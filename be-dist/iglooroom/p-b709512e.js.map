{"version":3,"names":["CommonService","Token","getCurrencies","token","this","getToken","MissingTokenError","data","axios","post","app_store","currencies","getExposedLanguages","languages","My_Result","getCountries","language","ExceptionMsg","Error","error","console","getUserDefaultCountry","IP","getExposedCountryByIp","lang","userDefaultCountry","getBEToken","getExposedLanguage","code","userPreferences","language_id","sections","entries","transformArrayToObject","localizedWords","Object","assign","direction","log","checkUserAuthState","anchor","JSON","parse","sessionStorage","getItem","login","is_signed_in","object","d","description"],"sources":["src/services/api/common.service.ts"],"sourcesContent":["import axios from 'axios';\r\nimport { MissingTokenError, Token } from '../../models/Token';\r\nimport app_store from '@/stores/app.store';\r\nimport localizedWords from '@/stores/localization.store';\r\n\r\nexport class CommonService extends Token {\r\n  public async getCurrencies() {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new MissingTokenError();\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Currencies?Ticket=${token}`);\r\n    app_store.currencies = [...data['My_Result']];\r\n    return data['My_Result'];\r\n  }\r\n  public async getExposedLanguages() {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new MissingTokenError();\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Languages?Ticket=${token}`);\r\n    app_store.languages = [...data.My_Result];\r\n    return data['My_Result'];\r\n  }\r\n  public async getCountries(language: string) {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        const { data } = await axios.post(`/Get_Exposed_Countries?Ticket=${token}`, {\r\n          language,\r\n        });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        return data.My_Result;\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async getUserDefaultCountry() {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        const { data } = await axios.post(`/Get_Country_By_IP?Ticket=${token}`, {\r\n          IP: '',\r\n        });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        return data['My_Result'];\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async getExposedCountryByIp() {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        const { data } = await axios.post(`/Get_Exposed_Country_By_IP?Ticket=${token}`, {\r\n          IP: '',\r\n          lang: 'en',\r\n        });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        app_store.userDefaultCountry = data['My_Result'];\r\n        return data['My_Result'];\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async getBEToken() {\r\n    try {\r\n      const { data } = await axios.post(`/Get_BE_Token`, {});\r\n      if (data.ExceptionMsg !== '') {\r\n        throw new Error(data.ExceptionMsg);\r\n      }\r\n      return data['My_Result'];\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async getExposedLanguage() {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token !== null) {\r\n        const { data } = await axios.post(`/Get_Exposed_Language?Ticket=${token}`, { code: app_store.userPreferences.language_id, sections: ['_BE_FRONT'] });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        let entries = this.transformArrayToObject(data.My_Result.entries);\r\n        localizedWords.entries = { ...localizedWords.entries, ...entries };\r\n        localizedWords.direction = data.My_Result.direction;\r\n        return { entries, direction: data.My_Result.direction };\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public checkUserAuthState() {\r\n    const anchor = JSON.parse(sessionStorage.getItem('anchor'));\r\n    if (anchor) {\r\n      if (anchor.login) {\r\n        app_store.is_signed_in = true;\r\n      }\r\n      return anchor.login || null;\r\n    }\r\n    return null;\r\n  }\r\n  private transformArrayToObject(data: any) {\r\n    let object: any = {};\r\n    for (const d of data) {\r\n      object[d.code] = d.description;\r\n    }\r\n    return object;\r\n  }\r\n}\r\n"],"mappings":"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"}