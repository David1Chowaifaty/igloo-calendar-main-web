import{b as o}from"./p-8e40500a.js";import{a as t}from"./p-d90a6658.js";import{P as e}from"./p-59ab3c21.js";import{t as n}from"./p-a62fb862.js";import{c as i}from"./p-3f95adf7.js";import{C as s}from"./p-afa53aba.js";var c=undefined&&undefined.__rest||function(o,t){var e={};for(var n in o)if(Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0)e[n]=o[n];if(o!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++){if(t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i]))e[n[i]]=o[n[i]]}return e};class r{constructor(){this.subscribers=[]}subscribe(o){this.subscribers.push(o)}unsubscribe(o){this.subscribers=this.subscribers.filter((t=>t!==o))}notifySubscribers(o){this.subscribers.forEach((t=>t(o)))}async signOut(){o.is_signed_in=false;i.userFormData={firstName:null,lastName:null,email:null,mobile_number:null,country_phone_prefix:null};n({login:null},"remove");if(!["booking","checkout"].includes(o.currentPage)){o.currentPage="booking"}const t=await(new s).getBEToken();o.app_data=Object.assign(Object.assign({},o.app_data),{token:t})}async login(i,s=true){const{option:r}=i,a=c(i,["option"]);const{data:l}=await t.post(`/Exposed_Guest_SignIn`,r==="direct"?a.params:Object.assign({},a));if(l["ExceptionMsg"]!==""){this.notifySubscribers({state:"failed",error:l["ExceptionMsg"]});throw new Error(l["ExceptionMsg"])}const u=l["My_Result"];if(s){o.app_data.token=u;o.is_signed_in=true;n({login:Object.assign(Object.assign({method:r},a),{isLoggedIn:true,token:u})})}console.count("auth called");const d=new e;d.getExposedGuest();this.notifySubscribers({state:"success",token:u,payload:Object.assign({method:r},a)});return l["My_Result"]}async signUp(e){const{data:n}=await t.post(`/Exposed_Guest_SignUp`,e);if(n["ExceptionMsg"]!==""){throw new Error(n["ExceptionMsg"])}o.app_data.token=n["My_Result"]}initializeFacebookSignIn(){window.fbAsyncInit=()=>{FB.init({appId:"1630011277802654",cookie:true,xfbml:true,version:"v19.0"});FB.AppEvents.logPageView()};(function(o,t,e){var n,i=o.getElementsByTagName(t)[0];if(o.getElementById(e)){return}n=o.createElement(t);n.id=e;n.src="https://connect.facebook.net/en_US/sdk.js";i.parentNode.insertBefore(n,i)})(document,"script","facebook-jssdk")}async handleCredentialResponse(o){try{const t=await this.login({option:"google",google_token:o.credential});return{state:"success",token:t}}catch(o){console.error("Error during Google Sign-In:",o);return{state:"failed",token:""}}}async loginWithFacebook(){FB.login((function(o){if(o.authResponse){console.log("Welcome!  Fetching your information.... ");FB.api("/me",{fields:"name, email, id"},(function(o){console.log(o)}))}else{console.log("User cancelled login or did not fully authorize.")}}));FB.getLoginStatus((o=>{console.log("login status",o)}))}createFakeGoogleWrapper(){const o=document.createElement("div");o.style.display="none";o.classList.add("custom-google-button");document.body.appendChild(o);window.google.accounts.id.renderButton(o,{type:"icon",width:"200"});const t=o.querySelector("div[role=button]");return{click:()=>{t.click()}}}loadGoogleSignInScript(o){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client";t.async=true;t.defer=true;t.onload=()=>this.initializeGoogleSignIn(o);document.head.appendChild(t)}initializeGoogleSignIn(o){window.google.accounts.id.initialize({client_id:"1035240403483-60urt17notg4vmvjbq739p0soqup0o87.apps.googleusercontent.com",callback:async o=>{this.handleCredentialResponse(o)},auto_select:true,ux_mode:"popup"});o=this.createFakeGoogleWrapper();window.handleGoogleLogin=()=>{o.click()}}}export{r as A};
//# sourceMappingURL=p-1df924b7.js.map