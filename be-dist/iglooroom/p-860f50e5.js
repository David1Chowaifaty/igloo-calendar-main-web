import{T as e,M as t,a as o}from"./p-7fc610bc.js";import{a as n}from"./p-f81fec0f.js";import{c as i,P as s}from"./p-02388b03.js";import{b as a}from"./p-e859690b.js";import{C as r}from"./p-b8ba2d40.js";import{z as c}from"./p-2ad5d597.js";var l=undefined&&undefined.__rest||function(e,t){var o={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0)o[n]=e[n];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++){if(t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i]))o[n[i]]=e[n[i]]}return o};class u extends e{constructor(){super(...arguments);this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter((t=>t!==e))}notifySubscribers(e){this.subscribers.forEach((t=>t(e)))}async signOut(){n.is_signed_in=false;i.userFormData={firstName:null,lastName:null,email:null,mobile_number:null,country_phone_prefix:null};a({login:null},"remove");if(!["booking","checkout"].includes(n.currentPage)){n.currentPage="booking"}const e=await(new r).getBEToken();n.app_data=Object.assign(Object.assign({},n.app_data),{token:e})}async login(e,i=true){const r=this.getToken();const{option:c}=e,u=l(e,["option"]);if(!r){throw new t}const{data:m}=await o.post(`/Exposed_Guest_SignIn?Ticket=${r}`,c==="direct"?u.params:Object.assign({},u));if(m["ExceptionMsg"]!==""){this.notifySubscribers({state:"failed",error:m["ExceptionMsg"]});throw new Error(m["ExceptionMsg"])}const d=m["My_Result"];if(i){n.app_data.token=d;n.is_signed_in=true;a({login:Object.assign(Object.assign({method:c},u),{isLoggedIn:true,token:d})})}const p=new s;p.setToken(d);p.getExposedGuest();this.notifySubscribers({state:"success",token:d,payload:Object.assign({method:c},u)});return m["My_Result"]}async signUp(e){const i=this.getToken();if(!i){throw new t}const{data:s}=await o.post(`/Exposed_Guest_SignUp?Ticket=${i}`,e);if(s["ExceptionMsg"]!==""){throw new Error(s["ExceptionMsg"])}n.app_data.token=s["My_Result"]}initializeFacebookSignIn(){window.fbAsyncInit=()=>{FB.init({appId:"1630011277802654",cookie:true,xfbml:true,version:"v19.0"});FB.AppEvents.logPageView()};(function(e,t,o){var n,i=e.getElementsByTagName(t)[0];if(e.getElementById(o)){return}n=e.createElement(t);n.id=o;n.src="https://connect.facebook.net/en_US/sdk.js";i.parentNode.insertBefore(n,i)})(document,"script","facebook-jssdk")}async handleCredentialResponse(e){try{const t=await this.login({option:"google",google_token:e.credential});return{state:"success",token:t}}catch(e){console.error("Error during Google Sign-In:",e);return{state:"failed",token:""}}}async loginWithFacebook(){FB.login((function(e){if(e.authResponse){console.log("Welcome!  Fetching your information.... ");FB.api("/me",{fields:"name, email, id"},(function(e){console.log(e)}))}else{console.log("User cancelled login or did not fully authorize.")}}));FB.getLoginStatus((e=>{console.log("login status",e)}))}createFakeGoogleWrapper(){const e=document.createElement("div");e.style.display="none";e.classList.add("custom-google-button");document.body.appendChild(e);window.google.accounts.id.renderButton(e,{type:"icon",width:"200"});const t=e.querySelector("div[role=button]");return{click:()=>{t.click()}}}loadGoogleSignInScript(e){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client";t.async=true;t.defer=true;t.onload=()=>this.initializeGoogleSignIn(e);document.head.appendChild(t)}initializeGoogleSignIn(e){window.google.accounts.id.initialize({client_id:"1035240403483-60urt17notg4vmvjbq739p0soqup0o87.apps.googleusercontent.com",callback:async e=>{this.handleCredentialResponse(e)},auto_select:true,ux_mode:"popup"});e=this.createFakeGoogleWrapper();window.handleGoogleLogin=()=>{e.click()}}}const m=c.object({firstName:c.string().min(2,{message:"FullNameCannotBeEmpty"}),lastName:c.string().min(2,{message:"LastNameCannotBeEmpty"}),email:c.string().email({message:"InvalidEmail"}),mobile_number:c.coerce.number().min(5),arrival_time:c.string(),message:c.string().optional(),bookingForSomeoneElse:c.boolean().default(false),country_id:c.coerce.number(),country_phone_prefix:c.coerce.string().min(1),id:c.coerce.number().nullable().default(null)});const d=c.object({address:c.string().nullable().default(null),city:c.string().nullable().default(null),country_id:c.coerce.number().min(1),dob:c.string().nullable().default(null),email:c.string().email(),first_name:c.string().min(2,{message:"FullNameCannotBeEmpty"}),id:c.coerce.number().nullable().default(null),last_name:c.string().min(3),mobile:c.coerce.number().min(5),subscribe_to_news_letter:c.boolean().default(false),country_phone_prefix:c.string().min(1),alternative_email:c.string().email().optional().nullable()});export{u as A,d as I,m as a};
//# sourceMappingURL=p-860f50e5.js.map