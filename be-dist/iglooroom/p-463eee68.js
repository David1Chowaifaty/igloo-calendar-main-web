import{T as t,M as o,a as e,P as n}from"./p-339e839b.js";import{a as i}from"./p-f5f7d9ce.js";import{a as s}from"./p-cf86677b.js";var c=undefined&&undefined.__rest||function(t,o){var e={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&o.indexOf(n)<0)e[n]=t[n];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++){if(o.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i]))e[n[i]]=t[n[i]]}return e};class r extends t{constructor(){super(...arguments);this.subscribers=[]}subscribe(t){this.subscribers.push(t)}unsubscribe(t){this.subscribers=this.subscribers.filter((o=>o!==t))}notifySubscribers(t){this.subscribers.forEach((o=>o(t)))}async login(t,r=true){const a=this.getToken();const{option:u}=t,l=c(t,["option"]);if(!a){throw new o}const{data:d}=await e.post(`/Exposed_Guest_SignIn?Ticket=${a}`,u==="direct"?l.params:Object.assign({},l));if(d["ExceptionMsg"]!==""){this.notifySubscribers({state:"failed",error:d["ExceptionMsg"]});throw new Error(d["ExceptionMsg"])}const f=d["My_Result"];if(r){localStorage.setItem("ir-token",f);i.app_data.token=f;i.is_signed_in=true}const p=new n;p.setToken(f);p.getExposedGuest();s({login:Object.assign(Object.assign({method:u},l),{isLoggedIn:true,token:f})});this.notifySubscribers({state:"success",token:f,payload:Object.assign({method:u},l)});return d["My_Result"]}async signUp(t){const n=this.getToken();if(!n){throw new o}const{data:s}=await e.post(`/Exposed_Guest_SignUp?Ticket=${n}`,t);if(s["ExceptionMsg"]!==""){throw new Error(s["ExceptionMsg"])}localStorage.setItem("ir-token",s["My_Result"]);i.app_data.token=s["My_Result"]}initializeFacebookSignIn(){window.fbAsyncInit=()=>{FB.init({appId:"1630011277802654",cookie:true,xfbml:true,version:"v19.0"});FB.AppEvents.logPageView()};(function(t,o,e){var n,i=t.getElementsByTagName(o)[0];if(t.getElementById(e)){return}n=t.createElement(o);n.id=e;n.src="https://connect.facebook.net/en_US/sdk.js";i.parentNode.insertBefore(n,i)})(document,"script","facebook-jssdk")}async handleCredentialResponse(t){try{const o=await this.login({option:"google",token:t.credential});return{state:"success",token:o}}catch(t){console.error("Error during Google Sign-In:",t);return{state:"failed",token:""}}}async loginWithFacebook(){FB.login((function(t){if(t.authResponse){console.log("Welcome!  Fetching your information.... ");FB.api("/me",{fields:"name, email, id"},(function(t){console.log(t)}))}else{console.log("User cancelled login or did not fully authorize.")}}));FB.getLoginStatus((t=>{console.log("login status",t)}))}createFakeGoogleWrapper(){const t=document.createElement("div");t.style.display="none";t.classList.add("custom-google-button");document.body.appendChild(t);window.google.accounts.id.renderButton(t,{type:"icon",width:"200"});const o=t.querySelector("div[role=button]");return{click:()=>{o.click()}}}loadGoogleSignInScript(t){const o=document.createElement("script");o.src="https://accounts.google.com/gsi/client";o.async=true;o.defer=true;o.onload=()=>this.initializeGoogleSignIn(t);document.head.appendChild(o)}initializeGoogleSignIn(t){window.google.accounts.id.initialize({client_id:"1035240403483-60urt17notg4vmvjbq739p0soqup0o87.apps.googleusercontent.com",callback:async t=>{this.handleCredentialResponse(t)},auto_select:true,ux_mode:"popup"});t=this.createFakeGoogleWrapper();window.handleGoogleLogin=()=>{t.click()}}}export{r as A};
//# sourceMappingURL=p-463eee68.js.map