import{T as o,M as t,a as e}from"./p-3a60a4ab.js";import{a as n}from"./p-f81fec0f.js";import{P as i}from"./p-cf38fe7e.js";import{n as s}from"./p-1c871994.js";import{c}from"./p-22f3649f.js";import{C as r}from"./p-eb455c34.js";var a=undefined&&undefined.__rest||function(o,t){var e={};for(var n in o)if(Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0)e[n]=o[n];if(o!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++){if(t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i]))e[n[i]]=o[n[i]]}return e};class l extends o{constructor(){super(...arguments);this.subscribers=[]}subscribe(o){this.subscribers.push(o)}unsubscribe(o){this.subscribers=this.subscribers.filter((t=>t!==o))}notifySubscribers(o){this.subscribers.forEach((t=>t(o)))}async signOut(){n.is_signed_in=false;c.userFormData={firstName:null,lastName:null,email:null,mobile_number:null,country_phone_prefix:null};s({login:null},"remove");if(!["booking","checkout"].includes(n.currentPage)){n.currentPage="booking"}const o=await(new r).getBEToken();n.app_data=Object.assign(Object.assign({},n.app_data),{token:o})}async login(o,c=true){const r=this.getToken();const{option:l}=o,u=a(o,["option"]);if(!r){throw new t}const{data:f}=await e.post(`/Exposed_Guest_SignIn?Ticket=${r}`,l==="direct"?u.params:Object.assign({},u));if(f["ExceptionMsg"]!==""){this.notifySubscribers({state:"failed",error:f["ExceptionMsg"]});throw new Error(f["ExceptionMsg"])}const p=f["My_Result"];if(c){n.app_data.token=p;n.is_signed_in=true;s({login:Object.assign(Object.assign({method:l},u),{isLoggedIn:true,token:p})})}const d=new i;d.setToken(p);d.getExposedGuest();this.notifySubscribers({state:"success",token:p,payload:Object.assign({method:l},u)});return f["My_Result"]}async signUp(o){const i=this.getToken();if(!i){throw new t}const{data:s}=await e.post(`/Exposed_Guest_SignUp?Ticket=${i}`,o);if(s["ExceptionMsg"]!==""){throw new Error(s["ExceptionMsg"])}n.app_data.token=s["My_Result"]}initializeFacebookSignIn(){window.fbAsyncInit=()=>{FB.init({appId:"1630011277802654",cookie:true,xfbml:true,version:"v19.0"});FB.AppEvents.logPageView()};(function(o,t,e){var n,i=o.getElementsByTagName(t)[0];if(o.getElementById(e)){return}n=o.createElement(t);n.id=e;n.src="https://connect.facebook.net/en_US/sdk.js";i.parentNode.insertBefore(n,i)})(document,"script","facebook-jssdk")}async handleCredentialResponse(o){try{const t=await this.login({option:"google",google_token:o.credential});return{state:"success",token:t}}catch(o){console.error("Error during Google Sign-In:",o);return{state:"failed",token:""}}}async loginWithFacebook(){FB.login((function(o){if(o.authResponse){console.log("Welcome!  Fetching your information.... ");FB.api("/me",{fields:"name, email, id"},(function(o){console.log(o)}))}else{console.log("User cancelled login or did not fully authorize.")}}));FB.getLoginStatus((o=>{console.log("login status",o)}))}createFakeGoogleWrapper(){const o=document.createElement("div");o.style.display="none";o.classList.add("custom-google-button");document.body.appendChild(o);window.google.accounts.id.renderButton(o,{type:"icon",width:"200"});const t=o.querySelector("div[role=button]");return{click:()=>{t.click()}}}loadGoogleSignInScript(o){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client";t.async=true;t.defer=true;t.onload=()=>this.initializeGoogleSignIn(o);document.head.appendChild(t)}initializeGoogleSignIn(o){window.google.accounts.id.initialize({client_id:"1035240403483-60urt17notg4vmvjbq739p0soqup0o87.apps.googleusercontent.com",callback:async o=>{this.handleCredentialResponse(o)},auto_select:true,ux_mode:"popup"});o=this.createFakeGoogleWrapper();window.handleGoogleLogin=()=>{o.click()}}}export{l as A};
//# sourceMappingURL=p-1e72d216.js.map