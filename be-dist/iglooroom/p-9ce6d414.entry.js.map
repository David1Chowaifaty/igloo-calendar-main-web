{"version":3,"names":["irAlertDialogCss","IrAlertDialogStyle0","IrAlertDialog","componentDidLoad","this","prepareFocusTrap","openModal","isOpen","addOverlay","openChange","emit","closeModal","removeOverlay","focusableElements","focusableContent","el","querySelectorAll","length","firstFocusableElement","lastFocusableElement","focus","handleKeyDown","ev","isTabPressed","key","keyCode","shiftKey","document","activeElement","preventDefault","disconnectedCallback","render","h","Host","class","tabIndex","role","id","name","irBookingCancelationCss","IrBookingCancelationStyle0","IrBookingCancelation","paymentService","PaymentService","setOverdueAmount","res","getExposedCancelationDueAmount","booking_nbr","currency_id","currency","overdueResult","find","f","type","paymentAmount","amount","error","console","init","policies","cancelation_policies","requests","booking","prepaymentPromise","getBookingPrepaymentAmount","push","overdueAmountPromise","results","Promise","all","prepaymentResult","_a","openDialog","alertDialog","closeAlertDialog","isPending","isRequestPending","ref","onOpenChange","e","detail","slot","localizedWords","entries","Lcz_BookingCancellation","Fragment","formatAmount","code","Lcz_NoPenalityIsApplied","onClick","Lcz_MoreDetails","svgClassName","_b","map","d","rt_name","rp_name","statement","label","Lcz_Cancel","variants","onButtonClick","size","disabled","Lcz_AcceptAndConfirm","isLoading","async","RequestBookingCancelation","cancelationResult","state"],"sources":["src/components/ui/ir-alert-dialog/ir-alert-dialog.css?tag=ir-alert-dialog&encapsulation=shadow","src/components/ui/ir-alert-dialog/ir-alert-dialog.tsx","src/components/ir-booking-cancelation/ir-booking-cancelation.css?tag=ir-booking-cancelation&encapsulation=shadow","src/components/ir-booking-cancelation/ir-booking-cancelation.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  margin: 0;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n}\r\n.backdrop {\r\n  opacity: 0;\r\n  background: rgba(0, 0, 0, 0.2);\r\n  position: fixed;\r\n  inset: 0;\r\n  z-index: 999999;\r\n}\r\n.backdrop[data-state='opened'] {\r\n  animation: overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\r\n}\r\n.backdrop[data-state='closed'] {\r\n  opacity: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.modal-container {\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\r\n  position: fixed;\r\n  top: 90%;\r\n  left: 50%;\r\n  transform: translate(-50%, -90%);\r\n  width: 90vw;\r\n  max-width: 500px;\r\n  max-height: 85vh;\r\n  padding: 25px;\r\n  z-index: 9999999;\r\n  animation: contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1);\r\n}\r\n\r\n.modal-footer ::slotted(*) {\r\n  display: flex;\r\n  flex-direction: column-reverse;\r\n  gap: 8px;\r\n  margin-top: 16px;\r\n}\r\n.modal-footer {\r\n  --ir-btn-width: 100%;\r\n}\r\n.modal-title ::slotted(*) {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #101828;\r\n  margin-bottom: 8px;\r\n}\r\n.modal-body ::slotted(*) {\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  color: #475467;\r\n}\r\n\r\n@keyframes overlayShow {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n@keyframes contentShow {\r\n  from {\r\n    opacity: 0;\r\n    transform: translate(-50%, -100%) scale(0.96);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translate(-50%, -90%) scale(1);\r\n  }\r\n}\r\n@keyframes contentShowMd {\r\n  from {\r\n    opacity: 0;\r\n    transform: translate(-50%, -48%) scale(0.96);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translate(-50%, -50%) scale(1);\r\n  }\r\n}\r\n\r\n/* md */\r\n\r\n@media only screen and (min-width: 768px) {\r\n  .modal-container {\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 90vw;\r\n    max-width: 500px;\r\n    max-height: 85vh;\r\n    padding: 25px;\r\n    z-index: 9999999;\r\n    animation: contentShowMd 300ms cubic-bezier(0.16, 1, 0.3, 1);\r\n  }\r\n  .modal-footer ::slotted(*) {\r\n    flex-direction: row;\r\n    align-items: center;\r\n    justify-content: end;\r\n    gap: 8px;\r\n    --ir-btn-width: inherit;\r\n  }\r\n}\r\n","import { addOverlay, removeOverlay } from '@/stores/overlay.store';\r\nimport { Component, Host, h, Element, Listen, State, Method, Event, EventEmitter } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-alert-dialog',\r\n  styleUrl: 'ir-alert-dialog.css',\r\n  shadow: true,\r\n})\r\nexport class IrAlertDialog {\r\n  @Element() el: HTMLElement;\r\n\r\n  @State() isOpen = false;\r\n\r\n  @Event() openChange: EventEmitter<boolean>;\r\n  private firstFocusableElement: HTMLElement;\r\n  private lastFocusableElement: HTMLElement;\r\n\r\n  componentDidLoad() {\r\n    this.prepareFocusTrap();\r\n  }\r\n\r\n  @Method()\r\n  async openModal() {\r\n    this.isOpen = true;\r\n    addOverlay();\r\n    this.prepareFocusTrap();\r\n    this.openChange.emit(this.isOpen);\r\n  }\r\n\r\n  @Method()\r\n  async closeModal() {\r\n    removeOverlay();\r\n    this.isOpen = false;\r\n    this.openChange.emit(this.isOpen);\r\n  }\r\n\r\n  prepareFocusTrap() {\r\n    const focusableElements = 'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\r\n    const focusableContent: NodeListOf<HTMLElement> = this.el.querySelectorAll(focusableElements);\r\n    if (focusableContent.length === 0) return;\r\n\r\n    this.firstFocusableElement = focusableContent[0];\r\n    this.lastFocusableElement = focusableContent[focusableContent.length - 1];\r\n    this.firstFocusableElement.focus();\r\n  }\r\n\r\n  @Listen('keydown', { target: 'document' })\r\n  handleKeyDown(ev: KeyboardEvent) {\r\n    let isTabPressed = ev.key === 'Tab' || ev.keyCode === 9;\r\n\r\n    if (!isTabPressed) return;\r\n\r\n    if (ev.shiftKey) {\r\n      // Shift + Tab\r\n      if (document.activeElement === this.firstFocusableElement) {\r\n        this.lastFocusableElement.focus();\r\n        ev.preventDefault();\r\n      }\r\n    } else {\r\n      // Tab\r\n      if (document.activeElement === this.lastFocusableElement) {\r\n        this.firstFocusableElement.focus();\r\n        ev.preventDefault();\r\n      }\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    removeOverlay();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"backdrop\" data-state={this.isOpen ? 'opened' : 'closed'}></div>\r\n        {this.isOpen && (\r\n          <div class=\"modal-container\" tabIndex={-1} role=\"alertdialog\" aria-labelledby=\"dialog1Title\" aria-describedby=\"dialog1Desc\">\r\n            <div class={'modal-title'} id=\"dialog1Title\">\r\n              <slot name=\"modal-title\"></slot>\r\n            </div>\r\n            <div class=\"modal-body\" id=\"dialog1Desc\">\r\n              <slot name=\"modal-body\"></slot>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n              <slot name=\"modal-footer\"></slot>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n","\r\n","import { Component, Event, EventEmitter, Fragment, h, Method, Prop, State } from '@stencil/core';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { PaymentService, TBookingInfo } from '@/services/api/payment.service';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport localizedWords from '@/stores/localization.store';\r\n\r\n@Component({\r\n  tag: 'ir-booking-cancelation',\r\n  styleUrl: 'ir-booking-cancelation.css',\r\n  shadow: true,\r\n})\r\nexport class IrBookingCancelation {\r\n  @Prop() booking_nbr: string;\r\n  @Prop() cancelation: string;\r\n  @Prop() cancelation_policies: TBookingInfo[] = [];\r\n  @Prop() currency: { code: string; id: number };\r\n  @Prop() booking: Booking;\r\n  @State() paymentAmount: number;\r\n  @State() isLoading: boolean;\r\n  @State() isOpen = false;\r\n  @State() policies: TBookingInfo[] = [];\r\n\r\n  @Event() openChange: EventEmitter<boolean>;\r\n  @Event() cancelationResult: EventEmitter<{ state: 'failed' | 'success'; booking_nbr: string }>;\r\n\r\n  private alertDialog: HTMLIrAlertDialogElement;\r\n  private paymentService = new PaymentService();\r\n\r\n  async setOverdueAmount() {\r\n    try {\r\n      const res = await this.paymentService.getExposedCancelationDueAmount({\r\n        booking_nbr: this.booking_nbr,\r\n        currency_id: this.currency.id,\r\n      });\r\n\r\n      const overdueResult = res.find(f => f.type === 'overdue');\r\n      if (overdueResult) {\r\n        this.paymentAmount = overdueResult.amount;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching overdue amount:', error);\r\n    }\r\n  }\r\n  async init() {\r\n    try {\r\n      this.policies = this.cancelation_policies;\r\n      const requests = [];\r\n      if (this.cancelation_policies.length === 0 && this.booking) {\r\n        const prepaymentPromise = this.paymentService.getBookingPrepaymentAmount(this.booking);\r\n        requests.push(prepaymentPromise);\r\n      }\r\n      const overdueAmountPromise = this.setOverdueAmount();\r\n      requests.push(overdueAmountPromise);\r\n      const results = await Promise.all(requests);\r\n      if (this.cancelation_policies.length === 0 && this.booking) {\r\n        const prepaymentResult = results.length > 1 ? results[0] : null;\r\n        if (prepaymentResult) {\r\n          this.policies = prepaymentResult.cancelation_policies ?? this.policies;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error during initialization:', error);\r\n    }\r\n  }\r\n  @Method()\r\n  async openDialog() {\r\n    this.openChange.emit(true);\r\n    this.alertDialog.openModal();\r\n    await this.init();\r\n  }\r\n\r\n  private closeAlertDialog() {\r\n    this.alertDialog.closeModal();\r\n    this.openChange.emit(false);\r\n  }\r\n\r\n  render() {\r\n    const isPending = isRequestPending('/Get_Exposed_Cancelation_Due_Amount');\r\n    return (\r\n      <div>\r\n        <ir-alert-dialog\r\n          ref={el => (this.alertDialog = el)}\r\n          onOpenChange={e => {\r\n            if (!e.detail && this.isOpen) {\r\n              this.isOpen = false;\r\n            }\r\n          }}\r\n        >\r\n          <h2 slot=\"modal-title\" class=\"text-lg font-medium\">\r\n            {localizedWords.entries.Lcz_BookingCancellation}\r\n          </h2>\r\n          <div class=\"py-3\" slot=\"modal-body\">\r\n            {isPending ? (\r\n              <div class=\"h-24\">\r\n                <ir-skeleton class=\"mb-2.5 h-4 w-60\"></ir-skeleton>\r\n              </div>\r\n            ) : (\r\n              <Fragment>\r\n                {this.paymentAmount > 0 ? (\r\n                  <p class=\"mb-2.5 font-semibold\">{`If you cancel now, the penalty will be ${formatAmount(this.paymentAmount, this.currency?.code || 'usd')}.`}</p>\r\n                ) : (\r\n                  <p class=\"mb-2.5 font-semibold\">{localizedWords.entries.Lcz_NoPenalityIsApplied}</p>\r\n                )}\r\n                <button\r\n                  onClick={() => {\r\n                    this.isOpen = !this.isOpen;\r\n                  }}\r\n                  class=\"flex w-full items-center justify-between rounded-md  py-1 \"\r\n                >\r\n                  <p>{localizedWords.entries.Lcz_MoreDetails}</p>\r\n                  <ir-icons name={this.isOpen ? 'angle_up' : 'angle_down'} svgClassName=\"h-3\"></ir-icons>\r\n                </button>\r\n                {this.isOpen && (\r\n                  <Fragment>\r\n                    <div class={'divide-y py-2'}>\r\n                      {this.policies?.map(d => (\r\n                        <div class=\"space-y-1.5 py-2.5\">\r\n                          <p class={'font-medium'}>\r\n                            {d.rt_name} {d.rp_name}\r\n                          </p>\r\n                          <p class=\"text-xs text-gray-500\">{d.statement}</p>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </Fragment>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n          </div>\r\n\r\n          <div slot=\"modal-footer\">\r\n            <ir-button\r\n              label={localizedWords.entries.Lcz_Cancel}\r\n              variants=\"outline\"\r\n              onButtonClick={() => {\r\n                this.closeAlertDialog();\r\n              }}\r\n              size=\"md\"\r\n            ></ir-button>\r\n            <ir-button\r\n              disabled={isPending}\r\n              size=\"md\"\r\n              label={localizedWords.entries.Lcz_AcceptAndConfirm}\r\n              isLoading={isRequestPending('/Request_Booking_Cancelation')}\r\n              onButtonClick={async () => {\r\n                try {\r\n                  await this.paymentService.RequestBookingCancelation(this.booking_nbr);\r\n                  this.cancelationResult.emit({ state: 'success', booking_nbr: this.booking_nbr });\r\n                  this.closeAlertDialog();\r\n                } catch (error) {\r\n                  console.error(error);\r\n                  this.cancelationResult.emit({ state: 'failed', booking_nbr: this.booking_nbr });\r\n                }\r\n              }}\r\n            ></ir-button>\r\n          </div>\r\n        </ir-alert-dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}