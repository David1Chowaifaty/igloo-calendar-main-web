import{T as e,M as t,a as o}from"./p-3a60a4ab.js";import{a}from"./p-f81fec0f.js";import{d as n}from"./p-474fd416.js";class i extends e{processBookingPayment(){}async GeneratePaymentCaller({token:e,params:n,onRedirect:i,onScriptRun:r}){if(!e){throw new t}const{data:s}=await o.post(`/Generate_Payment_Caller?Ticket=${e}`,Object.assign(Object.assign({},n),{callback_url:`https://${a.property.perma_link}.bookingmystay.com/invoice`}));if(s["ExceptionMsg"]!==""){throw new Error(s.ExceptionMsg)}const l=s["My_Result"];if(l.type===1){i(l.caller)}else{r(l.caller)}return l}async RequestBookingCancelation(e){const a=this.getToken();if(!a){throw new t}const{data:n}=await o.post(`/Request_Booking_Cancelation?Ticket=${a}`,{BOOK_NBR:e});if(n["ExceptionMsg"]!==""){throw new Error(n.ExceptionMsg)}return n["My_Result"]}async GetExposedApplicablePolicies({token:e,params:a,book_date:n}){if(!e){throw new t}const{data:i}=await o.post(`/Get_Exposed_Applicable_Policies?Ticket=${e}`,a);if(i["ExceptionMsg"]!==""){throw new Error(i.ExceptionMsg)}const r=i["My_Result"];return{data:r,amount:this.processAlicablePolicies(r,n).amount}}processAlicablePolicies(e,t){var o,a,i,r;let s=false;const l=((a=(o=e.find((e=>e.type==="guarantee")))===null||o===void 0?void 0:o.brackets[0])===null||a===void 0?void 0:a.gross_amount)||0;let c=e.find((e=>{var o;return e.type==="cancelation"&&((o=e===null||e===void 0?void 0:e.brackets)===null||o===void 0?void 0:o.some((e=>n.isBefore(t,new Date(e.due_on))),t))}));if(c){s=true;const e=(r=(i=c.brackets.find((e=>n.isBefore(new Date(e.due_on),t))))===null||i===void 0?void 0:i.gross_amount)!==null&&r!==void 0?r:null;return{amount:e>l?e:l,isInFreeCancelationZone:s}}return{amount:l,isInFreeCancelationZone:s}}}export{i as P};
//# sourceMappingURL=p-c4d9af03.js.map