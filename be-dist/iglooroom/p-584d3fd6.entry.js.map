{"version":3,"names":["irPopoverCss","IrPopoverStyle0","IrPopover","this","popoverInstance","handleKeyboardPress","e","isVisible","key","toggleVisibility","handleOutsideClick","event","outsideClick","composedPath","includes","el","openChange","emit","window","innerWidth","componentDidLoad","initializePopover","document","addEventListener","handleResize","currentIsMobile","isMobile","previousIsMobile","dialogElement","closeModal","popupInitializing","setTimeout","undefined","triggerElement","contentElement","createPopper","placement","localization_store","dir","modifiers","name","options","offset","currentDir","toLowerCase","state","newPlacement","replace","setOptions","then","update","disconnectedCallback","removeEventListener","destroy","clearTimeout","render","h","Fragment","class","onClick","openModal","closeButton","showCloseButton","ref","onOpenChange","stopImmediatePropagation","stopPropagation","isDialogOpen","detail","slot","trigger_label","width","height","viewBox","fill","xmlns","d"],"sources":["src/components/ui/ir-popover/ir-popover.css?tag=ir-popover&encapsulation=shadow","src/components/ui/ir-popover/ir-popover.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n.popover-content {\r\n  z-index: 9999999;\r\n  /* background: var(--background); */\r\n}\r\n.trigger {\r\n  width: 100%;\r\n  width: 200px;\r\n  background: white;\r\n  border-radius: var(--radius, 8px);\r\n  border: 1px solid var(--gray-300, #d0d5dd);\r\n  display: inline-flex;\r\n  align-items: center;\r\n  padding: 10px 14px;\r\n  justify-content: space-between;\r\n  font-size: 16px;\r\n  line-height: 1;\r\n}\r\n\r\n.trigger:focus,\r\n.trigger:active {\r\n  border-color: var(--brand-300, #84caff);\r\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.1), 0 0 0 4px var(--brand-100, #d1e9ff);\r\n}\r\n","import { Component, h, Prop, State, Element, Method, Event, EventEmitter, Fragment, Listen } from '@stencil/core';\r\nimport { createPopper, Placement } from '@popperjs/core';\r\nimport localization_store from '@/stores/app.store';\r\n\r\n@Component({\r\n  tag: 'ir-popover',\r\n  styleUrl: 'ir-popover.css',\r\n  shadow: true,\r\n})\r\nexport class IrPopover {\r\n  @Element() el: HTMLElement;\r\n\r\n  @Prop() active: boolean = false;\r\n  @Prop() trigger_label: string = '';\r\n  @Prop() placement: Placement;\r\n  @Prop() stopListeningForOutsideClicks: boolean = false;\r\n  @Prop() showCloseButton: boolean = true;\r\n\r\n  @State() isVisible: boolean = false;\r\n  @State() isMobile: boolean = window.innerWidth < 640;\r\n\r\n  @State() previousIsMobile: boolean = window.innerWidth < 640;\r\n  @State() isDialogOpen: boolean;\r\n\r\n  popoverInstance = null;\r\n  triggerElement: HTMLElement;\r\n  contentElement: HTMLElement;\r\n  popupInitializing: NodeJS.Timeout;\r\n\r\n  dialogElement: HTMLIrDialogElement;\r\n\r\n  @Event() openChange: EventEmitter<boolean>;\r\n  componentDidLoad() {\r\n    this.initializePopover();\r\n    document.addEventListener('click', this.handleOutsideClick, true);\r\n    document.addEventListener('keydown', this.handleKeyboardPress, true);\r\n  }\r\n  handleKeyboardPress = (e: KeyboardEvent) => {\r\n    if (!this.isVisible) {\r\n      return;\r\n    }\r\n    if (e.key === 'Escape') {\r\n      this.toggleVisibility();\r\n    }\r\n    return;\r\n  };\r\n  @Listen('resize', { target: 'window' })\r\n  handleResize() {\r\n    const currentIsMobile = window.innerWidth < 640;\r\n    if (this.isMobile !== currentIsMobile) {\r\n      this.previousIsMobile = this.isMobile;\r\n      this.isMobile = currentIsMobile;\r\n      if (this.previousIsMobile === false && this.isMobile === true && this.dialogElement) {\r\n        this.dialogElement.closeModal();\r\n        this.isVisible = false;\r\n        this.openChange.emit(this.isVisible);\r\n      }\r\n      if (!this.isMobile && this.isVisible) {\r\n        this.isVisible = false;\r\n        this.popupInitializing = setTimeout(() => {\r\n          this.initializePopover();\r\n        }, 100);\r\n      }\r\n    }\r\n    if (!currentIsMobile && this.dialogElement) {\r\n      this.dialogElement = undefined;\r\n      this.popupInitializing = setTimeout(() => {\r\n        this.initializePopover();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  initializePopover() {\r\n    if (this.triggerElement && this.contentElement) {\r\n      this.popoverInstance = createPopper(this.triggerElement, this.contentElement, {\r\n        placement: this.placement || localization_store.dir === 'LTR' ? 'bottom-start' : 'bottom-end',\r\n        modifiers: [\r\n          {\r\n            name: 'offset',\r\n            options: {\r\n              offset: [0, 3],\r\n            },\r\n          },\r\n        ],\r\n      });\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async toggleVisibility() {\r\n    this.isVisible = !this.isVisible;\r\n    if (this.dialogElement) {\r\n      this.dialogElement.closeModal();\r\n    }\r\n    if (this.isVisible && this.popoverInstance) {\r\n      const currentDir = localization_store.dir.toLowerCase() || 'ltr';\r\n      if (\r\n        (this.popoverInstance.state.options.placement === 'bottom-start' && currentDir === 'rtl') ||\r\n        (this.popoverInstance.state.options.placement === 'bottom-end' && currentDir === 'ltr')\r\n      ) {\r\n        let newPlacement = this.popoverInstance.state.options.placement;\r\n        if (currentDir === 'rtl') {\r\n          newPlacement = newPlacement.replace('bottom-start', 'bottom-end');\r\n        } else {\r\n          newPlacement = newPlacement.replace('bottom-end', 'bottom-start');\r\n        }\r\n        this.popoverInstance\r\n          .setOptions({\r\n            placement: newPlacement,\r\n          })\r\n          .then(() => {\r\n            this.popoverInstance.update();\r\n          });\r\n      } else {\r\n        this.popoverInstance.update();\r\n      }\r\n    }\r\n    this.openChange.emit(this.isVisible);\r\n  }\r\n\r\n  handleOutsideClick = (event: MouseEvent) => {\r\n    const outsideClick = typeof event.composedPath === 'function' && !event.composedPath().includes(this.el);\r\n    if (outsideClick && this.isVisible) {\r\n      this.isVisible = false;\r\n      this.openChange.emit(this.isVisible);\r\n    }\r\n  };\r\n\r\n  disconnectedCallback() {\r\n    document.removeEventListener('click', this.handleOutsideClick, true);\r\n    document.removeEventListener('keydown', this.handleKeyboardPress, true);\r\n    if (this.popoverInstance) {\r\n      this.popoverInstance.destroy();\r\n    }\r\n    if (this.popupInitializing) {\r\n      clearTimeout(this.popupInitializing);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        {this.isMobile && (\r\n          <div class=\"w-full md:hidden\">\r\n            <div\r\n              class=\"w-full\"\r\n              onClick={() => {\r\n                this.dialogElement.openModal();\r\n              }}\r\n            >\r\n              <slot name=\"trigger\" />\r\n            </div>\r\n            <ir-dialog\r\n              closeButton={this.showCloseButton}\r\n              ref={el => (this.dialogElement = el)}\r\n              onOpenChange={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                this.isDialogOpen = e.detail;\r\n                this.openChange.emit(e.detail);\r\n              }}\r\n            >\r\n              <div slot=\"modal-body\">\r\n                <slot name=\"popover-content\"></slot>\r\n              </div>\r\n            </ir-dialog>\r\n          </div>\r\n        )}\r\n        {!this.isMobile && (\r\n          <div class=\"hidden sm:block\">\r\n            <div\r\n              ref={el => (this.triggerElement = el)}\r\n              onClick={e => {\r\n                e.stopPropagation();\r\n                e.stopImmediatePropagation();\r\n                this.toggleVisibility();\r\n              }}\r\n            >\r\n              <slot name=\"trigger\">\r\n                <button class=\"trigger\">\r\n                  <span>{this.trigger_label}</span>\r\n                  <svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <path\r\n                      d=\"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z\"\r\n                      fill=\"currentColor\"\r\n                      fill-rule=\"evenodd\"\r\n                      clip-rule=\"evenodd\"\r\n                    ></path>\r\n                  </svg>\r\n                </button>\r\n              </slot>\r\n            </div>\r\n            <div class=\"popover-content\" ref={el => (this.contentElement = el)}>\r\n              {this.isVisible && (\r\n                <div>\r\n                  <slot name=\"popover-content\"></slot>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}