{"version":3,"names":["irBookingWidgetCss","IrBookingWidgetStyle0","IrBookingWidget","this","commonService","CommonService","propertyService","PropertyService","from_date","to_date","adultCount","childrenCount","initApp","modifyContainerStyle","axios","defaults","withCredentials","baseURL","baseUrl","componentWillLoad","token","getBEToken","app_store","userPreferences","language_id","language","currency_id","setToken","initProperty","isLoading","Promise","all","getExposedProperty","id","propertyId","aname","perma_link","getExposedLanguage","error","console","log","handleContentContainerStyle","contentContainerStyle","borderColor","el","style","setProperty","handleBooknow","guests","currentDomain","window","location","hostname","subdomainURL","dates","fromDate","format","toDate","adults","children","queryParams","queryString","filter","param","join","open","renderDateTrigger","h","class","slot","name","svgClassName","renderAdultChildTrigger","localizedWords","entries","Lcz_Adult","Lcz_Adults","Lcz_Child","Lcz_Children","render","Fragment","showCloseButton","placement","ref","popover","onOpenChange","e","isPopoverOpen","detail","_a","_b","locale","localization_store","selectedLocale","maxSpanDays","onDateChange","stopImmediatePropagation","stopPropagation","end","start","toggleVisibility","minAdultCount","maxAdultCount","_c","property","adult_child_constraints","adult_max_nbr","maxChildrenCount","_d","child_max_nbr","childMaxAge","_e","child_max_age","onUpdateCounts","onClick","bind"],"sources":["src/components/ir-booking-widget/ir-booking-widget.css?tag=ir-booking-widget&encapsulation=shadow","src/components/ir-booking-widget/ir-booking-widget.tsx"],"sourcesContent":[":host {\r\n  display: flex;\r\n  width: 100%;\r\n  justify-content: center;\r\n  padding: 0 1rem;\r\n}\r\n\r\n:host([position='sticky']) {\r\n  position: sticky;\r\n  bottom: 2rem;\r\n}\r\n.booking-widget-container {\r\n  position: relative;\r\n  display: flex;\r\n  background: #000;\r\n  color: white;\r\n  border-radius: var(--ir-widget-radius, 0.5rem);\r\n  border: 1px solid var(--ir-widget-border-color);\r\n  z-index: 0;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  transition: all 0.3s ease-in-out;\r\n}\r\n\r\n.popup-container {\r\n  border-radius: var(--ir-widget-radius);\r\n}\r\n.date-trigger,\r\n.guests-trigger {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 1rem;\r\n  border-bottom: 1px solid var(--ir-widget-border-color);\r\n  padding: 0.625rem 14px;\r\n  font-size: 14px;\r\n  position: relative;\r\n  z-index: 1;\r\n  cursor: pointer;\r\n  padding-inline-end: 2rem;\r\n  min-width: 250px;\r\n  width: 100%;\r\n}\r\n\r\n.book-now {\r\n  background: hsla(var(--brand-600, 215, 87%, 51%), 1);\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  gap: 0.5rem;\r\n  transition: all 0.3s ease-in-out;\r\n  text-align: center;\r\n}\r\n.book-now:hover {\r\n  background: hsl(var(--brand-700, 218, 80%, 46%));\r\n}\r\n\r\n.date-trigger ir-icons,\r\n.guests-trigger ir-icons {\r\n  position: absolute;\r\n  left: 14px;\r\n}\r\n.book-now {\r\n  border-bottom-right-radius: var(--ir-widget-radius, 0.5rem);\r\n  border-bottom-left-radius: var(--ir-widget-radius, 0.5rem);\r\n}\r\n.date-trigger {\r\n  border-top-right-radius: var(--ir-widget-radius, 0.5rem);\r\n  border-top-left-radius: var(--ir-widget-radius, 0.5rem);\r\n}\r\n/* sm */\r\n@media only screen and (min-width: 640px) {\r\n  .booking-widget-container {\r\n    flex-direction: row;\r\n    align-items: center;\r\n    width: fit-content;\r\n  }\r\n  .date-trigger,\r\n  .guests-trigger {\r\n    border-bottom: 0;\r\n  }\r\n  .date-trigger {\r\n    border-right: 1px solid var(--ir-widget-border-color);\r\n  }\r\n  .ir-popover {\r\n    width: fit-content;\r\n  }\r\n  .date-trigger {\r\n    border-top-right-radius: 0;\r\n    border-top-left-radius: 0;\r\n  }\r\n  .date-trigger ir-icons,\r\n  .guests-trigger ir-icons {\r\n    position: initial;\r\n    left: auto;\r\n  }\r\n}\r\n/* md */\r\n\r\n@media only screen and (min-width: 768px) {\r\n}\r\n\r\n/* lg */\r\n@media only screen and (min-width: 1024px) {\r\n}\r\n/* xl */\r\n\r\n@media only screen and (min-width: 1280px) {\r\n}\r\n/* 2xl */\r\n\r\n@media only screen and (min-width: 1536px) {\r\n}\r\n\r\n@keyframes rotate {\r\n  from {\r\n    transform: translate(-50%, -50%) scale(1.4) rotate(0turn);\r\n  }\r\n  to {\r\n    transform: translate(-50%, -50%) scale(1.4) rotate(1turn);\r\n  }\r\n}\r\n\r\n.btn-flip {\r\n  opacity: 1;\r\n  outline: 0;\r\n  color: #fff;\r\n  line-height: 40px;\r\n  position: relative;\r\n  text-align: center;\r\n  letter-spacing: 1px;\r\n  display: inline-block;\r\n  text-decoration: none;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.btn-flip:hover:after {\r\n  opacity: 1;\r\n  transform: translateY(0) rotateX(0);\r\n}\r\n\r\n.btn-flip:hover:before {\r\n  opacity: 0;\r\n  transform: translateY(50%) rotateX(90deg);\r\n}\r\n\r\n.btn-flip:after {\r\n  top: 0;\r\n  left: 0;\r\n  opacity: 0;\r\n  width: 100%;\r\n  color: white;\r\n  display: block;\r\n  transition: 0.5s;\r\n  position: absolute;\r\n  background: hsla(var(--brand-600, 215, 87%, 51%), 1);\r\n  content: attr(data-back);\r\n  transform: translateY(-50%) rotateX(90deg);\r\n  border-radius: var(--ir-widget-radius, 0.5rem);\r\n}\r\n.btn-flip:dir(ltr)::after {\r\n  border-bottom-left-radius: 0;\r\n  border-top-left-radius: 0;\r\n}\r\n.btn-flip:dir(rtl)::after {\r\n  border-bottom-right-radius: 0;\r\n  border-top-right-radius: 0;\r\n}\r\n\r\n.btn-flip:before {\r\n  top: 0;\r\n  left: 0;\r\n  opacity: 1;\r\n  color: white;\r\n  display: block;\r\n  padding: 0 30px;\r\n  line-height: 40px;\r\n  transition: 0.5s;\r\n  position: relative;\r\n  background: hsla(var(--brand-600, 215, 87%, 51%), 1);\r\n  content: attr(data-front);\r\n  transform: translateY(0) rotateX(0);\r\n  border-radius: var(--ir-widget-radius, 0.5rem);\r\n}\r\n.btn-flip:dir(ltr)::before {\r\n  border-bottom-left-radius: 0;\r\n  border-top-left-radius: 0;\r\n}\r\n.btn-flip:dir(rtl)::before {\r\n  border-bottom-right-radius: 0;\r\n  border-top-right-radius: 0;\r\n}\r\n","import { Component, h, Element, Prop, Watch, Fragment, State } from '@stencil/core';\r\nimport { TContainerStyle } from './types';\r\nimport localization_store from '@/stores/app.store';\r\nimport { CommonService } from '@/services/api/common.service';\r\nimport { PropertyService } from '@/services/api/property.service';\r\nimport axios from 'axios';\r\nimport app_store from '@/stores/app.store';\r\nimport { format } from 'date-fns';\r\nimport localizedWords from '@/stores/localization.store';\r\n@Component({\r\n  tag: 'ir-booking-widget',\r\n  styleUrl: 'ir-booking-widget.css',\r\n  shadow: true,\r\n})\r\nexport class IrBookingWidget {\r\n  @Element() el: HTMLIrBookingWidgetElement;\r\n\r\n  @Prop({ reflect: true }) position: 'sticky' | 'block' = 'sticky';\r\n  @Prop() contentContainerStyle: TContainerStyle;\r\n  @Prop() propertyId: number = 42;\r\n  @Prop() baseUrl: string;\r\n  @Prop() language: string = 'en';\r\n\r\n  @State() isPopoverOpen: boolean;\r\n  @State() isLoading: boolean;\r\n  @State() dates: { from_date: Date | null; to_date: Date | null } = {\r\n    from_date: null,\r\n    to_date: null,\r\n  };\r\n  @State() guests: { adultCount: number; childrenCount: number } = {\r\n    adultCount: 0,\r\n    childrenCount: 0,\r\n  };\r\n\r\n  private popover: HTMLIrPopoverElement;\r\n  private token: string;\r\n\r\n  private commonService = new CommonService();\r\n  private propertyService = new PropertyService();\r\n\r\n  private initApp() {\r\n    this.modifyContainerStyle();\r\n    axios.defaults.withCredentials = true;\r\n    axios.defaults.baseURL = this.baseUrl;\r\n  }\r\n  async componentWillLoad() {\r\n    this.initApp();\r\n    this.token = await this.commonService.getBEToken();\r\n    app_store.userPreferences = {\r\n      language_id: this.language,\r\n      currency_id: 'usd',\r\n    };\r\n    this.commonService.setToken(this.token);\r\n    this.propertyService.setToken(this.token);\r\n    this.initProperty();\r\n  }\r\n  async initProperty() {\r\n    try {\r\n      this.isLoading = true;\r\n      await Promise.all([\r\n        this.propertyService.getExposedProperty({\r\n          id: this.propertyId,\r\n          language: this.language,\r\n          aname: '',\r\n          perma_link: '',\r\n        }),\r\n        this.commonService.getExposedLanguage(),\r\n      ]);\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  @Watch('contentContainerStyle')\r\n  handleContentContainerStyle() {\r\n    this.modifyContainerStyle();\r\n  }\r\n\r\n  private modifyContainerStyle() {\r\n    if (this.contentContainerStyle && this.contentContainerStyle.borderColor) {\r\n      this.el.style.setProperty('--ir-widget-border-color', this.contentContainerStyle.borderColor);\r\n    }\r\n  }\r\n  handleBooknow() {\r\n    if (this.guests.adultCount === 0) {\r\n      return;\r\n    }\r\n    let currentDomain = window.location.hostname;\r\n    let subdomainURL = `bookingdirect.com`;\r\n    if (currentDomain === 'localhost') {\r\n      currentDomain = `localhost:7742`;\r\n    } else {\r\n      currentDomain = `${subdomainURL}`;\r\n    }\r\n\r\n    const { from_date, to_date } = this.dates;\r\n    const { adultCount, childrenCount } = this.guests;\r\n    const fromDate = from_date ? `checkin=${format(from_date, 'yyyy-MM-dd')}` : '';\r\n    const toDate = from_date ? `checkout=${format(to_date, 'yyyy-MM-dd')}` : '';\r\n    const adults = adultCount > 0 ? `adults=${adultCount}` : '';\r\n    const children = childrenCount > 0 ? `children=${childrenCount}` : '';\r\n    const queryParams = [fromDate, toDate, adults, children];\r\n    const queryString = queryParams.filter(param => param !== '').join('&');\r\n    window.open(`http://${currentDomain}?${queryString}`, '_blank');\r\n  }\r\n\r\n  private renderDateTrigger() {\r\n    return (\r\n      <div class=\"date-trigger\" slot=\"trigger\">\r\n        <ir-icons name=\"calendar\" svgClassName=\"size-4\"></ir-icons>\r\n        {this.dates && this.dates.from_date && this.dates.to_date ? (\r\n          <div>\r\n            <p>\r\n              <span>{format(this.dates.from_date, 'dd LLL yyyy')}</span>\r\n              <span>-</span>\r\n              <span>{format(this.dates.to_date, 'dd LLL yyyy')}</span>\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            <p>Your dates</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n  private renderAdultChildTrigger() {\r\n    const { adultCount, childrenCount } = this.guests;\r\n    return (\r\n      <div class=\"guests-trigger\" slot=\"trigger\">\r\n        <ir-icons name=\"user\" svgClassName=\"size-4\"></ir-icons>\r\n        <p class={'guests'}>\r\n          {adultCount > 0 && (\r\n            <span>\r\n              {adultCount} {adultCount === 1 ? localizedWords.entries.Lcz_Adult : localizedWords.entries.Lcz_Adults}\r\n            </span>\r\n          )}\r\n          {childrenCount > 0 && (\r\n            <span>\r\n              , {childrenCount} {childrenCount === 1 ? localizedWords.entries.Lcz_Child : localizedWords.entries.Lcz_Children}\r\n            </span>\r\n          )}\r\n          {adultCount === 0 && <span>number of guests</span>}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.isLoading) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Fragment>\r\n        <div class=\"booking-widget-container\" style={this.contentContainerStyle}>\r\n          <ir-popover class={'ir-popover'} showCloseButton={false} placement=\"auto\" ref={el => (this.popover = el)} onOpenChange={e => (this.isPopoverOpen = e.detail)}>\r\n            {this.renderDateTrigger()}\r\n            <div slot=\"popover-content\" class=\"popup-container w-full border-0 bg-white p-4 pb-6 shadow-none sm:w-auto sm:border sm:p-4 sm:shadow-sm md:p-6 \">\r\n              <ir-date-range\r\n                style={{ '--radius': 'var(--ir-widget-radius)' }}\r\n                fromDate={this.dates?.from_date}\r\n                toDate={this.dates?.to_date}\r\n                locale={localization_store.selectedLocale}\r\n                maxSpanDays={5}\r\n                onDateChange={e => {\r\n                  e.stopImmediatePropagation();\r\n                  e.stopPropagation();\r\n                  const { end, start } = e.detail;\r\n                  if (end && this.isPopoverOpen) {\r\n                    this.popover.toggleVisibility();\r\n                  }\r\n                  this.dates = {\r\n                    from_date: start,\r\n                    to_date: end,\r\n                  };\r\n                }}\r\n              ></ir-date-range>\r\n            </div>\r\n          </ir-popover>\r\n          <ir-popover class={'ir-popover'} showCloseButton={false} placement=\"auto\" onOpenChange={e => (this.isPopoverOpen = e.detail)}>\r\n            {this.renderAdultChildTrigger()}\r\n\r\n            <ir-guest-counter\r\n              slot=\"popover-content\"\r\n              minAdultCount={0}\r\n              maxAdultCount={app_store?.property?.adult_child_constraints.adult_max_nbr}\r\n              maxChildrenCount={app_store?.property?.adult_child_constraints.child_max_nbr}\r\n              childMaxAge={app_store.property?.adult_child_constraints.child_max_age}\r\n              onUpdateCounts={e => (this.guests = e.detail)}\r\n              class={'h-full'}\r\n            ></ir-guest-counter>\r\n          </ir-popover>\r\n          <button class=\"btn-flip\" onClick={this.handleBooknow.bind(this)} data-back=\"Book now\" data-front=\"Book now\">\r\n            {/* <p class=\"book-now px-4 py-[0.625rem] text-white\">Book now</p> */}\r\n          </button>\r\n        </div>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}