{"version":3,"file":"booking.js","sourceRoot":"","sources":["../../src/stores/booking.ts"],"names":[],"mappings":"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","sourcesContent":["import { Booking } from '@/models/booking.dto';\nimport { Agent, BeddingSetup, ISmokingOption, RatePlan, RoomType, Variation } from '@/models/property';\nimport VariationService from '@/services/app/variation.service';\nimport { createStore } from '@stencil/store';\nimport { Moment } from 'moment';\n\nexport interface IRatePlanSelection {\n  reserved: number;\n  visibleInventory: number;\n  infant_nbr: number[];\n  selected_variation: Variation | null;\n  ratePlan: RatePlan;\n  guestName: string[];\n  is_bed_configuration_enabled: boolean;\n  checkoutVariations: Variation[];\n  checkoutBedSelection: string[];\n  checkoutSmokingSelection: string[];\n  roomtype: {\n    id: number;\n    name: string;\n    physicalrooms: null;\n    rateplans: null;\n    availabilities: null;\n    inventory: number;\n    rate: number;\n    smoking_option: ISmokingOption;\n    bedding_setup: BeddingSetup[];\n  };\n}\n\nexport interface IRoomTypeSelection {\n  [ratePlanId: number]: IRatePlanSelection;\n}\nexport interface ISelectedVariation {\n  variation: Variation;\n  state: 'default' | 'modified';\n}\nexport interface IBookinAvailabilityParams {\n  from_date: Moment | null;\n  to_date: Moment | null;\n  adult_nbr: number;\n  child_nbr: number;\n  coupon?: string;\n  agent?: Agent;\n  loyalty?: boolean;\n  agent_code?: string;\n}\ninterface BookingStore {\n  tax_statement: { message: string } | null;\n  roomTypes: RoomType[];\n  enableBooking: boolean;\n  ratePlanSelections: { [roomTypeId: number]: IRoomTypeSelection };\n  bookingAvailabilityParams: IBookinAvailabilityParams;\n  booking: Booking;\n  resetBooking: boolean;\n  isInFreeCancelationZone: boolean;\n  fictus_booking_nbr: { nbr: string | null };\n  childrenAges: string[];\n}\n\nconst initialState: BookingStore = {\n  tax_statement: null,\n  roomTypes: undefined,\n  childrenAges: [],\n  enableBooking: false,\n  resetBooking: false,\n  ratePlanSelections: {},\n  isInFreeCancelationZone: false,\n  bookingAvailabilityParams: {\n    from_date: null,\n    to_date: null,\n    adult_nbr: 0,\n    child_nbr: 0,\n  },\n  booking: null,\n  fictus_booking_nbr: null,\n};\n\nexport const { state: booking_store, onChange: onRoomTypeChange } = createStore<BookingStore>(initialState);\n\nfunction checkVariation(variations: Variation[], selected_variation: Variation): Variation {\n  if (!variations) {\n    return null;\n  }\n  if (!selected_variation || booking_store.resetBooking) {\n    return variations[0];\n  }\n  return variations?.find(v => v.adult_nbr === selected_variation.adult_nbr && v.child_nbr === selected_variation.child_nbr) ?? null;\n}\n\nonRoomTypeChange('roomTypes', (newValue: RoomType[]) => {\n  const currentSelections = booking_store.ratePlanSelections;\n  const ratePlanSelections: { [roomTypeId: number]: IRoomTypeSelection } = {};\n  newValue.forEach(roomType => {\n    if (!roomType.is_active) return;\n    ratePlanSelections[roomType.id] = ratePlanSelections[roomType.id] || {};\n\n    roomType.rateplans.forEach(ratePlan => {\n      if (!ratePlan.is_active || !ratePlan?.variations?.length) return;\n      let lastVariation = ratePlan.variations[ratePlan.variations.length - 1];\n      lastVariation = ratePlan.selected_variation ?? lastVariation;\n      const currentRatePlanSelection = currentSelections[roomType.id]?.[ratePlan.id];\n      ratePlanSelections[roomType.id][ratePlan.id] =\n        currentRatePlanSelection && Object.keys(currentRatePlanSelection).length > 0\n          ? {\n              ...currentRatePlanSelection,\n              ratePlan,\n              selected_variation: checkVariation(ratePlan.variations, currentRatePlanSelection.selected_variation) ?? null,\n              // visibleInventory: roomType.inventory === 1 ? 2 : roomType.inventory,\n              visibleInventory: roomType.inventory,\n              reserved: roomType.inventory === 0 ? 0 : booking_store.resetBooking ? 0 : currentRatePlanSelection.reserved,\n              checkoutVariations: roomType.inventory === 0 ? [] : currentRatePlanSelection.checkoutVariations,\n              checkoutBedSelection: roomType.inventory === 0 ? [] : currentRatePlanSelection.checkoutBedSelection,\n              checkoutSmokingSelection: roomType.inventory === 0 ? [] : currentRatePlanSelection.checkoutSmokingSelection,\n              guestName: roomType.inventory === 0 ? [] : currentRatePlanSelection.guestName,\n              roomtype: {\n                ...currentRatePlanSelection.roomtype,\n              },\n            }\n          : {\n              reserved: 0,\n              infant_nbr: [],\n              // visibleInventory: roomType.inventory === 1 ? 2 : roomType.inventory,\n              visibleInventory: roomType.inventory,\n              selected_variation: ratePlan?.variations[0] ?? null,\n              ratePlan,\n              guestName: [],\n              is_bed_configuration_enabled: roomType.is_bed_configuration_enabled,\n              roomtype: {\n                ...roomType,\n                physicalrooms: null,\n                rateplans: null,\n                availabilities: null,\n              },\n              checkoutVariations: [],\n              checkoutBedSelection: [],\n              checkoutSmokingSelection: [],\n            };\n    });\n  });\n  booking_store.ratePlanSelections = ratePlanSelections;\n  booking_store.resetBooking = false;\n});\n\nexport function updateInventory(roomTypeId: number) {\n  const roomTypeSelection = booking_store.ratePlanSelections[roomTypeId];\n  const calculateTotalSelectedRoomsExcludingIndex = (excludedRatePlanId: number) => {\n    return Object.entries(roomTypeSelection).reduce((acc, [ratePlanId, ratePlan]) => {\n      return Number(ratePlanId) !== excludedRatePlanId ? acc + ratePlan.reserved : acc;\n    }, 0);\n  };\n  const newRatePlans = Object.fromEntries(\n    Object.entries(roomTypeSelection).map(([ratePlanId, ratePlan]) => {\n      const totalSelectedRoomsExcludingCurrent = calculateTotalSelectedRoomsExcludingIndex(Number(ratePlanId));\n      const roomTypeData = booking_store.roomTypes.find(rt => rt.id === roomTypeId);\n      // const availableRooms = roomTypeData ? (roomTypeData.inventory === 1 ? 2 : roomTypeData.inventory) - totalSelectedRoomsExcludingCurrent : 0;\n      const availableRooms = roomTypeData ? roomTypeData.inventory - totalSelectedRoomsExcludingCurrent : 0;\n\n      return [\n        ratePlanId,\n        {\n          ...ratePlan,\n          visibleInventory: availableRooms > 0 ? availableRooms : 0,\n        },\n      ];\n    }),\n  );\n  if (JSON.stringify(roomTypeSelection) !== JSON.stringify(newRatePlans)) {\n    booking_store.ratePlanSelections = {\n      ...booking_store.ratePlanSelections,\n      [roomTypeId]: newRatePlans,\n    };\n  }\n}\nexport function updateRoomParams({ ratePlanId, roomTypeId, params }: { roomTypeId: number; ratePlanId: number; params: Partial<IRatePlanSelection> }) {\n  booking_store.ratePlanSelections = {\n    ...booking_store.ratePlanSelections,\n    [Number(roomTypeId)]: {\n      ...booking_store.ratePlanSelections[Number(roomTypeId)],\n      [ratePlanId]: {\n        ...booking_store.ratePlanSelections[roomTypeId][ratePlanId],\n        ...params,\n      },\n    },\n  };\n}\n\nexport function getPrepaymentAmount() {\n  const variationService = new VariationService();\n  const agent = booking_store.bookingAvailabilityParams.agent;\n  if (agent && agent.payment_mode.code === '001') {\n    return 0;\n  }\n  let total = 0;\n  for (const roomtypeId in booking_store.ratePlanSelections) {\n    for (const rateplanId in booking_store.ratePlanSelections[roomtypeId]) {\n      const rateplan = booking_store.ratePlanSelections[roomtypeId][rateplanId];\n      rateplan.checkoutVariations.map((v, index) => {\n        const variation = variationService.getVariationBasedOnInfants({ baseVariation: v, variations: rateplan.ratePlan.variations, infants: rateplan.infant_nbr[index] });\n        total += variation.prepayment_amount_gross;\n      });\n    }\n  }\n  return total;\n}\n\nexport function reserveRooms(roomTypeId: number, ratePlanId: number, rooms: number) {\n  if (!booking_store.ratePlanSelections[roomTypeId]) {\n    booking_store.ratePlanSelections[roomTypeId] = {};\n  }\n  const roomType = booking_store.roomTypes?.find(r => r.id === roomTypeId);\n  if (!roomType) {\n    throw new Error('Invalid room type id');\n  }\n  const ratePlan = roomType.rateplans.find(r => r.id === ratePlanId);\n  if (!ratePlan) {\n    throw new Error('Invalid rate plan');\n  }\n  if (!booking_store.ratePlanSelections[roomTypeId][ratePlanId]) {\n    booking_store.ratePlanSelections[roomTypeId][ratePlanId] = {\n      guestName: null,\n      reserved: 0,\n      infant_nbr: [],\n      is_bed_configuration_enabled: roomType.is_bed_configuration_enabled,\n      visibleInventory: 0,\n      selected_variation: null,\n      ratePlan,\n      checkoutVariations: [],\n      checkoutBedSelection: [],\n      checkoutSmokingSelection: [],\n      roomtype: {\n        id: roomType.id,\n        name: roomType.name,\n        physicalrooms: null,\n        rateplans: null,\n        availabilities: null,\n        inventory: roomType.inventory,\n        rate: roomType.rate,\n        bedding_setup: roomType.bedding_setup,\n        smoking_option: roomType.smoking_option,\n      },\n    };\n  }\n\n  booking_store.ratePlanSelections = {\n    ...booking_store.ratePlanSelections,\n    [Number(roomTypeId)]: {\n      ...booking_store.ratePlanSelections[Number(roomTypeId)],\n      [ratePlanId]: { ...booking_store.ratePlanSelections[roomTypeId][ratePlanId], reserved: rooms, checkoutVariations: [] },\n    },\n  };\n  updateInventory(roomTypeId);\n}\n\nexport function getVisibleInventory(roomTypeId: number, ratePlanId: number) {\n  if (!booking_store.ratePlanSelections || !booking_store.ratePlanSelections[roomTypeId]) {\n    return { reserved: 0, visibleInventory: 0, selected_variation: null };\n  }\n  return booking_store.ratePlanSelections[roomTypeId][ratePlanId];\n}\n\nexport function modifyBookingStore(key: keyof BookingStore, value: any) {\n  booking_store[key] = value;\n}\n\n// export function calculateTotalCost(gross: boolean = false): { totalAmount: number; prePaymentAmount: number } {\n//   let prePaymentAmount = 0;\n//   let totalAmount = 0;\n//   const variationService = new VariationService();\n//   const calculateCost = (ratePlan: IRatePlanSelection, isPrePayment: boolean = false) => {\n//     if (ratePlan.checkoutVariations.length > 0 && ratePlan.reserved > 0) {\n//       if (isPrePayment) {\n//         return ratePlan.reserved * ratePlan.ratePlan.pre_payment_amount || 0;\n//       }\n//       return ratePlan.checkoutVariations.reduce((sum, variation, index) => {\n//         const infantBasedVariation = variationService.getVariationBasedOnInfants({\n//           variations: ratePlan.ratePlan.variations,\n//           baseVariation: variation,\n//           infants: ratePlan.infant_nbr[index],\n//         });\n//         return sum + Number(infantBasedVariation[gross ? 'discounted_gross_amount' : 'discounted_amount']);\n//       }, 0);\n//     } else if (ratePlan.reserved > 0) {\n//       const amount = isPrePayment ? ratePlan.ratePlan.pre_payment_amount ?? 0 : ratePlan.selected_variation[gross ? 'discounted_gross_amount' : 'discounted_amount'];\n//       return ratePlan.reserved * (amount ?? 0);\n//     }\n//     return 0;\n//   };\n//   Object.values(booking_store.ratePlanSelections).forEach(value => {\n//     Object.values(value).forEach(ratePlan => {\n//       totalAmount += calculateCost(ratePlan);\n//       prePaymentAmount += calculateCost(ratePlan, true);\n//     });\n//   });\n//   return { totalAmount, prePaymentAmount };\n// }\ntype CostCalculationConfig = {\n  gross: boolean;\n  infants: boolean;\n};\nexport function calculateTotalCost(config: CostCalculationConfig = { gross: false, infants: false }): { totalAmount: number } {\n  let totalAmount = 0;\n  const variationService = new VariationService();\n\n  // Helper to calculate cost for a single rate plan\n  const calculateCost = (ratePlan: IRatePlanSelection): number => {\n    if (ratePlan.checkoutVariations.length > 0 && ratePlan.reserved > 0) {\n      let variations: Variation[] = ratePlan.checkoutVariations;\n      if (config.infants) {\n        variations = [\n          ...ratePlan.checkoutVariations.map((variation, index) =>\n            variationService.getVariationBasedOnInfants({\n              variations: ratePlan.ratePlan.variations,\n              baseVariation: variation,\n              infants: ratePlan.infant_nbr[index],\n            }),\n          ),\n        ];\n      }\n\n      return variations.reduce((sum, infantBasedVariation) => {\n        const amount = infantBasedVariation[config.gross ? 'discounted_gross_amount' : 'discounted_amount'] || 0;\n        return sum + amount;\n      }, 0);\n    } else if (ratePlan.reserved > 0) {\n      const amount = ratePlan.selected_variation?.[config.gross ? 'discounted_gross_amount' : 'discounted_amount'] || 0;\n      return amount * ratePlan.reserved;\n    }\n    return 0;\n  };\n\n  // Iterate through rate plan selections\n  Object.values(booking_store.ratePlanSelections).forEach(roomTypeSelection => {\n    Object.values(roomTypeSelection).forEach(ratePlan => {\n      totalAmount += calculateCost(ratePlan);\n    });\n  });\n\n  return { totalAmount };\n}\n// export function validateBooking() {\n//   return Object.values(booking_store.ratePlanSelections).every(roomTypeSelection =>\n//     Object.values(roomTypeSelection).every(ratePlan => ratePlan.guestName.every(name => name.trim() !== '')),\n//   );\n// }\n// export function validateBooking() {\n//   return Object.values(booking_store.ratePlanSelections).every(roomTypeSelection =>\n//     Object.values(roomTypeSelection).every(ratePlan => {\n//       console.log(ratePlan);\n//       return (\n//         (ratePlan.guestName.every(name => name.trim() !== '') &&\n//           (!ratePlan.is_bed_configuration_enabled || ratePlan.checkoutBedSelection.every(selection => selection !== '-1'))) ||\n//         Number(ratePlan.infant_nbr) !== -1\n//       );\n//     }),\n//   );\n// }\n\nexport function validateBooking() {\n  return Object.values(booking_store.ratePlanSelections).every(roomTypeSelection =>\n    Object.values(roomTypeSelection).every(ratePlan => {\n      // console.log(ratePlan);\n      console.log({\n        ratePlan,\n        'Check guestName: All names must be non-empty': ratePlan.guestName.every(name => name.trim() !== ''),\n        'Check bed configuration: If enabled, all selections must be valid':\n          !ratePlan.is_bed_configuration_enabled || ratePlan.checkoutBedSelection.every(selection => selection !== '-1'),\n        'Check infant_nbr: Must be greater than -1': ratePlan.infant_nbr.every(nb => Number(nb) > -1),\n      });\n      return (\n        // Check guestName: All names must be non-empty\n        ratePlan.guestName.every(name => name.trim() !== '') &&\n        // Check bed configuration: If enabled, all selections must be valid\n        (!ratePlan.is_bed_configuration_enabled || ratePlan.checkoutBedSelection.every(selection => selection !== '-1')) &&\n        // Check infant_nbr: Must be greater than -1\n        ratePlan.infant_nbr.every(nb => Number(nb) > -1)\n      );\n    }),\n  );\n}\nexport function calculateTotalRooms() {\n  return Object.values(booking_store.ratePlanSelections).reduce((total, value) => {\n    return (\n      total +\n      Object.values(value).reduce((innerTotal, ratePlan) => {\n        if (ratePlan.reserved === 0) {\n          return innerTotal;\n        }\n        return innerTotal + ratePlan.reserved;\n      }, 0)\n    );\n  }, 0);\n}\nexport function clearCheckoutRooms() {\n  booking_store.ratePlanSelections = Object.fromEntries(\n    Object.entries(booking_store.ratePlanSelections).map(([roomTypeId, roomTypeSelection]) => [\n      roomTypeId,\n      Object.fromEntries(\n        Object.entries(roomTypeSelection).map(([ratePlanId, ratePlan]) => [\n          ratePlanId,\n          {\n            ...ratePlan,\n            checkoutVariations: [],\n            checkoutBedSelection: [],\n            checkoutSmokingSelection: [],\n          },\n        ]),\n      ),\n    ]),\n  );\n}\nexport default booking_store;\n"]}