{"version":3,"file":"ir-language-picker.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-engine/ir-nav/ir-language-picker/ir-language-picker.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ICurrency, IExposedLanguages } from '@/models/common';\r\nimport app_store, { changeLocale, onAppDataChange, updateUserPreference } from '@/stores/app.store';\r\nimport { cn, matchLocale } from '@/utils/utils';\r\nimport { Component, h, Event, EventEmitter, Prop, State } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-language-picker',\r\n  styleUrl: 'ir-language-picker.css',\r\n  shadow: true,\r\n})\r\nexport class IrLanguagePicker {\r\n  @Prop() currencies: ICurrency[];\r\n  @Prop() languages: IExposedLanguages[];\r\n\r\n  @State() selectedOptions: {\r\n    currency: ICurrency;\r\n    language: IExposedLanguages;\r\n  };\r\n\r\n  @Event() closeDialog: EventEmitter<null>;\r\n  @Event() resetBooking: EventEmitter<null>;\r\n\r\n  langEl: HTMLButtonElement[] = [];\r\n  selectedIndex: number = 0;\r\n\r\n  async componentWillLoad() {\r\n    await this.init();\r\n    onAppDataChange('userPreferences', newValue => {\r\n      this.selectedOptions = { language: this.languages.find(l => l.code === newValue.language_id), currency: this.currencies.find(l => l.code === newValue.currency_id) };\r\n    });\r\n  }\r\n  componentDidLoad() {\r\n    const index = this.languages.findIndex(l => l.code === this.selectedOptions.language.code);\r\n    if (index !== -1) {\r\n      this.langEl[index]?.focus();\r\n    }\r\n  }\r\n  async init() {\r\n    if (this.languages && this.currencies) {\r\n      this.selectedOptions = {\r\n        language: this.languages[0],\r\n        currency: this.currencies[0],\r\n      };\r\n    }\r\n  }\r\n\r\n  handleLanguageChange(id: string) {\r\n    this.selectedOptions = { ...this.selectedOptions, language: this.languages.find(l => l.code === id) };\r\n  }\r\n  handleCurrencyChange(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const id = e.detail;\r\n    this.selectedOptions = { ...this.selectedOptions, currency: this.currencies.find(l => l.code === id) };\r\n  }\r\n  handleConfirm(e: MouseEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    changeLocale(this.selectedOptions.language.direction, matchLocale(this.selectedOptions.language.code));\r\n    updateUserPreference({\r\n      currency_id: this.selectedOptions.currency.code,\r\n      language_id: this.selectedOptions.language.code,\r\n    });\r\n    localStorage.setItem(\r\n      'user_prefernce',\r\n      JSON.stringify({\r\n        currency_id: this.selectedOptions.currency.code,\r\n        language_id: this.selectedOptions.language.code,\r\n        direction: this.selectedOptions.language.direction,\r\n      }),\r\n    );\r\n    if (app_store.currentPage === 'checkout') {\r\n      this.resetBooking.emit(null);\r\n    }\r\n    this.closeDialog.emit(null);\r\n  }\r\n  handleKeyDown(e: KeyboardEvent) {\r\n    const index = this.selectedIndex;\r\n    const lastIndex = this.languages.length - 1;\r\n    let itemsPerRow = 4;\r\n    if (window.innerWidth < 640) {\r\n      itemsPerRow = 3;\r\n    }\r\n    if (e.key === 'ArrowRight') {\r\n      e.preventDefault();\r\n      const nextIndex = index === lastIndex ? 0 : index + 1;\r\n      this.selectedIndex = nextIndex;\r\n      this.langEl[nextIndex].focus();\r\n    } else if (e.key === 'ArrowLeft') {\r\n      e.preventDefault();\r\n      const prevIndex = index === 0 ? lastIndex : index - 1;\r\n      this.selectedIndex = prevIndex;\r\n      this.langEl[prevIndex].focus();\r\n    } else if (e.key === 'ArrowUp') {\r\n      e.preventDefault();\r\n      const prevIndex = index < itemsPerRow ? lastIndex - (itemsPerRow - 1 - index) : index - itemsPerRow;\r\n      if (prevIndex >= 0 && prevIndex <= lastIndex) {\r\n        this.selectedIndex = prevIndex;\r\n        this.langEl[prevIndex].focus();\r\n      }\r\n    } else if (e.key === 'ArrowDown') {\r\n      e.preventDefault();\r\n      const nextIndex = index + itemsPerRow > lastIndex ? (index + itemsPerRow) % itemsPerRow : index + itemsPerRow;\r\n      if (nextIndex >= 0 && nextIndex <= lastIndex) {\r\n        this.selectedIndex = nextIndex;\r\n        this.langEl[nextIndex].focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"p-4 sm:px-6\">\r\n        <p class=\"title mb-5\">Display settings</p>\r\n        <div\r\n          role=\"radiogroup\"\r\n          aria-required=\"false\"\r\n          aria-label=\"booking engine language\"\r\n          onKeyDown={e => this.handleKeyDown(e)}\r\n          class=\"mb-6 grid grid-cols-3 gap-2.5 outline-none sm:grid-cols-4\"\r\n          tabIndex={0}\r\n        >\r\n          {this.languages.map((language, i) => (\r\n            <button\r\n              ref={el => (this.langEl[i] = el)}\r\n              type=\"button\"\r\n              role=\"radio\"\r\n              tabIndex={0}\r\n              value={language.code}\r\n              aria-labelledby={language.description}\r\n              aria-checked={this.selectedOptions?.language.code === language.code ? 'true' : 'false'}\r\n              onClick={() => this.handleLanguageChange(language.code)}\r\n              class={cn('flex items-center gap-3 rounded-sm px-2 py-2 pr-4 transition-colors duration-300 ease-in-out hover:bg-[hsla(var(--brand-100),13%)]', {\r\n                'bg-[hsla(var(--brand-100),8%)]': this.selectedOptions?.language.code === language.code,\r\n              })}\r\n            >\r\n              <img src={language['flag']} alt={language.code} class={'size-4 rounded-full'}></img>\r\n              <span> {language.description}</span>\r\n\r\n              <input\r\n                type=\"radio\"\r\n                aria-hidden=\"true\"\r\n                tabindex=\"-1\"\r\n                checked={this.selectedOptions?.language.code === language.code ? true : false}\r\n                value={language.code}\r\n                class={'hidden'}\r\n              ></input>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <ir-select\r\n          variant=\"double-line\"\r\n          value={app_store.userPreferences.currency_id}\r\n          onValueChange={this.handleCurrencyChange.bind(this)}\r\n          label=\"Currency\"\r\n          select_id=\"currency_selector\"\r\n          data={this.currencies.map(currency => ({\r\n            id: currency.code,\r\n            value: `${currency.code} ${currency.symbol}`,\r\n          }))}\r\n        ></ir-select>\r\n        <div class=\"mt-8 flex w-full flex-col  gap-4 md:flex-row-reverse\">\r\n          <ir-button size=\"md\" label=\"Confirm\" class=\"w-full md:w-fit\" onClick={this.handleConfirm.bind(this)}></ir-button>\r\n          <ir-button onButtonClick={() => this.closeDialog.emit(null)} size=\"md\" label=\"Cancel\" variants=\"outline\" class=\"w-full md:w-fit\"></ir-button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]}