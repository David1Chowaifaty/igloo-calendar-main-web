{"version":3,"file":"ir-signin.js","sourceRoot":"","sources":["../../../../../../src/components/ir-booking-engine/ir-nav/ir-auth/ir-signin/ir-signin.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\r\nimport { SignInValidtor, TSignInAuthTrigger, TSignInValidator } from '@/validators/auth.validator';\r\nimport { ZodError } from 'zod';\r\nimport { AuthService } from '@/services/api/auth.service';\r\nimport app_store from '@/stores/app.store';\r\nimport { TAuthNavigation } from '../auth.types';\r\n\r\n@Component({\r\n  tag: 'ir-signin',\r\n  styleUrl: 'ir-signin.css',\r\n  scoped: true,\r\n})\r\nexport class IrSignin {\r\n  @Prop() enableSignUp: boolean = true;\r\n  @State() signInParams: TSignInValidator = {};\r\n  @State() formState: {\r\n    cause: 'zod' | 'auth' | null;\r\n    status: 'empty' | 'valid' | 'invalid';\r\n    errors: Record<keyof TSignInValidator, string> | null;\r\n  } = { cause: null, errors: null, status: 'empty' };\r\n  @Event() authFinish: EventEmitter<{ state: 'success' | 'failed'; token: string }>;\r\n  @Event() navigate: EventEmitter<TAuthNavigation>;\r\n  @Event() signIn: EventEmitter<TSignInAuthTrigger>;\r\n\r\n  private authService = new AuthService();\r\n\r\n  componentWillLoad() {\r\n    this.authService.setToken(app_store.app_data.token);\r\n  }\r\n\r\n  modifySignInParams(params: Partial<TSignInValidator>) {\r\n    if (!this.signInParams) {\r\n      this.signInParams = {};\r\n    }\r\n    this.signInParams = { ...this.signInParams, ...params };\r\n  }\r\n\r\n  async login(params: { email?: string; password?: string }) {\r\n    try {\r\n      const token = await this.authService.login({ ...params, password: '' }, params.password);\r\n      this.authFinish.emit({ state: 'success', token });\r\n    } catch (error) {\r\n      this.authFinish.emit({ state: 'failed', token: null });\r\n      this.formState = {\r\n        cause: 'auth',\r\n        status: 'invalid',\r\n        errors: { email: error.message, password: error.message },\r\n      };\r\n    }\r\n  }\r\n  async handleSignIn(e: Event) {\r\n    e.preventDefault();\r\n    try {\r\n      this.formState.errors = null;\r\n      const params = SignInValidtor.parse(this.signInParams);\r\n      this.signIn.emit({ trigger: 'be', params });\r\n      await this.login(params);\r\n    } catch (error) {\r\n      let newErrors: Record<keyof TSignInValidator, string> = {\r\n        email: null,\r\n        password: null,\r\n      };\r\n      if (error instanceof ZodError) {\r\n        error.issues.map(e => {\r\n          newErrors[e.path[0]] = e.message;\r\n        });\r\n        this.formState = {\r\n          cause: 'zod',\r\n          status: 'invalid',\r\n          errors: { ...newErrors },\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <h1 class=\"title mb-4\">Sign in to your account</h1>\r\n        <form onSubmit={this.handleSignIn.bind(this)} class=\"mb-8 space-y-4 \">\r\n          {this.formState?.cause === 'auth' && this.formState?.errors && (\r\n            <div class=\"mx-auto\">\r\n              <ir-badge-group variant=\"error\" badge=\"Error\" message={this.formState?.errors?.email ?? ''}></ir-badge-group>\r\n            </div>\r\n          )}\r\n          <fieldset class=\"mb-5\">\r\n            <ir-input\r\n              error={!!this.formState?.errors?.email}\r\n              onTextChanged={e => this.modifySignInParams({ email: e.detail })}\r\n              autofocus\r\n              inputId=\"email\"\r\n              label=\"Enter your email\"\r\n            ></ir-input>\r\n          </fieldset>\r\n          <fieldset>\r\n            <ir-input\r\n              error={!!this.formState?.errors?.password}\r\n              onTextChanged={e => this.modifySignInParams({ password: e.detail })}\r\n              inputId=\"password\"\r\n              type=\"password\"\r\n              label=\"Enter your password \"\r\n            ></ir-input>\r\n          </fieldset>\r\n          <div class=\"my-6 flex justify-end\">\r\n            <ir-button type=\"button\" variants=\"ghost-primary\" label=\"Forgot password\"></ir-button>\r\n          </div>\r\n          <ir-button type=\"submit\" class=\"w-full\" label=\"Sign in\" size=\"md\"></ir-button>\r\n          <div class=\"mb-4 flex items-center justify-center gap-4\">\r\n            <div class=\"h-[1px] w-[45%] bg-[var(--gray-200)]\"></div>\r\n            <span class=\"text-[var(--gray-500)]\">OR</span>\r\n            <div class=\"h-[1px] w-[45%] bg-[var(--gray-200)]\"></div>\r\n          </div>\r\n          <ir-social-button class=\"w-full\" onSocialButtonClick={() => this.signIn.emit({ trigger: 'google' })} label=\"Continue with Google\">\r\n            <span slot=\"icon\">\r\n              <svg width=\"25\" height=\"24\" viewBox=\"0 0 25 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <g clip-path=\"url(#clip0_6707_5591)\">\r\n                  <path\r\n                    d=\"M24.266 12.2765C24.266 11.4608 24.1999 10.6406 24.0588 9.83813H12.74V14.4591H19.2217C18.9528 15.9495 18.0885 17.2679 16.823 18.1056V21.104H20.69C22.9608 19.014 24.266 15.9274 24.266 12.2765Z\"\r\n                    fill=\"#4285F4\"\r\n                  />\r\n                  <path\r\n                    d=\"M12.74 24.0008C15.9764 24.0008 18.7058 22.9382 20.6944 21.1039L16.8274 18.1055C15.7516 18.8375 14.3626 19.252 12.7444 19.252C9.61376 19.252 6.95934 17.1399 6.00693 14.3003H2.01648V17.3912C4.05359 21.4434 8.20278 24.0008 12.74 24.0008Z\"\r\n                    fill=\"#34A853\"\r\n                  />\r\n                  <path\r\n                    d=\"M6.00253 14.3002C5.49987 12.8099 5.49987 11.196 6.00253 9.70569V6.61475H2.01649C0.31449 10.0055 0.31449 14.0004 2.01649 17.3912L6.00253 14.3002Z\"\r\n                    fill=\"#FBBC04\"\r\n                  />\r\n                  <path\r\n                    d=\"M12.74 4.74966C14.4508 4.7232 16.1043 5.36697 17.3433 6.54867L20.7694 3.12262C18.6 1.0855 15.7207 -0.034466 12.74 0.000808666C8.20277 0.000808666 4.05359 2.55822 2.01648 6.61481L6.00252 9.70575C6.95052 6.86173 9.60935 4.74966 12.74 4.74966Z\"\r\n                    fill=\"#EA4335\"\r\n                  />\r\n                </g>\r\n                <defs>\r\n                  <clipPath id=\"clip0_6707_5591\">\r\n                    <rect width=\"24\" height=\"24\" fill=\"white\" transform=\"translate(0.5)\" />\r\n                  </clipPath>\r\n                </defs>\r\n              </svg>\r\n            </span>\r\n          </ir-social-button>\r\n          <ir-social-button onSocialButtonClick={() => this.signIn.emit({ trigger: 'fb' })} class=\"w-full outline\" label=\"Continue with Facebook\">\r\n            <svg slot=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <g clip-path=\"url(#clip0_1256_132001)\">\r\n                <path\r\n                  d=\"M24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 17.9895 4.3882 22.954 10.125 23.8542V15.4688H7.07812V12H10.125V9.35625C10.125 6.34875 11.9166 4.6875 14.6576 4.6875C15.9701 4.6875 17.3438 4.92188 17.3438 4.92188V7.875H15.8306C14.34 7.875 13.875 8.80008 13.875 9.75V12H17.2031L16.6711 15.4688H13.875V23.8542C19.6118 22.954 24 17.9895 24 12Z\"\r\n                  fill=\"#1877F2\"\r\n                />\r\n                <path\r\n                  d=\"M16.6711 15.4688L17.2031 12H13.875V9.75C13.875 8.80102 14.34 7.875 15.8306 7.875H17.3438V4.92188C17.3438 4.92188 15.9705 4.6875 14.6576 4.6875C11.9166 4.6875 10.125 6.34875 10.125 9.35625V12H7.07812V15.4688H10.125V23.8542C11.3674 24.0486 12.6326 24.0486 13.875 23.8542V15.4688H16.6711Z\"\r\n                  fill=\"white\"\r\n                />\r\n              </g>\r\n              <defs>\r\n                <clipPath id=\"clip0_1256_132001\">\r\n                  <rect width=\"24\" height=\"24\" fill=\"white\" />\r\n                </clipPath>\r\n              </defs>\r\n            </svg>\r\n          </ir-social-button>\r\n        </form>\r\n        {this.enableSignUp && (\r\n          <div class=\"flex items-center justify-center\">\r\n            <p class=\"dont-have-an-account\">Don't have an account?</p>\r\n            <ir-button label=\"Sign up\" variants=\"ghost-primary\" onButtonClick={() => this.navigate.emit('register')}></ir-button>\r\n          </div>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}