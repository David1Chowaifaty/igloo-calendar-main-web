{"version":3,"file":"ir-auth.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-engine/ir-nav/ir-auth/ir-auth.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, Listen, State, h, Element, Event, EventEmitter, Prop } from '@stencil/core';\r\nimport { TAuthNavigation } from './auth.types';\r\nimport { AuthService } from '@/services/api/auth.service';\r\nimport app_store from '@/stores/app.store';\r\n\r\n@Component({\r\n  tag: 'ir-auth',\r\n  styleUrl: 'ir-auth.css',\r\n  scoped: true,\r\n})\r\nexport class IrAuth {\r\n  @Element() el: HTMLElement;\r\n  @Prop() enableSignUp: boolean = true;\r\n  @State() authState: TAuthNavigation = 'login';\r\n  @State() animationDirection: string = '';\r\n  @State() signedIn: boolean = false;\r\n\r\n  @Event() closeDialog: EventEmitter<null>;\r\n\r\n  private authService = new AuthService();\r\n  private googleButtonWrapper: any;\r\n\r\n  componentWillLoad() {\r\n    // this.authService.initializeFacebookSignIn();\r\n    if (!document.querySelector('.custom-google-button') && !app_store.app_data.hideGoogleSignIn) {\r\n      this.authService.loadGoogleSignInScript(this.googleButtonWrapper);\r\n    }\r\n    this.authService.subscribe(this.handleAuthStateChange.bind(this));\r\n  }\r\n\r\n  @Listen('navigate')\r\n  handleNavigation(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n\r\n    if (this.authState === 'login' && e.detail !== 'login') {\r\n      this.animationDirection = 'slide-right';\r\n    } else if (this.authState !== 'login' && e.detail === 'login') {\r\n      this.animationDirection = 'slide-left';\r\n    }\r\n\r\n    this.authState = e.detail;\r\n  }\r\n  @Listen('authFinish')\r\n  handleAuthFinished(e: CustomEvent) {\r\n    const { state } = e.detail;\r\n    if (state === 'success') {\r\n      this.closeDialog.emit(null);\r\n    }\r\n  }\r\n  signUp(params: { email?: string; password?: string; first_name?: string; last_name?: string }) {\r\n    try {\r\n      this.authService.signUp(params);\r\n    } catch (error) {\r\n      console.error('Error during sign-up:', error);\r\n    }\r\n  }\r\n  private handleAuthStateChange(result) {\r\n    if (result.state === 'success' && result.payload.method === 'google') {\r\n      this.closeDialog.emit(null);\r\n    }\r\n  }\r\n  disconnectedCallback() {\r\n    this.authService.unsubscribe(this.handleAuthStateChange.bind(this));\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class={`auth-container  ${this.animationDirection}`}>\r\n          {this.authState === 'login' ? (\r\n            <ir-signin\r\n              enableSignUp={this.enableSignUp}\r\n              onSignIn={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                if (e.detail.trigger === 'fb') {\r\n                  this.authService.loginWithFacebook();\r\n                }\r\n              }}\r\n            ></ir-signin>\r\n          ) : (\r\n            <ir-signup\r\n              onSignUp={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                if (e.detail.trigger === 'be') {\r\n                  this.signUp(e.detail.params);\r\n                } else if (e.detail.trigger === 'fb') {\r\n                  this.authService.loginWithFacebook();\r\n                }\r\n              }}\r\n            ></ir-signup>\r\n          )}\r\n          {!app_store.app_data.hideGoogleSignIn && (\r\n            <div class=\"flex-container\">\r\n              <div class=\"flex-center\">\r\n                <div id=\"googleSignInButton\"></div>\r\n              </div>\r\n              <div class=\"social-container\">\r\n                <ir-button\r\n                  ref={el => (this.googleButtonWrapper = el)}\r\n                  class=\"full-width\"\r\n                  onButtonClick={() => (window as any).handleGoogleLogin()}\r\n                  label=\"Continue with Google\"\r\n                  variants=\"outline\"\r\n                  haveLeftIcon\r\n                >\r\n                  <span slot=\"left-icon\">\r\n                    <svg width=\"25\" height=\"24\" viewBox=\"0 0 25 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                      <g clip-path=\"url(#clip0_6707_5591)\">\r\n                        <path\r\n                          d=\"M24.266 12.2765C24.266 11.4608 24.1999 10.6406 24.0588 9.83813H12.74V14.4591H19.2217C18.9528 15.9495 18.0885 17.2679 16.823 18.1056V21.104H20.69C22.9608 19.014 24.266 15.9274 24.266 12.2765Z\"\r\n                          fill=\"#4285F4\"\r\n                        />\r\n                        <path\r\n                          d=\"M12.74 24.0008C15.9764 24.0008 18.7058 22.9382 20.6944 21.1039L16.8274 18.1055C15.7516 18.8375 14.3626 19.252 12.7444 19.252C9.61376 19.252 6.95934 17.1399 6.00693 14.3003H2.01648V17.3912C4.05359 21.4434 8.20278 24.0008 12.74 24.0008Z\"\r\n                          fill=\"#34A853\"\r\n                        />\r\n                        <path\r\n                          d=\"M6.00253 14.3002C5.49987 12.8099 5.49987 11.196 6.00253 9.70569V6.61475H2.01649C0.31449 10.0055 0.31449 14.0004 2.01649 17.3912L6.00253 14.3002Z\"\r\n                          fill=\"#FBBC04\"\r\n                        />\r\n                        <path\r\n                          d=\"M12.74 4.74966C14.4508 4.7232 16.1043 5.36697 17.3433 6.54867L20.7694 3.12262C18.6 1.0855 15.7207 -0.034466 12.74 0.000808666C8.20277 0.000808666 4.05359 2.55822 2.01648 6.61481L6.00252 9.70575C6.95052 6.86173 9.60935 4.74966 12.74 4.74966Z\"\r\n                          fill=\"#EA4335\"\r\n                        />\r\n                      </g>\r\n                      <defs>\r\n                        <clipPath id=\"clip0_6707_5591\">\r\n                          <rect width=\"24\" height=\"24\" fill=\"white\" transform=\"translate(0.5)\" />\r\n                        </clipPath>\r\n                      </defs>\r\n                    </svg>\r\n                  </span>\r\n                </ir-button>\r\n                {/* <ir-social-button class=\"full-width\" label=\"Continue with Facebook\" onSocialButtonClick={() => this.authService.loginWithFacebook()}>\r\n                <svg slot=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                  <g clip-path=\"url(#clip0_1256_132001)\">\r\n                    <path\r\n                      d=\"M24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 17.9895 4.3882 22.954 10.125 23.8542V15.4688H7.07812V12H10.125V9.35625C10.125 6.34875 11.9166 4.6875 14.6576 4.6875C15.9701 4.6875 17.3438 4.92188 17.3438 4.92188V7.875H15.8306C14.34 7.875 13.875 8.80008 13.875 9.75V12H17.2031L16.6711 15.4688H13.875V23.8542C19.6118 22.954 24 17.9895 24 12Z\"\r\n                      fill=\"#1877F2\"\r\n                    />\r\n                    <path\r\n                      d=\"M16.6711 15.4688L17.2031 12H13.875V9.75C13.875 8.80102 14.34 7.875 15.8306 7.875H17.3438V4.92188C17.3438 4.92188 15.9705 4.6875 14.6576 4.6875C11.9166 4.6875 10.125 6.34875 10.125 9.35625V12H7.07812V15.4688H10.125V23.8542C11.3674 24.0486 12.6326 24.0486 13.875 23.8542V15.4688H16.6711Z\"\r\n                      fill=\"white\"\r\n                    />\r\n                  </g>\r\n                  <defs>\r\n                    <clipPath id=\"clip0_1256_132001\">\r\n                      <rect width=\"24\" height=\"24\" fill=\"white\" />\r\n                    </clipPath>\r\n                  </defs>\r\n                </svg>\r\n              </ir-social-button> */}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}