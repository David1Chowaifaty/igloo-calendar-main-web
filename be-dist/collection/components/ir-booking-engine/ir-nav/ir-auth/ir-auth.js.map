{"version":3,"file":"ir-auth.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-engine/ir-nav/ir-auth/ir-auth.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, Listen, State, h, Element, Event, EventEmitter, Prop } from '@stencil/core';\r\nimport { TAuthNavigation } from './auth.types';\r\nimport { AuthService } from '@/services/api/auth.service';\r\nimport app_store from '@/stores/app.store';\r\n\r\n@Component({\r\n  tag: 'ir-auth',\r\n  styleUrl: 'ir-auth.css',\r\n  shadow: true,\r\n})\r\nexport class IrAuth {\r\n  @Element() el: HTMLElement;\r\n  @Prop() enableSignUp: boolean = true;\r\n  @State() authState: TAuthNavigation = 'login';\r\n  @State() animationDirection: string = '';\r\n\r\n  @State() signedIn: boolean = false;\r\n\r\n  @Event() closeDialog: EventEmitter<null>;\r\n  @Event() authFinish: EventEmitter<{ state: 'success' | 'failed'; token: string }>;\r\n\r\n  // @Event() onSignIn: EventEmitter;\r\n  // @Event() onSignOut: EventEmitter;\r\n\r\n  private authService = new AuthService();\r\n  googleButton: HTMLDivElement;\r\n  // private signInDiv: HTMLDivElement;\r\n  //private googleTrigger: HTMLDivElement;\r\n\r\n  componentWillLoad() {\r\n    this.authService.setToken(app_store.app_data.token);\r\n  }\r\n  componentDidLoad() {\r\n    window.fbAsyncInit = () => {\r\n      FB.init({\r\n        appId: '1630011277802654',\r\n        xfbml: true,\r\n        version: 'v19.0',\r\n      });\r\n\r\n      FB.AppEvents.logPageView();\r\n    };\r\n\r\n    (function (d, s, id) {\r\n      var js,\r\n        fjs = d.getElementsByTagName(s)[0];\r\n      if (d.getElementById(id)) {\r\n        return;\r\n      }\r\n      js = d.createElement(s);\r\n      js.id = id;\r\n      js.src = 'https://connect.facebook.net/en_US/sdk.js';\r\n      fjs.parentNode.insertBefore(js, fjs);\r\n    })(document, 'script', 'facebook-jssdk');\r\n  }\r\n  handleCredentialResponse(response: any) {\r\n    console.log('Encoded JWT ID token: ' + response.credential);\r\n  }\r\n\r\n  handleSignOut = () => {\r\n    const auth2 = window.gapi.auth2.getAuthInstance();\r\n    auth2.signOut().then(() => {\r\n      this.signedIn = false;\r\n      // this.onSignOut.emit();\r\n    });\r\n  };\r\n\r\n  async loginWithFacebook() {\r\n    FB.login(response => {\r\n      if (response.authResponse) {\r\n        console.log('Welcome!  Fetching your information.... ');\r\n        FB.api('/me', response => {\r\n          console.log('Good to see you, ' + response.name + '.', response);\r\n        });\r\n      } else {\r\n        console.log('User cancelled login or did not fully authorize.');\r\n      }\r\n    });\r\n    FB.getLoginStatus(response => {\r\n      console.log('login status', response);\r\n    });\r\n  }\r\n\r\n  @Listen('navigate')\r\n  handleNavigation(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n\r\n    if (this.authState === 'login' && e.detail !== 'login') {\r\n      this.animationDirection = 'slide-right';\r\n    } else if (this.authState !== 'login' && e.detail === 'login') {\r\n      this.animationDirection = 'slide-left';\r\n    }\r\n\r\n    this.authState = e.detail;\r\n  }\r\n\r\n  signUp(params: { email?: string; password?: string; first_name?: string; last_name?: string }) {\r\n    try {\r\n      const res = this.authService.signUp(params);\r\n      console.log(res);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  onSignIn = googleUser => {\r\n    var profile = googleUser.getBasicProfile();\r\n    console.log(profile);\r\n    // Access profile information (e.g., profile.getId(), profile.getName(), etc.)\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class={`auth-container ${this.animationDirection} p-4 sm:p-6`}>\r\n          {/* <div id=\"buttonDiv\" ref={el => (this.googleTrigger = el)}></div> */}\r\n\r\n          {this.authState === 'login' ? (\r\n            <ir-signin\r\n              // onAuthFinish={e => {\r\n              //   console.log(e.detail);\r\n              //   this.authFinish.emit(e.detail);\r\n              // }}\r\n              enableSignUp={this.enableSignUp}\r\n              onSignIn={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                if (e.detail.trigger === 'fb') {\r\n                  return this.loginWithFacebook();\r\n                } else if (e.detail.trigger === 'google') {\r\n                  return;\r\n                }\r\n              }}\r\n            ></ir-signin>\r\n          ) : (\r\n            <ir-signup\r\n              onSignUp={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                if (e.detail.trigger === 'be') {\r\n                  return this.signUp(e.detail.params);\r\n                } else if (e.detail.trigger === 'fb') {\r\n                  return this.loginWithFacebook();\r\n                }\r\n                return;\r\n              }}\r\n            ></ir-signup>\r\n          )}\r\n          {/* <div class=\"g-signin2\" data-onsuccess=\"onSignIn\"></div>\r\n          <div\r\n            id=\"g_id_onload\"\r\n            data-client_id=\"http://1035240403483-60urt17notg4vmvjbq739p0soqup0o87.apps.googleusercontent.com\"\r\n            data-context=\"use\"\r\n            data-ux_mode=\"popup\"\r\n            data-callback=\"handleCallback\"\r\n            data-auto_prompt=\"false\"\r\n          ></div>\r\n\r\n          <div class=\"g_id_signin\" data-type=\"standard\" data-shape=\"rectangular\" data-theme=\"outline\" data-text=\"signin_with\" data-size=\"large\" data-logo_alignment=\"left\"></div> */}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}