{"version":3,"file":"ir-rateplan.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-engine/ir-booking-page/ir-rateplan/ir-rateplan.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAgB,QAAQ,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AAElF,OAAO,SAAS,MAAM,oBAAoB,CAAC;AAC3C,OAAO,EAAsB,YAAY,EAAE,gBAAgB,EAAE,MAAM,kBAAkB,CAAC;AACtF,OAAO,EAAE,EAAE,EAAE,YAAY,EAAE,MAAM,eAAe,CAAC;AAOjD,MAAM,OAAO,UAAU;;;;;;;IAcrB,qBAAqB,CAAC,CAAc,EAAE,UAAuB,EAAE,UAAkB,EAAE,UAAkB;QACnG,CAAC,CAAC,wBAAwB,EAAE,CAAC;QAC7B,CAAC,CAAC,eAAe,EAAE,CAAC;QACpB,MAAM,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC;QACvB,MAAM,iBAAiB,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,KAAK,KAAK,CAAC,CAAC;QACjG,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QAC/B,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACvB,OAAO;QACT,CAAC;QACD,gBAAgB,CAAC,EAAE,MAAM,EAAE,EAAE,kBAAkB,EAAE,iBAAiB,EAAE,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;IAC9G,CAAC;IACD,MAAM;;QACJ,OAAO,CACL,4DAAK,KAAK,EAAC,sGAAsG;YAC/G,4DACE,KAAK,EAAE,EAAE,CAAC,uDAAuD,EAAE;oBACjE,gBAAgB,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW;oBAC5C,eAAe,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW;iBAC3C,CAAC;gBAEF,0DAAG,KAAK,EAAC,4BAA4B;oBACnC,6DAAM,KAAK,EAAC,WAAW,IAAE,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAQ;oBACzD,6DAAM,KAAK,EAAC,yCAAyC,IAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAQ,CACtF;gBAEJ,4DAAK,KAAK,EAAC,kCAAkC;oBAC3C,0DAAG,KAAK,EAAC,aAAa,IAAE,YAAY,CAAC,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,MAAM,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,CAAK;oBACnI,0DAAG,KAAK,EAAC,uCAAuC,IAC7C,YAAY,CAAC,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,qBAAqB,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,CACpH,CACA,CACF;YAEN,0DAAG,KAAK,EAAE,EAAE,CAAC,2EAA2E,EAAE,WAAW,CAAC,IAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAK;YAEvI,4DACE,KAAK,EAAE,EAAE,CAAC,2IAA2I,EAAE;oBACrJ,eAAe,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW;oBAC3C,eAAe,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW;iBAC3C,CAAC;gBAEF,4DAAK,KAAK,EAAE,EAAE,CAAC,eAAe,CAAC;oBAC7B,kEACE,KAAK,EAAC,kBAAkB,EACxB,KAAK,EAAC,WAAW,EACjB,KAAK,EAAE,CAAC,CAAA,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,SAAS,KAAG,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,SAAS,CAAA,CAAC,CAAC,QAAQ,EAAE,EAC/H,aAAa,EAAE,CAAC,CAAC,EAAE;4BACjB,IAAI,CAAC,qBAAqB,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;wBAC7F,CAAC,EACD,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;4BACvC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE;4BAC1C,KAAK,EAAE,CAAC,CAAC,oBAAoB;yBAC9B,CAAC,CAAC,GACQ;oBACb,4DAAK,KAAK,EAAC,mCAAmC;wBAC5C,qFAA6B;wBAC7B,mEAAY,KAAK,EAAC,gDAAgD,EAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAe,CACnJ,CACF;gBAEN,4DAAK,KAAK,EAAC,4DAA4D;oBACrE,EAAC,QAAQ;wBACP,0DAAG,KAAK,EAAC,0BAA0B,IAAE,YAAY,CAAC,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,qBAAqB,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,CAAK;wBAC/J,0DAAG,KAAK,EAAC,2BAA2B;kCAAI,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB;+BAAE,YAAY,CAAK,CAC3F,CACP;gBAEN,4DAAK,KAAK,EAAC,uDAAuD;oBAChE,EAAC,QAAQ;wBACP,0DAAG,KAAK,EAAC,qBAAqB,IAAE,YAAY,CAAC,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,MAAM,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,CAAK;wBAC3I,0DAAG,KAAK,EAAC,qBAAqB;4BAAE,YAAY,CAAC,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,gBAAgB,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC;qCAAW,CAClJ,CACP;gBAEN,kEACE,aAAa,EAAE,CAAC,CAAC,EAAE;wBACjB,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;wBAClE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACvC,CAAC,EACD,KAAK,EAAC,OAAO,EACb,KAAK,EAAE,MAAA,IAAI,CAAC,gBAAgB,0CAAE,QAAQ,EACtC,KAAK,EAAE,EAAE,CAAC,mBAAmB,CAAC,EAC9B,IAAI,EAAE,MAAA,CAAC,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC,0CAAE,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;;wBAAC,OAAA,CAAC;4BAC/D,EAAE,EAAE,CAAC;4BACL,KAAK,EACH,CAAC,KAAK,CAAC;gCACL,CAAC,CAAC,WAAW;gCACb,CAAC,CAAC,GAAG,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC,CAAA,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,kBAAkB,0CAAE,MAAM,IAAG,CAAC,EAAE,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,EAAE;4BAC1J,QAAQ,EAAE,CAAC,IAAI,CAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAE,gBAAgB,IAAG,CAAC;4BAC1D,IAAI,EAAE,IAAI;yBACX,CAAC,CAAA;qBAAA,CAAC,GACQ,CACT,CACF,CACP,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Event, EventEmitter, Fragment, Prop, h } from '@stencil/core';\r\nimport { RatePlan, Variation } from '@/models/property';\r\nimport app_store from '@/stores/app.store';\r\nimport { IRatePlanSelection, reserveRooms, updateRoomParams } from '@/stores/booking';\r\nimport { cn, formatAmount } from '@/utils/utils';\r\n\r\n@Component({\r\n  tag: 'ir-rateplan',\r\n  styleUrl: 'ir-rateplan.css',\r\n  shadow: true,\r\n})\r\nexport class IrRateplan {\r\n  @Prop() ratePlan: RatePlan;\r\n  @Prop() visibleInventory?:\r\n    | IRatePlanSelection\r\n    | {\r\n        reserved: number;\r\n        visibleInventory?: number;\r\n        selected_variation: any;\r\n      };\r\n  @Prop() roomTypeInventory: number;\r\n  @Prop() roomTypeId: number;\r\n\r\n  @Event() animateBookingButton: EventEmitter<null>;\r\n\r\n  handleVariationChange(e: CustomEvent, variations: Variation[], rateplanId: number, roomTypeId: number) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const value = e.detail;\r\n    const selectedVariation = variations.find(v => (v.adult_nbr + v.child_nbr).toString() === value);\r\n    console.log(selectedVariation);\r\n    if (!selectedVariation) {\r\n      return;\r\n    }\r\n    updateRoomParams({ params: { selected_variation: selectedVariation }, ratePlanId: rateplanId, roomTypeId });\r\n  }\r\n  render() {\r\n    return (\r\n      <div class=\"bg-gray-100 app_container w-full p-2 flex flex-col lg:grid lg:grid-cols-7 lg:gap-4 space-y-1 text-sm\">\r\n        <div\r\n          class={cn('flex justify-between md:justify-start w-full md:w-fit', {\r\n            'lg:col-span-1 ': !this.ratePlan.custom_text,\r\n            'xl:col-span-2': this.ratePlan.custom_text,\r\n          })}\r\n        >\r\n          <p class=\"line-clamp-3 font-semibold\">\r\n            <span class=\"text-base\">{this.ratePlan.short_name}</span>\r\n            <span class=\"hidden md:inline text-slate-700 text-sm\">{this.ratePlan.custom_text}</span>\r\n          </p>\r\n\r\n          <div class=\"flex items-start gap-1 md:hidden\">\r\n            <p class=\"font-medium\">{formatAmount(this.visibleInventory?.selected_variation?.amount, app_store.userPreferences.currency_id)}</p>\r\n            <p class=\"font-medium line-through text-red-500\">\r\n              {formatAmount(this.visibleInventory?.selected_variation?.total_before_discount, app_store.userPreferences.currency_id)}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <p class={cn('line-clamp-3 text-slate-700 text-xs md:line-clamp-none mobile_custom_text', 'md:hidden')}>{this.ratePlan.custom_text}</p>\r\n\r\n        <div\r\n          class={cn('w-full space-y-2  flex flex-col md:space-y-0  md:justify-between md:flex-row md:items-start lg:grid lg:grid-cols-5 lg:col-span-5 lg:gap-4', {\r\n            'lg:col-span-6': !this.ratePlan.custom_text,\r\n            'xl:col-span-5': this.ratePlan.custom_text,\r\n          })}\r\n        >\r\n          <div class={cn('lg:col-span-2')}>\r\n            <ir-select\r\n              class=\"w-full md:w-auto\"\r\n              label=\"Travelers\"\r\n              value={(this.visibleInventory?.selected_variation?.adult_nbr + this.visibleInventory?.selected_variation?.child_nbr).toString()}\r\n              onValueChange={e => {\r\n                this.handleVariationChange(e, this.ratePlan.variations, this.ratePlan.id, this.roomTypeId);\r\n              }}\r\n              data={this.ratePlan.variations.map(v => ({\r\n                id: (v.adult_nbr + v.child_nbr).toString(),\r\n                value: v.adult_child_offering,\r\n              }))}\r\n            ></ir-select>\r\n            <div class=\"hidden md:flex items-center gap-1\">\r\n              <p>Cancelation conditions</p>\r\n              <ir-tooltip class=\"text-gray-500 flex items-center justify-center\" message={this.ratePlan.cancelation + '<br>' + this.ratePlan.guarantee}></ir-tooltip>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"hidden md:flex items-center gap-1 flex-col justify-between\">\r\n            <Fragment>\r\n              <p class=\"font-medium line-through\">{formatAmount(this.visibleInventory?.selected_variation?.total_before_discount, app_store.userPreferences.currency_id)}</p>\r\n              <p class=\"font-medium  text-red-500\">-%{this.visibleInventory?.selected_variation?.discount_pct}</p>\r\n            </Fragment>\r\n          </div>\r\n\r\n          <div class=\"hidden md:flex items-center  flex-col justify-between\">\r\n            <Fragment>\r\n              <p class=\"font-medium text-lg\">{formatAmount(this.visibleInventory?.selected_variation?.amount, app_store.userPreferences.currency_id)}</p>\r\n              <p class=\"font-medium text-xs\">{formatAmount(this.visibleInventory?.selected_variation?.amount_per_night, app_store.userPreferences.currency_id)}/night</p>\r\n            </Fragment>\r\n          </div>\r\n\r\n          <ir-select\r\n            onValueChange={e => {\r\n              reserveRooms(this.roomTypeId, this.ratePlan.id, Number(e.detail));\r\n              this.animateBookingButton.emit(null);\r\n            }}\r\n            label=\"Rooms\"\r\n            value={this.visibleInventory?.reserved}\r\n            class={cn('w-full  md:w-auto')}\r\n            data={[...new Array(this.roomTypeInventory + 1)]?.map((_, i) => ({\r\n              id: i,\r\n              value:\r\n                i === 0\r\n                  ? 'Select...'\r\n                  : `${i}&nbsp;&nbsp;&nbsp;${i === 0 ? '' : formatAmount(this.visibleInventory?.selected_variation?.amount * i, app_store.userPreferences.currency_id)}`,\r\n              disabled: i >= this.visibleInventory?.visibleInventory + 1,\r\n              html: true,\r\n            }))}\r\n          ></ir-select>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]}