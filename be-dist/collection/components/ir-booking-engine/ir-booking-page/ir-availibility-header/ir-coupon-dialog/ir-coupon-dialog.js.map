{"version":3,"file":"ir-coupon-dialog.js","sourceRoot":"","sources":["../../../../../../src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/ir-coupon-dialog/ir-coupon-dialog.tsx"],"names":[],"mappings":"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","sourcesContent":["import app_store from '@/stores/app.store';\r\nimport booking_store, { modifyBookingStore } from '@/stores/booking';\r\nimport localizedWords from '@/stores/localization.store';\r\nimport { cn, validateCoupon } from '@/utils/utils';\r\nimport { Component, Fragment, h, State, Event, EventEmitter } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-coupon-dialog',\r\n  styleUrl: 'ir-coupon-dialog.css',\r\n  shadow: true,\r\n})\r\nexport class IrCouponDialog {\r\n  @State() coupon: string;\r\n  @State() validationMessage: { error: boolean; message: string };\r\n  @State() isValid = false;\r\n\r\n  @Event() resetBooking: EventEmitter<string>;\r\n\r\n  dialogRef: HTMLIrDialogElement;\r\n\r\n  activateCoupon() {\r\n    this.validationMessage = null;\r\n    if (!validateCoupon(this.coupon)) {\r\n      return (this.validationMessage = { error: true, message: 'Invalid coupon' });\r\n    }\r\n    this.isValid = true;\r\n    this.validationMessage = { error: false, message: this.coupon };\r\n    this.resetBooking.emit('discountOnly');\r\n    this.coupon = null;\r\n    this.dialogRef.closeModal();\r\n  }\r\n\r\n  removeCoupon() {\r\n    this.isValid = false;\r\n    this.validationMessage = null;\r\n    modifyBookingStore('bookingAvailabilityParams', {\r\n      ...booking_store.bookingAvailabilityParams,\r\n      coupon: null,\r\n      loyalty: false,\r\n    });\r\n    this.resetBooking.emit('discountOnly');\r\n  }\r\n\r\n  render() {\r\n    const showCoupon = app_store.property?.promotions?.some(p => p.key !== '');\r\n    if (!showCoupon || booking_store.bookingAvailabilityParams.loyalty) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Fragment>\r\n        <div class=\"coupon-container\">\r\n          <ir-button\r\n            class={cn('coupon-button', {\r\n              'coupon-button-wide': !!booking_store.bookingAvailabilityParams.coupon,\r\n            })}\r\n            onButtonClick={() => this.dialogRef.openModal()}\r\n            variants=\"outline\"\r\n            label={localizedWords.entries.Lcz_HaveCoupon}\r\n            haveLeftIcon\r\n          >\r\n            <ir-icons slot=\"left-icon\" name=\"coupon\"></ir-icons>\r\n          </ir-button>\r\n          {!!booking_store.bookingAvailabilityParams.coupon && (\r\n            <div class=\"coupon-applied\">\r\n              <p onClick={this.removeCoupon.bind(this)}>{localizedWords.entries.Lcz_DiscountApplied}</p>\r\n              <ir-button\r\n                aria-label=\"remove coupon\"\r\n                iconName=\"xmark\"\r\n                variants=\"icon\"\r\n                class=\"icon-remove\"\r\n                svgClassName=\"text-[hsl(var(--brand-600))]\"\r\n                onButtonClick={this.removeCoupon.bind(this)}\r\n              >\r\n                {/* <ir-icons slot=\"btn-icon\" title=\"remove coupon\" name=\"xmark\" ></ir-icons> */}\r\n              </ir-button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <ir-dialog\r\n          ref={el => (this.dialogRef = el)}\r\n          onOpenChange={e => {\r\n            e.stopImmediatePropagation();\r\n            e.stopPropagation();\r\n            if (!e.detail) {\r\n              this.coupon = '';\r\n            }\r\n          }}\r\n        >\r\n          <form\r\n            onSubmit={e => {\r\n              e.preventDefault();\r\n              this.activateCoupon();\r\n            }}\r\n            class=\"coupon-form\"\r\n            slot=\"modal-body\"\r\n          >\r\n            <h1 class=\"title\">{localizedWords.entries.Lcz_HaveCoupon}</h1>\r\n            <ir-input\r\n              error={this.validationMessage?.error}\r\n              onTextChanged={e => (this.coupon = e.detail)}\r\n              autofocus\r\n              inputId=\"booking_code\"\r\n              placeholder={localizedWords.entries.Lcz_EnterYourCouponCode}\r\n              value={this.coupon}\r\n              mode=\"default\"\r\n            ></ir-input>\r\n            {this.validationMessage?.error && <p class=\"error-message\">{this.validationMessage.message}</p>}\r\n            <div class=\"footer-buttons\">\r\n              <ir-button\r\n                size=\"md\"\r\n                onButtonClick={() => {\r\n                  this.dialogRef.closeModal();\r\n                  this.coupon = '';\r\n                }}\r\n                variants=\"outline\"\r\n                label={localizedWords.entries.Lcz_Cancel}\r\n                class=\"button-cancel\"\r\n                type=\"button\"\r\n              ></ir-button>\r\n              <ir-button type=\"submit\" size=\"md\" label={localizedWords.entries.Lcz_Apply} class=\"button-apply\"></ir-button>\r\n            </div>\r\n          </form>\r\n        </ir-dialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n"]}