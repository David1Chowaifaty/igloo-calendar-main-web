{"version":3,"file":"ir-pickup.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-engine/ir-checkout-page/ir-pickup/ir-pickup.tsx"],"names":[],"mappings":"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","sourcesContent":["import { PickupFormData, TAllowedOptions } from '@/models/pickup';\r\nimport { PickupService } from '@/services/app/pickup.service';\r\nimport app_store, { onAppDataChange } from '@/stores/app.store';\r\nimport booking_store from '@/stores/booking';\r\nimport { checkout_store, onCheckoutDataChange, updatePartialPickupFormData, updatePickupFormData } from '@/stores/checkout.store';\r\nimport localizedWords from '@/stores/localization.store';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport { Component, h, Element, State, Listen, Prop } from '@stencil/core';\r\nimport { format } from 'date-fns';\r\nimport IMask from 'imask';\r\nimport { ZodIssue } from 'zod';\r\n@Component({\r\n  tag: 'ir-pickup',\r\n  styleUrl: 'ir-pickup.css',\r\n  shadow: true,\r\n})\r\nexport class IrPickup {\r\n  @Prop() errors: Record<string, ZodIssue>;\r\n  @State() vehicleCapacity: number[] = [];\r\n  @State() allowedOptionsByLocation: TAllowedOptions[] = [];\r\n\r\n  @Element() el: HTMLIrPickupElement;\r\n\r\n  private popover: HTMLIrPopoverElement;\r\n  private pickupService = new PickupService();\r\n  private time_mask = {\r\n    mask: 'HH:MM',\r\n    blocks: {\r\n      HH: {\r\n        mask: IMask.MaskedRange,\r\n        from: 0,\r\n        to: 23,\r\n        maxLength: 2,\r\n        placeholderChar: 'H',\r\n      },\r\n      MM: {\r\n        mask: IMask.MaskedRange,\r\n        from: 0,\r\n        to: 59,\r\n        maxLength: 2,\r\n        placeholderChar: 'M',\r\n      },\r\n    },\r\n    lazy: false,\r\n    placeholderChar: '_',\r\n  };\r\n  private oldCurrencyValue: string;\r\n  componentWillLoad() {\r\n    this.oldCurrencyValue = app_store.userPreferences.currency_id;\r\n    this.updateCurrency();\r\n    updatePickupFormData('arrival_date', format(booking_store.bookingAvailabilityParams?.from_date, 'yyyy-MM-dd'));\r\n    onAppDataChange('userPreferences', newValue => {\r\n      if (newValue.currency_id !== this.oldCurrencyValue) {\r\n        this.updateCurrency();\r\n      }\r\n    });\r\n\r\n    if (checkout_store.pickup.location) {\r\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(checkout_store.pickup.selected_option.vehicle.capacity, 3);\r\n      this.allowedOptionsByLocation = app_store.property.pickup_service.allowed_options.filter(\r\n        option => option.location.id.toString() === checkout_store.pickup.location.toString(),\r\n      );\r\n    }\r\n    onCheckoutDataChange('pickup', newValue => {\r\n      if (newValue.location) {\r\n        this.vehicleCapacity = this.pickupService.getNumberOfVehicles(newValue.selected_option.vehicle.capacity, 3);\r\n        this.allowedOptionsByLocation = app_store.property.pickup_service.allowed_options.filter(option => option.location.id.toString() === newValue.location.toString());\r\n      }\r\n    });\r\n  }\r\n  updateCurrency() {\r\n    const currency = app_store.currencies.find(c => c.code === app_store.userPreferences.currency_id);\r\n    updatePickupFormData('currency', currency);\r\n  }\r\n  dateTrigger() {\r\n    return (\r\n      <div class=\"popover-trigger w-full \" slot=\"trigger\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18\" width=\"12.5\" viewBox=\"0 0 448 512\">\r\n          <path\r\n            fill=\"currentColor\"\r\n            d=\"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z\"\r\n          />\r\n        </svg>\r\n        <div>\r\n          <p class=\"trigger-label\">{localizedWords.entries.Lcz_ArrivalDate}</p>\r\n          <p class={'date'}>{format(new Date(checkout_store.pickup.arrival_date), 'MMM dd, yyyy')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  @Listen('dateChange')\r\n  handleChangeDate(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    updatePickupFormData('arrival_date', format(e.detail, 'yyyy-MM-dd'));\r\n    this.popover.toggleVisibility();\r\n  }\r\n  handleVehicleTypeChange(e: CustomEvent) {\r\n    if (e.detail === '') {\r\n      updatePartialPickupFormData({ due_upon_booking: '', vehicle_type_code: '' });\r\n      return;\r\n    }\r\n    let locationChoice = app_store.property.pickup_service.allowed_options.find(\r\n      option => option.location.id === +checkout_store.pickup.location && option.vehicle.code === e.detail,\r\n    );\r\n    if (!locationChoice) {\r\n      return;\r\n    }\r\n    this.vehicleCapacity = [...this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, 3)];\r\n    updatePartialPickupFormData({\r\n      selected_option: locationChoice,\r\n      number_of_vehicles: this.vehicleCapacity[0],\r\n      due_upon_booking: this.pickupService\r\n        .updateDue({\r\n          amount: locationChoice.amount,\r\n          code: locationChoice.pricing_model.code,\r\n          numberOfPersons: 3,\r\n          number_of_vehicles: this.vehicleCapacity[0],\r\n        })\r\n        .toFixed(2),\r\n      vehicle_type_code: locationChoice.vehicle.code,\r\n    });\r\n  }\r\n  handleLocationChange(event: CustomEvent) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const value = event.detail;\r\n    if (value === '-1') {\r\n      updatePickupFormData('location', null);\r\n    }\r\n    if (value !== '-1') {\r\n      this.allowedOptionsByLocation = app_store.property.pickup_service.allowed_options.filter(option => option.location.id.toString() === value);\r\n      let locationChoice = this.allowedOptionsByLocation[0];\r\n      if (!locationChoice) {\r\n        return;\r\n      }\r\n      locationChoice.currency;\r\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, 3);\r\n      updatePartialPickupFormData({\r\n        location: value,\r\n        selected_option: locationChoice,\r\n        number_of_vehicles: this.vehicleCapacity[0],\r\n        due_upon_booking: this.pickupService\r\n          .updateDue({\r\n            amount: locationChoice.amount,\r\n            code: locationChoice.pricing_model.code,\r\n            numberOfPersons: 3,\r\n            number_of_vehicles: this.vehicleCapacity[0],\r\n          })\r\n          .toFixed(2),\r\n        vehicle_type_code: locationChoice.vehicle.code,\r\n        currency: locationChoice.currency,\r\n      });\r\n    }\r\n  }\r\n  handleVehicleQuantityChange(e: CustomEvent) {\r\n    if (e.detail === '') {\r\n      return;\r\n    }\r\n    const value = +e.detail;\r\n    updatePartialPickupFormData({\r\n      number_of_vehicles: value,\r\n      due_upon_booking: this.pickupService\r\n        .updateDue({\r\n          amount: checkout_store.pickup.selected_option.amount,\r\n          code: checkout_store.pickup.selected_option.pricing_model.code,\r\n          numberOfPersons: 3,\r\n          number_of_vehicles: value,\r\n        })\r\n        .toFixed(2),\r\n    });\r\n  }\r\n  render() {\r\n    if (!app_store.property.pickup_service.allowed_options) {\r\n      return null;\r\n    }\r\n    return (\r\n      <section class=\"space-y-5\">\r\n        <div class=\"flex flex-wrap items-center gap-2 rounded-md bg-gray-100 px-4 py-2\">\r\n          <ir-icons name=\"car\"></ir-icons>\r\n          <p>{localizedWords.entries.Lcz_NeedPickup}</p>\r\n          <ir-select\r\n            value={checkout_store.pickup?.location}\r\n            onValueChange={this.handleLocationChange.bind(this)}\r\n            data={[{ id: -1, value: localizedWords.entries.Lcz_NoThankYou }, ...(this.pickupService.getAvailableLocations(localizedWords.entries.Lcz_YesFrom) as any)]}\r\n          ></ir-select>\r\n        </div>\r\n        {checkout_store.pickup.location && (\r\n          <div class={'flex items-center  justify-between'}>\r\n            <div class=\"flex-1 space-y-5\">\r\n              <div class={'pickup-header-container'}>\r\n                <ir-popover ref={el => (this.popover = el)} class=\"w-fit sm:w-full lg:w-fit\">\r\n                  {this.dateTrigger()}\r\n                  <div slot=\"popover-content\" class=\"date-range-container w-full border-0 p-2 shadow-none sm:w-auto sm:border sm:shadow-sm md:p-4 \">\r\n                    <ir-calendar date={new Date(checkout_store.pickup.arrival_date)} fromDate={booking_store.bookingAvailabilityParams?.from_date}></ir-calendar>\r\n                  </div>\r\n                </ir-popover>\r\n                <ir-input\r\n                  class={'w-full'}\r\n                  onTextChanged={e => updatePickupFormData('arrival_time', e.detail)}\r\n                  label={localizedWords.entries.Lcz_ArrivalHour}\r\n                  placeholder=\"HH:MM\"\r\n                  mask={this.time_mask}\r\n                  type=\"text\"\r\n                  id=\"time-input\"\r\n                  data-state={this.errors && this.errors.arrival_time ? 'error' : ''}\r\n                  aria-invalid={this.errors && this.errors.arrival_time ? 'true' : 'false'}\r\n                  onInputBlur={e => {\r\n                    const firstNameSchema = PickupFormData.pick({ arrival_time: true });\r\n                    const firstNameValidation = firstNameSchema.safeParse({ arrival_time: checkout_store.pickup?.arrival_time });\r\n                    const target: HTMLIrInputElement = e.target;\r\n                    if (!firstNameValidation.success) {\r\n                      target.setAttribute('data-state', 'error');\r\n                      target.setAttribute('aria-invalid', 'true');\r\n                    } else {\r\n                      if (target.hasAttribute('aria-invalid')) {\r\n                        target.setAttribute('aria-invalid', 'false');\r\n                      }\r\n                    }\r\n                  }}\r\n                  onInputFocus={e => {\r\n                    const target: HTMLIrInputElement = e.target;\r\n                    if (target.hasAttribute('data-state')) target.removeAttribute('data-state');\r\n                  }}\r\n                />\r\n                <p class=\"pickup-amount\">\r\n                  {formatAmount(checkout_store.pickup.location ? Number(checkout_store.pickup.due_upon_booking) : 0, app_store.userPreferences.currency_id)}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <ir-input\r\n                  label={localizedWords.entries.Lcz_FlightDetails}\r\n                  placeholder=\"\"\r\n                  value={checkout_store.pickup.flight_details}\r\n                  onTextChanged={e => updatePickupFormData('flight_details', e.detail)}\r\n                ></ir-input>\r\n              </div>\r\n              <div class=\"flex flex-1 items-center gap-4\">\r\n                <ir-select\r\n                  value={checkout_store.pickup.vehicle_type_code}\r\n                  data={this.allowedOptionsByLocation.map(option => ({\r\n                    id: option.vehicle.code,\r\n                    value: option.vehicle.description,\r\n                  }))}\r\n                  onValueChange={this.handleVehicleTypeChange.bind(this)}\r\n                  class=\"w-full\"\r\n                  label={localizedWords.entries.Lcz_CarModel}\r\n                  variant=\"double-line\"\r\n                ></ir-select>\r\n                <ir-select\r\n                  value={checkout_store.pickup.number_of_vehicles}\r\n                  onValueChange={this.handleVehicleQuantityChange.bind(this)}\r\n                  class=\"w-72\"\r\n                  data={this.vehicleCapacity.map(i => ({\r\n                    id: i,\r\n                    value: i.toString(),\r\n                  }))}\r\n                  label={localizedWords.entries.Lcz_NoOfVehicles}\r\n                  variant=\"double-line\"\r\n                ></ir-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </section>\r\n    );\r\n  }\r\n}\r\n"]}