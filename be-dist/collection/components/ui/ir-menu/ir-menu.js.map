{"version":3,"file":"ir-menu.js","sourceRoot":"","sources":["../../../../src/components/ui/ir-menu/ir-menu.tsx"],"names":[],"mappings":"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","sourcesContent":["import { createPopper } from '@popperjs/core';\r\nimport { Component, h, Prop, State, Element, EventEmitter, Event, Listen, Fragment } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-menu',\r\n  styleUrl: 'ir-menu.css',\r\n  shadow: true,\r\n})\r\nexport class IrMenu {\r\n  @Prop({ reflect: true }) data: IItems[] = [];\r\n  @Prop({ reflect: true }) menuItem: string = 'Toggle Menu';\r\n\r\n  @State() isDropdownVisible: boolean = false;\r\n  @State() searchQuery: string = '';\r\n  @State() selectedItemName: string = '';\r\n  @State() currentHighlightedIndex: number = -1;\r\n  @State() usingKeyboard: boolean = false;\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  @Event({ bubbles: true, composed: true }) menuItemClick: EventEmitter<string | number>;\r\n\r\n  private buttonRef: HTMLButtonElement;\r\n  private listRef: HTMLUListElement;\r\n  private popoverInstance: any;\r\n  private contentElement: HTMLDivElement;\r\n  componentWillLoad() {\r\n    this.selectedItemName = this.data[0].item ?? '';\r\n  }\r\n  @Listen('keydown', { target: 'body' })\r\n  handleKeyDown(event: KeyboardEvent) {\r\n    if (!this.isDropdownVisible) {\r\n      return;\r\n    }\r\n    switch (event.key) {\r\n      case 'ArrowDown':\r\n        event.preventDefault();\r\n        this.moveHighlight(1);\r\n        break;\r\n      case 'ArrowUp':\r\n        event.preventDefault();\r\n        this.moveHighlight(-1);\r\n        break;\r\n      case 'Enter':\r\n        event.preventDefault();\r\n        if (this.currentHighlightedIndex !== -1) {\r\n          this.selectItem(this.currentHighlightedIndex);\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        event.stopImmediatePropagation();\r\n        this.closeDropdown();\r\n        break;\r\n      case 'Tab':\r\n        this.closeDropdown();\r\n        break;\r\n    }\r\n  }\r\n  componentDidLoad() {\r\n    this.popoverInstance = createPopper(this.buttonRef, this.contentElement, {\r\n      placement: 'bottom-end',\r\n      strategy: 'fixed',\r\n      modifiers: [\r\n        {\r\n          name: 'offset',\r\n          options: {\r\n            offset: [0, 4],\r\n          },\r\n        },\r\n        {\r\n          name: 'preventOverflow',\r\n          options: {\r\n            boundary: 'viewport',\r\n            padding: 10,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n  }\r\n  @Listen('click', { target: 'document' })\r\n  handleDocumentClick(event: MouseEvent) {\r\n    // const target = event.target as HTMLElement;\r\n    // if (!this.el.contains(target)) {\r\n    //   this.isDropdownVisible = false;\r\n    // }\r\n    const outsideClick = typeof event.composedPath === 'function' && !event.composedPath().includes(this.el);\r\n    if (outsideClick && this.isDropdownVisible) {\r\n      this.isDropdownVisible = false;\r\n    }\r\n  }\r\n  @Listen('mousemove')\r\n  handleMouseMove() {\r\n    if (this.usingKeyboard) this.disableKeyboardPriority();\r\n  }\r\n  moveHighlight(delta: number) {\r\n    let newIndex = this.currentHighlightedIndex;\r\n    do {\r\n      newIndex = (newIndex + delta + this.data.length) % this.data.length;\r\n    } while (this.data[newIndex].disabled);\r\n    this.currentHighlightedIndex = newIndex;\r\n    this.scrollToItem(newIndex);\r\n  }\r\n\r\n  selectItem(index: number) {\r\n    const item = this.data[index];\r\n    if (item && !item.disabled) {\r\n      this.selectedItemName = item.item;\r\n      this.menuItemClick.emit(item.id);\r\n      this.closeDropdown();\r\n    }\r\n  }\r\n\r\n  closeDropdown() {\r\n    this.isDropdownVisible = false;\r\n    this.buttonRef.focus();\r\n  }\r\n\r\n  toggleDropdown() {\r\n    this.isDropdownVisible = !this.isDropdownVisible;\r\n    if (this.isDropdownVisible) {\r\n      this.currentHighlightedIndex = -1;\r\n      this.adjustPopoverPlacement();\r\n    }\r\n  }\r\n  adjustPopoverPlacement() {\r\n    requestAnimationFrame(() => {\r\n      const rect = this.contentElement.getBoundingClientRect();\r\n      if (rect.bottom > window.innerHeight) {\r\n        this.popoverInstance.setOptions({\r\n          placement: 'top-end',\r\n        });\r\n      } else if (rect.top < 0) {\r\n        this.popoverInstance.setOptions({\r\n          placement: 'bottom-end',\r\n        });\r\n      }\r\n      this.popoverInstance.update();\r\n    });\r\n  }\r\n  scrollToItem(index: number) {\r\n    const item = this.listRef?.querySelector(`li:nth-of-type(${index + 1})`) as HTMLLIElement;\r\n    item?.scrollIntoView({ block: 'center' });\r\n  }\r\n  disableKeyboardPriority() {\r\n    this.usingKeyboard = false;\r\n  }\r\n  disconnectedCallback() {\r\n    if (this.popoverInstance) {\r\n      this.popoverInstance.destroy();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <button\r\n          ref={el => (this.buttonRef = el)}\r\n          type=\"button\"\r\n          aria-haspopup=\"listbox\"\r\n          aria-expanded={this.isDropdownVisible ? 'true' : 'false'}\r\n          onClick={() => {\r\n            this.toggleDropdown();\r\n          }}\r\n        >\r\n          <slot name=\"menu-trigger\">\r\n            <div class=\"SelectTrigger\">\r\n              {this.selectedItemName || this.menuItem}\r\n              <svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path\r\n                  d=\"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z\"\r\n                  fill=\"currentColor\"\r\n                  fill-rule=\"evenodd\"\r\n                  clip-rule=\"evenodd\"\r\n                ></path>\r\n              </svg>\r\n            </div>\r\n          </slot>\r\n        </button>\r\n        <div ref={el => (this.contentElement = el)} class=\"SelectContent\" data-state={this.isDropdownVisible ? 'open' : 'closed'}>\r\n          {this.isDropdownVisible && (\r\n            <ul role=\"menu\" ref={el => (this.listRef = el as HTMLUListElement)} tabindex=\"-1\">\r\n              {this.data.map((item, index) => (\r\n                <li\r\n                  data-disabled={item.disabled}\r\n                  data-state={this.currentHighlightedIndex === index ? 'checked' : 'unchecked'}\r\n                  data-highlighted={this.currentHighlightedIndex === index ? 'true' : 'false'}\r\n                  class={'menu-item'}\r\n                  tabindex={-1}\r\n                  role=\"menuitem\"\r\n                  aria-disabled={item.disabled ? 'true' : 'false'}\r\n                  aria-selected={this.selectedItemName === item.item ? 'true' : 'false'}\r\n                  onClick={() => {\r\n                    this.selectItem(index);\r\n                    this.disableKeyboardPriority();\r\n                  }}\r\n                  onMouseOver={() => {\r\n                    if (item.disabled) {\r\n                      return;\r\n                    }\r\n                    this.currentHighlightedIndex = index;\r\n                  }}\r\n                >\r\n                  {item.item}\r\n                  {this.selectedItemName === item.item && (\r\n                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                      <path\r\n                        d=\"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z\"\r\n                        fill=\"var(--brand-600)\"\r\n                        fill-rule=\"evenodd\"\r\n                        clip-rule=\"evenodd\"\r\n                      ></path>\r\n                    </svg>\r\n                  )}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n"]}