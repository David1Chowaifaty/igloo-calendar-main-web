{"file":"ir-coupon-dialog2.js","mappings":"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","names":["isBefore"],"sources":["src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/ir-coupon-dialog/ir-coupon-dialog.css?tag=ir-coupon-dialog&encapsulation=shadow","src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/ir-coupon-dialog/ir-coupon-dialog.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  --ir-dialog-max-width: 32rem;\r\n}\r\n.title {\r\n  height: 32px;\r\n  flex-grow: 0;\r\n  font-size: 16px;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1.33;\r\n  letter-spacing: normal;\r\n  color: #101828;\r\n}\r\n.Supporting-text {\r\n  height: 24px;\r\n  align-self: stretch;\r\n  flex-grow: 0;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1.5;\r\n  letter-spacing: normal;\r\n  color: #475467;\r\n}\r\n","import app_store from '@/stores/app.store';\r\nimport booking_store, { modifyBookingStore } from '@/stores/booking';\r\nimport { cn } from '@/utils/utils';\r\nimport { Component, Fragment, h, State, Event, EventEmitter } from '@stencil/core';\r\nimport { isBefore } from 'date-fns';\r\n\r\n@Component({\r\n  tag: 'ir-coupon-dialog',\r\n  styleUrl: 'ir-coupon-dialog.css',\r\n  shadow: true,\r\n})\r\nexport class IrCouponDialog {\r\n  @State() coupon: string;\r\n  @State() validationMessage: { error: boolean; message: string };\r\n\r\n  @Event() resetBooking: EventEmitter<null>;\r\n\r\n  dialogRef: HTMLIrDialogElement;\r\n\r\n  activateCoupon() {\r\n    this.validationMessage = null;\r\n    const c = app_store.property.promotions.find(p => p.key === this.coupon.trim());\r\n    if (!c) {\r\n      return (this.validationMessage = { error: true, message: 'Invalid coupon' });\r\n    }\r\n    if (isBefore(new Date(c.to), new Date())) {\r\n      return (this.validationMessage = { error: true, message: 'Invalid coupon' });\r\n    }\r\n    modifyBookingStore('bookingAvailabilityParams', {\r\n      coupon: this.coupon,\r\n      loyalty: false,\r\n    });\r\n    this.validationMessage = { error: false, message: this.coupon };\r\n    this.resetBooking.emit(null);\r\n    this.dialogRef.closeModal();\r\n  }\r\n  removeCoupon() {\r\n    this.validationMessage = null;\r\n    this.coupon = '';\r\n    modifyBookingStore('bookingAvailabilityParams', {\r\n      coupon: null,\r\n      loyalty: false,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const showCoupon = app_store.property?.promotions?.some(p => p.key !== '');\r\n    if (!showCoupon || booking_store.bookingAvailabilityParams.loyalty) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Fragment>\r\n        <div class=\"flex w-full items-center justify-center gap-4\">\r\n          <ir-button\r\n            class={cn('w-full', {\r\n              'w-fit': this.validationMessage && !this.validationMessage.error,\r\n            })}\r\n            onButtonClick={() => this.dialogRef.openModal()}\r\n            variants=\"outline\"\r\n            label=\"Have a coupon?\"\r\n            haveLeftIcon\r\n          >\r\n            <ir-icons slot=\"left-icon\" name=\"heart\"></ir-icons>\r\n          </ir-button>\r\n          {this.validationMessage && !this.validationMessage.error && (\r\n            <div class=\"flex items-center  text-sm text-[hsl(var(--brand-600))]\">\r\n              <p onClick={this.removeCoupon.bind(this)}>Discount applied</p>\r\n              <ir-button aria-label=\"remove coupon\" variants=\"icon\" onButtonClick={this.removeCoupon.bind(this)}>\r\n                <ir-icons slot=\"btn-icon\" title=\"remove coupon\" name=\"xmark\" svgClassName=\"text-[hsl(var(--brand-600))]\"></ir-icons>\r\n              </ir-button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <ir-dialog ref={el => (this.dialogRef = el)}>\r\n          <form\r\n            onSubmit={e => {\r\n              e.preventDefault();\r\n              this.activateCoupon();\r\n            }}\r\n            class=\"p-4 sm:p-6\"\r\n            slot=\"modal-body\"\r\n          >\r\n            <h1 class=\"title\">Have a coupon? </h1>\r\n            {/* <p class=\"Supporting-text mb-8\">If you have a coupon available, you can enter it below to unlock special discounts:</p> */}\r\n            <ir-input\r\n              error={this.validationMessage?.error}\r\n              onTextChanged={e => (this.coupon = e.detail)}\r\n              autofocus\r\n              inputId=\"booking_code\"\r\n              label=\"Enter your coupon code\"\r\n            ></ir-input>\r\n            {this.validationMessage?.error && <p class=\"text-red-500\">{this.validationMessage.message}</p>}\r\n            <div class=\"mt-8 flex flex-col-reverse items-center justify-end gap-4 sm:flex-row\">\r\n              <ir-button\r\n                size=\"md\"\r\n                onButtonClick={() => {\r\n                  this.dialogRef.closeModal();\r\n                }}\r\n                variants=\"outline\"\r\n                label=\"Cancel\"\r\n                class={'w-full sm:w-fit'}\r\n              ></ir-button>\r\n              <ir-button type=\"submit\" size=\"md\" label=\"Apply\" class=\"w-full sm:w-fit\"></ir-button>\r\n            </div>\r\n          </form>\r\n        </ir-dialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n"],"version":3}