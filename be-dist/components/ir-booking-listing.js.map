{"file":"ir-booking-listing.js","mappings":"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","names":["format","addDays","IrBookingListing"],"sources":["src/stores/booking_listing.store.ts","src/services/api/booking_listing.service.ts","src/components/ir-booking-engine/ir-booking-listing/ir-booking-listing.css?tag=ir-booking-listing&encapsulation=shadow","src/components/ir-booking-engine/ir-booking-listing/ir-booking-listing.tsx"],"sourcesContent":["import { Booking } from '@/models/booking.dto';\r\nimport { IExposedBookingsCriteria } from '@/models/IrBookingListing';\r\nimport { createStore } from '@stencil/store';\r\nimport { addDays, format } from 'date-fns';\r\n\r\nexport interface IBookingListingStore extends IExposedBookingsCriteria {\r\n  token: string;\r\n  userSelection: IUserListingSelection;\r\n  bookings: Booking[];\r\n  download_url: string | null;\r\n  rowCount: number;\r\n}\r\nexport interface IUserListingSelection {\r\n  channel: string;\r\n  property_id: number;\r\n  filter_type: number;\r\n  from: string;\r\n  to: string;\r\n  name: string;\r\n  book_nbr: string;\r\n  booking_status: string;\r\n  affiliate_id: 0;\r\n  is_mpo_managed: false;\r\n  is_mpo_used: false;\r\n  is_for_mobile: false;\r\n  is_combined_view: false;\r\n  start_row: number;\r\n  end_row: number;\r\n  total_count: number;\r\n  is_to_export: boolean;\r\n}\r\n\r\nconst initialState: IBookingListingStore = {\r\n  channels: [],\r\n  settlement_methods: [],\r\n  statuses: [],\r\n  types: [],\r\n  token: '',\r\n  rowCount: 10,\r\n  bookings: [],\r\n  userSelection: {\r\n    from: format(addDays(new Date(), -7), 'yyyy-MM-dd'),\r\n    to: format(new Date(), 'yyyy-MM-dd'),\r\n    channel: '',\r\n    property_id: null,\r\n    start_row: 0,\r\n    end_row: 20,\r\n    total_count: 0,\r\n    filter_type: null,\r\n    name: '',\r\n    book_nbr: '',\r\n    booking_status: '',\r\n    affiliate_id: 0,\r\n    is_mpo_managed: false,\r\n    is_mpo_used: false,\r\n    is_for_mobile: false,\r\n    is_combined_view: false,\r\n    is_to_export: false,\r\n  },\r\n  download_url: null,\r\n};\r\n\r\nexport const { state: booking_listing, onChange: onBookingListingChange } = createStore<IBookingListingStore>(initialState);\r\nexport function initializeUserSelection() {\r\n  //booking_listing.channels[0].name\r\n  booking_listing.userSelection = {\r\n    ...booking_listing.userSelection,\r\n    channel: '',\r\n    booking_status: booking_listing.statuses[0].code,\r\n    filter_type: booking_listing.types[0].id,\r\n    book_nbr: '',\r\n    name: '',\r\n    from: format(addDays(new Date(), -7), 'yyyy-MM-dd'),\r\n    to: format(new Date(), 'yyyy-MM-dd'),\r\n    start_row: 0,\r\n    end_row: booking_listing.rowCount,\r\n  };\r\n}\r\nexport function updateUserSelection(key: keyof IUserListingSelection, value: any) {\r\n  booking_listing.userSelection = {\r\n    ...booking_listing.userSelection,\r\n    [key]: value,\r\n  };\r\n}\r\nexport default booking_listing;\r\n","import { Token } from '@/models/Token';\r\nimport booking_listing, { initializeUserSelection, IUserListingSelection } from '@/stores/booking_listing.store';\r\nimport axios from 'axios';\r\n\r\nexport class BookingListingService extends Token {\r\n  public async getExposedBookingsCriteria(property_id: number) {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new Error('Invalid token');\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Bookings_Criteria?Ticket=${token}`, {\r\n      property_id,\r\n    });\r\n\r\n    const result = data.My_Result;\r\n\r\n    booking_listing.channels = result.channels;\r\n    booking_listing.settlement_methods = result.settlement_methods;\r\n    booking_listing.statuses = result.statuses;\r\n    booking_listing.types = result.types;\r\n    initializeUserSelection();\r\n  }\r\n\r\n  public async getExposedBookings(params: IUserListingSelection) {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new Error('Invalid token');\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Bookings?Ticket=${token}`, params);\r\n    const result = data.My_Result;\r\n    const header = data.My_Params_Get_Exposed_Bookings;\r\n    booking_listing.bookings = [...result];\r\n    booking_listing.userSelection = {\r\n      ...booking_listing.userSelection,\r\n      total_count: header.total_count,\r\n    };\r\n    booking_listing.download_url = header.exported_data_url;\r\n  }\r\n  public async removeExposedBooking(booking_nbr: string, is_to_revover: boolean) {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new Error('Invalid token');\r\n    }\r\n    await axios.post(`/Remove_Exposed_Booking?Ticket=${token}`, {\r\n      booking_nbr,\r\n      is_to_revover,\r\n    });\r\n  }\r\n}\r\n","@import url('../../gloabls.css');\r\n:host {\r\n  display: block;\r\n}\r\n","import { BookingListingService } from '@/services/api/booking_listing.service';\r\nimport booking_listing from '@/stores/booking_listing.store';\r\nimport { Component, Host, Prop, State, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-booking-listing',\r\n  styleUrl: 'ir-booking-listing.css',\r\n  shadow: true,\r\n})\r\nexport class IrBookingListing {\r\n  @Prop() propertid: number;\r\n\r\n  @State() isLoading = false;\r\n  @State() token: string;\r\n\r\n  private bookingListingService = new BookingListingService();\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      // await Promise.all([this.bookingListingService.getExposedBookingsCriteria(this.propertyid), this.roomService.fetchLanguage(this.language, ['_BOOKING_LIST_FRONT'])]);\r\n      await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    if (!this.token) {\r\n      return (\r\n        <main class=\"flex h-screen flex-col  justify-center\">\r\n          <div class=\"mx-auto w-full max-w-md px-4\">\r\n            {/* <ir-signin></ir-signin> */}\r\n            <ir-auth enableSignUp={false}></ir-auth>\r\n          </div>\r\n        </main>\r\n      );\r\n    }\r\n    return (\r\n      <Host>\r\n        <div class={'p-4'}>\r\n          <div class=\"table-container overflow-x-hidden shadow-md\">\r\n            <div class=\"flex flex-col gap-2.5 px-[20px] py-[16px] md:flex-row md:items-center md:justify-between \">\r\n              <h3>Bookings</h3>\r\n              <input type=\"text\" placeholder=\"Search...\" class=\"w-full max-w-sm rounded-md border border-solid border-gray-300 px-4 py-1.5 \" />\r\n            </div>\r\n            <div class=\"max-w-full overflow-x-auto \">\r\n              <table class=\"table\">\r\n                <thead>\r\n                  <tr class=\"table-header\">\r\n                    <th class=\"table-head\">Status</th>\r\n                    <th class=\"table-head\">Booking reference</th>\r\n                    <th class=\"table-head\">Booking date</th>\r\n                    <th class=\"table-head\">Check-in</th>\r\n                    <th class=\"table-head\">Duration</th>\r\n                    <th class=\"table-head\">Total price</th>\r\n                    <th class=\"table-head sr-only\">pay now</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {[...new Array(10)].map((_, i) => (\r\n                    <tr class=\"table-row\">\r\n                      <td class=\"table-cell\">\r\n                        <ir-badge label=\"Pending\" variant=\"pending\"></ir-badge>\r\n                      </td>\r\n                      <td class=\"table-cell\">{i}</td>\r\n                      <td class=\"table-cell\">Name {i}</td>\r\n                      <td class=\"table-cell\">email{i}@example.com</td>\r\n                      <td class=\"table-cell\">City {i}</td>\r\n                      <td class=\"table-cell\">Country {i}</td>\r\n                      <td class=\"table-cell\">Zip{i}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            <div class=\"flex items-center justify-between px-[20px] py-[16px] \">\r\n              <ir-button variants=\"outline\" label=\"Previous\" haveLeftIcon>\r\n                <ir-icons name=\"arrow_left\" slot=\"left-icon\" svgClassName=\"size-3\"></ir-icons>\r\n              </ir-button>\r\n              <ir-button variants=\"outline\" label=\"Next\" haveRightIcon>\r\n                <ir-icons name=\"arrow_right\" slot=\"right-icon\" svgClassName=\"size-3\"></ir-icons>\r\n              </ir-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}