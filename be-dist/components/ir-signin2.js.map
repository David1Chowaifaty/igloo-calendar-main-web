{"file":"ir-signin2.js","mappings":";;;;;;;;;;;AAAA,MAAM,WAAW,GAAG,2q9BAA2q9B,CAAC;AAChs9B,uBAAe,WAAW;;MCab,QAAQ;IALrB;;;;;;QAMU,iBAAY,GAAY,KAAK,CAAC;QAC7B,iBAAY,GAAqB,EAAE,CAAC;QACpC,cAAS,GAId,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC;QAC1C,cAAS,GAAG,KAAK,CAAC;QAanB,gBAAW,GAAG,IAAI,WAAW,EAAE,CAAC;QAChC,UAAK,GAAG,IAAI,KAAK,EAAE,CAAC;KAwJ7B;IAtJC,kBAAkB,CAAC,MAAiC;QAClD,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;SACxB;QACD,IAAI,CAAC,YAAY,mCAAQ,IAAI,CAAC,YAAY,GAAK,MAAM,CAAE,CAAC;KACzD;IAED,MAAM,KAAK,CAAC,MAAgD;QAC1D,IAAI;YACF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC;YACzE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC3B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;gBACnB,KAAK,EAAE,SAAS;gBAChB,KAAK;gBACL,OAAO,kBACL,MAAM,EAAE,QAAQ,IACb,MAAM,CACV;aACF,CAAC,CAAC;SACJ;QAAC,OAAO,KAAK,EAAE;YACd,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;gBACnB,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,IAAI;gBACX,OAAO,kBACL,MAAM,EAAE,QAAQ,IACb,MAAM,CACV;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,GAAG;gBACf,KAAK,EAAE,MAAM;gBACb,MAAM,EAAE,SAAS;gBACjB,MAAM,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,EAAE,WAAW,EAAE,KAAK,CAAC,OAAO,EAAE;aAC7D,CAAC;SACH;gBAAS;YACR,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;KACF;IACD,MAAM,YAAY,CAAC,CAAQ;QACzB,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,CAAC,CAAC,eAAe,EAAE,CAAC;QACpB,CAAC,CAAC,wBAAwB,EAAE,CAAC;QAC7B,IAAI;YACF,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;YAC7B,MAAM,MAAM,GAAG,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACvD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAC5C,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC1B;QAAC,OAAO,KAAK,EAAE;YACd,IAAI,SAAS,GAA2C;gBACtD,KAAK,EAAE,IAAI;gBACX,WAAW,EAAE,IAAI;aAClB,CAAC;YACF,IAAI,KAAK,YAAY,QAAQ,EAAE;gBAC7B,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;iBAClC,CAAC,CAAC;gBACH,IAAI,CAAC,SAAS,GAAG;oBACf,KAAK,EAAE,KAAK;oBACZ,MAAM,EAAE,SAAS;oBACjB,MAAM,oBAAO,SAAS,CAAE;iBACzB,CAAC;aACH;SACF;KACF;IAED,MAAM;;QACJ,QACE,EAAC,IAAI,uDACH,2DAAI,KAAK,EAAC,OAAO,IAAE,cAAc,CAAC,OAAO,CAAC,uBAAuB,CAAM,EACvE,6DAAM,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,IACzC,CAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,KAAK,MAAK,MAAM,KAAI,MAAA,IAAI,CAAC,SAAS,0CAAE,MAAM,CAAA,KACzD,4DAAK,KAAK,EAAC,OAAO,IAChB,uEAAgB,OAAO,EAAC,OAAO,EAAC,KAAK,EAAC,OAAO,EAAC,OAAO,EAAE,MAAA,MAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,MAAM,0CAAE,KAAK,mCAAI,EAAE,GAAmB,CACzG,CACP,EACD,mEACE,iEACE,KAAK,EAAE,CAAC,EAAC,MAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,MAAM,0CAAE,KAAK,CAAA,EACtC,aAAa,EAAE,CAAC,IAAI,IAAI,CAAC,kBAAkB,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC,EAChE,SAAS,QACT,OAAO,EAAC,OAAO,EACf,KAAK,EAAE,cAAc,CAAC,OAAO,CAAC,kBAAkB,EAChD,WAAW,EAAE,CAAC;gBACZ,MAAM,eAAe,GAAG,cAAc,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;gBAC7D,MAAM,mBAAmB,GAAG,eAAe,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC;gBAC1F,MAAM,MAAM,GAAuB,CAAC,CAAC,MAAM,CAAC;gBAC5C,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE;oBAChC,MAAM,CAAC,YAAY,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;oBAC3C,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;iBAC7C;qBAAM;oBACL,IAAI,MAAM,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;wBACvC,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;qBAC9C;iBACF;aACF,EACD,YAAY,EAAE,CAAC;gBACb,MAAM,MAAM,GAAuB,CAAC,CAAC,MAAM,CAAC;gBAC5C,IAAI,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC;oBAAE,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;aAC7E,GACS,CACH,EACX,mEACE,iEACE,KAAK,EAAE,CAAC,EAAC,MAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,MAAM,0CAAE,WAAW,CAAA,EAC5C,aAAa,EAAE,CAAC,IAAI,IAAI,CAAC,kBAAkB,CAAC,EAAE,WAAW,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC,EACtE,OAAO,EAAC,aAAa,EACrB,IAAI,EAAC,QAAQ,EACb,KAAK,EAAE,cAAc,CAAC,OAAO,CAAC,0BAA0B,EACxD,WAAW,EAAE,CAAC;gBACZ,MAAM,eAAe,GAAG,cAAc,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;gBACnE,MAAM,mBAAmB,GAAG,eAAe,CAAC,SAAS,CAAC,EAAE,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;gBACtG,MAAM,MAAM,GAAuB,CAAC,CAAC,MAAM,CAAC;gBAC5C,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE;oBAChC,MAAM,CAAC,YAAY,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;oBAC3C,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;iBAC7C;qBAAM;oBACL,IAAI,MAAM,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;wBACvC,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;qBAC9C;iBACF;aACF,EACD,YAAY,EAAE,CAAC;gBACb,MAAM,MAAM,GAAuB,CAAC,CAAC,MAAM,CAAC;gBAC5C,IAAI,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC;oBAAE,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;aAC7E,GACS,CACH,EACX,+DAAQ,IAAI,EAAC,QAAQ,EAAC,KAAK,EAAC,0BAA0B,eAAY,IAAI,IACnE,IAAI,CAAC,SAAS,IAAI,6DAAM,KAAK,EAAC,QAAQ,GAAQ,EAC9C,cAAc,CAAC,OAAO,CAAC,UAAU,CAC3B,EACR,CAAC,SAAS,CAAC,QAAQ,CAAC,gBAAgB,KACnC,4DAAK,KAAK,EAAC,SAAS,IAClB,4DAAK,KAAK,EAAC,cAAc,GAAO,EAChC,6DAAM,KAAK,EAAC,cAAc,IAAE,cAAc,CAAC,OAAO,CAAC,MAAM,CAAQ,EACjE,4DAAK,KAAK,EAAC,cAAc,GAAO,CAC5B,CACP,CACI,CASF,EACP;KACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["src/components/ir-booking-engine/ir-nav/ir-auth/ir-signin/ir-signin.css?tag=ir-signin&encapsulation=scoped","src/components/ir-booking-engine/ir-nav/ir-auth/ir-signin/ir-signin.tsx"],"sourcesContent":["@import url('../../../../ui/ir-button/ir-button.css');\r\n:host {\r\n  display: block;\r\n}\r\n.title {\r\n  height: 32px;\r\n  align-self: stretch;\r\n  flex-grow: 0;\r\n  font-size: 24px;\r\n  font-weight: 600;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1.33;\r\n  letter-spacing: normal;\r\n  text-align: center;\r\n  color: #101828;\r\n  margin-bottom: 2rem;\r\n}\r\n.Supporting-text {\r\n  height: 24px;\r\n  align-self: stretch;\r\n  flex-grow: 0;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1.5;\r\n  letter-spacing: normal;\r\n  text-align: center;\r\n  color: #475467;\r\n}\r\n.dont-have-an-account {\r\n  width: 155px;\r\n  height: 20px;\r\n  flex-grow: 0;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1.43;\r\n  letter-spacing: normal;\r\n  text-align: left;\r\n  color: #475467;\r\n}\r\n\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\nfieldset {\r\n  border: none;\r\n  padding: 0;\r\n}\r\n\r\n.ir-input {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.ir-button {\r\n  margin-top: 1rem;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.error {\r\n  color: var(--error-color, #dc3545);\r\n  text-align: center;\r\n  margin-bottom: 1rem;\r\n}\r\n.divider {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 1rem;\r\n  margin: 0.75rem 0;\r\n}\r\n.divider-line {\r\n  flex: 1;\r\n  height: 1px;\r\n  background-color: var(--divider-color, #ccc);\r\n}\r\n\r\n.divider-text {\r\n  color: var(--divider-text-color, #6c757d);\r\n}\r\n\r\n.dont-have-an-account {\r\n  font-size: 0.875rem;\r\n  color: var(--text-color, #333);\r\n}\r\n\r\n.sign-up-button {\r\n  background-color: transparent;\r\n  border: none;\r\n  color: var(--primary-color, #007bff);\r\n  cursor: pointer;\r\n  padding: 0;\r\n}\r\n\r\n.sign-up-button:hover {\r\n  text-decoration: underline;\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\r\nimport { SignInValidtor, TSignInAuthTrigger, TSignInValidator } from '@/validators/auth.validator';\r\nimport { ZodError } from 'zod';\r\nimport { AuthService } from '@/services/api/auth.service';\r\nimport app_store from '@/stores/app.store';\r\nimport { TAuthNavigation } from '../auth.types';\r\nimport localizedWords from '@/stores/localization.store';\r\nimport Token from '@/models/Token';\r\n\r\n@Component({\r\n  tag: 'ir-signin',\r\n  styleUrl: 'ir-signin.css',\r\n  scoped: true,\r\n})\r\nexport class IrSignin {\r\n  @Prop() enableSignUp: boolean = false;\r\n  @State() signInParams: TSignInValidator = {};\r\n  @State() formState: {\r\n    cause: 'zod' | 'auth' | null;\r\n    status: 'empty' | 'valid' | 'invalid';\r\n    errors: Record<keyof TSignInValidator, string> | null;\r\n  } = { cause: null, errors: null, status: 'empty' };\r\n  @State() isLoading = false;\r\n  @Event() authFinish: EventEmitter<{\r\n    state: 'success' | 'failed';\r\n    token: string;\r\n    payload: {\r\n      method: 'direct' | 'google';\r\n      email?: string;\r\n      booking_nbr?: string;\r\n    };\r\n  }>;\r\n  @Event() navigate: EventEmitter<TAuthNavigation>;\r\n  @Event({ bubbles: true, composed: true }) signIn: EventEmitter<TSignInAuthTrigger>;\r\n\r\n  private authService = new AuthService();\r\n  private token = new Token();\r\n\r\n  modifySignInParams(params: Partial<TSignInValidator>) {\r\n    if (!this.signInParams) {\r\n      this.signInParams = {};\r\n    }\r\n    this.signInParams = { ...this.signInParams, ...params };\r\n  }\r\n\r\n  async login(params: { email?: string; booking_nbr?: string }) {\r\n    try {\r\n      this.isLoading = true;\r\n      const token = await this.authService.login({ option: 'direct', params });\r\n      this.token.setToken(token);\r\n      this.authFinish.emit({\r\n        state: 'success',\r\n        token,\r\n        payload: {\r\n          method: 'direct',\r\n          ...params,\r\n        },\r\n      });\r\n    } catch (error) {\r\n      this.authFinish.emit({\r\n        state: 'failed',\r\n        token: null,\r\n        payload: {\r\n          method: 'direct',\r\n          ...params,\r\n        },\r\n      });\r\n      this.formState = {\r\n        cause: 'auth',\r\n        status: 'invalid',\r\n        errors: { email: error.message, booking_nbr: error.message },\r\n      };\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  async handleSignIn(e: Event) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    try {\r\n      this.formState.errors = null;\r\n      const params = SignInValidtor.parse(this.signInParams);\r\n      this.signIn.emit({ trigger: 'be', params });\r\n      await this.login(params);\r\n    } catch (error) {\r\n      let newErrors: Record<keyof TSignInValidator, string> = {\r\n        email: null,\r\n        booking_nbr: null,\r\n      };\r\n      if (error instanceof ZodError) {\r\n        error.issues.map(e => {\r\n          newErrors[e.path[0]] = e.message;\r\n        });\r\n        this.formState = {\r\n          cause: 'zod',\r\n          status: 'invalid',\r\n          errors: { ...newErrors },\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <h1 class=\"title\">{localizedWords.entries.Lcz_SignInToYourBooking}</h1>\r\n        <form onSubmit={this.handleSignIn.bind(this)}>\r\n          {this.formState?.cause === 'auth' && this.formState?.errors && (\r\n            <div class=\"error\">\r\n              <ir-badge-group variant=\"error\" badge=\"Error\" message={this.formState?.errors?.email ?? ''}></ir-badge-group>\r\n            </div>\r\n          )}\r\n          <fieldset>\r\n            <ir-input\r\n              error={!!this.formState?.errors?.email}\r\n              onTextChanged={e => this.modifySignInParams({ email: e.detail })}\r\n              autofocus\r\n              inputId=\"email\"\r\n              label={localizedWords.entries.Lcz_EnterYourEmail}\r\n              onInputBlur={e => {\r\n                const firstNameSchema = SignInValidtor.pick({ email: true });\r\n                const firstNameValidation = firstNameSchema.safeParse({ email: this.signInParams.email });\r\n                const target: HTMLIrInputElement = e.target;\r\n                if (!firstNameValidation.success) {\r\n                  target.setAttribute('data-state', 'error');\r\n                  target.setAttribute('aria-invalid', 'true');\r\n                } else {\r\n                  if (target.hasAttribute('aria-invalid')) {\r\n                    target.setAttribute('aria-invalid', 'false');\r\n                  }\r\n                }\r\n              }}\r\n              onInputFocus={e => {\r\n                const target: HTMLIrInputElement = e.target;\r\n                if (target.hasAttribute('data-state')) target.removeAttribute('data-state');\r\n              }}\r\n            ></ir-input>\r\n          </fieldset>\r\n          <fieldset>\r\n            <ir-input\r\n              error={!!this.formState?.errors?.booking_nbr}\r\n              onTextChanged={e => this.modifySignInParams({ booking_nbr: e.detail })}\r\n              inputId=\"booking_nbr\"\r\n              type=\"number\"\r\n              label={localizedWords.entries.Lcz_EnterYourBookingBumber}\r\n              onInputBlur={e => {\r\n                const firstNameSchema = SignInValidtor.pick({ booking_nbr: true });\r\n                const firstNameValidation = firstNameSchema.safeParse({ booking_nbr: this.signInParams.booking_nbr });\r\n                const target: HTMLIrInputElement = e.target;\r\n                if (!firstNameValidation.success) {\r\n                  target.setAttribute('data-state', 'error');\r\n                  target.setAttribute('aria-invalid', 'true');\r\n                } else {\r\n                  if (target.hasAttribute('aria-invalid')) {\r\n                    target.setAttribute('aria-invalid', 'false');\r\n                  }\r\n                }\r\n              }}\r\n              onInputFocus={e => {\r\n                const target: HTMLIrInputElement = e.target;\r\n                if (target.hasAttribute('data-state')) target.removeAttribute('data-state');\r\n              }}\r\n            ></ir-input>\r\n          </fieldset>\r\n          <button type=\"submit\" class=\"button-default ir-button\" data-size={'md'}>\r\n            {this.isLoading && <span class=\"loader\"></span>}\r\n            {localizedWords.entries.Lcz_SignIn}\r\n          </button>\r\n          {!app_store.app_data.hideGoogleSignIn && (\r\n            <div class=\"divider\">\r\n              <div class=\"divider-line\"></div>\r\n              <span class=\"divider-text\">{localizedWords.entries.Lcz_Or}</span>\r\n              <div class=\"divider-line\"></div>\r\n            </div>\r\n          )}\r\n        </form>\r\n        {/* {this.enableSignUp && (\r\n          <div class=\"flex items-center justify-center\">\r\n            <p class=\"dont-have-an-account\">Don't have an account?</p>\r\n            <button class=\"sign-up-button\" onClick={() => this.navigate.emit('register')}>\r\n              Sign up\r\n            </button>\r\n          </div>\r\n        )} */}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}