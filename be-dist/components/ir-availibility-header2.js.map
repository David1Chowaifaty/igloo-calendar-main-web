{"file":"ir-availibility-header2.js","mappings":"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","names":["parseISO","isValid","isBefore","isSameDay","isAfter","format"],"sources":["src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/availability.ts","src/validators/querystring.validator.ts","src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/ir-availibility-header.css?tag=ir-availibility-header&encapsulation=shadow","src/components/ir-booking-engine/ir-booking-page/ir-availibility-header/ir-availibility-header.tsx"],"sourcesContent":["import { z } from 'zod';\r\n\r\nexport const ExposedBookingAvailability = z.object({\r\n  propertyid: z.coerce.number(),\r\n  from_date: z.string().min(2),\r\n  to_date: z.string().min(2),\r\n  room_type_ids: z.string().array().optional().default([]),\r\n  adult_nbr: z.number().min(1),\r\n  child_nbr: z.number().min(0),\r\n  infant_nbr: z.number().min(0),\r\n  language: z.string().default('en'),\r\n  currency_ref: z.string(),\r\n  is_in_loyalty_mode: z.boolean().default(false),\r\n  promo_key: z.string(),\r\n  is_in_agent_mode: z.boolean().default(false),\r\n  agent_id: z.number().default(0).optional(),\r\n  is_in_affiliate_mode: z.boolean().default(false),\r\n  affiliate_id: z.number().default(0).optional(),\r\n});\r\n\r\nexport type TExposedBookingAvailability = z.infer<typeof ExposedBookingAvailability>;\r\n","import app_store from '@/stores/app.store';\r\nimport { parseISO, isValid, isAfter, isSameDay, isBefore, format } from 'date-fns';\r\nimport { z } from 'zod';\r\n\r\nexport class QueryStringValidator {\r\n  private errors: string[] = [];\r\n\r\n  private dateSchema = z.string().regex(/^\\d{4}-\\d{2}-\\d{2}$/, {\r\n    message: 'Date must be in YYYY-MM-DD format.',\r\n  });\r\n\r\n  public validateCheckin(checkinStr: string): Date | null {\r\n    this.errors = [];\r\n    try {\r\n      this.dateSchema.parse(checkinStr);\r\n    } catch (e) {\r\n      this.errors.push('Checkin date must be in YYYY-MM-DD format.');\r\n      return null;\r\n    }\r\n\r\n    const checkinDate = parseISO(checkinStr);\r\n    const today = new Date();\r\n\r\n    if (!isValid(checkinDate)) {\r\n      this.errors.push('Checkin date is not a valid date.');\r\n      return null;\r\n    }\r\n    if (isBefore(checkinDate, today) && !isSameDay(checkinDate, today)) {\r\n      this.errors.push('Checkin date must be today or in the future.');\r\n      return null;\r\n    }\r\n    if (app_store.nonBookableNights[checkinStr]) {\r\n      this.errors.push('Checkin date is unavailable.');\r\n      return null;\r\n    }\r\n    return checkinDate;\r\n  }\r\n  public validateAges(str: string) {\r\n    const regex = /^(\\d+_)+\\d+$/;\r\n    return regex.test(str);\r\n  }\r\n  public validateCheckout(checkoutStr: string, checkinDate: Date): Date | null {\r\n    try {\r\n      this.dateSchema.parse(checkoutStr);\r\n    } catch (e) {\r\n      this.errors.push('Checkout date must be in YYYY-MM-DD format.');\r\n      return null;\r\n    }\r\n\r\n    const checkoutDate = parseISO(checkoutStr);\r\n\r\n    if (!isValid(checkoutDate)) {\r\n      this.errors.push('Checkout date is not a valid date.');\r\n      return null;\r\n    }\r\n\r\n    if (!isAfter(checkoutDate, checkinDate)) {\r\n      this.errors.push('Checkout date must be at least one day after checkin date.');\r\n      return null;\r\n    }\r\n\r\n    if (app_store.nonBookableNights[checkoutStr] && app_store.nonBookableNights[format(checkinDate, 'yyyy-MM-dd')]) {\r\n      this.errors.push('Checkout date is unavailable.');\r\n      return null;\r\n    }\r\n    return checkoutDate;\r\n  }\r\n\r\n  public validateAdultCount(adultCount: string) {\r\n    return isNaN(Number(adultCount));\r\n  }\r\n\r\n  public validateChildrenCount(children: string) {\r\n    return isNaN(Number(children));\r\n  }\r\n\r\n  public getErrors(): string[] {\r\n    return this.errors;\r\n  }\r\n}\r\n",".availability-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  background-color: #f3f4f6;\r\n  padding: 1rem;\r\n  border-radius: min(var(--radius, 0.5rem), 0.75rem);\r\n}\r\n.full-width-on-mobile {\r\n  width: 100%;\r\n}\r\n.availability-inputs {\r\n  display: flex;\r\n  width: 100%;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.date-popup,\r\n.adult-child-counter,\r\n.button-container {\r\n  width: 100%;\r\n}\r\n.availability-controls {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  width: 100%;\r\n}\r\n.availability-controls ir-adult-child-counter {\r\n  flex: 1 1 0%;\r\n  width: 100%;\r\n}\r\n\r\n.date-toast .toast-message {\r\n  background-color: #ef4444;\r\n  color: white;\r\n  border-radius: 0.375rem;\r\n  padding: 0.25rem 1.25rem;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.button-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.hidden-on-mobile {\r\n  display: none;\r\n}\r\n\r\n.full-width-on-mobile {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.promotions-container {\r\n  display: flex;\r\n  width: 100%;\r\n  flex-wrap: wrap;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 1rem;\r\n}\r\n.arrow-up {\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 0.6rem solid transparent;\r\n  border-right: 0.6rem solid transparent;\r\n  border-bottom: 0.4rem solid #ef4444;\r\n  position: absolute;\r\n  top: -3.2px;\r\n  animation: tooltipAnimation 300ms ease-out;\r\n}\r\n.arrow-up:dir(rtl) {\r\n  right: 0.625rem;\r\n}\r\n.arrow-up:dir(ltr) {\r\n  left: 0.625rem;\r\n}\r\n.date-toast {\r\n  position: relative;\r\n  animation: tooltipAnimation 300ms ease-out;\r\n}\r\n.availability-inputs.promotions,\r\n.availability-inputs.promotions .adult-child-counter,\r\n.availability-inputs.promotions .date-popup {\r\n  flex: 1 1 0%;\r\n}\r\n@keyframes tooltipAnimation {\r\n  from {\r\n    transform: translateY(4px);\r\n    opacity: 0.6;\r\n  }\r\n}\r\n\r\n/* Media Queries */\r\n@media (min-width: 640px) {\r\n  .availability-container {\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    justify-content: center;\r\n    gap: 1rem;\r\n  }\r\n\r\n  .availability-inputs {\r\n    flex-direction: row;\r\n    width: auto;\r\n  }\r\n\r\n  .date-popup {\r\n    width: 100%;\r\n  }\r\n  .adult-child-counter,\r\n  .button-container {\r\n    width: auto;\r\n  }\r\n\r\n  .hidden-on-mobile {\r\n    display: block;\r\n  }\r\n\r\n  .full-width-on-mobile {\r\n    display: none;\r\n  }\r\n\r\n  .promotions-container {\r\n    width: auto;\r\n    justify-content: flex-start;\r\n  }\r\n}\r\n@media (min-width: 1024px) {\r\n  .availability-container {\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    gap: 2rem;\r\n  }\r\n  .availability-container.promotions {\r\n    justify-content: flex-start;\r\n  }\r\n}\r\n@media (min-width: 1280px) {\r\n  .availability-container {\r\n    gap: 4rem;\r\n  }\r\n}\r\n","import { Component, Event, EventEmitter, h, Listen, Prop, State, Watch } from '@stencil/core';\r\nimport { ExposedBookingAvailability, TExposedBookingAvailability } from './availability';\r\nimport { format } from 'date-fns';\r\nimport { ZodError } from 'zod';\r\nimport { onAppDataChange } from '@/stores/app.store';\r\nimport { PropertyService } from '@/services/api/property.service';\r\nimport app_store from '@/stores/app.store';\r\nimport booking_store from '@/stores/booking';\r\nimport { v4 } from 'uuid';\r\nimport { AvailabiltyService } from '@/services/app/availability.service';\r\nimport localizedWords from '@/stores/localization.store';\r\nimport { QueryStringValidator } from '@/validators/querystring.validator';\r\nimport { calculateInfantNumber, modifyQueryParam } from '@/utils/utils';\r\nimport { AddAdultsAndChildrenEvent } from '../ir-adult-child-counter/ir-adult-child-counter';\r\n\r\n@Component({\r\n  tag: 'ir-availibility-header',\r\n  styleUrl: 'ir-availibility-header.css',\r\n  shadow: true,\r\n})\r\nexport class IrAvailibilityHeader {\r\n  @Prop() fromDate: string;\r\n  @Prop() toDate: string;\r\n  @Prop() adultCount: string;\r\n  @Prop() childrenCount: string;\r\n  @Prop() ages: string = '';\r\n\r\n  @State() target: HTMLElement = null;\r\n  @State() isLoading = false;\r\n  @State() childrenAges: string[] = [];\r\n  @State() exposedBookingAvailabiltyParams: TExposedBookingAvailability = {\r\n    adult_nbr: 2,\r\n    child_nbr: 0,\r\n    infant_nbr: 0,\r\n    currency_ref: 'USD',\r\n    language: 'en',\r\n    room_type_ids: [],\r\n    propertyid: 42,\r\n    is_in_loyalty_mode: booking_store.bookingAvailabilityParams.loyalty ? true : !!booking_store.bookingAvailabilityParams.coupon,\r\n    promo_key: booking_store.bookingAvailabilityParams.coupon || '',\r\n    is_in_agent_mode: !!booking_store.bookingAvailabilityParams.agent || false,\r\n    agent_id: booking_store.bookingAvailabilityParams.agent || 0,\r\n  };\r\n\r\n  @Event() resetBooking: EventEmitter<null>;\r\n  @Event() scrollToRoomType: EventEmitter<null>;\r\n\r\n  private errorCause: ('date' | 'adult_child')[] | null = null;\r\n  private popoverInstance = null;\r\n  private toast_timeout: NodeJS.Timeout;\r\n  private identifier: string;\r\n  private personCounter: HTMLIrAdultChildCounterElement;\r\n\r\n  private propertyService = new PropertyService();\r\n  private availabiltyService = new AvailabiltyService();\r\n  private validator = new QueryStringValidator();\r\n\r\n  componentWillLoad() {\r\n    const { property_id } = app_store.app_data;\r\n    this.availabiltyService.subscribe(() => this.disableLoading());\r\n    const validatedFromDate = this.validator.validateCheckin(this.fromDate);\r\n    this.exposedBookingAvailabiltyParams = {\r\n      ...this.exposedBookingAvailabiltyParams,\r\n      adult_nbr: this.setDefaultAdultCount(),\r\n      child_nbr: this.setDefaultChildCount(),\r\n      from_date: validatedFromDate ? this.fromDate : null,\r\n      to_date: this.validator.validateCheckout(this.toDate, validatedFromDate) ? this.toDate : null,\r\n    };\r\n    this.childrenAges = [...Array(this.exposedBookingAvailabiltyParams.child_nbr)].fill('');\r\n\r\n    this.proccessAges();\r\n\r\n    if (booking_store.bookingAvailabilityParams.from_date) {\r\n      this.exposedBookingAvailabiltyParams.from_date = format(booking_store.bookingAvailabilityParams.from_date, 'yyyy-MM-dd');\r\n      this.exposedBookingAvailabiltyParams.to_date = format(booking_store.bookingAvailabilityParams.to_date, 'yyyy-MM-dd');\r\n    }\r\n    if (booking_store.bookingAvailabilityParams.adult_nbr) {\r\n      this.exposedBookingAvailabiltyParams.adult_nbr = booking_store.bookingAvailabilityParams.adult_nbr;\r\n      this.exposedBookingAvailabiltyParams.child_nbr = booking_store.bookingAvailabilityParams.child_nbr;\r\n    }\r\n    console.log(this.validator.getErrors());\r\n    this.changeExposedAvailabilityParams({\r\n      propertyid: property_id,\r\n      language: app_store.userPreferences.language_id,\r\n      currency_ref: app_store.userPreferences.currency_id,\r\n    });\r\n    onAppDataChange('userPreferences', async newValue => {\r\n      this.changeExposedAvailabilityParams({\r\n        language: newValue.language_id,\r\n        currency_ref: newValue.currency_id,\r\n      });\r\n      try {\r\n        if (app_store.currentPage === 'booking') {\r\n          this.resetBooking.emit(null);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    });\r\n    this.recheckAvailability();\r\n  }\r\n\r\n  @Watch('ages')\r\n  handleAgesChange(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      this.proccessAges();\r\n    }\r\n  }\r\n\r\n  @Watch('fromDate')\r\n  handleFromDateChange(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      if (this.validator.validateCheckin(newValue)) {\r\n        this.exposedBookingAvailabiltyParams = {\r\n          ...this.exposedBookingAvailabiltyParams,\r\n          from_date: newValue,\r\n        };\r\n        if (this.fromDate && this.toDate && !this.validator.validateAdultCount(this.adultCount)) {\r\n          this.checkAvailability();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  @Watch('toDate')\r\n  handleToDateChange(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      const validatedFromDate = this.validator.validateCheckin(this.fromDate);\r\n      if (validatedFromDate) {\r\n        if (this.validator.validateCheckout(newValue, validatedFromDate)) {\r\n          this.exposedBookingAvailabiltyParams = {\r\n            ...this.exposedBookingAvailabiltyParams,\r\n            to_date: newValue,\r\n          };\r\n          this.recheckAvailability();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  @Watch('childrenCount')\r\n  handleChildrenCountChange(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      if (!this.validator.validateChildrenCount(newValue)) {\r\n        this.exposedBookingAvailabiltyParams = {\r\n          ...this.exposedBookingAvailabiltyParams,\r\n          child_nbr: +newValue,\r\n        };\r\n        this.childrenAges = [...Array(this.exposedBookingAvailabiltyParams.child_nbr)].fill('');\r\n        this.recheckAvailability();\r\n      }\r\n    }\r\n  }\r\n\r\n  @Watch('adultCount')\r\n  handleAdultCountChange(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      if (!this.validator.validateAdultCount(newValue)) {\r\n        this.exposedBookingAvailabiltyParams = {\r\n          ...this.exposedBookingAvailabiltyParams,\r\n          adult_nbr: +newValue,\r\n        };\r\n        this.recheckAvailability();\r\n      }\r\n    }\r\n  }\r\n\r\n  @Listen('dateChange')\r\n  handleDateChange(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const { start, end } = e.detail;\r\n    if (end) {\r\n      this.changeExposedAvailabilityParams({\r\n        from_date: format(start, 'yyyy-MM-dd').toString(),\r\n        to_date: format(end, 'yyyy-MM-dd').toString(),\r\n      });\r\n    } else if (this.exposedBookingAvailabiltyParams.to_date && !end) {\r\n      this.changeExposedAvailabilityParams({\r\n        from_date: format(start, 'yyyy-MM-dd').toString(),\r\n        to_date: null,\r\n      });\r\n    } else {\r\n      this.changeExposedAvailabilityParams({ from_date: format(start, 'yyyy-MM-dd') });\r\n    }\r\n    modifyQueryParam('checkin', this.exposedBookingAvailabiltyParams.from_date);\r\n    modifyQueryParam('checkout', this.exposedBookingAvailabiltyParams.to_date);\r\n  }\r\n\r\n  @Listen('addAdultsAndChildren')\r\n  handleAdultChildChange(e: CustomEvent<AddAdultsAndChildrenEvent>) {\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    const { adult_nbr, child_nbr, childrenAges, infant_nbr } = e.detail;\r\n    this.childrenAges = [...childrenAges];\r\n    this.changeExposedAvailabilityParams({ adult_nbr, child_nbr, infant_nbr });\r\n    modifyQueryParam('adults', this.exposedBookingAvailabiltyParams.adult_nbr?.toString());\r\n    modifyQueryParam('children', this.exposedBookingAvailabiltyParams.child_nbr?.toString());\r\n    if (infant_nbr) {\r\n      modifyQueryParam('ages', encodeURIComponent(childrenAges.join('_')));\r\n    }\r\n  }\r\n\r\n  private setDefaultAdultCount() {\r\n    if (this.validator.validateAdultCount(this.adultCount)) {\r\n      return 2;\r\n    }\r\n    const adCountNumber = Number(this.adultCount);\r\n    return adCountNumber > app_store.property.adult_child_constraints.adult_max_nbr ? app_store.property.adult_child_constraints.adult_max_nbr : adCountNumber;\r\n  }\r\n\r\n  private setDefaultChildCount() {\r\n    if (this.validator.validateChildrenCount(this.childrenCount)) {\r\n      return 0;\r\n    }\r\n    const childCountNumber = Number(this.childrenCount);\r\n    return childCountNumber > app_store.property.adult_child_constraints.child_max_nbr ? app_store.property.adult_child_constraints.child_max_nbr : childCountNumber;\r\n  }\r\n\r\n  private disableLoading() {\r\n    if (this.isLoading) {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  private recheckAvailability() {\r\n    if (!this.fromDate || !this.toDate || !this.adultCount) {\r\n      return;\r\n    }\r\n    const isValidFromDate = this.validator.validateCheckin(this.fromDate);\r\n    const isValidToDate = this.validator.validateCheckout(this.toDate, isValidFromDate);\r\n    const isValidAdultCount = this.validator.validateAdultCount(this.adultCount);\r\n    if (!isValidAdultCount && isValidFromDate && isValidToDate) {\r\n      this.checkAvailability();\r\n    }\r\n  }\r\n\r\n  private proccessAges() {\r\n    if (this.exposedBookingAvailabiltyParams.child_nbr === 0) {\r\n      return;\r\n    }\r\n    if (this.validator.validateAges(this.ages)) {\r\n      const ages = this.ages.split('_');\r\n      ages.slice(0, this.adultCount.length + 1).forEach((age, index) => {\r\n        this.childrenAges[index] = age.toString();\r\n      });\r\n      const infant_nbr = calculateInfantNumber(this.childrenAges);\r\n      this.exposedBookingAvailabiltyParams = {\r\n        ...this.exposedBookingAvailabiltyParams,\r\n        infant_nbr,\r\n      };\r\n    }\r\n    if (this.exposedBookingAvailabiltyParams.child_nbr > 0 && this.childrenAges.some(c => c === '')) {\r\n      setTimeout(() => {\r\n        this.personCounter?.open();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  private async checkAvailability() {\r\n    const params = ExposedBookingAvailability.parse(this.exposedBookingAvailabiltyParams);\r\n    if (app_store.app_data.injected) {\r\n      const { from_date, to_date, adult_nbr, child_nbr, infant_nbr } = params;\r\n      const fromDate = `checkin=${from_date}`;\r\n      const toDate = `checkout=${to_date}`;\r\n      const adults = `adults=${adult_nbr}`;\r\n      const children = child_nbr > 0 ? `children=${child_nbr}` : '';\r\n      const affiliate = app_store.app_data.affiliate ? `aff=${app_store.app_data.affiliate.afname}` : '';\r\n      const currency = `cur=${app_store.userPreferences.currency_id}`;\r\n      const language = `lang=${app_store.userPreferences.language_id}`;\r\n      const loyalty = booking_store.bookingAvailabilityParams.loyalty ? 'loyalty=true' : '';\r\n      const promo_key = booking_store.bookingAvailabilityParams.coupon ? `promo=${booking_store.bookingAvailabilityParams.coupon}` : '';\r\n      const agent = booking_store.bookingAvailabilityParams.agent ? `agent=${booking_store.bookingAvailabilityParams.agent}` : '';\r\n      const ages = infant_nbr > 0 && !this.childrenAges.every(c => c === '') ? `ages=${this.childrenAges.join('_')}` : '';\r\n      const queryParams = [fromDate, toDate, adults, ages, children, affiliate, language, currency, loyalty, promo_key, agent];\r\n      const queryString = queryParams.filter(param => param !== '').join('&');\r\n\r\n      return (location.href = `https://${app_store.property.perma_link}.bookingmystay.com?${queryString}`);\r\n    }\r\n\r\n    if (this.childrenAges.length > 0 && this.childrenAges.some(c => c === '') && this.exposedBookingAvailabiltyParams.child_nbr > 0) {\r\n      if (!this.errorCause) {\r\n        this.errorCause = [];\r\n      }\r\n      console.log('error');\r\n      this.errorCause.push('adult_child');\r\n      return;\r\n    }\r\n    this.identifier = v4();\r\n    this.availabiltyService.initSocket(this.identifier);\r\n    booking_store.bookingAvailabilityParams = {\r\n      ...booking_store.bookingAvailabilityParams,\r\n      from_date: new Date(params.from_date),\r\n      to_date: new Date(params.to_date),\r\n      adult_nbr: params.adult_nbr,\r\n      child_nbr: params.child_nbr - params.infant_nbr,\r\n      infant_nbr: params.infant_nbr,\r\n    };\r\n    this.scrollToRoomType.emit(null);\r\n    await this.propertyService.getExposedBookingAvailability({\r\n      params: {\r\n        ...this.exposedBookingAvailabiltyParams,\r\n        child_nbr: this.exposedBookingAvailabiltyParams.child_nbr - this.exposedBookingAvailabiltyParams.infant_nbr,\r\n        promo_key: booking_store.bookingAvailabilityParams.coupon || '',\r\n        is_in_agent_mode: !!booking_store.bookingAvailabilityParams.agent || false,\r\n        agent_id: booking_store.bookingAvailabilityParams.agent || 0,\r\n        is_in_loyalty_mode: booking_store.bookingAvailabilityParams.loyalty ? true : !!booking_store.bookingAvailabilityParams.coupon,\r\n        is_in_affiliate_mode: !!app_store.app_data.affiliate,\r\n        affiliate_id: app_store.app_data.affiliate ? app_store.app_data.affiliate.id : null,\r\n      },\r\n      identifier: this.identifier,\r\n      mode: 'default',\r\n    });\r\n    app_store.fetchedBooking = true;\r\n  }\r\n\r\n  private async handleCheckAvailability() {\r\n    try {\r\n      this.isLoading = true;\r\n      await this.checkAvailability();\r\n    } catch (error) {\r\n      if (error instanceof ZodError) {\r\n        console.log(error.errors);\r\n        for (const err of error.errors) {\r\n          if (!this.errorCause) {\r\n            this.errorCause = [];\r\n          }\r\n          const error_cause = err.path[0].toString();\r\n\r\n          if (error_cause.includes('date') && !this.errorCause.find(c => c === 'date')) {\r\n            this.errorCause.push('date');\r\n          }\r\n          if (error_cause.includes('nbr')) {\r\n            this.errorCause.push('adult_child');\r\n          }\r\n        }\r\n      }\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  private changeExposedAvailabilityParams(params: Partial<TExposedBookingAvailability>) {\r\n    this.exposedBookingAvailabiltyParams = {\r\n      ...this.exposedBookingAvailabiltyParams,\r\n      ...params,\r\n    };\r\n  }\r\n\r\n  private shouldRenderErrorToast() {\r\n    // Check for date-related errors\r\n    if (this.errorCause?.find(c => c === 'date') !== undefined) {\r\n      // Both dates must be present to clear the error\r\n      if (this.exposedBookingAvailabiltyParams.from_date && this.exposedBookingAvailabiltyParams.to_date) {\r\n        this.errorCause = this.errorCause?.filter(c => c !== 'date');\r\n      }\r\n    }\r\n\r\n    // Check for adult/child count related errors\r\n    if (this.errorCause?.find(c => c === 'adult_child')) {\r\n      // There must be at least one adult to clear the error\r\n      if (this.exposedBookingAvailabiltyParams.adult_nbr > 0 && this.childrenAges.every(c => c !== '')) {\r\n        this.errorCause = this.errorCause?.filter(c => c !== 'adult_child');\r\n      }\r\n    }\r\n    return this.errorCause?.length > 0;\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    if (this.popoverInstance) {\r\n      this.popoverInstance.destroy();\r\n    }\r\n    if (this.toast_timeout) {\r\n      clearTimeout(this.toast_timeout);\r\n    }\r\n    this.availabiltyService.unsubscribe(() => this.disableLoading());\r\n    this.availabiltyService.disconnectSocket();\r\n  }\r\n\r\n  render() {\r\n    this.shouldRenderErrorToast();\r\n    const show_loyalty = app_store.property?.promotions?.some(p => p.is_loyalty);\r\n    const show_coupon = app_store.property?.promotions?.some(p => p.is_loyalty);\r\n    const showPromotions = app_store?.property?.promotions && (show_coupon || show_loyalty);\r\n    return (\r\n      <div class={`availability-container ${showPromotions ? 'promotions' : ''} xl:text-cyan-50`}>\r\n        <div class={`availability-inputs ${showPromotions ? 'promotions' : ''}`}>\r\n          <ir-date-popup\r\n            data-state={this.errorCause?.find(c => c === 'date') ? 'error' : ''}\r\n            dates={{\r\n              start: this.exposedBookingAvailabiltyParams?.from_date ? new Date(this.exposedBookingAvailabiltyParams.from_date) : null,\r\n              end: this.exposedBookingAvailabiltyParams?.to_date ? new Date(this.exposedBookingAvailabiltyParams.to_date) : null,\r\n            }}\r\n            class=\"date-popup\"\r\n          ></ir-date-popup>\r\n          {/* <div class=\"availability-controls\"> */}\r\n          <ir-adult-child-counter\r\n            infant_nbr={this.exposedBookingAvailabiltyParams.infant_nbr}\r\n            error={!!this.errorCause?.find(c => c === 'adult_child')}\r\n            data-state={this.errorCause?.find(c => c === 'adult_child') ? 'error' : ''}\r\n            adultCount={this.exposedBookingAvailabiltyParams.adult_nbr}\r\n            childrenCount={this.exposedBookingAvailabiltyParams.child_nbr}\r\n            minAdultCount={0}\r\n            maxAdultCount={app_store.property.adult_child_constraints.adult_max_nbr}\r\n            maxChildrenCount={app_store.property.adult_child_constraints.child_max_nbr}\r\n            childMaxAge={app_store.property.adult_child_constraints.child_max_age}\r\n            class=\"adult-child-counter\"\r\n            ref={el => (this.personCounter = el)}\r\n            baseChildrenAges={this.childrenAges}\r\n          ></ir-adult-child-counter>\r\n          <div class={'hidden sm:block'}>\r\n            <ir-button\r\n              isLoading={this.isLoading}\r\n              onButtonClick={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                this.handleCheckAvailability();\r\n              }}\r\n              size=\"pill\"\r\n              variants=\"icon-primary\"\r\n              iconName=\"search\"\r\n              label=\"Check availability\"\r\n            ></ir-button>\r\n          </div>\r\n          {/* </div> */}\r\n          <div class=\"full-width-on-mobile sm:hidden\">\r\n            <ir-button\r\n              isLoading={this.isLoading}\r\n              onButtonClick={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                this.handleCheckAvailability();\r\n              }}\r\n              size=\"md\"\r\n              label={localizedWords.entries.Lcz_Search}\r\n              buttonStyles={{ width: '100%' }}\r\n            ></ir-button>\r\n          </div>\r\n        </div>\r\n\r\n        {app_store?.property?.promotions && (\r\n          <div class=\"promotions-container\">\r\n            <ir-coupon-dialog class=\"coupon-dialog\"></ir-coupon-dialog>\r\n            <ir-loyalty class=\"loyalty\"></ir-loyalty>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"version":3}