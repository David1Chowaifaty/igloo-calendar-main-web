{"version":3,"file":"ir-price-input.entry.js","sources":["src/components/ui/ir-price-input/ir-price-input.css?tag=ir-price-input&encapsulation=scoped","src/components/ui/ir-price-input/ir-price-input.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  --ir-input-border-color: #cacfe7;\r\n  flex: 1 1 0%;\r\n}\r\n\r\n:host .input-group-text {\r\n  border-color: var(--ir-input-border-color);\r\n}\r\n:host .form-control,\r\n.currency-label {\r\n  font-size: 14px !important;\r\n}\r\n\r\n.ir-bl-lbl-none,\r\n.ir-bl-input-none {\r\n  border-top-left-radius: 0 !important;\r\n  border-bottom-left-radius: 0 !important;\r\n}\r\n.ir-br-lbl-none,\r\n.ir-br-input-none {\r\n  border-top-right-radius: 0 !important;\r\n  border-bottom-right-radius: 0 !important;\r\n}\r\n.ir-br-none {\r\n  border-right: none;\r\n}\r\n.ir-bl-none {\r\n  border-left: none;\r\n}\r\n\r\n.rate-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  box-sizing: border-box;\r\n  flex: 1;\r\n  padding: 0 !important;\r\n}\r\n:host([class='special-style']) .rate-input {\r\n  background: black !important;\r\n}\r\n.rate-input {\r\n  font-size: 0.875rem;\r\n  line-height: 0;\r\n  padding: 0;\r\n  height: 0;\r\n  box-sizing: border-box;\r\n  border-left: 0;\r\n  padding-left: 0px !important;\r\n  border-top-left-radius: 0 !important;\r\n  border-bottom-left-radius: 0 !important;\r\n}\r\n\r\n.currency-label.with-label {\r\n  border-radius: 0;\r\n}\r\n\r\n.currency-label {\r\n  box-sizing: border-box;\r\n  color: #3b4781;\r\n  border: 1px solid #cacfe7;\r\n  font-size: 0.875rem;\r\n  height: 2rem;\r\n  background: white;\r\n  border-right: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  pointer-events: none;\r\n  transition: border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\r\n}\r\n.currency-label.disabled,\r\n.rate-input:disabled {\r\n  background-color: #eceff1;\r\n  border-color: rgba(118, 118, 118, 0.3);\r\n}\r\n\r\n.price-input-group:focus-within .currency-label {\r\n  border-top: 1px solid #1e9ff2;\r\n  border-bottom: 1px solid #1e9ff2;\r\n  border-left: 1px solid #1e9ff2;\r\n}\r\n:host([data-state='error']) .currency-label,\r\n:host([data-state='error']) .rate-input,\r\n.error {\r\n  border-color: var(--red, #ff4961) !important;\r\n}\r\n.price-input:focus {\r\n  border-right-width: 1px !important;\r\n}\r\n\r\n.is-invalid {\r\n  background-image: none !important;\r\n}\r\n","import { Component, Element, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { v4 } from 'uuid';\r\nimport { ZodType } from 'zod';\r\nimport IMask, { InputMask } from 'imask';\r\n@Component({\r\n  tag: 'ir-price-input',\r\n  styleUrl: 'ir-price-input.css',\r\n  scoped: true,\r\n})\r\nexport class IrPriceInput {\r\n  @Element() el: HTMLIrPriceInputElement;\r\n\r\n  /** The label for the input, optional */\r\n  @Prop() label?: string;\r\n\r\n  /** Extra classnames for the input, optional */\r\n  @Prop() inputStyle?: string;\r\n\r\n  /** Extra classnames for the label, optional */\r\n  @Prop() labelStyle?: string;\r\n\r\n  /** The disabled for the input, optional */\r\n  @Prop() disabled?: boolean;\r\n\r\n  /** The Currency for the input, optional */\r\n  @Prop() currency?: string;\r\n\r\n  /** The AutoValidate for the input, optional */\r\n  @Prop() autoValidate?: boolean = true;\r\n\r\n  /** Indicates the key to wrap the value (e.g., 'price' or 'cost') */\r\n  @Prop() wrapKey?: string;\r\n\r\n  /**\r\n   * A Zod schema for validating the input\r\n   * Example: z.coerce.number()\r\n   */\r\n  @Prop() zod?: ZodType<any, any>;\r\n\r\n  /** Placeholder text for the input */\r\n  @Prop() placeholder: string = '';\r\n\r\n  /** Initial value for the input */\r\n  @Prop({ mutable: true }) value: string = '';\r\n\r\n  /** Whether the input is required */\r\n  @Prop() required: boolean = false;\r\n\r\n  /** Minimum value for the price */\r\n  @Prop() minValue?: number;\r\n\r\n  /** Maximum value for the price */\r\n  @Prop() maxValue?: number;\r\n\r\n  /** Unique id for testing */\r\n  @Prop() testId?: string;\r\n\r\n  /** Error*/\r\n  @State() error: boolean;\r\n\r\n  /** Emits the current value on change */\r\n  @Event() textChange: EventEmitter<string>;\r\n\r\n  /** Emits the current value on blur */\r\n  @Event() inputBlur: EventEmitter<string>;\r\n\r\n  /** Emits the current value on focus */\r\n  @Event() inputFocus: EventEmitter<void>;\r\n\r\n  private id: string;\r\n\r\n  private opts = {\r\n    mask: Number,\r\n    scale: 2,\r\n    radix: '.',\r\n    mapToRadix: [','],\r\n    normalizeZeros: true,\r\n    padFractionalZeros: true,\r\n    thousandsSeparator: ',',\r\n  };\r\n  private mask: InputMask<any>;\r\n  private inputRef: HTMLInputElement;\r\n\r\n  componentWillLoad() {\r\n    if (this.el.id) {\r\n      this.id = this.el.id;\r\n    } else {\r\n      this.id = v4();\r\n    }\r\n  }\r\n\r\n  componentDidLoad() {\r\n    if (!this.mask) {\r\n      this.initializeMask();\r\n    }\r\n  }\r\n\r\n  private initializeMask() {\r\n    // Create options object with min/max if provided\r\n    const maskOpts = {\r\n      ...this.opts,\r\n    };\r\n\r\n    if (this.minValue !== undefined) {\r\n      maskOpts['min'] = this.minValue;\r\n    }\r\n\r\n    if (this.maxValue !== undefined) {\r\n      maskOpts['max'] = this.maxValue;\r\n    }\r\n\r\n    this.mask = IMask(this.inputRef, maskOpts);\r\n\r\n    // Set initial value if provided\r\n    if (this.value) {\r\n      this.mask.value = this.value;\r\n    }\r\n\r\n    this.mask.on('accept', () => {\r\n      const isEmpty = this.inputRef.value.trim() === '' || this.mask.unmaskedValue === '';\r\n      if (isEmpty) {\r\n        this.value = '';\r\n        this.textChange.emit(null);\r\n      } else {\r\n        this.value = this.mask.unmaskedValue;\r\n        this.textChange.emit(this.value);\r\n      }\r\n    });\r\n  }\r\n\r\n  private hasSpecialClass(className: string): boolean {\r\n    return this.el.classList.contains(className);\r\n  }\r\n\r\n  private validateInput(value: string): void {\r\n    if (!this.autoValidate) {\r\n      return;\r\n    }\r\n    if (this.zod) {\r\n      try {\r\n        this.zod.parse(this.wrapKey ? { [this.wrapKey]: value } : value); // Validate the value using the Zod schema\r\n        this.error = false; // Clear the error if valid\r\n      } catch (error) {\r\n        console.log(error);\r\n        this.error = true; // Set the error message\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleInputChange = (): void => {\r\n    // The value is already being updated by the mask's 'accept' event\r\n    // Just validate here if needed\r\n    this.validateInput(this.value);\r\n  };\r\n\r\n  private handleBlur = (): void => {\r\n    this.validateInput(this.value);\r\n\r\n    // Format to 2 decimal places on blur\r\n    if (this.value) {\r\n      const numValue = parseFloat(this.value);\r\n      this.value = numValue.toFixed(2);\r\n\r\n      // Update the mask value to show the formatted value\r\n      if (this.mask) {\r\n        this.mask.value = this.value;\r\n      }\r\n    }\r\n\r\n    // Emit the blur event\r\n    this.inputBlur.emit(this.value);\r\n  };\r\n\r\n  private handleFocus = (): void => {\r\n    // Emit the focus event\r\n    this.inputFocus.emit();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <fieldset class=\"input-group price-input-group m-0 p-0\">\r\n        {this.label && (\r\n          <div class=\"input-group-prepend\">\r\n            <span\r\n              class={`input-group-text \r\n                ${this.labelStyle}\r\n              ${this.hasSpecialClass('ir-bl-lbl-none') ? 'ir-bl-lbl-none' : ''}\r\n              ${this.hasSpecialClass('ir-br-lbl-none') ? 'ir-br-lbl-none' : ''}\r\n              ${this.hasSpecialClass('ir-br-none') ? 'ir-br-none' : ''} \r\n              ${this.hasSpecialClass('ir-bl-none') ? 'ir-bl-none' : ''} \r\n              `}\r\n            >\r\n              <label class={'p-0 m-0 '} htmlFor={this.id}>\r\n                {this.label}\r\n              </label>\r\n            </span>\r\n          </div>\r\n        )}\r\n        <div class=\"position-relative has-icon-left rate-input-container\">\r\n          {this.currency && (\r\n            <div class={`input-group-prepend`}>\r\n              <span class={`input-group-text ${this.disabled ? 'disabled' : ''} currency-label ${this.error ? 'error' : ''} ${this.label ? 'with-label' : ''}`}>\r\n                {this.currency}\r\n              </span>\r\n            </div>\r\n          )}\r\n          <input\r\n            ref={el => (this.inputRef = el)}\r\n            data-testid={this.testId}\r\n            disabled={this.disabled}\r\n            id={this.id}\r\n            class={`form-control input-sm rate-input \r\n              ${this.inputStyle}\r\n              ${this.hasSpecialClass('ir-br-input-none') ? 'ir-br-input-none' : ''} \r\n              ${this.hasSpecialClass('ir-bl-input-none') ? 'ir-bl-input-none' : ''} \r\n              ${this.error ? 'error' : ''} py-0 m-0 ${this.currency ? 'ir-bl-none' : ''}`}\r\n            onInput={this.handleInputChange}\r\n            onBlur={this.handleBlur}\r\n            onFocus={this.handleFocus}\r\n            type=\"text\"\r\n            placeholder={this.placeholder}\r\n            aria-label={this.el.ariaLabel ?? 'price-input'}\r\n            aria-describedby={this.el.ariaDescription ?? 'price-input'}\r\n          />\r\n        </div>\r\n      </fieldset>\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}