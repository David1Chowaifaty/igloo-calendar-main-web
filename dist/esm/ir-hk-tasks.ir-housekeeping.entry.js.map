{"version":3,"file":"ir-hk-tasks.ir-housekeeping.entry.js","sources":["src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.css?tag=ir-hk-tasks&encapsulation=scoped","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.tsx","src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n\r\n@media only screen and (min-width: 900px) {\r\n  /* td {\r\n    min-width: 140px !important;\r\n    width: max-content !important;\r\n  } */\r\n}\r\n@media only screen and (max-width: 900px) {\r\n  /* td {\r\n    min-width: 100px !important;\r\n  } */\r\n  .table-container {\r\n    width: max-content !important;\r\n  }\r\n}\r\n","import { IPendingActions, Task } from '@/models/housekeeping';\r\nimport Token from '@/models/Token';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport housekeeping_store from '@/stores/housekeeping.store';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Host, Prop, State, h, Element, Watch, Event, EventEmitter, Listen } from '@stencil/core';\r\nimport moment from 'moment';\r\nimport { v4 } from 'uuid';\r\nimport { TaskFilters } from './types';\r\nimport { downloadFile } from '@/utils/utils';\r\n\r\n@Component({\r\n  tag: 'ir-hk-tasks',\r\n  styleUrl: 'ir-hk-tasks.css',\r\n  scoped: true,\r\n})\r\nexport class IrHkTasks {\r\n  @Element() el: HTMLElement;\r\n\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n  @Prop() propertyid: number;\r\n  @Prop() p: string;\r\n\r\n  @State() isLoading = false;\r\n  @State() selectedDuration = '';\r\n  @State() selectedHouseKeeper = '0';\r\n  @State() selectedRoom: IPendingActions | null = null;\r\n  @State() archiveOpened = false;\r\n  @State() property_id: number;\r\n  @State() tasks: Task[] = [];\r\n  @State() selectedTasks: Task[] = [];\r\n  @State() isSidebarOpen: boolean;\r\n  @State() isApplyFiltersLoading: boolean;\r\n  @State() filters: TaskFilters;\r\n\r\n  @Event({ bubbles: true, composed: true }) clearSelectedHkTasks: EventEmitter<void>;\r\n\r\n  private hkNameCache: Record<number, string> = {};\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n  private token = new Token();\r\n  private table_sorting: Map<string, 'ASC' | 'DESC'> = new Map();\r\n  private modal: HTMLIrModalElement;\r\n\r\n  componentWillLoad() {\r\n    if (this.ticket !== '') {\r\n      this.token.setToken(this.ticket);\r\n      this.init();\r\n    }\r\n  }\r\n\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.init();\r\n  }\r\n\r\n  @Listen('closeSideBar')\r\n  handleCloseSidebar(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    this.isSidebarOpen = false;\r\n  }\r\n  @Listen('sortingChanged')\r\n  handleSortingChanged(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const { field, direction } = e.detail;\r\n    console.log(e.detail);\r\n    if (field === 'date') {\r\n      return;\r\n    }\r\n    this.table_sorting.set(field, direction);\r\n  }\r\n\r\n  private async init() {\r\n    try {\r\n      this.isLoading = true;\r\n      let propertyId = this.propertyid;\r\n      if (!this.propertyid && !this.p) {\r\n        throw new Error('Property ID or username is required');\r\n      }\r\n      // let roomResp = null;\r\n      if (!propertyId) {\r\n        console.log(propertyId);\r\n        const propertyData = await this.roomService.getExposedProperty({\r\n          id: 0,\r\n          aname: this.p,\r\n          language: this.language,\r\n          is_backend: true,\r\n          include_units_hk_status: true,\r\n        });\r\n        // roomResp = propertyData;\r\n        propertyId = propertyData.My_Result.id;\r\n      }\r\n      this.property_id = propertyId;\r\n      const requests = [\r\n        this.houseKeepingService.getHkTasks({ property_id: this.property_id, from_date: moment().format('YYYY-MM-DD'), to_date: moment().format('YYYY-MM-DD') }),\r\n        this.houseKeepingService.getExposedHKSetup(this.property_id),\r\n        this.roomService.fetchLanguage(this.language),\r\n      ];\r\n      if (this.propertyid) {\r\n        requests.push(\r\n          this.roomService.getExposedProperty({\r\n            id: this.propertyid,\r\n            language: this.language,\r\n            is_backend: true,\r\n            include_units_hk_status: true,\r\n          }),\r\n        );\r\n      }\r\n\r\n      const results = await Promise.all(requests);\r\n      const tasks = results[0];\r\n      if (tasks) {\r\n        this.updateTasks(tasks);\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  private buildHousekeeperNameCache() {\r\n    this.hkNameCache = {};\r\n    housekeeping_store.hk_criteria?.housekeepers?.forEach(hk => {\r\n      if (hk.id != null && hk.name != null) {\r\n        this.hkNameCache[hk.id] = hk.name;\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateTasks(tasks) {\r\n    this.buildHousekeeperNameCache();\r\n    this.tasks = tasks.map(t => ({\r\n      ...t,\r\n      id: v4(),\r\n      housekeeper: (() => {\r\n        const name = this.hkNameCache[t.hkm_id];\r\n        if (name) {\r\n          return name;\r\n        }\r\n        const hkName = housekeeping_store.hk_criteria?.housekeepers?.find(hk => hk.id === t.hkm_id)?.name;\r\n        this.hkNameCache[t.hkm_id] = hkName;\r\n        return hkName;\r\n      })(),\r\n    }));\r\n  }\r\n\r\n  private handleHeaderButtonPress(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const { name } = e.detail;\r\n    switch (name) {\r\n      case 'cleaned':\r\n        this.modal?.openModal();\r\n        break;\r\n      case 'export':\r\n        const sortingArray: { key: string; value: string }[] = Array.from(this.table_sorting.entries()).map(([key, value]) => ({\r\n          key,\r\n          value,\r\n        }));\r\n        console.log(sortingArray);\r\n        downloadFile('');\r\n        break;\r\n      case 'archive':\r\n        this.isSidebarOpen = true;\r\n        break;\r\n    }\r\n  }\r\n\r\n  private async handleModalConfirmation(e: CustomEvent) {\r\n    try {\r\n      e.stopImmediatePropagation();\r\n      e.stopPropagation();\r\n      if (this.selectedTasks.length === 0) {\r\n        return;\r\n      }\r\n      await this.houseKeepingService.executeHKAction({\r\n        actions: this.selectedTasks.map(t => ({ description: 'Cleaned', hkm_id: t.hkm_id === 0 ? null : t.hkm_id, unit_id: t.unit.id, booking_nbr: t.booking_nbr })),\r\n      });\r\n      await this.fetchTasksWithFilters();\r\n    } finally {\r\n      this.selectedTasks = [];\r\n      this.clearSelectedHkTasks.emit();\r\n      this.modal.closeModal();\r\n    }\r\n  }\r\n\r\n  private async applyFilters(e: CustomEvent) {\r\n    try {\r\n      this.isApplyFiltersLoading = true;\r\n      e.stopImmediatePropagation();\r\n      e.stopPropagation();\r\n      this.filters = { ...e.detail };\r\n      await this.fetchTasksWithFilters();\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isApplyFiltersLoading = false;\r\n    }\r\n  }\r\n  private async fetchTasksWithFilters() {\r\n    const { cleaning_periods, housekeepers, cleaning_frequencies, dusty_units, highlight_check_ins } = this.filters ?? {};\r\n\r\n    const tasks = await this.houseKeepingService.getHkTasks({\r\n      housekeepers,\r\n      cleaning_frequencies: cleaning_frequencies?.code,\r\n      dusty_units: dusty_units?.code,\r\n      highlight_window: highlight_check_ins?.code,\r\n      property_id: this.property_id,\r\n      from_date: moment().format('YYYY-MM-DD'),\r\n      to_date: cleaning_periods?.code || moment().format('YYYY-MM-DD'),\r\n    });\r\n    if (tasks) {\r\n      this.updateTasks(tasks);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host data-testid=\"hk_tasks_base\">\r\n        <ir-toast></ir-toast>\r\n        <ir-interceptor></ir-interceptor>\r\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\r\n          <ir-tasks-header onHeaderButtonPress={this.handleHeaderButtonPress.bind(this)} isCleanedEnabled={this.selectedTasks.length > 0}></ir-tasks-header>\r\n          <div class=\"d-flex flex-column flex-md-row mt-1 \" style={{ gap: '1rem' }}>\r\n            <ir-tasks-filters\r\n              isLoading={this.isApplyFiltersLoading}\r\n              onApplyFilters={e => {\r\n                this.applyFilters(e);\r\n              }}\r\n            ></ir-tasks-filters>\r\n            <ir-tasks-table\r\n              onRowSelectChange={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                this.selectedTasks = e.detail;\r\n              }}\r\n              class=\"flex-grow-1 w-100\"\r\n              tasks={this.tasks}\r\n            ></ir-tasks-table>\r\n          </div>\r\n        </section>\r\n        <ir-modal\r\n          autoClose={false}\r\n          ref={el => (this.modal = el)}\r\n          isLoading={isRequestPending('/Execute_HK_Action')}\r\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\r\n          iconAvailable={true}\r\n          icon=\"ft-alert-triangle danger h1\"\r\n          leftBtnText={locales.entries.Lcz_NO}\r\n          rightBtnText={locales.entries.Lcz_Yes}\r\n          leftBtnColor=\"secondary\"\r\n          rightBtnColor={'primary'}\r\n          modalTitle={locales.entries.Lcz_Confirmation}\r\n          modalBody={'Update selected unit(s) to Clean'}\r\n        ></ir-modal>\r\n        <ir-sidebar\r\n          open={this.isSidebarOpen}\r\n          side={'right'}\r\n          id=\"editGuestInfo\"\r\n          onIrSidebarToggle={e => {\r\n            e.stopImmediatePropagation();\r\n            e.stopPropagation();\r\n            this.isSidebarOpen = false;\r\n          }}\r\n          showCloseButton={false}\r\n        >\r\n          {this.isSidebarOpen && <ir-hk-archive propertyId={this.property_id} slot=\"sidebar-body\"></ir-hk-archive>}\r\n        </ir-sidebar>\r\n        {/* <ir-title class=\"d-none d-md-flex\" label={locales.entries.Lcz_HousekeepingTasks} justifyContent=\"space-between\">\r\n            <ir-button slot=\"title-body\" text={locales.entries.Lcz_Archive} size=\"sm\"></ir-button>\r\n          </ir-title> */}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n","import Token from '@/models/Token';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport { updateHKStore } from '@/stores/housekeeping.store';\r\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\nimport { IToast } from '@components/ui/ir-toast/toast';\r\n@Component({\r\n  tag: 'ir-housekeeping',\r\n  styleUrl: 'ir-housekeeping.css',\r\n  scoped: true,\r\n})\r\nexport class IrHousekeeping {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n\r\n  @Prop() propertyid: number;\r\n  @Prop() p: string;\r\n\r\n  @State() isLoading = false;\r\n\r\n  @Event() toast: EventEmitter<IToast>;\r\n\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n  private token = new Token();\r\n\r\n  componentWillLoad() {\r\n    if (this.ticket !== '') {\r\n      this.token.setToken(this.ticket);\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Listen('resetData')\r\n  async handleResetData(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\r\n  }\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.initializeApp();\r\n  }\r\n\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      let propertyId = this.propertyid;\r\n      if (!propertyId) {\r\n        const propertyData = await this.roomService.getExposedProperty({\r\n          id: 0,\r\n          aname: this.p,\r\n          language: this.language,\r\n          is_backend: true,\r\n          include_sales_rate_plans: true,\r\n        });\r\n        propertyId = propertyData.My_Result.id;\r\n      }\r\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\r\n      const requests = [this.houseKeepingService.getExposedHKSetup(propertyId), this.roomService.fetchLanguage(this.language, ['_HK_FRONT'])];\r\n\r\n      if (this.propertyid) {\r\n        requests.unshift(\r\n          this.roomService.getExposedProperty({\r\n            id: propertyId,\r\n            language: this.language,\r\n            is_backend: true,\r\n            include_sales_rate_plans: true,\r\n          }),\r\n        );\r\n      }\r\n\r\n      await Promise.all(requests);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  private saveAutomaticCheckInCheckout(e: CustomEvent): void {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    try {\r\n      this.roomService.SetAutomaticCheckInOut({\r\n        property_id: this.propertyid,\r\n        flag: e.detail === 'auto',\r\n      });\r\n      this.toast.emit({\r\n        position: 'top-right',\r\n        title: 'Saved Successfully',\r\n        description: '',\r\n        type: 'success',\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-interceptor></ir-interceptor>\r\n        <ir-toast></ir-toast>\r\n        <section class=\"p-1\">\r\n          <h3 class=\"mb-2\">Housekeeping & Check-In Setup</h3>\r\n          <div class=\"card p-1\">\r\n            <ir-title borderShown label=\"Check-In Mode\"></ir-title>\r\n            <div class={'d-flex align-items-center'}>\r\n              <p class=\"my-0 py-0 mr-1  \">Check in & Check out guests automatically:</p>\r\n              <ir-select\r\n                LabelAvailable={false}\r\n                showFirstOption={false}\r\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\r\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\r\n                data={[\r\n                  { text: `Yes, as per the property's policy.`, value: 'auto' },\r\n                  { text: 'No, I will do it manually. ', value: 'manual' },\r\n                ]}\r\n              ></ir-select>\r\n            </div>\r\n          </div>\r\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\r\n          <ir-hk-team class=\"mb-1\"></ir-hk-team>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"names":["moment"],"mappings":"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"}