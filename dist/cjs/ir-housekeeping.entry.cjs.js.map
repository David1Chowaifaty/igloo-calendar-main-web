{"version":3,"file":"ir-housekeeping.entry.cjs.js","sources":["src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n","import Token from '@/models/Token';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport { updateHKStore } from '@/stores/housekeeping.store';\r\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\nimport { IToast } from '@components/ui/ir-toast/toast';\r\n@Component({\r\n  tag: 'ir-housekeeping',\r\n  styleUrl: 'ir-housekeeping.css',\r\n  scoped: true,\r\n})\r\nexport class IrHousekeeping {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n\r\n  @Prop() propertyid: number;\r\n  @Prop() p: string;\r\n\r\n  @State() isLoading = false;\r\n\r\n  @Event() toast: EventEmitter<IToast>;\r\n\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n  private token = new Token();\r\n\r\n  componentWillLoad() {\r\n    if (this.ticket !== '') {\r\n      this.token.setToken(this.ticket);\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Listen('resetData')\r\n  async handleResetData(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\r\n  }\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.initializeApp();\r\n  }\r\n\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      let propertyId = this.propertyid;\r\n      if (!propertyId) {\r\n        const propertyData = await this.roomService.getExposedProperty({\r\n          id: 0,\r\n          aname: this.p,\r\n          language: this.language,\r\n          is_backend: true,\r\n          include_sales_rate_plans: true,\r\n        });\r\n        propertyId = propertyData.My_Result.id;\r\n      }\r\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\r\n      const requests = [this.houseKeepingService.getExposedHKSetup(propertyId), this.roomService.fetchLanguage(this.language, ['_HK_FRONT'])];\r\n\r\n      if (this.propertyid) {\r\n        requests.unshift(\r\n          this.roomService.getExposedProperty({\r\n            id: propertyId,\r\n            language: this.language,\r\n            is_backend: true,\r\n            include_sales_rate_plans: true,\r\n          }),\r\n        );\r\n      }\r\n\r\n      await Promise.all(requests);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  private saveAutomaticCheckInCheckout(e: CustomEvent): void {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    try {\r\n      this.roomService.SetAutomaticCheckInOut({\r\n        property_id: this.propertyid,\r\n        flag: e.detail === 'auto',\r\n      });\r\n      this.toast.emit({\r\n        position: 'top-right',\r\n        title: 'Saved Successfully',\r\n        description: '',\r\n        type: 'success',\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-interceptor></ir-interceptor>\r\n        <ir-toast></ir-toast>\r\n        <section class=\"p-1\">\r\n          <h3 class=\"mb-2\">Housekeeping & Check-In Setup</h3>\r\n          <div class=\"card p-1\">\r\n            <ir-title borderShown label=\"Check-In Mode\"></ir-title>\r\n            <div class={'d-flex align-items-center'}>\r\n              <p class=\"my-0 py-0 mr-1  \">Check in & Check out guests automatically:</p>\r\n              <ir-select\r\n                LabelAvailable={false}\r\n                showFirstOption={false}\r\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\r\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\r\n                data={[\r\n                  { text: `Yes, as per the property's policy.`, value: 'auto' },\r\n                  { text: 'No, I will do it manually. ', value: 'manual' },\r\n                ]}\r\n              ></ir-select>\r\n            </div>\r\n          </div>\r\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\r\n          <ir-hk-team class=\"mb-1\"></ir-hk-team>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"names":["RoomService","HouseKeepingService","Token","updateHKStore","h","Host","calendar_data"],"mappings":"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"}