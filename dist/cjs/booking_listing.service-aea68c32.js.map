{"file":"booking_listing.service-aea68c32.js","mappings":"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","names":["axios","z","moment","createStore","isPrivilegedUser","extras"],"sources":["src/services/payment.service.ts","src/stores/booking_listing.store.ts","src/services/booking_listing.service.ts"],"sourcesContent":["import axios from 'axios';\nimport { Payment } from '@/components/ir-booking-details/types';\nexport interface IPaymentAction {\n  amount: number;\n  currency: {\n    code: string;\n    id: number;\n    symbol: string;\n  };\n  due_on: string;\n  reason: string;\n  pay_type_code: string;\n  type: 'OVERDUE' | 'FUTURE';\n}\nexport class PaymentService {\n  public async AddPayment(payment: Payment, book_nbr: string): Promise<any> {\n    try {\n      const { data } = await axios.post(`/Do_Payment`, { payment: { ...payment, book_nbr } });\n      if (data.ExceptionMsg !== '') {\n        throw new Error(data.ExceptionMsg);\n      }\n      return data.My_Result;\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n\n  public async CancelPayment(id: number): Promise<any> {\n    try {\n      const { data } = await axios.post(`/Cancel_Payment`, { id });\n      if (data.ExceptionMsg !== '') {\n        throw new Error(data.ExceptionMsg);\n      }\n      return data.My_Result;\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n  public async GetExposedCancellationDueAmount(params: { booking_nbr: string; currency_id: number }): Promise<IPaymentAction[]> {\n    try {\n      const { data } = await axios.post(`/Get_Exposed_Cancelation_Due_Amount`, params);\n      if (data.ExceptionMsg !== '') {\n        throw new Error(data.ExceptionMsg);\n      }\n      return data.My_Result;\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n}\n","import { IExposedBookingsCriteria } from '@/models/IrBookingListing';\nimport { Booking } from '@/models/booking.dto';\nimport { createStore } from '@stencil/store';\nimport moment from 'moment';\nimport { z } from 'zod';\n\ninterface PaginationRange {\n  from: number;\n  to: number;\n}\n\nexport interface BookingListingPagination {\n  currentPage: number;\n  totalPages: number;\n  totalRecords: number;\n  pageSize: number;\n  showing: PaginationRange;\n}\n\nexport interface IBookingListingStore extends IExposedBookingsCriteria {\n  token: string;\n  userSelection: ExposedBookingsParams;\n  bookings: Booking[];\n  download_url: string | null;\n  rowCount: number;\n  balance_filter: { name: string; value: string }[];\n  pagination: BookingListingPagination;\n}\nconst ymdDate = z.string().regex(/^\\d{4}-\\d{2}-\\d{2}$/, 'Expected date in YYYY-MM-DD format');\nexport const ExposedBookingsParamsSchema = z.object({\n  channel: z.string(),\n\n  // These are null in your initialState, so allow nulls\n  property_id: z.number().int().nullable(),\n  balance_filter: z.string().nullable(),\n  filter_type: z.union([z.number(), z.string()]).nullable(),\n\n  from: ymdDate,\n  to: ymdDate,\n\n  name: z.string(),\n  book_nbr: z.string(),\n  booking_status: z.string(),\n  userTypeCode: z.number().optional(),\n\n  // In the interface these were literal 0/false, but you treat them like values.\n  affiliate_id: z.number().int().default(0),\n  is_mpo_managed: z.boolean().default(false),\n  is_mpo_used: z.boolean().default(false),\n  is_for_mobile: z.boolean().default(false),\n  is_combined_view: z.boolean().default(false),\n\n  start_row: z.number().int(),\n  end_row: z.number().int(),\n  total_count: z.number().int(),\n\n  is_to_export: z.boolean(),\n\n  property_ids: z.array(z.number().int()).optional(),\n});\n\nexport type ExposedBookingsParams = z.infer<typeof ExposedBookingsParamsSchema>;\n\nconst initialState: IBookingListingStore = {\n  channels: [],\n  settlement_methods: [],\n  statuses: [],\n  types: [],\n  token: '',\n  rowCount: 10,\n  bookings: [],\n  balance_filter: [],\n  pagination: {\n    currentPage: 1,\n    totalPages: 0,\n    totalRecords: 0,\n    pageSize: 10,\n    showing: {\n      from: 0,\n      to: 0,\n    },\n  },\n  userSelection: {\n    from: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    to: moment().format('YYYY-MM-DD'),\n    channel: '',\n    balance_filter: null,\n    property_id: null,\n    start_row: 0,\n    end_row: 20,\n    total_count: 0,\n    filter_type: null,\n    name: '',\n    book_nbr: '',\n    booking_status: '',\n    affiliate_id: 0,\n    is_mpo_managed: false,\n    is_mpo_used: false,\n    is_for_mobile: false,\n    is_combined_view: false,\n    is_to_export: false,\n  },\n  download_url: null,\n};\n\nexport const { state: booking_listing, onChange: onBookingListingChange } = createStore<IBookingListingStore>(initialState);\nexport function initializeUserSelection() {\n  //booking_listing.channels[0].name\n  booking_listing.userSelection = {\n    ...booking_listing.userSelection,\n    channel: '',\n    booking_status: booking_listing.statuses[0].code,\n    filter_type: booking_listing.types[0].id,\n    book_nbr: '',\n    name: '',\n    from: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    to: moment().format('YYYY-MM-DD'),\n    start_row: 0,\n    end_row: booking_listing.rowCount,\n    balance_filter: booking_listing.balance_filter[0].value,\n  };\n}\nexport function updateUserSelections(params: Partial<ExposedBookingsParams>) {\n  booking_listing.userSelection = {\n    ...booking_listing.userSelection,\n    ...params,\n  };\n}\nexport function updateUserSelection(key: keyof ExposedBookingsParams, value: any) {\n  booking_listing.userSelection = {\n    ...booking_listing.userSelection,\n    [key]: value,\n  };\n}\n\nconst clamp = (value: number, min: number, max: number) => {\n  return Math.min(Math.max(value, min), max);\n};\n\nconst calculateShowing = (page: number, pageSize: number, totalRecords: number): PaginationRange => {\n  if (totalRecords === 0) {\n    return { from: 0, to: 0 };\n  }\n\n  const startRow = (page - 1) * pageSize;\n  return {\n    from: startRow + 1,\n    to: Math.min(startRow + pageSize, totalRecords),\n  };\n};\n\nconst calculateTotalPages = (totalRecords: number, pageSize: number) => {\n  if (totalRecords === 0) {\n    return 0;\n  }\n  return Math.ceil(totalRecords / pageSize);\n};\n\nconst getRowBounds = (page: number, pageSize: number) => {\n  const startRow = (page - 1) * pageSize;\n  return {\n    startRow,\n    endRow: startRow + pageSize,\n  };\n};\n\nexport function updatePaginationFromSelection(selection: ExposedBookingsParams) {\n  const nextPageSize = selection.end_row - selection.start_row || booking_listing.pagination.pageSize || booking_listing.rowCount;\n  const totalRecords = selection.total_count;\n  const totalPages = calculateTotalPages(totalRecords, nextPageSize);\n  const currentPage = totalPages === 0 ? 1 : Math.floor(selection.start_row / nextPageSize) + 1;\n\n  booking_listing.rowCount = nextPageSize;\n  booking_listing.pagination = {\n    ...booking_listing.pagination,\n    pageSize: nextPageSize,\n    currentPage,\n    totalPages,\n    totalRecords,\n    showing: calculateShowing(currentPage, nextPageSize, totalRecords),\n  };\n}\n\nexport function setPaginationPage(page: number) {\n  const pageSize = booking_listing.pagination.pageSize || booking_listing.rowCount;\n  const totalPages = booking_listing.pagination.totalPages || Math.max(calculateTotalPages(booking_listing.pagination.totalRecords, pageSize), 1);\n  const nextPage = clamp(page, 1, Math.max(totalPages, 1));\n  const { startRow, endRow } = getRowBounds(nextPage, pageSize);\n\n  updateUserSelections({\n    start_row: startRow,\n    end_row: endRow,\n  });\n\n  booking_listing.pagination = {\n    ...booking_listing.pagination,\n    currentPage: nextPage,\n    showing: calculateShowing(nextPage, pageSize, booking_listing.pagination.totalRecords),\n  };\n  return { startRow, endRow };\n}\n\nexport function setPaginationPageSize(pageSize: number) {\n  const normalizedPageSize = Math.max(pageSize, 1);\n  booking_listing.rowCount = normalizedPageSize;\n  const totalRecords = booking_listing.pagination.totalRecords;\n  const totalPages = calculateTotalPages(totalRecords, normalizedPageSize);\n  const nextPage = totalPages === 0 ? 1 : clamp(booking_listing.pagination.currentPage, 1, Math.max(totalPages, 1));\n  const { startRow, endRow } = getRowBounds(nextPage, normalizedPageSize);\n\n  booking_listing.pagination = {\n    ...booking_listing.pagination,\n    pageSize: normalizedPageSize,\n    currentPage: nextPage,\n    totalPages,\n    showing: calculateShowing(nextPage, normalizedPageSize, totalRecords),\n  };\n\n  updateUserSelections({\n    start_row: startRow,\n    end_row: endRow,\n  });\n  return { startRow, endRow };\n}\nexport default booking_listing;\n","import booking_listing, { ExposedBookingsParams, initializeUserSelection } from '@/stores/booking_listing.store';\nimport { extras, isPrivilegedUser } from '@/utils/utils';\nimport axios from 'axios';\n\nexport class BookingListingService {\n  public async getExposedBookingsCriteria(property_id: number) {\n    const { data } = await axios.post(`/Get_Exposed_Bookings_Criteria`, {\n      property_id,\n    });\n    const result = data.My_Result;\n    booking_listing.channels = result.channels;\n    booking_listing.settlement_methods = result.settlement_methods;\n    booking_listing.statuses = result.statuses;\n    booking_listing.types = result.types;\n    booking_listing.balance_filter = result.balance_filter;\n    initializeUserSelection();\n  }\n\n  public async getExposedBookings(params: ExposedBookingsParams) {\n    const { property_id, userTypeCode, channel, property_ids, ...rest } = params;\n    const havePrivilege = isPrivilegedUser(userTypeCode);\n    const { data } = await axios.post(`/Get_Exposed_Bookings`, {\n      ...rest,\n      extras,\n      property_id: havePrivilege ? undefined : property_id,\n      property_ids: havePrivilege ? property_ids : null,\n      channel: havePrivilege ? '' : channel,\n    });\n    const result = data.My_Result;\n    const header = data.My_Params_Get_Exposed_Bookings;\n    booking_listing.bookings = [...result];\n    booking_listing.userSelection = {\n      ...booking_listing.userSelection,\n      total_count: header.total_count,\n    };\n    booking_listing.download_url = header.exported_data_url;\n  }\n  public async removeExposedBooking(booking_nbr: string, is_to_revover: boolean) {\n    await axios.post(`/Remove_Exposed_Booking`, {\n      booking_nbr,\n      is_to_revover,\n    });\n  }\n}\n"],"version":3}