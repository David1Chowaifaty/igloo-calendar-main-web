{"file":"ir-arrivals.entry.cjs.js","mappings":"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","names":["Token","RoomService","BookingService","arrivalsStore","h","Host"],"sources":["src/assets/webawesome/component/host.css?tag=ir-arrivals&encapsulation=scoped","src/global/app.css?tag=ir-arrivals&encapsulation=scoped","src/components/ir-arrivals/ir-arrivals.css?tag=ir-arrivals&encapsulation=scoped","src/components/ir-arrivals/ir-arrivals.tsx"],"sourcesContent":[":host {\n  box-sizing: border-box !important;\n}\n\n:host *,\n:host *::before,\n:host *::after {\n  box-sizing: inherit !important;\n  padding: 0;\n  margin: 0;\n}\n\n[hidden] {\n  display: none !important;\n}\n","/* Web Awesome core styles */\n/* @import url('../assets/webawesome/themes/webawesome.css'); */\n@import url('../assets/webawesome/themes/default.css');\n/* Place project-wide overrides below. */\n.my-custom-style {\n  background: #000;\n  color: white;\n}\n.ir-price {\n  font-family: inherit;\n  font-size: 1rem;\n  font-weight: 800;\n  color: var(--ir-price-color, #1a1a1a);\n  text-align: right;\n  white-space: nowrap;\n}\n.page-title {\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-xl);\n}\n\n:host {\n  --wa-form-control-required-content-color: var(--wa-color-danger-border-loud, #f3676c);\n  padding: var(--wa-space-l);\n}\n/* td {\n  padding: 0 !important;\n} */\n.label-on-left {\n  display: grid;\n  gap: var(--wa-space-m);\n}\nwa-card::part(base) {\n  box-sizing: border-box;\n}\nwa-input[aria-invalid='true']::part(base),\nwa-select[aria-invalid='true']::part(combobox) {\n  border-color: var(--wa-color-danger-border-loud);\n  outline-color: var(--wa-color-danger-border-loud);\n  border-width: 2px;\n}\n\n/* Shared layout for form controls inside wa-select, wa-input, wa-textarea */\n@media (min-width: 768px) {\n  /* .label-on-left wa-switch::part(label) {\n    margin-inline-start: 0;\n    margin-inline-end: 0.5rem;\n  } */\n  .label-on-left {\n    align-items: center;\n    grid-template-columns: auto 1fr;\n  }\n  .label-on-left wa-switch::part(base),\n  .label-on-left wa-select::part(form-control),\n  .label-on-left wa-select,\n  .label-on-left wa-switch,\n  .label-on-left wa-input,\n  .label-on-left wa-textarea {\n    grid-column: 1 / -1;\n    grid-row-end: span 2;\n    display: grid;\n    grid-template-columns: subgrid;\n    gap: 0 var(--wa-space-l);\n    align-items: center;\n  }\n  .label-on-left wa-switch::part(base) {\n    direction: rtl;\n  }\n  .label-on-left wa-switch::part(base) > * {\n    justify-self: flex-start;\n    justify-content: flex-start;\n    direction: ltr; /* fix text direction */\n  }\n  /* Label alignment */\n  .label-on-left ::part(label) {\n    justify-content: flex-end;\n  }\n\n  /* Hint always in second column */\n  .label-on-left ::part(hint) {\n    grid-column: 2;\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-l, 1.5rem);\n  min-height: 100vh;\n}\n.page-title {\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-xl);\n}\n","import { Booking } from '@/models/booking.dto';\nimport Token from '@/models/Token';\nimport { BookingService } from '@/services/booking.service';\nimport { RoomService } from '@/services/room.service';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { Payment, PaymentEntries } from '../ir-booking-details/types';\nimport { arrivalsStore } from '@/stores/arrivals.store';\n\n@Component({\n  tag: 'ir-arrivals',\n  styleUrls: ['../../assets/webawesome/component/host.css', '../../global/app.css', 'ir-arrivals.css'],\n  scoped: true,\n})\nexport class IrArrivals {\n  @Prop() ticket: string;\n  @Prop() propertyid: number;\n  @Prop() language: string = 'en';\n  @Prop() p: string;\n\n  @State() bookingNumber: number;\n  @State() booking: Booking;\n  @State() paymentEntries: PaymentEntries;\n  @State() isPageLoading: boolean;\n  @State() payment: Payment;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private bookingService = new BookingService();\n\n  private paymentFolioRef: HTMLIrPaymentFolioElement;\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue && newValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Listen('payBookingBalance')\n  handleBookingPayment(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { booking_nbr, payment } = e.detail;\n    this.booking = arrivalsStore.bookings.find(b => b.booking_nbr === booking_nbr);\n    this.payment = payment;\n    this.paymentFolioRef.openFolio();\n  }\n\n  @Listen('openBookingDetails')\n  handleOpen(e: CustomEvent) {\n    this.bookingNumber = e.detail;\n  }\n\n  private async init() {\n    try {\n      this.isPageLoading = true;\n      const [_, __, setupEntries] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getSetupEntriesByTableNameMulti(['_BED_PREFERENCE_TYPE', '_DEPARTURE_TIME', '_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n      ]);\n\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n\n      this.paymentEntries = { types: pay_type, groups: pay_type_group, methods: pay_method };\n    } catch (error) {\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast style={{ display: 'none' }}></ir-toast>\n        <ir-interceptor style={{ display: 'none' }}></ir-interceptor>\n        <h3 class=\"page-title\">Arrivals</h3>\n        <ir-arrivals-filters></ir-arrivals-filters>\n        <ir-arrivals-table></ir-arrivals-table>\n        <ir-drawer\n          onDrawerHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.bookingNumber = null;\n          }}\n          withoutHeader\n          open={!!this.bookingNumber}\n          style={{\n            '--ir-drawer-width': '80rem',\n            '--ir-drawer-background-color': '#F2F3F8',\n            '--ir-drawer-padding-left': '0',\n            '--ir-drawer-padding-right': '0',\n            '--ir-drawer-padding-top': '0',\n            '--ir-drawer-padding-bottom': '0',\n          }}\n        >\n          {this.bookingNumber && (\n            <ir-booking-details\n              hasPrint\n              hasReceipt\n              hasCloseButton\n              onCloseSidebar={() => (this.bookingNumber = null)}\n              is_from_front_desk\n              propertyid={this.propertyid as any}\n              hasRoomEdit\n              hasRoomDelete\n              bookingNumber={this.bookingNumber.toString()}\n              ticket={this.ticket}\n              language={this.language}\n              hasRoomAdd\n            ></ir-booking-details>\n          )}\n        </ir-drawer>\n        <ir-payment-folio\n          style={{ height: 'auto' }}\n          bookingNumber={this.booking?.booking_nbr}\n          paymentEntries={this.paymentEntries}\n          payment={this.payment}\n          mode={'payment-action'}\n          ref={el => (this.paymentFolioRef = el)}\n          onCloseModal={() => {\n            this.booking = null;\n            this.payment = null;\n          }}\n        ></ir-payment-folio>\n      </Host>\n    );\n  }\n}\n"],"version":3}