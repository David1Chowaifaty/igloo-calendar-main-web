{"file":"ir-booking-editor-drawer2.js","mappings":"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","names":["moment"],"sources":["src/components/igloo-calendar/ir-booking-editor/ir-booking-editor-drawer/ir-booking-editor-drawer.css?tag=ir-booking-editor-drawer&encapsulation=scoped","src/components/igloo-calendar/ir-booking-editor/ir-booking-editor-drawer/ir-booking-editor-drawer.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n.booking-editor__drawer::part(dialog) {\n  overflow: hidden;\n}\n","import { Component, Event, EventEmitter, Fragment, h, Listen, Prop, State, Watch } from '@stencil/core';\nimport { BlockedDatePayload, BookingEditorMode, BookingStep } from '../types';\nimport { Booking } from '@/models/booking.dto';\nimport { IBlockUnit } from '@/models/IBooking';\nimport Token from '@/models/Token';\nimport booking_store, { hasAtLeastOneRoomSelected } from '@/stores/booking.store';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\nimport { getReleaseHoursString } from '@/utils/utils';\nimport { BookingService } from '@/services/booking-service/booking.service';\n\n@Component({\n  tag: 'ir-booking-editor-drawer',\n  styleUrl: 'ir-booking-editor-drawer.css',\n  scoped: true,\n})\nexport class IrBookingEditorDrawer {\n  /** Controls drawer visibility (reflected to DOM). */\n  @Prop({ reflect: true }) open: boolean;\n\n  /** Auth token used for API requests. */\n  @Prop() ticket: string;\n\n  /** Property identifier. */\n  @Prop() propertyid: string;\n\n  /** UI language code (default: `en`). */\n  @Prop() language: string = 'en';\n\n  /** Booking being created or edited. */\n  @Prop() booking: Booking;\n\n  /** Current booking editor mode. */\n  @Prop() mode: BookingEditorMode = 'PLUS_BOOKING';\n\n  /** Optional drawer title override. */\n  @Prop() label: string;\n\n  /** Check-in date (ISO string). */\n  @Prop() checkIn: string;\n\n  /** Check-out date (ISO string). */\n  @Prop() checkOut: string;\n\n  /** Selected unit identifier. */\n  @Prop() unitId: string;\n\n  /** Payload for blocked unit dates. */\n  @Prop({ mutable: true }) blockedUnit: BlockedDatePayload;\n\n  /** Allowed room type identifiers. */\n  @Prop() roomTypeIds: (string | number)[] = [];\n\n  /** Room identifier used by the editor. */\n  @Prop() roomIdentifier: string;\n\n  @State() step: BookingStep = 'details';\n  @State() isLoading: string;\n\n  /** Emitted when the booking editor drawer is closed. */\n  @Event() bookingEditorClosed: EventEmitter<void>;\n\n  private token = new Token();\n\n  private bookingService = new BookingService();\n\n  private wasBlockedUnit = false;\n  private didAdjustBlockedUnit = false;\n  private originalBlockPayload?: IBlockUnit;\n\n  componentWillLoad() {\n    if (this.token) {\n      this.token.setToken(this.ticket);\n    }\n    this.initializeBlockedUnitState(this.blockedUnit);\n  }\n\n  @Watch('ticket')\n  handleTicketChange() {\n    if (this.token) {\n      this.token.setToken(this.ticket);\n    }\n  }\n\n  @Watch('blockedUnit')\n  handleBlockedUnitChange(newValue?: BlockedDatePayload) {\n    this.initializeBlockedUnitState(newValue);\n  }\n\n  @Watch('checkIn')\n  handleCheckInChange() {\n    this.initializeBlockedUnitState(this.blockedUnit);\n  }\n\n  @Watch('checkOut')\n  handleCheckOutChange() {\n    this.initializeBlockedUnitState(this.blockedUnit);\n  }\n\n  @Watch('unitId')\n  handleUnitChange() {\n    this.initializeBlockedUnitState(this.blockedUnit);\n  }\n\n  private initializeBlockedUnitState(blockedUnit?: BlockedDatePayload) {\n    const allowedStatusCodes = ['002', '003', '004'];\n    if (!blockedUnit) {\n      this.wasBlockedUnit = false;\n      this.originalBlockPayload = undefined;\n      return;\n    }\n    const hasBlockMetadata = Boolean(blockedUnit && allowedStatusCodes.includes(blockedUnit.STATUS_CODE));\n    if (!hasBlockMetadata || !this.checkIn || !this.checkOut || !this.unitId) {\n      this.wasBlockedUnit = false;\n      this.originalBlockPayload = undefined;\n      this.didAdjustBlockedUnit = false;\n      return;\n    }\n\n    this.originalBlockPayload = {\n      from_date: this.checkIn,\n      to_date: this.checkOut,\n      NOTES: blockedUnit.OPTIONAL_REASON || '',\n      pr_id: this.unitId.toString(),\n      STAY_STATUS_CODE: (blockedUnit.STATUS_CODE || (blockedUnit.OUT_OF_SERVICE ? '004' : Number(blockedUnit.RELEASE_AFTER_HOURS) === 0 ? '002' : '003')) as any,\n      DESCRIPTION: blockedUnit.RELEASE_AFTER_HOURS || '',\n      BLOCKED_TILL_DATE: blockedUnit.ENTRY_DATE || undefined,\n      BLOCKED_TILL_HOUR: blockedUnit.ENTRY_HOUR !== undefined && blockedUnit.ENTRY_HOUR !== null ? blockedUnit.ENTRY_HOUR.toString() : undefined,\n      BLOCKED_TILL_MINUTE: blockedUnit.ENTRY_MINUTE !== undefined && blockedUnit.ENTRY_MINUTE !== null ? blockedUnit.ENTRY_MINUTE.toString() : undefined,\n    };\n    this.wasBlockedUnit = true;\n    this.didAdjustBlockedUnit = false;\n  }\n\n  @Listen('bookingStepChange')\n  handleBookingStepChange(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { direction } = e.detail;\n    switch (direction) {\n      case 'next':\n        this.step = 'confirm';\n        break;\n      case 'prev':\n        this.step = 'details';\n        break;\n      default:\n        console.warn('Direction not supported');\n    }\n  }\n\n  private get drawerLabel() {\n    if (this.label) {\n      return this.label;\n    }\n    switch (this.mode) {\n      case 'SPLIT_BOOKING':\n      case 'BAR_BOOKING':\n      case 'ADD_ROOM':\n      case 'EDIT_BOOKING':\n      case 'PLUS_BOOKING':\n        return 'New Booking';\n    }\n  }\n\n  private goToConfirm = (e?: CustomEvent) => {\n    e?.stopPropagation();\n    this.step = 'confirm';\n  };\n\n  private goToDetails = () => {\n    this.step = 'details';\n  };\n\n  private renderFooter() {\n    switch (this.step) {\n      case 'details':\n        return this.renderDetailsActions();\n      case 'confirm':\n        return this.renderConfirmActions();\n      default:\n        return null;\n    }\n  }\n\n  private renderConfirmActions() {\n    const { checkIn } = booking_store?.bookingDraft?.dates;\n    const hasCheckIn = checkIn ? checkIn?.isSame(moment(), 'date') : false;\n    return (\n      <Fragment>\n        <ir-custom-button onClickHandler={this.goToDetails} size=\"medium\" appearance=\"filled\" variant=\"neutral\">\n          Back\n        </ir-custom-button>\n        <ir-custom-button\n          loading={this.isLoading === 'book'}\n          value=\"book\"\n          form=\"new_booking_form\"\n          disabled={false}\n          type=\"submit\"\n          size=\"medium\"\n          appearance={hasCheckIn ? 'outlined' : 'accent'}\n          variant=\"brand\"\n        >\n          Book\n        </ir-custom-button>\n        {hasCheckIn && (\n          <ir-custom-button\n            loading={this.isLoading === 'book-checkin'}\n            value=\"book-checkin\"\n            form=\"new_booking_form\"\n            type=\"submit\"\n            size=\"medium\"\n            appearance=\"accent\"\n            variant=\"brand\"\n          >\n            Book and check-in\n          </ir-custom-button>\n        )}\n      </Fragment>\n    );\n  }\n\n  private renderDetailsActions() {\n    const haveRoomSelected = hasAtLeastOneRoomSelected();\n    return (\n      <Fragment>\n        <ir-custom-button data-drawer=\"close\" size=\"medium\" appearance=\"filled\" variant=\"neutral\">\n          Cancel\n        </ir-custom-button>\n        {['EDIT_BOOKING', 'PLUS_BOOKING', 'ADD_ROOM'].includes(this.mode) && (\n          <Fragment>\n            {!haveRoomSelected && <wa-tooltip for=\"booking_editor__next-button\">Please select at least one unit to continue.</wa-tooltip>}\n            <ir-custom-button id=\"booking_editor__next-button\" disabled={!haveRoomSelected} onClickHandler={this.goToConfirm} size=\"medium\" appearance=\"accent\" variant=\"brand\">\n              Next\n            </ir-custom-button>\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n  private async closeDrawer() {\n    if (this.wasBlockedUnit && !this.didAdjustBlockedUnit) {\n      await this.checkAndBlockDate();\n    } else if (this.blockedUnit && this.blockedUnit.STATUS_CODE) {\n      await this.handleBlockDate();\n    }\n    this.bookingEditorClosed.emit();\n    this.step = 'details';\n  }\n\n  private getBlockUnitPayload(): IBlockUnit | undefined {\n    if (this.wasBlockedUnit && this.originalBlockPayload) {\n      return this.originalBlockPayload;\n    }\n    if (!this.blockedUnit || !this.checkIn || !this.checkOut || !this.unitId) {\n      return undefined;\n    }\n    const releaseData = getReleaseHoursString(this.blockedUnit.RELEASE_AFTER_HOURS !== null ? Number(this.blockedUnit.RELEASE_AFTER_HOURS) : null);\n    return {\n      from_date: this.checkIn,\n      to_date: this.checkOut,\n      NOTES: this.blockedUnit.OPTIONAL_REASON || '',\n      pr_id: this.unitId.toString(),\n      STAY_STATUS_CODE: this.blockedUnit.OUT_OF_SERVICE ? '004' : Number(this.blockedUnit.RELEASE_AFTER_HOURS) === 0 ? '002' : '003',\n      DESCRIPTION: this.blockedUnit.RELEASE_AFTER_HOURS || '',\n      ...releaseData,\n    };\n  }\n\n  private async handleBlockDate(autoReset = true, overridePayload?: IBlockUnit) {\n    try {\n      const payload = overridePayload ?? this.getBlockUnitPayload();\n      if (!payload) {\n        return;\n      }\n      await this.bookingService.blockUnit(payload);\n      if (autoReset) {\n        this.blockedUnit = undefined;\n        this.initializeBlockedUnitState(undefined);\n      }\n    } catch (error) {}\n  }\n\n  private async handleAdjustBlockedUnitEvent(event: CustomEvent<any>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    try {\n      await this.adjustBlockedDatesAfterReservation(event.detail);\n      this.didAdjustBlockedUnit = true;\n    } catch (error) {\n      console.error('Error adjusting blocked unit:', error);\n    }\n  }\n\n  private async adjustBlockedDatesAfterReservation(serviceParams: any) {\n    if (!this.wasBlockedUnit || !this.originalBlockPayload) {\n      return;\n    }\n    const original_from_date = moment(this.originalBlockPayload.from_date, 'YYYY-MM-DD');\n    const current_from_date = moment(serviceParams.booking.from_date, 'YYYY-MM-DD');\n    const original_to_date = moment(this.originalBlockPayload.to_date, 'YYYY-MM-DD');\n    const current_to_date = moment(serviceParams.booking.to_date, 'YYYY-MM-DD');\n    if (current_to_date.isBefore(original_to_date, 'days')) {\n      const props = { ...this.originalBlockPayload, from_date: current_to_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    if (current_from_date.isAfter(original_from_date, 'days')) {\n      const props = { ...this.originalBlockPayload, to_date: current_from_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    return;\n  }\n\n  private async checkAndBlockDate() {\n    try {\n      if (!this.originalBlockPayload || !this.roomTypeIds || this.roomTypeIds.length === 0) {\n        return;\n      }\n      const roomTypeIds = this.roomTypeIds.map(id => Number(id)).filter(id => !Number.isNaN(id));\n      if (roomTypeIds.length === 0) {\n        return;\n      }\n      await this.bookingService.getBookingAvailability({\n        from_date: this.originalBlockPayload.from_date,\n        to_date: this.originalBlockPayload.to_date,\n        propertyid: calendar_data.property.id,\n        adultChildCount: {\n          adult: 2,\n          child: 0,\n        },\n        language: this.language,\n        room_type_ids: roomTypeIds,\n        currency: calendar_data.property?.currency,\n      });\n      const isAvailable = booking_store.roomTypes.every(rt => {\n        if (rt.is_available_to_book) {\n          return true;\n        }\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\n      });\n      if (isAvailable) {\n        await this.handleBlockDate();\n      } else {\n        console.warn('Blocked date is unavailable. Continuing...');\n      }\n    } catch (error) {\n      console.error('Error checking and blocking date:', error);\n    }\n  }\n  render() {\n    return (\n      <ir-drawer\n        onDrawerHide={async event => {\n          event.stopImmediatePropagation();\n          event.stopPropagation();\n          await this.closeDrawer();\n        }}\n        style={{\n          '--ir-drawer-width': '70rem',\n        }}\n        class=\"booking-editor__drawer\"\n        label={this.drawerLabel}\n        open={this.open}\n      >\n        {this.open && this.ticket && (\n          <ir-booking-editor\n            onLoadingChanged={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              this.isLoading = e.detail.cause;\n            }}\n            onAdjustBlockedUnit={event => this.handleAdjustBlockedUnitEvent(event)}\n            unitId={this.unitId}\n            propertyId={this.propertyid}\n            roomTypeIds={this.roomTypeIds}\n            onResetBookingEvt={async () => {\n              this.blockedUnit = undefined;\n              this.initializeBlockedUnitState(undefined);\n              await this.closeDrawer();\n            }}\n            step={this.step}\n            blockedUnit={this.blockedUnit}\n            language={this.language}\n            booking={this.booking}\n            mode={this.mode}\n            checkIn={this.checkIn}\n            checkOut={this.checkOut}\n            identifier={this.roomIdentifier}\n          ></ir-booking-editor>\n        )}\n        <div slot=\"footer\" class=\"ir__drawer-footer\">\n          {this.renderFooter()}\n        </div>\n      </ir-drawer>\n    );\n  }\n}\n"],"version":3}