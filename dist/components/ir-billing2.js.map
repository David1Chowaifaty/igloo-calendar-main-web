{"file":"ir-billing2.js","mappings":"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","names":["moment"],"sources":["src/components/ir-billing/ir-billing.css?tag=ir-billing&encapsulation=scoped","src/common/table.css?tag=ir-billing&encapsulation=scoped","src/components/ir-billing/ir-billing.tsx"],"sourcesContent":[":host {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.billing__container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-l);\n}\n.billing__section-title-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 1rem;\n}\n.billing__section-title {\n  margin: 0;\n  padding: 0;\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-m);\n}\n.billing__actions-row {\n  display: flex;\n  align-items: center;\n  /* justify-content: center; */\n  justify-content: flex-end;\n  /* min-width: 160px; */\n  gap: 0.5rem;\n}\n.billing__invoice-nbr {\n  margin: 0;\n  padding: 0;\n}\n.billing__invoice-nbr.--secondary {\n  font-size: 0.75rem;\n}\n.billing__price-col {\n  text-align: end !important;\n}\n\n/* Billing Cards Container */\n.billing__cards {\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-m);\n  padding-bottom: var(--wa-space-l) !important;\n}\n\n/* Individual Card */\n.billing__card {\n  display: block;\n}\n\n/* Header */\n.billing__card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n\n.billing__card-header-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.billing__card-number {\n  margin: 0;\n  font-weight: var(--wa-font-weight-heading);\n  font-family: var(--wa-font-family-heading);\n}\n\n.billing__card-type {\n  margin: 0;\n  font-size: var(--wa-font-size-xs);\n  color: var(--wa-color-text-secondary);\n}\n\n/* PDF Download Button */\n.billing__card-download-btn {\n  display: flex;\n  align-items: center;\n}\n\n/* Details Section */\n.billing__card-details {\n  display: flex;\n  /* flex-direction: column; */\n  gap: var(--wa-space-xs);\n  justify-content: space-between;\n}\n\n.billing__card-detail {\n  display: flex;\n  flex-direction: column;\n}\n\n.billing__card-detail-label {\n  margin: 0;\n  font-size: var(--wa-font-size-xs);\n  color: var(--wa-color-text-quiet);\n}\n.billing__card-detail-label.--amount {\n  text-align: end !important;\n}\n.billing__card-detail-value {\n  margin: 0;\n  font-weight: var(--wa-font-weight-regular);\n  font-size: var(--wa-font-size-s);\n}\n.billing__card-void-btn {\n  flex: 1 1 0%;\n}\n\n/* Footer (Void button) */\n.billing__card-footer {\n  display: flex;\n}\n.table-container {\n  display: none;\n}\n.billing__card::part(footer) {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n/*md*/\n@media (min-width: 768px) {\n  .billing__cards {\n    display: none;\n  }\n  .table-container {\n    display: block;\n  }\n}\n","/* Base styles */\n.ir-table-row td {\n  padding: 0.5rem 1rem !important;\n  text-align: left;\n  z-index: 2;\n  background-color: var(--wa-color-surface-default);\n  white-space: nowrap;\n  color: var(--wa-color-text-normal);\n  box-sizing: border-box;\n  /* width: max-content;\n  max-width: max-content; */\n}\n/* .ir-table-row td:last-child {\n  width: 100%; \n}*/\n/* .ir-table-row td:first-child,\n.table thead th:first-child {\n  position: sticky;\n  left: var(--ir-table-sticky-padding,-1rem);\n} */\n/* .table--container {\n  flex: 1 1 0%;\n} */\n.table--container {\n  overflow-x: auto;\n}\n.table td {\n  border-top: 0;\n  border-bottom: 1px solid var(--wa-color-neutral-border-quiet, #abaeb9);\n  /* border-bottom: 1px solid var(--wa-color-gray-80); */\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.table tbody tr:last-child > td {\n  border-bottom: 0 !important;\n}\n.table thead th {\n  border: none !important;\n  background: #ececec;\n  background: color-mix(in oklab, var(--wa-color-neutral-fill-quiet, #f1f2f3) 60%, transparent);\n  color: #374151;\n  padding: 0.5rem 1rem !important;\n  text-align: left;\n}\n.data-table thead th {\n  box-sizing: border-box;\n  background: var(--wa-color-surface-default) !important;\n  padding-top: 0.5rem !important;\n  padding-bottom: 0.5rem !important;\n  border-bottom: 1px solid var(--wa-color-neutral-90) !important;\n  color: var(--wa-color-text-normal);\n  /* position: sticky;\n  top: 0;\n  z-index: 99; */\n}\n\n.data-table .empty-row {\n  height: 50vh !important;\n  text-align: center;\n  color: var(--wa-color-gray-60);\n}\n\n.data-table--pagination {\n  padding: 0.5rem 1rem;\n  position: sticky;\n  bottom: 0;\n  background: var(--wa-color-surface-default);\n  border-top: 1px solid var(--wa-color-neutral-90);\n}\n\n/* Selected Rows Styles */\n\n.selected td {\n  background: #e3f3fa !important;\n}\n.selected td {\n  color: var(--gray-dark) !important;\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n\n/* Sorting styles */\n.sortable,\n.ir-table-row {\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.sortable {\n  text-transform: capitalize;\n}\n.sortable:hover {\n  color: #212529;\n  background-color: #e2e8f0 !important;\n  border-color: #dae0e5;\n  cursor: pointer;\n}\n.ir-table-row:hover td {\n  background: #e2e6ea3f !important;\n  background: var(--wa-color-neutral-fill-quiet, #f1f2f3) !important;\n}\n.sortable:active {\n  color: #212529;\n  background-color: #e2e8f0;\n  border-color: #d3d9df;\n}\n.sortable svg {\n  color: var(--blue);\n}\n/* .action-row {\n  position: sticky;\n  right:var(--ir-table-sticky-padding,-1rem);\n} */\n.sticky-column {\n  position: sticky !important;\n  right: 0;\n  background-color: white;\n}\n.table--container,\n.data-table {\n  height: 100%;\n}\n","import { Booking } from '@/models/booking.dto';\nimport { Component, Event, EventEmitter, Fragment, Listen, Prop, State, h } from '@stencil/core';\nimport { BookingInvoiceInfo, Invoice } from '../ir-invoice/types';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { downloadFile, formatAmount } from '@/utils/utils';\nimport moment from 'moment';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { v4 } from 'uuid';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  tag: 'ir-billing',\n  styleUrls: ['ir-billing.css', '../../common/table.css'],\n  scoped: true,\n})\nexport class IrBilling {\n  @Prop() booking: Booking;\n\n  @State() isOpen: 'invoice' = null;\n  @State() isLoading: 'page' | 'void' = 'page';\n  @State() invoiceInfo: BookingInvoiceInfo;\n  @State() selectedInvoice: string = null;\n\n  @Event() billingClose: EventEmitter<void>;\n\n  private bookingService = new BookingService();\n  private _id = `issue_invoice__btn_${v4()}`;\n\n  componentWillLoad() {\n    this.init();\n  }\n  @Listen('invoiceCreated')\n  async handleInvoiceCreation(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.invoiceInfo = { ...e.detail };\n  }\n  private async init() {\n    try {\n      this.isLoading = 'page';\n      this.invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  private async voidInvoice(e: CustomEvent) {\n    this.isLoading = 'void';\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingService.voidInvoice({\n      invoice_nbr: this.selectedInvoice,\n      property_id: calendar_data.property.id,\n      reason: '',\n    });\n    this.invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n    this.isLoading = null;\n    this.selectedInvoice = null;\n  }\n\n  private get invoices() {\n    const _invoices: Invoice[] = [];\n    for (const invoice of this.invoiceInfo.invoices) {\n      if (invoice.status.code === 'VALID') {\n        _invoices.push(invoice);\n      } else {\n        _invoices.push({ ...invoice, status: { code: 'VALID', description: '' } });\n        _invoices.push({ ...invoice, date: invoice.credit_note.date });\n      }\n    }\n    return _invoices.sort((a, b) => {\n      const aDate = moment(a.date ?? a.credit_note?.date, 'YYYY-MM-DD');\n      const bDate = moment(b.date ?? b.credit_note?.date, 'YYYY-MM-DD');\n      return aDate.diff(bDate); // ASC order\n    });\n  }\n\n  private async printInvoice(invoice: Invoice, autoDownload = false) {\n    try {\n      const { My_Result } = await this.bookingService.printInvoice({\n        property_id: calendar_data.property.id,\n        invoice_nbr: invoice.nbr,\n        mode: invoice.credit_note ? 'creditnote' : 'invoice',\n      });\n      if (!My_Result) {\n        return;\n      }\n      if (autoDownload) {\n        downloadFile(My_Result);\n        return;\n      }\n      window.open(My_Result);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    if (this.isLoading === 'page') {\n      return (\n        <div class=\"drawer__loader-container\">\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    const canIssueInvoice = !moment().isBefore(moment(this.booking.from_date, 'YYYY-MM-DD'), 'dates');\n    return (\n      <Fragment>\n        <div class=\"billing__container\">\n          <section>\n            <div class=\"billing__section-title-row\">\n              <h4 class=\"billing__section-title\">Issued documents</h4>\n              {!canIssueInvoice && <wa-tooltip for={this._id}>Invoices cannot be issued before guest arrival</wa-tooltip>}\n              <ir-custom-button\n                variant=\"brand\"\n                id={this._id}\n                onClickHandler={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.isOpen = 'invoice';\n                }}\n                disabled={!canIssueInvoice}\n              >\n                Issue invoice\n              </ir-custom-button>\n            </div>\n            <div class=\"table-container\">\n              <table class=\"table\">\n                <thead>\n                  <tr>\n                    {/* <th>Type</th> */}\n                    <th>Date</th>\n                    <th>Number</th>\n                    <th class=\"billing__price-col\">Amount</th>\n                    <th></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {this.invoices?.map(invoice => {\n                    const isValid = invoice.status.code === 'VALID';\n                    return (\n                      <tr class=\"ir-table-row\">\n                        {/* <td>{isValid ? 'Invoice' : 'Credit note'}</td> */}\n                        <td>\n                          {invoice.status.code === 'VALID'\n                            ? moment(invoice.date, 'YYYY-MM-DD').format('MMM DD, YYYY')\n                            : moment(invoice.credit_note.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}\n                        </td>\n                        <td>\n                          <p class=\"billing__invoice-nbr\">\n                            <b>{isValid ? 'Invoice' : 'Credit note'}:</b> {isValid ? invoice.nbr : invoice.credit_note.nbr}\n                          </p>\n                          {!isValid && <p class=\"billing__invoice-nbr --secondary\">{invoice.nbr}</p>}\n                        </td>\n                        <td class=\"billing__price-col\">\n                          <span class=\"ir-price\" style={{ fontWeight: '400' }}>\n                            {formatAmount(invoice.currency.symbol, invoice.total_amount)}\n                          </span>\n                        </td>\n                        <td>\n                          <div class=\"billing__actions-row\">\n                            <wa-dropdown\n                              onwa-hide={e => {\n                                e.stopImmediatePropagation();\n                                e.stopPropagation();\n                              }}\n                              onwa-select={async e => {\n                                switch ((e.detail as any).item.value) {\n                                  case 'print':\n                                    this.printInvoice(invoice, true);\n                                    break;\n                                  case 'view-print':\n                                    this.printInvoice(invoice);\n                                    break;\n                                  case 'void':\n                                    this.selectedInvoice = invoice.nbr;\n                                    break;\n                                }\n                              }}\n                            >\n                              <h3>Issued by: {invoice.credit_note ? invoice.credit_note.user : invoice.user}</h3>\n                              <wa-divider></wa-divider>\n                              {/* <h3>Actions</h3> */}\n                              <wa-dropdown-item value=\"view-print\">\n                                Open PDF\n                                {isRequestPending('/Print_Invoice') && <wa-spinner slot=\"details\"></wa-spinner>}\n                              </wa-dropdown-item>\n                              {isValid && !invoice.credit_note && (\n                                <wa-dropdown-item variant=\"danger\" value=\"void\">\n                                  Void with credit note\n                                </wa-dropdown-item>\n                              )}\n                              {/* <wa-tooltip for={`pdf-${invoice.system_id}`}>Download pdf</wa-tooltip> */}\n                              <ir-custom-button slot=\"trigger\" id={`pdf-${invoice.system_id}`} variant=\"neutral\" appearance=\"plain\">\n                                <wa-icon name=\"ellipsis-vertical\" style={{ fontSize: '1rem' }}></wa-icon>\n                              </ir-custom-button>\n                            </wa-dropdown>\n                          </div>\n                        </td>\n                        {/* <p>\n                    {this.booking.guest.first_name} {this.booking.guest.last_name}\n                  </p> */}\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n            <div class=\"billing__cards\">\n              {this.invoices?.map(invoice => {\n                const isValid = invoice.status.code === 'VALID';\n\n                return (\n                  <wa-card key={invoice.nbr} class=\"billing__card\">\n                    <div class=\"billing__card-header\">\n                      <div class=\"billing__card-header-info\">\n                        <p class=\"billing__card-number\">\n                          {isValid ? 'Invoice' : 'Credit note'}:{isValid ? invoice.nbr : invoice.credit_note.nbr}\n                        </p>\n                        <p class=\"billing__card-type\">{isValid ? '' : invoice.nbr}</p>\n                      </div>\n                      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'flex-end' }}>\n                        <wa-tooltip for={`mobile-download-pdf-${invoice.system_id}`}>Open PDF</wa-tooltip>\n                        <ir-custom-button\n                          onClickHandler={() => this.printInvoice(invoice)}\n                          loading={isRequestPending('/Print_Invoice')}\n                          id={`mobile-download-pdf-${invoice.system_id}`}\n                          variant=\"neutral\"\n                          appearance=\"plain\"\n                          class=\"billing__card-download-btn\"\n                        >\n                          <wa-icon name=\"file-pdf\" style={{ fontSize: '1rem' }}></wa-icon>\n                        </ir-custom-button>\n                      </div>\n                    </div>\n\n                    <div class=\"billing__card-details\">\n                      <div class=\"billing__card-detail\">\n                        <p class=\"billing__card-detail-label\">Date</p>\n                        <p class=\"billing__card-detail-value\">\n                          {' '}\n                          {isValid ? moment(invoice.date, 'YYYY-MM-DD').format('MMM DD, YYYY') : moment(invoice.credit_note.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}\n                        </p>\n                      </div>\n\n                      <div class=\"billing__card-detail\">\n                        <p class=\"billing__card-detail-label --amount\">Amount</p>\n                        <p class=\"billing__card-detail-value\">{formatAmount(invoice.currency.symbol, invoice.total_amount ?? 0)}</p>\n                      </div>\n                    </div>\n\n                    {isValid && !invoice.credit_note && (\n                      <div slot=\"footer\" class=\"billing__card-footer\">\n                        <ir-custom-button\n                          onClickHandler={() => {\n                            this.selectedInvoice = invoice.nbr;\n                          }}\n                          variant=\"danger\"\n                          appearance=\"outlined\"\n                          class=\"billing__card-void-btn\"\n                        >\n                          Void with credit note\n                        </ir-custom-button>\n                      </div>\n                    )}\n                  </wa-card>\n                );\n              })}\n            </div>\n            {this.invoiceInfo.invoices?.length === 0 && <ir-empty-state style={{ width: '100%', height: '40vh' }}></ir-empty-state>}\n          </section>\n        </div>\n        <ir-invoice\n          invoiceInfo={this.invoiceInfo}\n          onInvoiceClose={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.isOpen = null;\n          }}\n          open={this.isOpen === 'invoice'}\n          booking={this.booking}\n        ></ir-invoice>\n        <ir-dialog\n          label=\"Alert\"\n          open={this.selectedInvoice !== null}\n          lightDismiss={false}\n          onIrDialogHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n          }}\n          onIrDialogAfterHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.selectedInvoice = null;\n          }}\n        >\n          <p>Void invoice {this.selectedInvoice} by generating a credit note?</p>\n          <div slot=\"footer\" class=\"ir-dialog__footer\">\n            <ir-custom-button data-dialog=\"close\" size=\"medium\" appearance=\"filled\" variant=\"neutral\">\n              Cancel\n            </ir-custom-button>\n            <ir-custom-button loading={this.isLoading === 'void'} onClickHandler={this.voidInvoice.bind(this)} size=\"medium\" variant=\"danger\">\n              Confirm\n            </ir-custom-button>\n          </div>\n        </ir-dialog>\n      </Fragment>\n    );\n  }\n}\n"],"version":3}