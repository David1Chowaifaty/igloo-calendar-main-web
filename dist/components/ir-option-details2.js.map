{"file":"ir-option-details2.js","mappings":"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","names":[],"sources":["src/services/payment_option.service.ts","src/stores/payment-option.store.ts","src/components/ir-payment-option/ir-option-details/ir-option-details.css?tag=ir-option-details&encapsulation=scoped","src/components/ir-payment-option/ir-option-details/ir-option-details.tsx"],"sourcesContent":["import { MissingTokenError, Token } from '@/models/Token';\nimport axios from 'axios';\nimport { PaymentOption } from '@/models/payment-options';\n\nexport class PaymentOptionService extends Token {\n  public async GetExposedPaymentMethods() {\n    const token = this.getToken();\n    if (!token) {\n      throw new MissingTokenError();\n    }\n    const { data } = await axios.post(`/Get_Exposed_Payment_Methods?Ticket=${token}`);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    const results = data.My_Result;\n    return results;\n  }\n  public async GetPropertyPaymentMethods(property_id: string) {\n    const token = this.getToken();\n    if (!token) {\n      throw new MissingTokenError();\n    }\n    const { data } = await axios.post(`/Get_Property_Payment_Methods?Ticket=${token}`, { property_id, is_return_sensitive_data: true });\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    const results = data.My_Result;\n    return results;\n  }\n  public async GetExposedLanguages() {\n    const token = this.getToken();\n    if (!token) {\n      throw new MissingTokenError();\n    }\n    const { data } = await axios.post(`/Get_Exposed_Languages?Ticket=${token}`);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    const results = data.My_Result;\n    return results;\n  }\n  public async HandlePaymentMethod(paymentOption: PaymentOption) {\n    const token = this.getToken();\n    if (!token) {\n      throw new MissingTokenError();\n    }\n    const { data } = await axios.post(`/Handle_Payment_Method?Ticket=${token}`, paymentOption);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    const results = data.My_Result;\n    return results;\n  }\n}\n","import { createStore } from '@stencil/store';\nimport { ILanguages, PaymentOption } from '@/models/payment-options';\nexport interface IPaymentOptionStore {\n  selectedOption: PaymentOption | null;\n  token: string;\n  languages: ILanguages[];\n}\nconst initialState: IPaymentOptionStore = {\n  selectedOption: null,\n  token: null,\n  languages: null,\n};\nexport const { state: payment_option_store } = createStore<IPaymentOptionStore>(initialState);\n\nexport default payment_option_store;\n",":host {\n  display: block;\n}\n.money-transfer-form {\n  min-height: 200px !important;\n}\n","import { PaymentOption } from '@/models/payment-options';\nimport { PaymentOptionService } from '@/services/payment_option.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport payment_option_store from '@/stores/payment-option.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, h } from '@stencil/core';\n\n@Component({\n  tag: 'ir-option-details',\n  styleUrl: 'ir-option-details.css',\n  scoped: true,\n})\nexport class IrOptionDetails {\n  @Prop() propertyId: string;\n\n  @State() localizationIdx: number;\n  @State() selectedLanguage: string = null;\n  @State() invalid: boolean = false;\n\n  @Event() closeModal: EventEmitter<PaymentOption | null>;\n\n  private paymentOptionService = new PaymentOptionService();\n\n  async componentWillLoad() {\n    this.paymentOptionService.setToken(payment_option_store.token);\n    if (!payment_option_store.languages) {\n      const result = await this.paymentOptionService.GetExposedLanguages();\n      payment_option_store.languages = result;\n    }\n    this.selectedLanguage = payment_option_store.languages[0].id.toString();\n    this.localizationIdx =\n      payment_option_store.selectedOption.code === '005'\n        ? payment_option_store.selectedOption.localizables.findIndex(l => l.language.id.toString() === this.selectedLanguage)\n        : null;\n  }\n\n  async saveOption(e: Event) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n\n    let selectedOption: PaymentOption = {\n      ...payment_option_store.selectedOption,\n      property_id: this.propertyId,\n      is_active: true,\n    };\n\n    if (selectedOption?.code === '005') {\n      const englishDescription = selectedOption.localizables.find(l => l.language.code.toLowerCase() === 'en')?.description;\n      console.log(englishDescription);\n      // Check if the description is null or empty\n      if (!englishDescription || englishDescription.trim() === '') {\n        this.invalid = true;\n        return;\n      }\n    }\n    if (selectedOption.is_payment_gateway) {\n      selectedOption.display_order = 0;\n      // Check if any value in selectedOption.data is null or empty\n      const hasInvalidData = selectedOption.data.some(d => !d.value || d.value === '');\n      if (hasInvalidData) {\n        this.invalid = true;\n        return;\n      }\n    }\n\n    await this.paymentOptionService.HandlePaymentMethod(selectedOption);\n    this.closeModal.emit(selectedOption);\n  }\n\n  @Listen('selectChange')\n  handleSelectChange(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.selectedLanguage = e.detail;\n    this.localizationIdx =\n      payment_option_store.selectedOption.code === '005'\n        ? payment_option_store.selectedOption.localizables.findIndex(l => l.language.id.toString() === this.selectedLanguage)\n        : null;\n  }\n\n  private handleTextAreaChange(e: CustomEvent) {\n    const value = e.detail;\n    if (value.trim() !== '' && this.invalid) {\n      this.invalid = false;\n    }\n    const oldLocalizables = [...payment_option_store.selectedOption.localizables];\n    oldLocalizables[this.localizationIdx] = {\n      ...oldLocalizables[this.localizationIdx],\n      description: value,\n    };\n    payment_option_store.selectedOption = {\n      ...payment_option_store.selectedOption,\n      localizables: oldLocalizables,\n    };\n  }\n  private handlePaymentGatewayInfoChange(e: CustomEvent, idx: number): void {\n    const value = e.detail;\n    const prevData = [...payment_option_store.selectedOption.data];\n    prevData[idx] = { ...prevData[idx], value };\n    payment_option_store.selectedOption = {\n      ...payment_option_store.selectedOption,\n      data: prevData,\n    };\n  }\n  render() {\n    if (!payment_option_store.selectedOption) {\n      return null;\n    }\n\n    return (\n      <Host>\n        <form class={'p-1 mt-2'} onSubmit={this.saveOption.bind(this)}>\n          {payment_option_store.selectedOption.code === '005' ? (\n            <div>\n              <div class=\"mb-1\">\n                <ir-select\n                  selectedValue={this.selectedLanguage}\n                  LabelAvailable={false}\n                  showFirstOption={false}\n                  data={payment_option_store.languages.map(l => ({\n                    text: l.description,\n                    value: l.id.toString(),\n                  }))}\n                ></ir-select>\n              </div>\n              <div>\n                {this.invalid && <p class=\"text-danger p-0 m-0\">You must fill out the english field.</p>}\n                <ir-textarea\n                  placeholder=\"\"\n                  aria-invalid={this.invalid ? 'true' : 'false'}\n                  textareaClassname=\"money-transfer-form\"\n                  label=\"\"\n                  onTextChange={this.handleTextAreaChange.bind(this)}\n                  value={payment_option_store.selectedOption.localizables[this.localizationIdx].description ?? ''}\n                ></ir-textarea>\n              </div>\n            </div>\n          ) : (\n            <div>\n              {payment_option_store.selectedOption.data?.map((d, idx) => {\n                return (\n                  <fieldset key={d.key}>\n                    <ir-input-text\n                      value={d.value}\n                      onTextChange={e => this.handlePaymentGatewayInfoChange(e, idx)}\n                      id={`input_${d.key}`}\n                      label={d.key}\n                      placeholder=\"\"\n                      aria-invalid={this.invalid && (d.value === null || (d.value ?? '')?.trim() === '') ? 'true' : 'false'}\n                    ></ir-input-text>\n                  </fieldset>\n                );\n              })}\n            </div>\n          )}\n          <div class={'d-flex flex-column flex-sm-row mt-3'}>\n            <ir-button\n              onClick={() => this.closeModal.emit(null)}\n              btn_styles=\"justify-content-center\"\n              class={`mb-1 mb-sm-0 flex-fill mr-sm-1`}\n              icon=\"\"\n              text={'Cancel'}\n              btn_color=\"secondary\"\n              btn_type=\"button\"\n            ></ir-button>\n\n            <ir-button\n              btn_type=\"submit\"\n              btn_styles=\"justify-content-center align-items-center\"\n              class={'m-0 flex-fill text-center'}\n              icon=\"\"\n              isLoading={isRequestPending('/Handle_Payment_Method')}\n              text={'Save'}\n              btn_color=\"primary\"\n            ></ir-button>\n          </div>\n        </form>\n      </Host>\n    );\n  }\n}\n"],"version":3}