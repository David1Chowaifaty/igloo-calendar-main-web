{"file":"ir-booking-billing-recipient2.js","mappings":"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","names":[],"sources":["src/components/ir-booking-billing-recipient/ir-booking-billing-recipient.css?tag=ir-booking-billing-recipient&encapsulation=scoped","src/components/ir-booking-billing-recipient/ir-booking-billing-recipient.tsx"],"sourcesContent":[":host {\n  display: block;\n  padding: 0 !important;\n  box-sizing: border-box;\n}\n.billing-recipient__room::part(label) {\n  display: flex;\n  align-items: center;\n  gap: var(--wa-space-xl);\n  width: 100%;\n}\n\n.billing-recipient__guest-name {\n  font-weight: 500;\n}\n\n.billing-recipient__room-details {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n  font-size: 0.875rem;\n  color: var(--wa-color-neutral-600);\n}\n\n.billing-recipient__roomtype {\n  font-weight: 600;\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-booking-billing-recipient',\n  styleUrls: ['ir-booking-billing-recipient.css'],\n  scoped: true,\n})\nexport class IrBookingBillingRecipient {\n  @Prop({ mutable: true }) booking: Booking;\n\n  @State() selectedRecipient: string;\n  @State() rooms: Booking['rooms'] = [];\n\n  @Event() recipientChange: EventEmitter<string>;\n\n  private initialValue: string;\n  private bookingCompanyFormRef: HTMLIrBookingCompanyFormElement;\n\n  componentWillLoad() {\n    this.initializeDefaultValue();\n  }\n\n  @Watch('booking')\n  handleBookingChange() {\n    this.initializeDefaultValue();\n  }\n\n  private initializeDefaultValue() {\n    this.initialValue = this.booking?.guest?.id?.toString();\n    this.selectedRecipient = this.initialValue;\n    this.filterRoomGuests();\n  }\n\n  private handleRecipientChange(value: string) {\n    this.selectedRecipient = value;\n    switch (value) {\n      case 'company':\n        if (!this.booking.company_name) {\n          this.bookingCompanyFormRef.openCompanyForm();\n          return;\n        }\n        break;\n\n      default:\n        break;\n    }\n    this.recipientChange.emit(this.selectedRecipient);\n  }\n\n  private filterRoomGuests() {\n    const normalize = (str: string) => {\n      return str?.toLocaleLowerCase()?.trim();\n    };\n    const { guest: mainGuest } = this.booking;\n    let _rooms = [];\n    const guests = new Set<string>();\n    const main_guest = `${normalize(mainGuest.first_name)}_${normalize(mainGuest.last_name)}`;\n    guests.add(main_guest);\n    for (const room of this.booking.rooms) {\n      const _g = `${normalize(room.guest.first_name)}_${normalize(room.guest.last_name)}`;\n      if (guests.has(_g)) {\n        continue;\n      }\n      guests.add(_g);\n      _rooms.push(room);\n    }\n    this.rooms = [..._rooms];\n  }\n\n  render() {\n    return (\n      <Host>\n        <wa-radio-group\n          defaultValue={this.initialValue}\n          onchange={e => this.handleRecipientChange((e.target as any).value)}\n          label=\"Bill to\"\n          orientation=\"vertical\"\n          name={`${this.booking?.booking_nbr}-bill-to`}\n          value={this.selectedRecipient}\n        >\n          <wa-radio appearance=\"button\" value={this.booking?.guest?.id?.toString()}>\n            {this.booking?.guest.first_name} {this.booking.guest.last_name}\n          </wa-radio>\n          {this.rooms.map((r, idx) => (\n            <wa-radio appearance=\"button\" class=\"billing-recipient__room\" value={r.guest.id?.toString() ?? `guest_${idx}`} key={r.guest?.id ?? `guest_${idx}`}>\n              <span class=\"billing-recipient__guest-name\">\n                {r.guest.first_name} {r.guest.last_name}\n              </span>\n\n              {/* <div class=\"billing-recipient__room-details\">\n                <b class=\"billing-recipient__roomtype\">{r.roomtype.name}</b>\n                <span class=\"billing-recipient__rateplan\">{r.rateplan.short_name}</span>\n\n                {r.unit && (\n                  <wa-tag variant=\"brand\" size=\"small\" appearance=\"accent\">\n                    {(r.unit as IUnit)?.name}\n                  </wa-tag>\n                )}\n              </div> */}\n            </wa-radio>\n          ))}\n          <wa-radio appearance=\"button\" value=\"company\">\n            {this.booking.company_name ? this.booking.company_name : 'Company'}\n          </wa-radio>\n        </wa-radio-group>\n        <ir-booking-company-form\n          onCompanyFormClosed={() => {\n            if (this.selectedRecipient === 'company' && !this.booking.company_name) {\n              this.handleRecipientChange(this.initialValue);\n            }\n          }}\n          onResetBookingEvt={e => {\n            this.booking = { ...e.detail };\n            if (!this.booking.company_name) {\n              this.handleRecipientChange(this.initialValue);\n            }\n          }}\n          booking={this.booking}\n          ref={el => (this.bookingCompanyFormRef = el)}\n        ></ir-booking-company-form>\n      </Host>\n    );\n  }\n}\n"],"version":3}