{"file":"ir-booking-editor-header2.js","mappings":"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","names":["moment"],"sources":["src/components/igloo-calendar/ir-booking-editor/ir-booking-editor.service.ts","src/components/igloo-calendar/ir-booking-editor/ir-booking-editor-header/ir-booking-editor-header.css?tag=ir-booking-editor-header&encapsulation=scoped","src/components/igloo-calendar/ir-booking-editor/ir-booking-editor-header/ir-booking-editor-header.tsx"],"sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection, modifyBookingStore, reserveRooms } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment, { Moment } from 'moment';\nimport { BookingEditorMode } from './types';\nimport calendar_data from '@/stores/calendar-data';\n\nexport class IRBookingEditorService {\n  /** Current booking editor mode */\n  private mode: BookingEditorMode;\n\n  /** Lazy-initialized variation service */\n  private variationService?: VariationService;\n\n  constructor(mode?: BookingEditorMode) {\n    this.mode = mode;\n  }\n  public setMode(mode: BookingEditorMode) {\n    this.mode = mode;\n  }\n\n  /**\n   * Syncs room data with the booking store and reserves a room.\n   * Aborts if required room data is missing.\n   */\n  public updateBooking(room?: Room): void {\n    if (!room) return;\n\n    try {\n      const roomtypeId = room.roomtype?.id;\n      const rateplanId = room.rateplan?.id;\n      const guestData = room.guest;\n      const occupancy = room.occupancy;\n\n      if (!roomtypeId || !rateplanId || !guestData || !occupancy) {\n        console.warn('[updateBooking] Missing required room data', room);\n        return;\n      }\n\n      const guest = {\n        bed_preference: room.bed_preference?.toString() ?? null,\n        infant_nbr: occupancy.infant_nbr ?? 0,\n        last_name: guestData.last_name ?? '',\n        first_name: guestData.first_name ?? '',\n        unit: (room.unit as any)?.id?.toString() ?? null,\n        roomtype_id: roomtypeId,\n      };\n\n      modifyBookingStore('guest', guest);\n\n      reserveRooms({\n        roomTypeId: roomtypeId,\n        ratePlanId: rateplanId,\n        rooms: 1,\n        guest: [guest],\n      });\n    } catch (error) {\n      console.error('[updateBooking] Failed', error);\n    }\n  }\n\n  /**\n   * Finds a room by identifier and syncs its guest data to the store.\n   */\n  public getRoom(booking?: Booking, identifier?: string): Room | undefined {\n    if (!booking || !identifier) return;\n\n    const room = booking.rooms?.find(r => r.identifier === identifier);\n    if (!room) return;\n\n    modifyBookingStore('guest', {\n      bed_preference: room.bed_preference?.toString() ?? null,\n      infant_nbr: room.occupancy?.infant_nbr ?? 0,\n      first_name: room.guest?.first_name ?? '',\n      last_name: room.guest?.last_name ?? '',\n      unit: (room.unit as any)?.id?.toString() ?? null,\n    });\n\n    return room;\n  }\n\n  // ─────────────────────────────────────────────\n  // Utility helpers\n  // ─────────────────────────────────────────────\n\n  /**\n   * Checks whether a string contains underscores.\n   * Used to validate phone numbers.\n   */\n  private hasUnderscore(str: string): boolean {\n    return /_+/.test(str);\n  }\n  /**\n   * Generates daily rate entries for a reserved room.\n   */\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n  /**\n   * Builds room payloads based on selected rate plans\n   * and booking draft context.\n   */\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Moment;\n    check_out: Moment;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: Number(rateplan.selected_variation.child_nbr ?? 0) - Math.max(Number(rateplan.guest[i].infant_nbr ?? 0), 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n  public isEventType(mode: BookingEditorMode | BookingEditorMode[]): boolean {\n    if (Array.isArray(mode)) {\n      return mode.includes(this.mode);\n    }\n    return this.mode === mode;\n  }\n  /**\n   * Prepares payload parameters for the booking user service\n   * based on the current editor mode.\n   */\n  public async prepareBookUserServiceParams({ check_in, booking, room, unitId }: { check_in: boolean; booking: Booking; room: Room; unitId: string }) {\n    try {\n      // Validate context structure\n      const { dates } = booking_store.bookingDraft;\n\n      const fromDate = dates.checkIn;\n      const toDate = dates.checkOut;\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: this.isEventType(['BAR_BOOKING', 'SPLIT_BOOKING']) ? true : false,\n          unit: this.isEventType(['BAR_BOOKING', 'SPLIT_BOOKING']) ? unitId?.toString() ?? null : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n      const sourceOption = booking_store.bookingDraft.source;\n      switch (this.mode) {\n        case 'EDIT_BOOKING': {\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== room.identifier);\n          const newRooms = generateNewRooms(room.identifier, room.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const newRooms = generateNewRooms();\n          const previousRooms = booking.rooms;\n          newBooking = modifyBookingDetails(booking, [...previousRooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByGuest } = booking_store;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras: [...extras.filter(e => e.key !== 'payment_code'), { key: 'payment_code', value: booking_store.selectedPaymentMethod?.code }],\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            is_email_client: bookedByGuest.emailGuest,\n            booking: {\n              company_name: bookedByGuest.company ?? null,\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByGuest.note || null,\n              booking_nbr: '',\n              property: {\n                id: calendar_data.property.id,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: calendar_data.property.currency,\n              arrival: { code: bookedByGuest.selectedArrivalTime },\n              guest: {\n                email: bookedByGuest.email === '' ? null : bookedByGuest.email || null,\n                first_name: bookedByGuest.firstName,\n                last_name: bookedByGuest.lastName,\n                country_id: bookedByGuest.countryId === '' ? null : bookedByGuest.countryId,\n                city: null,\n                mobile: bookedByGuest.mobile === null ? '' : this.hasUnderscore(bookedByGuest.mobile) ? '' : bookedByGuest.mobile,\n                country_phone_prefix: bookedByGuest?.phone_prefix ?? null,\n                address: '',\n                dob: null,\n                // subscribe_to_news_letter: bookedByGuest.emailGuest || false,\n                cci: bookedByGuest.cardNumber\n                  ? {\n                      nbr: bookedByGuest.cardNumber,\n                      holder_name: bookedByGuest.cardHolderName,\n                      expiry_month: bookedByGuest.expiryMonth,\n                      expiry_year: bookedByGuest.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-m, 1rem);\n}\n.booking-editor-header__container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-m, 1rem);\n}\n.booking-editor-header__booking-picker {\n  max-width: 350px;\n}\n.booking-editor-header__booking-picker-validator {\n  margin-bottom: 1rem;\n}\n.booking-editor-header__tax_statement {\n  margin-top: 1.5rem;\n}\n@media (min-width: 768px) {\n  .booking-editor-header__container {\n    flex-direction: row;\n    align-items: flex-start;\n    flex-wrap: wrap;\n  }\n  .booking-editor-header__adults-select {\n    width: 100px;\n  }\n  .booking-editor-header__children-select {\n    width: 170px;\n  }\n}\n@media (min-width: 1024px) {\n  .booking-editor__date-validator::part(error-message) {\n    position: absolute;\n  }\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { BookedByGuestSchema, BookingEditorMode } from '../types';\nimport { Booking } from '@/models/booking.dto';\nimport moment from 'moment';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport booking_store, { resetAvailability, setBookingDraft } from '@/stores/booking.store';\nimport { z, ZodSchema } from 'zod';\nimport { DateRangeChangeEvent } from '@/components';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { IRBookingEditorService } from '../ir-booking-editor.service';\n\n@Component({\n  tag: 'ir-booking-editor-header',\n  styleUrl: 'ir-booking-editor-header.css',\n  scoped: true,\n})\nexport class IrBookingEditorHeader {\n  /** Booking context used for edit, add-room, and split flows */\n  @Prop() booking: Booking;\n\n  @Prop() isBlockConversion: boolean;\n\n  /** Controls header behavior and date constraints */\n  @Prop() mode: BookingEditorMode = 'PLUS_BOOKING';\n\n  /** Fixed check-in date (YYYY-MM-DD), if applicable */\n  @Prop() checkIn: string;\n\n  /** Fixed check-out date (YYYY-MM-DD), if applicable */\n  @Prop() checkOut: string;\n\n  @State() isLoading: boolean;\n  @State() bookings: Booking[] = [];\n  @State() datesSchema: ZodSchema;\n\n  @Event() guestSelected: EventEmitter<Booking>;\n  @Event() checkAvailability: EventEmitter<void>;\n\n  private bookingService = new BookingService();\n  private adultsSchema = z.coerce.number().min(1);\n\n  private readonly bookingEditorService = new IRBookingEditorService();\n\n  private BookedByGuestPickerSchema = z\n    .object({\n      firstName: z.string(),\n      // lastName: z.string(),\n    })\n    .superRefine((data, ctx) => {\n      if (!data.firstName) {\n        ctx.addIssue({\n          path: ['firstName'],\n          code: z.ZodIssueCode.custom,\n          message: locales.entries.Lcz_ChooseBookingNumber,\n        });\n      }\n      // if (!data.lastName) {\n      //   ctx.addIssue({\n      //     path: ['lastName'],\n      //     code: z.ZodIssueCode.custom,\n      //     message: locales.entries.Lcz_ChooseBookingNumber,\n      //   });\n      // }\n    });\n  private pickerRef: HTMLIrPickerElement;\n\n  // =====================\n  // Handlers\n  // =====================\n  componentWillLoad() {\n    this.createDatesSchema();\n    this.bookingEditorService.setMode(this.mode);\n  }\n\n  @Watch('booking')\n  handleBookingChange(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      this.createDatesSchema();\n    }\n  }\n\n  @Watch('mode')\n  handleModeChange(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      this.createDatesSchema();\n      this.bookingEditorService.setMode(this.mode);\n    }\n  }\n\n  // private createDatesSchema() {\n  //   this.datesSchema = z.object({\n  //     checkIn: z.custom(date => {\n  //       if (!moment.isMoment(date)) {\n  //         return false;\n  //       }\n  //       if (['SPLIT_BOOKING', 'ADD_ROOM'].includes(this.mode) && !date.isSameOrBefore(this.booking.to_date)) {\n  //         return false;\n  //       }\n  //       return true;\n  //     }),\n  //     checkOut: z.custom(data => moment.isMoment(data)),\n  //   });\n  // }\n  private createDatesSchema() {\n    this.datesSchema = z\n      .object({\n        checkIn: z.any(),\n        checkOut: z.any(),\n      })\n      .superRefine((data, ctx) => {\n        // ─────────────────────────────\n        // checkIn validations\n        // ─────────────────────────────\n\n        if (!moment.isMoment(data.checkIn)) {\n          ctx.addIssue({\n            path: ['checkIn'],\n            code: z.ZodIssueCode.custom,\n            message: 'Check-in date is required',\n          });\n        }\n\n        if (moment.isMoment(data.checkIn) && this.bookingEditorService.isEventType(['SPLIT_BOOKING', 'ADD_ROOM']) && !data.checkIn.isSameOrBefore(this.booking.to_date)) {\n          ctx.addIssue({\n            path: ['checkIn'],\n            code: z.ZodIssueCode.custom,\n            message: `${locales.entries.Lcz_CheckInDateShouldBeMAx.replace('%1', moment(this.booking.from_date, 'YYYY-MM-DD').format('ddd, DD MMM YYYY')).replace(\n              '%2',\n              moment(this.booking.to_date, 'YYYY-MM-DD').format('ddd, DD MMM YYYY'),\n            )}  `,\n          });\n        }\n\n        // ─────────────────────────────\n        // checkOut validations\n        // ─────────────────────────────\n\n        if (!moment.isMoment(data.checkOut)) {\n          ctx.addIssue({\n            path: ['checkOut'],\n            code: z.ZodIssueCode.custom,\n            message: 'Check-out date is required',\n          });\n        }\n      });\n  }\n  private async handleBookingSearch(value: string) {\n    try {\n      this.isLoading = true;\n      if (!value) {\n        this.pickerRef.clearInput();\n        return;\n      }\n      this.bookings = await this.bookingService.fetchExposedBookings(value, calendar_data.property.id, this.checkIn, this.checkOut);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private handleSubmit(event: Event): void {\n    event.preventDefault();\n    this.stopEvent(event);\n    try {\n      if (this.mode === 'SPLIT_BOOKING' && !booking_store.bookedByGuest.firstName) {\n        BookedByGuestSchema.parse(booking_store.bookedByGuest);\n      }\n      this.datesSchema.parse(booking_store.bookingDraft.dates);\n      this.adultsSchema.parse(booking_store.bookingDraft?.occupancy?.adults);\n      this.checkAvailability.emit();\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private handleDateRangeChange(event: CustomEvent<DateRangeChangeEvent>): void {\n    this.stopEvent(event);\n    resetAvailability();\n    setBookingDraft({ dates: event.detail });\n  }\n\n  private handleSourceChange(event: Event): void {\n    this.stopEvent(event);\n    const value = (event.target as HTMLSelectElement).value;\n    const source = booking_store.selects.sources.find(s => s.id === value);\n    setBookingDraft({ source });\n  }\n\n  private handleAdultsChange(event: Event): void {\n    this.stopEvent(event);\n    resetAvailability();\n    const adults = Number((event.target as HTMLSelectElement).value);\n    const { children } = booking_store.bookingDraft.occupancy;\n\n    setBookingDraft({\n      occupancy: { adults, children },\n    });\n  }\n\n  private handleChildrenChange(event: Event): void {\n    this.stopEvent(event);\n    resetAvailability();\n    const children = Number((event.target as HTMLSelectElement).value);\n    const { adults } = booking_store.bookingDraft.occupancy;\n\n    setBookingDraft({\n      occupancy: { adults, children },\n    });\n  }\n\n  private stopEvent(event: Event): void {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n  }\n\n  // =====================\n  // Computed values\n  // =====================\n\n  private get minDate() {\n    const today = moment();\n    switch (this.mode) {\n      case 'EDIT_BOOKING':\n        return today.add(-2, 'weeks').format('YYYY-MM-DD');\n      case 'ADD_ROOM':\n        return this.booking?.from_date;\n      case 'SPLIT_BOOKING':\n      default:\n        if (this.checkIn && this.isBlockConversion) return this.checkIn;\n        return today.format('YYYY-MM-DD');\n    }\n  }\n\n  private get maxDate() {\n    // const today = moment();\n    // const next60Days = today.add(60, 'days').format('YYYY-MM-DD');\n\n    switch (this.mode) {\n      case 'PLUS_BOOKING':\n        if (this.checkOut && this.isBlockConversion) return this.checkOut;\n        return undefined;\n      case 'ADD_ROOM':\n      // return this.booking.to_date;\n      case 'SPLIT_BOOKING':\n      default:\n        return undefined;\n    }\n  }\n\n  private get childrenSelectPlaceholder() {\n    const { child_max_age } = calendar_data.property.adult_child_constraints;\n    const years = child_max_age === 1 ? locales.entries.Lcz_Year : locales.entries.Lcz_Years;\n\n    return `${locales.entries.Lcz_ChildCaption} 0 - ${child_max_age} ${years}`;\n  }\n\n  private async selectGuest(e: CustomEvent) {\n    this.stopEvent(e);\n    const booking_nbr = e.detail?.item?.value;\n    const booking = await this.bookingService.getExposedBooking(booking_nbr, 'en', true);\n    this.guestSelected.emit(booking);\n  }\n\n  render() {\n    const { sources } = booking_store.selects;\n    const { adults, children } = booking_store.bookingDraft.occupancy;\n    const { checkIn, checkOut } = booking_store.bookingDraft.dates;\n\n    return (\n      <Host>\n        <form onSubmit={this.handleSubmit.bind(this)}>\n          {this.bookingEditorService.isEventType('SPLIT_BOOKING') && (\n            <ir-validator value={booking_store.bookedByGuest} class=\"booking-editor-header__booking-picker-validator\" showErrorMessage schema={this.BookedByGuestPickerSchema}>\n              <ir-picker\n                withClear\n                mode=\"select-async\"\n                class=\"booking-editor-header__booking-picker\"\n                debounce={300}\n                ref={el => (this.pickerRef = el)}\n                label={`${locales.entries.Lcz_Tobooking}#`}\n                // defaultValue={Object.keys(this.bookedByInfoData).length > 1 ? this.bookedByInfoData.bookingNumber?.toString() : ''}\n                // value={Object.keys(this.bookedByInfoData).length > 1 ? this.bookedByInfoData.bookingNumber?.toString() : ''}\n                placeholder={locales.entries.Lcz_BookingNumber}\n                loading={this.isLoading}\n                onText-change={e => this.handleBookingSearch(e.detail)}\n                onCombobox-select={this.selectGuest.bind(this)}\n              >\n                {this.bookings.map(b => {\n                  const label = `${b.booking_nbr} ${b.guest.first_name} ${b.guest.last_name}`;\n                  return (\n                    <ir-picker-item value={b.booking_nbr?.toString()} label={label}>\n                      {label}\n                    </ir-picker-item>\n                  );\n                })}\n              </ir-picker>\n            </ir-validator>\n          )}\n\n          <div class=\"booking-editor-header__container\">\n            {!this.bookingEditorService.isEventType(['EDIT_BOOKING', 'ADD_ROOM', 'SPLIT_BOOKING']) && (\n              <wa-select\n                size=\"small\"\n                placeholder={locales.entries.Lcz_Source}\n                value={booking_store.bookingDraft.source?.id?.toString()}\n                defaultValue={booking_store.bookingDraft.source?.id}\n                onwa-hide={this.stopEvent.bind(this)}\n                onchange={this.handleSourceChange.bind(this)}\n              >\n                {sources.map(option => (option.type === 'LABEL' ? <small>{option.description}</small> : <wa-option value={option.id?.toString()}>{option.description}</wa-option>))}\n              </wa-select>\n            )}\n            <ir-validator\n              class=\"booking-editor__date-validator\"\n              showErrorMessage\n              value={booking_store.bookingDraft.dates}\n              schema={this.datesSchema}\n              style={{ position: 'relative' }}\n            >\n              <igl-date-range\n                defaultData={{\n                  fromDate: checkIn?.format('YYYY-MM-DD') ?? '',\n                  toDate: checkOut?.format('YYYY-MM-DD') ?? '',\n                }}\n                variant=\"booking\"\n                withDateDifference\n                minDate={this.minDate}\n                maxDate={this.maxDate}\n                onDateRangeChange={this.handleDateRangeChange.bind(this)}\n              />\n            </ir-validator>\n            {!this.bookingEditorService.isEventType('EDIT_BOOKING') && (\n              <Fragment>\n                <ir-validator value={adults} schema={this.adultsSchema}>\n                  <wa-select\n                    class=\"booking-editor-header__adults-select\"\n                    size=\"small\"\n                    placeholder={locales.entries.Lcz_AdultsCaption}\n                    value={adults?.toString()}\n                    defaultValue={adults?.toString()}\n                    onwa-hide={this.stopEvent.bind(this)}\n                    onchange={this.handleAdultsChange.bind(this)}\n                  >\n                    {Array.from({ length: calendar_data.property.adult_child_constraints.adult_max_nbr }, (_, i) => i + 1).map(option => (\n                      <wa-option value={option.toString()}>{option}</wa-option>\n                    ))}\n                  </wa-select>\n                </ir-validator>\n\n                {calendar_data.property.adult_child_constraints.child_max_nbr > 0 && (\n                  <wa-select\n                    class=\"booking-editor-header__children-select\"\n                    size=\"small\"\n                    placeholder={this.childrenSelectPlaceholder}\n                    value={children?.toString()}\n                    defaultValue={children?.toString()}\n                    onwa-hide={this.stopEvent.bind(this)}\n                    onchange={this.handleChildrenChange.bind(this)}\n                  >\n                    {Array.from({ length: calendar_data.property.adult_child_constraints.child_max_nbr }, (_, i) => i + 1).map(option => (\n                      <wa-option value={option.toString()}>{option}</wa-option>\n                    ))}\n                  </wa-select>\n                )}\n              </Fragment>\n            )}\n\n            <ir-custom-button loading={isRequestPending('/Check_Availability')} type=\"submit\" variant=\"brand\">\n              Check\n            </ir-custom-button>\n          </div>\n          {booking_store.roomTypes?.length > 0 && (\n            <wa-callout size=\"small\" variant=\"neutral\" appearance=\"filled\" class=\"booking-editor-header__tax_statement\">\n              Including taxes and fees.\n            </wa-callout>\n          )}\n        </form>\n      </Host>\n    );\n  }\n}\n"],"version":3}