{"file":"ir-booking-extra-note2.js","mappings":"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","names":["__stencil_proxyCustomElement"],"sources":["src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.css?tag=ir-booking-extra-note&encapsulation=scoped","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n","import locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { getPrivateNote } from '@/utils/booking';\r\n@Component({\r\n  tag: 'ir-booking-extra-note',\r\n  styleUrl: 'ir-booking-extra-note.css',\r\n  scoped: true,\r\n})\r\nexport class IrBookingExtraNote {\r\n  @Prop() booking: Booking;\r\n\r\n  @State() isLoading = false;\r\n  @State() note = '';\r\n\r\n  @Event() closeModal: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\r\n\r\n  private bookingService = new BookingService();\r\n  componentWillLoad() {\r\n    if (this.booking.extras) {\r\n      this.setNote(getPrivateNote(this.booking.extras));\r\n    }\r\n  }\r\n\r\n  private setNote(value: string) {\r\n    this.note = value;\r\n  }\r\n  private async savePrivateNote() {\r\n    try {\r\n      this.isLoading = true;\r\n      let prevExtras = this.booking.extras || [];\r\n      const newExtraObj = { key: 'private_note', value: this.note };\r\n      if (prevExtras.length === 0) {\r\n        prevExtras.push(newExtraObj);\r\n      } else {\r\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\r\n        if (oldPrivateNoteIndex === -1) {\r\n          prevExtras.push(newExtraObj);\r\n        } else {\r\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\r\n        }\r\n      }\r\n      const res = await this.bookingService.doReservation({\r\n        assign_units: true,\r\n        is_pms: true,\r\n        is_direct: true,\r\n        is_in_loyalty_mode: false,\r\n        promo_key: null,\r\n        booking: this.booking,\r\n        Is_Non_Technical_Change: true,\r\n        extras: prevExtras,\r\n      });\r\n      this.resetBookingEvt.emit(res);\r\n      this.closeModal.emit(null);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <Host class={'px-0'}>\r\n        <ir-title class=\"px-1\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_PrivateNote} displayContext=\"sidebar\"></ir-title>\r\n        <form\r\n          class={'px-1'}\r\n          onSubmit={e => {\r\n            e.preventDefault();\r\n            this.savePrivateNote();\r\n          }}\r\n        >\r\n          <ir-textarea placeholder={locales.entries.Lcz_PrivateNote_MaxChar} label=\"\" value={this.note} maxLength={150} onTextChange={e => this.setNote(e.detail)}></ir-textarea>\r\n          <div class={'d-flex flex-column flex-sm-row mt-3'}>\r\n            <ir-button\r\n              onClickHandler={() => this.closeModal.emit(null)}\r\n              btn_styles=\"justify-content-center\"\r\n              class={`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`}\r\n              icon=\"\"\r\n              text={locales.entries.Lcz_Cancel}\r\n              btn_color=\"secondary\"\r\n            ></ir-button>\r\n\r\n            <ir-button\r\n              btn_styles=\"justify-content-center align-items-center\"\r\n              class={'m-0 flex-fill text-center ml-sm-1'}\r\n              icon=\"\"\r\n              isLoading={this.isLoading}\r\n              text={locales.entries.Lcz_Save}\r\n              btn_color=\"primary\"\r\n              btn_type=\"submit\"\r\n            ></ir-button>\r\n          </div>\r\n        </form>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}