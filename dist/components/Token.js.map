{"file":"Token.js","mappings":";;AAEA,MAAM,IAAI;IAMR;QAHQ,YAAO,GAAG,mCAAmC,CAAC;QAIpD,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,IAAI,EAAE,CAAC;SACb;KACF;IACM,MAAM,IAAI;;QAEf,KAAK,CAAC,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;;;;KAIvC;IACM,SAAS,CAAC,QAA4C;QAC3D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACjC;IACM,WAAW,CAAC,QAA4C;QAC7D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,IAAI,GAAG,KAAK,QAAQ,CAAC,CAAC;KACrE;IACM,kBAAkB,CAAC,KAAc;QACtC,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;KAC/B;IAEO,OAAO,iBAAiB,CAAC,eAAwB;QACvD,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,QAAQ,IAAI,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC;KACjE;IACM,eAAe;QACpB,OAAO,IAAI,CAAC,gBAAgB,CAAC;KAC9B;;AAjCc,eAAU,GAAG,KAAH,CAAS;AACnB,qBAAgB,GAAG,KAAH,CAAS;AAEzB,gBAAW,GAA8C,EAA9C;;ACN5B;AAIA,MAAM,KAAM,SAAQ,IAAI;IAKtB;QACE,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAE;;YAE7B,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM;gBACnC,IAAI,KAAK,CAAC,KAAK,EAAE;oBACf,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;oBACpC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC;iBACpC;gBACD,OAAO,MAAM,CAAC;aACf,CAAC,CAAC;YACH,KAAK,CAAC,kBAAkB,GAAG,IAAI,CAAC;SACjC;KACF;IAEM,QAAQ,CAAC,KAAa;QAC3B,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;KACrB;IACM,eAAe;QACpB,OAAO,KAAK,CAAC,eAAe,EAAE,CAAC;KAChC;IACM,QAAQ;QACb,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;YAChB,MAAM,IAAI,iBAAiB,EAAE,CAAC;SAC/B;QACD,OAAO,KAAK,CAAC,KAAK,CAAC;KACpB;;AA9Bc,WAAK,GAAkB,EAAE,CAAC;AAE1B,wBAAkB,GAAG,KAAK,CAAC;MA+B/B,iBAAkB,SAAQ,KAAK;IAC1C,YAAY,OAAO,GAAG,iBAAiB;QACrC,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,IAAI,GAAG,mBAAmB,CAAC;KACjC;;;;;","names":[],"sources":["src/models/Auth.ts","src/models/Token.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nclass Auth {\r\n  private static isAuthUsed = false;\r\n  private static _isAuthenticated = false;\r\n  private baseUrl = 'https://gateway.igloorooms.com/IR';\r\n  private static subscribers: Array<(isAuthenticated: boolean) => void> = [];\r\n\r\n  constructor() {\r\n    if (!Auth.isAuthUsed) {\r\n      this.init();\r\n    }\r\n  }\r\n  public async init() {\r\n    // axios.defaults.withCredentials = true;\r\n    axios.defaults.baseURL = this.baseUrl;\r\n    // Auth.isAuthUsed = true;\r\n    // const { data } = await axios.post('/Is_Already_Athenticated');\r\n    // this.setIsAuthenticated(data.My_Result);\r\n  }\r\n  public subscribe(callback: (isAuthenticated: boolean) => void) {\r\n    Auth.subscribers.push(callback);\r\n  }\r\n  public unsubscribe(callback: (isAuthenticated: boolean) => void) {\r\n    Auth.subscribers = Auth.subscribers.filter(sub => sub !== callback);\r\n  }\r\n  public setIsAuthenticated(value: boolean) {\r\n    Auth._isAuthenticated = value;\r\n    Auth.notifySubscribers(value);\r\n  }\r\n\r\n  private static notifySubscribers(isAuthenticated: boolean) {\r\n    Auth.subscribers.forEach(callback => callback(isAuthenticated));\r\n  }\r\n  public isAuthenticated() {\r\n    return Auth._isAuthenticated;\r\n  }\r\n}\r\n\r\nexport default Auth;\r\n","// import axios from 'axios';\r\nimport axios from 'axios';\r\nimport Auth from './Auth';\r\n\r\nclass Token extends Auth {\r\n  private static token: string | null = '';\r\n\r\n  private static isInterceptorAdded = false;\r\n\r\n  constructor() {\r\n    super();\r\n    if (!Token.isInterceptorAdded) {\r\n      // axios.defaults.withCredentials = true;\r\n      axios.interceptors.request.use(config => {\r\n        if (Token.token) {\r\n          config.params = config.params || {};\r\n          config.params.Ticket = Token.token;\r\n        }\r\n        return config;\r\n      });\r\n      Token.isInterceptorAdded = true;\r\n    }\r\n  }\r\n\r\n  public setToken(token: string) {\r\n    Token.token = token;\r\n  }\r\n  public isAuthenticated() {\r\n    return super.isAuthenticated();\r\n  }\r\n  public getToken() {\r\n    if (!Token.token) {\r\n      throw new MissingTokenError();\r\n    }\r\n    return Token.token;\r\n  }\r\n}\r\nexport default Token;\r\nexport class MissingTokenError extends Error {\r\n  constructor(message = 'Missing token!!') {\r\n    super(message);\r\n    this.name = 'MissingTokenError';\r\n  }\r\n}\r\n"],"version":3}