{"file":"ir-applicable-policies2.js","mappings":";;;;;;;;;AAAA,MAAM,uBAAuB,GAAG,0+FAA0+F,CAAC;AAC3gG,mCAAe,uBAAuB;;MCczB,oBAAoB;IALjC;;;;QAQU,aAAQ,GAAW,IAAI,CAAC;QAEvB,2BAAsB,GAA4B,EAAE,CAAC;QACrD,cAAS,GAAY,KAAK,CAAC;QAI5B,mCAA8B,GAAY,IAAI,CAAC;KA4XxD;IA1XC,iBAAiB;QACf,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B;IAGD,mBAAmB;QACjB,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B;IACO,MAAM,sBAAsB;QAClC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI;YACF,MAAM,iBAAiB,GAAG,CAAC,QAAmC,EAAE,IAAqC;gBACnG,OAAO,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC;aAC5C,CAAC;YACF,MAAM,UAAU,GAA4B,EAAE,CAAC;YAC/C,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI;;gBAC7B,MAAM,kBAAkB,GAAG,iBAAiB,CAAC,IAAI,CAAC,mBAAmB,EAAE,aAAa,CAAC,CAAC;gBACtF,MAAM,eAAe,GAAG,iBAAiB,CAAC,IAAI,CAAC,mBAAmB,EAAE,WAAW,CAAC,CAAC;gBAEjF,IAAI,kBAAkB,EAAE;;oBAEtB,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;oBAEnF,IAAI,QAAQ,GAAyB,mBAAmB;0BACpD,CAAC,kBAAkB,CAAC,QAAQ,CAAC,kBAAkB,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;0BACrE;4BACE,GAAG,kBAAkB,CAAC,QAAQ;iCAC3B,GAAG,CAAC,CAAC,OAAO,EAAE,KAAK;;gCAClB,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;oCACtB,OAAO,OAAO,CAAC;iCAChB;gCACD,IAAI,KAAK,GAAG,CAAA,kBAAkB,aAAlB,kBAAkB,uBAAlB,kBAAkB,CAAE,QAAQ,CAAC,MAAM,IAAG,CAAC,IAAI,CAAA,MAAA,kBAAkB,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,0CAAE,MAAM,IAAG,CAAC,EAAE;oCACzG,OAAO,OAAO,CAAC;iCAChB;6BACF,CAAC;iCACD,MAAM,CAAC,OAAO,CAAC;yBACnB,CAAC;oBACN,QAAQ,CAAC,IAAI,CAAC;wBACZ,MAAM,EAAE,IAAI,CAAC,KAAK;wBAClB,gBAAgB,EAAE,EAAE;wBACpB,IAAI,EAAE,EAAE;wBACR,WAAW,EAAE,CAAC;wBACd,MAAM,EAAEA,KAAM,CAAC,IAAI,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC;wBAChF,gBAAgB,EAAE,EAAE;wBACpB,YAAY,EAAE,IAAI,CAAC,WAAW;wBAC9B,sBAAsB,EAAE,EAAE;wBAC1B,SAAS,EAAE,qBAAqB;wBAChC,gBAAgB,EAAE,IAAI;qBACvB,CAAC,CAAC;oBACH,UAAU,CAAC,IAAI,iCACV,kBAAkB,KACrB,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,QAAQ,EACR,WAAW,EAAE,IAAI,CAAC,SAAS,EAC3B,UAAU,EAAE,IAAI,CAAC,WAAW,IAC5B,CAAC;iBACJ;gBACD,IAAI,eAAe,EAAE;oBACnB,KAAK,IAAI,MAAA,MAAA,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,QAAQ,CAAC,0CAAE,YAAY,mCAAI,CAAC,CAAC;iBAC9E;aACF,CAAC,CAAC;YAEH,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC7B,IAAI,CAAC,sBAAsB,GAAG,CAAC,GAAG,UAAU,CAAC,CAAC;SAC/C;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SACtB;gBAAS;YACR,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;KACF;IACO,0BAA0B,CAAC,EAAU,EAAE,EAAU;QACvD,IAAI,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE;YACzB,OAAO,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;SAC5B;QAED,OAAO,EAAE,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;KAClC;IAEO,6BAA6B,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,EAAiF;;QAM5J,IAAI,CAAC,OAAO,IAAI,CAAC,QAAQ,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,IAAI,QAAQ,CAAC,MAAM,EAAE;YAClE,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;SAChE;;QAGD,MAAM,YAAY,GAAGA,KAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QACvE,MAAM,cAAc,GAAGA,KAAM,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QAE5D,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,EAAE;YACxD,OAAO,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;YAC1E,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;SAChE;;QAGD,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YACzB,OAAO,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC;SAC9D;;QAGD,OAAO,IAAI,CAAC,sBAAsB,CAAC,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;KAC3E;IAEO,mBAAmB,CACzB,cAA6B,EAC7B,WAAmB;QAMnB,OAAO;YACL,SAAS,EAAE,cAAc,CAAC,MAAM,CAAC,QAAQ,CAAC;YAC1C,SAAS,EAAE,IAAI;YACf,UAAU,EAAEA,KAAM,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC;SACrE,CAAC;KACH;IAEO,sBAAsB,CAC5B,OAAgB,EAChB,KAAa,EACb,QAAmB,EACnB,WAAmB;QAMnB,MAAM,cAAc,GAAGA,KAAM,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;;QAG5D,IAAI,KAAK,KAAK,CAAC,EAAE;YACf,MAAM,WAAW,GAAG,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,WAAW,EAAE;gBAChB,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;aAChE;YAED,IAAI,kBAAkB,GAAGA,KAAM,CAAC,WAAW,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;YAClE,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,EAAE;gBACjC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;aAChE;YACD,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxB,kBAAkB,GAAG,kBAAkB,CAAC,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;aACjE;YAED,OAAO;gBACL,SAAS,EAAE,OAAO;gBAClB,SAAS,EAAE,KAAK;gBAChB,UAAU,EAAE,kBAAkB,CAAC,MAAM,CAAC,cAAc,CAAC;aACtD,CAAC;SACH;;;;;;;;;QAUD,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QACzB,IAAI,KAAK,KAAK,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACjC,OAAO;gBACL,SAAS,EAAE,GAAG,cAAc,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,UAAU;gBAC/D,SAAS,EAAE,KAAK;gBAChB,UAAU,EAAE,EAAE;aACf,CAAC;SACH;;QAGD,MAAM,WAAW,GAAG,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;QACxC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;SAChE;QAED,MAAM,kBAAkB,GAAGA,KAAM,CAAC,WAAW,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QACpE,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,EAAE;YACjC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;SAChE;;QAGD,MAAM,aAAa,GAAG,kBAAkB,CAAC,KAAK,EAAE,CAAC;QAEjD,OAAO;YACL,SAAS,EAAE,IAAI,CAAC,0BAA0B,CAAC,cAAc,EAAE,aAAa,CAAC;YACzE,SAAS,EAAE,IAAI;YACf,UAAU,EAAE,aAAa,CAAC,MAAM,CAAC,cAAc,CAAC;SACjD,CAAC;KACH;IACO,iBAAiB,CAAC,QAAmB;QAC3C,MAAM,KAAK,GAAGA,KAAM,EAAE,CAAC;QACvB,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;YAC9B,IAAI,KAAK,CAAC,aAAa,CAACA,KAAM,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,EAAE,MAAM,CAAC,EAAE;gBACrE,OAAO,OAAO,CAAC;aAChB;SACF;QACD,OAAO,IAAI,CAAC;KACb;IAEO,6BAA6B;QACnC,MAAM,KAAK,GAAG,oBAAoB,CAAC;QACnC,MAAM,EAAE,gCAAgC,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;QACpE,IAAI,gCAAgC,KAAK,CAAC,EAAE;YAC1C,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,GAAG,CAAC,EAAE;gBACxC,OAAO,aAAa,KAAK,EAAE,CAAC;aAC7B;YACD,OAAO,uBAAuB,KAAK,EAAE,CAAC;SACvC;QACD,OAAO,GAAG,gCAAgC,GAAG,CAAC,GAAG,QAAQ,GAAG,QAAQ,IAAI,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC,IAAI,KAAK,EAAE,CAAC;KAC5K;IAEO,kBAAkB,CAAC,QAAmB;QAC5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,IAAI,CAAC;QAEnE,MAAM,KAAK,GAAGA,KAAM,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;;QAGtC,MAAM,MAAM,GAAG,QAAQ;aACpB,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,EAAEA,KAAM,CAAC,CAAC,CAAC,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;aAC5E,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;aAC7B,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;QAEvD,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,IAAI,CAAC;;QAGrC,IAAI,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;YACzC,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SACvB;;QAGD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAC1C,MAAM,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAC3B,MAAM,IAAI,GAAG,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;YAChC,IAAI,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;gBAClE,OAAO,GAAG,CAAC;aACZ;SACF;;QAGD,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;KACvC;IAED,MAAM;;QACJ,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,OAAO,IAAI,CAAC;SACb;QACD,MAAM,wBAAwB,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC;QACzF,QACE,EAAC,IAAI,QACF,IAAI,CAAC,eAAe,KAAK,CAAC,KACzB,mBACE,WAAK,KAAK,EAAC,gCAAgC,IACzC,WAAK,KAAK,EAAC,qCAAqC,IAC9C,SAAG,KAAK,EAAC,qCAAqC,IAAEA,KAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAK,EAC7H,SAAG,KAAK,EAAC,uCAAuC,IAC9C,YAAM,KAAK,EAAC,MAAM,IAAE,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,EAAE,wBAAwB,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,CAAQ,CAC/J,EACJ,SAAG,KAAK,EAAC,sCAAsC,kBAAY,wBAAwB,GAAG,CAAC,GAAG,SAAS,GAAG,EAAE,CAAK,CACzG,EACL,wBAAwB,GAAG,CAAC,KAC3B,WAAK,KAAK,EAAC,uCAAuC,IAChD,iBACE,SAAS,EAAC,MAAM,EAChB,IAAI,EAAC,KAAK,EACV,IAAI,EAAC,IAAI,EACT,cAAc,EAAE;gBACd,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC;oBACxB,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC;oBAE1C,QAAQ,EAAE,aAAa,CAAC,QAAQ;oBAChC,MAAM,EAAEA,KAAM,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC;oBACrC,aAAa,EAAE,IAAI;oBACnB,MAAM,EAAE,EAAE;oBACV,IAAI,EAAE,SAAS;iBAChB,CAAC,CAAC;aACJ,GACU,CACT,CACP,CACG,CACE,CACX,EACD,mBACE,WAAK,KAAK,EAAC,gCAAgC,IACzC,WAAK,KAAK,EAAC,2BAA2B,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE,IAC7D,SAAG,KAAK,EAAC,oDAAoD,4BAA0B,EACvF,EAAC,aAAa,IAAC,OAAO,EAAC,MAAM,EAAC,IAAI,EAAC,iFAAiF,GAAG,CACnH,EACN,SAAG,KAAK,EAAC,iCAAiC,IAAE,IAAI,CAAC,6BAA6B,EAAE,CAAK,CACjF,EAEL,CAAA,MAAA,IAAI,CAAC,sBAAsB,0CAAE,MAAM,IAAG,CAAC,IAAI,IAAI,CAAC,8BAA8B,KAC7E,WAAK,KAAK,EAAC,iCAAiC,IACzC,MAAA,IAAI,CAAC,sBAAsB,0CAAE,GAAG,CAAC,SAAS;YACzC,MAAM,cAAc,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YACnE,QACE,WAAK,KAAK,EAAC,gCAAgC,IACxC,IAAI,CAAC,sBAAsB,CAAC,MAAM,GAAG,CAAC,KACrC,SAAG,KAAK,EAAC,2BAA2B,IAClC,aAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAK,OAAE,SAAS,CAAC,QAAQ,CAAC,YAAY,CAAC,OAAG,SAAS,CAAC,QAAQ,CAAC,iBAAiB,GAAG,MAAM,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,GAAG,EAAE,CACxJ,CACL,EACD,WAAK,KAAK,EAAC,+BAA+B,IACvC,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,GAAG;gBACnC,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC,6BAA6B,CAAC;oBAC9E,KAAK,EAAE,GAAG;oBACV,OAAO;oBACP,QAAQ,EAAE,SAAS,CAAC,QAAQ;oBAC5B,WAAW,EAAE,SAAS,CAAC,WAAW;iBACnC,CAAC,CAAC;gBACH,MAAM,kBAAkB,GAAGA,KAAM,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,MAAM,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;gBAE/F,QACE,WAAK,KAAK,EAAE,EAAE,8BAA8B,EAAE,IAAI,EAAE,0CAA0C,EAAE,kBAAkB,EAAE,IAClH,SAAG,KAAK,EAAC,oCAAoC,IAC1C,SAAS,OAAG,SAAS,IAAI,gBAAU,IAAI,EAAC,aAAa,EAAC,KAAK,EAAC,2BAA2B,EAAC,KAAK,EAAE,EAAE,aAAa,EAAE,UAAU,EAAE,GAAa,EAAE,GAAG,EAC9I,UAAU,CACT,EACJ,SAAG,KAAK,EAAC,6BAA6B,IAAE,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,EAAE,OAAO,CAAC,YAAY,CAAC,CAAK,EAE9G,SAAG,KAAK,EAAC,qCAAqC,IAAE,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,YAAY,GAAG,OAAO,CAAC,SAAS,CAAK,CACxG,EACN;aACH,CAAC,CACE,EACN,WAAK,KAAK,EAAC,qCAAqC,IAC9C,iBACE,iBACG,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,GAAG;gBACnC,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC,6BAA6B,CAAC;oBAC9E,KAAK,EAAE,GAAG;oBACV,OAAO;oBACP,QAAQ,EAAE,SAAS,CAAC,QAAQ;oBAC5B,WAAW,EAAE,SAAS,CAAC,WAAW;iBACnC,CAAC,CAAC;gBAEH,MAAM,kBAAkB,GAAGA,KAAM,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,MAAM,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;gBAC/F,OAAO,CAAC,GAAG,CAAC,EAAE,kBAAkB,EAAE,CAAC,CAAC;gBAEpC,QACE,UAAI,KAAK,EAAE,EAAE,0CAA0C,EAAE,kBAAkB,EAAE,IAC3E,UAAI,KAAK,EAAC,oCAAoC,IAC3C,SAAS,OAAG,SAAS,IAAI,gBAAU,IAAI,EAAC,aAAa,EAAC,KAAK,EAAC,2BAA2B,EAAC,KAAK,EAAE,EAAE,aAAa,EAAE,UAAU,EAAE,GAAa,EAAE,GAAG,EAC9I,UAAU,CACR,EAEL,UAAI,KAAK,EAAC,kCAAkC,IAAE,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,EAAE,OAAO,CAAC,YAAY,CAAC,CAAM,EAErH,UAAI,KAAK,EAAC,qCAAqC,IAAE,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,YAAY,GAAG,OAAO,CAAC,SAAS,CAAM,CAC3G,EACL;aACH,CAAC,CAUI,CACF,CACJ,CACF,EACN;SACH,CAAC,CACE,CACP,CACO,CACL,EACP;KACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":["moment"],"sources":["src/components/ir-booking-details/ir-payment-details/ir-applicable-policies/ir-applicable-policies.css?tag=ir-applicable-policies&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-applicable-policies/ir-applicable-policies.tsx"],"sourcesContent":[":host {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.applicable-policies__container {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  flex-wrap: wrap;\n  margin-bottom: 1rem;\n}\n\n.applicable-policies__title {\n  font-size: 1rem;\n  font-weight: 700;\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__no-penalty {\n  padding: 0;\n  margin: 0;\n  font-size: 0.875rem;\n}\n\n.applicable-policies__statements {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  background: rgb(30, 159, 242, 5%);\n  padding: 0.5rem 1rem;\n  border: 1px solid rgba(30, 159, 242, 40%);\n  border-radius: 0.25rem;\n  max-height: 200px;\n  overflow-y: auto;\n}\n.applicable-policies__highlighted-bracket {\n  color: rgba(30, 159, 242, 100%);\n}\n.applicable-policies__statement {\n  display: flex;\n  flex-direction: column;\n  /* gap: 0.5rem; */\n  border-bottom: 1px solid #e5e7eb;\n  padding-bottom: 0.5rem;\n}\n.applicable-policies__statement:last-child {\n  border-bottom: 0;\n  padding-bottom: 0;\n}\n\n.applicable-policies__room {\n  padding: 0;\n  margin: 0;\n  padding-bottom: 0.5rem;\n}\n\n.applicable-policies__bracket {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 0.25rem;\n  font-size: 0.875rem;\n  padding-bottom: 0.5rem;\n}\n\n.applicable-policies__bracket-dates {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0;\n  margin: 0;\n}\n\n/* .applicable-policies__icon {\n} */\n\n.applicable-policies__amount {\n  text-align: right;\n  padding: 0;\n  margin: 0;\n  font-weight: 600;\n}\n\n.applicable-policies__statement-text {\n  padding: 0;\n  margin: 0;\n}\n.applicable-policies__brackets-table {\n  display: none;\n}\n\n/* Container */\n.applicable-policies__guarantee {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem 1rem;\n  border: 1px solid rgba(255, 73, 97, 40%);\n  border-radius: 6px;\n  background-color: rgba(255, 73, 97, 10%);\n  margin-bottom: 0.5rem;\n  font-size: 0.875rem;\n}\n\n/* Left info section */\n.applicable-policies__guarantee-info {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n/* Text styles */\n.applicable-policies__guarantee-date {\n  color: var(--text-muted, #666);\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__guarantee-amount {\n  font-weight: 600;\n  color: var(--text-strong, #222);\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__guarantee-label {\n  color: red;\n  font-weight: 700;\n  padding: 0;\n  margin: 0;\n}\n\n/* Action (button container) */\n.applicable-policies__guarantee-action {\n  width: fit-content;\n}\n\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n  .applicable-policies__brackets {\n    display: none;\n  }\n  .applicable-policies__brackets-table {\n    display: block;\n    width: 100%;\n    font-size: 0.875rem;\n  }\n  .applicable-policies__brackets-table table {\n    width: 100%;\n  }\n  .applicable-policies__amount,\n  .applicable-policies__bracket-dates {\n    white-space: nowrap;\n  }\n  .applicable-policies__statement-text {\n    width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n}\n\n/*lg*/\n@media (min-width: 1024px) {\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { Booking, Bracket, ExposedApplicablePolicy } from '@/models/booking.dto';\nimport { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { BracketWithCheckIn, CancellationStatement } from '../../types';\nimport moment, { Moment } from 'moment';\nimport { formatAmount } from '@/utils/utils';\nimport calendar_data from '@/stores/calendar-data';\nimport { IPaymentAction } from '@/services/payment.service';\nimport locales from '@/stores/locales.store';\nimport { HelpDocButton } from '@/components/HelpButton';\n\n@Component({\n  tag: 'ir-applicable-policies',\n  styleUrl: 'ir-applicable-policies.css',\n  scoped: true,\n})\nexport class IrApplicablePolicies {\n  @Prop() booking: Booking;\n  @Prop() propertyId: number;\n  @Prop() language: string = 'en';\n\n  @State() cancellationStatements: CancellationStatement[] = [];\n  @State() isLoading: boolean = false;\n  @State() guaranteeAmount: number;\n\n  @Event() generatePayment: EventEmitter<IPaymentAction>;\n  private shouldShowCancellationBrackets: boolean = true;\n\n  componentWillLoad() {\n    this.loadApplicablePolicies();\n  }\n\n  @Watch('booking')\n  handleBookingChange() {\n    this.loadApplicablePolicies();\n  }\n  private async loadApplicablePolicies() {\n    this.isLoading = true;\n    try {\n      const getPoliciesByType = (policies: ExposedApplicablePolicy[], type: ExposedApplicablePolicy['type']) => {\n        return policies.find(p => p.type === type);\n      };\n      const statements: CancellationStatement[] = [];\n      let total = 0;\n      this.booking.rooms.forEach(room => {\n        const cancellationPolicy = getPoliciesByType(room.applicable_policies, 'cancelation');\n        const guaranteePolicy = getPoliciesByType(room.applicable_policies, 'guarantee');\n\n        if (cancellationPolicy) {\n          //check if every bracket have 0 in amount;\n          const isEveryBracketEmpty = cancellationPolicy.brackets.every(b => b.amount === 0);\n\n          let brackets: BracketWithCheckIn[] = isEveryBracketEmpty\n            ? [cancellationPolicy.brackets[cancellationPolicy.brackets.length - 1]]\n            : [\n                ...cancellationPolicy.brackets\n                  .map((bracket, index) => {\n                    if (bracket.amount > 0) {\n                      return bracket;\n                    }\n                    if (index < cancellationPolicy?.brackets.length - 1 && cancellationPolicy.brackets[index + 1]?.amount > 0) {\n                      return bracket;\n                    }\n                  })\n                  .filter(Boolean),\n              ];\n          brackets.push({\n            amount: room.total,\n            amount_formatted: '',\n            code: '',\n            currency_id: 0,\n            due_on: moment(room.from_date, 'YYYY-MM-DD').add(1, 'days').format('YYYY-MM-DD'),\n            due_on_formatted: '',\n            gross_amount: room.gross_total,\n            gross_amount_formatted: '',\n            statement: '100% of total price',\n            is_check_in_date: true,\n          });\n          statements.push({\n            ...cancellationPolicy,\n            roomType: room.roomtype,\n            ratePlan: room.rateplan,\n            brackets,\n            checkInDate: room.from_date,\n            grossTotal: room.gross_total,\n          });\n        }\n        if (guaranteePolicy) {\n          total += this.getCurrentBracket(guaranteePolicy.brackets)?.gross_amount ?? 0;\n        }\n      });\n\n      this.guaranteeAmount = total;\n      this.cancellationStatements = [...statements];\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private formatPreviousBracketDueOn(d1: Moment, d2: Moment) {\n    if (d1.isSame(d2, 'year')) {\n      return d1.format('MMM DD');\n    }\n\n    return d1.format('MMM DD, YYYY');\n  }\n\n  private getBracketLabelsAndArrowState({ bracket, index, brackets, checkInDate }: { index: number; bracket: Bracket; brackets: Bracket[]; checkInDate: string }): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    // Validate inputs\n    if (!bracket || !brackets || index < 0 || index >= brackets.length) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Parse dates with validation\n    const bookedOnDate = moment(this.booking.booked_on.date, 'YYYY-MM-DD');\n    const bracketDueDate = moment(bracket.due_on, 'YYYY-MM-DD');\n\n    if (!bookedOnDate.isValid() || !bracketDueDate.isValid()) {\n      console.warn('Invalid date encountered in getBracketLabelsAndArrowState');\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Single bracket case\n    if (brackets.length === 1) {\n      return this.handleSingleBracket(bracketDueDate, checkInDate);\n    }\n\n    // Multiple brackets case\n    return this.handleMultipleBrackets(bracket, index, brackets, checkInDate);\n  }\n\n  private handleSingleBracket(\n    bracketDueDate: moment.Moment,\n    checkInDate: string,\n  ): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    return {\n      leftLabel: bracketDueDate.format('MMM DD'),\n      showArrow: true,\n      rightLabel: moment(checkInDate, 'YYYY-MM-DD').format('MMM DD, YYYY'),\n    };\n  }\n\n  private handleMultipleBrackets(\n    bracket: Bracket,\n    index: number,\n    brackets: Bracket[],\n    checkInDate: string,\n  ): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    const bracketDueDate = moment(bracket.due_on, 'YYYY-MM-DD');\n\n    // First bracket\n    if (index === 0) {\n      const nextBracket = brackets[index + 1];\n      if (!nextBracket) {\n        return { leftLabel: null, rightLabel: null, showArrow: false };\n      }\n\n      let nextBracketDueDate = moment(nextBracket.due_on, 'YYYY-MM-DD');\n      if (!nextBracketDueDate.isValid()) {\n        return { leftLabel: null, rightLabel: null, showArrow: false };\n      }\n      if (bracket.amount === 0) {\n        nextBracketDueDate = nextBracketDueDate.clone().add(-1, 'days');\n      }\n\n      return {\n        leftLabel: 'Until',\n        showArrow: false,\n        rightLabel: nextBracketDueDate.format('MMM DD, YYYY'),\n      };\n    }\n\n    // Last bracket\n    // if (index === brackets.length - 1) {\n    //   return {\n    //     leftLabel: bracketDueDate.clone().format('MMM DD'),\n    //     showArrow: true,\n    //     rightLabel: moment(checkInDate).format('MMM DD, YYYY'),\n    //   };\n    // }\n    console.log(checkInDate);\n    if (index === brackets.length - 1) {\n      return {\n        leftLabel: `${bracketDueDate.clone().format('MMM DD')} onwards`,\n        showArrow: false,\n        rightLabel: '',\n      };\n    }\n\n    // Middle brackets\n    const nextBracket = brackets[index + 1];\n    if (!nextBracket) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    const nextBracketDueDate = moment(nextBracket.due_on, 'YYYY-MM-DD');\n    if (!nextBracketDueDate.isValid()) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Calculate the end of current bracket period (day before next bracket starts)\n    const periodEndDate = nextBracketDueDate.clone();\n\n    return {\n      leftLabel: this.formatPreviousBracketDueOn(bracketDueDate, periodEndDate),\n      showArrow: true,\n      rightLabel: periodEndDate.format('MMM DD, YYYY'),\n    };\n  }\n  private getCurrentBracket(brackets: Bracket[]) {\n    const today = moment();\n    for (const bracket of brackets) {\n      if (today.isSameOrAfter(moment(bracket.due_on, 'YYYY-MM-DD'), 'days')) {\n        return bracket;\n      }\n    }\n    return null;\n  }\n\n  private generateCancellationStatement() {\n    const label = 'if cancelled today';\n    const { cancelation_penality_as_if_today } = this.booking.financial;\n    if (cancelation_penality_as_if_today === 0) {\n      if (this.booking.financial.collected > 0) {\n        return `No refund ${label}`;\n      }\n      return `No payment required ${label}`;\n    }\n    return `${cancelation_penality_as_if_today < 0 ? 'Refund' : 'Charge'} ${formatAmount(calendar_data.currency.symbol, Math.abs(cancelation_penality_as_if_today))} ${label}`;\n  }\n\n  private _getCurrentBracket(brackets: Bracket[]): moment.Moment | null {\n    if (!Array.isArray(brackets) || brackets.length === 0) return null;\n\n    const today = moment().startOf('day');\n\n    // Parse + validate + sort ascending by due_on\n    const parsed = brackets\n      .map(b => ({ b, date: moment(b.due_on, 'YYYY-MM-DD', true).startOf('day') }))\n      .filter(x => x.date.isValid())\n      .sort((a, b) => a.date.valueOf() - b.date.valueOf());\n\n    if (parsed.length === 0) return null;\n\n    // If today is before the first due date → return first bracket (closest upcoming)\n    if (today.isBefore(parsed[0].date, 'day')) {\n      return parsed[0].date;\n    }\n\n    // Find i such that date[i] <= today < date[i+1] → return date[i]\n    for (let i = 0; i < parsed.length - 1; i++) {\n      const cur = parsed[i].date;\n      const next = parsed[i + 1].date;\n      if (today.isSameOrAfter(cur, 'day') && today.isBefore(next, 'day')) {\n        return cur;\n      }\n    }\n\n    // If today is on/after the last due date → return last bracket\n    return parsed[parsed.length - 1].date;\n  }\n\n  render() {\n    if (this.isLoading) {\n      return null;\n    }\n    const remainingGuaranteeAmount = this.booking.financial.collected - this.guaranteeAmount;\n    return (\n      <Host>\n        {this.guaranteeAmount !== 0 && (\n          <section>\n            <div class=\"applicable-policies__guarantee\">\n              <div class=\"applicable-policies__guarantee-info\">\n                <p class=\"applicable-policies__guarantee-date\">{moment(this.booking.booked_on.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</p>\n                <p class=\"applicable-policies__guarantee-amount\">\n                  <span class=\"px-1\">{formatAmount(calendar_data.currency.symbol, remainingGuaranteeAmount < 0 ? Math.abs(remainingGuaranteeAmount) : this.guaranteeAmount)}</span>\n                </p>\n                <p class=\"applicable-policies__guarantee-label\">Guarantee {remainingGuaranteeAmount < 0 ? 'balance' : ''}</p>\n              </div>\n              {remainingGuaranteeAmount < 0 && (\n                <div class=\"applicable-policies__guarantee-action\">\n                  <ir-button\n                    btn_color=\"dark\"\n                    text=\"Pay\"\n                    size=\"sm\"\n                    onClickHandler={() => {\n                      this.generatePayment.emit({\n                        amount: Math.abs(remainingGuaranteeAmount),\n\n                        currency: calendar_data.currency,\n                        due_on: moment().format('YYYY-MM-DD'),\n                        pay_type_code: null,\n                        reason: '',\n                        type: 'OVERDUE',\n                      });\n                    }}\n                  ></ir-button>\n                </div>\n              )}\n            </div>\n          </section>\n        )}\n        <section>\n          <div class=\"applicable-policies__container\">\n            <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n              <p class=\"applicable-policies__title font-size-large p-0 m-0\">Cancellation Schedule</p>\n              <HelpDocButton message=\"Help\" href=\"https://help.igloorooms.com/extranet/booking-details/guarantee-and-cancellation\" />\n            </div>\n            <p class=\"applicable-policies__no-penalty\">{this.generateCancellationStatement()}</p>\n          </div>\n\n          {this.cancellationStatements?.length > 0 && this.shouldShowCancellationBrackets && (\n            <div class=\"applicable-policies__statements\">\n              {this.cancellationStatements?.map(statement => {\n                const currentBracket = this._getCurrentBracket(statement.brackets);\n                return (\n                  <div class=\"applicable-policies__statement\">\n                    {this.cancellationStatements.length > 1 && (\n                      <p class=\"applicable-policies__room\">\n                        <b>{statement.roomType.name}</b> {statement.ratePlan['short_name']} {statement.ratePlan.is_non_refundable ? ` - ${locales.entries.Lcz_NonRefundable}` : ''}\n                      </p>\n                    )}\n                    <div class=\"applicable-policies__brackets\">\n                      {statement.brackets.map((bracket, idx) => {\n                        const { leftLabel, rightLabel, showArrow } = this.getBracketLabelsAndArrowState({\n                          index: idx,\n                          bracket,\n                          brackets: statement.brackets,\n                          checkInDate: statement.checkInDate,\n                        });\n                        const isInCurrentBracket = moment(bracket.due_on, 'YYYY-MM-DD').isSame(currentBracket, 'date');\n\n                        return (\n                          <div class={{ 'applicable-policies__bracket': true, 'applicable-policies__highlighted-bracket': isInCurrentBracket }}>\n                            <p class=\"applicable-policies__bracket-dates\">\n                              {leftLabel} {showArrow && <ir-icons name=\"arrow_right\" class=\"applicable-policies__icon\" style={{ '--icon-size': '0.875rem' }}></ir-icons>}{' '}\n                              {rightLabel}\n                            </p>\n                            <p class=\"applicable-policies__amount\">{formatAmount(calendar_data.currency.symbol, bracket.gross_amount)}</p>\n\n                            <p class=\"applicable-policies__statement-text\">{bracket.amount === 0 ? 'No penalty' : bracket.statement}</p>\n                          </div>\n                        );\n                      })}\n                    </div>\n                    <div class=\"applicable-policies__brackets-table\">\n                      <table>\n                        <tbody>\n                          {statement.brackets.map((bracket, idx) => {\n                            const { leftLabel, rightLabel, showArrow } = this.getBracketLabelsAndArrowState({\n                              index: idx,\n                              bracket,\n                              brackets: statement.brackets,\n                              checkInDate: statement.checkInDate,\n                            });\n\n                            const isInCurrentBracket = moment(bracket.due_on, 'YYYY-MM-DD').isSame(currentBracket, 'date');\n                            console.log({ isInCurrentBracket });\n\n                            return (\n                              <tr class={{ 'applicable-policies__highlighted-bracket': isInCurrentBracket }}>\n                                <td class=\"applicable-policies__bracket-dates\">\n                                  {leftLabel} {showArrow && <ir-icons name=\"arrow_right\" class=\"applicable-policies__icon\" style={{ '--icon-size': '0.875rem' }}></ir-icons>}{' '}\n                                  {rightLabel}\n                                </td>\n\n                                <td class=\"applicable-policies__amount px-1\">{formatAmount(calendar_data.currency.symbol, bracket.gross_amount)}</td>\n\n                                <td class=\"applicable-policies__statement-text\">{bracket.amount === 0 ? 'No penalty' : bracket.statement}</td>\n                              </tr>\n                            );\n                          })}\n                          {/* {isTodaySameOrAfterCheckInDate && (\n                            <tr class={{ 'applicable-policies__highlighted-bracket': true }}>\n                              <td class=\"applicable-policies__bracket-dates\">{moment(statement.checkInDate, 'YYYY-MM-DD').add(1, 'days').format('MMM DD')} onwards</td>\n\n                              <td class=\"applicable-policies__amount px-1\">{formatAmount(calendar_data.currency.symbol, statement.grossTotal)}</td>\n\n                              <td class=\"applicable-policies__statement-text\">100% of the total price</td>\n                            </tr>\n                          )} */}\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </section>\n      </Host>\n    );\n  }\n}\n"],"version":3}