{"file":"ir-proforma-invoice-preview2.js","mappings":"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","names":["moment"],"sources":["src/components/printing/ir-proforma-invoice-preview/ir-proforma-invoice-preview.css?tag=ir-proforma-invoice-preview&encapsulation=shadow","src/components/printing/ir-proforma-invoice-preview/ir-proforma-invoice-preview.tsx"],"sourcesContent":["@import url('../../../assets/webawesome/component/host.css');\n@import url('../printing.css');\n:host {\n  display: block;\n  width: 100%;\n  color: #1b1d26;\n  background-color: white;\n  padding: 1rem;\n}\n.proforma-invoice__company-details::part(container) {\n  text-align: end;\n  justify-content: flex-end;\n}\n.invoice__layout {\n  display: flex;\n  justify-content: space-between;\n}\n.invoice__column,\n.property-overview {\n  display: flex;\n  flex-direction: column;\n}\n.invoice__column--property,\n.property-overview {\n  align-items: flex-end;\n  text-align: end;\n}\n.bill-to-section,\n.property-overview {\n  margin-top: 0.875rem;\n}\n.property-logo {\n  height: 2.5rem;\n}\n.invoice {\n  max-width: 58.25rem;\n  margin-left: auto !important;\n  margin-right: auto !important;\n}\n.proforma__accommodation-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  margin-bottom: 1rem;\n  padding: 1rem 0;\n  border-top: 1px solid #d1d5db;\n}\n.ir-proforma-invoice__service {\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n}\n.ir-proforma-invoice__checkbox-price {\n  font-weight: 700;\n  white-space: nowrap;\n}\n.ir-proforma-invoice__cancellation-date {\n  font-size: 0.875rem;\n  color: #374151;\n}\n.ir-proforma-invoice__cancellation-info {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  max-width: 80%;\n}\n.proforma__accommodation-container .proforma__accommodation-title {\n  font-weight: 600;\n  font-size: 1.125rem /* 18px */;\n  line-height: 1.75rem /* 28px */;\n  color: #111827;\n}\n.invoice__title {\n  font-size: 1.3rem;\n}\n.invoice__layout {\n  padding: 1rem 0;\n}\n.proforma-payment__section {\n  font-size: 1rem;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem 0;\n  gap: 0.5rem;\n  border-top: 1px solid #d1d5db;\n}\n\n@media print {\n  .invoice {\n    min-width: 100%;\n    height: auto;\n    min-height: auto;\n  }\n  .invoice,\n  .invoice * {\n    visibility: visible;\n  }\n\n  .invoice {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n  }\n}\n","import { Booking } from '@/models/booking.dto';\nimport { BookingInvoiceInfo } from '../../ir-invoice/types';\nimport { Component, Fragment, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { IssueInvoiceProps } from '@/services/booking-service/types';\nimport moment from 'moment';\nimport { calculateDaysBetweenDates } from '@/utils/booking';\nimport { formatAmount } from '@/utils/utils';\n\ntype InvoicePayload = IssueInvoiceProps['invoice'];\n\nexport interface NightlyRate {\n  date: string;\n  amount: number;\n}\n\n@Component({\n  tag: 'ir-proforma-invoice-preview',\n  styleUrl: 'ir-proforma-invoice-preview.css',\n  shadow: true,\n})\nexport class IrProformaInvoicePreview {\n  /**\n   * Booking context used to display property, guest, and folio details.\n   */\n  @Prop() booking: Booking;\n\n  /**\n   * Invoice payload emitted by `ir-invoice-form`.\n   * Totals will fall back to booking data when omitted.\n   */\n  @Prop() invoice?: InvoicePayload;\n\n  /**\n   * Property associated with the booking.\n   */\n  @Prop() property: Booking['property'];\n\n  /**\n   * Optional metadata fetched via `getBookingInvoiceInfo`.\n   * Used to display reference numbers (invoice/credit note/etc.).\n   */\n  @Prop() invoiceInfo?: BookingInvoiceInfo;\n\n  /**\n   * Locale used for date formatting.\n   */\n  @Prop() locale: string = 'en';\n\n  /**\n   * Optional footer text shown at the end of the preview.\n   */\n  @Prop() footerNote?: string;\n\n  @State() invocableKeys: Set<string | number>;\n\n  componentWillLoad() {\n    this.invocableKeys = new Set(this.invoice?.items?.map(i => i.key));\n  }\n\n  @Watch('invoice')\n  handleInvoiceChange() {\n    this.invocableKeys = new Set(this.invoice?.items?.map(i => i.key));\n  }\n\n  private get bookingNumber() {\n    if (!this.booking.is_direct) {\n      return `${this.booking.booking_nbr} | ${this.booking.channel_booking_nbr}`;\n    }\n    return this.booking.booking_nbr;\n  }\n\n  private get CompanyLocation() {\n    const { company } = this.property;\n    const { postal, city, country } = company;\n    if (!postal && !city && !country) return null;\n    const location = [];\n    if (postal) {\n      location.push(postal);\n    }\n    if (city) {\n      location.push(city);\n    }\n    if (country) {\n      if (postal || city) {\n        location.push(`,${country.name}`);\n      } else {\n        location.push(company.name);\n      }\n    }\n    if (location.length === 0) {\n      return null;\n    }\n    return <p class=\"invoice-company__location\">{location.join(' ')}</p>;\n  }\n  private get guestPhoneNumber() {\n    const { country_phone_prefix, mobile_without_prefix } = this.booking.guest;\n    // if (!is_direct) {\n    //     return mobile;\n    // }\n    if (!country_phone_prefix) {\n      return mobile_without_prefix;\n    }\n    return `+${country_phone_prefix?.replace('+', '')}-${mobile_without_prefix}`;\n  }\n  private formatDisplayDate(value?: string) {\n    if (!value) {\n      return null;\n    }\n    const parsedDate = moment(value, ['YYYY-MM-DD', moment.ISO_8601], true);\n    if (!parsedDate.isValid()) {\n      return null;\n    }\n    return parsedDate.format('MMMM DD, YYYY');\n  }\n\n  private get issueDate() {\n    return this.formatDisplayDate(this.invoice?.Date) ?? 'â€”';\n  }\n\n  private renderPropertyCompanyHeader() {\n    const { company } = this.property;\n    if (!company) {\n      return null;\n    }\n    return (\n      <div class=\"invoice-company\" aria-label=\"Issuing company details\">\n        {company.name && <p class=\"invoice-company__name\">{company.name}</p>}\n        {company.address && <p class=\"invoice-company__address\">{company.address}</p>}\n        {this.CompanyLocation}\n        {company.phone && (\n          <ir-printing-label class=\"proforma-invoice__company-details\" label={'Phone:'} content={`${company.country?.phone_prefix ?? ''} ${company.phone}`.trim()} />\n        )}\n        {company.tax_nbr && <ir-printing-label class=\"proforma-invoice__company-details\" label={'Tax ID:'} content={company.tax_nbr} />}\n      </div>\n    );\n  }\n  private renderPropertyInfo() {\n    const propertyLocation = [this.property?.city?.name ?? null, this.property?.country?.name ?? null].filter(f => f !== null).join(', ');\n    const propertyLogo = this.property?.space_theme?.logo;\n    return (\n      <section class=\"property-overview\" aria-label=\"Property overview\">\n        <div class=\"property-overview__text\">\n          <p class=\"property-overview__name\">{this.property.name}</p>\n          <p class=\"property-overview__location\">{propertyLocation}</p>\n        </div>\n        {propertyLogo && <img src={propertyLogo} alt={`${this.property.name} logo`} class=\"property-logo\" />}\n      </section>\n    );\n  }\n  private formatBookingDates(date: string) {\n    return moment(date, 'YYYY-MM-DD').format('DD-MMM-YYYY');\n  }\n  private renderBillToSection() {\n    const { guest, company_name, company_tax_nbr } = this.booking;\n    const { target, billed_to_name } = this.invoice;\n    if (target?.code === '002') {\n      return (\n        <div class=\"bill-to\" aria-label=\"Bill to company\">\n          {company_name && <p class=\"bill-to__name\">{company_name}</p>}\n          {company_tax_nbr && <p class=\"bill-to__id\">{company_tax_nbr}</p>}\n        </div>\n      );\n    }\n    return (\n      <div class=\"bill-to\" aria-label=\"Bill to guest\">\n        {billed_to_name && <p>{billed_to_name}</p>}\n        <p class=\"bill-to__name\">\n          {' '}\n          {billed_to_name && <b>for</b>} {[guest.first_name ?? '', guest.last_name ?? ''].join(' ').trim()}\n        </p>\n        {guest.email && <p class=\"bill-to__contact\">{guest.email}</p>}\n        {this.guestPhoneNumber && <p class=\"bill-to__contact\">{this.guestPhoneNumber}</p>}\n      </div>\n    );\n  }\n  private renderCancellationPenalty() {\n    const cancellationPenalty = this.booking.financial.payments?.find(p => p.payment_type?.code === '013');\n    if (!cancellationPenalty) {\n      return null;\n    }\n    const sysId = cancellationPenalty.system_id;\n    if (!this.invocableKeys.has(sysId)) {\n      return null;\n    }\n\n    return (\n      <section class=\"proforma-payment__section\">\n        <div class=\"ir-proforma-invoice__service\">\n          <div class={'ir-proforma-invoice__cancellation-info'}>\n            <p>Cancellation penalty</p>\n            <p class={'ir-proforma-invoice__cancellation-date'}>( {this.formatDisplayDate(cancellationPenalty.date)} )</p>\n          </div>\n          <span class=\"ir-proforma-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, cancellationPenalty.amount)}</span>\n        </div>\n      </section>\n    );\n  }\n  render() {\n    if (!this.booking || !this.invoice || !this.property) {\n      return;\n    }\n    const billToContent = this.renderBillToSection();\n    const companyDetails = this.renderPropertyCompanyHeader();\n    const propertyOverview = this.renderPropertyInfo();\n    const totalNights = calculateDaysBetweenDates(this.booking.from_date, this.booking.to_date);\n    const invocableRoom = this.booking.rooms.filter(room => this.invocableKeys.has(room.system_id));\n    const existInvocableRoom = invocableRoom.length > 0;\n    const existInvocableExtraService = this.booking.extra_services?.some(service => this.invocableKeys.has(service.system_id));\n    const existInvocablePickup = this.invocableKeys?.has(this.booking.pickup_info?.['system_id']);\n    return (\n      <Host>\n        <article class=\"invoice\" aria-label=\"Pro-forma invoice\">\n          <header class=\"invoice__header\">\n            <h3 class=\"invoice__title\">Pro-forma Invoice</h3>\n            <section class=\"invoice__layout\" aria-label=\"Invoice summary\">\n              <div class=\"invoice__column invoice__column--details\">\n                <div class=\"invoice__details\">\n                  <ir-printing-label label=\"Date of issue:\" content={this.issueDate}></ir-printing-label>\n                  <ir-printing-label label=\"Booking no:\" content={this.bookingNumber}></ir-printing-label>\n                </div>\n                {billToContent && (\n                  <section class=\"bill-to-section\" aria-label=\"Bill to\">\n                    <h4 class=\"section-heading\">Bill To</h4>\n                    {billToContent}\n                  </section>\n                )}\n              </div>\n              <div class=\"invoice__column invoice__column--property\">\n                {companyDetails && (\n                  <section class=\"issuer-section\" aria-label=\"Issuer\">\n                    {companyDetails}\n                  </section>\n                )}\n                {propertyOverview}\n              </div>\n            </section>\n          </header>\n          <main>\n            {existInvocableRoom && (\n              <section style={{ marginTop: '2.5rem' }}>\n                <div class=\"proforma__accommodation-container\">\n                  <p class=\"proforma__accommodation-title\">ACCOMMODATION</p>\n                  <p class=\"booking-dates\">{this.formatBookingDates(this.booking?.from_date)}</p>\n                  <p class=\"booking-dates\">{this.formatBookingDates(this.booking?.to_date)}</p>\n                  <p class=\"number-of-nights\">\n                    {totalNights} {totalNights === 1 ? 'night' : 'nights'}\n                  </p>\n                  <p class=\"vat-exclusion\">\n                    <i>{this.property?.tax_statement}</i>\n                  </p>\n                </div>\n                <div>\n                  {invocableRoom.map((room, idx) => {\n                    return (\n                      <Fragment>\n                        <ir-print-room\n                          room={room}\n                          idx={idx}\n                          booking={this.booking}\n                          key={room.identifier}\n                          currency={this.booking.currency.symbol}\n                          property={this.property as any}\n                        ></ir-print-room>\n                      </Fragment>\n                    );\n                  })}\n                </div>\n              </section>\n            )}\n            {existInvocablePickup && <ir-printing-pickup pickup={this.booking.pickup_info}></ir-printing-pickup>}\n            {existInvocableExtraService && (\n              <ir-printing-extra-service\n                invocableKeys={this.invocableKeys}\n                extraServices={this.booking.extra_services}\n                currency={this.booking.currency}\n              ></ir-printing-extra-service>\n            )}\n            {this.renderCancellationPenalty()}\n            <section class=\"proforma-payment__section\">\n              <ir-printing-label label=\"Balance:\" content={formatAmount(this.booking.currency.symbol, this.booking.financial.due_amount)}></ir-printing-label>\n              <ir-printing-label\n                label=\"Collected (payments - refunds):\"\n                content={formatAmount(this.booking.currency.symbol, this.booking.financial.collected + this.booking.financial.refunds)}\n              ></ir-printing-label>\n            </section>\n          </main>\n          {this.footerNote && (\n            <footer class=\"invoice__footer\">\n              <p class=\"invoice__footer-note\">{this.footerNote}</p>\n            </footer>\n          )}\n        </article>\n      </Host>\n    );\n  }\n}\n"],"version":3}