{"version":3,"file":"ir-pms-payment-due-alert.js","sourceRoot":"","sources":["../../../../src/components/pms-header/ir-pms-payment-due-alert/ir-pms-payment-due-alert.tsx"],"names":[],"mappings":"AAAA,OAAO,EAA6C,eAAe,EAAE,MAAM,6BAA6B,CAAC;AACzG,OAAO,KAAK,MAAM,gBAAgB,CAAC;AACnC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AAOvE,MAAM,OAAO,oBAAoB;IACvB,UAAU,CAAS;IACnB,MAAM,CAAS;IACf,OAAO,CAAS;IAEf,aAAa,GAAkB,EAAE,CAAC;IAEnC,YAAY,GAAG,IAAI,KAAK,EAAE,CAAC;IAC3B,eAAe,GAAG,IAAI,eAAe,EAAE,CAAC;IAEhD,iBAAiB;QACf,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7C,CAAC;QACD,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAChB,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACxC,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC5B,CAAC;IACH,CAAC;IAGD,kBAAkB,CAAC,QAAgB,EAAE,QAAgB;QACnD,IAAI,QAAQ,KAAK,QAAQ,IAAI,CAAC,QAAQ,EAAE,CAAC;YACvC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACrC,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5B,CAAC;IAEO,KAAK,CAAC,kBAAkB;QAC9B,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;YACrB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;YACxB,OAAO;QACT,CAAC;QACD,IAAI,CAAC;YACH,IAAI,CAAC,aAAa,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACtF,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QAC1B,CAAC;IACH,CAAC;IAED,MAAM;QACJ,MAAM,eAAe,GAAG,IAAI,CAAC,aAAa;YACxC,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC;YACrC,EAAE,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC;YAC3C,EAAE,MAAM,CAAC,OAAO,CAAC;YACjB,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;QACd,IAAI,CAAC,eAAe,EAAE,CAAC;YACrB,OAAO,EAAC,IAAI,OAAQ,CAAC;QACvB,CAAC;QACD,OAAO,CACL,EAAC,IAAI;YACH,kBAAY,KAAK,EAAC,gCAAgC,EAAC,IAAI,EAAC,OAAO,EAAC,UAAU,EAAC,QAAQ,EAAC,OAAO,EAAC,QAAQ;gBAClG,WAAK,KAAK,EAAC,wCAAwC;oBACjD,eAAS,KAAK,EAAE,EAAE,KAAK,EAAE,kCAAkC,EAAE,QAAQ,EAAE,MAAM,EAAE,EAAE,IAAI,EAAC,MAAM,EAAC,IAAI,EAAC,sBAAsB,GAAW;oBACnI,gBAAO,eAAe,CAAQ,CAC1B,CACK,CACR,CACR,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { FetchNotificationsResult as Notifications, PropertyService } from '@/services/property.service';\nimport Token from '@/models/Token';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\n\n@Component({\n  tag: 'ir-pms-payment-due-alert',\n  styleUrl: 'ir-pms-payment-due-alert.css',\n  scoped: true,\n})\nexport class IrPmsPaymentDueAlert {\n  @Prop() propertyid: number;\n  @Prop() ticket: string;\n  @Prop() baseUrl: string;\n\n  @State() notifications: Notifications = [];\n\n  private tokenService = new Token();\n  private propertyService = new PropertyService();\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.tokenService.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.fetchNotifications();\n    }\n  }\n\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue === oldValue || !newValue) {\n      return;\n    }\n    this.tokenService.setToken(newValue);\n    this.fetchNotifications();\n  }\n\n  private async fetchNotifications() {\n    if (!this.propertyid) {\n      this.notifications = [];\n      return;\n    }\n    try {\n      this.notifications = await this.propertyService.fetchNotifications(this.propertyid);\n    } catch (error) {\n      console.log(error);\n      this.notifications = [];\n    }\n  }\n\n  render() {\n    const combinedMessage = this.notifications\n      ?.filter(n => n.type === 'financial')\n      ?.map(notification => notification.message)\n      ?.filter(Boolean)\n      ?.join(' ');\n    if (!combinedMessage) {\n      return <Host></Host>;\n    }\n    return (\n      <Host>\n        <wa-callout class=\"pms-payment-due-alert__callout\" size=\"small\" appearance=\"filled\" variant=\"danger\">\n          <div class=\"pms-payment-due-alert__callout-message\">\n            <wa-icon style={{ color: 'var(--wa-color-danger-fill-loud)', fontSize: '1rem' }} slot=\"icon\" name=\"triangle-exclamation\"></wa-icon>\n            <span>{combinedMessage}</span>\n          </div>\n        </wa-callout>\n      </Host>\n    );\n  }\n}\n"]}