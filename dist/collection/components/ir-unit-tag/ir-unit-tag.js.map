{"version":3,"file":"ir-unit-tag.js","sourceRoot":"","sources":["../../../src/components/ir-unit-tag/ir-unit-tag.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AAC3E,OAAO,EAAE,EAAE,EAAE,MAAM,MAAM,CAAC;AAO1B,MAAM,OAAO,SAAS;IACZ,IAAI,CAAS;IAEZ,WAAW,GAAG,KAAK,CAAC;IAErB,GAAG,GAAG,EAAE,EAAE,CAAC;IACX,cAAc,CAAkB;IAChC,cAAc,CAAmB;IACjC,gBAAgB,CAAU;IAC1B,aAAa,GAAG,CAAC,EAAmB,EAAE,EAAE;QAC9C,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;YACxB,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAC;QACnC,CAAC;QAED,IAAI,CAAC,cAAc,GAAI,EAAsB,IAAI,SAAS,CAAC;QAE3D,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YACzB,OAAO;QACT,CAAC;QAED,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC,CAAC;IAEF,gBAAgB;QACd,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAED,oBAAoB;QAClB,IAAI,CAAC,cAAc,EAAE,UAAU,EAAE,CAAC;QAClC,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC1B,oBAAoB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC5C,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;QACpC,CAAC;IACH,CAAC;IAGD,YAAY;QACV,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAEO,oBAAoB;QAC1B,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,OAAO,cAAc,KAAK,WAAW,EAAE,CAAC;YACnG,OAAO;QACT,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YACzB,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC;QAC/E,CAAC;QAED,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IACnD,CAAC;IAEO,qBAAqB;QAC3B,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE,CAAC;YAClC,OAAO;QACT,CAAC;QAED,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC1B,oBAAoB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC9C,CAAC;QAED,IAAI,CAAC,gBAAgB,GAAG,qBAAqB,CAAC,GAAG,EAAE;YACjD,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;YAClC,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,kBAAkB;QACxB,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE,CAAC;YAClC,OAAO;QACT,CAAC;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC;QAEpC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;YAC3B,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YAC3B,CAAC;YACD,OAAO;QACT,CAAC;QAED,MAAM,UAAU,GAAG,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;QAC7D,IAAI,UAAU,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;YACpC,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;QAChC,CAAC;IACH,CAAC;IAED,MAAM;QACJ,OAAO,CACL,EAAC,QAAQ;YACN,IAAI,CAAC,WAAW,IAAI,mEAAY,GAAG,EAAE,IAAI,CAAC,GAAG,IAAG,IAAI,CAAC,IAAI,CAAc;YACxE,+DAAQ,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,KAAK,EAAC,cAAc,EAAC,IAAI,EAAC,OAAO,EAAC,UAAU,EAAC,QAAQ,EAAC,OAAO,EAAC,OAAO;gBACzF,6DAAM,KAAK,EAAC,mBAAmB,EAAC,GAAG,EAAE,IAAI,CAAC,aAAa,IACpD,IAAI,CAAC,IAAI,CACL,CACA,CACA,CACZ,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Fragment, Prop, State, Watch, h } from '@stencil/core';\nimport { v4 } from 'uuid';\n\n@Component({\n  tag: 'ir-unit-tag',\n  styleUrls: ['ir-unit-tag.css'],\n  scoped: true,\n})\nexport class IrUnitTag {\n  @Prop() unit: string;\n\n  @State() showTooltip = false;\n\n  private _id = v4();\n  private resizeObserver?: ResizeObserver;\n  private contentElement?: HTMLSpanElement;\n  private measurementFrame?: number;\n  private setContentRef = (el?: Element | null) => {\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n    }\n\n    this.contentElement = (el as HTMLSpanElement) || undefined;\n\n    if (!this.contentElement) {\n      return;\n    }\n\n    this.attachResizeObserver();\n    this.scheduleTooltipUpdate();\n  };\n\n  componentDidLoad() {\n    this.attachResizeObserver();\n    this.scheduleTooltipUpdate();\n  }\n\n  disconnectedCallback() {\n    this.resizeObserver?.disconnect();\n    if (this.measurementFrame) {\n      cancelAnimationFrame(this.measurementFrame);\n      this.measurementFrame = undefined;\n    }\n  }\n\n  @Watch('unit')\n  onUnitChange() {\n    this.scheduleTooltipUpdate();\n  }\n\n  private attachResizeObserver() {\n    if (typeof window === 'undefined' || !this.contentElement || typeof ResizeObserver === 'undefined') {\n      return;\n    }\n\n    if (!this.resizeObserver) {\n      this.resizeObserver = new ResizeObserver(() => this.scheduleTooltipUpdate());\n    }\n\n    this.resizeObserver.observe(this.contentElement);\n  }\n\n  private scheduleTooltipUpdate() {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    if (this.measurementFrame) {\n      cancelAnimationFrame(this.measurementFrame);\n    }\n\n    this.measurementFrame = requestAnimationFrame(() => {\n      this.measurementFrame = undefined;\n      this.updateTooltipState();\n    });\n  }\n\n  private updateTooltipState() {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    const content = this.contentElement;\n\n    if (!content || !this.unit) {\n      if (this.showTooltip) {\n        this.showTooltip = false;\n      }\n      return;\n    }\n\n    const shouldShow = content.scrollWidth > content.clientWidth;\n    if (shouldShow !== this.showTooltip) {\n      this.showTooltip = shouldShow;\n    }\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.showTooltip && <wa-tooltip for={this._id}>{this.unit}</wa-tooltip>}\n        <wa-tag id={this._id} class=\"unit-tag__el\" size=\"small\" appearance=\"filled\" variant=\"brand\">\n          <span class=\"unit-tag__content\" ref={this.setContentRef}>\n            {this.unit}\n          </span>\n        </wa-tag>\n      </Fragment>\n    );\n  }\n}\n"]}