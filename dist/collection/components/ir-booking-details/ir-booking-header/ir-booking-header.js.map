{"version":3,"file":"ir-booking-header.js","sourceRoot":"","sources":["../../../../src/components/ir-booking-details/ir-booking-header/ir-booking-header.tsx"],"names":[],"mappings":"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","sourcesContent":["import { IToast } from '@/components/ui/ir-toast/toast';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\nimport calendar_data from '@/stores/calendar-data';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, h, Listen, Prop, State } from '@stencil/core';\nimport { BookingDetailsDialogEvents, OpenDialogEvent, OpenSidebarEvent } from '../types';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-booking-header',\n  styleUrl: 'ir-booking-header.css',\n  scoped: true,\n})\nexport class IrBookingHeader {\n  @Prop() booking: Booking;\n  @Prop() hasReceipt: boolean;\n  @Prop() hasPrint: boolean;\n  @Prop() hasDelete: boolean;\n  @Prop() hasMenu: boolean;\n  @Prop() hasCloseButton: boolean;\n  @Prop() hasEmail: boolean = true;\n\n  @State() bookingStatus: string | null = null;\n  @State() currentDialogStatus: BookingDetailsDialogEvents;\n\n  @Event() toast: EventEmitter<IToast>;\n  @Event() closeSidebar: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\n\n  private confirmationBG = {\n    '001': 'bg-ir-orange',\n    '002': 'bg-ir-green',\n    '003': 'bg-ir-red',\n    '004': 'bg-ir-red',\n  };\n  private dialogRef: HTMLIrDialogElement;\n\n  private bookingService = new BookingService();\n  modalEl: HTMLIrModalElement;\n\n  @Listen('selectChange')\n  handleSelectChange(e: CustomEvent<any>) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    const target = e.target;\n    this.bookingStatus = (target as any).selectedValue;\n  }\n  private async updateStatus() {\n    if (!this.bookingStatus || this.bookingStatus === '-1') {\n      this.toast.emit({\n        type: 'error',\n        description: '',\n        title: locales.entries.Lcz_SelectStatus,\n        position: 'top-right',\n      });\n      return;\n    }\n    try {\n      await this.bookingService.changeExposedBookingStatus({\n        book_nbr: this.booking.booking_nbr,\n        status: this.bookingStatus,\n      });\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: locales.entries.Lcz_StatusUpdatedSuccessfully,\n        position: 'top-right',\n      });\n      this.bookingStatus = null;\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private openDialog(e: OpenDialogEvent) {\n    const { type } = e;\n    this.currentDialogStatus = type;\n    this.dialogRef.openModal();\n  }\n  private renderDialogBody() {\n    switch (this.currentDialogStatus) {\n      case 'pms':\n        return <ir-pms-logs slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-pms-logs>;\n      case 'events-log':\n        return <ir-events-log booking={this.booking} slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-events-log>;\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"fluid-container px-1\">\n        <div class=\"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1\">\n          <div class=\"m-0 p-0 mb-1 mb-lg-0 mt-md-0\">\n            <p class=\"font-size-large m-0 p-0\">{`${locales.entries.Lcz_Booking}#${this.booking.booking_nbr}`}</p>\n            <p class=\"m-0 p-0\">{!this.booking.is_direct && <span class=\"mr-1 m-0\">{this.booking.channel_booking_nbr}</span>}</p>\n          </div>\n\n          <div class=\"d-flex justify-content-end align-items-center\" style={{ gap: '1rem', flexWrap: 'wrap' }}>\n            <span class={`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.is_requested_to_cancel ? '003' : this.booking.status.code]}`}>\n              {this.booking.is_requested_to_cancel ? locales.entries.Lcz_CancellationRequested : this.booking.status.description}\n            </span>\n            {this.booking.allowed_actions.length > 0 && this.booking.is_editable && (\n              <div class=\"m-0 p-0 d-flex align-items-center\" style={{ gap: '0.25rem' }}>\n                <ir-select\n                  selectContainerStyle=\"h-28\"\n                  selectStyles=\"d-flex status-select align-items-center h-28\"\n                  firstOption={locales.entries.Lcz_Select}\n                  id=\"update-status\"\n                  size=\"sm\"\n                  label-available=\"false\"\n                  data={this.booking.allowed_actions.map(b => ({ text: b.description, value: b.code }))}\n                  textSize=\"sm\"\n                  class=\"sm-padding-right m-0 \"\n                  selectedValue={this.bookingStatus}\n                ></ir-select>\n                <ir-button\n                  onClickHandler={() => {\n                    if (!this.booking.is_direct) {\n                      this.modalEl.openModal();\n                      return;\n                    }\n                    this.updateStatus();\n                  }}\n                  btn_styles=\"h-28\"\n                  isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n                  btn_disabled={isRequestPending('/Change_Exposed_Booking_Status')}\n                  id=\"update-status-btn\"\n                  size=\"sm\"\n                  text=\"Update\"\n                ></ir-button>\n              </div>\n            )}\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              text={locales.entries.Lcz_EventsLog}\n              onClickHandler={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.openDialog({ type: 'events-log' });\n              }}\n            ></ir-button>\n            {calendar_data.is_pms_enabled && (\n              <ir-button\n                size=\"sm\"\n                btn_color=\"outline\"\n                text={locales.entries.Lcz_pms}\n                onClick={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.openDialog({ type: 'pms' });\n                }}\n              ></ir-button>\n            )}\n            {this.hasReceipt && <ir-button variant=\"icon\" id=\"receipt\" icon_name=\"reciept\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasPrint && <ir-button variant=\"icon\" id=\"print\" icon_name=\"print\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasEmail && <ir-button variant=\"icon\" id=\"email\" title=\"Email this booking\" icon_name=\"email\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasDelete && <ir-button variant=\"icon\" id=\"book-delete\" icon_name=\"trash\" class=\"\" style={{ ...colorVariants.danger, '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasMenu && <ir-button variant=\"icon\" class=\"mr-1\" id=\"menu\" icon_name=\"menu_list\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n\n            {this.hasCloseButton && (\n              <ir-button\n                id=\"close\"\n                variant=\"icon\"\n                style={{ '--icon-size': '1.65rem' }}\n                icon_name=\"xmark\"\n                class=\"ml-2\"\n                onClickHandler={e => {\n                  e.stopPropagation();\n                  e.stopImmediatePropagation();\n                  this.closeSidebar.emit(null);\n                }}\n              ></ir-button>\n            )}\n          </div>\n        </div>\n        <ir-dialog\n          onOpenChange={e => {\n            if (!e.detail) {\n              this.currentDialogStatus = null;\n            }\n          }}\n          style={this.currentDialogStatus === 'events-log' && { '--ir-dialog-max-width': '400px' }}\n          ref={el => (this.dialogRef = el)}\n        >\n          {this.renderDialogBody()}\n        </ir-dialog>\n        <ir-modal\n          ref={el => (this.modalEl = el)}\n          modalTitle={''}\n          leftBtnText={locales?.entries?.Lcz_Cancel}\n          rightBtnText={locales?.entries?.Lcz_Confirm}\n          modalBody={\n            'ALERT! Modifying a channel booking will create a discrepancy between igloorooms and the source. Future guest modifications on the channel may require manual adjustments of the booking.'\n          }\n          isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n          onConfirmModal={this.updateStatus.bind(this)}\n        ></ir-modal>\n      </div>\n    );\n  }\n}\n"]}