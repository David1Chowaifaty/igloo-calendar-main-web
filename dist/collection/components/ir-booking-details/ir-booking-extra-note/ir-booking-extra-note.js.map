{"version":3,"file":"ir-booking-extra-note.js","sourceRoot":"","sources":["../../../../src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx"],"names":[],"mappings":"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","sourcesContent":["import locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Method, Prop, State, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { getPrivateNote } from '@/utils/booking';\n@Component({\n  tag: 'ir-booking-extra-note',\n  styleUrls: ['ir-booking-extra-note.css'],\n  scoped: true,\n})\nexport class IrBookingExtraNote {\n  @Prop({ mutable: true, reflect: true }) open: boolean;\n  @Prop() booking: Booking;\n\n  @State() isLoading = false;\n  @State() note = '';\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\n\n  private bookingService = new BookingService();\n  componentWillLoad() {\n    if (this.booking.extras) {\n      this.setNote(getPrivateNote(this.booking.extras));\n    }\n  }\n\n  private setNote(value: string) {\n    this.note = value;\n  }\n  private async savePrivateNote() {\n    try {\n      this.isLoading = true;\n      let prevExtras = this.booking.extras || [];\n      const newExtraObj = { key: 'private_note', value: this.note };\n      if (prevExtras.length === 0) {\n        prevExtras.push(newExtraObj);\n      } else {\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\n        if (oldPrivateNoteIndex === -1) {\n          prevExtras.push(newExtraObj);\n        } else {\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\n        }\n      }\n      const res = await this.bookingService.doReservation({\n        assign_units: true,\n        is_pms: true,\n        is_direct: true,\n        is_in_loyalty_mode: false,\n        promo_key: null,\n        booking: this.booking,\n        Is_Non_Technical_Change: true,\n        extras: prevExtras,\n      });\n      this.resetBookingEvt.emit(res);\n      this.closeDialog();\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  @Method()\n  async openDialog() {\n    this.open = true;\n  }\n  @Method()\n  async closeDialog() {\n    this.open = false;\n  }\n  render() {\n    return (\n      <ir-dialog\n        label=\"Private note\"\n        open={this.open}\n        onIrDialogHide={() => {\n          this.open = false;\n        }}\n      >\n        <wa-textarea\n          size=\"small\"\n          placeholder={locales.entries.Lcz_PrivateNote_MaxChar}\n          defaultValue={this.note}\n          onchange={e => this.setNote((e.target as any).value)}\n          value={this.note}\n        ></wa-textarea>\n        <div slot=\"footer\" class=\"ir-dialog__footer\">\n          <ir-custom-button data-dialog=\"close\" size=\"medium\" variant=\"neutral\" appearance=\"filled\" onClickHandler={() => this.closeModal.emit(null)} class={`flex-fill'}`}>\n            {locales.entries.Lcz_Cancel}\n          </ir-custom-button>\n\n          <ir-custom-button size=\"medium\" onClickHandler={() => this.savePrivateNote()} variant=\"brand\" loading={this.isLoading}>\n            {locales.entries.Lcz_Save}\n          </ir-custom-button>\n        </div>\n      </ir-dialog>\n    );\n  }\n}\n"]}