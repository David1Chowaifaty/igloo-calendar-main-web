{"version":3,"file":"ir-booking-extra-note.js","sourceRoot":"","sources":["../../../../src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx"],"names":[],"mappings":"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","sourcesContent":["import locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { getPrivateNote } from '@/utils/booking';\n@Component({\n  tag: 'ir-booking-extra-note',\n  styleUrls: ['ir-booking-extra-note.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrBookingExtraNote {\n  @Prop() booking: Booking;\n\n  @State() isLoading = false;\n  @State() note = '';\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\n\n  private bookingService = new BookingService();\n  componentWillLoad() {\n    if (this.booking.extras) {\n      this.setNote(getPrivateNote(this.booking.extras));\n    }\n  }\n\n  private setNote(value: string) {\n    this.note = value;\n  }\n  private async savePrivateNote() {\n    try {\n      this.isLoading = true;\n      let prevExtras = this.booking.extras || [];\n      const newExtraObj = { key: 'private_note', value: this.note };\n      if (prevExtras.length === 0) {\n        prevExtras.push(newExtraObj);\n      } else {\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\n        if (oldPrivateNoteIndex === -1) {\n          prevExtras.push(newExtraObj);\n        } else {\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\n        }\n      }\n      const res = await this.bookingService.doReservation({\n        assign_units: true,\n        is_pms: true,\n        is_direct: true,\n        is_in_loyalty_mode: false,\n        promo_key: null,\n        booking: this.booking,\n        Is_Non_Technical_Change: true,\n        extras: prevExtras,\n      });\n      this.resetBookingEvt.emit(res);\n      this.closeModal.emit(null);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container h-100'}\n        onSubmit={e => {\n          e.preventDefault();\n          this.savePrivateNote();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_PrivateNote} displayContext=\"sidebar\"></ir-title>\n        <div class=\"sheet-body px-1\">\n          <ir-textarea placeholder={locales.entries.Lcz_PrivateNote_MaxChar} label=\"\" value={this.note} maxLength={150} onTextChange={e => this.setNote(e.detail)}></ir-textarea>\n        </div>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClickHandler={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`}\n            icon=\"\"\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'m-0 flex-fill text-center ml-sm-1'}\n            icon=\"\"\n            isLoading={this.isLoading}\n            text={locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n            btn_type=\"submit\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n"]}