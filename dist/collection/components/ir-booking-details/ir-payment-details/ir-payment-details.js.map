{"version":3,"file":"ir-payment-details.js","sourceRoot":"","sources":["../../../../src/components/ir-booking-details/ir-payment-details/ir-payment-details.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Prop, State, Event, EventEmitter, Listen } from '@stencil/core';\nimport { Booking, IPayment } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { PaymentService, IPaymentAction } from '@/services/payment.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { Payment, PaymentEntries, PaymentSidebarEvent, PrintScreenOptions } from '../types';\nimport moment from 'moment';\nimport { formatAmount } from '@/utils/utils';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  styleUrl: 'ir-payment-details.css',\n  tag: 'ir-payment-details',\n  scoped: true,\n})\nexport class IrPaymentDetails {\n  @Prop({ mutable: true }) booking: Booking;\n  @Prop() paymentActions: IPaymentAction[];\n  @Prop() propertyId: number;\n  @Prop() paymentEntries: PaymentEntries;\n\n  @State() confirmModal: boolean = false;\n  @State() toBeDeletedItem: IPayment | null = null;\n  @State() modalMode: 'delete' | 'save' | null = null;\n  @State() isLoading: boolean = false;\n\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true }) resetExposedCancellationDueAmount: EventEmitter<null>;\n  @Event({ bubbles: true }) toast: EventEmitter<IToast>;\n  @Event({ bubbles: true }) openSidebar: EventEmitter<PaymentSidebarEvent>;\n  @Event({ bubbles: true }) openPrintScreen: EventEmitter<PrintScreenOptions>;\n\n  private paymentService = new PaymentService();\n  private bookingService = new BookingService();\n  private dialogRef: HTMLIrDialogElement;\n\n  @Listen('generatePayment')\n  handlePaymentGeneration(e: CustomEvent) {\n    const value = e.detail;\n    const paymentType = this.paymentEntries?.types?.find(p => p.CODE_NAME === (this.booking.status.code === '003' ? value.pay_type_code : '001'));\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment: {\n          ...value,\n          date: moment().format('YYYY-MM-DD'),\n          id: -1,\n          amount: value.amount,\n          payment_type: paymentType\n            ? {\n                code: paymentType.CODE_NAME,\n                description: paymentType.CODE_VALUE_EN,\n                operation: paymentType.NOTES,\n              }\n            : null,\n          designation: paymentType?.CODE_VALUE_EN ?? null,\n        },\n        mode: 'payment-action',\n      },\n    });\n  }\n\n  private handleAddPayment = (props?: { type: 'cancellation-penalty' | 'refund'; amount: number }) => {\n    let payment: Payment = {\n      id: -1,\n      date: moment().format('YYYY-MM-DD'),\n      amount: null,\n      currency: calendar_data.currency,\n      designation: null,\n      reference: null,\n    };\n    if (props) {\n      const { amount, type } = props;\n      const cashMethod = this.paymentEntries.methods.find(pt => pt.CODE_NAME === '001');\n      const payment_method = {\n        code: cashMethod.CODE_NAME,\n        description: cashMethod.CODE_VALUE_EN,\n        operation: cashMethod.NOTES,\n      };\n      const paymentType = this.paymentEntries.types.find(pt => pt.CODE_NAME === (type === 'cancellation-penalty' ? '001' : '010'));\n      payment = {\n        ...payment,\n        amount: amount,\n        designation: paymentType.CODE_VALUE_EN,\n        payment_type: {\n          code: paymentType.CODE_NAME,\n          description: paymentType.CODE_VALUE_EN,\n          operation: paymentType.NOTES,\n        },\n        payment_method: type === 'refund' ? undefined : payment_method,\n      };\n      this.openSidebar.emit({\n        type: 'payment-folio',\n        payload: {\n          payment,\n          mode: 'payment-action',\n        },\n      });\n      return;\n    }\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment,\n        mode: 'new',\n      },\n    });\n  };\n\n  private handleEditPayment(payment: IPayment) {\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: { payment, mode: 'edit' },\n    });\n  }\n\n  private handleDeletePayment(payment: IPayment) {\n    this.modalMode = 'delete';\n    this.toBeDeletedItem = payment;\n    this.dialogRef.openModal();\n  }\n\n  private async handleIssueReceipt(detail: IPayment) {\n    if (detail.receipt_nbr) {\n      this.openPrintScreen.emit({\n        mode: 'receipt',\n        payload: {\n          pid: detail.system_id?.toString(),\n          rnb: detail.receipt_nbr,\n        },\n      });\n      return;\n    }\n    const _number = await this.bookingService.getNextValue({ starter: 'RC' });\n    this.openPrintScreen.emit({\n      mode: 'receipt',\n      payload: {\n        pid: detail.system_id?.toString(),\n        rnb: `RC-${_number.My_Result}`,\n      },\n    });\n  }\n\n  private async cancelPayment() {\n    try {\n      this.isLoading = true;\n      await this.paymentService.CancelPayment(this.toBeDeletedItem.system_id);\n      const newPaymentArray = this.booking.financial.payments.filter((item: IPayment) => item.id !== this.toBeDeletedItem.id);\n\n      this.booking = {\n        ...this.booking,\n        financial: { ...this.booking.financial, payments: newPaymentArray },\n      };\n\n      this.dialogRef.closeModal();\n      this.confirmModal = false;\n      this.resetBookingEvt.emit(null);\n      this.resetExposedCancellationDueAmount.emit(null);\n      this.toBeDeletedItem = null;\n    } catch (error) {\n      console.error('Error canceling payment:', error);\n      this.toast.emit({\n        type: 'error',\n        title: 'Error',\n        description: 'Failed to cancel payment. Please try again.',\n        position: 'top-right',\n      });\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private handleConfirmModal = async (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n\n    if (this.modalMode === 'delete') {\n      await this.cancelPayment();\n    }\n  };\n\n  private handleCancelModal = (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalMode = null;\n    this.toBeDeletedItem = null;\n  };\n\n  private hasValidFinancialData(): boolean {\n    return Boolean(this.booking?.financial);\n  }\n\n  // private shouldShowPaymentActions(): boolean {\n  //   return Boolean(this.paymentActions?.filter(pa => pa.amount !== 0).length > 0 && this.booking.is_direct);\n  // }\n  private shouldShowRefundButton(): boolean {\n    if (!this.booking.is_direct) {\n      return false;\n    }\n    if (this.booking.financial.due_amount === 0) {\n      return false;\n    }\n    if (this.booking.financial.cancelation_penality_as_if_today === 0) {\n      return false;\n    }\n    if (this.booking.is_requested_to_cancel || ['003', '004'].includes(this.booking.status.code)) {\n      return this.booking.financial.cancelation_penality_as_if_today < 0;\n    }\n    return false;\n  }\n\n  private shouldCancellationButton(): boolean {\n    if (!this.booking.is_direct) {\n      return false;\n    }\n    if (this.booking.financial.due_amount === 0) {\n      return false;\n    }\n    if (this.booking.financial.cancelation_penality_as_if_today === 0) {\n      return false;\n    }\n    if (['003', '004'].includes(this.booking.status.code) && this.booking.financial.cancelation_penality_as_if_today > 0) {\n      return true;\n    }\n    return false;\n  }\n\n  render() {\n    if (!this.hasValidFinancialData()) {\n      return null;\n    }\n\n    const { financial, currency } = this.booking;\n\n    return [\n      <wa-card>\n        <ir-payment-summary\n          isBookingCancelled={['003', '004'].includes(this.booking.status.code)}\n          totalCost={financial.gross_cost}\n          balance={financial.due_amount}\n          collected={this.booking.financial.collected + this.booking.financial.refunds}\n          currency={currency}\n        />\n        <ir-booking-guarantee booking={this.booking} bookingService={this.bookingService} />\n        {/* {this.shouldShowPaymentActions() && <ir-payment-actions paymentAction={this.paymentActions} booking={this.booking} />} */}\n        {!['003', '004'].includes(this.booking.status.code) && this.booking.is_direct && (\n          <ir-applicable-policies propertyId={this.propertyId} booking={this.booking}></ir-applicable-policies>\n        )}\n\n        {this.shouldShowRefundButton() && (\n          <div class=\"d-flex mt-1\">\n            <ir-custom-button\n              variant=\"brand\"\n              appearance=\"outlined\"\n              onClickHandler={() => {\n                this.handleAddPayment({ type: 'refund', amount: Math.abs(this.booking.financial.cancelation_penality_as_if_today) });\n              }}\n            >\n              {`Refund ${formatAmount(currency.symbol, Math.abs(this.booking.financial.cancelation_penality_as_if_today))}`}\n            </ir-custom-button>\n          </div>\n        )}\n        {this.shouldCancellationButton() && (\n          <div class=\"d-flex mt-1\">\n            <ir-custom-button\n              variant=\"brand\"\n              appearance=\"outlined\"\n              onClickHandler={() => {\n                this.handleAddPayment({ type: 'cancellation-penalty', amount: Math.abs(this.booking.financial.cancelation_penality_as_if_today) });\n              }}\n            >\n              {`Charge cancellation penalty ${formatAmount(currency.symbol, this.booking.financial.cancelation_penality_as_if_today)}`}\n            </ir-custom-button>\n          </div>\n        )}\n      </wa-card>,\n      <ir-payments-folio\n        payments={financial.payments || []}\n        onAddPayment={() => this.handleAddPayment()}\n        onEditPayment={e => this.handleEditPayment(e.detail)}\n        onDeletePayment={e => this.handleDeletePayment(e.detail)}\n        onIssueReceipt={e => this.handleIssueReceipt(e.detail)}\n      />,\n      <ir-dialog\n        onIrDialogHide={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n        }}\n        onIrDialogAfterHide={e => {\n          this.handleCancelModal(e);\n        }}\n        ref={el => (this.dialogRef = el)}\n        label=\"Alert\"\n        lightDismiss={this.modalMode !== 'delete'}\n      >\n        <p>{this.modalMode === 'delete' ? locales.entries.Lcz_IfDeletedPermantlyLost : locales.entries.Lcz_EnteringAmountGreaterThanDue}</p>\n        <div slot=\"footer\" class=\"ir-dialog__footer\">\n          <ir-custom-button size=\"medium\" data-dialog=\"close\" variant=\"neutral\" appearance=\"filled\">\n            {locales.entries.Lcz_Cancel}\n          </ir-custom-button>\n          <ir-custom-button loading={this.isLoading} size=\"medium\" onClickHandler={e => this.handleConfirmModal(e)} variant={this.modalMode === 'delete' ? 'danger' : 'brand'}>\n            {this.modalMode === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\n          </ir-custom-button>\n        </div>\n      </ir-dialog>,\n    ];\n  }\n}\n"]}