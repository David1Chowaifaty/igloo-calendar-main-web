{"version":3,"file":"ir-payment-folio.js","sourceRoot":"","sources":["../../../../../src/components/ir-booking-details/ir-payment-details/ir-payment-folio/ir-payment-folio.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAgB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AACvF,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,OAAO,EAAE,EAAE,EAAE,MAAM,MAAM,CAAC;AAE1B,MAAM,WAAW,GAAG,YAAY,CAAC;AAOjC,MAAM,OAAO,cAAc;IACzB;;;;OAIG;IACK,cAAc,CAAiB;IAEvC;;;;OAIG;IACK,aAAa,CAAS;IAE9B;;;;OAIG;IACK,OAAO,GAAY;QACzB,IAAI,EAAE,MAAM,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC;QAClC,MAAM,EAAE,CAAC;QACT,WAAW,EAAE,SAAS;QACtB,QAAQ,EAAE,IAAI;QACd,SAAS,EAAE,IAAI;QACf,EAAE,EAAE,CAAC,CAAC;KACP,CAAC;IAEF;;;;OAIG;IACK,IAAI,CAAiB;IAEpB,SAAS,GAA0B,IAAI,CAAC;IACxC,MAAM,CAAU;IAEzB;;;;;OAKG;IACM,UAAU,CAAqB;IAExC;;;;OAIG;IAEH,KAAK,CAAC,SAAS;QACb,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACrB,CAAC;IAED;;;;OAIG;IAEH,KAAK,CAAC,UAAU;QACd,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEO,GAAG,GAAG,kBAAkB,EAAE,EAAE,EAAE,CAAC;IAEvC,MAAM;QACJ,iGAAiG;QACjG,OAAO,CACL,kEACE,SAAS,EAAC,OAAO,EACjB,KAAK,EAAE;gBACL,mBAAmB,EAAE,OAAO;gBAC5B,8BAA8B,EAAE,iCAAiC;gBACjE,0BAA0B,EAAE,gBAAgB;gBAC5C,2BAA2B,EAAE,gBAAgB;gBAC7C,yBAAyB,EAAE,gBAAgB;gBAC3C,4BAA4B,EAAE,gBAAgB;aAC/C,EACD,KAAK,EAAE,IAAI,CAAC,OAAO,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,iBAAiB,EACvE,IAAI,EAAE,IAAI,CAAC,MAAM,EACjB,YAAY,EAAE,KAAK,CAAC,EAAE;gBACpB,KAAK,CAAC,wBAAwB,EAAE,CAAC;gBACjC,KAAK,CAAC,eAAe,EAAE,CAAC;gBACxB,IAAI,CAAC,UAAU,EAAE,CAAC;YACpB,CAAC;YAEA,IAAI,CAAC,MAAM,IAAI,CACd,8EACE,MAAM,EAAE,IAAI,CAAC,GAAG,EAChB,gBAAgB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,MAAM,CAAC,EAClD,YAAY,EAAE,CAAC,CAAC,EAAE;oBAChB,CAAC,CAAC,wBAAwB,EAAE,CAAC;oBAC7B,CAAC,CAAC,eAAe,EAAE,CAAC;oBACpB,IAAI,CAAC,UAAU,EAAE,CAAC;gBACpB,CAAC,EACD,cAAc,EAAE,IAAI,CAAC,cAAc,EACnC,aAAa,EAAE,IAAI,CAAC,aAAa,EACjC,OAAO,EAAE,IAAI,CAAC,OAAO,EACrB,IAAI,EAAE,IAAI,CAAC,IAAI,GACQ,CAC1B;YACD,4DAAK,IAAI,EAAC,QAAQ,EAAC,KAAK,EAAC,iCAAiC,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,oBAAoB,EAAE;gBAC7F,yEAAkB,KAAK,EAAC,WAAW,EAAC,IAAI,EAAC,QAAQ,iBAAa,OAAO,EAAC,UAAU,EAAC,QAAQ,EAAC,OAAO,EAAC,SAAS,EAAC,cAAc,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,EAAE,aAEhI;gBACnB,yEACE,IAAI,EAAE,IAAI,CAAC,GAAG,EACd,OAAO,EAAE,IAAI,CAAC,SAAS,KAAK,MAAM,EAClC,KAAK,EAAC,WAAW,EACjB,IAAI,EAAC,QAAQ,EACb,IAAI,EAAC,QAAQ,EACb,KAAK,EAAC,MAAM;oBACZ,oDAAoD;oBACpD,UAAU,EAAE,QAAQ,EACpB,OAAO,EAAC,OAAO,WAGE,CAgBf,CACI,CACb,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Event, EventEmitter, Method, Prop, State, h } from '@stencil/core';\nimport moment from 'moment';\nimport { FolioEntryMode, Payment, PaymentEntries } from '../../types';\nimport { v4 } from 'uuid';\n\nconst DATE_FORMAT = 'YYYY-MM-DD';\n\n@Component({\n  tag: 'ir-payment-folio',\n  styleUrls: ['ir-payment-folio.css'],\n  scoped: true,\n})\nexport class IrPaymentFolio {\n  /**\n   * The list of existing payment or folio entries associated with the booking.\n   * Used by the folio form to determine validation rules, available actions,\n   * and how the new or edited entry should be inserted or updated.\n   */\n  @Prop() paymentEntries: PaymentEntries;\n\n  /**\n   * The booking reference number associated with this folio operation.\n   * Passed down to the folio form so the payment entry is linked to the\n   * correct reservation when saving.\n   */\n  @Prop() bookingNumber: string;\n\n  /**\n   * The payment or folio entry being created or edited.\n   * Defaults to a new empty payment object when the component\n   * is used for creating a new entry.\n   */\n  @Prop() payment: Payment = {\n    date: moment().format(DATE_FORMAT),\n    amount: 0,\n    designation: undefined,\n    currency: null,\n    reference: null,\n    id: -1,\n  };\n\n  /**\n   * Determines how the folio entry should behave or be displayed.\n   * Typical modes include creating a new entry, editing an existing one,\n   * or other folio-specific workflows.\n   */\n  @Prop() mode: FolioEntryMode;\n\n  @State() isLoading: 'save' | 'save-print' = null;\n  @State() isOpen: boolean;\n\n  /**\n   * Emitted when the folio drawer should be closed.\n   * Fired whenever the user cancels, the form requests closing,\n   * or the drawer itself is hidden. Consumers listen for this event\n   * to know when the folio UI has been dismissed.\n   */\n  @Event() closeModal: EventEmitter<null>;\n\n  /**\n   * Opens the folio drawer.\n   * This method can be called externally on the component instance\n   * to programmatically display the folio form.\n   */\n  @Method()\n  async openFolio() {\n    this.isOpen = true;\n  }\n\n  /**\n   * Closes the folio drawer and emits the `closeModal` event.\n   * Used internally when the user cancels or the form indicates\n   * that it has completed its action.\n   */\n  @Method()\n  async closeFolio() {\n    this.isOpen = false;\n    this.closeModal.emit(null);\n  }\n\n  private _id = `ir__folio-form-${v4()}`;\n\n  render() {\n    // const isNewPayment = this.folioData?.payment_type?.code === '001' && this.folioData.id === -1;\n    return (\n      <ir-drawer\n        placement=\"start\"\n        style={{\n          '--ir-drawer-width': '40rem',\n          '--ir-drawer-background-color': 'var(--wa-color-surface-default)',\n          '--ir-drawer-padding-left': 'var(--spacing)',\n          '--ir-drawer-padding-right': 'var(--spacing)',\n          '--ir-drawer-padding-top': 'var(--spacing)',\n          '--ir-drawer-padding-bottom': 'var(--spacing)',\n        }}\n        label={this.payment?.id !== -1 ? 'Edit Folio Entry' : 'New Folio Entry'}\n        open={this.isOpen}\n        onDrawerHide={event => {\n          event.stopImmediatePropagation();\n          event.stopPropagation();\n          this.closeFolio();\n        }}\n      >\n        {this.isOpen && (\n          <ir-payment-folio-form\n            formId={this._id}\n            onLoadingChanged={e => (this.isLoading = e.detail)}\n            onCloseModal={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              this.closeFolio();\n            }}\n            paymentEntries={this.paymentEntries}\n            bookingNumber={this.bookingNumber}\n            payment={this.payment}\n            mode={this.mode}\n          ></ir-payment-folio-form>\n        )}\n        <div slot=\"footer\" class=\"w-100 d-flex align-items-center\" style={{ gap: 'var(--wa-space-xs)' }}>\n          <ir-custom-button class=\"flex-fill\" size=\"medium\" data-drawer=\"close\" appearance=\"filled\" variant=\"neutral\" onClickHandler={() => this.closeFolio()}>\n            Cancel\n          </ir-custom-button>\n          <ir-custom-button\n            form={this._id}\n            loading={this.isLoading === 'save'}\n            class=\"flex-fill\"\n            size=\"medium\"\n            type=\"submit\"\n            value=\"save\"\n            // appearance={isNewPayment ? 'outlined' : 'accent'}\n            appearance={'accent'}\n            variant=\"brand\"\n          >\n            Save\n          </ir-custom-button>\n          {/* {isNewPayment && ( \n          <ir-custom-button\n            value=\"saveAndPrint\"\n            type=\"submit\"\n            form={this._id}\n            // onClickHandler={() => this.savePayment(true)}\n            loading={this.isLoading === 'save-print'}\n            class=\"flex-fill\"\n            size=\"medium\"\n            appearance=\"accent\"\n            variant=\"brand\"\n          >\n            Save & Print\n          </ir-custom-button>\n           )} */}\n        </div>\n      </ir-drawer>\n    );\n  }\n}\n"]}