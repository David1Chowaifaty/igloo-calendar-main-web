{"version":3,"file":"ir-booking-details.js","sourceRoot":"","sources":["../../../src/components/ir-booking-details/ir-booking-details.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Listen, h, Prop, Watch, State, Event, EventEmitter, Element, Fragment } from '@stencil/core';\nimport { Booking, ExtraService, Guest, IPmsLog, Room, SharedPerson } from '@/models/booking.dto';\nimport axios from 'axios';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { IglBookPropertyPayloadAddRoom, TIglBookPropertyPayload } from '@/models/igl-book-property';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport { ICountry, IEntries } from '@/models/IBooking';\nimport { IPaymentAction, PaymentService } from '@/services/payment.service';\nimport Token from '@/models/Token';\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent, PaymentEntries, PrintScreenOptions } from './types';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { buildSplitIndex, SplitIndex } from '@/utils/booking';\n\n@Component({\n  tag: 'ir-booking-details',\n  styleUrls: ['ir-booking-details.css'],\n  scoped: true,\n})\nexport class IrBookingDetails {\n  @Element() element: HTMLElement;\n  // Setup Data\n  @Prop() language: string = 'en';\n  @Prop() ticket: string = '';\n  @Prop() bookingNumber: string = '';\n  @Prop() propertyid: number;\n  @Prop() is_from_front_desk = false;\n  @Prop() p: string;\n  // Booleans Conditions\n  @Prop() hasPrint: boolean = false;\n  @Prop() hasReceipt: boolean = false;\n  @Prop() hasDelete: boolean = false;\n  @Prop() hasMenu: boolean = false;\n\n  // Room Booleans\n  @Prop() hasRoomEdit: boolean = false;\n  @Prop() hasRoomDelete: boolean = false;\n  @Prop() hasRoomAdd: boolean = false;\n  @Prop() hasCheckIn: boolean = false;\n  @Prop() hasCheckOut: boolean = false;\n  @Prop() hasCloseButton = false;\n\n  @State() bookingItem: TIglBookPropertyPayload | null = null;\n  @State() statusData = [];\n\n  @State() showPaymentDetails: any;\n  @State() booking: Booking;\n  @State() countries: ICountry[];\n  @State() calendarData: any = {};\n  // Guest Data\n  @State() guestData: Guest = null;\n  // Rerender Flag\n  @State() rerenderFlag = false;\n  @State() sidebarState: BookingDetailsSidebarEvents | null = null;\n  @State() sidebarPayload: any;\n  @State() isUpdateClicked = false;\n\n  @State() pms_status: IPmsLog;\n  @State() isPMSLogLoading: boolean = false;\n  @State() paymentActions: IPaymentAction[];\n  @State() property_id: number;\n  @State() selectedService: ExtraService;\n  @State() bedPreference: IEntries[];\n  @State() roomGuest: any;\n  @State() modalState: { type: 'email' | (string & {}); message: string; loading: boolean } = null;\n  @State() departureTime: IEntries[];\n\n  @State() paymentEntries: PaymentEntries;\n  @State() splitIndex: SplitIndex;\n\n  // Payment Event\n  @Event() toast: EventEmitter<IToast>;\n  @Event() bookingChanged: EventEmitter<Booking>;\n  @Event() closeSidebar: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private paymentService = new PaymentService();\n  private token = new Token();\n\n  private printingBaseUrl = 'https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2';\n  // private printingBaseUrl = 'http://localhost:5863/%1/printing?id=%2';\n  private modalRef: HTMLIrDialogElement;\n  private paymentFolioRef: HTMLIrPaymentFolioElement;\n\n  componentWillLoad() {\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('openSidebar')\n  handleSideBarEvents(e: CustomEvent<OpenSidebarEvent<unknown>>) {\n    this.sidebarState = e.detail.type;\n    this.sidebarPayload = e.detail.payload;\n    if (this.sidebarState === 'payment-folio') {\n      this.paymentFolioRef.openFolio();\n    }\n  }\n\n  @Listen('clickHandler')\n  handleIconClick(e: CustomEvent) {\n    const target = e.target as HTMLIrButtonElement;\n    switch (target.id) {\n      case 'pickup':\n        this.sidebarState = 'pickup';\n        return;\n      case 'close':\n        this.closeSidebar.emit(null);\n        return;\n      case 'email':\n        this.modalState = {\n          type: 'email',\n          message: locales.entries.Lcz_EmailBookingto.replace('%1', this.booking.guest.email),\n          loading: isRequestPending('/Send_Booking_Confirmation_Email'),\n        };\n        this.modalRef.openModal();\n        return;\n      case 'print':\n        this.openPrintingScreen({ mode: 'printing' });\n        return;\n      case 'invoice':\n        // this.openPrintingScreen({ mode: 'invoice' });\n        this.sidebarState = 'invoice';\n        return;\n      case 'book-delete':\n        return;\n      case 'menu':\n        window.location.href = 'https://x.igloorooms.com/manage/acbookinglist.aspx';\n        return;\n      case 'room-add':\n        (this.bookingItem as IglBookPropertyPayloadAddRoom) = {\n          ID: '',\n          NAME: this.booking.guest.last_name,\n          EMAIL: this.booking.guest.email,\n          PHONE: this.booking.guest.mobile,\n          REFERENCE_TYPE: '',\n          FROM_DATE: this.booking.from_date,\n          ARRIVAL: this.booking.arrival,\n          TO_DATE: this.booking.to_date,\n          TITLE: `${locales.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,\n          defaultDateRange: {\n            fromDate: new Date(this.booking.from_date),\n            fromDateStr: '',\n            toDate: new Date(this.booking.to_date),\n            toDateStr: '',\n            dateDifference: 0,\n            message: '',\n          },\n          event_type: 'ADD_ROOM',\n          booking: this.booking,\n          BOOKING_NUMBER: this.booking.booking_nbr,\n          ADD_ROOM_TO_BOOKING: this.booking.booking_nbr,\n          GUEST: this.booking.guest,\n          message: this.booking.remark,\n          SOURCE: this.booking.source,\n          ROOMS: this.booking.rooms,\n        };\n        return;\n      case 'extra_service_btn':\n        this.sidebarState = 'extra_service';\n        return;\n      case 'add-payment':\n        return;\n    }\n  }\n\n  @Listen('resetExposedCancellationDueAmount')\n  async handleResetExposedCancellationDueAmount(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    //TODO: Payment action\n    const paymentActions = await this.paymentService.GetExposedCancellationDueAmount({ booking_nbr: this.booking.booking_nbr, currency_id: this.booking.currency.id });\n    this.paymentActions = [...paymentActions];\n  }\n  @Listen('editInitiated')\n  handleEditInitiated(e: CustomEvent<TIglBookPropertyPayload>) {\n    this.bookingItem = e.detail;\n  }\n  @Listen('updateRoomGuests')\n  handleRoomGuestsUpdate(e: CustomEvent<{ identifier: string; guests: SharedPerson[] }>) {\n    const { identifier, guests } = e.detail;\n    const rooms = [...this.booking.rooms];\n    let currentRoomIndex = rooms.findIndex(r => r.identifier === identifier);\n    if (currentRoomIndex === -1) {\n      return;\n    }\n    const currentRoom = rooms[currentRoomIndex];\n    const updatedRoom = { ...currentRoom, sharing_persons: guests };\n    rooms[currentRoomIndex] = updatedRoom;\n    this.booking = { ...this.booking, rooms: [...rooms] };\n    this.splitIndex = buildSplitIndex(this.booking.rooms);\n  }\n\n  @Listen('resetBookingEvt')\n  async handleResetBooking(e: CustomEvent<Booking | null>) {\n    // e.stopPropagation();\n    // e.stopImmediatePropagation();\n    if (e.detail) {\n      this.booking = e.detail;\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n      return;\n    }\n    await this.resetBooking();\n  }\n  @Listen('editExtraService')\n  handleEditExtraService(e: CustomEvent) {\n    this.selectedService = e.detail;\n    console.log(this.selectedService);\n    this.sidebarState = 'extra_service';\n  }\n  @Listen('openPrintScreen')\n  handleOpenPrintScreen(e: CustomEvent<PrintScreenOptions>) {\n    this.openPrintingScreen(e.detail);\n  }\n\n  private setRoomsData(roomServiceResp) {\n    let roomsData: { [key: string]: any }[] = new Array();\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\n      roomsData = roomServiceResp.My_Result.roomtypes;\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\n        roomCategory.expanded = true;\n      });\n    }\n    this.calendarData.roomsInfo = roomsData;\n  }\n  // private shouldFetchCancellationPenalty(): boolean {\n  //   return this.booking.is_requested_to_cancel || this.booking.status.code === '003';\n  // }\n  private async initializeApp() {\n    try {\n      const [roomResponse, languageTexts, countriesList, bookingDetails, setupEntries] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getCountries(this.language),\n        this.bookingService.getExposedBooking(this.bookingNumber, this.language),\n        this.bookingService.getSetupEntriesByTableNameMulti(['_BED_PREFERENCE_TYPE', '_DEPARTURE_TIME', '_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n      ]);\n      this.property_id = roomResponse?.My_Result?.id;\n      const { bed_preference_type, departure_time, pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n      this.bedPreference = bed_preference_type;\n      this.departureTime = departure_time;\n      this.paymentEntries = { types: pay_type, groups: pay_type_group, methods: pay_method };\n      // if (bookingDetails?.booking_nbr && bookingDetails?.currency?.id && bookingDetails.is_direct) {\n      //   this.paymentService\n      //     .GetExposedCancellationDueAmount({\n      //       booking_nbr: bookingDetails.booking_nbr,\n      //       currency_id: bookingDetails.currency.id,\n      //     })\n      //     .then(res => {\n      //       this.paymentActions = res;\n      //     });\n      // }\n      if (!locales?.entries) {\n        locales.entries = languageTexts.entries;\n        locales.direction = languageTexts.direction;\n      }\n      this.countries = countriesList;\n      const myResult = roomResponse?.My_Result;\n      if (myResult) {\n        const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends, aname } = myResult;\n        this.printingBaseUrl = this.printingBaseUrl.replace('%1', aname).replace('%2', this.bookingNumber);\n        this.calendarData = {\n          currency,\n          allowed_booking_sources,\n          adult_child_constraints,\n          legendData: calendar_legends,\n        };\n        this.setRoomsData(roomResponse);\n        const paymentCodesToShow = ['001', '004'];\n        this.showPaymentDetails = paymentMethods?.some(method => paymentCodesToShow.includes(method.code));\n      } else {\n        console.warn(\"Room response is missing 'My_Result'.\");\n      }\n\n      // Set guest and booking data\n      this.guestData = bookingDetails.guest;\n      this.booking = bookingDetails;\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n    } catch (error) {\n      console.error('Error initializing app:', error);\n    }\n  }\n\n  private async openPrintingScreen(options: PrintScreenOptions, version: 'old' | 'new' = 'new') {\n    const { mode } = options;\n\n    if (version === 'old') {\n      if (mode === 'invoice') {\n        return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${encodeURIComponent(this.booking.system_id)}&&PM=I&TK=${encodeURIComponent(this.ticket)}`);\n      }\n      return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${encodeURIComponent(this.booking.system_id)}&&PM=B&TK=${encodeURIComponent(this.ticket)}`);\n    }\n\n    // Start with base URL\n    let url = this.printingBaseUrl;\n\n    // Add mode safely\n    url += `&mode=${encodeURIComponent(mode)}`;\n\n    // Add ANY payload safely\n    if ('payload' in options && options.payload) {\n      const payload = options.payload;\n\n      const safeParams = Object.entries(payload)\n        .map(([key, value]) => {\n          const safeKey = encodeURIComponent(key);\n          const safeValue = encodeURIComponent(String(value));\n          return `${safeKey}=${safeValue}`;\n        })\n        .join('&');\n\n      url += `&${safeParams}`;\n    }\n\n    // Add token safely\n    const { data } = await axios.post(`Get_ShortLiving_Token`);\n    if (!data.ExceptionMsg) {\n      url += `&token=${encodeURIComponent(data.My_Result)}`;\n    }\n\n    // Final: fully safe URL\n    window.open(url);\n  }\n\n  private handleCloseBookingWindow() {\n    this.bookingItem = null;\n  }\n\n  private handleDeleteFinish = (e: CustomEvent) => {\n    this.booking = { ...this.booking, rooms: this.booking.rooms.filter(room => room.identifier !== e.detail) };\n    this.splitIndex = buildSplitIndex(this.booking.rooms);\n  };\n\n  private async resetBooking() {\n    try {\n      const booking = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\n      this.booking = { ...booking };\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n      this.bookingChanged.emit(this.booking);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async handleModalConfirm() {\n    switch (this.modalState.type) {\n      case 'email':\n        await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr, this.language);\n        break;\n    }\n    this.modalState = null;\n    this.modalRef.closeModal();\n  }\n\n  private computeRoomGroups(rooms: Room[]) {\n    const indexById = new Map<string, number>();\n    rooms.forEach((room, idx) => indexById.set(room.identifier, idx));\n\n    if (!rooms.length) {\n      return { groups: [], indexById, hasSplitGroups: false };\n    }\n\n    const groupSortKey = (groupRooms: Room[]) => {\n      let min = Number.MAX_SAFE_INTEGER;\n      for (const r of groupRooms) {\n        const ts = Date.parse(r?.from_date ?? '');\n        if (!Number.isNaN(ts)) {\n          min = Math.min(min, ts);\n        }\n      }\n      return min;\n    };\n\n    const splitIndex = this.splitIndex ?? buildSplitIndex(rooms);\n    if (!splitIndex) {\n      const sortedRooms = [...rooms].sort((a, b) => {\n        const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n        if (!Number.isNaN(diff) && diff !== 0) {\n          return diff;\n        }\n        return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n      });\n      return { groups: [{ rooms: sortedRooms, order: 0, isSplit: false, sortKey: groupSortKey(sortedRooms) }], indexById, hasSplitGroups: false };\n    }\n\n    const roomsById = new Map<string, Room>(rooms.map(room => [room.identifier, room]));\n    const grouped: { rooms: Room[]; order: number; sortKey: number; isSplit: boolean }[] = [];\n    const visited = new Set<string>();\n\n    for (const head of splitIndex.heads) {\n      const chain = splitIndex.chainOf.get(head) ?? [head];\n      const chainRooms = chain.map(id => roomsById.get(id)).filter((room): room is Room => Boolean(room));\n      if (!chainRooms.length) continue;\n\n      const chainHasSplitLink =\n        chain.some(id => {\n          const parent = splitIndex.parentOf.get(id);\n          const children = splitIndex.childrenOf.get(id) ?? [];\n          return Boolean(parent) || children.length > 0;\n        }) || chainRooms.some(room => Boolean(room?.is_split));\n\n      if (chainHasSplitLink) {\n        chainRooms.forEach(room => visited.add(room.identifier));\n        const order = Math.min(...chainRooms.map(room => indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER));\n        grouped.push({ rooms: chainRooms, order, sortKey: groupSortKey(chainRooms), isSplit: true });\n      }\n    }\n\n    for (const room of rooms) {\n      if (!visited.has(room.identifier)) {\n        const order = indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER;\n        const singleGroup = [room];\n        grouped.push({ rooms: singleGroup, order, sortKey: groupSortKey(singleGroup), isSplit: false });\n      }\n    }\n\n    grouped.sort((a, b) => {\n      if (a.sortKey !== b.sortKey) {\n        return a.sortKey - b.sortKey;\n      }\n      return a.order - b.order;\n    });\n    const hasSplitGroups = grouped.some(group => group.isSplit);\n\n    if (!hasSplitGroups) {\n      const merged = grouped\n        .map(group => group.rooms)\n        .reduce<Room[]>((acc, curr) => acc.concat(curr), [])\n        .sort((a, b) => {\n          const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n          if (!Number.isNaN(diff) && diff !== 0) {\n            return diff;\n          }\n          return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n        });\n      return { groups: [{ rooms: merged, order: 0, sortKey: groupSortKey(merged), isSplit: false }], indexById, hasSplitGroups: false };\n    }\n\n    return { groups: grouped, indexById, hasSplitGroups: true };\n  }\n\n  private renderRoomItem(room: Room, bookingIndex: number, includeDepartureTime: boolean = true) {\n    const showCheckin = this.handleRoomCheckin(room);\n    const showCheckout = this.handleRoomCheckout(room);\n\n    return (\n      <ir-room\n        key={room.identifier}\n        room={room}\n        property_id={this.property_id}\n        language={this.language}\n        departureTime={this.departureTime}\n        bedPreferences={this.bedPreference}\n        isEditable={this.booking.is_editable}\n        legendData={this.calendarData.legendData}\n        roomsInfo={this.calendarData.roomsInfo}\n        myRoomTypeFoodCat={room.roomtype.name}\n        mealCodeName={room.rateplan.short_name}\n        includeDepartureTime={includeDepartureTime}\n        currency={this.booking.currency.symbol}\n        hasRoomEdit={this.hasRoomEdit && this.booking.status.code !== '003' && this.booking.is_direct}\n        hasRoomDelete={this.hasRoomDelete && this.booking.status.code !== '003' && this.booking.is_direct}\n        hasCheckIn={showCheckin}\n        hasCheckOut={showCheckout}\n        booking={this.booking}\n        bookingIndex={bookingIndex}\n        onDeleteFinished={this.handleDeleteFinish}\n      />\n    );\n  }\n\n  private renderRooms() {\n    const rooms = this.booking?.rooms ?? [];\n    if (!rooms.length) {\n      return null;\n    }\n\n    const { groups, indexById, hasSplitGroups } = this.computeRoomGroups(rooms);\n\n    if (!hasSplitGroups) {\n      const groupRooms = groups[0].rooms;\n      return groupRooms.map((room, idx) => (\n        <Fragment>\n          {this.renderRoomItem(room, indexById.get(room.identifier) ?? idx)}\n          {idx < groupRooms.length - 1 ? <wa-divider></wa-divider> : null}\n        </Fragment>\n      ));\n    }\n\n    return (\n      <Fragment>\n        <div class=\"d-flex flex-column\" style={{ gap: '1rem' }}>\n          {groups.map((group, groupIdx) => {\n            const isLastGroup = groupIdx === groups.length - 1;\n            return (\n              <div class={`${isLastGroup ? '' : 'room-group'}`} key={`room-group-${group.order}-${groupIdx}`}>\n                {group.rooms.map((room, roomIdx) => (\n                  <Fragment>\n                    {this.renderRoomItem(room, indexById.get(room.identifier) ?? roomIdx, roomIdx === group.rooms.length - 1)}\n                    {roomIdx < group.rooms.length - 1 ? <wa-divider></wa-divider> : null}\n                  </Fragment>\n                ))}\n                {!isLastGroup && <wa-divider style={{ '--width': '3px' }}></wa-divider>}\n              </div>\n            );\n          })}\n        </div>\n      </Fragment>\n    );\n  }\n  render() {\n    if (!this.booking) {\n      return (\n        <div class={'loading-container'}>\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    const roomsSection = this.renderRooms();\n    return [\n      <Fragment>\n        {!this.is_from_front_desk && (\n          <Fragment>\n            <ir-toast style={{ height: '0' }}></ir-toast>\n            <ir-interceptor style={{ height: '0' }}></ir-interceptor>\n          </Fragment>\n        )}\n      </Fragment>,\n      <ir-booking-header\n        booking={this.booking}\n        hasCloseButton={this.hasCloseButton}\n        hasDelete={this.hasDelete}\n        hasMenu={this.hasMenu}\n        hasPrint={this.hasPrint}\n        hasReceipt={calendar_data.property.is_frontdesk_enabled}\n        hasEmail={['001', '002'].includes(this.booking?.status?.code)}\n      ></ir-booking-header>,\n      <div class=\"booking-details__booking-info\">\n        <div class=\"booking-details__info-column\">\n          <ir-reservation-information countries={this.countries} booking={this.booking}></ir-reservation-information>\n          <wa-card>\n            <ir-date-view class=\"booking-details__date-view-header\" slot=\"header\" from_date={this.booking.from_date} to_date={this.booking.to_date}></ir-date-view>\n            {this.hasRoomAdd && this.booking.is_editable && (\n              <Fragment>\n                <wa-tooltip for=\"room-add\">Add unit</wa-tooltip>\n                <ir-custom-button slot=\"header-actions\" id=\"room-add\" appearance={'plain'} size={'small'} variant={'neutral'}>\n                  <wa-icon name=\"plus\" style={{ fontSize: '1rem' }} label=\"Add unit\"></wa-icon>\n                </ir-custom-button>\n              </Fragment>\n            )}\n\n            {roomsSection}\n          </wa-card>\n          {/* <ir-ota-services services={this.booking.ota_services}></ir-ota-services> */}\n          <ir-pickup-view booking={this.booking}></ir-pickup-view>\n          <section>\n            <ir-extra-services\n              booking={{ booking_nbr: this.booking.booking_nbr, currency: this.booking.currency, extra_services: this.booking.extra_services }}\n            ></ir-extra-services>\n          </section>\n        </div>\n\n        <ir-payment-details\n          class=\"booking-details__info-column\"\n          propertyId={this.property_id}\n          paymentEntries={this.paymentEntries}\n          paymentActions={this.paymentActions}\n          booking={this.booking}\n        ></ir-payment-details>\n      </div>,\n      <ir-dialog\n        label=\"Send Email\"\n        onIrDialogHide={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.modalRef.closeModal();\n          this.modalState = null;\n        }}\n        ref={el => (this.modalRef = el)}\n      >\n        <p>{this.modalState?.message}</p>\n        <div slot=\"footer\" class=\"ir-dialog__footer\">\n          <ir-custom-button data-dialog=\"close\" size=\"medium\" appearance=\"filled\" variant=\"neutral\">\n            {locales.entries.Lcz_Cancel}\n          </ir-custom-button>\n          <ir-custom-button\n            loading={isRequestPending('/Send_Booking_Confirmation_Email')}\n            onClickHandler={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              this.handleModalConfirm();\n            }}\n            size=\"medium\"\n            variant=\"brand\"\n          >\n            {locales.entries.Lcz_Confirm}\n          </ir-custom-button>\n        </div>\n      </ir-dialog>,\n      // <ir-sidebar\n      //   open={this.sidebarState === 'room-guest'}\n      //   side={'right'}\n      //   id=\"editGuestInfo\"\n      //   style={{ '--sidebar-width': this.sidebarState === 'room-guest' ? '60rem' : undefined }}\n      //   onIrSidebarToggle={e => {\n      //     e.stopImmediatePropagation();\n      //     e.stopPropagation();\n      //     this.sidebarState = null;\n      //   }}\n      //   showCloseButton={false}\n      // >\n      //   {this.renderSidebarContent()}\n      // </ir-sidebar>,\n      <ir-room-guests\n        open={this.sidebarState === 'room-guest'}\n        countries={this.countries}\n        language={this.language}\n        identifier={this.sidebarPayload?.identifier}\n        bookingNumber={this.booking.booking_nbr}\n        roomName={this.sidebarPayload?.roomName}\n        totalGuests={this.sidebarPayload?.totalGuests}\n        sharedPersons={this.sidebarPayload?.sharing_persons}\n        slot=\"sidebar-body\"\n        checkIn={this.sidebarPayload?.checkin}\n        onCloseModal={() => (this.sidebarState = null)}\n      ></ir-room-guests>,\n      <ir-extra-service-config\n        open={this.sidebarState === 'extra_service'}\n        service={this.selectedService}\n        booking={{ from_date: this.booking.from_date, to_date: this.booking.to_date, booking_nbr: this.booking.booking_nbr, currency: this.booking.currency }}\n        slot=\"sidebar-body\"\n        onCloseModal={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.sidebarState = null;\n          if (this.selectedService) {\n            this.selectedService = null;\n          }\n        }}\n      ></ir-extra-service-config>,\n      <ir-pickup\n        open={this.sidebarState === 'pickup'}\n        bookingDates={{ from: this.booking.from_date, to: this.booking.to_date }}\n        defaultPickupData={this.booking.pickup_info}\n        bookingNumber={this.booking.booking_nbr}\n        numberOfPersons={this.booking.occupancy.adult_nbr + this.booking.occupancy.children_nbr}\n        onCloseModal={() => {\n          this.sidebarState = null;\n        }}\n      ></ir-pickup>,\n      <ir-billing-drawer\n        open={this.sidebarState === 'invoice'}\n        onBillingClose={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.sidebarState = null;\n        }}\n        booking={this.booking}\n      ></ir-billing-drawer>,\n      <ir-guest-info-drawer\n        onGuestInfoDrawerClosed={() => {\n          this.sidebarState = null;\n        }}\n        booking_nbr={this.bookingNumber}\n        email={this.booking?.guest.email}\n        language={this.language}\n        open={this.sidebarState === 'guest'}\n      ></ir-guest-info-drawer>,\n      <ir-payment-folio\n        style={{ height: 'auto' }}\n        bookingNumber={this.booking.booking_nbr}\n        paymentEntries={this.paymentEntries}\n        payment={this.sidebarPayload?.payment}\n        mode={this.sidebarPayload?.mode}\n        ref={el => (this.paymentFolioRef = el)}\n        onCloseModal={() => (this.sidebarState = null)}\n      ></ir-payment-folio>,\n      <Fragment>\n        {/* {this.bookingItem && (\n          <igl-book-property\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\n            adultChildConstraints={this.calendarData.adult_child_constraints}\n            showPaymentDetails={this.showPaymentDetails}\n            countries={this.countries}\n            currency={this.calendarData.currency}\n            language={this.language}\n            propertyid={this.property_id}\n            bookingData={this.bookingItem}\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\n          ></igl-book-property>\n        )} */}\n        <ir-booking-editor-drawer\n          roomTypeIds={(this.bookingItem as any)?.roomsInfo?.map(r => r.id)}\n          onBookingEditorClosed={this.handleCloseBookingWindow.bind(this)}\n          unitId={(this.bookingItem as any)?.PR_ID}\n          mode={this.bookingItem?.event_type as any}\n          label={this.bookingItem?.TITLE}\n          booking={this.booking}\n          ticket={this.ticket}\n          open={this.bookingItem !== null}\n          roomIdentifier={(this.bookingItem as any)?.IDENTIFIER}\n          language={this.language}\n          propertyid={this.propertyid as any}\n          checkIn={this.bookingItem?.FROM_DATE}\n          checkOut={this.bookingItem?.TO_DATE}\n        ></ir-booking-editor-drawer>\n      </Fragment>,\n    ];\n  }\n  private handleRoomCheckout(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    return room.in_out.code === '001';\n  }\n  private handleRoomCheckin(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    if (!room.unit) {\n      return false;\n    }\n    if (room.in_out && room.in_out.code !== '000') {\n      return false;\n    }\n    if (moment().isSameOrAfter(moment(room.from_date, 'YYYY-MM-DD'), 'days') && moment().isBefore(moment(room.to_date, 'YYYY-MM-DD'), 'days')) {\n      return true;\n    }\n    return false;\n  }\n}\n"]}