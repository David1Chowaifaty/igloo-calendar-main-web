{"version":3,"file":"ir-booking-company-form.js","sourceRoot":"","sources":["../../../../src/components/ir-booking-details/ir-booking-company-form/ir-booking-company-form.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, h, Method, Prop, State } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\n@Component({\n  tag: 'ir-booking-company-form',\n  styleUrl: 'ir-booking-company-form.css',\n  scoped: true,\n})\nexport class IrBookingCompanyForm {\n  @Prop() booking: Booking;\n\n  @State() open: boolean;\n  @State() isLoading: boolean;\n  @State() formData: Pick<Booking, 'company_name' | 'company_tax_nbr'>;\n\n  @Event() resetBookingEvt: EventEmitter<Booking>;\n  @Event() companyFormClosed: EventEmitter<void>;\n\n  private bookingService = new BookingService();\n  componentWillLoad() {\n    this.formData = { company_name: this.booking.company_name, company_tax_nbr: this.booking.company_tax_nbr };\n  }\n\n  @Method()\n  async openCompanyForm() {\n    this.open = true;\n  }\n  private updateGuest(params: Partial<Booking['guest']>) {\n    this.formData = { ...this.formData, ...params };\n  }\n  private async saveCompany() {\n    try {\n      this.isLoading = true;\n      const booking = {\n        assign_units: true,\n        is_pms: true,\n        is_direct: this.booking.is_direct,\n        is_backend: true,\n        is_in_loyalty_mode: this.booking.is_in_loyalty_mode,\n        promo_key: this.booking.promo_key,\n        extras: this.booking.extras,\n        agent: this.booking.agent,\n        booking: {\n          ...this.formData,\n          from_date: this.booking.from_date,\n          to_date: this.booking.to_date,\n          remark: this.booking.remark,\n          booking_nbr: this.booking.booking_nbr,\n          property: this.booking.property,\n          booked_on: this.booking.booked_on,\n          source: this.booking.source,\n          rooms: this.booking.rooms,\n          currency: this.booking.currency,\n          arrival: this.booking.arrival,\n          guest: this.booking.guest,\n        },\n        pickup_info: this.booking.pickup_info,\n      };\n      await this.bookingService.doReservation(booking);\n      this.resetBookingEvt.emit({ ...this.booking, ...this.formData });\n      this.open = false;\n    } catch (error) {\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  render() {\n    return (\n      <ir-dialog\n        open={this.open}\n        onIrDialogHide={e => {\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n          this.open = false;\n          this.companyFormClosed.emit();\n        }}\n        label=\"Company\"\n        id=\"dialog-overview\"\n      >\n        <div class=\"d-flex  flex-column\" style={{ gap: '1rem' }}>\n          <ir-custom-input onText-change={e => this.updateGuest({ company_name: e.detail })} label=\"Name\" autofocus placeholder=\"XYZ LTD\"></ir-custom-input>\n          <ir-custom-input onText-change={e => this.updateGuest({ company_tax_nbr: e.detail })} label=\"Tax ID\" placeholder=\"VAT 123456\"></ir-custom-input>\n        </div>\n        <div slot=\"footer\" class=\"ir-dialog__footer\">\n          <ir-custom-button size=\"medium\" appearance=\"filled\" variant=\"neutral\" data-dialog=\"close\">\n            Cancel\n          </ir-custom-button>\n          <ir-custom-button loading={this.isLoading} size=\"medium\" variant=\"brand\" onClickHandler={() => this.saveCompany()}>\n            Save\n          </ir-custom-button>\n        </div>\n      </ir-dialog>\n    );\n  }\n}\n"]}