{"version":3,"file":"ir-unbookable-rooms-filters.js","sourceRoot":"","sources":["../../../../src/components/ir-unbookable-rooms/ir-unbookable-rooms-filters/ir-unbookable-rooms-filters.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\nimport { FetchUnBookableRoomsResult } from '@/services/property.service';\n\ntype UnbookableRoomsMode = 'default' | 'mpo';\ntype UnbookableRoomsFilters = { period_to_check: number; consecutive_period: number; country: string };\n\n@Component({\n  tag: 'ir-unbookable-rooms-filters',\n  styleUrl: 'ir-unbookable-rooms-filters.css',\n  scoped: true,\n})\nexport class IrUnbookableRoomsFilters {\n  @Prop() mode: UnbookableRoomsMode = 'default';\n  @Prop() filters: UnbookableRoomsFilters = { period_to_check: 2, consecutive_period: 14, country: 'all' };\n  @Prop() unbookableRooms: FetchUnBookableRoomsResult = [];\n  @Prop() isLoading = false;\n\n  @Event() filtersChange: EventEmitter<Partial<UnbookableRoomsFilters>>;\n  @Event() filtersReset: EventEmitter<void>;\n  @Event() filtersSave: EventEmitter<void>;\n\n  private normalizePositiveNumber(value: number, fallback: number) {\n    const parsed = Number(value);\n    if (Number.isFinite(parsed) && parsed > 0) {\n      return Math.floor(parsed);\n    }\n    return fallback;\n  }\n\n  private handlePeriodChange = (value: string) => {\n    this.filtersChange.emit({\n      period_to_check: this.normalizePositiveNumber(Number(value), this.filters.period_to_check),\n    });\n  };\n\n  private handleConsecutiveChange = (value: string) => {\n    this.filtersChange.emit({\n      consecutive_period: this.normalizePositiveNumber(Number(value), this.filters.consecutive_period),\n    });\n  };\n\n  private handleCountryChange = (value: string) => {\n    this.filtersChange.emit({ country: value });\n  };\n\n  render() {\n    const countries = new Map<number, string>();\n    this.unbookableRooms.forEach(entry => {\n      if (entry.country?.id != null) {\n        countries.set(entry.country.id, entry.country.name);\n      }\n    });\n    const sortedCountries = [...countries.entries()].sort(\n      (a, b) => a[1].localeCompare(b[1], undefined, { sensitivity: 'base' }) || a[0] - b[0],\n    );\n    return (\n      <Host>\n        <wa-card class=\"unbookable-rooms__filters-card\" appearance=\"outlined\">\n          <div slot=\"header\" class=\"filters-card__header\">\n            <wa-icon name=\"filter\"></wa-icon>\n            <h4 class=\"filters-card__title m-0\">Filters</h4>\n          </div>\n          <wa-select\n            label=\"Look ahead\"\n            size=\"small\"\n            value={this.filters.period_to_check?.toString()}\n            defaultValue={this.filters.period_to_check?.toString()}\n            onchange={e => {\n              this.handlePeriodChange((e.target as HTMLSelectElement).value);\n            }}\n          >\n            {Array.from({ length: 5 }, (_, i) => i + 2).map(value => (\n              <wa-option value={value.toString()}>\n                {value} month{value > 1 ? 's' : ''}\n              </wa-option>\n            ))}\n          </wa-select>\n          <ir-input\n            type=\"number\"\n            label=\"Minimum consecutive nights\"\n            min=\"7\"\n            hint=\"Period where room types are closed for booking.\"\n            max=\"60\"\n            value={this.filters.consecutive_period?.toString()}\n            onText-change={e => {\n              this.handleConsecutiveChange(e.detail);\n            }}\n          ></ir-input>\n          {this.mode === 'mpo' && sortedCountries.length > 1 && (\n            <wa-select\n              label=\"Country\"\n              size=\"small\"\n              value={this.filters.country?.toString()}\n              defaultValue=\"all\"\n              onchange={e => {\n                this.handleCountryChange((e.target as HTMLSelectElement).value);\n              }}\n            >\n              <wa-option value=\"all\">Show all</wa-option>\n              {sortedCountries.map(([id, name]) => (\n                <wa-option value={id.toString()}>{name}</wa-option>\n              ))}\n            </wa-select>\n          )}\n          <div class=\"filter__actions\">\n            <ir-custom-button onClickHandler={() => this.filtersReset.emit()} variant=\"neutral\" appearance=\"filled\">\n              Reset\n            </ir-custom-button>\n            <ir-custom-button loading={this.isLoading} onClickHandler={() => this.filtersSave.emit()} variant=\"brand\">\n              Save\n            </ir-custom-button>\n          </div>\n        </wa-card>\n      </Host>\n    );\n  }\n}\n"]}