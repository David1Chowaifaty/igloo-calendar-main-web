{"version":3,"file":"ir-invoice-form.js","sourceRoot":"","sources":["../../../../src/components/ir-invoice/ir-invoice-form/ir-invoice-form.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { buildSplitIndex } from '@/utils/booking';\nimport { formatAmount } from '@/utils/utils';\nimport { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport moment, { Moment } from 'moment';\nimport { BookingInvoiceInfo, InvoiceableItem, ViewMode } from '../types';\nimport { IEntries } from '@/models/IBooking';\n@Component({\n  tag: 'ir-invoice-form',\n  styleUrl: 'ir-invoice-form.css',\n  scoped: true,\n})\nexport class IrInvoiceForm {\n  /**\n   * Controls how the invoice form behaves (e.g., \"invoice\", \"proforma\", \"preview\").\n   */\n  @Prop() viewMode: ViewMode = 'invoice';\n\n  /**\n   * Unique ID applied to the underlying <form> element.\n   */\n  @Prop() formId: string;\n  /**\n   * Whether the invoice drawer is open.\n   *\n   * This prop is mutable and reflected to the host element,\n   * allowing parent components to control visibility via markup\n   * or via the public `openDrawer()` / `closeDrawer()` methods.\n   */\n  @Prop({ mutable: true, reflect: true }) open: boolean;\n\n  /**\n   * The booking object for which the invoice is being generated.\n   * Should contain room, guest, and pricing information.\n   */\n  @Prop() booking: Booking;\n\n  /**\n   * Specifies what the invoice is for.\n   * - `\"room\"`: invoice for a specific room\n   * - `\"booking\"`: invoice for the entire booking\n   */\n  @Prop() for: 'room' | 'booking' = 'booking';\n\n  /**\n   * The identifier of the room for which the invoice is being generated.\n   * Used when invoicing at room level instead of booking level.\n   */\n  @Prop() roomIdentifier: string;\n\n  /**\n   * When `true`, automatically triggers `window.print()` after an invoice is created.\n   * Useful for setups where the invoice should immediately be sent to a printer.\n   */\n  @Prop() autoPrint: boolean = false;\n\n  @Prop() invoiceInfo: BookingInvoiceInfo;\n\n  @State() selectedRecipient: string;\n  @State() isLoading: boolean;\n  @State() selectedItemKeys: Set<number> = new Set();\n  @State() invoicableKey: Map<InvoiceableItem['key'], InvoiceableItem>;\n  @State() toBeInvoicedItems: InvoiceableItem[];\n  @State() invoiceDate: Moment = moment();\n  @State() notInvoiceableItemKeys: Set<number> = new Set();\n  private splitDisabledKeys: Set<number> = new Set();\n\n  /**\n   * Emitted when the invoice drawer is opened.\n   *\n   * Fired when `openDrawer()` is called and the component\n   * transitions into the open state.\n   */\n  @Event() invoiceOpen: EventEmitter<void>;\n\n  /**\n   * Emitted when the invoice drawer is closed.\n   *\n   * Fired when `closeDrawer()` is called, including when the\n   * underlying drawer emits `onDrawerHide`.\n   */\n  @Event() invoiceClose: EventEmitter<void>;\n\n  /**\n   * Emitted when an invoice is created/confirmed.\n   *\n   * The event `detail` contains:\n   * - `booking`: the booking associated with the invoice\n   * - `recipientId`: the selected billing recipient\n   * - `for`: whether the invoice is for `\"room\"` or `\"booking\"`\n   * - `roomIdentifier`: the room identifier when invoicing a specific room\n   * - `mode`: the current invoice mode\n   */\n  @Event({ cancelable: true, composed: true, bubbles: true }) invoiceCreated: EventEmitter<{\n    booking: Booking;\n    recipientId: string;\n    for: 'room' | 'booking';\n    roomIdentifier?: string;\n    mode: 'create' | 'check_out-create';\n  }>;\n\n  @Event() loadingChange: EventEmitter<boolean>;\n\n  private room: Booking['rooms'][0];\n\n  private bookingService = new BookingService();\n  private invoiceTarget: IEntries[];\n\n  componentWillLoad() {\n    this.init();\n  }\n\n  @Watch('viewMode')\n  handleViewModeChange() {\n    this.enforceNonInvoiceableSelections();\n  }\n  @Watch('booking')\n  handleBookingChange() {\n    if (this.booking) {\n      this.selectedRecipient = this.booking.guest.id.toString();\n      if (this.for === 'room' && this.roomIdentifier) {\n        this.room = this.booking.rooms.find(r => r.identifier === this.roomIdentifier);\n      }\n    }\n    this.setUpDisabledItems();\n  }\n  @Watch('invoiceInfo')\n  handleInvoiceInfoChange() {\n    this.setupInvoicables(this.invoiceInfo);\n  }\n\n  private setUpDisabledItems() {\n    if (!this.booking || !this.invoicableKey?.size) {\n      this.notInvoiceableItemKeys = new Set();\n      this.splitDisabledKeys = new Set();\n      return;\n    }\n\n    const invoiceDate = (this.invoiceDate ?? moment()).clone().startOf('day');\n    const disabledKeys = new Set<number>();\n    this.splitDisabledKeys = new Set();\n    const markIfBefore = (key: number | undefined, dateStr?: string | null, options?: { checkedOut?: boolean }) => {\n      if (options?.checkedOut) {\n        return;\n      }\n      if (typeof key !== 'number' || !this.invoicableKey.has(key) || !dateStr) {\n        return;\n      }\n      const parsed = moment(dateStr, 'YYYY-MM-DD', true);\n      if (parsed.isValid() && invoiceDate.isBefore(parsed.clone().startOf('day'))) {\n        disabledKeys.add(key);\n      }\n    };\n\n    const rooms = this.booking.rooms ?? [];\n    rooms.forEach(room => {\n      markIfBefore(room.system_id, room.to_date, { checkedOut: room?.in_out?.code === '002' });\n    });\n\n    const pickupInfo: any = this.booking.pickup_info;\n    if (pickupInfo) {\n      markIfBefore(pickupInfo?.system_id, pickupInfo?.from_date ?? pickupInfo?.date);\n    }\n\n    (this.booking.extra_services ?? []).forEach(extra => {\n      markIfBefore(extra.system_id, (extra as any)?.from_date ?? extra.start_date ?? extra.end_date ?? this.booking.from_date);\n    });\n\n    const splitIndex = buildSplitIndex(rooms);\n    if (splitIndex) {\n      const roomsByIdentifier = new Map(rooms.map(room => [room.identifier, room]));\n      splitIndex.heads.forEach(head => {\n        const chain = splitIndex.chainOf.get(head) ?? [];\n        if (chain.length <= 1) {\n          return;\n        }\n        const tailIdentifier = chain[chain.length - 1];\n        const tailRoom = roomsByIdentifier.get(tailIdentifier);\n        if (!tailRoom) {\n          return;\n        }\n        const tailCheckedOut = tailRoom.in_out?.code === '002';\n        chain.forEach(identifier => {\n          const room = roomsByIdentifier.get(identifier);\n          if (!room || typeof room.system_id !== 'number' || !this.invoicableKey.has(room.system_id)) {\n            return;\n          }\n          if (tailCheckedOut) {\n            disabledKeys.delete(room.system_id);\n            return;\n          }\n          disabledKeys.add(room.system_id);\n          this.splitDisabledKeys.add(room.system_id);\n        });\n      });\n    }\n\n    this.notInvoiceableItemKeys = disabledKeys;\n    this.enforceNonInvoiceableSelections(disabledKeys);\n  }\n\n  private enforceNonInvoiceableSelections(disabledKeys: Set<number> = this.notInvoiceableItemKeys ?? new Set()) {\n    if (!disabledKeys.size) {\n      return;\n    }\n    const nextKeys = new Set(this.selectedItemKeys);\n    let changed = false;\n    disabledKeys.forEach(key => {\n      const isSplitDisabled = this.splitDisabledKeys.has(key);\n      if (this.viewMode === 'proforma' && !isSplitDisabled) {\n        if (!nextKeys.has(key)) {\n          nextKeys.add(key);\n          changed = true;\n        }\n        return;\n      }\n      if (nextKeys.delete(key)) {\n        changed = true;\n      }\n    });\n\n    if (changed) {\n      this.syncSelectedItems(nextKeys);\n    }\n  }\n  private syncSelectedItems(selectedKeys: Set<number>) {\n    this.selectedItemKeys = selectedKeys;\n    const selectedItems: InvoiceableItem[] = [];\n    selectedKeys.forEach(key => {\n      const item = this.invoicableKey?.get(key);\n      if (item) {\n        selectedItems.push(item);\n      }\n    });\n    this.toBeInvoicedItems = selectedItems;\n  }\n\n  private canInvoiceRoom(room?: Room) {\n    return Boolean(room && this.invoicableKey?.has(room.system_id));\n  }\n\n  private hasInvoiceableRooms(rooms: Room[]) {\n    return rooms.some(room => this.canInvoiceRoom(room));\n  }\n\n  private getInvoiceableRoomIds(rooms: Room[]) {\n    const ids: number[] = [];\n    rooms.forEach(room => {\n      if (this.canInvoiceRoom(room)) {\n        ids.push(room.system_id);\n      }\n    });\n    return ids;\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      let invoiceInfo = this.invoiceInfo;\n      if (!this.invoiceInfo) {\n        invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n      }\n      this.setupInvoicables(invoiceInfo);\n\n      if (this.booking) {\n        this.selectedRecipient = this.booking.guest.id.toString();\n        if (this.for === 'room' && this.roomIdentifier) {\n          this.room = this.booking.rooms.find(r => r.identifier === this.roomIdentifier);\n        }\n      }\n      this.invoiceTarget = await this.bookingService.getSetupEntriesByTableName('_INVOICE_TARGET');\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private setupInvoicables(invoiceInfo: BookingInvoiceInfo) {\n    const invoiceableItems = (invoiceInfo.invoiceable_items ?? []).filter(item => item.is_invoiceable);\n    this.invoicableKey = new Map(invoiceableItems.map(item => [item.key, item]));\n    this.syncSelectedItems(new Set(invoiceableItems.map(item => item.key)));\n    this.setUpDisabledItems();\n  }\n\n  /**\n   * Handles confirming/creating the invoice.\n   *\n   * Emits the `invoiceCreated` event with invoice context, and if\n   * `autoPrint` is `true`, triggers `window.print()` afterwards.\n   */\n  private async handleConfirmInvoice(isProforma: boolean = false) {\n    try {\n      this.loadingChange.emit(true);\n      const billed_to_name = this.selectedRecipient?.startsWith('room__') ? this.selectedRecipient.replace('room__', '').trim() : '';\n      let target: {};\n      const setTarget = (code: string) => {\n        let f = this.invoiceTarget.find(t => t.CODE_NAME === '001');\n        if (!f) {\n          throw new Error(`Invalid code ${code}`);\n        }\n        return {\n          code: f.CODE_NAME,\n          description: f.CODE_VALUE_EN,\n        };\n      };\n      if (this.selectedRecipient === 'guest') {\n        target = setTarget('002');\n      } else {\n        target = setTarget('001');\n      }\n      const invoice = {\n        booking_nbr: this.booking.booking_nbr,\n        currency: { id: this.booking.currency.id },\n        Date: this.invoiceDate.format('YYYY-MM-DD'),\n        items: this.toBeInvoicedItems,\n        target,\n        billed_to_name,\n      };\n      await this.bookingService.issueInvoice({\n        is_proforma: isProforma,\n        invoice,\n      });\n      if (this.autoPrint) {\n        try {\n          // window.print();\n        } catch (error) {\n          // Fail silently but log for debugging\n          console.error('Auto print failed:', error);\n        }\n      }\n      this.invoiceClose.emit();\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.loadingChange.emit(false);\n    }\n  }\n\n  private getMinDate() {\n    if (this.for === 'room') {\n      return this.room.to_date;\n    }\n    const getMinCheckoutDate = () => {\n      let minDate = moment();\n      for (const room of this.booking.rooms) {\n        const d = moment(room.to_date, 'YYYY-MM-DD');\n        if (d.isBefore(minDate)) {\n          minDate = d.clone();\n        }\n      }\n      return minDate;\n    };\n\n    return getMinCheckoutDate().format('YYYY-MM-DD');\n  }\n\n  private getMaxDate() {\n    return moment().format('YYYY-MM-DD');\n  }\n\n  private computeRoomGroups(rooms: Room[]) {\n    const indexById = new Map<string, number>();\n    rooms.forEach((room, idx) => indexById.set(room.identifier, idx));\n\n    if (!rooms.length) {\n      return { groups: [], indexById, hasSplitGroups: false };\n    }\n\n    const groupSortKey = (groupRooms: Room[]) => {\n      let min = Number.MAX_SAFE_INTEGER;\n      for (const r of groupRooms) {\n        const ts = Date.parse(r?.from_date ?? '');\n        if (!Number.isNaN(ts)) {\n          min = Math.min(min, ts);\n        }\n      }\n      return min;\n    };\n\n    const splitIndex = buildSplitIndex(rooms);\n    if (!splitIndex) {\n      const sortedRooms = [...rooms].sort((a, b) => {\n        const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n        if (!Number.isNaN(diff) && diff !== 0) {\n          return diff;\n        }\n        return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n      });\n      return { groups: [{ rooms: sortedRooms, order: 0, isSplit: false, sortKey: groupSortKey(sortedRooms) }], indexById, hasSplitGroups: false };\n    }\n\n    const roomsById = new Map<string, Room>(rooms.map(room => [room.identifier, room]));\n    const grouped: { rooms: Room[]; order: number; sortKey: number; isSplit: boolean }[] = [];\n    const visited = new Set<string>();\n\n    for (const head of splitIndex.heads) {\n      const chain = splitIndex.chainOf.get(head) ?? [head];\n      const chainRooms = chain.map(id => roomsById.get(id)).filter((room): room is Room => Boolean(room));\n      if (!chainRooms.length) continue;\n\n      const chainHasSplitLink =\n        chain.some(id => {\n          const parent = splitIndex.parentOf.get(id);\n          const children = splitIndex.childrenOf.get(id) ?? [];\n          return Boolean(parent) || children.length > 0;\n        }) || chainRooms.some(room => Boolean(room?.is_split));\n\n      if (chainHasSplitLink) {\n        chainRooms.forEach(room => visited.add(room.identifier));\n        const order = Math.min(...chainRooms.map(room => indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER));\n        grouped.push({ rooms: chainRooms, order, sortKey: groupSortKey(chainRooms), isSplit: true });\n      }\n    }\n\n    for (const room of rooms) {\n      if (!visited.has(room.identifier)) {\n        const order = indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER;\n        const singleGroup = [room];\n        grouped.push({ rooms: singleGroup, order, sortKey: groupSortKey(singleGroup), isSplit: false });\n      }\n    }\n\n    grouped.sort((a, b) => {\n      if (a.sortKey !== b.sortKey) {\n        return a.sortKey - b.sortKey;\n      }\n      return a.order - b.order;\n    });\n    const hasSplitGroups = grouped.some(group => group.isSplit);\n\n    if (!hasSplitGroups) {\n      const merged = grouped\n        .map(group => group.rooms)\n        .reduce<Room[]>((acc, curr) => acc.concat(curr), [])\n        .sort((a, b) => {\n          const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n          if (!Number.isNaN(diff) && diff !== 0) {\n            return diff;\n          }\n          return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n        });\n      return { groups: [{ rooms: merged, order: 0, sortKey: groupSortKey(merged), isSplit: false }], indexById, hasSplitGroups: false };\n    }\n\n    return { groups: grouped, indexById, hasSplitGroups: true };\n  }\n\n  private renderRooms() {\n    const rooms = this.booking?.rooms ?? [];\n    if (!rooms.length || !this.invoicableKey?.size) {\n      return null;\n    }\n\n    const { groups, hasSplitGroups } = this.computeRoomGroups(rooms);\n\n    if (!hasSplitGroups) {\n      const groupRooms = groups[0].rooms;\n      const invoiceableRooms = groupRooms.filter(room => this.canInvoiceRoom(room));\n      if (!invoiceableRooms.length) {\n        return null;\n      }\n      return invoiceableRooms.map(room => {\n        const isSelected = this.isSelected([room.system_id]);\n        const isDisabled = this.isDisabled([room.system_id]);\n        return (\n          <div class=\"ir-invoice__service\" key={room.identifier}>\n            <wa-checkbox\n              disabled={isDisabled}\n              size=\"small\"\n              onchange={e => {\n                const value = (e.target as any).checked;\n                this.handleCheckChange({ checked: value, system_id: room.system_id });\n              }}\n              defaultChecked={isSelected}\n              checked={isSelected}\n              class=\"ir-invoice__checkbox\"\n            >\n              <div class={'ir-invoice__room-checkbox-container'}>\n                <b>{room.roomtype.name}</b>\n                <span>{room.rateplan.short_name}</span>\n                <span class=\"ir-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, room.gross_total)}</span>\n              </div>\n            </wa-checkbox>\n          </div>\n\n          // {this.renderRoomItem(room, indexById.get(room.identifier) ?? idx)}\n          // {idx < groupRooms.length - 1 ? <wa-divider></wa-divider> : null}\n        );\n      });\n    }\n    return groups.map(group => {\n      if (!this.hasInvoiceableRooms(group.rooms)) {\n        return null;\n      }\n      const roomIds = this.getInvoiceableRoomIds(group.rooms);\n      const isDisabled = this.isDisabled(roomIds);\n      const isSelected = this.isSelected(roomIds);\n      return (\n        <div class=\"ir-invoice__service\" key={group.order}>\n          <wa-checkbox\n            disabled={isDisabled}\n            size=\"small\"\n            onchange={e => {\n              const value = (e.target as any).checked;\n              this.handleCheckChange({ checked: value, system_ids: roomIds });\n            }}\n            defaultChecked={isSelected}\n            checked={isSelected}\n            class=\"ir-invoice__checkbox group\"\n          >\n            <div class={'ir-invoice__room-checkbox-container group'}>\n              {group.rooms.map(room => {\n                if (!this.canInvoiceRoom(room)) {\n                  return null;\n                }\n                return (\n                  <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                    <b>{room.roomtype.name}</b>\n                    <span>{room.rateplan.short_name}</span>\n                    <span class=\"ir-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, room.gross_total)}</span>\n                  </div>\n                );\n              })}\n            </div>\n          </wa-checkbox>\n        </div>\n      );\n    });\n  }\n\n  private handleCheckChange({ checked, system_id, system_ids }: { checked: boolean; system_id?: number; system_ids?: number[] }) {\n    if (!this.invoicableKey) {\n      return;\n    }\n    const ids = [...(Array.isArray(system_ids) ? system_ids : []), ...(typeof system_id === 'number' ? [system_id] : [])].filter((id): id is number => typeof id === 'number');\n\n    if (!ids.length) {\n      return;\n    }\n\n    if (this.viewMode === 'invoice' && ids.some(id => this.notInvoiceableItemKeys.has(id))) {\n      return;\n    }\n\n    const nextKeys = new Set(this.selectedItemKeys);\n    let changed = false;\n\n    ids.forEach(id => {\n      if (!this.invoicableKey.has(id)) {\n        return;\n      }\n      if (checked) {\n        if (!nextKeys.has(id)) {\n          nextKeys.add(id);\n          changed = true;\n        }\n      } else if (nextKeys.delete(id)) {\n        changed = true;\n      }\n    });\n\n    if (changed) {\n      this.syncSelectedItems(nextKeys);\n    }\n  }\n\n  private isSelected(system_ids: (number | undefined)[] = []) {\n    if (!system_ids?.length) {\n      return false;\n    }\n    for (const id of system_ids) {\n      if (typeof id === 'number' && this.selectedItemKeys.has(id)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private isDisabled(systemIds: (number | undefined)[] = []) {\n    if (this.viewMode === 'proforma' || !systemIds?.length) {\n      return false;\n    }\n    return systemIds.some(id => typeof id === 'number' && this.notInvoiceableItemKeys.has(id));\n  }\n\n  private renderPickup() {\n    const sysId = this.booking.pickup_info?.['system_id'];\n    if (!this.invoicableKey?.has(sysId)) {\n      return null;\n    }\n    const isSelected = this.isSelected([sysId]);\n    const isDisabled = this.isDisabled([sysId]);\n\n    return (\n      <div class=\"ir-invoice__service\">\n        <wa-checkbox\n          disabled={isDisabled}\n          size=\"small\"\n          onchange={e => {\n            const value = (e.target as any).checked;\n            this.handleCheckChange({ checked: value, system_id: sysId });\n          }}\n          defaultChecked={isSelected}\n          checked={isSelected}\n          class=\"ir-invoice__checkbox\"\n        >\n          <div class=\"ir-invoice__room-checkbox-container\">\n            <span>Pickup</span>\n            <span class=\"ir-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, this.booking.pickup_info.selected_option.amount)}</span>\n          </div>\n        </wa-checkbox>\n      </div>\n    );\n  }\n\n  render() {\n    if (this.isLoading) {\n      return (\n        <div class=\"drawer__loader-container\">\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    return (\n      <Host size=\"small\">\n        <form\n          id={this.formId}\n          onSubmit={e => {\n            e.preventDefault();\n            const submitter = (e as SubmitEvent).submitter as any | null;\n            const shouldCreateProforma = this.viewMode === 'proforma' || submitter?.value === 'pro-forma';\n            this.handleConfirmInvoice(shouldCreateProforma);\n          }}\n          class=\"ir-invoice__container\"\n        >\n          <ir-custom-date-picker\n            onDateChanged={e => {\n              this.invoiceDate = e.detail.start;\n              this.setUpDisabledItems();\n            }}\n            label=\"Date\"\n            date={this.invoiceDate.format('YYYY-MM-DD')}\n            minDate={this.getMinDate()}\n            maxDate={this.getMaxDate()}\n          ></ir-custom-date-picker>\n          <ir-booking-billing-recipient onRecipientChange={e => (this.selectedRecipient = e.detail)} booking={this.booking}></ir-booking-billing-recipient>\n          <div class={'ir-invoice__services'}>\n            <p class=\"ir-invoice__form-control-label\">\n              Choose what to invoice <span style={{ color: 'var(--wa-color-gray-60)', paddingLeft: '0.5rem' }}> (Disabled services are not eligible to be invoiced yet)</span>\n            </p>\n            <div class=\"ir-invoice__services-container\">\n              {this.renderRooms()}\n              {this.booking.pickup_info && this.renderPickup()}\n              {this.booking.extra_services?.map(extra_service => {\n                const sysId = extra_service.system_id;\n                if (!this.invoicableKey?.has(sysId)) {\n                  return null;\n                }\n                const isSelected = this.isSelected([sysId]);\n                const isDisabled = this.isDisabled([sysId]);\n                return (\n                  <div key={extra_service.system_id} class=\"ir-invoice__service\">\n                    <wa-checkbox\n                      disabled={isDisabled}\n                      size=\"small\"\n                      onchange={e => {\n                        const value = (e.target as any).checked;\n                        this.handleCheckChange({ checked: value, system_id: sysId });\n                      }}\n                      defaultChecked={isSelected}\n                      class=\"ir-invoice__checkbox\"\n                      checked={isSelected}\n                    >\n                      <div class=\"ir-invoice__room-checkbox-container\">\n                        <span>{extra_service.description}</span>\n                        <span class=\"ir-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, extra_service.price)}</span>\n                      </div>\n                    </wa-checkbox>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </form>\n      </Host>\n    );\n  }\n}\n"]}