{"version":3,"file":"ir-user-management-table.js","sourceRoot":"","sources":["../../../../src/components/ir-user-management/ir-user-management-table/ir-user-management-table.tsx"],"names":[],"mappings":"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","sourcesContent":["import locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\nimport { User } from '../types';\nimport moment from 'moment';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport { sleep } from '@/utils/utils';\n\n@Component({\n  tag: 'ir-user-management-table',\n  styleUrls: ['ir-user-management-table.css', '../../../common/table.css'],\n  scoped: true,\n})\nexport class IrUserManagementTable {\n  @Prop() users: User[] = [];\n  @Prop() isSuperAdmin: boolean;\n\n  @State() currentTrigger: any = null;\n  @State() user: User = null;\n\n  @Event() toast: EventEmitter<IToast>;\n  private modalRef: HTMLIrModalElement;\n\n  private async handleUserActiveChange(e: CustomEvent, user: User) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await sleep(300);\n    console.log(user);\n    this.toast.emit({\n      position: 'top-right',\n      title: 'Saved Successfully',\n      description: '',\n      type: 'success',\n    });\n  }\n  render() {\n    return (\n      <Host>\n        <section class=\"table-container h-100 p-1 w-100 m-0 table-responsive\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th class=\"text-left\">{locales.entries.Lcz_Username ?? 'Username'}</th>\n                <th class=\"text-left\">{locales.entries.Lcz_Email}</th>\n                <th class=\"text-left\">{locales.entries.Lcz_Mobile ?? 'Mobile'}</th>\n                <th class=\"text-left\">Role</th>\n                <th class=\"text-left\">Last signed in</th>\n                <th class=\"text-left\">Created at</th>\n                <th>Active</th>\n\n                <th>\n                  <ir-icon\n                    style={{ paddingLeft: '0.875rem' }}\n                    data-testid=\"new_user\"\n                    title={locales.entries.Lcz_CreateHousekeeper}\n                    onIconClickHandler={() => {\n                      this.currentTrigger = {\n                        type: 'user',\n                        isEdit: false,\n                        user: null,\n                      };\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"17.5\" viewBox=\"0 0 448 512\">\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z\"\n                      />\n                    </svg>\n                  </ir-icon>\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.users.map((user, i) => (\n                <tr key={user.id} class=\"ir-table-row\">\n                  <td class=\"text-left\">{user.username}</td>\n                  <td class=\"text-left w-100\">{user.email}</td>\n                  <td class=\"text-left\">\n                    {user.phone_prefix} {user.mobile}\n                  </td>\n                  <td class=\"text-left\">{user.role}</td>\n                  <td class=\"text-left\">{moment(user.last_signed_in, 'YYYY-MM-DD').format('MMM, DD YYYY')}</td>\n                  <td class=\"text-left\">{moment(user.created_at, 'YYYY-MM-DD').format('MMM, DD YYYY')}</td>\n                  <td>{i > 0 && <ir-switch onCheckChange={e => this.handleUserActiveChange(e, user)} checked={user.is_active}></ir-switch>}</td>\n                  <td class=\"\">\n                    <div class=\"icons-container d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                      <ir-icon\n                        data-testid=\"edit\"\n                        title={locales.entries.Lcz_EditHousekeeper}\n                        onIconClickHandler={() => {\n                          this.currentTrigger = {\n                            type: 'user',\n                            isEdit: true,\n                            user,\n                          };\n                        }}\n                        icon=\"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right\"\n                      >\n                        <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"20\" viewBox=\"0 0 512 512\">\n                          <path\n                            fill=\"#6b6f82\"\n                            d=\"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z\"\n                          />\n                        </svg>\n                      </ir-icon>\n                      {i > 0 && (\n                        <ir-icon\n                          data-testid=\"delete\"\n                          title={locales.entries.Lcz_DeleteHousekeeper}\n                          icon=\"ft-trash-2 danger h5 pointer\"\n                          onIconClickHandler={() => {\n                            this.user = user;\n                            this.modalRef.openModal();\n                          }}\n                        >\n                          <svg slot=\"icon\" fill=\"#ff2441\" xmlns=\"http://www.w3.org/2000/svg\" height=\"16\" width=\"14.25\" viewBox=\"0 0 448 512\">\n                            <path d=\"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z\" />\n                          </svg>\n                        </ir-icon>\n                      )}\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </section>\n        <ir-sidebar\n          showCloseButton={false}\n          open={this.currentTrigger !== null && this.currentTrigger?.type !== 'delete'}\n          onIrSidebarToggle={() => (this.currentTrigger = null)}\n          style={{\n            '--sidebar-block-padding': '0',\n            '--sidebar-width': this.currentTrigger ? (this.currentTrigger?.type === 'unassigned_units' ? 'max-content' : '40rem') : 'max-content',\n          }}\n        >\n          {this.renderCurrentTrigger()}\n        </ir-sidebar>\n        <ir-modal\n          autoClose={false}\n          modalBody={`Are you sure you want to delete ${this.user?.username}?`}\n          rightBtnColor=\"danger\"\n          rightBtnText={locales.entries.Lcz_Delete}\n          onConfirmModal={this.removeUser.bind(this)}\n          ref={el => (this.modalRef = el)}\n        ></ir-modal>\n      </Host>\n    );\n  }\n  private async removeUser(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n    } finally {\n      this.user = null;\n      this.modalRef.closeModal();\n    }\n  }\n  private renderCurrentTrigger() {\n    if (!this.currentTrigger) {\n      return null;\n    }\n    return (\n      <ir-user-form-panel\n        isSuperAdmin={this.isSuperAdmin}\n        onCloseSideBar={() => (this.currentTrigger = null)}\n        slot=\"sidebar-body\"\n        user={this.currentTrigger?.user}\n        isEdit={this.currentTrigger?.isEdit}\n      ></ir-user-form-panel>\n    );\n  }\n}\n"]}