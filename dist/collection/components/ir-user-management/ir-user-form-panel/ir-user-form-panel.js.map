{"version":3,"file":"ir-user-form-panel.js","sourceRoot":"","sources":["../../../../src/components/ir-user-management/ir-user-form-panel/ir-user-form-panel.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, Fragment, Prop, State, h } from '@stencil/core';\n\nimport locales from '@/stores/locales.store';\nimport { z, ZodError } from 'zod';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { CONSTANTS } from '@/utils/constants';\nimport { UserService } from '@/services/user.service';\nimport calendar_data from '@/stores/calendar-data';\nimport { User } from '@/models/Users';\n\n@Component({\n  tag: 'ir-user-form-panel',\n  styleUrls: ['ir-user-form-panel.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrUserFormPanel {\n  @Prop() user: User;\n  @Prop() userTypes = Map<number | string, string>;\n  @Prop() isEdit: boolean = false;\n  @Prop() language: string = 'en';\n  @Prop() property_id: number;\n  @Prop() haveAdminPrivileges: boolean;\n  @Prop() userTypeCode: string | number;\n\n  @State() isLoading: boolean = false;\n  @State() autoValidate = false;\n\n  @State() userInfo: User = {\n    type: '',\n    id: -1,\n    is_active: false,\n    sign_ins: null,\n    created_on: null,\n    mobile: '',\n    name: '',\n    note: '',\n    password: '',\n    email: '',\n    property_id: null,\n    username: null,\n    phone_prefix: null,\n  };\n\n  @State() errors: { [P in keyof User]?: any } | null = null;\n  @State() showPasswordValidation: boolean = false;\n  @State() isUsernameTaken: boolean;\n  @State() isOpen: boolean;\n\n  @Event() resetData: EventEmitter<null>;\n  @Event() closeSideBar: EventEmitter<null>;\n\n  private housekeepingService = new HouseKeepingService();\n  private userService = new UserService();\n\n  private disableFields = false;\n  private isPropertyAdmin = false;\n  private mobileMask = {};\n  private userSchema = z.object({\n    mobile: z.string().min(1).max(12),\n    email: z.string().email(),\n    password: z\n      .string()\n      .nullable()\n      // .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()\\-_=+]).{8,16}$/)\n      .refine(\n        password => {\n          if (this.user && !this.userInfo?.password) {\n            return true;\n          }\n          return CONSTANTS.PASSWORD.test(password);\n        },\n        { message: 'Password must be at least 8 characters long.' },\n      ),\n    username: z\n      .string()\n      .min(3)\n      .refine(\n        async name => {\n          if (this.user && this.user.username) {\n            return true;\n          }\n          if (name.length >= 3) {\n            return !(await new UserService().checkUserExistence({ UserName: name }));\n          }\n          return true;\n        },\n        { message: 'Username already exists.' },\n      ),\n  });\n  async componentWillLoad() {\n    if (!this.user) {\n      this.userInfo['property_id'] = this.property_id;\n      // this.showPasswordValidation = true;\n    }\n    if (this.user) {\n      this.autoValidate = true;\n      this.userInfo = { ...this.user, password: '' };\n      this.disableFields = true;\n    }\n    this.isPropertyAdmin = this.userTypeCode.toString() === '17';\n    if (this.isPropertyAdmin) {\n      this.updateUserField('type', '16');\n    }\n    this.mobileMask = {\n      mask: `{${calendar_data.country.phone_prefix}} 000000000000`,\n      lazy: false,\n      autofix: true,\n      placeholderChar: '\\u200B',\n    };\n  }\n\n  private updateUserField(key: keyof User, value: any) {\n    this.userInfo = { ...this.userInfo, [key]: value };\n  }\n\n  private async createOrUpdateUser() {\n    try {\n      this.isLoading = true;\n      if (!this.autoValidate) {\n        this.autoValidate = true;\n      }\n      const toValidateUserInfo = { ...this.userInfo, password: this.user && this.userInfo.password === '' ? this.user.password : this.userInfo.password };\n      console.log('toValidateUserInfo', { ...toValidateUserInfo, mobile: toValidateUserInfo.mobile.split(' ').join('').replace(calendar_data.country.phone_prefix, '') });\n      await this.userSchema.parseAsync({ ...toValidateUserInfo, mobile: toValidateUserInfo.mobile.split(' ').join('').replace(calendar_data.country.phone_prefix, '') });\n      if (this.errors) {\n        this.errors = null;\n      }\n      await this.userService.handleExposedUser(toValidateUserInfo);\n      this.resetData.emit(null);\n      this.closeSideBar.emit(null);\n    } catch (error) {\n      const e: any = {};\n      if (error instanceof ZodError) {\n        error.issues.map(err => {\n          e[err.path[0]] = true;\n        });\n        this.errors = e;\n      }\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private async handleBlur(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    if (this.user || !this.userInfo.name) {\n      return;\n    }\n    const usermame = await this.housekeepingService.generateUserName(this.userInfo.name);\n    this.updateUserField('username', usermame);\n  }\n\n  render() {\n    return (\n      <form\n        class=\"sheet-container\"\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.createOrUpdateUser();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" displayContext=\"sidebar\" label={this.isEdit ? 'Edit User' : 'Create New User'}></ir-title>\n        <section class=\"px-1 sheet-body\">\n          <ir-input-text\n            testId=\"email\"\n            zod={this.userSchema.pick({ email: true })}\n            wrapKey=\"email\"\n            autoValidate={this.autoValidate}\n            error={this.errors?.email}\n            label={locales.entries.Lcz_Email}\n            placeholder=\"\"\n            onTextChange={e => this.updateUserField('email', e.detail)}\n            value={this.userInfo.email}\n            onInputBlur={this.handleBlur.bind(this)}\n            maxLength={40}\n          />\n          <ir-input-text\n            testId=\"mobile\"\n            disabled={this.disableFields}\n            zod={this.userSchema.pick({ mobile: true })}\n            wrapKey=\"mobile\"\n            error={this.errors?.mobile}\n            asyncParse\n            autoValidate={this.user ? (this.userInfo?.mobile !== this.user.mobile ? true : false) : this.autoValidate}\n            label=\"Mobile\"\n            mask={this.mobileMask}\n            placeholder={''}\n            value={this.userInfo.mobile}\n            onTextChange={e => this.updateUserField('mobile', e.detail)}\n          />\n          {(this.user && this.user?.type?.toString() === '1') || this.isPropertyAdmin ? null : (\n            <div class=\"mb-1\">\n              <ir-select\n                disabled={this.disableFields}\n                label=\"Role\"\n                data={[\n                  { text: 'Frontdesk', value: '16' },\n                  { text: 'Property Admin', value: '17' },\n                ]}\n                selectedValue={this.userInfo.type}\n                onSelectChange={e => this.updateUserField('type', e.detail)}\n              />\n            </div>\n          )}\n          <ir-input-text\n            testId=\"username\"\n            zod={this.userSchema.pick({ username: true })}\n            wrapKey=\"username\"\n            autoValidate={this.autoValidate}\n            error={this.errors?.username}\n            label=\"Username\"\n            disabled={this.disableFields}\n            placeholder=\"\"\n            onTextChange={e => this.updateUserField('username', e.detail)}\n            value={this.userInfo.username}\n            onInputBlur={this.handleBlur.bind(this)}\n            maxLength={40}\n          />\n          {!this.user ? (\n            <Fragment>\n              <ir-input-text\n                testId=\"password\"\n                autoValidate={this.user ? (!this.userInfo?.password ? false : true) : this.autoValidate}\n                label={'Password'}\n                value={this.userInfo.password}\n                type=\"password\"\n                maxLength={16}\n                zod={this.userSchema.pick({ password: true })}\n                wrapKey=\"password\"\n                error={this.errors?.password}\n                onInputFocus={() => (this.showPasswordValidation = true)}\n                onInputBlur={() => {\n                  // if (this.user) this.showPasswordValidation = false;\n                }}\n                onTextChange={e => this.updateUserField('password', e.detail)}\n              ></ir-input-text>\n              {this.showPasswordValidation && <ir-password-validator class=\"mb-1\" password={this.userInfo.password}></ir-password-validator>}\n            </Fragment>\n          ) : (\n            this.haveAdminPrivileges &&\n            this.user.type.toString() !== '1' && (\n              <div class=\"d-flex align-items-center justify-content-between\">\n                <h4 class=\"m-0 p-0\">Password</h4>\n                <ir-button btn_styles={'pr-0'} onClickHandler={() => (this.isOpen = true)} text=\"Change password\" btn_color=\"link\"></ir-button>\n              </div>\n            )\n          )}\n          <ir-sidebar\n            open={this.isOpen}\n            showCloseButton={false}\n            style={{\n              '--sidebar-block-padding': '0',\n            }}\n            onIrSidebarToggle={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              this.isOpen = false;\n            }}\n          >\n            {this.isOpen && (\n              <ir-reset-password\n                skip2Fa={true}\n                username={this.user.username}\n                onCloseSideBar={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.isOpen = false;\n                }}\n                slot=\"sidebar-body\"\n              ></ir-reset-password>\n            )}\n          </ir-sidebar>\n        </section>\n        <div class=\"sheet-footer\">\n          <ir-button\n            data-testid=\"cancel\"\n            onClickHandler={() => this.closeSideBar.emit(null)}\n            class=\"flex-fill\"\n            btn_styles=\"w-100 justify-content-center align-items-center\"\n            btn_color=\"secondary\"\n            text={locales.entries.Lcz_Cancel}\n          ></ir-button>\n          <ir-button\n            data-testid=\"save\"\n            isLoading={this.isLoading}\n            class=\"flex-fill\"\n            btn_type=\"submit\"\n            btn_styles=\"w-100 justify-content-center align-items-center\"\n            text={locales.entries.Lcz_Save}\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n"]}