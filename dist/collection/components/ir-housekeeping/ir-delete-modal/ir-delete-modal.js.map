{"version":3,"file":"ir-delete-modal.js","sourceRoot":"","sources":["../../../../src/components/ir-housekeeping/ir-delete-modal/ir-delete-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Listen, Method, Prop, State, h, Event } from '@stencil/core';\nimport housekeeping_store from '@/stores/housekeeping.store';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { IHouseKeepers } from '@/models/housekeeping';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'ir-delete-modal',\n  styleUrl: 'ir-delete-modal.css',\n  shadow: false,\n})\nexport class IrDeleteModal {\n  @Prop() user: IHouseKeepers;\n\n  @State() isOpen: boolean = false;\n  @State() selectedId: string = '';\n  @State() loadingBtn: 'confirm' | null = null;\n\n  @Event() modalClosed: EventEmitter<null>;\n  @Event() resetData: EventEmitter<string>;\n\n  private housekeepingService = new HouseKeepingService();\n\n  @Method()\n  async closeModal() {\n    this.isOpen = false;\n    this.modalClosed.emit(null);\n  }\n  @Method()\n  async openModal() {\n    this.isOpen = true;\n  }\n\n  @Listen('clickHandler')\n  async btnClickHandler(event: CustomEvent) {\n    let target = event.target as HTMLInputElement;\n    let name = target.name;\n    try {\n      if (name === 'confirm') {\n        this.loadingBtn = 'confirm';\n        if (this.selectedId === '') {\n          await this.housekeepingService.editExposedHKM(this.user, true);\n        } else {\n          const newAssignedUnits = this.user.assigned_units.map(u => ({ hkm_id: +this.selectedId, is_to_assign: true, unit_id: u.id }));\n          await this.housekeepingService.manageExposedAssignedUnitToHKM(housekeeping_store.default_properties.property_id, newAssignedUnits);\n          const { assigned_units, is_soft_deleted, is_active, ...user } = this.user;\n          await this.housekeepingService.editExposedHKM(user, true);\n        }\n        this.resetData.emit(null);\n      }\n      if (name === 'cancel') {\n        this.closeModal();\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      if (this.loadingBtn) {\n        this.loadingBtn = null;\n        this.closeModal();\n      }\n    }\n  }\n  render() {\n    if (!this.user) {\n      return;\n    }\n    return [\n      <div\n        class={`backdropModal ${this.isOpen ? 'active' : ''}`}\n        onClick={() => {\n          this.closeModal();\n        }}\n      ></div>,\n      <div data-state={this.isOpen ? 'opened' : 'closed'} class={`ir-modal`} tabindex=\"-1\">\n        <div class={`ir-alert-content p-2`}>\n          <div class={`r-alert-header mb-1 d-flex align-items-center justify-content-between border-0 py-0 m-0 `}>\n            <p class={'m-0 p-0'}>{this.user.assigned_units.length > 0 ? locales.entries.Lcz_AssignUnitsTo : locales.entries.Lcz_ConfirmDeletion}</p>\n            <ir-button class=\"exit-icon\" variant=\"icon\" icon_name=\"xmark\" onClickHandler={() => this.closeModal()}></ir-button>\n          </div>\n          <div class=\"modal-body text-left p-0 mb-2\">\n            {this.user.assigned_units.length > 0 && (\n              <div class=\"modal-body text-left p-0 mb-2\">\n                <ir-select\n                  firstOption={locales.entries.Lcz_nobody}\n                  selectedValue={this.selectedId}\n                  onSelectChange={e => (this.selectedId = e.detail)}\n                  LabelAvailable={false}\n                  data={housekeeping_store.hk_criteria.housekeepers\n                    .filter(hk => hk.id !== this.user.id)\n                    .map(m => ({\n                      value: m.id.toString(),\n                      text: m.name,\n                    }))\n                    .sort((a, b) => a.text.toLowerCase().localeCompare(b.text.toLowerCase()))}\n                ></ir-select>\n              </div>\n            )}\n          </div>\n\n          <div class={`ir-alert-footer border-0  d-flex justify-content-end`}>\n            <ir-button btn_color={'secondary'} btn_block text={locales.entries.Lcz_Cancel} name={'cancel'}></ir-button>\n            <ir-button isLoading={this.loadingBtn === 'confirm'} btn_color={'primary'} btn_block text={locales.entries.Lcz_Confirm} name={'confirm'}></ir-button>\n          </div>\n        </div>\n      </div>,\n    ];\n    // <div aria-modal={this.isOpen ? 'true' : 'false'} class=\"modal fade\" ref={el => (this.modalEl = el)} tabindex=\"-1\">\n    //   <div class=\"modal-dialog modal-dialog-centered\">\n    //     <div class=\"modal-content\">\n    //       <div class=\"modal-body\">\n    //         <div class={`ir-alert-header mb-1 d-flex align-items-center justify-content-between border-0 py-0 m-0 `}>\n    //           <p class=\"p-0 my-0 modal-title\">{this.user.assigned_units.length > 0 ? locales.entries.Lcz_AssignUnitsTo : locales.entries.Lcz_ConfirmDeletion}</p>\n    //           <ir-button class=\"exit-icon\" variant=\"icon\" icon_name=\"xmark\" onClickHandler={() => this.closeModal()}></ir-button>\n    //         </div>\n    //         {this.user.assigned_units.length > 0 && (\n    //           <div class=\"modal-body text-left p-0 mb-2\">\n    //             <ir-select\n    //               firstOption={locales.entries.Lcz_nobody}\n    //               selectedValue={this.selectedId}\n    //               onSelectChange={e => (this.selectedId = e.detail)}\n    //               LabelAvailable={false}\n    //               data={housekeeping_store.hk_criteria.housekeepers\n    //                 .filter(hk => hk.id !== this.user.id)\n    //                 .map(m => ({\n    //                   value: m.id.toString(),\n    //                   text: m.name,\n    //                 }))\n    //                 .sort((a, b) => a.text.toLowerCase().localeCompare(b.text.toLowerCase()))}\n    //             ></ir-select>\n    //           </div>\n    //         )}\n\n    //         <div class={`ir-alert-footer border-0 d-flex justify-content-end`}>\n    //           <ir-button btn_color={'secondary'} btn_block text={locales.entries.Lcz_Cancel} name={'cancel'}></ir-button>\n    //           <ir-button isLoading={this.loadingBtn === 'confirm'} btn_color={'primary'} btn_block text={locales.entries.Lcz_Confirm} name={'confirm'}></ir-button>\n    //         </div>\n    //       </div>\n    //     </div>\n    //   </div>\n    // </div>\n  }\n}\n"]}