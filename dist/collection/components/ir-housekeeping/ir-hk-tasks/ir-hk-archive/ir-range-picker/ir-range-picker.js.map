{"version":3,"file":"ir-range-picker.js","sourceRoot":"","sources":["../../../../../../src/components/ir-housekeeping/ir-hk-tasks/ir-hk-archive/ir-range-picker/ir-range-picker.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, Listen, Prop, Event, EventEmitter, h, State } from '@stencil/core';\nimport moment, { Moment } from 'moment';\n\n@Component({\n  tag: 'ir-range-picker',\n  styleUrl: 'ir-range-picker.css',\n  scoped: true,\n})\nexport class IrRangePicker {\n  /**\n   * The earliest date that can be selected.\n   */\n  @Prop() minDate?: string | Date;\n\n  /**\n   * The latest date that can be selected.\n   */\n  @Prop() maxDate?: string | Date;\n  /**\n   * The start date of the range.\n   */\n  @Prop() fromDate: Moment;\n  /**\n   * The end date of the range.\n   */\n  @Prop() toDate: Moment;\n\n  /**\n   * Whether to show the overlay before the date is selected.\n   */\n  @Prop() withOverlay: boolean = true;\n  /**\n   * Whether to all the emitted dates to be null.\n   */\n  @Prop() allowNullDates: boolean = true;\n\n  @State() lastFocusedPicker: string;\n\n  @Event() dateRangeChanged: EventEmitter<{ fromDate: Moment; toDate: Moment; wasFocused?: boolean }>;\n\n  private minSelectableDate = moment().subtract(90, 'days').toDate();\n  private fromDatePicker: HTMLIrDatePickerElement;\n  private toDatePicker: HTMLIrDatePickerElement;\n  private date_container: HTMLDivElement;\n  private focusTimeout: NodeJS.Timeout;\n\n  @Listen('dateChanged')\n  async handleDateChanged(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const selectedDate = e.detail.start ? moment(e.detail.start) : null;\n    if (!this.lastFocusedPicker) {\n      return;\n    }\n    if ((e.target as HTMLElement).id === 'fromDate') {\n      let updatedToDate = this.toDate;\n      if (!selectedDate) {\n        this.dateRangeChanged.emit({ fromDate: null, toDate: null, wasFocused: !!this.lastFocusedPicker });\n        return;\n      }\n      if (!updatedToDate || updatedToDate.isBefore(selectedDate, 'day')) {\n        updatedToDate = selectedDate;\n      }\n\n      this.dateRangeChanged.emit({ fromDate: selectedDate, toDate: updatedToDate, wasFocused: !!this.lastFocusedPicker });\n      await this.toDatePicker.openDatePicker();\n    } else {\n      if (!selectedDate) {\n        this.dateRangeChanged.emit({ fromDate: this.fromDate, toDate: this.fromDate, wasFocused: !!this.lastFocusedPicker });\n        return;\n      }\n      this.dateRangeChanged.emit({ fromDate: this.fromDate, toDate: selectedDate, wasFocused: !!this.lastFocusedPicker });\n    }\n    this.lastFocusedPicker = null;\n  }\n  @Listen('datePickerFocus')\n  handleDatePickerFocus(e: CustomEvent) {\n    e.stopPropagation();\n    clearTimeout(this.focusTimeout);\n    this.date_container.classList.add('focused');\n    (e.target as HTMLIrRangePickerElement).classList.add('focused');\n  }\n  @Listen('datePickerBlur')\n  handleDatePickerBlur(e: CustomEvent) {\n    e.stopPropagation();\n    (e.target as HTMLIrRangePickerElement).classList.remove('focused');\n    this.focusTimeout = setTimeout(() => {\n      this.date_container.classList.remove('focused');\n    }, 10);\n  }\n  disconnectedCallback() {\n    clearTimeout(this.focusTimeout);\n  }\n  private renderDatePicker(id: string, date: Moment, minDate: string | Date, refCallback: (el: HTMLIrDatePickerElement) => void, additionalProps: any = {}) {\n    return (\n      <ir-date-picker\n        class={{\n          'range-picker__date-picker': true,\n          'range-picker__date-picker--hidden': this.withOverlay && !this.fromDate,\n        }}\n        customPicker\n        ref={el => refCallback(el)}\n        minDate={minDate}\n        maxDate={this.maxDate}\n        date={date?.toDate()}\n        id={id}\n        onDatePickerFocus={() => {\n          this.lastFocusedPicker = id;\n        }}\n        emitEmptyDate={this.allowNullDates}\n        {...additionalProps}\n      >\n        <p class=\"range-picker__date-picker-button\" slot=\"trigger\">\n          {date?.format('YYYY-MM-DD') ?? '2025-03-02'}\n        </p>\n      </ir-date-picker>\n    );\n  }\n\n  render() {\n    return (\n      <Host size=\"small\">\n        <div class=\"range-picker__container\" ref={el => (this.date_container = el)}>\n          {this.withOverlay && (\n            <div\n              class={{\n                'range-picker__overlay': true,\n                'range-picker__overlay--active': !this.fromDate,\n              }}\n              onClick={() => this.fromDatePicker.openDatePicker()}\n            >\n              <wa-icon name=\"calendar\"></wa-icon>\n              <p class=\"m-0\">\n                <slot name=\"message\">Cleaned on</slot>\n              </p>\n            </div>\n          )}\n          <svg\n            class={{\n              'range-picker__calendar-icon': true,\n              'range-picker__icon--hidden': this.withOverlay && !this.fromDate,\n            }}\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 448 512\"\n            style={{ height: '14px', width: '14px' }}\n          >\n            <path\n              fill=\"currentColor\"\n              d=\"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z\"\n            ></path>\n          </svg>\n          {this.renderDatePicker('fromDate', this.fromDate, this.minDate, el => (this.fromDatePicker = el))}\n          <svg\n            class={{\n              'range-picker__arrow-icon': true,\n              'range-picker__icon--hidden': this.withOverlay && !this.fromDate,\n            }}\n            xmlns=\"http://www.w3.org/2000/svg\"\n            height=\"14\"\n            width=\"14\"\n            viewBox=\"0 0 512 512\"\n          >\n            <path\n              fill=\"currentColor\"\n              d=\"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z\"\n            />\n          </svg>\n          {this.renderDatePicker('toDate', this.toDate, this.fromDate?.toDate() || this.minSelectableDate, el => (this.toDatePicker = el), {\n            forceDestroyOnUpdate: false,\n          })}\n        </div>\n      </Host>\n    );\n  }\n}\n"]}