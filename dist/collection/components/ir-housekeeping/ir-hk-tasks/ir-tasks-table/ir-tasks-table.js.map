{"version":3,"file":"ir-tasks-table.js","sourceRoot":"","sources":["../../../../../src/components/ir-housekeeping/ir-hk-tasks/ir-tasks-table/ir-tasks-table.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { Task } from '@/models/housekeeping';\nimport moment from 'moment';\nimport housekeeping_store from '@/stores/housekeeping.store';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'ir-tasks-table',\n  styleUrls: ['ir-tasks-table.css', '../../../../common/table.css'],\n  scoped: true,\n})\nexport class IrTasksTable {\n  @Prop({ mutable: true }) tasks: Task[] = [];\n\n  /**\n   * Tracks which task IDs are currently selected via checkboxes.\n   */\n  @State() selectedIds: Task['id'][] = [];\n\n  /**\n   * Controls whether the \"Confirm Clean\" modal is shown.\n   */\n  @State() showConfirmModal: boolean = false;\n\n  /**\n   * The key we are sorting by (e.g., \"date\", \"unit\", \"status\", \"housekeeper\").\n   */\n  @State() sortKey: string = 'date';\n\n  /**\n   * The sort direction: ASC or DESC.\n   */\n  @State() sortDirection: 'ASC' | 'DESC' = 'ASC';\n  @State() checkableTasks: Task[] = [];\n\n  @Event({ bubbles: true, composed: true }) animateCleanedButton: EventEmitter<null>;\n  @Event({ bubbles: true, composed: true }) rowSelectChange: EventEmitter<Task[]>;\n  @Event({ bubbles: true, composed: true }) sortingChanged: EventEmitter<{ field: string; direction: 'ASC' | 'DESC' }>;\n\n  componentWillLoad() {\n    this.sortTasks('date', 'ASC');\n    if (this.tasks) {\n      this.assignCheckableTasks();\n    }\n  }\n\n  /**\n   * Sorts the tasks by the given key. If no direction is provided,\n   * it toggles between ascending and descending.\n   */\n  private handleSort(key: string) {\n    let newDirection = this.sortDirection;\n    // If we're clicking the same column, flip the direction. If a new column, default to ASC.\n    if (this.sortKey === key) {\n      newDirection = this.sortDirection === 'ASC' ? 'DESC' : 'ASC';\n    } else {\n      newDirection = 'ASC';\n    }\n    this.sortingChanged.emit({ field: key, direction: newDirection });\n    this.sortTasks(key, newDirection);\n  }\n\n  @Listen('clearSelectedHkTasks', { target: 'body' })\n  handleClearSelectedHkTasks(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.selectedIds = [];\n  }\n\n  @Watch('tasks')\n  handleTasksChange(newTasks: Task[]) {\n    if (newTasks?.length) {\n      this.selectedIds = [];\n      this.assignCheckableTasks();\n    }\n  }\n  /**\n   * Helper to sort tasks array in state.\n   */\n  /**\n   * Sorts the tasks by the given key in ASC or DESC order.\n   * If values for `key` are duplicates, it sorts by `date` ascending.\n   * If `date` is also the same, it finally sorts by `unit.name` ascending.\n   */\n  private sortTasks(key: string, direction: 'ASC' | 'DESC') {\n    const sorted = [...this.tasks].sort((a, b) => {\n      // Primary comparison: a[key] vs b[key]\n      let aPrimary = a[key];\n      let bPrimary = b[key];\n      if (key === 'status') {\n        aPrimary = a[key].description;\n        bPrimary = b[key].description;\n      }\n\n      if (aPrimary < bPrimary) {\n        return direction === 'ASC' ? -1 : 1;\n      }\n      if (aPrimary > bPrimary) {\n        return direction === 'ASC' ? 1 : -1;\n      }\n\n      // First tiebreaker: compare by date (always ascending)\n      if (a.date < b.date) return -1;\n      if (a.date > b.date) return 1;\n\n      // Second tiebreaker: compare by unit.name (always ascending)\n      if (a.unit?.name < b.unit?.name) return -1;\n      if (a.unit?.name > b.unit?.name) return 1;\n\n      return 0;\n    });\n\n    // Update component state\n    this.tasks = sorted;\n    this.sortKey = key;\n    this.sortDirection = direction;\n  }\n\n  /**\n   * Helper to toggle selection for a single row.\n   */\n  private toggleSelection(id: Task['id']) {\n    if (this.selectedIds.includes(id)) {\n      this.selectedIds = this.selectedIds.filter(item => item !== id);\n    } else {\n      this.selectedIds = [...this.selectedIds, id];\n      this.animateCleanedButton.emit(null);\n    }\n    this.emitSelectedTasks();\n  }\n\n  private emitSelectedTasks() {\n    if (this.tasks.length === 0) {\n      return;\n    }\n    const filteredTasks = this.tasks.filter(t => this.selectedIds.includes(t.id));\n    this.rowSelectChange.emit(filteredTasks);\n  }\n\n  /**\n   * Checks if every row is selected.\n   */\n  private get allSelected(): boolean {\n    return this.checkableTasks.length > 0 && this.selectedIds.length === this.checkableTasks.length;\n  }\n\n  /**\n   * Toggles selection on all visible tasks at once.\n   */\n  private toggleSelectAll() {\n    if (this.allSelected) {\n      this.selectedIds = [];\n    } else {\n      this.selectedIds = this.checkableTasks.map(t => t.id);\n      this.animateCleanedButton.emit(null);\n    }\n    this.emitSelectedTasks();\n  }\n\n  /**\n   * Assigns checkable tasks based on predefined criteria.\n   *\n   * This method filters tasks and determines which ones are eligible\n   * to be selected using checkboxes. A task is considered \"checkable\"\n   * if its date is today or earlier.\n   *\n   * The filtered tasks are stored in `this.checkableTasks`, ensuring\n   * only relevant tasks can be interacted with by users.\n   */\n  private assignCheckableTasks() {\n    const tasks = [];\n    this.tasks.forEach(task => {\n      if (this.isCheckable(task)) {\n        tasks.push(task);\n      }\n    });\n    this.checkableTasks = [...tasks];\n  }\n\n  /**\n   * Determines if a task is checkable.\n   *\n   * A task is considered checkable if its date is today or any day before.\n   * This prevents users from selecting tasks with future dates.\n   *\n   * @param {string} date - The task's date in 'YYYY-MM-DD' format.\n   * @returns {boolean} - Returns `true` if the task's date is today or earlier, otherwise `false`.\n   */\n  private isCheckable(task: Task): boolean {\n    // if (!task.hkm_id) {\n    //   return false;\n    // }\n    return moment(task.date, 'YYYY-MM-DD').isSameOrBefore(moment(), 'days');\n  }\n\n  render() {\n    const haveManyHousekeepers = housekeeping_store?.hk_criteria?.housekeepers?.length > 1;\n    return (\n      <div class=\"card table-container h-100 p-1 m-0 table-responsive\">\n        <table class=\"table\" data-testid=\"hk_tasks_table\">\n          <thead class=\"table-header\">\n            <tr>\n              <th class={'task-row'}>\n                <ir-checkbox\n                  indeterminate={this.selectedIds.length > 0 && this.selectedIds.length < this.checkableTasks.length}\n                  checked={this.allSelected}\n                  onCheckChange={() => this.toggleSelectAll()}\n                ></ir-checkbox>\n              </th>\n              <th class=\"extra-padding\">{locales.entries.Lcz_Period}</th>\n              <th class=\"extra-padding\">{locales.entries.Lcz_Unit}</th>\n              <th class={'sortable extra-padding'} onClick={() => this.handleSort('status')}>\n                <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                  <span>{locales.entries.Lcz_Status}</span>\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"16\"\n                    height=\"16\"\n                    viewBox=\"0 0 24 24\"\n                    fill=\"none\"\n                    stroke=\"currentColor\"\n                    stroke-width=\"2\"\n                    stroke-linecap=\"round\"\n                    stroke-linejoin=\"round\"\n                    class=\"lucide lucide-arrow-up-down\"\n                  >\n                    <path d=\"m21 16-4 4-4-4\" />\n                    <path d=\"M17 20V4\" />\n                    <path d=\"m3 8 4-4 4 4\" />\n                    <path d=\"M7 4v16\" />\n                  </svg>\n                </div>\n              </th>\n              <th class=\"extra-padding\">{locales.entries.Lcz_Hint}</th>\n              <th class=\"text-center\">{locales.entries.Lcz_A}</th>\n              <th class=\"text-center\">{locales.entries.Lcz_C}</th>\n              <th class=\"text-center\">{locales.entries.Lcz_I}</th>\n              {haveManyHousekeepers && (\n                <th style={{ textAlign: 'start' }} class={'sortable extra-padding'} onClick={() => this.handleSort('housekeeper')}>\n                  <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                    <span>{locales.entries.Lcz_Housekeeper}</span>\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"16\"\n                      height=\"16\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      stroke-width=\"2\"\n                      stroke-linecap=\"round\"\n                      stroke-linejoin=\"round\"\n                      class=\"lucide lucide-arrow-up-down\"\n                    >\n                      <path d=\"m21 16-4 4-4-4\" />\n                      <path d=\"M17 20V4\" />\n                      <path d=\"m3 8 4-4 4 4\" />\n                      <path d=\"M7 4v16\" />\n                    </svg>\n                  </div>\n                </th>\n              )}\n            </tr>\n          </thead>\n\n          <tbody>\n            {this.tasks.length === 0 && (\n              <tr class=\"ir-table-row\">\n                <td colSpan={9} class=\"text-center\">\n                  <div style={{ height: '300px' }} class=\"d-flex align-items-center justify-content-center\">\n                    <span> {locales.entries.Lcz_NoTasksFound}</span>\n                  </div>\n                </td>\n              </tr>\n            )}\n            {this.tasks.map(task => {\n              const isSelected = this.selectedIds.includes(task.id);\n              const isCheckable = this.isCheckable(task);\n              return (\n                <tr\n                  data-date={task.date}\n                  data-testid={`hk_task_row`}\n                  data-assigned={task.housekeeper ? 'true' : 'false'}\n                  style={isCheckable && { cursor: 'pointer' }}\n                  onClick={() => {\n                    if (!isCheckable) {\n                      return;\n                    }\n                    this.toggleSelection(task.id);\n                  }}\n                  class={{ 'selected': isSelected, 'task-table-row ir-table-row': true }}\n                  key={task.id}\n                >\n                  <td class=\"task-row \">{isCheckable && <ir-checkbox checked={isSelected}></ir-checkbox>}</td>\n                  <td class=\"task-row extra-padding\">{task.formatted_date}</td>\n                  <td class=\"task-row extra-padding\">\n                    <span class={{ 'highlighted-unit': task.is_highlight }}>{task.unit.name}</span>\n                  </td>\n                  <td class=\"task-row extra-padding\">{task.status.description}</td>\n                  <td class=\"task-row extra-padding\">{task.hint}</td>\n                  <td class=\"task-row text-center\">{task.adult}</td>\n                  <td class=\"task-row text-center\">{task.child}</td>\n                  <td class=\"task-row text-center\">{task.infant}</td>\n                  {haveManyHousekeepers && (\n                    <td class=\"w-50 task-row extra-padding\" style={{ textAlign: 'start' }}>\n                      {task.housekeeper ?? locales.entries.Lcz_Unassigned}\n                    </td>\n                  )}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n"]}