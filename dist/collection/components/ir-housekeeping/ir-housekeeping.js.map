{"version":3,"file":"ir-housekeeping.js","sourceRoot":"","sources":["../../../src/components/ir-housekeeping/ir-housekeeping.tsx"],"names":[],"mappings":"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","sourcesContent":["import { IHKStatuses } from '@/models/housekeeping';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport housekeeping_store from '@/stores/housekeeping.store';\r\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\r\nimport axios from 'axios';\r\n\r\n@Component({\r\n  tag: 'ir-housekeeping',\r\n  styleUrl: 'ir-housekeeping.css',\r\n  scoped: true,\r\n})\r\nexport class IrHousekeeping {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n  @Prop() baseurl: string = '';\r\n  @Prop() propertyid: number;\r\n\r\n  @State() isLoading = false;\r\n  @State() exposedHouseKeepingStatuses: IHKStatuses[];\r\n\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n\r\n  componentWillLoad() {\r\n    if (this.baseurl) {\r\n      axios.defaults.baseURL = this.baseurl;\r\n    }\r\n    if (this.ticket !== '') {\r\n      this.roomService.setToken(this.ticket);\r\n      this.houseKeepingService.setToken(this.ticket);\r\n      housekeeping_store.token = this.ticket;\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Watch('ticket')\r\n  async ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      this.roomService.setToken(this.ticket);\r\n      this.houseKeepingService.setToken(this.ticket);\r\n      housekeeping_store.token = this.ticket;\r\n      this.initializeApp();\r\n    }\r\n  }\r\n\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      const [housekeeping] = await Promise.all([this.houseKeepingService.getExposedHKSetup(this.propertyid)]);\r\n      this.exposedHouseKeepingStatuses = housekeeping.statuses;\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-interceptor></ir-interceptor>\r\n        <ir-toast></ir-toast>\r\n        <section class=\"p-1\">\r\n          <div class=\"card p-1\">\r\n            <h4>Room or Unit Status</h4>\r\n            <table>\r\n              <thead>\r\n                <tr>\r\n                  <th>Status</th>\r\n                  <th>Code</th>\r\n                  <th>Action</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {this.exposedHouseKeepingStatuses?.map(status => (\r\n                  <tr key={status.code}>\r\n                    <td>\r\n                      <div class=\"status-container\">\r\n                        <span class={`circle ${status.style.shape} ${status.style.color}`}></span>\r\n                        <p>{status.description}</p>\r\n                      </div>\r\n                    </td>\r\n                    <td>{status.code}</td>\r\n                    <td>\r\n                      <div class=\"action-container\">\r\n                        <p class={'m-0'}>{status.action}</p>\r\n                        {status.inspection_mode?.is_active && (\r\n                          <div>\r\n                            <ir-select\r\n                              LabelAvailable={false}\r\n                              firstOption=\"No\"\r\n                              data={Array.from(Array(status.inspection_mode.window + 1), (_, i) => i).map(i => {\r\n                                const text = i === 0 ? 'Yes on the same day.' : i.toString() + ' day prior.';\r\n                                return {\r\n                                  text,\r\n                                  value: i.toString(),\r\n                                };\r\n                              })}\r\n                            ></ir-select>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}