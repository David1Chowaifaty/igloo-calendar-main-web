{"version":3,"file":"ir-hk-team.js","sourceRoot":"","sources":["../../../../src/components/ir-housekeeping/ir-hk-team/ir-hk-team.tsx"],"names":[],"mappings":"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","sourcesContent":["import { IHouseKeepers, THousekeepingTrigger } from '@/models/housekeeping';\nimport housekeeping_store from '@/stores/housekeeping.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Listen, State, h, Element } from '@stencil/core';\n\n@Component({\n  tag: 'ir-hk-team',\n  styleUrl: 'ir-hk-team.css',\n  scoped: true,\n})\nexport class IrHkTeam {\n  @Element() el: HTMLElement;\n  @State() currentTrigger: THousekeepingTrigger | null = null;\n\n  private deletionTimout: NodeJS.Timeout;\n  renderAssignedUnits(hk: IHouseKeepers) {\n    if (hk.assigned_units.length === 0) {\n      return (\n        <span>\n          0 -{' '}\n          <button class=\"outline-btn\" onClick={() => (this.currentTrigger = { type: 'unassigned_units', user: hk })}>\n            {locales.entries.Lcz_Assign}\n          </button>\n        </span>\n      );\n    }\n    return (\n      <span>\n        {hk.assigned_units.length} -{' '}\n        <button onClick={() => (this.currentTrigger = { type: 'unassigned_units', user: hk })} class=\"outline-btn\">\n          {locales.entries.Lcz_Edit}\n        </button>\n      </span>\n    );\n  }\n  renderCurrentTrigger() {\n    switch (this.currentTrigger?.type) {\n      case 'unassigned_units':\n        return <ir-hk-unassigned-units slot=\"sidebar-body\" user={this.currentTrigger.user}></ir-hk-unassigned-units>;\n      case 'user':\n        return <ir-hk-user slot=\"sidebar-body\" user={this.currentTrigger.user} isEdit={this.currentTrigger.isEdit}></ir-hk-user>;\n      default:\n        return null;\n    }\n  }\n\n  @Listen('closeSideBar')\n  handleCloseSideBar(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.currentTrigger = null;\n  }\n  handleDeletion(user) {\n    this.currentTrigger = { type: 'delete', user };\n    this.deletionTimout = setTimeout(() => {\n      const modal = this.el.querySelector('ir-delete-modal');\n      if (!modal) return;\n      modal.openModal();\n    }, 100);\n  }\n  disconnectedCallback() {\n    clearTimeout(this.deletionTimout);\n  }\n  render() {\n    if (!housekeeping_store.hk_criteria) {\n      return null;\n    }\n    const { assigned, total, un_assigned } = housekeeping_store.hk_criteria.units_assignments;\n\n    return (\n      <Host class=\"card p-1\">\n        <section>\n          <ir-title label={locales.entries.Lcz_HousekeepingTeam} justifyContent=\"space-between\">\n            <div slot=\"title-body\" class=\"assignments-container gap-16 m-0\">\n              <p class=\"font-weight-bold m-0 p-0\">\n                {total} {locales.entries.Lcz_TotalUnits}\n              </p>\n              <p class={'m-0 p-0'}>\n                {assigned} <span>{locales.entries.Lcz_Assigned}</span>\n              </p>\n              {un_assigned > 0 && (\n                <button class=\"outline-btn\" onClick={() => (this.currentTrigger = { type: 'unassigned_units', user: null })}>\n                  {un_assigned} {locales.entries.Lcz_Unassigned}\n                </button>\n              )}\n            </div>\n          </ir-title>\n          <p class={'m-0 p-0'}>{locales.entries.Lcz_AsAnOption}</p>\n        </section>\n\n        <section class=\"mt-1 table-responsive\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th class=\"text-left\">{locales.entries.Lcz_Name}</th>\n                <th>{locales.entries.Lcz_Mobile}</th>\n                <th>{locales.entries.Lcz_Username}</th>\n                {/* <th>{locales.entries.Lcz_Note}</th> */}\n                <th>{locales.entries.Lcz_UnitsAssigned}</th>\n                <th class=\"text-center\">\n                  <ir-icon\n                    data-testid=\"new_user\"\n                    title={locales.entries.Lcz_CreateHousekeeper}\n                    onIconClickHandler={() => {\n                      this.currentTrigger = {\n                        type: 'user',\n                        isEdit: false,\n                        user: null,\n                      };\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"17.5\" viewBox=\"0 0 448 512\">\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z\"\n                      />\n                    </svg>\n                  </ir-icon>\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              {housekeeping_store.hk_criteria.housekeepers.map(hk => (\n                <tr key={hk.id}>\n                  <td class=\"text-left\">\n                    <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                      {hk.name?.length > 25 ? (\n                        <ir-popover trigger=\"hover\" content={hk.name}>\n                          <span>{hk.name.slice(0, 25)}...</span>\n                        </ir-popover>\n                      ) : (\n                        hk.name\n                      )}\n                      {hk.note && (\n                        <ir-popover content={hk.note}>\n                          <ir-button variant=\"icon\" icon_name=\"note\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Click to view note\"></ir-button>\n                        </ir-popover>\n                      )}\n                    </div>\n                  </td>\n                  <td>\n                    {hk.phone_prefix} {hk.mobile}\n                  </td>\n                  <td>{hk.username}</td>\n                  <td>{this.renderAssignedUnits(hk)}</td>\n                  <td class=\"text-center\">\n                    <div class=\"icons-container\">\n                      <ir-icon\n                        data-testid=\"edit\"\n                        title={locales.entries.Lcz_EditHousekeeper}\n                        onIconClickHandler={() => {\n                          const { assigned_units, is_soft_deleted, is_active, ...user } = hk;\n                          this.currentTrigger = {\n                            type: 'user',\n                            isEdit: true,\n                            user,\n                          };\n                        }}\n                        icon=\"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right\"\n                      >\n                        <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"20\" viewBox=\"0 0 512 512\">\n                          <path\n                            fill=\"#6b6f82\"\n                            d=\"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z\"\n                          />\n                        </svg>\n                      </ir-icon>\n                      <span> &nbsp;</span>\n                      <ir-icon\n                        data-testid=\"delete\"\n                        title={locales.entries.Lcz_DeleteHousekeeper}\n                        icon=\"ft-trash-2 danger h5 pointer\"\n                        onIconClickHandler={() => this.handleDeletion(hk)}\n                      >\n                        <svg slot=\"icon\" fill=\"#ff2441\" xmlns=\"http://www.w3.org/2000/svg\" height=\"16\" width=\"14.25\" viewBox=\"0 0 448 512\">\n                          <path d=\"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z\" />\n                        </svg>\n                      </ir-icon>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </section>\n        <ir-sidebar\n          showCloseButton={false}\n          open={this.currentTrigger !== null && this.currentTrigger.type !== 'delete'}\n          onIrSidebarToggle={() => (this.currentTrigger = null)}\n          style={{\n            '--sidebar-width': this.currentTrigger ? (this.currentTrigger.type === 'unassigned_units' ? 'max-content' : '40rem') : 'max-content',\n          }}\n        >\n          {this.renderCurrentTrigger()}\n        </ir-sidebar>\n        {this.currentTrigger?.type === 'delete' && <ir-delete-modal user={this.currentTrigger.user}></ir-delete-modal>}\n      </Host>\n    );\n  }\n}\n"]}