{"version":3,"file":"igl-book-property.service.js","sourceRoot":"","sources":["../../../../src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport { TSourceOption } from '@/models/igl-book-property';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class IglBookPropertyService {\n  private variationService: VariationService;\n  public setBookingInfoFromAutoComplete(context, res) {\n    context.bookedByInfoData = {\n      id: res.guest.id,\n      email: res.guest.email,\n      firstName: res.guest.first_name,\n      lastName: res.guest.last_name,\n      countryId: res.guest.country_id,\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\n      contactNumber: res.guest.mobile,\n      selectedArrivalTime: res.arrival,\n      emailGuest: res.guest.subscribe_to_news_letter,\n      message: res.remark,\n      cardNumber: '',\n      cardHolderName: '',\n      expiryMonth: '',\n      expiryYear: '',\n      bookingNumber: res.booking_nbr,\n      rooms: res.rooms,\n      from_date: res.from_date,\n      to_date: res.to_date,\n    };\n  }\n\n  public resetRoomsInfoAndMessage(context) {\n    context.defaultData.roomsInfo = [];\n    context.message = '';\n  }\n\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\n    let units = selectedUnits;\n    const { data, key, changedKey } = event.detail;\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\n    const ratePlanKey = `p_${data.ratePlanId}`;\n\n    if (this.shouldClearData(key)) {\n      units = new Map();\n    }\n\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\n\n    if (isEditBooking) {\n      if (changedKey === 'rate') {\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n        }\n      } else {\n        if (changedKey !== 'rateType') {\n          if (changedKey === 'adult_child_offering') {\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n            }\n          } else {\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n          }\n        }\n      }\n    } else {\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\n    }\n    this.cleanupEmptyData(roomCategoryKey, units);\n    return units;\n  }\n\n  private shouldClearData(key: string | undefined): boolean {\n    return key === 'clearData' || key === 'EDIT_BOOKING';\n  }\n\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (!selectedUnits.has(roomCategoryKey)) {\n      selectedUnits.set(roomCategoryKey, new Map());\n    }\n  }\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n    if (data.totalRooms === 0 || data.inventory === 0) {\n      selectedRatePlans.delete(ratePlanKey);\n    } else {\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\n    }\n  }\n\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (selectedUnits.has(roomCategoryKey)) {\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n      if (selectedRatePlans.size === 0) {\n        selectedUnits.delete(roomCategoryKey);\n      }\n    }\n  }\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\n    selectedUnits.clear();\n    let res = {};\n    if (isEdit) {\n      res = { ...data, guestName: name || '', roomId: '' };\n    } else {\n      res = { ...data };\n    }\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\n  }\n\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  // private extractFirstNameAndLastName(name: string) {\n  //   const names = name.split(' ');\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\n  // }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Date;\n    check_out: Date;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: rateplan.selected_variation.child_nbr - Math.max(rateplan.guest[i].infant_nbr, 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n\n  async prepareBookUserServiceParams({ context, sourceOption, check_in }: { context: any; sourceOption: TSourceOption; check_in: boolean }) {\n    try {\n      // Validate context structure\n      if (!context || !context.dateRangeData) {\n        throw new Error('Invalid context: Missing date range data.');\n      }\n\n      const fromDate = new Date(context.dateRangeData.fromDate);\n      const toDate = new Date(context.dateRangeData.toDate);\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n\n      switch (context.defaultData.event_type) {\n        case 'EDIT_BOOKING': {\n          const { booking, currentRoomType } = context.defaultData;\n\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\n          console.log('currentRoomType', currentRoomType);\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const { booking } = context.defaultData;\n          if (!booking) {\n            throw new Error('Missing booking');\n          }\n          console.log(booking);\n          const newRooms = generateNewRooms();\n          newBooking = modifyBookingDetails(booking, [...booking?.rooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByInfoData } = context;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras,\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            booking: {\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByInfoData.message || null,\n              booking_nbr: '',\n              property: {\n                id: context.propertyid,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: context.currency,\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\n              guest: {\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\n                first_name: bookedByInfoData.firstName,\n                last_name: bookedByInfoData.lastName,\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\n                city: null,\n                mobile: bookedByInfoData.contactNumber === null ? '' : bookedByInfoData.contactNumber,\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\n                address: '',\n                dob: null,\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\n                cci: bookedByInfoData.cardNumber\n                  ? {\n                      nbr: bookedByInfoData.cardNumber,\n                      holder_name: bookedByInfoData.cardHolderName,\n                      expiry_month: bookedByInfoData.expiryMonth,\n                      expiry_year: bookedByInfoData.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private getRoomCategoryByRoomId(bookingData) {\n    return bookingData.roomsInfo?.find(roomCategory => {\n      return roomCategory.id === bookingData.RATE_TYPE;\n    });\n  }\n  public setEditingRoomInfo(bookingData, selectedUnits) {\n    const category = this.getRoomCategoryByRoomId(bookingData);\n    const room_id = !category ? '' : `c_${category?.id}`;\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\n    const data = {\n      adultCount: bookingData.ADULTS_COUNT,\n      rate: bookingData.RATE,\n      rateType: bookingData.RATE_TYPE,\n      ratePlanId: bookingData.RATE_PLAN_ID,\n      roomCategoryId: category ? category.id : '',\n      roomCategoryName: category ? category.name : '',\n      totalRooms: 1,\n      ratePlanName: bookingData.RATE_PLAN,\n      roomId: bookingData.PR_ID,\n      guestName: bookingData.NAME,\n      cancelation: bookingData.cancelation,\n      guarantee: bookingData.guarantee,\n      adult_child_offering: bookingData.adult_child_offering,\n    };\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\n  }\n}\n"]}