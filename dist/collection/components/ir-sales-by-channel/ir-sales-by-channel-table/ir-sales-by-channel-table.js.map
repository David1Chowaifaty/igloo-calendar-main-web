{"version":3,"file":"ir-sales-by-channel-table.js","sourceRoot":"","sources":["../../../../src/components/ir-sales-by-channel/ir-sales-by-channel-table/ir-sales-by-channel-table.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AAEjE,OAAO,EAAE,YAAY,EAAE,MAAM,eAAe,CAAC;AAQ7C,MAAM,OAAO,qBAAqB;IACxB,OAAO,CAAsB;IAC7B,iBAAiB,CAAoB;IACrC,IAAI,CAAqB;IACxB,YAAY,GAAW,EAAE,CAAC;IAC1B,UAAU,GAAwB,IAAI,GAAG,EAAE,CAAC;IAErD,iBAAiB;QACf,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAGD,sBAAsB;QACpB,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IACO,eAAe;QACrB,MAAM,GAAG,GAAwB,IAAI,GAAG,EAAE,CAAC;QAC3C,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;YAC9C,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;QACtC,CAAC;QACD,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;IACjC,CAAC;IAEO,cAAc,GAAG,GAAG,EAAE;QAC5B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;IAC5E,CAAC,CAAC;IACF,MAAM;QACJ,MAAM,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAChE,MAAM,gBAAgB,GAAG,IAAI,CAAC,IAAI,KAAK,UAAU,CAAC;QAElD,OAAO,CACL,4DAAK,KAAK,EAAC,qDAAqD;YAC9D,8DAAO,KAAK,EAAC,OAAO,iBAAa,gBAAgB;gBAC/C,8DAAO,KAAK,EAAC,cAAc;oBACzB;wBACE,2DAAI,KAAK,EAAC,WAAW,cAAa;wBAClC,2DAAI,KAAK,EAAC,aAAa,kBAAiB;wBACxC,2DAAI,KAAK,EAAC,YAAY,mBAAkB;wBACxC,2DAAI,KAAK,EAAE,wCAAwC,CAAC,gBAAgB,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,GAAO,CAC1F,CACC;gBAER;oBACG,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAC5B;wBACE,2DAAI,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,qBAErC,CACF,CACN;oBACA,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;wBAC3B,MAAM,cAAc,GAAG,GAAG,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC;wBAC1E,MAAM,mBAAmB,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;wBAEnH,OAAO,CACL,yBAAiB,YAAY,EAAE,KAAK,EAAE,EAAE,6BAA6B,EAAE,IAAI,EAAE;4BAC3E,UAAI,KAAK,EAAC,WAAW;gCACnB,WAAK,KAAK,EAAC,oBAAoB,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE;oCACvD,SAAG,KAAK,EAAE,WAAW,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE,IAAG,MAAM,CAAC,MAAM,CAAK;oCAC7F,MAAM,CAAC,SAAS,EAAE,MAAM,IAAI,CAC3B,SAAG,KAAK,EAAC,UAAU,EAAC,KAAK,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG,EAAE,IACnE,MAAM,CAAC,SAAS,CAAC,MAAM,CACtB,CACL,CACG,CACH;4BACL,UAAI,KAAK,EAAC,aAAa;gCACrB,WAAK,KAAK,EAAC,oBAAoB,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE;oCACvD,SAAG,KAAK,EAAE,WAAW,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE,IAAG,MAAM,CAAC,MAAM,CAAK;oCAC7F,MAAM,CAAC,SAAS,EAAE,MAAM,IAAI,CAC3B,SAAG,KAAK,EAAC,UAAU,EAAC,KAAK,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG,EAAE,IACnE,MAAM,CAAC,SAAS,CAAC,MAAM,CACtB,CACL,CACG,CACH;4BACL,UAAI,KAAK,EAAC,aAAa;gCACrB,WAAK,KAAK,EAAC,oBAAoB,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE;oCACvD,SAAG,KAAK,EAAE,WAAW,MAAM,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE,IAAG,YAAY,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,CAAC,CAAK;oCAC9H,MAAM,CAAC,SAAS,EAAE,OAAO,IAAI,CAC5B,SAAG,KAAK,EAAC,UAAU,EAAC,KAAK,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG,EAAE,IACnE,YAAY,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CACtD,CACL,CACG,CACH;4BACL,UAAI,KAAK,EAAE,wCAAwC,CAAC,gBAAgB,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,IACnF,gBAAgB,IAAI,CACnB,WAAK,KAAK,EAAC,oBAAoB,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE;gCACtD,6BAAuB,UAAU,EAAE,cAAc,GAA0B;gCAC1E,MAAM,CAAC,SAAS,EAAE,GAAG,IAAI,6BAAuB,UAAU,EAAE,mBAAmB,EAAE,KAAK,EAAC,WAAW,GAAyB,CACxH,CACP,CACE,CACF,CACN,CAAC;oBACJ,CAAC,CAAC,CACI;gBACP,gBAAgB,IAAI,CACnB;oBACE,2DAAI,KAAK,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE;wBAC7B,2DAAI,OAAO,EAAE,CAAC;4BACZ,4DAAK,KAAK,EAAE,+CAA+C,EAAE,KAAK,EAAE,EAAE,GAAG,EAAE,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE;gCACvG,4DAAK,KAAK,EAAC,2BAA2B,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE;oCAC7D,4DAAK,KAAK,EAAC,mBAAmB,GAAO;oCACrC,0DAAG,KAAK,EAAC,SAAS,uBAAqB,CACnC;gCACN,4DAAK,KAAK,EAAC,2BAA2B,EAAC,KAAK,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE;oCAC7D,4DAAK,KAAK,EAAC,kBAAkB,GAAO;oCACpC,0DAAG,KAAK,EAAC,SAAS,oBAAkB,CAChC,CACF,CACH,CACF,CACC,CACT,CACK;YACP,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,CAC1C,4DAAK,KAAK,EAAE,gBAAgB;gBAC1B,kEAAW,KAAK,EAAC,SAAS,EAAC,IAAI,EAAC,IAAI,EAAC,IAAI,EAAC,WAAW,EAAC,cAAc,EAAE,IAAI,CAAC,cAAc,GAAc,CACnG,CACP,CACG,CACP,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Prop, State, Watch, h } from '@stencil/core';\nimport { ChannelReportResult, SalesByChannelMode } from '../types';\nimport { formatAmount } from '@/utils/utils';\nimport { AllowedProperties } from '@/services/property.service';\n\n@Component({\n  tag: 'ir-sales-by-channel-table',\n  styleUrls: ['ir-sales-by-channel-table.css', '../../../common/table.css'],\n  scoped: true,\n})\nexport class IrSalesByChannelTable {\n  @Prop() records: ChannelReportResult;\n  @Prop() allowedProperties: AllowedProperties;\n  @Prop() mode: SalesByChannelMode;\n  @State() visibleCount: number = 10;\n  @State() properties: Map<number, string> = new Map();\n\n  componentWillLoad() {\n    this.setupProperties();\n  }\n\n  @Watch('allowedProperties')\n  handlePropertiesChange() {\n    this.setupProperties();\n  }\n  private setupProperties() {\n    const map: Map<number, string> = new Map();\n    for (const property of this.allowedProperties) {\n      map.set(property.id, property.name);\n    }\n    this.properties = new Map(map);\n  }\n\n  private handleLoadMore = () => {\n    this.visibleCount = Math.min(this.visibleCount + 10, this.records.length);\n  };\n  render() {\n    const visibleRecords = this.records.slice(0, this.visibleCount);\n    const isSingleProperty = this.mode === 'property';\n\n    return (\n      <div class=\"table-container h-100 p-1 m-0 mb-2 table-responsive\">\n        <table class=\"table\" data-testid=\"hk_tasks_table\">\n          <thead class=\"table-header\">\n            <tr>\n              <th class=\"text-left\">Channel</th>\n              <th class=\"text-center\">Room nights</th>\n              <th class=\"text-right\">Room Revenue</th>\n              <th class={`sales-by-channel-table__progress-col ${!isSingleProperty ? 'single' : ''}`}></th>\n            </tr>\n          </thead>\n\n          <tbody>\n            {this.records.length === 0 && (\n              <tr>\n                <td colSpan={5} style={{ height: '300px' }}>\n                  No data found.\n                </td>\n              </tr>\n            )}\n            {visibleRecords.map(record => {\n              const mainPercentage = `${parseFloat(record.PCT.toString()).toFixed(2)}%`;\n              const secondaryPercentage = record.last_year ? `${parseFloat(record.last_year.PCT.toString()).toFixed(2)}%` : null;\n\n              return (\n                <tr data-testid={`record_row`} class={{ 'task-table-row ir-table-row': true }}>\n                  <td class=\"text-left\">\n                    <div class=\"d-flex flex-column\" style={{ gap: '0.25rem' }}>\n                      <p class={`p-0 m-0 ${record.last_year?.SOURCE ? 'font-weight-bold' : ''}`}>{record.SOURCE}</p>\n                      {record.last_year?.SOURCE && (\n                        <p class=\"p-0 mx-0\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                          {record.last_year.SOURCE}\n                        </p>\n                      )}\n                    </div>\n                  </td>\n                  <td class=\"text-center\">\n                    <div class=\"d-flex flex-column\" style={{ gap: '0.25rem' }}>\n                      <p class={`p-0 m-0 ${record.last_year?.NIGHTS ? 'font-weight-bold' : ''}`}>{record.NIGHTS}</p>\n                      {record.last_year?.NIGHTS && (\n                        <p class=\"p-0 mx-0\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                          {record.last_year.NIGHTS}\n                        </p>\n                      )}\n                    </div>\n                  </td>\n                  <td class=\"text-right \">\n                    <div class=\"d-flex flex-column\" style={{ gap: '0.25rem' }}>\n                      <p class={`p-0 m-0 ${record.last_year?.REVENUE ? 'font-weight-bold' : ''}`}>{formatAmount(record.currency, record.REVENUE)}</p>\n                      {record.last_year?.REVENUE && (\n                        <p class=\"p-0 mx-0\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                          {formatAmount(record.currency, record.last_year.REVENUE)}\n                        </p>\n                      )}\n                    </div>\n                  </td>\n                  <td class={`sales-by-channel-table__progress-col ${!isSingleProperty ? 'single' : ''}`}>\n                    {isSingleProperty && (\n                      <div class=\"d-flex flex-column\" style={{ gap: '0.5rem' }}>\n                        <ir-progress-indicator percentage={mainPercentage}></ir-progress-indicator>\n                        {record.last_year?.PCT && <ir-progress-indicator percentage={secondaryPercentage} color=\"secondary\"></ir-progress-indicator>}\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n          {isSingleProperty && (\n            <tfoot>\n              <tr style={{ fontSize: '12px' }}>\n                <td colSpan={4}>\n                  <div class={'d-flex align-items-center justify-content-end'} style={{ gap: '1rem', paddingTop: '0.5rem' }}>\n                    <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                      <div class=\"legend bg-primary\"></div>\n                      <p class=\"p-0 m-0\">Selected period </p>\n                    </div>\n                    <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                      <div class=\"legend secondary\"></div>\n                      <p class=\"p-0 m-0\">Previous year</p>\n                    </div>\n                  </div>\n                </td>\n              </tr>\n            </tfoot>\n          )}\n        </table>\n        {this.visibleCount < this.records.length && (\n          <div class={'d-flex mx-auto'}>\n            <ir-button class=\"mx-auto\" size=\"sm\" text=\"Load More\" onClickHandler={this.handleLoadMore}></ir-button>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n"]}