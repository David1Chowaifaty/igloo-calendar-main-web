{"version":3,"file":"ir-validator.js","sourceRoot":"","sources":["../../../../src/components/ui/ir-validator/ir-validator.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport type { ZodTypeAny } from 'zod';\n\ntype ValidatableChild = (HTMLElement | HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement) & {\n  value?: unknown;\n};\n\n@Component({\n  tag: 'ir-validator',\n  styleUrl: 'ir-validator.css',\n  shadow: true,\n})\nexport class IrValidator {\n  @Element() el: HTMLIrValidatorElement;\n\n  /** Zod schema used to validate the child control's value. */\n  @Prop() schema!: ZodTypeAny;\n  @Prop() value: any;\n\n  /** Enables automatic validation on every value change. */\n  @Prop({ reflect: true }) autovalidate?: boolean;\n\n  /** Optional form id. Falls back to the closest ancestor form when omitted. */\n  @Prop() form?: string;\n\n  /** Event names (space/comma separated) dispatched when the child value changes. */\n  @Prop({ attribute: 'value-event' }) valueEvent: string = 'input input-change value-change select-change';\n\n  /** Event names (space/comma separated) dispatched when the child loses focus. */\n  @Prop({ attribute: 'blur-event' }) blurEvent: string = 'blur input-blur select-blur';\n\n  /** Debounce delay (ms) before running validation for autovalidated changes. */\n  @Prop({ attribute: 'validation-debounce' }) validationDebounce: number = 200;\n\n  /** Emits whenever the validation state toggles. */\n  @Event({ eventName: 'irValidationChange' }) validationChange!: EventEmitter<{ valid: boolean; value: unknown }>;\n\n  /** Emits whenever the tracked value changes. */\n  @Event({ eventName: 'irValueChange' }) valueChange!: EventEmitter<{ value: unknown }>;\n\n  @State() private isValid = true;\n  @State() private autoValidateActive = false;\n\n  private childEl?: ValidatableChild;\n  private formEl?: HTMLFormElement | null;\n  private slotEl?: HTMLSlotElement;\n  private currentValue: unknown;\n  private hasInteracted = false;\n  private validationTimer?: ReturnType<typeof setTimeout>;\n  private valueEventsBound: string[] = [];\n  private blurEventsBound: string[] = [];\n\n  componentWillLoad() {\n    if (!this.schema) {\n      throw new Error('<ir-validator> requires a `schema` prop.');\n    }\n    this.syncAutovalidateFlag(this.autovalidate);\n  }\n\n  componentDidLoad() {\n    this.slotEl = this.el.shadowRoot?.querySelector('slot') as HTMLSlotElement;\n    this.slotEl?.addEventListener('slotchange', this.handleSlotChange);\n    this.initializeChildReference();\n    this.attachFormListener();\n  }\n\n  disconnectedCallback() {\n    this.teardownChildListeners();\n    this.detachFormListener();\n    this.slotEl?.removeEventListener('slotchange', this.handleSlotChange);\n    this.clearValidationTimer();\n  }\n\n  @Watch('schema')\n  protected handleSchemaChange() {\n    if (this.autoValidateActive && this.hasInteracted) {\n      this.flushValidation();\n    }\n  }\n\n  @Watch('autovalidate')\n  protected handleAutoValidatePropChange(next?: boolean) {\n    this.syncAutovalidateFlag(next);\n    if (this.autoValidateActive) {\n      this.flushValidation();\n    }\n  }\n\n  @Watch('form')\n  protected handleFormPropChange() {\n    this.detachFormListener();\n    this.attachFormListener();\n  }\n\n  @Watch('valueEvent')\n  protected handleValueEventChange(newValue: string, oldValue: string) {\n    if (newValue === oldValue) return;\n    this.rebindChildListeners();\n  }\n\n  @Watch('blurEvent')\n  protected handleBlurEventChange(newValue: string, oldValue: string) {\n    if (newValue === oldValue) return;\n    this.rebindChildListeners();\n  }\n\n  private syncAutovalidateFlag(next?: boolean) {\n    this.autoValidateActive = Boolean(next);\n  }\n\n  private parseEvents(spec?: string) {\n    if (!spec) return [];\n    return spec\n      .split(/[\\s,]+/)\n      .map(token => token.trim())\n      .filter(Boolean);\n  }\n\n  @Watch('value')\n  protected handleValuePropChange(next: unknown, previous: unknown) {\n    if (Object.is(next, previous)) return;\n    // keep the tracked value in sync with external changes without emitting another change event\n    this.updateValue(next, { suppressValidation: true, emitChange: false });\n    if (this.autoValidateActive && this.hasInteracted) {\n      this.flushValidation();\n    }\n  }\n\n  private handleSlotChange = () => {\n    this.initializeChildReference();\n  };\n\n  private initializeChildReference() {\n    const child = this.pickSingleChild();\n    if (child === this.childEl) return;\n\n    this.teardownChildListeners();\n    if (!child) return;\n\n    this.childEl = child;\n    this.hasInteracted = false;\n    this.registerChildListeners();\n\n    const initialValue = this.readValueFromChild();\n    this.updateValue(initialValue, { suppressValidation: !this.autoValidateActive, emitChange: true });\n    if (!this.autoValidateActive) {\n      this.updateAriaValidity(this.isValid);\n    }\n  }\n\n  private pickSingleChild(): ValidatableChild | undefined {\n    const slotChildren = this.slotEl?.assignedElements({ flatten: true }) ?? Array.from(this.el.children);\n    const elements = slotChildren.filter(node => node.nodeType === Node.ELEMENT_NODE) as ValidatableChild[];\n\n    if (elements.length === 0) {\n      console.warn('<ir-validator> requires exactly one child element but found none.');\n      return undefined;\n    }\n\n    if (elements.length > 1) {\n      console.warn(`<ir-validator> requires exactly one child element but found ${elements.length}. Using the first.`);\n    }\n\n    return elements[0];\n  }\n\n  private registerChildListeners() {\n    if (!this.childEl) return;\n\n    this.unbindChildListeners();\n\n    this.valueEventsBound = this.parseEvents(this.valueEvent);\n    this.blurEventsBound = this.parseEvents(this.blurEvent);\n\n    this.valueEventsBound.forEach(eventName => this.childEl!.addEventListener(eventName, this.handleValueEvent as EventListener));\n    this.blurEventsBound.forEach(eventName => this.childEl!.addEventListener(eventName, this.handleBlurEvent as EventListener));\n  }\n\n  private unbindChildListeners() {\n    if (!this.childEl) return;\n    this.valueEventsBound.forEach(eventName => this.childEl!.removeEventListener(eventName, this.handleValueEvent as EventListener));\n    this.blurEventsBound.forEach(eventName => this.childEl!.removeEventListener(eventName, this.handleBlurEvent as EventListener));\n    this.valueEventsBound = [];\n    this.blurEventsBound = [];\n  }\n\n  private teardownChildListeners() {\n    if (this.childEl) {\n      this.unbindChildListeners();\n      this.childEl = undefined;\n    }\n    this.clearValidationTimer();\n  }\n\n  private rebindChildListeners() {\n    if (!this.childEl) return;\n    this.registerChildListeners();\n  }\n\n  private handleValueEvent = (event: Event) => {\n    if (!this.childEl) return;\n    const nextValue = this.extractEventValue(event);\n    this.hasInteracted = true;\n    this.updateValue(nextValue);\n  };\n\n  private handleBlurEvent = () => {\n    if (!this.childEl) return;\n    this.hasInteracted = true;\n    if (this.autoValidateActive) {\n      this.flushValidation();\n    }\n  };\n\n  private extractEventValue(event: Event) {\n    if ('detail' in event && event['detail'] && typeof event['detail'] === 'object' && 'value' in (event as CustomEvent).detail) {\n      return (event as CustomEvent<{ value: unknown }>).detail.value;\n    }\n\n    const target = event.target as ValidatableChild;\n    if (target && 'value' in target) {\n      return target.value;\n    }\n\n    return this.readValueFromChild();\n  }\n\n  private readValueFromChild() {\n    if (this.value !== undefined) {\n      return this.value;\n    }\n    if (!this.childEl) return undefined;\n    if ('value' in this.childEl) {\n      return this.childEl.value;\n    }\n    return this.childEl.getAttribute?.('value');\n  }\n\n  private updateValue(nextValue: unknown, options: { suppressValidation?: boolean; emitChange?: boolean } = {}) {\n    const previous = this.currentValue;\n    this.currentValue = nextValue;\n\n    if (options.emitChange !== false && !Object.is(previous, nextValue)) {\n      this.valueChange.emit({ value: this.currentValue });\n    }\n\n    if (!options.suppressValidation && this.autoValidateActive && this.hasInteracted) {\n      this.scheduleValidation();\n    }\n  }\n\n  private validateCurrentValue(forceDisplay = false) {\n    if (!this.schema) return true;\n    const value = this.currentValue ?? this.readValueFromChild();\n    this.currentValue = value;\n    const result = this.schema.safeParse(value);\n    const nextValidity = result.success;\n    const previousValidity = this.isValid;\n    this.isValid = nextValidity;\n\n    const shouldDisplay = forceDisplay || (this.autoValidateActive && this.hasInteracted);\n    if (shouldDisplay) {\n      this.updateAriaValidity(nextValidity);\n      if (previousValidity !== nextValidity) {\n        this.emitValidationChange();\n      }\n    }\n\n    return nextValidity;\n  }\n\n  private updateAriaValidity(valid: boolean) {\n    if (!this.childEl) return;\n    if (valid) {\n      this.childEl.removeAttribute('aria-invalid');\n    } else {\n      this.childEl.setAttribute('aria-invalid', 'true');\n    }\n  }\n\n  private emitValidationChange() {\n    this.validationChange.emit({ valid: this.isValid, value: this.currentValue });\n  }\n\n  private attachFormListener() {\n    this.formEl = this.resolveFormRef();\n    this.formEl?.addEventListener('submit', this.handleFormSubmit, true);\n  }\n\n  private detachFormListener() {\n    this.formEl?.removeEventListener('submit', this.handleFormSubmit, true);\n    this.formEl = undefined;\n  }\n\n  private resolveFormRef(): HTMLFormElement | null {\n    if (typeof document !== 'undefined' && this.form) {\n      const provided = document.getElementById(this.form);\n      if (provided && provided instanceof HTMLFormElement) {\n        return provided;\n      }\n    }\n    return this.el.closest('form');\n  }\n\n  private handleFormSubmit = () => {\n    this.hasInteracted = true;\n    const valid = this.flushValidation();\n    if (!valid && !this.autoValidateActive) {\n      this.autoValidateActive = true;\n    }\n  };\n\n  private scheduleValidation(immediate = false) {\n    this.clearValidationTimer();\n    const delay = Number(this.validationDebounce);\n    if (immediate || !isFinite(delay) || delay <= 0) {\n      return this.validateCurrentValue(true);\n    }\n\n    this.validationTimer = setTimeout(() => {\n      this.validationTimer = undefined;\n      this.validateCurrentValue(true);\n    }, delay);\n\n    return this.isValid;\n  }\n\n  private flushValidation() {\n    return this.scheduleValidation(true);\n  }\n\n  private clearValidationTimer() {\n    if (this.validationTimer !== undefined) {\n      clearTimeout(this.validationTimer);\n      this.validationTimer = undefined;\n    }\n  }\n\n  render() {\n    return (\n      <Host>\n        <slot></slot>\n      </Host>\n    );\n  }\n}\n"]}