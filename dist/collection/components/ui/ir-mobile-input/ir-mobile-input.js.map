{"version":3,"file":"ir-mobile-input.js","sourceRoot":"","sources":["../../../../src/components/ui/ir-mobile-input/ir-mobile-input.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport IMask, { FactoryArg, InputMask } from 'imask';\nimport { masks } from './countries_masks';\nimport { ICountry } from '@/models/IBooking';\nimport { NativeWaInput } from '../ir-custom-input/ir-custom-input';\n\nexport interface IrMobileInputChangeDetail {\n  country: ICountry;\n  value: string;\n  formattedValue: string;\n}\n\n@Component({\n  tag: 'ir-mobile-input',\n  styleUrls: ['ir-mobile-input.css'],\n  shadow: true,\n})\nexport class IrMobileInput {\n  private static idCounter = 0;\n  private readonly componentId = ++IrMobileInput.idCounter;\n  private readonly inputId = `ir-mobile-input-${this.componentId}`;\n  private readonly labelId = `${this.inputId}-label`;\n  private readonly descriptionId = `${this.inputId}-description`;\n  private readonly errorId = `${this.inputId}-error`;\n  private readonly countryStatusId = `${this.inputId}-country-status`;\n\n  private inputRef?: HTMLInputElement;\n  private mask?: InputMask<any>;\n\n  /** The input's size. */\n  @Prop({ reflect: true }) size: NativeWaInput['size'] = 'small';\n  /** Visible label for the phone input */\n  @Prop() label: string = 'Phone number';\n  /** Name attribute passed to the native input */\n  @Prop() name: string = 'phone';\n  /** Placeholder shown when the input is empty */\n  @Prop() placeholder: string = 'Enter phone number';\n  /** Help text rendered under the label */\n  @Prop() description?: string;\n  /** Error message announced to screen readers */\n  @Prop() error?: string;\n  /** Native required attribute */\n  @Prop({ reflect: true }) required: boolean = false;\n  /** Whether the control is disabled */\n  @Prop({ reflect: true }) disabled: boolean = false;\n  /** Selected country ISO code. Component updates this prop when a new country is chosen */\n  @Prop({ mutable: true, reflect: true }) countryCode?: string;\n  /** Input value without formatting. Component keeps this prop in sync */\n  @Prop({ mutable: true, reflect: true }) value: string = '';\n  /**\n   * Country list, used to populate prefix and dropdown.\n   * If not provided, fetched from the booking service.\n   */\n  @Prop({ mutable: true }) countries: ICountry[] = [];\n\n  @Event({ eventName: 'mobile-input-change' }) mobileInputChange!: EventEmitter<IrMobileInputChangeDetail>;\n  @Event({ eventName: 'mobile-input-country-change' }) mobileInputCountryChange!: EventEmitter<ICountry>;\n\n  @State() selectedCountry?: ICountry;\n  @State() displayValue: string = '';\n\n  componentWillLoad() {\n    const resolvedCountry: ICountry | null = this.resolveCountry(this.countryCode) ?? null;\n    if (!resolvedCountry) {\n      return;\n    }\n    this.selectedCountry = resolvedCountry;\n    this.countryCode = resolvedCountry?.code;\n    this.displayValue = this.value ?? '';\n  }\n\n  componentDidLoad() {\n    requestAnimationFrame(() => this.initializeMask());\n  }\n\n  disconnectedCallback() {\n    this.destroyMask();\n  }\n\n  @Watch('countryCode')\n  protected handleCountryCodeChange(nextCode?: string) {\n    const resolvedCountry = this.resolveCountry(nextCode);\n    if (resolvedCountry && resolvedCountry !== this.selectedCountry) {\n      this.selectedCountry = resolvedCountry;\n    }\n  }\n\n  @Watch('selectedCountry')\n  protected handleSelectedCountryChange(next?: ICountry, previous?: ICountry) {\n    if (!next) return;\n    if (!previous || next.code !== previous.code) {\n      if (this.countryCode !== next.code) {\n        this.countryCode = next.code;\n      }\n      this.rebuildMask();\n      this.mobileInputCountryChange.emit(next);\n    }\n  }\n\n  @Watch('value')\n  protected handleValueChange(newValue: string, oldValue: string) {\n    // if (newValue === oldValue) return;\n    // if (this.mask) {\n    //   if (this.mask.unmaskedValue !== (newValue ?? '')) {\n    //     this.mask.unmaskedValue = newValue ?? '';\n    //   }\n    //   this.displayValue = this.mask.value;\n    // } else {\n    //   this.displayValue = newValue ?? '';\n    //   if (this.inputRef && this.inputRef.value !== this.displayValue) {\n    //     this.inputRef.value = this.displayValue;\n    //   }\n    // }\n    if (newValue !== oldValue) {\n      if (this.mask) {\n        this.mask.value = newValue;\n      }\n    }\n  }\n\n  private resolveCountry(code?: string) {\n    if (!code) return undefined;\n    return this.countries.find(country => country.code.toUpperCase() === code.toUpperCase());\n  }\n\n  private initializeMask() {\n    if (!this.inputRef) return;\n    const maskConfig = this.buildMaskOptions(this.selectedCountry);\n    if (!maskConfig) {\n      this.destroyMask();\n      return;\n    }\n    this.mask = IMask(this.inputRef, maskConfig as FactoryArg);\n    if (this.value) {\n      this.mask.unmaskedValue = this.value;\n    }\n    this.displayValue = this.mask.value;\n    this.mask.on('accept', () => {\n      if (!this.mask) return;\n      const nextValue = this.mask.unmaskedValue ?? '';\n      if (nextValue !== this.value) {\n        this.value = nextValue;\n      }\n      this.displayValue = this.mask.value;\n      this.emitChange();\n    });\n  }\n\n  private rebuildMask() {\n    this.destroyMask();\n    this.initializeMask();\n  }\n\n  private destroyMask() {\n    if (this.mask) {\n      this.mask.destroy();\n      this.mask = undefined;\n    }\n    this.displayValue = this.value ?? '';\n  }\n\n  private buildMaskOptions(country?: ICountry) {\n    if (!country) return undefined;\n    const iso = country.code?.toUpperCase();\n    if (!iso) return undefined;\n    const rawMask = masks[iso];\n    if (!rawMask) return undefined;\n\n    const normalizePattern = (pattern: string) => pattern.replace(/#/g, '0');\n\n    if (Array.isArray(rawMask)) {\n      return {\n        mask: rawMask.map(pattern => ({ mask: this.selectedCountry.phone_prefix + ' ' + normalizePattern(pattern) })),\n        lazy: false,\n        placeholderChar: '_',\n      };\n    }\n\n    return {\n      mask: this.selectedCountry.phone_prefix + ' ' + normalizePattern(rawMask),\n      lazy: false,\n      placeholderChar: '_',\n    };\n  }\n\n  private emitChange() {\n    if (!this.selectedCountry) return;\n    this.mobileInputChange.emit({\n      country: this.selectedCountry,\n      value: this.value ?? '',\n      formattedValue: this.displayValue ?? '',\n    });\n  }\n\n  private handleCountrySelect = (event: CustomEvent) => {\n    if (this.disabled) return;\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n    const value = (event.detail as any)?.item?.value;\n    const selected = this.countries.find(country => country.id.toString() === `${value}`);\n    if (selected) {\n      this.selectedCountry = selected;\n    }\n    requestAnimationFrame(() => {\n      this.inputRef?.focus();\n    });\n  };\n\n  private handlePlainInput = (event: Event) => {\n    if (this.mask) return;\n    const nextValue = (event.target as HTMLInputElement)?.value ?? '';\n    if (nextValue !== this.value) {\n      this.value = nextValue;\n      this.displayValue = nextValue;\n      this.emitChange();\n    }\n  };\n\n  render() {\n    const describedByIds = [this.description ? this.descriptionId : null, this.error ? this.errorId : null].filter(Boolean).join(' ') || undefined;\n\n    return (\n      <Host size={'small'} role=\"group\" aria-labelledby={this.labelId} aria-describedby={describedByIds}>\n        <label class=\"mobile-input__label\" id={this.labelId} htmlFor={this.inputId}>\n          {this.label}\n          {this.required ? (\n            <span class=\"mobile-input__required\" aria-hidden=\"true\">\n              *\n            </span>\n          ) : null}\n        </label>\n        {this.description ? (\n          <p id={this.descriptionId} class=\"mobile-input__description\">\n            {this.description}\n          </p>\n        ) : null}\n        <div class={{ 'mobile-input__container': true, 'mobile-input__container--disabled': this.disabled }}>\n          <wa-dropdown\n            onwa-show={e => {\n              e.stopPropagation();\n              e.stopImmediatePropagation();\n            }}\n            onwa-hide={e => {\n              e.stopPropagation();\n              e.stopImmediatePropagation();\n            }}\n            onwa-select={this.handleCountrySelect}\n            class=\"mobile-input__prefix-dropdown\"\n          >\n            <button slot=\"trigger\" type=\"button\" class=\"mobile-input__trigger\" disabled={this.disabled} aria-haspopup=\"listbox\" aria-label=\"Change country calling code\">\n              <div class=\"mobile-input__phone-country\" style={{ marginRight: '1rem' }}>\n                {this.selectedCountry ? <img src={this.selectedCountry?.flag} alt={this.selectedCountry?.name} class=\"mobile-input__logo\" /> : <span>Select</span>}\n                {/* <span aria-hidden=\"true\">{this.selectedCountry?.phone_prefix}</span> */}\n              </div>\n              <wa-icon class=\"mobile-input__phone-country-caret\" name=\"chevron-down\" aria-hidden=\"true\"></wa-icon>\n            </button>\n            <span class=\"sr-only\" id={this.countryStatusId} aria-live=\"polite\">\n              {this.selectedCountry ? `Selected country ${this.selectedCountry.name} ${this.selectedCountry.phone_prefix}` : 'Select a country'}\n            </span>\n            {this.countries.map(country => (\n              <wa-dropdown-item value={country.id.toString()}>\n                <div class=\"mobile-input__phone-country\" role=\"option\" aria-selected={this.selectedCountry?.id === country.id ? 'true' : 'false'}>\n                  <img src={country.flag} alt={country.name} class=\"mobile-input__logo\" />\n                  <span class=\"mobile-input__country-name\">{country.name}</span>\n                  <span class=\"mobile-input__country-prefix\">{country.phone_prefix}</span>\n                </div>\n              </wa-dropdown-item>\n            ))}\n          </wa-dropdown>\n          <input\n            ref={el => (this.inputRef = el)}\n            id={this.inputId}\n            class={{\n              'mobile-input__phone': true,\n              'mobile-input__phone--invalid': Boolean(this.error),\n            }}\n            name={this.name}\n            type=\"tel\"\n            inputmode=\"tel\"\n            autocomplete=\"tel\"\n            aria-required={this.required ? 'true' : undefined}\n            aria-invalid={this.error ? 'true' : 'false'}\n            aria-describedby={describedByIds}\n            disabled={this.disabled}\n            placeholder={this.placeholder}\n            value={this.displayValue}\n            onInput={this.handlePlainInput}\n          />\n        </div>\n        {this.error ? (\n          <p id={this.errorId} class=\"mobile-input__error\" role=\"alert\">\n            {this.error}\n          </p>\n        ) : null}\n      </Host>\n    );\n  }\n}\n"]}