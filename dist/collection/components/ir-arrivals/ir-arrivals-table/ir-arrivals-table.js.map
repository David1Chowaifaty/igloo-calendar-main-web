{"version":3,"file":"ir-arrivals-table.js","sourceRoot":"","sources":["../../../../src/components/ir-arrivals/ir-arrivals-table/ir-arrivals-table.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Booking } from '@/models/booking.dto';\nimport { arrivalsStore } from '@/stores/arrivals.store';\nimport { Component, Host, h } from '@stencil/core';\nimport moment from 'moment';\n\n@Component({\n  tag: 'ir-arrivals-table',\n  styleUrls: ['ir-arrivals-table.css', '../../../common/table.css'],\n  scoped: true,\n})\nexport class IrArrivalsTable {\n  private renderSection(bookings: Booking[], showAction = false) {\n    if (!bookings?.length) {\n      return null;\n    }\n\n    const rows = bookings.flatMap(booking => this.renderBookingRows(booking, showAction));\n    return [...rows];\n  }\n\n  private renderBookingRows(booking: Booking, showAction: boolean) {\n    return (booking.rooms ?? []).map((room, index) => this.renderRow(booking, room, index, showAction));\n  }\n\n  private renderRow(booking: Booking, room: Booking['rooms'][number], index: number, showAction: boolean) {\n    const rowKey = `${booking.booking_nbr}-${room?.identifier ?? index}`;\n    const isOverdueCheckIn = moment(room.from_date, 'YYYY-MM-DD').isBefore(moment());\n    return (\n      <tr class=\"ir-table-row\" key={rowKey}>\n        <td class=\"sticky-column\">\n          <ir-booking-number-cell channelBookingNumber={booking.channel_booking_nbr} bookingNumber={booking.booking_nbr}></ir-booking-number-cell>\n        </td>\n        <td>\n          <ir-booked-by-source-cell origin={booking.origin} guest={booking.guest} source={booking.source}></ir-booked-by-source-cell>\n        </td>\n        <td>\n          <ir-guest-name-cell name={room.guest}></ir-guest-name-cell>\n        </td>\n        <td>\n          <ir-unit-cell room={room}></ir-unit-cell>\n        </td>\n        <td>\n          <ir-dates-cell overdueCheckin={isOverdueCheckIn} checkIn={room.from_date} checkOut={room.to_date}></ir-dates-cell>\n        </td>\n        <td class=\"text-right\">\n          <ir-balance-cell\n            bookingNumber={booking.booking_nbr}\n            isDirect={booking.is_direct}\n            statusCode={booking.status.code}\n            currencySymbol={booking.currency.symbol}\n            financial={booking.financial}\n          ></ir-balance-cell>\n        </td>\n        <td>\n          <div class=\"arrivals-table__actions-cell\">\n            {showAction ? <ir-actions-cell buttons={isOverdueCheckIn ? ['overdue_check_in'] : ['check_in']}></ir-actions-cell> : 'In-house'}\n          </div>\n        </td>\n      </tr>\n    );\n  }\n\n  render() {\n    const { needsCheckInBookings, inHouseBookings } = arrivalsStore;\n    return (\n      <Host>\n        <div class=\"table--container\">\n          <table class=\"table data-table\">\n            <thead>\n              <tr>\n                <th>\n                  <span class={'arrivals-table__departure__cell'}>Booking#</span>\n                </th>\n                <th>\n                  <div>\n                    <p>Booked by / Source</p>\n                  </div>\n                </th>\n                <th>Guest name</th>\n                <th>Unit</th>\n                <th>Dates</th>\n                <th class=\"text-right\">Balance</th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.renderSection(needsCheckInBookings, true)}\n              {this.renderSection(inHouseBookings)}\n              {!needsCheckInBookings.length && !inHouseBookings.length && (\n                <tr>\n                  <td colSpan={7} class=\"empty-row\">\n                    No arrivals found.\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n        {/* <div style={{ height: '30px' }}>pagination</div> */}\n      </Host>\n    );\n  }\n}\n"]}