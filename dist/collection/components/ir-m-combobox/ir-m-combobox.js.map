{"version":3,"file":"ir-m-combobox.js","sourceRoot":"","sources":["../../../src/components/ir-m-combobox/ir-m-combobox.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Element, State, Listen, Prop, Event, EventEmitter, Watch, Method } from '@stencil/core';\nimport { v4 } from 'uuid';\n\nexport interface ComboboxOption {\n  value: string;\n  label: string;\n  disabled?: boolean;\n}\n\nexport type ComboboxType = 'select' | 'editable' | 'multiselect';\nexport type DataMode = 'static' | 'external';\n\n@Component({\n  tag: 'ir-m-combobox',\n  styleUrl: 'ir-m-combobox.css',\n  scoped: true,\n})\nexport class IrMCombobox {\n  @Element() el: HTMLElement;\n\n  /**\n   * Placeholder text displayed in the input when no option is selected.\n   */\n  @Prop() placeholder: string;\n\n  /**\n   * Determines how the options are loaded into the component.\n   * - 'static': Uses the options passed through the `options` prop or the default internal list.\n   * - 'external': Emits search events for external handling, options updated via `options` prop.\n   *\n   * @default 'static'\n   */\n  @Prop() dataMode: DataMode = 'static';\n\n  /**\n   * List of available options for the combobox when using static data mode.\n   * If empty, falls back to a default internal option list.\n   */\n  @Prop() options: ComboboxOption[] = [];\n\n  /**\n   * Debounce delay in milliseconds for search events when using external data mode.\n   * @default 300\n   */\n  @Prop() debounceDelay: number = 300;\n\n  /**\n   * Whether to show loading state\n   */\n  @Prop() loading: boolean = false;\n\n  /**\n   * Whether to use slot content for custom dropdown rendering\n   */\n  @Prop() useSlot: boolean = false;\n\n  @State() isOpen: boolean = false;\n  @State() selectedOption: ComboboxOption;\n  @State() focusedIndex: number = -1;\n  @State() filteredOptions: ComboboxOption[] = [];\n  @State() slotElements: HTMLElement[] = [];\n\n  /**\n   * Emitted when a user selects an option from the combobox.\n   * The event payload contains the selected `ComboboxOption` object.\n   */\n  @Event() optionChange: EventEmitter<ComboboxOption>;\n\n  /**\n   * Emitted when the user types in the input field (debounced).\n   * Used for external data fetching in 'external' data mode.\n   */\n  @Event() searchQuery: EventEmitter<string>;\n\n  /**\n   * Public method to select an option from external slot content\n   */\n  @Method()\n  async selectOptionFromSlot(option: ComboboxOption) {\n    this.selectOption(option);\n  }\n\n  private inputRef: HTMLInputElement;\n  private dropdownRef: HTMLElement;\n  private id = v4();\n  private dropdownId = `dropdown-${this.id}`;\n  private debounceTimeout: NodeJS.Timeout;\n\n  @Watch('options')\n  watchOptionsChanged(newOptions: ComboboxOption[]) {\n    this.filteredOptions = newOptions || [];\n    if (this.useSlot) {\n      this.updateSlotElements();\n    }\n  }\n\n  @Watch('useSlot')\n  watchUseSlotChanged() {\n    if (this.useSlot) {\n      setTimeout(() => this.updateSlotElements(), 0);\n    }\n  }\n\n  componentWillLoad() {\n    this.initializeOptions();\n  }\n\n  componentDidLoad() {\n    document.addEventListener('click', this.handleDocumentClick.bind(this));\n    if (this.useSlot) {\n      setTimeout(() => this.updateSlotElements(), 0);\n    }\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('click', this.handleDocumentClick.bind(this));\n    if (this.debounceTimeout) {\n      clearTimeout(this.debounceTimeout);\n    }\n  }\n\n  @Listen('keydown', { target: 'document' })\n  handleDocumentKeyDown(event: KeyboardEvent) {\n    if (!this.isOpen) return;\n\n    if (event.key === 'Escape') {\n      this.closeDropdown();\n      this.inputRef?.focus();\n    }\n  }\n\n  private initializeOptions() {\n    this.filteredOptions = this.options.length > 0 ? this.options : [];\n  }\n\n  private handleDocumentClick = (event: Event) => {\n    if (!this.el.contains(event.target as Node)) {\n      this.closeDropdown();\n    }\n  };\n\n  private openDropdown() {\n    this.isOpen = true;\n    if (this.useSlot) {\n      this.focusedIndex = -1;\n      setTimeout(() => this.updateSlotElements(), 0);\n    } else {\n      this.focusedIndex = this.selectedOption ? this.filteredOptions.findIndex(v => v.value === this.selectedOption.value) : -1;\n    }\n  }\n\n  private emitSearchQuery(query: string) {\n    if (this.debounceTimeout) {\n      clearTimeout(this.debounceTimeout);\n    }\n\n    this.debounceTimeout = setTimeout(() => {\n      this.searchQuery.emit(query);\n    }, this.debounceDelay);\n  }\n\n  private closeDropdown() {\n    this.isOpen = false;\n    this.focusedIndex = -1;\n    this.removeSlotFocus();\n  }\n\n  private updateSlotElements() {\n    if (!this.useSlot || !this.dropdownRef) return;\n\n    const slotElement = this.dropdownRef.querySelector('slot[name=\"dropdown-content\"]');\n    if (slotElement) {\n      const assignedElements = (slotElement as any).assignedElements\n        ? (slotElement as any).assignedElements()\n        : Array.from(this.el.querySelectorAll('[slot=\"dropdown-content\"] [data-option]'));\n\n      this.slotElements = assignedElements.length > 0 ? assignedElements : Array.from(this.dropdownRef.querySelectorAll('[data-option], .dropdown-item[style*=\"cursor\"]'));\n\n      this.slotElements.forEach((element, index) => {\n        element.setAttribute('data-slot-index', index.toString());\n        element.setAttribute('role', 'option');\n        element.setAttribute('tabindex', '-1');\n      });\n    }\n  }\n\n  private removeSlotFocus() {\n    this.slotElements.forEach(element => {\n      element.classList.remove('focused', 'active');\n      element.removeAttribute('aria-selected');\n    });\n  }\n\n  private focusSlotElement(index: number) {\n    this.removeSlotFocus();\n    if (index >= 0 && index < this.slotElements.length) {\n      const element = this.slotElements[index];\n      element.classList.add('focused', 'active');\n      element.setAttribute('aria-selected', 'true');\n      element.scrollIntoView({ block: 'nearest' });\n    }\n  }\n\n  private selectSlotElement(index: number) {\n    if (index >= 0 && index < this.slotElements.length) {\n      const element = this.slotElements[index];\n      element.click();\n    }\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    const maxIndex = this.useSlot ? this.slotElements.length - 1 : this.filteredOptions.length - 1;\n\n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n        } else {\n          this.focusedIndex = Math.min(this.focusedIndex + 1, maxIndex);\n          if (this.useSlot) {\n            this.focusSlotElement(this.focusedIndex);\n          } else {\n            this.scrollToFocusedOption();\n          }\n        }\n        break;\n\n      case 'ArrowUp':\n        event.preventDefault();\n        if (this.isOpen) {\n          this.focusedIndex = Math.max(this.focusedIndex - 1, 0);\n          if (this.useSlot) {\n            this.focusSlotElement(this.focusedIndex);\n          } else {\n            this.scrollToFocusedOption();\n          }\n        }\n        break;\n\n      case 'Enter':\n        event.preventDefault();\n        if (this.isOpen && this.focusedIndex >= 0) {\n          if (this.useSlot) {\n            this.selectSlotElement(this.focusedIndex);\n          } else {\n            this.selectOption(this.filteredOptions[this.focusedIndex]);\n          }\n        } else if (!this.isOpen) {\n          this.openDropdown();\n        }\n        break;\n\n      case 'Escape':\n        event.preventDefault();\n        this.closeDropdown();\n        break;\n\n      case 'Tab':\n        if (this.isOpen) {\n          this.closeDropdown();\n        }\n        break;\n    }\n  };\n\n  private selectOption(option: ComboboxOption) {\n    this.selectedOption = option;\n    this.optionChange.emit(option);\n    this.closeDropdown();\n    this.inputRef.focus();\n  }\n\n  private scrollToFocusedOption() {\n    if (this.focusedIndex < 0 || !this.dropdownRef || this.useSlot) return;\n\n    const focusedElement = this.dropdownRef.querySelector(`#${this.dropdownId}-option-${this.focusedIndex}`) as HTMLElement;\n    if (focusedElement) {\n      focusedElement.scrollIntoView({ block: 'nearest' });\n    }\n  }\n\n  private handleInput = (event: Event) => {\n    const target = event.target as HTMLInputElement;\n    const value = target.value;\n\n    if (this.dataMode === 'external') {\n      this.emitSearchQuery(value);\n    } else {\n      const allOptions = this.options.length > 0 ? this.options : [];\n      this.filteredOptions = value ? allOptions.filter(option => option.label.toLowerCase().includes(value.toLowerCase())) : allOptions;\n    }\n\n    this.focusedIndex = -1;\n    if (!this.isOpen) {\n      this.openDropdown();\n    }\n  };\n\n  render() {\n    return (\n      <Host>\n        <input\n          ref={el => (this.inputRef = el)}\n          type=\"text\"\n          class=\"form-control\"\n          role=\"combobox\"\n          id={this.id}\n          value={this.selectedOption?.label || ''}\n          placeholder={this.placeholder}\n          aria-expanded={String(this.isOpen)}\n          aria-autocomplete=\"list\"\n          aria-controls={this.dropdownId}\n          data-reference=\"parent\"\n          aria-haspopup=\"listbox\"\n          aria-activedescendant={this.focusedIndex >= 0 ? `${this.dropdownId}-option-${this.focusedIndex}` : null}\n          aria-label=\"Combobox\"\n          aria-required={true}\n          onKeyDown={this.handleKeyDown}\n          onInput={this.handleInput}\n        />\n        <div class={`dropdown ${this.isOpen ? 'show' : ''}`}>\n          <div ref={el => (this.dropdownRef = el)} class={`dropdown-menu ${this.isOpen ? 'show' : ''}`} id={this.dropdownId} role=\"listbox\" aria-expanded={String(this.isOpen)}>\n            {this.useSlot ? (\n              <slot name=\"dropdown-content\"></slot>\n            ) : (\n              [\n                this.loading && <div class=\"dropdown-item loading\">Loading...</div>,\n                !this.loading && this.filteredOptions.length === 0 && <div class=\"dropdown-item no-results\">No results found</div>,\n                !this.loading &&\n                  this.filteredOptions.map((option, index) => (\n                    <button\n                      id={`${this.dropdownId}-option-${index}`}\n                      class={`dropdown-item ${this.focusedIndex === index ? 'active' : ''}`}\n                      role=\"option\"\n                      aria-selected={this.selectedOption?.value === option.value ? 'true' : 'false'}\n                      onClick={() => this.selectOption(option)}\n                      onMouseEnter={() => (this.focusedIndex = index)}\n                    >\n                      {option.label}\n                    </button>\n                  )),\n              ]\n            )}\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"]}