{"version":3,"file":"ir-proforma-invoice-preview.js","sourceRoot":"","sources":["../../../../src/components/printing/ir-proforma-invoice-preview/ir-proforma-invoice-preview.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Booking } from '@/models/booking.dto';\nimport { BookingInvoiceInfo } from '../../ir-invoice/types';\nimport { Component, Fragment, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { IssueInvoiceProps } from '@/services/booking-service/types';\nimport moment from 'moment';\nimport { calculateDaysBetweenDates } from '@/utils/booking';\nimport { formatAmount } from '@/utils/utils';\n\ntype InvoicePayload = IssueInvoiceProps['invoice'];\n\nexport interface NightlyRate {\n  date: string;\n  amount: number;\n}\n\n@Component({\n  tag: 'ir-proforma-invoice-preview',\n  styleUrl: 'ir-proforma-invoice-preview.css',\n  shadow: true,\n})\nexport class IrProformaInvoicePreview {\n  /**\n   * Booking context used to display property, guest, and folio details.\n   */\n  @Prop() booking: Booking;\n\n  /**\n   * Invoice payload emitted by `ir-invoice-form`.\n   * Totals will fall back to booking data when omitted.\n   */\n  @Prop() invoice?: InvoicePayload;\n\n  /**\n   * Property associated with the booking.\n   */\n  @Prop() property: Booking['property'];\n\n  /**\n   * Optional metadata fetched via `getBookingInvoiceInfo`.\n   * Used to display reference numbers (invoice/credit note/etc.).\n   */\n  @Prop() invoiceInfo?: BookingInvoiceInfo;\n\n  /**\n   * Locale used for date formatting.\n   */\n  @Prop() locale: string = 'en';\n\n  /**\n   * Optional footer text shown at the end of the preview.\n   */\n  @Prop() footerNote?: string;\n\n  @State() invocableKeys: Set<string | number>;\n\n  componentWillLoad() {\n    this.invocableKeys = new Set(this.invoice?.items?.map(i => i.key));\n  }\n\n  @Watch('invoice')\n  handleInvoiceChange() {\n    this.invocableKeys = new Set(this.invoice?.items?.map(i => i.key));\n  }\n\n  private get bookingNumber() {\n    if (!this.booking.is_direct) {\n      return `${this.booking.booking_nbr} | ${this.booking.channel_booking_nbr}`;\n    }\n    return this.booking.booking_nbr;\n  }\n\n  private get CompanyLocation() {\n    const { company } = this.property;\n    const { postal, city, country } = company;\n    if (!postal && !city && !country) return null;\n    const location = [];\n    if (postal) {\n      location.push(postal);\n    }\n    if (city) {\n      location.push(city);\n    }\n    if (country) {\n      if (postal || city) {\n        location.push(`,${country.name}`);\n      } else {\n        location.push(company.name);\n      }\n    }\n    if (location.length === 0) {\n      return null;\n    }\n    return <p class=\"invoice-company__location\">{location.join(' ')}</p>;\n  }\n  private get guestPhoneNumber() {\n    const { country_phone_prefix, mobile_without_prefix } = this.booking.guest;\n    // if (!is_direct) {\n    //     return mobile;\n    // }\n    if (!country_phone_prefix) {\n      return mobile_without_prefix;\n    }\n    return `+${country_phone_prefix?.replace('+', '')}-${mobile_without_prefix}`;\n  }\n  private formatDisplayDate(value?: string) {\n    if (!value) {\n      return null;\n    }\n    const parsedDate = moment(value, ['YYYY-MM-DD', moment.ISO_8601], true);\n    if (!parsedDate.isValid()) {\n      return null;\n    }\n    return parsedDate.format('MMMM DD, YYYY');\n  }\n\n  private get issueDate() {\n    return this.formatDisplayDate(this.invoice?.Date) ?? 'â€”';\n  }\n\n  private renderPropertyCompanyHeader() {\n    const { company } = this.property;\n    if (!company) {\n      return null;\n    }\n    return (\n      <div class=\"invoice-company\" aria-label=\"Issuing company details\">\n        {company.name && <p class=\"invoice-company__name\">{company.name}</p>}\n        {company.address && <p class=\"invoice-company__address\">{company.address}</p>}\n        {this.CompanyLocation}\n        {company.phone && (\n          <ir-printing-label class=\"proforma-invoice__company-details\" label={'Phone:'} content={`${company.country?.phone_prefix ?? ''} ${company.phone}`.trim()} />\n        )}\n        {company.tax_nbr && <ir-printing-label class=\"proforma-invoice__company-details\" label={'Tax ID:'} content={company.tax_nbr} />}\n      </div>\n    );\n  }\n  private renderPropertyInfo() {\n    const propertyLocation = [this.property?.city?.name ?? null, this.property?.country?.name ?? null].filter(f => f !== null).join(', ');\n    const propertyLogo = this.property?.space_theme?.logo;\n    return (\n      <section class=\"property-overview\" aria-label=\"Property overview\">\n        <div class=\"property-overview__text\">\n          <p class=\"property-overview__name\">{this.property.name}</p>\n          <p class=\"property-overview__location\">{propertyLocation}</p>\n        </div>\n        {propertyLogo && <img src={propertyLogo} alt={`${this.property.name} logo`} class=\"property-logo\" />}\n      </section>\n    );\n  }\n  private formatBookingDates(date: string) {\n    return moment(date, 'YYYY-MM-DD').format('DD-MMM-YYYY');\n  }\n  private renderBillToSection() {\n    const { guest, company_name, company_tax_nbr } = this.booking;\n    const { target, billed_to_name } = this.invoice;\n    if (target?.code === '002') {\n      return (\n        <div class=\"bill-to\" aria-label=\"Bill to company\">\n          {company_name && <p class=\"bill-to__name\">{company_name}</p>}\n          {company_tax_nbr && <p class=\"bill-to__id\">{company_tax_nbr}</p>}\n        </div>\n      );\n    }\n    return (\n      <div class=\"bill-to\" aria-label=\"Bill to guest\">\n        {billed_to_name && <p>{billed_to_name}</p>}\n        <p class=\"bill-to__name\">\n          {' '}\n          {billed_to_name && <b>for</b>} {[guest.first_name ?? '', guest.last_name ?? ''].join(' ').trim()}\n        </p>\n        {guest.email && <p class=\"bill-to__contact\">{guest.email}</p>}\n        {this.guestPhoneNumber && <p class=\"bill-to__contact\">{this.guestPhoneNumber}</p>}\n      </div>\n    );\n  }\n  private renderCancellationPenalty() {\n    const cancellationPenalty = this.booking.financial.payments?.find(p => p.payment_type?.code === '013');\n    if (!cancellationPenalty) {\n      return null;\n    }\n    const sysId = cancellationPenalty.id;\n    if (!this.invocableKeys.has(sysId)) {\n      return null;\n    }\n\n    return (\n      <section class=\"proforma-payment__section\">\n        <div class=\"ir-proforma-invoice__service\">\n          <div class={'ir-proforma-invoice__cancellation-info'}>\n            <p>Cancellation penalty</p>\n            <p class={'ir-proforma-invoice__cancellation-date'}>( {this.formatDisplayDate(cancellationPenalty.date)} )</p>\n          </div>\n          <span class=\"ir-proforma-invoice__checkbox-price\">{formatAmount(this.booking.currency.symbol, cancellationPenalty.amount)}</span>\n        </div>\n      </section>\n    );\n  }\n  render() {\n    if (!this.booking || !this.invoice || !this.property) {\n      return;\n    }\n    const billToContent = this.renderBillToSection();\n    const companyDetails = this.renderPropertyCompanyHeader();\n    const propertyOverview = this.renderPropertyInfo();\n    const totalNights = calculateDaysBetweenDates(this.booking.from_date, this.booking.to_date);\n    const invocableRoom = this.booking.rooms.filter(room => this.invocableKeys.has(room.system_id));\n    const existInvocableRoom = invocableRoom.length > 0;\n    const existInvocableExtraService = this.booking.extra_services?.some(service => this.invocableKeys.has(service.system_id));\n    const existInvocablePickup = this.invocableKeys?.has(this.booking.pickup_info?.['system_id']);\n    return (\n      <Host>\n        <article class=\"invoice\" aria-label=\"Pro-forma invoice\">\n          <header class=\"invoice__header\">\n            <h3 class=\"invoice__title\">Pro-forma Invoice</h3>\n            <section class=\"invoice__layout\" aria-label=\"Invoice summary\">\n              <div class=\"invoice__column invoice__column--details\">\n                <div class=\"invoice__details\">\n                  <ir-printing-label label=\"Date of issue:\" content={this.issueDate}></ir-printing-label>\n                  <ir-printing-label label=\"Booking no:\" content={this.bookingNumber}></ir-printing-label>\n                </div>\n                {billToContent && (\n                  <section class=\"bill-to-section\" aria-label=\"Bill to\">\n                    <h4 class=\"section-heading\">Bill To</h4>\n                    {billToContent}\n                  </section>\n                )}\n              </div>\n              <div class=\"invoice__column invoice__column--property\">\n                {companyDetails && (\n                  <section class=\"issuer-section\" aria-label=\"Issuer\">\n                    {companyDetails}\n                  </section>\n                )}\n                {propertyOverview}\n              </div>\n            </section>\n          </header>\n          <main>\n            {existInvocableRoom && (\n              <section style={{ marginTop: '2.5rem' }}>\n                <div class=\"proforma__accommodation-container\">\n                  <p class=\"proforma__accommodation-title\">ACCOMMODATION</p>\n                  <p class=\"booking-dates\">{this.formatBookingDates(this.booking?.from_date)}</p>\n                  <p class=\"booking-dates\">{this.formatBookingDates(this.booking?.to_date)}</p>\n                  <p class=\"number-of-nights\">\n                    {totalNights} {totalNights === 1 ? 'night' : 'nights'}\n                  </p>\n                  <p class=\"vat-exclusion\">\n                    <i>{this.property?.tax_statement}</i>\n                  </p>\n                </div>\n                <div>\n                  {invocableRoom.map((room, idx) => {\n                    return (\n                      <Fragment>\n                        <ir-print-room\n                          room={room}\n                          idx={idx}\n                          booking={this.booking}\n                          key={room.identifier}\n                          currency={this.booking.currency.symbol}\n                          property={this.property as any}\n                        ></ir-print-room>\n                      </Fragment>\n                    );\n                  })}\n                </div>\n              </section>\n            )}\n            {existInvocablePickup && <ir-printing-pickup pickup={this.booking.pickup_info}></ir-printing-pickup>}\n            {existInvocableExtraService && (\n              <ir-printing-extra-service\n                invocableKeys={this.invocableKeys}\n                extraServices={this.booking.extra_services}\n                currency={this.booking.currency}\n              ></ir-printing-extra-service>\n            )}\n            {this.renderCancellationPenalty()}\n            <section class=\"proforma-payment__section\">\n              <ir-printing-label label=\"Balance:\" content={formatAmount(this.booking.currency.symbol, this.booking.financial.due_amount)}></ir-printing-label>\n              <ir-printing-label\n                label=\"Collected (payments - refunds):\"\n                content={formatAmount(this.booking.currency.symbol, this.booking.financial.collected + this.booking.financial.refunds)}\n              ></ir-printing-label>\n            </section>\n          </main>\n          {this.footerNote && (\n            <footer class=\"invoice__footer\">\n              <p class=\"invoice__footer-note\">{this.footerNote}</p>\n            </footer>\n          )}\n        </article>\n      </Host>\n    );\n  }\n}\n"]}