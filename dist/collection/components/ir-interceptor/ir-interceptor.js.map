{"version":3,"file":"ir-interceptor.js","sourceRoot":"","sources":["../../../src/components/ir-interceptor/ir-interceptor.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAgB,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AAC7F,OAAO,KAA4C,MAAM,OAAO,CAAC;AAEjE,OAAO,oBAAoB,MAAM,+BAA+B,CAAC;AACjE,OAAO,EAAE,gBAAgB,EAAE,MAAM,oBAAoB,CAAC;AAOtD,MAAM,OAAO,aAAa;IAL1B;QAM2B,qBAAgB,GAAG,CAAC,uBAAuB,EAAE,0BAA0B,EAAE,uBAAuB,EAAE,uBAAuB,CAAC,CAAC;QAC5I,2BAAsB,GAAa,EAAE,CAAC;QAErC,YAAO,GAAG,KAAK,CAAC;QAChB,cAAS,GAAG,KAAK,CAAC;QAClB,qBAAgB,GAAG,KAAK,CAAC;QACzB,mBAAc,GAAG,CAAC,CAAC;QACnB,yBAAoB,GAAkB,IAAI,CAAC;KA0OrD;IA1NC,qBAAqB,CAAC,CAAc;QAClC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,oBAAoB,GAAG,CAAC,CAAC,MAAM,CAAC;IACvC,CAAC;IACD,iBAAiB;QACf,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAChC,CAAC;IAEO,sBAAsB;QAC5B,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC3F,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC/F,CAAC;IAEO,eAAe,CAAC,GAAW;QACjC,OAAO,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;IAEO,iBAAiB,CAAC,GAAW;QACnC,OAAO,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;IAC7C,CAAC;IACO,aAAa,CAAC,MAA0B;QAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACtD,oBAAoB,CAAC,YAAY,CAAC,GAAG,SAAS,CAAC;QAC/C,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;QACpC,qBAAqB;QACrB,wCAAwC;QACxC,IAAI;QACJ,IAAI,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC,oBAAoB,KAAK,YAAY,EAAE,CAAC;YACvF,IAAI,YAAY,KAAK,uBAAuB,EAAE,CAAC;gBAC7C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,CAAC;iBAAM,CAAC;gBACN,IAAI,IAAI,CAAC,cAAc,GAAG,CAAC,EAAE,CAAC;oBAC5B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBACxB,CAAC;YACH,CAAC;QACH,CAAC;QACD,IAAI,YAAY,KAAK,uBAAuB,EAAE,CAAC;YAC7C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;QAChD,CAAC;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAEO,KAAK,CAAC,cAAc,CAAC,QAAuB;;QAClD,MAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAC/D,IAAI,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,EAAE,CAAC;YACzC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QACnC,CAAC;QACD,oBAAoB,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC;QAC5C,IAAI,YAAY,KAAK,uBAAuB,EAAE,CAAC;YAC7C,OAAO,QAAQ,CAAC;QAClB,CAAC;QACD,IAAI,QAAQ,CAAC,IAAI,CAAC,aAAa,KAAK,KAAK,EAAE,CAAC;YAC1C,OAAO,IAAI,CAAC,iBAAiB,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC;QAC5D,CAAC;QACD,IAAI,MAAA,QAAQ,CAAC,IAAI,CAAC,YAAY,0CAAE,IAAI,EAAE,EAAE,CAAC;YACvC,IAAI,CAAC,wBAAwB,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC;QAC5D,CAAC;QACD,OAAO,QAAQ,CAAC;IAClB,CAAC;IAEO,wBAAwB,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAqD;QAC5G,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,YAAY,EAAE,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACxF,MAAM,IAAI,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACtF,CAAC;IAEO,iBAAiB,CAAC,EAAE,YAAY,EAAE,QAAQ,EAAqD;QACrG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC;QACxC,MAAM,IAAI,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACnC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,IAAI,KAAK,qBAAqB,EAAE,CAAC;YACnC,IAAI,UAAkB,CAAC;YACvB,IAAI,CAAC;gBACH,MAAM,IAAI,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC;gBAChH,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;YAChC,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACX,OAAO,CAAC,KAAK,CAAC,8CAA8C,EAAE,CAAC,CAAC,CAAC;gBACjE,UAAU,GAAG,IAAI,CAAC,CAAC,WAAW;YAChC,CAAC;YACD,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC/B,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACzB,CAAC;QAED,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC,MAAM,CAAC;QACrC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,OAAO,IAAI,OAAO,CAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACpD,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;YAC9B,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;YAC5B,UAAU,CAAC,GAAG,EAAE;;gBACd,MAAA,IAAI,CAAC,QAAQ,0CAAE,SAAS,EAAE,CAAC;YAC7B,CAAC,EAAE,EAAE,CAAC,CAAC;QACT,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,WAAW,CAAC,KAAa,EAAE,GAAW,EAAE,IAAY;QAC1D,MAAM,mBAAmB,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACtE,IAAI,CAAC,mBAAmB,IAAI,CAAC,mBAAmB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YAC3D,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;gBACd,IAAI,EAAE,OAAO;gBACb,KAAK,EAAE,KAAK;gBACZ,WAAW,EAAE,EAAE;gBACf,QAAQ,EAAE,WAAW;aACtB,CAAC,CAAC;QACL,CAAC;QACD,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAC/B,CAAC;IAED,qDAAqD;IACrD,8EAA8E;IAC9E,cAAc;IACd,MAAM;IAEN,qCAAqC;IACrC,8BAA8B;IAC9B,kBAAkB;IAClB,gEAAgE;IAChE,eAAe;IACf,cAAc;IACd,2DAA2D;IAC3D,sDAAsD;IACtD,qCAAqC;IACrC,sBAAsB;IACtB,wIAAwI;IACxI,iBAAiB;IACjB,eAAe;IACf,2DAA2D;IAC3D,uCAAuC;IACvC,YAAY;IACZ,wBAAwB;IACxB,mCAAmC;IACnC,UAAU;IACV,QAAQ;IACR,MAAM;IACN,oCAAoC;IACpC,qCAAqC;IACrC,oCAAoC;IACpC,4BAA4B;IAC5B,qDAAqD;IACrD,8BAA8B;IAC9B,4BAA4B;IAC5B,MAAM;IACN,IAAI;IACI,KAAK,CAAC,iBAAiB,CAAC,EAAe;QAC7C,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC;YACvE,OAAO;QACT,CAAC;QAED,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,MAAM,CAAC;QAChC,IAAI,IAAI,KAAK,QAAQ,EAAE,CAAC;YACtB,MAAM,UAAU,GAAG;gBACjB,MAAM,EAAE,IAAI,CAAC,aAAa;gBAC1B,IAAI,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE;gBACtD,MAAM,EAAE,CAAC;gBACT,UAAU,EAAE,eAAe;gBAC3B,OAAO,EAAE,EAAE;gBACX,OAAO,EAAE,EAAE;aACK,CAAC;YACnB,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;QAClC,CAAC;aAAM,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;YAC9B,IAAI,CAAC,GAAG,EAAE,CAAC;gBACT,IAAI,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAAC;YACzD,CAAC;iBAAM,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB,EAAE,CAAC;gBACrD,wDAAwD;gBACxD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,QAAS,CAAC,CAAC;YACtC,CAAC;iBAAM,CAAC;gBACN,IAAI,CAAC;oBACH,MAAM,WAAW,mCACZ,IAAI,CAAC,aAAa,KACrB,IAAI,EAAE,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,IAAI,EAAE,GACxH,CAAC;oBACF,MAAM,IAAI,GAAG,MAAM,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;oBAC9C,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;gBAC5B,CAAC;gBAAC,OAAO,GAAG,EAAE,CAAC;oBACb,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;gBAC1B,CAAC;YACH,CAAC;QACH,CAAC;QAED,kBAAkB;QAClB,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;QAChC,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;QAC/B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IACzB,CAAC;IAED,MAAM;QACJ,OAAO,CACL,EAAC,IAAI;YASF,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,oBAAoB,IAAI,CAC/C,4DAAK,KAAK,EAAC,wBAAwB;gBACjC,4DAAK,KAAK,EAAC,iBAAiB;oBAC1B,6DAAM,KAAK,EAAC,aAAa,GAAQ,CAC7B,CACF,CACP;YACA,IAAI,CAAC,SAAS,IAAI,CACjB,qEACE,KAAK,EAAE,IAAI,CAAC,KAAK,EACjB,UAAU,EAAE,IAAI,CAAC,UAAU,EAC3B,UAAU,EAAE,IAAI,CAAC,UAAU,EAC3B,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,EAC/B,aAAa,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,GAClC,CACjB,CACI,CACR,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Event, EventEmitter, Host, Listen, Prop, State, h } from '@stencil/core';\r\nimport axios, { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport { IToast } from '@components/ui/ir-toast/toast';\r\nimport interceptor_requests from '@/stores/ir-interceptor.store';\r\nimport { InterceptorError } from './InterceptorError';\r\n\r\n@Component({\r\n  tag: 'ir-interceptor',\r\n  styleUrl: 'ir-interceptor.css',\r\n  scoped: true,\r\n})\r\nexport class IrInterceptor {\r\n  @Prop({ reflect: true }) handledEndpoints = ['/Get_Exposed_Calendar', '/ReAllocate_Exposed_Room', '/Get_Exposed_Bookings', '/UnBlock_Exposed_Unit'];\r\n  @Prop() suppressToastEndpoints: string[] = [];\r\n\r\n  @State() isShown = false;\r\n  @State() isLoading = false;\r\n  @State() isUnassignedUnit = false;\r\n  @State() endpointsCount = 0;\r\n  @State() isPageLoadingStopped: string | null = null;\r\n  @State() showModal: boolean;\r\n  @State() requestUrl: string;\r\n  @State() baseOTPUrl: string;\r\n  @State() email: string;\r\n\r\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\r\n\r\n  private otpModal: HTMLIrOtpModalElement;\r\n\r\n  private pendingConfig?: AxiosRequestConfig;\r\n  private pendingResolve?: (resp: AxiosResponse) => void;\r\n  private pendingReject?: (err: any) => void;\r\n  private response?: AxiosResponse;\r\n\r\n  @Listen('preventPageLoad', { target: 'body' })\r\n  handleStopPageLoading(e: CustomEvent) {\r\n    this.isLoading = false;\r\n    this.isPageLoadingStopped = e.detail;\r\n  }\r\n  componentWillLoad() {\r\n    this.setupAxiosInterceptors();\r\n  }\r\n\r\n  private setupAxiosInterceptors() {\r\n    axios.interceptors.request.use(this.handleRequest.bind(this), this.handleError.bind(this));\r\n    axios.interceptors.response.use(this.handleResponse.bind(this), this.handleError.bind(this));\r\n  }\r\n\r\n  private extractEndpoint(url: string): string {\r\n    return url.split('?')[0];\r\n  }\r\n\r\n  private isHandledEndpoint(url: string): boolean {\r\n    return this.handledEndpoints.includes(url);\r\n  }\r\n  private handleRequest(config: AxiosRequestConfig) {\r\n    const extractedUrl = this.extractEndpoint(config.url);\r\n    interceptor_requests[extractedUrl] = 'pending';\r\n    config.params = config.params || {};\r\n    // if (this.ticket) {\r\n    //   config.params.Ticket = this.ticket;\r\n    // }\r\n    if (this.isHandledEndpoint(extractedUrl) && this.isPageLoadingStopped !== extractedUrl) {\r\n      if (extractedUrl !== '/Get_Exposed_Calendar') {\r\n        this.isLoading = true;\r\n      } else {\r\n        if (this.endpointsCount > 0) {\r\n          this.isLoading = true;\r\n        }\r\n      }\r\n    }\r\n    if (extractedUrl === '/Get_Exposed_Calendar') {\r\n      this.endpointsCount = this.endpointsCount + 1;\r\n    }\r\n    return config;\r\n  }\r\n\r\n  private async handleResponse(response: AxiosResponse) {\r\n    const extractedUrl = this.extractEndpoint(response.config.url);\r\n    if (this.isHandledEndpoint(extractedUrl)) {\r\n      this.isLoading = false;\r\n      this.isPageLoadingStopped = null;\r\n    }\r\n    interceptor_requests[extractedUrl] = 'done';\r\n    if (extractedUrl === '/Validate_Exposed_OTP') {\r\n      return response;\r\n    }\r\n    if (response.data.ExceptionCode === 'OTP') {\r\n      return this.handleOtpResponse({ response, extractedUrl });\r\n    }\r\n    if (response.data.ExceptionMsg?.trim()) {\r\n      this.handleResponseExceptions({ response, extractedUrl });\r\n    }\r\n    return response;\r\n  }\r\n\r\n  private handleResponseExceptions({ response, extractedUrl }: { response: AxiosResponse; extractedUrl: string }) {\r\n    this.handleError(response.data.ExceptionMsg, extractedUrl, response.data.ExceptionCode);\r\n    throw new InterceptorError(response.data.ExceptionMsg, response.data.ExceptionCode);\r\n  }\r\n\r\n  private handleOtpResponse({ extractedUrl, response }: { response: AxiosResponse; extractedUrl: string }) {\r\n    this.showModal = true;\r\n    this.email = response.data.ExceptionMsg;\r\n    const name = extractedUrl.slice(1);\r\n    this.baseOTPUrl = name;\r\n    if (name === 'Check_OTP_Necessity') {\r\n      let methodName: string;\r\n      try {\r\n        const body = typeof response.config.data === 'string' ? JSON.parse(response.config.data) : response.config.data;\r\n        methodName = body.METHOD_NAME;\r\n      } catch (e) {\r\n        console.error('Failed to parse request body for METHOD_NAME', e);\r\n        methodName = name; // fallback\r\n      }\r\n      this.requestUrl = methodName;\r\n    } else {\r\n      this.requestUrl = name;\r\n    }\r\n\r\n    this.pendingConfig = response.config;\r\n    this.response = response;\r\n    return new Promise<AxiosResponse>((resolve, reject) => {\r\n      this.pendingResolve = resolve;\r\n      this.pendingReject = reject;\r\n      setTimeout(() => {\r\n        this.otpModal?.openModal();\r\n      }, 10);\r\n    });\r\n  }\r\n\r\n  private handleError(error: string, url: string, code: string) {\r\n    const shouldSuppressToast = this.suppressToastEndpoints.includes(url);\r\n    if (!shouldSuppressToast || (shouldSuppressToast && !code)) {\r\n      this.toast.emit({\r\n        type: 'error',\r\n        title: error,\r\n        description: '',\r\n        position: 'top-right',\r\n      });\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n\r\n  // private async handleOtpFinished(ev: CustomEvent) {\r\n  //   if (!this.pendingConfig || !this.pendingResolve || !this.pendingReject) {\r\n  //     return;\r\n  //   }\r\n\r\n  //   const { otp, type } = ev.detail;\r\n  //   if (type === 'success') {\r\n  //     if (!otp) {\r\n  //       this.pendingReject(new Error('OTP cancelled by user'));\r\n  //     } else {\r\n  //       try {\r\n  //         if (this.baseOTPUrl !== 'Check_OTP_Necessity') {\r\n  //           const retryConfig: AxiosRequestConfig = {\r\n  //             ...this.pendingConfig,\r\n  //             data: {\r\n  //               ...(typeof this.pendingConfig.data === 'string' ? JSON.parse(this.pendingConfig.data) : this.pendingConfig.data || {}),\r\n  //             },\r\n  //           };\r\n  //           const resp = await axios.request(retryConfig);\r\n  //           this.pendingResolve(resp);\r\n  //         }\r\n  //       } catch (err) {\r\n  //         this.pendingReject(err);\r\n  //       }\r\n  //     }\r\n  //   }\r\n  //   this.pendingConfig = undefined;\r\n  //   this.pendingResolve = undefined;\r\n  //   this.pendingReject = undefined;\r\n  //   this.showModal = false;\r\n  //   if (this.baseOTPUrl === 'Check_OTP_Necessity') {\r\n  //     this.baseOTPUrl = null;\r\n  //     return this.response;\r\n  //   }\r\n  // }\r\n  private async handleOtpFinished(ev: CustomEvent) {\r\n    if (!this.pendingConfig || !this.pendingResolve || !this.pendingReject) {\r\n      return;\r\n    }\r\n\r\n    const { otp, type } = ev.detail;\r\n    if (type === 'cancel') {\r\n      const cancelResp = {\r\n        config: this.pendingConfig,\r\n        data: { cancelled: true, baseOTPUrl: this.baseOTPUrl },\r\n        status: 0,\r\n        statusText: 'OTP Cancelled',\r\n        headers: {},\r\n        request: {},\r\n      } as AxiosResponse;\r\n      this.pendingResolve(cancelResp);\r\n    } else if (type === 'success') {\r\n      if (!otp) {\r\n        this.pendingReject(new Error('OTP cancelled by user'));\r\n      } else if (this.baseOTPUrl === 'Check_OTP_Necessity') {\r\n        // don't resend, just resolve with the original response\r\n        this.pendingResolve(this.response!);\r\n      } else {\r\n        try {\r\n          const retryConfig: AxiosRequestConfig = {\r\n            ...this.pendingConfig,\r\n            data: typeof this.pendingConfig.data === 'string' ? JSON.parse(this.pendingConfig.data) : this.pendingConfig.data || {},\r\n          };\r\n          const resp = await axios.request(retryConfig);\r\n          this.pendingResolve(resp);\r\n        } catch (err) {\r\n          this.pendingReject(err);\r\n        }\r\n      }\r\n    }\r\n\r\n    // common clean-up\r\n    this.pendingConfig = undefined;\r\n    this.pendingResolve = undefined;\r\n    this.pendingReject = undefined;\r\n    this.showModal = false;\r\n    this.baseOTPUrl = null;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        {/* {this.isLoading && !this.isPageLoadingStopped && (\r\n          <div class=\"loadingScreenContainer\">\r\n            <div class=\"loaderContainer\">\r\n              <span class=\"loader\"></span>\r\n              <p>Fetching bookings.</p>\r\n            </div>\r\n          </div>\r\n        )} */}\r\n        {this.isLoading && !this.isPageLoadingStopped && (\r\n          <div class=\"loadingScreenContainer\">\r\n            <div class=\"loaderContainer\">\r\n              <span class=\"page-loader\"></span>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.showModal && (\r\n          <ir-otp-modal\r\n            email={this.email}\r\n            baseOTPUrl={this.baseOTPUrl}\r\n            requestUrl={this.requestUrl}\r\n            ref={el => (this.otpModal = el)}\r\n            onOtpFinished={this.handleOtpFinished.bind(this)}\r\n          ></ir-otp-modal>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}