{"version":3,"file":"ir-billing.js","sourceRoot":"","sources":["../../../src/components/ir-billing/ir-billing.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Booking } from '@/models/booking.dto';\nimport { Component, Event, EventEmitter, Fragment, Listen, Prop, State, h } from '@stencil/core';\nimport { BookingInvoiceInfo, Invoice } from '../ir-invoice/types';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { formatAmount } from '@/utils/utils';\nimport moment from 'moment';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n\n@Component({\n  tag: 'ir-billing',\n  styleUrls: ['ir-billing.css', '../../common/table.css'],\n  scoped: true,\n})\nexport class IrBilling {\n  @Prop() booking: Booking;\n\n  @State() isOpen: 'invoice' = null;\n  @State() isLoading: 'page' | 'void' = 'page';\n  @State() invoiceInfo: BookingInvoiceInfo;\n  @State() selectedInvoice: string = null;\n\n  @Event() billingClose: EventEmitter<void>;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.init();\n  }\n  @Listen('invoiceCreated')\n  async handleInvoiceCreation(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n  }\n  private async init() {\n    try {\n      this.isLoading = 'page';\n      this.invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  private async voidInvoice(e: CustomEvent) {\n    this.isLoading = 'void';\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingService.voidInvoice({\n      invoice_nbr: this.selectedInvoice,\n      reason: '',\n    });\n    this.invoiceInfo = await this.bookingService.getBookingInvoiceInfo({ booking_nbr: this.booking.booking_nbr });\n    this.isLoading = null;\n    this.selectedInvoice = null;\n  }\n\n  private get invoices() {\n    const _invoices: Invoice[] = [];\n    for (const invoice of this.invoiceInfo.invoices) {\n      if (invoice.status.code === 'VALID') {\n        _invoices.push(invoice);\n      } else {\n        _invoices.push({ ...invoice, status: { code: 'VALID', description: '' } });\n        _invoices.push({ ...invoice, date: invoice.credit_note.date });\n      }\n    }\n    return _invoices.sort((a, b) => {\n      const aDate = moment(a.date ?? a.credit_note?.date, 'YYYY-MM-DD');\n      const bDate = moment(b.date ?? b.credit_note?.date, 'YYYY-MM-DD');\n      return aDate.diff(bDate); // ASC order\n    });\n  }\n\n  private async printInvoice(invoice: Invoice) {\n    try {\n      const { My_Result } = await this.bookingService.printInvoice({\n        invoice_nbr: invoice.nbr,\n        mode: invoice.credit_note ? 'creditnote' : 'invoice',\n      });\n      window.open(My_Result.url);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    if (this.isLoading === 'page') {\n      return (\n        <div class=\"drawer__loader-container\">\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    return (\n      <Fragment>\n        <div class=\"billing__container\">\n          <section>\n            <div class=\"billing__section-title-row\">\n              <h4 class=\"billing__section-title\">Issued documents</h4>\n              <ir-custom-button\n                variant=\"brand\"\n                onClickHandler={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.isOpen = 'invoice';\n                }}\n              >\n                Issue invoice\n              </ir-custom-button>\n            </div>\n            <div class=\"table-container\">\n              <table class=\"table\">\n                <thead>\n                  <tr>\n                    {/* <th>Type</th> */}\n                    <th>Date</th>\n                    <th>Number</th>\n                    <th class=\"billing__price-col\">Amount</th>\n                    <th></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {this.invoices?.map(invoice => {\n                    const isValid = invoice.status.code === 'VALID';\n                    return (\n                      <tr class=\"ir-table-row\">\n                        {/* <td>{isValid ? 'Invoice' : 'Credit note'}</td> */}\n                        <td>\n                          {invoice.status.code === 'VALID'\n                            ? moment(invoice.date, 'YYYY-MM-DD').format('MMM DD, YYYY')\n                            : moment(invoice.credit_note.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}\n                        </td>\n                        <td>\n                          <p class=\"billing__invoice-nbr\">\n                            <b>{isValid ? 'Invoice' : 'Credit note'}:</b> {isValid ? invoice.nbr : invoice.credit_note.nbr}\n                          </p>\n                          {!isValid && <p class=\"billing__invoice-nbr --secondary\">{invoice.nbr}</p>}\n                        </td>\n                        <td class=\"billing__price-col\">\n                          <span class=\"ir-price\" style={{ fontWeight: '400' }}>\n                            {formatAmount(invoice.currency.symbol, invoice.total_amount)}\n                          </span>\n                        </td>\n                        <td>\n                          <div class=\"billing__actions-row\">\n                            <wa-dropdown\n                              onwa-hide={e => {\n                                e.stopImmediatePropagation();\n                                e.stopPropagation();\n                              }}\n                              onwa-select={async e => {\n                                switch ((e.detail as any).item.value) {\n                                  case 'print':\n                                    this.printInvoice(invoice);\n                                    break;\n                                  case 'void':\n                                    this.selectedInvoice = invoice.nbr;\n                                    break;\n                                }\n                              }}\n                            >\n                              <h3>Issued by: {invoice.credit_note ? invoice.credit_note.user : invoice.user}</h3>\n                              <wa-divider></wa-divider>\n                              <h3>Actions</h3>\n                              <wa-dropdown-item value=\"print\">\n                                Print to pdf\n                                {isRequestPending('/Print_Invoice') && <wa-spinner slot=\"details\"></wa-spinner>}\n                              </wa-dropdown-item>\n                              {isValid && !invoice.credit_note && (\n                                <wa-dropdown-item variant=\"danger\" value=\"void\">\n                                  Void with credit note\n                                </wa-dropdown-item>\n                              )}\n                              {/* <wa-tooltip for={`pdf-${invoice.system_id}`}>Download pdf</wa-tooltip> */}\n                              <ir-custom-button slot=\"trigger\" id={`pdf-${invoice.system_id}`} variant=\"neutral\" appearance=\"plain\">\n                                <wa-icon name=\"ellipsis-vertical\" style={{ fontSize: '1rem' }}></wa-icon>\n                              </ir-custom-button>\n                            </wa-dropdown>\n                          </div>\n                        </td>\n                        {/* <p>\n                    {this.booking.guest.first_name} {this.booking.guest.last_name}\n                  </p> */}\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n            <div class=\"billing__cards\">\n              {this.invoices?.map(invoice => {\n                const isValid = invoice.status.code === 'VALID';\n\n                return (\n                  <wa-card key={invoice.nbr} class=\"billing__card\">\n                    <div class=\"billing__card-header\">\n                      <div class=\"billing__card-header-info\">\n                        <p class=\"billing__card-number\">\n                          {isValid ? 'Invoice' : 'Credit note'}:{isValid ? invoice.nbr : invoice.credit_note.nbr}\n                        </p>\n                        <p class=\"billing__card-type\">{isValid ? '' : invoice.nbr}</p>\n                      </div>\n\n                      <wa-tooltip for={`mobile-pdf-${invoice.system_id}`}>Download pdf</wa-tooltip>\n                      <ir-custom-button\n                        onClickHandler={() => this.printInvoice(invoice)}\n                        loading={isRequestPending('/Print_Invoice')}\n                        id={`mobile-pdf-${invoice.system_id}`}\n                        variant=\"neutral\"\n                        appearance=\"plain\"\n                        class=\"billing__card-download-btn\"\n                      >\n                        <wa-icon name=\"file-pdf\" style={{ fontSize: '1rem' }}></wa-icon>\n                      </ir-custom-button>\n                    </div>\n\n                    <div class=\"billing__card-details\">\n                      <div class=\"billing__card-detail\">\n                        <p class=\"billing__card-detail-label\">Date</p>\n                        <p class=\"billing__card-detail-value\">\n                          {' '}\n                          {isValid ? moment(invoice.date, 'YYYY-MM-DD').format('MMM DD, YYYY') : moment(invoice.credit_note.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}\n                        </p>\n                      </div>\n\n                      <div class=\"billing__card-detail\">\n                        <p class=\"billing__card-detail-label --amount\">Amount</p>\n                        <p class=\"billing__card-detail-value\">{formatAmount(invoice.currency.symbol, invoice.total_amount ?? 0)}</p>\n                      </div>\n                    </div>\n\n                    {isValid && !invoice.credit_note && (\n                      <div slot=\"footer\" class=\"billing__card-footer\">\n                        <ir-custom-button\n                          onClickHandler={() => {\n                            this.selectedInvoice = invoice.nbr;\n                          }}\n                          variant=\"danger\"\n                          appearance=\"outlined\"\n                          class=\"billing__card-void-btn\"\n                        >\n                          Void with credit note\n                        </ir-custom-button>\n                      </div>\n                    )}\n                  </wa-card>\n                );\n              })}\n            </div>\n            {this.invoiceInfo.invoices?.length === 0 && <ir-empty-state></ir-empty-state>}\n          </section>\n        </div>\n        <ir-invoice\n          invoiceInfo={this.invoiceInfo}\n          onInvoiceClose={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.isOpen = null;\n          }}\n          open={this.isOpen === 'invoice'}\n          booking={this.booking}\n        ></ir-invoice>\n        <ir-dialog\n          label=\"Alert\"\n          open={this.selectedInvoice !== null}\n          lightDismiss={false}\n          onIrDialogHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n          }}\n          onIrDialogAfterHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.selectedInvoice = null;\n          }}\n        >\n          <p>Confirm that you want to void this invoice and generate a corresponding credit note.</p>\n          <div slot=\"footer\" class=\"ir-dialog__footer\">\n            <ir-custom-button data-dialog=\"close\" size=\"medium\" appearance=\"filled\" variant=\"neutral\">\n              Cancel\n            </ir-custom-button>\n            <ir-custom-button loading={this.isLoading === 'void'} onClickHandler={this.voidInvoice.bind(this)} size=\"medium\" variant=\"danger\">\n              Confirm\n            </ir-custom-button>\n          </div>\n        </ir-dialog>\n      </Fragment>\n    );\n  }\n}\n"]}