import{r as t,c as e,h as i,H as s,F as a}from"./p-ee49d535.js";import{q as o,d as n,k as d}from"./p-551d64ea.js";import{l}from"./p-806fad31.js";import{c}from"./p-6bab2172.js";import{v as r}from"./p-4ed69de7.js";import{B as h}from"./p-bb37d715.js";import{t as f,d as b}from"./p-d49ed902.js";import{E as p}from"./p-5c499067.js";import{a as m}from"./p-bd53d1f9.js";import{h as u}from"./p-6c4ba7c0.js";import"./p-4eb12235.js";import"./p-06203439.js";import"./p-dfa14c12.js";const g=".sc-igl-application-info-h{display:block}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:80%}.guest-info-container.sc-igl-application-info{max-width:300px}.preference-select-container.sc-igl-application-info{max-width:250px}}";const y=g;const k=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.userRate=0;this.guestInfo=undefined;this.currency=undefined;this.roomsList=[];this.guestRefKey=undefined;this.bedPreferenceType=[];this.selectedUnits=[];this.bookingType="PLUS_BOOKING";this.defaultGuestPreference=undefined;this.index=undefined;this.defaultGuestRoomId=undefined;this.dateDifference=undefined;this.filterdRoomList=[];this.isButtonPressed=false;this.guestData=undefined}componentWillLoad(){if(this.guestInfo.isRateModified&&this.guestInfo.rateType===2){this.userRate=this.guestInfo.rate*this.dateDifference}else{this.userRate=this.guestInfo.rate}this.guestData=this.guestInfo?Object.assign({},this.guestInfo):{};this.guestData.roomId="";if(this.defaultGuestRoomId&&this.roomsList.filter((t=>t.id.toString()===this.defaultGuestRoomId.toString())).length>0){this.guestData.roomId=this.defaultGuestRoomId}this.guestData.preference=+this.defaultGuestPreference||"";this.updateRoomList()}componentDidLoad(){this.timeout=setTimeout((()=>{this.updateData()}),200)}disconnectedCallback(){clearTimeout(this.timeout)}async handleSelctedUnits(){this.updateRoomList()}updateRoomList(){const t=[...this.selectedUnits];t[this.index]=-1;this.filterdRoomList=this.roomsList.filter((e=>!t.includes(e.id)||e.name===""))}updateData(){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",guestRefKey:this.guestRefKey,data:Object.assign({},this.guestData)})}handleDataChange(t,e){this.guestData[t]=+e;if(e===""){this.guestData["roomName"]=e}if(t==="roomId"&&e!==""){this.guestData["roomName"]=this.filterdRoomList.find((t=>t.id===+e)).name||""}this.updateData()}handleGuestNameChange(t){this.guestData.guestName=t.target.value;this.updateData()}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}render(){return i(s,{key:"9e7ddbd6e6b4d5acfd6994d06edf4eb49f1fa2bc"},i("div",{key:"10f0b714856c481ba4acdf79cfb3ca643d227b7f",class:"text-left mt-1 "},i("div",{key:"b01b9ffb12ea8ccf0d6387812cf99ff17f943201",class:" mb-1 "},this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING"?i("span",{class:"h5 mr-1"},this.guestInfo.roomCategoryName):null,i("span",{key:"50eb5cfb3a818ff9a8a9c91dedaa7b31a2e77ddf",class:" font-weight-bold"},this.guestInfo.ratePlanName.replace(this.guestInfo.roomCategoryName+"/",""),i("ir-tooltip",{key:"a6cd36bc8f112d3ff7cb6ea65768339dd789813c",class:" mr-1",message:this.guestInfo.cancelation+this.guestInfo.guarantee})),i("span",{key:"80baf8fc1ce54f5a3949d03fd85387516be05e65"},this.guestInfo.adult_child_offering)),i("div",{key:"43806d8201c85d1b773e5035e0c5deb9a1db284c",class:"d-flex flex-column flex-md-row m-0 p-0 align-items-md-center aplicationInfoContainer "},i("div",{key:"f1870ba87b12889393233730febd4fbe22268416",class:"mr-1 flex-fill guest-info-container"},i("input",{key:"6b0d16203bf4e43b76a7b212cbdc1eaee5e866a4",id:r(),type:"email",class:`form-control ${this.isButtonPressed&&this.guestData.guestName===""&&"border-danger"}`,placeholder:l.entries.Lcz_GuestFirstnameAndLastname,name:"guestName",onInput:t=>this.handleGuestNameChange(t),required:true,value:this.guestData.guestName})),i("div",{key:"36707c425d9a1e6f4144ece5b871ffc38ea97007",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},c.is_frontdesk_enabled&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")?i("div",{class:"mr-1 p-0 flex-fill  preference-select-container"},i("select",{class:`form-control  input-sm pr-0`,id:r(),onChange:t=>this.handleDataChange("roomId",t.target.value)},i("option",{value:"",selected:this.guestData.roomId===""},l.entries.Lcz_Assignunits),this.filterdRoomList.map((t=>i("option",{value:t.id,selected:+this.guestData.roomId===t.id},t.name))))):null,this.guestData.is_bed_configuration_enabled&&i("div",{key:"e1fae3f7dd6294c9cb5038dde8fdb40b74f1a03d",class:"mr-1 flex-fill"},i("select",{key:"cd2c69c47a2997b155e07e0c5fe0a116c4ed51ff",class:`form-control input-sm ${this.isButtonPressed&&(this.guestData.preference===""||this.guestData.preference===0)&&"border-danger"}`,id:r(),onChange:t=>this.handleDataChange("preference",t.target.value)},i("option",{key:"6134882af24a338a7682137cbfc931e8b4b444fb",value:"",selected:this.guestData.preference===""},l.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((t=>i("option",{value:+t.CODE_NAME,selected:this.guestData.preference===+t.CODE_NAME},t.CODE_VALUE_EN))))),i("div",{key:"37469c0019cfdff7bde640d47172dea53dae0bb1",class:""},o(this.currency.code)+Number(this.userRate).toFixed(2),"/",l.entries.Lcz_Stay)))))}static get watchers(){return{selectedUnits:["handleSelctedUnits"]}}};k.style=y;const x=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const v=x;const w=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new h;this.defaultData=undefined;this.fromDate=undefined;this.toDate=undefined;this.entryDate=undefined;this.entryHour=undefined;this.isEventHover=false;this.entryMinute=undefined;this.renderAgain=false}async componentWillLoad(){try{this.bookingService.setToken(c.token);this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(t){}}handleOptionalReason(t){this.blockDatesData.OPTIONAL_REASON=t.target.value;this.emitData()}handleReleaseAfterChange(t){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(t.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let t=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){t.setHours(this.entryHour,this.entryMinute,0,0)}else{t.setHours(t.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,t.getMinutes(),0,0)}return t.toLocaleString("default",{month:"short"})+" "+t.getDate()+", "+this.formatNumber(t.getHours())+":"+this.formatNumber(t.getMinutes())}formatNumber(t){return t<10?`0${t}`:t}handleOutOfService(t){this.blockDatesData.OUT_OF_SERVICE=t.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){return i(s,{key:"33d870a6e3906b77eece0aadf7927a6d2f39cd30"},i("div",{key:"e70de36c7e354b63cede6ef7d8e9a54c972c45c2",class:`m-0 p-0 mb-1`},i("div",{key:"a117f81a211f41c95456b1b2d97aa240656544ae",class:"text-left p-0"},i("ir-date-view",{key:"2b4dd29f9263c6ab2c781073d0e0ab9be088b491",from_date:this.fromDate,dateOption:"DD MMM YYYY",showDateDifference:false,to_date:this.toDate}))),i("div",{key:"d4de0d5e59f192a82730582266fd6bd5ece09cd0",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},i("div",{key:"fbae2c940d686793fb40eaf423f358bafb4c2383",class:"mb-1 "},i("label",{key:"4f41cb24c0d6676fdb5236a0b811573ebd2762e9",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},l.entries.Lcz_Reason,":"),i("div",{key:"415b0caac88aa8108703f772d01ff7bfee6fce54",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},i("input",{key:"c6980fb960700df3494dc85bc153690e9113bede",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:t=>this.handleOutOfService(t)})),i("span",{key:"bd64adfa657761075cf56ab36d3f0f3427ecb2de",class:"align-middle out-of-service-label"},l.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?i("div",null,i("div",{class:"mb-1 d-flex  align-items-center"},i("span",{class:"align-middle"},l.entries.Lcz_Or," "),i("div",{class:"d-inline-flex col pr-0 align-middle"},i("input",{class:"form-control",type:"text",placeholder:l.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:t=>this.handleOptionalReason(t)}))),i("div",{class:"mb-1 w-100 pr-0 "},i("span",{class:"text-bold-700 font-medium-1"},l.entries.Lcz_AutomaticReleaseIn,": "),i("div",{class:"d-inline-block"},i("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:t=>this.handleReleaseAfterChange(t)},this.releaseList.map((t=>i("option",{value:+t.CODE_NAME,selected:this.blockDatesData.RELEASE_AFTER_HOURS==+t.CODE_NAME},t.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?i("div",{class:"d-inline-block releaseTime"},i("em",null,l.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};w.style=v;class D{setBookingInfoFromAutoComplete(t,e){t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:e.guest.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,a){let o=e;const{data:n,key:d,changedKey:l}=t.detail;const c=`c_${n.roomCategoryId}`;const r=`p_${n.ratePlanId}`;if(this.shouldClearData(d)){o=new Map}this.initializeRoomCategoryIfNeeded(c,o);if(s){if(l==="rate"){if(o.has(c)&&o.get(c).has(r)){this.applyBookingEditToSelectedRoom(c,r,n,o,a,i)}}else{if(l!=="rateType"){if(l==="adult_child_offering"){if(o.has(c)&&e.get(c).has(r)){this.applyBookingEditToSelectedRoom(c,r,n,o,a,i)}}else{this.applyBookingEditToSelectedRoom(c,r,n,o,a,i)}}}}else{this.setSelectedRoomData(c,r,n,o)}this.cleanupEmptyData(c,o);return o}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let a=s.get(t);if(i.totalRooms===0||i.inventory===0){a.delete(e)}else{s.set(t,a.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,a,o){s.clear();let n={};if(o){n=Object.assign(Object.assign({},i),{guestName:a||"",roomId:""})}else{n=Object.assign({},i)}s.set(t,(new Map).set(e,n))}async prepareBookUserServiceParams(t,e,i){try{const s=t.isEventType("EDIT_BOOKING")?t.getArrivalTimeForBooking():t.isEventType("ADD_ROOM")?t.bookingData.ARRIVAL.code:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.selectedArrivalTime.code:"";const a=t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:undefined;const o=t.isEventType("EDIT_BOOKING")||t.isEventType("ADD_ROOM")?t.bookingData.BOOKING_NUMBER:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.bookingNumber:undefined;let n=[];if(t.isEventType("ADD_ROOM")){n=t.bookingData.ROOMS}else if(t.isEventType("SPLIT_BOOKING")){n=t.bookedByInfoData.rooms}else if(t.isEventType("EDIT_BOOKING")){n=t.defaultData.ROOMS.filter((e=>e.identifier!==t.bookingData.IDENTIFIER))}return{bookedByInfoData:t.bookedByInfoData,check_in:e,fromDate:new Date(t.dateRangeData.fromDate),toDate:new Date(t.dateRangeData.toDate),guestData:t.guestData,totalNights:t.dateRangeData.dateDifference,source:i,propertyid:t.propertyid,rooms:n,pickup_info:t.bookingData.PICKUP_INFO||null,currency:t.currency,bookingNumber:o,defaultGuest:t.bookingData.GUEST,arrivalTime:s,pr_id:a,identifier:t.bookingData.IDENTIFIER,extras:null}}catch(t){console.error(t)}}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const a=`p_${t.RATE_PLAN_ID}`;const o={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(a,o))}}const O=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto;padding-bottom:85px !important}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.row.sc-igl-book-property{padding:0 0 0 15px;margin:0}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}";const _=O;const I=class{constructor(i){t(this,i);this.closeBookingWindow=e(this,"closeBookingWindow",7);this.bookingCreated=e(this,"bookingCreated",7);this.blockedCreated=e(this,"blockedCreated",7);this.resetBookingData=e(this,"resetBookingData",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.toast=e(this,"toast",7);this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new h;this.bookPropertyService=new D;this.eventsService=new p;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.buttonName=""}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}else return}componentDidLoad(){console.log("booking_data",this.bookingData);document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();const{key:e,data:i}=t.detail;if(e==="select"){const t=await this.bookingService.getExposedBooking(i.booking_nbr,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}else if(e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}async componentWillLoad(){this.bookingService.setToken(c.token);this.eventsService.setToken(c.token);this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE};this.handleKeyDown=this.handleKeyDown.bind(this);if(!this.bookingData.defaultDateRange){return}this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange);try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);if(this.isEventType("EDIT_BOOKING")){this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}if(this.defaultData.event_type==="SPLIT_BOOKING"){this.showSplitBookingOption=true;this.page="page_one"}else if(this.defaultData.event_type==="BLOCK_DATES"){this.page="page_block_date"}else{this.page="page_one"}}catch(t){console.error("Error fetching setup entries:",t)}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){if(this.guestData.length===0){return true}for(const t of this.guestData){if(t.guestName===""||(t.preference===""||t.preference===0)&&t.is_bed_configuration_enabled){return true}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.id,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag,type:t[0].type,id:t[0].id}}}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.adultChildCount=Object.assign({},t.detail)}async initializeBookingAvailability(t,e){const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.defaultData.roomsInfo.map((t=>t.id));const a=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:s,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:a.roomtypes})}catch(t){}}getRoomCategoryByRoomId(t){var e;return(e=this.defaultData.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.physicalrooms.find((e=>e.id===+t))))}getSplitBookings(){return this.defaultData.hasOwnProperty("splitBookingEvents")&&this.defaultData.splitBookingEvents||[]}closeWindow(){this.dateRangeData={};this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.initializeBookingAvailability(n(new Date(this.dateRangeData.fromDate)),n(new Date(this.dateRangeData.toDate)))}}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}renderPage(){this.renderAgain=!this.renderAgain}gotoSplitPageTwo(){this.gotoPage("page_two")}gotoPage(t){this.page=t;this.renderPage()}showSplitBooking(){this.showSplitBookingOption=true;this.gotoPage("page_one")}getPageBlockDatesView(){return i(a,null,i("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),i("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},i("ir-button",{text:l.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),i("ir-button",{text:l.entries.Lcz_Blockdates,isLoading:m("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})))}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);this.buttonName="book";break;case"bookAndCheckIn":this.bookUser(true);this.buttonName="bookAndCheckIn";break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(this.selectedUnits.size>0){this.gotoPage("page_two");break}else{if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}}this.toast.emit({type:"error",description:l.entries.Lcz_SelectRatePlan,title:l.entries.Lcz_SelectRatePlan});break;case"check":this.initializeBookingAvailability(n(new Date(this.dateRangeData.fromDate)),n(new Date(this.dateRangeData.toDate)));break}}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(){const t=d(+this.blockDatesData.RELEASE_AFTER_HOURS);const e=await this.bookingService.blockUnit(Object.assign({from_date:n(this.defaultData.defaultDateRange.fromDate),to_date:n(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t));const i=await f(e);this.blockedCreated.emit(i);this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else{if(this.isButtonDisabled()){this.isLoading="";return}}try{if(["003","002","004"].includes(this.defaultData.STATUS_CODE)){this.eventsService.deleteEvent(this.defaultData.POOL)}if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}const e=await this.bookPropertyService.prepareBookUserServiceParams(this,t,this.sourceOption);await this.bookingService.bookUser(e);this.resetBookingData.emit(null)}catch(t){}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}getArrivalTimeForBooking(){return this.bookedByInfoData.arrivalTime.find((t=>t.CODE_VALUE_EN===this.defaultData.ARRIVAL_TIME)).CODE_NAME}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}onRoomDataUpdate(t){const e=this.bookPropertyService.onDataRoomUpdate(t,this.selectedUnits,this.isEventType("EDIT_BOOKING"),this.isEventType("EDIT_BOOKING")||this.isEventType("SPLIT_BOOKING")||this.isEventType("BAR_BOOKING"),this.defaultData.NAME);this.selectedUnits=new Map(e);this.renderPage()}getCurrentPage(t){return this.page===t}render(){return i(s,{key:"9e5f6745fadb2c5f11da26de678643e9640656eb"},i("div",{key:"7114f9ff47ff7f4d9a0dc221a7d14b571586becc",class:"background-overlay",onClick:()=>this.closeWindow()}),i("div",{key:"1d5ea2a8215dcf6af4708cd92111aee480c1b00e",class:"sideWindow pb-5 pb-md-0 "+(this.getCurrentPage("page_block_date")?"block-date":"")},i("div",{key:"3d3b16d4a00316cf23dcff893e06985342787e83",class:"card position-sticky mb-0 shadow-none p-0 "},i("div",{key:"0e1b46fabfc93df98cf0fdfb5ff9d496daabe28d",class:"card-header-container mb-2"},i("h3",{key:"96fa48414622e52b1133f4c25108fbfd4c39a10d",class:" text-left font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),i("ir-icon",{key:"916ca43053cfde44df79306b6acd8e750fa323bd",class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},i("svg",{key:"628b5087a633b38f0bf8de8622fb9e123b5eb8fa",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"9251caf6525470c0b58109e6ef14239d943dd630",fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{key:"b55556718aa040ad1eaf562bc8a1f07994fd8783",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&i("igl-booking-overview-page",{key:"edd10f49c59ab17f200f4719ab1e275a17058bc6",initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,onRoomsDataUpdate:t=>{this.onRoomDataUpdate(t)},sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&i("igl-pagetwo",{key:"52197be468c56a57e98a8b6fbd75b3a8392b9658",currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};I.style=_;const C=".sc-igl-book-property-footer-h{display:block;margin:0;padding:0}.sc-igl-book-property-footer-h>*.sc-igl-book-property-footer{margin:auto;padding:auto}.gap-30.sc-igl-book-property-footer{gap:30px}";const B=C;const N=class{constructor(i){t(this,i);this.buttonClicked=e(this,"buttonClicked",7);this.eventType=undefined;this.disabled=true}isEventType(t){return t===this.eventType}editNext(t){if(this.isEventType("EDIT_BOOKING")){if(t==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton(t,e,s=false,a){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("ir-button",{btn_color:t==="cancel"?"secondary":"primary",text:e,btn_disabled:s,onClickHanlder:()=>{this.buttonClicked.emit({key:t})},icon_name:a,iconPostion:"right",style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){return i(s,{key:"1c1b3b203de19a641835d7d63369aa2771277672"},i("div",{key:"c6f63cef6e45e2cedeb7a8768fa7b16156fa8ae8",class:"d-flex justify-content-between gap-30 align-items-center"},this.isEventType("EDIT_BOOKING")?i(a,null,this.renderButton("cancel",l.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${l.entries.Lcz_Next}`,m("/Get_Exposed_Booking_Availability"),"angles_right")):i(a,null,this.renderButton("cancel",l.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${l.entries.Lcz_Next}`,false,"angles_right"))))}};N.style=B;const R=".sc-igl-book-property-header-h{display:block}.row.sc-igl-book-property-header{padding:0 0 0 15px;margin:0}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const T=R;const j=class{constructor(i){t(this,i);this.splitBookingDropDownChange=e(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=e(this,"sourceDropDownChange",7);this.adultChild=e(this,"adultChild",7);this.checkClicked=e(this,"checkClicked",7);this.buttonClicked=e(this,"buttonClicked",7);this.toast=e(this,"toast",7);this.spiltBookingSelected=e(this,"spiltBookingSelected",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.sourceOption={code:"",description:"",tag:"",id:"",type:""};this.splitBookingId="";this.bookingData="";this.minDate=undefined;this.sourceOptions=[];this.message=undefined;this.bookingDataDefaultDateRange=undefined;this.showSplitBookingOption=false;this.adultChildConstraints=undefined;this.splitBookings=undefined;this.adultChildCount=undefined;this.dateRangeData=undefined;this.bookedByInfoData=undefined;this.defaultDaterange=undefined;this.propertyId=undefined}getSplitBookingList(){return i("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},i("label",{class:"mr-lg-1"},l.entries.Lcz_Tobooking,"# "),i("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},i("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:u(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:u(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:l.entries.Lcz_BookingNumber,onComboboxValue:t=>{t.stopImmediatePropagation();this.spiltBookingSelected.emit(t.detail)},isSplitBooking:true})))}getSourceNode(){return i("fieldset",{class:"d-flex text-left  align-items-center"},i("label",{class:"mr-1"},l.entries.Lcz_Source," "),i("div",{class:"btn-group mt-0 flex-fill sourceContainer"},i("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:t=>this.sourceDropDownChange.emit(t.target.value)},this.sourceOptions.map((t=>{if(t.type==="LABEL"){return i("optgroup",{label:t.value})}return i("option",{value:t.id,selected:this.sourceOption.code===t.id},t.value)})))))}handleAdultChildChange(t,e){let i={};if(e===""){i=Object.assign(Object.assign({},this.adultChildCount),{[t]:0})}else{i=Object.assign(Object.assign({},this.adultChildCount),{[t]:e})}this.adultChild.emit(i)}getAdultChildConstraints(){return i("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},i("div",{class:"form-group my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},i("fieldset",null,i("div",{class:"btn-group "},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("adult",t.detail),select_id:"adult_child_select",firstOption:l.entries.Lcz_AdultsCaption,LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&i("fieldset",null,i("div",{class:"btn-group ml-1"},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("child",t.detail),select_id:"child_select",firstOption:this.renderChildCaption(),LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),i("ir-button",{btn_id:"check_availability",isLoading:m("/Get_Exposed_Booking_Availability"),icon:"",size:"sm",class:"ml-2",text:l.entries.Lcz_Check,onClickHanlder:()=>this.handleButtonClicked()})))}renderChildCaption(){const t=this.adultChildConstraints.child_max_age;let e=l.entries.Lcz_Years;if(t===1){e=l.entries.Lcz_Year}return`${l.entries.Lcz_ChildCaption} < ${this.adultChildConstraints.child_max_age} ${e}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:l.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=u(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const e=u(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=u(new Date(this.dateRangeData.fromDate));const s=u(new Date(this.dateRangeData.toDate));if(s.isBefore(e)||i.isAfter(t)){this.toast.emit({type:"error",title:`${l.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",u(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",u(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:l.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${l.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",u(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",u(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:l.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(t){return this.bookingData.event_type===t}render(){const t=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return i(s,{key:"55b62ea25933b51ecf1a7052d24a843643a2e8f2"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),t&&this.getSourceNode(),i("div",{key:"f14db7d62fa5aefeb952a523380dc24673302092",class:`d-flex flex-column flex-lg-row align-items-lg-center ${t?"mt-1":""}`},i("fieldset",{key:"ffb400ea8577bd6142702c5b65f120cabb34598f",class:"mt-lg-0  "},i("igl-date-range",{key:"85df3428f3d308a04ec291741744fdd78e6a669f",dateLabel:l.entries.Lcz_Dates,minDate:this.isEventType("PLUS_BOOKING")?u().add(-1,"months").startOf("month").format("YYYY-MM-DD"):this.minDate,disabled:this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),i("p",{key:"ff20b95b2fc9723cd256c2b8ffaf798fb18f7940",class:"text-right mt-1 message-label"},c.tax_statement))}};j.style=T;const S=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const E=S;const G=class{constructor(i){t(this,i);this.roomsDataUpdate=e(this,"roomsDataUpdate",7);this.bookingData=undefined;this.propertyId=undefined;this.message=undefined;this.showSplitBookingOption=undefined;this.eventType=undefined;this.currency=undefined;this.adultChildConstraints=undefined;this.ratePricingMode=undefined;this.dateRangeData=undefined;this.defaultDaterange=undefined;this.selectedRooms=undefined;this.adultChildCount=undefined;this.sourceOptions=undefined;this.bookedByInfoData=undefined;this.initialRoomIds=undefined}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const t=u(this.bookingData.FROM_DATE,"YYYY-MM-DD");const e=u();if(t.isAfter(e)){return e.add(-2,"weeks").format("YYYY-MM-DD")}return t.add(-2,"weeks").format("YYYY-MM-DD")}render(){var t,e;return i(s,{key:"10bb0647f1dda45256d5ebf4958db6e7617ea096"},i("igl-book-property-header",{key:"63fd9d685f7ae67eca115abcfdd593d6e6916d2b",bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"3c37f4c8c090eb15fd4e31db20c06bfab2308562",class:" text-left"},m("/Get_Exposed_Booking_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(a,null,(e=(t=this.bookingData)===null||t===void 0?void 0:t.roomsInfo)===null||e===void 0?void 0:e.map((t=>i("igl-booking-rooms",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomTypeData:t,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,defaultData:this.selectedRooms.get(`c_${t.id}`),onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)}))))),i("igl-book-property-footer",{key:"c934d624a9e3fe51a25070a00631539b0b76a80a",class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type,disabled:this.selectedRooms.size===0}))}};G.style=E;const A=".sc-igl-booking-room-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-booking-room-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-booking-room-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-booking-room-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-booking-room-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-state='focus'].sc-igl-booking-room-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-disabled].sc-igl-booking-room-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:40%}.rateplan-container.sc-igl-booking-room-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-booking-room-rate-plan{max-width:200px}.rate-input-container.sc-igl-booking-room-rate-plan{max-width:100px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:35%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-booking-room-rate-plan{width:100%}}.total-nights-container.sc-igl-booking-room-rate-plan{width:max-content}.nightBorder.sc-igl-booking-room-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const M=A;const K=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.gotoSplitPageTwoEvent=e(this,"gotoSplitPageTwoEvent",7);this.defaultData=undefined;this.ratePlanData=undefined;this.totalAvailableRooms=undefined;this.index=undefined;this.ratePricingMode=[];this.currency=undefined;this.physicalrooms=undefined;this.shouldBeDisabled=undefined;this.dateDifference=undefined;this.bookingType="PLUS_BOOKING";this.fullyBlocked=undefined;this.isBookDisabled=false;this.defaultRoomId=undefined;this.selectedRoom=undefined;this.is_bed_configuration_enabled=undefined;this.isInputFocused=false;this.selectedData=undefined;this.ratePlanChangedState=false}getAvailableRooms(t){let e=[];t.forEach((t=>{if(t.Is_Fully_Available){e.push({name:t.name,id:t.pr_id})}}));return e}componentWillLoad(){this.updateSelectedRatePlan(this.ratePlanData)}disableForm(){if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){return false}else{return this.selectedData.is_closed||this.totalAvailableRooms===0||c.is_frontdesk_enabled&&this.selectedData.physicalRooms.length===0}}setAvailableRooms(t){let e=this.getAvailableRooms(t);if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){if(this.selectedRoom){e.push({id:this.selectedRoom.roomId,name:this.selectedRoom.roomName});e.sort(((t,e)=>{if(t.name<e.name){return-1}if(t.name>e.name){return 1}return 0}))}}return e}getSelectedOffering(t){return this.ratePlanData.variations.find((e=>e.adult_child_offering===t))}updateSelectedRatePlan(t){var e;this.selectedData={is_bed_configuration_enabled:this.is_bed_configuration_enabled,ratePlanId:t.id,adult_child_offering:t.variations[0].adult_child_offering,rateType:1,totalRooms:0,rate:(e=t.variations[0].amount)!==null&&e!==void 0?e:0,ratePlanName:t.name,adultCount:t.variations[0].adult_nbr,childrenCount:t.variations[0].child_nbr,cancelation:t.cancelation,guarantee:t.guarantee,isRateModified:false,defaultSelectedRate:0,index:this.index,is_closed:t.is_closed,physicalRooms:this.setAvailableRooms(this.ratePlanData.assignable_units),dateDifference:this.dateDifference};if(this.defaultData){for(const[t,e]of Object.entries(this.defaultData)){this.selectedData[t]=e}this.selectedData["rateType"]=1}}componentDidLoad(){if(this.defaultData){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"physicalRooms",data:this.selectedData})}}async ratePlanDataChanged(t){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t.variations[0].adult_child_offering,adultCount:t.variations[0].adult_nbr,childrenCount:t.variations[0].child_nbr,rate:this.handleRateDaysUpdate(),physicalRooms:this.setAvailableRooms(t.assignable_units)});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}handleRateDaysUpdate(){if(this.selectedData.isRateModified){return this.selectedData.defaultSelectedRate}const t=this.getSelectedOffering(this.selectedData.adult_child_offering);return t?t.amount:0}handleInput(t){const e=t.target;let i=e.value.replace(/[^0-9.]/g,"");const s=/^\d*\.?\d*$/;if(!s.test(i)){i=i.substring(0,i.length-1)}e.value=i;if(i){this.selectedData.isRateModified=true;this.handleDataChange("rate",t)}else{this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:-1,totalRooms:0});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}}handleDataChange(t,e){const i=e.target.value;switch(t){case"adult_child_offering":this.updateOffering(i);break;case"rate":this.updateRate(i);break;default:this.updateGenericData(t,i);break}this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:t,data:this.selectedData})}updateOffering(t){const e=this.getSelectedOffering(t);if(e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t,adultCount:e.adult_nbr,childrenCount:e.child_nbr,rate:e.amount,isRateModified:false})}}updateRate(t){const e=t===""?0:Number(t);this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:e,totalRooms:t===""?0:this.selectedData.totalRooms,defaultSelectedRate:this.selectedData.rateType===2?e/this.dateDifference:e})}updateGenericData(t,e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{[t]:e===""?0:parseInt(e)})}bookProperty(){this.dataUpdateEvent.emit({key:"clearData",data:this.selectedData});this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){if(this.selectedData.isRateModified){console.log("selectedData.rate",this.selectedData.rate);return this.selectedData.rate===-1?"":this.selectedData.rate}return this.selectedData.rateType===1?Number(this.selectedData.rate).toFixed(2):Number(this.selectedData.rate/this.dateDifference).toFixed(2)}render(){return i(s,{key:"a034867af1eb7a8c4a17c619de19ec0cac96ffd1"},i("div",{key:"e5ed1c1cbca838ec8d2dcaacf4f736a333bd84b6",class:"d-flex flex-column m-0 p-0 flex-lg-row align-items-lg-center justify-content-lg-between "},i("div",{key:"584d2771ba66e6ba521c6048f8b0aa50b6fda427",class:"rateplan-name-container"},this.bookingType==="BAR_BOOKING"?i(a,null,i("span",{class:"font-weight-bold\t"},this.ratePlanData.name.split("/")[0]),i("span",null,"/",this.ratePlanData.name.split("/")[1])):i("span",null,this.ratePlanData.short_name),i("ir-tooltip",{key:"544bcec810e0eb07521ee8c371a4b58216d79967",message:this.ratePlanData.cancelation+this.ratePlanData.guarantee})),i("div",{key:"4f23e501566f807262dbbae160c667fc2273372a",class:"d-md-flex justify-content-md-end  align-items-md-center flex-fill rateplan-container"},i("div",{key:"c33b9536cb8c33e9f9da5ae50cae6d34ab23324c",class:"mt-1 mt-md-0 flex-fill max-w-300"},i("fieldset",{key:"0587315c40815c22d3fe274d45006d2ad533f0ee",class:"position-relative"},i("select",{key:"13a47a893c93874240644c985a8e307b6e42639f",disabled:this.disableForm(),class:"form-control  input-sm",id:r(),onChange:t=>this.handleDataChange("adult_child_offering",t)},this.ratePlanData.variations.map((t=>i("option",{value:t.adult_child_offering,selected:this.selectedData.adult_child_offering===t.adult_child_offering},t.adult_child_offering)))))),i("div",{key:"37da66fd94a035c3acae6e7ea1c87e700f2398a5",class:"m-0 p-0 mt-1 mt-md-0 d-flex justify-content-between align-items-md-center ml-md-1 "},i("div",{key:"150e6a6f6f03ab08361a929c89e209e0851c4019",class:" d-flex  m-0 p-0 rate-total-night-view  mt-0"},i("fieldset",{key:"a8d83407a5f0766c446115d4ff290e1d56548e36",class:"position-relative has-icon-left m-0 p-0 rate-input-container  "},i("div",{key:"ebfda851cb40c59270c08ec4fbb7fd39a060105a",class:"input-group-prepend"},i("span",{key:"f3441d4cfad04f81bfc616970dcdaee13aec9a8c","data-disabled":this.disableForm(),"data-state":this.isInputFocused?"focus":"",class:"input-group-text new-currency",id:"basic-addon1"},o(this.currency.code))),i("input",{key:"a1d40a0d7e67a833c60e93ba2426337cf63f73b2",onFocus:()=>this.isInputFocused=true,onBlur:()=>this.isInputFocused=false,disabled:this.disableForm(),type:"text",class:"form-control pl-0 input-sm rate-input py-0 m-0 rounded-0 rateInputBorder",value:this.renderRate(),id:r(),placeholder:l.entries.Lcz_Rate||"Rate",onInput:t=>this.handleInput(t)})),i("fieldset",{key:"cf2c15d69f7cf5a4e2c10fe8323744991963c3ac",class:"position-relative m-0 total-nights-container p-0 "},i("select",{key:"98f8c3c2b16201ed9115e179d9511e5c4eb57fdd",disabled:this.disableForm(),class:"form-control input-sm m-0 nightBorder rounded-0 m-0  py-0",id:r(),onChange:t=>this.handleDataChange("rateType",t)},this.ratePricingMode.map((t=>i("option",{value:t.CODE_NAME,selected:this.selectedData.rateType===+t.CODE_NAME},t.CODE_VALUE_EN)))))),this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"?i("div",{class:"flex-fill  mt-lg-0 ml-1 m-0 mt-md-0 p-0"},i("fieldset",{class:"position-relative"},i("select",{disabled:this.selectedData.rate===0||this.disableForm(),class:"form-control input-sm",id:r(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:this.totalAvailableRooms+1},((t,e)=>e)).map((t=>i("option",{value:t,selected:this.selectedData.totalRooms===t},t)))))):null),this.bookingType==="EDIT_BOOKING"?i(a,null,i("div",{class:" m-0 p-0  mt-lg-0  ml-md-1 mt-md-1 d-none d-md-block"},i("fieldset",{class:"position-relative"},i("input",{disabled:this.disableForm(),type:"radio",name:"ratePlanGroup",value:"1",onChange:t=>this.handleDataChange("totalRooms",t),checked:this.selectedData.totalRooms===1}))),i("button",{disabled:this.selectedData.rate===-1||this.disableForm(),type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 d-md-none ",onClick:()=>this.bookProperty()},this.selectedData.totalRooms===1?l.entries.Lcz_Current:l.entries.Lcz_Select)):null,this.bookingType==="BAR_BOOKING"||this.bookingType==="SPLIT_BOOKING"?i("button",{disabled:this.selectedData.rate===-1||this.disableForm()||this.bookingType==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 ",onClick:()=>this.bookProperty()},l.entries.Lcz_Book):null)))}static get watchers(){return{ratePlanData:["ratePlanDataChanged"]}}};K.style=M;const Y=".sc-igl-booking-rooms-h{display:block}.margin-bottom-8.sc-igl-booking-rooms{margin-bottom:8px !important}";const P=Y;const L=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"];this.roomTypeData=undefined;this.defaultData=undefined;this.bookingType="PLUS_BOOKING";this.dateDifference=undefined;this.ratePricingMode=[];this.roomInfoId=null;this.currency=undefined;this.selectedRooms=[];this.totalRooms=undefined;this.isBookDisabled=undefined;this.initialRoomIds=undefined;this.roomsDistributions=[]}componentWillLoad(){this.initializeRoomData()}initializeRoomData(){const{inventory:t,rateplans:e}=this.roomTypeData;this.totalRooms=t||0;this.selectedRooms=new Array(e.length).fill(0);this.roomsDistributions=this.calculateInitialDistributions(e,t)}handleRoomTypeData(){this.initializeRoomData()}calculateInitialDistributions(t,e){let i=new Array(t.length).fill(e);if(this.defaultData&&this.bookingType!=="EDIT_BOOKING"&&e>0){let t=[];let e=0;this.defaultData.forEach((s=>{this.selectedRooms[s.index]=s.totalRooms;i[s.index]=s.totalRooms;e+=s.totalRooms;t.push(s.index)}));if(t.length<i.length){i.forEach(((s,a)=>{if(!t.includes(a)){if(e===this.totalRooms){i[a]=0}else{i[a]=i[a]-e}}else{if(e<this.totalRooms){i[a]=this.totalRooms-e+i[a]}}}))}}else{i.fill(e)}return i}onRoomDataUpdate(t,e){t.stopImmediatePropagation();const{detail:{data:i,changedKey:s}}=t;let a=Object.assign({},i);if(s==="totalRooms"){this.handleTotalRoomsUpdate(e,a.totalRooms)}a=Object.assign(Object.assign({},a),{roomCategoryId:this.roomTypeData.id,roomCategoryName:this.roomTypeData.name,inventory:this.roomTypeData.inventory});this.dataUpdateEvent.emit({key:i.key,data:a,changedKey:s})}handleTotalRoomsUpdate(t,e){if(this.selectedRooms[t]!==e){this.selectedRooms[t]=e;this.updateRatePlanTotalRooms(t)}}updateRatePlanTotalRooms(t){const e=t=>this.selectedRooms.reduce(((e,i,s)=>s!==t?e+i:e),0);const i=this.selectedRooms.map(((i,s)=>{if(s===t){return this.roomsDistributions[s]}const a=e(s);const o=this.totalRooms-a;return o>0?o:0}));if(JSON.stringify(this.roomsDistributions)!==JSON.stringify(i)){this.roomsDistributions=[...i]}}render(){const t=this.validBookingTypes.includes(this.bookingType);return i(s,{key:"5b769fac02363d59dc7ed4e0400b97badb0f25f0"},t&&this.roomTypeData.rateplans.length>0&&i("div",{key:"3d05bb856afb15ce606d093428f24aa24d066505",class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomTypeData.name),this.roomTypeData.rateplans.map(((e,s)=>{if(e.variations!==null){let a=this.roomInfoId&&this.roomInfoId===this.roomTypeData.id;let o=-1;if(a&&this.initialRoomIds){o=this.initialRoomIds.roomId}return i("igl-booking-room-rate-plan",{is_bed_configuration_enabled:this.roomTypeData.is_bed_configuration_enabled,index:s,isBookDisabled:this.isBookDisabled,key:`rate-plan-${e.id}`,ratePricingMode:this.ratePricingMode,class:t?"":"",currency:this.currency,dateDifference:this.dateDifference,ratePlanData:e,totalAvailableRooms:this.roomsDistributions[s],bookingType:this.bookingType,defaultData:this.defaultData&&this.defaultData.get(`p_${e.id}`)||null,shouldBeDisabled:a,onDataUpdateEvent:t=>this.onRoomDataUpdate(t,s),physicalrooms:this.roomTypeData.physicalrooms,defaultRoomId:o,selectedRoom:this.initialRoomIds})}else{return null}})))}static get watchers(){return{roomTypeData:["handleRoomTypeData"]}}};L.style=P;const U=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center;inset:0}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}";const $=U;const z=class{constructor(i){t(this,i);this.dateSelectEvent=e(this,"dateSelectEvent",7);this.toast=e(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.withDateDifference=true;this.renderAgain=false}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:this.fromDateStr,toDateStr:this.toDateStr,dateDifference:this.totalNights})}}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}calculateTotalNights(){this.totalNights=b(u(this.fromDate).format("YYYY-MM-DD"),u(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){return i(s,{key:"0112708f033e5ed0bf807367b9955bc9e794e302"},i("div",{key:"e9e97488a86ec193f25b7f7243eca8da66037051",class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},i("ir-date-picker",{key:"9c001e9d82f8254d3e63a5861f0b1dfc1fcc1d03",maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),i("div",{key:"b8bab51d30a8ebf429570761a24831d7f6d930ca","data-state":this.disabled?"disabled":"active",class:"date-view"},i("svg",{key:"0dbdff27237f573f5378df04e8d7fc329c916d0f",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},i("path",{key:"cdf53aaebf6e8c2451e618c573115bf5252a65f2",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),i("ir-date-view",{key:"8ce8db7888c6034d976f269b047f6d0ac1e37178",showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&i("span",{key:"0c2090c8e1edb53b24222d42e8e8546cc6ef0caa"},this.totalNights&&!this.disabled?i("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${l.entries.Lcz_Nights}`:` ${l.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};z.style=$;const H=".sc-igl-pagetwo-h{display:block}.card-title.sc-igl-pagetwo{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-pagetwo{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-pagetwo{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-pagetwo{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-pagetwo{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-pagetwo:not(:disabled),[type='button'].sc-igl-pagetwo:not(:disabled){cursor:pointer}.row.sc-igl-pagetwo{padding:0 0 0 15px;margin:0}";const W=H;const F=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.buttonClicked=e(this,"buttonClicked",7);this.showPaymentDetails=undefined;this.currency=undefined;this.isEditOrAddRoomEvent=undefined;this.dateRangeData=undefined;this.bookingData=undefined;this.showSplitBookingOption=undefined;this.language=undefined;this.bookedByInfoData=undefined;this.propertyId=undefined;this.bedPreferenceType=undefined;this.selectedRooms=undefined;this.isLoading=undefined;this.countryNodeList=undefined;this.selectedGuestData=undefined;this.defaultGuestData=undefined;this.selectedBookedByData=undefined;this.guestData=undefined;this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const e=Object.assign({},this.selectedUnits);const i=(t,e,i,s)=>{if(i&&s===2){return t*e}return t};this.selectedUnits=e;this.guestData=[];this.selectedRooms.forEach(((s,a)=>{s.forEach((s=>{e[a]=s.selectedUnits;t+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,e){const i=t.detail;const s=`c_${i.data.roomCategoryId}`;const a=[...this.selectedUnits[s]||[]];a[e]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:a});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,e,i){if(e==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,i)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const e=(t,e,i)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return this.isLoading===t||e(this.selectedGuestData,"guestName","")||e(this.selectedBookedByData,"isdCode","")||e(this.selectedBookedByData,"contactNumber","")||e(this.selectedBookedByData,"firstName","")||e(this.selectedBookedByData,"lastName","")||e(this.selectedBookedByData,"countryId",-1)||e(this.selectedBookedByData,"selectedArrivalTime","")||e(this.selectedBookedByData,"email","")}render(){return i(s,{key:"7a87f4429f3f4ba2a8b8098e89d507cf2114e34f"},i("div",{key:"0c59d4c8f63e77ddcb39ab54620c8d481baf4756",class:"d-flex flex-wrap"},i("ir-date-view",{key:"6c413bb99b3124d3ed9f6c3754995d6e18b40fc4",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:this.dateRangeData.fromDateStr,to_date:this.dateRangeData.toDateStr,dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{key:"fabf9057d48425efce9dff7d70a639c744a7df58",class:"mt-1 mt-md-0 text-right"},l.entries.Lcz_TotalPrice," ",i("span",{key:"aa00c23cc991017912ce9555059b72f652ddfd8a",class:"font-weight-bold font-medium-1"},o(this.currency.code)+this.bookingData.TOTAL_PRICE||"$0.00"))),this.guestData.map(((t,e)=>i("igl-application-info",{dateDifference:this.dateRangeData.dateDifference,defaultGuestPreference:this.defaultGuestData.bed_preference,defaultGuestRoomId:this.defaultGuestData.PR_ID,currency:this.currency,bedPreferenceType:this.bedPreferenceType,index:e,selectedUnits:this.selectedUnits[`c_${t.roomCategoryId}`],guestInfo:t,guestRefKey:e,bookingType:this.bookingData.event_type,roomsList:t.physicalRooms,onDataUpdateEvent:t=>this.handleEventData(t,"application-info",e)}))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>this.handleEventData(t,"propertyBookedBy",0)}),this.isEditOrAddRoomEvent?i("div",{class:"d-flex p-0 mb-1 mt-2"},i("div",{class:"flex-fill mr-2"},i("ir-button",{icon:"",text:l.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"})})),i("div",{class:"flex-fill"},i("ir-button",{isLoading:this.isLoading==="save",onClickHanlder:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:l.entries.Lcz_Save}))):i("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},i("div",{class:"flex-fill mr-md-1"},i("ir-button",{icon_name:"angles_left",btn_color:"secondary",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"}),text:l.entries.Lcz_Back,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}})),i("div",{class:"mt-1 mt-md-0 flex-fill"},i("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"book"}),text:l.entries.Lcz_Book}))))}};F.style=W;const V=".sc-igl-property-booked-by-h{display:block}.row.sc-igl-property-booked-by{padding:0 0 0 15px;margin:0}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const q=V;const J=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.bookingService=new h;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.language=undefined;this.showPaymentDetails=false;this.defaultData=undefined;this.countryNodeList=[];this.propertyId=undefined;this.isButtonPressed=false;this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.bookingService.setToken(c.token);this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const t=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((e,i)=>(t+i).toString()))}async assignCountryCode(){const t=await this.bookingService.getUserDefaultCountry();const e=t["COUNTRY_ID"];this.country=e;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.toString(),countryId:e})}initializeDateData(){const t=new Date;const e=t.getMonth()+1;this.currentMonth=e<10?`0${e}`:e.toString()}populateBookedByData(){var t;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((t=this.defaultData)===null||t===void 0?void 0:t.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(t,e){this.bookedByData[t]=t==="emailGuest"?e.target.checked:e.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(t==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.target.value})}console.log(this.bookedByData)}handleNumberInput(t,e){const i=e.target;const s=i.value;const a=/^[0-9]+$/;if(!a.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(t,e)}}async handleEmailInput(t,e){const i=e.target;const s=i.value;if(this.isValidEmail(s)){this.handleDataChange(t,e)}}async checkUser(){try{const t=this.bookedByData.email;if(this.isValidEmail(t)){const e=await this.bookingService.getUserInfo(t);if(e!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:e.id,firstName:e.first_name,lastName:e.last_name,contactNumber:e.mobile,countryId:e.country_id,isdCode:e.country_id.toString()})}else{this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:undefined,firstName:"",lastName:"",contactNumber:"",countryId:"",isdCode:""})}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}}catch(t){}}isValidEmail(t){const e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;return e.test(t)}handleComboboxChange(t){t.stopImmediatePropagation();t.stopPropagation();const{key:e,data:i}=t.detail;switch(e){case"blur":if(i!==""){this.bookedByData.email=i;this.checkUser()}break;case"select":this.bookedByData.email=i.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile,countryId:i.country_id,isdCode:i.country_id.toString()});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData});break}}clearEvent(){this.bookedByData.email="";this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return i(s,{key:"c6fe8d8ee3483e34b19f226d8d6bef2210c178d5"},i("div",{key:"d314fb1d87d9c01ea11a7f370e321633cd060f43",class:"text-left mt-3"},i("div",{key:"4c0b26638992181276865a0f28894e1eaaf18e28",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},i("label",{key:"ae1e09dd3ecf3b7e5596e5bd5df1b9cbaa9b8f41",class:"p-0 m-0 label-control mr-1 font-weight-bold"},l.entries.Lcz_BookedBy),i("div",{key:"6bd219809bfb316ba74acb2b2c2c714553593d74",class:"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center"},i("ir-autocomplete",{key:"aca6096b8fb5175eb3199ff40510f98ddd055574",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"email",value:this.bookedByData.email,required:true,class:"flex-fill",placeholder:l.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent()}),i("ir-tooltip",{key:"e2a5f161c122fb7a407c24a06f7fc6584040881e",class:"ml-1",message:"Leave empty if email is unavailable"})))),i("div",{key:"2b83fdfe3b273b99bc2d0428893f1d23d3a8d0d3",class:"bookedDetailsForm text-left mt-2 font-small-3 "},i("div",{key:"b2f84a1c7522575a33a6892ed2291dc71a509958",class:"d-flex flex-column flex-md-row  justify-content-md-between "},i("div",{key:"7816391c85bda17b80aa3e00852b39fff958ff70",class:"p-0 flex-fill "},i("div",{key:"32168d85fcb430226e1160b087b6fb4654079669",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},i("label",{key:"51f35c554e470e54b6f8a7a68dbad1aba7097340",class:"p-0 m-0 margin3"},l.entries.Lcz_FirstName),i("div",{key:"442fa42beb54464c474ebea8ea4cbf394b890c39",class:"p-0 m-0  controlContainer flex-fill  "},i("input",{key:"b7435b224582c419263f6219f2ddaa070e1ee18a",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:l.entries.Lcz_FirstName,id:r(),value:this.bookedByData.firstName,onInput:t=>this.handleDataChange("firstName",t),required:true}))),i("div",{key:"c819367bd08452615f72750a7e4392d0186fb01d",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"22ded57ea17b54cea77cf1bca77a9fdd1ce60d36",class:"p-0 m-0 margin3"},l.entries.Lcz_LastName),i("div",{key:"0cf5b8dbbb27af47442a9221bdb3c7e980c32444",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"3c021d3316c74249b4f2370c442dbf450a77095d",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:l.entries.Lcz_LastName,id:r(),value:this.bookedByData.lastName,onInput:t=>this.handleDataChange("lastName",t)}))),i("div",{key:"0c02d2e51cbed6d105ae7afbf3786d5bdd74a7a9",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"5cbdf2ea859a0ac237a6bd5bea0cb4fde761c5ae",class:"p-0 m-0 margin3"},l.entries.Lcz_Country),i("div",{key:"acd0d054cd2db0872036f11f22a90f35d46e5159",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"da803cba43e9c4062ec55cbd6c3696519e3a43a6",class:`form-control input-sm pr-0`,id:r(),onChange:t=>this.handleDataChange("countryId",t)},i("option",{key:"b508d52f67c4262cf3c4e9ccd9a9bf52afe42d99",value:"",selected:this.bookedByData.countryId===""},l.entries.Lcz_Select),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.countryId===t.id},t.name)))))),i("div",{key:"0a26974c2e01afbd3a9afe3e40f83e1cb6176f6a",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"fe9871a9e20393c1646e74f24e2f57241ec133fa",class:"p-0 m-0 margin3"},l.entries.Lcz_MobilePhone),i("div",{key:"4dd12c61763e75eb1f3116ac30332f8e5b585743",class:"p-0 m-0  d-flex  controlContainer flex-fill"},i("div",{key:"e53c7873755226c67fc160152cc8b7d12b02b151",class:" p-0 m-0"},i("select",{key:"ec832d8a0b5321c70f9adc1114b0905a734def20",class:`form-control input-sm pr-0`,id:r(),onChange:t=>this.handleDataChange("isdCode",t)},i("option",{key:"f35d76efbc7fbe8b51b32085a0285bd70c60c0ce",value:"",selected:this.bookedByData.isdCode===""},l.entries.Lcz_Isd),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.isdCode===t.id.toString()},t.phone_prefix))))),i("div",{key:"cdd9126a95d74868e6a5f41c74dcadee57b17bcb",class:"flex-fill p-0 m-0"},i("input",{key:"5a8cc3e3624f724e9c529b45872e2993d47ba30c",class:`form-control\n                     \n                      `,type:"tel",placeholder:l.entries.Lcz_ContactNumber,id:r(),value:this.bookedByData.contactNumber,onInput:t=>this.handleNumberInput("contactNumber",t)})))),i("div",{key:"fea32615cb634a0ed2168653ad47f369fff90d86",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"c46e046bb02d52938defe38151f8a906b0b18023",class:"p-0 m-0 margin3"},l.entries.Lcz_YourArrivalTime),i("div",{key:"d8dc9a890400268154abd03ddc9684439910e777",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"c3bb9a0e6403b94735ac4d798cd62ad11990778a",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:r(),onChange:t=>this.handleDataChange("selectedArrivalTime",t)},this.arrivalTimeList.map((t=>i("option",{value:t.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===t.CODE_NAME},t.CODE_VALUE_EN))))))),i("div",{key:"e127518843ee87df2e2adb9376fa229e58983cef",class:"p-0 flex-fill  ml-md-3"},i("div",{key:"ab6a0c2d7baad70350974e761a9b71a2c8a5f79b",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},i("label",{key:"08be648d1e43d3a35df8e54fef710d07d62cd777",class:"p-0 m-0 margin3"},l.entries.Lcz_AnyMessageForUs),i("div",{key:"f018a9c14e7508dfd0f1cfeff76a43f06aa8390e",class:"p-0 m-0  controlContainer flex-fill "},i("textarea",{key:"0866b1096201c01cdec6ef92b3f90db3a4d09c6d",id:r(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:t=>this.handleDataChange("message",t)}))),this.showPaymentDetails&&i(a,{key:"0488b9b1cfcda466770b5b60f30638f7449510de"},i("div",{key:"cc898ea7cb03c890ef8c90af3b741dc04526354a",class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"4db78ff0085ad59be662a3b7c017bc853dd2b45c",class:"p-0 m-0 margin3"},l.entries.Lcz_CardNumber),i("div",{key:"e02483f8e5dd3b81297b669ad6b2e9f2ebe068ff",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"cfa71772b8e67a3fd0f2530fc695ef116100c532",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:r(),value:this.bookedByData.cardNumber,onInput:t=>this.handleNumberInput("cardNumber",t)}))),i("div",{key:"8469963e3907b1f64b83fc273bd7288731692e7b",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"9ecef93da9c66d747918b3825416e3beb055594b",class:"p-0 m-0 margin3"},l.entries.Lcz_CardHolderName),i("div",{key:"ad48211c7b59c3afc9f7f655eab51ede3af5bd7d",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"981ce8d16831e4c5432e54247c4c64b829be8785",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:r(),value:this.bookedByData.cardHolderName,onInput:t=>this.handleDataChange("cardHolderName",t)}))),i("div",{key:"7cf1cecbc796b54cfa5dd323933b911a7776fc6f",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"d4d317f476ba01c7b048f40302b55f9e3f26d59a",class:"p-0 m-0 margin3"},l.entries.Lcz_ExpiryDate),i("div",{key:"d74523ab77e748f65bdd655f2ee809ac44d17bea",class:"p-0 m-0 row  controlContainer flex-fill"},i("div",{key:"bb4782ca5a4cdd957d40739c2c74a1e8c1ffc0a2",class:"p-0 m-0"},i("select",{key:"013929df8862fe4aaf9e262632bcad5b45b05bde",class:"form-control input-sm pr-0",id:r(),onChange:t=>this.handleDataChange("expiryMonth",t)},this.expiryMonths.map((t=>i("option",{value:t,selected:t===this.bookedByData.expiryMonth},t))))),i("div",{key:"1d90aa867b442395db20e6ed62df3f1664d1bc45",class:"p-0 m-0 ml-1"},i("select",{key:"7360165fc1b231ab1907f0074e39d24702e33ec1",class:"form-control input-sm pr-0",id:r(),onChange:t=>this.handleDataChange("expiryYear",t)},this.expiryYears.map(((t,e)=>i("option",{value:t,selected:e===this.bookedByData.expiryYear},t)))))))),i("div",{key:"765954485b755437d4876da874867f499f94e647",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},i("label",{key:"750ebfe0f0294687f763fc7d1526b3df64ac61e3",class:"p-0 m-0",htmlFor:"emailTheGuestId"},l.entries.Lcz_EmailTheGuest),i("div",{key:"5fde2849b195bcacd285acc8b21af3cd1934799a",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},i("input",{key:"af4856366408c083696d43b845303e25f4bbcd52",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:t=>this.handleDataChange("emailGuest",t)})))))))}};J.style=q;export{k as igl_application_info,w as igl_block_dates_view,I as igl_book_property,N as igl_book_property_footer,j as igl_book_property_header,G as igl_booking_overview_page,K as igl_booking_room_rate_plan,L as igl_booking_rooms,z as igl_date_range,F as igl_pagetwo,J as igl_property_booked_by};
//# sourceMappingURL=p-b5d3f248.entry.js.map