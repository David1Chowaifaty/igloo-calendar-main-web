{"version":3,"names":["VariationService","formatVariationBasedOnInfants","params","variation","this","getVariationBasedOnInfants","formatVariation","infants","calculateVariationAmount","_a","discounted_amount","variations","baseVariation","adult_nbr","child_nbr","find","v","Math","max","infant_nbr","adultNumber","Number","infantNumber","adultLabel","locales","entries","Lcz_Adults","toLowerCase","Lcz_Adult","childLabel","Lcz_Children","Lcz_Child","infantLabel","_b","_d","_c","parts","filter","Boolean","join","iglApplicationInfoCss","IglApplicationInfoStyle0","IglApplicationInfo","constructor","hostRef","bedPreferenceType","bookingType","totalNights","isButtonPressed","variationService","componentWillLoad","isSingleUnit","rateplanSelection","roomtype","id","filteredRooms","filterRooms","length","updateGuest","unit","toString","roomTypeId","ratePlanId","ratePlan","prevGuest","guest","roomIndex","Object","assign","booking_store","ratePlanSelections","handleButtonClicked","event","detail","key","getTooltipMessages","selected_variation","selectedVariation","guestInfo","matchingVariation","cancellationPolicy","_e","applicable_policies","p","type","combined_statement","guaranteePolicy","_g","_f","tooltip","undefined","getAmount","is_amount_modified","view_mode","rp_amount","discounted_gross_amount","result","calendar_data","is_frontdesk_enabled","assignable_units","forEach","Is_Fully_Available","push","name","pr_id","filteredGuestsRoom","_","i","map","r","filteredResults","includes","baseData","roomtypeId","f","sort","a","b","localeCompare","render","filteredRoomList","formattedVariation","h","Host","class","short_name","is_non_refundable","message","innerHTML","formatAmount","currency","symbol","Lcz_Stay","v4","first_name","placeholder","onInput","target","value","event_type","modifyBookingStore","required","last_name","onChange","selected","_h","Lcz_Assignunits","room","is_bed_configuration_enabled","_j","bed_preference","_k","Lcz_BedConfiguration","data","CODE_NAME","CODE_VALUE_EN","_l","style","gap","marginTop","_m","width","_o","Array","from","item","IglBookPropertyService","setBookingInfoFromAutoComplete","context","res","bookedByInfoData","email","firstName","lastName","countryId","country_id","isdCode","country_phone_prefix","contactNumber","mobile","selectedArrivalTime","arrival","emailGuest","subscribe_to_news_letter","remark","cardNumber","cardHolderName","expiryMonth","expiryYear","bookingNumber","booking_nbr","rooms","from_date","to_date","resetRoomsInfoAndMessage","defaultData","roomsInfo","onDataRoomUpdate","selectedUnits","isEdit","isEditBooking","units","changedKey","roomCategoryKey","roomCategoryId","ratePlanKey","shouldClearData","Map","initializeRoomCategoryIfNeeded","has","get","applyBookingEditToSelectedRoom","setSelectedRoomData","cleanupEmptyData","set","selectedRatePlans","totalRooms","inventory","delete","fill","size","clear","guestName","roomId","calculateAmount","total_days","nights","generateDailyRates","rate_plan","amount","n","date","night","cost","getBookedRooms","check_in","check_out","notes","identifier","override_unit","auto_check_in","rateplanId","rateplan","reserved","prepayment_amount_gross","occupancy","children_nbr","moment","format","days","city","address","dob","cci","prepareBookUserServiceParams","sourceOption","dateRangeData","Error","fromDate","Date","toDate","generateNewRooms","isEventType","bookingData","PR_ID","modifyBookingDetails","pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras","rest","__rest","assign_units","is_pms","is_backend","booking","newBooking","console","log","currentRoomType","newRooms","in_out","code","previousRooms","isAgent","e","selectedPaymentMethod","agent","tag","property","propertyid","booked_on","hour","getHours","minute","getMinutes","source","nbr","holder_name","expiry_month","expiry_year","error","getRoomCategoryByRoomId","roomCategory","RATE_TYPE","setEditingRoomInfo","category","room_id","RATE_PLAN_ID","adultCount","ADULTS_COUNT","rate","RATE","rateType","roomCategoryName","ratePlanName","RATE_PLAN","NAME","cancelation","guarantee","adult_child_offering","iglBookPropertyCss","IglBookPropertyStyle0","sheetCss","IglBookPropertyStyle1","IglBookProperty","showPaymentDetails","adultChildCount","adult","child","renderAgain","bookingHistory","initialRoomIds","showSplitBookingOption","sourceOptions","guestData","blockDatesData","ratePricingMode","bookingService","BookingService","bookPropertyService","updatedBooking","MAX_HISTORY_LENGTH","roomTypes","handleKeyDown","bind","initializeDefaultDateRange","defaultDateRange","initializeDefaultData","wasBlockedUnit","hasOwnProperty","fetchSetupEntriesAndInitialize","componentDidLoad","document","addEventListener","handleBodyOverflow","disconnectedCallback","removeEventListener","clearBooking","stopImmediatePropagation","stopPropagation","renderPage","handleSpiltBookingSelected","getExposedBooking","language","handleAdultChildChange","updateBookingHistory","adults","children","onDateRangeSelect","opt","dates","checkIn","checkOut","checkBookingAvailability","handleSourceDropDown","selectedSource","description","gotoSplitPageTwo","gotoPage","bookUser","closeWindow","resetReserved","animateIrSelect","emit","calculateTotalRooms","animateIrButton","toast","Lcz_SelectRatePlan","title","partialData","lastEntry","newEntry","shift","FROM_DATE","TO_DATE","setupEntries","fetchSetupEntries","setSourceOptions","allowedBookingSources","setOtherProperties","initializeEventData","initializeEditBookingData","initializePage","CHILDREN_COUNT","roomName","GUEST","page","isGuestDataIncomplete","isButtonDisabled","isValidProperty","comparedBy","bookingSource","_sourceOptions","getFilteredSourceOptions","SOURCE","option","o","agentIds","Set","hasAgentOnlyRoomType","some","rt","rps","rateplans","isForAgentOnly","every","rp","agents","ag","add","candidate","matchesId","arrivalTime","resetBookingStore","is_in_agent_mode","room_type_ids_to_update","room_type_ids","getBookingAvailability","agent_id","updateBooking","roomtype_id","reserveRooms","checkAndBlockDate","block_exposed_unit_props","isAvailable","is_available_to_book","handleBlockDate","didReservation","el","querySelector","classList","setTimeout","closeBookingWindow","handleBlockDateUpdate","handleGuestInfoUpdate","guestRefKey","handleBookedByInfoUpdate","getPageBlockDatesView","Fragment","entryDate","ENTRY_DATE","onDataUpdateEvent","handlePageTwoDataUpdateEvent","auto_close","props","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","dateToFormattedString","NOTES","OPTIONAL_REASON","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","blockUnit","setLoadingState","isLoading","isEditOrAdd","allowed_booking_sources","serviceParams","doReservation","adjustBlockedDatesAfterReservation","resetBookingEvt","resetLoadingState","original_from_date","current_from_date","original_to_date","current_to_date","isBefore","isAfter","getCurrentPage","onClick","isRequestPending","BLOCK_DATES_TITLE","TITLE","onIconClickHandler","slot","xmlns","viewBox","height","d","defaultDaterange","eventType","selectedRooms","adultChildConstraints","propertyId","selectedGuestData","countries","defaultGuestData","isEditOrAddRoomEvent","text","Lcz_Cancel","btn_color","Lcz_Blockdates","iglBookPropertyFooterCss","IglBookPropertyFooterStyle0","IglBookPropertyFooter","disabled","editNext","label","renderButton","icon_name","icon_position","shouldRenderTwoButtons","btn_disabled","onClickHandler","buttonClicked","btn_styles","iconPosition","icon_style","paddingBottom","Lcz_Next","showBookAndCheckin","checkin_enabled","isSame","Lcz_Back","Lcz_Save","Lcz_Book","Lcz_BookAndChekcIn","iglBookPropertyHeaderCss","IglBookPropertyHeaderStyle0","IglBookPropertyHeader","splitBookingId","getSplitBookingList","Lcz_Tobooking","keys","bookingDataDefaultDateRange","Lcz_BookingNumber","onComboboxValue","spiltBookingSelected","isSplitBooking","getSourceNode","Lcz_Source","evt","sourceDropDownChange","obj","adultChild","getAdultChildConstraints","testId","selectedValue","onSelectChange","selectId","firstOption","Lcz_AdultsCaption","adult_max_nbr","child_max_nbr","renderChildCaption","btn_id","Lcz_Check","maxAge","child_max_age","years","Lcz_Years","Lcz_Year","Lcz_ChildCaption","Lcz_ChooseBookingNumber","position","initialToDate","initialFromDate","selectedFromDate","selectedToDate","Lcz_CheckInDateShouldBeMAx","replace","Lcz_PlzSelectNumberOfGuests","minDate","getTime","getMinDate","startOf","getMaxDate","showSourceNode","variant","dateLabel","Lcz_Dates","maxDate","tax_statement","iglBookingFormCss","IglBookingFormStyle0","IglBookingForm","initializeGuestData","selectedBookedByData","total","newSelectedUnits","getRate","isRateModified","preference","dateDifference","TOTAL_PRICE","handleOnApplicationInfoDataUpdateEvent","index","categoryIdKey","updatedUnits","dataUpdateEvent","handleEventData","dateOption","Lcz_TotalPrice","values","val","iglBookingOverviewPageCss","IglBookingOverviewPageStyle0","IglBookingOverviewPage","getSplitBookings","splitBookingEvents","setMinDate","today","splitBookings","roomType","isBookDisabled","roomInfoId","roomsDataUpdate","iglPropertyBookedByCss","IglPropertyBookedByStyle0","IglPropertyBookedBy","bookedByData","arrivalTimeList","expiryMonths","expiryYears","currentMonth","paymentMethods","assignCountryCode","initializeExpiryYears","initializeDateData","populateBookedByData","allowed_payment_methods","is_active","is_payment_gateway","currentYear","getFullYear","country","getUserDefaultCountry","dt","month","getMonth","handleDataChange","checked","handleCountryChange","handleNumberInput","inputElement","inputValue","numericRegex","test","checkUser","z","string","safeParse","success","getUserInfo","mobile_without_prefix","prevBookedByData","checkout_guest","handleComboboxChange","clearEvent","Lcz_BookedBy","Lcz_FindEmailAddress","onInputCleared","danger_border","validateEmail","Lcz_FirstName","Lcz_LastName","Lcz_Country","onCountryChange","c","Lcz_MobilePhone","phone_prefix","default_country","onTextChange","Lcz_YourArrivalTime","time","Lcz_AnyMessageForUs","rows","showFirstOption","Lcz_CardNumber","pattern","Lcz_CardHolderName","Lcz_ExpiryDate","year","localizables","l","htmlFor","Lcz_EmailTheGuest","iglRoomTypeCss","IglRoomTypeStyle0","IglRoomType","roomsDistributions","validBookingTypes","isValidBookingType","shouldBeDisabled","visibleInventory","getVisibleInventory","HelpDocButton","href","wrapperClass","customSlot","rel","ApplicablePoliciesService","_booking","fetchGroupedApplicablePolicies","status","groupedRooms","groupRoomsForRequest","requests","grouping","basePayload","currency_id","property_id","rate_plan_id","room_type_id","is_preserve_history","identifiers","roomIdentifier","getExposedApplicablePolicies","room_identifier","then","policies","groupedPolicies","Promise","all","policiesByType","buildPoliciesByType","cancellationStatements","buildCancellationStatements","guaranteeAmount","calculateGuaranteeAmount","String","groupMap","group","flattened","flatMap","groupPoliciesByType","reduce","acc","policy","statements","checkInDate","isValid","oldBrackets","brackets","bracket","bracketDate","due_on","hasPositiveBracket","filteredBrackets","nextBracket","mergeBracketsByAmount","inDate","outDate","stayNights","diff","fullChargeDate","clone","amount_formatted","due_on_formatted","gross_amount","gross_total","gross_amount_formatted","statement","aDate","bDate","valueOf","grossTotal","currentBracket","selectCurrentBracket","roomsTotal","dueDate","isSameOrAfter","last","irApplicablePoliciesCss","IrApplicablePoliciesStyle0","IrApplicablePolicies","shouldShowCancellationBrackets","applicablePoliciesService","loadApplicablePolicies","handleBookingChange","formatPreviousBracketDueOn","d1","d2","getBracketLabelsAndArrowState","leftLabel","rightLabel","showArrow","bookedOnDate","bracketDueDate","warn","handleSingleBracket","_brackets","handleMultipleBrackets","momentCheckInDate","nextBracketDueDate","periodEndDate","haveSameDays","generateCancellationStatement","cancelation_penality_as_if_today","financial","collected","abs","_getCurrentBracket","isArray","parsed","x","cur","next","remainingGuaranteeAmount","generatePayment","pay_type_code","reason","Lcz_NonRefundable","idx","isInCurrentBracket","irBookingDetailsCss","IrBookingDetailsStyle0","IrBookingDetails","ticket","is_from_front_desk","hasPrint","hasReceipt","hasDelete","hasMenu","hasRoomEdit","hasRoomDelete","hasRoomAdd","hasCheckIn","hasCheckOut","hasCloseButton","bookingItem","statusData","calendarData","rerenderFlag","sidebarState","isUpdateClicked","isPMSLogLoading","modalState","roomService","RoomService","paymentService","PaymentService","token","Token","printingBaseUrl","handleDeleteFinish","splitIndex","buildSplitIndex","setToken","initializeApp","ticketChanged","newValue","oldValue","handleSideBarEvents","sidebarPayload","payload","handleIconClick","closeSidebar","Lcz_EmailBookingto","loading","modalRef","openModal","openPrintingScreen","window","location","ID","EMAIL","PHONE","REFERENCE_TYPE","ARRIVAL","Lcz_AddingUnitToBooking","fromDateStr","toDateStr","BOOKING_NUMBER","ADD_ROOM_TO_BOOKING","ROOMS","handleResetExposedCancellationDueAmount","paymentActions","GetExposedCancellationDueAmount","handleEditInitiated","handleRoomGuestsUpdate","guests","currentRoomIndex","findIndex","currentRoom","updatedRoom","sharing_persons","handleResetBooking","resetBooking","handleEditExtraService","selectedService","setRoomsData","roomServiceResp","roomsData","My_Result","roomtypes","expanded","roomResponse","languageTexts","countriesList","bookingDetails","getExposedProperty","aname","fetchLanguage","getCountries","getSetupEntriesByTableNameMulti","bed_preference_type","departure_time","pay_type","pay_type_group","pay_method","groupEntryTablesResult","bedPreference","departureTime","paymentEntries","types","groups","methods","direction","myResult","adult_child_constraints","calendar_legends","legendData","paymentCodesToShow","method","mode","version","open","system_id","url","axios","post","ExceptionMsg","handleCloseBookingWindow","bookingChanged","handleModalConfirm","sendBookingConfirmationEmail","closeModal","renderSidebarContent","handleClose","isInSideBar","headerShown","onCloseSideBar","bookingDates","to","defaultPickupData","numberOfPersons","onCloseModal","service","totalGuests","sharedPersons","checkin","payment","computeRoomGroups","indexById","hasSplitGroups","groupSortKey","groupRooms","min","MAX_SAFE_INTEGER","ts","parse","isNaN","sortedRooms","order","isSplit","sortKey","roomsById","grouped","visited","head","heads","chain","chainOf","chainRooms","chainHasSplitLink","parent","parentOf","childrenOf","is_split","singleGroup","merged","curr","concat","renderRoomItem","bookingIndex","includeDepartureTime","showCheckin","handleRoomCheckin","showCheckout","handleRoomCheckout","bedPreferences","isEditable","is_editable","myRoomTypeFoodCat","mealCodeName","onDeleteFinished","renderRooms","groupIdx","isLastGroup","roomIdx","roomsSection","hasEmail","Lcz_ExtraServices","modalBody","leftBtnText","rightBtnText","Lcz_Confirm","autoClose","ref","onConfirmModal","onCancelModal","side","onIrSidebarToggle","showCloseButton","onCloseBookingWindow","is_automatic_check_in_out","irBookingExtraNoteCss","IrBookingExtraNoteStyle0","IrBookingExtraNoteStyle1","IrBookingExtraNote","note","setNote","getPrivateNote","savePrivateNote","prevExtras","newExtraObj","oldPrivateNoteIndex","Is_Non_Technical_Change","onSubmit","preventDefault","Lcz_PrivateNote","displayContext","Lcz_PrivateNote_MaxChar","maxLength","btn_type","irBookingGuaranteeCss","IrBookingGuaranteeStyle0","IrBookingGuarantee","collapsed","paymentDetailsUrl","paymentExceptionMessage","formatCurrency","locale","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","checkPaymentCode","pm","getPaymentMethod","paymentMethod","payment_code","Lcz_OnCredit","handleToggleCollapse","channel_booking_nbr","getPCICardInfoURL","shouldShowGuarantee","shouldShowToggleButton","renderCreditCardInfo","cvc","renderCollapsedContent","src","frameborder","renderOtaGuarantee","ota_guarante","content","card_type","is_virtual","labelText","Lcz_CardType","cardholder_name","card_number","toFloat","meta","virtual_card_current_balance","virtual_card_decimal_places","virtual_card_currency_code","Lcz_CardBalance","Lcz_BookingGuarantee","irBookingHeaderCss","IrBookingHeaderStyle0","IrBookingHeader","bookingStatus","confirmationBG","alertMessage","handleSelectChange","updateStatus","Lcz_SelectStatus","changeExposedBookingStatus","book_nbr","Lcz_StatusUpdatedSuccessfully","openDialog","currentDialogStatus","dialogRef","renderDialogBody","lastManipulation","ota_manipulations","Lcz_Booking","flexWrap","is_requested_to_cancel","Lcz_CancellationRequested","trigger","renderContentAsHtml","user","marginBottom","allowed_actions","selectContainerStyle","selectStyles","Lcz_Select","textSize","modalEl","Lcz_EventsLog","is_pms_enabled","Lcz_pms","colorVariants","danger","onOpenChange","modalTitle","Lcz_OTA_Modification_Alter","irDialogCss","IrDialogStyle0","IrDialog","hasTitleSlot","hasBodySlot","previouslyFocused","instanceId","dialogIds","handleCancel","handleNativeClose","hideDialog","onTitleSlotChange","assignedNodes","flatten","onBodySlotChange","onCloseButtonClick","titleId","descriptionId","dialogEl","syncSlotState","showDialog","restoreFocus","handleOpenChange","activeElement","showModal","setAttribute","openChange","close","focus","preventScroll","titleSlot","bodySlot","labelledBy","describedBy","role","onSlotchange","focusable","irDropdownCss","IrDropdownStyle0","IrDropdown","caret","isOpen","focusedIndex","itemChildren","mo","isComponentConnected","updateQueued","handleDocumentClick","contains","closeDropdown","maxIndex","openDropdown","focusItemElement","selectItemElement","selectedOption","documentClickHandler","collectItemChildren","MutationObserver","requestAnimationFrame","observe","childList","subtree","passive","updateItemElements","updateDropdownItemValue","disconnect","handleDocumentKeyDown","handleDropdownItemSelect","ev","selectOption","handleDropdownItemRegister","handleDropdownItemUnregister","handleValueChange","removeAttribute","getSelectedItemIndex","scrollToSelectedItem","removeItemFocus","items","querySelectorAll","element","remove","scrollIntoView","block","behavior","click","selectedElement","inline","optionChange","onKeyDown","tabindex","irDropdownItemCss","IrDropdownItemStyle0","IrDropdownItem","hasRegistered","hidden","handleClick","dropdownItemSelect","dropdownItemRegister","parentElement","parentDropdown","closest","dropdownItemUnregister","matchesQuery","query","q","hay","textContent","setHidden","html_content","irEventsLogCss","IrEventsLogStyle0","IrEventsLog","init","bookingEvents","events","opacity","padStart","second","irExtraServiceCss","IrExtraServiceStyle0","IrExtraService","deleteService","doBookingExtraService","is_remove","price","currencySymbol","booking_system_id","secondary","editExtraService","irModalRef","start_date","end_date","showDateDifference","iconAvailable","icon","Lcz_Delete","leftBtnColor","rightBtnColor","Lcz_Confirmation","Lcz_ThisService","Lcz_FromThisBooking","ZIdInfo","object","union","literal","optional","number","nullable","ZSharedPerson","coerce","refine","transform","isDDMMYYYY","id_info","is_main","boolean","default","validateSharedPerson","hasValue","field","trim","ctx","path","ZodIssueCode","custom","hasAnyFieldData","ZodError","ExtraServiceSchema","irExtraServiceConfigCss","IrExtraServiceConfigStyle0","IrExtraServiceConfigStyle1","IrExtraServiceConfig","s_service","saveAmenity","updateService","prevService","validatePrice","priceSchema","pick","async","Lcz_Description","Lcz_DatesOn","emitEmptyDate","onDateChanged","start","_formatDate","borderLeftWidth","borderRightWidth","borderRadius","Lcz_TillAndIncluding","zod","Lcz_Price","wrapKey","autoValidate","parseFloat","Lcz_Cost","labelStyle","_p","irExtraServicesCss","IrExtraServicesStyle0","IrExtraServices","irGuestInfoCss","IrGuestInfoStyle0","IrGuestInfoStyle1","GuestInfo","getToken","fetchedLocales","fetchGuest","resolve","handleInputChange","editGuest","editExposedGuest","closeSideBar","Lcz_GuestDetails","Lcz_Email","Lcz_AlternativeEmail","alternative_email","Lcz_Newsletter","color","irPaymentDetailsCss","IrPaymentDetailsStyle0","IrPaymentDetails","confirmModal","toBeDeletedItem","modalMode","handleAddPayment","designation","reference","cashMethod","pt","payment_method","operation","paymentType","payment_type","openSidebar","handleEditPayment","handleDeletePayment","handleConfirmModal","cancelPayment","handleCancelModal","handlePaymentGeneration","CancelPayment","newPaymentArray","payments","resetExposedCancellationDueAmount","modal","hasValidFinancialData","shouldShowRefundButton","due_amount","shouldCancellationButton","isBookingCancelled","totalCost","gross_cost","balance","refunds","onAddPayment","onEditPayment","onDeletePayment","Lcz_IfDeletedPermantlyLost","Lcz_EnteringAmountGreaterThanDue","irPaymentFolioCss","IrPaymentFolioStyle0","IrPaymentFolioStyle1","IrPaymentFolio","_paymentTypes","folioSchema","regex","dateStr","folioData","getPaymentTypes","handlePaymentChange","handlePaymentTypesChange","updateFolioData","savePayment","errors","AddPayment","err","issues","handleDropdownChange","PAYMENT_TYPES_WITH_METHOD","handlePaymentMethodDropdownChange","rec","buildPaymentTypes","PAYMENTS","CANCELLATION","renderDropdownItems","border","borderTopLeftRadius","borderBottomLeftRadius","onOptionChange","_r","_q","_t","_s","_u","_w","_v","_x","_y","_0","_z","_1","_3","_2","containerClassname","labelContainerClassname","minValue","_4","_5","_7","_6","_8","_9","reference_number","inputContainerStyle","margin","labelWidth","irPaymentItemCss","IrPaymentItemStyle0","IrPaymentItem","isCredit","paymentDescription","part","time_stamp","editPayment","deletePayment","irPaymentSummaryCss","IrPaymentSummaryStyle0","IrPaymentSummary","shouldShowTotalCost","Lcz_TotalCost","Lcz_Balance","Lcz_Collected","irPaymentsFolioCss","IrPaymentsFolioStyle0","IrPaymentsFolio","addPayment","hasPayments","renderPaymentItem","renderEmptyState","PickupService","savePickup","splitTime","arrival_time","split","arrival_date","details","flight_details","nbr_of_units","number_of_vehicles","selected_option","due_upon_booking","transformDefaultPickupData","renderTime","toFixed","vehicle_type_code","vehicle","getAvailableLocations","locations","pickup_service","allowed_options","createPickupSchema","isBetween","hours","minutes","nonempty","validateForm","schema","getNumberOfVehicles","capacity","total_number_of_vehicles","ceil","startNumber","bonus_number","getPickUpPersonStatus","getCodeDescription","allowed_pricing_models","model","updateDue","irPickupCss","IrPickupStyle0","IrPickupStyle1","IrPickup","allowedOptionsByLocation","pickupData","vehicleCapacity","cause","pickupService","arrival_time_mask","mask","blocks","HH","MaskedRange","placeholderChar","mm","lazy","transformedData","pickupSchema","handleLocationChange","updatePickupData","locationChoice","pricing_model","handleVehicleQuantityChange","handleVehicleTypeChange","Lcz_Pickup","Lcz_Pickup_NoThankYou","Lcz_Pickup_YesFrom","Lcz_ArrivalDate","Lcz_Time","inputStyles","Lcz_FlightDetails","labelBorder","Lcz_NbrOfVehicles","readOnly","Lcz_DueUponBooking","irPickupViewCss","IrPickupViewStyle0","IrPickupView","is_enabled","Lcz_Date","_formatTime","pickup_instruction","pickup_cancelation_prepayment","irPmsLogsCss","IrPmsLogsStyle0","IrPmsLogs","pmsLogs","fetchPMSLogs","Lcz_PMS_Logs","Lcz_SentAt","sent_date","sent_hour","sent_minute","is_acknowledged","Lcz_YES","Lcz_NO","Lcz_Acknowledged","irReservationInformationCss","IrReservationInformationStyle0","IrReservationInformation","userCountry","guestCountryId","handleEditClick","renderPhoneNumber","selectedCountry","privateNote","origin","Label","image","Icon","alt","Lcz_BookedOn","nbr_confirmed_bookings","Lcz_BookingsNbr","Lcz_Phone","Lcz_Address","isCountryImage","flag","display","Lcz_GuestPrivateNote","Lcz_ArrivalTime","Lcz_Coupon","Lcz_LoyaltyDiscountApplied","Lcz_GuestRemark","Lcz_ChannelNotes","remarks","ota_notes","maxVisibleItems","Lcz_BookingPrivateNote","Lcz_VisibleToHotelOnly","irRoomCss","IrRoomStyle0","IrRoom","modalReason","isModelOpen","mainGuest","getMainGuest","pressCheckIn","pressCheckOut","handleRoomDataChange","getDateStr","getDate","toLocaleString","editInitiated","formatName","Lcz_EditBookingFor","ARRIVAL_TIME","COUNTRY","FROM_DATE_STR","IDENTIFIER","IS_EDITABLE","NO_OF_DAYS","POOL","SPLIT_BOOKING","STATUS","TO_DATE_STR","PICKUP_INFO","handleModalConfirmation","deleteRoom","handleExposedRoomInOut","resetbooking","oldRooms","body","deleteFinished","updateDepartureTime","setDepartureTime","childCount","infantCount","Lcz_Infants","Lcz_Infant","getSmokingLabel","smoking_option","currRT","allowed_smoking_options","s","ota_meta","smoking_preferences","getBedName","bed","bed_preferences","renderModalMessage","handleCheckIn","showGuestModal","fontWeight","Lcz_CheckIn","Lcz_CheckOut","btnStyle","padding","fontSize","textAlign","lineHeight","toUpperCase","Lcz_Breakdown","_getDay","Lcz_SubTotal","filtered_data","taxes","tx","pct","is_exlusive","Lcz_Excluding","Lcz_Including","ota_taxes","Lcz_SmokingOptions","Lcz_Cancellation","Lcz_Guarantee","Lcz_MealPlan","meal_plan","Lcz_Policies","defaultGuest","full_name","password","dateMask","str","autofix","YYYY","MM","DD","irRoomGuestsCss","IrRoomGuestsStyle0","IrRoomGuestsStyle1","IrRoomGuests","idTypes","initializeGuests","getSetupEntriesByTableName","propertyCountry","COUNTRY_ID","defaultGuestsCount","g","updateGuestInfo","tempGuests","tempGuest","saveGuests","handleExposedRoomGuests","updateRoomGuests","minWidth","Lcz_MainGuest","Lcz_DOB","Lcz_Nationality","Lcz_Documents","isRowValid","Lcz_PersonsSharingRoom","selectForcedStyles","borderTopRightRadius","borderBottomRightRadius","borderRight","t","inputForcedStyle","otaLabelCss","OtaLabelStyle0","OtaLabel","showAll","toggleShowAll","displayedRemarks","slice","Lcz_ShowLess","Lcz_ShowMore"],"sources":["src/services/variation.service.ts","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-application-info/igl-application-info.css?tag=igl-application-info&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-application-info/igl-application-info.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts","src/components/igloo-calendar/igl-book-property/igl-book-property.css?tag=igl-book-property&encapsulation=scoped","src/common/sheet.css?tag=igl-book-property&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.css?tag=igl-book-property-footer&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-header/igl-book-property-header.css?tag=igl-book-property-header&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-header/igl-book-property-header.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.css?tag=igl-booking-form&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.css?tag=igl-booking-overview-page&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-property-booked-by/igl-property-booked-by.css?tag=igl-property-booked-by&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-property-booked-by/igl-property-booked-by.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-room-type/igl-room-type.css?tag=igl-room-type&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-room-type/igl-room-type.tsx","src/components/HelpButton.tsx","src/services/applicable-policies.service.ts","src/components/ir-booking-details/ir-payment-details/ir-applicable-policies/ir-applicable-policies.css?tag=ir-applicable-policies&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-applicable-policies/ir-applicable-policies.tsx","src/components/ir-booking-details/ir-booking-details.css?tag=ir-booking-details&encapsulation=scoped","src/components/ir-booking-details/ir-booking-details.tsx","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.css?tag=ir-booking-extra-note&encapsulation=scoped","src/common/sheet.css?tag=ir-booking-extra-note&encapsulation=scoped","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx","src/components/ir-booking-details/ir-payment-details/ir-booking-guarantee/ir-booking-guarantee.css?tag=ir-booking-guarantee&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-booking-guarantee/ir-booking-guarantee.tsx","src/components/ir-booking-details/ir-booking-header/ir-booking-header.css?tag=ir-booking-header&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-booking-header.tsx","src/components/ui/ir-dialog/ir-dialog.css?tag=ir-dialog&encapsulation=shadow","src/components/ui/ir-dialog/ir-dialog.tsx","src/components/ui/ir-dropdown/ir-dropdown.css?tag=ir-dropdown&encapsulation=scoped","src/components/ui/ir-dropdown/ir-dropdown.tsx","src/components/ui/ir-dropdown-item/ir-dropdown-item.css?tag=ir-dropdown-item&encapsulation=scoped","src/components/ui/ir-dropdown-item/ir-dropdown-item.tsx","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.css?tag=ir-events-log&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.css?tag=ir-extra-service&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.tsx","src/models/booking.dto.ts","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.css?tag=ir-extra-service-config&encapsulation=scoped","src/common/sheet.css?tag=ir-extra-service-config&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-services.css?tag=ir-extra-services&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-services.tsx","src/components/ir-guest-info/ir-guest-info.css?tag=ir-guest-info&encapsulation=scoped","src/common/sheet.css?tag=ir-guest-info&encapsulation=scoped","src/components/ir-guest-info/ir-guest-info.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-details.css?tag=ir-payment-details&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-details.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-folio/ir-payment-folio.css?tag=ir-payment-folio&encapsulation=scoped","src/common/sheet.css?tag=ir-payment-folio&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-folio/ir-payment-folio.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-item/ir-payment-item.css?tag=ir-payment-item&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-item/ir-payment-item.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-summary/ir-payment-summary.css?tag=ir-payment-summary&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-summary/ir-payment-summary.tsx","src/components/ir-booking-details/ir-payment-details/ir-payments-folio/ir-payments-folio.css?tag=ir-payments-folio&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payments-folio/ir-payments-folio.tsx","src/components/ir-booking-details/ir-pickup/pickup.service.ts","src/components/ir-booking-details/ir-pickup/ir-pickup.css?tag=ir-pickup&encapsulation=scoped","src/common/sheet.css?tag=ir-pickup&encapsulation=scoped","src/components/ir-booking-details/ir-pickup/ir-pickup.tsx","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.css?tag=ir-pickup-view&encapsulation=scoped","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.tsx","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.css?tag=ir-pms-logs&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.tsx","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.css?tag=ir-reservation-information&encapsulation=scoped","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.tsx","src/components/ir-booking-details/ir-room/ir-room.css?tag=ir-room&encapsulation=scoped","src/components/ir-booking-details/ir-room/ir-room.tsx","src/components/ir-booking-details/ir-room-guests/data.ts","src/components/ir-booking-details/ir-room-guests/ir-room-guests.css?tag=ir-room-guests&encapsulation=scoped","src/common/sheet.css?tag=ir-room-guests&encapsulation=scoped","src/components/ir-booking-details/ir-room-guests/ir-room-guests.tsx","src/components/ui/ota-label/ota-label.css?tag=ota-label&encapsulation=scoped","src/components/ui/ota-label/ota-label.tsx"],"sourcesContent":["import { Variation } from '@/models/property';\nimport locales from '@/stores/locales.store';\n\nexport default class VariationService {\n  /**\n   * Formats a variation based on the number of infants and returns a formatted string.\n   * @param {Object} params - The input parameters.\n   * @param {Variation} params.baseVariation - The base variation object.\n   * @param {Variation[]} params.variations - A list of available variations.\n   * @param {number} params.infants - The number of infants to adjust the variation for.\n   * @returns {string} A formatted string describing the variation adjusted for infants.\n   */\n  public formatVariationBasedOnInfants(params: { baseVariation: Variation; variations: Variation[]; infants: number }): string {\n    const variation = this.getVariationBasedOnInfants(params);\n    return this.formatVariation(variation, params.infants);\n  }\n\n  /**\n   * Calculates the discounted amount for a variation adjusted for the number of infants.\n   * @param {Object} params - The input parameters.\n   * @param {Variation} params.baseVariation - The base variation object.\n   * @param {Variation[]} params.variations - A list of available variations.\n   * @param {number} params.infants - The number of infants to consider for adjustments.\n   * @returns {number} The discounted amount for the selected variation, or 0 if no discounted amount is available.\n   */\n  public calculateVariationAmount(params: { baseVariation: Variation; variations: Variation[]; infants: number }): number {\n    return this.getVariationBasedOnInfants(params)?.discounted_amount || 0;\n  }\n\n  /**\n   * Finds the appropriate variation from a list of variations based on the number of infants.\n   * @param {Object} params - The input parameters.\n   * @param {Variation} params.baseVariation - The base variation object.\n   * @param {Variation[]} params.variations - A list of available variations.\n   * @param {number} params.infants - The number of infants to adjust for.\n   * @returns {Variation} The matching variation or the base variation if no match is found.\n   */\n  public getVariationBasedOnInfants({ variations, baseVariation, infants }: { baseVariation: Variation; variations: Variation[]; infants: number }): Variation {\n    const { adult_nbr, child_nbr } = baseVariation;\n    return variations.find(v => v.adult_nbr === adult_nbr && v.child_nbr === Math.max(0, child_nbr - Math.max(0, infants))) || baseVariation;\n  }\n\n  /**\n   * Formats a variation object into a human-readable string, adjusted for the number of infants.\n   * @param {Variation} variation - The variation object to format.\n   * @param {number} infant_nbr - The number of infants to adjust for.\n   * @returns {string} A formatted string representing the variation.\n   * @private\n   */\n  private formatVariation({ child_nbr, adult_nbr }: Variation, infant_nbr: number): string {\n    const adultNumber = Number(adult_nbr) || 0;\n    const infantNumber = Math.max(Number(infant_nbr) || 0, 0);\n    const adultLabel = adultNumber > 1 ? locales.entries.Lcz_Adults.toLowerCase() : locales.entries.Lcz_Adult.toLowerCase();\n    const childLabel = child_nbr > 1 ? locales.entries.Lcz_Children.toLowerCase() : locales.entries.Lcz_Child.toLowerCase();\n    const infantLabel = infantNumber > 1 ? (locales.entries['Lcz_Infants'] ?? 'infants')?.toLowerCase() : (locales?.entries['Lcz_Infant'] ?? 'infant')?.toLowerCase();\n    const parts = [`${adultNumber} ${adultLabel}`, child_nbr ? `${child_nbr} ${childLabel}` : '', infantNumber ? `${infantNumber} ${infantLabel}` : ''];\n    return parts.filter(Boolean).join('&nbsp&nbsp&nbsp&nbsp');\n  }\n}\n",":host {\n  display: block;\n}\n.rate_amount {\n  display: none;\n  padding: 0;\n  margin: 0;\n}\n\n.booking-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n  gap: 0.5rem;\n}\n.non-ref-span {\n  font-size: 12px;\n  color: var(--green);\n}\n.booking-roomtype-title {\n  font-size: 1.25rem;\n  margin-right: 0.5rem;\n  margin: 0;\n  padding: 0;\n}\n\n.booking-details-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0;\n  margin: 0;\n}\n\n.booking-rateplan {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin: 0;\n  padding: 0;\n}\n\n.booking-rateplan-name {\n  font-weight: bold;\n  margin: 0;\n  padding: 0;\n}\n\n.booking-tooltip {\n  margin-right: 0.5rem;\n  margin: 0;\n  padding: 0;\n}\n\n.booking-variation {\n  margin: 0;\n  padding: 0;\n}\n\n.booking-price {\n  margin: 0;\n  padding: 0;\n}\n\n.booking-footer {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0;\n  margin-bottom: 0.5rem;\n}\n\n.booking-details-container {\n  display: none;\n}\n\n/*md*/\n@media (min-width: 768px) {\n  .booking-header {\n    justify-content: flex-start;\n  }\n  .booking-footer,\n  .booking-price {\n    display: none;\n  }\n  .booking-details-container,\n  .rate_amount {\n    display: inline-flex;\n    gap: 0.5rem;\n  }\n}\n\n@media only screen and (min-width: 908px) {\n  .aplicationInfoContainer {\n    max-width: 100%;\n  }\n  .guest-info-container,\n  .bed-preference-container,\n  .unit-select-container {\n    max-width: 250px;\n  }\n  /* .preference-select-container {\n    max-width: 250px;\n  } */\n}\n","import { Component, Host, h, Prop, State, Listen } from '@stencil/core';\nimport { TPropertyButtonsTypes } from '@/components';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { IRatePlanSelection, modifyBookingStore, RatePlanGuest } from '@/stores/booking.store';\nimport locales from '@/stores/locales.store';\nimport { v4 } from 'uuid';\nimport calendar_data, { isSingleUnit } from '@/stores/calendar-data';\nimport { formatAmount } from '@/utils/utils';\nimport VariationService from '@/services/variation.service';\n\n@Component({\n  tag: 'igl-application-info',\n  styleUrl: 'igl-application-info.css',\n  scoped: true,\n})\nexport class IglApplicationInfo {\n  @Prop() rateplanSelection: IRatePlanSelection;\n  @Prop() guestInfo: RatePlanGuest | null;\n  @Prop() currency: ICurrency;\n  @Prop() bedPreferenceType = [];\n  @Prop() bookingType: string = 'PLUS_BOOKING';\n  @Prop() roomIndex: number;\n  @Prop() totalNights: number = 1;\n  @Prop() baseData: { unit: { id: string; name: string }; roomtypeId: number };\n\n  @State() isButtonPressed = false;\n\n  private variationService = new VariationService();\n\n  componentWillLoad() {\n    if (isSingleUnit(this.rateplanSelection.roomtype.id)) {\n      const filteredRooms = this.filterRooms();\n      if (filteredRooms.length > 0) this.updateGuest({ unit: filteredRooms[0]?.id?.toString() });\n    }\n  }\n\n  private updateGuest(params: Partial<RatePlanGuest>) {\n    const roomTypeId = this.rateplanSelection.roomtype.id;\n    const ratePlanId = this.rateplanSelection.ratePlan.id;\n    let prevGuest = [...this.rateplanSelection.guest];\n    prevGuest[this.roomIndex] = {\n      ...prevGuest[this.roomIndex],\n      ...params,\n    };\n    booking_store.ratePlanSelections = {\n      ...booking_store.ratePlanSelections,\n      [roomTypeId]: {\n        ...booking_store.ratePlanSelections[roomTypeId],\n        [ratePlanId]: { ...this.rateplanSelection, guest: [...prevGuest] },\n      },\n    };\n  }\n\n  @Listen('buttonClicked', { target: 'body' })\n  handleButtonClicked(\n    event: CustomEvent<{\n      key: TPropertyButtonsTypes;\n      data?: CustomEvent;\n    }>,\n  ) {\n    switch (event.detail.key) {\n      case 'book':\n      case 'bookAndCheckIn':\n      case 'save':\n        this.isButtonPressed = true;\n        break;\n    }\n  }\n\n  private getTooltipMessages(): string | undefined {\n    const { ratePlan, selected_variation } = this.rateplanSelection;\n    let selectedVariation = selected_variation;\n    if (this.guestInfo?.infant_nbr) {\n      selectedVariation = this.variationService.getVariationBasedOnInfants({\n        variations: ratePlan.variations,\n        baseVariation: selected_variation,\n        infants: this.guestInfo?.infant_nbr,\n      });\n    }\n\n    if (!selectedVariation) return;\n\n    const matchingVariation = ratePlan.variations?.find(variation => variation.adult_nbr === selectedVariation.adult_nbr && variation.child_nbr === selectedVariation.child_nbr);\n\n    if (!matchingVariation) return;\n\n    const cancellationPolicy = matchingVariation.applicable_policies?.find(p => p.type === 'cancelation')?.combined_statement;\n    const guaranteePolicy = matchingVariation.applicable_policies?.find(p => p.type === 'guarantee')?.combined_statement;\n\n    let tooltip = '';\n    if (cancellationPolicy) {\n      tooltip += `<b><u>Cancellation:</u></b> ${cancellationPolicy}<br/>`;\n    }\n    if (guaranteePolicy) {\n      tooltip += `<b><u>Guarantee:</u></b> ${guaranteePolicy}`;\n    }\n    return tooltip || undefined;\n  }\n\n  private getAmount(): number {\n    if (this.rateplanSelection.is_amount_modified) {\n      return this.rateplanSelection.view_mode === '001' ? this.rateplanSelection.rp_amount : this.rateplanSelection.rp_amount * this.totalNights;\n    }\n    let variation = this.rateplanSelection.selected_variation;\n    if (this.guestInfo?.infant_nbr) {\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: this.rateplanSelection.ratePlan.variations,\n        baseVariation: this.rateplanSelection.selected_variation,\n        infants: this.guestInfo?.infant_nbr,\n      });\n    }\n    return variation.discounted_gross_amount;\n  }\n\n  private filterRooms(): { name: string; id: number }[] {\n    const result = [];\n    if (!calendar_data.is_frontdesk_enabled) {\n      return result;\n    }\n    this.rateplanSelection.ratePlan?.assignable_units?.forEach(unit => {\n      if (unit.Is_Fully_Available) {\n        result.push({ name: unit.name, id: unit.pr_id });\n      }\n    });\n    const filteredGuestsRoom = this.rateplanSelection.guest.filter((_, i) => i !== this.roomIndex).map(r => r.unit);\n    const filteredResults = result.filter(r => !filteredGuestsRoom.includes(r.id.toString()));\n    return this.bookingType === 'EDIT_BOOKING'\n      ? [...filteredResults, this.rateplanSelection.roomtype.id === this.baseData?.roomtypeId ? this.baseData?.unit : null]\n          .filter(f => !!f)\n          .sort((a, b) => a.name.localeCompare(b.name))\n      : filteredResults;\n  }\n\n  render() {\n    const filteredRoomList = this.filterRooms();\n    const formattedVariation = this.variationService.formatVariationBasedOnInfants({\n      baseVariation: this.rateplanSelection.selected_variation,\n      infants: this.guestInfo.infant_nbr,\n      variations: this.rateplanSelection.ratePlan.variations,\n    });\n    return (\n      <Host class={'my-2'} data-testid={`room_info_${this.rateplanSelection.ratePlan.id}`}>\n        <div class=\"booking-header\">\n          {(this.bookingType === 'PLUS_BOOKING' || this.bookingType === 'ADD_ROOM' || this.bookingType === 'EDIT_BOOKING') && (\n            <span class=\"booking-roomtype-title\">{this.rateplanSelection.roomtype.name}</span>\n          )}\n          <div class=\"booking-details-container\">\n            <div class=\"booking-rateplan\">\n              <p class=\"booking-rateplan-name\">\n                {this.rateplanSelection.ratePlan.short_name} {this.rateplanSelection.ratePlan.is_non_refundable && <span class={'non-ref-span'}>Non Refundable</span>}\n              </p>\n              <ir-tooltip class=\"booking-tooltip\" message={this.getTooltipMessages()}></ir-tooltip>\n            </div>\n            <p class=\"booking-variation\" innerHTML={formattedVariation}></p>\n          </div>\n          <p class=\"booking-price\">\n            {formatAmount(this.currency?.symbol, this.getAmount())}/{locales.entries.Lcz_Stay}\n          </p>\n        </div>\n        <div class=\"booking-footer\">\n          <div class=\"booking-rateplan\">\n            <p class=\"booking-rateplan-name\">{this.rateplanSelection.ratePlan.short_name}</p>\n            <ir-tooltip class=\"booking-tooltip\" message={this.getTooltipMessages()}></ir-tooltip>\n          </div>\n          <p class=\"booking-variation\" innerHTML={formattedVariation}></p>\n        </div>\n        <div class=\"d-flex flex-column flex-md-row  p-0 align-items-md-center aplicationInfoContainer\">\n          <div class=\"mr-md-1 mb-1 mb-md-0 flex-fill guest-info-container\">\n            <input\n              id={v4()}\n              type=\"text\"\n              data-testid=\"guest_first_name\"\n              class={`form-control ${this.isButtonPressed && this.guestInfo?.first_name === '' && 'border-danger'}`}\n              placeholder={locales.entries['Lcz_GuestFirstname'] ?? 'Guest first name'}\n              name=\"guestFirstName\"\n              onInput={event => {\n                const name = (event.target as HTMLInputElement).value;\n                this.updateGuest({ first_name: name });\n                if (booking_store.event_type.type === 'EDIT_BOOKING') {\n                  modifyBookingStore('guest', {\n                    ...booking_store.guest,\n                    name,\n                  });\n                }\n              }}\n              required\n              value={this.guestInfo?.first_name}\n            />\n          </div>\n          <div class=\"mr-md-1 flex-fill guest-info-container\">\n            <input\n              id={v4()}\n              type=\"text\"\n              class={`form-control ${this.isButtonPressed && this.guestInfo?.last_name === '' && 'border-danger'}`}\n              placeholder={locales.entries['Lcz_GuestLastname'] ?? 'Guest last name'}\n              name=\"guestLastName\"\n              data-testid=\"guest_last_name\"\n              onInput={event => {\n                const name = (event.target as HTMLInputElement).value;\n                this.updateGuest({ last_name: name });\n                if (booking_store.event_type.type === 'EDIT_BOOKING') {\n                  modifyBookingStore('guest', {\n                    ...booking_store.guest,\n                    name,\n                  });\n                }\n              }}\n              required\n              value={this.guestInfo?.last_name}\n            />\n          </div>\n          {calendar_data.is_frontdesk_enabled &&\n            !isSingleUnit(this.rateplanSelection.roomtype.id) &&\n            (this.bookingType === 'PLUS_BOOKING' || this.bookingType === 'ADD_ROOM' || this.bookingType === 'EDIT_BOOKING') && (\n              <div class=\"mt-1 mt-md-0 d-flex align-items-center flex-fill\">\n                <div class=\"mr-md-1 p-0 flex-fill preference-select-container\">\n                  <select data-testid=\"unit\" class=\"form-control input-sm pr-0\" id={v4()} onChange={event => this.updateGuest({ unit: (event.target as HTMLInputElement).value })}>\n                    <option value=\"\" selected={this.guestInfo?.unit === ''}>\n                      {locales.entries.Lcz_Assignunits}\n                    </option>\n                    {filteredRoomList?.map(room => (\n                      <option value={room.id} selected={this.guestInfo?.unit === room.id.toString()}>\n                        {room.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n            )}\n          {this.rateplanSelection.roomtype.is_bed_configuration_enabled && (\n            <div class=\"mt-1 mt-md-0 mr-md-1 flex-fill\">\n              <select\n                data-testid=\"bed_configuration\"\n                class={`form-control input-sm ${this.isButtonPressed && this.guestInfo?.bed_preference === '' && 'border-danger'}`}\n                id={v4()}\n                onChange={event => this.updateGuest({ bed_preference: (event.target as HTMLInputElement).value })}\n              >\n                <option value=\"\" selected={this.guestInfo?.bed_preference === ''}>\n                  {locales.entries.Lcz_BedConfiguration}\n                </option>\n                {this.bedPreferenceType.map(data => (\n                  <option value={data.CODE_NAME} selected={this.guestInfo?.bed_preference === data.CODE_NAME}>\n                    {data.CODE_VALUE_EN}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n          <p class=\"rate_amount\">\n            {formatAmount(this.currency?.symbol, this.getAmount())}/{locales.entries.Lcz_Stay}\n          </p>\n        </div>\n        {this.rateplanSelection.selected_variation.child_nbr > 0 && (\n          <div style={{ gap: '0.5rem', marginTop: '0.5rem' }} class=\"d-flex  flex-row  p-0 align-items-center aplicationInfoContainer\">\n            <p class={'m-0 p-0 text-danger'}>Any of the children below 3 years?</p>\n            <div class=\"mr-1 flex-fill\">\n              <select\n                class={`form-control input-sm ${this.isButtonPressed && this.guestInfo?.bed_preference === '' && 'border-danger'}`}\n                id={v4()}\n                style={{ width: 'max-content' }}\n                onChange={event => this.updateGuest({ infant_nbr: Number((event.target as HTMLInputElement).value) })}\n              >\n                <option value=\"\" selected={Number(this.guestInfo?.infant_nbr) === 0}>\n                  {locales.entries['No'] || 'No'}\n                </option>\n                {Array.from({ length: this.rateplanSelection.selected_variation.child_nbr }, (_, i) => i + 1).map(item => (\n                  <option value={item} selected={this.guestInfo?.infant_nbr === item}>\n                    {item}\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n        )}\n      </Host>\n    );\n  }\n}\n","import { Booking, Room } from '@/models/booking.dto';\nimport { TSourceOption } from '@/models/igl-book-property';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class IglBookPropertyService {\n  private variationService: VariationService;\n  public setBookingInfoFromAutoComplete(context, res) {\n    context.bookedByInfoData = {\n      id: res.guest.id,\n      email: res.guest.email,\n      firstName: res.guest.first_name,\n      lastName: res.guest.last_name,\n      countryId: res.guest.country_id,\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\n      contactNumber: res.guest.mobile,\n      selectedArrivalTime: res.arrival,\n      emailGuest: res.guest.subscribe_to_news_letter,\n      message: res.remark,\n      cardNumber: '',\n      cardHolderName: '',\n      expiryMonth: '',\n      expiryYear: '',\n      bookingNumber: res.booking_nbr,\n      rooms: res.rooms,\n      from_date: res.from_date,\n      to_date: res.to_date,\n    };\n  }\n\n  public resetRoomsInfoAndMessage(context) {\n    context.defaultData.roomsInfo = [];\n    context.message = '';\n  }\n\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\n    let units = selectedUnits;\n    const { data, key, changedKey } = event.detail;\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\n    const ratePlanKey = `p_${data.ratePlanId}`;\n\n    if (this.shouldClearData(key)) {\n      units = new Map();\n    }\n\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\n\n    if (isEditBooking) {\n      if (changedKey === 'rate') {\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n        }\n      } else {\n        if (changedKey !== 'rateType') {\n          if (changedKey === 'adult_child_offering') {\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n            }\n          } else {\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n          }\n        }\n      }\n    } else {\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\n    }\n    this.cleanupEmptyData(roomCategoryKey, units);\n    return units;\n  }\n\n  private shouldClearData(key: string | undefined): boolean {\n    return key === 'clearData' || key === 'EDIT_BOOKING';\n  }\n\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (!selectedUnits.has(roomCategoryKey)) {\n      selectedUnits.set(roomCategoryKey, new Map());\n    }\n  }\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n    if (data.totalRooms === 0 || data.inventory === 0) {\n      selectedRatePlans.delete(ratePlanKey);\n    } else {\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\n    }\n  }\n\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (selectedUnits.has(roomCategoryKey)) {\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n      if (selectedRatePlans.size === 0) {\n        selectedUnits.delete(roomCategoryKey);\n      }\n    }\n  }\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\n    selectedUnits.clear();\n    let res = {};\n    if (isEdit) {\n      res = { ...data, guestName: name || '', roomId: '' };\n    } else {\n      res = { ...data };\n    }\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\n  }\n\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  // private extractFirstNameAndLastName(name: string) {\n  //   const names = name.split(' ');\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\n  // }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Date;\n    check_out: Date;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: Number(rateplan.selected_variation.child_nbr ?? 0) - Math.max(Number(rateplan.guest[i].infant_nbr ?? 0), 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n\n  async prepareBookUserServiceParams({ context, sourceOption, check_in }: { context: any; sourceOption: TSourceOption; check_in: boolean }) {\n    try {\n      // Validate context structure\n      if (!context || !context.dateRangeData) {\n        throw new Error('Invalid context: Missing date range data.');\n      }\n\n      const fromDate = new Date(context.dateRangeData.fromDate);\n      const toDate = new Date(context.dateRangeData.toDate);\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n      console.log({ event_type: context.defaultData.event_type, defaultData: context.defaultData });\n      switch (context.defaultData.event_type) {\n        case 'EDIT_BOOKING': {\n          const { booking, currentRoomType } = context.defaultData;\n\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\n          console.log('currentRoomType', currentRoomType);\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const { booking } = context.defaultData;\n          // console.log(booking);\n          if (!booking) {\n            throw new Error('Missing booking');\n          }\n          const newRooms = generateNewRooms();\n          // const previousRooms = context.defaultData.event_type === 'ADD_ROOM' ? ROOMS ?? [] : booking?.rooms;\n          const previousRooms = booking.rooms;\n          newBooking = modifyBookingDetails(booking, [...previousRooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByInfoData } = context;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras: [...extras.filter(e => e.key !== 'payment_code'), { key: 'payment_code', value: booking_store.selectedPaymentMethod?.code }],\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            booking: {\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByInfoData.message || null,\n              booking_nbr: '',\n              property: {\n                id: context.propertyid,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: context.currency,\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\n              guest: {\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\n                first_name: bookedByInfoData.firstName,\n                last_name: bookedByInfoData.lastName,\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\n                city: null,\n                mobile: bookedByInfoData.contactNumber === null ? '' : bookedByInfoData.contactNumber,\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\n                address: '',\n                dob: null,\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\n                cci: bookedByInfoData.cardNumber\n                  ? {\n                      nbr: bookedByInfoData.cardNumber,\n                      holder_name: bookedByInfoData.cardHolderName,\n                      expiry_month: bookedByInfoData.expiryMonth,\n                      expiry_year: bookedByInfoData.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private getRoomCategoryByRoomId(bookingData) {\n    return bookingData.roomsInfo?.find(roomCategory => {\n      return roomCategory.id === bookingData.RATE_TYPE;\n    });\n  }\n  public setEditingRoomInfo(bookingData, selectedUnits) {\n    const category = this.getRoomCategoryByRoomId(bookingData);\n    const room_id = !category ? '' : `c_${category?.id}`;\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\n    const data = {\n      adultCount: bookingData.ADULTS_COUNT,\n      rate: bookingData.RATE,\n      rateType: bookingData.RATE_TYPE,\n      ratePlanId: bookingData.RATE_PLAN_ID,\n      roomCategoryId: category ? category.id : '',\n      roomCategoryName: category ? category.name : '',\n      totalRooms: 1,\n      ratePlanName: bookingData.RATE_PLAN,\n      roomId: bookingData.PR_ID,\n      guestName: bookingData.NAME,\n      cancelation: bookingData.cancelation,\n      guarantee: bookingData.guarantee,\n      adult_child_offering: bookingData.adult_child_offering,\n    };\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\n  }\n}\n",":host {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100vw;\n  min-height: 100vh;\n  z-index: 99;\n  overflow: hidden;\n  /* min-width: 450px; */\n}\n\n.card-title {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n}\n.card-header-container {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  padding: 1rem 0;\n  justify-content: space-between;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.card-header-container h3 {\n  padding: 0;\n  margin: 0;\n}\n\n.background-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.25);\n}\n\n.formContainer {\n  height: calc(100% - 79px);\n  overflow: auto;\n}\n.gap-30 {\n  gap: 30px;\n}\n.block-date {\n  width: 100%;\n}\n.sideWindow {\n  position: absolute;\n  inset: 0;\n  left: unset;\n  background-color: #ffffff;\n  width: 100%;\n  overflow: auto;\n  animation: slideInFromRight 0.5s;\n}\n.card {\n  top: 0;\n  z-index: 1000;\n}\n\n.close {\n  float: right;\n  font-size: 1.5rem;\n  font-weight: 700;\n  line-height: 1;\n  color: #000;\n  text-shadow: 0 1px 0 #fff;\n  opacity: 0.5;\n  padding: 0;\n  background-color: transparent;\n  border: 0;\n  appearance: none;\n}\n\n.close-icon {\n  position: absolute;\n  top: 18px;\n  right: 33px;\n  outline: none;\n}\n\nbutton:not(:disabled),\n[type='button']:not(:disabled) {\n  cursor: pointer;\n}\n.sheet-footer {\n  width: 100%;\n}\n\n/* .row {\n  padding: 0 0 0 15px;\n  margin: 0;\n} */\n@media only screen and (min-width: 1200px) {\n  .sideWindow {\n    max-width: 70%;\n  }\n}\n@media only screen and (min-width: 2000px) {\n  .sideWindow {\n    max-width: 40%;\n  }\n}\n@media only screen and (min-width: 768px) and (max-width: 1200px) {\n  .sideWindow {\n    max-width: 90%;\n  }\n}\n@media only screen and (min-width: 600px) and (max-width: 768px) {\n  .sideWindow {\n    max-width: 75%;\n  }\n}\n@media only screen and (min-width: 641px) {\n  .block-date {\n    max-width: 450px;\n    padding-bottom: 0 !important;\n  }\n}\n@keyframes slideInFromRight {\n  from {\n    transform: translateX(120%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n@keyframes slideOutToRight {\n  from {\n    transform: translateX(0);\n  }\n  to {\n    transform: translateX(120%);\n  }\n}\n\n.sideWindow--exit {\n  animation: slideOutToRight 0.5s forwards;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, h, Listen, Fragment } from '@stencil/core';\nimport { BookingService } from '@/services/booking.service';\nimport { dateToFormattedString, getReleaseHoursString, handleBodyOverflow } from '@/utils/utils';\nimport { ICountry, IEntries, RoomBlockDetails } from '@/models/IBooking';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyService } from './igl-book-property.service';\nimport { IglBookPropertyPayloadEditBooking, TAdultChildConstraints, TEventType, TPropertyButtonsTypes, TSourceOption, TSourceOptions } from '@/models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { calculateTotalRooms, modifyBookingStore, reserveRooms, resetBookingStore, resetReserved } from '@/stores/booking.store';\nimport moment from 'moment';\nimport calendar_data from '@/stores/calendar-data';\nexport type IHistoryEntry = {\n  dates: { checkIn: Date; checkOut: Date };\n  adults: number;\n  children: number;\n};\n@Component({\n  tag: 'igl-book-property',\n  styleUrls: ['igl-book-property.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBookProperty {\n  @Prop() propertyid: number;\n  @Prop() allowedBookingSources: any;\n  @Prop() language: string;\n  @Prop() countries: ICountry[];\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true, mutable: true }) bookingData: { [key: string]: any };\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n\n  @State() adultChildCount: { adult: number; child: number } = { adult: 0, child: 0 };\n  @State() renderAgain: boolean = false;\n  @State() dateRangeData: { [key: string]: any };\n  @State() defaultData: any;\n  @State() isLoading: string;\n  @State() bookingHistory: Array<{\n    dates: { checkIn: Date; checkOut: Date };\n    adults: number;\n    children: number;\n  }> = [];\n\n  @Event() closeBookingWindow: EventEmitter<{ [key: string]: any }>;\n  @Event() blockedCreated: EventEmitter<RoomBlockDetails>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n\n  private initialRoomIds: { roomName: string; ratePlanId: number; roomId: string; roomTypeId: string } | null = null;\n  private sourceOption: TSourceOption;\n  private page: string;\n  private showSplitBookingOption: boolean = false;\n  private sourceOptions: TSourceOptions[] = [];\n  private guestData: { [key: string]: any }[] = [];\n  private bookedByInfoData: { [key: string]: any } = {};\n  private blockDatesData: { [key: string]: any } = {};\n  private ratePricingMode: IEntries[] = [];\n  private selectedUnits: Map<string, Map<string, any>> = new Map();\n  private bedPreferenceType: IEntries[] = [];\n  private bookingService: BookingService = new BookingService();\n  private bookPropertyService = new IglBookPropertyService();\n  private defaultDateRange: { from_date: string; to_date: string };\n  private updatedBooking: boolean = false;\n  private MAX_HISTORY_LENGTH: number = 2;\n  private didReservation: boolean;\n  private wasBlockedUnit: boolean;\n  private _sourceOptions: TSourceOptions[];\n\n  async componentWillLoad() {\n    console.log('<==>roomtypes<==>', booking_store?.roomTypes);\n    if (booking_store.roomTypes) {\n      modifyBookingStore('roomTypes', []);\n      modifyBookingStore('ratePlanSelections', {});\n    }\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.initializeDefaultDateRange();\n\n    if (!this.bookingData.defaultDateRange) {\n      return;\n    }\n    // console.log(this.bookingData);\n    this.initializeDefaultData();\n    this.wasBlockedUnit = this.defaultData.hasOwnProperty('block_exposed_unit_props');\n    modifyBookingStore('event_type', { type: this.defaultData.event_type });\n    this.fetchSetupEntriesAndInitialize();\n  }\n\n  componentDidLoad() {\n    document.addEventListener('keydown', this.handleKeyDown);\n    handleBodyOverflow(true);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  @Listen('inputCleared')\n  clearBooking(e: CustomEvent) {\n    if (this.isEventType('SPLIT_BOOKING')) {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.bookedByInfoData = {};\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n      this.renderPage();\n    }\n  }\n\n  @Listen('spiltBookingSelected')\n  async handleSpiltBookingSelected(e: CustomEvent<{ key: string; data: unknown }>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { key, data } = e.detail;\n    if (key === 'select' || (key === 'blur' && data !== '')) {\n      const res = await this.bookingService.getExposedBooking((data as any).booking_nbr || (data as string), this.language);\n      this.defaultData = { ...this.defaultData, booking: res };\n      this.bookPropertyService.setBookingInfoFromAutoComplete(this, res);\n      this.sourceOption = res.source;\n      this.renderPage();\n    }\n  }\n\n  // @Listen('adultChild')\n  // handleAdultChildChange(event: CustomEvent) {\n  //   if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n  //     this.bookPropertyService.resetRoomsInfoAndMessage(this);\n  //   }\n  //   const { adult, child } = event.detail;\n  //   this.adultChildCount = { ...event.detail };\n  //   this.updateBookingHistory({ adults: adult, children: child });\n  // }\n  @Listen('adultChild')\n  handleAdultChildChange(event: CustomEvent) {\n    if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n    const { adult, child } = event.detail;\n    this.adultChildCount = { ...event.detail };\n\n    // Update the booking history\n    this.updateBookingHistory({ adults: Number(adult), children: Number(child) });\n  }\n\n  @Listen('dateSelectEvent')\n  onDateRangeSelect(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.updateBookingHistory({\n      dates: {\n        checkIn: new Date(this.dateRangeData.fromDate),\n        checkOut: new Date(new Date(opt.data.toDate)),\n      },\n    });\n    console.log('date changed', opt);\n    if (opt.key === 'selectedDateRange') {\n      this.dateRangeData = opt.data;\n      if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n        this.defaultData.roomsInfo = [];\n      } else if (this.adultChildCount.adult !== 0) {\n        this.checkBookingAvailability();\n        // this.checkBookingAvailability(dateToFormattedString(new Date(this.dateRangeData.fromDate)), dateToFormattedString(new Date(this.dateRangeData.toDate)));\n      }\n    }\n  }\n  @Listen('sourceDropDownChange')\n  handleSourceDropDown(event: CustomEvent) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const value = event.detail;\n    const selectedSource = this.sourceOptions.find(opt => opt.id === value.toString());\n    this.sourceOption = {\n      code: value,\n      description: selectedSource.value || '',\n      tag: selectedSource.tag,\n      id: selectedSource.id,\n      type: selectedSource.type,\n    };\n  }\n\n  @Listen('gotoSplitPageTwoEvent', { target: 'window' })\n  gotoSplitPageTwo() {\n    this.gotoPage('page_two');\n  }\n\n  @Listen('buttonClicked')\n  handleButtonClicked(event: CustomEvent<{ key: TPropertyButtonsTypes; data?: CustomEvent }>) {\n    switch (event.detail.key) {\n      case 'save':\n        this.bookUser(false);\n        break;\n      case 'cancel':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        this.closeWindow();\n        break;\n      case 'back':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (this.isEventType('BAR_BOOKING')) {\n          resetReserved();\n        }\n        this.gotoPage('page_one');\n        break;\n      case 'book':\n        this.bookUser(false);\n        break;\n      case 'bookAndCheckIn':\n        this.bookUser(true);\n        break;\n      case 'next':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (!this.adultChildCount?.adult) {\n          this.animateIrSelect.emit('adult_child_select');\n          break;\n        }\n        if (calculateTotalRooms() > 0) {\n          this.gotoPage('page_two');\n          break;\n        } else if (this.defaultData?.roomsInfo.length === 0) {\n          this.animateIrButton.emit('check_availability');\n          break;\n        }\n        this.toast.emit({\n          type: 'error',\n          description: locales.entries.Lcz_SelectRatePlan,\n          title: locales.entries.Lcz_SelectRatePlan,\n        });\n        break;\n      case 'check':\n        this.checkBookingAvailability();\n        break;\n      default:\n        break;\n    }\n  }\n\n  private updateBookingHistory(partialData: Partial<IHistoryEntry>) {\n    const lastEntry = this.bookingHistory[this.bookingHistory.length - 1];\n\n    const newEntry: IHistoryEntry = {\n      dates: {\n        checkIn: partialData.dates?.checkIn || lastEntry?.dates?.checkIn || new Date(this.dateRangeData.fromDate),\n        checkOut: partialData.dates?.checkOut || lastEntry?.dates?.checkOut || new Date(this.dateRangeData.toDate),\n      },\n      adults: partialData.adults ?? lastEntry?.adults ?? this.adultChildCount.adult,\n      children: partialData.children ?? lastEntry?.children ?? this.adultChildCount.child,\n    };\n\n    // Update the booking history\n    this.bookingHistory.push(newEntry);\n    if (this.bookingHistory.length > this.MAX_HISTORY_LENGTH) {\n      this.bookingHistory.shift();\n    }\n  }\n\n  private handleKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      this.closeWindow();\n    }\n  }\n\n  private initializeDefaultDateRange() {\n    this.defaultDateRange = {\n      from_date: this.bookingData.FROM_DATE,\n      to_date: this.bookingData.TO_DATE,\n    };\n  }\n\n  private initializeDefaultData() {\n    this.defaultData = this.bookingData;\n    this.dateRangeData = { ...this.defaultData.defaultDateRange };\n  }\n\n  private async fetchSetupEntriesAndInitialize() {\n    try {\n      const setupEntries = await this.fetchSetupEntries();\n      this.setSourceOptions(this.allowedBookingSources);\n      this.setOtherProperties(setupEntries);\n      this.initializeEventData();\n    } catch (error) {\n      console.error('Error fetching setup entries:', error);\n    }\n  }\n\n  private initializeEventData() {\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.initializeEditBookingData();\n    }\n\n    if (!this.isEventType('BAR_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n\n    this.initializePage();\n  }\n\n  private initializeEditBookingData() {\n    this.adultChildCount = {\n      adult: this.defaultData.ADULTS_COUNT,\n      child: this.defaultData.CHILDREN_COUNT,\n    };\n\n    this.initialRoomIds = {\n      roomName: this.defaultData.roomName,\n      ratePlanId: this.defaultData.RATE_PLAN_ID,\n      roomId: this.defaultData.PR_ID,\n      roomTypeId: this.defaultData.RATE_TYPE,\n    };\n    const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n    console.log(GUEST);\n    modifyBookingStore('guest', {\n      bed_preference: currentRoomType.bed_preference?.toString(),\n      infant_nbr: currentRoomType.occupancy.infant_nbr,\n      first_name: GUEST.first_name ?? '',\n      last_name: GUEST.last_name ?? '',\n      // name: currentRoomType.guest.last_name ? currentRoomType.guest.first_name + ' ' + currentRoomType.guest.last_name : currentRoomType.guest.first_name,\n      unit: (currentRoomType.unit as any)?.id?.toString(),\n    });\n    this.checkBookingAvailability();\n    this.bookPropertyService.setEditingRoomInfo(this.defaultData, this.selectedUnits);\n  }\n\n  private initializePage() {\n    switch (this.defaultData.event_type) {\n      case 'SPLIT_BOOKING':\n        this.showSplitBookingOption = true;\n        this.page = 'page_one';\n        break;\n      case 'BLOCK_DATES':\n        this.page = 'page_block_date';\n        break;\n      default:\n        this.page = 'page_one';\n        break;\n    }\n  }\n\n  async fetchSetupEntries() {\n    return await this.bookingService.fetchSetupEntries();\n  }\n\n  private isGuestDataIncomplete() {\n    for (const roomtypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomtypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (const guest of rateplan.guest) {\n            if (guest.first_name === '' || guest.last_name === '') {\n              return true;\n            }\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  private isButtonDisabled() {\n    const isValidProperty = (property, key, comparedBy) => {\n      if (!property) {\n        return true;\n      }\n      if (property === this.guestData) {\n        return this.isGuestDataIncomplete();\n      }\n      if (key === 'selectedArrivalTime') {\n        if (property[key] !== undefined) {\n          return property[key].code === '';\n        } else {\n          return true;\n        }\n      }\n      return property[key] === comparedBy || property[key] === undefined;\n    };\n    return (\n      isValidProperty(this.guestData, 'guestName', '') ||\n      isValidProperty(this.bookedByInfoData, 'firstName', '') ||\n      isValidProperty(this.bookedByInfoData, 'lastName', '') ||\n      isValidProperty(this.bookedByInfoData, 'selectedArrivalTime', '')\n    );\n  }\n\n  private setSourceOptions(bookingSource: any[]) {\n    this.sourceOptions = bookingSource.map(source => ({\n      id: source.id,\n      value: source.description,\n      tag: source.tag,\n      type: source.type,\n    }));\n    this._sourceOptions = this.isEventType('BAR_BOOKING') ? this.getFilteredSourceOptions() : this.sourceOptions;\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.sourceOption = { ...this.defaultData.SOURCE };\n    } else {\n      //get first source option not tag\n      let option: TSourceOptions & { code: string; description: string } = this._sourceOptions.find(o => o.type !== 'LABEL') as any;\n      console.log({ option });\n      this.sourceOption = {\n        code: option.code,\n        description: option.description,\n        tag: option.tag,\n        type: option.type,\n        id: option.id,\n      };\n    }\n  }\n  private getFilteredSourceOptions(): TSourceOptions[] {\n    const agentIds = new Set<string>();\n    const hasAgentOnlyRoomType =\n      this.bookingData?.roomsInfo?.some((rt: any) => {\n        const rps = rt?.rateplans ?? [];\n        if (rps.length === 0) return false;\n\n        const isForAgentOnly = rps.every((rp: any) => (rp?.agents?.length ?? 0) > 0);\n        if (isForAgentOnly) {\n          rps.forEach((rp: any) => {\n            (rp?.agents ?? []).forEach((ag: any) => agentIds.add(ag?.id?.toString()));\n          });\n        }\n        return isForAgentOnly;\n      }) ?? false;\n    if (!hasAgentOnlyRoomType) {\n      return this.sourceOptions;\n    }\n    return (this.sourceOptions ?? []).filter((opt: any) => {\n      if (opt?.type === 'LABEL') return true;\n      const candidate = opt?.tag;\n      const matchesId = candidate != null && agentIds.has(candidate);\n      return matchesId;\n    });\n  }\n  private setOtherProperties(res: any) {\n    this.ratePricingMode = res?.ratePricingMode;\n    this.bookedByInfoData.arrivalTime = res.arrivalTime;\n    this.bedPreferenceType = res.bedPreferenceType;\n  }\n\n  private async checkBookingAvailability() {\n    resetBookingStore();\n    const from_date = moment(this.dateRangeData.fromDate).format('YYYY-MM-DD');\n    const to_date = moment(this.dateRangeData.toDate).format('YYYY-MM-DD');\n    console.log({ sourceOption: this.sourceOption });\n    const is_in_agent_mode = this.sourceOption['type'] === 'TRAVEL_AGENCY';\n    try {\n      const room_type_ids_to_update = this.isEventType('EDIT_BOOKING') ? [this.defaultData.RATE_TYPE] : [];\n      const room_type_ids = this.isEventType('BAR_BOOKING') ? this.defaultData.roomsInfo.map(room => room.id) : [];\n      const data = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.propertyid,\n        adultChildCount: this.adultChildCount,\n        language: this.language,\n        room_type_ids,\n        currency: this.currency,\n        agent_id: is_in_agent_mode ? this.sourceOption['tag'] : null,\n        is_in_agent_mode,\n        room_type_ids_to_update,\n      });\n      if (!this.isEventType('EDIT_BOOKING')) {\n        this.defaultData.defaultDateRange.fromDate = new Date(this.dateRangeData.fromDate);\n        this.defaultData.defaultDateRange.toDate = new Date(this.dateRangeData.toDate);\n      }\n      this.defaultData = { ...this.defaultData, roomsInfo: data };\n      if (this.isEventType('EDIT_BOOKING') && !this.updatedBooking) {\n        this.updateBooking();\n      }\n    } catch (error) {\n      console.error('Error initializing booking availability:', error);\n    }\n  }\n\n  private updateBooking() {\n    try {\n      const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n      const roomtypeId = currentRoomType.roomtype.id;\n      const rateplanId = currentRoomType.rateplan.id;\n      const guest = {\n        bed_preference: currentRoomType.bed_preference?.toString(),\n        infant_nbr: currentRoomType.occupancy.infant_nbr,\n        last_name: GUEST.last_name,\n        first_name: GUEST.first_name,\n        unit: (currentRoomType.unit as any)?.id?.toString(),\n        roomtype_id: currentRoomType.roomtype.id,\n      };\n      modifyBookingStore('guest', guest);\n      reserveRooms({\n        roomTypeId: roomtypeId,\n        ratePlanId: rateplanId,\n        rooms: 1,\n        guest: [guest],\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  private async checkAndBlockDate() {\n    try {\n      const { block_exposed_unit_props } = this.defaultData;\n      await this.bookingService.getBookingAvailability({\n        from_date: block_exposed_unit_props.from_date,\n        to_date: block_exposed_unit_props.to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: 2,\n          child: 0,\n        },\n        language: this.language,\n        room_type_ids: this.defaultData.roomsInfo.map(room => room.id),\n        currency: this.currency,\n      });\n      const isAvailable = booking_store.roomTypes.every(rt => {\n        if (rt.is_available_to_book) {\n          return true;\n        }\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\n      });\n      if (isAvailable) {\n        await this.handleBlockDate(false);\n      } else {\n        console.log('Blocked date is unavailable. Continuing...');\n      }\n    } catch (error) {\n      console.error('Error checking and blocking date:', error);\n    }\n  }\n  private async closeWindow() {\n    resetBookingStore();\n    handleBodyOverflow(false);\n\n    if (this.wasBlockedUnit && !this.didReservation) {\n      await this.checkAndBlockDate();\n    }\n    const el = document.querySelector('.sideWindow');\n    if (!el) return;\n\n    el.classList.add('sideWindow--exit');\n\n    setTimeout(() => {\n      this.closeBookingWindow.emit();\n      document.removeEventListener('keydown', this.handleKeyDown);\n    }, 300);\n  }\n\n  private isEventType(key: TEventType) {\n    return this.defaultData.event_type === key;\n  }\n\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.blockDatesData = opt.data;\n  }\n\n  private handleGuestInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt = event.detail;\n    if (opt.guestRefKey) {\n      if (this.isEventType('BAR_BOOKING') || this.wasBlockedUnit || this.isEventType('SPLIT_BOOKING')) {\n        this.guestData[opt.guestRefKey] = {\n          ...opt.data,\n          roomId: this.defaultData.PR_ID,\n        };\n      } else this.guestData[opt.guestRefKey] = opt.data;\n    }\n  }\n\n  private handleBookedByInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.bookedByInfoData = opt.value.data;\n  }\n\n  private renderPage() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  private gotoPage(gotoPage: string) {\n    this.page = gotoPage;\n    this.renderPage();\n  }\n\n  private getPageBlockDatesView() {\n    return (\n      <Fragment>\n        <igl-block-dates-view\n          fromDate={this.defaultData.FROM_DATE}\n          toDate={this.defaultData.TO_DATE}\n          entryDate={this.defaultData.ENTRY_DATE}\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\n        ></igl-block-dates-view>\n      </Fragment>\n    );\n  }\n\n  private handlePageTwoDataUpdateEvent(event: CustomEvent<IPageTwoDataUpdateProps>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    if (event.detail.key === 'propertyBookedBy') {\n      this.handleBookedByInfoUpdate(event);\n    } else {\n      this.handleGuestInfoUpdate(event);\n    }\n  }\n\n  private async handleBlockDate(auto_close = true) {\n    const props = this.wasBlockedUnit\n      ? this.defaultData.block_exposed_unit_props\n      : (() => {\n          const releaseData = getReleaseHoursString(+this.blockDatesData.RELEASE_AFTER_HOURS);\n          return {\n            from_date: dateToFormattedString(this.defaultData.defaultDateRange.fromDate),\n            to_date: dateToFormattedString(this.defaultData.defaultDateRange.toDate),\n            NOTES: this.blockDatesData.OPTIONAL_REASON || '',\n            pr_id: this.defaultData.PR_ID.toString(),\n            STAY_STATUS_CODE: this.blockDatesData.OUT_OF_SERVICE ? '004' : this.blockDatesData.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\n            DESCRIPTION: this.blockDatesData.RELEASE_AFTER_HOURS || '',\n            ...releaseData,\n          };\n        })();\n    // const blockedUnit = await transformNewBLockedRooms(result);\n    await this.bookingService.blockUnit(props);\n    // this.blockedCreated.emit(blockedUnit);\n    if (auto_close) this.closeWindow();\n  }\n\n  private async bookUser(check_in: boolean) {\n    this.setLoadingState(check_in);\n\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      if (this.isGuestDataIncomplete()) {\n        this.isLoading = '';\n        return;\n      }\n    } else if (this.isButtonDisabled()) {\n      this.isLoading = '';\n      return;\n    }\n\n    try {\n      const isEditOrAdd = this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM');\n      if (isEditOrAdd) {\n        this.bookedByInfoData.message = this.defaultData.NOTES;\n      }\n      this.didReservation = true;\n\n      let sourceOption = (calendar_data.property.allowed_booking_sources.find(o => o.id === this.sourceOption.id) as any) || this.sourceOption;\n\n      const serviceParams = await this.bookPropertyService.prepareBookUserServiceParams({\n        context: this,\n        sourceOption,\n        check_in,\n      });\n      await this.bookingService.doReservation(serviceParams);\n      await this.adjustBlockedDatesAfterReservation(serviceParams);\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.error('Error booking user:', error);\n    } finally {\n      // this.isLoading = null;\n      this.resetLoadingState();\n    }\n  }\n  private async adjustBlockedDatesAfterReservation(serviceParams: any) {\n    if (!this.wasBlockedUnit) {\n      return;\n    }\n    const original_from_date = moment(this.defaultData.block_exposed_unit_props.from_date, 'YYYY-MM-DD');\n    const current_from_date = moment(serviceParams.booking.from_date, 'YYYY-MM-DD');\n    const original_to_date = moment(this.defaultData.block_exposed_unit_props.to_date, 'YYYY-MM-DD');\n    const current_to_date = moment(serviceParams.booking.to_date, 'YYYY-MM-DD');\n    if (current_to_date.isBefore(original_to_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, from_date: current_to_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    if (current_from_date.isAfter(original_from_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, to_date: current_from_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    return;\n  }\n\n  private setLoadingState(assign_units: boolean) {\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      this.isLoading = 'save';\n    } else {\n      this.isLoading = assign_units ? 'bookAndCheckIn' : 'book';\n    }\n  }\n\n  private resetLoadingState() {\n    this.isLoading = '';\n    setTimeout(() => {\n      this.closeWindow();\n    }, 100);\n  }\n\n  private getCurrentPage(name: string) {\n    return this.page === name;\n  }\n\n  render() {\n    return (\n      <Host data-testid=\"book_property_sheet h-100\">\n        <div class=\"background-overlay\" onClick={() => this.closeWindow()}></div>\n        <div class={'sideWindow sheet-container ' + (this.getCurrentPage('page_block_date') ? 'block-date' : '')}>\n          {isRequestPending('/Get_Setup_Entries_By_TBL_NAME_MULTI') ? (\n            <div class={'loading-container'}>\n              <ir-spinner></ir-spinner>\n            </div>\n          ) : (\n            <Fragment>\n              <div class=\"sheet-header\">\n                <div class=\"card-header-container mb-2\">\n                  <h3 class=\"text-left font-medium-2 px-2\">{this.getCurrentPage('page_block_date') ? this.defaultData.BLOCK_DATES_TITLE : this.defaultData.TITLE}</h3>\n                  <ir-icon\n                    class={'px-2'}\n                    onIconClickHandler={() => {\n                      this.closeWindow();\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={20} width={20}>\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                      />\n                    </svg>\n                  </ir-icon>\n                </div>\n              </div>\n              <div class=\"px-2 sheet-body\">\n                {this.getCurrentPage('page_one') && (\n                  <igl-booking-overview-page\n                    wasBlockedUnit={this.wasBlockedUnit}\n                    initialRoomIds={this.initialRoomIds}\n                    defaultDaterange={this.defaultDateRange}\n                    eventType={this.defaultData.event_type}\n                    selectedRooms={this.selectedUnits}\n                    currency={this.currency}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    ratePricingMode={this.ratePricingMode}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    adultChildCount={this.adultChildCount}\n                    bookedByInfoData={this.bookedByInfoData}\n                    adultChildConstraints={this.adultChildConstraints}\n                    sourceOptions={this._sourceOptions}\n                    propertyId={this.propertyid}\n                  ></igl-booking-overview-page>\n                )}\n\n                {this.getCurrentPage('page_two') && (\n                  <igl-booking-form\n                    currency={this.currency}\n                    propertyId={this.propertyid}\n                    showPaymentDetails={this.showPaymentDetails}\n                    selectedGuestData={this.guestData}\n                    countries={this.countries}\n                    isLoading={this.isLoading}\n                    selectedRooms={this.selectedUnits}\n                    bedPreferenceType={this.bedPreferenceType}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    language={this.language}\n                    bookedByInfoData={this.bookedByInfoData}\n                    defaultGuestData={this.defaultData}\n                    isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                    onDataUpdateEvent={event => this.handlePageTwoDataUpdateEvent(event)}\n                  ></igl-booking-form>\n                )}\n                {this.getCurrentPage('page_block_date') ? this.getPageBlockDatesView() : null}\n              </div>\n              {this.getCurrentPage('page_block_date') ? (\n                <div class=\"sheet-footer\">\n                  <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class=\"flex-fill\" onClick={() => this.closeWindow()}></ir-button>\n                  <ir-button\n                    text={locales.entries.Lcz_Blockdates}\n                    isLoading={isRequestPending('/Block_Exposed_Unit')}\n                    class=\"flex-fill\"\n                    onClick={() => this.handleBlockDate()}\n                  ></ir-button>\n                </div>\n              ) : (\n                <igl-book-property-footer\n                  page={this.page}\n                  dateRangeData={this.dateRangeData}\n                  isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                  isLoading={this.isLoading}\n                  class={'sheet-footer'}\n                  eventType={this.bookingData.event_type}\n                ></igl-book-property-footer>\n              )}\n            </Fragment>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  width: 100% !important;\n  background: #000;\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { TIcons } from '@/components/ui/ir-icons/icons';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\n\n@Component({\n  tag: 'igl-book-property-footer',\n  styleUrl: 'igl-book-property-footer.css',\n  scoped: true,\n})\nexport class IglBookPropertyFooter {\n  @Prop() eventType: string;\n  @Prop() disabled: boolean = true;\n  @Prop() page: string;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() isLoading: string;\n\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\n\n  private isEventType(event: string) {\n    return event === this.eventType;\n  }\n  private editNext(label) {\n    if (this.isEventType('EDIT_BOOKING')) {\n      if (label === 'Cancel') {\n        return 'flex-fill';\n      } else {\n        return 'd-none d-md-block  flex-fill';\n      }\n    }\n    return 'flex-fill';\n  }\n\n  private renderButton({\n    label,\n    type,\n    disabled,\n    icon_name,\n    isLoading,\n    icon_position = 'right',\n  }: {\n    type: TPropertyButtonsTypes;\n    label: string;\n    disabled?: boolean;\n    icon_name?: TIcons;\n    isLoading?: boolean;\n    icon_position?: 'right' | 'left';\n  }) {\n    return (\n      <div class={this.shouldRenderTwoButtons() ? ` ${this.editNext(label)}` : 'flex-fill'}>\n        {/* <button class={`btn btn-${type === 'cancel' ? 'secondary' : 'primary'} full-width`} onClick={() => this.buttonClicked.emit({ key: type })} disabled={disabled}>\n          {label}\n        </button> */}\n        <ir-button\n          isLoading={isLoading}\n          btn_color={type === 'cancel' || type === 'back' ? 'secondary' : 'primary'}\n          text={label}\n          btn_disabled={disabled}\n          onClickHandler={() => {\n            this.buttonClicked.emit({ key: type });\n          }}\n          class=\"full-width\"\n          btn_styles=\"justify-content-center\"\n          icon_name={icon_name}\n          iconPosition={icon_position}\n          style={{ '--icon-size': '1rem' }}\n          icon_style={{ paddingBottom: '1.9px' }}\n        ></ir-button>\n      </div>\n    );\n  }\n\n  private shouldRenderTwoButtons() {\n    return this.isEventType('PLUS_BOOKING') || this.isEventType('ADD_ROOM') || this.isEventType('EDIT_BOOKING');\n  }\n\n  render() {\n    if (this.page === 'page_one') {\n      return (\n        <Host>\n          {/* <div class=\"d-flex justify-content-between gap-30 align-items-center full-width\"> */}\n          {this.isEventType('EDIT_BOOKING') ? (\n            <Fragment>\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\n              {this.shouldRenderTwoButtons() &&\n                this.renderButton({\n                  type: 'next',\n                  label: `${locales.entries.Lcz_Next}`,\n                  disabled: isRequestPending('/Get_Exposed_Booking_Availability'),\n                  icon_name: 'angles_right',\n                })}\n            </Fragment>\n          ) : (\n            <Fragment>\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\n              {this.shouldRenderTwoButtons() && this.renderButton({ type: 'next', label: `${locales.entries.Lcz_Next}`, icon_name: 'angles_right' })}\n            </Fragment>\n          )}\n          {/* </div> */}\n        </Host>\n      );\n    }\n    const showBookAndCheckin = calendar_data.checkin_enabled && moment(new Date(this.dateRangeData?.fromDate)).isSame(new Date(), 'day');\n    return (\n      <Fragment>\n        {this.isEditOrAddRoomEvent ? (\n          <Fragment>\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\n            {this.renderButton({ type: 'save', label: locales.entries.Lcz_Save, isLoading: this.isLoading === 'save' })}\n          </Fragment>\n        ) : (\n          <Fragment>\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\n            {this.renderButton({ type: 'book', label: locales.entries.Lcz_Book, isLoading: this.isLoading === 'book' })}\n            {showBookAndCheckin && this.renderButton({ type: 'bookAndCheckIn', label: locales.entries.Lcz_BookAndChekcIn, isLoading: this.isLoading === 'bookAndCheckIn' })}\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n\n.sourceContainer {\n  max-width: 350px;\n}\n.message-label {\n  font-size: 80%;\n}\n","import { Component, Host, Prop, h, Event, EventEmitter } from '@stencil/core';\nimport { TAdultChildConstraints, TPropertyButtonsTypes, TSourceOption, TSourceOptions } from '../../../../models/igl-book-property';\n\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { modifyBookingStore } from '@/stores/booking.store';\n\n@Component({\n  tag: 'igl-book-property-header',\n  styleUrl: 'igl-book-property-header.css',\n  scoped: true,\n})\nexport class IglBookPropertyHeader {\n  @Prop() splitBookingId: any = '';\n  @Prop() bookingData: any = '';\n  @Prop() minDate: string;\n  @Prop() sourceOptions: TSourceOptions[] = [];\n  @Prop() message: string;\n  @Prop() bookingDataDefaultDateRange: { [key: string]: any };\n  @Prop() showSplitBookingOption: boolean = false;\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n  @Prop() splitBookings: any[];\n  @Prop() adultChildCount: { adult: number; child: number };\n  @Prop() dateRangeData: any;\n  @Prop() bookedByInfoData: any;\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\n  @Prop() propertyId: number;\n  @Prop() wasBlockedUnit: boolean;\n\n  @Event() splitBookingDropDownChange: EventEmitter<any>;\n  @Event() sourceDropDownChange: EventEmitter<string>;\n  @Event() adultChild: EventEmitter<any>;\n  @Event() checkClicked: EventEmitter<any>;\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\n  @Event() toast: EventEmitter<IToast>;\n  @Event() spiltBookingSelected: EventEmitter<{ key: string; data: unknown }>;\n\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n\n  private sourceOption: TSourceOption = {\n    code: '',\n    description: '',\n    tag: '',\n    id: '',\n    type: '',\n  };\n\n  getSplitBookingList() {\n    return (\n      <fieldset class=\"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center\">\n        <label class=\"mr-lg-1\">{locales.entries.Lcz_Tobooking}# </label>\n        <div class=\"btn-group mt-1 mt-lg-0 sourceContainer\">\n          <ir-autocomplete\n            value={\n              Object.keys(this.bookedByInfoData).length > 1 ? `${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}` : ''\n            }\n            from_date={moment(this.bookingDataDefaultDateRange.fromDate).format('YYYY-MM-DD')}\n            to_date={moment(this.bookingDataDefaultDateRange.toDate).format('YYYY-MM-DD')}\n            propertyId={this.propertyId}\n            placeholder={locales.entries.Lcz_BookingNumber}\n            onComboboxValue={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation;\n              this.spiltBookingSelected.emit(e.detail);\n            }}\n            isSplitBooking\n          ></ir-autocomplete>\n        </div>\n      </fieldset>\n    );\n  }\n  getSourceNode() {\n    return (\n      <fieldset class=\"d-flex text-left  align-items-center\">\n        <label class=\"mr-1\">{locales.entries.Lcz_Source} </label>\n        <div class=\"btn-group mt-0 flex-fill sourceContainer\">\n          <select class=\"form-control input-sm\" id=\"xSmallSelect\" onChange={evt => this.sourceDropDownChange.emit((evt.target as HTMLSelectElement).value)}>\n            {this.sourceOptions.map(option => {\n              if (option.type === 'LABEL') {\n                return <optgroup label={option.value}></optgroup>;\n              }\n              return (\n                <option value={option.id} selected={this.sourceOption.code === option.id}>\n                  {option.value}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n      </fieldset>\n    );\n  }\n  handleAdultChildChange(key: string, value: string) {\n    //const value = (event.target as HTMLSelectElement).value;\n    let obj = {};\n    if (value === '') {\n      obj = {\n        ...this.adultChildCount,\n        [key]: 0,\n      };\n    } else {\n      obj = {\n        ...this.adultChildCount,\n        [key]: value,\n      };\n    }\n    modifyBookingStore('bookingAvailabilityParams', {\n      from_date: this.bookingDataDefaultDateRange.fromDate,\n      to_date: this.bookingDataDefaultDateRange.toDate,\n      adult_nbr: obj?.['adult'] ?? 0,\n      child_nbr: obj?.['child'] ?? 0,\n    });\n    this.adultChild.emit(obj);\n  }\n\n  getAdultChildConstraints() {\n    return (\n      <div class={'mt-1 mt-lg-0 d-flex flex-column text-left'}>\n        {/* <label class=\"mb-1 d-lg-none\">{locales.entries.Lcz_NumberOfGuests} </label> */}\n        <div class=\"form-group  my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start\">\n          <fieldset>\n            <div class=\"btn-group ml-0\">\n              <ir-select\n                testId=\"adult_number\"\n                class={'m-0'}\n                selectedValue={this.adultChildCount?.adult?.toString()}\n                onSelectChange={e => this.handleAdultChildChange('adult', e.detail)}\n                selectId=\"adult_select\"\n                firstOption={locales.entries.Lcz_AdultsCaption}\n                data={Array.from(Array(this.adultChildConstraints.adult_max_nbr), (_, i) => i + 1).map(option => ({\n                  text: option.toString(),\n                  value: option.toString(),\n                }))}\n              ></ir-select>\n            </div>\n          </fieldset>\n          {this.adultChildConstraints.child_max_nbr > 0 && (\n            <fieldset>\n              <div class=\"btn-group ml-1 p-0\">\n                {/* <select class=\"form-control input-sm\" id=\"xChildrenSmallSelect\" onChange={evt => this.handleAdultChildChange('child', evt)}>\n                  <option value={''}>{this.renderChildCaption()}</option>\n                  {Array.from(Array(this.adultChildConstraints.child_max_nbr), (_, i) => i + 1).map(option => (\n                    <option value={option}>{option}</option>\n                  ))}\n                </select> */}\n                <ir-select\n                  selectedValue={this.adultChildCount?.child?.toString()}\n                  testId=\"child_number\"\n                  onSelectChange={e => this.handleAdultChildChange('child', e.detail)}\n                  selectId=\"child_select\"\n                  firstOption={this.renderChildCaption()}\n                  data={Array.from(Array(this.adultChildConstraints.child_max_nbr), (_, i) => i + 1).map(option => ({\n                    text: option.toString(),\n                    value: option.toString(),\n                  }))}\n                ></ir-select>\n              </div>\n            </fieldset>\n          )}\n          <ir-button\n            btn_id=\"check_availability\"\n            isLoading={isRequestPending('/Check_Availability')}\n            size=\"sm\"\n            class=\"ml-2\"\n            text={locales.entries.Lcz_Check}\n            onClickHandler={() => this.handleButtonClicked()}\n          ></ir-button>\n          {/* <button class={'btn btn-primary btn-sm  ml-2'} onClick={() => this.handleButtonClicked()}>\n            {locales.entries.Lcz_Check}\n          </button> */}\n        </div>\n      </div>\n    );\n  }\n  renderChildCaption() {\n    const maxAge = this.adultChildConstraints.child_max_age;\n    let years = locales.entries.Lcz_Years;\n\n    if (maxAge === 1) {\n      years = locales.entries.Lcz_Year;\n    }\n    return `${locales.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${years}`;\n  }\n  handleButtonClicked() {\n    if (this.isEventType('SPLIT_BOOKING') && Object.keys(this.bookedByInfoData).length <= 1) {\n      this.toast.emit({\n        type: 'error',\n        title: locales.entries.Lcz_ChooseBookingNumber,\n        description: '',\n        position: 'top-right',\n      });\n    } else if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n      const initialToDate = moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date));\n      const initialFromDate = moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date));\n      const selectedFromDate = moment(new Date(this.dateRangeData.fromDate));\n      const selectedToDate = moment(new Date(this.dateRangeData.toDate));\n      if (selectedToDate.isBefore(initialFromDate) || selectedFromDate.isAfter(initialToDate)) {\n        this.toast.emit({\n          type: 'error',\n          title: `${locales.entries.Lcz_CheckInDateShouldBeMAx.replace(\n            '%1',\n            moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date)).format('ddd, DD MMM YYYY'),\n          ).replace('%2', moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date)).format('ddd, DD MMM YYYY'))}  `,\n          description: '',\n          position: 'top-right',\n        });\n        return;\n      } else if (this.adultChildCount.adult === 0) {\n        this.toast.emit({ type: 'error', title: locales.entries.Lcz_PlzSelectNumberOfGuests, description: '', position: 'top-right' });\n        this.animateIrSelect.emit('adult_child_select');\n      } else {\n        this.buttonClicked.emit({ key: 'check' });\n      }\n    } else if (this.minDate && new Date(this.dateRangeData.fromDate).getTime() > new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date).getTime()) {\n      this.toast.emit({\n        type: 'error',\n        title: `${locales.entries.Lcz_CheckInDateShouldBeMAx.replace(\n          '%1',\n          moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date)).format('ddd, DD MMM YYYY'),\n        ).replace('%2', moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date)).format('ddd, DD MMM YYYY'))}  `,\n        description: '',\n        position: 'top-right',\n      });\n    } else if (this.adultChildCount.adult === 0) {\n      this.animateIrSelect.emit('adult_child_select');\n      this.toast.emit({ type: 'error', title: locales.entries.Lcz_PlzSelectNumberOfGuests, description: '', position: 'top-right' });\n    } else {\n      this.buttonClicked.emit({ key: 'check' });\n    }\n  }\n  isEventType(key: string) {\n    return this.bookingData.event_type === key;\n  }\n  private getMinDate() {\n    if (this.isEventType('PLUS_BOOKING')) {\n      return moment().add(-1, 'months').startOf('month').format('YYYY-MM-DD');\n    }\n    if (this.wasBlockedUnit) {\n      return this.bookingData?.block_exposed_unit_props.from_date;\n    }\n    return this.minDate;\n  }\n  private getMaxDate() {\n    if (!this.bookingData?.block_exposed_unit_props) {\n      return undefined;\n    }\n    return this.bookingData?.block_exposed_unit_props.to_date;\n  }\n  render() {\n    const showSourceNode = this.showSplitBookingOption ? this.getSplitBookingList() : this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM') ? false : true;\n    return (\n      <Host>\n        {this.isEventType('SPLIT_BOOKING') && this.getSplitBookingList()}\n        {showSourceNode && this.getSourceNode()}\n        <div class={`d-flex flex-column flex-lg-row align-items-lg-center ${showSourceNode ? 'mt-1' : ''}`}>\n          <fieldset class=\"mt-lg-0 mr-1 \">\n            <igl-date-range\n              data-testid=\"date_picker\"\n              variant=\"booking\"\n              dateLabel={locales.entries.Lcz_Dates}\n              maxDate={this.getMaxDate()}\n              minDate={this.getMinDate()}\n              disabled={(this.isEventType('BAR_BOOKING') && !this.wasBlockedUnit) || this.isEventType('SPLIT_BOOKING')}\n              defaultData={this.bookingDataDefaultDateRange}\n            ></igl-date-range>\n          </fieldset>\n          {!this.isEventType('EDIT_BOOKING') && this.getAdultChildConstraints()}\n        </div>\n        <p class=\"text-right mt-1 message-label\">{calendar_data.tax_statement}</p>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n}\n","import { Component, Prop, h, Event, EventEmitter, State } from '@stencil/core';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyPayloadEditBooking, TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport { formatAmount } from '@/utils/utils';\nimport locales from '@/stores/locales.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { ICountry } from '@/models/IBooking';\n@Component({\n  tag: 'igl-booking-form',\n  styleUrl: 'igl-booking-form.css',\n  scoped: true,\n})\nexport class IglBookingForm {\n  @Prop() showPaymentDetails: boolean;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() bookingData: { [key: string]: any };\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() language: string;\n  @Prop() bookedByInfoData: { [key: string]: any };\n  @Prop() propertyId: number;\n  @Prop() bedPreferenceType: any;\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop({ reflect: true }) isLoading: string;\n  @Prop() countries: ICountry[];\n  @Prop() selectedGuestData;\n  @Prop() defaultGuestData: IglBookPropertyPayloadEditBooking;\n\n  @State() selectedBookedByData;\n  @State() guestData: any;\n  @State() selectedUnits: { [key: string]: any } = {};\n\n  @Event() dataUpdateEvent: EventEmitter<IPageTwoDataUpdateProps>;\n  @Event() buttonClicked: EventEmitter<{\n    key: TPropertyButtonsTypes;\n    data?: CustomEvent;\n  }>;\n\n  componentWillLoad() {\n    this.initializeGuestData();\n    this.selectedBookedByData = this.bookedByInfoData;\n  }\n\n  initializeGuestData() {\n    let total = 0;\n    const newSelectedUnits = { ...this.selectedUnits };\n    const getRate = (rate: number, totalNights: number, isRateModified: boolean, preference: number) => {\n      if (isRateModified && preference === 2) {\n        return rate * totalNights;\n      }\n      return rate;\n    };\n    this.selectedUnits = newSelectedUnits;\n    this.guestData = [];\n    this.selectedRooms.forEach((room, key) => {\n      room.forEach(rate_plan => {\n        newSelectedUnits[key] = rate_plan.selectedUnits;\n        total += rate_plan.totalRooms * getRate(rate_plan.rate, this.dateRangeData.dateDifference, rate_plan.isRateModified, rate_plan.rateType);\n        for (let i = 1; i <= rate_plan.totalRooms; i++) {\n          this.guestData.push({\n            guestName: '',\n            roomId: '',\n            preference: '',\n            ...rate_plan,\n          });\n        }\n      });\n    });\n    this.bookingData.TOTAL_PRICE = total;\n  }\n  handleOnApplicationInfoDataUpdateEvent(event: CustomEvent, index: number) {\n    const opt = event.detail;\n    const categoryIdKey = `c_${opt.data.roomCategoryId}`;\n    const updatedUnits = [...(this.selectedUnits[categoryIdKey] || [])];\n    updatedUnits[index] = opt.data.roomId;\n    this.selectedUnits = {\n      ...this.selectedUnits,\n      [categoryIdKey]: updatedUnits,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'applicationInfoUpdateEvent',\n      value: event.detail,\n    });\n  }\n\n  handleEventData(event: any, key: string, index: number) {\n    if (key === 'application-info') {\n      this.handleOnApplicationInfoDataUpdateEvent(event, index);\n    } else {\n      this.selectedBookedByData = event.detail.data;\n      this.dataUpdateEvent.emit({\n        key: 'propertyBookedBy',\n        value: event.detail,\n      });\n    }\n  }\n  isGuestDataIncomplete() {\n    if (this.selectedGuestData.length !== this.guestData.length) {\n      return true;\n    }\n    for (const data of this.selectedGuestData) {\n      if (data.guestName === '' || data.preference === '' || data.roomId === '') {\n        return true;\n      }\n    }\n    return false;\n  }\n  isButtonDisabled(key: string) {\n    const isValidProperty = (property, key, comparedBy) => {\n      if (!property) {\n        return true;\n      }\n      if (property === this.selectedGuestData) {\n        return this.isGuestDataIncomplete();\n      }\n      if (key === 'selectedArrivalTime') {\n        if (property[key] !== undefined) {\n          return property[key].code === '';\n        } else {\n          return true;\n        }\n      }\n      return property[key] === comparedBy || property[key] === undefined;\n    };\n    return (\n      this.isLoading === key ||\n      isValidProperty(this.selectedGuestData, 'guestName', '') ||\n      isValidProperty(this.selectedBookedByData, 'isdCode', '') ||\n      isValidProperty(this.selectedBookedByData, 'contactNumber', '') ||\n      isValidProperty(this.selectedBookedByData, 'firstName', '') ||\n      isValidProperty(this.selectedBookedByData, 'lastName', '') ||\n      isValidProperty(this.selectedBookedByData, 'countryId', -1) ||\n      isValidProperty(this.selectedBookedByData, 'selectedArrivalTime', '') ||\n      isValidProperty(this.selectedBookedByData, 'email', '')\n    );\n  }\n\n  render() {\n    return (\n      <div class=\"d-flex flex-column h-100\">\n        <div class=\"d-flex flex-wrap\">\n          <ir-date-view\n            class=\"mr-1 flex-fill font-weight-bold font-medium-1\"\n            from_date={new Date(this.dateRangeData.fromDate)}\n            to_date={new Date(this.dateRangeData.toDate)}\n            dateOption=\"DD MMM YYYY\"\n          ></ir-date-view>\n          {this.guestData.length > 1 && (\n            <div class=\"mt-1 mt-md-0 text-right\">\n              {locales.entries.Lcz_TotalPrice} <span class=\"font-weight-bold font-medium-1\">{formatAmount(this.currency.symbol, this.bookingData.TOTAL_PRICE || '0')}</span>\n            </div>\n          )}\n        </div>\n        {Object.values(booking_store.ratePlanSelections).map(val =>\n          Object.values(val).map(ratePlan => {\n            const rp = ratePlan as IRatePlanSelection;\n            if (rp.reserved === 0) {\n              return null;\n            }\n\n            return [...new Array(rp.reserved)].map((_, i) => (\n              <igl-application-info\n                totalNights={Number(this.dateRangeData.dateDifference)}\n                bedPreferenceType={this.bedPreferenceType}\n                currency={this.currency}\n                guestInfo={rp.guest ? rp.guest[i] : null}\n                bookingType={this.bookingData.event_type}\n                rateplanSelection={rp}\n                key={`${rp.ratePlan.id}_${i}`}\n                roomIndex={i}\n                baseData={\n                  this.bookingData.event_type === 'EDIT_BOOKING'\n                    ? {\n                        roomtypeId: this.bookingData.currentRoomType.roomtype.id,\n                        unit: this.bookingData.currentRoomType.unit,\n                      }\n                    : undefined\n                }\n              ></igl-application-info>\n            ));\n          }),\n        )}\n\n        {this.isEditOrAddRoomEvent || this.showSplitBookingOption ? null : (\n          <igl-property-booked-by\n            propertyId={this.propertyId}\n            countries={this.countries}\n            language={this.language}\n            showPaymentDetails={this.showPaymentDetails}\n            defaultData={this.bookedByInfoData}\n            onDataUpdateEvent={event => {\n              this.handleEventData(event, 'propertyBookedBy', 0);\n            }}\n          ></igl-property-booked-by>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host > * {\n  margin: 0;\n  padding: auto;\n}\n.scrollContent {\n  height: calc(100% - 79px);\n  overflow: auto;\n  position: relative;\n}\n.loading-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  background: white;\n  position: absolute;\n  inset: 0;\n  z-index: 100;\n}\n.loader {\n  width: 1.25rem;\n  height: 1.25rem;\n  border: 2.5px solid #3f3f3f;\n  border-bottom-color: transparent;\n  border-radius: 50%;\n  display: inline-block;\n  box-sizing: border-box;\n  animation: rotation 1s linear infinite;\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TAdultChildConstraints, TSourceOptions } from '../../../../models/igl-book-property';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport moment from 'moment';\nimport booking_store from '@/stores/booking.store';\n@Component({\n  tag: 'igl-booking-overview-page',\n  styleUrl: 'igl-booking-overview-page.css',\n  scoped: true,\n})\nexport class IglBookingOverviewPage {\n  @Prop() bookingData: any;\n  @Prop() propertyId: number;\n  @Prop() message: string;\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() eventType: string;\n  @Prop() currency: any;\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n  @Prop() ratePricingMode: any;\n  @Prop() dateRangeData: any;\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop() adultChildCount: { adult: number; child: number };\n  @Prop() sourceOptions: TSourceOptions[];\n  @Prop() bookedByInfoData: any;\n  @Prop() initialRoomIds: any;\n  @Prop() wasBlockedUnit: boolean;\n\n  @Event() roomsDataUpdate: EventEmitter;\n\n  getSplitBookings() {\n    return (this.bookingData.hasOwnProperty('splitBookingEvents') && this.bookingData.splitBookingEvents) || [];\n  }\n  isEventType(event: string) {\n    return event === this.eventType;\n  }\n  setMinDate() {\n    if (!this.isEventType('EDIT_BOOKING')) {\n      return;\n    }\n    const from_date = moment(this.bookingData.FROM_DATE, 'YYYY-MM-DD');\n    const today = moment();\n    if (from_date.isAfter(today)) {\n      return today.add(-2, 'weeks').format('YYYY-MM-DD');\n    }\n    return from_date.add(-2, 'weeks').format('YYYY-MM-DD');\n  }\n  render() {\n    return (\n      <Host>\n        <igl-book-property-header\n          wasBlockedUnit={this.wasBlockedUnit}\n          bookedByInfoData={this.bookedByInfoData}\n          defaultDaterange={this.defaultDaterange}\n          dateRangeData={this.dateRangeData}\n          minDate={this.setMinDate()}\n          // minDate={this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING') ? this.bookedByInfoData.from_date || this.bookingData.FROM_DATE : undefined}\n          adultChildCount={this.adultChildCount}\n          splitBookingId={this.showSplitBookingOption}\n          bookingData={this.bookingData}\n          sourceOptions={this.sourceOptions}\n          message={this.message}\n          bookingDataDefaultDateRange={this.bookingData.defaultDateRange}\n          showSplitBookingOption={this.showSplitBookingOption}\n          adultChildConstraints={this.adultChildConstraints}\n          splitBookings={this.getSplitBookings()}\n          propertyId={this.propertyId}\n        ></igl-book-property-header>\n        {/* {this.adultChildCount.adult === 0 && <p class={'col text-left'}>Please select the number of guests</p>} */}\n        <div class=\" text-left\">\n          {isRequestPending('/Check_Availability') && this.isEventType('EDIT_BOOKING') ? (\n            <div class=\"loading-container\">\n              <div class=\"loader\"></div>\n            </div>\n          ) : (\n            <Fragment>\n              {booking_store.roomTypes?.map(roomType => (\n                <igl-room-type\n                  initialRoomIds={this.initialRoomIds}\n                  isBookDisabled={Object.keys(this.bookedByInfoData).length <= 1}\n                  key={`room-type-${roomType.id}`}\n                  currency={this.currency}\n                  ratePricingMode={this.ratePricingMode}\n                  dateDifference={this.dateRangeData.dateDifference}\n                  bookingType={this.bookingData.event_type}\n                  roomType={roomType}\n                  class=\"mt-2 mb-1 p-0\"\n                  data-testid={`room_type_${roomType.id}`}\n                  id={roomType.id.toString()}\n                  roomInfoId={this.selectedRooms.has(`c_${roomType.id}`) ? roomType.id : null}\n                  onDataUpdateEvent={evt => this.roomsDataUpdate.emit(evt.detail)}\n                ></igl-room-type>\n              ))}\n            </Fragment>\n          )}\n        </div>\n\n        {/* <igl-book-property-footer class={'p-0 mb-1 mt-3'} eventType={this.bookingData.event_type}></igl-book-property-footer> */}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.bookedByEmailContainer {\n  flex: auto;\n  max-width: 350px;\n}\n\n.bookedDetailsForm label {\n  min-width: 125px;\n  max-width: 125px;\n}\n.row.sc-igl-booking-form {\n  padding: 0 !important;\n}\n.bookedDetailsForm .form-group {\n  margin-bottom: 10px !important;\n}\n\n.bookedDetailsForm .checkBoxContainer input {\n  height: 1.2rem !important;\n  width: 30px;\n}\n\n.property-booked-by__money-transfer-description * {\n  margin: 0 !important;\n  margin-bottom: 0 !important;\n  margin-top: 0 !important;\n}\n/* reset wrapper itself + all descendants */\n.property-booked-by__money-transfer-description,\n.property-booked-by__money-transfer-description :where(*, *::before, *::after) {\n  margin: 0.5rem !important;\n}\n/* .controlContainer1 .textarea-container {\n  border: 1px solid #ced4da; \n  border-radius: 0.25rem; \n  height: 60px; \n  width: 100%;\n} */\n.controlContainer textarea {\n  height: 60px !important;\n}\n.margin3 {\n  margin-bottom: 5px !important;\n}\n@media (min-width: 768px) {\n  .bookedByEmailContainer {\n    margin-left: 37px;\n  }\n}\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Fragment, Listen } from '@stencil/core';\nimport { BookingService } from '@/services/booking.service';\nimport { IEntries, ICountry } from '@/models/IBooking';\nimport { v4 } from 'uuid';\nimport locales from '@/stores/locales.store';\nimport { TPropertyButtonsTypes } from '@/components';\nimport { z } from 'zod';\nimport { validateEmail } from '@/utils/utils';\nimport booking_store, { BookingStore, modifyBookingStore } from '@/stores/booking.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { AllowedPaymentMethod } from '@/models/booking.dto';\n\n@Component({\n  tag: 'igl-property-booked-by',\n  styleUrl: 'igl-property-booked-by.css',\n  scoped: true,\n})\nexport class IglPropertyBookedBy {\n  @Prop() language: string;\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() defaultData: { [key: string]: any };\n  @Prop() countries: ICountry[] = [];\n  @Prop() propertyId: number;\n\n  @State() isButtonPressed: boolean = false;\n  @State() bookedByData: { [key: string]: any } = {\n    id: undefined,\n    email: '',\n    firstName: '',\n    lastName: '',\n    countryId: '',\n    isdCode: '',\n    contactNumber: '',\n    selectedArrivalTime: '',\n    emailGuest: false,\n    message: '',\n    cardNumber: '',\n    cardHolderName: '',\n    expiryMonth: '',\n    expiryYear: '',\n  };\n\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\n\n  private bookingService: BookingService = new BookingService();\n  private arrivalTimeList: IEntries[] = [];\n  private expiryMonths: string[] = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];\n  private expiryYears: string[] = [];\n  private currentMonth: string = '01';\n  private country;\n  private paymentMethods: AllowedPaymentMethod[] = [];\n\n  componentWillLoad() {\n    this.assignCountryCode();\n    this.initializeExpiryYears();\n    this.initializeDateData();\n    this.populateBookedByData();\n    this.paymentMethods = calendar_data.property.allowed_payment_methods.filter(p => p.is_active && !p.is_payment_gateway);\n    if (this.paymentMethods.length > 0) {\n      modifyBookingStore('selectedPaymentMethod', { code: this.paymentMethods[0].code });\n    }\n  }\n\n  @Listen('buttonClicked', { target: 'body' })\n  handleButtonClicked(\n    event: CustomEvent<{\n      key: TPropertyButtonsTypes;\n      data?: CustomEvent;\n    }>,\n  ) {\n    switch (event.detail.key) {\n      case 'book':\n      case 'bookAndCheckIn':\n        this.isButtonPressed = true;\n        break;\n    }\n  }\n\n  private initializeExpiryYears() {\n    const currentYear = new Date().getFullYear();\n    this.expiryYears = Array.from({ length: 12 }, (_, index) => (currentYear + index).toString());\n  }\n  private async assignCountryCode() {\n    const country = await this.bookingService.getUserDefaultCountry();\n\n    const countryId = country['COUNTRY_ID'];\n    this.country = countryId;\n    this.bookedByData = { ...this.bookedByData, isdCode: countryId.toString(), countryId };\n  }\n  private initializeDateData() {\n    const dt = new Date();\n    const month = dt.getMonth() + 1;\n    this.currentMonth = month < 10 ? `0${month}` : month.toString();\n  }\n\n  private populateBookedByData() {\n    this.bookedByData = this.defaultData ? { ...this.bookedByData, ...this.defaultData } : {};\n    this.arrivalTimeList = this.defaultData?.arrivalTime || [];\n    this.bookedByData = { ...this.bookedByData, selectedArrivalTime: this.arrivalTimeList[0].CODE_NAME };\n    if (!this.bookedByData.expiryMonth) {\n      this.bookedByData.expiryMonth = this.currentMonth;\n    }\n    if (!this.bookedByData.expiryYear) {\n      this.bookedByData.expiryYear = new Date().getFullYear();\n    }\n  }\n\n  private handleDataChange(key, event) {\n    this.bookedByData[key] = key === 'emailGuest' ? event.target.checked : event.target.value;\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n    if (key === 'countryId') {\n      this.bookedByData = {\n        ...this.bookedByData,\n        isdCode: event.target.value,\n      };\n    }\n    // console.log(this.bookedByData);\n  }\n  private handleCountryChange(value) {\n    this.bookedByData = {\n      ...this.bookedByData,\n      isdCode: value,\n      countryId: value,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n    // console.log(this.bookedByData);\n  }\n\n  private handleNumberInput(key, event: InputEvent) {\n    const inputElement = event.target as HTMLInputElement;\n    const inputValue = inputElement.value;\n\n    // Regular expression to match only numeric characters (0-9)\n    const numericRegex = /^[0-9]+$/;\n\n    if (!numericRegex.test(inputValue)) {\n      // If the input is not numeric, prevent it from being entered\n      inputElement.value = inputValue.replace(/[^0-9]/g, '');\n    }\n    if (inputValue === inputElement.value) {\n      this.handleDataChange(key, event);\n    }\n  }\n\n  // async handleEmailInput(key, event: InputEvent) {\n  //   const inputElement = event.target as HTMLInputElement;\n  //   const inputValue = inputElement.value;\n  //   if (z.string().email().safeParse(inputValue).success) {\n  //     this.handleDataChange(key, event);\n  //   }\n  // }\n  private async checkUser() {\n    try {\n      const email = this.bookedByData.email;\n      if (z.string().email().safeParse(email).success) {\n        const res = await this.bookingService.getUserInfo(email);\n        if (res !== null) {\n          this.bookedByData = {\n            ...this.bookedByData,\n            id: res.id,\n            firstName: res.first_name,\n            lastName: res.last_name,\n            contactNumber: res.mobile_without_prefix,\n            countryId: res.country_id,\n            isdCode: res?.country_phone_prefix ?? res.isdCode.toString(),\n          };\n          console.log(this.bookedByData);\n        } else {\n          let prevBookedByData = { ...this.bookedByData };\n          prevBookedByData = { ...prevBookedByData, email };\n          this.bookedByData = { ...prevBookedByData };\n        }\n      } else {\n        let prevBookedByData = { ...this.bookedByData };\n        prevBookedByData = { ...prevBookedByData, email: '' };\n        this.bookedByData = { ...prevBookedByData };\n      }\n      this.dataUpdateEvent.emit({\n        key: 'bookedByInfoUpdated',\n        data: { ...this.bookedByData },\n      });\n    } catch (error) {\n      //   toastr.error(error);\n    }\n  }\n\n  private updateGuest(props: Partial<BookingStore['checkout_guest']>) {\n    modifyBookingStore('checkout_guest', { ...(booking_store.checkout_guest ?? {}), ...props });\n  }\n\n  private handleComboboxChange(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { key, data } = e.detail;\n    console.log(key, data);\n    if (key === 'blur') {\n      if (z.string().email().safeParse(data).success) {\n        this.bookedByData.email = data;\n        this.checkUser();\n      } else if (this.bookedByData.email !== '' && data == '') {\n        this.bookedByData.email = '';\n      }\n      this.dataUpdateEvent.emit({\n        key: 'bookedByInfoUpdated',\n        data: this.bookedByData,\n      });\n    }\n    if (key === 'select') {\n      this.bookedByData.email = data.email;\n      this.bookedByData = {\n        ...this.bookedByData,\n        id: data.id,\n        firstName: data.first_name,\n        lastName: data.last_name,\n        contactNumber: data.mobile_without_prefix,\n        countryId: data.country_id,\n        isdCode: data['country_phone_prefix'] ?? data?.country_id,\n      };\n      this.dataUpdateEvent.emit({\n        key: 'bookedByInfoUpdated',\n        data: this.bookedByData,\n      });\n    }\n  }\n\n  private clearEvent() {\n    this.bookedByData = {\n      ...this.bookedByData,\n      id: '',\n      firstName: '',\n      lastName: '',\n      contactNumber: '',\n      isdCode: this.country.toString(),\n      countryId: this.country,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class=\"text-left mt-3\">\n          <div class=\"form-group d-flex flex-column flex-md-row align-items-md-center text-left \">\n            <label class=\"p-0 m-0 label-control mr-1 font-weight-bold\">{locales.entries.Lcz_BookedBy}</label>\n            <div class=\"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center\">\n              {/* <input\n                id={v4()}\n                type=\"email\"\n                class=\"form-control\"\n                placeholder=\"Email address\"\n                name=\"bookeyByEmail\"\n                value={this.bookedByData.email}\n                onInput={event => this.handleEmailInput('email', event)}\n                required\n                onBlur={() => this.checkUser()}\n              /> */}\n              <ir-autocomplete\n                testId={'main_guest_email'}\n                onComboboxValue={this.handleComboboxChange.bind(this)}\n                propertyId={this.propertyId}\n                type=\"text\"\n                value={this.bookedByData.email}\n                required\n                class={'flex-fill'}\n                placeholder={locales.entries.Lcz_FindEmailAddress}\n                onInputCleared={() => this.clearEvent()}\n                danger_border={this.isButtonPressed && this.bookedByData.email !== '' && validateEmail(this.bookedByData.email)}\n              ></ir-autocomplete>\n              <ir-tooltip class={'ml-1'} message=\"Leave empty if email is unavailable\"></ir-tooltip>\n            </div>\n          </div>\n        </div>\n        <div class=\"bookedDetailsForm text-left mt-2 font-small-3 \">\n          <div class=\"d-flex flex-column flex-md-row  justify-content-md-between \">\n            <div class=\"p-0 flex-fill \">\n              <div class=\"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill \">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_FirstName}</label>\n                <div class=\"p-0 m-0  controlContainer flex-fill  \">\n                  <input\n                    data-testid=\"main_guest_first_name\"\n                    class={`form-control flex-fill ${this.isButtonPressed && this.bookedByData.firstName === '' && 'border-danger'}`}\n                    type=\"text\"\n                    placeholder={locales.entries.Lcz_FirstName}\n                    id={v4()}\n                    value={this.bookedByData.firstName}\n                    onInput={event => {\n                      this.updateGuest({ first_name: (event.target as HTMLInputElement).value });\n                      this.handleDataChange('firstName', event);\n                    }}\n                    required\n                  />\n                </div>\n              </div>\n\n              <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_LastName}</label>\n                <div class=\"p-0 m-0  controlContainer flex-fill\">\n                  <input\n                    data-testid=\"main_guest_last_name\"\n                    class={`form-control ${this.isButtonPressed && this.bookedByData.lastName === '' && 'border-danger'}`}\n                    type=\"text\"\n                    placeholder={locales.entries.Lcz_LastName}\n                    id={v4()}\n                    value={this.bookedByData.lastName}\n                    onInput={event => this.handleDataChange('lastName', event)}\n                  />\n                </div>\n              </div>\n\n              <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_Country}</label>\n                {/* <div class=\"p-0 m-0  controlContainer flex-fill\"> */}\n                <ir-country-picker\n                  testId=\"main_guest_country\"\n                  class=\"flex-grow-1 m-0\"\n                  onCountryChange={e => this.handleCountryChange(e.detail.id)}\n                  countries={this.countries}\n                  country={this.countries.find(c => c.id === this.bookedByData.countryId)}\n                ></ir-country-picker>\n                {/* <select class={`form-control input-sm pr-0`} id={v4()} onChange={event => this.handleDataChange('countryId', event)}>\n                    <option value=\"\" selected={this.bookedByData.countryId === ''}>\n                      {locales.entries.Lcz_Select}\n                    </option>\n                    {this.countries.map(countryNode => (\n                      <option value={countryNode.id} selected={this.bookedByData.countryId === countryNode.id}>\n                        {countryNode.name}\n                      </option>\n                    ))}\n                  </select> */}\n                {/* </div> */}\n              </div>\n\n              {/* <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_MobilePhone}</label>\n                <div class=\"p-0 m-0  d-flex  controlContainer flex-fill\">\n                  <div class=\" p-0 m-0\">\n                    <select class={`form-control input-sm pr-0`} id={v4()} onChange={event => this.handleDataChange('isdCode', event)}>\n                      <option value=\"\" selected={this.bookedByData.isdCode === ''}>\n                        {locales.entries.Lcz_Isd}\n                      </option>\n                      {this.countries.map(country => (\n                        <option value={country.id} selected={this.bookedByData.isdCode === country.id.toString()}>\n                          {country.phone_prefix}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div class=\"flex-fill p-0 m-0\">\n                    <input\n                      class={`form-control\n                     \n                      `}\n                      type=\"tel\"\n                      placeholder={locales.entries.Lcz_ContactNumber}\n                      id={v4()}\n                      value={this.bookedByData.contactNumber}\n                      onInput={event => this.handleNumberInput('contactNumber', event)}\n                    />\n                  </div>\n                </div>\n              </div> */}\n              <div class=\"form-group p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_MobilePhone}</label>\n                <div class=\"p-0 m-0 controlContainer flex-fill\">\n                  <ir-phone-input\n                    testId=\"main_guest_phone\"\n                    language={this.language}\n                    // label={locales.entries.Lcz_MobilePhone}\n                    value={this.bookedByData.contactNumber}\n                    phone_prefix={this.bookedByData.isdCode}\n                    default_country={this.bookedByData.countryId}\n                    onTextChange={e => {\n                      this.handleDataChange('isdCode', { target: { value: e.detail.phone_prefix } });\n                      this.handleDataChange('contactNumber', { target: { value: e.detail.mobile } });\n                    }}\n                  ></ir-phone-input>\n                </div>\n              </div>\n              <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_YourArrivalTime}</label>\n                <div class=\"p-0 m-0  controlContainer flex-fill\">\n                  <select\n                    data-testid=\"arrival_time\"\n                    class={`form-control input-sm pr-0 ${this.isButtonPressed && this.bookedByData.selectedArrivalTime.code === '' && 'border-danger'}`}\n                    id={v4()}\n                    onChange={event => this.handleDataChange('selectedArrivalTime', event)}\n                  >\n                    {/* <option value=\"\" selected={this.bookedByData.selectedArrivalTime.code === ''}>\n                      -\n                    </option> */}\n                    {this.arrivalTimeList.map(time => (\n                      <option value={time.CODE_NAME} selected={this.bookedByData.selectedArrivalTime.code === time.CODE_NAME}>\n                        {time.CODE_VALUE_EN}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n            </div>\n            <div class=\"p-0 flex-fill  ml-md-3\">\n              <div class=\"  p-0 d-flex flex-column flex-md-row align-items-md-center \">\n                <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_AnyMessageForUs}</label>\n                <div class=\"p-0 m-0  controlContainer flex-fill \">\n                  <textarea\n                    data-testid=\"note\"\n                    id={v4()}\n                    rows={4}\n                    class=\"form-control \"\n                    name=\"message\"\n                    value={this.bookedByData.message}\n                    onInput={event => this.handleDataChange('message', event)}\n                  ></textarea>\n                </div>\n              </div>\n              {this.paymentMethods.length > 1 && (\n                <div class=\"form-group mt-md-1 mt-1 p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                  <label class=\"p-0 m-0 margin3\">Payment Method</label>\n                  <div class=\"p-0 m-0  controlContainer flex-fill\">\n                    <ir-select\n                      showFirstOption={false}\n                      selectedValue={booking_store?.selectedPaymentMethod?.code}\n                      data={this.paymentMethods.map(p => ({\n                        text: p.description,\n                        value: p.code,\n                      }))}\n                      onSelectChange={e =>\n                        modifyBookingStore('selectedPaymentMethod', {\n                          code: e.detail,\n                        })\n                      }\n                    ></ir-select>\n                  </div>\n                </div>\n              )}\n              {booking_store.selectedPaymentMethod?.code === '001' && (\n                <Fragment>\n                  <div class=\"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                    <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_CardNumber}</label>\n                    <div class=\"p-0 m-0  controlContainer flex-fill\">\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"\"\n                        pattern=\"0-9 \"\n                        id={v4()}\n                        value={this.bookedByData.cardNumber}\n                        onInput={event => this.handleNumberInput('cardNumber', event)}\n                      />\n                    </div>\n                  </div>\n                  <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                    <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_CardHolderName}</label>\n                    <div class=\"p-0 m-0  controlContainer flex-fill\">\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        placeholder=\"\"\n                        pattern=\"0-9 \"\n                        id={v4()}\n                        value={this.bookedByData.cardHolderName}\n                        onInput={event => this.handleDataChange('cardHolderName', event)}\n                      />\n                    </div>\n                  </div>\n                  <div class=\"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                    <label class=\"p-0 m-0 margin3\">{locales.entries.Lcz_ExpiryDate}</label>\n                    <div class=\"p-0 m-0 row  controlContainer flex-fill\">\n                      <div class=\"p-0 m-0\">\n                        <select class=\"form-control input-sm pr-0\" id={v4()} onChange={event => this.handleDataChange('expiryMonth', event)}>\n                          {this.expiryMonths.map(month => (\n                            <option value={month} selected={month === this.bookedByData.expiryMonth}>\n                              {month}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      <div class=\"p-0 m-0 ml-1\">\n                        <select class=\"form-control input-sm pr-0\" id={v4()} onChange={event => this.handleDataChange('expiryYear', event)}>\n                          {this.expiryYears.map((year, index) => (\n                            <option value={year} selected={index === this.bookedByData.expiryYear}>\n                              {year}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                    </div>\n                  </div>\n                </Fragment>\n              )}\n              {booking_store.selectedPaymentMethod?.code === '005' && (\n                <div class=\"form-group mt-md-1 mt-1 p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                  <label class=\"p-0 m-0 margin3\"></label>\n                  <div class=\"p-0 m-0  controlContainer flex-fill\">\n                    <div\n                      class=\"property-booked-by__money-transfer-description\"\n                      innerHTML={this.paymentMethods.find(p => p.code === '005')?.localizables.find(l => l.language.code.toLowerCase() === 'en')?.description}\n                    ></div>\n                  </div>\n                </div>\n              )}\n              <div class=\"form-group mt-1 p-0 d-flex flex-row align-items-center\">\n                <label class=\"p-0 m-0\" htmlFor={'emailTheGuestId'}>\n                  {locales.entries.Lcz_EmailTheGuest}\n                </label>\n                <div class=\"p-0 m-0  controlContainer flex-fill checkBoxContainer\">\n                  <input\n                    class=\"form-control\"\n                    type=\"checkbox\"\n                    checked={this.bookedByData.emailGuest}\n                    id={'emailTheGuestId'}\n                    onChange={event => this.handleDataChange('emailGuest', event)}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.margin-bottom-8 {\n  margin-bottom: 8px !important;\n}\n","import { RoomType } from '@/models/property';\nimport { getVisibleInventory } from '@/stores/booking.store';\nimport { Component, Host, h, Prop, Event, EventEmitter, State } from '@stencil/core';\n\n@Component({\n  tag: 'igl-room-type',\n  styleUrl: 'igl-room-type.css',\n  scoped: true,\n})\nexport class IglRoomType {\n  @Prop() roomType: RoomType;\n  @Prop() bookingType = 'PLUS_BOOKING';\n  @Prop() dateDifference: number;\n  @Prop() ratePricingMode = [];\n  @Prop() roomInfoId: number | null = null;\n  @Prop() currency;\n  @Prop() initialRoomIds: any;\n  @Prop() isBookDisabled: boolean;\n\n  @State() selectedRooms: number[] = [];\n  @State() totalRooms: number;\n  @State() roomsDistributions: number[] = [];\n\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\n\n  private validBookingTypes = ['PLUS_BOOKING', 'ADD_ROOM', 'EDIT_BOOKING', 'SPLIT_BOOKING'];\n\n  render() {\n    const isValidBookingType = this.validBookingTypes.includes(this.bookingType);\n\n    return (\n      <Host>\n        {isValidBookingType && this.roomType.rateplans?.length > 0 && <div class=\"font-weight-bold font-medium-1 margin-bottom-8 \">{this.roomType.name}</div>}\n        {this.roomType.rateplans?.map(ratePlan => {\n          if (!!ratePlan.variations) {\n            let shouldBeDisabled = this.roomInfoId && this.roomInfoId === this.roomType.id;\n            // let roomId = -1;\n            // if (shouldBeDisabled && this.initialRoomIds) {\n            //   roomId = this.initialRoomIds.roomId;\n            // }\n            const visibleInventory = getVisibleInventory(this.roomType.id, ratePlan.id);\n            return (\n              <igl-rate-plan\n                // is_bed_configuration_enabled={this.roomType.is_bed_configuration_enabled}\n                // index={index}\n                isBookDisabled={this.isBookDisabled}\n                visibleInventory={visibleInventory}\n                key={`rate-plan-${ratePlan.id}`}\n                ratePricingMode={this.ratePricingMode}\n                class={isValidBookingType ? '' : ''}\n                currency={this.currency}\n                // dateDifference={this.dateDifference}\n                ratePlan={ratePlan}\n                roomTypeId={this.roomType.id}\n                // totalAvailableRooms={this.roomsDistributions[index]}\n                bookingType={this.bookingType}\n                shouldBeDisabled={shouldBeDisabled}\n                // physicalrooms={this.roomType.physicalrooms}\n                // defaultRoomId={roomId}\n              ></igl-rate-plan>\n            );\n          }\n          return null;\n        })}\n      </Host>\n    );\n  }\n}\n","// HelpDocButton.tsx\nimport { FunctionalComponent, h } from '@stencil/core';\n\ntype HelpDocButtonProps = {\n  /** Tooltip message */\n  message?: string;\n  /** Link to open in a new tab */\n  href?: string;\n  /** Optional wrapper class for layout tweaks */\n  class?: string;\n};\n\nexport const HelpDocButton: FunctionalComponent<HelpDocButtonProps> = ({ message, href, class: wrapperClass }) => (\n  <div class={wrapperClass}>\n    <style>\n      {`.documentation-btn{\n          display:flex;\n          align-items:center;\n          justify-content:center;\n          height:1rem;\n          width:1rem;\n          border:1px solid #6b6f82;\n          color:#6b6f82;\n          padding:0.1rem;\n          border-radius:0.5rem;\n          background:transparent;\n        }\n        .documentation-btn:hover{\n          border-color:#104064;\n          background:transparent;\n          color:#104064 !important;\n        }`}\n    </style>\n\n    <ir-tooltip customSlot message={message}>\n      <a slot=\"tooltip-trigger\" class=\"documentation-btn\" target=\"_blank\" rel=\"noopener\" href={href} aria-label={message}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\">\n          <path\n            fill=\"currentColor\"\n            d=\"M224 224C224 171 267 128 320 128C373 128 416 171 416 224C416 266.7 388.1 302.9 349.5 315.4C321.1 324.6 288 350.7 288 392L288 416C288 433.7 302.3 448 320 448C337.7 448 352 433.7 352 416L352 392C352 390.3 352.6 387.9 355.5 384.7C358.5 381.4 363.4 378.2 369.2 376.3C433.5 355.6 480 295.3 480 224C480 135.6 408.4 64 320 64C231.6 64 160 135.6 160 224C160 241.7 174.3 256 192 256C209.7 256 224 241.7 224 224zM320 576C342.1 576 360 558.1 360 536C360 513.9 342.1 496 320 496C297.9 496 280 513.9 280 536C280 558.1 297.9 576 320 576z\"\n          />\n        </svg>\n      </a>\n    </ir-tooltip>\n  </div>\n);\n","import moment from 'moment';\n\nimport { Booking, ExposedApplicablePolicy, Room } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\n\nexport type ApplicablePoliciesByType = Partial<Record<ExposedApplicablePolicy['type'], ExposedApplicablePolicy[]>>;\n\nexport interface ApplicablePolicyStatement extends ExposedApplicablePolicy {\n  roomType: Room['roomtype'];\n  ratePlan: Room['rateplan'];\n  checkInDate: Room['from_date'];\n  grossTotal: Room['gross_total'];\n}\n\nexport interface ApplicablePoliciesResult {\n  policiesByType: ApplicablePoliciesByType;\n  cancellationStatements: ApplicablePolicyStatement[];\n  guaranteeAmount: number;\n}\n\ninterface GroupedRoomPayload {\n  identifiers: string[];\n  ratePlanId: number;\n  roomTypeId: number;\n  rooms: Room[];\n}\n\ntype BookingServiceDependency = Readonly<Pick<BookingService, 'getExposedApplicablePolicies'>>;\n\ninterface ApplicablePoliciesRequest {\n  language?: string;\n}\n\ninterface GroupedPoliciesResponse {\n  grouping: GroupedRoomPayload;\n  policies: ExposedApplicablePolicy[] | null;\n}\n\n/**\n * Coordinates retrieval of applicable policies for a booking by delegating to\n * {@link BookingService} while providing light data preparation utilities.\n */\nexport class ApplicablePoliciesService {\n  private _booking: Booking | null = null;\n\n  constructor(private readonly bookingService: BookingServiceDependency) {}\n\n  /**\n   * Returns the booking reference used to scope applicable policy requests.\n   */\n  public get booking(): Booking | null {\n    return this._booking;\n  }\n\n  /**\n   * Assigns the booking reference that downstream requests rely on.\n   */\n  public set booking(value: Booking | null) {\n    this._booking = value;\n  }\n\n  /**\n   * Fetches the exposed applicable policies for the active booking and groups\n   * them by policy type to simplify consumption within UI layers. Requests for\n   * each unique room grouping are executed in parallel. The response includes\n   * the grouped policies alongside prebuilt cancellation statements and the\n   * aggregate guarantee amount.\n   *\n   * @throws If a booking is not configured prior to invocation.\n   */\n  public async fetchGroupedApplicablePolicies(params: ApplicablePoliciesRequest): Promise<ApplicablePoliciesResult> {\n    if (!this._booking) {\n      throw new Error('Booking must be defined before fetching applicable policies.');\n    }\n    if (['003', '004'].includes(this._booking.status.code) || !this._booking.is_direct) {\n      return;\n    }\n    const { rooms, booking_nbr, currency, property } = this._booking;\n    const groupedRooms = this.groupRoomsForRequest(rooms ?? []);\n\n    try {\n      const requests: Promise<GroupedPoliciesResponse>[] = [];\n\n      groupedRooms.forEach(grouping => {\n        const basePayload = {\n          booking_nbr,\n          currency_id: currency.id,\n          language: params.language,\n          property_id: property.id,\n          rate_plan_id: grouping.ratePlanId,\n          room_type_id: grouping.roomTypeId,\n          is_preserve_history: true,\n        };\n\n        if (grouping.identifiers.length > 1) {\n          grouping.identifiers.forEach(roomIdentifier => {\n            requests.push(\n              this.bookingService\n                .getExposedApplicablePolicies({ ...basePayload, room_identifier: roomIdentifier })\n                .then(policies => ({ grouping: { ...grouping, rooms: rooms.filter(r => r.identifier === roomIdentifier) }, policies })),\n            );\n          });\n        } else {\n          requests.push(this.bookingService.getExposedApplicablePolicies(basePayload).then(policies => ({ grouping, policies })));\n        }\n      });\n\n      const groupedPolicies = await Promise.all(requests);\n\n      const policiesByType = this.buildPoliciesByType(groupedPolicies);\n      const cancellationStatements = this.buildCancellationStatements(groupedPolicies);\n      const guaranteeAmount = this.calculateGuaranteeAmount(groupedPolicies);\n\n      return { policiesByType, cancellationStatements, guaranteeAmount };\n    } catch (error) {\n      const detail = error instanceof Error ? error.message : String(error);\n      throw new Error(`Failed to fetch applicable policies: ${detail}`);\n    }\n  }\n\n  /**\n   * Creates a list of unique room groupings keyed by rate plan and room type.\n   * Each grouping tracks the identifiers of the rooms it represents.\n   *\n   * @param rooms - The rooms attached to the active booking.\n   */\n  private groupRoomsForRequest(rooms: Room[]): GroupedRoomPayload[] {\n    if (!rooms.length) {\n      throw new Error('Cannot request applicable policies without booking rooms.');\n    }\n\n    const groupMap = new Map<string, GroupedRoomPayload>();\n\n    rooms.forEach(room => {\n      if (!room.rateplan?.id || !room.roomtype?.id) {\n        throw new Error('Room is missing rate plan or room type information.');\n      }\n\n      const key = `${room.roomtype.id}-${room.rateplan.id}`;\n      const identifier = typeof room.identifier === 'string' ? room.identifier : null;\n\n      if (!groupMap.has(key)) {\n        groupMap.set(key, {\n          ratePlanId: room.rateplan.id,\n          roomTypeId: room.roomtype.id,\n          identifiers: identifier ? [identifier] : [],\n          rooms: [room],\n        });\n        return;\n      }\n\n      const group = groupMap.get(key)!;\n      group.rooms.push(room);\n      if (identifier && !group.identifiers.includes(identifier)) {\n        group.identifiers.push(identifier);\n      }\n    });\n\n    return [...groupMap.values()];\n  }\n\n  private buildPoliciesByType(groupedPolicies: GroupedPoliciesResponse[]): ApplicablePoliciesByType {\n    const flattened = groupedPolicies.flatMap(group => group.policies ?? []);\n    return this.groupPoliciesByType(flattened);\n  }\n\n  /**\n   * Organizes the raw policies returned from the API by their logical type so\n   * consumers can access grouped guarantees or cancellations effortlessly.\n   */\n  private groupPoliciesByType(policies: ExposedApplicablePolicy[]): ApplicablePoliciesByType {\n    return policies.reduce<ApplicablePoliciesByType>((acc, policy) => {\n      acc[policy.type] = acc[policy.type] ? [...acc[policy.type]!, policy] : [policy];\n      return acc;\n    }, {});\n  }\n\n  /**\n   * Builds the cancellation statements derived from the fetched policies and\n   * booking rooms.\n   */\n  private buildCancellationStatements(groupedPolicies: GroupedPoliciesResponse[]): ApplicablePolicyStatement[] {\n    if (!this._booking) {\n      return [];\n    }\n\n    const statements: ApplicablePolicyStatement[] = [];\n\n    groupedPolicies.forEach(({ grouping, policies }) => {\n      if (!policies?.length) {\n        return;\n      }\n\n      const cancellationPolicy = policies.find(policy => policy.type === 'cancelation');\n      if (!cancellationPolicy) {\n        return;\n      }\n\n      grouping.rooms.forEach(room => {\n        const checkInDate = moment(room.from_date, 'YYYY-MM-DD', true);\n        if (!checkInDate.isValid()) {\n          return;\n        }\n        // const checkInDateStr = checkInDate.format('YYYY-MM-DD');\n        //Remove check-in dates and above from brackets\n        const oldBrackets = cancellationPolicy.brackets.filter(bracket => {\n          const bracketDate = moment(bracket.due_on, 'YYYY-MM-DD', true);\n          return bracketDate.isValid() && bracketDate.isBefore(checkInDate, 'day');\n        });\n        // if (!oldBrackets.length) {\n        //   return;\n        // }\n        //check if at least one bracket have a amount > 0\n        const hasPositiveBracket = oldBrackets.some(bracket => bracket.amount > 0);\n\n        let filteredBrackets: typeof oldBrackets;\n\n        if (hasPositiveBracket) {\n          filteredBrackets = oldBrackets\n            .map((bracket, index) => {\n              if (bracket.amount > 0) {\n                return bracket;\n              }\n              const nextBracket = oldBrackets[index + 1];\n              if (nextBracket?.amount && nextBracket.amount > 0) {\n                return bracket;\n              }\n              return undefined;\n            })\n            .filter((bracket): bracket is (typeof oldBrackets)[number] => Boolean(bracket));\n        } else {\n          filteredBrackets = [...oldBrackets];\n        }\n\n        filteredBrackets = [...this.mergeBracketsByAmount(filteredBrackets)];\n\n        if (!room.rateplan.is_non_refundable) {\n          const inDate = moment(room.from_date, 'YYYY-MM-DD', true);\n          const outDate = moment(room.to_date, 'YYYY-MM-DD', true);\n          const stayNights = outDate.isValid() && inDate.isValid() ? outDate.diff(inDate, 'days') : 0;\n          const fullChargeDate = stayNights > 1 ? inDate.clone().add(1, 'day').format('YYYY-MM-DD') : inDate.format('YYYY-MM-DD');\n          filteredBrackets.push({\n            amount: room.total,\n            amount_formatted: '',\n            code: '',\n            currency_id: this._booking.currency.id,\n            due_on: fullChargeDate,\n            due_on_formatted: '',\n            gross_amount: room.gross_total,\n            gross_amount_formatted: '',\n            statement: '100% of total price',\n          });\n\n          filteredBrackets.sort((a, b) => {\n            const aDate = moment(a.due_on, 'YYYY-MM-DD', true);\n            const bDate = moment(b.due_on, 'YYYY-MM-DD', true);\n            return aDate.valueOf() - bDate.valueOf();\n          });\n        }\n\n        statements.push({\n          ...cancellationPolicy,\n          brackets: filteredBrackets,\n          roomType: room.roomtype,\n          ratePlan: room.rateplan,\n          checkInDate: room.from_date,\n          grossTotal: room.gross_total,\n        });\n      });\n    });\n\n    return statements;\n  }\n\n  /**\n   * Aggregates the guarantee commitments across the booking rooms using the\n   * freshly retrieved policy data.\n   */\n  private calculateGuaranteeAmount(groupedPolicies: GroupedPoliciesResponse[]): number {\n    return groupedPolicies.reduce((total, { grouping, policies }) => {\n      if (!policies?.length) {\n        return total;\n      }\n\n      const guaranteePolicy = policies.find(policy => policy.type === 'guarantee');\n      if (!guaranteePolicy) {\n        return total;\n      }\n\n      const currentBracket = this.selectCurrentBracket(guaranteePolicy.brackets);\n      if (!currentBracket) {\n        return total;\n      }\n\n      const roomsTotal = grouping.rooms.length * (currentBracket.gross_amount ?? 0);\n      return total + roomsTotal;\n    }, 0);\n  }\n\n  private selectCurrentBracket(brackets: ExposedApplicablePolicy['brackets']): ExposedApplicablePolicy['brackets'][number] | null {\n    const today = moment().startOf('day');\n\n    for (const bracket of brackets) {\n      const dueDate = moment(bracket.due_on, 'YYYY-MM-DD', true);\n      if (!dueDate.isValid()) {\n        continue;\n      }\n\n      if (today.isSameOrAfter(dueDate, 'day')) {\n        return bracket;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Collapses consecutive brackets that share the same gross amount so only\n   * price changes are surfaced.\n   */\n  private mergeBracketsByAmount(brackets: ExposedApplicablePolicy['brackets']): ExposedApplicablePolicy['brackets'] {\n    if (brackets.length <= 1) {\n      return [...brackets];\n    }\n\n    return brackets.reduce<ExposedApplicablePolicy['brackets']>((acc, bracket) => {\n      const last = acc[acc.length - 1];\n      if (!last || last.gross_amount !== bracket.gross_amount) {\n        acc.push(bracket);\n      }\n      return acc;\n    }, []);\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.applicable-policies__container {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  flex-wrap: wrap;\n  margin-bottom: 1rem;\n}\n\n.applicable-policies__title {\n  font-size: 1rem;\n  font-weight: 700;\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__no-penalty {\n  padding: 0;\n  margin: 0;\n  font-size: 0.875rem;\n}\n\n.applicable-policies__statements {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  background: rgb(30, 159, 242, 5%);\n  padding: 0.5rem 1rem;\n  border: 1px solid rgba(30, 159, 242, 40%);\n  border-radius: 0.25rem;\n  max-height: 200px;\n  overflow-y: auto;\n}\n.applicable-policies__highlighted-bracket {\n  color: rgba(30, 159, 242, 100%);\n}\n.applicable-policies__statement {\n  display: flex;\n  flex-direction: column;\n  /* gap: 0.5rem; */\n  border-bottom: 1px solid #e5e7eb;\n  padding-bottom: 0.5rem;\n}\n.applicable-policies__statement:last-child {\n  border-bottom: 0;\n  padding-bottom: 0;\n}\n\n.applicable-policies__room {\n  padding: 0;\n  margin: 0;\n  padding-bottom: 0.5rem;\n}\n\n.applicable-policies__bracket {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 0.25rem;\n  font-size: 0.875rem;\n  padding-bottom: 0.5rem;\n}\n\n.applicable-policies__bracket-dates {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0;\n  margin: 0;\n}\n\n/* .applicable-policies__icon {\n} */\n\n.applicable-policies__amount {\n  text-align: right;\n  padding: 0;\n  margin: 0;\n  font-weight: 600;\n}\n\n.applicable-policies__statement-text {\n  padding: 0;\n  margin: 0;\n}\n.applicable-policies__brackets-table {\n  display: none;\n}\n\n/* Container */\n.applicable-policies__guarantee {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem 1rem;\n  border: 1px solid rgba(255, 73, 97, 40%);\n  border-radius: 6px;\n  background-color: rgba(255, 73, 97, 10%);\n  margin-bottom: 0.5rem;\n  font-size: 0.875rem;\n}\n\n/* Left info section */\n.applicable-policies__guarantee-info {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n/* Text styles */\n.applicable-policies__guarantee-date {\n  color: var(--text-muted, #666);\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__guarantee-amount {\n  font-weight: 600;\n  color: var(--text-strong, #222);\n  padding: 0;\n  margin: 0;\n}\n\n.applicable-policies__guarantee-label {\n  color: red;\n  font-weight: 700;\n  padding: 0;\n  margin: 0;\n}\n\n/* Action (button container) */\n.applicable-policies__guarantee-action {\n  width: fit-content;\n}\n\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n  .applicable-policies__brackets {\n    display: none;\n  }\n  .applicable-policies__brackets-table {\n    display: block;\n    width: 100%;\n    font-size: 0.875rem;\n  }\n  .applicable-policies__brackets-table table {\n    width: 100%;\n  }\n  .applicable-policies__amount,\n  .applicable-policies__bracket-dates {\n    white-space: nowrap;\n  }\n  .applicable-policies__statement-text {\n    width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n}\n\n/*lg*/\n@media (min-width: 1024px) {\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { Booking, Bracket } from '@/models/booking.dto';\nimport { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { CancellationStatement } from '../../types';\nimport moment, { Moment } from 'moment';\nimport { formatAmount } from '@/utils/utils';\nimport calendar_data from '@/stores/calendar-data';\nimport { IPaymentAction } from '@/services/payment.service';\nimport locales from '@/stores/locales.store';\nimport { HelpDocButton } from '@/components/HelpButton';\nimport { ApplicablePoliciesService } from '@/services/applicable-policies.service';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-applicable-policies',\n  styleUrl: 'ir-applicable-policies.css',\n  scoped: true,\n})\nexport class IrApplicablePolicies {\n  @Prop() booking: Booking;\n  @Prop() propertyId: number;\n  @Prop() language: string = 'en';\n\n  @State() cancellationStatements: CancellationStatement[] = [];\n  @State() isLoading: boolean = false;\n  @State() guaranteeAmount: number;\n\n  @Event() generatePayment: EventEmitter<IPaymentAction>;\n\n  private shouldShowCancellationBrackets: boolean = true;\n  private applicablePoliciesService = new ApplicablePoliciesService(new BookingService());\n\n  componentWillLoad() {\n    this.loadApplicablePolicies();\n  }\n\n  @Watch('booking')\n  handleBookingChange() {\n    this.loadApplicablePolicies();\n  }\n  private async loadApplicablePolicies() {\n    this.isLoading = true;\n    try {\n      this.applicablePoliciesService.booking = this.booking;\n      const { cancellationStatements, guaranteeAmount } = await this.applicablePoliciesService.fetchGroupedApplicablePolicies({\n        language: this.language,\n      });\n\n      this.guaranteeAmount = guaranteeAmount;\n      this.cancellationStatements = [...cancellationStatements];\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private formatPreviousBracketDueOn(d1: Moment, d2: Moment) {\n    if (d1.isSame(d2, 'year')) {\n      return d1.format('MMM DD');\n    }\n\n    return d1.format('MMM DD, YYYY');\n  }\n\n  private getBracketLabelsAndArrowState({ bracket, index, brackets, checkInDate }: { index: number; bracket: Bracket; brackets: Bracket[]; checkInDate: string }): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    // Validate inputs\n    if (!bracket || !brackets || index < 0 || index >= brackets.length) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Parse dates with validation\n    const bookedOnDate = moment(this.booking.booked_on.date, 'YYYY-MM-DD');\n    const bracketDueDate = moment(bracket.due_on, 'YYYY-MM-DD');\n\n    if (!bookedOnDate.isValid() || !bracketDueDate.isValid()) {\n      console.warn('Invalid date encountered in getBracketLabelsAndArrowState');\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Single bracket case\n    if (brackets.length === 1) {\n      return this.handleSingleBracket(bracketDueDate, checkInDate);\n    }\n\n    // Multiple brackets case\n    const _brackets = this.handleMultipleBrackets(bracket, index, brackets, checkInDate);\n\n    return _brackets;\n  }\n\n  private handleSingleBracket(\n    bracketDueDate: moment.Moment,\n    checkInDate: string,\n  ): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    const momentCheckInDate = moment(checkInDate, 'YYYY-MM-DD');\n    if (bracketDueDate.isSame(momentCheckInDate, 'days')) {\n      return {\n        leftLabel: `${momentCheckInDate.format('MMM DD')} onwards`,\n        showArrow: false,\n        rightLabel: '',\n      };\n    }\n    return {\n      leftLabel: bracketDueDate.format('MMM DD'),\n      showArrow: true,\n      rightLabel: moment(checkInDate, 'YYYY-MM-DD').format('MMM DD, YYYY'),\n    };\n  }\n\n  private handleMultipleBrackets(\n    bracket: Bracket,\n    index: number,\n    brackets: Bracket[],\n    checkInDate: string,\n  ): {\n    leftLabel: string | null;\n    showArrow: boolean;\n    rightLabel: string | null;\n  } {\n    const bracketDueDate = moment(bracket.due_on, 'YYYY-MM-DD');\n    const momentCheckInDate = moment(checkInDate, 'YYYY-MM-DD');\n\n    // First bracket\n    if (index === 0) {\n      const nextBracket = brackets[index + 1];\n      if (!nextBracket) {\n        return { leftLabel: null, rightLabel: null, showArrow: false };\n      }\n\n      let nextBracketDueDate = moment(nextBracket.due_on, 'YYYY-MM-DD');\n      if (!nextBracketDueDate.isValid()) {\n        return { leftLabel: null, rightLabel: null, showArrow: false };\n      }\n      if (bracket.amount === 0) {\n        nextBracketDueDate = nextBracketDueDate.clone().add(-1, 'days');\n      }\n\n      return {\n        leftLabel: 'Until',\n        showArrow: false,\n        rightLabel: nextBracketDueDate.isSame(momentCheckInDate, 'dates')\n          ? nextBracketDueDate.clone().add(-1, 'days').format('MMM DD, YYYY')\n          : nextBracketDueDate.format('MMM DD, YYYY'),\n      };\n    }\n\n    if (moment(bracket.due_on, 'YYYY-MM-DD').isSameOrAfter(momentCheckInDate, 'days')) {\n      return {\n        leftLabel: `${momentCheckInDate.format('MMM DD')} onwards`,\n        showArrow: false,\n        rightLabel: '',\n      };\n    }\n\n    // Last bracket\n    if (index === brackets.length - 1) {\n      return {\n        leftLabel: bracketDueDate.clone().format('MMM DD'),\n        showArrow: true,\n        rightLabel: moment(checkInDate).format('MMM DD, YYYY'),\n      };\n    }\n\n    // Middle brackets\n    const nextBracket = brackets[index + 1];\n    if (!nextBracket) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    const nextBracketDueDate = moment(nextBracket.due_on, 'YYYY-MM-DD');\n    if (!nextBracketDueDate.isValid()) {\n      return { leftLabel: null, rightLabel: null, showArrow: false };\n    }\n\n    // Calculate the end of current bracket period (day before next bracket starts)\n    const periodEndDate = nextBracketDueDate.isAfter(momentCheckInDate, 'days') ? momentCheckInDate : nextBracketDueDate.clone();\n    const haveSameDays = bracketDueDate.isSame(periodEndDate.clone().add(-1, 'days'), 'days');\n    return {\n      leftLabel: this.formatPreviousBracketDueOn(bracketDueDate, periodEndDate),\n      showArrow: !haveSameDays,\n      rightLabel: haveSameDays ? '' : periodEndDate.add(-1, 'days').format('MMM DD, YYYY'),\n    };\n  }\n  private generateCancellationStatement() {\n    const label = 'if cancelled today';\n    const { cancelation_penality_as_if_today } = this.booking.financial;\n    if (cancelation_penality_as_if_today === 0) {\n      if (this.booking.financial.collected > 0) {\n        return `No refund ${label}`;\n      }\n      return `No payment required ${label}`;\n    }\n    return `${cancelation_penality_as_if_today < 0 ? 'Refund' : 'Charge'} ${formatAmount(calendar_data.currency.symbol, Math.abs(cancelation_penality_as_if_today))} ${label}`;\n  }\n\n  private _getCurrentBracket(brackets: Bracket[]): moment.Moment | null {\n    if (!Array.isArray(brackets) || brackets.length === 0) return null;\n\n    const today = moment().startOf('day');\n\n    // Parse + validate + sort ascending by due_on\n    const parsed = brackets\n      .map(b => ({ b, date: moment(b.due_on, 'YYYY-MM-DD', true).startOf('day') }))\n      .filter(x => x.date.isValid())\n      .sort((a, b) => a.date.valueOf() - b.date.valueOf());\n\n    if (parsed.length === 0) return null;\n\n    // If today is before the first due date  return first bracket (closest upcoming)\n    if (today.isBefore(parsed[0].date, 'day')) {\n      return parsed[0].date;\n    }\n\n    // Find i such that date[i] <= today < date[i+1]  return date[i]\n    for (let i = 0; i < parsed.length - 1; i++) {\n      const cur = parsed[i].date;\n      const next = parsed[i + 1].date;\n      if (today.isSameOrAfter(cur, 'day') && today.isBefore(next, 'day')) {\n        return cur;\n      }\n    }\n\n    // If today is on/after the last due date  return last bracket\n    return parsed[parsed.length - 1].date;\n  }\n\n  render() {\n    if (this.isLoading) {\n      return null;\n    }\n    const remainingGuaranteeAmount = this.booking.financial.collected - this.guaranteeAmount;\n    return (\n      <Host>\n        {this.guaranteeAmount !== 0 && (\n          <section>\n            <div class=\"applicable-policies__guarantee\">\n              <div class=\"applicable-policies__guarantee-info\">\n                <p class=\"applicable-policies__guarantee-date\">{moment(this.booking.booked_on.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</p>\n                <p class=\"applicable-policies__guarantee-amount\">\n                  <span class=\"px-1\">{formatAmount(calendar_data.currency.symbol, remainingGuaranteeAmount < 0 ? Math.abs(remainingGuaranteeAmount) : this.guaranteeAmount)}</span>\n                </p>\n                <p class=\"applicable-policies__guarantee-label\">Guarantee {remainingGuaranteeAmount < 0 ? 'balance' : ''}</p>\n              </div>\n              {remainingGuaranteeAmount < 0 && (\n                <div class=\"applicable-policies__guarantee-action\">\n                  <ir-button\n                    btn_color=\"dark\"\n                    text=\"Pay\"\n                    size=\"sm\"\n                    onClickHandler={() => {\n                      this.generatePayment.emit({\n                        amount: Math.abs(remainingGuaranteeAmount),\n\n                        currency: calendar_data.currency,\n                        due_on: moment().format('YYYY-MM-DD'),\n                        pay_type_code: null,\n                        reason: '',\n                        type: 'OVERDUE',\n                      });\n                    }}\n                  ></ir-button>\n                </div>\n              )}\n            </div>\n          </section>\n        )}\n        <section>\n          <div class=\"applicable-policies__container\">\n            <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n              <p class=\"applicable-policies__title font-size-large p-0 m-0\">Cancellation Schedule</p>\n              <HelpDocButton message=\"Help\" href=\"https://help.igloorooms.com/extranet/booking-details/guarantee-and-cancellation\" />\n            </div>\n            <p class=\"applicable-policies__no-penalty\">{this.generateCancellationStatement()}</p>\n          </div>\n\n          {this.cancellationStatements?.length > 0 && this.cancellationStatements.every(e => e.brackets.length > 0) && this.shouldShowCancellationBrackets && (\n            <div class=\"applicable-policies__statements\">\n              {this.cancellationStatements?.map(statement => {\n                const currentBracket = this._getCurrentBracket(statement.brackets);\n                // const isTodaySameOrAfterCheckInDate = moment().isSameOrAfter(moment(statement.checkInDate, 'YYYY-MM-DD').add(1, 'days'));\n                return (\n                  <div class=\"applicable-policies__statement\">\n                    {this.cancellationStatements.length > 1 && (\n                      <p class=\"applicable-policies__room\">\n                        <b>{statement.roomType.name}</b> {statement.ratePlan['short_name']} {statement.ratePlan.is_non_refundable ? ` - ${locales.entries.Lcz_NonRefundable}` : ''}\n                      </p>\n                    )}\n                    <div class=\"applicable-policies__brackets\">\n                      {statement.brackets.map((bracket, idx) => {\n                        const { leftLabel, rightLabel, showArrow } = this.getBracketLabelsAndArrowState({\n                          index: idx,\n                          bracket,\n                          brackets: statement.brackets,\n                          checkInDate: statement.checkInDate,\n                        });\n                        const isInCurrentBracket = moment(bracket.due_on, 'YYYY-MM-DD').isSame(currentBracket, 'date');\n\n                        return (\n                          <div class={{ 'applicable-policies__bracket': true, 'applicable-policies__highlighted-bracket': isInCurrentBracket }}>\n                            <p class=\"applicable-policies__bracket-dates\">\n                              {leftLabel} {showArrow && <ir-icons name=\"arrow_right\" class=\"applicable-policies__icon\" style={{ '--icon-size': '0.875rem' }}></ir-icons>}{' '}\n                              {rightLabel}\n                            </p>\n                            <p class=\"applicable-policies__amount\">{formatAmount(calendar_data.currency.symbol, bracket.gross_amount)}</p>\n\n                            <p class=\"applicable-policies__statement-text\">{bracket.amount === 0 ? 'No penalty' : bracket.statement}</p>\n                          </div>\n                        );\n                      })}\n                    </div>\n                    <div class=\"applicable-policies__brackets-table\">\n                      <table>\n                        <tbody>\n                          {statement.brackets.map((bracket, idx) => {\n                            const { leftLabel, rightLabel, showArrow } = this.getBracketLabelsAndArrowState({\n                              index: idx,\n                              bracket,\n                              brackets: statement.brackets,\n                              checkInDate: statement.checkInDate,\n                            });\n\n                            const isInCurrentBracket = moment(bracket.due_on, 'YYYY-MM-DD').isSame(currentBracket, 'date');\n\n                            return (\n                              <tr class={{ 'applicable-policies__highlighted-bracket': isInCurrentBracket }}>\n                                <td class=\"applicable-policies__bracket-dates\">\n                                  {leftLabel} {showArrow && <ir-icons name=\"arrow_right\" class=\"applicable-policies__icon\" style={{ '--icon-size': '0.875rem' }}></ir-icons>}{' '}\n                                  {rightLabel}\n                                </td>\n\n                                <td class=\"applicable-policies__amount px-1\">{formatAmount(calendar_data.currency.symbol, bracket.gross_amount)}</td>\n\n                                <td class=\"applicable-policies__statement-text\">{bracket.amount === 0 ? 'No penalty' : bracket.statement}</td>\n                              </tr>\n                            );\n                          })}\n                          {/*isTodaySameOrAfterCheckInDate && (\n                            <tr class={{ 'applicable-policies__highlighted-bracket': true }}>\n                              <td class=\"applicable-policies__bracket-dates\">{moment(statement.checkInDate, 'YYYY-MM-DD').add(1, 'days').format('MMM DD')} onwards</td>\n\n                              <td class=\"applicable-policies__amount px-1\">{formatAmount(calendar_data.currency.symbol, statement.grossTotal)}</td>\n\n                              <td class=\"applicable-policies__statement-text\">100% of the total price</td>\n                            </tr>\n                          )*/}\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  overflow-x: hidden;\n  --ir-dialog-max-width: 20rem;\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: inherit !important;\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n\n.font-medium {\n  font-weight: 600;\n}\n\n:host th {\n  font-weight: 600;\n}\n.card.room-group {\n  margin-bottom: 1rem !important;\n}\n.card.room-group:last-child {\n  margin-bottom: 1.81rem !important;\n}\n.h-28 {\n  height: 2rem;\n}\n.mx-01 {\n  --m: 5px;\n  margin-right: var(--m) !important;\n  margin-left: var(--m) !important;\n}\n\n.date-margin {\n  margin-right: 5px;\n}\n.pickup-margin {\n  margin-bottom: 7px !important;\n}\n.header-date {\n  padding-left: 5px !important;\n}\n\n.pointer {\n  cursor: pointer;\n}\n\n:root {\n  --sidebar-width: 50rem;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.sm-padding-right {\n  padding-right: 0.2rem;\n}\n.sm-padding-left {\n  padding-left: 0.2rem;\n}\n.sm-padding-top {\n  padding-top: 0.2rem;\n}\n.sm-padding-bottom {\n  padding-bottom: 0.2rem;\n}\n\n.info-notes {\n  list-style: none;\n  padding-left: 0;\n}\n.light-blue-bg {\n  background-color: #acecff;\n  padding: 0.2rem 0.3rem;\n}\n.iframeHeight {\n  height: 17.5rem;\n}\n\n.dialog-title {\n  width: fit-content;\n}\n","import { Component, Listen, h, Prop, Watch, State, Event, EventEmitter, Element, Fragment } from '@stencil/core';\nimport { Booking, ExtraService, Guest, IPmsLog, Room, SharedPerson } from '@/models/booking.dto';\nimport axios from 'axios';\nimport { BookingService } from '@/services/booking.service';\nimport { IglBookPropertyPayloadAddRoom, TIglBookPropertyPayload } from '@/models/igl-book-property';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport { ICountry, IEntries } from '@/models/IBooking';\nimport { IPaymentAction, PaymentService } from '@/services/payment.service';\nimport Token from '@/models/Token';\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent, PaymentEntries } from './types';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\nimport { IrModalCustomEvent } from '@/components';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { buildSplitIndex, SplitIndex } from '@/utils/booking';\n\n@Component({\n  tag: 'ir-booking-details',\n  styleUrl: 'ir-booking-details.css',\n  scoped: true,\n})\nexport class IrBookingDetails {\n  @Element() element: HTMLElement;\n  // Setup Data\n  @Prop() language: string = 'en';\n  @Prop() ticket: string = '';\n  @Prop() bookingNumber: string = '';\n  @Prop() propertyid: number;\n  @Prop() is_from_front_desk = false;\n  @Prop() p: string;\n  // Booleans Conditions\n  @Prop() hasPrint: boolean = false;\n  @Prop() hasReceipt: boolean = false;\n  @Prop() hasDelete: boolean = false;\n  @Prop() hasMenu: boolean = false;\n\n  // Room Booleans\n  @Prop() hasRoomEdit: boolean = false;\n  @Prop() hasRoomDelete: boolean = false;\n  @Prop() hasRoomAdd: boolean = false;\n  @Prop() hasCheckIn: boolean = false;\n  @Prop() hasCheckOut: boolean = false;\n  @Prop() hasCloseButton = false;\n\n  @State() bookingItem: TIglBookPropertyPayload | null = null;\n  @State() statusData = [];\n\n  @State() showPaymentDetails: any;\n  @State() booking: Booking;\n  @State() countries: ICountry[];\n  @State() calendarData: any = {};\n  // Guest Data\n  @State() guestData: Guest = null;\n  // Rerender Flag\n  @State() rerenderFlag = false;\n  @State() sidebarState: BookingDetailsSidebarEvents | null = null;\n  @State() sidebarPayload: any;\n  @State() isUpdateClicked = false;\n\n  @State() pms_status: IPmsLog;\n  @State() isPMSLogLoading: boolean = false;\n  @State() paymentActions: IPaymentAction[];\n  @State() property_id: number;\n  @State() selectedService: ExtraService;\n  @State() bedPreference: IEntries[];\n  @State() roomGuest: any;\n  @State() modalState: { type: 'email' | (string & {}); message: string; loading: boolean } = null;\n  @State() departureTime: IEntries[];\n\n  @State() paymentEntries: PaymentEntries;\n  @State() splitIndex: SplitIndex;\n\n  // Payment Event\n  @Event() toast: EventEmitter<IToast>;\n  @Event() bookingChanged: EventEmitter<Booking>;\n  @Event() closeSidebar: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private paymentService = new PaymentService();\n  private token = new Token();\n\n  private printingBaseUrl = 'https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2';\n  private modalRef: HTMLIrModalElement;\n\n  componentWillLoad() {\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('openSidebar')\n  handleSideBarEvents(e: CustomEvent<OpenSidebarEvent<unknown>>) {\n    this.sidebarState = e.detail.type;\n    this.sidebarPayload = e.detail.payload;\n  }\n\n  @Listen('clickHandler')\n  handleIconClick(e: CustomEvent) {\n    const target = e.target as HTMLIrButtonElement;\n    switch (target.id) {\n      case 'pickup':\n        this.sidebarState = 'pickup';\n        return;\n      case 'close':\n        this.closeSidebar.emit(null);\n        return;\n      case 'email':\n        this.modalState = {\n          type: 'email',\n          message: locales.entries.Lcz_EmailBookingto.replace('%1', this.booking.guest.email),\n          loading: isRequestPending('/Send_Booking_Confirmation_Email'),\n        };\n        this.modalRef.openModal();\n        return;\n      case 'print':\n        this.openPrintingScreen();\n        return;\n      case 'receipt':\n        this.openPrintingScreen('invoice');\n        return;\n      case 'book-delete':\n        return;\n      case 'menu':\n        window.location.href = 'https://x.igloorooms.com/manage/acbookinglist.aspx';\n        return;\n      case 'room-add':\n        (this.bookingItem as IglBookPropertyPayloadAddRoom) = {\n          ID: '',\n          NAME: this.booking.guest.last_name,\n          EMAIL: this.booking.guest.email,\n          PHONE: this.booking.guest.mobile,\n          REFERENCE_TYPE: '',\n          FROM_DATE: this.booking.from_date,\n          ARRIVAL: this.booking.arrival,\n          TO_DATE: this.booking.to_date,\n          TITLE: `${locales.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,\n          defaultDateRange: {\n            fromDate: new Date(this.booking.from_date),\n            fromDateStr: '',\n            toDate: new Date(this.booking.to_date),\n            toDateStr: '',\n            dateDifference: 0,\n            message: '',\n          },\n          event_type: 'ADD_ROOM',\n          booking: this.booking,\n          BOOKING_NUMBER: this.booking.booking_nbr,\n          ADD_ROOM_TO_BOOKING: this.booking.booking_nbr,\n          GUEST: this.booking.guest,\n          message: this.booking.remark,\n          SOURCE: this.booking.source,\n          ROOMS: this.booking.rooms,\n        };\n        return;\n      case 'extra_service_btn':\n        this.sidebarState = 'extra_service';\n        return;\n      case 'add-payment':\n        return;\n    }\n  }\n\n  @Listen('resetExposedCancellationDueAmount')\n  async handleResetExposedCancellationDueAmount(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    //TODO: Payment action\n    const paymentActions = await this.paymentService.GetExposedCancellationDueAmount({ booking_nbr: this.booking.booking_nbr, currency_id: this.booking.currency.id });\n    this.paymentActions = [...paymentActions];\n  }\n  @Listen('editInitiated')\n  handleEditInitiated(e: CustomEvent<TIglBookPropertyPayload>) {\n    this.bookingItem = e.detail;\n  }\n  @Listen('updateRoomGuests')\n  handleRoomGuestsUpdate(e: CustomEvent<{ identifier: string; guests: SharedPerson[] }>) {\n    const { identifier, guests } = e.detail;\n    const rooms = [...this.booking.rooms];\n    let currentRoomIndex = rooms.findIndex(r => r.identifier === identifier);\n    if (currentRoomIndex === -1) {\n      return;\n    }\n    const currentRoom = rooms[currentRoomIndex];\n    const updatedRoom = { ...currentRoom, sharing_persons: guests };\n    rooms[currentRoomIndex] = updatedRoom;\n    this.booking = { ...this.booking, rooms: [...rooms] };\n    this.splitIndex = buildSplitIndex(this.booking.rooms);\n  }\n\n  @Listen('resetBookingEvt')\n  async handleResetBooking(e: CustomEvent<Booking | null>) {\n    // e.stopPropagation();\n    // e.stopImmediatePropagation();\n    if (e.detail) {\n      this.booking = e.detail;\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n      return;\n    }\n    await this.resetBooking();\n  }\n  @Listen('editExtraService')\n  handleEditExtraService(e: CustomEvent) {\n    this.selectedService = e.detail;\n    this.sidebarState = 'extra_service';\n  }\n\n  private setRoomsData(roomServiceResp) {\n    let roomsData: { [key: string]: any }[] = new Array();\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\n      roomsData = roomServiceResp.My_Result.roomtypes;\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\n        roomCategory.expanded = true;\n      });\n    }\n    this.calendarData.roomsInfo = roomsData;\n  }\n  // private shouldFetchCancellationPenalty(): boolean {\n  //   return this.booking.is_requested_to_cancel || this.booking.status.code === '003';\n  // }\n  private async initializeApp() {\n    try {\n      const [roomResponse, languageTexts, countriesList, bookingDetails, setupEntries] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getCountries(this.language),\n        this.bookingService.getExposedBooking(this.bookingNumber, this.language),\n        this.bookingService.getSetupEntriesByTableNameMulti(['_BED_PREFERENCE_TYPE', '_DEPARTURE_TIME', '_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n      ]);\n      this.property_id = roomResponse?.My_Result?.id;\n      const { bed_preference_type, departure_time, pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n      this.bedPreference = bed_preference_type;\n      this.departureTime = departure_time;\n      this.paymentEntries = { types: pay_type, groups: pay_type_group, methods: pay_method };\n      // if (bookingDetails?.booking_nbr && bookingDetails?.currency?.id && bookingDetails.is_direct) {\n      //   this.paymentService\n      //     .GetExposedCancellationDueAmount({\n      //       booking_nbr: bookingDetails.booking_nbr,\n      //       currency_id: bookingDetails.currency.id,\n      //     })\n      //     .then(res => {\n      //       this.paymentActions = res;\n      //     });\n      // }\n      if (!locales?.entries) {\n        locales.entries = languageTexts.entries;\n        locales.direction = languageTexts.direction;\n      }\n      this.countries = countriesList;\n      const myResult = roomResponse?.My_Result;\n      if (myResult) {\n        const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends, aname } = myResult;\n        this.printingBaseUrl = this.printingBaseUrl.replace('%1', aname).replace('%2', this.bookingNumber);\n        this.calendarData = {\n          currency,\n          allowed_booking_sources,\n          adult_child_constraints,\n          legendData: calendar_legends,\n        };\n        this.setRoomsData(roomResponse);\n        const paymentCodesToShow = ['001', '004'];\n        this.showPaymentDetails = paymentMethods?.some(method => paymentCodesToShow.includes(method.code));\n      } else {\n        console.warn(\"Room response is missing 'My_Result'.\");\n      }\n\n      // Set guest and booking data\n      this.guestData = bookingDetails.guest;\n      this.booking = bookingDetails;\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n    } catch (error) {\n      console.error('Error initializing app:', error);\n    }\n  }\n\n  private async openPrintingScreen(mode: 'invoice' | 'print' = 'print', version: 'old' | 'new' = 'new') {\n    if (version === 'old') {\n      if (mode === 'invoice') {\n        return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`);\n      }\n      return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`);\n    }\n    let url = this.printingBaseUrl;\n    if (mode === 'invoice') {\n      url = url + '&mode=invoice';\n    }\n    const { data } = await axios.post(`Get_ShortLiving_Token`);\n    if (!data.ExceptionMsg) {\n      url = url + `&token=${data.My_Result}`;\n    }\n    window.open(url);\n  }\n\n  private handleCloseBookingWindow() {\n    this.bookingItem = null;\n  }\n\n  private handleDeleteFinish = (e: CustomEvent) => {\n    this.booking = { ...this.booking, rooms: this.booking.rooms.filter(room => room.identifier !== e.detail) };\n    this.splitIndex = buildSplitIndex(this.booking.rooms);\n  };\n\n  private async resetBooking() {\n    try {\n      const booking = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\n      this.booking = { ...booking };\n      this.splitIndex = buildSplitIndex(this.booking.rooms);\n      this.bookingChanged.emit(this.booking);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async handleModalConfirm(e: IrModalCustomEvent<any>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    switch (this.modalState.type) {\n      case 'email':\n        await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr, this.language);\n        break;\n    }\n    this.modalState = null;\n    this.modalRef.closeModal();\n  }\n  private renderSidebarContent() {\n    const handleClose = () => {\n      this.sidebarState = null;\n    };\n    switch (this.sidebarState) {\n      case 'guest':\n        return (\n          <ir-guest-info\n            isInSideBar\n            headerShown\n            slot=\"sidebar-body\"\n            booking_nbr={this.bookingNumber}\n            email={this.booking?.guest.email}\n            language={this.language}\n            onCloseSideBar={handleClose}\n          ></ir-guest-info>\n        );\n      case 'pickup':\n        return (\n          <ir-pickup\n            bookingDates={{ from: this.booking.from_date, to: this.booking.to_date }}\n            slot=\"sidebar-body\"\n            defaultPickupData={this.booking.pickup_info}\n            bookingNumber={this.booking.booking_nbr}\n            numberOfPersons={this.booking.occupancy.adult_nbr + this.booking.occupancy.children_nbr}\n            onCloseModal={handleClose}\n          ></ir-pickup>\n        );\n      case 'extra_note':\n        return <ir-booking-extra-note slot=\"sidebar-body\" booking={this.booking} onCloseModal={() => (this.sidebarState = null)}></ir-booking-extra-note>;\n      case 'extra_service':\n        return (\n          <ir-extra-service-config\n            service={this.selectedService}\n            booking={{ from_date: this.booking.from_date, to_date: this.booking.to_date, booking_nbr: this.booking.booking_nbr, currency: this.booking.currency }}\n            slot=\"sidebar-body\"\n            onCloseModal={() => {\n              handleClose();\n              if (this.selectedService) {\n                this.selectedService = null;\n              }\n            }}\n          ></ir-extra-service-config>\n        );\n      case 'room-guest':\n        return (\n          <ir-room-guests\n            countries={this.countries}\n            language={this.language}\n            identifier={this.sidebarPayload?.identifier}\n            bookingNumber={this.booking.booking_nbr}\n            roomName={this.sidebarPayload?.roomName}\n            totalGuests={this.sidebarPayload?.totalGuests}\n            sharedPersons={this.sidebarPayload?.sharing_persons}\n            slot=\"sidebar-body\"\n            checkIn={this.sidebarPayload?.checkin}\n            onCloseModal={handleClose}\n          ></ir-room-guests>\n        );\n      case 'payment-folio':\n        return (\n          <ir-payment-folio\n            bookingNumber={this.booking.booking_nbr}\n            paymentEntries={this.paymentEntries}\n            slot=\"sidebar-body\"\n            payment={this.sidebarPayload.payment}\n            mode={this.sidebarPayload.mode}\n            onCloseModal={handleClose}\n          ></ir-payment-folio>\n        );\n      default:\n        return null;\n    }\n  }\n\n  private computeRoomGroups(rooms: Room[]) {\n    const indexById = new Map<string, number>();\n    rooms.forEach((room, idx) => indexById.set(room.identifier, idx));\n\n    if (!rooms.length) {\n      return { groups: [], indexById, hasSplitGroups: false };\n    }\n\n    const groupSortKey = (groupRooms: Room[]) => {\n      let min = Number.MAX_SAFE_INTEGER;\n      for (const r of groupRooms) {\n        const ts = Date.parse(r?.from_date ?? '');\n        if (!Number.isNaN(ts)) {\n          min = Math.min(min, ts);\n        }\n      }\n      return min;\n    };\n\n    const splitIndex = this.splitIndex ?? buildSplitIndex(rooms);\n    if (!splitIndex) {\n      const sortedRooms = [...rooms].sort((a, b) => {\n        const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n        if (!Number.isNaN(diff) && diff !== 0) {\n          return diff;\n        }\n        return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n      });\n      return { groups: [{ rooms: sortedRooms, order: 0, isSplit: false, sortKey: groupSortKey(sortedRooms) }], indexById, hasSplitGroups: false };\n    }\n\n    const roomsById = new Map<string, Room>(rooms.map(room => [room.identifier, room]));\n    const grouped: { rooms: Room[]; order: number; sortKey: number; isSplit: boolean }[] = [];\n    const visited = new Set<string>();\n\n    for (const head of splitIndex.heads) {\n      const chain = splitIndex.chainOf.get(head) ?? [head];\n      const chainRooms = chain.map(id => roomsById.get(id)).filter((room): room is Room => Boolean(room));\n      if (!chainRooms.length) continue;\n\n      const chainHasSplitLink =\n        chain.some(id => {\n          const parent = splitIndex.parentOf.get(id);\n          const children = splitIndex.childrenOf.get(id) ?? [];\n          return Boolean(parent) || children.length > 0;\n        }) || chainRooms.some(room => Boolean(room?.is_split));\n\n      if (chainHasSplitLink) {\n        chainRooms.forEach(room => visited.add(room.identifier));\n        const order = Math.min(...chainRooms.map(room => indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER));\n        grouped.push({ rooms: chainRooms, order, sortKey: groupSortKey(chainRooms), isSplit: true });\n      }\n    }\n\n    for (const room of rooms) {\n      if (!visited.has(room.identifier)) {\n        const order = indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER;\n        const singleGroup = [room];\n        grouped.push({ rooms: singleGroup, order, sortKey: groupSortKey(singleGroup), isSplit: false });\n      }\n    }\n\n    grouped.sort((a, b) => {\n      if (a.sortKey !== b.sortKey) {\n        return a.sortKey - b.sortKey;\n      }\n      return a.order - b.order;\n    });\n    const hasSplitGroups = grouped.some(group => group.isSplit);\n\n    if (!hasSplitGroups) {\n      const merged = grouped\n        .map(group => group.rooms)\n        .reduce<Room[]>((acc, curr) => acc.concat(curr), [])\n        .sort((a, b) => {\n          const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n          if (!Number.isNaN(diff) && diff !== 0) {\n            return diff;\n          }\n          return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n        });\n      return { groups: [{ rooms: merged, order: 0, sortKey: groupSortKey(merged), isSplit: false }], indexById, hasSplitGroups: false };\n    }\n\n    return { groups: grouped, indexById, hasSplitGroups: true };\n  }\n\n  private renderRoomItem(room: Room, bookingIndex: number, includeDepartureTime: boolean = true) {\n    const showCheckin = this.handleRoomCheckin(room);\n    const showCheckout = this.handleRoomCheckout(room);\n\n    return (\n      <ir-room\n        key={room.identifier}\n        room={room}\n        property_id={this.property_id}\n        language={this.language}\n        departureTime={this.departureTime}\n        bedPreferences={this.bedPreference}\n        isEditable={this.booking.is_editable}\n        legendData={this.calendarData.legendData}\n        roomsInfo={this.calendarData.roomsInfo}\n        myRoomTypeFoodCat={room.roomtype.name}\n        mealCodeName={room.rateplan.short_name}\n        includeDepartureTime={includeDepartureTime}\n        currency={this.booking.currency.symbol}\n        hasRoomEdit={this.hasRoomEdit && this.booking.status.code !== '003' && this.booking.is_direct}\n        hasRoomDelete={this.hasRoomDelete && this.booking.status.code !== '003' && this.booking.is_direct}\n        hasCheckIn={showCheckin}\n        hasCheckOut={showCheckout}\n        booking={this.booking}\n        bookingIndex={bookingIndex}\n        onDeleteFinished={this.handleDeleteFinish}\n      />\n    );\n  }\n\n  private renderRooms() {\n    const rooms = this.booking?.rooms ?? [];\n    if (!rooms.length) {\n      return null;\n    }\n\n    const { groups, indexById, hasSplitGroups } = this.computeRoomGroups(rooms);\n\n    if (!hasSplitGroups) {\n      const groupRooms = groups[0].rooms;\n      return (\n        <div class=\"card p-0 mx-0\">\n          {groupRooms.map((room, idx) => (\n            <Fragment>\n              {this.renderRoomItem(room, indexById.get(room.identifier) ?? idx)}\n              {idx < groupRooms.length - 1 ? <hr class=\"mr-2 ml-2 my-0 p-0\" /> : null}\n            </Fragment>\n          ))}\n        </div>\n      );\n    }\n\n    return (\n      <Fragment>\n        {groups.map((group, groupIdx) => {\n          const isLastGroup = groupIdx === groups.length - 1;\n          return (\n            <div class={`card p-0 mx-0 ${isLastGroup ? '' : 'room-group'}`} key={`room-group-${group.order}-${groupIdx}`}>\n              {group.rooms.map((room, roomIdx) => (\n                <Fragment>\n                  {this.renderRoomItem(room, indexById.get(room.identifier) ?? roomIdx, roomIdx === group.rooms.length - 1)}\n                  {roomIdx < group.rooms.length - 1 ? <hr class=\"mr-2 ml-2 my-0 p-0\" /> : null}\n                </Fragment>\n              ))}\n            </div>\n          );\n        })}\n      </Fragment>\n    );\n  }\n  render() {\n    if (!this.booking) {\n      return (\n        <div class={'loading-container'}>\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    const roomsSection = this.renderRooms();\n    return [\n      <Fragment>\n        {!this.is_from_front_desk && (\n          <Fragment>\n            <ir-toast></ir-toast>\n            <ir-interceptor></ir-interceptor>\n          </Fragment>\n        )}\n      </Fragment>,\n      <ir-booking-header\n        booking={this.booking}\n        hasCloseButton={this.hasCloseButton}\n        hasDelete={this.hasDelete}\n        hasMenu={this.hasMenu}\n        hasPrint={this.hasPrint}\n        hasReceipt={this.hasReceipt}\n        hasEmail={['001', '002'].includes(this.booking?.status?.code)}\n      ></ir-booking-header>,\n      <div class=\"fluid-container p-1 text-left mx-0\">\n        <div class=\"row m-0\">\n          <div class=\"col-12 p-0 mx-0 pr-lg-1 col-lg-6\">\n            <ir-reservation-information countries={this.countries} booking={this.booking}></ir-reservation-information>\n            <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\n              <ir-date-view from_date={this.booking.from_date} to_date={this.booking.to_date}></ir-date-view>\n              {\n                // this.hasRoomAdd && this.booking.is_direct && this.booking.is_editable && (\n                this.hasRoomAdd && this.booking.is_editable && <ir-button id=\"room-add\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\n              }\n            </div>\n            {roomsSection}\n            {/* <ir-ota-services services={this.booking.ota_services}></ir-ota-services> */}\n            <ir-pickup-view booking={this.booking}></ir-pickup-view>\n            <section>\n              <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\n                <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_ExtraServices}</p>\n                <ir-button id=\"extra_service_btn\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\n              </div>\n              <ir-extra-services\n                booking={{ booking_nbr: this.booking.booking_nbr, currency: this.booking.currency, extra_services: this.booking.extra_services }}\n              ></ir-extra-services>\n            </section>\n          </div>\n          <div class=\"col-12 p-0 m-0 pl-lg-1 col-lg-6\">\n            <ir-payment-details propertyId={this.property_id} paymentEntries={this.paymentEntries} paymentActions={this.paymentActions} booking={this.booking}></ir-payment-details>\n          </div>\n        </div>\n      </div>,\n      <ir-modal\n        modalBody={this.modalState?.message}\n        leftBtnText={locales.entries.Lcz_Cancel}\n        rightBtnText={locales.entries.Lcz_Confirm}\n        autoClose={false}\n        isLoading={isRequestPending('/Send_Booking_Confirmation_Email')}\n        ref={el => (this.modalRef = el)}\n        onConfirmModal={e => {\n          this.handleModalConfirm(e);\n        }}\n        onCancelModal={() => {\n          this.modalRef.closeModal();\n        }}\n      ></ir-modal>,\n      <ir-sidebar\n        open={this.sidebarState !== null && this.sidebarState !== 'payment-folio'}\n        side={'right'}\n        id=\"editGuestInfo\"\n        style={{ '--sidebar-width': this.sidebarState === 'room-guest' ? '60rem' : undefined }}\n        onIrSidebarToggle={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.sidebarState = null;\n        }}\n        showCloseButton={false}\n      >\n        {this.renderSidebarContent()}\n      </ir-sidebar>,\n      <ir-sidebar\n        open={this.sidebarState === 'payment-folio'}\n        side={'left'}\n        id=\"folioSidebar\"\n        onIrSidebarToggle={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.sidebarState = null;\n        }}\n        showCloseButton={false}\n      >\n        {this.renderSidebarContent()}\n      </ir-sidebar>,\n      <Fragment>\n        {this.bookingItem && (\n          <igl-book-property\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\n            adultChildConstraints={this.calendarData.adult_child_constraints}\n            showPaymentDetails={this.showPaymentDetails}\n            countries={this.countries}\n            currency={this.calendarData.currency}\n            language={this.language}\n            propertyid={this.property_id}\n            bookingData={this.bookingItem}\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\n          ></igl-book-property>\n        )}\n      </Fragment>,\n    ];\n  }\n  private handleRoomCheckout(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    return room.in_out.code === '001';\n  }\n  private handleRoomCheckin(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    if (!room.unit) {\n      return false;\n    }\n    if (room.in_out && room.in_out.code !== '000') {\n      return false;\n    }\n    if (moment().isSameOrAfter(moment(room.from_date, 'YYYY-MM-DD'), 'days') && moment().isBefore(moment(room.to_date, 'YYYY-MM-DD'), 'days')) {\n      return true;\n    }\n    return false;\n  }\n}\n",":host {\n  display: block;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { getPrivateNote } from '@/utils/booking';\n@Component({\n  tag: 'ir-booking-extra-note',\n  styleUrls: ['ir-booking-extra-note.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrBookingExtraNote {\n  @Prop() booking: Booking;\n\n  @State() isLoading = false;\n  @State() note = '';\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\n\n  private bookingService = new BookingService();\n  componentWillLoad() {\n    if (this.booking.extras) {\n      this.setNote(getPrivateNote(this.booking.extras));\n    }\n  }\n\n  private setNote(value: string) {\n    this.note = value;\n  }\n  private async savePrivateNote() {\n    try {\n      this.isLoading = true;\n      let prevExtras = this.booking.extras || [];\n      const newExtraObj = { key: 'private_note', value: this.note };\n      if (prevExtras.length === 0) {\n        prevExtras.push(newExtraObj);\n      } else {\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\n        if (oldPrivateNoteIndex === -1) {\n          prevExtras.push(newExtraObj);\n        } else {\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\n        }\n      }\n      const res = await this.bookingService.doReservation({\n        assign_units: true,\n        is_pms: true,\n        is_direct: true,\n        is_in_loyalty_mode: false,\n        promo_key: null,\n        booking: this.booking,\n        Is_Non_Technical_Change: true,\n        extras: prevExtras,\n      });\n      this.resetBookingEvt.emit(res);\n      this.closeModal.emit(null);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container h-100'}\n        onSubmit={e => {\n          e.preventDefault();\n          this.savePrivateNote();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_PrivateNote} displayContext=\"sidebar\"></ir-title>\n        <div class=\"sheet-body px-1\">\n          <ir-textarea placeholder={locales.entries.Lcz_PrivateNote_MaxChar} label=\"\" value={this.note} maxLength={150} onTextChange={e => this.setNote(e.detail)}></ir-textarea>\n        </div>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClickHandler={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'m-0 flex-fill text-center ml-sm-1'}\n            isLoading={this.isLoading}\n            text={locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n            btn_type=\"submit\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n.iframeHeight {\n  height: max-content;\n  height: 22.5rem;\n}\n","import { Component, h, Prop, State } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { toFloat } from '@/utils/utils';\nimport locales from '@/stores/locales.store';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  styleUrl: 'ir-booking-guarantee.css',\n  tag: 'ir-booking-guarantee',\n  scoped: true,\n})\nexport class IrBookingGuarantee {\n  @Prop() booking: Booking;\n  @Prop() bookingService: BookingService;\n\n  @State() collapsed: boolean = false;\n  @State() paymentDetailsUrl: string = '';\n  @State() paymentExceptionMessage: string = '';\n\n  async componentWillLoad() {\n    try {\n      // Initialize any required data\n    } catch (error) {\n      if (this.booking.guest.cci) {\n        return;\n      }\n      if (!this.booking.is_direct && this.booking.channel_booking_nbr) {\n        this.paymentExceptionMessage = error;\n      }\n    }\n  }\n\n  private formatCurrency(amount: number, currency: string, locale: string = 'en-US'): string {\n    if (!currency || amount < 0) {\n      return '';\n    }\n\n    return new Intl.NumberFormat(locale, {\n      style: 'currency',\n      currency,\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(amount);\n  }\n\n  private checkPaymentCode(value: string): string | null {\n    return calendar_data.allowed_payment_methods?.find(pm => pm.code === value)?.description ?? null;\n  }\n\n  private getPaymentMethod(): string | null {\n    let paymentMethod = null;\n    const payment_code = this.booking?.extras?.find(e => e.key === 'payment_code');\n\n    if (this.booking.agent) {\n      const code = this.booking?.extras?.find(e => e.key === 'agent_payment_mode');\n      if (code) {\n        paymentMethod = code.value === '001' ? locales.entries.Lcz_OnCredit : payment_code ? this.checkPaymentCode(payment_code.value) : null;\n      }\n    } else if (payment_code) {\n      paymentMethod = payment_code.value === '000' ? 'No card info required upon booking' : this.checkPaymentCode(payment_code.value);\n    }\n\n    return paymentMethod;\n  }\n\n  private async handleToggleCollapse() {\n    if (!this.booking.is_direct && this.booking.channel_booking_nbr && !this.booking.guest.cci && !this.collapsed) {\n      this.paymentDetailsUrl = await this.bookingService.getPCICardInfoURL(this.booking.booking_nbr);\n    }\n    this.collapsed = !this.collapsed;\n  }\n\n  private shouldShowGuarantee(): boolean {\n    const paymentMethod = this.booking.is_direct ? this.getPaymentMethod() : null;\n    return this.booking.is_direct ? Boolean(paymentMethod || this.booking.guest.cci) : true;\n  }\n\n  private shouldShowToggleButton() {\n    return !this.booking.is_direct || (this.booking.is_direct && this.booking.guest.cci);\n  }\n\n  private renderCreditCardInfo() {\n    const { cci } = this.booking.guest;\n    if (!cci) return null;\n\n    return [\n      <div>\n        {cci && 'Card:'} <span>{cci.nbr || ''}</span>\n        {cci.expiry_month && ' Expiry: '}\n        <span>\n          {cci.expiry_month || ''}\n          {cci.expiry_year && '/' + cci.expiry_year}\n        </span>\n      </div>,\n      <div>\n        {cci.holder_name && 'Name:'} <span>{cci.holder_name || ''}</span>\n        {cci.cvc && ' - CVC:'} <span>{cci.cvc || ''}</span>\n      </div>,\n    ];\n  }\n\n  private renderCollapsedContent() {\n    if (this.booking.guest.cci) {\n      return this.renderCreditCardInfo();\n    }\n\n    if (this.paymentDetailsUrl) {\n      return <iframe src={this.paymentDetailsUrl} width=\"100%\" class=\"iframeHeight\" frameborder=\"0\" name=\"payment\" />;\n    }\n\n    return <div class=\"text-center\">{this.paymentExceptionMessage}</div>;\n  }\n\n  private renderOtaGuarantee() {\n    const { ota_guarante } = this.booking;\n    if (!ota_guarante || this.booking.is_direct) return null;\n\n    return (\n      <div>\n        <ir-label content={ota_guarante.card_type + `${ota_guarante.is_virtual ? ' (virtual)' : ''}`} labelText={`${locales.entries.Lcz_CardType}:`} />\n        <ir-label content={ota_guarante.cardholder_name} labelText={`${locales.entries.Lcz_CardHolderName}:`} />\n        <ir-label content={ota_guarante.card_number} labelText={`${locales.entries.Lcz_CardNumber}:`} />\n        <ir-label\n          content={this.formatCurrency(\n            toFloat(Number(ota_guarante.meta?.virtual_card_current_balance), Number(ota_guarante.meta?.virtual_card_decimal_places)),\n            ota_guarante.meta?.virtual_card_currency_code,\n          )}\n          labelText={`${locales.entries.Lcz_CardBalance}:`}\n        />\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.shouldShowGuarantee()) {\n      return null;\n    }\n\n    const paymentMethod = this.booking.is_direct ? this.getPaymentMethod() : null;\n\n    return (\n      <div class=\"mb-1\">\n        <div class=\"d-flex align-items-center\">\n          <span class=\"mr-1 font-medium\">\n            {locales.entries.Lcz_BookingGuarantee}\n            {paymentMethod && <span>: {paymentMethod}</span>}\n          </span>\n\n          {this.shouldShowToggleButton() && (\n            <ir-button\n              id=\"drawer-icon\"\n              data-toggle=\"collapse\"\n              data-target=\".guarrantee\"\n              aria-expanded={this.collapsed ? 'true' : 'false'}\n              aria-controls=\"myCollapse\"\n              class=\"sm-padding-right pointer\"\n              variant=\"icon\"\n              icon_name=\"credit_card\"\n              onClickHandler={this.handleToggleCollapse.bind(this)}\n            />\n          )}\n        </div>\n\n        <div class=\"collapse guarrantee\">{this.renderCollapsedContent()}</div>\n\n        {this.renderOtaGuarantee()}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.confirmed {\n  color: #fff;\n  display: flex;\n  align-items: center;\n}\n.bg-ir-green {\n  background: #629a4c;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n.bg-ir-red {\n  background: #ff4961;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n.bg-ir-orange {\n  background: #ff9149;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n","import { IToast } from '@/components/ui/ir-toast/toast';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\nimport calendar_data from '@/stores/calendar-data';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, h, Listen, Prop, State } from '@stencil/core';\nimport { BookingDetailsDialogEvents, OpenDialogEvent, OpenSidebarEvent } from '../types';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-booking-header',\n  styleUrl: 'ir-booking-header.css',\n  scoped: true,\n})\nexport class IrBookingHeader {\n  @Prop() booking: Booking;\n  @Prop() hasReceipt: boolean;\n  @Prop() hasPrint: boolean;\n  @Prop() hasDelete: boolean;\n  @Prop() hasMenu: boolean;\n  @Prop() hasCloseButton: boolean;\n  @Prop() hasEmail: boolean = true;\n\n  @State() bookingStatus: string | null = null;\n  @State() currentDialogStatus: BookingDetailsDialogEvents;\n\n  @Event() toast: EventEmitter<IToast>;\n  @Event() closeSidebar: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\n\n  private confirmationBG = {\n    '001': 'bg-ir-orange',\n    '002': 'bg-ir-green',\n    '003': 'bg-ir-red',\n    '004': 'bg-ir-red',\n  };\n  private dialogRef: HTMLIrDialogElement;\n\n  private bookingService = new BookingService();\n  private alertMessage = `ALERT! Modifying an OTA booking will create a discrepancy between igloorooms and the source. Future guest modifications on the OTA may require manual adjustmentsofthebooking.`;\n  modalEl: HTMLIrModalElement;\n\n  @Listen('selectChange')\n  handleSelectChange(e: CustomEvent<any>) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    const target = e.target;\n    this.bookingStatus = (target as any).selectedValue;\n  }\n  private async updateStatus() {\n    if (!this.bookingStatus || this.bookingStatus === '-1') {\n      this.toast.emit({\n        type: 'error',\n        description: '',\n        title: locales.entries.Lcz_SelectStatus,\n        position: 'top-right',\n      });\n      return;\n    }\n    try {\n      await this.bookingService.changeExposedBookingStatus({\n        book_nbr: this.booking.booking_nbr,\n        status: this.bookingStatus,\n      });\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: locales.entries.Lcz_StatusUpdatedSuccessfully,\n        position: 'top-right',\n      });\n      this.bookingStatus = null;\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private openDialog(e: OpenDialogEvent) {\n    const { type } = e;\n    this.currentDialogStatus = type;\n    this.dialogRef.openModal();\n  }\n  private renderDialogBody() {\n    switch (this.currentDialogStatus) {\n      case 'pms':\n        return <ir-pms-logs slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-pms-logs>;\n      case 'events-log':\n        return <ir-events-log booking={this.booking} slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-events-log>;\n    }\n  }\n\n  render() {\n    const lastManipulation = this.booking.ota_manipulations ? this.booking.ota_manipulations[this.booking.ota_manipulations.length - 1] : null;\n    return (\n      <div class=\"fluid-container px-1\">\n        <div class=\"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1\">\n          <div class=\"m-0 p-0 mb-1 mb-lg-0 mt-md-0\">\n            <p class=\"font-size-large m-0 p-0\">{`${locales.entries.Lcz_Booking}#${this.booking.booking_nbr}`}</p>\n            <p class=\"m-0 p-0\">{!this.booking.is_direct && <span class=\"mr-1 m-0\">{this.booking.channel_booking_nbr}</span>}</p>\n          </div>\n\n          <div class=\"d-flex justify-content-end align-items-center\" style={{ gap: '1rem', flexWrap: 'wrap' }}>\n            <div class=\"d-flex flex-column align-items-center\">\n              <span class={`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.is_requested_to_cancel ? '003' : this.booking.status.code]}`}>\n                {this.booking.is_requested_to_cancel ? locales.entries.Lcz_CancellationRequested : this.booking.status.description}\n              </span>\n              {lastManipulation && (\n                <ir-popover\n                  trigger=\"hover\"\n                  renderContentAsHtml\n                  content={`<div><p>Modified by ${lastManipulation.user} at ${lastManipulation.date} ${lastManipulation.hour}:${lastManipulation.minute}.</p>\n                <p>${this.alertMessage}</p></div>`}\n                >\n                  <p class=\"mx-0 p-0 small text-danger\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                    <b>Modified</b>\n                  </p>\n                </ir-popover>\n              )}\n            </div>\n            {this.booking.allowed_actions.length > 0 && this.booking.is_editable && (\n              <div class=\"m-0 p-0 d-flex align-items-center\" style={{ gap: '0.25rem' }}>\n                <ir-select\n                  selectContainerStyle=\"h-28\"\n                  selectStyles=\"d-flex status-select align-items-center h-28\"\n                  firstOption={locales.entries.Lcz_Select}\n                  id=\"update-status\"\n                  size=\"sm\"\n                  label-available=\"false\"\n                  data={this.booking.allowed_actions.map(b => ({ text: b.description, value: b.code }))}\n                  textSize=\"sm\"\n                  class=\"sm-padding-right m-0 \"\n                  selectedValue={this.bookingStatus}\n                ></ir-select>\n                <ir-button\n                  onClickHandler={() => {\n                    if (!this.booking.is_direct) {\n                      this.modalEl.openModal();\n                      return;\n                    }\n                    this.updateStatus();\n                  }}\n                  btn_styles=\"h-28\"\n                  isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n                  btn_disabled={isRequestPending('/Change_Exposed_Booking_Status')}\n                  id=\"update-status-btn\"\n                  size=\"sm\"\n                  text=\"Update\"\n                ></ir-button>\n              </div>\n            )}\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              text={locales.entries.Lcz_EventsLog}\n              onClickHandler={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.openDialog({ type: 'events-log' });\n              }}\n            ></ir-button>\n            {calendar_data.is_pms_enabled && (\n              <ir-button\n                size=\"sm\"\n                btn_color=\"outline\"\n                text={locales.entries.Lcz_pms}\n                onClick={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.openDialog({ type: 'pms' });\n                }}\n              ></ir-button>\n            )}\n            {this.hasReceipt && <ir-button variant=\"icon\" id=\"receipt\" icon_name=\"reciept\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasPrint && <ir-button variant=\"icon\" id=\"print\" icon_name=\"print\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasEmail && <ir-button variant=\"icon\" id=\"email\" title=\"Email this booking\" icon_name=\"email\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasDelete && <ir-button variant=\"icon\" id=\"book-delete\" icon_name=\"trash\" class=\"\" style={{ ...colorVariants.danger, '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasMenu && <ir-button variant=\"icon\" class=\"mr-1\" id=\"menu\" icon_name=\"menu_list\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n\n            {this.hasCloseButton && (\n              <ir-button\n                id=\"close\"\n                variant=\"icon\"\n                style={{ '--icon-size': '1.65rem' }}\n                icon_name=\"xmark\"\n                class=\"ml-2\"\n                onClickHandler={e => {\n                  e.stopPropagation();\n                  e.stopImmediatePropagation();\n                  this.closeSidebar.emit(null);\n                }}\n              ></ir-button>\n            )}\n          </div>\n        </div>\n        <ir-dialog\n          onOpenChange={e => {\n            if (!e.detail) {\n              this.currentDialogStatus = null;\n            }\n          }}\n          style={this.currentDialogStatus === 'events-log' && { '--ir-dialog-max-width': 'max-content' }}\n          ref={el => (this.dialogRef = el)}\n        >\n          {this.renderDialogBody()}\n        </ir-dialog>\n        <ir-modal\n          ref={el => (this.modalEl = el)}\n          modalTitle={''}\n          leftBtnText={locales?.entries?.Lcz_Cancel}\n          rightBtnText={locales?.entries?.Lcz_Confirm}\n          modalBody={locales.entries.Lcz_OTA_Modification_Alter}\n          isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n          onConfirmModal={this.updateStatus.bind(this)}\n        ></ir-modal>\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n  box-sizing: border-box;\n  font: inherit;\n  color: inherit;\n}\n\n.dialog {\n  border: none;\n  margin: auto;\n  padding: 0;\n  background: transparent;\n  color: inherit;\n  width: min(90vw, var(--ir-dialog-max-width, 40rem));\n  max-width: var(--ir-dialog-max-width, 40rem);\n  min-width: var(--ir-dialog-min-width, auto);\n}\n\n.dialog::backdrop {\n  background: rgba(0, 0, 0, 0.35);\n  backdrop-filter: blur(2px);\n  animation: overlayShow 160ms cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n.dialog__content {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  background: #ffffff;\n  border-radius: 8px;\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\n  max-height: min(85vh, 100%);\n  overflow: hidden;\n  padding: 1rem;\n}\n\n.dialog[open] .dialog__content {\n  animation: contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n.dialog__header,\n.dialog__body,\n.dialog__footer {\n  padding: 0;\n}\n\n.dialog__header {\n  display: flex;\n  align-items: flex-start;\n  gap: 16px;\n}\n\n.dialog__header slot[name='modal-title']::slotted(*) {\n  margin: 0;\n}\n\n.dialog__body {\n  flex: 1 1 auto;\n  overflow: auto;\n  padding-bottom: 2rem;\n}\n\n.dialog__body ::slotted(*) {\n  font-size: 14px;\n  font-weight: 400;\n  color: #475467;\n  margin: 0;\n}\n\n.dialog__footer {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 12px;\n}\n\n.dialog__footer ::slotted(*) {\n  --ir-btn-width: auto;\n}\n\n.dialog__close-button {\n  margin-left: auto;\n  border: none;\n  background: transparent;\n  padding: 4px;\n  border-radius: 999px;\n  color: #104064;\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.dialog__close-button:hover {\n  background: rgba(16, 64, 100, 0.08);\n}\n\n.dialog__close-button:focus-visible {\n  outline: 2px solid #104064;\n  outline-offset: 2px;\n}\n\n.dialog__close-button svg {\n  display: block;\n}\n\n.dialog__header slot[name='modal-title']::slotted(*) {\n  font-size: 18px;\n  font-weight: 600;\n  color: #101828;\n}\n\n@keyframes overlayShow {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes contentShow {\n  from {\n    opacity: 0;\n    transform: translateY(-8px) scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n","import { Component, Host, h, Element, Method, State, Event, EventEmitter, Prop, Watch } from '@stencil/core';\n\n@Component({\n  tag: 'ir-dialog',\n  styleUrl: 'ir-dialog.css',\n  shadow: true,\n})\nexport class IrDialog {\n  private static dialogIds = 0;\n\n  @Element() hostEl!: HTMLElement;\n\n  /**\n   * Controls whether the dialog is open. Reflects to the host attribute for CSS hooks.\n   */\n  @Prop({ mutable: true, reflect: true }) open = false;\n\n  /**\n   * Emits when the open state changes due to user interaction or programmatic control.\n   */\n  @Event() openChange: EventEmitter<boolean>;\n\n  @State() private hasTitleSlot = false;\n  @State() private hasBodySlot = false;\n\n  private dialogEl?: HTMLDialogElement;\n  private previouslyFocused: HTMLElement | null = null;\n  private readonly instanceId = ++IrDialog.dialogIds;\n\n  private get titleId() {\n    return `ir-dialog-title-${this.instanceId}`;\n  }\n\n  private get descriptionId() {\n    return `ir-dialog-description-${this.instanceId}`;\n  }\n\n  componentDidLoad() {\n    if (!this.dialogEl) {\n      return;\n    }\n\n    this.dialogEl.addEventListener('cancel', this.handleCancel);\n    this.dialogEl.addEventListener('close', this.handleNativeClose);\n\n    this.syncSlotState();\n\n    if (this.open) {\n      this.showDialog(false);\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.dialogEl) {\n      this.dialogEl.removeEventListener('cancel', this.handleCancel);\n      this.dialogEl.removeEventListener('close', this.handleNativeClose);\n    }\n    this.restoreFocus();\n  }\n\n  @Watch('open')\n  protected handleOpenChange(open: boolean) {\n    if (open) {\n      this.showDialog();\n    } else {\n      this.hideDialog();\n    }\n  }\n\n  /**\n   * Opens the dialog programmatically using the native `showModal` API.\n   */\n  @Method()\n  async openModal() {\n    this.open = true;\n  }\n\n  /**\n   * Closes the dialog programmatically and restores focus to the previously active element.\n   */\n  @Method()\n  async closeModal() {\n    this.open = false;\n  }\n\n  private showDialog(emit = true) {\n    if (!this.dialogEl || this.dialogEl.open) {\n      return;\n    }\n\n    this.previouslyFocused = document.activeElement as HTMLElement;\n\n    if (typeof this.dialogEl.showModal === 'function') {\n      this.dialogEl.showModal();\n    } else {\n      this.dialogEl.setAttribute('open', '');\n    }\n\n    if (emit) {\n      this.openChange.emit(true);\n    }\n  }\n\n  private hideDialog(emit = true) {\n    if (!this.dialogEl) {\n      return;\n    }\n\n    if (this.dialogEl.open) {\n      this.dialogEl.close();\n    }\n\n    this.restoreFocus();\n\n    if (emit) {\n      this.openChange.emit(false);\n    }\n  }\n\n  private handleCancel = (event: Event) => {\n    event.preventDefault();\n    this.closeModal();\n  };\n\n  private handleNativeClose = () => {\n    if (this.open) {\n      // Ensure the public prop stays in sync when the native dialog closes (e.g. via form submission).\n      this.open = false;\n      return;\n    }\n\n    this.hideDialog(false);\n  };\n\n  private restoreFocus() {\n    if (this.previouslyFocused && typeof this.previouslyFocused.focus === 'function') {\n      this.previouslyFocused.focus({ preventScroll: true });\n    }\n    this.previouslyFocused = null;\n  }\n\n  private onTitleSlotChange = (event: Event) => {\n    const slot = event.target as HTMLSlotElement;\n    this.hasTitleSlot = slot.assignedNodes({ flatten: true }).length > 0;\n  };\n\n  private onBodySlotChange = (event: Event) => {\n    const slot = event.target as HTMLSlotElement;\n    this.hasBodySlot = slot.assignedNodes({ flatten: true }).length > 0;\n  };\n\n  private onCloseButtonClick = () => {\n    this.closeModal();\n  };\n\n  private syncSlotState() {\n    if (!this.dialogEl) {\n      return;\n    }\n\n    const titleSlot = this.dialogEl.querySelector('slot[name=\"modal-title\"]') as HTMLSlotElement | null;\n    const bodySlot = this.dialogEl.querySelector('slot[name=\"modal-body\"]') as HTMLSlotElement | null;\n\n    if (titleSlot) {\n      this.hasTitleSlot = titleSlot.assignedNodes({ flatten: true }).length > 0;\n    }\n\n    if (bodySlot) {\n      this.hasBodySlot = bodySlot.assignedNodes({ flatten: true }).length > 0;\n    }\n  }\n\n  render() {\n    const labelledBy = this.hasTitleSlot ? this.titleId : undefined;\n    const describedBy = this.hasBodySlot ? this.descriptionId : undefined;\n\n    return (\n      <Host>\n        <dialog\n          ref={el => (this.dialogEl = el as HTMLDialogElement)}\n          class=\"dialog\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby={labelledBy}\n          aria-describedby={describedBy}\n        >\n          <div class=\"dialog__content\" role=\"document\">\n            <header class=\"dialog__header\" id={labelledBy}>\n              <slot name=\"modal-title\" onSlotchange={this.onTitleSlotChange}></slot>\n              <button type=\"button\" class=\"dialog__close-button\" onClick={this.onCloseButtonClick} aria-label=\"Close dialog\">\n                <slot name=\"close-icon\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={18} width={18} aria-hidden=\"true\" focusable=\"false\">\n                    <path\n                      fill=\"currentColor\"\n                      d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                    />\n                  </svg>\n                </slot>\n              </button>\n            </header>\n            <section class=\"dialog__body\" id={describedBy}>\n              <slot name=\"modal-body\" onSlotchange={this.onBodySlotChange}></slot>\n            </section>\n            <footer class=\"dialog__footer\">\n              <slot name=\"modal-footer\"></slot>\n            </footer>\n          </div>\n        </dialog>\n      </Host>\n    );\n  }\n}\n","/* Existing styles */\n\n/* New styles for the overlay dropdown */\n.dropdown-menu {\n  z-index: 1000;\n  width: 100%;\n  max-height: 300px;\n  min-width: var(--ir-dropdown-menu-min-width, 11rem) !important;\n  overflow-y: auto;\n}\n\n.dropdown.nav-item.show .dropdown-menu {\n  display: block; /* display the dropdown when the parent has the \"show\" class */\n}\n.caret-icon {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-55%);\n  right: 0.25rem;\n  z-index: 99999;\n}\n.dropdown-trigger {\n  position: relative;\n}\n.caret-icon.disabled {\n  opacity: 0.5 !important;\n  pointer-events: none !important;\n  cursor: not-allowed !important;\n}\n","import { Component, Prop, State, h, Event, EventEmitter, Host, Element, Listen, Watch } from '@stencil/core';\n\nexport type DropdownItem = {\n  value: string | number;\n};\n\n@Component({\n  tag: 'ir-dropdown',\n  styleUrl: 'ir-dropdown.css',\n  scoped: true,\n})\nexport class IrDropdown {\n  @Element() el: HTMLIrDropdownElement;\n\n  @Prop({ reflect: true, mutable: true }) value: DropdownItem['value'];\n\n  @Prop({ reflect: true, mutable: true }) disabled: boolean = false;\n\n  @Prop({ reflect: true, mutable: true }) caret: boolean = true;\n\n  @State() isOpen: boolean = false;\n  @State() selectedOption: DropdownItem['value'];\n  @State() focusedIndex: number = -1;\n  @State() itemChildren: HTMLIrDropdownItemElement[] = [];\n\n  private mo: MutationObserver | null = null;\n  private documentClickHandler: (event: Event) => void;\n  private isComponentConnected: boolean = true;\n  private updateQueued: boolean = false;\n\n  /**\n   * Emitted when a user selects an option from the combobox.\n   * The event payload contains the selected `DropdownItem` object.\n   */\n  @Event() optionChange: EventEmitter<DropdownItem['value']>;\n\n  componentWillLoad() {\n    this.selectedOption = this.value;\n    this.documentClickHandler = this.handleDocumentClick.bind(this);\n    this.collectItemChildren();\n\n    // Optimized mutation observer with debouncing\n    this.mo = new MutationObserver(() => {\n      if (!this.updateQueued) {\n        this.updateQueued = true;\n        requestAnimationFrame(() => {\n          if (this.isComponentConnected) {\n            this.collectItemChildren();\n            this.updateQueued = false;\n          }\n        });\n      }\n    });\n    this.mo.observe(this.el, { childList: true, subtree: true });\n  }\n\n  componentDidLoad() {\n    document.addEventListener('click', this.documentClickHandler, { passive: true });\n\n    // Single RAF call instead of multiple setTimeouts\n    requestAnimationFrame(() => {\n      if (this.isComponentConnected) {\n        this.updateItemElements();\n        if (this.value) {\n          this.updateDropdownItemValue(this.value);\n        }\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n    document.removeEventListener('click', this.documentClickHandler);\n    this.mo?.disconnect();\n    this.mo = null;\n  }\n\n  @Listen('keydown', { target: 'document' })\n  handleDocumentKeyDown(event: KeyboardEvent) {\n    if (!this.isOpen || !this.isComponentConnected) return;\n\n    if (event.key === 'Escape') {\n      this.closeDropdown();\n    }\n  }\n\n  @Listen('dropdownItemSelect')\n  handleDropdownItemSelect(ev: CustomEvent<DropdownItem['value']>) {\n    if (!this.isComponentConnected) return;\n\n    ev.stopPropagation();\n    this.selectOption(ev.detail);\n    (ev.target as HTMLIrDropdownItemElement).setAttribute('aria-selected', 'true');\n  }\n\n  @Listen('dropdownItemRegister')\n  handleDropdownItemRegister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Listen('dropdownItemUnregister')\n  handleDropdownItemUnregister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Watch('value')\n  handleValueChange(newValue: DropdownItem['value'], oldValue: DropdownItem['value']) {\n    if (newValue !== oldValue && this.isComponentConnected) {\n      this.updateDropdownItemValue(newValue);\n    }\n  }\n\n  private updateDropdownItemValue(value: DropdownItem['value']) {\n    // Clear previous selections immediately\n    this.itemChildren.forEach(el => el.removeAttribute('aria-selected'));\n\n    // Set new selection\n    const el = this.itemChildren.find(el => el.value === value);\n    if (el) {\n      el.setAttribute('aria-selected', 'true');\n    }\n  }\n\n  private getSelectedItemIndex(): number {\n    if (!this.value) return -1;\n    return this.itemChildren.findIndex(item => item.value === this.value);\n  }\n\n  private openDropdown() {\n    try {\n      this.isOpen = true;\n      // Initialize focus to the currently selected item\n      this.focusedIndex = this.getSelectedItemIndex();\n      // Immediate update instead of setTimeout\n      this.updateItemElements();\n\n      // Auto-scroll to selected item if it exists\n      if (this.focusedIndex >= 0) {\n        requestAnimationFrame(() => {\n          this.scrollToSelectedItem();\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  private closeDropdown() {\n    this.isOpen = false;\n    this.focusedIndex = -1;\n    this.removeItemFocus();\n  }\n\n  private handleDocumentClick = (event: Event) => {\n    if (!this.isComponentConnected || !this.el.contains(event.target as Node)) {\n      this.closeDropdown();\n    }\n  };\n\n  private collectItemChildren() {\n    if (!this.isComponentConnected) return;\n\n    const items = Array.from(this.el.querySelectorAll('ir-dropdown-item')) as HTMLIrDropdownItemElement[];\n    this.itemChildren = items;\n\n    // Immediate update instead of setTimeout\n    this.updateItemElements();\n  }\n\n  private updateItemElements() {\n    if (!this.isComponentConnected) return;\n\n    // Use the collected item children directly\n    this.itemChildren.forEach((el, index) => {\n      el.setAttribute('data-slot-index', String(index));\n      el.setAttribute('role', 'option');\n      el.setAttribute('tabindex', '-1');\n    });\n  }\n\n  private removeItemFocus() {\n    this.itemChildren.forEach(element => {\n      element.classList.remove('focused', 'active');\n      // Don't remove aria-selected as it indicates selection, not focus\n    });\n  }\n\n  private focusItemElement(index: number) {\n    this.removeItemFocus();\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.classList.add('focused');\n      element.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n    }\n  }\n\n  private selectItemElement(index: number) {\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.click();\n    }\n  }\n\n  private scrollToSelectedItem() {\n    if (this.focusedIndex >= 0 && this.focusedIndex < this.itemChildren.length) {\n      const selectedElement = this.itemChildren[this.focusedIndex];\n      if (selectedElement) {\n        selectedElement.scrollIntoView({\n          block: 'nearest',\n          behavior: 'smooth',\n          inline: 'nearest',\n        });\n      }\n    }\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    if (!this.isComponentConnected || this.disabled) return;\n\n    const maxIndex = this.itemChildren.length - 1;\n\n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from next item\n          if (this.focusedIndex >= 0 && this.focusedIndex < maxIndex) {\n            this.focusedIndex++;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from first item\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === maxIndex) {\n            // At last item, wrap to first\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex < maxIndex ? this.focusedIndex + 1 : 0;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'ArrowUp':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from previous item\n          if (this.focusedIndex > 0) {\n            this.focusedIndex--;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from last item\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === 0) {\n            // At first item, wrap to last\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex > 0 ? this.focusedIndex - 1 : maxIndex;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'Enter':\n        event.preventDefault();\n        if (this.isOpen && this.focusedIndex >= 0) {\n          this.selectItemElement(this.focusedIndex);\n        } else if (!this.isOpen) {\n          this.openDropdown();\n        }\n        break;\n\n      case 'Escape':\n        event.preventDefault();\n        this.closeDropdown();\n        break;\n\n      case 'Tab':\n        if (this.isOpen) {\n          this.closeDropdown();\n        }\n        break;\n    }\n  };\n\n  private selectOption(option: DropdownItem['value']) {\n    this.selectedOption = option;\n    this.value = option;\n    this.optionChange.emit(option);\n    this.closeDropdown();\n  }\n\n  render() {\n    return (\n      <Host class={`dropdown ${this.isOpen ? 'show' : ''}`}>\n        <div\n          onClick={() => {\n            if (this.disabled) return;\n            if (this.isOpen) {\n              this.closeDropdown();\n            } else {\n              this.openDropdown();\n            }\n          }}\n          aria-disabled={String(this.disabled)}\n          class={`dropdown-trigger ${this.disabled ? 'disabled' : ''}`}\n          onKeyDown={this.handleKeyDown}\n          tabindex=\"0\"\n        >\n          <slot name=\"trigger\"></slot>\n          {this.caret && (\n            <div class={`caret-icon ${this.disabled ? 'disabled' : ''}`}>\n              <ir-icons name={!this.isOpen ? 'angle-down' : 'angle-up'}></ir-icons>\n            </div>\n          )}\n        </div>\n        <div class=\"dropdown-menu\" role=\"listbox\" aria-expanded={this.isOpen.toString()}>\n          <slot></slot>\n        </div>\n      </Host>\n    );\n  }\n}\n","/* ir-m-combobox-item.css */\n:host {\n  display: block;\n  cursor: pointer;\n}\n:host([hidden]) {\n  display: none !important;\n}\n:host(.focused) {\n  background: #f4f5fa !important;\n}\n:host(.active),\n:host([aria-selected='true']),\n:host:active {\n  /* keep in sync with your combobox .dropdown-item.active styles */\n  outline: none;\n  background-color: var(--blue, #1e9ff2) !important;\n  color: white !important;\n}\n:host(.dropdown-item) {\n  padding: 0.25rem 1rem !important;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n","import { Component, Element, Event, EventEmitter, Host, Method, Prop, h } from '@stencil/core';\nimport { DropdownItem } from '../ir-dropdown/ir-dropdown';\n\n@Component({\n  tag: 'ir-dropdown-item',\n  styleUrl: 'ir-dropdown-item.css',\n  scoped: true,\n})\nexport class IrDropdownItem {\n  @Element() el: HTMLIrDropdownItemElement;\n\n  private isComponentConnected: boolean = true;\n  private hasRegistered: boolean = false;\n\n  /**\n   * Required value for the option\n   */\n  @Prop() value!: string;\n\n  /**\n   * Optional label (falls back to textContent)\n   */\n  @Prop() label?: string;\n\n  /**\n   * Optional html_content (when you want rich content);\n   * If omitted, the component will render its own slot content.\n   */\n  @Prop() html_content?: string;\n\n  /**\n   * When true, visually hide the item (used for filtering).\n   */\n  @Prop({ mutable: true, reflect: true }) hidden: boolean = false;\n\n  /**\n   * Emit when this item is chosen. Parent listens and closes dropdown.\n   */\n  @Event({ eventName: 'dropdownItemSelect' }) dropdownItemSelect: EventEmitter<DropdownItem['value']>;\n\n  /**\n   * Inform the parent this item exists (parent will index and manage focus)\n   */\n  @Event({ eventName: 'dropdownItemRegister' }) dropdownItemRegister: EventEmitter<void>;\n\n  /**\n   * Inform the parent this item is gone\n   */\n  @Event({ eventName: 'dropdownItemUnregister' }) dropdownItemUnregister: EventEmitter<void>;\n\n  componentDidLoad() {\n    if (this.isComponentConnected && !this.hasRegistered) {\n      this.hasRegistered = true;\n      // Use RAF to ensure parent is ready\n      requestAnimationFrame(() => {\n        if (this.isComponentConnected) {\n          this.dropdownItemRegister.emit();\n        }\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n\n    // Only emit unregister if we previously registered and parent might still be connected\n    if (this.hasRegistered && this.el.parentElement) {\n      // Check if parent dropdown still exists in DOM\n      const parentDropdown = this.el.closest('ir-dropdown');\n      if (parentDropdown && document.contains(parentDropdown)) {\n        this.dropdownItemUnregister.emit();\n      }\n    }\n    this.hasRegistered = false;\n  }\n\n  @Method()\n  async matchesQuery(query: string): Promise<boolean> {\n    if (!this.isComponentConnected) return false;\n\n    const q = query.toLowerCase();\n    const hay = (this.label ?? this.el.textContent ?? '').toLowerCase();\n    return hay.includes(q);\n  }\n\n  @Method()\n  async setHidden(next: boolean) {\n    if (this.isComponentConnected) {\n      this.hidden = next;\n    }\n  }\n\n  private handleClick = (event: Event) => {\n    event.stopPropagation();\n\n    if (!this.isComponentConnected) return;\n\n    this.dropdownItemSelect.emit(this.value);\n  };\n\n  render() {\n    return (\n      <Host role=\"option\" tabindex=\"-1\" aria-selected=\"false\" class={{ 'dropdown-item': true, 'hidden': this.hidden }} onClick={this.handleClick} data-value={this.value}>\n        {this.html_content ? <span innerHTML={this.html_content}></span> : <slot></slot>}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n\n.beta {\n  background: var(--red);\n  color: white;\n  padding: 0.2rem 0.3rem;\n  font-size: 12px;\n  border-radius: 4px;\n  margin: 0;\n}\n.event-row {\n  padding-bottom: 0.5rem;\n}\n.list-title {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  font-weight: bold;\n  width: fit-content;\n}\n.list-item {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  margin-left: 5px;\n  width: fit-content;\n}\n.list-item.green {\n  color: #629a4c;\n  font-weight: 600;\n}\n.list-item.red {\n  color: #ff4961;\n  font-weight: 600;\n}\n.dates-row {\n  display: flex;\n  align-items: center;\n  gap: 0.875rem;\n}\n","import { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { Component, Fragment, Prop, State, h } from '@stencil/core';\nimport locales from '@/stores/locales.store';\nimport { Booking, ExposedBookingEvent } from '@/models/booking.dto';\n\n@Component({\n  tag: 'ir-events-log',\n  styleUrl: 'ir-events-log.css',\n  scoped: true,\n})\nexport class IrEventsLog {\n  @Prop() bookingNumber: string;\n  @Prop() booking: Booking;\n\n  @State() bookingEvents: ExposedBookingEvent[];\n\n  componentWillLoad() {\n    this.init();\n  }\n\n  private async init() {\n    try {\n      this.bookingEvents = this.booking.events;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"p-1\">\n        <div class=\"d-flex  align-items-center\" style={{ gap: '0.5rem' }}>\n          <h3 class=\" text-left p-0 m-0  dialog-title \">{locales.entries.Lcz_EventsLog}</h3>\n          {/* <span class=\"m-0 beta\">Beta</span> */}\n        </div>\n\n        {isRequestPending('/Get_Exposed_Booking_Events') ? (\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\n            <ir-spinner></ir-spinner>\n          </div>\n        ) : (\n          <Fragment>\n            <table class=\" dialog-container-height\">\n              <thead style={{ opacity: '0' }}>\n                <tr>\n                  <th>date</th>\n                  <th>user</th>\n                  <th>status</th>\n                </tr>\n              </thead>\n              <tbody>\n                {this.bookingEvents?.map(e => (\n                  <tr key={e.id} class=\"pb-1\">\n                    <td class=\"event-row dates-row\">\n                      <span>{e.date}</span>\n                      <span>\n                        {String(e.hour).padStart(2, '0')}:{String(e.minute).padStart(2, '0')}:{String(e.second).padStart(2, '0')}\n                      </span>\n                    </td>\n                    <td class=\"pl-3 event-row \">{e.type}</td>\n                    <td class=\"pl-1 event-row \">{e.user}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.extra-service-container {\n  display: flex;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n.extra-service-container * {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n.extra-service-actions {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.extra-service-conditional-date {\n  margin-top: 0.5rem;\n}\n.extra-service-price {\n  white-space: nowrap;\n}\n.extra-service-description {\n  word-break: break-all;\n}\n","import { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\nimport { ExtraService } from '@/models/booking.dto';\nimport { formatAmount } from '@/utils/utils';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport locales from '@/stores/locales.store';\nimport moment from 'moment';\nimport { BookingService } from '@/services/booking.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n\n@Component({\n  tag: 'ir-extra-service',\n  styleUrl: 'ir-extra-service.css',\n  scoped: true,\n})\nexport class IrExtraService {\n  @Prop() service: ExtraService;\n  @Prop() bookingNumber: string;\n  @Prop() currencySymbol: string;\n\n  @Event() editExtraService: EventEmitter<ExtraService>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private irModalRef: HTMLIrModalElement;\n  private bookingService = new BookingService();\n\n  private async deleteService() {\n    try {\n      await this.bookingService.doBookingExtraService({\n        service: this.service,\n        is_remove: true,\n        booking_nbr: this.bookingNumber,\n      });\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    return (\n      <Host>\n        <div class=\"p-1\">\n          <div class={'extra-service-container'}>\n            <p class=\"extra-service-description\">{this.service.description}</p>\n            <div class=\"extra-service-actions\">\n              {!!this.service.price && this.service.price > 0 && (\n                <p class=\"extra-service-price p-0 m-0 font-weight-bold\">{formatAmount(this.currencySymbol, this.service.price)}</p>\n              )}\n              <ir-button\n                id={`serviceEdit-${this.service.booking_system_id}`}\n                class=\"extra-service-edit-btn m-0 p-0\"\n                variant=\"icon\"\n                icon_name=\"edit\"\n                style={colorVariants.secondary}\n                onClickHandler={() => this.editExtraService.emit(this.service)}\n              ></ir-button>\n              <ir-button\n                class=\"extra-service-delete-btn m-0 p-0\"\n                variant=\"icon\"\n                onClickHandler={() => this.irModalRef.openModal()}\n                id={`roomDelete-${this.service.booking_system_id}`}\n                icon_name=\"trash\"\n                style={colorVariants.danger}\n              ></ir-button>\n            </div>\n          </div>\n          <div class=\"extra-service-conditional-date\">\n            {this.service.start_date && this.service.end_date ? (\n              <ir-date-view class=\"extra-service-date-view mr-1\" from_date={this.service.start_date} to_date={this.service.end_date} showDateDifference={false}></ir-date-view>\n            ) : (\n              this.service.start_date && <p class=\"extra-service-date-view\">{moment(new Date(this.service.start_date)).format('MMM DD, YYYY')}</p>\n            )}\n          </div>\n        </div>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.irModalRef = el)}\n          isLoading={isRequestPending('/Do_Booking_Extra_Service')}\n          onConfirmModal={this.deleteService.bind(this)}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={locales.entries.Lcz_Delete}\n          leftBtnColor=\"secondary\"\n          rightBtnColor=\"danger\"\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={`${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${locales.entries.Lcz_ThisService} ${locales.entries.Lcz_FromThisBooking}`}\n        ></ir-modal>\n      </Host>\n    );\n  }\n}\n","import { z, ZodError, ZodIssueCode } from 'zod';\nimport { IAllowedOptions, ICurrency, IPickupCurrency } from './calendarData';\nimport { TSourceOption } from './igl-book-property';\nimport { ICountry } from './IBooking';\nimport moment from 'moment';\nimport { IHouseKeepers } from './housekeeping';\n\ninterface IDType {\n  code: string;\n  description: string;\n}\n\ninterface IDInfo {\n  type: IDType;\n  number: string;\n}\n\nexport interface SharedPerson {\n  address: null;\n  alternative_email: null;\n  cci: null;\n  city: null;\n  country: ICountry;\n  country_id: string;\n  country_phone_prefix: null;\n  dob: string;\n  email: null;\n  first_name: string;\n  full_name: string;\n  id: number;\n  id_info: IDInfo;\n  is_main?: boolean;\n  last_name: string;\n  mobile: null;\n  nbr_confirmed_bookings: number;\n  notes: null;\n  password: null;\n  subscribe_to_news_letter: null;\n}\n// export const ZIdInfo = z.object({\n//   type: z.object({\n//     code: z.string().min(3),\n//     description: z.string(),\n//   }),\n//   number: z.string().min(2),\n// });\n// export const ZSharedPerson = z.object({\n//   id: z.number(),\n//   full_name: z.string().min(2),\n//   country_id: z.coerce.number().min(0),\n//   dob: z.coerce.date().transform(date => moment(date).format('YYYY-MM-DD')),\n//   id_info: ZIdInfo,\n// });\n\n/**\n * ZIdInfo schema:\n * - `type.code`: Validates a non-empty string must be at least 3 chars.\n *   If empty string or not provided, validation is skipped.\n * - `type.description`: Same pattern for description (but no min length).\n * - `number`: Validates if non-empty string it should be at least 2 chars.\n */\nexport const ZIdInfo = z.object({\n  type: z.object({\n    code: z\n      .union([\n        // If provided and non-empty, must have at least 3 chars\n        z.string().min(3),\n        // or it can be an empty string\n        z.literal(''),\n      ])\n      .optional(), // or undefined\n    description: z\n      .union([\n        // If provided and non-empty, no special min\n        z.string(),\n        // or it can be empty string\n        z.literal(''),\n      ])\n      .optional(),\n  }),\n  number: z\n    .union([\n      // If provided and non-empty, must have at least 2 chars\n      z.string().min(2),\n      // or it can be empty string\n      z.literal(''),\n    ])\n    .optional()\n    .nullable(),\n});\n\n/**\n * ZSharedPerson schema:\n * - `id`: Optional numeric field.\n * - `full_name`: If provided and non-empty, must be at least 2 chars.\n * - `country_id`: If provided, coerced to number, must be >= 0.\n * - `dob`: If provided, coerced to Date and formatted. Otherwise skipped.\n * - `id_info`: The nested object above; can also be omitted entirely.\n */\nexport const ZSharedPerson = z.object({\n  id: z.number().optional(),\n  // full_name: z\n  //   .union([\n  //     z.string().min(2), // if provided and non-empty, must have min length 2\n  //     z.literal(''), // or it can be empty string\n  //   ])\n  //   .optional(),\n  first_name: z\n    .union([\n      z.string().min(2), // if provided and non-empty, must have min length 2\n      z.literal(''), // or it can be empty string\n    ])\n    .optional(),\n  // .nullable(),\n  last_name: z\n    .union([\n      z.string().min(2), // if provided and non-empty, must have min length 2\n      z.literal(''), // or it can be empty string\n    ])\n    .optional(),\n  // .nullable(),\n  country_id: z.coerce\n    .number()\n    .min(0) // if provided, must be >= 0\n    .optional(),\n  dob: z\n    .string()\n    .nullable()\n    .optional()\n    .refine(value => value === undefined || moment(value, 'DD/MM/YYYY', true).isValid() || value === '' || value === null, 'Invalid date format')\n    .transform(value => {\n      if (value === undefined || value === '' || value === null) return null;\n      const isDDMMYYYY = moment(value, 'DD/MM/YYYY', true).isValid();\n      return isDDMMYYYY ? null : moment(value, 'DD/MM/YYYY').format('YYYY-MM-DD');\n    }),\n  id_info: ZIdInfo.optional(),\n  is_main: z.boolean().default(false),\n});\n\n// export const ZSharedPersons = z.array(ZSharedPerson).superRefine((data, ctx) => {\n//   for (const d of data) {\n//     validateSharedPerson(d, ctx);\n//   }\n// });\n\nexport function validateSharedPerson(data: any) {\n  ZSharedPerson.parse(data);\n  const hasValue = (field: string | null | undefined): boolean => {\n    return field !== null && field !== undefined && field.trim() !== '';\n  };\n  const ctx = [];\n  if (data.is_main) {\n    if (!hasValue(data.first_name)) {\n      ctx.push({\n        path: ['first_name'],\n        code: ZodIssueCode.custom,\n        message: 'First name is required for main guest',\n      });\n    }\n\n    if (!hasValue(data.last_name)) {\n      ctx.push({\n        path: ['last_name'],\n        code: ZodIssueCode.custom,\n        message: 'Last name is required for main guest',\n      });\n    }\n  }\n\n  // For non-main guests: check if ANY field has data\n  const hasAnyFieldData =\n    hasValue(data.first_name) ||\n    hasValue(data.last_name) ||\n    hasValue(data.dob) ||\n    (data.country_id !== null && data.country_id !== undefined && data.country_id > 0) ||\n    hasValue(data.id_info?.number);\n\n  // If any field has data, then first_name and last_name become required\n  if (hasAnyFieldData) {\n    if (!hasValue(data.first_name)) {\n      ctx.push({\n        path: ['first_name'],\n        code: ZodIssueCode.custom,\n        message: 'First name is required when other guest information is provided',\n      });\n    }\n\n    if (!hasValue(data.last_name)) {\n      ctx.push({\n        path: ['last_name'],\n        code: ZodIssueCode.custom,\n        message: 'Last name is required when other guest information is provided',\n      });\n    }\n  }\n  if (ctx.length >= 1) {\n    throw new ZodError(ctx);\n  }\n}\nexport interface HandleExposedRoomGuestsRequest {\n  booking_nbr: string;\n  identifier: string;\n  guests: SharedPerson[];\n}\nexport interface OtaGuarantee {\n  card_number: string;\n  card_type: string;\n  cardholder_name: string;\n  cvv: string;\n  expiration_date: string;\n  is_virtual: boolean;\n  meta: Meta;\n  token: string;\n}\n\ninterface Meta {\n  virtual_card_currency_code: string;\n  virtual_card_current_balance: string;\n  virtual_card_decimal_places: string;\n  virtual_card_effective_date: string;\n  virtual_card_expiration_date: string;\n}\nexport interface OtaService {\n  name: string;\n  nights: number;\n  persons: number;\n  price_mode: string;\n  price_per_unit: number;\n  total_price: number;\n}\nexport interface ExposedBookingEvent {\n  date: string;\n  hour: number;\n  id: number;\n  minute: number;\n  second: number;\n  user: string;\n  type: string;\n}\n\nexport type OTAManipulations = {\n  user: string;\n  date: string;\n  hour: string;\n  minute: string;\n};\n\nexport type BypassedOtaRevisions = {\n  revision_nbr: number;\n  date: string;\n  revision_type: string;\n};\nexport interface Booking {\n  agent: {\n    code: string;\n    id: number;\n    name: string;\n    verification_mode: null;\n  } | null;\n  events: ExposedBookingEvent[];\n  ota_manipulations: OTAManipulations[];\n  bypassed_ota_revisions: BypassedOtaRevisions[];\n  ota_services: OtaService[];\n  is_requested_to_cancel: boolean;\n  arrival: Arrival;\n  allowed_actions: IAllowedActions[];\n  system_id: number;\n  booked_on: DateTime;\n  booking_nbr: string;\n  currency: Currency;\n  extra_services: ExtraService[] | null;\n  from_date: string;\n  guest: Guest;\n  extras: Extras[] | null;\n  occupancy: Occupancy;\n  origin: Origin;\n  ota_guarante: OtaGuarantee;\n  property: Property;\n  remark: string;\n  ota_notes: IOtaNotes[];\n  rooms: Room[];\n  source: Source;\n  status: Status;\n  to_date: string;\n  total: number;\n  is_editable: boolean;\n  format: IFormat;\n  channel_booking_nbr: string | null;\n  is_direct: boolean;\n  financial: IFinancial;\n  pickup_info: IBookingPickupInfo | null;\n  cost: number | null;\n  is_pms_enabled: boolean;\n  promo_key: string | null;\n  is_in_loyalty_mode: boolean;\n}\n\nexport const ExtraServiceSchema = z.object({\n  booking_system_id: z.number().optional(),\n  cost: z.coerce.number().nullable(),\n  currency_id: z.number().min(1),\n  description: z.string().min(1),\n  end_date: z.string().nullable(),\n  price: z.coerce.number(),\n  start_date: z.string().nullable(),\n  system_id: z.number().optional(),\n});\n\nexport type ExtraService = z.infer<typeof ExtraServiceSchema>;\nexport interface Extras {\n  key: string;\n  value: any;\n}\nexport interface IOtaNotes {\n  statement: string;\n}\nexport interface IBookingPickupInfo {\n  currency: IPickupCurrency;\n  date: string;\n  details: string;\n  hour: number;\n  minute: number;\n  nbr_of_units: number;\n  selected_option: IAllowedOptions;\n  total: number;\n}\nexport interface IAllowedActions {\n  code: string;\n  description: string;\n}\nexport interface IFinancial {\n  cancelation_penality_as_if_today: number;\n  due_amount: number;\n  due_dates: IDueDate[];\n  payments: IPayment[] | null;\n  total_amount: number;\n  collected: number;\n  gross_total: number;\n  gross_cost: number;\n  refunds: number;\n  invoice_nbr: string;\n  gross_total_with_extras: number;\n}\nexport interface IPayment {\n  id: number | null;\n  date: string;\n  amount: number;\n  currency: ICurrency;\n  designation: string;\n  reference: string;\n  book_nbr?: string;\n  payment_gateway_code?: number;\n  payment_type?: PaymentType;\n  payment_method?: PaymentType;\n  time_stamp: {\n    date: string;\n    hour: number;\n    minute: number;\n    second: number;\n    user: string;\n  };\n}\n\ninterface PaymentType {\n  code: string;\n  description: string;\n  operation: string;\n}\n\nexport interface IDueDate {\n  amount: number;\n  currencysymbol: string;\n  date: string;\n  description: string;\n  room: string;\n}\nexport interface IFormat {\n  from_date: string;\n  to_date: string;\n}\nexport interface Arrival {\n  code: string;\n  description: string;\n}\n\nexport interface DateTime {\n  date: string;\n  hour: number;\n  minute: number;\n}\n\nexport interface Currency {\n  code: string;\n  id: number;\n  symbol: string;\n}\n\nexport interface Guest {\n  address: string | null;\n  city: string | null;\n  country_id: number | null;\n  dob: string | null;\n  email: string | null;\n  first_name: string;\n  id: number;\n  last_name: string | null;\n  mobile: string | null;\n  country_phone_prefix: string | null;\n  subscribe_to_news_letter: boolean | null;\n  cci?: ICCI | null;\n  alternative_email?: string;\n  nbr_confirmed_bookings: number;\n  notes: string;\n  mobile_without_prefix: string;\n}\nexport interface ICCI {\n  nbr: string | number;\n  holder_name: string | number;\n  expiry_month: string | number;\n  expiry_year: string | number;\n  cvc?: string | null;\n}\nexport interface Occupancy {\n  adult_nbr: number;\n  children_nbr: number;\n  infant_nbr: number | null;\n}\nexport interface DoReservationProps {\n  assign_units: boolean;\n  check_in: boolean;\n  is_pms: boolean;\n  is_direct: boolean;\n  is_in_loyalty_mode: boolean;\n  promo_key: string | null;\n  extras: any; // Assuming extras can have any structure, replace with a specific type if known\n  booking: {\n    from_date: string; // Format 'YYYY-MM-DD'\n    to_date: string; // Format 'YYYY-MM-DD'\n    remark: string | null;\n    booking_nbr: string;\n    property: {\n      id: string | number;\n    };\n    booked_on: {\n      date: string; // Format 'YYYY-MM-DD'\n      hour: number;\n      minute: number;\n    };\n    source: TSourceOption;\n    rooms: Room[]; // Assuming rooms are defined in the imported `Room` type\n    currency: string;\n    arrival: {\n      code: string;\n    };\n    guest: {\n      email: string | null;\n      first_name: string;\n      last_name: string;\n      country_id: string | number | null;\n      city: string | null;\n      mobile: string;\n      phone_prefix: string | null;\n      address: string;\n      dob: string | null;\n      subscribe_to_news_letter: boolean;\n      cci: {\n        nbr: string;\n        holder_name: string;\n        expiry_month: string;\n        expiry_year: string;\n      } | null;\n    };\n  };\n  pickup_info: any | null; // Assuming it can be any structure, replace if specific type is available\n}\nexport interface Origin {\n  Icon: string;\n  Label: string;\n}\n\nexport interface BookingColor {\n  color: string | null;\n  design: 'skew';\n  name: string | null;\n}\n\nexport interface Property {\n  address: string;\n  adult_child_constraints: Adultchildconstraints;\n  affiliates: any[];\n  agents: Agent[];\n  allowed_booking_sources: Allowedbookingsource[];\n  allowed_cards: Allowedcard[];\n  allowed_payment_methods: AllowedPaymentMethod[];\n  amenities: Amenity[];\n  aname: string;\n  area: string;\n  baby_cot_offering: Babycotoffering;\n  be_listing_mode: string;\n  calendar_extra: CalendarExtra | null;\n  calendar_legends: Calendarlegend[];\n  city: City;\n  cleaning_frequency: Paymentmode;\n  contacts: Contact[];\n  country: Country;\n  currency: Currency;\n  description: Description;\n  extra_info: Extrainfo[];\n  id: number;\n  images: Image[];\n  internet_offering: Internetoffering;\n  is_automatic_check_in_out: boolean;\n  is_be_enabled: boolean;\n  is_frontdesk_enabled: boolean;\n  is_multi_property: boolean;\n  is_pms_enabled: boolean;\n  is_vacation_rental: boolean;\n  location: Location;\n  max_nights: number;\n  name: string;\n  parking_offering: Parkingoffering;\n  payment_methods: null;\n  perma_link: string;\n  pets_acceptance: Petsacceptance;\n  phone: string;\n  pickup_service: Pickupservice;\n  postal: null;\n  privacy_policy: string;\n  promotions: Promotion[];\n  registered_name: string;\n  roomtypes: any[];\n  social_media: Socialmedia[];\n  sources: Paymentmode[];\n  space_theme: Spacetheme;\n  tags: Extrainfo[];\n  tax_nbr: string;\n  tax_statement: string;\n  taxation_strategy: Paymentmode;\n  taxes: Tax[];\n  time_constraints: Timeconstraints;\n}\n\ninterface Timeconstraints {\n  booking_cutoff: string;\n  check_in_from: string;\n  check_in_till: string;\n  check_out_till: string;\n}\n\ninterface Tax {\n  is_exlusive: boolean;\n  name: string;\n  pct: number;\n}\n\ninterface Spacetheme {\n  background_image: string;\n  button_bg_color: string;\n  button_border_radius: string;\n  favicon: string;\n  heading_bar_color: string;\n  heading_font_color: string;\n  logo: string;\n  website: string;\n}\n\ninterface Socialmedia {\n  code: string;\n  link: string;\n  name: string;\n}\n\ninterface Promotion {\n  from: string;\n  id: number;\n  is_last_minute_discount: boolean;\n  is_loyalty: boolean;\n  key: string;\n  mode: null;\n  to: string;\n  type: null;\n  value: null;\n}\n\ninterface Pickupservice {\n  allowed_locations: Allowedlocation[];\n  allowed_options: Allowedoption[];\n  allowed_pricing_models: Paymentmode[];\n  allowed_vehicle_types: Vehicle[];\n  is_enabled: boolean;\n  is_not_allowed_on_same_day: boolean;\n  pickup_cancelation_prepayment: Paymentmode;\n  pickup_instruction: Paymentmode;\n}\n\ninterface Allowedoption {\n  amount: number;\n  currency: Currency;\n  id: number;\n  location: Allowedlocation;\n  pricing_model: Paymentmode;\n  vehicle: Vehicle;\n}\n\ninterface Vehicle {\n  capacity: number;\n  code: string;\n  description: string;\n}\n\ninterface Allowedlocation {\n  description: string;\n  id: number;\n}\n\ninterface Petsacceptance {\n  title: string;\n}\n\ninterface Parkingoffering {\n  pricing: number;\n  schedule: string;\n  title: string;\n}\n\ninterface Location {\n  latitude: number;\n  longitude: number;\n}\n\ninterface Internetoffering {\n  is_public_internet_free: boolean;\n  is_room_internet_free: boolean;\n  public_internet_statement: string;\n  room_internet_statement: string;\n  room_rate_per_24_hour: number;\n  room_rate_per_hour: number;\n}\n\ninterface Image {\n  thumbnail: string;\n  tooltip: null | string;\n  url: string;\n}\n\ninterface Extrainfo {\n  key: string;\n  value: string;\n}\n\ninterface Description {\n  food_and_beverage: string;\n  important_info: string;\n  location_and_intro: string;\n  non_standard_conditions: string;\n  rooming: string;\n}\n\n// interface Currency {\n//   code: string;\n//   id: number;\n//   symbol: string;\n// }\n\ninterface Country {\n  cities: null;\n  code: null;\n  currency: null;\n  flag: null;\n  gmt_offset: number;\n  id: number;\n  name: string;\n  phone_prefix: string;\n}\n\ninterface Contact {\n  email: string;\n  mobile: null;\n  name: string;\n  phone: string;\n  type: string;\n}\n\ninterface City {\n  gmt_offset: number;\n  id: number;\n  name: string;\n}\n\ninterface Calendarlegend {\n  color: string;\n  design: string;\n  id: string;\n  name: string;\n}\n\ninterface Babycotoffering {\n  rate_per_night: number;\n  title: string;\n}\n\ninterface Amenity {\n  amenity_type: string;\n  code: string;\n  description: string;\n}\n\nexport interface AllowedPaymentMethod {\n  allowed_currencies: null | string;\n  code: string;\n  data: null;\n  description: string;\n  display_order: null;\n  id: null | number;\n  img_url: null | string;\n  is_active: boolean;\n  is_payment_gateway: boolean;\n  localizables: Localizable[] | null;\n  property_id: number;\n}\n\ninterface Localizable {\n  code: string;\n  description: string;\n  id: number;\n  language: Language;\n}\n\ninterface Language {\n  code: string;\n  culture: null;\n  description: string;\n  direction: null;\n  entries: null;\n  flag: null;\n  id: number;\n}\n\ninterface Allowedcard {\n  id: number;\n  name: string;\n}\n\ninterface Allowedbookingsource {\n  code: string;\n  description: string;\n  id: string;\n  tag: string;\n  type: string;\n}\n\ninterface Agent {\n  code: string;\n  id: number;\n  is_active: boolean;\n  name: string;\n  payment_mode: Paymentmode;\n  verification_mode: string;\n}\n\ninterface Paymentmode {\n  code: string;\n  description: string;\n}\n\ninterface Adultchildconstraints {\n  adult_max_nbr: number;\n  child_max_age: number;\n  child_max_nbr: number;\n}\n\nexport interface CalendarExtra {\n  booking_colors: BookingColor[] | null;\n}\n// export interface Property {\n//   calendar_legends: any;\n//   currency: null;\n//   id: number;\n//   name: string;\n//   roomtypes: null;\n//   calendar_extra: CalendarExtra | null;\n// }\nexport type DepartureTime = {\n  code: string;\n  description: string;\n};\nexport interface ExposedApplicablePolicy {\n  brackets: Bracket[];\n  combined_statement: string;\n  type: 'cancelation' | 'guarantee';\n}\n\nexport interface Bracket {\n  amount: number;\n  amount_formatted: string;\n  code: string;\n  currency_id: number;\n  due_on: string;\n  due_on_formatted: null | string;\n  gross_amount: number;\n  gross_amount_formatted: string;\n  statement: string;\n}\nexport type RoomInOut = { code: '001' | '002' | '000'; description: string };\nexport interface Room {\n  days: Day[];\n  applicable_policies: ExposedApplicablePolicy[];\n  from_date: string;\n  calendar_extra: string;\n  parent_room_identifier: string | null;\n  is_split: boolean;\n  guest: Guest;\n  occupancy_default: number;\n  notes: string | null;\n  occupancy: Occupancy;\n  physicalroom: null;\n  in_out: RoomInOut | null;\n  sharing_persons: SharedPerson[] | null;\n  bed_preference: number | null;\n  rateplan: RatePlan;\n  roomtype: RoomType;\n  departure_time: DepartureTime;\n  to_date: string;\n  total: number;\n  smoking_option: string;\n  identifier: string;\n  unit: string | number | IUnit | null;\n  ota_taxes: IOtaTax[];\n  ota_meta: OtaMeta;\n\n  cost: number | null;\n  gross_cost: number;\n  gross_total: number;\n  guarantee: number;\n  gross_guarantee: number;\n}\ninterface OtaMeta {\n  bed_preferences: string | null;\n  meal_plan: string | null;\n  parent_rate_plan_id: string | null;\n  policies: string | null;\n  smoking_preferences: string | null;\n}\nexport interface IOtaTax {\n  amount: number;\n  currency: IOtaTaxCurrency;\n  is_exlusive: boolean;\n  name: string;\n}\nexport interface IOtaTaxCurrency {\n  code: string;\n  id: number;\n  symbol: string;\n}\nexport interface IUnit {\n  calendar_cell: null;\n  id: 2;\n  name: '402';\n}\nexport interface Day {\n  amount: number;\n  date: string;\n  cost: number | null;\n}\n\nexport interface RatePlan {\n  cancelation: string | null;\n  guarantee: null;\n  id: number;\n  name: string;\n  rate_restrictions: null;\n  variations: null;\n  selected_variation: IVariations;\n  is_non_refundable: boolean;\n  custom_text: string | null;\n  is_active: boolean;\n  short_name: string;\n  meal_plan: {\n    code: string;\n    description: string | null;\n  } | null;\n}\nexport interface IVariations {\n  adult_child_offering: string;\n  adult_nbr: number;\n  amount: number | null;\n  child_nbr: number;\n}\nexport interface RoomType {\n  availabilities: null;\n  id: number;\n  inventory: number;\n  name: string;\n  physicalrooms: PhysicalRoom[];\n  rate: number;\n  rateplans: null;\n  is_active: boolean;\n}\nexport type RoomHkStatus = '001' | '002' | '003' | '004';\nexport interface PhysicalRoom {\n  calendar_cell: null;\n  housekeeper: IHouseKeepers;\n  id: number;\n  is_active: boolean;\n  name: string;\n  hk_status: RoomHkStatus;\n}\n\nexport interface Source {\n  code: string | null;\n  description: string;\n  tag: string | null;\n}\n\nexport interface Status {\n  code: string;\n  description: string;\n}\n\nexport interface IPmsLog {\n  is_acknowledged: boolean;\n  is_sent: boolean;\n  sent_date: string;\n  sent_hour: number;\n  sent_minute: number;\n}\n",":host {\n  display: block;\n  --ir-input-border-color: #cacfe7;\n}\n\n:host .input-group-text {\n  border-color: var(--ir-input-border-color);\n}\n/* .hidden-date-picker.hidden-dates .date-range-input {\n  opacity: 0;\n} */\n.currency-ph {\n  padding: 0;\n  margin: 0;\n  color: #3b4781;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0 0 0 0.25rem;\n  border-top: 1px solid var(--ir-input-border-color);\n  border-bottom: 1px solid var(--ir-input-border-color);\n  border-left: 1px solid transparent;\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\n}\n\n.service-description-input {\n  height: 70px !important;\n}\n\n.service-description .input-group-prepend {\n  background-color: #f4f5fa;\n  border: 1px solid var(--ir-input-border-color);\n  border-top-left-radius: 0.25rem;\n  border-bottom-left-radius: 0.25rem;\n}\n.service-date-container {\n  padding: 0;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  position: relative;\n  width: 100%;\n  justify-content: center;\n}\n.service-date-container .btn-container {\n  position: absolute;\n  right: 5px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n}\n.service-description .input-group-text {\n  height: fit-content;\n  border: 0;\n  padding-top: 0.75rem !important;\n}\n\n.price-input-group:focus-within .currency-ph,\n.cost-input-group:focus-within .currency-ph {\n  border-top: 1px solid #1e9ff2;\n  border-bottom: 1px solid #1e9ff2;\n  border-left: 1px solid #1e9ff2;\n}\n.currency-ph[data-state='error'] {\n  border-color: var(--red, #ff4961);\n}\n.price-input:focus {\n  border-right-width: 1px !important;\n}\n\n.is-invalid {\n  background-image: none !important;\n}\n.price-input,\n.cost-input {\n  border-left: 0;\n}\n\n.row-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n@media (min-width: 640px) {\n  .row-group {\n    flex-direction: row;\n    align-items: center;\n    gap: 0;\n  }\n  .cost-label {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    border-left: 0;\n  }\n  .until-prepend,\n  .cost-input-placeholder {\n    border-top-left-radius: 0 !important;\n    border-bottom-left-radius: 0 !important;\n  }\n  .date-from,\n  .price-input {\n    border-right-width: 0 !important;\n    border-top-right-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n  }\n}\n\n.date-focused {\n  border-color: #1e9ff2;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Booking, ExtraService, ExtraServiceSchema } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { ZodError } from 'zod';\nimport { _formatDate } from '../../functions';\n\n@Component({\n  tag: 'ir-extra-service-config',\n  styleUrls: ['ir-extra-service-config.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrExtraServiceConfig {\n  @Prop() booking: Pick<Booking, 'from_date' | 'to_date' | 'currency' | 'booking_nbr'>;\n  @Prop() service: ExtraService;\n\n  @State() s_service: ExtraService;\n  @State() error: boolean;\n  @State() fromDateClicked: boolean;\n  @State() toDateClicked: boolean;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  // private d1: HTMLDivElement;\n  // private d1_0: HTMLDivElement;\n  // private d2_0: HTMLDivElement;\n  // private d2: HTMLInputElement;\n\n  componentWillLoad() {\n    if (this.service) {\n      this.s_service = { ...this.service };\n    }\n  }\n\n  private async saveAmenity() {\n    try {\n      ExtraServiceSchema.parse(this.s_service);\n      await this.bookingService.doBookingExtraService({\n        service: this.s_service,\n        booking_nbr: this.booking.booking_nbr,\n        is_remove: false,\n      });\n      this.resetBookingEvt.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        this.error = true;\n      }\n      console.error(error);\n    }\n  }\n  private updateService(params: Partial<ExtraService>) {\n    let prevService: ExtraService = this.s_service;\n    if (!prevService) {\n      prevService = {\n        cost: null,\n        description: null,\n        end_date: null,\n        start_date: null,\n        price: null,\n        currency_id: this.booking.currency.id,\n      };\n    }\n    this.s_service = { ...prevService, ...params };\n  }\n  private validatePrice(): boolean {\n    if (this.s_service?.price === undefined || this.s_service?.price?.toString() === '') {\n      return false;\n    }\n    const priceSchema = ExtraServiceSchema.pick({ price: true });\n    const result = priceSchema.safeParse({ price: this.s_service?.price });\n    return result.success;\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.saveAmenity();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_ExtraServices} displayContext=\"sidebar\"></ir-title>\n        <section class={'px-1 sheet-body'}>\n          {/* Description */}\n          <fieldset class=\"input-group mb-1 service-description\">\n            <div class=\"input-group-prepend\">\n              <span class=\"input-group-text\">{locales.entries.Lcz_Description}</span>\n            </div>\n            <textarea\n              value={this.s_service?.description}\n              class={`form-control service-description-input ${this.error && !this.s_service?.description ? 'is-invalid' : ''}`}\n              style={{ height: '7rem' }}\n              maxLength={250}\n              onChange={e => this.updateService({ description: (e.target as HTMLTextAreaElement).value })}\n              aria-label=\"Amenity description\"\n            ></textarea>\n          </fieldset>\n          {/* Dates */}\n          <div class={'row-group mb-1'}>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <span class=\"input-group-text\" id=\"basic-addon1\">\n                  {locales.entries.Lcz_DatesOn}\n                </span>\n              </div>\n              <div\n                // ref={el => (this.d1_0 = el)}\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from\"\n              >\n                <div class=\"service-date-container\">\n                  <ir-date-picker\n                    // onDatePickerFocus={() => {\n                    //   this.d1?.classList.add('date-focused');\n                    //   this.d1_0?.classList.add('date-focused');\n                    // }}\n                    // onDatePickerBlur={() => {\n                    //   this.d1?.classList.remove('date-focused');\n                    //   this.d1_0?.classList.remove('date-focused');\n                    // }}\n                    // customPicker\n                    emitEmptyDate\n                    date={this.s_service?.start_date}\n                    minDate={this.booking.from_date}\n                    maxDate={this.booking.to_date}\n                    onDateChanged={e => this.updateService({ start_date: e.detail.start?.format('YYYY-MM-DD') })}\n                  >\n                    <input\n                      // ref={el => (this.d1 = el)}\n                      type=\"text\"\n                      slot=\"trigger\"\n                      value={this.s_service?.start_date ? _formatDate(this.s_service.start_date) : null}\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%', borderRadius: '0' }}\n                      class=\"text-center w-100 form-control input-sm\"\n                    ></input>\n                  </ir-date-picker>\n                  {this.s_service?.start_date && (\n                    <div class=\"btn-container\">\n                      <ir-button\n                        title=\"clear\"\n                        id=\"close\"\n                        variant=\"icon\"\n                        style={{ '--icon-size': '0.875rem' }}\n                        icon_name=\"xmark-fill\"\n                        class=\"ml-2\"\n                        onClickHandler={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          this.updateService({ start_date: null });\n                        }}\n                      ></ir-button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend \">\n                <span class=\"input-group-text until-prepend\" id=\"basic-addon1\">\n                  {locales.entries.Lcz_TillAndIncluding}\n                </span>\n              </div>\n              <div\n                // ref={el => (this.d2_0 = el)}\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center\"\n              >\n                <div class=\"service-date-container\">\n                  <ir-date-picker\n                    // onDatePickerFocus={() => {\n                    //   this.d2?.classList.add('date-focused');\n                    //   this.d2_0?.classList.add('date-focused');\n                    // }}\n                    // onDatePickerBlur={() => {\n                    //   this.d2?.classList.remove('date-focused');\n                    //   this.d2_0?.classList.remove('date-focused');\n                    // }}\n                    emitEmptyDate\n                    date={this.s_service?.end_date}\n                    minDate={this.s_service?.start_date ?? this.booking.from_date}\n                    maxDate={this.booking.to_date}\n                    onDateChanged={e => {\n                      e.stopImmediatePropagation();\n                      e.stopPropagation();\n                      this.updateService({ end_date: e.detail.start?.format('YYYY-MM-DD') });\n                    }}\n                  >\n                    <input\n                      // ref={el => (this.d2 = el)}\n                      slot=\"trigger\"\n                      value={this.s_service?.end_date ? _formatDate(this.s_service.end_date) : null}\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%' }}\n                      class=\"text-center form-control input-sm\"\n                    ></input>\n                  </ir-date-picker>\n\n                  {this.s_service?.end_date && (\n                    <div class=\"btn-container\">\n                      <ir-button\n                        title=\"clear\"\n                        id=\"close\"\n                        variant=\"icon\"\n                        style={{ '--icon-size': '0.875rem' }}\n                        icon_name=\"xmark-fill\"\n                        class=\"ml-2\"\n                        onClickHandler={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          this.updateService({ end_date: null });\n                        }}\n                      ></ir-button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n          {/* Prices and cost */}\n          <div class={'row-group'}>\n            <ir-price-input\n              label=\"Price\"\n              currency={this.booking.currency.symbol}\n              class=\"ir-br-input-none\"\n              value={this.s_service?.price?.toString()}\n              zod={ExtraServiceSchema.pick({ price: true })}\n              aria-label={locales.entries.Lcz_Price}\n              wrapKey=\"price\"\n              aria-describedby=\"service price\"\n              autoValidate={false}\n              data-state={this.error && !this.validatePrice() ? 'error' : ''}\n              onTextChange={e => this.updateService({ price: parseFloat(e.detail) })}\n            ></ir-price-input>\n            <ir-price-input\n              autoValidate={false}\n              label={locales.entries.Lcz_Cost}\n              labelStyle=\"rounded-0 border-left-0\"\n              currency={this.booking.currency.symbol}\n              // class=\"ir-bl-lbl-none ir-bl-none\"\n              value={this.s_service?.cost?.toString()}\n              zod={ExtraServiceSchema.pick({ cost: true })}\n              onTextChange={e => this.updateService({ cost: parseFloat(e.detail) })}\n              wrapKey=\"cost\"\n              aria-label=\"Cost\"\n              aria-describedby=\"service cost\"\n            ></ir-price-input>\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClick={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`flex-fill`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'flex-fill'}\n            btn_type=\"submit\"\n            isLoading={isRequestPending('/Do_Booking_Extra_Service')}\n            text={locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { Component, Fragment, Host, Prop, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-extra-services',\n  styleUrl: 'ir-extra-services.css',\n  scoped: true,\n})\nexport class IrExtraServices {\n  @Prop() booking: Pick<Booking, 'currency' | 'extra_services' | 'booking_nbr'>;\n\n  render() {\n    return (\n      <Host class={'card p-0 '}>\n        {this.booking.extra_services?.map((service, index) => (\n          <Fragment>\n            <ir-extra-service\n              bookingNumber={this.booking.booking_nbr}\n              currencySymbol={this.booking.currency.symbol}\n              key={service.booking_system_id}\n              service={service}\n            ></ir-extra-service>\n            {index !== this.booking.extra_services.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />}\n          </Fragment>\n        ))}\n      </Host>\n    );\n  }\n}\n",".input-group-text {\n  min-width: 10rem;\n  text-align: left;\n}\n.mobilePrefixSelect {\n  border-right-width: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.mobilePrefixInput {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n\n/* custome checkbox */\n.check-container {\n  position: relative;\n  /* padding-left: 30px; */\n  cursor: pointer;\n  font-size: 14px;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  display: flex;\n  align-items: center;\n}\n.check-container input {\n  position: relative;\n  opacity: 0;\n  cursor: pointer;\n  height: 0;\n  width: 0;\n}\n.check-container .checkmark {\n  position: relative;\n  top: 0;\n  left: 0;\n  height: 20px;\n  width: 20px;\n  border: 1px solid #cacfe7;\n  border-radius: 4px;\n  transition: all 0.3s ease;\n}\n.check-container input:checked ~ .checkmark {\n  background-color: #1e9ff2;\n  border-color: #1e9ff2;\n}\n.checkmark:after {\n  content: '';\n  position: absolute;\n  display: none;\n}\n.check-container input:checked ~ .checkmark:after {\n  display: block;\n}\n.check-label {\n  margin-left: 10px !important;\n}\n.check-container .checkmark:after {\n  left: 6px;\n  top: 3px;\n  width: 6px;\n  height: 10px;\n  border: solid white;\n  border-width: 0 2px 2px 0;\n  -webkit-transform: rotate(45deg);\n  -ms-transform: rotate(45deg);\n  transform: rotate(45deg);\n}\n.ir-card-header {\n  width: 100%;\n  border-bottom: 1px solid #e4e5ec;\n}\n.close-icon {\n  margin: 0;\n}\n.border-theme {\n  border: 1px solid #cacfe7;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, State, h, Prop, EventEmitter, Event, Watch, Fragment } from '@stencil/core';\nimport { Guest } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry } from '@/components';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport Token from '@/models/Token';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { IToast } from '@components/ui/ir-toast/toast';\n\n@Component({\n  tag: 'ir-guest-info',\n  styleUrls: ['ir-guest-info.css', '../../common/sheet.css'],\n  scoped: true,\n})\nexport class GuestInfo {\n  @Prop() language: string;\n  @Prop() headerShown: boolean;\n  @Prop() email: string;\n  @Prop() booking_nbr: string;\n  @Prop() ticket: string;\n  @Prop() isInSideBar: boolean;\n\n  @State() countries: ICountry[];\n  // @State() submit: boolean = false;\n  @State() guest: Guest | null = null;\n  @State() isLoading: boolean = true;\n  @State() autoValidate = false;\n\n  @Event() closeSideBar: EventEmitter<null>;\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\n  @Event() toast: EventEmitter<IToast>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private token: Token = new Token();\n\n  async componentWillLoad() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n    if (!!this.token.getToken()) this.init();\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.init();\n  }\n\n  async init() {\n    try {\n      console.log('first');\n      this.isLoading = true;\n      const [guest, countries, fetchedLocales] = await Promise.all([\n        this.bookingService.fetchGuest(this.email),\n        this.bookingService.getCountries(this.language),\n        !locales || !locales.entries || Object.keys(locales.entries).length === 0 ? this.roomService.fetchLanguage(this.language) : Promise.resolve(null), // Skip fetching if locales are already set\n      ]);\n\n      // Set the fetched locales if they were fetched\n      if (fetchedLocales) {\n        locales.entries = fetchedLocales.entries;\n        locales.direction = fetchedLocales.direction;\n      }\n\n      // Assign the fetched guest and countries\n      this.countries = countries;\n      this.guest = { ...guest, mobile: guest.mobile_without_prefix };\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private handleInputChange(params: Partial<Guest>) {\n    this.guest = { ...this.guest, ...params };\n  }\n\n  private async editGuest() {\n    try {\n      this.autoValidate = true;\n\n      await this.bookingService.editExposedGuest(this.guest, this.booking_nbr ?? null);\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: 'Saved Successfully',\n        position: 'top-right',\n      });\n      this.closeSideBar.emit(null);\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    if (this.isLoading && this.isInSideBar) {\n      <div class={'loading-container'}>\n        <ir-spinner></ir-spinner>\n      </div>;\n    }\n    if (this.isLoading) {\n      return null;\n    }\n    return (\n      <form\n        class={'p-0 sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.editGuest();\n        }}\n      >\n        {!this.isInSideBar && [<ir-toast></ir-toast>, <ir-interceptor></ir-interceptor>]}\n        {this.headerShown && <ir-title class=\"px-1 sheet-header\" displayContext=\"sidebar\" label={locales.entries.Lcz_GuestDetails}></ir-title>}\n        <div class={this.isInSideBar ? 'sheet-body' : 'card-content collapse show '}>\n          <div class={this.headerShown ? 'card-body px-1 pt-0' : 'pt-0'}>\n            <ir-input-text\n              autoValidate={this.autoValidate}\n              label={locales.entries?.Lcz_FirstName}\n              name=\"firstName\"\n              // submitted={this.submit}\n              value={this.guest?.first_name}\n              required\n              onTextChange={e => this.handleInputChange({ first_name: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              autoValidate={this.autoValidate}\n              label={locales.entries?.Lcz_LastName}\n              name=\"lastName\"\n              // submitted={this.submit}\n              value={this.guest?.last_name}\n              required\n              onTextChange={e => this.handleInputChange({ last_name: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              label={locales.entries?.Lcz_Email}\n              name=\"email\"\n              // submitted={this.submit}\n              value={this.guest?.email}\n              required\n              onTextChange={e => this.handleInputChange({ email: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              label={locales.entries?.Lcz_AlternativeEmail}\n              name=\"altEmail\"\n              value={this.guest?.alternative_email}\n              onTextChange={e => this.handleInputChange({ alternative_email: e.detail })}\n            ></ir-input-text>\n            {/* <ir-input-text label=\"Password\" placeholder=\"\" name=\"password\" submited={this.submit} type=\"password\" value={this.Model.password} required></ir-input-text> */}\n            {/* <ir-select\n              selectContainerStyle=\"mb-1\"\n              required\n              name=\"country\"\n              submited={this.submit}\n              label={locales.entries.Lcz_Country}\n              selectedValue={this.guest?.country_id?.toString() ?? ''}\n              data={this.countries?.map(item => {\n                return {\n                  value: item.id.toString(),\n                  text: item.name,\n                };\n              })}\n              firstOption={'...'}\n              onSelectChange={e => this.handleInputChange({ country_id: e.detail })}\n            ></ir-select> */}\n            <ir-country-picker\n              // error={this.submit && !this.guest.country_id}\n              country={this.countries.find(c => c.id === this.guest.country_id)}\n              label={locales.entries?.Lcz_Country}\n              onCountryChange={e => this.handleInputChange({ country_id: e.detail.id })}\n              countries={this.countries}\n            ></ir-country-picker>\n\n            <ir-phone-input\n              onTextChange={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                const { mobile, phone_prefix } = e.detail;\n                if (mobile !== this.guest.mobile) {\n                  this.handleInputChange({ mobile });\n                }\n                if (phone_prefix !== this.guest.country_phone_prefix) this.handleInputChange({ country_phone_prefix: phone_prefix });\n              }}\n              phone_prefix={this.guest.country_phone_prefix}\n              value={this.guest.mobile}\n              language={this.language}\n              label={locales.entries?.Lcz_MobilePhone}\n              countries={this.countries}\n            />\n            <div class=\"mb-2\">\n              <ir-textarea\n                variant=\"prepend\"\n                onTextChange={e => this.handleInputChange({ notes: e.detail })}\n                value={this.guest?.notes}\n                label={locales.entries?.Lcz_PrivateNote}\n              ></ir-textarea>\n            </div>\n            <div class={'p-0 m-0'}>\n              <label class={`check-container m-0 p-0`}>\n                <input\n                  class={'m-0 p-0'}\n                  type=\"checkbox\"\n                  name=\"newsletter\"\n                  checked={this.guest.subscribe_to_news_letter}\n                  onInput={e => this.handleInputChange({ subscribe_to_news_letter: (e.target as HTMLInputElement).checked })}\n                />\n                <span class=\"checkmark m-0 p-0\"></span>\n                <span class={'m-0 p-0  check-label'}>{locales.entries.Lcz_Newsletter}</span>\n              </label>\n              {!this.isInSideBar && (\n                <Fragment>\n                  <hr />\n                  <ir-button\n                    btn_styles=\"d-flex align-items-center justify-content-center\"\n                    text={locales.entries.Lcz_Save}\n                    onClickHandler={this.editGuest.bind(this)}\n                    isLoading={isRequestPending('/Edit_Exposed_Guest')}\n                    color=\"btn-primary\"\n                  ></ir-button>\n                </Fragment>\n              )}\n            </div>\n          </div>\n        </div>\n        {this.isInSideBar && (\n          <div class={'sheet-footer'}>\n            <ir-button\n              data-testid=\"cancel\"\n              onClickHandler={() => this.closeSideBar.emit(null)}\n              class=\"flex-fill m-0 p-0\"\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\n              btn_color=\"secondary\"\n              text={locales.entries.Lcz_Cancel}\n            ></ir-button>\n            <ir-button\n              data-testid=\"save\"\n              isLoading={isRequestPending('/Edit_Exposed_Guest')}\n              btn_disabled={this.isLoading}\n              class=\"flex-fill m-0\"\n              btn_type=\"submit\"\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\n              text={locales.entries.Lcz_Save}\n            ></ir-button>\n          </div>\n        )}\n      </form>\n    );\n  }\n}\n",":host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n\n.sm-margin-right {\n  margin-right: 5px !important;\n  background: #000;\n}\n.action_icons {\n  width: 60px;\n}\n.w-60 {\n  width: 100px;\n  padding: 0 5px;\n}\n.payments-height {\n  height: 30px;\n}\n.payment_date {\n  width: 100px;\n}\n.iframeHeight {\n  height: max-content;\n  height: 22.5rem;\n}\n.designation {\n  width: 120px;\n}\n.total-cost-container {\n  background: #7cbebe;\n  color: white;\n  padding: 0.5rem;\n  border-radius: 5px;\n}\n","import { Component, h, Prop, State, Event, EventEmitter, Listen } from '@stencil/core';\nimport { Booking, IPayment } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { PaymentService, IPaymentAction } from '@/services/payment.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { Payment, PaymentEntries, PaymentSidebarEvent } from '../types';\nimport moment from 'moment';\nimport { formatAmount } from '@/utils/utils';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  styleUrl: 'ir-payment-details.css',\n  tag: 'ir-payment-details',\n  scoped: true,\n})\nexport class IrPaymentDetails {\n  @Prop({ mutable: true }) booking: Booking;\n  @Prop() paymentActions: IPaymentAction[];\n  @Prop() propertyId: number;\n  @Prop() paymentEntries: PaymentEntries;\n\n  @State() confirmModal: boolean = false;\n  @State() toBeDeletedItem: IPayment | null = null;\n  @State() modalMode: 'delete' | 'save' | null = null;\n\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true }) resetExposedCancellationDueAmount: EventEmitter<null>;\n  @Event({ bubbles: true }) toast: EventEmitter<IToast>;\n  @Event({ bubbles: true }) openSidebar: EventEmitter<PaymentSidebarEvent>;\n\n  private paymentService = new PaymentService();\n  private bookingService = new BookingService();\n\n  @Listen('generatePayment')\n  handlePaymentGeneration(e: CustomEvent) {\n    const value = e.detail;\n    const paymentType = this.paymentEntries?.types?.find(p => p.CODE_NAME === (this.booking.status.code === '003' ? value.pay_type_code : '001'));\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment: {\n          ...value,\n          date: moment().format('YYYY-MM-DD'),\n          id: -1,\n          amount: value.amount,\n          payment_type: paymentType\n            ? {\n                code: paymentType.CODE_NAME,\n                description: paymentType.CODE_VALUE_EN,\n                operation: paymentType.NOTES,\n              }\n            : null,\n          designation: paymentType?.CODE_VALUE_EN ?? null,\n        },\n        mode: 'payment-action',\n      },\n    });\n  }\n\n  private handleAddPayment = (props?: { type: 'cancellation-penalty' | 'refund'; amount: number }) => {\n    let payment: Payment = {\n      id: -1,\n      date: moment().format('YYYY-MM-DD'),\n      amount: null,\n      currency: calendar_data.currency,\n      designation: null,\n      reference: null,\n    };\n    if (props) {\n      const { amount, type } = props;\n      const cashMethod = this.paymentEntries.methods.find(pt => pt.CODE_NAME === '001');\n      const payment_method = {\n        code: cashMethod.CODE_NAME,\n        description: cashMethod.CODE_VALUE_EN,\n        operation: cashMethod.NOTES,\n      };\n      const paymentType = this.paymentEntries.types.find(pt => pt.CODE_NAME === (type === 'cancellation-penalty' ? '001' : '010'));\n      payment = {\n        ...payment,\n        amount: amount,\n        designation: paymentType.CODE_VALUE_EN,\n        payment_type: {\n          code: paymentType.CODE_NAME,\n          description: paymentType.CODE_VALUE_EN,\n          operation: paymentType.NOTES,\n        },\n        payment_method: type === 'refund' ? undefined : payment_method,\n      };\n      this.openSidebar.emit({\n        type: 'payment-folio',\n        payload: {\n          payment,\n          mode: 'payment-action',\n        },\n      });\n      return;\n    }\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment,\n        mode: 'new',\n      },\n    });\n  };\n\n  private handleEditPayment = (payment: IPayment) => {\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: { payment, mode: 'edit' },\n    });\n  };\n\n  private handleDeletePayment = (payment: IPayment) => {\n    this.modalMode = 'delete';\n    this.toBeDeletedItem = payment;\n    this.openModal();\n  };\n\n  private async cancelPayment() {\n    try {\n      await this.paymentService.CancelPayment(this.toBeDeletedItem.id);\n      const newPaymentArray = this.booking.financial.payments.filter((item: IPayment) => item.id !== this.toBeDeletedItem.id);\n\n      this.booking = {\n        ...this.booking,\n        financial: { ...this.booking.financial, payments: newPaymentArray },\n      };\n\n      this.confirmModal = false;\n      this.resetBookingEvt.emit(null);\n      this.resetExposedCancellationDueAmount.emit(null);\n      this.toBeDeletedItem = null;\n      this.modalMode = null;\n    } catch (error) {\n      console.error('Error canceling payment:', error);\n      this.toast.emit({\n        type: 'error',\n        title: 'Error',\n        description: 'Failed to cancel payment. Please try again.',\n        position: 'top-right',\n      });\n    }\n  }\n\n  private handleConfirmModal = async (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n\n    if (this.modalMode === 'delete') {\n      await this.cancelPayment();\n    }\n  };\n\n  private handleCancelModal = (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalMode = null;\n    this.toBeDeletedItem = null;\n  };\n\n  private openModal() {\n    const modal: any = document.querySelector('.delete-record-modal');\n    modal?.openModal();\n  }\n\n  private hasValidFinancialData(): boolean {\n    return Boolean(this.booking?.financial);\n  }\n\n  // private shouldShowPaymentActions(): boolean {\n  //   return Boolean(this.paymentActions?.filter(pa => pa.amount !== 0).length > 0 && this.booking.is_direct);\n  // }\n  private shouldShowRefundButton(): boolean {\n    if (!this.booking.is_direct) {\n      return false;\n    }\n    if (this.booking.financial.due_amount === 0) {\n      return false;\n    }\n    if (this.booking.financial.cancelation_penality_as_if_today === 0) {\n      return false;\n    }\n    if (this.booking.is_requested_to_cancel || ['003', '004'].includes(this.booking.status.code)) {\n      return this.booking.financial.cancelation_penality_as_if_today < 0;\n    }\n    return false;\n  }\n\n  private shouldCancellationButton(): boolean {\n    if (!this.booking.is_direct) {\n      return false;\n    }\n    if (this.booking.financial.due_amount === 0) {\n      return false;\n    }\n    if (this.booking.financial.cancelation_penality_as_if_today === 0) {\n      return false;\n    }\n    if (['003', '004'].includes(this.booking.status.code) && this.booking.financial.cancelation_penality_as_if_today > 0) {\n      return true;\n    }\n    return false;\n  }\n\n  render() {\n    if (!this.hasValidFinancialData()) {\n      return null;\n    }\n\n    const { financial, currency } = this.booking;\n\n    return [\n      <div class=\"card p-1\">\n        <ir-payment-summary\n          isBookingCancelled={['003', '004'].includes(this.booking.status.code)}\n          totalCost={financial.gross_cost}\n          balance={financial.due_amount}\n          collected={this.booking.financial.collected + this.booking.financial.refunds}\n          currency={currency}\n        />\n        <ir-booking-guarantee booking={this.booking} bookingService={this.bookingService} />\n        {/* {this.shouldShowPaymentActions() && <ir-payment-actions paymentAction={this.paymentActions} booking={this.booking} />} */}\n        {!['003', '004'].includes(this.booking.status.code) && this.booking.is_direct && (\n          <ir-applicable-policies propertyId={this.propertyId} booking={this.booking}></ir-applicable-policies>\n        )}\n\n        {this.shouldShowRefundButton() && (\n          <div class=\"d-flex mt-1\">\n            <ir-button\n              btn_color=\"outline\"\n              text={`Refund ${formatAmount(currency.symbol, Math.abs(this.booking.financial.cancelation_penality_as_if_today))}`}\n              size=\"sm\"\n              onClickHandler={() => {\n                this.handleAddPayment({ type: 'refund', amount: Math.abs(this.booking.financial.cancelation_penality_as_if_today) });\n              }}\n            ></ir-button>\n          </div>\n        )}\n        {this.shouldCancellationButton() && (\n          <div class=\"d-flex mt-1\">\n            <ir-button\n              btn_color=\"outline\"\n              text={`Charge cancellation penalty ${formatAmount(currency.symbol, this.booking.financial.cancelation_penality_as_if_today)}`}\n              size=\"sm\"\n              onClickHandler={() => {\n                this.handleAddPayment({ type: 'cancellation-penalty', amount: Math.abs(this.booking.financial.cancelation_penality_as_if_today) });\n              }}\n            ></ir-button>\n          </div>\n        )}\n      </div>,\n      <ir-payments-folio\n        payments={financial.payments || []}\n        onAddPayment={() => this.handleAddPayment()}\n        onEditPayment={e => this.handleEditPayment(e.detail)}\n        onDeletePayment={e => this.handleDeletePayment(e.detail)}\n      />,\n      <ir-modal\n        item={this.toBeDeletedItem}\n        class=\"delete-record-modal\"\n        modalTitle={locales.entries.Lcz_Confirmation}\n        modalBody={this.modalMode === 'delete' ? locales.entries.Lcz_IfDeletedPermantlyLost : locales.entries.Lcz_EnteringAmountGreaterThanDue}\n        iconAvailable={true}\n        icon=\"ft-alert-triangle danger h1\"\n        leftBtnText={locales.entries.Lcz_Cancel}\n        rightBtnText={this.modalMode === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\n        leftBtnColor=\"secondary\"\n        rightBtnColor={this.modalMode === 'delete' ? 'danger' : 'primary'}\n        onConfirmModal={this.handleConfirmModal}\n        onCancelModal={this.handleCancelModal}\n      />,\n    ];\n  }\n}\n",":host {\n  display: block;\n  --payment-type-badge-bg: #ff4961;\n}\n.payment-type-badge {\n  background: var(--payment-type-badge-bg);\n  color: white;\n  padding: 0.2rem 0.3rem !important;\n  font-size: 12px;\n  border-radius: 4px;\n  margin: 0;\n  text-transform: capitalize;\n}\n.credit-badge {\n  --payment-type-badge-bg: #629a4c;\n}\n.debit-badge {\n  --payment-type-badge-bg: #ff4961;\n}\n.dropdown-item-payment {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  box-sizing: border-box;\n  justify-content: space-between;\n}\n\n.input-group-text {\n  border-color: #cacfe7 !important;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport { Component, Event, EventEmitter, Fragment, Prop, State, Watch, h } from '@stencil/core';\nimport moment from 'moment';\nimport { z, ZodError } from 'zod';\nimport { IEntries } from '@/models/IBooking';\nimport { PaymentService } from '@/services/payment.service';\nimport { FolioEntryMode, Payment, PaymentEntries } from '../../types';\nimport { buildPaymentTypes } from '@/services/booking.service';\nimport { PAYMENT_TYPES_WITH_METHOD } from '../global.variables';\n@Component({\n  tag: 'ir-payment-folio',\n  styleUrls: ['ir-payment-folio.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrPaymentFolio {\n  @Prop() paymentEntries: PaymentEntries;\n  @Prop() bookingNumber: string;\n  @Prop() payment: Payment = {\n    date: moment().format('YYYY-MM-DD'),\n    amount: 0,\n    designation: undefined,\n    currency: null,\n    reference: null,\n    id: -1,\n  };\n\n  @Prop() mode: FolioEntryMode;\n\n  @State() isLoading: boolean;\n  @State() errors: any;\n  @State() autoValidate: boolean = false;\n  @State() folioData: Payment;\n  @State() _paymentTypes: Record<string, IEntries[]> = {};\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() resetExposedCancellationDueAmount: EventEmitter<null>;\n\n  private folioSchema: any;\n  private paymentService = new PaymentService();\n\n  componentWillLoad() {\n    this.folioSchema = z.object({\n      date: z\n        .string()\n        .regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n        .refine(\n          dateStr => {\n            const date = moment(dateStr, 'YYYY-MM-DD', true);\n            return date.isValid();\n          },\n          { message: `Invalid date` },\n        ),\n      amount: z.coerce.number().refine(a => a >= 0),\n      reference: z.string().optional().nullable(),\n      // designation: z.string().min(1),\n      payment_type: z.object({\n        code: z.string().min(3).max(4),\n        description: z.string().min(1),\n        operation: z.union([z.literal('CR'), z.literal('DB')]),\n      }),\n      payment_method: z.object({\n        code: z.string().min(3).max(4),\n        description: z.string().min(1),\n      }),\n    });\n    if (this.payment) {\n      this.folioData = { ...this.payment };\n    }\n    this.getPaymentTypes();\n  }\n\n  @Watch('payment')\n  handlePaymentChange(newValue: Payment, oldValue: Payment) {\n    if (newValue !== oldValue && newValue) {\n      this.folioData = { ...newValue };\n      this.getPaymentTypes();\n    }\n  }\n  @Watch('paymentTypes')\n  handlePaymentTypesChange(newValue: IEntries[], oldValue: IEntries[]) {\n    if (newValue !== oldValue && newValue) {\n      this.getPaymentTypes();\n    }\n  }\n\n  private updateFolioData(params: Partial<Payment>): void {\n    this.folioData = { ...this.folioData, ...params };\n  }\n\n  private async savePayment() {\n    try {\n      this.isLoading = true;\n      this.autoValidate = true;\n      if (this.errors) {\n        this.errors = null;\n      }\n      this.folioSchema.parse(this.folioData ?? {});\n      await this.paymentService.AddPayment(\n        {\n          ...this.folioData,\n          currency: calendar_data.currency,\n          reference: this.folioData.reference ?? '',\n          designation: this.folioData.payment_type?.description || '',\n        },\n        this.bookingNumber,\n      );\n      this.resetBookingEvt.emit(null);\n      this.resetExposedCancellationDueAmount.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      const err = {};\n      if (error instanceof ZodError) {\n        error.issues.forEach(e => {\n          err[e.path[0]] = true;\n        });\n      }\n      console.error(error);\n      this.errors = err;\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private handleDropdownChange(e: CustomEvent<string | number>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const value = e.detail.toString();\n    console.log(value);\n    this.updateFolioData({ designation: value });\n    if (!e.detail) {\n      this.updateFolioData({\n        payment_type: null,\n      });\n    } else {\n      const payment_type = this.paymentEntries?.types.find(pt => pt.CODE_NAME === value);\n      if (!payment_type) {\n        console.warn(`Invalid payment type ${e.detail}`);\n        this.updateFolioData({\n          payment_type: null,\n        });\n        return;\n      }\n\n      this.updateFolioData({\n        payment_type: {\n          code: payment_type.CODE_NAME,\n          description: payment_type.CODE_VALUE_EN,\n          operation: payment_type.NOTES,\n        },\n        payment_method: PAYMENT_TYPES_WITH_METHOD.includes(payment_type.CODE_NAME)\n          ? undefined\n          : {\n              code: this.paymentEntries.methods[0].CODE_NAME,\n              description: this.paymentEntries.methods[0].CODE_VALUE_EN,\n              operation: this.paymentEntries.methods[0].NOTES,\n            },\n      });\n    }\n  }\n  private handlePaymentMethodDropdownChange(e: CustomEvent<string | number>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const value = e.detail.toString();\n    const payment_method = this.paymentEntries?.methods.find(pt => pt.CODE_NAME === value);\n    if (!payment_method) {\n      console.warn(`Invalid payment method ${e.detail}`);\n      this.updateFolioData({\n        payment_type: null,\n      });\n      return;\n    }\n    this.updateFolioData({\n      payment_method: {\n        code: payment_method.CODE_NAME,\n        description: payment_method.CODE_VALUE_EN,\n        operation: payment_method.NOTES,\n      },\n    });\n  }\n\n  private async getPaymentTypes() {\n    const rec = buildPaymentTypes(this.paymentEntries);\n    if (this.mode === 'payment-action' && this.payment.payment_type?.code === '001') {\n      const { PAYMENTS, CANCELLATION } = rec;\n      return (this._paymentTypes = {\n        PAYMENTS,\n        CANCELLATION,\n      });\n    }\n    this._paymentTypes = rec;\n  }\n\n  private renderDropdownItems() {\n    return Object.values(this._paymentTypes).map((p, idx) => (\n      <Fragment>\n        {p.map(pt => (\n          <ir-dropdown-item value={pt.CODE_NAME} class=\"dropdown-item-payment\">\n            <span>{pt.CODE_VALUE_EN}</span>\n            <span class={`payment-type-badge ${pt.NOTES === 'CR' ? 'credit-badge' : 'debit-badge'}`}>{pt.NOTES === 'CR' ? 'credit' : 'debit'}</span>\n          </ir-dropdown-item>\n        ))}\n        {idx !== Object.values(this._paymentTypes).length - 1 && <div class=\"dropdown-divider\"></div>}\n      </Fragment>\n    ));\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          this.savePayment();\n        }}\n      >\n        <ir-title\n          class=\"px-1 sheet-header\"\n          onCloseSideBar={() => this.closeModal.emit(null)}\n          label={this.mode === 'edit' ? 'Edit Folio Entry' : 'New Folio Entry'}\n          displayContext=\"sidebar\"\n        ></ir-title>\n        <section class={'px-1 sheet-body d-flex flex-column'} style={{ gap: '1rem' }}>\n          <div class={'d-flex w-fill'} style={{ gap: '0.5rem' }}>\n            {/*Date Picker */}\n            <div class=\"form-group  mb-0 flex-grow-1\">\n              <div class=\"input-group row m-0 flex-grow-1\">\n                <div class={`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`}>\n                  <label class={`input-group-text flex-grow-1 text-dark border-theme `}>Date</label>\n                </div>\n                <div class=\"form-control  form-control-md col-10 flex-grow-1 d-flex align-items-center px-0 mx-0\" style={{ border: '0' }}>\n                  <style>\n                    {`.ir-date-picker-trigger{\n                    width:100%;}`}\n                  </style>\n                  <ir-date-picker\n                    data-testid=\"pickup_date\"\n                    date={this.folioData?.date}\n                    class=\"w-100\"\n                    emitEmptyDate={true}\n                    maxDate={moment().format('YYYY-MM-DD')}\n                    aria-invalid={this.errors?.date && !this.folioData?.date ? 'true' : 'false'}\n                    onDateChanged={evt => {\n                      this.updateFolioData({ date: evt.detail.start?.format('YYYY-MM-DD') });\n                    }}\n                  >\n                    <input\n                      type=\"text\"\n                      slot=\"trigger\"\n                      value={this.folioData?.date ? moment(this.folioData?.date).format('MMM DD, YYYY') : null}\n                      class={`form-control w-100 input-sm ${this.errors?.date && !this.folioData?.date ? 'border-danger' : ''} text-left`}\n                      style={{ borderTopLeftRadius: '0', borderBottomLeftRadius: '0', width: '100%' }}\n                    ></input>\n                  </ir-date-picker>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div>\n            <ir-dropdown value={this.folioData?.payment_type?.code} disabled={this.mode === 'payment-action'} onOptionChange={this.handleDropdownChange.bind(this)}>\n              <div slot=\"trigger\" class={'input-group row m-0 '}>\n                <div class={`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`}>\n                  <label class={`input-group-text flex-grow-1 text-dark  border-theme`}>Transaction type</label>\n                </div>\n                <button\n                  type=\"button\"\n                  disabled={this.mode === 'payment-action'}\n                  class={`form-control  d-flex align-items-center cursor-pointer ${this.errors?.payment_type && !this.folioData?.payment_type?.code ? 'border-danger' : ''}`}\n                >\n                  {this.folioData?.payment_type ? <span>{this.folioData.payment_type?.description}</span> : <span>Select...</span>}\n                </button>\n              </div>\n              <ir-dropdown-item value=\"\">Select...</ir-dropdown-item>\n              {this.renderDropdownItems()}\n            </ir-dropdown>\n          </div>\n          {PAYMENT_TYPES_WITH_METHOD.includes(this.folioData?.payment_type?.code) && (\n            <div>\n              <ir-dropdown value={this.folioData?.payment_method?.code} onOptionChange={this.handlePaymentMethodDropdownChange.bind(this)}>\n                <button\n                  slot=\"trigger\"\n                  type=\"button\"\n                  class={`form-control d-flex align-items-center cursor-pointer ${this.errors?.payment_method && !this.folioData?.payment_method?.code ? 'border-danger' : ''}`}\n                >\n                  {this.folioData?.payment_method ? (\n                    <span>{this.folioData.payment_method?.description}</span>\n                  ) : (\n                    <span>Select {this.folioData?.payment_type?.code === '001' ? 'payment' : 'refund'} method...</span>\n                  )}\n                </button>\n\n                <ir-dropdown-item value=\"\">Select {this.folioData.payment_type?.code === '001' ? 'payment' : 'refund'} method...</ir-dropdown-item>\n                {this.paymentEntries?.methods?.map(pt => {\n                  return (\n                    <ir-dropdown-item value={pt.CODE_NAME} class=\"dropdown-item-payment\">\n                      <span>{pt.CODE_VALUE_EN}</span>\n                    </ir-dropdown-item>\n                  );\n                })}\n              </ir-dropdown>\n            </div>\n          )}\n          <div>\n            <ir-price-input\n              containerClassname=\"row\"\n              labelContainerClassname=\"col-4 col-md-3 p-0 text-dark border-0\"\n              minValue={0}\n              autoValidate={this.autoValidate}\n              zod={this.folioSchema.pick({ amount: true })}\n              wrapKey=\"amount\"\n              label=\"Amount\"\n              labelStyle={'flex-grow-1 text-dark  border-theme'}\n              error={this.errors?.amount && !this.folioData?.amount}\n              value={this.folioData?.amount?.toString()}\n              currency={calendar_data.currency.symbol}\n              onTextChange={e => this.updateFolioData({ amount: Number(e.detail) })}\n            ></ir-price-input>\n          </div>\n          <div>\n            <ir-input-text\n              value={this.folioData?.reference}\n              error={this.errors?.reference_number}\n              autoValidate={this.autoValidate}\n              zod={this.folioSchema.pick({ reference: true })}\n              label=\"Reference\"\n              maxLength={50}\n              inputContainerStyle={{\n                margin: '0',\n              }}\n              onTextChange={e => this.updateFolioData({ reference: e.detail })}\n              labelWidth={3}\n              labelContainerClassname={'col-4 col-md-3'}\n            ></ir-input-text>\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button onClick={() => this.closeModal.emit(null)} btn_styles=\"justify-content-center\" class={`flex-fill`} text={'Cancel'} btn_color=\"secondary\"></ir-button>\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'flex-fill'}\n            isLoading={this.isLoading}\n            text={'Save'}\n            btn_color=\"primary\"\n            btn_type=\"submit\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n","/* .payment-item {\n  position: relative;\n  width: 100%;\n  display: flex;\n  padding: 0.5rem;\n  align-items: center;\n  min-height: 3rem;\n  gap: 1rem;\n  box-sizing: border-box;\n}\n.payment-item:hover {\n  background: #f4f5fa;\n}\n.payment-item:hover .payment-actions {\n  display: flex;\n}\n\n.payment-item p {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n\n.payment-item .payment-actions {\n  display: none;\n  background: #f4f5fa;\n  gap: 0.5rem;\n  justify-content: flex-end;\n  align-items: center;\n}\n.payment-body {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  flex: 1 1 0%;\n}\n\n.payment-fields {\n  display: flex;\n  flex-direction: column;\n}\n\n.payment-amount {\n  font-weight: 700;\n  white-space: nowrap;\n}\n\n\n.payment-reference {\n  font-size: 12px;\n}\n.payment-toolbar {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n@media (min-width: 768px) {\n  .payment-fields {\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n  }\n} */\n.payment-item__payment-item {\n  display: flex;\n  flex-direction: column;\n  /* gap: 0.25rem; */\n  padding: 0.25rem 0.5rem;\n  min-height: 2.5rem;\n}\n.payment-item__payment-item p {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n.payment-item__payment-body {\n  display: flex;\n  flex-direction: column;\n}\n.payment-item__payment-fields {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.payment-item__payment-body .payment-item__payment-reference,\n.payment-item__payment-body .payment-item__payment-description {\n  display: none;\n}\n.payment-item__payment-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.payment-item__payment-toolbar .payment-item__payment-amount {\n  display: none;\n}\n.payment-item__action-button {\n  cursor: pointer;\n}\n.payment-item__payment-amount {\n  font-weight: 700;\n  white-space: nowrap;\n}\n.payment-item__payment-amount.is-credit {\n  color: #629a4c;\n}\n.payment-item__payment-amount.is-debit {\n  color: #ff4961;\n}\n.payment-item__payment-reference {\n  font-size: 12px;\n}\n/*md*/\n@media (min-width: 640px) {\n  .payment-item__payment-item {\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .payment-item__payment-item:hover {\n    background: #f4f5fa;\n  }\n  .payment-item__payment-item .payment-item__payment-actions {\n    display: inline-flex;\n  }\n  .payment-item__payment-body .payment-item__payment-reference,\n  .payment-item__payment-body .payment-item__payment-description,\n  .payment-item__payment-item .payment-item__payment-amount {\n    display: inline-flex;\n  }\n  .payment-item__payment-fields .payment-item__payment-amount,\n  .payment-item__payment-toolbar .payment-item__payment-description,\n  .payment-item__payment-item .payment-item__payment-reference,\n  .payment-item__payment-actions {\n    display: none;\n  }\n  .payment-item__payment-description {\n    padding: 0 0.5rem !important;\n  }\n  .payment-item__payment-body .payment-item__payment-reference {\n    display: inline-flex;\n    align-items: center;\n  }\n  .payment-item__payment-body {\n    flex: 1 1 0%;\n    justify-content: flex-start;\n    /* gap: 0.5rem; */\n  }\n  .payment-item__payment-fields {\n    justify-content: flex-start;\n    gap: 0.5rem;\n  }\n  .payment-item__payment-toolbar {\n    gap: 0.5rem;\n    align-items: center;\n  }\n}\n","import { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Component, Event, EventEmitter, Prop, h } from '@stencil/core';\nimport { IPayment } from '@/models/booking.dto';\nimport { formatAmount } from '@/utils/utils';\nimport { PAYMENT_TYPES_WITH_METHOD } from '../global.variables';\nimport moment from 'moment';\n\n@Component({\n  tag: 'ir-payment-item',\n  styleUrl: 'ir-payment-item.css',\n  scoped: true,\n})\nexport class IrPaymentItem {\n  @Prop() payment: IPayment;\n\n  @Event() editPayment: EventEmitter<IPayment>;\n  @Event() deletePayment: EventEmitter<IPayment>;\n\n  render() {\n    const isCredit = this.payment.payment_type.operation === 'CR';\n\n    const paymentDescription =\n      (PAYMENT_TYPES_WITH_METHOD.includes(this.payment.payment_type?.code)\n        ? `${this.payment.payment_type?.description}: ${this.payment.payment_method.description}`\n        : this.payment.payment_type.description) ?? this.payment.designation;\n    return (\n      <div class=\"payment-item__payment-item\">\n        <div class=\"payment-item__payment-body\" part=\"payment-body\">\n          <div class=\"payment-item__payment-fields\" part=\"payment-fields\">\n            <p class=\"payment-item__payment-date\">{moment(this.payment.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</p>\n            <p class={`payment-item__payment-amount ${isCredit ? 'is-credit' : 'is-debit'}`}>{formatAmount(this.payment.currency.symbol, this.payment.amount)}</p>\n            <p class=\"payment-item__payment-description\">{paymentDescription}</p>\n          </div>\n          {this.payment.reference && <p class=\"payment-item__payment-reference\">{this.payment?.reference}</p>}\n        </div>\n        <div class=\"payment-item__payment-toolbar\">\n          <p class={`payment-item__payment-amount ${isCredit ? 'is-credit' : 'is-debit'}`}>{formatAmount(this.payment.currency.symbol, this.payment.amount)}</p>\n          <p class=\"payment-item__payment-description\">{paymentDescription}</p>\n          <div class=\"payment-item__payment-actions\">\n            <div class=\"d-flex align-items-center\">\n              <ir-popover trigger=\"hover\" content={`User: ${this.payment.time_stamp.user}`}>\n                <ir-button variant=\"icon\" style={{ 'color': colorVariants.secondary['--icon-button-color'], '--icon-size': '1.1rem' }} icon_name=\"user\"></ir-button>\n                {/* <ir-icons name=\"user\" style={{ '--icon-size': '1rem', 'color': colorVariants.secondary['--icon-button-color'] }}></ir-icons> */}\n              </ir-popover>\n            </div>\n            <ir-button\n              class=\"payment-item__action-button\"\n              variant=\"icon\"\n              onClickHandler={() => {\n                this.editPayment.emit(this.payment);\n              }}\n              icon_name=\"edit\"\n              style={colorVariants.secondary}\n            ></ir-button>\n            <ir-button\n              class=\"payment-item__action-button\"\n              onClickHandler={() => {\n                this.deletePayment.emit(this.payment);\n              }}\n              variant=\"icon\"\n              style={colorVariants.danger}\n              icon_name=\"trash\"\n            ></ir-button>\n          </div>\n        </div>\n\n        {this.payment.reference && <p class=\"payment-item__payment-reference\">{this.payment?.reference}</p>}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n","import { Currency } from '@/models/property';\nimport locales from '@/stores/locales.store';\nimport { formatAmount } from '@/utils/utils';\nimport { Component, Prop, h } from '@stencil/core';\n\n@Component({\n  tag: 'ir-payment-summary',\n  styleUrl: 'ir-payment-summary.css',\n  scoped: true,\n})\nexport class IrPaymentSummary {\n  @Prop() totalCost: number;\n  @Prop() balance: number;\n  @Prop() collected: number;\n  @Prop() currency: Currency;\n  @Prop() isBookingCancelled: boolean;\n\n  private shouldShowTotalCost(): boolean {\n    return this.totalCost > 0 && this.totalCost !== null;\n  }\n\n  render() {\n    return (\n      <div class=\" m-0\">\n        {this.shouldShowTotalCost() && (\n          <div class=\"mb-2 h4 total-cost-container\">\n            {locales.entries.Lcz_TotalCost}:<span>{formatAmount(this.currency.symbol, this.totalCost)}</span>\n          </div>\n        )}\n\n        <div class=\"h4 d-flex align-items-center justify-content-between\">\n          <span>{locales.entries.Lcz_Balance}: </span>\n          <span class=\"danger font-weight-bold\">{formatAmount(this.currency.symbol, this.balance)}</span>\n        </div>\n\n        {!this.isBookingCancelled && (\n          <div class=\"mb-2 h4 d-flex align-items-center justify-content-between\">\n            <span>{locales.entries.Lcz_Collected}: </span>\n            <span>{formatAmount(this.currency.symbol, this.collected)}</span>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { Component, h, Prop, Event, EventEmitter } from '@stencil/core';\nimport { IPayment } from '@/models/booking.dto';\nimport { HelpDocButton } from '@/components/HelpButton';\n\n@Component({\n  styleUrl: 'ir-payments-folio.css',\n  tag: 'ir-payments-folio',\n  scoped: true,\n})\nexport class IrPaymentsFolio {\n  @Prop() payments: IPayment[] = [];\n\n  @Event({ bubbles: true }) addPayment: EventEmitter<void>;\n  @Event({ bubbles: true }) editPayment: EventEmitter<IPayment>;\n  @Event({ bubbles: true }) deletePayment: EventEmitter<IPayment>;\n\n  private handleAddPayment = () => {\n    this.addPayment.emit();\n  };\n\n  private handleEditPayment = (payment: IPayment) => {\n    this.editPayment.emit(payment);\n  };\n\n  private handleDeletePayment = (payment: IPayment) => {\n    this.deletePayment.emit(payment);\n  };\n\n  private hasPayments(): boolean {\n    return this.payments && this.payments.length > 0;\n  }\n\n  private renderPaymentItem(payment: IPayment, index: number) {\n    return [\n      <ir-payment-item\n        key={payment.id}\n        payment={payment}\n        onDeletePayment={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.handleDeletePayment(e.detail);\n        }}\n        onEditPayment={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.handleEditPayment(e.detail);\n        }}\n      />,\n      index < this.payments.length - 1 && <hr class=\"p-0 m-0\" />,\n    ];\n  }\n\n  private renderEmptyState() {\n    return (\n      <div class=\"text-center p-3\">\n        <p class=\"text-muted\">No payments recorded yet</p>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div class=\"mt-1\">\n        <div class=\"d-flex flex-column rounded payment-container\">\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n              <p class=\"font-size-large p-0 m-0\">Guest Folio</p>\n              <HelpDocButton message=\"Help\" href=\"https://help.igloorooms.com/extranet/booking-details/guest-folio\" />\n            </div>\n            <ir-button id=\"add-payment\" variant=\"icon\" icon_name=\"square_plus\" style={{ '--icon-size': '1.5rem' }} onClickHandler={this.handleAddPayment} />\n          </div>\n\n          <div class=\"mt-1 card p-1 payments-container\">\n            {this.hasPayments() ? this.payments.map((payment, index) => this.renderPaymentItem(payment, index)) : this.renderEmptyState()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import axios from 'axios';\nimport { TDueParams, TPickupData } from './types';\nimport calendar_data from '@/stores/calendar-data';\nimport { IBookingPickupInfo } from '@/components';\nimport { z, ZodError } from 'zod';\nimport { renderTime } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class PickupService {\n  public async savePickup(params: TPickupData, booking_nbr: string, is_remove: boolean) {\n    try {\n      const splitTime = params.arrival_time.split(':');\n      await axios.post(`/Do_Pickup`, {\n        booking_nbr,\n        is_remove,\n        currency: params.currency,\n        date: params.arrival_date,\n        details: params.flight_details,\n        hour: splitTime[0],\n        minute: splitTime[1],\n        nbr_of_units: params.number_of_vehicles,\n        selected_option: params.selected_option,\n        total: +params.due_upon_booking,\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  public transformDefaultPickupData(data: IBookingPickupInfo): TPickupData {\n    const arrival_time = data.hour && data.minute ? renderTime(data.hour) + ':' + renderTime(data.minute) : '';\n    return {\n      arrival_date: data.date,\n      arrival_time,\n      currency: data.currency,\n      due_upon_booking: data.total.toFixed(2),\n      flight_details: data.details,\n      location: data.selected_option.location.id,\n      number_of_vehicles: data.nbr_of_units,\n      selected_option: data.selected_option,\n      vehicle_type_code: data.selected_option.vehicle.code,\n    };\n  }\n  public getAvailableLocations(message: string) {\n    let locations: { value: number; text: string }[] = [];\n    calendar_data.pickup_service.allowed_options.forEach(option => {\n      if (locations.filter(location => location.value === option.location.id).length === 0) {\n        locations.push({\n          text: message + ' ' + option.location.description,\n          value: option.location.id,\n        });\n      }\n    });\n    return locations;\n  }\n  public createPickupSchema(minDate: string, maxDate: string) {\n    return z.object({\n      arrival_date: z\n        .string()\n        .regex(/^\\d{4}-\\d{2}-\\d{2}$/, { message: 'Invalid date format, expected YYYY-MM-DD' })\n        .refine(\n          dateStr => {\n            const date = moment(dateStr, 'YYYY-MM-DD', true);\n            const min = moment(minDate, 'YYYY-MM-DD', true);\n            const max = moment(maxDate, 'YYYY-MM-DD', true);\n            return date.isValid() && min.isValid() && max.isValid() && date.isBetween(min, max, undefined, '[]');\n          },\n          { message: `arrival_date must be between ${minDate} and ${maxDate}` },\n        ),\n\n      arrival_time: z\n        .string()\n        .regex(/^\\d{2}:\\d{2}$/, { message: 'Invalid time format. Expected HH:MM' })\n        .refine(\n          time => {\n            const [hours, minutes] = time.split(':').map(Number);\n            return hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59;\n          },\n          { message: 'Time values are out of range' },\n        ),\n      flight_details: z.string().nonempty({ message: 'Flight details cannot be empty' }),\n      vehicle_type_code: z.string().nonempty({ message: 'Vehicle type code cannot be empty' }),\n      number_of_vehicles: z.coerce.number().min(1, { message: 'At least one vehicle is required' }),\n    });\n  }\n  public validateForm(\n    params: TPickupData,\n    schema: any, // : { error: boolean; cause?: keyof TPickupData }\n  ) {\n    try {\n      schema.parse(params);\n      return null;\n    } catch (error) {\n      console.log(error);\n      const err = {};\n      if (error instanceof ZodError) {\n        error.issues.forEach(e => {\n          err[e.path[0]] = true;\n        });\n        return err;\n      }\n    }\n    // if (params.arrival_time.split(':').length !== 2) {\n    //   return {\n    //     error: true,\n    //     cause: 'arrival_time',\n    //   };\n    // }\n    // if (params.flight_details === '') {\n    //   return {\n    //     error: true,\n    //     cause: 'flight_details',\n    //   };\n    // }\n    // if (params.vehicle_type_code === '') {\n    //   return {\n    //     error: true,\n    //     cause: 'vehicle_type_code',\n    //   };\n    // }\n    // if (params.number_of_vehicles === 0) {\n    //   return {\n    //     error: true,\n    //     cause: 'number_of_vehicles',\n    //   };\n    // }\n    // return { error: false };\n  }\n  public getNumberOfVehicles(capacity: number, numberOfPersons: number) {\n    let total_number_of_vehicles = Math.ceil(numberOfPersons / capacity);\n    let startNumber = total_number_of_vehicles > 1 ? total_number_of_vehicles : 1;\n    let bonus_number = total_number_of_vehicles > 1 ? 2 : 3;\n    return Array.from({ length: total_number_of_vehicles + bonus_number }, (_, i) => startNumber + i);\n  }\n  private getPickUpPersonStatus(code: string) {\n    const getCodeDescription = calendar_data.pickup_service.allowed_pricing_models.find(model => model.code === code);\n    if (!getCodeDescription) {\n      return null;\n    }\n    return getCodeDescription.description;\n  }\n  public updateDue(params: TDueParams) {\n    const getCodeDescription = this.getPickUpPersonStatus(params.code);\n    if (!getCodeDescription) {\n      return;\n    }\n    if (getCodeDescription === 'Person') {\n      return params.amount * params.numberOfPersons;\n    } else {\n      return params.amount * params.number_of_vehicles;\n    }\n  }\n}\n",":host {\n  display: block;\n}\n.custom-card-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid #e4e5ec;\n}\n.card-title {\n  flex: 1;\n}\n.border-theme {\n  border: 1px solid #cacfe7;\n}\n@media (min-width: 768px) {\n  .price-input-container {\n    max-width: 290px;\n  }\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport { Component, Element, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { TPickupData } from './types';\nimport moment from 'moment';\nimport { IAllowedOptions } from '@/models/calendarData';\nimport { PickupService } from './pickup.service';\nimport { IBookingPickupInfo } from '@/models/booking.dto';\nimport { MaskedRange } from 'imask';\n\n@Component({\n  tag: 'ir-pickup',\n  styleUrls: ['ir-pickup.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrPickup {\n  @Element() el: HTMLElement;\n\n  @Prop() defaultPickupData: IBookingPickupInfo | null;\n  @Prop() numberOfPersons: number = 0;\n  @Prop() bookingNumber: string;\n  @Prop() bookingDates: { from: string; to: string };\n\n  @State() isLoading = false;\n  @State() allowedOptionsByLocation: IAllowedOptions[] = [];\n  @State() pickupData: TPickupData = {\n    location: -1,\n    flight_details: '',\n    due_upon_booking: '',\n    number_of_vehicles: 1,\n    vehicle_type_code: '',\n    currency: undefined,\n    arrival_time: '',\n    arrival_date: null,\n    selected_option: undefined,\n  };\n  @State() vehicleCapacity: number[] = [];\n  @State() cause: keyof TPickupData | null = null;\n  @State() errors: Record<string, boolean>;\n  @State() autoValidate = false;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private pickupService = new PickupService();\n  private pickupSchema;\n\n  private arrival_time_mask = {\n    mask: 'HH:mm',\n    blocks: {\n      HH: {\n        mask: MaskedRange,\n        from: 0,\n        to: 23,\n        placeholderChar: 'H',\n      },\n      mm: {\n        mask: MaskedRange,\n        from: 0,\n        to: 59,\n        placeholderChar: 'm',\n      },\n    },\n    lazy: false,\n    placeholderChar: '_',\n  };\n\n  componentWillLoad() {\n    if (this.defaultPickupData) {\n      const transformedData = this.pickupService.transformDefaultPickupData(this.defaultPickupData);\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(transformedData.selected_option.vehicle.capacity, this.numberOfPersons);\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id === transformedData.location);\n      this.pickupData = { ...transformedData };\n    }\n    this.pickupSchema = this.pickupService.createPickupSchema(this.bookingDates.from, this.bookingDates.to);\n  }\n  private handleLocationChange(event: CustomEvent) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const value = event.detail;\n    if (value === '') {\n      this.updatePickupData('location', -1);\n    }\n    if (value !== '') {\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id.toString() === value);\n      let locationChoice = this.allowedOptionsByLocation[0];\n      if (!locationChoice) {\n        return;\n      }\n      locationChoice.currency;\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons);\n      this.pickupData = {\n        ...this.pickupData,\n        location: value,\n        selected_option: locationChoice,\n        number_of_vehicles: this.vehicleCapacity[0],\n        due_upon_booking: this.pickupService\n          .updateDue({\n            amount: locationChoice.amount,\n            code: locationChoice.pricing_model.code,\n            numberOfPersons: this.numberOfPersons,\n            number_of_vehicles: this.vehicleCapacity[0],\n          })\n          .toFixed(2),\n        vehicle_type_code: locationChoice.vehicle.code,\n        currency: locationChoice.currency,\n        // number_of_vehicles:this.pickupService\n      };\n    }\n  }\n\n  private handleVehicleQuantityChange(e: CustomEvent) {\n    if (e.detail === '') {\n      return;\n    }\n    const value = +e.detail;\n    this.pickupData = {\n      ...this.pickupData,\n      number_of_vehicles: value,\n      due_upon_booking: this.pickupService\n        .updateDue({\n          amount: this.pickupData.selected_option.amount,\n          code: this.pickupData.selected_option.pricing_model.code,\n          numberOfPersons: this.numberOfPersons,\n          number_of_vehicles: value,\n        })\n        .toFixed(2),\n    };\n  }\n\n  private handleVehicleTypeChange(e: CustomEvent) {\n    if (e.detail === '') {\n      this.pickupData = {\n        ...this.pickupData,\n        due_upon_booking: '',\n        vehicle_type_code: '',\n      };\n      return;\n    }\n    let locationChoice = calendar_data.pickup_service.allowed_options.find(option => option.location.id === +this.pickupData.location && option.vehicle.code === e.detail);\n    if (!locationChoice) {\n      return;\n    }\n    this.vehicleCapacity = [...this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons)];\n    this.pickupData = {\n      ...this.pickupData,\n      selected_option: locationChoice,\n      number_of_vehicles: this.vehicleCapacity[0],\n      due_upon_booking: this.pickupService\n        .updateDue({\n          amount: locationChoice.amount,\n          code: locationChoice.pricing_model.code,\n          numberOfPersons: this.numberOfPersons,\n          number_of_vehicles: this.vehicleCapacity[0],\n        })\n        .toFixed(2),\n      vehicle_type_code: locationChoice.vehicle.code,\n    };\n  }\n\n  private updatePickupData(key: keyof TPickupData, value: any) {\n    this.pickupData = { ...this.pickupData, [key]: value };\n  }\n  private async savePickup() {\n    try {\n      this.isLoading = true;\n      this.autoValidate = true;\n      if (this.errors) {\n        this.errors = null;\n      }\n      this.errors = this.pickupService.validateForm(this.pickupData, this.pickupSchema);\n      if (this.errors) {\n        return;\n      }\n      await this.pickupService.savePickup(this.pickupData, this.bookingNumber, this.defaultPickupData !== null && this.pickupData.location === -1);\n      this.resetBookingEvt.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.savePickup();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_Pickup} displayContext=\"sidebar\"></ir-title>\n        <section class={'px-1 sheet-body'}>\n          <ir-select\n            testId=\"pickup_location\"\n            selectedValue={this.pickupData.location}\n            selectContainerStyle=\"mb-1\"\n            onSelectChange={this.handleLocationChange.bind(this)}\n            firstOption={locales.entries.Lcz_Pickup_NoThankYou}\n            class={'m-0 mb-1'}\n            data={this.pickupService.getAvailableLocations(locales.entries.Lcz_Pickup_YesFrom) as any}\n          ></ir-select>\n          {this.pickupData.location > 0 && (\n            <div class=\"m-0 p-0\" data-testid=\"pickup_body\">\n              {/*Date and Time Picker container */}\n              <div class={'d-flex'}>\n                {/*Date Picker */}\n                <div class=\"form-group  mr-1\">\n                  <div class=\"input-group row m-0\">\n                    <div class={`input-group-prepend col-5 p-0 text-dark border-0`}>\n                      <label class={`input-group-text  flex-grow-1 text-dark border-theme `}>{locales.entries.Lcz_ArrivalDate}</label>\n                    </div>\n                    <div class=\"form-control  form-control-md col-7 d-flex align-items-center px-0 mx-0\" style={{ border: '0' }}>\n                      <ir-date-picker\n                        data-testid=\"pickup_arrival_date\"\n                        date={this.pickupData.arrival_date}\n                        minDate={this.bookingDates.from}\n                        maxDate={this.bookingDates?.to}\n                        emitEmptyDate={true}\n                        aria-invalid={this.errors?.arrival_date && !this.pickupData.arrival_date ? 'true' : 'false'}\n                        onDateChanged={evt => {\n                          this.updatePickupData('arrival_date', evt.detail.start?.format('YYYY-MM-DD'));\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={this.pickupData.arrival_date ? moment(this.pickupData.arrival_date).format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm ${this.errors?.arrival_date && !this.pickupData.arrival_date ? 'border-danger' : ''} text-center`}\n                          style={{ borderTopLeftRadius: '0', borderBottomLeftRadius: '0', width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </div>\n                  </div>\n                </div>\n                {/*Time Picker */}\n                <ir-input-text\n                  autoValidate={this.autoValidate}\n                  wrapKey=\"arrival_time\"\n                  testId=\"pickup_arrival_time\"\n                  error={this.errors?.arrival_time}\n                  value={this.pickupData.arrival_time}\n                  zod={this.pickupSchema.pick({ arrival_time: true })}\n                  label={locales.entries.Lcz_Time}\n                  inputStyles=\"col-sm-4\"\n                  data-state={this.cause === 'arrival_time' ? 'error' : ''}\n                  mask={this.arrival_time_mask}\n                  onTextChange={e => this.updatePickupData('arrival_time', e.detail)}\n                ></ir-input-text>\n              </div>\n              <ir-input-text\n                wrapKey=\"flight_details\"\n                zod={this.pickupSchema.pick({ flight_details: true })}\n                autoValidate={this.autoValidate}\n                testId=\"pickup_flight_details\"\n                value={this.pickupData.flight_details}\n                label={locales.entries.Lcz_FlightDetails}\n                onTextChange={e => this.updatePickupData('flight_details', e.detail)}\n                placeholder=\"\"\n                error={this.errors?.flight_details}\n              ></ir-input-text>\n              <ir-select\n                testId=\"pickup_vehicle_type_code\"\n                selectContainerStyle=\"mb-1\"\n                error={this.cause === 'vehicle_type_code'}\n                onSelectChange={this.handleVehicleTypeChange.bind(this)}\n                firstOption={locales.entries.Lcz_Select}\n                selectedValue={this.pickupData.vehicle_type_code}\n                class={'m-0'}\n                data={\n                  this.allowedOptionsByLocation.map(option => ({\n                    text: option.vehicle.description,\n                    value: option.vehicle.code,\n                  })) as any\n                }\n              ></ir-select>\n              <div class={'d-flex flex-column flex-md-row'}>\n                <ir-select\n                  showFirstOption={false}\n                  testId=\"pickup_number_of_vehicles\"\n                  labelBorder=\"theme\"\n                  selectContainerStyle=\"mb-1\"\n                  onSelectChange={this.handleVehicleQuantityChange.bind(this)}\n                  selectedValue={this.pickupData.number_of_vehicles}\n                  error={this.cause === 'number_of_vehicles'}\n                  labelWidth={7}\n                  class={'m-0  mb-md-0 mr-md-1 flex-fill'}\n                  label={locales.entries.Lcz_NbrOfVehicles}\n                  data={\n                    this.vehicleCapacity.map(i => ({\n                      text: i,\n                      value: i,\n                    })) as any\n                  }\n                ></ir-select>\n                {/* <ir-input-text\n                  labelBorder=\"theme\"\n                  readonly\n                  value={this.pickupData.due_upon_booking}\n                  labelWidth={7}\n                  label={`${locales.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`}\n                  placeholder=\"\"\n                  class=\"\"\n                ></ir-input-text> */}\n                <div class=\"price-input-container\">\n                  <ir-price-input readOnly label={`${locales.entries.Lcz_DueUponBooking}`} value={this.pickupData.due_upon_booking} currency={this.pickupData.currency.symbol} />\n                </div>\n              </div>\n            </div>\n          )}\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClick={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`flex-fill`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n          {(this.defaultPickupData || this.pickupData.location !== -1) && (\n            <ir-button\n              btn_styles=\"justify-content-center align-items-center\"\n              class={'flex-fill'}\n              isLoading={this.isLoading}\n              text={locales.entries.Lcz_Save}\n              btn_color=\"primary\"\n              btn_type=\"submit\"\n            ></ir-button>\n          )}\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, h } from '@stencil/core';\nimport { _formatTime } from '../functions';\nimport moment from 'moment';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-pickup-view',\n  styleUrl: 'ir-pickup-view.css',\n  scoped: true,\n})\nexport class IrPickupView {\n  @Prop() booking: Booking;\n  render() {\n    if (!calendar_data.pickup_service.is_enabled || !this.booking.is_editable) {\n      return null;\n    }\n    return (\n      <Host>\n        <div class=\"mb-1\">\n          <div class={'d-flex w-100 mb-1 align-items-center justify-content-between'}>\n            <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_Pickup}</p>\n            <ir-button id=\"pickup\" data-testid=\"new_pickup_btn\" variant=\"icon\" icon_name=\"edit\" style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}></ir-button>\n          </div>\n          {this.booking.pickup_info && (\n            <div class={'card'}>\n              <div class={'p-1'}>\n                <div class={'d-flex align-items-center py-0 my-0 pickup-margin'}>\n                  <p class={'font-weight-bold mr-1 py-0 my-0'}>\n                    {locales.entries.Lcz_Date}: <span class={'font-weight-normal'}>{moment(this.booking.pickup_info.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</span>\n                  </p>\n                  {this.booking.pickup_info.hour && this.booking.pickup_info.minute && (\n                    <p class={'font-weight-bold flex-fill py-0 my-0'}>\n                      {locales.entries.Lcz_Time}:\n                      <span class={'font-weight-normal'}> {_formatTime(this.booking.pickup_info.hour.toString(), this.booking.pickup_info.minute.toString())}</span>\n                    </p>\n                  )}\n                  <p class={'font-weight-bold py-0 my-0'}>\n                    {locales.entries.Lcz_DueUponBooking}:{' '}\n                    <span class={'font-weight-normal'}>\n                      {this.booking.pickup_info.currency.symbol}\n                      {this.booking.pickup_info.total}\n                    </span>\n                  </p>\n                </div>\n                <p class={'font-weight-bold py-0 my-0'}>\n                  {locales.entries.Lcz_FlightDetails}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.details}`}</span>\n                </p>\n                <p class={'py-0 my-0 pickup-margin'}>{`${this.booking.pickup_info.selected_option.vehicle.description}`}</p>\n                <p class={'font-weight-bold py-0 my-0 pickup-margin'}>\n                  {locales.entries.Lcz_NbrOfVehicles}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.nbr_of_units}`}</span>\n                </p>\n                <p class={'small py-0 my-0 pickup-margin'}>\n                  {calendar_data.pickup_service.pickup_instruction.description}\n                  {calendar_data.pickup_service.pickup_cancelation_prepayment.description}\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.dialog-container-height {\n  height: 4rem;\n}\n.list-title {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  font-weight: bold;\n  width: fit-content;\n}\n.list-item {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  margin-left: 5px;\n  width: fit-content;\n}\n.list-item.green {\n  color: #629a4c;\n  font-weight: 600;\n}\n.list-item.red {\n  color: #ff4961;\n  font-weight: 600;\n}\n","import { Component, h, Prop, State } from '@stencil/core';\nimport { _formatTime } from '../../functions';\nimport locales from '@/stores/locales.store';\nimport { IPmsLog } from '@/models/booking.dto';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-pms-logs',\n  styleUrl: 'ir-pms-logs.css',\n  scoped: true,\n})\nexport class IrPmsLogs {\n  @Prop() bookingNumber: string;\n\n  @State() pmsLogs: IPmsLog;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.init();\n  }\n\n  private async init() {\n    try {\n      this.pmsLogs = await this.bookingService.fetchPMSLogs(this.bookingNumber);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"p-1\">\n        <h3 class=\" text-left mb-1 dialog-title \">{locales.entries.Lcz_PMS_Logs}</h3>\n\n        {isRequestPending('/Get_Exposed_PMS_Logs') ? (\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\n            <ir-spinner></ir-spinner>\n          </div>\n        ) : (\n          <div class={'dialog-container-height'}>\n            <div class=\"d-flex align-items-center \" style={{ paddingBottom: '0.5rem' }}>\n              <p class=\"list-title p-0 m-0\">{locales.entries.Lcz_SentAt}</p>\n              {this.pmsLogs?.sent_date ? (\n                <p class=\"list-item\">\n                  {this.pmsLogs?.sent_date} {_formatTime(this.pmsLogs?.sent_hour.toString(), this.pmsLogs?.sent_minute.toString())}\n                </p>\n              ) : (\n                <p class={`list-item ${this.pmsLogs?.sent_date ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\n              )}\n            </div>\n            <div class=\"d-flex align-items-center p-0 m-0\">\n              <h4 class=\"list-title p-0 m-0\">{locales.entries.Lcz_Acknowledged}</h4>\n              <p class={`list-item  ${this.pmsLogs?.is_acknowledged ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\nimport locales from '@/stores/locales.store';\nimport { getPrivateNote } from '@/utils/booking';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { ICountry } from '@/models/IBooking';\nimport { _formatDate, _formatTime } from '../functions';\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent } from '../types';\n\n@Component({\n  tag: 'ir-reservation-information',\n  styleUrl: 'ir-reservation-information.css',\n  scoped: true,\n})\nexport class IrReservationInformation {\n  @Prop() booking: Booking;\n  @Prop() countries: ICountry[];\n\n  @State() userCountry: ICountry | null = null;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\n  componentWillLoad() {\n    const guestCountryId = this.booking?.guest?.country_id;\n    this.userCountry = guestCountryId ? this.countries?.find(country => country.id === guestCountryId) || null : null;\n  }\n  private handleEditClick(e: CustomEvent, type: BookingDetailsSidebarEvents) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.openSidebar.emit({ type });\n  }\n\n  private renderPhoneNumber() {\n    const { mobile_without_prefix, country_phone_prefix, country_id } = this.booking.guest;\n    if (!mobile_without_prefix) {\n      return null;\n    }\n    if (country_phone_prefix) {\n      return country_phone_prefix + ' ' + mobile_without_prefix;\n    }\n    if (country_id) {\n      const selectedCountry = this.countries.find(c => c.id === country_id);\n      if (!selectedCountry) {\n        throw new Error('Invalid country id');\n      }\n      return selectedCountry.phone_prefix + ' ' + mobile_without_prefix;\n    }\n    return mobile_without_prefix;\n    // const { mobile, country_phone_prefix, country_id } = this.booking.guest;\n    // if (!mobile) {\n    //   return null;\n    // }\n    // if (this.booking.is_direct) {\n    //   if (country_phone_prefix) {\n    //     return country_phone_prefix + ' ' + mobile;\n    //   }\n    //   if (country_id) {\n    //     const selectedCountry = this.countries.find(c => c.id === country_id);\n    //     if (!selectedCountry) {\n    //       throw new Error('Invalid country id');\n    //     }\n    //     return selectedCountry.phone_prefix + ' ' + mobile;\n    //   }\n    // }\n    // return mobile;\n  }\n  render() {\n    const privateNote = getPrivateNote(this.booking.extras);\n    return (\n      <div class=\"card\">\n        <div class=\"p-1\">\n          <p>{this.booking.property.name || ''}</p>\n          <ir-label\n            labelText={`${locales.entries.Lcz_Source}:`}\n            content={this.booking.origin.Label}\n            image={{ src: this.booking.origin.Icon, alt: this.booking.origin.Label }}\n          ></ir-label>\n          <ir-label\n            renderContentAsHtml\n            labelText={`${locales.entries.Lcz_BookedOn}:`}\n            content={`${_formatDate(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${_formatTime(\n              this.booking.booked_on.hour.toString(),\n              this.booking.booked_on.minute.toString(),\n            )}`}\n          ></ir-label>\n          <ir-label labelText={`${locales.entries.Lcz_BookedBy}:`} content={`${this.booking.guest.first_name} ${this.booking.guest.last_name}`}>\n            {this.booking.guest?.nbr_confirmed_bookings > 1 && !this.booking.agent && (\n              <div class={'m-0 p-0'} slot=\"prefix\">\n                <ir-tooltip message={`${locales.entries.Lcz_BookingsNbr}`.replace('%1', this.booking.guest.nbr_confirmed_bookings.toString())} customSlot>\n                  <div class=\"d-flex align-items-center m-0 p-0\" slot=\"tooltip-trigger\" style={{ gap: '0.25rem' }}>\n                    <p class={'p-0 m-0'} style={{ color: '#FB0AAD' }}>\n                      {this.booking.guest.nbr_confirmed_bookings}\n                    </p>\n                    <ir-icons style={{ '--icon-size': '1rem' }} color=\"#FB0AAD\" name=\"heart-fill\"></ir-icons>\n                  </div>\n                </ir-tooltip>\n              </div>\n            )}\n            <ir-button\n              slot=\"suffix\"\n              variant=\"icon\"\n              icon_name={'edit'}\n              style={{ ...colorVariants.secondary, '--icon-size': '1.1rem' }}\n              onClickHandler={e => this.handleEditClick(e, 'guest')}\n            ></ir-button>\n          </ir-label>\n          {this.booking.guest.mobile && <ir-label labelText={`${locales.entries.Lcz_Phone}:`} content={this.renderPhoneNumber()}></ir-label>}\n          {!this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_Email}:`} content={this.booking.guest.email}></ir-label>}\n          {this.booking.guest.alternative_email && <ir-label labelText={`${locales.entries.Lcz_AlternativeEmail}:`} content={this.booking.guest.alternative_email}></ir-label>}\n          {this.booking?.guest?.address && <ir-label labelText={`${locales.entries.Lcz_Address}:`} content={this.booking.guest.address}></ir-label>}\n          {this.userCountry && (\n            <ir-label\n              labelText={`${locales.entries.Lcz_Country}:`}\n              isCountryImage\n              content={this.userCountry.name}\n              image={{ src: this.userCountry.flag, alt: this.userCountry.name }}\n            ></ir-label>\n          )}\n          {this.booking.guest?.notes && <ir-label display=\"inline\" labelText={`${locales.entries.Lcz_GuestPrivateNote}:`} content={this.booking.guest?.notes}></ir-label>}\n          {this.booking.is_direct && <ir-label labelText={`${locales.entries.Lcz_ArrivalTime}:`} content={this.booking.arrival.description}></ir-label>}\n          {this.booking.promo_key && <ir-label labelText={`${locales.entries.Lcz_Coupon}:`} content={this.booking.promo_key}></ir-label>}\n          {/* {this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_AgentCode?.split(':')[0]}:`} content={this.booking.agent.name}></ir-label>} */}\n          {this.booking.is_in_loyalty_mode && !this.booking.promo_key && (\n            <div class=\"d-flex align-items-center\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\n                <path\n                  fill=\"#fc6c85\"\n                  d=\"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z\"\n                />\n              </svg>\n              <p class=\"m-0 p-0 ml-1\">{locales.entries.Lcz_LoyaltyDiscountApplied}</p>\n            </div>\n          )}\n          {this.booking.is_direct ? (\n            <ir-label labelText={`${locales.entries.Lcz_GuestRemark}:`} display=\"inline\" content={this.booking.remark}></ir-label>\n          ) : (\n            <ota-label\n              class={'m-0 p-0'}\n              label={`${locales.entries.Lcz_ChannelNotes || 'Channel notes'}:`}\n              remarks={this.booking.ota_notes}\n              maxVisibleItems={this.booking.ota_notes?.length}\n            ></ota-label>\n          )}\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <ir-label\n              labelText={`${locales.entries.Lcz_BookingPrivateNote}:`}\n              placeholder={locales.entries.Lcz_VisibleToHotelOnly}\n              content={privateNote}\n              display={privateNote ? 'inline' : 'flex'}\n              // ignore_content\n            ></ir-label>\n            <ir-button variant=\"icon\" icon_name=\"edit\" style={colorVariants.secondary} onClickHandler={e => this.handleEditClick(e, 'extra_note')}></ir-button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n",".light-blue-bg {\n  background: #acecff;\n  padding: 0.1rem 0.3rem;\n  border-radius: 5px;\n  display: block;\n  max-width: 100px;\n  box-sizing: border-box;\n  display: inline-block;\n  overflow: hidden;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  cursor: default;\n}\n\n.room_statements {\n  display: block;\n  width: 100%; /* Ensure the container uses the full width */\n}\n.room_statements {\n  display: block;\n  width: 100%;\n}\n.room_statements span {\n  display: inline;\n  white-space: normal;\n  line-height: 1.5;\n  word-break: break-word;\n}\n\n.room_statements b {\n  display: inline;\n  margin-right: 5px;\n}\n.payment-container {\n  position: absolute;\n  right: 1rem;\n  height: fit-content;\n}\n:host {\n  position: relative;\n}\n.sm-mr {\n  margin-right: 3px;\n}\n.subtotal_row {\n  padding-top: 8px;\n  font-weight: 600;\n}\n.room_actions_btns {\n  gap: 0.5rem;\n}\n.night-cost {\n  color: #7cbebe;\n}\n.room_actions_btns {\n  /* max-width: 50%; */\n  white-space: nowrap;\n  width: max-content;\n}\n.room_actions_btns {\n  flex: 1 1 0%;\n  display: flex;\n  justify-content: flex-end;\n}\n/* .cancelation {\n  max-width: 30%;\n} */\n.mx-0-5 {\n  margin-left: 2px !important;\n  margin-right: 2px !important;\n}\n.tax-width {\n  font-size: 10px;\n  /* flex-wrap: wrap; */\n}\n.sm-mb-1 {\n  margin-bottom: 5px !important;\n}\n.sm-mt-1 {\n  margin-top: 5px !important;\n}\n.mx-01 {\n  --m: 5px;\n  margin-right: var(--m) !important;\n  margin-left: var(--m) !important;\n}\n","import { Component, h, Prop, EventEmitter, Event, Listen, State, Element, Host, Fragment, Watch } from '@stencil/core';\nimport { _getDay } from '../functions';\nimport { Booking, IUnit, Occupancy, Room, SharedPerson } from '@/models/booking.dto';\nimport { TIglBookPropertyPayload } from '@/models/igl-book-property';\nimport { formatName } from '@/utils/booking';\nimport locales from '@/stores/locales.store';\nimport calendar_data, { isSingleUnit } from '@/stores/calendar-data';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { formatAmount } from '@/utils/utils';\nimport { IEntries } from '@/models/IBooking';\nimport { BookingService } from '@/services/booking.service';\nimport { OpenSidebarEvent, RoomGuestsPayload } from '../types';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nexport type RoomModalReason = 'delete' | 'checkin' | 'checkout' | null;\n@Component({\n  tag: 'ir-room',\n  styleUrl: 'ir-room.css',\n  scoped: true,\n})\nexport class IrRoom {\n  @Element() element: HTMLIrRoomElement;\n  // Room Data\n  @Prop() booking: Booking;\n  @Prop() bookingIndex: number;\n  @Prop() isEditable: boolean;\n  @Prop() room: Room;\n  @Prop() property_id: number;\n  @Prop() includeDepartureTime: boolean;\n  // Meal Code names\n  @Prop() mealCodeName: string;\n  @Prop() myRoomTypeFoodCat: string;\n  // Currency\n  @Prop() currency: string = 'USD';\n  @Prop() language: string = 'en';\n  @Prop() legendData;\n  @Prop() roomsInfo;\n  @Prop() bedPreferences: IEntries[];\n  @Prop() departureTime: IEntries[];\n  // Booleans Conditions\n  @Prop() hasRoomEdit: boolean = false;\n  @Prop() hasRoomDelete: boolean = false;\n  @Prop() hasRoomAdd: boolean = false;\n  @Prop() hasCheckIn: boolean = false;\n  @Prop() hasCheckOut: boolean = false;\n\n  @State() collapsed: boolean = false;\n  @State() isLoading: boolean = false;\n  @State() modalReason: RoomModalReason = null;\n  @State() mainGuest: SharedPerson;\n  @State() isModelOpen: boolean = false;\n\n  // Event Emitters\n  @Event({ bubbles: true, composed: true }) deleteFinished: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n  @Event({ bubbles: true, composed: true }) pressCheckIn: EventEmitter;\n  @Event({ bubbles: true, composed: true }) pressCheckOut: EventEmitter;\n  @Event({ bubbles: true, composed: true }) editInitiated: EventEmitter<TIglBookPropertyPayload>;\n  @Event() resetbooking: EventEmitter<null>;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<RoomGuestsPayload>>;\n\n  private modal: HTMLIrModalElement;\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.mainGuest = this.getMainGuest();\n  }\n  @Listen('clickHandler')\n  handleClick(e) {\n    let target = e.target;\n    if (target.id == 'checkin') {\n      this.pressCheckIn.emit(this.room);\n    } else if (target.id == 'checkout') {\n      this.pressCheckOut.emit(this.room);\n    }\n  }\n  @Watch('room')\n  handleRoomDataChange() {\n    this.mainGuest = this.getMainGuest();\n  }\n\n  private getDateStr(date, locale = 'default') {\n    return date.getDate() + ' ' + date.toLocaleString(locale, { month: 'short' }) + ' ' + date.getFullYear();\n  }\n  private handleEditClick() {\n    this.editInitiated.emit({\n      event_type: 'EDIT_BOOKING',\n      ID: this.room['assigned_units_pool'],\n      NAME: formatName(this.mainGuest?.first_name, this.mainGuest?.last_name),\n      EMAIL: this.booking.guest.email,\n      PHONE: this.booking.guest.mobile,\n      REFERENCE_TYPE: '',\n      FROM_DATE: this.booking.from_date,\n      TO_DATE: this.booking.to_date,\n      TITLE: `${locales.entries.Lcz_EditBookingFor} ${this.room?.roomtype?.name} ${(this.room?.unit as IUnit)?.name || ''}`,\n      defaultDateRange: {\n        dateDifference: this.room.days.length,\n        fromDate: new Date(this.room.from_date + 'T00:00:00'),\n        fromDateStr: this.getDateStr(new Date(this.room.from_date + 'T00:00:00')),\n        toDate: new Date(this.room.to_date + 'T00:00:00'),\n        toDateStr: this.getDateStr(new Date(this.room.to_date + 'T00:00:00')),\n        message: '',\n      },\n      bed_preference: this.room.bed_preference,\n      adult_child_offering: this.room.rateplan.selected_variation.adult_child_offering,\n      ADULTS_COUNT: this.room.rateplan.selected_variation.adult_nbr,\n      ARRIVAL: this.booking.arrival,\n      ARRIVAL_TIME: this.booking.arrival.description,\n      BOOKING_NUMBER: this.booking.booking_nbr,\n      cancelation: this.room.rateplan.cancelation,\n      channel_booking_nbr: this.booking.channel_booking_nbr,\n      CHILDREN_COUNT: this.room.rateplan.selected_variation.child_nbr,\n      COUNTRY: this.booking.guest.country_id,\n      ENTRY_DATE: this.booking.from_date,\n      FROM_DATE_STR: this.booking.format.from_date,\n      guarantee: this.room.rateplan.guarantee,\n      GUEST: this.mainGuest,\n      IDENTIFIER: this.room.identifier,\n      is_direct: this.booking.is_direct,\n      IS_EDITABLE: this.booking.is_editable,\n      NO_OF_DAYS: this.room.days.length,\n      NOTES: this.booking.remark,\n      origin: this.booking.origin,\n      POOL: this.room['assigned_units_pool'],\n      PR_ID: (this.room.unit as IUnit)?.id,\n      RATE: this.room.total,\n      RATE_PLAN: this.room.rateplan.name,\n      RATE_PLAN_ID: this.room.rateplan.id,\n      RATE_TYPE: this.room.roomtype.id,\n      ROOMS: this.booking.rooms,\n      SOURCE: this.booking.source,\n      SPLIT_BOOKING: false,\n      STATUS: 'IN-HOUSE',\n      TO_DATE_STR: this.booking.format.to_date,\n      TOTAL_PRICE: this.booking.total,\n      legendData: this.legendData,\n      roomsInfo: this.roomsInfo,\n      roomName: (this.room.unit as IUnit)?.name || '',\n      PICKUP_INFO: this.booking.pickup_info,\n      booking: this.booking,\n      currentRoomType: this.room,\n    });\n  }\n  private openModal(reason: RoomModalReason) {\n    if (!reason) {\n      return;\n    }\n    this.modalReason = reason;\n    this.modal.openModal();\n  }\n  private async handleModalConfirmation(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      if (!this.modalReason) {\n        return;\n      }\n      this.isLoading = true;\n      switch (this.modalReason) {\n        case 'delete':\n          await this.deleteRoom();\n          break;\n        case 'checkin':\n        case 'checkout':\n          await this.bookingService.handleExposedRoomInOut({\n            booking_nbr: this.booking.booking_nbr,\n            room_identifier: this.room.identifier,\n            status: this.modalReason === 'checkin' ? '001' : '002',\n          });\n          this.resetbooking.emit(null);\n          break;\n        default:\n          break;\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n      this.modalReason = null;\n      this.modal.closeModal();\n    }\n  }\n  private async deleteRoom() {\n    let oldRooms = [...this.booking.rooms];\n    oldRooms = oldRooms.filter(room => room.identifier !== this.room.identifier);\n\n    const body = {\n      assign_units: true,\n      check_in: true,\n      is_pms: true,\n      is_direct: true,\n      booking: {\n        booking_nbr: this.booking.booking_nbr,\n        from_date: this.booking.from_date,\n        to_date: this.booking.to_date,\n        remark: this.booking.remark,\n        property: this.booking.property,\n        source: this.booking.source,\n        currency: this.booking.currency,\n        arrival: this.booking.arrival,\n        guest: this.booking.guest,\n        rooms: oldRooms,\n      },\n      extras: this.booking.extras,\n      pickup_info: this.booking.pickup_info,\n    };\n    await this.bookingService.doReservation(body);\n    this.deleteFinished.emit(this.room.identifier);\n  }\n  private async updateDepartureTime(code: string) {\n    try {\n      await this.bookingService.setDepartureTime({\n        property_id: this.property_id,\n        code,\n        room_identifier: this.room.identifier,\n      });\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: 'Saved Successfully',\n        position: 'top-right',\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private formatVariation({ infant_nbr, adult_nbr, children_nbr }: Occupancy) {\n    const adultCount = adult_nbr > 0 ? adult_nbr : 0;\n    const childCount = children_nbr > 0 ? children_nbr : 0;\n    const infantCount = infant_nbr > 0 ? infant_nbr : 0;\n\n    const adultLabel = adultCount > 1 ? locales.entries.Lcz_Adults.toLowerCase() : locales.entries.Lcz_Adult.toLowerCase();\n    const childLabel = childCount > 1 ? locales.entries.Lcz_Children.toLowerCase() : locales.entries.Lcz_Child.toLowerCase();\n    const infantLabel = infantCount > 1 ? locales.entries.Lcz_Infants.toLowerCase() : locales.entries.Lcz_Infant.toLowerCase();\n\n    const parts = [];\n    if (adultCount > 0) {\n      parts.push(`${adultCount} ${adultLabel}`);\n    }\n    if (childCount > 0) {\n      parts.push(`${childCount} ${childLabel}`);\n    }\n    if (infantCount > 0) {\n      parts.push(`${infantCount} ${infantLabel}`);\n    }\n\n    return parts.join('&nbsp&nbsp&nbsp&nbsp');\n  }\n  private getSmokingLabel() {\n    if (this.booking.is_direct) {\n      if (!this.room.smoking_option) {\n        return null;\n      }\n      const currRT = calendar_data.roomsInfo.find(rt => rt.id === this.room.roomtype.id);\n      if (currRT) {\n        const smoking_option = currRT['smoking_option']?.allowed_smoking_options;\n        if (smoking_option) {\n          return smoking_option.find(s => s.code === this.room.smoking_option)?.description;\n        }\n        return null;\n      }\n      return null;\n    }\n    return this.room.ota_meta?.smoking_preferences;\n  }\n\n  private getBedName() {\n    if (this.booking.is_direct) {\n      const bed = this.bedPreferences.find(p => p.CODE_NAME === this.room?.bed_preference?.toString());\n      if (!bed) {\n        return;\n      }\n      return bed[`CODE_VALUE_${this.language}`] ?? bed.CODE_VALUE_EN;\n    }\n    return this.room.ota_meta?.bed_preferences;\n  }\n  private renderModalMessage() {\n    switch (this.modalReason) {\n      case 'delete':\n        return `${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${this.room.roomtype.name} ${this.room.unit ? (this.room.unit as IUnit).name : ''} ${\n          locales.entries.Lcz_FromThisBooking\n        }`;\n      case 'checkin':\n        return `Are you sure you want to Check In this unit?\n`;\n      case 'checkout':\n        return `Are you sure you want to Check Out this unit?`;\n      default:\n        return '';\n    }\n  }\n  private handleCheckIn() {\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\n    if (this.room.sharing_persons.length < adult_nbr + children_nbr + infant_nbr) {\n      return this.showGuestModal();\n    }\n    return this.renderModalMessage();\n  }\n  private getMainGuest() {\n    return this.room.sharing_persons?.find(p => p.is_main);\n  }\n\n  render() {\n    const bed = this.getBedName();\n    return (\n      <Host class=\"p-1 d-flex m-0\">\n        <ir-button\n          variant=\"icon\"\n          id=\"drawer-icon\"\n          data-toggle=\"collapse\"\n          data-target={`#roomCollapse-${this.room.identifier?.split(' ').join('')}`}\n          aria-expanded={this.collapsed ? 'true' : 'false'}\n          aria-controls=\"myCollapse\"\n          class=\"mr-1\"\n          icon_name={this.collapsed ? 'closed_eye' : 'open_eye'}\n          onClickHandler={() => {\n            this.collapsed = !this.collapsed;\n          }}\n          style={{ '--icon-size': '1.6rem' }}\n        ></ir-button>\n        <div class=\"flex-fill m-0 \">\n          <div class=\"d-flex align-items-start justify-content-between sm-mb-1\">\n            <p class=\"m-0 p-0\">\n              <span class=\"m-0 p-0\" style={{ fontWeight: '600' }}>\n                {this.myRoomTypeFoodCat || ''}{' '}\n              </span>{' '}\n              {this.mealCodeName} {this.room.rateplan.is_non_refundable && ` - ${locales.entries.Lcz_NonRefundable}`}{' '}\n            </p>\n            {/*this.room.My_Room_type.My_Room_type_desc[0].CUSTOM_TXT || ''*/}\n            <div class=\"d-flex m-0 p-0 align-items-center room_actions_btns\">\n              <span class=\"p-0 m-0 font-weight-bold\">{formatAmount(this.currency, this.room['gross_total'])}</span>\n              {this.hasRoomEdit && this.isEditable && (\n                <ir-button\n                  id={`roomEdit-${this.room.identifier}`}\n                  variant=\"icon\"\n                  icon_name=\"edit\"\n                  // class=\"mx-1\"\n                  style={colorVariants.secondary}\n                  onClickHandler={this.handleEditClick.bind(this)}\n                ></ir-button>\n              )}\n              {this.hasRoomDelete && this.isEditable && (\n                <ir-button\n                  variant=\"icon\"\n                  onClickHandler={this.openModal.bind(this, 'delete')}\n                  id={`roomDelete-${this.room.identifier}`}\n                  icon_name=\"trash\"\n                  style={colorVariants.danger}\n                ></ir-button>\n              )}\n            </div>\n          </div>\n          <div class=\"d-flex align-items-center sm-mb-1\">\n            <ir-date-view\n              class=\"mr-1  flex-grow-1\"\n              style={{ width: 'fit-content' }}\n              from_date={this.room.from_date}\n              to_date={this.room.to_date}\n              showDateDifference={false}\n            ></ir-date-view>\n            {!isSingleUnit(this.room.roomtype.id) && calendar_data.is_frontdesk_enabled && this.room.unit && (\n              <div class={'d-flex justify-content-center align-items-center'}>\n                <ir-tooltip message={(this.room.unit as IUnit).name} customSlot>\n                  <span slot=\"tooltip-trigger\" class={`light-blue-bg  ${this.hasCheckIn || this.hasCheckOut ? 'mr-2' : ''} `}>\n                    {(this.room.unit as IUnit).name}\n                  </span>\n                </ir-tooltip>\n              </div>\n            )}\n            {this.hasCheckIn && (\n              <ir-button onClickHandler={this.handleCheckIn.bind(this)} id=\"checkin\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckIn}></ir-button>\n            )}\n            {this.hasCheckOut && (\n              <ir-button onClickHandler={this.openModal.bind(this, 'checkout')} id=\"checkout\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckOut}></ir-button>\n            )}\n          </div>\n          <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n            <p class=\"m-0 p-0\">{`${this.mainGuest.first_name || ''} ${this.mainGuest.last_name || ''}`}</p>\n            {this.room.rateplan.selected_variation.adult_nbr > 0 &&\n              (this.room.unit ? (\n                <ir-tooltip message={'View guests'} class=\"m-0 p-0\" customSlot>\n                  <ir-button\n                    class=\"m-0 p-0\"\n                    slot=\"tooltip-trigger\"\n                    btn_color=\"link\"\n                    renderContentAsHtml\n                    onClickHandler={() => this.showGuestModal()}\n                    size=\"sm\"\n                    btnStyle={{ width: 'fit-content', margin: '0', padding: '0', fontSize: 'inherit', textAlign: 'center', lineHeight: '1.2' }}\n                    text={this.formatVariation(this.room.occupancy)}\n                  ></ir-button>\n                </ir-tooltip>\n              ) : (\n                <span innerHTML={this.formatVariation(this.room.occupancy)}></span>\n              ))}\n            {bed && <p class=\"m-0 p-0\">({bed})</p>}\n          </div>\n          {this.includeDepartureTime && (\n            <div class=\"d-flex align-items-center\" style={{ marginTop: '0.5rem', marginBottom: '0.875rem', gap: '0.5rem' }}>\n              <p class=\"m-0 p-0\">Expected departure time:</p>\n              <ir-select\n                selectedValue={this.room.departure_time?.code}\n                showFirstOption={false}\n                onSelectChange={e => {\n                  this.updateDepartureTime(e.detail);\n                }}\n                data={this.departureTime?.map(d => ({\n                  text: d[`CODE_VALUE_${this.language?.toUpperCase()}`] ?? d[`CODE_VALUE_EN`],\n                  value: d.CODE_NAME,\n                }))}\n              ></ir-select>\n            </div>\n          )}\n          <div class=\"collapse\" id={`roomCollapse-${this.room.identifier?.split(' ').join('')}`}>\n            <div class=\"d-flex sm-mb-1 sm-mt-1\">\n              <div class=\" sm-padding-top\">\n                <p class=\"sm-padding-right\" style={{ fontWeight: '600' }}>{`${locales.entries.Lcz_Breakdown}:`}</p>\n              </div>\n              <div class={'flex-fill'}>\n                <table>\n                  {this.room.days.length > 0 &&\n                    this.room.days.map(room => {\n                      return (\n                        <tr>\n                          <td class={'pr-2 text-right'}>{_getDay(room.date)}</td>\n                          <td class=\"text-right\">{formatAmount(this.currency, room.amount)}</td>\n                          {room.cost > 0 && room.cost !== null && <td class=\"pl-2 text-left night-cost\">{formatAmount(this.currency, room.cost)}</td>}\n                        </tr>\n                      );\n                    })}\n                  <tr class={''}>\n                    <th class=\"text-right pr-2 subtotal_row\">{locales.entries.Lcz_SubTotal}</th>\n                    <th class=\"text-right subtotal_row\">{formatAmount(this.currency, this.room.total)}</th>\n                    {this.room.gross_cost > 0 && this.room.gross_cost !== null && <th class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, this.room.cost)}</th>}\n                  </tr>\n                  {this.booking.is_direct ? (\n                    <Fragment>\n                      {(() => {\n                        const filtered_data = calendar_data.taxes.filter(tx => tx.pct > 0);\n                        return filtered_data.map(d => {\n                          return (\n                            <tr>\n                              <td class=\"text-right pr-2\">\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name} ({d.pct}%)\n                              </td>\n                              <td class=\"text-right\">{formatAmount(this.currency, (this.room.total * d.pct) / 100)}</td>\n                              {this.room.gross_cost > 0 && this.room.gross_cost !== null && (\n                                <td class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, (this.room.cost * d.pct) / 100)}</td>\n                              )}\n                            </tr>\n                          );\n                        });\n                      })()}\n                    </Fragment>\n                  ) : (\n                    <Fragment>\n                      {(() => {\n                        const filtered_data = this.room.ota_taxes.filter(tx => tx.amount > 0);\n                        return filtered_data.map(d => {\n                          return (\n                            <tr>\n                              <td class=\"text-right pr-2\">\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name}\n                              </td>\n                              <td class=\"text-right\">\n                                {d.currency.symbol}\n                                {d.amount}\n                              </td>\n                            </tr>\n                          );\n                        });\n                      })()}\n                    </Fragment>\n                  )}\n                </table>\n              </div>\n            </div>\n            <ir-label labelText={`${locales.entries.Lcz_SmokingOptions}:`} display=\"inline\" content={this.getSmokingLabel()}></ir-label>\n            {this.booking.is_direct && (\n              <Fragment>\n                {this.room.rateplan.cancelation && (\n                  <ir-label labelText={`${locales.entries.Lcz_Cancellation}:`} display=\"inline\" content={this.room.rateplan.cancelation || ''} renderContentAsHtml></ir-label>\n                )}\n                {this.room.rateplan.guarantee && (\n                  <ir-label labelText={`${locales.entries.Lcz_Guarantee}:`} display=\"inline\" content={this.room.rateplan.guarantee || ''} renderContentAsHtml></ir-label>\n                )}\n              </Fragment>\n            )}\n            {this.room.ota_meta && (\n              <div>\n                <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} display=\"inline\" content={this.room.ota_meta.meal_plan}></ir-label>\n                <ir-label labelText={`${locales.entries.Lcz_Policies}:`} display=\"inline\" content={this.room.ota_meta.policies}></ir-label>\n              </div>\n            )}\n            {/* {this.bookingEvent.is_direct && <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} content={this.mealCodeName}></ir-label>} */}\n          </div>\n        </div>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.modal = el)}\n          isLoading={this.isLoading}\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={this.modalReason === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\n          leftBtnColor=\"secondary\"\n          rightBtnColor={this.modalReason === 'delete' ? 'danger' : 'primary'}\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={this.renderModalMessage()}\n        ></ir-modal>\n      </Host>\n    );\n  }\n  private showGuestModal(): void {\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\n    this.openSidebar.emit({\n      type: 'room-guest',\n      payload: {\n        roomName: (this.room.unit as IUnit)?.name,\n        sharing_persons: this.room.sharing_persons,\n        totalGuests: adult_nbr + children_nbr + infant_nbr,\n        checkin: this.hasCheckIn,\n        identifier: this.room.identifier,\n      },\n    });\n  }\n}\n","import { SharedPerson } from '@/models/booking.dto';\nimport moment from 'moment';\nimport { FactoryArg, MaskedRange } from 'imask';\n\nexport const defaultGuest: SharedPerson = {\n  id: -1,\n  full_name: '',\n  country_id: null,\n  dob: '',\n  id_info: {\n    type: {\n      code: null,\n      description: null,\n    },\n    number: '',\n  },\n  address: null,\n  alternative_email: null,\n  cci: null,\n  city: null,\n  country: undefined,\n  country_phone_prefix: null,\n  email: null,\n  first_name: '',\n  last_name: '',\n  mobile: null,\n  nbr_confirmed_bookings: 0,\n  notes: null,\n  password: null,\n  subscribe_to_news_letter: null,\n};\n/**Date of birth mask for room guests  with min */\nexport const dateMask: FactoryArg = {\n  mask: Date,\n  pattern: 'DD/MM/YYYY',\n  lazy: false,\n  min: moment('1900-01-01', 'YYYY-MM-DD').toDate(),\n  max: new Date(),\n  format: date => moment(date).format('DD/MM/YYYY'),\n  parse: str => moment(str, 'DD/MM/YYYY').toDate(),\n  autofix: true,\n  placeholderChar: '_',\n  blocks: {\n    YYYY: {\n      mask: MaskedRange,\n      from: 1900,\n      to: new Date().getFullYear(),\n      placeholderChar: 'Y',\n    },\n    MM: {\n      mask: MaskedRange,\n      from: 1,\n      to: 12,\n      placeholderChar: 'M',\n    },\n    DD: {\n      mask: MaskedRange,\n      from: 1,\n      to: 31,\n      placeholderChar: 'D',\n    },\n  },\n};\n",":host {\n  display: block;\n  height: 100%;\n  position: relative;\n  text-align: start !important;\n}\n.id-select {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border-right-width: 0;\n}\n:host {\n  display: block;\n  width: 100%;\n}\n\n.guest-grid > * {\n  height: 100%;\n}\n\n.guests-labels {\n  display: none;\n}\n.guest_label {\n  width: 100px;\n  color: #6b6f82;\n}\n.sharing_persons_label {\n  display: none;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.guest_document input {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.guests-labels *,\n.sharing_persons_label {\n  margin-bottom: 0.5rem;\n  padding-bottom: 0;\n}\n\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n  .sharing_persons_label {\n    display: block;\n  }\n  .guest_country_picker {\n    margin-bottom: 3px;\n  }\n  .guest-grid {\n    display: grid;\n    grid-template-columns: 2fr 2fr 2fr 2fr 5fr;\n    gap: 0.5rem;\n    align-items: flex-start;\n  }\n\n  .guest_label,\n  .sharing_persons_heading,\n  .main_guest_heading {\n    display: none;\n  }\n}\n\n/*lg*/\n@media (min-width: 1024px) {\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { SharedPerson, validateSharedPerson, ZIdInfo, ZSharedPerson } from '@/models/booking.dto';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Fragment, Prop, State, h } from '@stencil/core';\nimport moment from 'moment';\nimport { dateMask, defaultGuest } from './data';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry, IEntries } from '@/models/IBooking';\nimport { ZodError } from 'zod';\n@Component({\n  tag: 'ir-room-guests',\n  styleUrls: ['ir-room-guests.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrRoomGuests {\n  /**\n   * The name of the room currently being displayed.\n   * Used to label the room in the user interface for clarity.\n   */\n  @Prop() roomName: string;\n\n  /**\n   * A unique identifier for the room.\n   * This is used to distinguish between rooms, especially when performing operations like saving or checking in guests.\n   */\n  @Prop() identifier: string;\n\n  /**\n   * An array of people sharing the room.\n   * Contains information about the {locales.entries.Lcz_MainGuest} and additional guests, such as their name, date of birth, {locales.entries.Lcz_Nationality}, and ID details.\n   */\n  @Prop() sharedPersons: SharedPerson[] = [];\n\n  /**\n   * The total number of guests for the room.\n   * Determines how many guest input forms to display in the UI.\n   */\n  @Prop() totalGuests: number = 0;\n\n  /**\n   * A list of available countries.\n   * Used to populate dropdowns for selecting the {locales.entries.Lcz_Nationality} of guests.\n   */\n  @Prop() countries: ICountry[];\n\n  /**\n   * A boolean indicating whether the room is in the process of being checked in.\n   * If true, additional actions like saving the room state as \"checked in\" are performed.\n   */\n  @Prop() checkIn: boolean;\n\n  /**\n   * The language used for displaying text content in the component.\n   * Defaults to English ('en'), but can be set to other supported languages.\n   */\n  @Prop() language: string = 'en';\n\n  /**\n   * A unique booking number associated with the room.\n   * This is used for backend operations like saving guest information or checking in the room.\n   */\n  @Prop() bookingNumber: string;\n\n  @State() guests: SharedPerson[] = [];\n  @State() idTypes: IEntries[] = [];\n  @State() error: Record<string, boolean> = {};\n  @State() isLoading: boolean;\n  @State() propertyCountry: ICountry;\n  @State() autoValidate = false;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() updateRoomGuests: EventEmitter<{ identifier: string; guests: SharedPerson[] }>;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.init();\n    this.initializeGuests();\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      const [country, idTypes] = await Promise.all([this.bookingService.getUserDefaultCountry(), this.bookingService.getSetupEntriesByTableName('_ID_TYPE')]);\n      this.idTypes = idTypes;\n      if (country) {\n        this.propertyCountry = this.countries.find(c => c.id === country.COUNTRY_ID);\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private initializeGuests(): void {\n    let guests = [];\n    if (this.totalGuests > this.sharedPersons.length) {\n      const defaultGuestsCount = this.totalGuests - this.sharedPersons.length;\n      guests = [\n        ...this.sharedPersons,\n        ...Array(defaultGuestsCount).fill({\n          ...defaultGuest,\n          id_info: {\n            ...defaultGuest.id_info,\n            type: {\n              code: this.idTypes[0]?.CODE_NAME || '001',\n              description: this.idTypes[0]?.CODE_VALUE_EN || '',\n            },\n            number: '',\n          },\n        }),\n      ];\n    } else {\n      guests = [...this.sharedPersons];\n    }\n    guests = guests.map(g => ({ ...g, dob: new Date(g.dob).getFullYear() === 1900 ? null : g.dob }));\n    this.guests = guests.map(g => ({ ...g, dob: g.dob ? moment(new Date(g.dob)).format('DD/MM/YYYY') : '', country_id: g.country ? g.country.id : null }));\n  }\n\n  private updateGuestInfo(index: number, params: Partial<SharedPerson>) {\n    const tempGuests = [...this.guests];\n    let tempGuest = tempGuests[index];\n    tempGuest = { ...tempGuest, ...params };\n    tempGuests[index] = tempGuest;\n    this.guests = [...tempGuests];\n  }\n\n  private async saveGuests() {\n    try {\n      this.error = {};\n      this.autoValidate = true;\n      console.log({\n        sharedPersons: this.sharedPersons,\n        guests: this.guests,\n      });\n      // ZSharedPersons.parse(this.guests);\n      for (const guest of this.guests) {\n        validateSharedPerson(guest);\n      }\n      await this.bookingService.handleExposedRoomGuests({\n        booking_nbr: this.bookingNumber,\n        identifier: this.identifier,\n        guests: this.guests\n          .map(g => {\n            if (!g.first_name && g.id === -1) {\n              return null;\n            }\n            return { ...g, dob: g.dob ? moment(g.dob, 'DD/MM/YYYY').format('YYYY-MM-DD') : null };\n          })\n          .filter(Boolean),\n      });\n      if (this.checkIn) {\n        await this.bookingService.handleExposedRoomInOut({\n          booking_nbr: this.bookingNumber,\n          room_identifier: this.identifier,\n          status: '001',\n        });\n      }\n      this.closeModal.emit(null);\n      this.updateRoomGuests.emit({ identifier: this.identifier, guests: this.guests });\n      this.resetBookingEvt.emit();\n    } catch (error) {\n      console.log(error);\n      if (error instanceof ZodError) {\n        let errors = {};\n        error.issues.forEach(e => {\n          errors[e.path[e.path.length - 1]] = true;\n        });\n        this.error = { ...errors };\n      }\n    }\n  }\n\n  render() {\n    if (this.isLoading) {\n      return (\n        <div class={'loading-container'}>\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    return (\n      <form\n        class=\"sheet-container\"\n        style={{ minWidth: '300px' }}\n        onSubmit={e => {\n          e.preventDefault();\n          this.saveGuests();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={`Room ${this.roomName}`} displayContext=\"sidebar\"></ir-title>\n        <section class={'sheet-body px-1'}>\n          <div class=\"\">\n            <div class=\"guest-grid guests-labels\">\n              <p class=\"\">{locales.entries.Lcz_MainGuest}</p>\n              <p class=\"\"></p>\n              <p class=\" \">{locales.entries.Lcz_DOB}</p>\n              <p class=\"\">{locales.entries.Lcz_Nationality}</p>\n              <p class=\" \">{locales.entries.Lcz_Documents}</p>\n            </div>\n            <h5 class=\"main_guest_heading\">{locales.entries.Lcz_MainGuest}</h5>\n            {this.guests.map((guest, idx) => {\n              let isRowValid = true;\n              try {\n                validateSharedPerson(guest);\n              } catch (error) {\n                isRowValid = false;\n              }\n              // console.log(`row ${idx}=>${isRowValid}`);\n              return (\n                <Fragment>\n                  {idx === 1 && (\n                    <div class=\"d-flex mx-0 px-0\">\n                      <h5 class=\"mx-0 px-0 sharing_persons_heading\">{locales.entries.Lcz_PersonsSharingRoom}</h5>\n                      <p class=\"mx-0 px-0 sharing_persons_label\">{locales.entries.Lcz_PersonsSharingRoom}</p>\n                    </div>\n                  )}\n                  <div key={idx} class=\"guest-grid\">\n                    <div class={'m-0 p-0 d-flex align-items-center h-100'}>\n                      <p class=\"guest_label\">First name</p>\n                      <ir-input-text\n                        class=\"flex-grow-1 h-100\"\n                        id={`first_name_${idx}`}\n                        zod={ZSharedPerson.pick({ first_name: true })}\n                        error={!!this.error['first_name'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"first_name\"\n                        placeholder=\"First name\"\n                        onTextChange={e => this.updateGuestInfo(idx, { first_name: e.detail })}\n                        value={guest.first_name}\n                        maxLength={40}\n                      ></ir-input-text>\n                    </div>\n                    <div class={'m-0 p-0 d-flex align-items-center h-100'}>\n                      <p class=\"guest_label\">Last name</p>\n                      <ir-input-text\n                        maxLength={40}\n                        class=\"flex-grow-1 h-100\"\n                        id={`last_name_${idx}`}\n                        zod={ZSharedPerson.pick({ last_name: true })}\n                        error={!!this.error['last_name'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"last_name\"\n                        placeholder=\"Last name\"\n                        onTextChange={e => this.updateGuestInfo(idx, { last_name: e.detail })}\n                        value={guest.last_name}\n                      ></ir-input-text>\n                    </div>\n                    <div class=\"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_DOB}</p>\n                      <ir-input-text\n                        class=\"flex-grow-1 h-100\"\n                        id={`dob_${idx}`}\n                        zod={ZSharedPerson.pick({ dob: true })}\n                        error={!!this.error['dob'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"dob\"\n                        mask={dateMask}\n                        placeholder=\"\"\n                        onTextChange={e => {\n                          this.updateGuestInfo(idx, { dob: e.detail });\n                        }}\n                        value={guest.dob}\n                      ></ir-input-text>\n                    </div>\n                    <div class=\" m-0 p-0 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_Nationality}</p>\n                      <div class=\"mx-0 flex-grow-1  h-100\">\n                        <ir-country-picker\n                          class=\"h-100\"\n                          propertyCountry={this.propertyCountry}\n                          id={`{locales.entries.Lcz_Nationality}_${idx}`}\n                          error={!!this.error['country_id'] && !guest.country_id}\n                          country={this.countries?.find(c => c.id?.toString() === guest.country?.id?.toString())}\n                          onCountryChange={e => this.updateGuestInfo(idx, { country_id: e.detail?.id?.toString() ?? null, country: e.detail })}\n                          countries={this.countries}\n                        ></ir-country-picker>\n                      </div>\n                    </div>\n                    <div class=\"flex-grow-1 m-0 p-0 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_Documents}</p>\n                      <div class={' d-flex m-0 flex-grow-1 h-100'}>\n                        <ir-select\n                          selectForcedStyles={{\n                            borderTopRightRadius: '0px',\n                            borderBottomRightRadius: '0px',\n                            borderRight: '0',\n                          }}\n                          selectStyles={'rounded-top-0 rounded-bottom-0'}\n                          onSelectChange={e => {\n                            this.updateGuestInfo(idx, {\n                              id_info: {\n                                ...this.guests[idx].id_info,\n                                type: {\n                                  code: e.detail,\n                                  description: '',\n                                },\n                              },\n                            });\n                          }}\n                          selectedValue={guest.id_info?.type?.code}\n                          showFirstOption={false}\n                          data={this.idTypes?.map(t => ({ text: t[`CODE_VALUE_${this.language.toUpperCase()}`] ?? t[`CODE_VALUE_EN`], value: t.CODE_NAME }))}\n                        ></ir-select>\n                        <ir-input-text\n                          autoValidate={this.autoValidate}\n                          maxLength={18}\n                          placeholder=\"12345\"\n                          class=\"flex-grow-1 guest_document\"\n                          type=\"text\"\n                          inputForcedStyle={{ borderTopLeftRadius: '0px', borderBottomLeftRadius: '0px' }}\n                          value={guest?.id_info?.number}\n                          zod={ZIdInfo.pick({ number: true })}\n                          error={!!this.error['number'] && !isRowValid}\n                          wrapKey=\"number\"\n                          inputStyles=\"form-control\"\n                          onTextChange={e =>\n                            this.updateGuestInfo(idx, {\n                              id_info: {\n                                ...this.guests[idx].id_info,\n                                number: e.detail,\n                              },\n                            })\n                          }\n                        ></ir-input-text>\n                      </div>\n                    </div>\n                  </div>\n                </Fragment>\n              );\n            })}\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button onClick={() => this.closeModal.emit(null)} class={`flex-fill`} text={locales.entries.Lcz_Cancel} btn_color=\"secondary\"></ir-button>\n          <ir-button\n            btn_type=\"submit\"\n            class={'flex-fill'}\n            isLoading={isRequestPending('/Handle_Exposed_Room_Guests')}\n            text={this.checkIn ? locales.entries.Lcz_CheckIn : locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n","* {\n  margin: 0;\n  padding: 0;\n}\n:host {\n  display: flex;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n.label_title {\n  min-width: max-content;\n  padding: 0;\n  margin: 0;\n  font-weight: 600;\n}\n.ota-message-list {\n  margin: 0 3px;\n  padding: 0;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  /* list-style: circle !important; */\n}\n.ota-message-item {\n  width: 100%;\n  line-height: 1.5;\n  margin: 0;\n  padding: 0;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n}\n.ota-message-item::before {\n  content: '- ';\n  margin-right: 0.25rem;\n}\n\n.ota-visibility-toggle {\n  background: white;\n  color: var(--blue);\n  padding: 0;\n  margin: 0;\n  margin-left: 3px;\n  font-size: 12px;\n  border: 0;\n}\n.ota-visibility-toggle:hover {\n  color: #355270;\n}\n.ota-message-list {\n  margin: 0 3px;\n  padding: 0;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  white-space: normal;\n  list-style: none;\n}\n.ota-message-item {\n  width: 100%;\n  line-height: 1.5;\n  margin: 0 0 0 1.2em; /* indent for dash */\n  padding: 0;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  white-space: normal;\n  position: relative;\n}\n/* .ota-message-item::before {\n  content: '-';\n  position: absolute;\n  left: 0;\n} */\n","import { Component, Host, Prop, State, h } from '@stencil/core';\nimport { v4 } from 'uuid';\nimport { IOtaNotes } from '@/models/booking.dto';\nimport locales from '@/stores/locales.store';\n@Component({\n  tag: 'ota-label',\n  styleUrl: 'ota-label.css',\n  scoped: true,\n})\nexport class OtaLabel {\n  /**\n   * Label displayed as the section title.\n   */\n  @Prop() label: string;\n\n  /**\n   * Array of OTA notes to display in the list.\n   */\n  @Prop() remarks: IOtaNotes[];\n\n  /**\n   * Maximum number of remarks to display before showing the \"Show More\" button.\n   */\n  @Prop() maxVisibleItems: number = 3;\n\n  /**\n   * Internal state that determines whether all remarks are shown or only the limited number.\n   */\n  @State() showAll: boolean = false;\n\n  /**\n   * Toggles between showing all remarks or only a limited number.\n   *\n   * Example:\n   * ```ts\n   * this.toggleShowAll(); // flips showAll state\n   * ```\n   */\n  private toggleShowAll = () => {\n    this.showAll = !this.showAll;\n  };\n\n  render() {\n    if (!this.remarks) {\n      return null;\n    }\n\n    const displayedRemarks = this.showAll ? this.remarks : this.remarks.slice(0, this.maxVisibleItems);\n\n    return (\n      <Host>\n        <p class={'label_title'}>{this.label}</p>\n        <ul class=\"ota-message-list\">\n          {displayedRemarks.map((remark, index) => (\n            <li key={v4()} class=\"ota-message-item\">\n              {remark.statement}{' '}\n              {this.remarks.length > this.maxVisibleItems && index === displayedRemarks.length - 1 && (\n                <button class=\"ota-visibility-toggle\" onClick={this.toggleShowAll}>\n                  {this.showAll ? locales.entries.Lcz_ShowLess : locales.entries.Lcz_ShowMore}\n                </button>\n              )}\n            </li>\n          ))}\n        </ul>\n        {/* Show toggle button if there are more remarks than `maxVisibleItems` */}\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}