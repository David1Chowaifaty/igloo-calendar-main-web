import{r as t,c as e,h as i,H as s}from"./p-acddcbeb.js";import{P as n,p as o}from"./p-ddeedd0d.js";import{i as l}from"./p-3b76fc4f.js";import{l as a}from"./p-e58470d9.js";import"./p-bf44a732.js";import"./p-2925ded6.js";const r=".sc-ir-option-details-h{display:block}";const h=r;const c=".sc-ir-option-details-h{height:100%}.sheet-container.sc-ir-option-details{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-option-details{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-option-details{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-option-details{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-option-details{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-option-details{flex-direction:row;align-items:center}}";const d=c;const p=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.toast=e(this,"toast",7)}propertyId;localizationIdx;selectedLanguage=null;invalid=false;closeModal;toast;paymentOptionService=new n;async componentWillLoad(){if(o.selectedOption.code!=="005"){return}if(!o.languages){const t=await this.paymentOptionService.GetExposedLanguages();o.languages=t}const t=o.selectedOption.localizables??[];this.selectedLanguage=o.languages[0].id.toString();if(t.length===0){t.push(this.createBankTransferInfoObject(o.languages[0]))}this.localizationIdx=o.selectedOption.code==="005"?t?.findIndex((t=>t.language.id.toString()===this.selectedLanguage)):null;o.selectedOption={...o.selectedOption,localizables:t}}createBankTransferInfoObject(t){return{code:"BANK_TRANSFER_INFO",description:"",id:null,language:t}}async saveOption(t){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();let e={...o.selectedOption,property_id:this.propertyId,is_active:o.mode==="create"?true:o.selectedOption.is_active??false};if(e?.code==="005"){const t=e.localizables.find((t=>t.language.code.toLowerCase()==="en"))?.description;if(!t||t.trim()===""||this.isEditorEmpty(t.trim())){this.selectedLanguage=o.languages.find((t=>t.code.toLowerCase()==="en")).id.toString();this.localizationIdx=o.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage));this.invalid=true;return}}if(e.is_payment_gateway){e.display_order=0;const t=e.data.some((t=>!t.value||t.value===""));if(t){this.invalid=true;return}}await this.paymentOptionService.HandlePaymentMethod(e);this.toast.emit({type:"success",description:"",title:a.entries.Lcz_Saved,position:"top-right"});this.closeModal.emit(e)}isEditorEmpty(t){const e=t.replace(/<\/?[^>]+(>|$)/g,"").replace(/&nbsp;/g,"").trim();return e.length===0}handleSelectChange(t){t.stopImmediatePropagation();t.stopPropagation();if(o.selectedOption.code!=="005"){return}this.selectedLanguage=t.detail;let e=o.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage));const i=o.selectedOption.localizables??[];if(e===-1){i.push(this.createBankTransferInfoObject(o.languages.find((t=>t.id.toString()===this.selectedLanguage))));o.selectedOption={...o.selectedOption,localizables:i};e=i.length-1}this.localizationIdx=e}handleTextAreaChange(t){const e=t.detail;if(e.trim()!==""&&this.invalid){this.invalid=false}const i=[...o.selectedOption.localizables];i[this.localizationIdx]={...i[this.localizationIdx],description:e};o.selectedOption={...o.selectedOption,localizables:i}}handlePaymentGatewayInfoChange(t,e){const i=t.detail;const s=[...o.selectedOption.data];s[e]={...s[e],value:i};o.selectedOption={...o.selectedOption,data:s}}render(){if(!o.selectedOption){return null}return i(s,null,i("form",{class:"sheet-container",onSubmit:this.saveOption.bind(this)},i("ir-title",{class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:a?.entries.Lcz_Information?.replace("%1",o.selectedOption?.description),displayContext:"sidebar"}),i("div",{class:"sheet-body px-1"},o.selectedOption.code==="005"?i("div",null,i("div",{class:"mb-1"},i("ir-select",{selectedValue:this.selectedLanguage,showFirstOption:false,data:o.languages.map((t=>({text:t.description,value:t.id.toString()})))})),i("div",null,this.invalid&&i("p",{class:"text-danger p-0 m-0"},a.entries.Lcz_YouMustFillEnglishField),i("ir-text-editor",{maxLength:450,placeholder:"",style:{"--ir-editor-height":"250px"},error:this.invalid,value:this.localizationIdx!==null?o.selectedOption?.localizables[this.localizationIdx]?.description??"":"",onTextChange:this.handleTextAreaChange.bind(this)}))):i("div",null,o.selectedOption.data?.map(((t,e)=>i("fieldset",{key:t.key},i("ir-input-text",{value:t.value,onTextChange:t=>this.handlePaymentGatewayInfoChange(t,e),id:`input_${t.key}`,label:t.key.replace(/_/g," "),placeholder:"",labelWidth:4,"aria-invalid":this.invalid&&(t.value===null||(t.value??"")?.trim()==="")?"true":"false"})))))),i("div",{class:"sheet-footer"},i("ir-button",{onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:a.entries.Lcz_Cancel,btn_color:"secondary",btn_type:"button"}),i("ir-button",{btn_type:"submit",btn_styles:"justify-content-center align-items-center",class:"flex-fill",isLoading:l("/Handle_Payment_Method"),text:a.entries.Lcz_Save,btn_color:"primary"}))))}};p.style=h+d;export{p as ir_option_details};
//# sourceMappingURL=p-4e498cb6.entry.js.map