{"version":3,"names":["Auth","constructor","isAuthUsed","this","init","subscribe","callback","subscribers","push","unsubscribe","filter","sub","setIsAuthenticated","value","_isAuthenticated","notifySubscribers","isAuthenticated","forEach","Token","super","baseUrl","modifiedBaseUrl","axios","defaults","baseURL","getToken","token","setBaseUrl","url","initialize","isInterceptorAdded","interceptors","request","use","config","MissingTokenError","headers","Authorization","setToken","Error","message","name"],"sources":["src/models/Auth.ts","src/models/Token.ts"],"sourcesContent":["// import axios from 'axios';\r\n\r\nclass Auth {\r\n  private static isAuthUsed = false;\r\n  private static _isAuthenticated = false;\r\n  private static subscribers: Array<(isAuthenticated: boolean) => void> = [];\r\n\r\n  constructor() {\r\n    if (!Auth.isAuthUsed) {\r\n      this.init();\r\n    }\r\n  }\r\n  public async init() {\r\n    // axios.defaults.withCredentials = true;\r\n    // Auth.isAuthUsed = true;\r\n    // const { data } = await axios.post('/Is_Already_Athenticated');\r\n    // this.setIsAuthenticated(data.My_Result);\r\n  }\r\n  public subscribe(callback: (isAuthenticated: boolean) => void) {\r\n    Auth.subscribers.push(callback);\r\n  }\r\n  public unsubscribe(callback: (isAuthenticated: boolean) => void) {\r\n    Auth.subscribers = Auth.subscribers.filter(sub => sub !== callback);\r\n  }\r\n  public setIsAuthenticated(value: boolean) {\r\n    Auth._isAuthenticated = value;\r\n    Auth.notifySubscribers(value);\r\n  }\r\n\r\n  private static notifySubscribers(isAuthenticated: boolean) {\r\n    Auth.subscribers.forEach(callback => callback(isAuthenticated));\r\n  }\r\n  public isAuthenticated() {\r\n    return Auth._isAuthenticated;\r\n  }\r\n}\r\n\r\nexport default Auth;\r\n","import axios from 'axios';\nimport Auth from './Auth';\n\nclass Token extends Auth {\n  private baseUrl = 'https://gateway.igloorooms.com/IR';\n  private static token: string | null = '';\n  private static modifiedBaseUrl: boolean = false;\n  private static isInterceptorAdded = false;\n\n  constructor() {\n    super();\n    if (Token.modifiedBaseUrl) {\n      return;\n    }\n    Token.modifiedBaseUrl = true;\n    axios.defaults.baseURL = this.baseUrl;\n  }\n  public getToken() {\n    return Token.token;\n  }\n  public setBaseUrl(url: string) {\n    this.baseUrl = url;\n    axios.defaults.baseURL = this.baseUrl;\n  }\n  private initialize() {\n    if (Token.isInterceptorAdded) {\n      return;\n    }\n\n    axios.interceptors.request.use(config => {\n      if (!Token.token) {\n        throw new MissingTokenError();\n      }\n      config.headers.Authorization = Token.token;\n      // config.params = config.params || {};\n      // config.params.Ticket = Token.token;\n      return config;\n    });\n\n    Token.isInterceptorAdded = true;\n  }\n\n  public setToken(token: string) {\n    Token.token = token;\n    this.initialize();\n  }\n}\nexport default Token;\nexport class MissingTokenError extends Error {\n  constructor(message = 'Missing token!!') {\n    super(message);\n    this.name = 'MissingTokenError';\n  }\n}\n"],"mappings":"oCAEA,MAAMA,EAKJ,WAAAC,GACE,IAAKD,EAAKE,WAAY,CACpBC,KAAKC,M,EAGF,UAAMA,G,CAMN,SAAAC,CAAUC,GACfN,EAAKO,YAAYC,KAAKF,E,CAEjB,WAAAG,CAAYH,GACjBN,EAAKO,YAAcP,EAAKO,YAAYG,QAAOC,GAAOA,IAAQL,G,CAErD,kBAAAM,CAAmBC,GACxBb,EAAKc,iBAAmBD,EACxBb,EAAKe,kBAAkBF,E,CAGjB,wBAAOE,CAAkBC,GAC/BhB,EAAKO,YAAYU,SAAQX,GAAYA,EAASU,I,CAEzC,eAAAA,GACL,OAAOhB,EAAKc,gB,EA9BCd,EAAAE,WAAa,MACbF,EAAAc,iBAAmB,MACnBd,EAAAO,YAAyD,GCF1E,MAAMW,UAAclB,EAMlB,WAAAC,GACEkB,QANMhB,KAAAiB,QAAU,oCAOhB,GAAIF,EAAMG,gBAAiB,CACzB,M,CAEFH,EAAMG,gBAAkB,KACxBC,EAAMC,SAASC,QAAUrB,KAAKiB,O,CAEzB,QAAAK,GACL,OAAOP,EAAMQ,K,CAER,UAAAC,CAAWC,GAChBzB,KAAKiB,QAAUQ,EACfN,EAAMC,SAASC,QAAUrB,KAAKiB,O,CAExB,UAAAS,GACN,GAAIX,EAAMY,mBAAoB,CAC5B,M,CAGFR,EAAMS,aAAaC,QAAQC,KAAIC,IAC7B,IAAKhB,EAAMQ,MAAO,CAChB,MAAM,IAAIS,C,CAEZD,EAAOE,QAAQC,cAAgBnB,EAAMQ,MAGrC,OAAOQ,CAAM,IAGfhB,EAAMY,mBAAqB,I,CAGtB,QAAAQ,CAASZ,GACdR,EAAMQ,MAAQA,EACdvB,KAAK0B,Y,EAvCQX,EAAAQ,MAAuB,GACvBR,EAAAG,gBAA2B,MAC3BH,EAAAY,mBAAqB,M,MAyCzBK,UAA0BI,MACrC,WAAAtC,CAAYuC,EAAU,mBACpBrB,MAAMqB,GACNrC,KAAKsC,KAAO,mB","ignoreList":[]}