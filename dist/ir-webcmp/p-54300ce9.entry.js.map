{"version":3,"names":["IglBookPropertyService","setBookingInfoFromAutoComplete","context","res","bookedByInfoData","id","guest","email","firstName","first_name","lastName","last_name","countryId","country_id","isdCode","_b","_a","country_phone_prefix","_c","toString","contactNumber","mobile","selectedArrivalTime","arrival","emailGuest","subscribe_to_news_letter","message","remark","cardNumber","cardHolderName","expiryMonth","expiryYear","bookingNumber","booking_nbr","rooms","from_date","to_date","resetRoomsInfoAndMessage","defaultData","roomsInfo","onDataRoomUpdate","event","selectedUnits","isEdit","isEditBooking","name","units","data","key","changedKey","detail","roomCategoryKey","roomCategoryId","ratePlanKey","ratePlanId","this","shouldClearData","Map","initializeRoomCategoryIfNeeded","has","get","applyBookingEditToSelectedRoom","setSelectedRoomData","cleanupEmptyData","set","selectedRatePlans","totalRooms","inventory","delete","Object","assign","Array","fill","size","clear","guestName","roomId","calculateAmount","is_amount_modified","selected_variation","view_mode","rp_amount","total_days","nights","length","generateDailyRates","rate_plan","i","variation","amount","infant_nbr","variationService","VariationService","getVariationBasedOnInfants","variations","ratePlan","baseVariation","infants","map","n","date","night","discounted_amount","cost","getBookedRooms","check_in","check_out","notes","identifier","override_unit","unit","auto_check_in","roomTypeId","booking_store","ratePlanSelections","roomtype","rateplanId","rateplan","reserved","push","prepayment_amount_gross","occupancy","adult_nbr","children_nbr","child_nbr","Math","max","bed_preference","moment","format","days","city","address","dob","cci","prepareBookUserServiceParams","sourceOption","dateRangeData","Error","fromDate","Date","toDate","generateNewRooms","isEventType","bookingData","PR_ID","modifyBookingDetails","pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras","rest","__rest","assign_units","is_pms","booking","newBooking","event_type","currentRoomType","filteredRooms","filter","r","console","log","newRooms","in_out","code","isAgent","type","agent","tag","property","propertyid","booked_on","hour","getHours","minute","getMinutes","source","currency","nbr","holder_name","expiry_month","expiry_year","error","getRoomCategoryByRoomId","find","roomCategory","RATE_TYPE","setEditingRoomInfo","category","room_id","RATE_PLAN_ID","adultCount","ADULTS_COUNT","rate","RATE","rateType","roomCategoryName","ratePlanName","RATE_PLAN","NAME","cancelation","guarantee","adult_child_offering","iglBookPropertyCss","IglBookPropertyStyle0","sheetCss","IglBookPropertyStyle1","IglBookProperty","constructor","hostRef","showPaymentDetails","adultChildCount","adult","child","renderAgain","bookingHistory","initialRoomIds","showSplitBookingOption","sourceOptions","guestData","blockDatesData","ratePricingMode","bedPreferenceType","bookingService","BookingService","bookPropertyService","updatedBooking","MAX_HISTORY_LENGTH","componentWillLoad","roomTypes","modifyBookingStore","handleKeyDown","bind","initializeDefaultDateRange","defaultDateRange","initializeDefaultData","wasBlockedUnit","hasOwnProperty","fetchSetupEntriesAndInitialize","componentDidLoad","document","addEventListener","handleBodyOverflow","disconnectedCallback","removeEventListener","clearBooking","e","stopImmediatePropagation","stopPropagation","renderPage","handleSpiltBookingSelected","getExposedBooking","language","handleAdultChildChange","updateBookingHistory","adults","Number","children","onDateRangeSelect","opt","dates","checkIn","checkOut","checkBookingAvailability","handleSourceDropDown","value","selectedSource","description","gotoSplitPageTwo","gotoPage","handleButtonClicked","bookUser","closeWindow","resetReserved","animateIrSelect","emit","calculateTotalRooms","animateIrButton","toast","locales","entries","Lcz_SelectRatePlan","title","partialData","lastEntry","newEntry","_d","_f","_e","_h","_g","shift","FROM_DATE","TO_DATE","setupEntries","fetchSetupEntries","setSourceOptions","allowedBookingSources","setOtherProperties","initializeEventData","initializeEditBookingData","initializePage","CHILDREN_COUNT","roomName","GUEST","page","isGuestDataIncomplete","roomtypeId","isButtonDisabled","isValidProperty","comparedBy","undefined","bookingSource","SOURCE","arrivalTime","resetBookingStore","is_in_agent_mode","room_type_ids_to_update","room_type_ids","room","getBookingAvailability","agent_id","updateBooking","roomtype_id","reserveRooms","checkAndBlockDate","block_exposed_unit_props","isAvailable","every","rt","is_available_to_book","handleBlockDate","didReservation","el","querySelector","classList","add","setTimeout","closeBookingWindow","handleBlockDateUpdate","handleGuestInfoUpdate","guestRefKey","handleBookedByInfoUpdate","getPageBlockDatesView","h","Fragment","entryDate","ENTRY_DATE","onDataUpdateEvent","handlePageTwoDataUpdateEvent","auto_close","props","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","dateToFormattedString","NOTES","OPTIONAL_REASON","pr_id","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","blockUnit","setLoadingState","isLoading","serviceParams","doReservation","resetBookingEvt","resetLoadingState","getCurrentPage","render","Host","class","onClick","isRequestPending","BLOCK_DATES_TITLE","TITLE","onIconClickHandler","slot","xmlns","viewBox","height","width","d","defaultDaterange","eventType","selectedRooms","adultChildConstraints","propertyId","selectedGuestData","countries","defaultGuestData","isEditOrAddRoomEvent","text","Lcz_Cancel","btn_color","Lcz_Blockdates","iglBookPropertyFooterCss","IglBookPropertyFooterStyle0","IglBookPropertyFooter","disabled","editNext","label","renderButton","icon_name","icon_position","shouldRenderTwoButtons","btn_disabled","onClickHandler","buttonClicked","btn_styles","iconPosition","style","icon_style","paddingBottom","Lcz_Next","showBookAndCheckin","calendar_data","checkin_enabled","isSame","Lcz_Back","Lcz_Save","Lcz_Book","Lcz_BookAndChekcIn","iglBookingFormCss","IglBookingFormStyle0","IglBookingForm","initializeGuestData","selectedBookedByData","total","newSelectedUnits","getRate","totalNights","isRateModified","preference","forEach","dateDifference","TOTAL_PRICE","handleOnApplicationInfoDataUpdateEvent","index","categoryIdKey","updatedUnits","dataUpdateEvent","handleEventData","dateOption","Lcz_TotalPrice","formatAmount","symbol","values","val","rp","_","guestInfo","bookingType","rateplanSelection","roomIndex","baseData","iglBookingOverviewPageCss","IglBookingOverviewPageStyle0","IglBookingOverviewPage","getSplitBookings","splitBookingEvents","setMinDate","today","isAfter","minDate","splitBookingId","bookingDataDefaultDateRange","splitBookings","roomType","isBookDisabled","keys","roomInfoId","evt","roomsDataUpdate","irBookingDetailsCss","IrBookingDetailsStyle0","IrBookingDetails","ticket","is_from_front_desk","hasPrint","hasReceipt","hasDelete","hasMenu","hasRoomEdit","hasRoomDelete","hasRoomAdd","hasCheckIn","hasCheckOut","hasCloseButton","bookingItem","statusData","calendarData","rerenderFlag","sidebarState","isUpdateClicked","isPMSLogLoading","modalState","roomService","RoomService","paymentService","PaymentService","token","Token","printingBaseUrl","setToken","initializeApp","ticketChanged","newValue","oldValue","handleSideBarEvents","sidebarPayload","payload","handleIconClick","target","closeSidebar","Lcz_EmailBookingto","replace","loading","modalRef","openModal","openPrintingScreen","window","location","href","ID","EMAIL","PHONE","REFERENCE_TYPE","ARRIVAL","Lcz_AddingUnitToBooking","fromDateStr","toDateStr","BOOKING_NUMBER","ADD_ROOM_TO_BOOKING","ROOMS","handleResetExposedCancellationDueAmount","paymentActions","GetExposedCancellationDueAmount","currency_id","handleEditInitiated","handleRoomGuestsUpdate","guests","currentRoomIndex","findIndex","currentRoom","updatedRoom","sharing_persons","handleResetBooking","resetBooking","handleEditExtraService","selectedService","setRoomsData","roomServiceResp","roomsData","My_Result","roomtypes","expanded","roomResponse","languageTexts","countriesList","bookingDetails","bedPreference","Promise","all","getExposedProperty","aname","p","fetchLanguage","getCountries","getSetupEntriesByTableName","property_id","then","direction","myResult","allowed_payment_methods","paymentMethods","allowed_booking_sources","adult_child_constraints","calendar_legends","legendData","paymentCodesToShow","some","method","includes","warn","mode","version","open","system_id","url","axios","post","ExceptionMsg","handleCloseBookingWindow","handleDeleteFinish","bookingChanged","handleModalConfirm","sendBookingConfirmationEmail","closeModal","renderSidebarContent","handleClose","isInSideBar","headerShown","onCloseSideBar","bookingDates","from","to","defaultPickupData","numberOfPersons","onCloseModal","service","totalGuests","sharedPersons","checkin","hasEmail","status","is_editable","variant","showCheckin","handleRoomCheckin","showCheckout","handleRoomCheckout","bedPreferences","isEditable","myRoomTypeFoodCat","mealCodeName","short_name","bookingIndex","onDeleteFinished","Lcz_ExtraServices","modalBody","leftBtnText","rightBtnText","Lcz_Confirm","autoClose","ref","onConfirmModal","onCancelModal","side","onIrSidebarToggle","showCloseButton","onCloseBookingWindow","is_automatic_check_in_out","isSameOrAfter","isBefore","irBookingExtraNoteCss","IrBookingExtraNoteStyle0","IrBookingExtraNoteStyle1","IrBookingExtraNote","note","setNote","getPrivateNote","savePrivateNote","prevExtras","newExtraObj","oldPrivateNoteIndex","Is_Non_Technical_Change","onSubmit","preventDefault","Lcz_PrivateNote","displayContext","placeholder","Lcz_PrivateNote_MaxChar","maxLength","onTextChange","icon","btn_type","irBookingHeaderCss","IrBookingHeaderStyle0","IrBookingHeader","bookingStatus","confirmationBG","handleSelectChange","selectedValue","updateStatus","Lcz_SelectStatus","position","changeExposedBookingStatus","book_nbr","Lcz_StatusUpdatedSuccessfully","openDialog","currentDialogStatus","dialogRef","renderDialogBody","Lcz_Booking","channel_booking_nbr","gap","flexWrap","allowed_actions","selectContainerStyle","selectStyles","firstOption","Lcz_Select","b","textSize","Lcz_EventsLog","is_pms_enabled","Lcz_pms","colorVariants","danger","onOpenChange","irDialogCss","IrDialogStyle0","IrDialog","isOpen","prepareFocusTrap","body","overflow","openChange","handleOpenChange","focusableElements","focusableContent","shadowRoot","querySelectorAll","firstFocusableElement","lastFocusableElement","focus","ev","isTabPressed","shiftKey","activeElement","tabIndex","role","irEventsLogCss","IrEventsLogStyle0","IrEventsLog","init","bookingEvents","getExposedBookingEvents","opacity","String","padStart","second","user","irExtraServiceCss","IrExtraServiceStyle0","IrExtraService","deleteService","doBookingExtraService","is_remove","price","currencySymbol","booking_system_id","secondary","editExtraService","irModalRef","start_date","end_date","showDateDifference","iconAvailable","Lcz_Delete","leftBtnColor","rightBtnColor","modalTitle","Lcz_Confirmation","Lcz_ThisService","Lcz_FromThisBooking","ZIdInfo","z","object","union","string","min","literal","optional","number","ZSharedPerson","coerce","nullable","refine","isValid","transform","isDDMMYYYY","id_info","ZSharedPersons","array","ExtraServiceSchema","irExtraServiceConfigCss","IrExtraServiceConfigStyle0","IrExtraServiceConfigStyle1","IrExtraServiceConfig","s_service","saveAmenity","parse","ZodError","updateService","params","prevService","validatePrice","priceSchema","pick","result","safeParse","success","async","Lcz_Description","onChange","Lcz_DatesOn","emitEmptyDate","maxDate","onDateChanged","start","_formatDate","borderLeftWidth","borderRightWidth","borderRadius","Lcz_TillAndIncluding","_j","_k","_m","_l","zod","Lcz_Price","wrapKey","autoValidate","parseFloat","Lcz_Cost","labelStyle","_p","_o","irExtraServicesCss","IrExtraServicesStyle0","IrExtraServices","irGuestInfoCss","IrGuestInfoStyle0","IrGuestInfoStyle1","GuestInfo","getToken","fetchedLocales","fetchGuest","resolve","mobile_without_prefix","handleInputChange","editGuest","editExposedGuest","closeSideBar","Lcz_GuestDetails","Lcz_FirstName","required","Lcz_LastName","Lcz_Email","Lcz_AlternativeEmail","alternative_email","country","c","Lcz_Country","onCountryChange","phone_prefix","Lcz_MobilePhone","checked","onInput","Lcz_Newsletter","color","irPaymentActionsCss","IrPaymentActionsStyle0","IrPaymentActions","paymentAction","pa","due_on","generatePayment","irPaymentDetailsCss","IrPaymentDetailsStyle0","IrPaymentDetails","newTableRow","collapsedPayment","collapsedGuarantee","flag","confirmModal","paymentDetailsUrl","paymentExceptionMessage","modal_mode","paymentBackground","handlePaymentGeneration","itemToBeAdded","initializeItemToBeAdded","designation","reference","_processPaymentSave","Lcz_EnterAmount","financial","due_amount","_handleSave","AddPayment","resetExposedCancelationDueAmount","handlePaymentInputChange","isNaN","inputElement","inputValue","cancelPayment","CancelPayment","toBeDeletedItem","newPaymentArray","payments","item","handleConfirmModal","modal","handleCancelModal","handleBookingDetails","handleDateChange","end","_renderTableRow","rowMode","startOf","border","marginLeft","marginRight","inputStyle","rowSpan","colSpan","onKeyPress","formatCurrency","locale","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","bookingGuarantee","paymentMethod","getPaymentMethod","Lcz_BookingGuarantee","getPCICardInfoURL","_s","_r","_q","_u","_t","_x","_w","_v","_0","_z","_y","cvc","_3","_2","_1","src","frameborder","ota_guarante","content","_4","card_type","_5","is_virtual","labelText","Lcz_CardType","_6","cardholder_name","Lcz_CardHolderName","_7","card_number","Lcz_CardNumber","toFloat","_9","_8","meta","virtual_card_current_balance","_11","_10","virtual_card_decimal_places","_13","_12","virtual_card_currency_code","Lcz_CardBalance","checkPaymentCode","pm","payment_code","Lcz_OnCredit","_renderDueDate","gross_cost","Lcz_TotalCost","Lcz_Balance","Lcz_Collected","reduce","prev","curr","Lcz_Payments","backgroundColor","Lcz_Dates","Lcz_Amount","Lcz_Designation","Lcz_IfDeletedPermantlyLost","Lcz_EnteringAmountGreaterThanDue","PickupService","savePickup","splitTime","arrival_time","split","arrival_date","details","flight_details","nbr_of_units","number_of_vehicles","selected_option","due_upon_booking","transformDefaultPickupData","renderTime","toFixed","vehicle_type_code","vehicle","getAvailableLocations","locations","pickup_service","allowed_options","option","createPickupSchema","regex","dateStr","isBetween","time","hours","minutes","nonempty","validateForm","schema","err","issues","path","getNumberOfVehicles","capacity","total_number_of_vehicles","ceil","startNumber","bonus_number","getPickUpPersonStatus","getCodeDescription","allowed_pricing_models","model","updateDue","irPickupCss","IrPickupStyle0","IrPickupStyle1","IrPickup","allowedOptionsByLocation","pickupData","vehicleCapacity","cause","pickupService","arrival_time_mask","mask","blocks","HH","MaskedRange","placeholderChar","mm","lazy","transformedData","pickupSchema","handleLocationChange","updatePickupData","locationChoice","pricing_model","handleVehicleQuantityChange","handleVehicleTypeChange","errors","Lcz_Pickup","testId","onSelectChange","Lcz_Pickup_NoThankYou","LabelAvailable","Lcz_Pickup_YesFrom","Lcz_ArrivalDate","borderTopLeftRadius","borderBottomLeftRadius","Lcz_Time","inputStyles","Lcz_FlightDetails","showFirstOption","labelBorder","labelWidth","Lcz_NbrOfVehicles","readOnly","Lcz_DueUponBooking","irPickupViewCss","IrPickupViewStyle0","IrPickupView","is_enabled","Lcz_Date","_formatTime","pickup_instruction","pickup_cancelation_prepayment","irPmsLogsCss","IrPmsLogsStyle0","IrPmsLogs","pmsLogs","fetchPMSLogs","Lcz_PMS_Logs","Lcz_SentAt","sent_date","sent_hour","sent_minute","is_acknowledged","Lcz_YES","Lcz_NO","Lcz_Acknowledged","irReservationInformationCss","IrReservationInformationStyle0","IrReservationInformation","userCountry","guestCountryId","handleEditClick","openSidebar","renderPhoneNumber","selectedCountry","privateNote","Lcz_Source","origin","Label","image","Icon","alt","renderContentAsHtml","Lcz_BookedOn","Lcz_BookedBy","nbr_confirmed_bookings","Lcz_BookingsNbr","customSlot","Lcz_Phone","Lcz_Address","isCountryImage","display","Lcz_GuestPrivateNote","Lcz_ArrivalTime","Lcz_Coupon","Lcz_LoyaltyDiscountApplied","Lcz_GuestRemark","Lcz_ChannelNotes","remarks","ota_notes","maxVisibleItems","Lcz_BookingPrivateNote","Lcz_VisibleToHotelOnly","irRoomCss","IrRoomStyle0","IrRoom","collapsed","modalReason","isModelOpen","mainGuest","getMainGuest","handleClick","pressCheckIn","pressCheckOut","handleRoomDataChange","getDateStr","getDate","toLocaleString","month","getFullYear","editInitiated","formatName","Lcz_EditBookingFor","ARRIVAL_TIME","COUNTRY","FROM_DATE_STR","IDENTIFIER","IS_EDITABLE","NO_OF_DAYS","POOL","SPLIT_BOOKING","STATUS","TO_DATE_STR","PICKUP_INFO","reason","handleModalConfirmation","deleteRoom","handleExposedRoomInOut","room_identifier","resetbooking","oldRooms","deleteFinished","formatVariation","childCount","infantCount","adultLabel","Lcz_Adults","toLowerCase","Lcz_Adult","childLabel","Lcz_Children","Lcz_Child","infantLabel","Lcz_Infants","Lcz_Infant","parts","join","getSmokingLabel","smoking_option","currRT","allowed_smoking_options","s","ota_meta","smoking_preferences","getBedName","bed","CODE_NAME","CODE_VALUE_EN","bed_preferences","renderModalMessage","handleCheckIn","showGuestModal","is_main","fontWeight","is_non_refundable","Lcz_NonRefundable","isSingleUnit","is_frontdesk_enabled","Lcz_CheckIn","Lcz_CheckOut","btnStyle","margin","padding","fontSize","textAlign","lineHeight","innerHTML","Lcz_Breakdown","_getDay","Lcz_SubTotal","filtered_data","taxes","tx","pct","is_exlusive","Lcz_Excluding","Lcz_Including","ota_taxes","Lcz_SmokingOptions","Lcz_Cancellation","Lcz_Guarantee","Lcz_MealPlan","meal_plan","Lcz_Policies","policies","defaultGuest","full_name","password","dateMask","pattern","str","autofix","YYYY","MM","DD","irRoomGuestsCss","IrRoomGuestsStyle0","IrRoomGuests","idTypes","initializeGuests","getUserDefaultCountry","propertyCountry","COUNTRY_ID","defaultGuestsCount","g","updateGuestInfo","tempGuests","tempGuest","saveGuests","handleExposedRoomGuests","updateRoomGuests","minWidth","Lcz_MainGuest","Lcz_DOB","Lcz_Nationality","Lcz_Documents","idx","Lcz_PersonsSharingRoom","selectForcedStyles","borderTopRightRadius","borderBottomRightRadius","borderRight","t","toUpperCase","inputForcedStyle","otaLabelCss","OtaLabelStyle0","OtaLabel","showAll","toggleShowAll","displayedRemarks","slice","v4","statement","Lcz_ShowLess","Lcz_ShowMore"],"sources":["src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts","src/components/igloo-calendar/igl-book-property/igl-book-property.css?tag=igl-book-property&encapsulation=scoped","src/common/sheet.css?tag=igl-book-property&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.css?tag=igl-book-property-footer&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.css?tag=igl-booking-form&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.css?tag=igl-booking-overview-page&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.tsx","src/components/ir-booking-details/ir-booking-details.css?tag=ir-booking-details&encapsulation=scoped","src/components/ir-booking-details/ir-booking-details.tsx","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.css?tag=ir-booking-extra-note&encapsulation=scoped","src/common/sheet.css?tag=ir-booking-extra-note&encapsulation=scoped","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx","src/components/ir-booking-details/ir-booking-header/ir-booking-header.css?tag=ir-booking-header&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-booking-header.tsx","src/components/ui/ir-dialog/ir-dialog.css?tag=ir-dialog&encapsulation=shadow","src/components/ui/ir-dialog/ir-dialog.tsx","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.css?tag=ir-events-log&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.css?tag=ir-extra-service&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.tsx","src/models/booking.dto.ts","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.css?tag=ir-extra-service-config&encapsulation=scoped","src/common/sheet.css?tag=ir-extra-service-config&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-services.css?tag=ir-extra-services&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-services.tsx","src/components/ir-guest-info/ir-guest-info.css?tag=ir-guest-info&encapsulation=scoped","src/common/sheet.css?tag=ir-guest-info&encapsulation=scoped","src/components/ir-guest-info/ir-guest-info.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-actions.css?tag=ir-payment-actions&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-actions.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-details.css?tag=ir-payment-details&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-details.tsx","src/components/ir-booking-details/ir-pickup/pickup.service.ts","src/components/ir-booking-details/ir-pickup/ir-pickup.css?tag=ir-pickup&encapsulation=scoped","src/common/sheet.css?tag=ir-pickup&encapsulation=scoped","src/components/ir-booking-details/ir-pickup/ir-pickup.tsx","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.css?tag=ir-pickup-view&encapsulation=scoped","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.tsx","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.css?tag=ir-pms-logs&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.tsx","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.css?tag=ir-reservation-information&encapsulation=scoped","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.tsx","src/components/ir-booking-details/ir-room/ir-room.css?tag=ir-room&encapsulation=scoped","src/components/ir-booking-details/ir-room/ir-room.tsx","src/components/ir-booking-details/ir-room-guests/data.ts","src/components/ir-booking-details/ir-room-guests/ir-room-guests.css?tag=ir-room-guests&encapsulation=scoped","src/components/ir-booking-details/ir-room-guests/ir-room-guests.tsx","src/components/ui/ota-label/ota-label.css?tag=ota-label&encapsulation=scoped","src/components/ui/ota-label/ota-label.tsx"],"sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\r\nimport { TSourceOption } from '@/models/igl-book-property';\r\nimport VariationService from '@/services/variation.service';\r\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\r\nimport { extras } from '@/utils/utils';\r\nimport moment from 'moment';\r\n\r\nexport class IglBookPropertyService {\r\n  private variationService: VariationService;\r\n  public setBookingInfoFromAutoComplete(context, res) {\r\n    context.bookedByInfoData = {\r\n      id: res.guest.id,\r\n      email: res.guest.email,\r\n      firstName: res.guest.first_name,\r\n      lastName: res.guest.last_name,\r\n      countryId: res.guest.country_id,\r\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\r\n      contactNumber: res.guest.mobile,\r\n      selectedArrivalTime: res.arrival,\r\n      emailGuest: res.guest.subscribe_to_news_letter,\r\n      message: res.remark,\r\n      cardNumber: '',\r\n      cardHolderName: '',\r\n      expiryMonth: '',\r\n      expiryYear: '',\r\n      bookingNumber: res.booking_nbr,\r\n      rooms: res.rooms,\r\n      from_date: res.from_date,\r\n      to_date: res.to_date,\r\n    };\r\n  }\r\n\r\n  public resetRoomsInfoAndMessage(context) {\r\n    context.defaultData.roomsInfo = [];\r\n    context.message = '';\r\n  }\r\n\r\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\r\n    let units = selectedUnits;\r\n    const { data, key, changedKey } = event.detail;\r\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\r\n    const ratePlanKey = `p_${data.ratePlanId}`;\r\n\r\n    if (this.shouldClearData(key)) {\r\n      units = new Map();\r\n    }\r\n\r\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\r\n\r\n    if (isEditBooking) {\r\n      if (changedKey === 'rate') {\r\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\r\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\r\n        }\r\n      } else {\r\n        if (changedKey !== 'rateType') {\r\n          if (changedKey === 'adult_child_offering') {\r\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\r\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\r\n            }\r\n          } else {\r\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\r\n    }\r\n    this.cleanupEmptyData(roomCategoryKey, units);\r\n    return units;\r\n  }\r\n\r\n  private shouldClearData(key: string | undefined): boolean {\r\n    return key === 'clearData' || key === 'EDIT_BOOKING';\r\n  }\r\n\r\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\r\n    if (!selectedUnits.has(roomCategoryKey)) {\r\n      selectedUnits.set(roomCategoryKey, new Map());\r\n    }\r\n  }\r\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\r\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\r\n    if (data.totalRooms === 0 || data.inventory === 0) {\r\n      selectedRatePlans.delete(ratePlanKey);\r\n    } else {\r\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\r\n    }\r\n  }\r\n\r\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\r\n    if (selectedUnits.has(roomCategoryKey)) {\r\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\r\n      if (selectedRatePlans.size === 0) {\r\n        selectedUnits.delete(roomCategoryKey);\r\n      }\r\n    }\r\n  }\r\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\r\n    selectedUnits.clear();\r\n    let res = {};\r\n    if (isEdit) {\r\n      res = { ...data, guestName: name || '', roomId: '' };\r\n    } else {\r\n      res = { ...data };\r\n    }\r\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\r\n  }\r\n\r\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\r\n    const total_days = selected_variation.nights.length;\r\n    if (is_amount_modified) {\r\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\r\n    }\r\n  }\r\n\r\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\r\n    let variation = rate_plan.selected_variation;\r\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\r\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\r\n      if (!this.variationService) {\r\n        this.variationService = new VariationService();\r\n      }\r\n      variation = this.variationService.getVariationBasedOnInfants({\r\n        variations: rate_plan.ratePlan.variations,\r\n        baseVariation: rate_plan.selected_variation,\r\n        infants: rate_plan.guest[i].infant_nbr,\r\n      });\r\n    }\r\n    return variation.nights.map(n => ({\r\n      date: n.night,\r\n      amount: amount ?? n.discounted_amount,\r\n      cost: null,\r\n    }));\r\n  }\r\n\r\n  // private extractFirstNameAndLastName(name: string) {\r\n  //   const names = name.split(' ');\r\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\r\n  // }\r\n\r\n  private getBookedRooms({\r\n    check_in,\r\n    check_out,\r\n    notes,\r\n    identifier,\r\n    override_unit,\r\n    unit,\r\n    auto_check_in,\r\n  }: {\r\n    identifier: string | null;\r\n    check_in: Date;\r\n    check_out: Date;\r\n    override_unit: boolean;\r\n    unit: string;\r\n    notes: string | null;\r\n    auto_check_in: boolean;\r\n  }) {\r\n    const rooms = [];\r\n\r\n    for (const roomTypeId in booking_store.ratePlanSelections) {\r\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\r\n      for (const rateplanId in roomtype) {\r\n        const rateplan = roomtype[rateplanId];\r\n        if (rateplan.reserved > 0) {\r\n          for (let i = 0; i < rateplan.reserved; i++) {\r\n            const { first_name, last_name } = rateplan.guest[i];\r\n            rooms.push({\r\n              identifier,\r\n              roomtype: rateplan.roomtype,\r\n              rateplan: rateplan.ratePlan,\r\n              prepayment_amount_gross: 0,\r\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\r\n              occupancy: {\r\n                adult_nbr: rateplan.selected_variation.adult_nbr,\r\n                children_nbr: rateplan.selected_variation.child_nbr - Math.max(rateplan.guest[i].infant_nbr, 0),\r\n                infant_nbr: rateplan.guest[i].infant_nbr,\r\n              },\r\n              bed_preference: rateplan.guest[i].bed_preference,\r\n              from_date: moment(check_in).format('YYYY-MM-DD'),\r\n              to_date: moment(check_out).format('YYYY-MM-DD'),\r\n              notes,\r\n              check_in: auto_check_in,\r\n              days: this.generateDailyRates(rateplan, i),\r\n              guest: {\r\n                email: null,\r\n                first_name,\r\n                last_name,\r\n                country_id: null,\r\n                city: null,\r\n                mobile: null,\r\n                address: null,\r\n                dob: null,\r\n                subscribe_to_news_letter: null,\r\n                cci: null,\r\n              },\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return rooms;\r\n  }\r\n\r\n  async prepareBookUserServiceParams({ context, sourceOption, check_in }: { context: any; sourceOption: TSourceOption; check_in: boolean }) {\r\n    try {\r\n      // Validate context structure\r\n      if (!context || !context.dateRangeData) {\r\n        throw new Error('Invalid context: Missing date range data.');\r\n      }\r\n\r\n      const fromDate = new Date(context.dateRangeData.fromDate);\r\n      const toDate = new Date(context.dateRangeData.toDate);\r\n\r\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\r\n        return this.getBookedRooms({\r\n          check_in: fromDate,\r\n          check_out: toDate,\r\n          identifier,\r\n          notes: '',\r\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\r\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\r\n          auto_check_in: check_in,\r\n        });\r\n      };\r\n\r\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\r\n        return {\r\n          assign_units: true,\r\n          is_pms: true,\r\n          is_direct,\r\n          is_in_loyalty_mode,\r\n          promo_key,\r\n          extras,\r\n          booking: {\r\n            ...rest,\r\n            rooms,\r\n          },\r\n          extra_services,\r\n          pickup_info,\r\n        };\r\n      };\r\n\r\n      let newBooking = null;\r\n\r\n      switch (context.defaultData.event_type) {\r\n        case 'EDIT_BOOKING': {\r\n          const { booking, currentRoomType } = context.defaultData;\r\n\r\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\r\n          console.log('currentRoomType', currentRoomType);\r\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\r\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\r\n          break;\r\n        }\r\n        case 'ADD_ROOM':\r\n        case 'SPLIT_BOOKING': {\r\n          const { booking } = context.defaultData;\r\n          if (!booking) {\r\n            throw new Error('Missing booking');\r\n          }\r\n          console.log(booking);\r\n          const newRooms = generateNewRooms();\r\n          newBooking = modifyBookingDetails(booking, [...booking?.rooms, ...newRooms]);\r\n          break;\r\n        }\r\n        default: {\r\n          const newRooms = generateNewRooms(null, check_in);\r\n          const { bookedByInfoData } = context;\r\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\r\n          newBooking = {\r\n            assign_units: true,\r\n            is_pms: true,\r\n            is_direct: true,\r\n            is_in_loyalty_mode: false,\r\n            promo_key: null,\r\n            extras,\r\n            agent: isAgent ? { id: sourceOption.tag } : null,\r\n            booking: {\r\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\r\n              to_date: moment(toDate).format('YYYY-MM-DD'),\r\n              remark: bookedByInfoData.message || null,\r\n              booking_nbr: '',\r\n              property: {\r\n                id: context.propertyid,\r\n              },\r\n              booked_on: {\r\n                date: moment().format('YYYY-MM-DD'),\r\n                hour: new Date().getHours(),\r\n                minute: new Date().getMinutes(),\r\n              },\r\n              source: isAgent ? '' : sourceOption,\r\n              rooms: newRooms,\r\n              currency: context.currency,\r\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\r\n              guest: {\r\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\r\n                first_name: bookedByInfoData.firstName,\r\n                last_name: bookedByInfoData.lastName,\r\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\r\n                city: null,\r\n                mobile: bookedByInfoData.contactNumber === null ? '' : bookedByInfoData.contactNumber,\r\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\r\n                address: '',\r\n                dob: null,\r\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\r\n                cci: bookedByInfoData.cardNumber\r\n                  ? {\r\n                      nbr: bookedByInfoData.cardNumber,\r\n                      holder_name: bookedByInfoData.cardHolderName,\r\n                      expiry_month: bookedByInfoData.expiryMonth,\r\n                      expiry_year: bookedByInfoData.expiryYear,\r\n                    }\r\n                  : null,\r\n              },\r\n            },\r\n            pickup_info: null,\r\n          };\r\n          break;\r\n        }\r\n      }\r\n      return newBooking;\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  private getRoomCategoryByRoomId(bookingData) {\r\n    return bookingData.roomsInfo?.find(roomCategory => {\r\n      return roomCategory.id === bookingData.RATE_TYPE;\r\n    });\r\n  }\r\n  public setEditingRoomInfo(bookingData, selectedUnits) {\r\n    const category = this.getRoomCategoryByRoomId(bookingData);\r\n    const room_id = !category ? '' : `c_${category?.id}`;\r\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\r\n    const data = {\r\n      adultCount: bookingData.ADULTS_COUNT,\r\n      rate: bookingData.RATE,\r\n      rateType: bookingData.RATE_TYPE,\r\n      ratePlanId: bookingData.RATE_PLAN_ID,\r\n      roomCategoryId: category ? category.id : '',\r\n      roomCategoryName: category ? category.name : '',\r\n      totalRooms: 1,\r\n      ratePlanName: bookingData.RATE_PLAN,\r\n      roomId: bookingData.PR_ID,\r\n      guestName: bookingData.NAME,\r\n      cancelation: bookingData.cancelation,\r\n      guarantee: bookingData.guarantee,\r\n      adult_child_offering: bookingData.adult_child_offering,\r\n    };\r\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\r\n  }\r\n}\r\n",":host {\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  width: 100vw;\r\n  min-height: 100vh;\r\n  z-index: 99;\r\n  overflow: hidden;\r\n  /* min-width: 450px; */\r\n}\r\n\r\n.card-title {\r\n  border-bottom: 1px solid #e4e5ec;\r\n  width: 100%;\r\n}\r\n.card-header-container {\r\n  border-bottom: 1px solid #e4e5ec;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  padding: 1rem 0;\r\n  justify-content: space-between;\r\n}\r\n.loading-container {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n.card-header-container h3 {\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\n.background-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.25);\r\n}\r\n\r\n.formContainer {\r\n  height: calc(100% - 79px);\r\n  overflow: auto;\r\n}\r\n.gap-30 {\r\n  gap: 30px;\r\n}\r\n.block-date {\r\n  width: 100%;\r\n}\r\n.sideWindow {\r\n  position: absolute;\r\n  inset: 0;\r\n  left: unset;\r\n  background-color: #ffffff;\r\n  width: 100%;\r\n  overflow: auto;\r\n  animation: slideInFromRight 0.5s;\r\n}\r\n.card {\r\n  top: 0;\r\n  z-index: 1000;\r\n}\r\n\r\n.close {\r\n  float: right;\r\n  font-size: 1.5rem;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #000;\r\n  text-shadow: 0 1px 0 #fff;\r\n  opacity: 0.5;\r\n  padding: 0;\r\n  background-color: transparent;\r\n  border: 0;\r\n  appearance: none;\r\n}\r\n\r\n.close-icon {\r\n  position: absolute;\r\n  top: 18px;\r\n  right: 33px;\r\n  outline: none;\r\n}\r\n\r\nbutton:not(:disabled),\r\n[type='button']:not(:disabled) {\r\n  cursor: pointer;\r\n}\r\n.sheet-footer {\r\n  width: 100%;\r\n}\r\n\r\n/* .row {\r\n  padding: 0 0 0 15px;\r\n  margin: 0;\r\n} */\r\n@media only screen and (min-width: 1200px) {\r\n  .sideWindow {\r\n    max-width: 70%;\r\n  }\r\n}\r\n@media only screen and (min-width: 2000px) {\r\n  .sideWindow {\r\n    max-width: 40%;\r\n  }\r\n}\r\n@media only screen and (min-width: 768px) and (max-width: 1200px) {\r\n  .sideWindow {\r\n    max-width: 90%;\r\n  }\r\n}\r\n@media only screen and (min-width: 600px) and (max-width: 768px) {\r\n  .sideWindow {\r\n    max-width: 75%;\r\n  }\r\n}\r\n@media only screen and (min-width: 641px) {\r\n  .block-date {\r\n    max-width: 450px;\r\n    padding-bottom: 0 !important;\r\n  }\r\n}\r\n@keyframes slideInFromRight {\r\n  from {\r\n    transform: translateX(120%);\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n  }\r\n}\r\n@keyframes slideOutToRight {\r\n  from {\r\n    transform: translateX(0);\r\n  }\r\n  to {\r\n    transform: translateX(120%);\r\n  }\r\n}\r\n\r\n.sideWindow--exit {\r\n  animation: slideOutToRight 0.5s forwards;\r\n}\r\n",":host {\r\n  height: 100%;\r\n}\r\n.sheet-container {\r\n  display: flex !important;\r\n  flex-direction: column !important;\r\n  background: white;\r\n  height: 100% !important;\r\n  gap: 1rem;\r\n}\r\n.sheet-footer {\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 20;\r\n  background: white;\r\n  border-top: 1px solid #e4e5ec;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  gap: 0.5rem;\r\n}\r\n.sheet-header {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  background: white;\r\n}\r\n.sheet-body {\r\n  flex: 1 1 0%;\r\n}\r\n@media (min-width: 768px) {\r\n  .sheet-footer {\r\n    flex-direction: row;\r\n    align-items: center;\r\n  }\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, State, h, Listen, Fragment } from '@stencil/core';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { dateToFormattedString, getReleaseHoursString, handleBodyOverflow } from '@/utils/utils';\r\nimport { ICountry, IEntries, RoomBlockDetails } from '@/models/IBooking';\r\nimport { IPageTwoDataUpdateProps } from '@/models/models';\r\nimport { IglBookPropertyService } from './igl-book-property.service';\r\nimport { IglBookPropertyPayloadEditBooking, TAdultChildConstraints, TEventType, TPropertyButtonsTypes, TSourceOption, TSourceOptions } from '@/models/igl-book-property';\r\nimport locales from '@/stores/locales.store';\r\nimport { IToast } from '@/components/ui/ir-toast/toast';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { ICurrency } from '@/models/calendarData';\r\nimport booking_store, { calculateTotalRooms, modifyBookingStore, reserveRooms, resetBookingStore, resetReserved } from '@/stores/booking.store';\r\nimport moment from 'moment';\r\nexport type IHistoryEntry = {\r\n  dates: { checkIn: Date; checkOut: Date };\r\n  adults: number;\r\n  children: number;\r\n};\r\n@Component({\r\n  tag: 'igl-book-property',\r\n  styleUrls: ['igl-book-property.css', '../../../common/sheet.css'],\r\n  scoped: true,\r\n})\r\nexport class IglBookProperty {\r\n  @Prop() propertyid: number;\r\n  @Prop() allowedBookingSources: any;\r\n  @Prop() language: string;\r\n  @Prop() countries: ICountry[];\r\n  @Prop() showPaymentDetails: boolean = false;\r\n  @Prop() currency: ICurrency;\r\n  @Prop({ reflect: true, mutable: true }) bookingData: { [key: string]: any };\r\n  @Prop() adultChildConstraints: TAdultChildConstraints;\r\n\r\n  @State() adultChildCount: { adult: number; child: number } = { adult: 0, child: 0 };\r\n  @State() renderAgain: boolean = false;\r\n  @State() dateRangeData: { [key: string]: any };\r\n  @State() defaultData: any;\r\n  @State() isLoading: string;\r\n  @State() bookingHistory: Array<{\r\n    dates: { checkIn: Date; checkOut: Date };\r\n    adults: number;\r\n    children: number;\r\n  }> = [];\r\n\r\n  @Event() closeBookingWindow: EventEmitter<{ [key: string]: any }>;\r\n  @Event() blockedCreated: EventEmitter<RoomBlockDetails>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\r\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\r\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\r\n\r\n  private initialRoomIds: { roomName: string; ratePlanId: number; roomId: string; roomTypeId: string } | null = null;\r\n  private sourceOption: TSourceOption;\r\n  private page: string;\r\n  private showSplitBookingOption: boolean = false;\r\n  private sourceOptions: TSourceOptions[] = [];\r\n  private guestData: { [key: string]: any }[] = [];\r\n  private bookedByInfoData: { [key: string]: any } = {};\r\n  private blockDatesData: { [key: string]: any } = {};\r\n  private ratePricingMode: IEntries[] = [];\r\n  private selectedUnits: Map<string, Map<string, any>> = new Map();\r\n  private bedPreferenceType: IEntries[] = [];\r\n  private bookingService: BookingService = new BookingService();\r\n  private bookPropertyService = new IglBookPropertyService();\r\n  private defaultDateRange: { from_date: string; to_date: string };\r\n  private updatedBooking: boolean = false;\r\n  private MAX_HISTORY_LENGTH: number = 2;\r\n  private didReservation: boolean;\r\n  private wasBlockedUnit: boolean;\r\n\r\n  async componentWillLoad() {\r\n    console.log('<==>roomtypes<==>', booking_store?.roomTypes);\r\n    if (booking_store.roomTypes) {\r\n      modifyBookingStore('roomTypes', []);\r\n      modifyBookingStore('ratePlanSelections', {});\r\n    }\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    this.initializeDefaultDateRange();\r\n\r\n    if (!this.bookingData.defaultDateRange) {\r\n      return;\r\n    }\r\n    // console.log(this.bookingData);\r\n    this.initializeDefaultData();\r\n    this.wasBlockedUnit = this.defaultData.hasOwnProperty('block_exposed_unit_props');\r\n    modifyBookingStore('event_type', { type: this.defaultData.event_type });\r\n    this.fetchSetupEntriesAndInitialize();\r\n  }\r\n\r\n  componentDidLoad() {\r\n    document.addEventListener('keydown', this.handleKeyDown);\r\n    handleBodyOverflow(true);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    document.removeEventListener('keydown', this.handleKeyDown);\r\n  }\r\n\r\n  @Listen('inputCleared')\r\n  clearBooking(e: CustomEvent) {\r\n    if (this.isEventType('SPLIT_BOOKING')) {\r\n      e.stopImmediatePropagation();\r\n      e.stopPropagation();\r\n      this.bookedByInfoData = {};\r\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\r\n      this.renderPage();\r\n    }\r\n  }\r\n\r\n  @Listen('spiltBookingSelected')\r\n  async handleSpiltBookingSelected(e: CustomEvent<{ key: string; data: unknown }>) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    const { key, data } = e.detail;\r\n    if (key === 'select' || (key === 'blur' && data !== '')) {\r\n      const res = await this.bookingService.getExposedBooking((data as any).booking_nbr || (data as string), this.language);\r\n      this.defaultData = { ...this.defaultData, booking: res };\r\n      this.bookPropertyService.setBookingInfoFromAutoComplete(this, res);\r\n      this.sourceOption = res.source;\r\n      this.renderPage();\r\n    }\r\n  }\r\n\r\n  // @Listen('adultChild')\r\n  // handleAdultChildChange(event: CustomEvent) {\r\n  //   if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\r\n  //     this.bookPropertyService.resetRoomsInfoAndMessage(this);\r\n  //   }\r\n  //   const { adult, child } = event.detail;\r\n  //   this.adultChildCount = { ...event.detail };\r\n  //   this.updateBookingHistory({ adults: adult, children: child });\r\n  // }\r\n  @Listen('adultChild')\r\n  handleAdultChildChange(event: CustomEvent) {\r\n    if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\r\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\r\n    }\r\n    const { adult, child } = event.detail;\r\n    this.adultChildCount = { ...event.detail };\r\n\r\n    // Update the booking history\r\n    this.updateBookingHistory({ adults: Number(adult), children: Number(child) });\r\n  }\r\n\r\n  @Listen('dateSelectEvent')\r\n  onDateRangeSelect(event: CustomEvent<{ [key: string]: any }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const opt: { [key: string]: any } = event.detail;\r\n    this.updateBookingHistory({\r\n      dates: {\r\n        checkIn: new Date(this.dateRangeData.fromDate),\r\n        checkOut: new Date(new Date(opt.data.toDate)),\r\n      },\r\n    });\r\n    console.log('date changed', opt);\r\n    if (opt.key === 'selectedDateRange') {\r\n      this.dateRangeData = opt.data;\r\n      if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\r\n        this.defaultData.roomsInfo = [];\r\n      } else if (this.adultChildCount.adult !== 0) {\r\n        this.checkBookingAvailability();\r\n        // this.checkBookingAvailability(dateToFormattedString(new Date(this.dateRangeData.fromDate)), dateToFormattedString(new Date(this.dateRangeData.toDate)));\r\n      }\r\n    }\r\n  }\r\n  @Listen('sourceDropDownChange')\r\n  handleSourceDropDown(event: CustomEvent) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const value = event.detail;\r\n    const selectedSource = this.sourceOptions.find(opt => opt.id === value.toString());\r\n    this.sourceOption = {\r\n      code: value,\r\n      description: selectedSource.value || '',\r\n      tag: selectedSource.tag,\r\n      id: selectedSource.id,\r\n      type: selectedSource.type,\r\n    };\r\n  }\r\n\r\n  @Listen('gotoSplitPageTwoEvent', { target: 'window' })\r\n  gotoSplitPageTwo() {\r\n    this.gotoPage('page_two');\r\n  }\r\n\r\n  @Listen('buttonClicked')\r\n  handleButtonClicked(event: CustomEvent<{ key: TPropertyButtonsTypes; data?: CustomEvent }>) {\r\n    switch (event.detail.key) {\r\n      case 'save':\r\n        this.bookUser(false);\r\n        break;\r\n      case 'cancel':\r\n        event.stopImmediatePropagation();\r\n        event.stopPropagation();\r\n        this.closeWindow();\r\n        break;\r\n      case 'back':\r\n        event.stopImmediatePropagation();\r\n        event.stopPropagation();\r\n        if (this.isEventType('BAR_BOOKING')) {\r\n          resetReserved();\r\n        }\r\n        this.gotoPage('page_one');\r\n        break;\r\n      case 'book':\r\n        this.bookUser(false);\r\n        break;\r\n      case 'bookAndCheckIn':\r\n        this.bookUser(true);\r\n        break;\r\n      case 'next':\r\n        event.stopImmediatePropagation();\r\n        event.stopPropagation();\r\n        if (!this.adultChildCount?.adult) {\r\n          this.animateIrSelect.emit('adult_child_select');\r\n          break;\r\n        }\r\n        if (calculateTotalRooms() > 0) {\r\n          this.gotoPage('page_two');\r\n          break;\r\n        } else if (this.defaultData?.roomsInfo.length === 0) {\r\n          this.animateIrButton.emit('check_availability');\r\n          break;\r\n        }\r\n        this.toast.emit({\r\n          type: 'error',\r\n          description: locales.entries.Lcz_SelectRatePlan,\r\n          title: locales.entries.Lcz_SelectRatePlan,\r\n        });\r\n        break;\r\n      case 'check':\r\n        this.checkBookingAvailability();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  private updateBookingHistory(partialData: Partial<IHistoryEntry>) {\r\n    const lastEntry = this.bookingHistory[this.bookingHistory.length - 1];\r\n\r\n    const newEntry: IHistoryEntry = {\r\n      dates: {\r\n        checkIn: partialData.dates?.checkIn || lastEntry?.dates?.checkIn || new Date(this.dateRangeData.fromDate),\r\n        checkOut: partialData.dates?.checkOut || lastEntry?.dates?.checkOut || new Date(this.dateRangeData.toDate),\r\n      },\r\n      adults: partialData.adults ?? lastEntry?.adults ?? this.adultChildCount.adult,\r\n      children: partialData.children ?? lastEntry?.children ?? this.adultChildCount.child,\r\n    };\r\n\r\n    // Update the booking history\r\n    this.bookingHistory.push(newEntry);\r\n    if (this.bookingHistory.length > this.MAX_HISTORY_LENGTH) {\r\n      this.bookingHistory.shift();\r\n    }\r\n  }\r\n\r\n  private handleKeyDown(e: KeyboardEvent) {\r\n    if (e.key === 'Escape') {\r\n      this.closeWindow();\r\n    }\r\n  }\r\n\r\n  private initializeDefaultDateRange() {\r\n    this.defaultDateRange = {\r\n      from_date: this.bookingData.FROM_DATE,\r\n      to_date: this.bookingData.TO_DATE,\r\n    };\r\n  }\r\n\r\n  private initializeDefaultData() {\r\n    this.defaultData = this.bookingData;\r\n    this.dateRangeData = { ...this.defaultData.defaultDateRange };\r\n  }\r\n\r\n  private async fetchSetupEntriesAndInitialize() {\r\n    try {\r\n      const setupEntries = await this.fetchSetupEntries();\r\n      this.setSourceOptions(this.allowedBookingSources);\r\n      this.setOtherProperties(setupEntries);\r\n      this.initializeEventData();\r\n    } catch (error) {\r\n      console.error('Error fetching setup entries:', error);\r\n    }\r\n  }\r\n\r\n  private initializeEventData() {\r\n    if (this.isEventType('EDIT_BOOKING')) {\r\n      this.initializeEditBookingData();\r\n    }\r\n\r\n    if (!this.isEventType('BAR_BOOKING')) {\r\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\r\n    }\r\n\r\n    this.initializePage();\r\n  }\r\n\r\n  private initializeEditBookingData() {\r\n    this.adultChildCount = {\r\n      adult: this.defaultData.ADULTS_COUNT,\r\n      child: this.defaultData.CHILDREN_COUNT,\r\n    };\r\n\r\n    this.initialRoomIds = {\r\n      roomName: this.defaultData.roomName,\r\n      ratePlanId: this.defaultData.RATE_PLAN_ID,\r\n      roomId: this.defaultData.PR_ID,\r\n      roomTypeId: this.defaultData.RATE_TYPE,\r\n    };\r\n    const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\r\n    console.log(GUEST);\r\n    modifyBookingStore('guest', {\r\n      bed_preference: currentRoomType.bed_preference?.toString(),\r\n      infant_nbr: currentRoomType.occupancy.infant_nbr,\r\n      first_name: GUEST.first_name ?? '',\r\n      last_name: GUEST.last_name ?? '',\r\n      // name: currentRoomType.guest.last_name ? currentRoomType.guest.first_name + ' ' + currentRoomType.guest.last_name : currentRoomType.guest.first_name,\r\n      unit: (currentRoomType.unit as any)?.id?.toString(),\r\n    });\r\n    this.checkBookingAvailability();\r\n    this.bookPropertyService.setEditingRoomInfo(this.defaultData, this.selectedUnits);\r\n  }\r\n\r\n  private initializePage() {\r\n    switch (this.defaultData.event_type) {\r\n      case 'SPLIT_BOOKING':\r\n        this.showSplitBookingOption = true;\r\n        this.page = 'page_one';\r\n        break;\r\n      case 'BLOCK_DATES':\r\n        this.page = 'page_block_date';\r\n        break;\r\n      default:\r\n        this.page = 'page_one';\r\n        break;\r\n    }\r\n  }\r\n\r\n  async fetchSetupEntries() {\r\n    return await this.bookingService.fetchSetupEntries();\r\n  }\r\n\r\n  private isGuestDataIncomplete() {\r\n    for (const roomtypeId in booking_store.ratePlanSelections) {\r\n      const roomtype = booking_store.ratePlanSelections[roomtypeId];\r\n      for (const rateplanId in roomtype) {\r\n        const rateplan = roomtype[rateplanId];\r\n        if (rateplan.reserved > 0) {\r\n          for (const guest of rateplan.guest) {\r\n            if (guest.first_name === '' || guest.last_name === '') {\r\n              return true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private isButtonDisabled() {\r\n    const isValidProperty = (property, key, comparedBy) => {\r\n      if (!property) {\r\n        return true;\r\n      }\r\n      if (property === this.guestData) {\r\n        return this.isGuestDataIncomplete();\r\n      }\r\n      if (key === 'selectedArrivalTime') {\r\n        if (property[key] !== undefined) {\r\n          return property[key].code === '';\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n      return property[key] === comparedBy || property[key] === undefined;\r\n    };\r\n    return (\r\n      isValidProperty(this.guestData, 'guestName', '') ||\r\n      isValidProperty(this.bookedByInfoData, 'firstName', '') ||\r\n      isValidProperty(this.bookedByInfoData, 'lastName', '') ||\r\n      isValidProperty(this.bookedByInfoData, 'selectedArrivalTime', '')\r\n    );\r\n  }\r\n\r\n  private setSourceOptions(bookingSource: any[]) {\r\n    this.sourceOptions = bookingSource.map(source => ({\r\n      id: source.id,\r\n      value: source.description,\r\n      tag: source.tag,\r\n      type: source.type,\r\n    }));\r\n    if (this.isEventType('EDIT_BOOKING')) {\r\n      this.sourceOption = { ...this.defaultData.SOURCE };\r\n    } else {\r\n      this.sourceOption = {\r\n        code: bookingSource[0].code,\r\n        description: bookingSource[0].description,\r\n        tag: bookingSource[0].tag,\r\n        type: bookingSource[0].type,\r\n        id: bookingSource[0].id,\r\n      };\r\n    }\r\n  }\r\n\r\n  private setOtherProperties(res: any) {\r\n    this.ratePricingMode = res?.ratePricingMode;\r\n    this.bookedByInfoData.arrivalTime = res.arrivalTime;\r\n    this.bedPreferenceType = res.bedPreferenceType;\r\n  }\r\n\r\n  private async checkBookingAvailability() {\r\n    resetBookingStore();\r\n    const from_date = moment(this.dateRangeData.fromDate).format('YYYY-MM-DD');\r\n    const to_date = moment(this.dateRangeData.toDate).format('YYYY-MM-DD');\r\n    const is_in_agent_mode = this.sourceOption['type'] === 'TRAVEL_AGENCY';\r\n    try {\r\n      const room_type_ids_to_update = this.isEventType('EDIT_BOOKING') ? [this.defaultData.RATE_TYPE] : [];\r\n      const room_type_ids = this.isEventType('BAR_BOOKING') ? this.defaultData.roomsInfo.map(room => room.id) : [];\r\n      const data = await this.bookingService.getBookingAvailability({\r\n        from_date,\r\n        to_date,\r\n        propertyid: this.propertyid,\r\n        adultChildCount: this.adultChildCount,\r\n        language: this.language,\r\n        room_type_ids,\r\n        currency: this.currency,\r\n        agent_id: is_in_agent_mode ? this.sourceOption['tag'] : null,\r\n        is_in_agent_mode,\r\n        room_type_ids_to_update,\r\n      });\r\n      if (!this.isEventType('EDIT_BOOKING')) {\r\n        this.defaultData.defaultDateRange.fromDate = new Date(this.dateRangeData.fromDate);\r\n        this.defaultData.defaultDateRange.toDate = new Date(this.dateRangeData.toDate);\r\n      }\r\n      this.defaultData = { ...this.defaultData, roomsInfo: data };\r\n      if (this.isEventType('EDIT_BOOKING') && !this.updatedBooking) {\r\n        this.updateBooking();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initializing booking availability:', error);\r\n    }\r\n  }\r\n\r\n  private updateBooking() {\r\n    try {\r\n      const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\r\n      const roomtypeId = currentRoomType.roomtype.id;\r\n      const rateplanId = currentRoomType.rateplan.id;\r\n      console.log({ GUEST });\r\n      const guest = {\r\n        bed_preference: currentRoomType.bed_preference?.toString(),\r\n        infant_nbr: currentRoomType.occupancy.infant_nbr,\r\n        last_name: GUEST.last_name,\r\n        first_name: GUEST.first_name,\r\n        unit: (currentRoomType.unit as any)?.id?.toString(),\r\n        roomtype_id: currentRoomType.roomtype.id,\r\n      };\r\n      modifyBookingStore('guest', guest);\r\n      reserveRooms({\r\n        roomTypeId: roomtypeId,\r\n        ratePlanId: rateplanId,\r\n        rooms: 1,\r\n        guest: [guest],\r\n      });\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n  private async checkAndBlockDate() {\r\n    try {\r\n      const { block_exposed_unit_props } = this.defaultData;\r\n      await this.bookingService.getBookingAvailability({\r\n        from_date: block_exposed_unit_props.from_date,\r\n        to_date: block_exposed_unit_props.to_date,\r\n        propertyid: this.propertyid,\r\n        adultChildCount: {\r\n          adult: 2,\r\n          child: 0,\r\n        },\r\n        language: this.language,\r\n        room_type_ids: this.defaultData.roomsInfo.map(room => room.id),\r\n        currency: this.currency,\r\n      });\r\n      const isAvailable = booking_store.roomTypes.every(rt => {\r\n        if (rt.is_available_to_book) {\r\n          return true;\r\n        }\r\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\r\n      });\r\n      if (isAvailable) {\r\n        await this.handleBlockDate(false);\r\n      } else {\r\n        console.log('Blocked date is unavailable. Continuing...');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking and blocking date:', error);\r\n    }\r\n  }\r\n  private async closeWindow() {\r\n    resetBookingStore();\r\n    handleBodyOverflow(false);\r\n\r\n    if (this.wasBlockedUnit && !this.didReservation) {\r\n      await this.checkAndBlockDate();\r\n    }\r\n    const el = document.querySelector('.sideWindow');\r\n    if (!el) return;\r\n\r\n    el.classList.add('sideWindow--exit');\r\n\r\n    setTimeout(() => {\r\n      this.closeBookingWindow.emit();\r\n      document.removeEventListener('keydown', this.handleKeyDown);\r\n    }, 300);\r\n  }\r\n\r\n  private isEventType(key: TEventType) {\r\n    return this.defaultData.event_type === key;\r\n  }\r\n\r\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const opt: { [key: string]: any } = event.detail;\r\n    this.blockDatesData = opt.data;\r\n  }\r\n\r\n  private handleGuestInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const opt = event.detail;\r\n    if (opt.guestRefKey) {\r\n      if (this.isEventType('BAR_BOOKING') || this.isEventType('SPLIT_BOOKING')) {\r\n        this.guestData[opt.guestRefKey] = {\r\n          ...opt.data,\r\n          roomId: this.defaultData.PR_ID,\r\n        };\r\n      } else this.guestData[opt.guestRefKey] = opt.data;\r\n    }\r\n  }\r\n\r\n  private handleBookedByInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const opt: { [key: string]: any } = event.detail;\r\n    this.bookedByInfoData = opt.value.data;\r\n  }\r\n\r\n  private renderPage() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  private gotoPage(gotoPage: string) {\r\n    this.page = gotoPage;\r\n    this.renderPage();\r\n  }\r\n\r\n  private getPageBlockDatesView() {\r\n    return (\r\n      <Fragment>\r\n        <igl-block-dates-view\r\n          fromDate={this.defaultData.FROM_DATE}\r\n          toDate={this.defaultData.TO_DATE}\r\n          entryDate={this.defaultData.ENTRY_DATE}\r\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\r\n        ></igl-block-dates-view>\r\n      </Fragment>\r\n    );\r\n  }\r\n\r\n  private handlePageTwoDataUpdateEvent(event: CustomEvent<IPageTwoDataUpdateProps>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    if (event.detail.key === 'propertyBookedBy') {\r\n      this.handleBookedByInfoUpdate(event);\r\n    } else {\r\n      this.handleGuestInfoUpdate(event);\r\n    }\r\n  }\r\n\r\n  private async handleBlockDate(auto_close = true) {\r\n    const props = this.wasBlockedUnit\r\n      ? this.defaultData.block_exposed_unit_props\r\n      : (() => {\r\n          const releaseData = getReleaseHoursString(+this.blockDatesData.RELEASE_AFTER_HOURS);\r\n          return {\r\n            from_date: dateToFormattedString(this.defaultData.defaultDateRange.fromDate),\r\n            to_date: dateToFormattedString(this.defaultData.defaultDateRange.toDate),\r\n            NOTES: this.blockDatesData.OPTIONAL_REASON || '',\r\n            pr_id: this.defaultData.PR_ID.toString(),\r\n            STAY_STATUS_CODE: this.blockDatesData.OUT_OF_SERVICE ? '004' : this.blockDatesData.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\r\n            DESCRIPTION: this.blockDatesData.RELEASE_AFTER_HOURS || '',\r\n            ...releaseData,\r\n          };\r\n        })();\r\n    await this.bookingService.blockUnit(props);\r\n    // const blockedUnit = await transformNewBLockedRooms(result);\r\n    // this.blockedCreated.emit(blockedUnit);\r\n    if (auto_close) this.closeWindow();\r\n  }\r\n\r\n  private async bookUser(check_in: boolean) {\r\n    this.setLoadingState(check_in);\r\n\r\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\r\n      if (this.isGuestDataIncomplete()) {\r\n        this.isLoading = '';\r\n        return;\r\n      }\r\n    } else if (this.isButtonDisabled()) {\r\n      this.isLoading = '';\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\r\n        this.bookedByInfoData.message = this.defaultData.NOTES;\r\n      }\r\n      this.didReservation = true;\r\n      const serviceParams = await this.bookPropertyService.prepareBookUserServiceParams({\r\n        context: this,\r\n        sourceOption: this.sourceOption,\r\n        check_in,\r\n      });\r\n      await this.bookingService.doReservation(serviceParams);\r\n      this.resetBookingEvt.emit(null);\r\n    } catch (error) {\r\n      console.error('Error booking user:', error);\r\n    } finally {\r\n      // this.isLoading = null;\r\n      this.resetLoadingState();\r\n    }\r\n  }\r\n\r\n  private setLoadingState(assign_units: boolean) {\r\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\r\n      this.isLoading = 'save';\r\n    } else {\r\n      this.isLoading = assign_units ? 'bookAndCheckIn' : 'book';\r\n    }\r\n  }\r\n\r\n  private resetLoadingState() {\r\n    this.isLoading = '';\r\n    setTimeout(() => {\r\n      this.closeWindow();\r\n    }, 100);\r\n  }\r\n\r\n  private getCurrentPage(name: string) {\r\n    return this.page === name;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host data-testid=\"book_property_sheet h-100\">\r\n        <div class=\"background-overlay\" onClick={() => this.closeWindow()}></div>\r\n        <div class={'sideWindow sheet-container ' + (this.getCurrentPage('page_block_date') ? 'block-date' : '')}>\r\n          {isRequestPending('/Get_Setup_Entries_By_TBL_NAME_MULTI') ? (\r\n            <div class={'loading-container'}>\r\n              <ir-spinner></ir-spinner>\r\n            </div>\r\n          ) : (\r\n            <Fragment>\r\n              <div class=\"sheet-header\">\r\n                <div class=\"card-header-container mb-2\">\r\n                  <h3 class=\"text-left font-medium-2 px-2\">{this.getCurrentPage('page_block_date') ? this.defaultData.BLOCK_DATES_TITLE : this.defaultData.TITLE}</h3>\r\n                  <ir-icon\r\n                    class={'px-2'}\r\n                    onIconClickHandler={() => {\r\n                      this.closeWindow();\r\n                    }}\r\n                  >\r\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={20} width={20}>\r\n                      <path\r\n                        fill=\"currentColor\"\r\n                        d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\r\n                      />\r\n                    </svg>\r\n                  </ir-icon>\r\n                </div>\r\n              </div>\r\n              <div class=\"px-2 sheet-body\">\r\n                {this.getCurrentPage('page_one') && (\r\n                  <igl-booking-overview-page\r\n                    initialRoomIds={this.initialRoomIds}\r\n                    defaultDaterange={this.defaultDateRange}\r\n                    eventType={this.defaultData.event_type}\r\n                    selectedRooms={this.selectedUnits}\r\n                    currency={this.currency}\r\n                    showSplitBookingOption={this.showSplitBookingOption}\r\n                    ratePricingMode={this.ratePricingMode}\r\n                    dateRangeData={this.dateRangeData}\r\n                    bookingData={this.defaultData}\r\n                    adultChildCount={this.adultChildCount}\r\n                    bookedByInfoData={this.bookedByInfoData}\r\n                    adultChildConstraints={this.adultChildConstraints}\r\n                    sourceOptions={this.sourceOptions}\r\n                    propertyId={this.propertyid}\r\n                  ></igl-booking-overview-page>\r\n                )}\r\n\r\n                {this.getCurrentPage('page_two') && (\r\n                  <igl-booking-form\r\n                    currency={this.currency}\r\n                    propertyId={this.propertyid}\r\n                    showPaymentDetails={this.showPaymentDetails}\r\n                    selectedGuestData={this.guestData}\r\n                    countries={this.countries}\r\n                    isLoading={this.isLoading}\r\n                    selectedRooms={this.selectedUnits}\r\n                    bedPreferenceType={this.bedPreferenceType}\r\n                    dateRangeData={this.dateRangeData}\r\n                    bookingData={this.defaultData}\r\n                    showSplitBookingOption={this.showSplitBookingOption}\r\n                    language={this.language}\r\n                    bookedByInfoData={this.bookedByInfoData}\r\n                    defaultGuestData={this.defaultData}\r\n                    isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\r\n                    onDataUpdateEvent={event => this.handlePageTwoDataUpdateEvent(event)}\r\n                  ></igl-booking-form>\r\n                )}\r\n                {this.getCurrentPage('page_block_date') ? this.getPageBlockDatesView() : null}\r\n              </div>\r\n              {this.getCurrentPage('page_block_date') ? (\r\n                <div class=\"sheet-footer\">\r\n                  <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class=\"flex-fill\" onClick={() => this.closeWindow()}></ir-button>\r\n                  <ir-button\r\n                    text={locales.entries.Lcz_Blockdates}\r\n                    isLoading={isRequestPending('/Block_Exposed_Unit')}\r\n                    class=\"flex-fill\"\r\n                    onClick={() => this.handleBlockDate()}\r\n                  ></ir-button>\r\n                </div>\r\n              ) : (\r\n                <igl-book-property-footer\r\n                  page={this.page}\r\n                  dateRangeData={this.dateRangeData}\r\n                  isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\r\n                  isLoading={this.isLoading}\r\n                  class={'sheet-footer'}\r\n                  eventType={this.bookingData.event_type}\r\n                ></igl-book-property-footer>\r\n              )}\r\n            </Fragment>\r\n          )}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  width: 100% !important;\r\n  background: #000;\r\n}\r\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\r\nimport { TPropertyButtonsTypes } from '../../../../models/igl-book-property';\r\nimport locales from '@/stores/locales.store';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { TIcons } from '@/components/ui/ir-icons/icons';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport moment from 'moment';\r\n\r\n@Component({\r\n  tag: 'igl-book-property-footer',\r\n  styleUrl: 'igl-book-property-footer.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookPropertyFooter {\r\n  @Prop() eventType: string;\r\n  @Prop() disabled: boolean = true;\r\n  @Prop() page: string;\r\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\r\n  @Prop() dateRangeData: { [key: string]: any };\r\n  @Prop() isLoading: string;\r\n\r\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\r\n\r\n  private isEventType(event: string) {\r\n    return event === this.eventType;\r\n  }\r\n  private editNext(label) {\r\n    if (this.isEventType('EDIT_BOOKING')) {\r\n      if (label === 'Cancel') {\r\n        return 'flex-fill';\r\n      } else {\r\n        return 'd-none d-md-block  flex-fill';\r\n      }\r\n    }\r\n    return 'flex-fill';\r\n  }\r\n\r\n  private renderButton({\r\n    label,\r\n    type,\r\n    disabled,\r\n    icon_name,\r\n    isLoading,\r\n    icon_position = 'right',\r\n  }: {\r\n    type: TPropertyButtonsTypes;\r\n    label: string;\r\n    disabled?: boolean;\r\n    icon_name?: TIcons;\r\n    isLoading?: boolean;\r\n    icon_position?: 'right' | 'left';\r\n  }) {\r\n    return (\r\n      <div class={this.shouldRenderTwoButtons() ? ` ${this.editNext(label)}` : 'flex-fill'}>\r\n        {/* <button class={`btn btn-${type === 'cancel' ? 'secondary' : 'primary'} full-width`} onClick={() => this.buttonClicked.emit({ key: type })} disabled={disabled}>\r\n          {label}\r\n        </button> */}\r\n        <ir-button\r\n          isLoading={isLoading}\r\n          btn_color={type === 'cancel' || type === 'back' ? 'secondary' : 'primary'}\r\n          text={label}\r\n          btn_disabled={disabled}\r\n          onClickHandler={() => {\r\n            this.buttonClicked.emit({ key: type });\r\n          }}\r\n          class=\"full-width\"\r\n          btn_styles=\"justify-content-center\"\r\n          icon_name={icon_name}\r\n          iconPosition={icon_position}\r\n          style={{ '--icon-size': '1rem' }}\r\n          icon_style={{ paddingBottom: '1.9px' }}\r\n        ></ir-button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private shouldRenderTwoButtons() {\r\n    return this.isEventType('PLUS_BOOKING') || this.isEventType('ADD_ROOM') || this.isEventType('EDIT_BOOKING');\r\n  }\r\n\r\n  render() {\r\n    if (this.page === 'page_one') {\r\n      return (\r\n        <Host>\r\n          {/* <div class=\"d-flex justify-content-between gap-30 align-items-center full-width\"> */}\r\n          {this.isEventType('EDIT_BOOKING') ? (\r\n            <Fragment>\r\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\r\n              {this.shouldRenderTwoButtons() &&\r\n                this.renderButton({\r\n                  type: 'next',\r\n                  label: `${locales.entries.Lcz_Next}`,\r\n                  disabled: isRequestPending('/Get_Exposed_Booking_Availability'),\r\n                  icon_name: 'angles_right',\r\n                })}\r\n            </Fragment>\r\n          ) : (\r\n            <Fragment>\r\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\r\n              {this.shouldRenderTwoButtons() && this.renderButton({ type: 'next', label: `${locales.entries.Lcz_Next}`, icon_name: 'angles_right' })}\r\n            </Fragment>\r\n          )}\r\n          {/* </div> */}\r\n        </Host>\r\n      );\r\n    }\r\n    const showBookAndCheckin = calendar_data.checkin_enabled && moment(new Date(this.dateRangeData?.fromDate)).isSame(new Date(), 'day');\r\n    return (\r\n      <Fragment>\r\n        {this.isEditOrAddRoomEvent ? (\r\n          <Fragment>\r\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\r\n            {this.renderButton({ type: 'save', label: locales.entries.Lcz_Save, isLoading: this.isLoading === 'save' })}\r\n          </Fragment>\r\n        ) : (\r\n          <Fragment>\r\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\r\n            {this.renderButton({ type: 'book', label: locales.entries.Lcz_Book, isLoading: this.isLoading === 'book' })}\r\n            {showBookAndCheckin && this.renderButton({ type: 'bookAndCheckIn', label: locales.entries.Lcz_BookAndChekcIn, isLoading: this.isLoading === 'bookAndCheckIn' })}\r\n          </Fragment>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n","import { Component, Prop, h, Event, EventEmitter, State } from '@stencil/core';\r\nimport { IPageTwoDataUpdateProps } from '@/models/models';\r\nimport { IglBookPropertyPayloadEditBooking, TPropertyButtonsTypes } from '../../../../models/igl-book-property';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport locales from '@/stores/locales.store';\r\nimport { ICurrency } from '@/models/calendarData';\r\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\r\nimport { ICountry } from '@/models/IBooking';\r\n@Component({\r\n  tag: 'igl-booking-form',\r\n  styleUrl: 'igl-booking-form.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingForm {\r\n  @Prop() showPaymentDetails: boolean;\r\n  @Prop() currency: ICurrency;\r\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\r\n  @Prop() dateRangeData: { [key: string]: any };\r\n  @Prop() bookingData: { [key: string]: any };\r\n  @Prop() showSplitBookingOption: boolean;\r\n  @Prop() language: string;\r\n  @Prop() bookedByInfoData: { [key: string]: any };\r\n  @Prop() propertyId: number;\r\n  @Prop() bedPreferenceType: any;\r\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\r\n  @Prop({ reflect: true }) isLoading: string;\r\n  @Prop() countries: ICountry[];\r\n  @Prop() selectedGuestData;\r\n  @Prop() defaultGuestData: IglBookPropertyPayloadEditBooking;\r\n\r\n  @State() selectedBookedByData;\r\n  @State() guestData: any;\r\n  @State() selectedUnits: { [key: string]: any } = {};\r\n\r\n  @Event() dataUpdateEvent: EventEmitter<IPageTwoDataUpdateProps>;\r\n  @Event() buttonClicked: EventEmitter<{\r\n    key: TPropertyButtonsTypes;\r\n    data?: CustomEvent;\r\n  }>;\r\n\r\n  componentWillLoad() {\r\n    this.initializeGuestData();\r\n    this.selectedBookedByData = this.bookedByInfoData;\r\n  }\r\n\r\n  initializeGuestData() {\r\n    let total = 0;\r\n    const newSelectedUnits = { ...this.selectedUnits };\r\n    const getRate = (rate: number, totalNights: number, isRateModified: boolean, preference: number) => {\r\n      if (isRateModified && preference === 2) {\r\n        return rate * totalNights;\r\n      }\r\n      return rate;\r\n    };\r\n    this.selectedUnits = newSelectedUnits;\r\n    this.guestData = [];\r\n    this.selectedRooms.forEach((room, key) => {\r\n      room.forEach(rate_plan => {\r\n        newSelectedUnits[key] = rate_plan.selectedUnits;\r\n        total += rate_plan.totalRooms * getRate(rate_plan.rate, this.dateRangeData.dateDifference, rate_plan.isRateModified, rate_plan.rateType);\r\n        for (let i = 1; i <= rate_plan.totalRooms; i++) {\r\n          this.guestData.push({\r\n            guestName: '',\r\n            roomId: '',\r\n            preference: '',\r\n            ...rate_plan,\r\n          });\r\n        }\r\n      });\r\n    });\r\n    this.bookingData.TOTAL_PRICE = total;\r\n  }\r\n  handleOnApplicationInfoDataUpdateEvent(event: CustomEvent, index: number) {\r\n    const opt = event.detail;\r\n    const categoryIdKey = `c_${opt.data.roomCategoryId}`;\r\n    const updatedUnits = [...(this.selectedUnits[categoryIdKey] || [])];\r\n    updatedUnits[index] = opt.data.roomId;\r\n    this.selectedUnits = {\r\n      ...this.selectedUnits,\r\n      [categoryIdKey]: updatedUnits,\r\n    };\r\n    this.dataUpdateEvent.emit({\r\n      key: 'applicationInfoUpdateEvent',\r\n      value: event.detail,\r\n    });\r\n  }\r\n\r\n  handleEventData(event: any, key: string, index: number) {\r\n    if (key === 'application-info') {\r\n      this.handleOnApplicationInfoDataUpdateEvent(event, index);\r\n    } else {\r\n      this.selectedBookedByData = event.detail.data;\r\n      this.dataUpdateEvent.emit({\r\n        key: 'propertyBookedBy',\r\n        value: event.detail,\r\n      });\r\n    }\r\n  }\r\n  isGuestDataIncomplete() {\r\n    if (this.selectedGuestData.length !== this.guestData.length) {\r\n      return true;\r\n    }\r\n    for (const data of this.selectedGuestData) {\r\n      if (data.guestName === '' || data.preference === '' || data.roomId === '') {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  isButtonDisabled(key: string) {\r\n    const isValidProperty = (property, key, comparedBy) => {\r\n      if (!property) {\r\n        return true;\r\n      }\r\n      if (property === this.selectedGuestData) {\r\n        return this.isGuestDataIncomplete();\r\n      }\r\n      if (key === 'selectedArrivalTime') {\r\n        if (property[key] !== undefined) {\r\n          return property[key].code === '';\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n      return property[key] === comparedBy || property[key] === undefined;\r\n    };\r\n    return (\r\n      this.isLoading === key ||\r\n      isValidProperty(this.selectedGuestData, 'guestName', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'isdCode', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'contactNumber', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'firstName', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'lastName', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'countryId', -1) ||\r\n      isValidProperty(this.selectedBookedByData, 'selectedArrivalTime', '') ||\r\n      isValidProperty(this.selectedBookedByData, 'email', '')\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"d-flex flex-column h-100\">\r\n        <div class=\"d-flex flex-wrap\">\r\n          <ir-date-view\r\n            class=\"mr-1 flex-fill font-weight-bold font-medium-1\"\r\n            from_date={new Date(this.dateRangeData.fromDate)}\r\n            to_date={new Date(this.dateRangeData.toDate)}\r\n            dateOption=\"DD MMM YYYY\"\r\n          ></ir-date-view>\r\n          {this.guestData.length > 1 && (\r\n            <div class=\"mt-1 mt-md-0 text-right\">\r\n              {locales.entries.Lcz_TotalPrice} <span class=\"font-weight-bold font-medium-1\">{formatAmount(this.currency.symbol, this.bookingData.TOTAL_PRICE || '0')}</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {Object.values(booking_store.ratePlanSelections).map(val =>\r\n          Object.values(val).map(ratePlan => {\r\n            const rp = ratePlan as IRatePlanSelection;\r\n            if (rp.reserved === 0) {\r\n              return null;\r\n            }\r\n\r\n            return [...new Array(rp.reserved)].map((_, i) => (\r\n              <igl-application-info\r\n                totalNights={Number(this.dateRangeData.dateDifference)}\r\n                bedPreferenceType={this.bedPreferenceType}\r\n                currency={this.currency}\r\n                guestInfo={rp.guest ? rp.guest[i] : null}\r\n                bookingType={this.bookingData.event_type}\r\n                rateplanSelection={rp}\r\n                key={`${rp.ratePlan.id}_${i}`}\r\n                roomIndex={i}\r\n                baseData={\r\n                  this.bookingData.event_type === 'EDIT_BOOKING'\r\n                    ? {\r\n                        roomtypeId: this.bookingData.currentRoomType.roomtype.id,\r\n                        unit: this.bookingData.currentRoomType.unit,\r\n                      }\r\n                    : undefined\r\n                }\r\n              ></igl-application-info>\r\n            ));\r\n          }),\r\n        )}\r\n\r\n        {this.isEditOrAddRoomEvent || this.showSplitBookingOption ? null : (\r\n          <igl-property-booked-by\r\n            propertyId={this.propertyId}\r\n            countries={this.countries}\r\n            language={this.language}\r\n            showPaymentDetails={this.showPaymentDetails}\r\n            defaultData={this.bookedByInfoData}\r\n            onDataUpdateEvent={event => {\r\n              this.handleEventData(event, 'propertyBookedBy', 0);\r\n            }}\r\n          ></igl-property-booked-by>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n:host > * {\r\n  margin: 0;\r\n  padding: auto;\r\n}\r\n.scrollContent {\r\n  height: calc(100% - 79px);\r\n  overflow: auto;\r\n  position: relative;\r\n}\r\n.loading-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  background: white;\r\n  position: absolute;\r\n  inset: 0;\r\n  z-index: 100;\r\n}\r\n.loader {\r\n  width: 1.25rem;\r\n  height: 1.25rem;\r\n  border: 2.5px solid #3f3f3f;\r\n  border-bottom-color: transparent;\r\n  border-radius: 50%;\r\n  display: inline-block;\r\n  box-sizing: border-box;\r\n  animation: rotation 1s linear infinite;\r\n}\r\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\r\nimport { TAdultChildConstraints, TSourceOptions } from '../../../../models/igl-book-property';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport moment from 'moment';\r\nimport booking_store from '@/stores/booking.store';\r\n@Component({\r\n  tag: 'igl-booking-overview-page',\r\n  styleUrl: 'igl-booking-overview-page.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingOverviewPage {\r\n  @Prop() bookingData: any;\r\n  @Prop() propertyId: number;\r\n  @Prop() message: string;\r\n  @Prop() showSplitBookingOption: boolean;\r\n  @Prop() eventType: string;\r\n  @Prop() currency: any;\r\n  @Prop() adultChildConstraints: TAdultChildConstraints;\r\n  @Prop() ratePricingMode: any;\r\n  @Prop() dateRangeData: any;\r\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\r\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\r\n  @Prop() adultChildCount: { adult: number; child: number };\r\n  @Prop() sourceOptions: TSourceOptions[];\r\n  @Prop() bookedByInfoData: any;\r\n  @Prop() initialRoomIds: any;\r\n\r\n  @Event() roomsDataUpdate: EventEmitter;\r\n\r\n  getSplitBookings() {\r\n    return (this.bookingData.hasOwnProperty('splitBookingEvents') && this.bookingData.splitBookingEvents) || [];\r\n  }\r\n  isEventType(event: string) {\r\n    return event === this.eventType;\r\n  }\r\n  setMinDate() {\r\n    if (!this.isEventType('EDIT_BOOKING')) {\r\n      return;\r\n    }\r\n    const from_date = moment(this.bookingData.FROM_DATE, 'YYYY-MM-DD');\r\n    const today = moment();\r\n    if (from_date.isAfter(today)) {\r\n      return today.add(-2, 'weeks').format('YYYY-MM-DD');\r\n    }\r\n    return from_date.add(-2, 'weeks').format('YYYY-MM-DD');\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <igl-book-property-header\r\n          bookedByInfoData={this.bookedByInfoData}\r\n          defaultDaterange={this.defaultDaterange}\r\n          dateRangeData={this.dateRangeData}\r\n          minDate={this.setMinDate()}\r\n          // minDate={this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING') ? this.bookedByInfoData.from_date || this.bookingData.FROM_DATE : undefined}\r\n          adultChildCount={this.adultChildCount}\r\n          splitBookingId={this.showSplitBookingOption}\r\n          bookingData={this.bookingData}\r\n          sourceOptions={this.sourceOptions}\r\n          message={this.message}\r\n          bookingDataDefaultDateRange={this.bookingData.defaultDateRange}\r\n          showSplitBookingOption={this.showSplitBookingOption}\r\n          adultChildConstraints={this.adultChildConstraints}\r\n          splitBookings={this.getSplitBookings()}\r\n          propertyId={this.propertyId}\r\n        ></igl-book-property-header>\r\n        {/* {this.adultChildCount.adult === 0 && <p class={'col text-left'}>Please select the number of guests</p>} */}\r\n        <div class=\" text-left\">\r\n          {isRequestPending('/Check_Availability') && this.isEventType('EDIT_BOOKING') ? (\r\n            <div class=\"loading-container\">\r\n              <div class=\"loader\"></div>\r\n            </div>\r\n          ) : (\r\n            <Fragment>\r\n              {booking_store.roomTypes?.map(roomType => (\r\n                <igl-room-type\r\n                  initialRoomIds={this.initialRoomIds}\r\n                  isBookDisabled={Object.keys(this.bookedByInfoData).length <= 1}\r\n                  key={`room-type-${roomType.id}`}\r\n                  currency={this.currency}\r\n                  ratePricingMode={this.ratePricingMode}\r\n                  dateDifference={this.dateRangeData.dateDifference}\r\n                  bookingType={this.bookingData.event_type}\r\n                  roomType={roomType}\r\n                  class=\"mt-2 mb-1 p-0\"\r\n                  data-testid={`room_type_${roomType.id}`}\r\n                  id={roomType.id.toString()}\r\n                  roomInfoId={this.selectedRooms.has(`c_${roomType.id}`) ? roomType.id : null}\r\n                  onDataUpdateEvent={evt => this.roomsDataUpdate.emit(evt.detail)}\r\n                ></igl-room-type>\r\n              ))}\r\n            </Fragment>\r\n          )}\r\n        </div>\r\n\r\n        {/* <igl-book-property-footer class={'p-0 mb-1 mt-3'} eventType={this.bookingData.event_type}></igl-book-property-footer> */}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  overflow-x: hidden;\r\n  --ir-dialog-max-width: 20rem;\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\r\n}\r\n:host * {\r\n  font-family: inherit !important;\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\r\n}\r\n\r\n.font-medium {\r\n  font-weight: 600;\r\n}\r\n\r\n:host th {\r\n  font-weight: 600;\r\n}\r\n.h-28 {\r\n  height: 2rem;\r\n}\r\n.mx-01 {\r\n  --m: 5px;\r\n  margin-right: var(--m) !important;\r\n  margin-left: var(--m) !important;\r\n}\r\n\r\n.date-margin {\r\n  margin-right: 5px;\r\n}\r\n.pickup-margin {\r\n  margin-bottom: 7px !important;\r\n}\r\n.header-date {\r\n  padding-left: 5px !important;\r\n}\r\n\r\n.pointer {\r\n  cursor: pointer;\r\n}\r\n\r\n:root {\r\n  --sidebar-width: 50rem;\r\n}\r\n.loading-container {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n.sm-padding-right {\r\n  padding-right: 0.2rem;\r\n}\r\n.sm-padding-left {\r\n  padding-left: 0.2rem;\r\n}\r\n.sm-padding-top {\r\n  padding-top: 0.2rem;\r\n}\r\n.sm-padding-bottom {\r\n  padding-bottom: 0.2rem;\r\n}\r\n\r\n.info-notes {\r\n  list-style: none;\r\n  padding-left: 0;\r\n}\r\n.light-blue-bg {\r\n  background-color: #acecff;\r\n  padding: 0.2rem 0.3rem;\r\n}\r\n.iframeHeight {\r\n  height: 17.5rem;\r\n}\r\n\r\n.dialog-title {\r\n  width: fit-content;\r\n}\r\n","import { Component, Listen, h, Prop, Watch, State, Event, EventEmitter, Element, Fragment } from '@stencil/core';\r\nimport { Booking, ExtraService, Guest, IPmsLog, Room, SharedPerson } from '@/models/booking.dto';\r\nimport axios from 'axios';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { IglBookPropertyPayloadAddRoom, TIglBookPropertyPayload } from '@/models/igl-book-property';\r\nimport { RoomService } from '@/services/room.service';\r\nimport locales from '@/stores/locales.store';\r\nimport { IToast } from '@components/ui/ir-toast/toast';\r\nimport { ICountry, IEntries } from '@/models/IBooking';\r\nimport { IPaymentAction, PaymentService } from '@/services/payment.service';\r\nimport Token from '@/models/Token';\r\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent } from './types';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport moment from 'moment';\r\nimport { IrModalCustomEvent } from '@/components';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\n\r\n@Component({\r\n  tag: 'ir-booking-details',\r\n  styleUrl: 'ir-booking-details.css',\r\n  scoped: true,\r\n})\r\nexport class IrBookingDetails {\r\n  @Element() element: HTMLElement;\r\n  // Setup Data\r\n  @Prop() language: string = 'en';\r\n  @Prop() ticket: string = '';\r\n  @Prop() bookingNumber: string = '';\r\n  @Prop() propertyid: number;\r\n  @Prop() is_from_front_desk = false;\r\n  @Prop() p: string;\r\n  // Booleans Conditions\r\n  @Prop() hasPrint: boolean = false;\r\n  @Prop() hasReceipt: boolean = false;\r\n  @Prop() hasDelete: boolean = false;\r\n  @Prop() hasMenu: boolean = false;\r\n\r\n  // Room Booleans\r\n  @Prop() hasRoomEdit: boolean = false;\r\n  @Prop() hasRoomDelete: boolean = false;\r\n  @Prop() hasRoomAdd: boolean = false;\r\n  @Prop() hasCheckIn: boolean = false;\r\n  @Prop() hasCheckOut: boolean = false;\r\n  @Prop() hasCloseButton = false;\r\n\r\n  @State() bookingItem: TIglBookPropertyPayload | null = null;\r\n  @State() statusData = [];\r\n\r\n  @State() showPaymentDetails: any;\r\n  @State() booking: Booking;\r\n  @State() countries: ICountry[];\r\n  @State() calendarData: any = {};\r\n  // Guest Data\r\n  @State() guestData: Guest = null;\r\n  // Rerender Flag\r\n  @State() rerenderFlag = false;\r\n  @State() sidebarState: BookingDetailsSidebarEvents | null = null;\r\n  @State() sidebarPayload: any;\r\n  @State() isUpdateClicked = false;\r\n\r\n  @State() pms_status: IPmsLog;\r\n  @State() isPMSLogLoading: boolean = false;\r\n  @State() paymentActions: IPaymentAction[];\r\n  @State() property_id: number;\r\n  @State() selectedService: ExtraService;\r\n  @State() bedPreference: IEntries[];\r\n  @State() roomGuest: any;\r\n  @State() modalState: { type: 'email' | (string & {}); message: string; loading: boolean } = null;\r\n  // Payment Event\r\n  @Event() toast: EventEmitter<IToast>;\r\n  @Event() bookingChanged: EventEmitter<Booking>;\r\n  @Event() closeSidebar: EventEmitter<null>;\r\n\r\n  private bookingService = new BookingService();\r\n  private roomService = new RoomService();\r\n  private paymentService = new PaymentService();\r\n  private token = new Token();\r\n\r\n  private printingBaseUrl = 'https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2';\r\n  modalRef: HTMLIrModalElement;\r\n\r\n  componentWillLoad() {\r\n    if (this.ticket !== '') {\r\n      this.token.setToken(this.ticket);\r\n      this.initializeApp();\r\n    }\r\n  }\r\n\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.initializeApp();\r\n  }\r\n\r\n  @Listen('openSidebar')\r\n  handleSideBarEvents(e: CustomEvent<OpenSidebarEvent<unknown>>) {\r\n    this.sidebarState = e.detail.type;\r\n    this.sidebarPayload = e.detail.payload;\r\n  }\r\n\r\n  @Listen('clickHandler')\r\n  handleIconClick(e: CustomEvent) {\r\n    const target = e.target as HTMLIrButtonElement;\r\n    switch (target.id) {\r\n      case 'pickup':\r\n        this.sidebarState = 'pickup';\r\n        return;\r\n      case 'close':\r\n        this.closeSidebar.emit(null);\r\n        return;\r\n      case 'email':\r\n        this.modalState = {\r\n          type: 'email',\r\n          message: locales.entries.Lcz_EmailBookingto.replace('%1', this.booking.guest.email),\r\n          loading: isRequestPending('/Send_Booking_Confirmation_Email'),\r\n        };\r\n        this.modalRef.openModal();\r\n        return;\r\n      case 'print':\r\n        this.openPrintingScreen();\r\n        return;\r\n      case 'receipt':\r\n        this.openPrintingScreen('invoice');\r\n        return;\r\n      case 'book-delete':\r\n        return;\r\n      case 'menu':\r\n        window.location.href = 'https://x.igloorooms.com/manage/acbookinglist.aspx';\r\n        return;\r\n      case 'room-add':\r\n        (this.bookingItem as IglBookPropertyPayloadAddRoom) = {\r\n          ID: '',\r\n          NAME: this.booking.guest.last_name,\r\n          EMAIL: this.booking.guest.email,\r\n          PHONE: this.booking.guest.mobile,\r\n          REFERENCE_TYPE: '',\r\n          FROM_DATE: this.booking.from_date,\r\n          ARRIVAL: this.booking.arrival,\r\n          TO_DATE: this.booking.to_date,\r\n          TITLE: `${locales.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,\r\n          defaultDateRange: {\r\n            fromDate: new Date(this.booking.from_date),\r\n            fromDateStr: '',\r\n            toDate: new Date(this.booking.to_date),\r\n            toDateStr: '',\r\n            dateDifference: 0,\r\n            message: '',\r\n          },\r\n          event_type: 'ADD_ROOM',\r\n          booking: this.booking,\r\n          BOOKING_NUMBER: this.booking.booking_nbr,\r\n          ADD_ROOM_TO_BOOKING: this.booking.booking_nbr,\r\n          GUEST: this.booking.guest,\r\n          message: this.booking.remark,\r\n          SOURCE: this.booking.source,\r\n          ROOMS: this.booking.rooms,\r\n        };\r\n        return;\r\n      case 'extra_service_btn':\r\n        this.sidebarState = 'extra_service';\r\n        return;\r\n      case 'add-payment':\r\n        return;\r\n    }\r\n  }\r\n\r\n  @Listen('resetExposedCancelationDueAmount')\r\n  async handleResetExposedCancellationDueAmount(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    //TODO: Payment action\r\n    const paymentActions = await this.paymentService.GetExposedCancellationDueAmount({ booking_nbr: this.booking.booking_nbr, currency_id: this.booking.currency.id });\r\n    this.paymentActions = [...paymentActions];\r\n  }\r\n  @Listen('editInitiated')\r\n  handleEditInitiated(e: CustomEvent<TIglBookPropertyPayload>) {\r\n    this.bookingItem = e.detail;\r\n  }\r\n  @Listen('updateRoomGuests')\r\n  handleRoomGuestsUpdate(e: CustomEvent<{ identifier: string; guests: SharedPerson[] }>) {\r\n    const { identifier, guests } = e.detail;\r\n    const rooms = [...this.booking.rooms];\r\n    let currentRoomIndex = rooms.findIndex(r => r.identifier === identifier);\r\n    if (currentRoomIndex === -1) {\r\n      return;\r\n    }\r\n    const currentRoom = rooms[currentRoomIndex];\r\n    const updatedRoom = { ...currentRoom, sharing_persons: guests };\r\n    rooms[currentRoomIndex] = updatedRoom;\r\n    this.booking = { ...this.booking, rooms: [...rooms] };\r\n  }\r\n\r\n  @Listen('resetBookingEvt')\r\n  async handleResetBooking(e: CustomEvent<Booking | null>) {\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    if (e.detail) {\r\n      return (this.booking = e.detail);\r\n    }\r\n    await this.resetBooking();\r\n  }\r\n  @Listen('editExtraService')\r\n  handleEditExtraService(e: CustomEvent) {\r\n    this.selectedService = e.detail;\r\n    this.sidebarState = 'extra_service';\r\n  }\r\n\r\n  private setRoomsData(roomServiceResp) {\r\n    let roomsData: { [key: string]: any }[] = new Array();\r\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\r\n      roomsData = roomServiceResp.My_Result.roomtypes;\r\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\r\n        roomCategory.expanded = true;\r\n      });\r\n    }\r\n    this.calendarData.roomsInfo = roomsData;\r\n  }\r\n  private async initializeApp() {\r\n    try {\r\n      const [roomResponse, languageTexts, countriesList, bookingDetails, bedPreference] = await Promise.all([\r\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\r\n        this.roomService.fetchLanguage(this.language),\r\n        this.bookingService.getCountries(this.language),\r\n        this.bookingService.getExposedBooking(this.bookingNumber, this.language),\r\n        this.bookingService.getSetupEntriesByTableName('_BED_PREFERENCE_TYPE'),\r\n      ]);\r\n      this.property_id = roomResponse?.My_Result?.id;\r\n      this.bedPreference = bedPreference;\r\n      if (bookingDetails?.booking_nbr && bookingDetails?.currency?.id && bookingDetails.is_direct) {\r\n        this.paymentService\r\n          .GetExposedCancellationDueAmount({\r\n            booking_nbr: bookingDetails.booking_nbr,\r\n            currency_id: bookingDetails.currency.id,\r\n          })\r\n          .then(res => {\r\n            this.paymentActions = res;\r\n          });\r\n      }\r\n      if (!locales?.entries) {\r\n        locales.entries = languageTexts.entries;\r\n        locales.direction = languageTexts.direction;\r\n      }\r\n      this.countries = countriesList;\r\n      const myResult = roomResponse?.My_Result;\r\n      if (myResult) {\r\n        const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends, aname } = myResult;\r\n        this.printingBaseUrl = this.printingBaseUrl.replace('%1', aname).replace('%2', this.bookingNumber);\r\n        this.calendarData = {\r\n          currency,\r\n          allowed_booking_sources,\r\n          adult_child_constraints,\r\n          legendData: calendar_legends,\r\n        };\r\n        this.setRoomsData(roomResponse);\r\n        const paymentCodesToShow = ['001', '004'];\r\n        this.showPaymentDetails = paymentMethods?.some(method => paymentCodesToShow.includes(method.code));\r\n      } else {\r\n        console.warn(\"Room response is missing 'My_Result'.\");\r\n      }\r\n\r\n      // Set guest and booking data\r\n      this.guestData = bookingDetails.guest;\r\n      this.booking = bookingDetails;\r\n    } catch (error) {\r\n      console.error('Error initializing app:', error);\r\n    }\r\n  }\r\n\r\n  private async openPrintingScreen(mode: 'invoice' | 'print' = 'print', version: 'old' | 'new' = 'new') {\r\n    if (version === 'old') {\r\n      if (mode === 'invoice') {\r\n        return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`);\r\n      }\r\n      return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`);\r\n    }\r\n    let url = this.printingBaseUrl;\r\n    if (mode === 'invoice') {\r\n      url = url + '&mode=invoice';\r\n    }\r\n    const { data } = await axios.post(`Get_ShortLiving_Token`);\r\n    if (!data.ExceptionMsg) {\r\n      url = url + `&token=${data.My_Result}`;\r\n    }\r\n    window.open(url);\r\n  }\r\n\r\n  private handleCloseBookingWindow() {\r\n    this.bookingItem = null;\r\n  }\r\n\r\n  private handleDeleteFinish(e: CustomEvent) {\r\n    this.booking = { ...this.booking, rooms: this.booking.rooms.filter(room => room.identifier !== e.detail) };\r\n  }\r\n\r\n  private async resetBooking() {\r\n    try {\r\n      const booking = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\r\n      this.booking = { ...booking };\r\n      this.bookingChanged.emit(this.booking);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  private async handleModalConfirm(e: IrModalCustomEvent<any>) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    switch (this.modalState.type) {\r\n      case 'email':\r\n        await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr, this.language);\r\n        break;\r\n    }\r\n    this.modalState = null;\r\n    this.modalRef.closeModal();\r\n  }\r\n  private renderSidebarContent() {\r\n    const handleClose = () => {\r\n      this.sidebarState = null;\r\n    };\r\n    switch (this.sidebarState) {\r\n      case 'guest':\r\n        return (\r\n          <ir-guest-info\r\n            isInSideBar\r\n            headerShown\r\n            slot=\"sidebar-body\"\r\n            booking_nbr={this.bookingNumber}\r\n            email={this.booking?.guest.email}\r\n            language={this.language}\r\n            onCloseSideBar={handleClose}\r\n          ></ir-guest-info>\r\n        );\r\n      case 'pickup':\r\n        return (\r\n          <ir-pickup\r\n            bookingDates={{ from: this.booking.from_date, to: this.booking.to_date }}\r\n            slot=\"sidebar-body\"\r\n            defaultPickupData={this.booking.pickup_info}\r\n            bookingNumber={this.booking.booking_nbr}\r\n            numberOfPersons={this.booking.occupancy.adult_nbr + this.booking.occupancy.children_nbr}\r\n            onCloseModal={handleClose}\r\n          ></ir-pickup>\r\n        );\r\n      case 'extra_note':\r\n        return <ir-booking-extra-note slot=\"sidebar-body\" booking={this.booking} onCloseModal={() => (this.sidebarState = null)}></ir-booking-extra-note>;\r\n      case 'extra_service':\r\n        return (\r\n          <ir-extra-service-config\r\n            service={this.selectedService}\r\n            booking={{ from_date: this.booking.from_date, to_date: this.booking.to_date, booking_nbr: this.booking.booking_nbr, currency: this.booking.currency }}\r\n            slot=\"sidebar-body\"\r\n            onCloseModal={() => {\r\n              handleClose();\r\n              if (this.selectedService) {\r\n                this.selectedService = null;\r\n              }\r\n            }}\r\n          ></ir-extra-service-config>\r\n        );\r\n      case 'room-guest':\r\n        return (\r\n          <ir-room-guests\r\n            countries={this.countries}\r\n            language={this.language}\r\n            identifier={this.sidebarPayload?.identifier}\r\n            bookingNumber={this.booking.booking_nbr}\r\n            roomName={this.sidebarPayload?.roomName}\r\n            totalGuests={this.sidebarPayload?.totalGuests}\r\n            sharedPersons={this.sidebarPayload?.sharing_persons}\r\n            slot=\"sidebar-body\"\r\n            checkIn={this.sidebarPayload?.checkin}\r\n            onCloseModal={handleClose}\r\n          ></ir-room-guests>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n  render() {\r\n    if (!this.booking) {\r\n      return (\r\n        <div class={'loading-container'}>\r\n          <ir-spinner></ir-spinner>\r\n        </div>\r\n      );\r\n    }\r\n    return [\r\n      <Fragment>\r\n        {!this.is_from_front_desk && (\r\n          <Fragment>\r\n            <ir-toast></ir-toast>\r\n            <ir-interceptor></ir-interceptor>\r\n          </Fragment>\r\n        )}\r\n      </Fragment>,\r\n      <ir-booking-header\r\n        booking={this.booking}\r\n        hasCloseButton={this.hasCloseButton}\r\n        hasDelete={this.hasDelete}\r\n        hasMenu={this.hasMenu}\r\n        hasPrint={this.hasPrint}\r\n        hasReceipt={this.hasReceipt}\r\n        hasEmail={['001', '002'].includes(this.booking?.status?.code)}\r\n      ></ir-booking-header>,\r\n      <div class=\"fluid-container p-1 text-left mx-0\">\r\n        <div class=\"row m-0\">\r\n          <div class=\"col-12 p-0 mx-0 pr-lg-1 col-lg-6\">\r\n            <ir-reservation-information countries={this.countries} booking={this.booking}></ir-reservation-information>\r\n            <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\r\n              <ir-date-view from_date={this.booking.from_date} to_date={this.booking.to_date}></ir-date-view>\r\n              {this.hasRoomAdd && this.booking.is_direct && this.booking.is_editable && (\r\n                <ir-button id=\"room-add\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\r\n              )}\r\n            </div>\r\n            <div class=\"card p-0 mx-0\">\r\n              {this.booking.rooms.map((room: Room, index: number) => {\r\n                const showCheckin = this.handleRoomCheckin(room);\r\n                const showCheckout = this.handleRoomCheckout(room);\r\n                return [\r\n                  <ir-room\r\n                    room={room}\r\n                    language={this.language}\r\n                    bedPreferences={this.bedPreference}\r\n                    isEditable={this.booking.is_editable}\r\n                    legendData={this.calendarData.legendData}\r\n                    roomsInfo={this.calendarData.roomsInfo}\r\n                    myRoomTypeFoodCat={room.roomtype.name}\r\n                    mealCodeName={room.rateplan.short_name}\r\n                    currency={this.booking.currency.symbol}\r\n                    hasRoomEdit={this.hasRoomEdit && this.booking.status.code !== '003' && this.booking.is_direct}\r\n                    hasRoomDelete={this.hasRoomDelete && this.booking.status.code !== '003' && this.booking.is_direct}\r\n                    hasCheckIn={showCheckin}\r\n                    hasCheckOut={showCheckout}\r\n                    booking={this.booking}\r\n                    bookingIndex={index}\r\n                    onDeleteFinished={this.handleDeleteFinish.bind(this)}\r\n                  />,\r\n                  index !== this.booking.rooms.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />,\r\n                ];\r\n              })}\r\n            </div>\r\n            {/* <ir-ota-services services={this.booking.ota_services}></ir-ota-services> */}\r\n            <ir-pickup-view booking={this.booking}></ir-pickup-view>\r\n            <section>\r\n              <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\r\n                <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_ExtraServices}</p>\r\n                <ir-button id=\"extra_service_btn\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\r\n              </div>\r\n              <ir-extra-services\r\n                booking={{ booking_nbr: this.booking.booking_nbr, currency: this.booking.currency, extra_services: this.booking.extra_services }}\r\n              ></ir-extra-services>\r\n            </section>\r\n          </div>\r\n          <div class=\"col-12 p-0 m-0 pl-lg-1 col-lg-6\">\r\n            <ir-payment-details paymentActions={this.paymentActions} bookingDetails={this.booking}></ir-payment-details>\r\n          </div>\r\n        </div>\r\n      </div>,\r\n      <ir-modal\r\n        modalBody={this.modalState?.message}\r\n        leftBtnText={locales.entries.Lcz_Cancel}\r\n        rightBtnText={locales.entries.Lcz_Confirm}\r\n        autoClose={false}\r\n        isLoading={isRequestPending('/Send_Booking_Confirmation_Email')}\r\n        ref={el => (this.modalRef = el)}\r\n        onConfirmModal={e => {\r\n          this.handleModalConfirm(e);\r\n        }}\r\n        onCancelModal={() => {\r\n          this.modalRef.closeModal();\r\n        }}\r\n      ></ir-modal>,\r\n      <ir-sidebar\r\n        open={this.sidebarState !== null}\r\n        side={'right'}\r\n        id=\"editGuestInfo\"\r\n        style={{ '--sidebar-width': this.sidebarState === 'room-guest' ? '60rem' : undefined }}\r\n        onIrSidebarToggle={e => {\r\n          e.stopImmediatePropagation();\r\n          e.stopPropagation();\r\n          this.sidebarState = null;\r\n        }}\r\n        showCloseButton={false}\r\n      >\r\n        {this.renderSidebarContent()}\r\n      </ir-sidebar>,\r\n      <Fragment>\r\n        {this.bookingItem && (\r\n          <igl-book-property\r\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\r\n            adultChildConstraints={this.calendarData.adult_child_constraints}\r\n            showPaymentDetails={this.showPaymentDetails}\r\n            countries={this.countries}\r\n            currency={this.calendarData.currency}\r\n            language={this.language}\r\n            propertyid={this.property_id}\r\n            bookingData={this.bookingItem}\r\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\r\n          ></igl-book-property>\r\n        )}\r\n      </Fragment>,\r\n    ];\r\n  }\r\n  private handleRoomCheckout(room: Room): boolean {\r\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\r\n      return false;\r\n    }\r\n    return room.in_out.code === '001';\r\n  }\r\n  private handleRoomCheckin(room: Room): boolean {\r\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\r\n      return false;\r\n    }\r\n    if (!room.unit) {\r\n      return false;\r\n    }\r\n    if (room.in_out && room.in_out.code !== '000') {\r\n      return false;\r\n    }\r\n    if (moment(new Date()).isSameOrAfter(new Date(room.from_date), 'days') && moment(new Date()).isBefore(new Date(room.to_date), 'days')) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n",":host {\r\n  height: 100%;\r\n}\r\n.sheet-container {\r\n  display: flex !important;\r\n  flex-direction: column !important;\r\n  background: white;\r\n  height: 100% !important;\r\n  gap: 1rem;\r\n}\r\n.sheet-footer {\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 20;\r\n  background: white;\r\n  border-top: 1px solid #e4e5ec;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  gap: 0.5rem;\r\n}\r\n.sheet-header {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  background: white;\r\n}\r\n.sheet-body {\r\n  flex: 1 1 0%;\r\n}\r\n@media (min-width: 768px) {\r\n  .sheet-footer {\r\n    flex-direction: row;\r\n    align-items: center;\r\n  }\r\n}\r\n","import locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { getPrivateNote } from '@/utils/booking';\r\n@Component({\r\n  tag: 'ir-booking-extra-note',\r\n  styleUrls: ['ir-booking-extra-note.css', '../../../common/sheet.css'],\r\n  scoped: true,\r\n})\r\nexport class IrBookingExtraNote {\r\n  @Prop() booking: Booking;\r\n\r\n  @State() isLoading = false;\r\n  @State() note = '';\r\n\r\n  @Event() closeModal: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\r\n\r\n  private bookingService = new BookingService();\r\n  componentWillLoad() {\r\n    if (this.booking.extras) {\r\n      this.setNote(getPrivateNote(this.booking.extras));\r\n    }\r\n  }\r\n\r\n  private setNote(value: string) {\r\n    this.note = value;\r\n  }\r\n  private async savePrivateNote() {\r\n    try {\r\n      this.isLoading = true;\r\n      let prevExtras = this.booking.extras || [];\r\n      const newExtraObj = { key: 'private_note', value: this.note };\r\n      if (prevExtras.length === 0) {\r\n        prevExtras.push(newExtraObj);\r\n      } else {\r\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\r\n        if (oldPrivateNoteIndex === -1) {\r\n          prevExtras.push(newExtraObj);\r\n        } else {\r\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\r\n        }\r\n      }\r\n      const res = await this.bookingService.doReservation({\r\n        assign_units: true,\r\n        is_pms: true,\r\n        is_direct: true,\r\n        is_in_loyalty_mode: false,\r\n        promo_key: null,\r\n        booking: this.booking,\r\n        Is_Non_Technical_Change: true,\r\n        extras: prevExtras,\r\n      });\r\n      this.resetBookingEvt.emit(res);\r\n      this.closeModal.emit(null);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <form\r\n        class={'sheet-container h-100'}\r\n        onSubmit={e => {\r\n          e.preventDefault();\r\n          this.savePrivateNote();\r\n        }}\r\n      >\r\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_PrivateNote} displayContext=\"sidebar\"></ir-title>\r\n        <div class=\"sheet-body px-1\">\r\n          <ir-textarea placeholder={locales.entries.Lcz_PrivateNote_MaxChar} label=\"\" value={this.note} maxLength={150} onTextChange={e => this.setNote(e.detail)}></ir-textarea>\r\n        </div>\r\n        <div class={'sheet-footer'}>\r\n          <ir-button\r\n            onClickHandler={() => this.closeModal.emit(null)}\r\n            btn_styles=\"justify-content-center\"\r\n            class={`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`}\r\n            icon=\"\"\r\n            text={locales.entries.Lcz_Cancel}\r\n            btn_color=\"secondary\"\r\n          ></ir-button>\r\n\r\n          <ir-button\r\n            btn_styles=\"justify-content-center align-items-center\"\r\n            class={'m-0 flex-fill text-center ml-sm-1'}\r\n            icon=\"\"\r\n            isLoading={this.isLoading}\r\n            text={locales.entries.Lcz_Save}\r\n            btn_color=\"primary\"\r\n            btn_type=\"submit\"\r\n          ></ir-button>\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n.confirmed {\r\n  color: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.bg-ir-green {\r\n  background: #629a4c;\r\n  padding: 0.2rem 0.3rem;\r\n  /* height: 28px; */\r\n  /* padding-top: 0 !important;\r\n  padding-bottom: 0 !important ; */\r\n}\r\n.bg-ir-red {\r\n  background: #ff4961;\r\n  padding: 0.2rem 0.3rem;\r\n  /* height: 28px; */\r\n  /* padding-top: 0 !important;\r\n  padding-bottom: 0 !important ; */\r\n}\r\n.bg-ir-orange {\r\n  background: #ff9149;\r\n  padding: 0.2rem 0.3rem;\r\n  /* height: 28px; */\r\n  /* padding-top: 0 !important;\r\n  padding-bottom: 0 !important ; */\r\n}\r\n","import { IToast } from '@/components/ui/ir-toast/toast';\r\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, h, Listen, Prop, State } from '@stencil/core';\r\nimport { BookingDetailsDialogEvents, OpenDialogEvent, OpenSidebarEvent } from '../types';\r\nimport { BookingService } from '@/services/booking.service';\r\n\r\n@Component({\r\n  tag: 'ir-booking-header',\r\n  styleUrl: 'ir-booking-header.css',\r\n  scoped: true,\r\n})\r\nexport class IrBookingHeader {\r\n  @Prop() booking: Booking;\r\n  @Prop() hasReceipt: boolean;\r\n  @Prop() hasPrint: boolean;\r\n  @Prop() hasDelete: boolean;\r\n  @Prop() hasMenu: boolean;\r\n  @Prop() hasCloseButton: boolean;\r\n  @Prop() hasEmail: boolean = true;\r\n\r\n  @State() bookingStatus: string | null = null;\r\n  @State() currentDialogStatus: BookingDetailsDialogEvents;\r\n\r\n  @Event() toast: EventEmitter<IToast>;\r\n  @Event() closeSidebar: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\r\n\r\n  private confirmationBG = {\r\n    '001': 'bg-ir-orange',\r\n    '002': 'bg-ir-green',\r\n    '003': 'bg-ir-red',\r\n    '004': 'bg-ir-red',\r\n  };\r\n  private dialogRef: HTMLIrDialogElement;\r\n\r\n  private bookingService = new BookingService();\r\n\r\n  @Listen('selectChange')\r\n  handleSelectChange(e: CustomEvent<any>) {\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    const target = e.target;\r\n    this.bookingStatus = (target as any).selectedValue;\r\n  }\r\n  private async updateStatus() {\r\n    if (!this.bookingStatus || this.bookingStatus === '-1') {\r\n      this.toast.emit({\r\n        type: 'error',\r\n        description: '',\r\n        title: locales.entries.Lcz_SelectStatus,\r\n        position: 'top-right',\r\n      });\r\n      return;\r\n    }\r\n    try {\r\n      await this.bookingService.changeExposedBookingStatus({\r\n        book_nbr: this.booking.booking_nbr,\r\n        status: this.bookingStatus,\r\n      });\r\n      this.toast.emit({\r\n        type: 'success',\r\n        description: '',\r\n        title: locales.entries.Lcz_StatusUpdatedSuccessfully,\r\n        position: 'top-right',\r\n      });\r\n      this.bookingStatus = null;\r\n      this.resetBookingEvt.emit(null);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  private openDialog(e: OpenDialogEvent) {\r\n    const { type } = e;\r\n    this.currentDialogStatus = type;\r\n    this.dialogRef.openModal();\r\n  }\r\n  private renderDialogBody() {\r\n    switch (this.currentDialogStatus) {\r\n      case 'pms':\r\n        return <ir-pms-logs slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-pms-logs>;\r\n      case 'events-log':\r\n        return <ir-events-log slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-events-log>;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"fluid-container px-1\">\r\n        <div class=\"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1\">\r\n          <div class=\"m-0 p-0 mb-1 mb-lg-0 mt-md-0\">\r\n            <p class=\"font-size-large m-0 p-0\">{`${locales.entries.Lcz_Booking}#${this.booking.booking_nbr}`}</p>\r\n            <p class=\"m-0 p-0\">{!this.booking.is_direct && <span class=\"mr-1 m-0\">{this.booking.channel_booking_nbr}</span>}</p>\r\n          </div>\r\n\r\n          <div class=\"d-flex justify-content-end align-items-center\" style={{ gap: '1rem', flexWrap: 'wrap' }}>\r\n            <span class={`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.status.code]}`}>{this.booking.status.description}</span>\r\n            {this.booking.allowed_actions.length > 0 && this.booking.is_editable && (\r\n              <div class=\"m-0 p-0 d-flex align-items-center\" style={{ gap: '0.25rem' }}>\r\n                <ir-select\r\n                  selectContainerStyle=\"h-28\"\r\n                  selectStyles=\"d-flex status-select align-items-center h-28\"\r\n                  firstOption={locales.entries.Lcz_Select}\r\n                  id=\"update-status\"\r\n                  size=\"sm\"\r\n                  label-available=\"false\"\r\n                  data={this.booking.allowed_actions.map(b => ({ text: b.description, value: b.code }))}\r\n                  textSize=\"sm\"\r\n                  class=\"sm-padding-right m-0 \"\r\n                  selectedValue={this.bookingStatus}\r\n                ></ir-select>\r\n                <ir-button\r\n                  onClickHandler={this.updateStatus.bind(this)}\r\n                  btn_styles=\"h-28\"\r\n                  isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\r\n                  btn_disabled={isRequestPending('/Change_Exposed_Booking_Status')}\r\n                  id=\"update-status-btn\"\r\n                  size=\"sm\"\r\n                  text=\"Update\"\r\n                ></ir-button>\r\n              </div>\r\n            )}\r\n            <ir-button\r\n              size=\"sm\"\r\n              btn_color=\"outline\"\r\n              text={locales.entries.Lcz_EventsLog}\r\n              onClickHandler={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                this.openDialog({ type: 'events-log' });\r\n              }}\r\n            ></ir-button>\r\n            {calendar_data.is_pms_enabled && (\r\n              <ir-button\r\n                size=\"sm\"\r\n                btn_color=\"outline\"\r\n                text={locales.entries.Lcz_pms}\r\n                onClick={e => {\r\n                  e.stopImmediatePropagation();\r\n                  e.stopPropagation();\r\n                  this.openDialog({ type: 'pms' });\r\n                }}\r\n              ></ir-button>\r\n            )}\r\n            {this.hasReceipt && <ir-button variant=\"icon\" id=\"receipt\" icon_name=\"reciept\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\r\n            {this.hasPrint && <ir-button variant=\"icon\" id=\"print\" icon_name=\"print\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\r\n            {this.hasEmail && <ir-button variant=\"icon\" id=\"email\" title=\"Email this booking\" icon_name=\"email\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\r\n            {this.hasDelete && <ir-button variant=\"icon\" id=\"book-delete\" icon_name=\"trash\" class=\"\" style={{ ...colorVariants.danger, '--icon-size': '1.65rem' }}></ir-button>}\r\n            {this.hasMenu && <ir-button variant=\"icon\" class=\"mr-1\" id=\"menu\" icon_name=\"menu_list\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\r\n\r\n            {this.hasCloseButton && (\r\n              <ir-button\r\n                id=\"close\"\r\n                variant=\"icon\"\r\n                style={{ '--icon-size': '1.65rem' }}\r\n                icon_name=\"xmark\"\r\n                class=\"ml-2\"\r\n                onClickHandler={e => {\r\n                  e.stopPropagation();\r\n                  e.stopImmediatePropagation();\r\n                  this.closeSidebar.emit(null);\r\n                }}\r\n              ></ir-button>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <ir-dialog\r\n          onOpenChange={e => {\r\n            if (!e.detail) {\r\n              this.currentDialogStatus = null;\r\n            }\r\n          }}\r\n          style={this.currentDialogStatus === 'events-log' && { '--ir-dialog-max-width': '400px' }}\r\n          ref={el => (this.dialogRef = el)}\r\n        >\r\n          {this.renderDialogBody()}\r\n        </ir-dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  margin: 0;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n}\r\n.backdrop {\r\n  opacity: 0;\r\n  background: rgba(0, 0, 0, 0.2);\r\n  position: fixed;\r\n  inset: 0;\r\n  z-index: 99999998;\r\n}\r\n.backdrop[data-state='opened'] {\r\n  animation: overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\r\n}\r\n.backdrop[data-state='closed'] {\r\n  opacity: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.modal-container {\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\r\n  position: fixed;\r\n  z-index: 99999999;\r\n  overflow-y: auto;\r\n  top: 50%;\r\n  left: 50%;\r\n  background: white;\r\n  transform: translate(-50%, -50%);\r\n  width: 90%;\r\n  min-height: fit-content;\r\n  height: fit-content;\r\n  max-width: var(--ir-dialog-max-width, 40rem);\r\n  max-height: 85vh;\r\n  border-radius: 8px;\r\n  padding: 0;\r\n  animation: contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1);\r\n}\r\n\r\n.modal-footer ::slotted(*) {\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: end;\r\n  gap: 8px;\r\n  --ir-btn-width: inherit;\r\n}\r\n.modal-footer {\r\n  --ir-btn-width: 100%;\r\n}\r\n.modal-title ::slotted(*) {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #101828;\r\n  margin-bottom: 8px;\r\n}\r\n.modal-body ::slotted(*) {\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  color: #475467;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\n@keyframes overlayShow {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n@keyframes contentShow {\r\n  from {\r\n    opacity: 0;\r\n    transform: translate(-50%, -48%) scale(0.96);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translate(-50%, -50%) scale(1);\r\n  }\r\n}\r\n.dialog-close-button {\r\n  position: absolute;\r\n  top: 15px;\r\n  right: 15px;\r\n}\r\n/* md */\r\n","import { Component, Host, h, Element, Method, Listen, State, Event, EventEmitter, Prop, Watch } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-dialog',\r\n  styleUrl: 'ir-dialog.css',\r\n  shadow: true,\r\n})\r\nexport class IrDialog {\r\n  @Prop() open: boolean = false;\r\n  @Element() el: HTMLElement;\r\n  private firstFocusableElement: HTMLElement;\r\n  private lastFocusableElement: HTMLElement;\r\n\r\n  @State() isOpen = false;\r\n  @Event() openChange: EventEmitter<boolean>;\r\n  componentWillLoad() {\r\n    if (this.open) {\r\n      this.openModal();\r\n    }\r\n  }\r\n  componentDidLoad() {\r\n    this.prepareFocusTrap();\r\n  }\r\n\r\n  @Method()\r\n  async openModal() {\r\n    this.isOpen = true;\r\n    document.body.style.overflow = 'hidden';\r\n    setTimeout(() => {\r\n      this.prepareFocusTrap();\r\n    }, 10);\r\n    this.openChange.emit(this.isOpen);\r\n  }\r\n\r\n  @Method()\r\n  async closeModal() {\r\n    console.log('close');\r\n    if (!this.isOpen) {\r\n      return;\r\n    }\r\n    document.body.style.overflow = 'visible';\r\n    this.isOpen = false;\r\n    this.openChange.emit(this.isOpen);\r\n  }\r\n\r\n  @Watch('open')\r\n  handleOpenChange() {\r\n    if (this.open) {\r\n      this.openModal();\r\n    } else {\r\n      this.closeModal();\r\n    }\r\n  }\r\n\r\n  prepareFocusTrap() {\r\n    const focusableElements = 'button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\r\n    const focusableContent: NodeListOf<HTMLElement> = this.el.shadowRoot.querySelectorAll(focusableElements);\r\n    // console.log(focusableContent);\r\n    if (focusableContent.length === 0) return;\r\n    this.firstFocusableElement = focusableContent[0];\r\n    this.lastFocusableElement = focusableContent[focusableContent.length - 1];\r\n    this.firstFocusableElement.focus();\r\n  }\r\n\r\n  @Listen('keydown', { target: 'window' })\r\n  handleKeyDown(ev: KeyboardEvent) {\r\n    if (!this.isOpen) {\r\n      return;\r\n    }\r\n\r\n    let isTabPressed = ev.key === 'Tab';\r\n    if (ev.key === 'Escape' && this.isOpen) {\r\n      this.closeModal();\r\n    }\r\n    if (!isTabPressed) {\r\n      return;\r\n    }\r\n\r\n    // If focus is about to leave the last focusable element, redirect it to the first.\r\n    if (!ev.shiftKey && document.activeElement === this.lastFocusableElement) {\r\n      this.firstFocusableElement.focus();\r\n      ev.preventDefault();\r\n    }\r\n\r\n    // If focus is about to leave the first focusable element, redirect it to the last.\r\n    if (ev.shiftKey && document.activeElement === this.firstFocusableElement) {\r\n      this.lastFocusableElement.focus();\r\n      ev.preventDefault();\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    document.body.style.overflow = 'visible';\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"backdrop\" data-state={this.isOpen ? 'opened' : 'closed'} onClick={() => this.closeModal()}></div>\r\n        {this.isOpen && (\r\n          <div class=\"modal-container\" tabIndex={-1} role=\"dialog\" aria-labelledby=\"dialog1Title\" aria-describedby=\"dialog1Desc\">\r\n            <ir-icon id=\"close\" class=\"dialog-close-button\" onIconClickHandler={() => this.closeModal()}>\r\n              <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={18} width={18}>\r\n                <path\r\n                  fill=\"#104064\"\r\n                  class=\"currentColor\"\r\n                  d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\r\n                />\r\n              </svg>\r\n            </ir-icon>\r\n            <div class={'modal-title'} id=\"dialog1Title\">\r\n              <slot name=\"modal-title\"></slot>\r\n            </div>\r\n            <div class=\"modal-body\" id=\"dialog1Desc\">\r\n              <slot name=\"modal-body\"></slot>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n              <slot name=\"modal-footer\"></slot>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n\r\n.beta {\r\n  background: var(--red);\r\n  color: white;\r\n  padding: 0.2rem 0.3rem;\r\n  font-size: 12px;\r\n  border-radius: 4px;\r\n  margin: 0;\r\n}\r\n.event-row {\r\n  padding-bottom: 0.5rem;\r\n}\r\n.list-title {\r\n  margin: 0;\r\n  padding: 0;\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  width: fit-content;\r\n}\r\n.list-item {\r\n  margin: 0;\r\n  padding: 0;\r\n  font-size: 14px;\r\n  margin-left: 5px;\r\n  width: fit-content;\r\n}\r\n.list-item.green {\r\n  color: #629a4c;\r\n  font-weight: 600;\r\n}\r\n.list-item.red {\r\n  color: #ff4961;\r\n  font-weight: 600;\r\n}\r\n.dates-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.875rem;\r\n}\r\n","import { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { Component, Fragment, Prop, State, h } from '@stencil/core';\r\nimport { BookingService, ExposedBookingEvent } from '@/services/booking.service';\r\nimport locales from '@/stores/locales.store';\r\n\r\n@Component({\r\n  tag: 'ir-events-log',\r\n  styleUrl: 'ir-events-log.css',\r\n  scoped: true,\r\n})\r\nexport class IrEventsLog {\r\n  @Prop() bookingNumber: string;\r\n\r\n  @State() bookingEvents: ExposedBookingEvent[];\r\n\r\n  private bookingService = new BookingService();\r\n\r\n  componentWillLoad() {\r\n    this.init();\r\n  }\r\n\r\n  private async init() {\r\n    try {\r\n      this.bookingEvents = await this.bookingService.getExposedBookingEvents(this.bookingNumber);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"p-1\">\r\n        <div class=\"d-flex  align-items-center\" style={{ gap: '0.5rem' }}>\r\n          <h3 class=\" text-left p-0 m-0  dialog-title \">{locales.entries.Lcz_EventsLog}</h3>\r\n          {/* <span class=\"m-0 beta\">Beta</span> */}\r\n        </div>\r\n\r\n        {isRequestPending('/Get_Exposed_Booking_Events') ? (\r\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\r\n            <ir-spinner></ir-spinner>\r\n          </div>\r\n        ) : (\r\n          <Fragment>\r\n            <table class=\" dialog-container-height\">\r\n              <thead style={{ opacity: '0' }}>\r\n                <tr>\r\n                  <th>date</th>\r\n                  <th>user</th>\r\n                  <th>status</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {this.bookingEvents?.map(e => (\r\n                  <tr key={e.id} class=\"pb-1\">\r\n                    <td class=\"event-row dates-row\">\r\n                      <span>{e.date}</span>\r\n                      <span>\r\n                        {String(e.hour).padStart(2, '0')}:{String(e.minute).padStart(2, '0')}:{String(e.second).padStart(2, '0')}\r\n                      </span>\r\n                    </td>\r\n                    <td class=\"pl-3 event-row \">{e.type}</td>\r\n                    <td class=\"pl-1 event-row \">{e.user}</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </Fragment>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n.extra-service-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 0.5rem;\r\n}\r\n.extra-service-container * {\r\n  padding: 0;\r\n  margin: 0;\r\n  box-sizing: border-box;\r\n}\r\n.extra-service-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n.extra-service-conditional-date {\r\n  margin-top: 0.5rem;\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\nimport { ExtraService } from '@/models/booking.dto';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport locales from '@/stores/locales.store';\r\nimport moment from 'moment';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\n\r\n@Component({\r\n  tag: 'ir-extra-service',\r\n  styleUrl: 'ir-extra-service.css',\r\n  scoped: true,\r\n})\r\nexport class IrExtraService {\r\n  @Prop() service: ExtraService;\r\n  @Prop() bookingNumber: string;\r\n  @Prop() currencySymbol: string;\r\n\r\n  @Event() editExtraService: EventEmitter<ExtraService>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n\r\n  private irModalRef: HTMLIrModalElement;\r\n  private bookingService = new BookingService();\r\n\r\n  private async deleteService() {\r\n    try {\r\n      await this.bookingService.doBookingExtraService({\r\n        service: this.service,\r\n        is_remove: true,\r\n        booking_nbr: this.bookingNumber,\r\n      });\r\n      this.resetBookingEvt.emit(null);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"p-1\">\r\n          <div class={'extra-service-container'}>\r\n            <p class=\"extra-service-description\">{this.service.description}</p>\r\n            <div class=\"extra-service-actions\">\r\n              {this.service.price && <p class=\"extra-service-price p-0 m-0 font-weight-bold\">{formatAmount(this.currencySymbol, this.service.price)}</p>}\r\n              <ir-button\r\n                id={`serviceEdit-${this.service.booking_system_id}`}\r\n                class=\"extra-service-edit-btn m-0 p-0\"\r\n                variant=\"icon\"\r\n                icon_name=\"edit\"\r\n                style={colorVariants.secondary}\r\n                onClickHandler={() => this.editExtraService.emit(this.service)}\r\n              ></ir-button>\r\n              <ir-button\r\n                class=\"extra-service-delete-btn m-0 p-0\"\r\n                variant=\"icon\"\r\n                onClickHandler={() => this.irModalRef.openModal()}\r\n                id={`roomDelete-${this.service.booking_system_id}`}\r\n                icon_name=\"trash\"\r\n                style={colorVariants.danger}\r\n              ></ir-button>\r\n            </div>\r\n          </div>\r\n          <div class=\"extra-service-conditional-date\">\r\n            {this.service.start_date && this.service.end_date ? (\r\n              <ir-date-view class=\"extra-service-date-view mr-1\" from_date={this.service.start_date} to_date={this.service.end_date} showDateDifference={false}></ir-date-view>\r\n            ) : (\r\n              this.service.start_date && <p class=\"extra-service-date-view\">{moment(new Date(this.service.start_date)).format('MMM DD, YYYY')}</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <ir-modal\r\n          autoClose={false}\r\n          ref={el => (this.irModalRef = el)}\r\n          isLoading={isRequestPending('/Do_Booking_Extra_Service')}\r\n          onConfirmModal={this.deleteService.bind(this)}\r\n          iconAvailable={true}\r\n          icon=\"ft-alert-triangle danger h1\"\r\n          leftBtnText={locales.entries.Lcz_Cancel}\r\n          rightBtnText={locales.entries.Lcz_Delete}\r\n          leftBtnColor=\"secondary\"\r\n          rightBtnColor=\"danger\"\r\n          modalTitle={locales.entries.Lcz_Confirmation}\r\n          modalBody={`${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${locales.entries.Lcz_ThisService} ${locales.entries.Lcz_FromThisBooking}`}\r\n        ></ir-modal>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n","import { z } from 'zod';\r\nimport { IAllowedOptions, ICurrency, IPickupCurrency } from './calendarData';\r\nimport { TSourceOption } from './igl-book-property';\r\nimport { ICountry } from './IBooking';\r\nimport moment from 'moment';\r\nimport { IHouseKeepers } from './housekeeping';\r\n\r\ninterface IDType {\r\n  code: string;\r\n  description: string;\r\n}\r\n\r\ninterface IDInfo {\r\n  type: IDType;\r\n  number: string;\r\n}\r\n\r\nexport interface SharedPerson {\r\n  address: null;\r\n  alternative_email: null;\r\n  cci: null;\r\n  city: null;\r\n  country: ICountry;\r\n  country_id: string;\r\n  country_phone_prefix: null;\r\n  dob: string;\r\n  email: null;\r\n  first_name: string;\r\n  full_name: string;\r\n  id: number;\r\n  id_info: IDInfo;\r\n  is_main?: boolean;\r\n  last_name: string;\r\n  mobile: null;\r\n  nbr_confirmed_bookings: number;\r\n  notes: null;\r\n  password: null;\r\n  subscribe_to_news_letter: null;\r\n}\r\n// export const ZIdInfo = z.object({\r\n//   type: z.object({\r\n//     code: z.string().min(3),\r\n//     description: z.string(),\r\n//   }),\r\n//   number: z.string().min(2),\r\n// });\r\n// export const ZSharedPerson = z.object({\r\n//   id: z.number(),\r\n//   full_name: z.string().min(2),\r\n//   country_id: z.coerce.number().min(0),\r\n//   dob: z.coerce.date().transform(date => moment(date).format('YYYY-MM-DD')),\r\n//   id_info: ZIdInfo,\r\n// });\r\n\r\n/**\r\n * ZIdInfo schema:\r\n * - `type.code`: Validates a non-empty string must be at least 3 chars.\r\n *   If empty string or not provided, validation is skipped.\r\n * - `type.description`: Same pattern for description (but no min length).\r\n * - `number`: Validates if non-empty string it should be at least 2 chars.\r\n */\r\nexport const ZIdInfo = z.object({\r\n  type: z.object({\r\n    code: z\r\n      .union([\r\n        // If provided and non-empty, must have at least 3 chars\r\n        z.string().min(3),\r\n        // or it can be an empty string\r\n        z.literal(''),\r\n      ])\r\n      .optional(), // or undefined\r\n    description: z\r\n      .union([\r\n        // If provided and non-empty, no special min\r\n        z.string(),\r\n        // or it can be empty string\r\n        z.literal(''),\r\n      ])\r\n      .optional(),\r\n  }),\r\n  number: z\r\n    .union([\r\n      // If provided and non-empty, must have at least 2 chars\r\n      z.string().min(2),\r\n      // or it can be empty string\r\n      z.literal(''),\r\n    ])\r\n    .optional(),\r\n});\r\n\r\n/**\r\n * ZSharedPerson schema:\r\n * - `id`: Optional numeric field.\r\n * - `full_name`: If provided and non-empty, must be at least 2 chars.\r\n * - `country_id`: If provided, coerced to number, must be >= 0.\r\n * - `dob`: If provided, coerced to Date and formatted. Otherwise skipped.\r\n * - `id_info`: The nested object above; can also be omitted entirely.\r\n */\r\nexport const ZSharedPerson = z.object({\r\n  id: z.number().optional(),\r\n  // full_name: z\r\n  //   .union([\r\n  //     z.string().min(2), // if provided and non-empty, must have min length 2\r\n  //     z.literal(''), // or it can be empty string\r\n  //   ])\r\n  //   .optional(),\r\n  first_name: z\r\n    .union([\r\n      z.string().min(2), // if provided and non-empty, must have min length 2\r\n      z.literal(''), // or it can be empty string\r\n    ])\r\n    .optional(),\r\n  last_name: z\r\n    .union([\r\n      z.string().min(2), // if provided and non-empty, must have min length 2\r\n      z.literal(''), // or it can be empty string\r\n    ])\r\n    .optional(),\r\n  country_id: z.coerce\r\n    .number()\r\n    .min(0) // if provided, must be >= 0\r\n    .optional(),\r\n  dob: z\r\n    .string()\r\n    .nullable()\r\n    .optional()\r\n    .refine(value => value === undefined || moment(value, 'DD/MM/YYYY', true).isValid() || value === '' || value === null, 'Invalid date format')\r\n    .transform(value => {\r\n      if (value === undefined || value === '' || value === null) return null;\r\n      const isDDMMYYYY = moment(value, 'DD/MM/YYYY', true).isValid();\r\n      return isDDMMYYYY ? null : moment(value, 'DD/MM/YYYY').format('YYYY-MM-DD');\r\n    }),\r\n  id_info: ZIdInfo.optional(),\r\n});\r\n\r\nexport const ZSharedPersons = z.array(ZSharedPerson);\r\n\r\nexport interface HandleExposedRoomGuestsRequest {\r\n  booking_nbr: string;\r\n  identifier: string;\r\n  guests: SharedPerson[];\r\n}\r\nexport interface OtaGuarantee {\r\n  card_number: string;\r\n  card_type: string;\r\n  cardholder_name: string;\r\n  cvv: string;\r\n  expiration_date: string;\r\n  is_virtual: boolean;\r\n  meta: Meta;\r\n  token: string;\r\n}\r\n\r\ninterface Meta {\r\n  virtual_card_currency_code: string;\r\n  virtual_card_current_balance: string;\r\n  virtual_card_decimal_places: string;\r\n  virtual_card_effective_date: string;\r\n  virtual_card_expiration_date: string;\r\n}\r\nexport interface OtaService {\r\n  name: string;\r\n  nights: number;\r\n  persons: number;\r\n  price_mode: string;\r\n  price_per_unit: number;\r\n  total_price: number;\r\n}\r\nexport interface Booking {\r\n  agent: {\r\n    code: string;\r\n    id: number;\r\n    name: string;\r\n    verification_mode: null;\r\n  } | null;\r\n  ota_services: OtaService[];\r\n  arrival: Arrival;\r\n  allowed_actions: IAllowedActions[];\r\n  system_id: number;\r\n  booked_on: DateTime;\r\n  booking_nbr: string;\r\n  currency: Currency;\r\n  extra_services: ExtraService[] | null;\r\n  from_date: string;\r\n  guest: Guest;\r\n  extras: Extras[] | null;\r\n  occupancy: Occupancy;\r\n  origin: Origin;\r\n  ota_guarante: OtaGuarantee;\r\n  property: Property;\r\n  remark: string;\r\n  ota_notes: IOtaNotes[];\r\n  rooms: Room[];\r\n  source: Source;\r\n  status: Status;\r\n  to_date: string;\r\n  total: number;\r\n  is_editable: boolean;\r\n  format: IFormat;\r\n  channel_booking_nbr: string | null;\r\n  is_direct: boolean;\r\n  financial: IFinancials;\r\n  pickup_info: IBookingPickupInfo | null;\r\n  cost: number | null;\r\n  is_pms_enabled: boolean;\r\n  promo_key: string | null;\r\n  is_in_loyalty_mode: boolean;\r\n}\r\n\r\nexport const ExtraServiceSchema = z.object({\r\n  booking_system_id: z.number().optional(),\r\n  cost: z.coerce.number().nullable(),\r\n  currency_id: z.number().min(1),\r\n  description: z.string().min(1),\r\n  end_date: z.string().nullable(),\r\n  price: z.coerce.number(),\r\n  start_date: z.string().nullable(),\r\n  system_id: z.number().optional(),\r\n});\r\n\r\nexport type ExtraService = z.infer<typeof ExtraServiceSchema>;\r\nexport interface Extras {\r\n  key: string;\r\n  value: any;\r\n}\r\nexport interface IOtaNotes {\r\n  statement: string;\r\n}\r\nexport interface IBookingPickupInfo {\r\n  currency: IPickupCurrency;\r\n  date: string;\r\n  details: string;\r\n  hour: number;\r\n  minute: number;\r\n  nbr_of_units: number;\r\n  selected_option: IAllowedOptions;\r\n  total: number;\r\n}\r\nexport interface IAllowedActions {\r\n  code: string;\r\n  description: string;\r\n}\r\nexport interface IFinancials {\r\n  due_amount: number;\r\n  due_dates: IDueDate[];\r\n  payments: IPayment[] | null;\r\n  total_amount: number;\r\n  gross_total: number;\r\n  gross_cost: number;\r\n  invoice_nbr: string;\r\n}\r\nexport interface IPayment {\r\n  id: number | null;\r\n  date: string;\r\n  amount: number;\r\n  currency: ICurrency;\r\n  designation: string;\r\n  reference: string;\r\n}\r\nexport interface IDueDate {\r\n  amount: number;\r\n  currencysymbol: string;\r\n  date: string;\r\n  description: string;\r\n  room: string;\r\n}\r\nexport interface IFormat {\r\n  from_date: string;\r\n  to_date: string;\r\n}\r\nexport interface Arrival {\r\n  code: string;\r\n  description: string;\r\n}\r\n\r\nexport interface DateTime {\r\n  date: string;\r\n  hour: number;\r\n  minute: number;\r\n}\r\n\r\nexport interface Currency {\r\n  code: string;\r\n  id: number;\r\n  symbol: string;\r\n}\r\n\r\nexport interface Guest {\r\n  address: string | null;\r\n  city: string | null;\r\n  country_id: number | null;\r\n  dob: string | null;\r\n  email: string | null;\r\n  first_name: string;\r\n  id: number;\r\n  last_name: string | null;\r\n  mobile: string | null;\r\n  country_phone_prefix: string | null;\r\n  subscribe_to_news_letter: boolean | null;\r\n  cci?: ICCI | null;\r\n  alternative_email?: string;\r\n  nbr_confirmed_bookings: number;\r\n  notes: string;\r\n  mobile_without_prefix: string;\r\n}\r\nexport interface ICCI {\r\n  nbr: string | number;\r\n  holder_name: string | number;\r\n  expiry_month: string | number;\r\n  expiry_year: string | number;\r\n  cvc?: string | null;\r\n}\r\nexport interface Occupancy {\r\n  adult_nbr: number;\r\n  children_nbr: number;\r\n  infant_nbr: number | null;\r\n}\r\nexport interface DoReservationProps {\r\n  assign_units: boolean;\r\n  check_in: boolean;\r\n  is_pms: boolean;\r\n  is_direct: boolean;\r\n  is_in_loyalty_mode: boolean;\r\n  promo_key: string | null;\r\n  extras: any; // Assuming extras can have any structure, replace with a specific type if known\r\n  booking: {\r\n    from_date: string; // Format 'YYYY-MM-DD'\r\n    to_date: string; // Format 'YYYY-MM-DD'\r\n    remark: string | null;\r\n    booking_nbr: string;\r\n    property: {\r\n      id: string | number;\r\n    };\r\n    booked_on: {\r\n      date: string; // Format 'YYYY-MM-DD'\r\n      hour: number;\r\n      minute: number;\r\n    };\r\n    source: TSourceOption;\r\n    rooms: Room[]; // Assuming rooms are defined in the imported `Room` type\r\n    currency: string;\r\n    arrival: {\r\n      code: string;\r\n    };\r\n    guest: {\r\n      email: string | null;\r\n      first_name: string;\r\n      last_name: string;\r\n      country_id: string | number | null;\r\n      city: string | null;\r\n      mobile: string;\r\n      phone_prefix: string | null;\r\n      address: string;\r\n      dob: string | null;\r\n      subscribe_to_news_letter: boolean;\r\n      cci: {\r\n        nbr: string;\r\n        holder_name: string;\r\n        expiry_month: string;\r\n        expiry_year: string;\r\n      } | null;\r\n    };\r\n  };\r\n  pickup_info: any | null; // Assuming it can be any structure, replace if specific type is available\r\n}\r\nexport interface Origin {\r\n  Icon: string;\r\n  Label: string;\r\n}\r\n\r\nexport interface Property {\r\n  calendar_legends: null;\r\n  currency: null;\r\n  id: number;\r\n  name: string;\r\n  roomtypes: null;\r\n}\r\nexport type RoomInOut = { code: '001' | '002' | '000'; description: string };\r\nexport interface Room {\r\n  days: Day[];\r\n  from_date: string;\r\n  guest: Guest;\r\n  occupancy_default: number;\r\n  notes: string | null;\r\n  occupancy: Occupancy;\r\n  physicalroom: null;\r\n  in_out: RoomInOut | null;\r\n  sharing_persons: SharedPerson[] | null;\r\n  bed_preference: number | null;\r\n  rateplan: RatePlan;\r\n  roomtype: RoomType;\r\n  to_date: string;\r\n  total: number;\r\n  smoking_option: string;\r\n  identifier: string;\r\n  unit: string | number | IUnit | null;\r\n  ota_taxes: IOtaTax[];\r\n  ota_meta: OtaMeta;\r\n  cost: number | null;\r\n  gross_cost: number;\r\n  gross_total: number;\r\n  guarantee: number;\r\n  gross_guarantee: number;\r\n}\r\ninterface OtaMeta {\r\n  bed_preferences: string | null;\r\n  meal_plan: string | null;\r\n  parent_rate_plan_id: string | null;\r\n  policies: string | null;\r\n  smoking_preferences: string | null;\r\n}\r\nexport interface IOtaTax {\r\n  amount: number;\r\n  currency: IOtaTaxCurrency;\r\n  is_exlusive: boolean;\r\n  name: string;\r\n}\r\nexport interface IOtaTaxCurrency {\r\n  code: string;\r\n  id: number;\r\n  symbol: string;\r\n}\r\nexport interface IUnit {\r\n  calendar_cell: null;\r\n  id: 2;\r\n  name: '402';\r\n}\r\nexport interface Day {\r\n  amount: number;\r\n  date: string;\r\n  cost: number | null;\r\n}\r\n\r\nexport interface RatePlan {\r\n  cancelation: string | null;\r\n  guarantee: null;\r\n  id: number;\r\n  name: string;\r\n  rate_restrictions: null;\r\n  variations: null;\r\n  selected_variation: IVariations;\r\n  is_non_refundable: boolean;\r\n  custom_text: string | null;\r\n  is_active: boolean;\r\n  short_name: string;\r\n}\r\nexport interface IVariations {\r\n  adult_child_offering: string;\r\n  adult_nbr: number;\r\n  amount: number | null;\r\n  child_nbr: number;\r\n}\r\nexport interface RoomType {\r\n  availabilities: null;\r\n  id: number;\r\n  inventory: number;\r\n  name: string;\r\n  physicalrooms: PhysicalRoom[];\r\n  rate: number;\r\n  rateplans: null;\r\n  is_active: boolean;\r\n}\r\nexport type RoomHkStatus = '001' | '002' | '003';\r\nexport interface PhysicalRoom {\r\n  calendar_cell: null;\r\n  housekeeper: IHouseKeepers;\r\n  id: number;\r\n  is_active: boolean;\r\n  name: string;\r\n  hk_status: RoomHkStatus;\r\n}\r\n\r\nexport interface Source {\r\n  code: string | null;\r\n  description: string;\r\n  tag: string | null;\r\n}\r\n\r\nexport interface Status {\r\n  code: string;\r\n  description: string;\r\n}\r\n\r\nexport interface IPmsLog {\r\n  is_acknowledged: boolean;\r\n  is_sent: boolean;\r\n  sent_date: string;\r\n  sent_hour: number;\r\n  sent_minute: number;\r\n}\r\n",":host {\r\n  display: block;\r\n  --ir-input-border-color: #cacfe7;\r\n}\r\n\r\n:host .input-group-text {\r\n  border-color: var(--ir-input-border-color);\r\n}\r\n/* .hidden-date-picker.hidden-dates .date-range-input {\r\n  opacity: 0;\r\n} */\r\n.currency-ph {\r\n  padding: 0;\r\n  margin: 0;\r\n  color: #3b4781;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0 0 0 0.25rem;\r\n  border-top: 1px solid var(--ir-input-border-color);\r\n  border-bottom: 1px solid var(--ir-input-border-color);\r\n  border-left: 1px solid transparent;\r\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\r\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\r\n}\r\n\r\n.service-description-input {\r\n  height: 70px !important;\r\n}\r\n\r\n.service-description .input-group-prepend {\r\n  background-color: #f4f5fa;\r\n  border: 1px solid var(--ir-input-border-color);\r\n  border-top-left-radius: 0.25rem;\r\n  border-bottom-left-radius: 0.25rem;\r\n}\r\n.service-date-container {\r\n  padding: 0;\r\n  margin: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  position: relative;\r\n  width: 100%;\r\n  justify-content: center;\r\n}\r\n.service-date-container .btn-container {\r\n  position: absolute;\r\n  right: 5px;\r\n  margin: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0;\r\n}\r\n.service-description .input-group-text {\r\n  height: fit-content;\r\n  border: 0;\r\n  padding-top: 0.75rem !important;\r\n}\r\n\r\n.price-input-group:focus-within .currency-ph,\r\n.cost-input-group:focus-within .currency-ph {\r\n  border-top: 1px solid #1e9ff2;\r\n  border-bottom: 1px solid #1e9ff2;\r\n  border-left: 1px solid #1e9ff2;\r\n}\r\n.currency-ph[data-state='error'] {\r\n  border-color: var(--red, #ff4961);\r\n}\r\n.price-input:focus {\r\n  border-right-width: 1px !important;\r\n}\r\n\r\n.is-invalid {\r\n  background-image: none !important;\r\n}\r\n.price-input,\r\n.cost-input {\r\n  border-left: 0;\r\n}\r\n\r\n.row-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n@media (min-width: 640px) {\r\n  .row-group {\r\n    flex-direction: row;\r\n    align-items: center;\r\n    gap: 0;\r\n  }\r\n  .cost-label {\r\n    border-top-left-radius: 0;\r\n    border-bottom-left-radius: 0;\r\n    border-left: 0;\r\n  }\r\n  .until-prepend,\r\n  .cost-input-placeholder {\r\n    border-top-left-radius: 0 !important;\r\n    border-bottom-left-radius: 0 !important;\r\n  }\r\n  .date-from,\r\n  .price-input {\r\n    border-right-width: 0 !important;\r\n    border-top-right-radius: 0 !important;\r\n    border-bottom-right-radius: 0 !important;\r\n  }\r\n}\r\n\r\n.date-focused {\r\n  border-color: #1e9ff2;\r\n}\r\n",":host {\r\n  height: 100%;\r\n}\r\n.sheet-container {\r\n  display: flex !important;\r\n  flex-direction: column !important;\r\n  background: white;\r\n  height: 100% !important;\r\n  gap: 1rem;\r\n}\r\n.sheet-footer {\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 20;\r\n  background: white;\r\n  border-top: 1px solid #e4e5ec;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  gap: 0.5rem;\r\n}\r\n.sheet-header {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  background: white;\r\n}\r\n.sheet-body {\r\n  flex: 1 1 0%;\r\n}\r\n@media (min-width: 768px) {\r\n  .sheet-footer {\r\n    flex-direction: row;\r\n    align-items: center;\r\n  }\r\n}\r\n","import { Booking, ExtraService, ExtraServiceSchema } from '@/models/booking.dto';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { ZodError } from 'zod';\r\nimport { _formatDate } from '../../functions';\r\n\r\n@Component({\r\n  tag: 'ir-extra-service-config',\r\n  styleUrls: ['ir-extra-service-config.css', '../../../../common/sheet.css'],\r\n  scoped: true,\r\n})\r\nexport class IrExtraServiceConfig {\r\n  @Prop() booking: Pick<Booking, 'from_date' | 'to_date' | 'currency' | 'booking_nbr'>;\r\n  @Prop() service: ExtraService;\r\n\r\n  @State() s_service: ExtraService;\r\n  @State() error: boolean;\r\n  @State() fromDateClicked: boolean;\r\n  @State() toDateClicked: boolean;\r\n\r\n  @Event() closeModal: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n\r\n  private bookingService = new BookingService();\r\n  // private d1: HTMLDivElement;\r\n  // private d1_0: HTMLDivElement;\r\n  // private d2_0: HTMLDivElement;\r\n  // private d2: HTMLInputElement;\r\n\r\n  componentWillLoad() {\r\n    if (this.service) {\r\n      this.s_service = { ...this.service };\r\n    }\r\n  }\r\n\r\n  private async saveAmenity() {\r\n    try {\r\n      ExtraServiceSchema.parse(this.s_service);\r\n      await this.bookingService.doBookingExtraService({\r\n        service: this.s_service,\r\n        booking_nbr: this.booking.booking_nbr,\r\n        is_remove: false,\r\n      });\r\n      this.resetBookingEvt.emit(null);\r\n      this.closeModal.emit(null);\r\n    } catch (error) {\r\n      if (error instanceof ZodError) {\r\n        this.error = true;\r\n      }\r\n      console.error(error);\r\n    }\r\n  }\r\n  private updateService(params: Partial<ExtraService>) {\r\n    let prevService: ExtraService = this.s_service;\r\n    if (!prevService) {\r\n      prevService = {\r\n        cost: null,\r\n        description: null,\r\n        end_date: null,\r\n        start_date: null,\r\n        price: null,\r\n        currency_id: this.booking.currency.id,\r\n      };\r\n    }\r\n    this.s_service = { ...prevService, ...params };\r\n  }\r\n  private validatePrice(): boolean {\r\n    if (this.s_service?.price === undefined || this.s_service?.price?.toString() === '') {\r\n      return false;\r\n    }\r\n    const priceSchema = ExtraServiceSchema.pick({ price: true });\r\n    const result = priceSchema.safeParse({ price: this.s_service?.price });\r\n    return result.success;\r\n  }\r\n  render() {\r\n    return (\r\n      <form\r\n        class={'sheet-container'}\r\n        onSubmit={async e => {\r\n          e.preventDefault();\r\n          await this.saveAmenity();\r\n        }}\r\n      >\r\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_ExtraServices} displayContext=\"sidebar\"></ir-title>\r\n        <section class={'px-1 sheet-body'}>\r\n          {/* Description */}\r\n          <fieldset class=\"input-group mb-1 service-description\">\r\n            <div class=\"input-group-prepend\">\r\n              <span class=\"input-group-text\">{locales.entries.Lcz_Description}</span>\r\n            </div>\r\n            <textarea\r\n              value={this.s_service?.description}\r\n              class={`form-control service-description-input ${this.error && !this.s_service?.description ? 'is-invalid' : ''}`}\r\n              style={{ height: '7rem' }}\r\n              maxLength={250}\r\n              onChange={e => this.updateService({ description: (e.target as HTMLTextAreaElement).value })}\r\n              aria-label=\"Amenity description\"\r\n            ></textarea>\r\n          </fieldset>\r\n          {/* Dates */}\r\n          <div class={'row-group mb-1'}>\r\n            <div class=\"input-group\">\r\n              <div class=\"input-group-prepend\">\r\n                <span class=\"input-group-text\" id=\"basic-addon1\">\r\n                  {locales.entries.Lcz_DatesOn}\r\n                </span>\r\n              </div>\r\n              <div\r\n                // ref={el => (this.d1_0 = el)}\r\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from\"\r\n              >\r\n                <div class=\"service-date-container\">\r\n                  <ir-date-picker\r\n                    // onDatePickerFocus={() => {\r\n                    //   this.d1?.classList.add('date-focused');\r\n                    //   this.d1_0?.classList.add('date-focused');\r\n                    // }}\r\n                    // onDatePickerBlur={() => {\r\n                    //   this.d1?.classList.remove('date-focused');\r\n                    //   this.d1_0?.classList.remove('date-focused');\r\n                    // }}\r\n                    // customPicker\r\n                    emitEmptyDate\r\n                    date={this.s_service?.start_date}\r\n                    minDate={this.booking.from_date}\r\n                    maxDate={this.booking.to_date}\r\n                    onDateChanged={e => this.updateService({ start_date: e.detail.start?.format('YYYY-MM-DD') })}\r\n                  >\r\n                    <input\r\n                      // ref={el => (this.d1 = el)}\r\n                      type=\"text\"\r\n                      slot=\"trigger\"\r\n                      value={this.s_service?.start_date ? _formatDate(this.s_service.start_date) : null}\r\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%', borderRadius: '0' }}\r\n                      class=\"text-center w-100 form-control input-sm\"\r\n                    ></input>\r\n                  </ir-date-picker>\r\n                  {this.s_service?.start_date && (\r\n                    <div class=\"btn-container\">\r\n                      <ir-button\r\n                        title=\"clear\"\r\n                        id=\"close\"\r\n                        variant=\"icon\"\r\n                        style={{ '--icon-size': '0.875rem' }}\r\n                        icon_name=\"xmark-fill\"\r\n                        class=\"ml-2\"\r\n                        onClickHandler={e => {\r\n                          e.stopImmediatePropagation();\r\n                          e.stopPropagation();\r\n                          this.updateService({ start_date: null });\r\n                        }}\r\n                      ></ir-button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"input-group\">\r\n              <div class=\"input-group-prepend \">\r\n                <span class=\"input-group-text until-prepend\" id=\"basic-addon1\">\r\n                  {locales.entries.Lcz_TillAndIncluding}\r\n                </span>\r\n              </div>\r\n              <div\r\n                // ref={el => (this.d2_0 = el)}\r\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center\"\r\n              >\r\n                <div class=\"service-date-container\">\r\n                  <ir-date-picker\r\n                    // onDatePickerFocus={() => {\r\n                    //   this.d2?.classList.add('date-focused');\r\n                    //   this.d2_0?.classList.add('date-focused');\r\n                    // }}\r\n                    // onDatePickerBlur={() => {\r\n                    //   this.d2?.classList.remove('date-focused');\r\n                    //   this.d2_0?.classList.remove('date-focused');\r\n                    // }}\r\n                    emitEmptyDate\r\n                    date={this.s_service?.end_date}\r\n                    minDate={this.s_service?.start_date ?? this.booking.from_date}\r\n                    maxDate={this.booking.to_date}\r\n                    onDateChanged={e => {\r\n                      e.stopImmediatePropagation();\r\n                      e.stopPropagation();\r\n                      this.updateService({ end_date: e.detail.start?.format('YYYY-MM-DD') });\r\n                    }}\r\n                  >\r\n                    <input\r\n                      // ref={el => (this.d2 = el)}\r\n                      slot=\"trigger\"\r\n                      value={this.s_service?.end_date ? _formatDate(this.s_service.end_date) : null}\r\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%' }}\r\n                      class=\"text-center form-control input-sm\"\r\n                    ></input>\r\n                  </ir-date-picker>\r\n\r\n                  {this.s_service?.end_date && (\r\n                    <div class=\"btn-container\">\r\n                      <ir-button\r\n                        title=\"clear\"\r\n                        id=\"close\"\r\n                        variant=\"icon\"\r\n                        style={{ '--icon-size': '0.875rem' }}\r\n                        icon_name=\"xmark-fill\"\r\n                        class=\"ml-2\"\r\n                        onClickHandler={e => {\r\n                          e.stopImmediatePropagation();\r\n                          e.stopPropagation();\r\n                          this.updateService({ end_date: null });\r\n                        }}\r\n                      ></ir-button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {/* Prices and cost */}\r\n          <div class={'row-group'}>\r\n            <ir-price-input\r\n              label=\"Price\"\r\n              currency={this.booking.currency.symbol}\r\n              class=\"ir-br-input-none\"\r\n              value={this.s_service?.price?.toString()}\r\n              zod={ExtraServiceSchema.pick({ price: true })}\r\n              aria-label={locales.entries.Lcz_Price}\r\n              wrapKey=\"price\"\r\n              aria-describedby=\"service price\"\r\n              autoValidate={false}\r\n              data-state={this.error && !this.validatePrice() ? 'error' : ''}\r\n              onTextChange={e => this.updateService({ price: parseFloat(e.detail) })}\r\n            ></ir-price-input>\r\n            <ir-price-input\r\n              autoValidate={false}\r\n              label={locales.entries.Lcz_Cost}\r\n              labelStyle=\"rounded-0 border-left-0\"\r\n              currency={this.booking.currency.symbol}\r\n              // class=\"ir-bl-lbl-none ir-bl-none\"\r\n              value={this.s_service?.cost?.toString()}\r\n              zod={ExtraServiceSchema.pick({ cost: true })}\r\n              onTextChange={e => this.updateService({ cost: parseFloat(e.detail) })}\r\n              wrapKey=\"cost\"\r\n              aria-label=\"Cost\"\r\n              aria-describedby=\"service cost\"\r\n            ></ir-price-input>\r\n          </div>\r\n        </section>\r\n        <div class={'sheet-footer'}>\r\n          <ir-button\r\n            onClick={() => this.closeModal.emit(null)}\r\n            btn_styles=\"justify-content-center\"\r\n            class={`flex-fill`}\r\n            icon=\"\"\r\n            text={locales.entries.Lcz_Cancel}\r\n            btn_color=\"secondary\"\r\n          ></ir-button>\r\n\r\n          <ir-button\r\n            btn_styles=\"justify-content-center align-items-center\"\r\n            class={'flex-fill'}\r\n            icon=\"\"\r\n            btn_type=\"submit\"\r\n            isLoading={isRequestPending('/Do_Booking_Extra_Service')}\r\n            text={locales.entries.Lcz_Save}\r\n            btn_color=\"primary\"\r\n          ></ir-button>\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n","import { Component, Fragment, Host, Prop, h } from '@stencil/core';\r\nimport { Booking } from '@/models/booking.dto';\r\n@Component({\r\n  tag: 'ir-extra-services',\r\n  styleUrl: 'ir-extra-services.css',\r\n  scoped: true,\r\n})\r\nexport class IrExtraServices {\r\n  @Prop() booking: Pick<Booking, 'currency' | 'extra_services' | 'booking_nbr'>;\r\n\r\n  render() {\r\n    return (\r\n      <Host class={'card p-0 '}>\r\n        {this.booking.extra_services?.map((service, index) => (\r\n          <Fragment>\r\n            <ir-extra-service\r\n              bookingNumber={this.booking.booking_nbr}\r\n              currencySymbol={this.booking.currency.symbol}\r\n              key={service.booking_system_id}\r\n              service={service}\r\n            ></ir-extra-service>\r\n            {index !== this.booking.extra_services.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />}\r\n          </Fragment>\r\n        ))}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",".input-group-text {\r\n  min-width: 10rem;\r\n  text-align: left;\r\n}\r\n.mobilePrefixSelect {\r\n  border-right-width: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n}\r\n.mobilePrefixInput {\r\n  border-top-left-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n}\r\n\r\n/* custome checkbox */\r\n.check-container {\r\n  position: relative;\r\n  /* padding-left: 30px; */\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.check-container input {\r\n  position: relative;\r\n  opacity: 0;\r\n  cursor: pointer;\r\n  height: 0;\r\n  width: 0;\r\n}\r\n.check-container .checkmark {\r\n  position: relative;\r\n  top: 0;\r\n  left: 0;\r\n  height: 20px;\r\n  width: 20px;\r\n  border: 1px solid #cacfe7;\r\n  border-radius: 4px;\r\n  transition: all 0.3s ease;\r\n}\r\n.check-container input:checked ~ .checkmark {\r\n  background-color: #1e9ff2;\r\n  border-color: #1e9ff2;\r\n}\r\n.checkmark:after {\r\n  content: '';\r\n  position: absolute;\r\n  display: none;\r\n}\r\n.check-container input:checked ~ .checkmark:after {\r\n  display: block;\r\n}\r\n.check-label {\r\n  margin-left: 10px !important;\r\n}\r\n.check-container .checkmark:after {\r\n  left: 6px;\r\n  top: 3px;\r\n  width: 6px;\r\n  height: 10px;\r\n  border: solid white;\r\n  border-width: 0 2px 2px 0;\r\n  -webkit-transform: rotate(45deg);\r\n  -ms-transform: rotate(45deg);\r\n  transform: rotate(45deg);\r\n}\r\n.ir-card-header {\r\n  width: 100%;\r\n  border-bottom: 1px solid #e4e5ec;\r\n}\r\n.close-icon {\r\n  margin: 0;\r\n}\r\n.border-theme {\r\n  border: 1px solid #cacfe7;\r\n}\r\n.loading-container {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n",":host {\r\n  height: 100%;\r\n}\r\n.sheet-container {\r\n  display: flex !important;\r\n  flex-direction: column !important;\r\n  background: white;\r\n  height: 100% !important;\r\n  gap: 1rem;\r\n}\r\n.sheet-footer {\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 20;\r\n  background: white;\r\n  border-top: 1px solid #e4e5ec;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  gap: 0.5rem;\r\n}\r\n.sheet-header {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  background: white;\r\n}\r\n.sheet-body {\r\n  flex: 1 1 0%;\r\n}\r\n@media (min-width: 768px) {\r\n  .sheet-footer {\r\n    flex-direction: row;\r\n    align-items: center;\r\n  }\r\n}\r\n","import { Component, State, h, Prop, EventEmitter, Event, Watch, Fragment } from '@stencil/core';\r\nimport { Guest } from '@/models/booking.dto';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { ICountry } from '@/components';\r\nimport { RoomService } from '@/services/room.service';\r\nimport locales from '@/stores/locales.store';\r\nimport Token from '@/models/Token';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\n\r\n@Component({\r\n  tag: 'ir-guest-info',\r\n  styleUrls: ['ir-guest-info.css', '../../common/sheet.css'],\r\n  scoped: true,\r\n})\r\nexport class GuestInfo {\r\n  @Prop() language: string;\r\n  @Prop() headerShown: boolean;\r\n  @Prop() email: string;\r\n  @Prop() booking_nbr: string;\r\n  @Prop() ticket: string;\r\n  @Prop() isInSideBar: boolean;\r\n\r\n  @State() countries: ICountry[];\r\n  // @State() submit: boolean = false;\r\n  @State() guest: Guest | null = null;\r\n  @State() isLoading: boolean = true;\r\n  @State() autoValidate = false;\r\n\r\n  @Event() closeSideBar: EventEmitter<null>;\r\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\r\n\r\n  private bookingService = new BookingService();\r\n  private roomService = new RoomService();\r\n  private token: Token = new Token();\r\n\r\n  async componentWillLoad() {\r\n    if (this.ticket) {\r\n      this.token.setToken(this.ticket);\r\n    }\r\n    if (!!this.token.getToken()) this.init();\r\n  }\r\n\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      console.log('first');\r\n      this.isLoading = true;\r\n      const [guest, countries, fetchedLocales] = await Promise.all([\r\n        this.bookingService.fetchGuest(this.email),\r\n        this.bookingService.getCountries(this.language),\r\n        !locales || !locales.entries || Object.keys(locales.entries).length === 0 ? this.roomService.fetchLanguage(this.language) : Promise.resolve(null), // Skip fetching if locales are already set\r\n      ]);\r\n\r\n      // Set the fetched locales if they were fetched\r\n      if (fetchedLocales) {\r\n        locales.entries = fetchedLocales.entries;\r\n        locales.direction = fetchedLocales.direction;\r\n      }\r\n\r\n      // Assign the fetched guest and countries\r\n      this.countries = countries;\r\n      this.guest = { ...guest, mobile: guest.mobile_without_prefix };\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  private handleInputChange(params: Partial<Guest>) {\r\n    this.guest = { ...this.guest, ...params };\r\n  }\r\n\r\n  private async editGuest() {\r\n    try {\r\n      this.autoValidate = true;\r\n\r\n      await this.bookingService.editExposedGuest(this.guest, this.booking_nbr ?? null);\r\n      this.closeSideBar.emit(null);\r\n      this.resetBookingEvt.emit(null);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading && this.isInSideBar) {\r\n      <div class={'loading-container'}>\r\n        <ir-spinner></ir-spinner>\r\n      </div>;\r\n    }\r\n    if (this.isLoading) {\r\n      return null;\r\n    }\r\n    return (\r\n      <form\r\n        class={'p-0 sheet-container'}\r\n        onSubmit={async e => {\r\n          e.preventDefault();\r\n          await this.editGuest();\r\n        }}\r\n      >\r\n        {this.headerShown && <ir-title class=\"px-1 sheet-header\" displayContext=\"sidebar\" label={locales.entries.Lcz_GuestDetails}></ir-title>}\r\n        <div class={this.isInSideBar ? 'sheet-body' : 'card-content collapse show '}>\r\n          <div class={this.headerShown ? 'card-body px-1 pt-0' : 'pt-0'}>\r\n            <ir-input-text\r\n              autoValidate={this.autoValidate}\r\n              label={locales.entries?.Lcz_FirstName}\r\n              name=\"firstName\"\r\n              // submitted={this.submit}\r\n              value={this.guest?.first_name}\r\n              required\r\n              onTextChange={e => this.handleInputChange({ first_name: e.detail })}\r\n            ></ir-input-text>\r\n            <ir-input-text\r\n              autoValidate={this.autoValidate}\r\n              label={locales.entries?.Lcz_LastName}\r\n              name=\"lastName\"\r\n              // submitted={this.submit}\r\n              value={this.guest?.last_name}\r\n              required\r\n              onTextChange={e => this.handleInputChange({ last_name: e.detail })}\r\n            ></ir-input-text>\r\n            <ir-input-text\r\n              label={locales.entries?.Lcz_Email}\r\n              name=\"email\"\r\n              // submitted={this.submit}\r\n              value={this.guest?.email}\r\n              required\r\n              onTextChange={e => this.handleInputChange({ email: e.detail })}\r\n            ></ir-input-text>\r\n            <ir-input-text\r\n              label={locales.entries?.Lcz_AlternativeEmail}\r\n              name=\"altEmail\"\r\n              value={this.guest?.alternative_email}\r\n              onTextChange={e => this.handleInputChange({ alternative_email: e.detail })}\r\n            ></ir-input-text>\r\n            {/* <ir-input-text label=\"Password\" placeholder=\"\" name=\"password\" submited={this.submit} type=\"password\" value={this.Model.password} required></ir-input-text> */}\r\n            {/* <ir-select\r\n              selectContainerStyle=\"mb-1\"\r\n              required\r\n              name=\"country\"\r\n              submited={this.submit}\r\n              label={locales.entries.Lcz_Country}\r\n              selectedValue={this.guest?.country_id?.toString() ?? ''}\r\n              data={this.countries?.map(item => {\r\n                return {\r\n                  value: item.id.toString(),\r\n                  text: item.name,\r\n                };\r\n              })}\r\n              firstOption={'...'}\r\n              onSelectChange={e => this.handleInputChange({ country_id: e.detail })}\r\n            ></ir-select> */}\r\n            <ir-country-picker\r\n              // error={this.submit && !this.guest.country_id}\r\n              country={this.countries.find(c => c.id === this.guest.country_id)}\r\n              label={locales.entries?.Lcz_Country}\r\n              onCountryChange={e => this.handleInputChange({ country_id: e.detail.id })}\r\n              countries={this.countries}\r\n            ></ir-country-picker>\r\n            <ir-phone-input\r\n              onTextChange={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n                const { mobile, phone_prefix } = e.detail;\r\n                if (mobile !== this.guest.mobile) {\r\n                  this.handleInputChange({ mobile });\r\n                }\r\n                if (phone_prefix !== this.guest.country_phone_prefix) this.handleInputChange({ country_phone_prefix: phone_prefix });\r\n              }}\r\n              phone_prefix={this.guest.country_phone_prefix}\r\n              value={this.guest.mobile}\r\n              language={this.language}\r\n              label={locales.entries?.Lcz_MobilePhone}\r\n              countries={this.countries}\r\n            />\r\n            <div class=\"mb-2\">\r\n              <ir-textarea\r\n                variant=\"prepend\"\r\n                onTextChange={e => this.handleInputChange({ notes: e.detail })}\r\n                value={this.guest?.notes}\r\n                label={locales.entries?.Lcz_PrivateNote}\r\n              ></ir-textarea>\r\n            </div>\r\n            <div class={'p-0 m-0'}>\r\n              <label class={`check-container m-0 p-0`}>\r\n                <input\r\n                  class={'m-0 p-0'}\r\n                  type=\"checkbox\"\r\n                  name=\"newsletter\"\r\n                  checked={this.guest.subscribe_to_news_letter}\r\n                  onInput={e => this.handleInputChange({ subscribe_to_news_letter: (e.target as HTMLInputElement).checked })}\r\n                />\r\n                <span class=\"checkmark m-0 p-0\"></span>\r\n                <span class={'m-0 p-0  check-label'}>{locales.entries.Lcz_Newsletter}</span>\r\n              </label>\r\n              {!this.isInSideBar && (\r\n                <Fragment>\r\n                  <hr />\r\n                  <ir-button\r\n                    isLoading={this.isLoading}\r\n                    btn_disabled={this.isLoading}\r\n                    btn_styles=\"d-flex align-items-center justify-content-center\"\r\n                    text={locales.entries.Lcz_Save}\r\n                    onClickHandler={this.editGuest.bind(this)}\r\n                    color=\"btn-primary\"\r\n                  ></ir-button>\r\n                </Fragment>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {this.isInSideBar && (\r\n          <div class={'sheet-footer'}>\r\n            <ir-button\r\n              data-testid=\"cancel\"\r\n              onClickHandler={() => this.closeSideBar.emit(null)}\r\n              class=\"flex-fill m-0 p-0\"\r\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\r\n              btn_color=\"secondary\"\r\n              text={locales.entries.Lcz_Cancel}\r\n            ></ir-button>\r\n            <ir-button\r\n              data-testid=\"save\"\r\n              isLoading={isRequestPending('/Edit_Exposed_Guest')}\r\n              btn_disabled={this.isLoading}\r\n              class=\"flex-fill m-0\"\r\n              btn_type=\"submit\"\r\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\r\n              text={locales.entries.Lcz_Save}\r\n            ></ir-button>\r\n          </div>\r\n        )}\r\n      </form>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n:host p,\r\n:host div,\r\n:host span,\r\n:host ir-icons {\r\n  box-sizing: border-box;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n.action-container td {\r\n  padding: 0px 0.5rem;\r\n  padding-bottom: 0.5rem;\r\n}\r\n.action-container .amount_action {\r\n  padding-inline-start: 0;\r\n}\r\n.overdue_action {\r\n  color: #ff4961;\r\n  border-radius: 0.25rem;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n.future_action {\r\n  border-radius: 0.25rem;\r\n  color: #1e9ff2;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: start;\r\n  gap: 0.5rem;\r\n}\r\n.date_action {\r\n  font-weight: 500;\r\n}\r\n.amount_action {\r\n  /* color: green; */\r\n  font-weight: 600;\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\nimport { IPaymentAction } from '@/services/payment.service';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport moment from 'moment';\r\n@Component({\r\n  tag: 'ir-payment-actions',\r\n  styleUrl: 'ir-payment-actions.css',\r\n  scoped: true,\r\n})\r\nexport class IrPaymentActions {\r\n  @Prop() booking: Booking;\r\n  @Prop() paymentAction: IPaymentAction[];\r\n\r\n  @Event() generatePayment: EventEmitter<IPaymentAction>;\r\n\r\n  render() {\r\n    if (this.paymentAction?.filter(pa => pa.amount !== 0).length == 0) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Host>\r\n        <div class={'my-1'}>\r\n          <span class={'font-medium'}>Payment actions</span>\r\n        </div>\r\n        <table>\r\n          <thead>\r\n            <th>\r\n              <p class=\"sr-only\">Amount</p>\r\n            </th>\r\n            <th>\r\n              <p class={'sr-only'}>Due date</p>\r\n            </th>\r\n            <th>\r\n              <p class={'sr-only'}>Pay</p>\r\n            </th>\r\n            <th>\r\n              <p class={'sr-only'}>Status</p>\r\n            </th>\r\n          </thead>\r\n          <tbody>\r\n            {this.paymentAction?.map(pa => {\r\n              if (!pa.due_on) {\r\n                return null;\r\n              }\r\n              return (\r\n                <tr class={'action-container'}>\r\n                  <td class={'amount_action'}>{formatAmount(pa.currency.symbol, pa.amount)}</td>\r\n                  <td class={'date_action'}>{moment(new Date(pa.due_on)).format('ddd, DD MMM YYYY')}</td>\r\n                  {pa.amount > 0 && (\r\n                    <td>\r\n                      <ir-button btn_color=\"outline\" text={'Pay'} size=\"sm\" onClickHandler={() => this.generatePayment.emit(pa)}></ir-button>\r\n                    </td>\r\n                  )}\r\n                  {pa.type === 'overdue' && pa.amount > 0 && (\r\n                    <td>\r\n                      <div class={'overdue_action'}>\r\n                        <svg height={16} width={16} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\r\n                          <path\r\n                            fill=\"currentColor\"\r\n                            d=\"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z\"\r\n                          />\r\n                        </svg>\r\n                        <span>Overdue</span>\r\n                      </div>\r\n                    </td>\r\n                  )}\r\n                  {pa.type === 'future' && pa.amount > 0 && (\r\n                    <td>\r\n                      <div class={'future_action '}>\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" height={16} width={16} viewBox=\"0 0 512 512\">\r\n                          <path\r\n                            fill=\"currentColor\"\r\n                            d=\"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z\"\r\n                          />\r\n                        </svg>\r\n                        <span>{moment(new Date(pa.due_on)).isSame(new Date()) ? 'Today' : 'Future'}</span>\r\n                      </div>\r\n                    </td>\r\n                  )}\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\r\n}\r\n:host * {\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\r\n}\r\n\r\n.sm-margin-right {\r\n  margin-right: 5px !important;\r\n  background: #000;\r\n}\r\n.action_icons {\r\n  width: 60px;\r\n}\r\n.w-60 {\r\n  width: 100px;\r\n  padding: 0 5px;\r\n}\r\n.payments-height {\r\n  height: 30px;\r\n}\r\n.payment_date {\r\n  width: 100px;\r\n}\r\n.iframeHeight {\r\n  height: max-content;\r\n  height: 22.5rem;\r\n}\r\n.designation {\r\n  width: 120px;\r\n}\r\n.total-cost-container {\r\n  background: #7cbebe;\r\n  color: white;\r\n  padding: 0.5rem;\r\n  border-radius: 5px;\r\n}\r\n.payment-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  gap: 0.5rem;\r\n}\r\n.payment_action_beta_container {\r\n  border: 1px solid var(--red);\r\n  position: relative;\r\n  padding: 4px;\r\n  box-sizing: border-box;\r\n  border-radius: 4px;\r\n}\r\n.beta {\r\n  position: absolute;\r\n  top: 4px;\r\n  background: var(--red);\r\n  color: white;\r\n  padding: 0.2rem 0.3rem;\r\n  font-size: 12px;\r\n  border-radius: 4px;\r\n  right: 4px;\r\n  margin: 0;\r\n}\r\n","import { Component, h, Prop, State, Event, EventEmitter, Fragment, Watch, Listen } from '@stencil/core';\r\nimport { _formatDate } from '../functions';\r\nimport { Booking, IDueDate, IPayment } from '@/models/booking.dto';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport moment from 'moment';\r\nimport { PaymentService, IPaymentAction } from '@/services/payment.service';\r\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { formatAmount, toFloat } from '@/utils/utils';\r\nimport locales from '@/stores/locales.store';\r\nimport { IToast } from '@/components/ui/ir-toast/toast';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\n@Component({\r\n  styleUrl: 'ir-payment-details.css',\r\n  tag: 'ir-payment-details',\r\n  scoped: true,\r\n})\r\nexport class IrPaymentDetails {\r\n  @Prop({ mutable: true }) bookingDetails: Booking;\r\n  @Prop() paymentActions: IPaymentAction[];\r\n\r\n  @State() newTableRow: boolean = false;\r\n\r\n  @State() collapsedPayment: boolean = false;\r\n  @State() collapsedGuarantee: boolean = false;\r\n\r\n  @State() flag: boolean = false;\r\n\r\n  @State() confirmModal: boolean = false;\r\n  @State() toBeDeletedItem: IPayment;\r\n\r\n  @State() paymentDetailsUrl: string = '';\r\n  @State() paymentExceptionMessage: string = '';\r\n  @State() modal_mode: 'delete' | 'save' | null = null;\r\n  @State() itemToBeAdded: IPayment;\r\n\r\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\r\n  @Event({ bubbles: true }) resetExposedCancelationDueAmount: EventEmitter<null>;\r\n  @Event({ bubbles: true }) toast: EventEmitter<IToast>;\r\n\r\n  private paymentService = new PaymentService();\r\n  private bookingService = new BookingService();\r\n  private paymentBackground = 'white';\r\n\r\n  @Listen('generatePayment')\r\n  handlePaymentGeneration(e: CustomEvent) {\r\n    const value = e.detail;\r\n    this.newTableRow = true;\r\n    this.itemToBeAdded = { ...this.itemToBeAdded, amount: value.amount, date: value.due_on };\r\n    this.paymentBackground = 'rgba(250, 253, 174)';\r\n  }\r\n  async componentWillLoad() {\r\n    try {\r\n      this.initializeItemToBeAdded();\r\n    } catch (error) {\r\n      if (this.bookingDetails.guest.cci) {\r\n        return;\r\n      }\r\n      if (!this.bookingDetails.is_direct && this.bookingDetails.channel_booking_nbr) {\r\n        this.paymentExceptionMessage = error;\r\n      }\r\n    }\r\n  }\r\n  initializeItemToBeAdded() {\r\n    this.itemToBeAdded = {\r\n      id: -1,\r\n      date: moment().format('YYYY-MM-DD'),\r\n      amount: null,\r\n      currency: this.bookingDetails.currency,\r\n      designation: '',\r\n      reference: '',\r\n    };\r\n    this.paymentBackground = 'white';\r\n  }\r\n\r\n  async _processPaymentSave() {\r\n    if (this.itemToBeAdded.amount === null) {\r\n      this.toast.emit({\r\n        type: 'error',\r\n        title: locales.entries.Lcz_EnterAmount,\r\n        description: '',\r\n        position: 'top-right',\r\n      });\r\n      return;\r\n    }\r\n    if (Number(this.itemToBeAdded.amount) > Number(this.bookingDetails.financial.due_amount)) {\r\n      this.modal_mode = 'save';\r\n      this.openModal();\r\n      return;\r\n    }\r\n    this._handleSave();\r\n  }\r\n\r\n  async _handleSave() {\r\n    this.paymentBackground = 'white';\r\n    try {\r\n      await this.paymentService.AddPayment(this.itemToBeAdded, this.bookingDetails.booking_nbr);\r\n      this.initializeItemToBeAdded();\r\n      this.resetBookingEvt.emit(null);\r\n      this.resetExposedCancelationDueAmount.emit(null);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  handlePaymentInputChange(key: keyof IPayment, value: any, event?: CustomEvent) {\r\n    this.paymentBackground = 'white';\r\n    if (key === 'amount') {\r\n      if (!isNaN(value) || value === '') {\r\n        if (value === '') {\r\n          this.itemToBeAdded = { ...this.itemToBeAdded, [key]: null };\r\n        } else {\r\n          this.itemToBeAdded = { ...this.itemToBeAdded, [key]: parseFloat(value) };\r\n        }\r\n      } else if (event && event.target) {\r\n        let inputElement = event.target as HTMLInputElement;\r\n        let inputValue = inputElement.value;\r\n        inputValue = inputValue.replace(/[^\\d-]|(?<!^)-/g, '');\r\n        inputElement.value = inputValue;\r\n      }\r\n    } else {\r\n      this.itemToBeAdded = { ...this.itemToBeAdded, [key]: value };\r\n    }\r\n  }\r\n  async cancelPayment() {\r\n    try {\r\n      await this.paymentService.CancelPayment(this.toBeDeletedItem.id);\r\n      const newPaymentArray = this.bookingDetails.financial.payments.filter((item: IPayment) => item.id !== this.toBeDeletedItem.id);\r\n      this.bookingDetails = { ...this.bookingDetails, financial: { ...this.bookingDetails.financial, payments: newPaymentArray } };\r\n      this.confirmModal = !this.confirmModal;\r\n      this.resetBookingEvt.emit(null);\r\n      this.resetExposedCancelationDueAmount.emit(null);\r\n      this.toBeDeletedItem = null;\r\n      this.modal_mode = null;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  async handleConfirmModal(e: CustomEvent) {\r\n    this.paymentBackground = 'white';\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    if (this.modal_mode === 'delete') {\r\n      await this.cancelPayment();\r\n    } else {\r\n      await this._handleSave();\r\n    }\r\n  }\r\n  openModal() {\r\n    const modal: any = document.querySelector('.delete-record-modal');\r\n    modal.openModal();\r\n  }\r\n  async handleCancelModal(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    try {\r\n      this.paymentBackground = 'white';\r\n      if (this.modal_mode === 'save') {\r\n        this.initializeItemToBeAdded();\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  @Watch('bookingDetails')\r\n  handleBookingDetails() {\r\n    if (this.newTableRow) {\r\n      this.newTableRow = false;\r\n    }\r\n  }\r\n  handleDateChange(\r\n    e: CustomEvent<{\r\n      start: moment.Moment;\r\n      end: moment.Moment;\r\n    }>,\r\n  ) {\r\n    this.handlePaymentInputChange('date', e.detail.end.format('YYYY-MM-DD'));\r\n  }\r\n  _renderTableRow(item: IPayment, rowMode: 'add' | 'normal' = 'normal') {\r\n    return (\r\n      <Fragment>\r\n        <tr>\r\n          <td class={'border payments-height border-light border-bottom-0 text-center'}>\r\n            {rowMode === 'normal' ? (\r\n              <span class=\"sm-padding-left\">{_formatDate(item.date)}</span>\r\n            ) : (\r\n              <ir-date-picker\r\n                date={this.itemToBeAdded?.date ? new Date(this.itemToBeAdded.date) : new Date()}\r\n                minDate={moment().add(-2, 'months').startOf('month').format('YYYY-MM-DD')}\r\n                // singleDatePicker\r\n                // autoApply\r\n                class=\"d-flex justify-content-center\"\r\n                onDateChanged={this.handleDateChange.bind(this)}\r\n              >\r\n                <input\r\n                  type=\"text\"\r\n                  slot=\"trigger\"\r\n                  value={_formatDate(this.itemToBeAdded?.date)}\r\n                  class=\"text-center  form-control flex-grow-1 w-100\"\r\n                  style={{ border: '0', marginLeft: 'auto', marginRight: 'auto', width: '100%' }}\r\n                ></input>\r\n              </ir-date-picker>\r\n            )}\r\n          </td>\r\n          <td class={'border payments-height border-light border-bottom-0 text-center '}>\r\n            {rowMode === 'normal' ? (\r\n              <span class=\"sm-padding-right\">{formatAmount(this.bookingDetails.currency.symbol, item.amount)}</span>\r\n            ) : (\r\n              // <input\r\n              //   type=\"text\"\r\n              //   class=\"border-0 text-center form-control py-0 m-0 w-100\"\r\n              //   value={this.itemToBeAdded.amount}\r\n              //   onBlur={e => {\r\n              //     (e.target as HTMLInputElement).value = Number(this.itemToBeAdded.amount).toFixed(2);\r\n              //   }}\r\n              //   onInput={event => this.handlePaymentInputChange('amount', +(event.target as HTMLInputElement).value, event)}\r\n              // ></input>\r\n              <ir-price-input\r\n                value={this.itemToBeAdded.amount?.toString()}\r\n                onTextChange={e => this.handlePaymentInputChange('amount', Number(e.detail), e)}\r\n                inputStyle=\"border-0 rounded-0 text-center py-0 m-0 w-100\"\r\n              ></ir-price-input>\r\n            )}\r\n          </td>\r\n          <td class={'border payments-height border-light border-bottom-0 text-center'}>\r\n            {rowMode === 'normal' ? (\r\n              <span class=\"sm-padding-left\">{item.designation}</span>\r\n            ) : (\r\n              <input\r\n                class=\"border-0 w-100 form-control py-0 m-0\"\r\n                onInput={event => this.handlePaymentInputChange('designation', (event.target as HTMLInputElement).value)}\r\n                type=\"text\"\r\n              ></input>\r\n            )}\r\n          </td>\r\n          <td rowSpan={2} class={'border payments-height border-light border-bottom-0 text-center'}>\r\n            <div class={'payment-actions'}>\r\n              {rowMode === 'add' && (\r\n                <ir-button\r\n                  variant=\"icon\"\r\n                  icon_name=\"save\"\r\n                  style={colorVariants.secondary}\r\n                  isLoading={rowMode === 'add' && isRequestPending('/Do_Payment')}\r\n                  class={'m-0'}\r\n                  onClickHandler={() => {\r\n                    this._processPaymentSave();\r\n                  }}\r\n                ></ir-button>\r\n              )}\r\n              <ir-button\r\n                variant=\"icon\"\r\n                icon_name=\"trash\"\r\n                style={colorVariants.danger}\r\n                isLoading={this.toBeDeletedItem?.id === item?.id && isRequestPending('/Cancel_Payment')}\r\n                onClickHandler={\r\n                  rowMode === 'add'\r\n                    ? () => {\r\n                        this.newTableRow = false;\r\n                        this.initializeItemToBeAdded();\r\n                      }\r\n                    : () => {\r\n                        this.modal_mode = 'delete';\r\n                        this.toBeDeletedItem = item;\r\n                        this.openModal();\r\n                      }\r\n                }\r\n              ></ir-button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td colSpan={3} class={'border border-light payments-height border-bottom-0 text-center'}>\r\n            {rowMode === 'normal' ? (\r\n              <span class=\"sm-padding-left \">{item.reference}</span>\r\n            ) : (\r\n              <input\r\n                class=\"border-0 w-100  form-control py-0 m-0\"\r\n                onKeyPress={event => {\r\n                  if (event.key === 'Enter') {\r\n                    this.newTableRow = false;\r\n                    this._handleSave();\r\n                  }\r\n                }}\r\n                onInput={event => this.handlePaymentInputChange('reference', (event.target as HTMLInputElement).value)}\r\n                type=\"text\"\r\n              ></input>\r\n            )}\r\n          </td>\r\n        </tr>\r\n      </Fragment>\r\n    );\r\n  }\r\n  private formatCurrency(amount: number, currency: string, locale: string = 'en-US'): string {\r\n    if (!currency) {\r\n      return;\r\n    }\r\n    if (amount >= 0) {\r\n      return new Intl.NumberFormat(locale, {\r\n        style: 'currency',\r\n        currency,\r\n        minimumFractionDigits: 2,\r\n        maximumFractionDigits: 2,\r\n      }).format(amount);\r\n    }\r\n    return;\r\n  }\r\n  private bookingGuarantee() {\r\n    const paymentMethod = this.bookingDetails.is_direct ? this.getPaymentMethod() : null;\r\n    if (this.bookingDetails.is_direct && !paymentMethod && !this.bookingDetails.guest.cci) {\r\n      return null;\r\n    }\r\n    return (\r\n      <div class=\"mb-1\">\r\n        <div class=\"d-flex align-items-center\">\r\n          <span class=\"mr-1 font-medium\">\r\n            {locales.entries.Lcz_BookingGuarantee}\r\n            {!!paymentMethod && <span>: {paymentMethod}</span>}\r\n          </span>\r\n          {(!this.bookingDetails.is_direct || (this.bookingDetails.is_direct && this.bookingDetails.guest.cci)) && (\r\n            <ir-button\r\n              id=\"drawer-icon\"\r\n              data-toggle=\"collapse\"\r\n              data-target={`.guarrantee`}\r\n              aria-expanded={this.collapsedGuarantee ? 'true' : 'false'}\r\n              aria-controls=\"myCollapse\"\r\n              class=\"sm-padding-right pointer\"\r\n              variant=\"icon\"\r\n              icon_name=\"credit_card\"\r\n              onClickHandler={async () => {\r\n                if (!this.bookingDetails.is_direct && this.bookingDetails.channel_booking_nbr && !this.bookingDetails.guest.cci && !this.collapsedGuarantee) {\r\n                  this.paymentDetailsUrl = await this.bookingService.getPCICardInfoURL(this.bookingDetails.booking_nbr);\r\n                }\r\n                this.collapsedGuarantee = !this.collapsedGuarantee;\r\n              }}\r\n            ></ir-button>\r\n          )}\r\n        </div>\r\n        <div class=\"collapse guarrantee \">\r\n          {this.bookingDetails.guest.cci ? (\r\n            [\r\n              <div>\r\n                {this.bookingDetails?.guest?.cci && 'Card:'} <span>{this.bookingDetails?.guest?.cci?.nbr || ''}</span> {this.bookingDetails?.guest?.cci?.expiry_month && 'Expiry: '}\r\n                <span>\r\n                  {' '}\r\n                  {this.bookingDetails?.guest?.cci?.expiry_month || ''} {this.bookingDetails?.guest?.cci?.expiry_year && '/' + this.bookingDetails?.guest?.cci?.expiry_year}\r\n                </span>\r\n              </div>,\r\n              <div>\r\n                {this.bookingDetails?.guest?.cci.holder_name && 'Name:'} <span>{this.bookingDetails?.guest?.cci?.holder_name || ''}</span>{' '}\r\n                {this.bookingDetails?.guest?.cci?.cvc && '- CVC:'} <span> {this.bookingDetails?.guest?.cci?.cvc || ''}</span>\r\n              </div>,\r\n            ]\r\n          ) : this.paymentDetailsUrl ? (\r\n            <iframe src={this.paymentDetailsUrl} width=\"100%\" class=\"iframeHeight\" frameborder=\"0\" name=\"payment\"></iframe>\r\n          ) : (\r\n            <div class=\"text-center\">{this.paymentExceptionMessage}</div>\r\n          )}\r\n        </div>\r\n        {!this.bookingDetails.is_direct && this.bookingDetails.ota_guarante && (\r\n          <div>\r\n            <ir-label\r\n              content={this.bookingDetails.ota_guarante?.card_type + `${this.bookingDetails.ota_guarante?.is_virtual ? ' (virtual)' : ''}`}\r\n              labelText={`${locales.entries.Lcz_CardType}:`}\r\n            ></ir-label>\r\n            <ir-label content={this.bookingDetails.ota_guarante?.cardholder_name} labelText={`${locales.entries.Lcz_CardHolderName}:`}></ir-label>\r\n            <ir-label content={this.bookingDetails.ota_guarante?.card_number} labelText={`${locales.entries.Lcz_CardNumber}:`}></ir-label>\r\n            {/* <ir-label content={this.bookingDetails.ota_guarante?.cvv} labelText=\"Cvv:\"></ir-label> */}\r\n            {/* <ir-label content={JSON.stringify(this.bookingDetails?.ota_guarante.is_virtual)} labelText=\"Is card virtual:\"></ir-label> */}\r\n            {/* <ir-label content={this.bookingDetails.ota_guarante?.expiration_date} labelText=\"Expiration date:\"></ir-label> */}\r\n            <ir-label\r\n              content={this.formatCurrency(\r\n                toFloat(Number(this.bookingDetails.ota_guarante?.meta?.virtual_card_current_balance), Number(this.bookingDetails.ota_guarante?.meta?.virtual_card_decimal_places)),\r\n                this.bookingDetails.ota_guarante?.meta?.virtual_card_currency_code,\r\n              )}\r\n              labelText={`${locales.entries.Lcz_CardBalance}:`}\r\n            ></ir-label>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private checkPaymentCode(value: string) {\r\n    console.log(calendar_data.allowed_payment_methods);\r\n    return calendar_data.allowed_payment_methods?.find(pm => pm.code === value)?.description ?? null;\r\n  }\r\n\r\n  private getPaymentMethod() {\r\n    let paymentMethod = null;\r\n    const payment_code = this.bookingDetails?.extras?.find(e => e.key === 'payment_code');\r\n    if (this.bookingDetails.agent) {\r\n      const code = this.bookingDetails?.extras?.find(e => e.key === 'agent_payment_mode');\r\n      if (code) {\r\n        paymentMethod = code.value === '001' ? locales.entries.Lcz_OnCredit : payment_code ? this.checkPaymentCode(payment_code.value) : null;\r\n      }\r\n    } else {\r\n      if (payment_code) {\r\n        paymentMethod = this.checkPaymentCode(payment_code.value);\r\n      }\r\n    }\r\n    return paymentMethod;\r\n  }\r\n\r\n  _renderDueDate(item: IDueDate) {\r\n    return (\r\n      <tr>\r\n        <td class={'pr-1'}>{_formatDate(item.date)}</td>\r\n        <td class={'pr-1'}>{formatAmount(this.bookingDetails.currency.symbol, item.amount)}</td>\r\n        <td class={'pr-1'}>{item.description}</td>\r\n        <td class=\"collapse font-size-small roomName\">{item.room}</td>\r\n      </tr>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (!this.bookingDetails.financial) {\r\n      return null;\r\n    }\r\n    return [\r\n      <div class=\"card m-0\">\r\n        <div class=\"p-1\">\r\n          {this.bookingDetails.financial.gross_cost > 0 && this.bookingDetails.financial.gross_cost !== null && (\r\n            <div class=\"mb-2 h4 total-cost-container\">\r\n              {locales.entries.Lcz_TotalCost}: <span>{formatAmount(this.bookingDetails.currency.symbol, this.bookingDetails.financial.gross_cost)}</span>\r\n            </div>\r\n          )}\r\n          {/* TODO:IMPLEMENT THIS ON BOOKING ACTIONS */}\r\n          <div class=\" h4\">\r\n            {locales.entries.Lcz_Balance}:{' '}\r\n            <span class=\"danger font-weight-bold\">{formatAmount(this.bookingDetails.currency.symbol, this.bookingDetails.financial.due_amount)}</span>\r\n          </div>\r\n          {/* <div class=\" h4\">\r\n            {locales.entries.Lcz_DueBalance}:{' '}\r\n            <span class=\"danger font-weight-bold\">{formatAmount(this.bookingDetails.currency.symbol, this.bookingDetails.financial.due_amount)}</span>\r\n          </div> */}\r\n          {/* TODO:IMPLEMENT THIS ON BOOKING ACTIONS */}\r\n          <div class=\"mb-2 h4\">\r\n            {locales.entries.Lcz_Collected}:{' '}\r\n            <span class=\"\">\r\n              {formatAmount(\r\n                this.bookingDetails.currency.symbol,\r\n                this.bookingDetails.financial.payments ? this.bookingDetails.financial.payments.reduce((prev, curr) => prev + curr.amount, 0) : 0,\r\n              )}\r\n            </span>\r\n          </div>\r\n\r\n          {this.bookingGuarantee()}\r\n          {/* <div class=\"mt-2\">\r\n            <div>\r\n              {this.bookingDetails.financial?.due_dates?.length > 0 && (\r\n                <Fragment>\r\n                  <div class=\"d-flex align-items-center\">\r\n                    <strong class=\"mr-1\">{locales.entries.Lcz_PaymentDueDates}</strong>\r\n                    <ir-button\r\n                      id=\"drawer-icon\"\r\n                      data-toggle=\"collapse\"\r\n                      data-target={`.roomName`}\r\n                      aria-expanded={this.collapsedPayment ? 'true' : 'false'}\r\n                      aria-controls=\"myCollapse\"\r\n                      variant=\"icon\"\r\n                      icon_name={this.collapsedPayment ? 'closed_eye' : 'open_eye'}\r\n                      onClickHandler={() => {\r\n                        this.collapsedPayment = !this.collapsedPayment;\r\n                      }}\r\n                      style={{ '--icon-size': '1.5rem' }}\r\n                    ></ir-button>\r\n                  </div>\r\n\r\n                  <table>{this.bookingDetails.financial.due_dates?.map(item => this._renderDueDate(item))}</table>\r\n                </Fragment>\r\n              )}\r\n            </div>\r\n          </div> */}\r\n          {/* TODO:IMPLEMENT THIS ON BOOKING ACTIONS */}\r\n          {this.paymentActions?.filter(pa => pa.amount !== 0).length > 0 && this.bookingDetails.is_direct && (\r\n            <div class=\"payment_action_beta_container\">\r\n              <p class=\"beta\">Beta</p>\r\n              <ir-payment-actions paymentAction={this.paymentActions} booking={this.bookingDetails}></ir-payment-actions>\r\n            </div>\r\n          )}\r\n          <div class=\"mt-2 d-flex  flex-column rounded payment-container\">\r\n            <div class=\"d-flex align-items-center justify-content-between\">\r\n              <span class={'font-medium'}>{locales.entries.Lcz_Payments} history</span>\r\n              <ir-button\r\n                id=\"add-payment\"\r\n                variant=\"icon\"\r\n                icon_name=\"square_plus\"\r\n                style={{ '--icon-size': '1.5rem' }}\r\n                onClickHandler={() => {\r\n                  this.newTableRow = true;\r\n                }}\r\n              ></ir-button>\r\n            </div>\r\n            <table class=\"mt-1\" style={{ backgroundColor: this.paymentBackground }}>\r\n              <thead>\r\n                <tr>\r\n                  <th class={'border border-light border-bottom-0 text-center payment_date'}>{locales.entries.Lcz_Dates}</th>\r\n                  <th class={'border border-light border-bottom-0 text-center w-60'}>{locales.entries.Lcz_Amount}</th>\r\n                  <th class={'border border-light border-bottom-0 text-center designation'}>{locales.entries.Lcz_Designation}</th>\r\n                  <th class={'border border-light border-bottom-0 text-center action_icons'}>\r\n                    <span class={'sr-only'}>payment actions</span>\r\n                    {/* <ir-button\r\n                      id=\"add-payment\"\r\n                      variant=\"icon\"\r\n                      icon_name=\"square_plus\"\r\n                      onClickHandler={() => {\r\n                        this.newTableRow = true;\r\n                      }}\r\n                    ></ir-button> */}\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {this.bookingDetails.financial.payments?.map((item: any) => this._renderTableRow(item))}\r\n                {this.newTableRow ? this._renderTableRow(null, 'add') : null}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>,\r\n\r\n      <ir-modal\r\n        item={this.toBeDeletedItem}\r\n        class={'delete-record-modal'}\r\n        modalTitle={locales.entries.Lcz_Confirmation}\r\n        modalBody={this.modal_mode === 'delete' ? locales.entries.Lcz_IfDeletedPermantlyLost : locales.entries.Lcz_EnteringAmountGreaterThanDue}\r\n        iconAvailable={true}\r\n        icon=\"ft-alert-triangle danger h1\"\r\n        leftBtnText={locales.entries.Lcz_Cancel}\r\n        rightBtnText={this.modal_mode === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\r\n        leftBtnColor=\"secondary\"\r\n        rightBtnColor={this.modal_mode === 'delete' ? 'danger' : 'primary'}\r\n        onConfirmModal={this.handleConfirmModal.bind(this)}\r\n        onCancelModal={this.handleCancelModal.bind(this)}\r\n      ></ir-modal>,\r\n    ];\r\n  }\r\n}\r\n","import axios from 'axios';\r\nimport { TDueParams, TPickupData } from './types';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport { IBookingPickupInfo } from '@/components';\r\nimport { z, ZodError } from 'zod';\r\nimport { renderTime } from '@/utils/utils';\r\nimport moment from 'moment';\r\n\r\nexport class PickupService {\r\n  public async savePickup(params: TPickupData, booking_nbr: string, is_remove: boolean) {\r\n    try {\r\n      const splitTime = params.arrival_time.split(':');\r\n      await axios.post(`/Do_Pickup`, {\r\n        booking_nbr,\r\n        is_remove,\r\n        currency: params.currency,\r\n        date: params.arrival_date,\r\n        details: params.flight_details,\r\n        hour: splitTime[0],\r\n        minute: splitTime[1],\r\n        nbr_of_units: params.number_of_vehicles,\r\n        selected_option: params.selected_option,\r\n        total: +params.due_upon_booking,\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  public transformDefaultPickupData(data: IBookingPickupInfo): TPickupData {\r\n    const arrival_time = data.hour && data.minute ? renderTime(data.hour) + ':' + renderTime(data.minute) : '';\r\n    return {\r\n      arrival_date: data.date,\r\n      arrival_time,\r\n      currency: data.currency,\r\n      due_upon_booking: data.total.toFixed(2),\r\n      flight_details: data.details,\r\n      location: data.selected_option.location.id,\r\n      number_of_vehicles: data.nbr_of_units,\r\n      selected_option: data.selected_option,\r\n      vehicle_type_code: data.selected_option.vehicle.code,\r\n    };\r\n  }\r\n  public getAvailableLocations(message: string) {\r\n    let locations: { value: number; text: string }[] = [];\r\n    calendar_data.pickup_service.allowed_options.forEach(option => {\r\n      if (locations.filter(location => location.value === option.location.id).length === 0) {\r\n        locations.push({\r\n          text: message + ' ' + option.location.description,\r\n          value: option.location.id,\r\n        });\r\n      }\r\n    });\r\n    return locations;\r\n  }\r\n  public createPickupSchema(minDate: string, maxDate: string) {\r\n    return z.object({\r\n      arrival_date: z\r\n        .string()\r\n        .regex(/^\\d{4}-\\d{2}-\\d{2}$/, { message: 'Invalid date format, expected YYYY-MM-DD' })\r\n        .refine(\r\n          dateStr => {\r\n            const date = moment(dateStr, 'YYYY-MM-DD', true);\r\n            const min = moment(minDate, 'YYYY-MM-DD', true);\r\n            const max = moment(maxDate, 'YYYY-MM-DD', true);\r\n            return date.isValid() && min.isValid() && max.isValid() && date.isBetween(min, max, undefined, '[]');\r\n          },\r\n          { message: `arrival_date must be between ${minDate} and ${maxDate}` },\r\n        ),\r\n\r\n      arrival_time: z\r\n        .string()\r\n        .regex(/^\\d{2}:\\d{2}$/, { message: 'Invalid time format. Expected HH:MM' })\r\n        .refine(\r\n          time => {\r\n            const [hours, minutes] = time.split(':').map(Number);\r\n            return hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59;\r\n          },\r\n          { message: 'Time values are out of range' },\r\n        ),\r\n      flight_details: z.string().nonempty({ message: 'Flight details cannot be empty' }),\r\n      vehicle_type_code: z.string().nonempty({ message: 'Vehicle type code cannot be empty' }),\r\n      number_of_vehicles: z.coerce.number().min(1, { message: 'At least one vehicle is required' }),\r\n    });\r\n  }\r\n  public validateForm(\r\n    params: TPickupData,\r\n    schema: any, // : { error: boolean; cause?: keyof TPickupData }\r\n  ) {\r\n    try {\r\n      schema.parse(params);\r\n      return null;\r\n    } catch (error) {\r\n      console.log(error);\r\n      const err = {};\r\n      if (error instanceof ZodError) {\r\n        error.issues.forEach(e => {\r\n          err[e.path[0]] = true;\r\n        });\r\n        return err;\r\n      }\r\n    }\r\n    // if (params.arrival_time.split(':').length !== 2) {\r\n    //   return {\r\n    //     error: true,\r\n    //     cause: 'arrival_time',\r\n    //   };\r\n    // }\r\n    // if (params.flight_details === '') {\r\n    //   return {\r\n    //     error: true,\r\n    //     cause: 'flight_details',\r\n    //   };\r\n    // }\r\n    // if (params.vehicle_type_code === '') {\r\n    //   return {\r\n    //     error: true,\r\n    //     cause: 'vehicle_type_code',\r\n    //   };\r\n    // }\r\n    // if (params.number_of_vehicles === 0) {\r\n    //   return {\r\n    //     error: true,\r\n    //     cause: 'number_of_vehicles',\r\n    //   };\r\n    // }\r\n    // return { error: false };\r\n  }\r\n  public getNumberOfVehicles(capacity: number, numberOfPersons: number) {\r\n    let total_number_of_vehicles = Math.ceil(numberOfPersons / capacity);\r\n    let startNumber = total_number_of_vehicles > 1 ? total_number_of_vehicles : 1;\r\n    let bonus_number = total_number_of_vehicles > 1 ? 2 : 3;\r\n    return Array.from({ length: total_number_of_vehicles + bonus_number }, (_, i) => startNumber + i);\r\n  }\r\n  private getPickUpPersonStatus(code: string) {\r\n    const getCodeDescription = calendar_data.pickup_service.allowed_pricing_models.find(model => model.code === code);\r\n    if (!getCodeDescription) {\r\n      return null;\r\n    }\r\n    return getCodeDescription.description;\r\n  }\r\n  public updateDue(params: TDueParams) {\r\n    const getCodeDescription = this.getPickUpPersonStatus(params.code);\r\n    if (!getCodeDescription) {\r\n      return;\r\n    }\r\n    if (getCodeDescription === 'Person') {\r\n      return params.amount * params.numberOfPersons;\r\n    } else {\r\n      return params.amount * params.number_of_vehicles;\r\n    }\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n.custom-card-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  border-bottom: 1px solid #e4e5ec;\r\n}\r\n.card-title {\r\n  flex: 1;\r\n}\r\n.border-theme {\r\n  border: 1px solid #cacfe7;\r\n}\r\n@media (min-width: 768px) {\r\n  .price-input-container {\r\n    max-width: 290px;\r\n  }\r\n}\r\n",":host {\r\n  height: 100%;\r\n}\r\n.sheet-container {\r\n  display: flex !important;\r\n  flex-direction: column !important;\r\n  background: white;\r\n  height: 100% !important;\r\n  gap: 1rem;\r\n}\r\n.sheet-footer {\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 20;\r\n  background: white;\r\n  border-top: 1px solid #e4e5ec;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  gap: 0.5rem;\r\n}\r\n.sheet-header {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  background: white;\r\n}\r\n.sheet-body {\r\n  flex: 1 1 0%;\r\n}\r\n@media (min-width: 768px) {\r\n  .sheet-footer {\r\n    flex-direction: row;\r\n    align-items: center;\r\n  }\r\n}\r\n","import calendar_data from '@/stores/calendar-data';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Element, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { TPickupData } from './types';\r\nimport moment from 'moment';\r\nimport { IAllowedOptions } from '@/models/calendarData';\r\nimport { PickupService } from './pickup.service';\r\nimport { IBookingPickupInfo } from '@/models/booking.dto';\r\nimport { MaskedRange } from 'imask';\r\n\r\n@Component({\r\n  tag: 'ir-pickup',\r\n  styleUrls: ['ir-pickup.css', '../../../common/sheet.css'],\r\n  scoped: true,\r\n})\r\nexport class IrPickup {\r\n  @Element() el: HTMLElement;\r\n\r\n  @Prop() defaultPickupData: IBookingPickupInfo | null;\r\n  @Prop() numberOfPersons: number = 0;\r\n  @Prop() bookingNumber: string;\r\n  @Prop() bookingDates: { from: string; to: string };\r\n\r\n  @State() isLoading = false;\r\n  @State() allowedOptionsByLocation: IAllowedOptions[] = [];\r\n  @State() pickupData: TPickupData = {\r\n    location: -1,\r\n    flight_details: '',\r\n    due_upon_booking: '',\r\n    number_of_vehicles: 1,\r\n    vehicle_type_code: '',\r\n    currency: undefined,\r\n    arrival_time: '',\r\n    arrival_date: null,\r\n    selected_option: undefined,\r\n  };\r\n  @State() vehicleCapacity: number[] = [];\r\n  @State() cause: keyof TPickupData | null = null;\r\n  @State() errors: Record<string, boolean>;\r\n  @State() autoValidate = false;\r\n\r\n  @Event() closeModal: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n\r\n  private pickupService = new PickupService();\r\n  private pickupSchema;\r\n\r\n  private arrival_time_mask = {\r\n    mask: 'HH:mm',\r\n    blocks: {\r\n      HH: {\r\n        mask: MaskedRange,\r\n        from: 0,\r\n        to: 23,\r\n        placeholderChar: 'H',\r\n      },\r\n      mm: {\r\n        mask: MaskedRange,\r\n        from: 0,\r\n        to: 59,\r\n        placeholderChar: 'm',\r\n      },\r\n    },\r\n    lazy: false,\r\n    placeholderChar: '_',\r\n  };\r\n\r\n  componentWillLoad() {\r\n    if (this.defaultPickupData) {\r\n      const transformedData = this.pickupService.transformDefaultPickupData(this.defaultPickupData);\r\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(transformedData.selected_option.vehicle.capacity, this.numberOfPersons);\r\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id === transformedData.location);\r\n      this.pickupData = { ...transformedData };\r\n    }\r\n    this.pickupSchema = this.pickupService.createPickupSchema(this.bookingDates.from, this.bookingDates.to);\r\n  }\r\n  private handleLocationChange(event: CustomEvent) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const value = event.detail;\r\n    if (value === '') {\r\n      this.updatePickupData('location', -1);\r\n    }\r\n    if (value !== '') {\r\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id.toString() === value);\r\n      let locationChoice = this.allowedOptionsByLocation[0];\r\n      if (!locationChoice) {\r\n        return;\r\n      }\r\n      locationChoice.currency;\r\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons);\r\n      this.pickupData = {\r\n        ...this.pickupData,\r\n        location: value,\r\n        selected_option: locationChoice,\r\n        number_of_vehicles: this.vehicleCapacity[0],\r\n        due_upon_booking: this.pickupService\r\n          .updateDue({\r\n            amount: locationChoice.amount,\r\n            code: locationChoice.pricing_model.code,\r\n            numberOfPersons: this.numberOfPersons,\r\n            number_of_vehicles: this.vehicleCapacity[0],\r\n          })\r\n          .toFixed(2),\r\n        vehicle_type_code: locationChoice.vehicle.code,\r\n        currency: locationChoice.currency,\r\n        // number_of_vehicles:this.pickupService\r\n      };\r\n    }\r\n  }\r\n\r\n  private handleVehicleQuantityChange(e: CustomEvent) {\r\n    if (e.detail === '') {\r\n      return;\r\n    }\r\n    const value = +e.detail;\r\n    this.pickupData = {\r\n      ...this.pickupData,\r\n      number_of_vehicles: value,\r\n      due_upon_booking: this.pickupService\r\n        .updateDue({\r\n          amount: this.pickupData.selected_option.amount,\r\n          code: this.pickupData.selected_option.pricing_model.code,\r\n          numberOfPersons: this.numberOfPersons,\r\n          number_of_vehicles: value,\r\n        })\r\n        .toFixed(2),\r\n    };\r\n  }\r\n\r\n  private handleVehicleTypeChange(e: CustomEvent) {\r\n    if (e.detail === '') {\r\n      this.pickupData = {\r\n        ...this.pickupData,\r\n        due_upon_booking: '',\r\n        vehicle_type_code: '',\r\n      };\r\n      return;\r\n    }\r\n    let locationChoice = calendar_data.pickup_service.allowed_options.find(option => option.location.id === +this.pickupData.location && option.vehicle.code === e.detail);\r\n    if (!locationChoice) {\r\n      return;\r\n    }\r\n    this.vehicleCapacity = [...this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons)];\r\n    this.pickupData = {\r\n      ...this.pickupData,\r\n      selected_option: locationChoice,\r\n      number_of_vehicles: this.vehicleCapacity[0],\r\n      due_upon_booking: this.pickupService\r\n        .updateDue({\r\n          amount: locationChoice.amount,\r\n          code: locationChoice.pricing_model.code,\r\n          numberOfPersons: this.numberOfPersons,\r\n          number_of_vehicles: this.vehicleCapacity[0],\r\n        })\r\n        .toFixed(2),\r\n      vehicle_type_code: locationChoice.vehicle.code,\r\n    };\r\n  }\r\n\r\n  private updatePickupData(key: keyof TPickupData, value: any) {\r\n    this.pickupData = { ...this.pickupData, [key]: value };\r\n  }\r\n  private async savePickup() {\r\n    try {\r\n      this.isLoading = true;\r\n      this.autoValidate = true;\r\n      if (this.errors) {\r\n        this.errors = null;\r\n      }\r\n      this.errors = this.pickupService.validateForm(this.pickupData, this.pickupSchema);\r\n      if (this.errors) {\r\n        return;\r\n      }\r\n      await this.pickupService.savePickup(this.pickupData, this.bookingNumber, this.defaultPickupData !== null && this.pickupData.location === -1);\r\n      this.resetBookingEvt.emit(null);\r\n      this.closeModal.emit(null);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <form\r\n        class={'sheet-container'}\r\n        onSubmit={async e => {\r\n          e.preventDefault();\r\n          await this.savePickup();\r\n        }}\r\n      >\r\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_Pickup} displayContext=\"sidebar\"></ir-title>\r\n        <section class={'px-1 sheet-body'}>\r\n          <ir-select\r\n            testId=\"pickup_location\"\r\n            selectedValue={this.pickupData.location}\r\n            selectContainerStyle=\"mb-1\"\r\n            onSelectChange={this.handleLocationChange.bind(this)}\r\n            firstOption={locales.entries.Lcz_Pickup_NoThankYou}\r\n            class={'m-0 mb-1'}\r\n            LabelAvailable={false}\r\n            data={this.pickupService.getAvailableLocations(locales.entries.Lcz_Pickup_YesFrom) as any}\r\n          ></ir-select>\r\n          {this.pickupData.location > 0 && (\r\n            <div class=\"m-0 p-0\" data-testid=\"pickup_body\">\r\n              {/*Date and Time Picker container */}\r\n              <div class={'d-flex'}>\r\n                {/*Date Picker */}\r\n                <div class=\"form-group  mr-1\">\r\n                  <div class=\"input-group row m-0\">\r\n                    <div class={`input-group-prepend col-5 p-0 text-dark border-0`}>\r\n                      <label class={`input-group-text  flex-grow-1 text-dark border-theme `}>{locales.entries.Lcz_ArrivalDate}</label>\r\n                    </div>\r\n                    <div class=\"form-control  form-control-md col-7 d-flex align-items-center px-0 mx-0\" style={{ border: '0' }}>\r\n                      <ir-date-picker\r\n                        data-testid=\"pickup_arrival_date\"\r\n                        date={this.pickupData.arrival_date}\r\n                        minDate={this.bookingDates.from}\r\n                        maxDate={this.bookingDates?.to}\r\n                        emitEmptyDate={true}\r\n                        aria-invalid={this.errors?.arrival_date && !this.pickupData.arrival_date ? 'true' : 'false'}\r\n                        onDateChanged={evt => {\r\n                          this.updatePickupData('arrival_date', evt.detail.start?.format('YYYY-MM-DD'));\r\n                        }}\r\n                      >\r\n                        <input\r\n                          type=\"text\"\r\n                          slot=\"trigger\"\r\n                          value={this.pickupData.arrival_date ? moment(this.pickupData.arrival_date).format('MMM DD, YYYY') : null}\r\n                          class={`form-control input-sm ${this.errors?.arrival_date && !this.pickupData.arrival_date ? 'border-danger' : ''} text-center`}\r\n                          style={{ borderTopLeftRadius: '0', borderBottomLeftRadius: '0', width: '100%' }}\r\n                        ></input>\r\n                      </ir-date-picker>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                {/*Time Picker */}\r\n                <ir-input-text\r\n                  autoValidate={this.autoValidate}\r\n                  wrapKey=\"arrival_time\"\r\n                  testId=\"pickup_arrival_time\"\r\n                  error={this.errors?.arrival_time}\r\n                  value={this.pickupData.arrival_time}\r\n                  zod={this.pickupSchema.pick({ arrival_time: true })}\r\n                  label={locales.entries.Lcz_Time}\r\n                  inputStyles=\"col-sm-4\"\r\n                  data-state={this.cause === 'arrival_time' ? 'error' : ''}\r\n                  mask={this.arrival_time_mask}\r\n                  onTextChange={e => this.updatePickupData('arrival_time', e.detail)}\r\n                ></ir-input-text>\r\n              </div>\r\n              <ir-input-text\r\n                wrapKey=\"flight_details\"\r\n                zod={this.pickupSchema.pick({ flight_details: true })}\r\n                autoValidate={this.autoValidate}\r\n                testId=\"pickup_flight_details\"\r\n                value={this.pickupData.flight_details}\r\n                label={locales.entries.Lcz_FlightDetails}\r\n                onTextChange={e => this.updatePickupData('flight_details', e.detail)}\r\n                placeholder=\"\"\r\n                error={this.errors?.flight_details}\r\n              ></ir-input-text>\r\n              <ir-select\r\n                testId=\"pickup_vehicle_type_code\"\r\n                selectContainerStyle=\"mb-1\"\r\n                error={this.cause === 'vehicle_type_code'}\r\n                onSelectChange={this.handleVehicleTypeChange.bind(this)}\r\n                firstOption={locales.entries.Lcz_Select}\r\n                selectedValue={this.pickupData.vehicle_type_code}\r\n                class={'m-0'}\r\n                LabelAvailable={false}\r\n                data={\r\n                  this.allowedOptionsByLocation.map(option => ({\r\n                    text: option.vehicle.description,\r\n                    value: option.vehicle.code,\r\n                  })) as any\r\n                }\r\n              ></ir-select>\r\n              <div class={'d-flex flex-column flex-md-row'}>\r\n                <ir-select\r\n                  showFirstOption={false}\r\n                  testId=\"pickup_number_of_vehicles\"\r\n                  labelBorder=\"theme\"\r\n                  selectContainerStyle=\"mb-1\"\r\n                  onSelectChange={this.handleVehicleQuantityChange.bind(this)}\r\n                  selectedValue={this.pickupData.number_of_vehicles}\r\n                  error={this.cause === 'number_of_vehicles'}\r\n                  labelWidth={7}\r\n                  class={'m-0  mb-md-0 mr-md-1 flex-fill'}\r\n                  label={locales.entries.Lcz_NbrOfVehicles}\r\n                  data={\r\n                    this.vehicleCapacity.map(i => ({\r\n                      text: i,\r\n                      value: i,\r\n                    })) as any\r\n                  }\r\n                ></ir-select>\r\n                {/* <ir-input-text\r\n                  labelBorder=\"theme\"\r\n                  readonly\r\n                  value={this.pickupData.due_upon_booking}\r\n                  labelWidth={7}\r\n                  label={`${locales.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`}\r\n                  placeholder=\"\"\r\n                  class=\"\"\r\n                ></ir-input-text> */}\r\n                <div class=\"price-input-container\">\r\n                  <ir-price-input readOnly label={`${locales.entries.Lcz_DueUponBooking}`} value={this.pickupData.due_upon_booking} currency={this.pickupData.currency.symbol} />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </section>\r\n        <div class={'sheet-footer'}>\r\n          <ir-button\r\n            onClick={() => this.closeModal.emit(null)}\r\n            btn_styles=\"justify-content-center\"\r\n            class={`flex-fill`}\r\n            icon=\"\"\r\n            text={locales.entries.Lcz_Cancel}\r\n            btn_color=\"secondary\"\r\n          ></ir-button>\r\n          {(this.defaultPickupData || this.pickupData.location !== -1) && (\r\n            <ir-button\r\n              btn_styles=\"justify-content-center align-items-center\"\r\n              class={'flex-fill'}\r\n              icon=\"\"\r\n              isLoading={this.isLoading}\r\n              text={locales.entries.Lcz_Save}\r\n              btn_color=\"primary\"\r\n              btn_type=\"submit\"\r\n            ></ir-button>\r\n          )}\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n","import calendar_data from '@/stores/calendar-data';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Host, Prop, h } from '@stencil/core';\r\nimport { _formatTime } from '../functions';\r\nimport moment from 'moment';\r\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport { Booking } from '@/models/booking.dto';\r\n@Component({\r\n  tag: 'ir-pickup-view',\r\n  styleUrl: 'ir-pickup-view.css',\r\n  scoped: true,\r\n})\r\nexport class IrPickupView {\r\n  @Prop() booking: Booking;\r\n  render() {\r\n    if (!calendar_data.pickup_service.is_enabled || !this.booking.is_editable) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Host>\r\n        <div class=\"mb-1\">\r\n          <div class={'d-flex w-100 mb-1 align-items-center justify-content-between'}>\r\n            <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_Pickup}</p>\r\n            <ir-button id=\"pickup\" data-testid=\"new_pickup_btn\" variant=\"icon\" icon_name=\"edit\" style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}></ir-button>\r\n          </div>\r\n          {this.booking.pickup_info && (\r\n            <div class={'card'}>\r\n              <div class={'p-1'}>\r\n                <div class={'d-flex align-items-center py-0 my-0 pickup-margin'}>\r\n                  <p class={'font-weight-bold mr-1 py-0 my-0'}>\r\n                    {locales.entries.Lcz_Date}: <span class={'font-weight-normal'}>{moment(this.booking.pickup_info.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</span>\r\n                  </p>\r\n                  {this.booking.pickup_info.hour && this.booking.pickup_info.minute && (\r\n                    <p class={'font-weight-bold flex-fill py-0 my-0'}>\r\n                      {locales.entries.Lcz_Time}:\r\n                      <span class={'font-weight-normal'}> {_formatTime(this.booking.pickup_info.hour.toString(), this.booking.pickup_info.minute.toString())}</span>\r\n                    </p>\r\n                  )}\r\n                  <p class={'font-weight-bold py-0 my-0'}>\r\n                    {locales.entries.Lcz_DueUponBooking}:{' '}\r\n                    <span class={'font-weight-normal'}>\r\n                      {this.booking.pickup_info.currency.symbol}\r\n                      {this.booking.pickup_info.total}\r\n                    </span>\r\n                  </p>\r\n                </div>\r\n                <p class={'font-weight-bold py-0 my-0'}>\r\n                  {locales.entries.Lcz_FlightDetails}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.details}`}</span>\r\n                </p>\r\n                <p class={'py-0 my-0 pickup-margin'}>{`${this.booking.pickup_info.selected_option.vehicle.description}`}</p>\r\n                <p class={'font-weight-bold py-0 my-0 pickup-margin'}>\r\n                  {locales.entries.Lcz_NbrOfVehicles}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.nbr_of_units}`}</span>\r\n                </p>\r\n                <p class={'small py-0 my-0 pickup-margin'}>\r\n                  {calendar_data.pickup_service.pickup_instruction.description}\r\n                  {calendar_data.pickup_service.pickup_cancelation_prepayment.description}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n.dialog-container-height {\r\n  height: 4rem;\r\n}\r\n.list-title {\r\n  margin: 0;\r\n  padding: 0;\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  width: fit-content;\r\n}\r\n.list-item {\r\n  margin: 0;\r\n  padding: 0;\r\n  font-size: 14px;\r\n  margin-left: 5px;\r\n  width: fit-content;\r\n}\r\n.list-item.green {\r\n  color: #629a4c;\r\n  font-weight: 600;\r\n}\r\n.list-item.red {\r\n  color: #ff4961;\r\n  font-weight: 600;\r\n}\r\n","import { Component, h, Prop, State } from '@stencil/core';\r\nimport { _formatTime } from '../../functions';\r\nimport locales from '@/stores/locales.store';\r\nimport { IPmsLog } from '@/models/booking.dto';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport { BookingService } from '@/services/booking.service';\r\n\r\n@Component({\r\n  tag: 'ir-pms-logs',\r\n  styleUrl: 'ir-pms-logs.css',\r\n  scoped: true,\r\n})\r\nexport class IrPmsLogs {\r\n  @Prop() bookingNumber: string;\r\n\r\n  @State() pmsLogs: IPmsLog;\r\n\r\n  private bookingService = new BookingService();\r\n\r\n  componentWillLoad() {\r\n    this.init();\r\n  }\r\n\r\n  private async init() {\r\n    try {\r\n      this.pmsLogs = await this.bookingService.fetchPMSLogs(this.bookingNumber);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"p-1\">\r\n        <h3 class=\" text-left mb-1 dialog-title \">{locales.entries.Lcz_PMS_Logs}</h3>\r\n\r\n        {isRequestPending('/Get_Exposed_PMS_Logs') ? (\r\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\r\n            <ir-spinner></ir-spinner>\r\n          </div>\r\n        ) : (\r\n          <div class={'dialog-container-height'}>\r\n            <div class=\"d-flex align-items-center \" style={{ paddingBottom: '0.5rem' }}>\r\n              <p class=\"list-title p-0 m-0\">{locales.entries.Lcz_SentAt}</p>\r\n              {this.pmsLogs?.sent_date ? (\r\n                <p class=\"list-item\">\r\n                  {this.pmsLogs?.sent_date} {_formatTime(this.pmsLogs?.sent_hour.toString(), this.pmsLogs?.sent_minute.toString())}\r\n                </p>\r\n              ) : (\r\n                <p class={`list-item ${this.pmsLogs?.sent_date ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\r\n              )}\r\n            </div>\r\n            <div class=\"d-flex align-items-center p-0 m-0\">\r\n              <h4 class=\"list-title p-0 m-0\">{locales.entries.Lcz_Acknowledged}</h4>\r\n              <p class={`list-item  ${this.pmsLogs?.is_acknowledged ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n","import { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport locales from '@/stores/locales.store';\r\nimport { getPrivateNote } from '@/utils/booking';\r\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { ICountry } from '@/models/IBooking';\r\nimport { _formatDate, _formatTime } from '../functions';\r\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent } from '../types';\r\n\r\n@Component({\r\n  tag: 'ir-reservation-information',\r\n  styleUrl: 'ir-reservation-information.css',\r\n  scoped: true,\r\n})\r\nexport class IrReservationInformation {\r\n  @Prop() booking: Booking;\r\n  @Prop() countries: ICountry[];\r\n\r\n  @State() userCountry: ICountry | null = null;\r\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\r\n  componentWillLoad() {\r\n    const guestCountryId = this.booking?.guest?.country_id;\r\n    this.userCountry = guestCountryId ? this.countries?.find(country => country.id === guestCountryId) || null : null;\r\n  }\r\n  private handleEditClick(e: CustomEvent, type: BookingDetailsSidebarEvents) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    this.openSidebar.emit({ type });\r\n  }\r\n\r\n  private renderPhoneNumber() {\r\n    const { mobile_without_prefix, country_phone_prefix, country_id } = this.booking.guest;\r\n    if (!mobile_without_prefix) {\r\n      return null;\r\n    }\r\n    if (country_phone_prefix) {\r\n      return country_phone_prefix + ' ' + mobile_without_prefix;\r\n    }\r\n    if (country_id) {\r\n      const selectedCountry = this.countries.find(c => c.id === country_id);\r\n      if (!selectedCountry) {\r\n        throw new Error('Invalid country id');\r\n      }\r\n      return selectedCountry.phone_prefix + ' ' + mobile_without_prefix;\r\n    }\r\n    return mobile_without_prefix;\r\n    // const { mobile, country_phone_prefix, country_id } = this.booking.guest;\r\n    // if (!mobile) {\r\n    //   return null;\r\n    // }\r\n    // if (this.booking.is_direct) {\r\n    //   if (country_phone_prefix) {\r\n    //     return country_phone_prefix + ' ' + mobile;\r\n    //   }\r\n    //   if (country_id) {\r\n    //     const selectedCountry = this.countries.find(c => c.id === country_id);\r\n    //     if (!selectedCountry) {\r\n    //       throw new Error('Invalid country id');\r\n    //     }\r\n    //     return selectedCountry.phone_prefix + ' ' + mobile;\r\n    //   }\r\n    // }\r\n    // return mobile;\r\n  }\r\n  render() {\r\n    const privateNote = getPrivateNote(this.booking.extras);\r\n    return (\r\n      <div class=\"card\">\r\n        <div class=\"p-1\">\r\n          <p>{this.booking.property.name || ''}</p>\r\n          <ir-label\r\n            labelText={`${locales.entries.Lcz_Source}:`}\r\n            content={this.booking.origin.Label}\r\n            image={{ src: this.booking.origin.Icon, alt: this.booking.origin.Label }}\r\n          ></ir-label>\r\n          <ir-label\r\n            renderContentAsHtml\r\n            labelText={`${locales.entries.Lcz_BookedOn}:`}\r\n            content={`${_formatDate(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${_formatTime(\r\n              this.booking.booked_on.hour.toString(),\r\n              this.booking.booked_on.minute.toString(),\r\n            )}`}\r\n          ></ir-label>\r\n          <ir-label labelText={`${locales.entries.Lcz_BookedBy}:`} content={`${this.booking.guest.first_name} ${this.booking.guest.last_name}`}>\r\n            {this.booking.guest?.nbr_confirmed_bookings > 1 && !this.booking.agent && (\r\n              <div class={'m-0 p-0'} slot=\"prefix\">\r\n                <ir-tooltip message={`${locales.entries.Lcz_BookingsNbr}`.replace('%1', this.booking.guest.nbr_confirmed_bookings.toString())} customSlot>\r\n                  <div class=\"d-flex align-items-center m-0 p-0\" slot=\"tooltip-trigger\" style={{ gap: '0.25rem' }}>\r\n                    <p class={'p-0 m-0'} style={{ color: '#FB0AAD' }}>\r\n                      {this.booking.guest.nbr_confirmed_bookings}\r\n                    </p>\r\n                    <ir-icons style={{ '--icon-size': '1rem' }} color=\"#FB0AAD\" name=\"heart-fill\"></ir-icons>\r\n                  </div>\r\n                </ir-tooltip>\r\n              </div>\r\n            )}\r\n            <ir-button\r\n              slot=\"suffix\"\r\n              variant=\"icon\"\r\n              icon_name={'edit'}\r\n              style={{ ...colorVariants.secondary, '--icon-size': '1.1rem' }}\r\n              onClickHandler={e => this.handleEditClick(e, 'guest')}\r\n            ></ir-button>\r\n          </ir-label>\r\n          {this.booking.guest.mobile && <ir-label labelText={`${locales.entries.Lcz_Phone}:`} content={this.renderPhoneNumber()}></ir-label>}\r\n          {!this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_Email}:`} content={this.booking.guest.email}></ir-label>}\r\n          {this.booking.guest.alternative_email && <ir-label labelText={`${locales.entries.Lcz_AlternativeEmail}:`} content={this.booking.guest.alternative_email}></ir-label>}\r\n          {this.booking?.guest?.address && <ir-label labelText={`${locales.entries.Lcz_Address}:`} content={this.booking.guest.address}></ir-label>}\r\n          {this.userCountry && (\r\n            <ir-label\r\n              labelText={`${locales.entries.Lcz_Country}:`}\r\n              isCountryImage\r\n              content={this.userCountry.name}\r\n              image={{ src: this.userCountry.flag, alt: this.userCountry.name }}\r\n            ></ir-label>\r\n          )}\r\n          {this.booking.guest?.notes && <ir-label display=\"inline\" labelText={`${locales.entries.Lcz_GuestPrivateNote}:`} content={this.booking.guest?.notes}></ir-label>}\r\n          {this.booking.is_direct && <ir-label labelText={`${locales.entries.Lcz_ArrivalTime}:`} content={this.booking.arrival.description}></ir-label>}\r\n          {this.booking.promo_key && <ir-label labelText={`${locales.entries.Lcz_Coupon}:`} content={this.booking.promo_key}></ir-label>}\r\n          {/* {this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_AgentCode?.split(':')[0]}:`} content={this.booking.agent.name}></ir-label>} */}\r\n          {this.booking.is_in_loyalty_mode && !this.booking.promo_key && (\r\n            <div class=\"d-flex align-items-center\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\r\n                <path\r\n                  fill=\"#fc6c85\"\r\n                  d=\"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z\"\r\n                />\r\n              </svg>\r\n              <p class=\"m-0 p-0 ml-1\">{locales.entries.Lcz_LoyaltyDiscountApplied}</p>\r\n            </div>\r\n          )}\r\n          {this.booking.is_direct ? (\r\n            <ir-label labelText={`${locales.entries.Lcz_GuestRemark}:`} display=\"inline\" content={this.booking.remark}></ir-label>\r\n          ) : (\r\n            <ota-label\r\n              class={'m-0 p-0'}\r\n              label={`${locales.entries.Lcz_ChannelNotes || 'Channel notes'}:`}\r\n              remarks={this.booking.ota_notes}\r\n              maxVisibleItems={this.booking.ota_notes?.length}\r\n            ></ota-label>\r\n          )}\r\n          <div class=\"d-flex align-items-center justify-content-between\">\r\n            <ir-label\r\n              labelText={`${locales.entries.Lcz_BookingPrivateNote}:`}\r\n              placeholder={locales.entries.Lcz_VisibleToHotelOnly}\r\n              content={privateNote}\r\n              display={privateNote ? 'inline' : 'flex'}\r\n              // ignore_content\r\n            ></ir-label>\r\n            <ir-button variant=\"icon\" icon_name=\"edit\" style={colorVariants.secondary} onClickHandler={e => this.handleEditClick(e, 'extra_note')}></ir-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n",".light-blue-bg {\r\n  background: #acecff;\r\n  padding: 0.1rem 0.3rem;\r\n  border-radius: 5px;\r\n  display: block;\r\n  max-width: 100px;\r\n  box-sizing: border-box;\r\n  display: inline-block;\r\n  overflow: hidden;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  cursor: default;\r\n}\r\n\r\n.room_statements {\r\n  display: block;\r\n  width: 100%; /* Ensure the container uses the full width */\r\n}\r\n.room_statements {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n.room_statements span {\r\n  display: inline;\r\n  white-space: normal;\r\n  line-height: 1.5;\r\n  word-break: break-word;\r\n}\r\n\r\n.room_statements b {\r\n  display: inline;\r\n  margin-right: 5px;\r\n}\r\n.payment-container {\r\n  position: absolute;\r\n  right: 1rem;\r\n  height: fit-content;\r\n}\r\n:host {\r\n  position: relative;\r\n}\r\n.sm-mr {\r\n  margin-right: 3px;\r\n}\r\n.subtotal_row {\r\n  padding-top: 8px;\r\n  font-weight: 600;\r\n}\r\n.room_actions_btns {\r\n  gap: 0.5rem;\r\n}\r\n.night-cost {\r\n  color: #7cbebe;\r\n}\r\n.room_actions_btns {\r\n  /* max-width: 50%; */\r\n  white-space: nowrap;\r\n  width: max-content;\r\n}\r\n.room_actions_btns {\r\n  flex: 1 1 0%;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n/* .cancelation {\r\n  max-width: 30%;\r\n} */\r\n.mx-0-5 {\r\n  margin-left: 2px !important;\r\n  margin-right: 2px !important;\r\n}\r\n.tax-width {\r\n  font-size: 10px;\r\n  /* flex-wrap: wrap; */\r\n}\r\n.sm-mb-1 {\r\n  margin-bottom: 5px !important;\r\n}\r\n.sm-mt-1 {\r\n  margin-top: 5px !important;\r\n}\r\n.mx-01 {\r\n  --m: 5px;\r\n  margin-right: var(--m) !important;\r\n  margin-left: var(--m) !important;\r\n}\r\n","import { Component, h, Prop, EventEmitter, Event, Listen, State, Element, Host, Fragment, Watch } from '@stencil/core';\r\nimport { _getDay } from '../functions';\r\nimport { Booking, IUnit, IVariations, Occupancy, Room, SharedPerson } from '@/models/booking.dto';\r\nimport { TIglBookPropertyPayload } from '@/models/igl-book-property';\r\nimport { formatName } from '@/utils/booking';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data, { isSingleUnit } from '@/stores/calendar-data';\r\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\r\nimport { formatAmount } from '@/utils/utils';\r\nimport { IEntries } from '@/models/IBooking';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { OpenSidebarEvent, RoomGuestsPayload } from '../types';\r\nexport type RoomModalReason = 'delete' | 'checkin' | 'checkout' | null;\r\n@Component({\r\n  tag: 'ir-room',\r\n  styleUrl: 'ir-room.css',\r\n  scoped: true,\r\n})\r\nexport class IrRoom {\r\n  @Element() element: HTMLIrRoomElement;\r\n  // Room Data\r\n  @Prop() booking: Booking;\r\n  @Prop() bookingIndex: number;\r\n  @Prop() isEditable: boolean;\r\n  @Prop() room: Room;\r\n  // Meal Code names\r\n  @Prop() mealCodeName: string;\r\n  @Prop() myRoomTypeFoodCat: string;\r\n  // Currency\r\n  @Prop() currency: string = 'USD';\r\n  @Prop() language: string = 'en';\r\n  @Prop() legendData;\r\n  @Prop() roomsInfo;\r\n  @Prop() bedPreferences: IEntries[];\r\n  // Booleans Conditions\r\n  @Prop() hasRoomEdit: boolean = false;\r\n  @Prop() hasRoomDelete: boolean = false;\r\n  @Prop() hasRoomAdd: boolean = false;\r\n  @Prop() hasCheckIn: boolean = false;\r\n  @Prop() hasCheckOut: boolean = false;\r\n\r\n  @State() collapsed: boolean = false;\r\n  @State() isLoading: boolean = false;\r\n  @State() modalReason: RoomModalReason = null;\r\n  @State() mainGuest: SharedPerson;\r\n  @State() isModelOpen: boolean = false;\r\n\r\n  // Event Emitters\r\n  @Event({ bubbles: true, composed: true }) deleteFinished: EventEmitter<string>;\r\n  @Event({ bubbles: true, composed: true }) pressCheckIn: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) pressCheckOut: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) editInitiated: EventEmitter<TIglBookPropertyPayload>;\r\n  @Event() resetbooking: EventEmitter<null>;\r\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<RoomGuestsPayload>>;\r\n\r\n  private modal: HTMLIrModalElement;\r\n  private bookingService = new BookingService();\r\n\r\n  componentWillLoad() {\r\n    this.mainGuest = this.getMainGuest();\r\n  }\r\n  @Listen('clickHandler')\r\n  handleClick(e) {\r\n    let target = e.target;\r\n    if (target.id == 'checkin') {\r\n      this.pressCheckIn.emit(this.room);\r\n    } else if (target.id == 'checkout') {\r\n      this.pressCheckOut.emit(this.room);\r\n    }\r\n  }\r\n  @Watch('room')\r\n  handleRoomDataChange() {\r\n    this.mainGuest = this.getMainGuest();\r\n  }\r\n\r\n  private getDateStr(date, locale = 'default') {\r\n    return date.getDate() + ' ' + date.toLocaleString(locale, { month: 'short' }) + ' ' + date.getFullYear();\r\n  }\r\n  private handleEditClick() {\r\n    this.editInitiated.emit({\r\n      event_type: 'EDIT_BOOKING',\r\n      ID: this.room['assigned_units_pool'],\r\n      NAME: formatName(this.mainGuest?.first_name, this.mainGuest?.last_name),\r\n      EMAIL: this.booking.guest.email,\r\n      PHONE: this.booking.guest.mobile,\r\n      REFERENCE_TYPE: '',\r\n      FROM_DATE: this.booking.from_date,\r\n      TO_DATE: this.booking.to_date,\r\n      TITLE: `${locales.entries.Lcz_EditBookingFor} ${this.room?.roomtype?.name} ${(this.room?.unit as IUnit)?.name || ''}`,\r\n      defaultDateRange: {\r\n        dateDifference: this.room.days.length,\r\n        fromDate: new Date(this.room.from_date + 'T00:00:00'),\r\n        fromDateStr: this.getDateStr(new Date(this.room.from_date + 'T00:00:00')),\r\n        toDate: new Date(this.room.to_date + 'T00:00:00'),\r\n        toDateStr: this.getDateStr(new Date(this.room.to_date + 'T00:00:00')),\r\n        message: '',\r\n      },\r\n      bed_preference: this.room.bed_preference,\r\n      adult_child_offering: this.room.rateplan.selected_variation.adult_child_offering,\r\n      ADULTS_COUNT: this.room.rateplan.selected_variation.adult_nbr,\r\n      ARRIVAL: this.booking.arrival,\r\n      ARRIVAL_TIME: this.booking.arrival.description,\r\n      BOOKING_NUMBER: this.booking.booking_nbr,\r\n      cancelation: this.room.rateplan.cancelation,\r\n      channel_booking_nbr: this.booking.channel_booking_nbr,\r\n      CHILDREN_COUNT: this.room.rateplan.selected_variation.child_nbr,\r\n      COUNTRY: this.booking.guest.country_id,\r\n      ENTRY_DATE: this.booking.from_date,\r\n      FROM_DATE_STR: this.booking.format.from_date,\r\n      guarantee: this.room.rateplan.guarantee,\r\n      GUEST: this.mainGuest,\r\n      IDENTIFIER: this.room.identifier,\r\n      is_direct: this.booking.is_direct,\r\n      IS_EDITABLE: this.booking.is_editable,\r\n      NO_OF_DAYS: this.room.days.length,\r\n      NOTES: this.booking.remark,\r\n      origin: this.booking.origin,\r\n      POOL: this.room['assigned_units_pool'],\r\n      PR_ID: (this.room.unit as IUnit)?.id,\r\n      RATE: this.room.total,\r\n      RATE_PLAN: this.room.rateplan.name,\r\n      RATE_PLAN_ID: this.room.rateplan.id,\r\n      RATE_TYPE: this.room.roomtype.id,\r\n      ROOMS: this.booking.rooms,\r\n      SOURCE: this.booking.source,\r\n      SPLIT_BOOKING: false,\r\n      STATUS: 'IN-HOUSE',\r\n      TO_DATE_STR: this.booking.format.to_date,\r\n      TOTAL_PRICE: this.booking.total,\r\n      legendData: this.legendData,\r\n      roomsInfo: this.roomsInfo,\r\n      roomName: (this.room.unit as IUnit)?.name || '',\r\n      PICKUP_INFO: this.booking.pickup_info,\r\n      booking: this.booking,\r\n      currentRoomType: this.room,\r\n    });\r\n  }\r\n  private openModal(reason: RoomModalReason) {\r\n    if (!reason) {\r\n      return;\r\n    }\r\n    this.modalReason = reason;\r\n    this.modal.openModal();\r\n  }\r\n  private async handleModalConfirmation(e: CustomEvent) {\r\n    try {\r\n      e.stopImmediatePropagation();\r\n      e.stopPropagation();\r\n      if (!this.modalReason) {\r\n        return;\r\n      }\r\n      this.isLoading = true;\r\n      switch (this.modalReason) {\r\n        case 'delete':\r\n          await this.deleteRoom();\r\n          break;\r\n        case 'checkin':\r\n        case 'checkout':\r\n          await this.bookingService.handleExposedRoomInOut({\r\n            booking_nbr: this.booking.booking_nbr,\r\n            room_identifier: this.room.identifier,\r\n            status: this.modalReason === 'checkin' ? '001' : '002',\r\n          });\r\n          this.resetbooking.emit(null);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n      this.modalReason = null;\r\n      this.modal.closeModal();\r\n    }\r\n  }\r\n  private async deleteRoom() {\r\n    let oldRooms = [...this.booking.rooms];\r\n    oldRooms = oldRooms.filter(room => room.identifier !== this.room.identifier);\r\n\r\n    const body = {\r\n      assign_units: true,\r\n      check_in: true,\r\n      is_pms: true,\r\n      is_direct: true,\r\n      booking: {\r\n        booking_nbr: this.booking.booking_nbr,\r\n        from_date: this.booking.from_date,\r\n        to_date: this.booking.to_date,\r\n        remark: this.booking.remark,\r\n        property: this.booking.property,\r\n        source: this.booking.source,\r\n        currency: this.booking.currency,\r\n        arrival: this.booking.arrival,\r\n        guest: this.booking.guest,\r\n        rooms: oldRooms,\r\n      },\r\n      extras: this.booking.extras,\r\n      pickup_info: this.booking.pickup_info,\r\n    };\r\n    await this.bookingService.doReservation(body);\r\n    this.deleteFinished.emit(this.room.identifier);\r\n  }\r\n\r\n  private formatVariation({ adult_nbr, child_nbr }: IVariations, { infant_nbr }: Occupancy) {\r\n    const adultCount = adult_nbr > 0 ? adult_nbr : 0;\r\n    const childCount = child_nbr > 0 ? child_nbr : 0;\r\n    const infantCount = infant_nbr > 0 ? infant_nbr : 0;\r\n\r\n    const adultLabel = adultCount > 1 ? locales.entries.Lcz_Adults.toLowerCase() : locales.entries.Lcz_Adult.toLowerCase();\r\n    const childLabel = childCount > 1 ? locales.entries.Lcz_Children.toLowerCase() : locales.entries.Lcz_Child.toLowerCase();\r\n    const infantLabel = infantCount > 1 ? locales.entries.Lcz_Infants.toLowerCase() : locales.entries.Lcz_Infant.toLowerCase();\r\n\r\n    const parts = [];\r\n    if (adultCount > 0) {\r\n      parts.push(`${adultCount} ${adultLabel}`);\r\n    }\r\n    if (childCount > 0) {\r\n      parts.push(`${childCount} ${childLabel}`);\r\n    }\r\n    if (infantCount > 0) {\r\n      parts.push(`${infantCount} ${infantLabel}`);\r\n    }\r\n\r\n    return parts.join('&nbsp&nbsp&nbsp&nbsp');\r\n  }\r\n  private getSmokingLabel() {\r\n    if (this.booking.is_direct) {\r\n      if (!this.room.smoking_option) {\r\n        return null;\r\n      }\r\n      const currRT = calendar_data.roomsInfo.find(rt => rt.id === this.room.roomtype.id);\r\n      if (currRT) {\r\n        const smoking_option = currRT['smoking_option']?.allowed_smoking_options;\r\n        if (smoking_option) {\r\n          return smoking_option.find(s => s.code === this.room.smoking_option)?.description;\r\n        }\r\n        return null;\r\n      }\r\n      return null;\r\n    }\r\n    return this.room.ota_meta?.smoking_preferences;\r\n  }\r\n\r\n  private getBedName() {\r\n    if (this.booking.is_direct) {\r\n      const bed = this.bedPreferences.find(p => p.CODE_NAME === this.room?.bed_preference?.toString());\r\n      if (!bed) {\r\n        return;\r\n      }\r\n      return bed[`CODE_VALUE_${this.language}`] ?? bed.CODE_VALUE_EN;\r\n    }\r\n    return this.room.ota_meta?.bed_preferences;\r\n  }\r\n  private renderModalMessage() {\r\n    switch (this.modalReason) {\r\n      case 'delete':\r\n        return `${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${this.room.roomtype.name} ${this.room.unit ? (this.room.unit as IUnit).name : ''} ${\r\n          locales.entries.Lcz_FromThisBooking\r\n        }`;\r\n      case 'checkin':\r\n        return `Are you sure you want to Check In this unit?\r\n`;\r\n      case 'checkout':\r\n        return `Are you sure you want to Check Out this unit?`;\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n  private handleCheckIn() {\r\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\r\n    if (this.room.sharing_persons.length < adult_nbr + children_nbr + infant_nbr) {\r\n      return this.showGuestModal();\r\n    }\r\n    return this.renderModalMessage();\r\n  }\r\n  private getMainGuest() {\r\n    return this.room.sharing_persons?.find(p => p.is_main);\r\n  }\r\n  render() {\r\n    const bed = this.getBedName();\r\n    return (\r\n      <Host class=\"p-1 d-flex m-0\">\r\n        <ir-button\r\n          variant=\"icon\"\r\n          id=\"drawer-icon\"\r\n          data-toggle=\"collapse\"\r\n          data-target={`#roomCollapse-${this.room.identifier?.split(' ').join('')}`}\r\n          aria-expanded={this.collapsed ? 'true' : 'false'}\r\n          aria-controls=\"myCollapse\"\r\n          class=\"mr-1\"\r\n          icon_name={this.collapsed ? 'closed_eye' : 'open_eye'}\r\n          onClickHandler={() => {\r\n            this.collapsed = !this.collapsed;\r\n          }}\r\n          style={{ '--icon-size': '1.6rem' }}\r\n        ></ir-button>\r\n\r\n        <div class=\"flex-fill m-0 \">\r\n          <div class=\"d-flex align-items-start justify-content-between sm-mb-1 flex-fill\" style={{ gap: '0.5rem' }}>\r\n            <p class=\"m-0 p-0  room-name\">\r\n              <span class=\"m-0 p-0\" style={{ fontWeight: '600' }}>\r\n                {this.myRoomTypeFoodCat || ''}{' '}\r\n              </span>{' '}\r\n              <span>\r\n                {this.mealCodeName} {this.room.rateplan.is_non_refundable && ` - ${locales.entries.Lcz_NonRefundable}`}{' '}\r\n              </span>\r\n            </p>\r\n            {/*this.room.My_Room_type.My_Room_type_desc[0].CUSTOM_TXT || ''*/}\r\n            <div class=\"d-flex m-0 p-0 align-items-center room_actions_btns\">\r\n              <span class=\"p-0 m-0 font-weight-bold\">{formatAmount(this.currency, this.room['gross_total'])}</span>\r\n              {this.hasRoomEdit && this.isEditable && (\r\n                <ir-button\r\n                  id={`roomEdit-${this.room.identifier}`}\r\n                  variant=\"icon\"\r\n                  icon_name=\"edit\"\r\n                  // class=\"mx-1\"\r\n                  style={colorVariants.secondary}\r\n                  onClickHandler={this.handleEditClick.bind(this)}\r\n                ></ir-button>\r\n              )}\r\n              {this.hasRoomDelete && this.isEditable && (\r\n                <ir-button\r\n                  variant=\"icon\"\r\n                  onClickHandler={this.openModal.bind(this, 'delete')}\r\n                  id={`roomDelete-${this.room.identifier}`}\r\n                  icon_name=\"trash\"\r\n                  style={colorVariants.danger}\r\n                ></ir-button>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex align-items-center sm-mb-1\">\r\n            <ir-date-view\r\n              class=\"mr-1  flex-grow-1\"\r\n              style={{ width: 'fit-content' }}\r\n              from_date={this.room.from_date}\r\n              to_date={this.room.to_date}\r\n              showDateDifference={false}\r\n            ></ir-date-view>\r\n            {!isSingleUnit(this.room.roomtype.id) && calendar_data.is_frontdesk_enabled && this.room.unit && (\r\n              <div class={'d-flex justify-content-center align-items-center'}>\r\n                <ir-tooltip message={(this.room.unit as IUnit).name} customSlot>\r\n                  <span slot=\"tooltip-trigger\" class={`light-blue-bg  ${this.hasCheckIn || this.hasCheckOut ? 'mr-2' : ''} `}>\r\n                    {(this.room.unit as IUnit).name}\r\n                  </span>\r\n                </ir-tooltip>\r\n              </div>\r\n            )}\r\n            {this.hasCheckIn && (\r\n              <ir-button onClickHandler={this.handleCheckIn.bind(this)} id=\"checkin\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckIn}></ir-button>\r\n            )}\r\n            {this.hasCheckOut && (\r\n              <ir-button onClickHandler={this.openModal.bind(this, 'checkout')} id=\"checkout\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckOut}></ir-button>\r\n            )}\r\n          </div>\r\n          <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\r\n            <p class=\"m-0 p-0\">{`${this.mainGuest.first_name || ''} ${this.mainGuest.last_name || ''}`}</p>\r\n            {this.room.rateplan.selected_variation.adult_nbr > 0 &&\r\n              (this.room.unit ? (\r\n                <ir-tooltip message={'View guests'} class=\"m-0 p-0\" customSlot>\r\n                  <ir-button\r\n                    class=\"m-0 p-0\"\r\n                    slot=\"tooltip-trigger\"\r\n                    btn_color=\"link\"\r\n                    renderContentAsHtml\r\n                    onClickHandler={() => this.showGuestModal()}\r\n                    size=\"sm\"\r\n                    btnStyle={{ width: 'fit-content', margin: '0', padding: '0', fontSize: 'inherit', textAlign: 'center', lineHeight: '1.2' }}\r\n                    text={this.formatVariation(this.room.rateplan.selected_variation, this.room.occupancy)}\r\n                  ></ir-button>\r\n                </ir-tooltip>\r\n              ) : (\r\n                <span innerHTML={this.formatVariation(this.room.rateplan.selected_variation, this.room.occupancy)}></span>\r\n              ))}\r\n            {bed && <p class=\"m-0 p-0\">({bed})</p>}\r\n          </div>\r\n          <div class=\"collapse\" id={`roomCollapse-${this.room.identifier?.split(' ').join('')}`}>\r\n            <div class=\"d-flex sm-mb-1 sm-mt-1\">\r\n              <div class=\" sm-padding-top\">\r\n                <p class=\"sm-padding-right\" style={{ fontWeight: '600' }}>{`${locales.entries.Lcz_Breakdown}:`}</p>\r\n              </div>\r\n              <div class={'flex-fill'}>\r\n                <table>\r\n                  {this.room.days.length > 0 &&\r\n                    this.room.days.map(room => {\r\n                      return (\r\n                        <tr>\r\n                          <td class={'pr-2 text-right'}>{_getDay(room.date)}</td>\r\n                          <td class=\"text-right\">{formatAmount(this.currency, room.amount)}</td>\r\n                          {room.cost > 0 && room.cost !== null && <td class=\"pl-2 text-left night-cost\">{formatAmount(this.currency, room.cost)}</td>}\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  <tr class={''}>\r\n                    <th class=\"text-right pr-2 subtotal_row\">{locales.entries.Lcz_SubTotal}</th>\r\n                    <th class=\"text-right subtotal_row\">{formatAmount(this.currency, this.room.total)}</th>\r\n                    {this.room.gross_cost > 0 && this.room.gross_cost !== null && <th class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, this.room.cost)}</th>}\r\n                  </tr>\r\n                  {this.booking.is_direct ? (\r\n                    <Fragment>\r\n                      {(() => {\r\n                        const filtered_data = calendar_data.taxes.filter(tx => tx.pct > 0);\r\n                        return filtered_data.map(d => {\r\n                          return (\r\n                            <tr>\r\n                              <td class=\"text-right pr-2\">\r\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name} ({d.pct}%)\r\n                              </td>\r\n                              <td class=\"text-right\">{formatAmount(this.currency, (this.room.total * d.pct) / 100)}</td>\r\n                              {this.room.gross_cost > 0 && this.room.gross_cost !== null && (\r\n                                <td class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, (this.room.cost * d.pct) / 100)}</td>\r\n                              )}\r\n                            </tr>\r\n                          );\r\n                        });\r\n                      })()}\r\n                    </Fragment>\r\n                  ) : (\r\n                    <Fragment>\r\n                      {(() => {\r\n                        const filtered_data = this.room.ota_taxes.filter(tx => tx.amount > 0);\r\n                        return filtered_data.map(d => {\r\n                          return (\r\n                            <tr>\r\n                              <td class=\"text-right pr-2\">\r\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name}\r\n                              </td>\r\n                              <td class=\"text-right\">\r\n                                {d.currency.symbol}\r\n                                {d.amount}\r\n                              </td>\r\n                            </tr>\r\n                          );\r\n                        });\r\n                      })()}\r\n                    </Fragment>\r\n                  )}\r\n                </table>\r\n              </div>\r\n            </div>\r\n            <ir-label labelText={`${locales.entries.Lcz_SmokingOptions}:`} display=\"inline\" content={this.getSmokingLabel()}></ir-label>\r\n            {this.booking.is_direct && (\r\n              <Fragment>\r\n                {this.room.rateplan.cancelation && (\r\n                  <ir-label labelText={`${locales.entries.Lcz_Cancellation}:`} display=\"inline\" content={this.room.rateplan.cancelation || ''} renderContentAsHtml></ir-label>\r\n                )}\r\n                {this.room.rateplan.guarantee && (\r\n                  <ir-label labelText={`${locales.entries.Lcz_Guarantee}:`} display=\"inline\" content={this.room.rateplan.guarantee || ''} renderContentAsHtml></ir-label>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n            {this.room.ota_meta && (\r\n              <div>\r\n                <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} display=\"inline\" content={this.room.ota_meta.meal_plan}></ir-label>\r\n                <ir-label labelText={`${locales.entries.Lcz_Policies}:`} display=\"inline\" content={this.room.ota_meta.policies}></ir-label>\r\n              </div>\r\n            )}\r\n            {/* {this.bookingEvent.is_direct && <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} content={this.mealCodeName}></ir-label>} */}\r\n          </div>\r\n        </div>\r\n        <ir-modal\r\n          autoClose={false}\r\n          ref={el => (this.modal = el)}\r\n          isLoading={this.isLoading}\r\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\r\n          iconAvailable={true}\r\n          icon=\"ft-alert-triangle danger h1\"\r\n          leftBtnText={locales.entries.Lcz_Cancel}\r\n          rightBtnText={this.modalReason === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\r\n          leftBtnColor=\"secondary\"\r\n          rightBtnColor={this.modalReason === 'delete' ? 'danger' : 'primary'}\r\n          modalTitle={locales.entries.Lcz_Confirmation}\r\n          modalBody={this.renderModalMessage()}\r\n        ></ir-modal>\r\n      </Host>\r\n    );\r\n  }\r\n  private showGuestModal(): void {\r\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\r\n    this.openSidebar.emit({\r\n      type: 'room-guest',\r\n      payload: {\r\n        roomName: (this.room.unit as IUnit)?.name,\r\n        sharing_persons: this.room.sharing_persons,\r\n        totalGuests: adult_nbr + children_nbr + infant_nbr,\r\n        checkin: this.hasCheckIn,\r\n        identifier: this.room.identifier,\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { SharedPerson } from '@/models/booking.dto';\r\nimport moment from 'moment';\r\nimport { FactoryArg, MaskedRange } from 'imask';\r\n\r\nexport const defaultGuest: SharedPerson = {\r\n  id: -1,\r\n  full_name: '',\r\n  country_id: null,\r\n  dob: '',\r\n  id_info: {\r\n    type: {\r\n      code: null,\r\n      description: null,\r\n    },\r\n    number: '',\r\n  },\r\n  address: null,\r\n  alternative_email: null,\r\n  cci: null,\r\n  city: null,\r\n  country: undefined,\r\n  country_phone_prefix: null,\r\n  email: null,\r\n  first_name: '',\r\n  last_name: '',\r\n  mobile: null,\r\n  nbr_confirmed_bookings: 0,\r\n  notes: null,\r\n  password: null,\r\n  subscribe_to_news_letter: null,\r\n};\r\n/**Date of birth mask for room guests  with min */\r\nexport const dateMask: FactoryArg = {\r\n  mask: Date,\r\n  pattern: 'DD/MM/YYYY',\r\n  lazy: false,\r\n  min: new Date(1900, 0, 1),\r\n  max: new Date(),\r\n  format: date => moment(date).format('DD/MM/YYYY'),\r\n  parse: str => moment(str, 'DD/MM/YYYY').toDate(),\r\n  autofix: true,\r\n  placeholderChar: '_',\r\n  blocks: {\r\n    YYYY: {\r\n      mask: MaskedRange,\r\n      from: 1970,\r\n      to: new Date().getFullYear(),\r\n      placeholderChar: 'Y',\r\n    },\r\n    MM: {\r\n      mask: MaskedRange,\r\n      from: 1,\r\n      to: 12,\r\n      placeholderChar: 'M',\r\n    },\r\n    DD: {\r\n      mask: MaskedRange,\r\n      from: 1,\r\n      to: 31,\r\n      placeholderChar: 'D',\r\n    },\r\n  },\r\n};\r\n",":host {\r\n  display: block;\r\n  height: 100%;\r\n  position: relative;\r\n  text-align: start !important;\r\n}\r\n.id-select {\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  border-right-width: 0;\r\n}\r\n:host {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.guest-grid > * {\r\n  height: 100%;\r\n}\r\n\r\n.guests-labels {\r\n  display: none;\r\n}\r\n.guest_label {\r\n  width: 100px;\r\n  color: #6b6f82;\r\n}\r\n.sharing_persons_label {\r\n  display: none;\r\n}\r\n.loading-container {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n.guest_document input {\r\n  border-top-left-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n}\r\n.guests-labels *,\r\n.sharing_persons_label {\r\n  margin-bottom: 0.5rem;\r\n  padding-bottom: 0;\r\n}\r\n\r\n/*sm*/\r\n@media (min-width: 640px) {\r\n}\r\n\r\n/*md*/\r\n@media (min-width: 768px) {\r\n  .sharing_persons_label {\r\n    display: block;\r\n  }\r\n  .guest_country_picker {\r\n    margin-bottom: 3px;\r\n  }\r\n  .guest-grid {\r\n    display: grid;\r\n    grid-template-columns: 2fr 2fr 2fr 2fr 5fr;\r\n    gap: 0.5rem;\r\n    align-items: flex-start;\r\n  }\r\n\r\n  .guest_label,\r\n  .sharing_persons_heading,\r\n  .main_guest_heading {\r\n    display: none;\r\n  }\r\n}\r\n\r\n/*lg*/\r\n@media (min-width: 1024px) {\r\n}\r\n\r\n/*xl*/\r\n@media (min-width: 1280px) {\r\n}\r\n\r\n/*2xl*/\r\n@media (min-width: 1536px) {\r\n}\r\n","import { SharedPerson, ZIdInfo, ZSharedPerson, ZSharedPersons } from '@/models/booking.dto';\r\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Fragment, Prop, State, h } from '@stencil/core';\r\nimport moment from 'moment';\r\nimport { dateMask, defaultGuest } from './data';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { ICountry, IEntries } from '@/models/IBooking';\r\nimport { ZodError } from 'zod';\r\n@Component({\r\n  tag: 'ir-room-guests',\r\n  styleUrl: 'ir-room-guests.css',\r\n  scoped: true,\r\n})\r\nexport class IrRoomGuests {\r\n  /**\r\n   * The name of the room currently being displayed.\r\n   * Used to label the room in the user interface for clarity.\r\n   */\r\n  @Prop() roomName: string;\r\n\r\n  /**\r\n   * A unique identifier for the room.\r\n   * This is used to distinguish between rooms, especially when performing operations like saving or checking in guests.\r\n   */\r\n  @Prop() identifier: string;\r\n\r\n  /**\r\n   * An array of people sharing the room.\r\n   * Contains information about the {locales.entries.Lcz_MainGuest} and additional guests, such as their name, date of birth, {locales.entries.Lcz_Nationality}, and ID details.\r\n   */\r\n  @Prop() sharedPersons: SharedPerson[] = [];\r\n\r\n  /**\r\n   * The total number of guests for the room.\r\n   * Determines how many guest input forms to display in the UI.\r\n   */\r\n  @Prop() totalGuests: number = 0;\r\n\r\n  /**\r\n   * A list of available countries.\r\n   * Used to populate dropdowns for selecting the {locales.entries.Lcz_Nationality} of guests.\r\n   */\r\n  @Prop() countries: ICountry[];\r\n\r\n  /**\r\n   * A boolean indicating whether the room is in the process of being checked in.\r\n   * If true, additional actions like saving the room state as \"checked in\" are performed.\r\n   */\r\n  @Prop() checkIn: boolean;\r\n\r\n  /**\r\n   * The language used for displaying text content in the component.\r\n   * Defaults to English ('en'), but can be set to other supported languages.\r\n   */\r\n  @Prop() language: string = 'en';\r\n\r\n  /**\r\n   * A unique booking number associated with the room.\r\n   * This is used for backend operations like saving guest information or checking in the room.\r\n   */\r\n  @Prop() bookingNumber: string;\r\n\r\n  @State() guests: SharedPerson[] = [];\r\n  @State() idTypes: IEntries[] = [];\r\n  @State() error: Record<string, boolean> = {};\r\n  @State() isLoading: boolean;\r\n  @State() propertyCountry: ICountry;\r\n  @State() autoValidate = false;\r\n\r\n  @Event() closeModal: EventEmitter<null>;\r\n  @Event() resetBookingEvt: EventEmitter<null>;\r\n  @Event() updateRoomGuests: EventEmitter<{ identifier: string; guests: SharedPerson[] }>;\r\n\r\n  private bookingService = new BookingService();\r\n\r\n  componentWillLoad() {\r\n    this.init();\r\n    this.initializeGuests();\r\n  }\r\n\r\n  private async init() {\r\n    try {\r\n      this.isLoading = true;\r\n      const [country, idTypes] = await Promise.all([this.bookingService.getUserDefaultCountry(), this.bookingService.getSetupEntriesByTableName('_ID_TYPE')]);\r\n      this.idTypes = idTypes;\r\n      if (country) {\r\n        this.propertyCountry = this.countries.find(c => c.id === country.COUNTRY_ID);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  private initializeGuests(): void {\r\n    let guests = [];\r\n    if (this.totalGuests > this.sharedPersons.length) {\r\n      const defaultGuestsCount = this.totalGuests - this.sharedPersons.length;\r\n      guests = [\r\n        ...this.sharedPersons,\r\n        ...Array(defaultGuestsCount).fill({\r\n          ...defaultGuest,\r\n          id_info: {\r\n            ...defaultGuest.id_info,\r\n            type: {\r\n              code: this.idTypes[0]?.CODE_NAME || '001',\r\n              description: this.idTypes[0]?.CODE_VALUE_EN || '',\r\n            },\r\n            number: '',\r\n          },\r\n        }),\r\n      ];\r\n    } else {\r\n      guests = [...this.sharedPersons];\r\n    }\r\n    guests = guests.map(g => ({ ...g, dob: new Date(g.dob).getFullYear() === 1900 ? null : g.dob }));\r\n    this.guests = guests.map(g => ({ ...g, dob: g.dob ? moment(new Date(g.dob)).format('DD/MM/YYYY') : '', country_id: g.country ? g.country.id : null }));\r\n  }\r\n\r\n  private updateGuestInfo(index: number, params: Partial<SharedPerson>) {\r\n    const tempGuests = [...this.guests];\r\n    let tempGuest = tempGuests[index];\r\n    tempGuest = { ...tempGuest, ...params };\r\n    tempGuests[index] = tempGuest;\r\n    this.guests = [...tempGuests];\r\n  }\r\n\r\n  private async saveGuests() {\r\n    try {\r\n      this.error = {};\r\n      this.autoValidate = true;\r\n      ZSharedPersons.parse(this.guests);\r\n      await this.bookingService.handleExposedRoomGuests({\r\n        booking_nbr: this.bookingNumber,\r\n        identifier: this.identifier,\r\n        guests: this.guests.map(g => ({ ...g, dob: g.dob ? moment(g.dob, 'DD/MM/YYYY').format('YYYY-MM-DD') : null })),\r\n      });\r\n      if (this.checkIn) {\r\n        await this.bookingService.handleExposedRoomInOut({\r\n          booking_nbr: this.bookingNumber,\r\n          room_identifier: this.identifier,\r\n          status: '001',\r\n        });\r\n      }\r\n      this.closeModal.emit(null);\r\n      this.updateRoomGuests.emit({ identifier: this.identifier, guests: this.guests });\r\n      this.resetBookingEvt.emit();\r\n    } catch (error) {\r\n      console.log(error);\r\n      if (error instanceof ZodError) {\r\n        let errors = {};\r\n        error.issues.forEach(e => {\r\n          errors[e.path[1]] = true;\r\n        });\r\n        this.error = { ...errors };\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.isLoading) {\r\n      return (\r\n        <div class={'loading-container'}>\r\n          <ir-spinner></ir-spinner>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div class=\"h-100 d-flex flex-column\" style={{ minWidth: '300px' }}>\r\n        <ir-title class=\"px-1\" onCloseSideBar={() => this.closeModal.emit(null)} label={`Room ${this.roomName}`} displayContext=\"sidebar\"></ir-title>\r\n        <section class={'d-flex flex-column px-1 h-100 '}>\r\n          <div class=\"\">\r\n            <div class=\"guest-grid guests-labels\">\r\n              <p class=\"\">{locales.entries.Lcz_MainGuest}</p>\r\n              <p class=\"\"></p>\r\n              <p class=\" \">{locales.entries.Lcz_DOB}</p>\r\n              <p class=\"\">{locales.entries.Lcz_Nationality}</p>\r\n              <p class=\" \">{locales.entries.Lcz_Documents}</p>\r\n            </div>\r\n            <h5 class=\"main_guest_heading\">{locales.entries.Lcz_MainGuest}</h5>\r\n            {this.guests.map((guest, idx) => (\r\n              <Fragment>\r\n                {idx === 1 && (\r\n                  <div class=\"d-flex mx-0 px-0\">\r\n                    <h5 class=\"mx-0 px-0 sharing_persons_heading\">{locales.entries.Lcz_PersonsSharingRoom}</h5>\r\n                    <p class=\"mx-0 px-0 sharing_persons_label\">{locales.entries.Lcz_PersonsSharingRoom}</p>\r\n                  </div>\r\n                )}\r\n                <div key={idx} class=\"guest-grid\">\r\n                  <div class={'m-0 p-0 d-flex align-items-center h-100'}>\r\n                    <p class=\"guest_label\">First name</p>\r\n                    <ir-input-text\r\n                      class=\"flex-grow-1 h-100\"\r\n                      id={`first_name_${idx}`}\r\n                      zod={ZSharedPerson.pick({ first_name: true })}\r\n                      error={!!this.error['first_name']}\r\n                      autoValidate={this.autoValidate}\r\n                      wrapKey=\"first_name\"\r\n                      placeholder=\"First name\"\r\n                      onTextChange={e => this.updateGuestInfo(idx, { first_name: e.detail })}\r\n                      value={guest.first_name}\r\n                      maxLength={40}\r\n                    ></ir-input-text>\r\n                  </div>\r\n                  <div class={'m-0 p-0 d-flex align-items-center h-100'}>\r\n                    <p class=\"guest_label\">Last name</p>\r\n                    <ir-input-text\r\n                      maxLength={40}\r\n                      class=\"flex-grow-1 h-100\"\r\n                      id={`last_name_${idx}`}\r\n                      zod={ZSharedPerson.pick({ last_name: true })}\r\n                      error={!!this.error['last_name']}\r\n                      autoValidate={this.autoValidate}\r\n                      wrapKey=\"last_name\"\r\n                      placeholder=\"Last name\"\r\n                      onTextChange={e => this.updateGuestInfo(idx, { last_name: e.detail })}\r\n                      value={guest.last_name}\r\n                    ></ir-input-text>\r\n                  </div>\r\n                  <div class=\"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center\">\r\n                    <p class=\"guest_label\">{locales.entries.Lcz_DOB}</p>\r\n                    <ir-input-text\r\n                      class=\"flex-grow-1 h-100\"\r\n                      id={`dob_${idx}`}\r\n                      zod={ZSharedPerson.pick({ dob: true })}\r\n                      error={!!this.error['dob']}\r\n                      autoValidate={this.autoValidate}\r\n                      wrapKey=\"dob\"\r\n                      mask={dateMask}\r\n                      placeholder=\"\"\r\n                      onTextChange={e => {\r\n                        this.updateGuestInfo(idx, { dob: e.detail });\r\n                      }}\r\n                      value={guest.dob}\r\n                    ></ir-input-text>\r\n                  </div>\r\n                  <div class=\" m-0 p-0 d-flex align-items-center\">\r\n                    <p class=\"guest_label\">{locales.entries.Lcz_Nationality}</p>\r\n                    <div class=\"mx-0 flex-grow-1  h-100\">\r\n                      <ir-country-picker\r\n                        class=\"h-100\"\r\n                        propertyCountry={this.propertyCountry}\r\n                        id={`{locales.entries.Lcz_Nationality}_${idx}`}\r\n                        error={!!this.error['country_id'] && !guest.country_id}\r\n                        country={this.countries?.find(c => c.id?.toString() === guest.country?.id?.toString())}\r\n                        onCountryChange={e => this.updateGuestInfo(idx, { country_id: e.detail?.id?.toString() ?? null, country: e.detail })}\r\n                        countries={this.countries}\r\n                      ></ir-country-picker>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"flex-grow-1 m-0 p-0 d-flex align-items-center\">\r\n                    <p class=\"guest_label\">{locales.entries.Lcz_Documents}</p>\r\n                    <div class={' d-flex m-0 flex-grow-1 h-100'}>\r\n                      <ir-select\r\n                        selectForcedStyles={{\r\n                          borderTopRightRadius: '0px',\r\n                          borderBottomRightRadius: '0px',\r\n                          borderRight: '0',\r\n                        }}\r\n                        selectStyles={'rounded-top-0 rounded-bottom-0'}\r\n                        onSelectChange={e => {\r\n                          this.updateGuestInfo(idx, {\r\n                            id_info: {\r\n                              ...this.guests[idx].id_info,\r\n                              type: {\r\n                                code: e.detail,\r\n                                description: '',\r\n                              },\r\n                            },\r\n                          });\r\n                        }}\r\n                        selectedValue={guest.id_info.type.code}\r\n                        LabelAvailable={false}\r\n                        showFirstOption={false}\r\n                        data={this.idTypes?.map(t => ({ text: t[`CODE_VALUE_${this.language.toUpperCase()}`] ?? t[`CODE_VALUE_EN`], value: t.CODE_NAME }))}\r\n                      ></ir-select>\r\n                      <ir-input-text\r\n                        autoValidate={this.autoValidate}\r\n                        maxLength={18}\r\n                        placeholder=\"12345\"\r\n                        class=\"flex-grow-1 guest_document\"\r\n                        type=\"text\"\r\n                        inputForcedStyle={{ borderTopLeftRadius: '0px', borderBottomLeftRadius: '0px' }}\r\n                        value={guest.id_info.number}\r\n                        zod={ZIdInfo.pick({ number: true })}\r\n                        error={!!this.error['number']}\r\n                        wrapKey=\"number\"\r\n                        inputStyles=\"form-control\"\r\n                        onTextChange={e =>\r\n                          this.updateGuestInfo(idx, {\r\n                            id_info: {\r\n                              ...this.guests[idx].id_info,\r\n                              number: e.detail,\r\n                            },\r\n                          })\r\n                        }\r\n                      ></ir-input-text>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Fragment>\r\n            ))}\r\n          </div>\r\n          <div class={'d-flex flex-column flex-sm-row mt-3 action-buttons '}>\r\n            <ir-button\r\n              onClick={() => this.closeModal.emit(null)}\r\n              btn_styles=\"justify-content-center\"\r\n              class={`mb-1 mb-sm-0 flex-fill mr-sm-1`}\r\n              icon=\"\"\r\n              text={locales.entries.Lcz_Cancel}\r\n              btn_color=\"secondary\"\r\n            ></ir-button>\r\n\r\n            <ir-button\r\n              btn_styles=\"justify-content-center align-items-center\"\r\n              class={'m-0 flex-fill text-center'}\r\n              icon=\"\"\r\n              isLoading={isRequestPending('/Handle_Exposed_Room_Guests')}\r\n              text={this.checkIn ? locales.entries.Lcz_CheckIn : locales.entries.Lcz_Save}\r\n              btn_color=\"primary\"\r\n              onClickHandler={this.saveGuests.bind(this)}\r\n            ></ir-button>\r\n          </div>\r\n        </section>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","* {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n:host {\r\n  display: flex;\r\n  margin-bottom: 5px;\r\n  gap: 5px;\r\n}\r\n.label_title {\r\n  min-width: max-content;\r\n  padding: 0;\r\n  margin: 0;\r\n  font-weight: 600;\r\n}\r\n.ota-message-list {\r\n  margin: 0 3px;\r\n  padding: 0;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n  list-style: circle !important;\r\n}\r\n.ota-message-item {\r\n  width: 100%;\r\n  line-height: 1.5;\r\n  margin: 0;\r\n  padding: 0;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n}\r\n.ota-message-item::before {\r\n  content: '- ';\r\n  margin-right: 0.25rem;\r\n}\r\n\r\n.ota-visibility-toggle {\r\n  background: white;\r\n  color: var(--blue);\r\n  padding: 0;\r\n  margin: 0;\r\n  margin-left: 3px;\r\n  font-size: 12px;\r\n  border: 0;\r\n}\r\n.ota-visibility-toggle:hover {\r\n  color: #355270;\r\n}\r\n.ota-message-list {\r\n  margin: 0 3px;\r\n  padding: 0;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n  white-space: normal;\r\n  list-style: none;\r\n}\r\n.ota-message-item {\r\n  width: 100%;\r\n  line-height: 1.5;\r\n  margin: 0 0 0 1.2em; /* indent for dash */\r\n  padding: 0;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n  white-space: normal;\r\n  position: relative;\r\n}\r\n/* .ota-message-item::before {\r\n  content: '-';\r\n  position: absolute;\r\n  left: 0;\r\n} */\r\n","import { Component, Host, Prop, State, h } from '@stencil/core';\r\nimport { v4 } from 'uuid';\r\nimport { IOtaNotes } from '@/models/booking.dto';\r\nimport locales from '@/stores/locales.store';\r\n@Component({\r\n  tag: 'ota-label',\r\n  styleUrl: 'ota-label.css',\r\n  scoped: true,\r\n})\r\nexport class OtaLabel {\r\n  @Prop() label: string;\r\n  @Prop() remarks: IOtaNotes[];\r\n  @Prop() maxVisibleItems: number = 3;\r\n\r\n  @State() showAll: boolean = false;\r\n\r\n  toggleShowAll = () => {\r\n    this.showAll = !this.showAll;\r\n  };\r\n\r\n  render() {\r\n    if (!this.remarks) {\r\n      return null;\r\n    }\r\n\r\n    const displayedRemarks = this.showAll ? this.remarks : this.remarks.slice(0, this.maxVisibleItems);\r\n\r\n    return (\r\n      <Host>\r\n        <p class={'label_title'}>{this.label}</p>\r\n        <ul class=\"ota-message-list\">\r\n          {displayedRemarks.map((remark, index) => (\r\n            <li key={v4()} class=\"ota-message-item\">\r\n              {remark.statement}{' '}\r\n              {this.remarks.length > this.maxVisibleItems && index === displayedRemarks.length - 1 && (\r\n                <button class=\"ota-visibility-toggle\" onClick={this.toggleShowAll}>\r\n                  {this.showAll ? locales.entries.Lcz_ShowLess : locales.entries.Lcz_ShowMore}\r\n                </button>\r\n              )}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n        {/* Show toggle button if there are more remarks than `maxVisibleItems` */}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}