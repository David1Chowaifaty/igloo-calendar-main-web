import{r as e,c as t,h as i,F as a,H as o}from"./p-d239357b.js";import{l as s}from"./p-4e493fea.js";import{c as r}from"./p-99cb260a.js";import{h as n}from"./p-6c4ba7c0.js";import{i as l}from"./p-6fec77c0.js";import{B as d,b as c,s as h,m as p,o as b}from"./p-5295ca2d.js";import{z as f}from"./p-e7d273da.js";import{f as u,D as m}from"./p-aebe797b.js";import{I as y}from"./p-518eace5.js";import{B as g}from"./p-c65723d4.js";import{v as k}from"./p-4ed69de7.js";import"./p-c5894a47.js";import"./p-bf44a732.js";import"./p-fa7340f2.js";const v=".sc-igl-book-property-footer-h{width:100% !important;background:#000}";const D=v;const _=class{constructor(i){e(this,i);this.buttonClicked=t(this,"buttonClicked",7)}eventType;page;isEditOrAddRoomEvent;dateRangeData;isLoading;buttonClicked;isEventType(e){return e===this.eventType}editNext(e){if(this.isEventType("EDIT_BOOKING")){if(e==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton({label:e,type:t="button",disabled:a=false,isLoading:o,appearance:s,variant:r,value:n,form:l}){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("ir-custom-button",{type:t,form:l,size:"medium",loading:o,appearance:s,variant:r,disabled:a,onClickHandler:()=>{this.buttonClicked.emit({key:n})},class:"full-width"},e))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){if(this.page==="page_one"){return i(o,null,this.isEventType("EDIT_BOOKING")?i(a,null,this.renderButton({value:"cancel",label:s.entries.Lcz_Cancel,appearance:"filled",variant:"neutral"}),this.shouldRenderTwoButtons()&&this.renderButton({value:"next",label:`${s.entries.Lcz_Next}`,icon_name:"angles_right",variant:"brand",appearance:"accent"})):i(a,null,this.renderButton({value:"cancel",label:s.entries.Lcz_Cancel,appearance:"filled",variant:"neutral"}),this.shouldRenderTwoButtons()&&this.renderButton({value:"next",label:`${s.entries.Lcz_Next}`,icon_name:"angles_right",variant:"brand",appearance:"accent"})))}const e=r.checkin_enabled&&n(new Date(this.dateRangeData?.fromDate)).isSame(new Date,"day");return i(a,null,this.isEditOrAddRoomEvent?i(a,null,this.renderButton({value:"back",icon_position:"left",label:s.entries.Lcz_Back,icon_name:"angles_left",appearance:"filled",variant:"neutral"}),this.renderButton({value:"save",label:s.entries.Lcz_Save,isLoading:this.isLoading==="save",variant:"brand",appearance:"accent"})):i(a,null,this.renderButton({value:"back",icon_position:"left",label:s.entries.Lcz_Back,icon_name:"angles_left",appearance:"filled",variant:"neutral"}),this.renderButton({value:"book",type:"submit",form:"new_booking_form",label:s.entries.Lcz_Book,isLoading:this.isLoading==="book",variant:"brand",appearance:e?"outlined":"accent"}),e&&this.renderButton({type:"submit",form:"new_booking_form",value:"bookAndCheckIn",label:s.entries.Lcz_BookAndChekcIn,isLoading:this.isLoading==="bookAndCheckIn",variant:"brand",appearance:"accent"})))}};_.style=D;const x=".sc-igl-book-property-header-h{display:flex;flex-direction:column;text-align:start;gap:1rem}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}.fd-book-property__constraints-container.sc-igl-book-property-header,.fd-book-property__header-container.sc-igl-book-property-header{display:flex;flex-direction:column;gap:0.5rem;flex-wrap:wrap}@media (min-width: 768px){.fd-book-property__constraints-container.sc-igl-book-property-header,.fd-book-property__header-container.sc-igl-book-property-header{flex-direction:row;align-items:center}.fd-book-property__adults-select.sc-igl-book-property-header{width:100px}.fd-book-property__children-select.sc-igl-book-property-header{width:170px}}";const w=x;const B=class{constructor(i){e(this,i);this.splitBookingDropDownChange=t(this,"splitBookingDropDownChange",7);this.checkClicked=t(this,"checkClicked",7);this.buttonClicked=t(this,"buttonClicked",7);this.toast=t(this,"toast",7);this.spiltBookingSelected=t(this,"spiltBookingSelected",7);this.animateIrSelect=t(this,"animateIrSelect",7)}splitBookingId="";bookingData="";minDate;message;bookingDataDefaultDateRange;showSplitBookingOption=false;adultChildConstraints;splitBookings;dateRangeData;bookedByInfoData;defaultDaterange;propertyId;wasBlockedUnit;isLoading;bookings=[];splitBookingDropDownChange;checkClicked;buttonClicked;toast;spiltBookingSelected;animateIrSelect;autoValidate;bookingService=new d;adultAnimationContainer;async fetchExposedBookings(e){this.isLoading=true;this.bookings=await this.bookingService.fetchExposedBookings(e,this.propertyId,n(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),n(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"));this.isLoading=false}getSplitBookingList(){return i("ir-picker",{mode:"select-async",class:"sourceContainer",debounce:300,"onText-change":e=>{this.fetchExposedBookings(e.detail)},defaultValue:Object.keys(this.bookedByInfoData).length>1?this.bookedByInfoData.bookingNumber?.toString():"",value:Object.keys(this.bookedByInfoData).length>1?this.bookedByInfoData.bookingNumber?.toString():"",label:`${s.entries.Lcz_Tobooking}#`,placeholder:s.entries.Lcz_BookingNumber,loading:this.isLoading,"onCombobox-select":e=>{const t=this.bookings?.find((t=>t.booking_nbr?.toString()===e.detail.item.value));this.spiltBookingSelected.emit({key:"select",data:t})}},this.bookings?.map((e=>{const t=`${e.booking_nbr} ${e.guest.first_name} ${e.guest.last_name}`;return i("ir-picker-item",{value:e.booking_nbr?.toString(),label:t},t)})))}getSourceNode(){const{sources:e}=c.selects;return i("wa-select",{size:"small",placeholder:s.entries.Lcz_Source,value:c.bookingDraft.source?.id?.toString(),defaultValue:c.bookingDraft.source?.id,id:"xSmallSelect","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:t=>{h({source:e.find((e=>e.id===t.target.value))})}},e.map((e=>{if(e.type==="LABEL"){return i("small",null,e.description)}return i("wa-option",{value:e.id?.toString()},e.description)})))}getAdultChildConstraints(){const{adults:e,children:t}=c.bookingDraft.occupancy;return i(a,null,i("ir-validator",{value:e,schema:f.number().min(1),autovalidate:this.autoValidate},i("wa-select",{class:"fd-book-property__adults-select","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:e=>{h({occupancy:{children:t,adults:Number(e.target.value)}})},value:e?.toString(),defaultValue:e?.toString(),placeholder:s.entries.Lcz_AdultsCaption,size:"small"},Array.from(Array(this.adultChildConstraints.adult_max_nbr),((e,t)=>t+1)).map((e=>i("wa-option",{value:e?.toString()},e))))),this.adultChildConstraints.child_max_nbr>0&&i("wa-select",{class:"fd-book-property__children-select","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:t=>h({occupancy:{adults:e,children:Number(t.target.value)}}),defaultValue:t?.toString(),value:t?.toString(),placeholder:this.renderChildCaption(),size:"small"},Array.from(Array(this.adultChildConstraints.child_max_nbr),((e,t)=>t+1)).map((e=>i("wa-option",{value:e?.toString()},e)))))}renderChildCaption(){const e=this.adultChildConstraints.child_max_age;let t=s.entries.Lcz_Years;if(e===1){t=s.entries.Lcz_Year}return`${s.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${t}`}handleButtonClicked(){const{occupancy:e}=c.bookingDraft;if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:s.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=n(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const i=n(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const a=n(new Date(this.dateRangeData.fromDate));const o=n(new Date(this.dateRangeData.toDate));if(o.isBefore(i)||a.isAfter(t)){this.toast.emit({type:"error",title:`${s.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",n(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",n(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(Number(e.adults)===0){this.toast.emit({type:"error",title:s.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.autoValidate=true}else{this.buttonClicked.emit({key:"check"})}}else if(Number(e.adults)===0){this.autoValidate=true;this.toast.emit({type:"error",title:s.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(e){return this.bookingData.event_type===e}getMinDate(){if(this.isEventType("PLUS_BOOKING")){return n().add(-1,"months").startOf("month").format("YYYY-MM-DD")}if(this.wasBlockedUnit){return this.bookingData?.block_exposed_unit_props.from_date}return this.minDate}getMaxDate(){if(!this.bookingData?.block_exposed_unit_props){return undefined}return this.bookingData?.block_exposed_unit_props.to_date}render(){console.log(this.bookingData.event_type);const e=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return i(o,{key:"5727bb290f004ceae4a58e21d59e0bbb896e77d3"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),i("div",{key:"31e860800d56d1ba4cb2d0c6a87f59fa2800472a",class:`fd-book-property__header-container`},e&&this.getSourceNode(),i("igl-date-range",{key:"c1683f6c9a81fc729b2577d8ba2142ef5c0b8d67","data-testid":"date_picker",variant:"booking",dateLabel:s.entries.Lcz_Dates,maxDate:this.getMaxDate(),minDate:this.getMinDate(),disabled:this.isEventType("BAR_BOOKING")&&!this.wasBlockedUnit||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange}),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints(),i("ir-custom-button",{key:"ca0240c19f9dfbd380062b2494b2344896d79b40",loading:l("/Check_Availability"),variant:"brand",onClickHandler:()=>this.handleButtonClicked()},s.entries.Lcz_Check)),i("p",{key:"a795ce30283db2fe320d2f2141000513491ce763",class:"text-right message-label"},r.tax_statement))}};B.style=w;const I=".sc-igl-booking-form-h{display:flex;flex-direction:column}";const C=I;const O=class{constructor(i){e(this,i);this.dataUpdateEvent=t(this,"dataUpdateEvent",7);this.buttonClicked=t(this,"buttonClicked",7)}showPaymentDetails;currency;isEditOrAddRoomEvent;dateRangeData;bookingData;showSplitBookingOption;language;bookedByInfoData;propertyId;bedPreferenceType;selectedRooms;isLoading;countries;selectedGuestData;defaultGuestData;selectedBookedByData;guestData;selectedUnits={};dataUpdateEvent;buttonClicked;componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let e=0;const t={...this.selectedUnits};const i=(e,t,i,a)=>{if(i&&a===2){return e*t}return e};this.selectedUnits=t;this.guestData=[];this.selectedRooms.forEach(((a,o)=>{a.forEach((a=>{t[o]=a.selectedUnits;e+=a.totalRooms*i(a.rate,this.dateRangeData.dateDifference,a.isRateModified,a.rateType);for(let e=1;e<=a.totalRooms;e++){this.guestData.push({guestName:"",roomId:"",preference:"",...a})}}))}));this.bookingData.TOTAL_PRICE=e}handleOnApplicationInfoDataUpdateEvent(e,t){const i=e.detail;const a=`c_${i.data.roomCategoryId}`;const o=[...this.selectedUnits[a]||[]];o[t]=i.data.roomId;this.selectedUnits={...this.selectedUnits,[a]:o};this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:e.detail})}handleEventData(e,t,i){if(t==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(e,i)}else{this.selectedBookedByData=e.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:e.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const e of this.selectedGuestData){if(e.guestName===""||e.preference===""||e.roomId===""){return true}}return false}isButtonDisabled(e){const t=(e,t,i)=>{if(!e){return true}if(e===this.selectedGuestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return this.isLoading===e||t(this.selectedGuestData,"guestName","")||t(this.selectedBookedByData,"isdCode","")||t(this.selectedBookedByData,"contactNumber","")||t(this.selectedBookedByData,"firstName","")||t(this.selectedBookedByData,"lastName","")||t(this.selectedBookedByData,"countryId",-1)||t(this.selectedBookedByData,"selectedArrivalTime","")||t(this.selectedBookedByData,"email","")}render(){return i("form",{key:"7a71b66c015464ad2eff70981513934ab4b13c41",class:"d-flex flex-column h-100",id:"new_booking_form",autoComplete:"off",onSubmit:e=>{e.preventDefault()}},i("div",{key:"48b4fad422ecbf8ed930a3ab788b9b27a043d692",class:"d-flex flex-wrap"},i("ir-date-view",{key:"7bcf7d0a00f94f684d37c23771db0658ada5d8c8",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{key:"e6f1b78e846f8a6712ca82c14ae6a117b072c01e",class:"mt-1 mt-md-0 text-right"},s.entries.Lcz_TotalPrice," ",i("span",{key:"5af28b859764b75cef65582a368f28ccb813989a",class:"font-weight-bold font-medium-1"},u(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(c.ratePlanSelections).map((e=>Object.values(e).map((e=>{const t=e;if(t.reserved===0){return null}return[...new Array(t.reserved)].map(((e,a)=>i("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:t.guest?t.guest[a]:null,bookingType:this.bookingData.event_type,rateplanSelection:t,key:`${t.ratePlan.id}_${a}`,roomIndex:a,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countries:this.countries,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:e=>{this.handleEventData(e,"propertyBookedBy",0)}}))}};O.style=C;const Y=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const M=Y;const N=class{constructor(i){e(this,i);this.roomsDataUpdate=t(this,"roomsDataUpdate",7)}bookingData;propertyId;message;showSplitBookingOption;eventType;currency;adultChildConstraints;ratePricingMode;dateRangeData;defaultDaterange;selectedRooms;bookedByInfoData;initialRoomIds;wasBlockedUnit;roomsDataUpdate;getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(e){return e===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return n().format("YYYY-MM-DD")}const e=n(this.bookingData.FROM_DATE,"YYYY-MM-DD");const t=n();if(e.isAfter(t)){return t.add(-2,"weeks").format("YYYY-MM-DD")}return e.add(-2,"weeks").format("YYYY-MM-DD")}render(){return i(o,{key:"ede53c96f098aafcd1eecacfd216b9bcccc83346"},i("igl-book-property-header",{key:"d55f688d9a689ad7ef5091a54962837b5acbfc23",wasBlockedUnit:this.wasBlockedUnit,bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"48b916935883fb79949fc71368a1ba0c25f992d5",class:" text-left"},l("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(a,null,c.roomTypes?.map((e=>i("igl-room-type",{isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-type-${e.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,bookingType:this.bookingData.event_type,roomType:e,class:"mt-2 mb-1 p-0","data-testid":`room_type_${e.id}`,id:e.id.toString(),roomTypeId:this.selectedRooms.has(`c_${e.id}`)?e.id:null}))))))}};N.style=M;const T=".sc-igl-property-booked-by-h{display:block}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.row.sc-igl-booking-form.sc-igl-property-booked-by{padding:0 !important}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.property-booked-by__money-transfer-description.sc-igl-property-booked-by *.sc-igl-property-booked-by{margin:0 !important;margin-bottom:0 !important;margin-top:0 !important}.property-booked-by__money-transfer-description.sc-igl-property-booked-by,.property-booked-by__money-transfer-description.sc-igl-property-booked-by .sc-igl-property-booked-by:where(*,*.sc-igl-property-booked-by::before,*.sc-igl-property-booked-by::after){margin:0.5rem !important}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}.fd-property-booked-by__guest-form.sc-igl-property-booked-by{display:grid;padding:0;box-sizing:border-box;gap:0.5rem;width:100%;flex:1 1 0%}";const E=T;const S=class{constructor(i){e(this,i);this.dataUpdateEvent=t(this,"dataUpdateEvent",7)}language;showPaymentDetails=false;defaultData;countries=[];propertyId;isButtonPressed=false;bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""};guests;typedEmail;dataUpdateEvent;bookingService=new d;arrivalTimeList=[];currentMonth="01";country;paymentMethods=[];pickerRef;componentWillLoad(){this.assignCountryCode();this.initializeDateData();this.populateBookedByData();this.paymentMethods=r.property.allowed_payment_methods.filter((e=>e.is_active&&!e.is_payment_gateway));if(this.paymentMethods.length>0){p("selectedPaymentMethod",{code:this.paymentMethods[0].code})}}handleButtonClicked(e){switch(e.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}async assignCountryCode(){const e=await this.bookingService.getUserDefaultCountry();const t=e["COUNTRY_ID"];this.country=t;const i=this.countries.find((e=>e.id?.toString()===t?.toString()));this.bookedByData={...this.bookedByData,isdCode:i.phone_prefix.toString(),countryId:t}}initializeDateData(){const e=new Date;const t=e.getMonth()+1;this.currentMonth=t<10?`0${t}`:t.toString()}populateBookedByData(){this.bookedByData=this.defaultData?{...this.bookedByData,...this.defaultData}:{};this.arrivalTimeList=this.defaultData?.arrivalTime||[];this.bookedByData={...this.bookedByData,selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME};if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}}handleDataChange(e,t){this.bookedByData={...this.bookedByData,[e]:e==="emailGuest"?t.target.checked:t.target.value};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}});if(e==="firstName"||e==="lastName"){b(true)}if(e==="countryId"){this.bookedByData={...this.bookedByData,isdCode:t.target.value}}}handleCreditCardDataChange(e,t){this.bookedByData[e]=t;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}});if(e==="countryId"){this.bookedByData={...this.bookedByData,isdCode:t}}}handleCountryChange(e){const t=this.countries?.find((t=>t.id===e));this.bookedByData={...this.bookedByData,isdCode:this.bookedByData?.contactNumber?this.bookedByData?.isdCode:t?.phone_prefix,countryId:e};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}})}updateGuest(e){p("checkout_guest",{...c.checkout_guest??{},...e})}handleComboboxSelect(e){const t=this.guests?.find((t=>t.id?.toString()===e.detail.item.value));if(!t){console.warn(`guest not found with id ${e.detail.item.value}`);return}this.bookedByData.email=t.email;this.bookedByData={...this.bookedByData,id:t.id,firstName:t.first_name,lastName:t.last_name,contactNumber:t.mobile_without_prefix,countryId:t.country_id,isdCode:t["country_phone_prefix"]??t?.country_id};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}clearEvent(){this.bookedByData={...this.bookedByData,id:"",firstName:"",lastName:"",contactNumber:"",email:"",isdCode:this.country.toString(),countryId:this.country};b(false);this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}})}async fetchGuests(e){this.typedEmail=e;this.guests=await this.bookingService.fetchExposedGuest(e,this.propertyId)}get expiryDate(){const{expiryMonth:e,expiryYear:t}=this.bookedByData;if(!e||!t){return""}const i=t.toString().length===4?t.toString().slice(-2):t.toString();return`${e}/${i}`}render(){return i(o,{key:"54a2ce466f35cc55ea549a750168266a75cd636c"},i("div",{key:"323015f6415a175b6887cc39bc4da80b610355f8",class:"text-left mt-3"},i("div",{key:"a87d2f7f8c0b109b70331d2f81ce1a934c832197",class:"d-flex",style:{alignItems:"flex-end",gap:"0.5rem"}},i("ir-picker",{key:"9b17869a6e4e6c35d9028d583457942679fe5e55",class:"bookedByEmailContainer m-0 p-0",label:s.entries.Lcz_BookedBy,value:this.bookedByData.email,ref:e=>this.pickerRef=e,"aria-invalid":String(Boolean(this.isButtonPressed&&this.bookedByData.email!==""&&m(this.bookedByData.email))),withClear:true,"onText-change":e=>this.fetchGuests(e.detail),debounce:300,"onInput-picker-blurred":e=>{e.stopPropagation();e.stopImmediatePropagation();const t=this.typedEmail;if(this.bookedByData.email){return}if(this.guests.length===0){if(f.string().email().safeParse(t).success){this.bookedByData={...this.bookedByData,email:t}}else{this.clearEvent();this.pickerRef.clearInput()}}},"onCombobox-clear":e=>{e.stopImmediatePropagation();e.stopPropagation();this.clearEvent()},loading:l("/Fetch_Exposed_Guests"),placeholder:s.entries.Lcz_FindEmailAddress,mode:"select-async","onCombobox-select":this.handleComboboxSelect.bind(this)},this.guests?.map((e=>{const t=`${e.email} - ${e.first_name} ${e.last_name}`;return i("ir-picker-item",{label:t,value:e.id?.toString(),key:e.id},t)}))),i("div",{key:"6f2c15baa2446ecc02a6e52e0ec51c7e92b2e600",style:{paddingBottom:"0.5rem"}},i("wa-tooltip",{key:"284a003008ac27fe74bc63c495438b8c14b24f26",for:`main_guest-search-tooltip`},"Leave empty if email is unavailable"),i("wa-icon",{key:"a9c49b0b59f400084590732740828a1ff5e4c55c",name:"circle-info",id:`main_guest-search-tooltip`})))),i("div",{key:"2d851ae462bbe62c6a9054d9cb7c2a8c3909cbac",class:"bookedDetailsForm text-left mt-2 font-small-3 "},i("div",{key:"0e9446d26864243c29aa213d5d24e9afd763222a",class:"d-flex flex-column flex-md-row  justify-content-md-between ",style:{gap:"1rem"}},i("div",{key:"18c428d6574758d92815c2d49ab2e990a18df9c4",class:"fd-property-booked-by__guest-form "},i("ir-validator",{key:"9b4703fa5d8842f50d4612bbea64b639b08e6ce8",value:this.bookedByData.firstName,schema:g.shape.first_name},i("ir-input",{key:"1350b74d61d47c990bf894ecb7e597b96f3d5d97","onText-change":e=>{this.updateGuest({first_name:e.detail});this.handleDataChange("firstName",{target:{value:e.detail.trim()}})},defaultValue:this.bookedByData.firstName,value:this.bookedByData.firstName,label:s.entries.Lcz_FirstName,placeholder:s.entries.Lcz_FirstName,required:true,name:"last_name_custom",autocomplete:"family-name"})),i("ir-validator",{key:"89db40da34af5655fe96b72eea1e264af33c79a5",value:this.bookedByData.lastName,schema:g.shape.last_name},i("ir-input",{key:"7473ca9ded4707eddae83d7032ecd57ee2577d62","onText-change":e=>{this.updateGuest({last_name:e.detail});this.handleDataChange("lastName",{target:{value:e.detail.trim()}})},name:"first_name_custom",autocomplete:"given-name",defaultValue:this.bookedByData.lastName,value:this.bookedByData.lastName,label:s.entries.Lcz_LastName,placeholder:s.entries.Lcz_LastName,required:true})),i("ir-country-picker",{key:"8682a00b8f87c1e17d29cfd3dc1d7411ee69a931",label:s.entries.Lcz_Country,variant:"modern",testId:"main_guest_country",class:"flex-grow-1 m-0",onCountryChange:e=>this.handleCountryChange(e.detail.id),countries:this.countries,country:this.countries.find((e=>e.id===this.bookedByData.countryId))}),i("ir-mobile-input",{key:"3eb9cf8a6a17d09d1e2dba394212dacccdef628f",size:"small","onMobile-input-change":e=>{this.handleDataChange("contactNumber",{target:{value:e.detail.formattedValue}})},"onMobile-input-country-change":e=>this.handleDataChange("isdCode",{target:{value:e.detail.phone_prefix}}),value:this.bookedByData.contactNumber,countryCode:this.countries.find((e=>e.phone_prefix===this.bookedByData.isdCode))?.code,countries:this.countries}),i("wa-select",{key:"09510458fa71c4d7ee271e140ebb263d4e27834c",size:"small",label:s.entries.Lcz_YourArrivalTime,"data-testid":"arrival_time","aria-disabled":String(Boolean(this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code==="")),id:k(),defaultValue:this.arrivalTimeList[0].CODE_NAME,value:this.bookedByData.selectedArrivalTime.code,onchange:e=>this.handleDataChange("selectedArrivalTime",e)},this.arrivalTimeList.map((e=>i("wa-option",{value:e.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===e.CODE_NAME},e.CODE_VALUE_EN))))),i("div",{key:"019f5d7363c6515ba46b1ea048a331a29283d2f1",class:"p-0 flex-fill  ml-md-3 d-flex flex-column",style:{gap:"0.5rem"}},i("wa-textarea",{key:"d53e263df20d0b80143f0d8bf4a2ca5227fb0512",onchange:e=>this.handleDataChange("message",e),size:"small",value:this.bookedByData.message,defaultValue:this.bookedByData.message,label:s.entries.Lcz_AnyMessageForUs,rows:4}),this.paymentMethods.length>1&&i("wa-select",{key:"18e2ffb0d4ce01d3ce4ddd3364652b9dfa90124b",label:"Payment Method",size:"small",value:c?.selectedPaymentMethod?.code,onchange:e=>p("selectedPaymentMethod",{code:e.target.value})},this.paymentMethods.map((e=>i("wa-option",{value:e.code},e.description)))),c.selectedPaymentMethod?.code==="001"&&i(a,{key:"3082b74d778970b160e330a8aff2841c689bc139"},i("ir-input",{key:"b94bf35b95992aba6781bb535112c15f119045e4",value:this.bookedByData.cardNumber,defaultValue:this.bookedByData.cardNumber,"onText-change":e=>this.handleCreditCardDataChange("cardNumber",e.detail.trim()),label:s.entries.Lcz_CardNumber}),i("ir-input",{key:"5747d83aac43c80c8d413d3b61c3ad8ada5b20f3",value:this.bookedByData.cardHolderName,defaultValue:this.bookedByData.cardHolderName,"onText-change":e=>this.handleCreditCardDataChange("cardHolderName",e.detail.trim()),label:s.entries.Lcz_CardHolderName}),i("ir-input",{key:"3ffa0dd4307cbb3e3934302da543c47860394948","onText-change":e=>{const[t,i]=e.detail.split("/");this.handleCreditCardDataChange("expiryYear",t??"");this.handleCreditCardDataChange("expiryMonth",i??"")},value:this.expiryDate,mask:{mask:"MM/YY",placeholderChar:"_",blocks:{MM:{mask:y.MaskedRange,from:1,to:12,maxLength:2},YY:{mask:y.MaskedRange,from:(new Date).getFullYear()%100,to:(new Date).getFullYear()%100+20,maxLength:2}}},label:s.entries.Lcz_ExpiryDate})),c.selectedPaymentMethod?.code==="005"&&i("div",{key:"4c3147076a9c045ec7c098e4fc1eef06151c76c8",class:"form-group mt-md-1 mt-1 p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"185690bbdf2f0c1af1bddd6f51935f73238db93b",class:"p-0 m-0 margin3"}),i("div",{key:"7b5a77bde2e0a7d7f774903742eb93880e88ad38",class:"p-0 m-0  controlContainer flex-fill"},i("div",{key:"71a6070cdcd35e24a141e657b83eafecba8cd97b",class:"property-booked-by__money-transfer-description",innerHTML:this.paymentMethods.find((e=>e.code==="005"))?.localizables.find((e=>e.language.code.toLowerCase()==="en"))?.description}))),i("wa-checkbox",{key:"b78f1ec058ccc297f710dcb692684fcd71b669d9",checked:this.bookedByData.emailGuest,onchange:e=>this.handleDataChange("emailGuest",e)},s.entries.Lcz_EmailTheGuest)))))}};S.style=E;export{_ as igl_book_property_footer,B as igl_book_property_header,O as igl_booking_form,N as igl_booking_overview_page,S as igl_property_booked_by};
//# sourceMappingURL=p-057cc818.entry.js.map