import{h as n}from"./p-6c4ba7c0.js";import{z as t}from"./p-7fc0c3ea.js";import{c as o}from"./p-29b13e62.js";import{a as e}from"./p-bf44a732.js";import{l as i}from"./p-2fcb9a1f.js";import{c as a}from"./p-41fabaeb.js";const r={days:[],months:[],fromDate:"",toDate:"",disabled_cells:new Map};const{state:s,onChange:c}=a(r);async function d(n){const t=[];const o=await D();for(const e of n){for(const n of e.days){for(const e of n.room_types){u(e.physicalrooms,t,o)}}}return t}function u(n,t,o){for(const e of n){for(const n in e.calendar_cell){if(e.calendar_cell[n].Is_Available===false){f(e.calendar_cell[n],t,o)}}}}const l={"004":"BLOCKED","003":"BLOCKED-WITH-DATES","002":"BLOCKED"};const _={"000":"IN-HOUSE","001":"PENDING-CONFIRMATION","002":"CONFIRMED","003":"CHECKED-OUT"};function E(n,t){if(n===null&&t===null||!n)return"";if(!!t){return`${n!==null&&n!==void 0?n:""} , ${t!==null&&t!==void 0?t:""}`}return n}async function D(){try{const{data:n}=await e.post(`/Get_Setup_Entries_By_TBL_NAME_Multi`,{TBL_NAMES:["_STAY_STATUS"]});return n.My_Result.map((n=>({code:n.CODE_NAME,value:n.CODE_VALUE_EN})))}catch(n){console.log(n)}}function T(t,o,e){const a=new Date(t);a.setHours(o);a.setMinutes(e);return`${i.entries.Lcz_BlockedTill} ${n(a).format("MMM DD, HH:mm")}`}function O(t,o){var e,i,a,r,s,c,d,u,D,O;if(U(t.STAY_STATUS_CODE)){const e=n(t.My_Block_Info.from_date,"YYYY-MM-DD").isAfter(t.DATE)?t.My_Block_Info.from_date:t.DATE;const i=n(t.My_Block_Info.to_date,"YYYY-MM-DD").isAfter(t.DATE)?t.My_Block_Info.to_date:t.DATE;return{ID:t.POOL,NOTES:"",BALANCE:"",NAME:t.My_Block_Info.NOTES!==""?t.My_Block_Info.NOTES:t.STAY_STATUS_CODE==="003"?T(t.My_Block_Info.BLOCKED_TILL_DATE,t.My_Block_Info.BLOCKED_TILL_HOUR,t.My_Block_Info.BLOCKED_TILL_MINUTE):o.find((n=>n.code===t.STAY_STATUS_CODE)).value||"",RELEASE_AFTER_HOURS:t.My_Block_Info.DESCRIPTION,PR_ID:t.My_Block_Info.pr_id,ENTRY_DATE:t.My_Block_Info.BLOCKED_TILL_DATE,ENTRY_HOUR:t.My_Block_Info.BLOCKED_TILL_HOUR,ENTRY_MINUTE:t.My_Block_Info.BLOCKED_TILL_MINUTE,OPTIONAL_REASON:t.My_Block_Info.NOTES,FROM_DATE:e,TO_DATE:i,NO_OF_DAYS:C(e,i),STATUS:l[t.STAY_STATUS_CODE],POOL:t.POOL,STATUS_CODE:t.STAY_STATUS_CODE,OUT_OF_SERVICE:t.STAY_STATUS_CODE==="004",FROM_DATE_STR:t.My_Block_Info.format.from_date,TO_DATE_STR:t.My_Block_Info.format.to_date,defaultDates:{from_date:t.My_Block_Info.from_date,to_date:t.My_Block_Info.to_date}}}const Y=n(t.room.from_date,"YYYY-MM-DD").isAfter(t.DATE)?t.room.from_date:t.DATE;const f=n(t.room.to_date,"YYYY-MM-DD").isAfter(t.DATE)?t.room.to_date:t.DATE;const A=(e=t.room.sharing_persons)===null||e===void 0?void 0:e.find((n=>n.is_main));return{ID:t.POOL,FROM_DATE:Y,TO_DATE:f,NO_OF_DAYS:C(Y,f),STATUS:_[(i=t.booking)===null||i===void 0?void 0:i.status.code],NAME:E(A===null||A===void 0?void 0:A.first_name,A===null||A===void 0?void 0:A.last_name),IDENTIFIER:t.room.identifier,PR_ID:t.pr_id,POOL:t.POOL,BOOKING_NUMBER:t.booking.booking_nbr,NOTES:t.booking.is_direct?t.booking.remark:null,PRIVATE_NOTE:N(t.booking.extras),is_direct:t.booking.is_direct,BALANCE:(a=t.booking.financial)===null||a===void 0?void 0:a.due_amount,channel_booking_nbr:t.booking.channel_booking_nbr,ARRIVAL_TIME:t.booking.arrival.description,defaultDates:{from_date:t.room.from_date,to_date:t.room.to_date},ENTRY_DATE:t.booking.booked_on.date,PHONE_PREFIX:t.booking.guest.country_phone_prefix,IS_EDITABLE:t.booking.is_editable,ARRIVAL:t.booking.arrival,PHONE:(r=t.booking.guest.mobile_without_prefix)!==null&&r!==void 0?r:"",RATE:t.room.total,RATE_PLAN:t.room.rateplan.name,SPLIT_BOOKING:false,RATE_PLAN_ID:t.room.rateplan.id,RATE_TYPE:(c=(s=t.room)===null||s===void 0?void 0:s.roomtype)===null||c===void 0?void 0:c.id,ADULTS_COUNT:t.room.occupancy.adult_nbr,CHILDREN_COUNT:t.room.occupancy.children_nbr,origin:t.booking.origin,GUEST:t.booking.guest,ROOMS:t.booking.rooms,cancelation:t.room.rateplan.cancelation,guarantee:t.room.rateplan.guarantee,TOTAL_PRICE:(d=t.booking.financial)===null||d===void 0?void 0:d.gross_total,COUNTRY:t.booking.guest.country_id,FROM_DATE_STR:t.booking.format.from_date,TO_DATE_STR:t.booking.format.to_date,adult_child_offering:t.room.rateplan.selected_variation.adult_child_offering,SOURCE:{code:t.booking.source.code,description:t.booking.source.description,tag:t.booking.source.tag},CHECKIN:((u=t.room.in_out)===null||u===void 0?void 0:u.code)==="001",CHECKOUT:((D=t.room.in_out)===null||D===void 0?void 0:D.code)==="002",ROOM_INFO:{occupancy:t.room.occupancy,sharing_persons:t.room.sharing_persons,unit:t.room.unit,in_out:t.room.in_out},BASE_STATUS_CODE:(O=t.booking.status)===null||O===void 0?void 0:O.code}}function Y(t){var e,i;const{in_out:a,status_code:r,from_date:s,to_date:c}=t;if(o.checkin_enabled){if((a===null||a===void 0?void 0:a.code)==="001"){return _["000"]}else if((a===null||a===void 0?void 0:a.code)==="002"){if(!o.is_automatic_check_in_out){const t=n();const a=n(c,"YYYY-MM-DD");const r=n(s,"YYYY-MM-DD");const d=R(t.toDate(),S((e=o.checkin_checkout_hours)===null||e===void 0?void 0:e.offset,(i=o.checkin_checkout_hours)===null||i===void 0?void 0:i.hour));if(t.isSame(a,"days")&&t.isAfter(r,"days")&&d||t.isAfter(a,"days")){return _["003"]}else{return _["002"]}}}return _[r||"001"]}else{const t=n();const o=n(c,"YYYY-MM-DD");const e=n(s,"YYYY-MM-DD");if(r!=="PENDING"){if(e.isSame(t,"day")&&t.hour()>=12){return _["000"]}else if(t.isAfter(e,"day")&&t.isBefore(o,"day")){return _["000"]}else if(o.isSame(t,"day")&&t.hour()<12){return _["000"]}else if(o.isSame(t,"day")&&t.hour()>=12||o.isBefore(t,"day")){return _["003"]}else{return _[r||"001"]}}}}function f(n,t,o){const e=t.findIndex((t=>t.POOL===n.POOL));if(e===-1){const e=O(n,o);t.push(e)}}function N(n){var t;if(!n){return null}return((t=n.find((n=>n.key==="private_note")))===null||t===void 0?void 0:t.value)||null}function A(t){let o=[];const e=t.rooms.filter((n=>!!n["assigned_units_pool"]));e.forEach((e=>{var i,a,r,c,d,u;const l=n(e.from_date,"YYYY-MM-DD").isAfter(n(s.fromDate,"YYYY-MM-DD"))?e.from_date:s.fromDate;const _=e.to_date;if(n(e.to_date,"YYYY-MM-DD").isBefore(n(s.fromDate,"YYYY-MM-DD"))){return}const D=(i=e.sharing_persons)===null||i===void 0?void 0:i.find((n=>n.is_main));o.push({CHECKIN:false,CHECKOUT:false,ID:e["assigned_units_pool"],TO_DATE:_,FROM_DATE:l,PRIVATE_NOTE:N(t.extras),NO_OF_DAYS:C(l,_),ARRIVAL:t.arrival,IS_EDITABLE:true,BALANCE:(a=t.financial)===null||a===void 0?void 0:a.due_amount,STATUS:Y({in_out:e.in_out,from_date:e.from_date,to_date:e.to_date,status_code:(r=t.status)===null||r===void 0?void 0:r.code}),NAME:E(D===null||D===void 0?void 0:D.first_name,D.last_name),PHONE:(c=t.guest.mobile_without_prefix)!==null&&c!==void 0?c:"",ENTRY_DATE:"12-12-2023",PHONE_PREFIX:t.guest.country_phone_prefix,RATE:e.total,RATE_PLAN:e.rateplan.name,SPLIT_BOOKING:false,RATE_PLAN_ID:e.rateplan.id,IDENTIFIER:e.identifier,RATE_TYPE:e.roomtype.id,ADULTS_COUNT:e.occupancy.adult_nbr,CHILDREN_COUNT:e.occupancy.children_nbr,PR_ID:+e.unit.id,POOL:e["assigned_units_pool"],GUEST:t.guest,ROOMS:t.rooms,BOOKING_NUMBER:t.booking_nbr,cancelation:e.rateplan.cancelation,guarantee:e.rateplan.guarantee,TOTAL_PRICE:(d=t.financial)===null||d===void 0?void 0:d.gross_total,COUNTRY:t.guest.country_id,FROM_DATE_STR:t.format.from_date,TO_DATE_STR:t.format.to_date,adult_child_offering:e.rateplan.selected_variation.adult_child_offering,ARRIVAL_TIME:t.arrival.description,origin:t.origin,channel_booking_nbr:t.channel_booking_nbr,is_direct:t.is_direct,NOTES:t.is_direct?t.remark:null,SOURCE:{code:t.source.code,description:t.source.description,tag:t.source.tag},ota_notes:t.ota_notes,defaultDates:{from_date:e.from_date,to_date:e.to_date},ROOM_INFO:{occupancy:e.occupancy,sharing_persons:e.sharing_persons,unit:e.unit,in_out:e.in_out},BASE_STATUS_CODE:(u=t.status)===null||u===void 0?void 0:u.code})}));return o}async function M(n){const t=await D();return{ID:n.POOL,NOTES:"",BALANCE:"",NAME:n.NOTES!==""?n.NOTES:n.STAY_STATUS_CODE==="003"?T(n.BLOCKED_TILL_DATE,n.BLOCKED_TILL_HOUR,n.BLOCKED_TILL_MINUTE):t.find((t=>t.code===n.STAY_STATUS_CODE)).value||"",RELEASE_AFTER_HOURS:n.DESCRIPTION,PR_ID:n.pr_id,ENTRY_DATE:n.BLOCKED_TILL_DATE,ENTRY_HOUR:n.BLOCKED_TILL_HOUR,ENTRY_MINUTE:n.BLOCKED_TILL_MINUTE,OPTIONAL_REASON:n.NOTES,FROM_DATE:n.from_date,TO_DATE:n.to_date,NO_OF_DAYS:I(n.from_date,n.to_date),STATUS:l[n.STAY_STATUS_CODE],POOL:n.POOL,STATUS_CODE:n.STAY_STATUS_CODE,OUT_OF_SERVICE:n.STAY_STATUS_CODE==="004",FROM_DATE_STR:n.format.from_date,TO_DATE_STR:n.format.to_date,defaultDates:{from_date:n.from_date,to_date:n.to_date}}}function I(t,o){const e=n(t,"YYYY-MM-DD").startOf("day");const i=n(o,"YYYY-MM-DD").endOf("day");const a=i.diff(e,"days");return a||1}function R(n,t){return n.getHours()>=t.getHours()&&n.getMinutes()>=t.getMinutes()}function S(n,t){const o=new Date;const e=n*60*60*1e3;const i=new Date(o.getTime()+e);const a=i.getUTCFullYear();const r=i.getUTCMonth();const s=i.getUTCDate();const c=t-n;return new Date(Date.UTC(a,r,s,c))}function v(t,o,e="D_M_YYYY"){const i=`${t.split(" ")[1]} ${o}`;const a=n(i,"DD MMM YYYY");if(!a.isValid()){throw new Error("Invalid Date")}return a.format(e)}function m(t,o){const e=n(t+" "+o,"ddd DD MMM YYYY").toDate();e.setHours(0,0,0,0);return e.getTime()}function C(n,t){const o=new Date(n);const e=new Date(t);return Math.ceil((e.getTime()-o.getTime())/(1e3*60*60*24))}function L(n){const t=n.getFullYear();const o=(n.getMonth()+1).toString().padStart(2,"0");const e=n.getDate().toString().padStart(2,"0");return`${t}-${o}-${e}`}function p(n){let t={};const o={"IN-HOUSE":{id:1,clsName:"IN_HOUSE"},CONFIRMED:{id:2,clsName:"CONFIRMED"},"PENDING-CONFIRMATION":{id:3,clsName:"PENDING_CONFIRMATION"},"SPLIT-UNIT":{id:4,clsName:"SPLIT_UNIT"},"CHECKED-IN":{id:5,clsName:"CHECKED_IN"},"CHECKED-OUT":{id:5,clsName:"CHECKED_OUT"},BLOCKED:{id:6,clsName:"BLOCKED"},"BLOCKED-WITH-DATES":{id:7,clsName:"BLOCKED_WITH_DATES"},NOTES:{id:8,clsName:"NOTES"},"OUTSTANDING-BALANCE":{id:9,clsName:"OUTSTANDING_BALANCE"},"TEMP-EVENT":{id:10,clsName:"PENDING_CONFIRMATION"}};n.forEach((n=>{t[n.id]=n;t.statusId=o}));return t}function U(n){return["003","002","004"].includes(n)}const y=(n,t)=>t.find((t=>t.id===n));function g(n){const t=new Date;const o=n;t.setHours(t.getHours()+o,t.getMinutes(),0,0);return{BLOCKED_TILL_DATE:L(t),BLOCKED_TILL_HOUR:t.getHours().toString(),BLOCKED_TILL_MINUTE:t.getMinutes().toString()}}function P(t,o){const e=n(t,"D_M_YYYY");e.add(o,"days");return e.format("YYYY-MM-DD")}function F(t){const o=n(t,"D_M_YYYY");return o.format("YYYY-MM-DD")}function h(t){return n(t).add(2,"months").format("YYYY-MM-DD")}function B(t,o="DD MMM YYYY"){const e=n(t,o).format("ddd, DD MMM YYYY");return e}function H(t){return n(t).add(1,"days").format("YYYY-MM-DD")}function b(t){return n(t,"YYYY-MM-DD").format("DD/MM ddd")}function K(t,o){let e=[];let i=n.min(n(t).add(1,"days"),n(o));let a=n.max(n(t),n(o));while(i<a){e.push(i.format("YYYY-MM-DD"));i=i.clone().add(1,"days")}return e}function w(n){return n<10?n.toString().padStart(2,"0"):n.toString()}function k(n){if(n===""){return true}const o=t.string().email().safeParse(n);return!o.success}function G(n,t){return n+" "+t.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})}const j=[{key:"private_note",value:""},{key:"is_backend",value:true},{key:"ERROR_EMAIL",value:""},{key:"agent_payment_mode",value:""},{key:"payment_code",value:""}];function x(n,t="add"){const o=JSON.parse(sessionStorage.getItem("backend_anchor"));if(o){if(t==="add"){return sessionStorage.setItem("backend_anchor",JSON.stringify(Object.assign(Object.assign({},o),n)))}else if(t==="remove"){const t=Object.keys(n);t.forEach((n=>{if(n in o){delete o[n]}}));return sessionStorage.setItem("backend_anchor",JSON.stringify(o))}}else{if(t==="add"){return sessionStorage.setItem("backend_anchor",JSON.stringify(Object.assign({},n)))}}}function V(){const n=JSON.parse(sessionStorage.getItem("backend_anchor"));if(n){return n.login||null}return null}function $({from_date:t,to_date:e,isCheckedIn:i}){var a,r;if(!o.checkin_enabled||o.is_automatic_check_in_out){return false}if(i){return false}const s=n();if(n().isSameOrAfter(new Date(t),"days")&&n().isBefore(new Date(e),"days")||n().isSame(new Date(e),"days")&&!R(s.toDate(),S((a=o.checkin_checkout_hours)===null||a===void 0?void 0:a.offset,(r=o.checkin_checkout_hours)===null||r===void 0?void 0:r.hour))){return true}return false}function J(n,t){const o=document.createElement("a");o.href=n;o.download=t||n;document.body.appendChild(o);o.click();document.body.removeChild(o)}function W(n,t){const o=Math.pow(10,t);return n/o}async function X(n=200){return new Promise((t=>setTimeout((()=>t(null)),n)))}function q(n){const t="data-ir-scroll-locked";let o=document.body.getAttribute(t);if(!document.getElementById("scroll-lock-style")){const n=document.createElement("style");n.id="scroll-lock-style";n.innerHTML=`\n      body:dir(ltr)[data-ir-scroll-locked] {\n        overflow: hidden !important;\n        overscroll-behavior: contain;\n        position: relative !important;\n        padding-left: 0px;\n        padding-top: 0px;\n        padding-right: 0px;\n        margin-left: 0;\n        margin-top: 0;\n        margin-right: 15px !important;\n      }\n      body:dir(rtl)[data-ir-scroll-locked] {\n        overflow: hidden !important;\n        overscroll-behavior: contain;\n        position: relative !important;\n        padding-left: 0px;\n        padding-top: 0px;\n        padding-right: 0px;\n        margin-right: 0;\n        margin-top: 0;\n        margin-left: 15px !important;\n      }\n    `;document.head.appendChild(n)}if(!o){document.body.setAttribute(t,"1")}else{const e=n?Number(o)+1:Number(o)-1;document.body.setAttribute(t,e.toString());if(e<=0){document.body.removeAttribute(t)}}}export{w as A,K as B,b as C,B as D,d as E,v as F,m as G,V as H,x as I,J,X as K,I as a,y as b,s as c,L as d,j as e,G as f,g,q as h,U as i,$ as j,R as k,S as l,C as m,p as n,E as o,Y as p,M as q,_ as r,N as s,A as t,H as u,k as v,h as w,F as x,P as y,W as z};
//# sourceMappingURL=p-792550e2.js.map