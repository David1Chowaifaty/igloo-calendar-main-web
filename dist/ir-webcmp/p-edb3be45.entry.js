import{r as e,c as t,h as i,F as s,H as a,g as o}from"./p-53d64953.js";import{a as n,B as r,m as c,c as l,r as d,d as h,e as p,b as f}from"./p-2b01cc1d.js";import{e as u,K as m,B as b,i as g,f as y,g as v,L as k,M as _,o as x}from"./p-61aaf60c.js";import{V as w}from"./p-39011dec.js";import{h as D}from"./p-6c4ba7c0.js";import{l as O}from"./p-71768c2d.js";import{a as C}from"./p-5b45ff50.js";import{c as T,i as Y}from"./p-00df8713.js";import{a as I}from"./p-bf44a732.js";import{R as E}from"./p-429a4d65.js";import{P as M}from"./p-9592e7ee.js";import{T as B}from"./p-a93581f3.js";import{c as S}from"./p-6b5b5b8a.js";import{z as j,Z as A,a as R}from"./p-b859bcd5.js";import{a as N,_ as L,b as z}from"./p-b2679b77.js";import{M as P}from"./p-518eace5.js";import{v as G}from"./p-4ed69de7.js";import"./p-a973aec7.js";var H=undefined&&undefined.__rest||function(e,t){var i={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0)i[s]=e[s];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++){if(t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a]))i[s[a]]=e[s[a]]}return i};class U{setBookingInfoFromAutoComplete(e,t){var i,s,a;e.bookedByInfoData={id:t.guest.id,email:t.guest.email,firstName:t.guest.first_name,lastName:t.guest.last_name,countryId:t.guest.country_id,isdCode:(s=(i=t.guest)===null||i===void 0?void 0:i.country_phone_prefix)!==null&&s!==void 0?s:(a=t.guest)===null||a===void 0?void 0:a.country_id.toString(),contactNumber:t.guest.mobile,selectedArrivalTime:t.arrival,emailGuest:t.guest.subscribe_to_news_letter,message:t.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:t.booking_nbr,rooms:t.rooms,from_date:t.from_date,to_date:t.to_date}}resetRoomsInfoAndMessage(e){e.defaultData.roomsInfo=[];e.message=""}onDataRoomUpdate(e,t,i,s,a){let o=t;const{data:n,key:r,changedKey:c}=e.detail;const l=`c_${n.roomCategoryId}`;const d=`p_${n.ratePlanId}`;if(this.shouldClearData(r)){o=new Map}this.initializeRoomCategoryIfNeeded(l,o);if(s){if(c==="rate"){if(o.has(l)&&o.get(l).has(d)){this.applyBookingEditToSelectedRoom(l,d,n,o,a,i)}}else{if(c!=="rateType"){if(c==="adult_child_offering"){if(o.has(l)&&t.get(l).has(d)){this.applyBookingEditToSelectedRoom(l,d,n,o,a,i)}}else{this.applyBookingEditToSelectedRoom(l,d,n,o,a,i)}}}}else{this.setSelectedRoomData(l,d,n,o)}this.cleanupEmptyData(l,o);return o}shouldClearData(e){return e==="clearData"||e==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(e,t){if(!t.has(e)){t.set(e,new Map)}}setSelectedRoomData(e,t,i,s){let a=s.get(e);if(i.totalRooms===0||i.inventory===0){a.delete(t)}else{s.set(e,a.set(t,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(e,t){if(t.has(e)){let i=t.get(e);if(i.size===0){t.delete(e)}}}applyBookingEditToSelectedRoom(e,t,i,s,a,o){s.clear();let n={};if(o){n=Object.assign(Object.assign({},i),{guestName:a||"",roomId:""})}else{n=Object.assign({},i)}s.set(e,(new Map).set(t,n))}calculateAmount({is_amount_modified:e,selected_variation:t,view_mode:i,rp_amount:s}){const a=t.nights.length;if(e){return i==="002"?s:s/a}}generateDailyRates(e,t){let i=e.selected_variation;const s=e.is_amount_modified?this.calculateAmount(e):null;if(e.guest[t].infant_nbr>0&&!e.is_amount_modified){if(!this.variationService){this.variationService=new w}i=this.variationService.getVariationBasedOnInfants({variations:e.ratePlan.variations,baseVariation:e.selected_variation,infants:e.guest[t].infant_nbr})}return i.nights.map((e=>({date:e.night,amount:s!==null&&s!==void 0?s:e.discounted_amount,cost:null})))}getBookedRooms({check_in:e,check_out:t,notes:i,identifier:s,override_unit:a,unit:o,auto_check_in:r}){var c,l;const d=[];for(const h in n.ratePlanSelections){const p=n.ratePlanSelections[h];for(const n in p){const h=p[n];if(h.reserved>0){for(let n=0;n<h.reserved;n++){const{first_name:p,last_name:f}=h.guest[n];d.push({identifier:s,roomtype:h.roomtype,rateplan:h.ratePlan,prepayment_amount_gross:0,unit:a?{id:o}:h.guest[n].unit?{id:h.guest[n].unit}:null,occupancy:{adult_nbr:h.selected_variation.adult_nbr,children_nbr:Number((c=h.selected_variation.child_nbr)!==null&&c!==void 0?c:0)-Math.max(Number((l=h.guest[n].infant_nbr)!==null&&l!==void 0?l:0),0),infant_nbr:h.guest[n].infant_nbr},bed_preference:h.guest[n].bed_preference,from_date:D(e).format("YYYY-MM-DD"),to_date:D(t).format("YYYY-MM-DD"),notes:i,check_in:r,days:this.generateDailyRates(h,n),guest:{email:null,first_name:p,last_name:f,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null,cci:null}})}}}}return d}async prepareBookUserServiceParams({context:e,sourceOption:t,check_in:i}){var s,a;try{if(!e||!e.dateRangeData){throw new Error("Invalid context: Missing date range data.")}const o=new Date(e.dateRangeData.fromDate);const n=new Date(e.dateRangeData.toDate);const r=(t=null,i=false)=>this.getBookedRooms({check_in:o,check_out:n,identifier:t,notes:"",override_unit:e.isEventType("BAR_BOOKING")?true:false,unit:e.isEventType("BAR_BOOKING")?e.bookingData.PR_ID:null,auto_check_in:i});const c=(e,t)=>{var{pickup_info:i,extra_services:s,is_direct:a,is_in_loyalty_mode:o,promo_key:n,extras:r}=e,c=H(e,["pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras"]);return{assign_units:true,is_pms:true,is_direct:a,is_backend:true,is_in_loyalty_mode:o,promo_key:n,extras:r,booking:Object.assign(Object.assign({},c),{rooms:t}),extra_services:s,pickup_info:i}};let l=null;switch(e.defaultData.event_type){case"EDIT_BOOKING":{const{booking:t,currentRoomType:i}=e.defaultData;const a=t.rooms.filter((e=>e.identifier!==i.identifier));console.log("currentRoomType",i);const o=r(i.identifier,((s=i.in_out)===null||s===void 0?void 0:s.code)==="001");l=c(t,[...a,...o]);break}case"ADD_ROOM":case"SPLIT_BOOKING":{const{booking:t,ROOMS:i}=e.defaultData;if(!t){throw new Error("Missing booking")}const s=r();const a=e.defaultData.event_type==="ADD_ROOM"?i!==null&&i!==void 0?i:[]:t===null||t===void 0?void 0:t.rooms;l=c(t,[...a,...s]);break}default:{const s=r(null,i);const{bookedByInfoData:c}=e;const d=t.type==="TRAVEL_AGENCY";l={assign_units:true,is_pms:true,is_direct:true,is_backend:true,is_in_loyalty_mode:false,promo_key:null,extras:u,agent:d?{id:t.tag}:null,booking:{from_date:D(o).format("YYYY-MM-DD"),to_date:D(n).format("YYYY-MM-DD"),remark:c.message||null,booking_nbr:"",property:{id:e.propertyid},booked_on:{date:D().format("YYYY-MM-DD"),hour:(new Date).getHours(),minute:(new Date).getMinutes()},source:d?"":t,rooms:s,currency:e.currency,arrival:{code:c.selectedArrivalTime},guest:{email:c.email===""?null:c.email||null,first_name:c.firstName,last_name:c.lastName,country_id:c.countryId===""?null:c.countryId,city:null,mobile:c.contactNumber===null?"":c.contactNumber,country_phone_prefix:(a=c===null||c===void 0?void 0:c.isdCode)!==null&&a!==void 0?a:null,address:"",dob:null,subscribe_to_news_letter:c.emailGuest||false,cci:c.cardNumber?{nbr:c.cardNumber,holder_name:c.cardHolderName,expiry_month:c.expiryMonth,expiry_year:c.expiryYear}:null}},pickup_info:null};break}}return l}catch(e){console.error(e)}}getRoomCategoryByRoomId(e){var t;return(t=e.roomsInfo)===null||t===void 0?void 0:t.find((t=>t.id===e.RATE_TYPE))}setEditingRoomInfo(e,t){const i=this.getRoomCategoryByRoomId(e);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const a=`p_${e.RATE_PLAN_ID}`;const o={adultCount:e.ADULTS_COUNT,rate:e.RATE,rateType:e.RATE_TYPE,ratePlanId:e.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:e.RATE_PLAN,roomId:e.PR_ID,guestName:e.NAME,cancelation:e.cancelation,guarantee:e.guarantee,adult_child_offering:e.adult_child_offering};t.set(s,(new Map).set(a,o))}}const F=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;min-height:100vh;z-index:99;overflow:hidden}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.loading-container.sc-igl-book-property{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;inset:0;left:unset;background-color:#ffffff;width:100%;overflow:auto;animation:slideInFromRight 0.5s}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.sheet-footer.sc-igl-book-property{width:100%}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}@keyframes slideInFromRight{from{transform:translateX(120%)}to{transform:translateX(0)}}@keyframes slideOutToRight{from{transform:translateX(0)}to{transform:translateX(120%)}}.sideWindow--exit.sc-igl-book-property{animation:slideOutToRight 0.5s forwards}";const K=F;const V=".sc-igl-book-property-h{height:100%}.sheet-container.sc-igl-book-property{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-igl-book-property{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-igl-book-property{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-igl-book-property{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-igl-book-property{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-igl-book-property{flex-direction:row;align-items:center}}";const W=V;const q=class{constructor(i){e(this,i);this.closeBookingWindow=t(this,"closeBookingWindow",7);this.blockedCreated=t(this,"blockedCreated",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.animateIrButton=t(this,"animateIrButton",7);this.animateIrSelect=t(this,"animateIrSelect",7);this.toast=t(this,"toast",7);this.showPaymentDetails=false;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.bookingHistory=[];this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new r;this.bookPropertyService=new U;this.updatedBooking=false;this.MAX_HISTORY_LENGTH=2}async componentWillLoad(){console.log("<==>roomtypes<==>",n===null||n===void 0?void 0:n.roomTypes);if(n.roomTypes){c("roomTypes",[]);c("ratePlanSelections",{})}this.handleKeyDown=this.handleKeyDown.bind(this);this.initializeDefaultDateRange();if(!this.bookingData.defaultDateRange){return}this.initializeDefaultData();this.wasBlockedUnit=this.defaultData.hasOwnProperty("block_exposed_unit_props");c("event_type",{type:this.defaultData.event_type});this.fetchSetupEntriesAndInitialize()}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown);m(true)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(e){if(this.isEventType("SPLIT_BOOKING")){e.stopImmediatePropagation();e.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(e){e.stopImmediatePropagation();e.stopPropagation();const{key:t,data:i}=e.detail;if(t==="select"||t==="blur"&&i!==""){const e=await this.bookingService.getExposedBooking(i.booking_nbr||i,this.language);this.defaultData=Object.assign(Object.assign({},this.defaultData),{booking:e});this.bookPropertyService.setBookingInfoFromAutoComplete(this,e);this.sourceOption=e.source;this.renderPage()}}handleAdultChildChange(e){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}const{adult:t,child:i}=e.detail;this.adultChildCount=Object.assign({},e.detail);this.updateBookingHistory({adults:Number(t),children:Number(i)})}onDateRangeSelect(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.updateBookingHistory({dates:{checkIn:new Date(this.dateRangeData.fromDate),checkOut:new Date(new Date(t.data.toDate))}});console.log("date changed",t);if(t.key==="selectedDateRange"){this.dateRangeData=t.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.checkBookingAvailability()}}}handleSourceDropDown(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;const i=this.sourceOptions.find((e=>e.id===t.toString()));this.sourceOption={code:t,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}gotoSplitPageTwo(){this.gotoPage("page_two")}handleButtonClicked(e){var t,i;switch(e.detail.key){case"save":this.bookUser(false);break;case"cancel":e.stopImmediatePropagation();e.stopPropagation();this.closeWindow();break;case"back":e.stopImmediatePropagation();e.stopPropagation();if(this.isEventType("BAR_BOOKING")){d()}this.gotoPage("page_one");break;case"book":this.bookUser(false);break;case"bookAndCheckIn":this.bookUser(true);break;case"next":e.stopImmediatePropagation();e.stopPropagation();if(!((t=this.adultChildCount)===null||t===void 0?void 0:t.adult)){this.animateIrSelect.emit("adult_child_select");break}if(l()>0){this.gotoPage("page_two");break}else if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}this.toast.emit({type:"error",description:O.entries.Lcz_SelectRatePlan,title:O.entries.Lcz_SelectRatePlan});break;case"check":this.checkBookingAvailability();break}}updateBookingHistory(e){var t,i,s,a,o,n,r,c;const l=this.bookingHistory[this.bookingHistory.length-1];const d={dates:{checkIn:((t=e.dates)===null||t===void 0?void 0:t.checkIn)||((i=l===null||l===void 0?void 0:l.dates)===null||i===void 0?void 0:i.checkIn)||new Date(this.dateRangeData.fromDate),checkOut:((s=e.dates)===null||s===void 0?void 0:s.checkOut)||((a=l===null||l===void 0?void 0:l.dates)===null||a===void 0?void 0:a.checkOut)||new Date(this.dateRangeData.toDate)},adults:(n=(o=e.adults)!==null&&o!==void 0?o:l===null||l===void 0?void 0:l.adults)!==null&&n!==void 0?n:this.adultChildCount.adult,children:(c=(r=e.children)!==null&&r!==void 0?r:l===null||l===void 0?void 0:l.children)!==null&&c!==void 0?c:this.adultChildCount.child};this.bookingHistory.push(d);if(this.bookingHistory.length>this.MAX_HISTORY_LENGTH){this.bookingHistory.shift()}}handleKeyDown(e){if(e.key==="Escape"){this.closeWindow()}}initializeDefaultDateRange(){this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE}}initializeDefaultData(){this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange)}async fetchSetupEntriesAndInitialize(){try{const e=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(e);this.initializeEventData()}catch(e){console.error("Error fetching setup entries:",e)}}initializeEventData(){if(this.isEventType("EDIT_BOOKING")){this.initializeEditBookingData()}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.initializePage()}initializeEditBookingData(){var e,t,i,s,a;this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};const{currentRoomType:o,GUEST:n}=this.defaultData;console.log(n);c("guest",{bed_preference:(e=o.bed_preference)===null||e===void 0?void 0:e.toString(),infant_nbr:o.occupancy.infant_nbr,first_name:(t=n.first_name)!==null&&t!==void 0?t:"",last_name:(i=n.last_name)!==null&&i!==void 0?i:"",unit:(a=(s=o.unit)===null||s===void 0?void 0:s.id)===null||a===void 0?void 0:a.toString()});this.checkBookingAvailability();this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}initializePage(){switch(this.defaultData.event_type){case"SPLIT_BOOKING":this.showSplitBookingOption=true;this.page="page_one";break;case"BLOCK_DATES":this.page="page_block_date";break;default:this.page="page_one";break}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){for(const e in n.ratePlanSelections){const t=n.ratePlanSelections[e];for(const e in t){const i=t[e];if(i.reserved>0){for(const e of i.guest){if(e.first_name===""||e.last_name===""){return true}}}}}return false}isButtonDisabled(){const e=(e,t,i)=>{if(!e){return true}if(e===this.guestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return e(this.guestData,"guestName","")||e(this.bookedByInfoData,"firstName","")||e(this.bookedByInfoData,"lastName","")||e(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(e){this.sourceOptions=e.map((e=>({id:e.id,value:e.description,tag:e.tag,type:e.type})));this._sourceOptions=this.isEventType("BAR_BOOKING")?this.getFilteredSourceOptions():this.sourceOptions;if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{let e=this._sourceOptions.find((e=>e.type!=="LABEL"));console.log({option:e});this.sourceOption={code:e.code,description:e.description,tag:e.tag,type:e.type,id:e.id}}}getFilteredSourceOptions(){var e,t,i,s;const a=new Set;const o=(i=(t=(e=this.bookingData)===null||e===void 0?void 0:e.roomsInfo)===null||t===void 0?void 0:t.some((e=>{var t;const i=(t=e===null||e===void 0?void 0:e.rateplans)!==null&&t!==void 0?t:[];if(i.length===0)return false;const s=i.every((e=>{var t,i;return((i=(t=e===null||e===void 0?void 0:e.agents)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0)>0}));if(s){i.forEach((e=>{var t;((t=e===null||e===void 0?void 0:e.agents)!==null&&t!==void 0?t:[]).forEach((e=>{var t;return a.add((t=e===null||e===void 0?void 0:e.id)===null||t===void 0?void 0:t.toString())}))}))}return s})))!==null&&i!==void 0?i:false;if(!o){return this.sourceOptions}return((s=this.sourceOptions)!==null&&s!==void 0?s:[]).filter((e=>{if((e===null||e===void 0?void 0:e.type)==="LABEL")return true;const t=e===null||e===void 0?void 0:e.tag;const i=t!=null&&a.has(t);return i}))}setOtherProperties(e){this.ratePricingMode=e===null||e===void 0?void 0:e.ratePricingMode;this.bookedByInfoData.arrivalTime=e.arrivalTime;this.bedPreferenceType=e.bedPreferenceType}async checkBookingAvailability(){h();const e=D(this.dateRangeData.fromDate).format("YYYY-MM-DD");const t=D(this.dateRangeData.toDate).format("YYYY-MM-DD");console.log({sourceOption:this.sourceOption});const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.isEventType("EDIT_BOOKING")?[this.defaultData.RATE_TYPE]:[];const a=this.isEventType("BAR_BOOKING")?this.defaultData.roomsInfo.map((e=>e.id)):[];const o=await this.bookingService.getBookingAvailability({from_date:e,to_date:t,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:a,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i,room_type_ids_to_update:s});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:o});if(this.isEventType("EDIT_BOOKING")&&!this.updatedBooking){this.updateBooking()}}catch(e){console.error("Error initializing booking availability:",e)}}updateBooking(){var e,t,i;try{const{currentRoomType:s,GUEST:a}=this.defaultData;const o=s.roomtype.id;const n=s.rateplan.id;const r={bed_preference:(e=s.bed_preference)===null||e===void 0?void 0:e.toString(),infant_nbr:s.occupancy.infant_nbr,last_name:a.last_name,first_name:a.first_name,unit:(i=(t=s.unit)===null||t===void 0?void 0:t.id)===null||i===void 0?void 0:i.toString(),roomtype_id:s.roomtype.id};c("guest",r);p({roomTypeId:o,ratePlanId:n,rooms:1,guest:[r]})}catch(e){console.error(e)}}async checkAndBlockDate(){try{const{block_exposed_unit_props:e}=this.defaultData;await this.bookingService.getBookingAvailability({from_date:e.from_date,to_date:e.to_date,propertyid:this.propertyid,adultChildCount:{adult:2,child:0},language:this.language,room_type_ids:this.defaultData.roomsInfo.map((e=>e.id)),currency:this.currency});const t=n.roomTypes.every((e=>{if(e.is_available_to_book){return true}return e.inventory>0&&e["not_available_reason"]==="ALL-RATES-PLAN-NOT-BOOKABLE"}));if(t){await this.handleBlockDate(false)}else{console.log("Blocked date is unavailable. Continuing...")}}catch(e){console.error("Error checking and blocking date:",e)}}async closeWindow(){h();m(false);if(this.wasBlockedUnit&&!this.didReservation){await this.checkAndBlockDate()}const e=document.querySelector(".sideWindow");if(!e)return;e.classList.add("sideWindow--exit");setTimeout((()=>{this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}),300)}isEventType(e){return this.defaultData.event_type===e}handleBlockDateUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.blockDatesData=t.data}handleGuestInfoUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;if(t.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.wasBlockedUnit||this.isEventType("SPLIT_BOOKING")){this.guestData[t.guestRefKey]=Object.assign(Object.assign({},t.data),{roomId:this.defaultData.PR_ID})}else this.guestData[t.guestRefKey]=t.data}}handleBookedByInfoUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.bookedByInfoData=t.value.data}renderPage(){this.renderAgain=!this.renderAgain}gotoPage(e){this.page=e;this.renderPage()}getPageBlockDatesView(){return i(s,null,i("igl-block-dates-view",{fromDate:this.defaultData.FROM_DATE,toDate:this.defaultData.TO_DATE,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:e=>this.handleBlockDateUpdate(e)}))}handlePageTwoDataUpdateEvent(e){e.stopImmediatePropagation();e.stopPropagation();if(e.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(e)}else{this.handleGuestInfoUpdate(e)}}async handleBlockDate(e=true){const t=this.wasBlockedUnit?this.defaultData.block_exposed_unit_props:(()=>{const e=b(+this.blockDatesData.RELEASE_AFTER_HOURS);return Object.assign({from_date:g(this.defaultData.defaultDateRange.fromDate),to_date:g(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},e)})();await this.bookingService.blockUnit(t);if(e)this.closeWindow()}async bookUser(e){this.setLoadingState(e);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else if(this.isButtonDisabled()){this.isLoading="";return}try{if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}this.didReservation=true;const t=await this.bookPropertyService.prepareBookUserServiceParams({context:this,sourceOption:this.sourceOption,check_in:e});await this.bookingService.doReservation(t);await this.adjustBlockedDatesAfterReservation(t);this.resetBookingEvt.emit(null)}catch(e){console.error("Error booking user:",e)}finally{this.resetLoadingState()}}async adjustBlockedDatesAfterReservation(e){if(!this.wasBlockedUnit){return}const t=D(this.defaultData.block_exposed_unit_props.from_date,"YYYY-MM-DD");const i=D(e.booking.from_date,"YYYY-MM-DD");const s=D(this.defaultData.block_exposed_unit_props.to_date,"YYYY-MM-DD");const a=D(e.booking.to_date,"YYYY-MM-DD");if(a.isBefore(s,"days")){const e=Object.assign(Object.assign({},this.defaultData.block_exposed_unit_props),{from_date:a.format("YYYY-MM-DD")});await this.bookingService.blockUnit(e)}if(i.isAfter(t,"days")){const e=Object.assign(Object.assign({},this.defaultData.block_exposed_unit_props),{to_date:i.format("YYYY-MM-DD")});await this.bookingService.blockUnit(e)}return}setLoadingState(e){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=e?"bookAndCheckIn":"book"}}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}getCurrentPage(e){return this.page===e}render(){return i(a,{key:"369ed3e0f4202ec04b69bea53effd363e10d85a2","data-testid":"book_property_sheet h-100"},i("div",{key:"be32cb1439d810e50c22d74a5fba1832216caa8e",class:"background-overlay",onClick:()=>this.closeWindow()}),i("div",{key:"601e36e67a2c75d2b0d05747dea0850626e0906a",class:"sideWindow sheet-container "+(this.getCurrentPage("page_block_date")?"block-date":"")},C("/Get_Setup_Entries_By_TBL_NAME_MULTI")?i("div",{class:"loading-container"},i("ir-spinner",null)):i(s,null,i("div",{class:"sheet-header"},i("div",{class:"card-header-container mb-2"},i("h3",{class:"text-left font-medium-2 px-2"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),i("ir-icon",{class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{class:"px-2 sheet-body"},this.getCurrentPage("page_one")&&i("igl-booking-overview-page",{wasBlockedUnit:this.wasBlockedUnit,initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,sourceOptions:this._sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&i("igl-booking-form",{currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countries:this.countries,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:e=>this.handlePageTwoDataUpdateEvent(e)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null),this.getCurrentPage("page_block_date")?i("div",{class:"sheet-footer"},i("ir-button",{text:O.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),i("ir-button",{text:O.entries.Lcz_Blockdates,isLoading:C("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})):i("igl-book-property-footer",{page:this.page,dateRangeData:this.dateRangeData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),isLoading:this.isLoading,class:"sheet-footer",eventType:this.bookingData.event_type}))))}};q.style=K+W;const X=".sc-igl-book-property-footer-h{width:100% !important;background:#000}";const Q=X;const Z=class{constructor(i){e(this,i);this.buttonClicked=t(this,"buttonClicked",7);this.disabled=true}isEventType(e){return e===this.eventType}editNext(e){if(this.isEventType("EDIT_BOOKING")){if(e==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton({label:e,type:t,disabled:s,icon_name:a,isLoading:o,icon_position:n="right"}){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("ir-button",{isLoading:o,btn_color:t==="cancel"||t==="back"?"secondary":"primary",text:e,btn_disabled:s,onClickHandler:()=>{this.buttonClicked.emit({key:t})},class:"full-width",btn_styles:"justify-content-center",icon_name:a,iconPosition:n,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){var e;if(this.page==="page_one"){return i(a,null,this.isEventType("EDIT_BOOKING")?i(s,null,this.renderButton({type:"cancel",label:O.entries.Lcz_Cancel}),this.shouldRenderTwoButtons()&&this.renderButton({type:"next",label:`${O.entries.Lcz_Next}`,disabled:C("/Get_Exposed_Booking_Availability"),icon_name:"angles_right"})):i(s,null,this.renderButton({type:"cancel",label:O.entries.Lcz_Cancel}),this.shouldRenderTwoButtons()&&this.renderButton({type:"next",label:`${O.entries.Lcz_Next}`,icon_name:"angles_right"})))}const t=T.checkin_enabled&&D(new Date((e=this.dateRangeData)===null||e===void 0?void 0:e.fromDate)).isSame(new Date,"day");return i(s,null,this.isEditOrAddRoomEvent?i(s,null,this.renderButton({type:"back",icon_position:"left",label:O.entries.Lcz_Back,icon_name:"angles_left"}),this.renderButton({type:"save",label:O.entries.Lcz_Save,isLoading:this.isLoading==="save"})):i(s,null,this.renderButton({type:"back",icon_position:"left",label:O.entries.Lcz_Back,icon_name:"angles_left"}),this.renderButton({type:"book",label:O.entries.Lcz_Book,isLoading:this.isLoading==="book"}),t&&this.renderButton({type:"bookAndCheckIn",label:O.entries.Lcz_BookAndChekcIn,isLoading:this.isLoading==="bookAndCheckIn"})))}};Z.style=Q;const J=".sc-igl-booking-form-h{display:flex;flex-direction:column}";const ee=J;const te=class{constructor(i){e(this,i);this.dataUpdateEvent=t(this,"dataUpdateEvent",7);this.buttonClicked=t(this,"buttonClicked",7);this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let e=0;const t=Object.assign({},this.selectedUnits);const i=(e,t,i,s)=>{if(i&&s===2){return e*t}return e};this.selectedUnits=t;this.guestData=[];this.selectedRooms.forEach(((s,a)=>{s.forEach((s=>{t[a]=s.selectedUnits;e+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let e=1;e<=s.totalRooms;e++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=e}handleOnApplicationInfoDataUpdateEvent(e,t){const i=e.detail;const s=`c_${i.data.roomCategoryId}`;const a=[...this.selectedUnits[s]||[]];a[t]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:a});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:e.detail})}handleEventData(e,t,i){if(t==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(e,i)}else{this.selectedBookedByData=e.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:e.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const e of this.selectedGuestData){if(e.guestName===""||e.preference===""||e.roomId===""){return true}}return false}isButtonDisabled(e){const t=(e,t,i)=>{if(!e){return true}if(e===this.selectedGuestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return this.isLoading===e||t(this.selectedGuestData,"guestName","")||t(this.selectedBookedByData,"isdCode","")||t(this.selectedBookedByData,"contactNumber","")||t(this.selectedBookedByData,"firstName","")||t(this.selectedBookedByData,"lastName","")||t(this.selectedBookedByData,"countryId",-1)||t(this.selectedBookedByData,"selectedArrivalTime","")||t(this.selectedBookedByData,"email","")}render(){return i("div",{key:"e326420f127c97d2032604c58aa6ff1c4777ff8f",class:"d-flex flex-column h-100"},i("div",{key:"feef108a586c2f94a67cbb26c41b9a563c325fed",class:"d-flex flex-wrap"},i("ir-date-view",{key:"74d2ea0068da7b04c35896a4d69438287ebe0fbb",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{key:"1d57c3f8e4e3dc3e8341af35dca172622989022d",class:"mt-1 mt-md-0 text-right"},O.entries.Lcz_TotalPrice," ",i("span",{key:"df4cbcc51fefec735c0f9bee50b69793aeb88952",class:"font-weight-bold font-medium-1"},y(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(n.ratePlanSelections).map((e=>Object.values(e).map((e=>{const t=e;if(t.reserved===0){return null}return[...new Array(t.reserved)].map(((e,s)=>i("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:t.guest?t.guest[s]:null,bookingType:this.bookingData.event_type,rateplanSelection:t,key:`${t.ratePlan.id}_${s}`,roomIndex:s,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countries:this.countries,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:e=>{this.handleEventData(e,"propertyBookedBy",0)}}))}};te.style=ee;const ie=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const se=ie;const ae=class{constructor(i){e(this,i);this.roomsDataUpdate=t(this,"roomsDataUpdate",7)}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(e){return e===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const e=D(this.bookingData.FROM_DATE,"YYYY-MM-DD");const t=D();if(e.isAfter(t)){return t.add(-2,"weeks").format("YYYY-MM-DD")}return e.add(-2,"weeks").format("YYYY-MM-DD")}render(){var e;return i(a,{key:"faf7b0fc05351cf3d063857d8fcb5ca7a8bc4af7"},i("igl-book-property-header",{key:"d54c5b1502b528eb63b9dc6c61a6e35ac3e76924",wasBlockedUnit:this.wasBlockedUnit,bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"610d2268e8b252dfab4b18a9c660dfe945fcc00e",class:" text-left"},C("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(s,null,(e=n.roomTypes)===null||e===void 0?void 0:e.map((e=>i("igl-room-type",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-type-${e.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomType:e,class:"mt-2 mb-1 p-0","data-testid":`room_type_${e.id}`,id:e.id.toString(),roomInfoId:this.selectedRooms.has(`c_${e.id}`)?e.id:null,onDataUpdateEvent:e=>this.roomsDataUpdate.emit(e.detail)}))))))}};ae.style=se;const oe=".sc-ir-booking-details-h{overflow-x:hidden;--ir-dialog-max-width:20rem;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-booking-details-h *.sc-ir-booking-details{font-family:inherit !important;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.font-medium.sc-ir-booking-details{font-weight:600}.sc-ir-booking-details-h th.sc-ir-booking-details{font-weight:600}.h-28.sc-ir-booking-details{height:2rem}.mx-01.sc-ir-booking-details{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}.date-margin.sc-ir-booking-details{margin-right:5px}.pickup-margin.sc-ir-booking-details{margin-bottom:7px !important}.header-date.sc-ir-booking-details{padding-left:5px !important}.pointer.sc-ir-booking-details{cursor:pointer}.sc-ir-booking-details:root{--sidebar-width:50rem}.loading-container.sc-ir-booking-details{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.sm-padding-right.sc-ir-booking-details{padding-right:0.2rem}.sm-padding-left.sc-ir-booking-details{padding-left:0.2rem}.sm-padding-top.sc-ir-booking-details{padding-top:0.2rem}.sm-padding-bottom.sc-ir-booking-details{padding-bottom:0.2rem}.info-notes.sc-ir-booking-details{list-style:none;padding-left:0}.light-blue-bg.sc-ir-booking-details{background-color:#acecff;padding:0.2rem 0.3rem}.iframeHeight.sc-ir-booking-details{height:17.5rem}.dialog-title.sc-ir-booking-details{width:fit-content}";const ne=oe;const re=class{constructor(i){e(this,i);this.toast=t(this,"toast",7);this.bookingChanged=t(this,"bookingChanged",7);this.closeSidebar=t(this,"closeSidebar",7);this.language="en";this.ticket="";this.bookingNumber="";this.is_from_front_desk=false;this.hasPrint=false;this.hasReceipt=false;this.hasDelete=false;this.hasMenu=false;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.hasCloseButton=false;this.bookingItem=null;this.statusData=[];this.calendarData={};this.guestData=null;this.rerenderFlag=false;this.sidebarState=null;this.isUpdateClicked=false;this.isPMSLogLoading=false;this.modalState=null;this.bookingService=new r;this.roomService=new E;this.paymentService=new M;this.token=new B;this.printingBaseUrl="https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2"}componentWillLoad(){if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(e,t){if(e===t){return}this.token.setToken(this.ticket);this.initializeApp()}handleSideBarEvents(e){this.sidebarState=e.detail.type;this.sidebarPayload=e.detail.payload}handleIconClick(e){const t=e.target;switch(t.id){case"pickup":this.sidebarState="pickup";return;case"close":this.closeSidebar.emit(null);return;case"email":this.modalState={type:"email",message:O.entries.Lcz_EmailBookingto.replace("%1",this.booking.guest.email),loading:C("/Send_Booking_Confirmation_Email")};this.modalRef.openModal();return;case"print":this.openPrintingScreen();return;case"receipt":this.openPrintingScreen("invoice");return;case"book-delete":return;case"menu":window.location.href="https://x.igloorooms.com/manage/acbookinglist.aspx";return;case"room-add":this.bookingItem={ID:"",NAME:this.booking.guest.last_name,EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,ARRIVAL:this.booking.arrival,TO_DATE:this.booking.to_date,TITLE:`${O.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,defaultDateRange:{fromDate:new Date(this.booking.from_date),fromDateStr:"",toDate:new Date(this.booking.to_date),toDateStr:"",dateDifference:0,message:""},event_type:"ADD_ROOM",booking:this.booking,BOOKING_NUMBER:this.booking.booking_nbr,ADD_ROOM_TO_BOOKING:this.booking.booking_nbr,GUEST:this.booking.guest,message:this.booking.remark,SOURCE:this.booking.source,ROOMS:this.booking.rooms};return;case"extra_service_btn":this.sidebarState="extra_service";return;case"add-payment":return}}async handleResetExposedCancellationDueAmount(e){e.stopImmediatePropagation();e.stopPropagation();const t=await this.paymentService.GetExposedCancellationDueAmount({booking_nbr:this.booking.booking_nbr,currency_id:this.booking.currency.id});this.paymentActions=[...t]}handleEditInitiated(e){this.bookingItem=e.detail}handleRoomGuestsUpdate(e){const{identifier:t,guests:i}=e.detail;const s=[...this.booking.rooms];let a=s.findIndex((e=>e.identifier===t));if(a===-1){return}const o=s[a];const n=Object.assign(Object.assign({},o),{sharing_persons:i});s[a]=n;this.booking=Object.assign(Object.assign({},this.booking),{rooms:[...s]})}async handleResetBooking(e){e.stopPropagation();e.stopImmediatePropagation();if(e.detail){return this.booking=e.detail}await this.resetBooking()}handleEditExtraService(e){this.selectedService=e.detail;this.sidebarState="extra_service"}setRoomsData(e){var t,i;let s=new Array;if((i=(t=e.My_Result)===null||t===void 0?void 0:t.roomtypes)===null||i===void 0?void 0:i.length){s=e.My_Result.roomtypes;e.My_Result.roomtypes.forEach((e=>{e.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){var e,t;try{const[i,s,a,o,n]=await Promise.all([this.roomService.getExposedProperty({id:this.propertyid||0,language:this.language,aname:this.p}),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language),this.bookingService.getExposedBooking(this.bookingNumber,this.language),this.bookingService.getSetupEntriesByTableNameMulti(["_BED_PREFERENCE_TYPE","_DEPARTURE_TIME","_PAY_TYPE","_PAY_TYPE_GROUP"])]);this.property_id=(e=i===null||i===void 0?void 0:i.My_Result)===null||e===void 0?void 0:e.id;const{bed_preference_type:r,departure_time:c,pay_type:l,pay_type_group:d}=this.bookingService.groupEntryTablesResult(n);this.bedPreference=r;this.departureTime=c;this.paymentTypes=l;this.paymentTypesGroups=d;console.log(c);if((o===null||o===void 0?void 0:o.booking_nbr)&&((t=o===null||o===void 0?void 0:o.currency)===null||t===void 0?void 0:t.id)&&o.is_direct){this.paymentService.GetExposedCancellationDueAmount({booking_nbr:o.booking_nbr,currency_id:o.currency.id}).then((e=>{this.paymentActions=e}))}if(!(O===null||O===void 0?void 0:O.entries)){O.entries=s.entries;O.direction=s.direction}this.countries=a;const h=i===null||i===void 0?void 0:i.My_Result;if(h){const{allowed_payment_methods:e,currency:t,allowed_booking_sources:s,adult_child_constraints:a,calendar_legends:o,aname:n}=h;this.printingBaseUrl=this.printingBaseUrl.replace("%1",n).replace("%2",this.bookingNumber);this.calendarData={currency:t,allowed_booking_sources:s,adult_child_constraints:a,legendData:o};this.setRoomsData(i);const r=["001","004"];this.showPaymentDetails=e===null||e===void 0?void 0:e.some((e=>r.includes(e.code)))}else{console.warn("Room response is missing 'My_Result'.")}this.guestData=o.guest;this.booking=o}catch(e){console.error("Error initializing app:",e)}}async openPrintingScreen(e="print",t="new"){if(t==="old"){if(e==="invoice"){return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`)}return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`)}let i=this.printingBaseUrl;if(e==="invoice"){i=i+"&mode=invoice"}const{data:s}=await I.post(`Get_ShortLiving_Token`);if(!s.ExceptionMsg){i=i+`&token=${s.My_Result}`}window.open(i)}handleCloseBookingWindow(){this.bookingItem=null}handleDeleteFinish(e){this.booking=Object.assign(Object.assign({},this.booking),{rooms:this.booking.rooms.filter((t=>t.identifier!==e.detail))})}async resetBooking(){try{const e=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);this.booking=Object.assign({},e);this.bookingChanged.emit(this.booking)}catch(e){console.log(e)}}async handleModalConfirm(e){e.stopImmediatePropagation();e.stopPropagation();switch(this.modalState.type){case"email":await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr,this.language);break}this.modalState=null;this.modalRef.closeModal()}renderSidebarContent(){var e,t,s,a,o,n;const r=()=>{this.sidebarState=null};switch(this.sidebarState){case"guest":return i("ir-guest-info",{isInSideBar:true,headerShown:true,slot:"sidebar-body",booking_nbr:this.bookingNumber,email:(e=this.booking)===null||e===void 0?void 0:e.guest.email,language:this.language,onCloseSideBar:r});case"pickup":return i("ir-pickup",{bookingDates:{from:this.booking.from_date,to:this.booking.to_date},slot:"sidebar-body",defaultPickupData:this.booking.pickup_info,bookingNumber:this.booking.booking_nbr,numberOfPersons:this.booking.occupancy.adult_nbr+this.booking.occupancy.children_nbr,onCloseModal:r});case"extra_note":return i("ir-booking-extra-note",{slot:"sidebar-body",booking:this.booking,onCloseModal:()=>this.sidebarState=null});case"extra_service":return i("ir-extra-service-config",{service:this.selectedService,booking:{from_date:this.booking.from_date,to_date:this.booking.to_date,booking_nbr:this.booking.booking_nbr,currency:this.booking.currency},slot:"sidebar-body",onCloseModal:()=>{r();if(this.selectedService){this.selectedService=null}}});case"room-guest":return i("ir-room-guests",{countries:this.countries,language:this.language,identifier:(t=this.sidebarPayload)===null||t===void 0?void 0:t.identifier,bookingNumber:this.booking.booking_nbr,roomName:(s=this.sidebarPayload)===null||s===void 0?void 0:s.roomName,totalGuests:(a=this.sidebarPayload)===null||a===void 0?void 0:a.totalGuests,sharedPersons:(o=this.sidebarPayload)===null||o===void 0?void 0:o.sharing_persons,slot:"sidebar-body",checkIn:(n=this.sidebarPayload)===null||n===void 0?void 0:n.checkin,onCloseModal:r});case"payment-folio":return i("ir-payment-folio",{paymentTypesGroups:this.paymentTypesGroups,bookingNumber:this.booking.booking_nbr,paymentTypes:this.paymentTypes,slot:"sidebar-body",payment:this.sidebarPayload.payment,mode:this.sidebarPayload.mode,onCloseModal:r});default:return null}}render(){var e,t,a;if(!this.booking){return i("div",{class:"loading-container"},i("ir-spinner",null))}return[i(s,null,!this.is_from_front_desk&&i(s,null,i("ir-toast",null),i("ir-interceptor",null))),i("ir-booking-header",{booking:this.booking,hasCloseButton:this.hasCloseButton,hasDelete:this.hasDelete,hasMenu:this.hasMenu,hasPrint:this.hasPrint,hasReceipt:this.hasReceipt,hasEmail:["001","002"].includes((t=(e=this.booking)===null||e===void 0?void 0:e.status)===null||t===void 0?void 0:t.code)}),i("div",{class:"fluid-container p-1 text-left mx-0"},i("div",{class:"row m-0"},i("div",{class:"col-12 p-0 mx-0 pr-lg-1 col-lg-6"},i("ir-reservation-information",{countries:this.countries,booking:this.booking}),i("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},i("ir-date-view",{from_date:this.booking.from_date,to_date:this.booking.to_date}),this.hasRoomAdd&&this.booking.is_editable&&i("ir-button",{id:"room-add",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),i("div",{class:"card p-0 mx-0"},this.booking.rooms.map(((e,t)=>{const s=this.handleRoomCheckin(e);const a=this.handleRoomCheckout(e);return[i("ir-room",{room:e,property_id:this.property_id,language:this.language,departureTime:this.departureTime,bedPreferences:this.bedPreference,isEditable:this.booking.is_editable,legendData:this.calendarData.legendData,roomsInfo:this.calendarData.roomsInfo,myRoomTypeFoodCat:e.roomtype.name,mealCodeName:e.rateplan.short_name,currency:this.booking.currency.symbol,hasRoomEdit:this.hasRoomEdit&&this.booking.status.code!=="003"&&this.booking.is_direct,hasRoomDelete:this.hasRoomDelete&&this.booking.status.code!=="003"&&this.booking.is_direct,hasCheckIn:s,hasCheckOut:a,booking:this.booking,bookingIndex:t,onDeleteFinished:this.handleDeleteFinish.bind(this)}),t!==this.booking.rooms.length-1&&i("hr",{class:"mr-2 ml-2 my-0 p-0"})]}))),i("ir-pickup-view",{booking:this.booking}),i("section",null,i("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},i("p",{class:"font-size-large p-0 m-0 "},O.entries.Lcz_ExtraServices),i("ir-button",{id:"extra_service_btn",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),i("ir-extra-services",{booking:{booking_nbr:this.booking.booking_nbr,currency:this.booking.currency,extra_services:this.booking.extra_services}}))),i("div",{class:"col-12 p-0 m-0 pl-lg-1 col-lg-6"},i("ir-payment-details",{paymentTypes:this.paymentTypes,paymentActions:this.paymentActions,booking:this.booking})))),i("ir-modal",{modalBody:(a=this.modalState)===null||a===void 0?void 0:a.message,leftBtnText:O.entries.Lcz_Cancel,rightBtnText:O.entries.Lcz_Confirm,autoClose:false,isLoading:C("/Send_Booking_Confirmation_Email"),ref:e=>this.modalRef=e,onConfirmModal:e=>{this.handleModalConfirm(e)},onCancelModal:()=>{this.modalRef.closeModal()}}),i("ir-sidebar",{open:this.sidebarState!==null,side:"right",id:"editGuestInfo",style:{"--sidebar-width":this.sidebarState==="room-guest"?"60rem":undefined},onIrSidebarToggle:e=>{e.stopImmediatePropagation();e.stopPropagation();this.sidebarState=null},showCloseButton:false},this.renderSidebarContent()),i(s,null,this.bookingItem&&i("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countries:this.countries,currency:this.calendarData.currency,language:this.language,propertyid:this.property_id,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))]}handleRoomCheckout(e){if(!T.checkin_enabled||T.is_automatic_check_in_out){return false}return e.in_out.code==="001"}handleRoomCheckin(e){if(!T.checkin_enabled||T.is_automatic_check_in_out){return false}if(!e.unit){return false}if(e.in_out&&e.in_out.code!=="000"){return false}if(D().isSameOrAfter(D(e.from_date,"YYYY-MM-DD"),"days")&&D().isBefore(D(e.to_date,"YYYY-MM-DD"),"days")){return true}return false}get element(){return o(this)}static get watchers(){return{ticket:["ticketChanged"]}}};re.style=ne;const ce=".sc-ir-booking-extra-note-h{display:block}";const le=ce;const de=".sc-ir-booking-extra-note-h{height:100%}.sheet-container.sc-ir-booking-extra-note{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-booking-extra-note{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-booking-extra-note{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-booking-extra-note{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-booking-extra-note{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-booking-extra-note{flex-direction:row;align-items:center}}";const he=de;const pe=class{constructor(i){e(this,i);this.closeModal=t(this,"closeModal",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.isLoading=false;this.note="";this.bookingService=new r}componentWillLoad(){if(this.booking.extras){this.setNote(v(this.booking.extras))}}setNote(e){this.note=e}async savePrivateNote(){try{this.isLoading=true;let e=this.booking.extras||[];const t={key:"private_note",value:this.note};if(e.length===0){e.push(t)}else{const i=e.findIndex((e=>e.key==="private_note"));if(i===-1){e.push(t)}else{e[i]=t}}const i=await this.bookingService.doReservation({assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,booking:this.booking,Is_Non_Technical_Change:true,extras:e});this.resetBookingEvt.emit(i);this.closeModal.emit(null)}catch(e){console.error(e)}finally{this.isLoading=false}}render(){return i("form",{key:"102c307fa4cde38c7f4ba91dc9a5fa8735097b09",class:"sheet-container h-100",onSubmit:e=>{e.preventDefault();this.savePrivateNote()}},i("ir-title",{key:"3f782610a879434699c9ebb3b23cb3d6cd1b2e53",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:O.entries.Lcz_PrivateNote,displayContext:"sidebar"}),i("div",{key:"6949926b1deb312ed33c825f529038dfd7bc9b27",class:"sheet-body px-1"},i("ir-textarea",{key:"e64dd33ac84eb6d71ab0c363cdc524c9d336314f",placeholder:O.entries.Lcz_PrivateNote_MaxChar,label:"",value:this.note,maxLength:150,onTextChange:e=>this.setNote(e.detail)})),i("div",{key:"b8c2233c042dff0e6749257abb4f7c642206efd7",class:"sheet-footer"},i("ir-button",{key:"3cd692a29b35917dc21d5e2ca2a354b64d5d770f",onClickHandler:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`,text:O.entries.Lcz_Cancel,btn_color:"secondary"}),i("ir-button",{key:"4428660d719e92ae8dbf2714ccba94f73fd64e0f",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center ml-sm-1",isLoading:this.isLoading,text:O.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"})))}};pe.style=le+he;const fe=".sc-ir-booking-guarantee-h{display:block}.sc-ir-booking-guarantee-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-booking-guarantee-h *.sc-ir-booking-guarantee{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.iframeHeight.sc-ir-booking-guarantee{height:max-content;height:22.5rem}";const ue=fe;const me=class{constructor(t){e(this,t);this.collapsed=false;this.paymentDetailsUrl="";this.paymentExceptionMessage=""}async componentWillLoad(){}formatCurrency(e,t,i="en-US"){if(!t||e<0){return""}return new Intl.NumberFormat(i,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}checkPaymentCode(e){var t,i,s;return(s=(i=(t=T.allowed_payment_methods)===null||t===void 0?void 0:t.find((t=>t.code===e)))===null||i===void 0?void 0:i.description)!==null&&s!==void 0?s:null}getPaymentMethod(){var e,t,i,s;let a=null;const o=(t=(e=this.booking)===null||e===void 0?void 0:e.extras)===null||t===void 0?void 0:t.find((e=>e.key==="payment_code"));if(this.booking.agent){const e=(s=(i=this.booking)===null||i===void 0?void 0:i.extras)===null||s===void 0?void 0:s.find((e=>e.key==="agent_payment_mode"));if(e){a=e.value==="001"?O.entries.Lcz_OnCredit:o?this.checkPaymentCode(o.value):null}}else if(o){a=this.checkPaymentCode(o.value)}return a}async handleToggleCollapse(){if(!this.booking.is_direct&&this.booking.channel_booking_nbr&&!this.booking.guest.cci&&!this.collapsed){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.booking.booking_nbr)}this.collapsed=!this.collapsed}shouldShowGuarantee(){const e=this.booking.is_direct?this.getPaymentMethod():null;return this.booking.is_direct?Boolean(e||this.booking.guest.cci):true}shouldShowToggleButton(){return!this.booking.is_direct||this.booking.is_direct&&this.booking.guest.cci}renderCreditCardInfo(){const{cci:e}=this.booking.guest;if(!e)return null;return[i("div",null,e&&"Card:"," ",i("span",null,e.nbr||""),e.expiry_month&&" Expiry: ",i("span",null,e.expiry_month||"",e.expiry_year&&"/"+e.expiry_year)),i("div",null,e.holder_name&&"Name:"," ",i("span",null,e.holder_name||""),e.cvc&&" - CVC:"," ",i("span",null,e.cvc||""))]}renderCollapsedContent(){if(this.booking.guest.cci){return this.renderCreditCardInfo()}if(this.paymentDetailsUrl){return i("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"})}return i("div",{class:"text-center"},this.paymentExceptionMessage)}renderOtaGuarantee(){var e,t,s;const{ota_guarante:a}=this.booking;if(!a||this.booking.is_direct)return null;return i("div",null,i("ir-label",{content:a.card_type+`${a.is_virtual?" (virtual)":""}`,labelText:`${O.entries.Lcz_CardType}:`}),i("ir-label",{content:a.cardholder_name,labelText:`${O.entries.Lcz_CardHolderName}:`}),i("ir-label",{content:a.card_number,labelText:`${O.entries.Lcz_CardNumber}:`}),i("ir-label",{content:this.formatCurrency(k(Number((e=a.meta)===null||e===void 0?void 0:e.virtual_card_current_balance),Number((t=a.meta)===null||t===void 0?void 0:t.virtual_card_decimal_places)),(s=a.meta)===null||s===void 0?void 0:s.virtual_card_currency_code),labelText:`${O.entries.Lcz_CardBalance}:`}))}render(){if(!this.shouldShowGuarantee()){return null}const e=this.booking.is_direct?this.getPaymentMethod():null;return i("div",{class:"mb-1"},i("div",{class:"d-flex align-items-center"},i("span",{class:"mr-1 font-medium"},O.entries.Lcz_BookingGuarantee,e&&i("span",null,": ",e)),this.shouldShowToggleButton()&&i("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":".guarrantee","aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",variant:"icon",icon_name:"credit_card",onClickHandler:this.handleToggleCollapse.bind(this)})),i("div",{class:"collapse guarrantee"},this.renderCollapsedContent()),this.renderOtaGuarantee())}};me.style=ue;const be=".sc-ir-booking-header-h{display:block}.confirmed.sc-ir-booking-header{color:#fff;display:flex;align-items:center}.bg-ir-green.sc-ir-booking-header{background:#629a4c;padding:0.2rem 0.3rem}.bg-ir-red.sc-ir-booking-header{background:#ff4961;padding:0.2rem 0.3rem}.bg-ir-orange.sc-ir-booking-header{background:#ff9149;padding:0.2rem 0.3rem}";const ge=be;const ye=class{constructor(i){e(this,i);this.toast=t(this,"toast",7);this.closeSidebar=t(this,"closeSidebar",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.openSidebar=t(this,"openSidebar",7);this.hasEmail=true;this.bookingStatus=null;this.confirmationBG={"001":"bg-ir-orange","002":"bg-ir-green","003":"bg-ir-red","004":"bg-ir-red"};this.bookingService=new r;this.alertMessage=`ALERT! Modifying an OTA booking will create a discrepancy between igloorooms and the source. Future guest modifications on the OTA may require manual adjustmentsofthebooking.`}handleSelectChange(e){e.stopPropagation();e.stopImmediatePropagation();const t=e.target;this.bookingStatus=t.selectedValue}async updateStatus(){if(!this.bookingStatus||this.bookingStatus==="-1"){this.toast.emit({type:"error",description:"",title:O.entries.Lcz_SelectStatus,position:"top-right"});return}try{await this.bookingService.changeExposedBookingStatus({book_nbr:this.booking.booking_nbr,status:this.bookingStatus});this.toast.emit({type:"success",description:"",title:O.entries.Lcz_StatusUpdatedSuccessfully,position:"top-right"});this.bookingStatus=null;this.resetBookingEvt.emit(null)}catch(e){console.log(e)}}openDialog(e){const{type:t}=e;this.currentDialogStatus=t;this.dialogRef.openModal()}renderDialogBody(){switch(this.currentDialogStatus){case"pms":return i("ir-pms-logs",{slot:"modal-body",bookingNumber:this.booking.booking_nbr});case"events-log":return i("ir-events-log",{booking:this.booking,slot:"modal-body",bookingNumber:this.booking.booking_nbr})}}render(){var e,t;const s=this.booking.ota_manipulations?this.booking.ota_manipulations[this.booking.ota_manipulations.length-1]:null;return i("div",{key:"30ddd492ce59575592f5d80d997679acde455740",class:"fluid-container px-1"},i("div",{key:"5a7a4812b37736ae388f559827423a3ea29acf0a",class:"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1"},i("div",{key:"53b1f01da142328fd4082af388ce7d88e057f5e2",class:"m-0 p-0 mb-1 mb-lg-0 mt-md-0"},i("p",{key:"6873463ecb14a3e222aeb0a6f8e4bea4462900cc",class:"font-size-large m-0 p-0"},`${O.entries.Lcz_Booking}#${this.booking.booking_nbr}`),i("p",{key:"768be3c66846fd5565687a5bda398e6f48fccb58",class:"m-0 p-0"},!this.booking.is_direct&&i("span",{key:"c60255b5394ccf51a9603d2dc92693eeec9f3c4f",class:"mr-1 m-0"},this.booking.channel_booking_nbr))),i("div",{key:"8814531a2bb9e4bec62a3f01a7a14942b2bf8a06",class:"d-flex justify-content-end align-items-center",style:{gap:"1rem",flexWrap:"wrap"}},i("div",{key:"fa66f51ca5ae1c4c81b975e14ba74aaf7b16dce7",class:"d-flex flex-column align-items-center"},i("span",{key:"6ecac89fb523d42123a2d6b92462335fa0380dd4",class:`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.is_requested_to_cancel?"003":this.booking.status.code]}`},this.booking.is_requested_to_cancel?O.entries.Lcz_CancellationRequested:this.booking.status.description),s&&i("ir-popover",{key:"19fb0cba89b0b5c0eec81db45cf35e9e8940520b",trigger:"hover",renderContentAsHtml:true,content:`<div><p>Modified by ${s.user} at ${s.date} ${s.hour}:${s.minute}.</p>\n                <p>${this.alertMessage}</p></div>`},i("p",{key:"ee5811df2c03cdcf38a01488a6e8f6be883849bb",class:"mx-0 p-0 small text-danger",style:{marginTop:"0.25rem",marginBottom:"0"}},i("b",{key:"ca4fdf0e7f33573eedc856f946a4279dfc13367c"},"Modified")))),this.booking.allowed_actions.length>0&&this.booking.is_editable&&i("div",{key:"9020e7a7ef42b83f6323d00d91526456880fb2ab",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.25rem"}},i("ir-select",{key:"30b857194f2a2885060fa990de9d4b0ea793473a",selectContainerStyle:"h-28",selectStyles:"d-flex status-select align-items-center h-28",firstOption:O.entries.Lcz_Select,id:"update-status",size:"sm","label-available":"false",data:this.booking.allowed_actions.map((e=>({text:e.description,value:e.code}))),textSize:"sm",class:"sm-padding-right m-0 ",selectedValue:this.bookingStatus}),i("ir-button",{key:"8ccb7d2ff690c6a05e1f629994c0bc6109836295",onClickHandler:()=>{if(!this.booking.is_direct){this.modalEl.openModal();return}this.updateStatus()},btn_styles:"h-28",isLoading:C("/Change_Exposed_Booking_Status"),btn_disabled:C("/Change_Exposed_Booking_Status"),id:"update-status-btn",size:"sm",text:"Update"})),i("ir-button",{key:"9505dbdf5da862241afa8eff254c6e4f31c2a3a0",size:"sm",btn_color:"outline",text:O.entries.Lcz_EventsLog,onClickHandler:e=>{e.stopImmediatePropagation();e.stopPropagation();this.openDialog({type:"events-log"})}}),T.is_pms_enabled&&i("ir-button",{key:"59072d6b196a98625a1f824e42fa192f88dcff25",size:"sm",btn_color:"outline",text:O.entries.Lcz_pms,onClick:e=>{e.stopImmediatePropagation();e.stopPropagation();this.openDialog({type:"pms"})}}),this.hasReceipt&&i("ir-button",{key:"bd433e96319b59153bdc7934e0b6b67d2813a247",variant:"icon",id:"receipt",icon_name:"reciept",class:"",style:{"--icon-size":"1.65rem"}}),this.hasPrint&&i("ir-button",{key:"0b529fc81cd818d0c75d9fe069e323c3a95078e8",variant:"icon",id:"print",icon_name:"print",class:"",style:{"--icon-size":"1.65rem"}}),this.hasEmail&&i("ir-button",{key:"a9c3853c979b295cf0c000ffae1bea8da368fd18",variant:"icon",id:"email",title:"Email this booking",icon_name:"email",class:"",style:{"--icon-size":"1.65rem"}}),this.hasDelete&&i("ir-button",{key:"4f8976307db16e480ba6d78897a4d811f818efb2",variant:"icon",id:"book-delete",icon_name:"trash",class:"",style:Object.assign(Object.assign({},S.danger),{"--icon-size":"1.65rem"})}),this.hasMenu&&i("ir-button",{key:"48a67eedd8ac9c0491bb1cbb04fb3fdc515bb1b6",variant:"icon",class:"mr-1",id:"menu",icon_name:"menu_list",style:{"--icon-size":"1.65rem"}}),this.hasCloseButton&&i("ir-button",{key:"be1a63dcdcc3d1f9dc7e57e1c0075be46dabf933",id:"close",variant:"icon",style:{"--icon-size":"1.65rem"},icon_name:"xmark",class:"ml-2",onClickHandler:e=>{e.stopPropagation();e.stopImmediatePropagation();this.closeSidebar.emit(null)}}))),i("ir-dialog",{key:"51e552d046ff5d0675b066b0432b18efc3968522",onOpenChange:e=>{if(!e.detail){this.currentDialogStatus=null}},style:this.currentDialogStatus==="events-log"&&{"--ir-dialog-max-width":"max-content"},ref:e=>this.dialogRef=e},this.renderDialogBody()),i("ir-modal",{key:"7c9681b34b38c0cf261c5c2e20f00728f54219ff",ref:e=>this.modalEl=e,modalTitle:"",leftBtnText:(e=O===null||O===void 0?void 0:O.entries)===null||e===void 0?void 0:e.Lcz_Cancel,rightBtnText:(t=O===null||O===void 0?void 0:O.entries)===null||t===void 0?void 0:t.Lcz_Confirm,modalBody:O.entries.Lcz_OTA_Modification_Alter,isLoading:C("/Change_Exposed_Booking_Status"),onConfirmModal:this.updateStatus.bind(this)}))}};ye.style=ge;const ve=":host{display:block;margin:0;padding:0;box-sizing:border-box}.backdrop{opacity:0;background:rgba(0, 0, 0, 0.2);position:fixed;inset:0;z-index:99999998}.backdrop[data-state='opened']{animation:overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards}.backdrop[data-state='closed']{opacity:0;pointer-events:none}.modal-container{box-sizing:border-box;margin:0;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;position:fixed;z-index:99999999;overflow-y:auto;top:50%;left:50%;background:white;transform:translate(-50%, -50%);width:90%;min-height:fit-content;height:fit-content;max-width:var(--ir-dialog-max-width, 40rem);min-width:var(--ir-dialog-min-width);max-height:85vh;border-radius:8px;padding:0;animation:contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1)}.modal-footer ::slotted(*){flex-direction:row;align-items:center;justify-content:end;gap:8px;--ir-btn-width:inherit}.modal-footer{--ir-btn-width:100%}.modal-title ::slotted(*){font-size:18px;font-weight:600;color:#101828;margin-bottom:8px}.modal-body ::slotted(*){font-size:14px;font-weight:400;color:#475467;padding:0;margin:0}@keyframes overlayShow{from{opacity:0}to{opacity:1}}@keyframes contentShow{from{opacity:0;transform:translate(-50%, -48%) scale(0.96)}to{opacity:1;transform:translate(-50%, -50%) scale(1)}}.dialog-close-button{position:absolute;top:15px;right:15px}";const ke=ve;const _e=class{constructor(i){e(this,i);this.openChange=t(this,"openChange",7);this.open=false;this.isOpen=false}componentWillLoad(){if(this.open){this.openModal()}}componentDidLoad(){this.prepareFocusTrap()}async openModal(){this.isOpen=true;document.body.style.overflow="hidden";setTimeout((()=>{this.prepareFocusTrap()}),10);this.openChange.emit(this.isOpen)}async closeModal(){console.log("close");if(!this.isOpen){return}document.body.style.overflow="visible";this.isOpen=false;this.openChange.emit(this.isOpen)}handleOpenChange(){if(this.open){this.openModal()}else{this.closeModal()}}handleKeyDown(e){if(!this.isOpen){return}let t=e.key==="Tab";if(e.key==="Escape"&&this.isOpen){this.closeModal()}if(!t){return}if(!e.shiftKey&&document.activeElement===this.lastFocusableElement){this.firstFocusableElement.focus();e.preventDefault()}if(e.shiftKey&&document.activeElement===this.firstFocusableElement){this.lastFocusableElement.focus();e.preventDefault()}}disconnectedCallback(){document.body.style.overflow="visible"}prepareFocusTrap(){const e='button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';const t=this.el.shadowRoot.querySelectorAll(e);if(t.length===0)return;this.firstFocusableElement=t[0];this.lastFocusableElement=t[t.length-1];this.firstFocusableElement.focus()}render(){return i(a,{key:"88208af05265da41d72729589240413fdc332803"},i("div",{key:"c388c04a14969b923762f8e35441b256b2bdd069",class:"backdrop","data-state":this.isOpen?"opened":"closed",onClick:()=>this.closeModal()}),this.isOpen&&i("div",{key:"237a086f0321abe0af6a4a2f911cdcff97cace72",class:"modal-container",tabIndex:-1,role:"dialog","aria-labelledby":"dialog1Title","aria-describedby":"dialog1Desc"},i("ir-icon",{key:"bd17c4d383d9dd7cd80165627125946ce1066f2b",id:"close",class:"dialog-close-button",onIconClickHandler:()=>this.closeModal()},i("svg",{key:"b338880b61e1b44e3e356d33431e1cc843ac24e5",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:18,width:18},i("path",{key:"3a4f25400c7bbb89d0f1d1e6d4ae1e2a4014a54b",fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("div",{key:"7173e875c9f60d3717aba474a1429f88952f6352",class:"modal-title",id:"dialog1Title"},i("slot",{key:"f784e94da5f0244c5a45e406c933763a80aec7f7",name:"modal-title"})),i("div",{key:"36cc3ebfad070395f4536984870c55d205474e84",class:"modal-body",id:"dialog1Desc"},i("slot",{key:"5557ac14fb0841f93a9f560264f7ce893d2d0fa4",name:"modal-body"})),i("div",{key:"21ffb3b8accca71fe3fa0a7d46b0b91e7164c678",class:"modal-footer"},i("slot",{key:"67783528da31a4c6ec14c0f4360c858df2bde683",name:"modal-footer"}))))}get el(){return o(this)}static get watchers(){return{open:["handleOpenChange"]}}};_e.style=ke;const xe=".dropdown-menu.sc-ir-dropdown{z-index:1000;width:100%;max-height:300px;overflow-y:auto}.dropdown.nav-item.show.sc-ir-dropdown .dropdown-menu.sc-ir-dropdown{display:block}.caret-icon.sc-ir-dropdown{position:absolute;top:50%;transform:translateY(-55%);right:0.25rem;z-index:99999}.dropdown-trigger.sc-ir-dropdown{position:relative}.caret-icon.disabled.sc-ir-dropdown{opacity:0.5 !important;pointer-events:none !important;cursor:not-allowed !important}";const we=xe;const De=class{constructor(i){e(this,i);this.optionChange=t(this,"optionChange",7);this.disabled=false;this.isOpen=false;this.focusedIndex=-1;this.itemChildren=[];this.mo=null;this.isComponentConnected=true;this.updateQueued=false;this.handleDocumentClick=e=>{if(!this.isComponentConnected||!this.el.contains(e.target)){this.closeDropdown()}};this.handleKeyDown=e=>{if(!this.isComponentConnected||this.disabled)return;const t=this.itemChildren.length-1;switch(e.key){case"ArrowDown":e.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>=0&&this.focusedIndex<t){this.focusedIndex++;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===t){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}}else if(t>=0){this.focusedIndex=this.focusedIndex<t?this.focusedIndex+1:0;this.focusItemElement(this.focusedIndex)}break;case"ArrowUp":e.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>0){this.focusedIndex--;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=t;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===0){this.focusedIndex=t;this.focusItemElement(this.focusedIndex)}}else if(t>=0){this.focusedIndex=this.focusedIndex>0?this.focusedIndex-1:t;this.focusItemElement(this.focusedIndex)}break;case"Enter":e.preventDefault();if(this.isOpen&&this.focusedIndex>=0){this.selectItemElement(this.focusedIndex)}else if(!this.isOpen){this.openDropdown()}break;case"Escape":e.preventDefault();this.closeDropdown();break;case"Tab":if(this.isOpen){this.closeDropdown()}break}}}componentWillLoad(){this.selectedOption=this.value;this.documentClickHandler=this.handleDocumentClick.bind(this);this.collectItemChildren();this.mo=new MutationObserver((()=>{if(!this.updateQueued){this.updateQueued=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.collectItemChildren();this.updateQueued=false}}))}}));this.mo.observe(this.el,{childList:true,subtree:true})}componentDidLoad(){document.addEventListener("click",this.documentClickHandler,{passive:true});requestAnimationFrame((()=>{if(this.isComponentConnected){this.updateItemElements();if(this.value){this.updateDropdownItemValue(this.value)}}}))}disconnectedCallback(){var e;this.isComponentConnected=false;document.removeEventListener("click",this.documentClickHandler);(e=this.mo)===null||e===void 0?void 0:e.disconnect();this.mo=null}handleDocumentKeyDown(e){if(!this.isOpen||!this.isComponentConnected)return;if(e.key==="Escape"){this.closeDropdown()}}handleDropdownItemSelect(e){if(!this.isComponentConnected)return;e.stopPropagation();this.selectOption(e.detail);e.target.setAttribute("aria-selected","true")}handleDropdownItemRegister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleDropdownItemUnregister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleValueChange(e,t){if(e!==t&&this.isComponentConnected){this.updateDropdownItemValue(e)}}updateDropdownItemValue(e){this.itemChildren.forEach((e=>e.removeAttribute("aria-selected")));const t=this.itemChildren.find((t=>t.value===e));if(t){t.setAttribute("aria-selected","true")}}getSelectedItemIndex(){if(!this.value)return-1;return this.itemChildren.findIndex((e=>e.value===this.value))}openDropdown(){try{this.isOpen=true;this.focusedIndex=this.getSelectedItemIndex();this.updateItemElements();if(this.focusedIndex>=0){requestAnimationFrame((()=>{this.scrollToSelectedItem()}))}}catch(e){console.log(e)}}closeDropdown(){this.isOpen=false;this.focusedIndex=-1;this.removeItemFocus()}collectItemChildren(){if(!this.isComponentConnected)return;const e=Array.from(this.el.querySelectorAll("ir-dropdown-item"));this.itemChildren=e;this.updateItemElements()}updateItemElements(){if(!this.isComponentConnected)return;this.itemChildren.forEach(((e,t)=>{e.setAttribute("data-slot-index",String(t));e.setAttribute("role","option");e.setAttribute("tabindex","-1")}))}removeItemFocus(){this.itemChildren.forEach((e=>{e.classList.remove("focused","active")}))}focusItemElement(e){this.removeItemFocus();if(e>=0&&e<this.itemChildren.length){const t=this.itemChildren[e];t.classList.add("focused");t.scrollIntoView({block:"nearest",behavior:"smooth"})}}selectItemElement(e){if(e>=0&&e<this.itemChildren.length){const t=this.itemChildren[e];t.click()}}scrollToSelectedItem(){if(this.focusedIndex>=0&&this.focusedIndex<this.itemChildren.length){const e=this.itemChildren[this.focusedIndex];if(e){e.scrollIntoView({block:"nearest",behavior:"smooth",inline:"nearest"})}}}selectOption(e){this.selectedOption=e;this.value=e;this.optionChange.emit(e);this.closeDropdown()}render(){return i(a,{key:"2dc85a1a0c3e18e5d7ad95d73b65191ab4d6517f",class:`dropdown ${this.isOpen?"show":""}`},i("div",{key:"27ea00249469c1b2b87549a14335488a388a93e3",onClick:()=>{if(this.disabled)return;if(this.isOpen){this.closeDropdown()}else{this.openDropdown()}},"aria-disabled":String(this.disabled),class:`dropdown-trigger ${this.disabled?"disabled":""}`,onKeyDown:this.handleKeyDown,tabindex:"0"},i("slot",{key:"1da437861821b8d6ce88268074964c7769848992",name:"trigger"}),i("div",{key:"180d0d26598c5892fb6422c4f145e5f03601f8e7",class:`caret-icon ${this.disabled?"disabled":""}`},i("ir-icons",{key:"768ff0d27e0dd698f700b17fb823ebbcf8ae7362",name:!this.isOpen?"angle-down":"angle-up"}))),i("div",{key:"72c5479acbc9a3f6163e30c0634ae52e19816433",class:"dropdown-menu",role:"listbox","aria-expanded":this.isOpen.toString()},i("slot",{key:"87327ce54ba63e3ee7fa304e7a7566bfef14447f"})))}get el(){return o(this)}static get watchers(){return{value:["handleValueChange"]}}};De.style=we;const Oe=".sc-ir-dropdown-item-h{display:block;cursor:pointer}[hidden].sc-ir-dropdown-item-h{display:none !important}.focused.sc-ir-dropdown-item-h{background:#f4f5fa !important}.active.sc-ir-dropdown-item-h,[aria-selected='true'].sc-ir-dropdown-item-h,.sc-ir-dropdown-item-h:active{outline:none;background-color:var(--blue, #1e9ff2) !important;color:white !important}.dropdown-item.sc-ir-dropdown-item-h{padding:0.5rem 1rem !important;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}";const Ce=Oe;const Te=class{constructor(i){e(this,i);this.dropdownItemSelect=t(this,"dropdownItemSelect",7);this.dropdownItemRegister=t(this,"dropdownItemRegister",7);this.dropdownItemUnregister=t(this,"dropdownItemUnregister",7);this.isComponentConnected=true;this.hasRegistered=false;this.hidden=false;this.handleClick=e=>{e.stopPropagation();if(!this.isComponentConnected)return;this.dropdownItemSelect.emit(this.value)}}componentDidLoad(){if(this.isComponentConnected&&!this.hasRegistered){this.hasRegistered=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.dropdownItemRegister.emit()}}))}}disconnectedCallback(){this.isComponentConnected=false;if(this.hasRegistered&&this.el.parentElement){const e=this.el.closest("ir-dropdown");if(e&&document.contains(e)){this.dropdownItemUnregister.emit()}}this.hasRegistered=false}async matchesQuery(e){var t,i;if(!this.isComponentConnected)return false;const s=e.toLowerCase();const a=((i=(t=this.label)!==null&&t!==void 0?t:this.el.textContent)!==null&&i!==void 0?i:"").toLowerCase();return a.includes(s)}async setHidden(e){if(this.isComponentConnected){this.hidden=e}}render(){return i(a,{key:"3e1272790e89b0be5d43c1419849d5522dfd1eb1",role:"option",tabindex:"-1","aria-selected":"false",class:{"dropdown-item":true,hidden:this.hidden},onClick:this.handleClick,"data-value":this.value},this.html_content?i("span",{innerHTML:this.html_content}):i("slot",null))}get el(){return o(this)}};Te.style=Ce;const Ye=".sc-ir-events-log-h{display:block}.beta.sc-ir-events-log{background:var(--red);color:white;padding:0.2rem 0.3rem;font-size:12px;border-radius:4px;margin:0}.event-row.sc-ir-events-log{padding-bottom:0.5rem}.list-title.sc-ir-events-log{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-events-log{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-events-log{color:#629a4c;font-weight:600}.list-item.red.sc-ir-events-log{color:#ff4961;font-weight:600}.dates-row.sc-ir-events-log{display:flex;align-items:center;gap:0.875rem}";const Ie=Ye;const Ee=class{constructor(t){e(this,t)}componentWillLoad(){this.init()}async init(){try{this.bookingEvents=this.booking.events}catch(e){console.error(e)}}render(){var e;return i("div",{key:"08cbb954abf646045af6d0abe392d916bdb63160",class:"p-1"},i("div",{key:"7a9132b0ca420d4db6677a2ebcbcfa01f62551ce",class:"d-flex  align-items-center",style:{gap:"0.5rem"}},i("h3",{key:"8b7612f1fabe26a9450bdd3810fb011161306c33",class:" text-left p-0 m-0  dialog-title "},O.entries.Lcz_EventsLog)),C("/Get_Exposed_Booking_Events")?i("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},i("ir-spinner",null)):i(s,null,i("table",{class:" dialog-container-height"},i("thead",{style:{opacity:"0"}},i("tr",null,i("th",null,"date"),i("th",null,"user"),i("th",null,"status"))),i("tbody",null,(e=this.bookingEvents)===null||e===void 0?void 0:e.map((e=>i("tr",{key:e.id,class:"pb-1"},i("td",{class:"event-row dates-row"},i("span",null,e.date),i("span",null,String(e.hour).padStart(2,"0"),":",String(e.minute).padStart(2,"0"),":",String(e.second).padStart(2,"0"))),i("td",{class:"pl-3 event-row "},e.type),i("td",{class:"pl-1 event-row "},e.user))))))))}};Ee.style=Ie;const Me=".sc-ir-extra-service-h{display:block}.extra-service-container.sc-ir-extra-service{display:flex;align-items:start;justify-content:space-between;gap:0.5rem}.extra-service-container.sc-ir-extra-service *.sc-ir-extra-service{padding:0;margin:0;box-sizing:border-box}.extra-service-actions.sc-ir-extra-service{display:flex;align-items:center;gap:0.5rem}.extra-service-conditional-date.sc-ir-extra-service{margin-top:0.5rem}.extra-service-price.sc-ir-extra-service{white-space:nowrap}.extra-service-description.sc-ir-extra-service{word-break:break-all}";const Be=Me;const Se=class{constructor(i){e(this,i);this.editExtraService=t(this,"editExtraService",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.bookingService=new r}async deleteService(){try{await this.bookingService.doBookingExtraService({service:this.service,is_remove:true,booking_nbr:this.bookingNumber});this.resetBookingEvt.emit(null)}catch(e){console.log(e)}}render(){return i(a,{key:"c27d94a1710cf991ceab294598e76ea9784bab82"},i("div",{key:"61ef29b41f73782c13db9f8a42fbe74820218bbd",class:"p-1"},i("div",{key:"8b0608696bfc853e6945b4ec90e1823a327aa5af",class:"extra-service-container"},i("p",{key:"4447c2d5743610f9994678d4986712856087a86c",class:"extra-service-description"},this.service.description),i("div",{key:"ce95afcbe3c2729d43ad1295379929250126a5a8",class:"extra-service-actions"},!!this.service.price&&this.service.price>0&&i("p",{key:"074934359a8db0b6dbd9f69dc670ae4e04b83f01",class:"extra-service-price p-0 m-0 font-weight-bold"},y(this.currencySymbol,this.service.price)),i("ir-button",{key:"daad82b348c141f60ec4306737080d75d8e0d913",id:`serviceEdit-${this.service.booking_system_id}`,class:"extra-service-edit-btn m-0 p-0",variant:"icon",icon_name:"edit",style:S.secondary,onClickHandler:()=>this.editExtraService.emit(this.service)}),i("ir-button",{key:"29d9431c1334c3121e27620148bba06683a8bace",class:"extra-service-delete-btn m-0 p-0",variant:"icon",onClickHandler:()=>this.irModalRef.openModal(),id:`roomDelete-${this.service.booking_system_id}`,icon_name:"trash",style:S.danger}))),i("div",{key:"e2d9db6b2a244fafe9914c58c5cff3d40899e651",class:"extra-service-conditional-date"},this.service.start_date&&this.service.end_date?i("ir-date-view",{class:"extra-service-date-view mr-1",from_date:this.service.start_date,to_date:this.service.end_date,showDateDifference:false}):this.service.start_date&&i("p",{class:"extra-service-date-view"},D(new Date(this.service.start_date)).format("MMM DD, YYYY")))),i("ir-modal",{key:"5511cf100769738fdc9a3e163c0479e6aa493cf3",autoClose:false,ref:e=>this.irModalRef=e,isLoading:C("/Do_Booking_Extra_Service"),onConfirmModal:this.deleteService.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:O.entries.Lcz_Cancel,rightBtnText:O.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:O.entries.Lcz_Confirmation,modalBody:`${O.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${O.entries.Lcz_ThisService} ${O.entries.Lcz_FromThisBooking}`}))}};Se.style=Be;const je=j.object({type:j.object({code:j.union([j.string().min(3),j.literal("")]).optional(),description:j.union([j.string(),j.literal("")]).optional()}),number:j.union([j.string().min(2),j.literal("")]).optional().nullable()});const Ae=j.object({id:j.number().optional(),first_name:j.union([j.string().min(2),j.literal("")]).optional(),last_name:j.union([j.string().min(2),j.literal("")]).optional(),country_id:j.coerce.number().min(0).optional(),dob:j.string().nullable().optional().refine((e=>e===undefined||D(e,"DD/MM/YYYY",true).isValid()||e===""||e===null),"Invalid date format").transform((e=>{if(e===undefined||e===""||e===null)return null;const t=D(e,"DD/MM/YYYY",true).isValid();return t?null:D(e,"DD/MM/YYYY").format("YYYY-MM-DD")})),id_info:je.optional(),is_main:j.boolean().default(false)});function Re(e){var t;Ae.parse(e);const i=e=>e!==null&&e!==undefined&&e.trim()!=="";const s=[];if(e.is_main){if(!i(e.first_name)){s.push({path:["first_name"],code:R.custom,message:"First name is required for main guest"})}if(!i(e.last_name)){s.push({path:["last_name"],code:R.custom,message:"Last name is required for main guest"})}}const a=i(e.first_name)||i(e.last_name)||i(e.dob)||e.country_id!==null&&e.country_id!==undefined&&e.country_id>0||i((t=e.id_info)===null||t===void 0?void 0:t.number);if(a){if(!i(e.first_name)){s.push({path:["first_name"],code:R.custom,message:"First name is required when other guest information is provided"})}if(!i(e.last_name)){s.push({path:["last_name"],code:R.custom,message:"Last name is required when other guest information is provided"})}}if(s.length>=1){throw new A(s)}}const Ne=j.object({booking_system_id:j.number().optional(),cost:j.coerce.number().nullable(),currency_id:j.number().min(1),description:j.string().min(1),end_date:j.string().nullable(),price:j.coerce.number(),start_date:j.string().nullable(),system_id:j.number().optional()});const Le=".sc-ir-extra-service-config-h{display:block;--ir-input-border-color:#cacfe7}.sc-ir-extra-service-config-h .input-group-text.sc-ir-extra-service-config{border-color:var(--ir-input-border-color)}.currency-ph.sc-ir-extra-service-config{padding:0;margin:0;color:#3b4781;display:flex;align-items:center;justify-content:center;padding:0 0 0 0.25rem;border-top:1px solid var(--ir-input-border-color);border-bottom:1px solid var(--ir-input-border-color);border-left:1px solid transparent;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.service-description-input.sc-ir-extra-service-config{height:70px !important}.service-description.sc-ir-extra-service-config .input-group-prepend.sc-ir-extra-service-config{background-color:#f4f5fa;border:1px solid var(--ir-input-border-color);border-top-left-radius:0.25rem;border-bottom-left-radius:0.25rem}.service-date-container.sc-ir-extra-service-config{padding:0;margin:0;display:flex;align-items:center;position:relative;width:100%;justify-content:center}.service-date-container.sc-ir-extra-service-config .btn-container.sc-ir-extra-service-config{position:absolute;right:5px;margin:0;display:flex;align-items:center;justify-content:center;padding:0}.service-description.sc-ir-extra-service-config .input-group-text.sc-ir-extra-service-config{height:fit-content;border:0;padding-top:0.75rem !important}.price-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config,.cost-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config{border-top:1px solid #1e9ff2;border-bottom:1px solid #1e9ff2;border-left:1px solid #1e9ff2}.currency-ph[data-state='error'].sc-ir-extra-service-config{border-color:var(--red, #ff4961)}.price-input.sc-ir-extra-service-config:focus{border-right-width:1px !important}.is-invalid.sc-ir-extra-service-config{background-image:none !important}.price-input.sc-ir-extra-service-config,.cost-input.sc-ir-extra-service-config{border-left:0}.row-group.sc-ir-extra-service-config{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 640px){.row-group.sc-ir-extra-service-config{flex-direction:row;align-items:center;gap:0}.cost-label.sc-ir-extra-service-config{border-top-left-radius:0;border-bottom-left-radius:0;border-left:0}.until-prepend.sc-ir-extra-service-config,.cost-input-placeholder.sc-ir-extra-service-config{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.date-from.sc-ir-extra-service-config,.price-input.sc-ir-extra-service-config{border-right-width:0 !important;border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}}.date-focused.sc-ir-extra-service-config{border-color:#1e9ff2}";const ze=Le;const $e=".sc-ir-extra-service-config-h{height:100%}.sheet-container.sc-ir-extra-service-config{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-extra-service-config{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-extra-service-config{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-extra-service-config{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-extra-service-config{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-extra-service-config{flex-direction:row;align-items:center}}";const Pe=$e;const Ge=class{constructor(i){e(this,i);this.closeModal=t(this,"closeModal",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.bookingService=new r}componentWillLoad(){if(this.service){this.s_service=Object.assign({},this.service)}}async saveAmenity(){try{Ne.parse(this.s_service);await this.bookingService.doBookingExtraService({service:this.s_service,booking_nbr:this.booking.booking_nbr,is_remove:false});this.resetBookingEvt.emit(null);this.closeModal.emit(null)}catch(e){if(e instanceof A){this.error=true}console.error(e)}}updateService(e){let t=this.s_service;if(!t){t={cost:null,description:null,end_date:null,start_date:null,price:null,currency_id:this.booking.currency.id}}this.s_service=Object.assign(Object.assign({},t),e)}validatePrice(){var e,t,i,s;if(((e=this.s_service)===null||e===void 0?void 0:e.price)===undefined||((i=(t=this.s_service)===null||t===void 0?void 0:t.price)===null||i===void 0?void 0:i.toString())===""){return false}const a=Ne.pick({price:true});const o=a.safeParse({price:(s=this.s_service)===null||s===void 0?void 0:s.price});return o.success}render(){var e,t,s,a,o,n,r,c,l,d,h,p,f,u;return i("form",{key:"f8bd9a5202fd899facfe900128c8d56bf4a8e7ef",class:"sheet-container",onSubmit:async e=>{e.preventDefault();await this.saveAmenity()}},i("ir-title",{key:"c6afac1577b2deff5f61dc24415469638b986174",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:O.entries.Lcz_ExtraServices,displayContext:"sidebar"}),i("section",{key:"8d6aab346073f4039c7b68c0156e86933976c012",class:"px-1 sheet-body"},i("fieldset",{key:"03334d806aaba87a73554ad2d45b70fae7736bfc",class:"input-group mb-1 service-description"},i("div",{key:"530fc4331dd39e457dd7717e4502755b13d4ed39",class:"input-group-prepend"},i("span",{key:"cd755a1955705a9913b49fbd22e755415beaa47e",class:"input-group-text"},O.entries.Lcz_Description)),i("textarea",{key:"2786e785a2cb7da4c1e25a7d637bb9b7c50b8b91",value:(e=this.s_service)===null||e===void 0?void 0:e.description,class:`form-control service-description-input ${this.error&&!((t=this.s_service)===null||t===void 0?void 0:t.description)?"is-invalid":""}`,style:{height:"7rem"},maxLength:250,onChange:e=>this.updateService({description:e.target.value}),"aria-label":"Amenity description"})),i("div",{key:"c735e26a8d877817a9dce04e79e2051d9c9112cb",class:"row-group mb-1"},i("div",{key:"6ebf0053bb2844c1d9ecc9c81a64d82f760248af",class:"input-group"},i("div",{key:"c83ca3bd6b8b5178d2a4f6307f84acb1a433fc78",class:"input-group-prepend"},i("span",{key:"39bef9d2ea5a77de5aea08b0f360b1189ca8f0c1",class:"input-group-text",id:"basic-addon1"},O.entries.Lcz_DatesOn)),i("div",{key:"ead019a28cc9f69cc6c868f2db368b2245117b88",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from"},i("div",{key:"ea266e480a2ce5c64fec3370958dc6107c0b19f7",class:"service-date-container"},i("ir-date-picker",{key:"ba7215b64215012e426f7dd7770c771a2474b5f9",emitEmptyDate:true,date:(s=this.s_service)===null||s===void 0?void 0:s.start_date,minDate:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:e=>{var t;return this.updateService({start_date:(t=e.detail.start)===null||t===void 0?void 0:t.format("YYYY-MM-DD")})}},i("input",{key:"d8e9b44a995f9be5b6414a9a9b0e90aa3d40daaa",type:"text",slot:"trigger",value:((a=this.s_service)===null||a===void 0?void 0:a.start_date)?N(this.s_service.start_date):null,style:{borderLeftWidth:"0",borderRightWidth:"0",width:"100%",borderRadius:"0"},class:"text-center w-100 form-control input-sm"})),((o=this.s_service)===null||o===void 0?void 0:o.start_date)&&i("div",{key:"fd7ed32e7db65d8539e1c0c1a3aa260122a407bf",class:"btn-container"},i("ir-button",{key:"f9bb8d6dd692d44ae8a3ca7f58d69011db214b31",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:e=>{e.stopImmediatePropagation();e.stopPropagation();this.updateService({start_date:null})}}))))),i("div",{key:"92d36dd21ef90cad79510061a9b2e456183a2bf3",class:"input-group"},i("div",{key:"8bc2d8ba8a732a02c0d91f5bdd1b0d2bd41f57f4",class:"input-group-prepend "},i("span",{key:"c8b76aca071ac48e4408561a94c9c2be6570cd88",class:"input-group-text until-prepend",id:"basic-addon1"},O.entries.Lcz_TillAndIncluding)),i("div",{key:"3f45d7c79699ee3e2d0b569c109da35adeafa030",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center"},i("div",{key:"d42640d39101bec44f6ae3cd8e6323c193d5907c",class:"service-date-container"},i("ir-date-picker",{key:"5d1166d56045532d692ab5cace1b03c76fa01bdd",emitEmptyDate:true,date:(n=this.s_service)===null||n===void 0?void 0:n.end_date,minDate:(c=(r=this.s_service)===null||r===void 0?void 0:r.start_date)!==null&&c!==void 0?c:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:e=>{var t;e.stopImmediatePropagation();e.stopPropagation();this.updateService({end_date:(t=e.detail.start)===null||t===void 0?void 0:t.format("YYYY-MM-DD")})}},i("input",{key:"3eac663f700edf775cd07f7e89f8bcb56879ce5c",slot:"trigger",value:((l=this.s_service)===null||l===void 0?void 0:l.end_date)?N(this.s_service.end_date):null,style:{borderLeftWidth:"0",borderRightWidth:"0",width:"100%"},class:"text-center form-control input-sm"})),((d=this.s_service)===null||d===void 0?void 0:d.end_date)&&i("div",{key:"a3810aeeb7477651502d412e755f01d76e48c3d8",class:"btn-container"},i("ir-button",{key:"957b91a01649813d95dda8d14f3b8dd23b7cd0dd",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:e=>{e.stopImmediatePropagation();e.stopPropagation();this.updateService({end_date:null})}})))))),i("div",{key:"4a09784366b0462d7973d5d3e276ab59b020c55e",class:"row-group"},i("ir-price-input",{key:"89bcecd47b8150e1caa77d2a05565eb1a9bbf4de",label:"Price",currency:this.booking.currency.symbol,class:"ir-br-input-none",value:(p=(h=this.s_service)===null||h===void 0?void 0:h.price)===null||p===void 0?void 0:p.toString(),zod:Ne.pick({price:true}),"aria-label":O.entries.Lcz_Price,wrapKey:"price","aria-describedby":"service price",autoValidate:false,"data-state":this.error&&!this.validatePrice()?"error":"",onTextChange:e=>this.updateService({price:parseFloat(e.detail)})}),i("ir-price-input",{key:"bc3c1feea67c2bf43c22c58cc76ec8f1aae56afd",autoValidate:false,label:O.entries.Lcz_Cost,labelStyle:"rounded-0 border-left-0",currency:this.booking.currency.symbol,value:(u=(f=this.s_service)===null||f===void 0?void 0:f.cost)===null||u===void 0?void 0:u.toString(),zod:Ne.pick({cost:true}),onTextChange:e=>this.updateService({cost:parseFloat(e.detail)}),wrapKey:"cost","aria-label":"Cost","aria-describedby":"service cost"}))),i("div",{key:"f9395cf9b4698fc91d28c130c0cd26386bd2288a",class:"sheet-footer"},i("ir-button",{key:"2c60bacd835cceff319d8d5034e66f22043c1e3c",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:O.entries.Lcz_Cancel,btn_color:"secondary"}),i("ir-button",{key:"b60099bd600e6ebca0cb38448c8fda123c389009",btn_styles:"justify-content-center align-items-center",class:"flex-fill",btn_type:"submit",isLoading:C("/Do_Booking_Extra_Service"),text:O.entries.Lcz_Save,btn_color:"primary"})))}};Ge.style=ze+Pe;const He=".sc-ir-extra-services-h{display:block}";const Ue=He;const Fe=class{constructor(t){e(this,t)}render(){var e;return i(a,{key:"7dcb2166f8c3df55e0ccda040d84406ac44e34cc",class:"card p-0 "},(e=this.booking.extra_services)===null||e===void 0?void 0:e.map(((e,t)=>i(s,null,i("ir-extra-service",{bookingNumber:this.booking.booking_nbr,currencySymbol:this.booking.currency.symbol,key:e.booking_system_id,service:e}),t!==this.booking.extra_services.length-1&&i("hr",{class:"mr-2 ml-2 my-0 p-0"})))))}};Fe.style=Ue;const Ke=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}.loading-container.sc-ir-guest-info{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}";const Ve=Ke;const We=".sc-ir-guest-info-h{height:100%}.sheet-container.sc-ir-guest-info{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-guest-info{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-guest-info{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-guest-info{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-guest-info{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-guest-info{flex-direction:row;align-items:center}}";const qe=We;const Xe=class{constructor(i){e(this,i);this.closeSideBar=t(this,"closeSideBar",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.toast=t(this,"toast",7);this.guest=null;this.isLoading=true;this.autoValidate=false;this.bookingService=new r;this.roomService=new E;this.token=new B}async componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}if(!!this.token.getToken())this.init()}ticketChanged(e,t){if(e===t){return}this.token.setToken(this.ticket);this.init()}async init(){try{console.log("first");this.isLoading=true;const[e,t,i]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language),!O||!O.entries||Object.keys(O.entries).length===0?this.roomService.fetchLanguage(this.language):Promise.resolve(null)]);if(i){O.entries=i.entries;O.direction=i.direction}this.countries=t;this.guest=Object.assign(Object.assign({},e),{mobile:e.mobile_without_prefix})}catch(e){console.log(e)}finally{this.isLoading=false}}handleInputChange(e){this.guest=Object.assign(Object.assign({},this.guest),e)}async editGuest(){var e;try{this.autoValidate=true;await this.bookingService.editExposedGuest(this.guest,(e=this.booking_nbr)!==null&&e!==void 0?e:null);this.toast.emit({type:"success",description:"",title:"Saved Successfully",position:"top-right"});this.closeSideBar.emit(null);this.resetBookingEvt.emit(null)}catch(e){console.log(e)}}render(){var e,t,a,o,n,r,c,l,d,h,p,f;if(this.isLoading&&this.isInSideBar){i("div",{class:"loading-container"},i("ir-spinner",null))}if(this.isLoading){return null}return i("form",{class:"p-0 sheet-container",onSubmit:async e=>{e.preventDefault();await this.editGuest()}},!this.isInSideBar&&[i("ir-toast",null),i("ir-interceptor",null)],this.headerShown&&i("ir-title",{class:"px-1 sheet-header",displayContext:"sidebar",label:O.entries.Lcz_GuestDetails}),i("div",{class:this.isInSideBar?"sheet-body":"card-content collapse show "},i("div",{class:this.headerShown?"card-body px-1 pt-0":"pt-0"},i("ir-input-text",{autoValidate:this.autoValidate,label:(e=O.entries)===null||e===void 0?void 0:e.Lcz_FirstName,name:"firstName",value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:e=>this.handleInputChange({first_name:e.detail})}),i("ir-input-text",{autoValidate:this.autoValidate,label:(a=O.entries)===null||a===void 0?void 0:a.Lcz_LastName,name:"lastName",value:(o=this.guest)===null||o===void 0?void 0:o.last_name,required:true,onTextChange:e=>this.handleInputChange({last_name:e.detail})}),i("ir-input-text",{label:(n=O.entries)===null||n===void 0?void 0:n.Lcz_Email,name:"email",value:(r=this.guest)===null||r===void 0?void 0:r.email,required:true,onTextChange:e=>this.handleInputChange({email:e.detail})}),i("ir-input-text",{label:(c=O.entries)===null||c===void 0?void 0:c.Lcz_AlternativeEmail,name:"altEmail",value:(l=this.guest)===null||l===void 0?void 0:l.alternative_email,onTextChange:e=>this.handleInputChange({alternative_email:e.detail})}),i("ir-country-picker",{country:this.countries.find((e=>e.id===this.guest.country_id)),label:(d=O.entries)===null||d===void 0?void 0:d.Lcz_Country,onCountryChange:e=>this.handleInputChange({country_id:e.detail.id}),countries:this.countries}),i("ir-phone-input",{onTextChange:e=>{e.stopImmediatePropagation();e.stopPropagation();const{mobile:t,phone_prefix:i}=e.detail;if(t!==this.guest.mobile){this.handleInputChange({mobile:t})}if(i!==this.guest.country_phone_prefix)this.handleInputChange({country_phone_prefix:i})},phone_prefix:this.guest.country_phone_prefix,value:this.guest.mobile,language:this.language,label:(h=O.entries)===null||h===void 0?void 0:h.Lcz_MobilePhone,countries:this.countries}),i("div",{class:"mb-2"},i("ir-textarea",{variant:"prepend",onTextChange:e=>this.handleInputChange({notes:e.detail}),value:(p=this.guest)===null||p===void 0?void 0:p.notes,label:(f=O.entries)===null||f===void 0?void 0:f.Lcz_PrivateNote})),i("div",{class:"p-0 m-0"},i("label",{class:`check-container m-0 p-0`},i("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:e=>this.handleInputChange({subscribe_to_news_letter:e.target.checked})}),i("span",{class:"checkmark m-0 p-0"}),i("span",{class:"m-0 p-0  check-label"},O.entries.Lcz_Newsletter)),!this.isInSideBar&&i(s,null,i("hr",null),i("ir-button",{btn_styles:"d-flex align-items-center justify-content-center",text:O.entries.Lcz_Save,onClickHandler:this.editGuest.bind(this),isLoading:C("/Edit_Exposed_Guest"),color:"btn-primary"}))))),this.isInSideBar&&i("div",{class:"sheet-footer"},i("ir-button",{"data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill m-0 p-0",btn_styles:"w-100 m-0  justify-content-center align-items-center",btn_color:"secondary",text:O.entries.Lcz_Cancel}),i("ir-button",{"data-testid":"save",isLoading:C("/Edit_Exposed_Guest"),btn_disabled:this.isLoading,class:"flex-fill m-0",btn_type:"submit",btn_styles:"w-100 m-0  justify-content-center align-items-center",text:O.entries.Lcz_Save})))}static get watchers(){return{ticket:["ticketChanged"]}}};Xe.style=Ve+qe;const Qe=".sc-ir-payment-action-h{display:block;--label-col:6rem;--amount-col:1ch;--payment-action-bg:rgba(255, 73, 97, 10%);--payment-action-border:rgba(255, 73, 97, 40%)}.action-container.overdue.sc-ir-payment-action{--payment-action-bg:rgba(255, 73, 97, 5%);--payment-action-border:rgba(255, 73, 97, 40%)}.action-container.future.sc-ir-payment-action{--payment-action-bg:rgb(30, 159, 242, 5%);--payment-action-border:rgba(30, 159, 242, 40%)}.action-container.overdue.sc-ir-payment-action:hover{--payment-action-bg:rgba(255, 73, 97, 10%);--payment-action-border:rgba(255, 73, 97, 50%)}.action-container.future.sc-ir-payment-action:hover{--payment-action-bg:rgb(30, 159, 242, 10%);--payment-action-border:rgba(30, 159, 242, 50%)}.action-container.sc-ir-payment-action{display:flex;align-items:center;gap:1rem;background:var(--payment-action-bg);padding:0.5rem 1rem;box-sizing:border-box;border:1px solid var(--payment-action-border);border-radius:0.25rem;transition:all 0.3s ease-in-out}.overdue_action.sc-ir-payment-action,.future_action.sc-ir-payment-action{display:inline-flex;align-items:center;gap:0.5rem;border-radius:0.25rem;min-width:0}.action-container.overdue.sc-ir-payment-action .overdue_action.sc-ir-payment-action{color:#ff4961}.future_action.sc-ir-payment-action{color:#1e9ff2}.payment-meta.sc-ir-payment-action{display:flex;align-items:center;gap:1rem}.alert-message.sc-ir-payment-action{display:none}.action-container.overdue.sc-ir-payment-action .alert-message.sc-ir-payment-action{text-transform:capitalize}.amount_action.sc-ir-payment-action{font-weight:600;font-variant-numeric:tabular-nums;text-align:right;justify-self:end;white-space:nowrap}.meta-grid.sc-ir-payment-action{display:flex;flex-direction:column;flex:1 1 0%}.payment-reason.sc-ir-payment-action{font-size:12px;color:hsl(230, 10%, 46%, 80%)}.date_action.sc-ir-payment-action{font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.action-container.sc-ir-payment-action p.sc-ir-payment-action{margin:0;padding:0}.action-row.sc-ir-payment-action{display:contents}@media (min-width: 640px){.sc-ir-payment-action-h{--amount-col:8ch}.alert-message.sc-ir-payment-action{display:inline-flex}.amount_action.sc-ir-payment-action{justify-self:auto}.action-container.sc-ir-payment-action{display:grid;grid-template-columns:var(--label-col) 1fr auto;align-items:center}.payment-meta.sc-ir-payment-action{display:grid;grid-template-columns:var(--amount-col) 1fr;align-items:center;column-gap:1rem;min-width:0}}";const Ze=Qe;const Je=class{constructor(i){e(this,i);this.generatePayment=t(this,"generatePayment",7)}render(){const e=this.paymentAction.type.toLowerCase();const t=e==="future";return i("div",{key:"a0c1de8da0c96b0ba1d03e19901366a26245baf8",class:`action-container ${t?"future":"overdue"}`},i("div",{key:"596590dcef716f23b191f8f13e71cdc8f8144ed4",class:"action-row"},!t&&i("div",{key:"4fa7b061fc8444d2ec94d3d17c6f049755ac8d2c",class:"overdue_action"},i("svg",{key:"06156c7f0a9ef6cc890bff665caf742803184caf",height:16,width:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},i("path",{key:"41f1fe45c1ffb9bce8c8bcbfa5a0c20ccf600342",fill:"currentColor",d:"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})),i("span",{key:"82126fb4e4a5d33a2da8d1d60de23d9521b6343f",class:"alert-message"},e)),e==="future"&&this.paymentAction.amount>0&&i("div",{key:"b3c43d1245c39a302601ca1bd906b9d2c9cdba3b",class:"future_action "},i("svg",{key:"478944ba35ad9df65ab1760948ed03ac45384136",xmlns:"http://www.w3.org/2000/svg",height:16,width:16,viewBox:"0 0 512 512"},i("path",{key:"49600735567142c3eca4cd5a1122364a32d392b0",fill:"currentColor",d:"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"})),i("span",{key:"d181b5c72fe65e48e1fd866a9e1a032ed59ec1ec",class:"alert-message"},D(new Date(this.paymentAction.due_on)).isSame(new Date)?"Today":"Future")),i("div",{key:"710698a3d329b2676406f8cc525e62b3626aa8fc",class:"meta-grid"},i("div",{key:"c1a7f4ce2bd44d5c9090e18c968393bcbb818db4",class:"payment-meta"},i("p",{key:"59aa2698dce216918690c25a8767df7e54cefea0",class:"amount_action"},y(this.paymentAction.currency.symbol,this.paymentAction.amount)),i("p",{key:"6e815eafef093d3e5ff7603ecb1a8604f94fc419",class:"date_action"},D(new Date(this.paymentAction.due_on)).format("ddd, MMM DD YYYY"))))),i("div",{key:"12c261a6ad92f6df2f6f354506b7632649cd58ff",style:{width:"fit-content"}},i("ir-button",{key:"479215e1b9695892f500fae6d0bcdaaa54600ca7",btn_color:"dark",text:"Pay",size:"sm",onClickHandler:()=>this.generatePayment.emit(this.paymentAction)})))}};Je.style=Ze;const et=".sc-ir-payment-actions-h{display:block}.sc-ir-payment-actions-h p.sc-ir-payment-actions,.sc-ir-payment-actions-h div.sc-ir-payment-actions,.sc-ir-payment-actions-h span.sc-ir-payment-actions,.sc-ir-payment-actions-h ir-icons.sc-ir-payment-actions{box-sizing:border-box;padding:0;margin:0}.beta.sc-ir-payment-actions{background:var(--red);color:white;padding:0.2rem 0.3rem !important;font-size:12px;border-radius:4px;margin:0}.payment-actions-container.sc-ir-payment-actions{display:flex;flex-direction:column;gap:0.5rem}";const tt=et;const it=class{constructor(t){e(this,t)}render(){var e,t;if(((e=this.paymentAction)===null||e===void 0?void 0:e.filter((e=>e.amount!==0)).length)==0){return null}return i(a,null,i("div",{class:"my-1 d-flex align-items-center",style:{gap:"0.5rem"}},i("p",{class:"font-size-large p-0 m-0 "},"Payment Actions"),i("span",{class:"beta"},"Beta")),i("div",{class:"payment-actions-container"},(t=this.paymentAction)===null||t===void 0?void 0:t.map(((e,t)=>i("ir-payment-action",{key:e.due_on+t,paymentAction:e})))))}};it.style=tt;const st=".sc-ir-payment-details-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-payment-details-h *.sc-ir-payment-details{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}.total-cost-container.sc-ir-payment-details{background:#7cbebe;color:white;padding:0.5rem;border-radius:5px}";const at=st;const ot=class{constructor(i){e(this,i);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.resetExposedCancellationDueAmount=t(this,"resetExposedCancellationDueAmount",7);this.toast=t(this,"toast",7);this.openSidebar=t(this,"openSidebar",7);this.confirmModal=false;this.toBeDeletedItem=null;this.modalMode=null;this.paymentService=new M;this.bookingService=new r;this.handleAddPayment=()=>{this.openSidebar.emit({type:"payment-folio",payload:{payment:{id:-1,date:D().format("YYYY-MM-DD"),amount:null,currency:undefined,designation:null,reference:null},mode:"new"}})};this.handleEditPayment=e=>{this.openSidebar.emit({type:"payment-folio",payload:{payment:e,mode:"edit"}})};this.handleDeletePayment=e=>{this.modalMode="delete";this.toBeDeletedItem=e;this.openModal()};this.handleConfirmModal=async e=>{e.stopImmediatePropagation();e.stopPropagation();if(this.modalMode==="delete"){await this.cancelPayment()}};this.handleCancelModal=e=>{e.stopImmediatePropagation();e.stopPropagation();this.modalMode=null;this.toBeDeletedItem=null}}handlePaymentGeneration(e){var t,i;const s=e.detail;const a=(t=this.paymentTypes)===null||t===void 0?void 0:t.find((e=>e.CODE_NAME===(this.booking.status.code==="003"?s.pay_type_code:"001")));this.openSidebar.emit({type:"payment-folio",payload:{payment:Object.assign(Object.assign({},s),{date:D().format("YYYY-MM-DD"),id:-1,amount:s.amount,payment_type:a?{code:a.CODE_NAME,description:a.CODE_VALUE_EN,operation:a.NOTES}:null,designation:(i=a===null||a===void 0?void 0:a.CODE_VALUE_EN)!==null&&i!==void 0?i:null}),mode:"payment-action"}})}async cancelPayment(){try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const e=this.booking.financial.payments.filter((e=>e.id!==this.toBeDeletedItem.id));this.booking=Object.assign(Object.assign({},this.booking),{financial:Object.assign(Object.assign({},this.booking.financial),{payments:e})});this.confirmModal=false;this.resetBookingEvt.emit(null);this.resetExposedCancellationDueAmount.emit(null);this.toBeDeletedItem=null;this.modalMode=null}catch(e){console.error("Error canceling payment:",e);this.toast.emit({type:"error",title:"Error",description:"Failed to cancel payment. Please try again.",position:"top-right"})}}openModal(){const e=document.querySelector(".delete-record-modal");e===null||e===void 0?void 0:e.openModal()}hasValidFinancialData(){var e;return Boolean((e=this.booking)===null||e===void 0?void 0:e.financial)}shouldShowPaymentActions(){var e;return Boolean(((e=this.paymentActions)===null||e===void 0?void 0:e.filter((e=>e.amount!==0)).length)>0&&this.booking.is_direct)}render(){if(!this.hasValidFinancialData()){return null}const{financial:e,currency:t}=this.booking;return[i("div",{class:"card p-1"},i("ir-payment-summary",{totalCost:e.gross_cost,balance:e.due_amount,collected:this.booking.financial.collected,currency:t}),i("ir-booking-guarantee",{booking:this.booking,bookingService:this.bookingService}),this.shouldShowPaymentActions()&&i("ir-payment-actions",{paymentAction:this.paymentActions,booking:this.booking})),i("ir-payments-folio",{paymentTypes:this.paymentTypes,payments:e.payments||[],onAddPayment:this.handleAddPayment,onEditPayment:e=>this.handleEditPayment(e.detail),onDeletePayment:e=>this.handleDeletePayment(e.detail)}),i("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:O.entries.Lcz_Confirmation,modalBody:this.modalMode==="delete"?O.entries.Lcz_IfDeletedPermantlyLost:O.entries.Lcz_EnteringAmountGreaterThanDue,iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:O.entries.Lcz_Cancel,rightBtnText:this.modalMode==="delete"?O.entries.Lcz_Delete:O.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modalMode==="delete"?"danger":"primary",onConfirmModal:this.handleConfirmModal,onCancelModal:this.handleCancelModal})]}};ot.style=at;const nt=".sc-ir-payment-folio-h{display:block;--payment-type-badge-bg:#ff4961}.payment-type-badge.sc-ir-payment-folio{background:var(--payment-type-badge-bg);color:white;padding:0.2rem 0.3rem !important;font-size:12px;border-radius:4px;margin:0;text-transform:capitalize}.credit-badge.sc-ir-payment-folio{--payment-type-badge-bg:#629a4c}.debit-badge.sc-ir-payment-folio{--payment-type-badge-bg:#ff4961}.dropdown-item-payment.sc-ir-payment-folio{display:flex;align-items:center;gap:1rem;box-sizing:border-box;justify-content:space-between}.input-group-text.sc-ir-payment-folio{border-color:#cacfe7 !important}";const rt=nt;const ct=".sc-ir-payment-folio-h{height:100%}.sheet-container.sc-ir-payment-folio{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-payment-folio{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-payment-folio{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-payment-folio{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-payment-folio{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-payment-folio{flex-direction:row;align-items:center}}";const lt=ct;const dt=class{constructor(i){e(this,i);this.closeModal=t(this,"closeModal",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.resetExposedCancellationDueAmount=t(this,"resetExposedCancellationDueAmount",7);this.payment={date:D().format("YYYY-MM-DD"),amount:0,designation:undefined,currency:null,reference:null,id:-1};this.autoValidate=false;this._paymentTypes={};this.paymentService=new M}componentWillLoad(){this.folioSchema=j.object({date:j.string().regex(/^\d{4}-\d{2}-\d{2}$/).refine((e=>{const t=D(e,"YYYY-MM-DD",true);return t.isValid()}),{message:`Invalid date`}),amount:j.coerce.number().refine((e=>e!==0)),reference:j.string().optional().nullable(),designation:j.string().min(1),payment_type:j.object({code:j.string().min(3).max(4),description:j.string().min(1),operation:j.union([j.literal("CR"),j.literal("DB")])})});if(this.payment){this.folioData=Object.assign({},this.payment)}this.getPaymentTypes()}handlePaymentChange(e,t){if(e!==t&&e){this.folioData=Object.assign({},e);this.getPaymentTypes()}}handlePaymentTypesChange(e,t){if(e!==t&&e){this.getPaymentTypes()}}updateFolioData(e){this.folioData=Object.assign(Object.assign({},this.folioData),e)}async savePayment(){var e,t,i;try{this.isLoading=true;this.autoValidate=true;if(this.errors){this.errors=null}this.folioSchema.parse((e=this.folioData)!==null&&e!==void 0?e:{});await this.paymentService.AddPayment(Object.assign(Object.assign({},this.folioData),{currency:T.currency,reference:(t=this.folioData.reference)!==null&&t!==void 0?t:"",designation:(i=this.folioData.payment_type)===null||i===void 0?void 0:i.description}),this.bookingNumber);this.resetBookingEvt.emit(null);this.resetExposedCancellationDueAmount.emit(null);this.closeModal.emit(null)}catch(e){const t={};if(e instanceof A){e.issues.forEach((e=>{t[e.path[0]]=true}))}console.error(e);this.errors=t}finally{this.isLoading=false}}handleDropdownChange(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail.toString();console.log(t);this.updateFolioData({designation:t});if(!e.detail){this.updateFolioData({payment_type:null})}else{const i=this.paymentTypes.find((e=>e.CODE_NAME===t));if(!i){console.warn(`Invalid payment type ${e.detail}`);this.updateFolioData({payment_type:null});return}this.updateFolioData({payment_type:{code:i.CODE_NAME,description:i.CODE_VALUE_EN,operation:i.NOTES}})}}async getPaymentTypes(){var e;const t=f(this.paymentTypes,this.paymentTypesGroups);if(this.mode==="payment-action"&&((e=this.payment.payment_type)===null||e===void 0?void 0:e.code)==="001"){const{PAYMENTS:e,CANCELLATION:i}=t;return this._paymentTypes={PAYMENTS:e,CANCELLATION:i}}this._paymentTypes=t}renderDropdownItems(){return Object.values(this._paymentTypes).map(((e,t)=>i(s,null,e.map((e=>i("ir-dropdown-item",{value:e.CODE_NAME,class:"dropdown-item-payment"},i("span",null,e.CODE_VALUE_EN),i("span",{class:`payment-type-badge ${e.NOTES==="CR"?"credit-badge":"debit-badge"}`},e.NOTES==="CR"?"credit":"debit")))),t!==Object.values(this._paymentTypes).length-1&&i("div",{class:"dropdown-divider"}))))}render(){var e,t,s,a,o,n,r,c,l,d,h,p,f,u,m,b,g,y,v,k,_;return i("form",{key:"2a8187232925f8b7be05a5d4c83701abcf27dac4",class:"sheet-container",onSubmit:async e=>{e.preventDefault();this.savePayment()}},i("ir-title",{key:"92fef2faa274657a0074ebd4ad6fac4c2f62f720",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:this.mode==="edit"?"Edit Folio Entry":"New Folio Entry",displayContext:"sidebar"}),i("section",{key:"112e4ed8720629d140992b968dd620552faa78f6",class:"px-1 sheet-body d-flex flex-column",style:{gap:"1rem"}},i("div",{key:"4c945b8c692f638d45deb09af009b58bc73e2021",class:"d-flex w-fill",style:{gap:"0.5rem"}},i("div",{key:"f38b5fb806b2b2d6d346e1ea3eff9974b59f0052",class:"form-group  mb-0 flex-grow-1"},i("div",{key:"1e1f6b27ce91fa6d76a52120c0e873aed05a3c77",class:"input-group row m-0 flex-grow-1"},i("div",{key:"b3eee69e897bc52904d1d68c8995b969f98c873b",class:`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`},i("label",{key:"7fbc7d39b3dee408e6c364e00fe95654b1eb8614",class:`input-group-text flex-grow-1 text-dark border-theme `},"Date")),i("div",{key:"29a341c6f1fa1254f10e6131e58ee66b8da0146f",class:"form-control  form-control-md col-10 flex-grow-1 d-flex align-items-center px-0 mx-0",style:{border:"0"}},i("style",{key:"ea035d76ff516b1090ceff85159b820e168d3d2b"},`.ir-date-picker-trigger{\n                    width:100%;}`),i("ir-date-picker",{key:"81d8bf5dc04ad2c7a9374a2a4fd562c3e5b5b1be","data-testid":"pickup_date",date:(e=this.folioData)===null||e===void 0?void 0:e.date,class:"w-100",emitEmptyDate:true,maxDate:D().format("YYYY-MM-DD"),"aria-invalid":((t=this.errors)===null||t===void 0?void 0:t.date)&&!((s=this.folioData)===null||s===void 0?void 0:s.date)?"true":"false",onDateChanged:e=>{var t;this.updateFolioData({date:(t=e.detail.start)===null||t===void 0?void 0:t.format("YYYY-MM-DD")})}},i("input",{key:"dd9652b2b802aae27573855b3e5b01a8cfc267ee",type:"text",slot:"trigger",value:((a=this.folioData)===null||a===void 0?void 0:a.date)?D((o=this.folioData)===null||o===void 0?void 0:o.date).format("MMM DD, YYYY"):null,class:`form-control w-100 input-sm ${((n=this.errors)===null||n===void 0?void 0:n.date)&&!((r=this.folioData)===null||r===void 0?void 0:r.date)?"border-danger":""} text-left`,style:{borderTopLeftRadius:"0",borderBottomLeftRadius:"0",width:"100%"}})))))),i("div",{key:"a5dc2a3e812d896d805ed7bba1b163666f6fb268"},i("ir-price-input",{key:"d660d9a7c33fac2a5695470532c5418db78ffa20",containerClassname:"row",labelContainerClassname:"col-4 col-md-3 p-0 text-dark border-0",minValue:0,autoValidate:this.autoValidate,zod:this.folioSchema.pick({amount:true}),wrapKey:"amount",label:"Amount",labelStyle:"flex-grow-1 text-dark  border-theme",error:((c=this.errors)===null||c===void 0?void 0:c.amount)&&!((l=this.folioData)===null||l===void 0?void 0:l.amount),value:(h=(d=this.folioData)===null||d===void 0?void 0:d.amount)===null||h===void 0?void 0:h.toString(),currency:T.currency.symbol,onTextChange:e=>this.updateFolioData({amount:Number(e.detail)})})),i("div",{key:"e34b0067245388db1d9e31cf1510b7e3d079cc07"},i("ir-dropdown",{key:"327379f38b2657d7b6fe46a79097f732d9ac0e51",value:(f=(p=this.folioData)===null||p===void 0?void 0:p.payment_type)===null||f===void 0?void 0:f.code,disabled:((u=this.payment.payment_type)===null||u===void 0?void 0:u.code)!=="001"&&this.mode==="payment-action",onOptionChange:this.handleDropdownChange.bind(this)},i("div",{key:"6b2c28631618121d8323c317af777552133032c2",slot:"trigger",class:"input-group row m-0 "},i("div",{key:"6d4fb964b368f2d6f96246a4c493ac7e09233b97",class:`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`},i("label",{key:"b045229e9e50cb4bb4665185279f8397e9bed1d6",class:`input-group-text flex-grow-1 text-dark  border-theme`},"Transaction type")),i("button",{key:"eb5c06f1d7c43a85a940534148833a74f0f2035d",type:"button",disabled:((m=this.payment.payment_type)===null||m===void 0?void 0:m.code)!=="001"&&this.mode==="payment-action",class:`form-control  d-flex align-items-center cursor-pointer ${((b=this.errors)===null||b===void 0?void 0:b.designation)&&!((g=this.folioData)===null||g===void 0?void 0:g.designation)?"border-danger":""}`},((y=this.folioData)===null||y===void 0?void 0:y.payment_type)?i("span",null,(v=this.folioData.payment_type)===null||v===void 0?void 0:v.description):i("span",null,"Select..."))),i("ir-dropdown-item",{key:"d8660579f05776e7e60080be5920bdd7b5a9fece",value:""},"Select..."),this.renderDropdownItems())),i("div",{key:"7f9f5ab7178e8acba7035b75b405a4ae50783da2"},i("ir-input-text",{key:"0fa31134e58e80cc826add4baa65f08f8fe50744",value:(k=this.folioData)===null||k===void 0?void 0:k.reference,error:(_=this.errors)===null||_===void 0?void 0:_.reference_number,autoValidate:this.autoValidate,zod:this.folioSchema.pick({reference:true}),label:"Reference",maxLength:50,inputContainerStyle:{margin:"0"},onTextChange:e=>this.updateFolioData({reference:e.detail}),labelWidth:3,labelContainerClassname:"col-4 col-md-3"}))),i("div",{key:"9462a08e75bfd69770c700b1cce1ef3aab9a6e79",class:"sheet-footer"},i("ir-button",{key:"ee88fc7781c1ea7367e6d3e65997d9d997fff9a4",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:"Cancel",btn_color:"secondary"}),i("ir-button",{key:"3966efadcc73a1c243511ba5a9634b7f5a1aa003",btn_styles:"justify-content-center align-items-center",class:"flex-fill",isLoading:this.isLoading,text:"Save",btn_color:"primary",btn_type:"submit"})))}static get watchers(){return{payment:["handlePaymentChange"],paymentTypes:["handlePaymentTypesChange"]}}};dt.style=rt+lt;const ht=".payment-item__payment-item{display:flex;flex-direction:column;padding:0.5rem;min-height:3rem}.payment-item__payment-item p{padding:0;margin:0;box-sizing:border-box}.payment-item__payment-body{display:flex;flex-direction:column}.payment-item__payment-fields{display:flex;align-items:center;justify-content:space-between}.payment-item__payment-body .payment-item__payment-reference,.payment-item__payment-body .payment-item__payment-description{display:none}.payment-item__payment-toolbar{display:flex;align-items:center;justify-content:space-between}.payment-item__payment-toolbar .payment-item__payment-amount{display:none}.payment-item__action-button{cursor:pointer}.payment-item__payment-amount{font-weight:700;white-space:nowrap}.payment-item__payment-amount.is-credit{color:#629a4c}.payment-item__payment-amount.is-debit{color:#ff4961}.payment-item__payment-reference{font-size:12px}@media (min-width: 640px){.payment-item__payment-item{flex-direction:row;align-items:center;gap:1rem}.payment-item__payment-item:hover{background:#f4f5fa}.payment-item__payment-item:hover .payment-item__payment-actions{display:inline-flex}.payment-item__payment-body .payment-item__payment-reference,.payment-item__payment-body .payment-item__payment-description,.payment-item__payment-item .payment-item__payment-amount{display:inline-flex}.payment-item__payment-fields .payment-item__payment-amount,.payment-item__payment-toolbar .payment-item__payment-description,.payment-item__payment-item .payment-item__payment-reference,.payment-item__payment-actions{display:none}.payment-item__payment-body .payment-item__payment-reference{display:inline-flex;align-items:center}.payment-item__payment-body{flex:1 1 0%;justify-content:flex-start;gap:0.5rem}.payment-item__payment-fields{justify-content:flex-start;gap:0.5rem}.payment-item__payment-toolbar{gap:0.5rem;align-items:center}}";const pt=ht;const ft=class{constructor(i){e(this,i);this.editPayment=t(this,"editPayment",7);this.deletePayment=t(this,"deletePayment",7)}render(){var e,t,s,a;const o=this.payment.payment_type.operation==="CR";return i("div",{key:"ef49ef3ec25ab7fe065dd4272859a28c687699de",class:"payment-item__payment-item"},i("div",{key:"e0a50f803e04c59fdc2bcc6e722393ed434b883e",class:"payment-item__payment-body",part:"payment-body"},i("div",{key:"3213807247c5cddf3eb69023ce83b0a492cbc905",class:"payment-item__payment-fields",part:"payment-fields"},i("p",{key:"4d8e2f771c3a6ee5304be94068ef67a7646deced",class:"payment-item__payment-date"},this.payment.date),i("p",{key:"5c1a76e1b88321dadd737acff9e94977486cd778",class:`payment-item__payment-amount ${o?"is-credit":"is-debit"}`},y(this.payment.currency.symbol,this.payment.payment_type.code==="012"?this.payment.amount*-1:this.payment.amount)),i("p",{key:"11eb2c639ac121cdca9b8a8b1583436ed994baf5",class:"payment-item__payment-description"},i("b",{key:"f3e473c054eb9459bef9eb6b22eab3b05ab135d8"},(e=this.payment.payment_type.description)!==null&&e!==void 0?e:this.payment.designation))),this.payment.reference&&i("p",{key:"5b7afd273cd84e8d5e192c7d3449d58805fc7723",class:"payment-item__payment-reference"},(t=this.payment)===null||t===void 0?void 0:t.reference)),i("div",{key:"40d7e9601d0f3e269dede735d6f63a5baa3b4d75",class:"payment-item__payment-toolbar"},i("p",{key:"987c3d003417d1c8785296ce41f8ff524f879a88",class:`payment-item__payment-amount ${o?"is-credit":"is-debit"}`},y(this.payment.currency.symbol,this.payment.payment_type.code==="012"?this.payment.amount*-1:this.payment.amount)),i("p",{key:"02393758d4d52fac8555b5cd188b03fcca1995bb",class:"payment-item__payment-description"},i("b",{key:"5f95d873aeff278d1d13b8d12ea8a54b29e353f5"},(s=this.payment.payment_type.description)!==null&&s!==void 0?s:this.payment.designation)),i("div",{key:"33defcba94fd34966174fb3daca9bc50378e153e",class:"payment-item__payment-actions"},i("ir-button",{key:"f5d6338c97b4c7dc9a8f7135d16dd29d259ded6c",class:"payment-item__action-button",variant:"icon",onClickHandler:()=>{this.editPayment.emit(this.payment)},icon_name:"edit",style:S.secondary}),i("ir-button",{key:"b28b7b7a44e426f8253cca811e5ed86e02e4c5c7",class:"payment-item__action-button",onClickHandler:()=>{this.deletePayment.emit(this.payment)},variant:"icon",style:S.danger,icon_name:"trash"}))),this.payment.reference&&i("p",{key:"bd5102ec0f21239c45c93da7cc0715381c05df12",class:"payment-item__payment-reference"},(a=this.payment)===null||a===void 0?void 0:a.reference))}};ft.style=pt;const ut=".sc-ir-payment-summary-h{display:block}.sc-ir-payment-summary-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-payment-summary-h *.sc-ir-payment-summary{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}";const mt=ut;const bt=class{constructor(t){e(this,t)}shouldShowTotalCost(){return this.totalCost>0&&this.totalCost!==null}render(){return i("div",{key:"0db7213420cd4bdcb26ca8735cf010104d09326c",class:" m-0"},this.shouldShowTotalCost()&&i("div",{key:"c08de0c61f23c7e72bd6205b1d19ae60756b4b4a",class:"mb-2 h4 total-cost-container"},O.entries.Lcz_TotalCost,":",i("span",{key:"07cc1c5edf8d6a11d7fe75a7a2df158d52699357"},y(this.currency.symbol,this.totalCost))),i("div",{key:"33ffb7106478aa641bef6dca170bdf63920ec7d7",class:"h4 d-flex align-items-center justify-content-between"},i("span",{key:"1df5186dd2f90d9bd93793e7d7af7a05848318c5"},O.entries.Lcz_Balance,": "),i("span",{key:"2a0158f7fee29e20e2c0d5c8f8d21c60e40c76c4",class:"danger font-weight-bold"},y(this.currency.symbol,this.balance))),i("div",{key:"501319c3de850f9b447c2fb2ac0bc5564de97347",class:"mb-2 h4 d-flex align-items-center justify-content-between"},i("span",{key:"8b1a9714c71eab98bd15ef0529a6fd64b28580eb"},O.entries.Lcz_Collected,": "),i("span",{key:"c68c261db825c5d9db09e5ee1aaf01f60eb1823b"},y(this.currency.symbol,this.collected))))}};bt.style=mt;const gt=".sc-ir-payments-folio-h{display:block}";const yt=gt;const vt=class{constructor(i){e(this,i);this.addPayment=t(this,"addPayment",7);this.editPayment=t(this,"editPayment",7);this.deletePayment=t(this,"deletePayment",7);this.payments=[];this.handleAddPayment=()=>{this.addPayment.emit()};this.handleEditPayment=e=>{this.editPayment.emit(e)};this.handleDeletePayment=e=>{this.deletePayment.emit(e)}}hasPayments(){return this.payments&&this.payments.length>0}renderPaymentItem(e,t){return[i("ir-payment-item",{key:e.id,payment:e,onDeletePayment:e=>{e.stopImmediatePropagation();e.stopPropagation();this.handleDeletePayment(e.detail)},onEditPayment:e=>{e.stopImmediatePropagation();e.stopPropagation();this.handleEditPayment(e.detail)}}),t<this.payments.length-1&&i("hr",{class:"p-0 m-0"})]}renderEmptyState(){return i("div",{class:"text-center p-3"},i("p",{class:"text-muted"},"No payments recorded yet"))}render(){return i("div",{key:"5de39847ba10b5f6f71c3c878422a753e27e7bc6",class:"mt-1"},i("div",{key:"cead0e15b39c3fdcb70cc5f340b3a56a227b087f",class:"d-flex flex-column rounded payment-container"},i("div",{key:"dd8582187346cb63f7081406c8a9f859ded1fbb0",class:"d-flex align-items-center justify-content-between"},i("p",{key:"06aa5207487feeea895b23a7adddaa5397fae06e",class:"font-size-large p-0 m-0"},"Guest Folio"),i("ir-button",{key:"09c0edb8b81ab526461ebd8254775e91a342659c",id:"add-payment",variant:"icon",icon_name:"square_plus",style:{"--icon-size":"1.5rem"},onClickHandler:this.handleAddPayment})),i("div",{key:"d264f7bb0d68be53a551b3554cd60122ae458349",class:"mt-1 card p-1 payments-container"},this.hasPayments()?this.payments.map(((e,t)=>this.renderPaymentItem(e,t))):this.renderEmptyState())))}};vt.style=yt;class kt{async savePickup(e,t,i){try{const s=e.arrival_time.split(":");await I.post(`/Do_Pickup`,{booking_nbr:t,is_remove:i,currency:e.currency,date:e.arrival_date,details:e.flight_details,hour:s[0],minute:s[1],nbr_of_units:e.number_of_vehicles,selected_option:e.selected_option,total:+e.due_upon_booking})}catch(e){console.log(e)}}transformDefaultPickupData(e){const t=e.hour&&e.minute?_(e.hour)+":"+_(e.minute):"";return{arrival_date:e.date,arrival_time:t,currency:e.currency,due_upon_booking:e.total.toFixed(2),flight_details:e.details,location:e.selected_option.location.id,number_of_vehicles:e.nbr_of_units,selected_option:e.selected_option,vehicle_type_code:e.selected_option.vehicle.code}}getAvailableLocations(e){let t=[];T.pickup_service.allowed_options.forEach((i=>{if(t.filter((e=>e.value===i.location.id)).length===0){t.push({text:e+" "+i.location.description,value:i.location.id})}}));return t}createPickupSchema(e,t){return j.object({arrival_date:j.string().regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Invalid date format, expected YYYY-MM-DD"}).refine((i=>{const s=D(i,"YYYY-MM-DD",true);const a=D(e,"YYYY-MM-DD",true);const o=D(t,"YYYY-MM-DD",true);return s.isValid()&&a.isValid()&&o.isValid()&&s.isBetween(a,o,undefined,"[]")}),{message:`arrival_date must be between ${e} and ${t}`}),arrival_time:j.string().regex(/^\d{2}:\d{2}$/,{message:"Invalid time format. Expected HH:MM"}).refine((e=>{const[t,i]=e.split(":").map(Number);return t>=0&&t<=23&&i>=0&&i<=59}),{message:"Time values are out of range"}),flight_details:j.string().nonempty({message:"Flight details cannot be empty"}),vehicle_type_code:j.string().nonempty({message:"Vehicle type code cannot be empty"}),number_of_vehicles:j.coerce.number().min(1,{message:"At least one vehicle is required"})})}validateForm(e,t){try{t.parse(e);return null}catch(e){console.log(e);const t={};if(e instanceof A){e.issues.forEach((e=>{t[e.path[0]]=true}));return t}}}getNumberOfVehicles(e,t){let i=Math.ceil(t/e);let s=i>1?i:1;let a=i>1?2:3;return Array.from({length:i+a},((e,t)=>s+t))}getPickUpPersonStatus(e){const t=T.pickup_service.allowed_pricing_models.find((t=>t.code===e));if(!t){return null}return t.description}updateDue(e){const t=this.getPickUpPersonStatus(e.code);if(!t){return}if(t==="Person"){return e.amount*e.numberOfPersons}else{return e.amount*e.number_of_vehicles}}}const _t=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}@media (min-width: 768px){.price-input-container.sc-ir-pickup{max-width:290px}}";const xt=_t;const wt=".sc-ir-pickup-h{height:100%}.sheet-container.sc-ir-pickup{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-pickup{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-pickup{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-pickup{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-pickup{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-pickup{flex-direction:row;align-items:center}}";const Dt=wt;const Ot=class{constructor(i){e(this,i);this.closeModal=t(this,"closeModal",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.numberOfPersons=0;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:null,selected_option:undefined};this.vehicleCapacity=[];this.cause=null;this.autoValidate=false;this.pickupService=new kt;this.arrival_time_mask={mask:"HH:mm",blocks:{HH:{mask:P,from:0,to:23,placeholderChar:"H"},mm:{mask:P,from:0,to:59,placeholderChar:"m"}},lazy:false,placeholderChar:"_"}}componentWillLoad(){if(this.defaultPickupData){const e=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(e.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=T.pickup_service.allowed_options.filter((t=>t.location.id===e.location));this.pickupData=Object.assign({},e)}this.pickupSchema=this.pickupService.createPickupSchema(this.bookingDates.from,this.bookingDates.to)}handleLocationChange(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;if(t===""){this.updatePickupData("location",-1)}if(t!==""){this.allowedOptionsByLocation=T.pickup_service.allowed_options.filter((e=>e.location.id.toString()===t));let e=this.allowedOptionsByLocation[0];if(!e){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:t,selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code,currency:e.currency})}}handleVehicleQuantityChange(e){if(e.detail===""){return}const t=+e.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:t,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:t}).toFixed(2)})}handleVehicleTypeChange(e){if(e.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let t=T.pickup_service.allowed_options.find((t=>t.location.id===+this.pickupData.location&&t.vehicle.code===e.detail));if(!t){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code})}updatePickupData(e,t){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[e]:t})}async savePickup(){try{this.isLoading=true;this.autoValidate=true;if(this.errors){this.errors=null}this.errors=this.pickupService.validateForm(this.pickupData,this.pickupSchema);if(this.errors){return}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingEvt.emit(null);this.closeModal.emit(null)}catch(e){console.error(e)}finally{this.isLoading=false}}render(){var e,t,s,a,o;return i("form",{key:"85631b5e7603358aa308a6a0bb0d6734659737b3",class:"sheet-container",onSubmit:async e=>{e.preventDefault();await this.savePickup()}},i("ir-title",{key:"80511acbf177d11584a9aa4a028672465e65a720",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:O.entries.Lcz_Pickup,displayContext:"sidebar"}),i("section",{key:"15790f00c2f0cedd2d54f1bca733aeb971f0d4cb",class:"px-1 sheet-body"},i("ir-select",{key:"772c1d9e0b66b30c4de5588c41665cba1f3eb0f2",testId:"pickup_location",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:O.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",data:this.pickupService.getAvailableLocations(O.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&i("div",{key:"6ab57c70989a2f9fd61204edc6e1dcd53ec0d467",class:"m-0 p-0","data-testid":"pickup_body"},i("div",{key:"c6f1792f6c79fd60c4734ea1a9bf0dccb42bd570",class:"d-flex"},i("div",{key:"867dfb42aa449711f17d0c0ad1e4687e5d08a877",class:"form-group  mr-1"},i("div",{key:"ecbfab1c8b044a42003eea84ffcb841fe8462de9",class:"input-group row m-0"},i("div",{key:"8933609e91d9b40e37a22de8e2267e261125c606",class:`input-group-prepend col-5 p-0 text-dark border-0`},i("label",{key:"7b2c15e75bdcd495bd3ff37927c4f564d808f464",class:`input-group-text  flex-grow-1 text-dark border-theme `},O.entries.Lcz_ArrivalDate)),i("div",{key:"f5b539ded301f0307390e6dd9d7015403179e9e3",class:"form-control  form-control-md col-7 d-flex align-items-center px-0 mx-0",style:{border:"0"}},i("ir-date-picker",{key:"110965ff499d1fa7aba62fb7838f8f2a708a4745","data-testid":"pickup_arrival_date",date:this.pickupData.arrival_date,minDate:this.bookingDates.from,maxDate:(e=this.bookingDates)===null||e===void 0?void 0:e.to,emitEmptyDate:true,"aria-invalid":((t=this.errors)===null||t===void 0?void 0:t.arrival_date)&&!this.pickupData.arrival_date?"true":"false",onDateChanged:e=>{var t;this.updatePickupData("arrival_date",(t=e.detail.start)===null||t===void 0?void 0:t.format("YYYY-MM-DD"))}},i("input",{key:"f792fccf58f635550792f13935c9424e7eb977cb",type:"text",slot:"trigger",value:this.pickupData.arrival_date?D(this.pickupData.arrival_date).format("MMM DD, YYYY"):null,class:`form-control input-sm ${((s=this.errors)===null||s===void 0?void 0:s.arrival_date)&&!this.pickupData.arrival_date?"border-danger":""} text-center`,style:{borderTopLeftRadius:"0",borderBottomLeftRadius:"0",width:"100%"}}))))),i("ir-input-text",{key:"44ffd7d2dbee47f331ad6892dd2a6b947269c6ce",autoValidate:this.autoValidate,wrapKey:"arrival_time",testId:"pickup_arrival_time",error:(a=this.errors)===null||a===void 0?void 0:a.arrival_time,value:this.pickupData.arrival_time,zod:this.pickupSchema.pick({arrival_time:true}),label:O.entries.Lcz_Time,inputStyles:"col-sm-4","data-state":this.cause==="arrival_time"?"error":"",mask:this.arrival_time_mask,onTextChange:e=>this.updatePickupData("arrival_time",e.detail)})),i("ir-input-text",{key:"82b7333b9df5cc29fdeed37b30ccdb5d6452f39b",wrapKey:"flight_details",zod:this.pickupSchema.pick({flight_details:true}),autoValidate:this.autoValidate,testId:"pickup_flight_details",value:this.pickupData.flight_details,label:O.entries.Lcz_FlightDetails,onTextChange:e=>this.updatePickupData("flight_details",e.detail),placeholder:"",error:(o=this.errors)===null||o===void 0?void 0:o.flight_details}),i("ir-select",{key:"b5d6258c7f231bf138b5abc8338b39ed041a54dc",testId:"pickup_vehicle_type_code",selectContainerStyle:"mb-1",error:this.cause==="vehicle_type_code",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:O.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",data:this.allowedOptionsByLocation.map((e=>({text:e.vehicle.description,value:e.vehicle.code})))}),i("div",{key:"61b16f17ea000920b0f7f089b5f4c80e17d872c8",class:"d-flex flex-column flex-md-row"},i("ir-select",{key:"b8fe820334423e3899422b04b0a85155627bd65d",showFirstOption:false,testId:"pickup_number_of_vehicles",labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectedValue:this.pickupData.number_of_vehicles,error:this.cause==="number_of_vehicles",labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:O.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((e=>({text:e,value:e})))}),i("div",{key:"77d91b73caa9466cb0cea6f64657ce4eaafb942b",class:"price-input-container"},i("ir-price-input",{key:"d714cfe4bd31cb7176081e1fd48e39a950a5c503",readOnly:true,label:`${O.entries.Lcz_DueUponBooking}`,value:this.pickupData.due_upon_booking,currency:this.pickupData.currency.symbol}))))),i("div",{key:"2881d80f0f97f2077c0bb801f4915a623f3a9733",class:"sheet-footer"},i("ir-button",{key:"cccd89b867d16b5f3ad317bfedbfd83a6fc20d56",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:O.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&i("ir-button",{key:"6234d96cb10ff0ef6885b4ac61bf3498ada30227",btn_styles:"justify-content-center align-items-center",class:"flex-fill",isLoading:this.isLoading,text:O.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"})))}get el(){return o(this)}};Ot.style=xt+Dt;const Ct=".sc-ir-pickup-view-h{display:block}";const Tt=Ct;const Yt=class{constructor(t){e(this,t)}render(){if(!T.pickup_service.is_enabled||!this.booking.is_editable){return null}return i(a,null,i("div",{class:"mb-1"},i("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},i("p",{class:"font-size-large p-0 m-0 "},O.entries.Lcz_Pickup),i("ir-button",{id:"pickup","data-testid":"new_pickup_btn",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},S.secondary),{"--icon-size":"1.5rem"})})),this.booking.pickup_info&&i("div",{class:"card"},i("div",{class:"p-1"},i("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},i("p",{class:"font-weight-bold mr-1 py-0 my-0"},O.entries.Lcz_Date,": ",i("span",{class:"font-weight-normal"},D(this.booking.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),this.booking.pickup_info.hour&&this.booking.pickup_info.minute&&i("p",{class:"font-weight-bold flex-fill py-0 my-0"},O.entries.Lcz_Time,":",i("span",{class:"font-weight-normal"}," ",L(this.booking.pickup_info.hour.toString(),this.booking.pickup_info.minute.toString()))),i("p",{class:"font-weight-bold py-0 my-0"},O.entries.Lcz_DueUponBooking,":"," ",i("span",{class:"font-weight-normal"},this.booking.pickup_info.currency.symbol,this.booking.pickup_info.total))),i("p",{class:"font-weight-bold py-0 my-0"},O.entries.Lcz_FlightDetails,":",i("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.details}`)),i("p",{class:"py-0 my-0 pickup-margin"},`${this.booking.pickup_info.selected_option.vehicle.description}`),i("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},O.entries.Lcz_NbrOfVehicles,":",i("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.nbr_of_units}`)),i("p",{class:"small py-0 my-0 pickup-margin"},T.pickup_service.pickup_instruction.description,T.pickup_service.pickup_cancelation_prepayment.description)))))}};Yt.style=Tt;const It=".sc-ir-pms-logs-h{display:block}.dialog-container-height.sc-ir-pms-logs{height:4rem}.list-title.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-pms-logs{color:#629a4c;font-weight:600}.list-item.red.sc-ir-pms-logs{color:#ff4961;font-weight:600}";const Et=It;const Mt=class{constructor(t){e(this,t);this.bookingService=new r}componentWillLoad(){this.init()}async init(){try{this.pmsLogs=await this.bookingService.fetchPMSLogs(this.bookingNumber)}catch(e){console.error(e)}}render(){var e,t,s,a,o,n,r,c;return i("div",{key:"9ad8d543a7bccf49a45736615a1ce566de4792d3",class:"p-1"},i("h3",{key:"079bdc4645a0a4a25518cf3b552583b3f71783e4",class:" text-left mb-1 dialog-title "},O.entries.Lcz_PMS_Logs),C("/Get_Exposed_PMS_Logs")?i("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},i("ir-spinner",null)):i("div",{class:"dialog-container-height"},i("div",{class:"d-flex align-items-center ",style:{paddingBottom:"0.5rem"}},i("p",{class:"list-title p-0 m-0"},O.entries.Lcz_SentAt),((e=this.pmsLogs)===null||e===void 0?void 0:e.sent_date)?i("p",{class:"list-item"},(t=this.pmsLogs)===null||t===void 0?void 0:t.sent_date," ",L((s=this.pmsLogs)===null||s===void 0?void 0:s.sent_hour.toString(),(a=this.pmsLogs)===null||a===void 0?void 0:a.sent_minute.toString())):i("p",{class:`list-item ${((o=this.pmsLogs)===null||o===void 0?void 0:o.sent_date)?"green":"red"}`},((n=this.pmsLogs)===null||n===void 0?void 0:n.is_acknowledged)?O.entries.Lcz_YES:O.entries.Lcz_NO)),i("div",{class:"d-flex align-items-center p-0 m-0"},i("h4",{class:"list-title p-0 m-0"},O.entries.Lcz_Acknowledged),i("p",{class:`list-item  ${((r=this.pmsLogs)===null||r===void 0?void 0:r.is_acknowledged)?"green":"red"}`},((c=this.pmsLogs)===null||c===void 0?void 0:c.is_acknowledged)?O.entries.Lcz_YES:O.entries.Lcz_NO))))}};Mt.style=Et;const Bt=":host{display:block;width:100%}*{box-sizing:border-box}.popover-trigger{all:unset;cursor:pointer}.popover-trigger:hover,.popover-trigger:focus{color:#000}";const St=Bt;const jt=class{constructor(t){e(this,t);this.irPopoverLeft="10px";this.placement="auto";this.trigger="focus";this.renderContentAsHtml=false;this.initialized=false}componentDidLoad(){if(this.initialized){return}this.initializePopover()}initializePopover(){$(this.popoverTrigger).popover({trigger:this.trigger,content:this.content,placement:this.placement,html:this.renderContentAsHtml});this.initialized=true}disconnectedCallback(){$(this.popoverTrigger).popover("dispose")}render(){return i(a,{key:"770be229890bbfed67593497444dfe43f065d9d8",style:{"--ir-popover-left":this.irPopoverLeft}},this.trigger!=="focus"?i("p",{ref:e=>this.popoverTrigger=e,class:"popover-title m-0 p-0",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"}},i("slot",null)):i("button",{tabindex:"0",class:"popover-trigger",ref:e=>this.popoverTrigger=e},i("slot",null)))}get el(){return o(this)}};jt.style=St;const At=".sc-ir-reservation-information-h{display:block}";const Rt=At;const Nt=class{constructor(i){e(this,i);this.openSidebar=t(this,"openSidebar",7);this.userCountry=null}componentWillLoad(){var e,t,i;const s=(t=(e=this.booking)===null||e===void 0?void 0:e.guest)===null||t===void 0?void 0:t.country_id;this.userCountry=s?((i=this.countries)===null||i===void 0?void 0:i.find((e=>e.id===s)))||null:null}handleEditClick(e,t){e.stopImmediatePropagation();e.stopPropagation();this.openSidebar.emit({type:t})}renderPhoneNumber(){const{mobile_without_prefix:e,country_phone_prefix:t,country_id:i}=this.booking.guest;if(!e){return null}if(t){return t+" "+e}if(i){const t=this.countries.find((e=>e.id===i));if(!t){throw new Error("Invalid country id")}return t.phone_prefix+" "+e}return e}render(){var e,t,s,a,o,n;const r=v(this.booking.extras);return i("div",{key:"92eac6fa6e93490faa787479a5091a6c19e80929",class:"card"},i("div",{key:"3f26739bc1f05227782b0d35ce37deff5f8a6603",class:"p-1"},i("p",{key:"fdc6dc43689e77f30c89236036abde550455c351"},this.booking.property.name||""),i("ir-label",{key:"be557697ade21da9e1ea0174cd226e594b97709b",labelText:`${O.entries.Lcz_Source}:`,content:this.booking.origin.Label,image:{src:this.booking.origin.Icon,alt:this.booking.origin.Label}}),i("ir-label",{key:"389f42f38c7f266aa2419741a41e48a10f161cb7",renderContentAsHtml:true,labelText:`${O.entries.Lcz_BookedOn}:`,content:`${N(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${L(this.booking.booked_on.hour.toString(),this.booking.booked_on.minute.toString())}`}),i("ir-label",{key:"2ec61d11dd45273b664d4d7f5658bc7c7148adde",labelText:`${O.entries.Lcz_BookedBy}:`,content:`${this.booking.guest.first_name} ${this.booking.guest.last_name}`},((e=this.booking.guest)===null||e===void 0?void 0:e.nbr_confirmed_bookings)>1&&!this.booking.agent&&i("div",{key:"11a259895bfbdfaa77013cfc300b963e56913d4f",class:"m-0 p-0",slot:"prefix"},i("ir-tooltip",{key:"0c33030c3c2db8773b5704a1793edde20b91c574",message:`${O.entries.Lcz_BookingsNbr}`.replace("%1",this.booking.guest.nbr_confirmed_bookings.toString()),customSlot:true},i("div",{key:"3f1323a4b4e806dc310069bb952eccb48362a004",class:"d-flex align-items-center m-0 p-0",slot:"tooltip-trigger",style:{gap:"0.25rem"}},i("p",{key:"2e3ea49585879f2717c7f05e5cdad41e05564496",class:"p-0 m-0",style:{color:"#FB0AAD"}},this.booking.guest.nbr_confirmed_bookings),i("ir-icons",{key:"43c17bda2a64bf1c589acda108e0210400c6d9bd",style:{"--icon-size":"1rem"},color:"#FB0AAD",name:"heart-fill"})))),i("ir-button",{key:"fe0246a6ea96f1a223c534fdaa5ab2812ad802fb",slot:"suffix",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},S.secondary),{"--icon-size":"1.1rem"}),onClickHandler:e=>this.handleEditClick(e,"guest")})),this.booking.guest.mobile&&i("ir-label",{key:"afcdb3493cc6b02b673fc3dbacfea4011f3fa76b",labelText:`${O.entries.Lcz_Phone}:`,content:this.renderPhoneNumber()}),!this.booking.agent&&i("ir-label",{key:"b118152400a57a94963135e814429d92cdeab680",labelText:`${O.entries.Lcz_Email}:`,content:this.booking.guest.email}),this.booking.guest.alternative_email&&i("ir-label",{key:"0e2261b5958dae961dc1a1b18e87ac5b0dac1ffa",labelText:`${O.entries.Lcz_AlternativeEmail}:`,content:this.booking.guest.alternative_email}),((s=(t=this.booking)===null||t===void 0?void 0:t.guest)===null||s===void 0?void 0:s.address)&&i("ir-label",{key:"5ea13fb444e851c8169cf27dd47fae8718752a6d",labelText:`${O.entries.Lcz_Address}:`,content:this.booking.guest.address}),this.userCountry&&i("ir-label",{key:"b3630fbf00343934660e5f6379466efcc6a02f2e",labelText:`${O.entries.Lcz_Country}:`,isCountryImage:true,content:this.userCountry.name,image:{src:this.userCountry.flag,alt:this.userCountry.name}}),((a=this.booking.guest)===null||a===void 0?void 0:a.notes)&&i("ir-label",{key:"aa4ed8fe291379d4ec0cb61769874ddb04771cca",display:"inline",labelText:`${O.entries.Lcz_GuestPrivateNote}:`,content:(o=this.booking.guest)===null||o===void 0?void 0:o.notes}),this.booking.is_direct&&i("ir-label",{key:"73c2443c6e73b8bb8861565a9fc802e76da620e1",labelText:`${O.entries.Lcz_ArrivalTime}:`,content:this.booking.arrival.description}),this.booking.promo_key&&i("ir-label",{key:"e876f51b39edc88e2195f285cfbf68f8dbd47089",labelText:`${O.entries.Lcz_Coupon}:`,content:this.booking.promo_key}),this.booking.is_in_loyalty_mode&&!this.booking.promo_key&&i("div",{key:"2bb13c01917cfb3e4dcbd60b1006f9eb1debf2fd",class:"d-flex align-items-center"},i("svg",{key:"30db84122aaf443f90ca00775a2f616b4f4cce96",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},i("path",{key:"c9df765e3b640933cf9ad11d393d4761313b2e02",fill:"#fc6c85",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"})),i("p",{key:"4c8a50680fb4c37dfdeecc8a8da74bce09fcb7f7",class:"m-0 p-0 ml-1"},O.entries.Lcz_LoyaltyDiscountApplied)),this.booking.is_direct?i("ir-label",{labelText:`${O.entries.Lcz_GuestRemark}:`,display:"inline",content:this.booking.remark}):i("ota-label",{class:"m-0 p-0",label:`${O.entries.Lcz_ChannelNotes||"Channel notes"}:`,remarks:this.booking.ota_notes,maxVisibleItems:(n=this.booking.ota_notes)===null||n===void 0?void 0:n.length}),i("div",{key:"d6cac42a945972b0ad4ab7892e6e12e0e5f38d23",class:"d-flex align-items-center justify-content-between"},i("ir-label",{key:"732df9777b6b271099c1cc8d676ae7f62025054b",labelText:`${O.entries.Lcz_BookingPrivateNote}:`,placeholder:O.entries.Lcz_VisibleToHotelOnly,content:r,display:r?"inline":"flex"}),i("ir-button",{key:"fa3558e458a881e6110b828e9e0475cc84a27cfb",variant:"icon",icon_name:"edit",style:S.secondary,onClickHandler:e=>this.handleEditClick(e,"extra_note")}))))}};Nt.style=Rt;const Lt=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.1rem 0.3rem;border-radius:5px;display:block;max-width:100px;box-sizing:border-box;display:inline-block;overflow:hidden;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default}.room_statements.sc-ir-room{display:block;width:100%}.room_statements.sc-ir-room{display:block;width:100%}.room_statements.sc-ir-room span.sc-ir-room{display:inline;white-space:normal;line-height:1.5;word-break:break-word}.room_statements.sc-ir-room b.sc-ir-room{display:inline;margin-right:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.subtotal_row.sc-ir-room{padding-top:8px;font-weight:600}.room_actions_btns.sc-ir-room{gap:0.5rem}.night-cost.sc-ir-room{color:#7cbebe}.room_actions_btns.sc-ir-room{white-space:nowrap;width:max-content}.room_actions_btns.sc-ir-room{flex:1 1 0%;display:flex;justify-content:flex-end}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const zt=Lt;const $t=class{constructor(i){e(this,i);this.deleteFinished=t(this,"deleteFinished",7);this.toast=t(this,"toast",7);this.pressCheckIn=t(this,"pressCheckIn",7);this.pressCheckOut=t(this,"pressCheckOut",7);this.editInitiated=t(this,"editInitiated",7);this.resetbooking=t(this,"resetbooking",7);this.openSidebar=t(this,"openSidebar",7);this.currency="USD";this.language="en";this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.collapsed=false;this.isLoading=false;this.modalReason=null;this.isModelOpen=false;this.bookingService=new r}componentWillLoad(){this.mainGuest=this.getMainGuest()}handleClick(e){let t=e.target;if(t.id=="checkin"){this.pressCheckIn.emit(this.room)}else if(t.id=="checkout"){this.pressCheckOut.emit(this.room)}}handleRoomDataChange(){this.mainGuest=this.getMainGuest()}getDateStr(e,t="default"){return e.getDate()+" "+e.toLocaleString(t,{month:"short"})+" "+e.getFullYear()}handleEditClick(){var e,t,i,s,a,o,n,r;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.room["assigned_units_pool"],NAME:x((e=this.mainGuest)===null||e===void 0?void 0:e.first_name,(t=this.mainGuest)===null||t===void 0?void 0:t.last_name),EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,TO_DATE:this.booking.to_date,TITLE:`${O.entries.Lcz_EditBookingFor} ${(s=(i=this.room)===null||i===void 0?void 0:i.roomtype)===null||s===void 0?void 0:s.name} ${((o=(a=this.room)===null||a===void 0?void 0:a.unit)===null||o===void 0?void 0:o.name)||""}`,defaultDateRange:{dateDifference:this.room.days.length,fromDate:new Date(this.room.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.room.from_date+"T00:00:00")),toDate:new Date(this.room.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.room.to_date+"T00:00:00")),message:""},bed_preference:this.room.bed_preference,adult_child_offering:this.room.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.room.rateplan.selected_variation.adult_nbr,ARRIVAL:this.booking.arrival,ARRIVAL_TIME:this.booking.arrival.description,BOOKING_NUMBER:this.booking.booking_nbr,cancelation:this.room.rateplan.cancelation,channel_booking_nbr:this.booking.channel_booking_nbr,CHILDREN_COUNT:this.room.rateplan.selected_variation.child_nbr,COUNTRY:this.booking.guest.country_id,ENTRY_DATE:this.booking.from_date,FROM_DATE_STR:this.booking.format.from_date,guarantee:this.room.rateplan.guarantee,GUEST:this.mainGuest,IDENTIFIER:this.room.identifier,is_direct:this.booking.is_direct,IS_EDITABLE:this.booking.is_editable,NO_OF_DAYS:this.room.days.length,NOTES:this.booking.remark,origin:this.booking.origin,POOL:this.room["assigned_units_pool"],PR_ID:(n=this.room.unit)===null||n===void 0?void 0:n.id,RATE:this.room.total,RATE_PLAN:this.room.rateplan.name,RATE_PLAN_ID:this.room.rateplan.id,RATE_TYPE:this.room.roomtype.id,ROOMS:this.booking.rooms,SOURCE:this.booking.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.booking.format.to_date,TOTAL_PRICE:this.booking.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((r=this.room.unit)===null||r===void 0?void 0:r.name)||"",PICKUP_INFO:this.booking.pickup_info,booking:this.booking,currentRoomType:this.room})}openModal(e){if(!e){return}this.modalReason=e;this.modal.openModal()}async handleModalConfirmation(e){try{e.stopImmediatePropagation();e.stopPropagation();if(!this.modalReason){return}this.isLoading=true;switch(this.modalReason){case"delete":await this.deleteRoom();break;case"checkin":case"checkout":await this.bookingService.handleExposedRoomInOut({booking_nbr:this.booking.booking_nbr,room_identifier:this.room.identifier,status:this.modalReason==="checkin"?"001":"002"});this.resetbooking.emit(null);break}}catch(e){console.log(e)}finally{this.isLoading=false;this.modalReason=null;this.modal.closeModal()}}async deleteRoom(){let e=[...this.booking.rooms];e=e.filter((e=>e.identifier!==this.room.identifier));const t={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.booking.booking_nbr,from_date:this.booking.from_date,to_date:this.booking.to_date,remark:this.booking.remark,property:this.booking.property,source:this.booking.source,currency:this.booking.currency,arrival:this.booking.arrival,guest:this.booking.guest,rooms:e},extras:this.booking.extras,pickup_info:this.booking.pickup_info};await this.bookingService.doReservation(t);this.deleteFinished.emit(this.room.identifier)}async updateDepartureTime(e){try{await this.bookingService.setDepartureTime({property_id:this.property_id,code:e,room_identifier:this.room.identifier});this.toast.emit({type:"success",description:"",title:"Saved Successfully",position:"top-right"})}catch(e){console.log(e)}}formatVariation({infant_nbr:e,adult_nbr:t,children_nbr:i}){const s=t>0?t:0;const a=i>0?i:0;const o=e>0?e:0;const n=s>1?O.entries.Lcz_Adults.toLowerCase():O.entries.Lcz_Adult.toLowerCase();const r=a>1?O.entries.Lcz_Children.toLowerCase():O.entries.Lcz_Child.toLowerCase();const c=o>1?O.entries.Lcz_Infants.toLowerCase():O.entries.Lcz_Infant.toLowerCase();const l=[];if(s>0){l.push(`${s} ${n}`)}if(a>0){l.push(`${a} ${r}`)}if(o>0){l.push(`${o} ${c}`)}return l.join("&nbsp&nbsp&nbsp&nbsp")}getSmokingLabel(){var e,t,i;if(this.booking.is_direct){if(!this.room.smoking_option){return null}const i=T.roomsInfo.find((e=>e.id===this.room.roomtype.id));if(i){const s=(e=i["smoking_option"])===null||e===void 0?void 0:e.allowed_smoking_options;if(s){return(t=s.find((e=>e.code===this.room.smoking_option)))===null||t===void 0?void 0:t.description}return null}return null}return(i=this.room.ota_meta)===null||i===void 0?void 0:i.smoking_preferences}getBedName(){var e,t;if(this.booking.is_direct){const t=this.bedPreferences.find((e=>{var t,i;return e.CODE_NAME===((i=(t=this.room)===null||t===void 0?void 0:t.bed_preference)===null||i===void 0?void 0:i.toString())}));if(!t){return}return(e=t[`CODE_VALUE_${this.language}`])!==null&&e!==void 0?e:t.CODE_VALUE_EN}return(t=this.room.ota_meta)===null||t===void 0?void 0:t.bed_preferences}renderModalMessage(){switch(this.modalReason){case"delete":return`${O.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.room.roomtype.name} ${this.room.unit?this.room.unit.name:""} ${O.entries.Lcz_FromThisBooking}`;case"checkin":return`Are you sure you want to Check In this unit?\n`;case"checkout":return`Are you sure you want to Check Out this unit?`;default:return""}}handleCheckIn(){const{adult_nbr:e,children_nbr:t,infant_nbr:i}=this.room.occupancy;if(this.room.sharing_persons.length<e+t+i){return this.showGuestModal()}return this.renderModalMessage()}getMainGuest(){var e;return(e=this.room.sharing_persons)===null||e===void 0?void 0:e.find((e=>e.is_main))}render(){var e,t,o,n;const r=this.getBedName();return i(a,{key:"5a761c15b06b83a8fdff91650badd21a180ba8f7",class:"p-1 d-flex m-0"},i("ir-button",{key:"cf810ee2c56f52634407ef6af6470d15b66895b4",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${(e=this.room.identifier)===null||e===void 0?void 0:e.split(" ").join("")}`,"aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"mr-1",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}}),i("div",{key:"6a95425efc5d2f774c885bd168533a97d570ab76",class:"flex-fill m-0 "},i("div",{key:"308c74d5f9c960a1f3c143e6a9d17ccd91c1cda4",class:"d-flex align-items-start justify-content-between sm-mb-1"},i("p",{key:"ace9af8afa70929f4237abde4a02d27d5d39ffc0",class:"m-0 p-0"},i("span",{key:"2077fa5cb129922bde60e83d6636b0bea49d9ded",class:"m-0 p-0",style:{fontWeight:"600"}},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.room.rateplan.is_non_refundable&&` - ${O.entries.Lcz_NonRefundable}`," "),i("div",{key:"c673a03861ae04b0b198ac1ad8012a3a6df40782",class:"d-flex m-0 p-0 align-items-center room_actions_btns"},i("span",{key:"adcba2d1c0e914fb5839f298b5794f65d1869bc4",class:"p-0 m-0 font-weight-bold"},y(this.currency,this.room["gross_total"])),this.hasRoomEdit&&this.isEditable&&i("ir-button",{key:"3eb67b471f2380d928a797e104e30bd18a31412b",id:`roomEdit-${this.room.identifier}`,variant:"icon",icon_name:"edit",style:S.secondary,onClickHandler:this.handleEditClick.bind(this)}),this.hasRoomDelete&&this.isEditable&&i("ir-button",{key:"8227f90a1b74a191f638cc2f0bc0871e931705f2",variant:"icon",onClickHandler:this.openModal.bind(this,"delete"),id:`roomDelete-${this.room.identifier}`,icon_name:"trash",style:S.danger}))),i("div",{key:"cac639a537b396a57524d224ae7ba3c71da78d97",class:"d-flex align-items-center sm-mb-1"},i("ir-date-view",{key:"a692392b2bd1e5913f6fec679c0abc2f704f9b09",class:"mr-1  flex-grow-1",style:{width:"fit-content"},from_date:this.room.from_date,to_date:this.room.to_date,showDateDifference:false}),!Y(this.room.roomtype.id)&&T.is_frontdesk_enabled&&this.room.unit&&i("div",{key:"f19005592ecdf0fe1fecfa06e534b17384ed55e4",class:"d-flex justify-content-center align-items-center"},i("ir-tooltip",{key:"9031af3c72e239c52272a21d3bf46d58f48d8095",message:this.room.unit.name,customSlot:true},i("span",{key:"e2aa0cb4dd81912d76241acc0522bb12fbfc253e",slot:"tooltip-trigger",class:`light-blue-bg  ${this.hasCheckIn||this.hasCheckOut?"mr-2":""} `},this.room.unit.name))),this.hasCheckIn&&i("ir-button",{key:"07e7226046188848f46d0e2211034ecb90eca9ee",onClickHandler:this.handleCheckIn.bind(this),id:"checkin",btn_color:"outline",size:"sm",text:O.entries.Lcz_CheckIn}),this.hasCheckOut&&i("ir-button",{key:"4ebd170e3c92dc5b784c53aea53779e7f0ad2a6c",onClickHandler:this.openModal.bind(this,"checkout"),id:"checkout",btn_color:"outline",size:"sm",text:O.entries.Lcz_CheckOut})),i("div",{key:"50eb92b5a571492b5866bb096c509e0419483830",class:"d-flex align-items-center",style:{gap:"0.5rem"}},i("p",{key:"e0dde1b3be1deea7b88552b676591d45add57879",class:"m-0 p-0"},`${this.mainGuest.first_name||""} ${this.mainGuest.last_name||""}`),this.room.rateplan.selected_variation.adult_nbr>0&&(this.room.unit?i("ir-tooltip",{message:"View guests",class:"m-0 p-0",customSlot:true},i("ir-button",{class:"m-0 p-0",slot:"tooltip-trigger",btn_color:"link",renderContentAsHtml:true,onClickHandler:()=>this.showGuestModal(),size:"sm",btnStyle:{width:"fit-content",margin:"0",padding:"0",fontSize:"inherit",textAlign:"center",lineHeight:"1.2"},text:this.formatVariation(this.room.occupancy)})):i("span",{innerHTML:this.formatVariation(this.room.occupancy)})),r&&i("p",{key:"24c3bbaef386fcb14e1578c4765908f1d1a7a2ed",class:"m-0 p-0"},"(",r,")")),i("div",{key:"6909e22f456a7a2ab5b668a78d5568ae87500234",class:"d-flex align-items-center",style:{marginTop:"0.5rem",marginBottom:"0.875rem",gap:"0.5rem"}},i("p",{key:"33e248772cdfed1aecf81e1a88bd842900c03df2",class:"m-0 p-0"},"Expected departure time:"),i("ir-select",{key:"c8e83a62b9f88159f7c6caf4851a6f3e4ba6e207",selectedValue:(t=this.room.departure_time)===null||t===void 0?void 0:t.code,showFirstOption:false,onSelectChange:e=>{this.updateDepartureTime(e.detail)},data:(o=this.departureTime)===null||o===void 0?void 0:o.map((e=>{var t,i;return{text:(i=e[`CODE_VALUE_${(t=this.language)===null||t===void 0?void 0:t.toUpperCase()}`])!==null&&i!==void 0?i:e[`CODE_VALUE_EN`],value:e.CODE_NAME}}))})),i("div",{key:"5c5c1ada9f82810bdd5f808bf751adc9a7626975",class:"collapse",id:`roomCollapse-${(n=this.room.identifier)===null||n===void 0?void 0:n.split(" ").join("")}`},i("div",{key:"7c06637a9a879d29c50323671a0b2a4a8a589873",class:"d-flex sm-mb-1 sm-mt-1"},i("div",{key:"cd7b4bb94905f1ec41e44d2afbed53a5fd54f62a",class:" sm-padding-top"},i("p",{key:"fc553a9c1a758898af21a8fa385706b14416efb4",class:"sm-padding-right",style:{fontWeight:"600"}},`${O.entries.Lcz_Breakdown}:`)),i("div",{key:"733d1ac83a2f54b1b56fa21bbdd551b98a703d46",class:"flex-fill"},i("table",{key:"48f4a4c3db790e7833c69c138c8e578df41cc27f"},this.room.days.length>0&&this.room.days.map((e=>i("tr",null,i("td",{class:"pr-2 text-right"},z(e.date)),i("td",{class:"text-right"},y(this.currency,e.amount)),e.cost>0&&e.cost!==null&&i("td",{class:"pl-2 text-left night-cost"},y(this.currency,e.cost))))),i("tr",{key:"a6806939a1c08d96ca1b3d2bfb4c45230673bd6b",class:""},i("th",{key:"84bf11a624f5f4612d749d290699d21e6ec36ef7",class:"text-right pr-2 subtotal_row"},O.entries.Lcz_SubTotal),i("th",{key:"7b2567d4b95a1129544dac4d8ab9dabeb123a94e",class:"text-right subtotal_row"},y(this.currency,this.room.total)),this.room.gross_cost>0&&this.room.gross_cost!==null&&i("th",{key:"bba670e1803c4f46e141ad54d06ce8f9f000051a",class:"pl-2 text-right night-cost"},y(this.currency,this.room.cost))),this.booking.is_direct?i(s,null,(()=>{const e=T.taxes.filter((e=>e.pct>0));return e.map((e=>i("tr",null,i("td",{class:"text-right pr-2"},e.is_exlusive?O.entries.Lcz_Excluding:O.entries.Lcz_Including," ",e.name," (",e.pct,"%)"),i("td",{class:"text-right"},y(this.currency,this.room.total*e.pct/100)),this.room.gross_cost>0&&this.room.gross_cost!==null&&i("td",{class:"pl-2 text-right night-cost"},y(this.currency,this.room.cost*e.pct/100)))))})()):i(s,null,(()=>{const e=this.room.ota_taxes.filter((e=>e.amount>0));return e.map((e=>i("tr",null,i("td",{class:"text-right pr-2"},e.is_exlusive?O.entries.Lcz_Excluding:O.entries.Lcz_Including," ",e.name),i("td",{class:"text-right"},e.currency.symbol,e.amount))))})())))),i("ir-label",{key:"8cf5ecf3452f5dd29cc575b3636114794793f960",labelText:`${O.entries.Lcz_SmokingOptions}:`,display:"inline",content:this.getSmokingLabel()}),this.booking.is_direct&&i(s,{key:"150cbad6349617142beb128a7b84e0e33a74bad1"},this.room.rateplan.cancelation&&i("ir-label",{key:"e754ddc9d8085af5c6ab27776d02ded8c5f2c118",labelText:`${O.entries.Lcz_Cancellation}:`,display:"inline",content:this.room.rateplan.cancelation||"",renderContentAsHtml:true}),this.room.rateplan.guarantee&&i("ir-label",{key:"dc8dd28c0cb725f26d97e774492b1c9462d71556",labelText:`${O.entries.Lcz_Guarantee}:`,display:"inline",content:this.room.rateplan.guarantee||"",renderContentAsHtml:true})),this.room.ota_meta&&i("div",{key:"209000196075c661ae0cefdcb1396bb7a8c82c0f"},i("ir-label",{key:"7a57369d6ffe2c85438f36d28be47b117ffcc598",labelText:`${O.entries.Lcz_MealPlan}:`,display:"inline",content:this.room.ota_meta.meal_plan}),i("ir-label",{key:"da42cfc05e070708299cc24354d38ce8f675b421",labelText:`${O.entries.Lcz_Policies}:`,display:"inline",content:this.room.ota_meta.policies})))),i("ir-modal",{key:"427fdf4c7d49d068f666a1a1145aeca2ba80374a",autoClose:false,ref:e=>this.modal=e,isLoading:this.isLoading,onConfirmModal:this.handleModalConfirmation.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:O.entries.Lcz_Cancel,rightBtnText:this.modalReason==="delete"?O.entries.Lcz_Delete:O.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modalReason==="delete"?"danger":"primary",modalTitle:O.entries.Lcz_Confirmation,modalBody:this.renderModalMessage()}))}showGuestModal(){var e;const{adult_nbr:t,children_nbr:i,infant_nbr:s}=this.room.occupancy;this.openSidebar.emit({type:"room-guest",payload:{roomName:(e=this.room.unit)===null||e===void 0?void 0:e.name,sharing_persons:this.room.sharing_persons,totalGuests:t+i+s,checkin:this.hasCheckIn,identifier:this.room.identifier}})}get element(){return o(this)}static get watchers(){return{room:["handleRoomDataChange"]}}};$t.style=zt;const Pt={id:-1,full_name:"",country_id:null,dob:"",id_info:{type:{code:null,description:null},number:""},address:null,alternative_email:null,cci:null,city:null,country:undefined,country_phone_prefix:null,email:null,first_name:"",last_name:"",mobile:null,nbr_confirmed_bookings:0,notes:null,password:null,subscribe_to_news_letter:null};const Gt={mask:Date,pattern:"DD/MM/YYYY",lazy:false,min:new Date(1900,0,1),max:new Date,format:e=>D(e).format("DD/MM/YYYY"),parse:e=>D(e,"DD/MM/YYYY").toDate(),autofix:true,placeholderChar:"_",blocks:{YYYY:{mask:P,from:1970,to:(new Date).getFullYear(),placeholderChar:"Y"},MM:{mask:P,from:1,to:12,placeholderChar:"M"},DD:{mask:P,from:1,to:31,placeholderChar:"D"}}};const Ht=".sc-ir-room-guests-h{display:block;height:100%;position:relative;text-align:start !important}.id-select.sc-ir-room-guests{border-top-right-radius:0;border-bottom-right-radius:0;border-right-width:0}.sc-ir-room-guests-h{display:block;width:100%}.guest-grid.sc-ir-room-guests>*.sc-ir-room-guests{height:100%}.guests-labels.sc-ir-room-guests{display:none}.guest_label.sc-ir-room-guests{width:100px;color:#6b6f82}.sharing_persons_label.sc-ir-room-guests{display:none}.loading-container.sc-ir-room-guests{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.guest_document.sc-ir-room-guests input.sc-ir-room-guests{border-top-left-radius:0;border-bottom-left-radius:0}.guests-labels.sc-ir-room-guests *.sc-ir-room-guests,.sharing_persons_label.sc-ir-room-guests{margin-bottom:0.5rem;padding-bottom:0}@media (min-width: 768px){.sharing_persons_label.sc-ir-room-guests{display:block}.guest_country_picker.sc-ir-room-guests{margin-bottom:3px}.guest-grid.sc-ir-room-guests{display:grid;grid-template-columns:2fr 2fr 2fr 2fr 5fr;gap:0.5rem;align-items:flex-start}.guest_label.sc-ir-room-guests,.sharing_persons_heading.sc-ir-room-guests,.main_guest_heading.sc-ir-room-guests{display:none}}";const Ut=Ht;const Ft=".sc-ir-room-guests-h{height:100%}.sheet-container.sc-ir-room-guests{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-room-guests{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-room-guests{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-room-guests{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-room-guests{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-room-guests{flex-direction:row;align-items:center}}";const Kt=Ft;const Vt=class{constructor(i){e(this,i);this.closeModal=t(this,"closeModal",7);this.resetBookingEvt=t(this,"resetBookingEvt",7);this.updateRoomGuests=t(this,"updateRoomGuests",7);this.sharedPersons=[];this.totalGuests=0;this.language="en";this.guests=[];this.idTypes=[];this.error={};this.autoValidate=false;this.bookingService=new r}componentWillLoad(){this.init();this.initializeGuests()}async init(){try{this.isLoading=true;const[e,t]=await Promise.all([this.bookingService.getUserDefaultCountry(),this.bookingService.getSetupEntriesByTableName("_ID_TYPE")]);this.idTypes=t;if(e){this.propertyCountry=this.countries.find((t=>t.id===e.COUNTRY_ID))}}catch(e){console.error(e)}finally{this.isLoading=false}}initializeGuests(){var e,t;let i=[];if(this.totalGuests>this.sharedPersons.length){const s=this.totalGuests-this.sharedPersons.length;i=[...this.sharedPersons,...Array(s).fill(Object.assign(Object.assign({},Pt),{id_info:Object.assign(Object.assign({},Pt.id_info),{type:{code:((e=this.idTypes[0])===null||e===void 0?void 0:e.CODE_NAME)||"001",description:((t=this.idTypes[0])===null||t===void 0?void 0:t.CODE_VALUE_EN)||""},number:""})}))]}else{i=[...this.sharedPersons]}i=i.map((e=>Object.assign(Object.assign({},e),{dob:new Date(e.dob).getFullYear()===1900?null:e.dob})));this.guests=i.map((e=>Object.assign(Object.assign({},e),{dob:e.dob?D(new Date(e.dob)).format("DD/MM/YYYY"):"",country_id:e.country?e.country.id:null})))}updateGuestInfo(e,t){const i=[...this.guests];let s=i[e];s=Object.assign(Object.assign({},s),t);i[e]=s;this.guests=[...i]}async saveGuests(){try{this.error={};this.autoValidate=true;for(const e of this.guests){Re(e)}await this.bookingService.handleExposedRoomGuests({booking_nbr:this.bookingNumber,identifier:this.identifier,guests:this.guests.map((e=>{if(!e.first_name&&e.id===-1){return null}return Object.assign(Object.assign({},e),{dob:e.dob?D(e.dob,"DD/MM/YYYY").format("YYYY-MM-DD"):null})})).filter(Boolean)});if(this.checkIn){await this.bookingService.handleExposedRoomInOut({booking_nbr:this.bookingNumber,room_identifier:this.identifier,status:"001"})}this.closeModal.emit(null);this.updateRoomGuests.emit({identifier:this.identifier,guests:this.guests});this.resetBookingEvt.emit()}catch(e){console.log(e);if(e instanceof A){let t={};e.issues.forEach((e=>{t[e.path[e.path.length-1]]=true}));this.error=Object.assign({},t)}}}render(){if(this.isLoading){return i("div",{class:"loading-container"},i("ir-spinner",null))}return i("form",{class:"sheet-container",style:{minWidth:"300px"},onSubmit:e=>{e.preventDefault();this.saveGuests()}},i("ir-title",{class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:`Room ${this.roomName}`,displayContext:"sidebar"}),i("section",{class:"sheet-body px-1"},i("div",{class:""},i("div",{class:"guest-grid guests-labels"},i("p",{class:""},O.entries.Lcz_MainGuest),i("p",{class:""}),i("p",{class:" "},O.entries.Lcz_DOB),i("p",{class:""},O.entries.Lcz_Nationality),i("p",{class:" "},O.entries.Lcz_Documents)),i("h5",{class:"main_guest_heading"},O.entries.Lcz_MainGuest),this.guests.map(((e,t)=>{var a,o;let n=true;try{Re(e)}catch(e){n=false}console.log(`row ${t}=>${n}`);return i(s,null,t===1&&i("div",{class:"d-flex mx-0 px-0"},i("h5",{class:"mx-0 px-0 sharing_persons_heading"},O.entries.Lcz_PersonsSharingRoom),i("p",{class:"mx-0 px-0 sharing_persons_label"},O.entries.Lcz_PersonsSharingRoom)),i("div",{key:t,class:"guest-grid"},i("div",{class:"m-0 p-0 d-flex align-items-center h-100"},i("p",{class:"guest_label"},"First name"),i("ir-input-text",{class:"flex-grow-1 h-100",id:`first_name_${t}`,zod:Ae.pick({first_name:true}),error:!!this.error["first_name"]&&!n,autoValidate:this.autoValidate,wrapKey:"first_name",placeholder:"First name",onTextChange:e=>this.updateGuestInfo(t,{first_name:e.detail}),value:e.first_name,maxLength:40})),i("div",{class:"m-0 p-0 d-flex align-items-center h-100"},i("p",{class:"guest_label"},"Last name"),i("ir-input-text",{maxLength:40,class:"flex-grow-1 h-100",id:`last_name_${t}`,zod:Ae.pick({last_name:true}),error:!!this.error["last_name"]&&!n,autoValidate:this.autoValidate,wrapKey:"last_name",placeholder:"Last name",onTextChange:e=>this.updateGuestInfo(t,{last_name:e.detail}),value:e.last_name})),i("div",{class:"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center"},i("p",{class:"guest_label"},O.entries.Lcz_DOB),i("ir-input-text",{class:"flex-grow-1 h-100",id:`dob_${t}`,zod:Ae.pick({dob:true}),error:!!this.error["dob"]&&!n,autoValidate:this.autoValidate,wrapKey:"dob",mask:Gt,placeholder:"",onTextChange:e=>{this.updateGuestInfo(t,{dob:e.detail})},value:e.dob})),i("div",{class:" m-0 p-0 d-flex align-items-center"},i("p",{class:"guest_label"},O.entries.Lcz_Nationality),i("div",{class:"mx-0 flex-grow-1  h-100"},i("ir-country-picker",{class:"h-100",propertyCountry:this.propertyCountry,id:`{locales.entries.Lcz_Nationality}_${t}`,error:!!this.error["country_id"]&&!e.country_id,country:(a=this.countries)===null||a===void 0?void 0:a.find((t=>{var i,s,a;return((i=t.id)===null||i===void 0?void 0:i.toString())===((a=(s=e.country)===null||s===void 0?void 0:s.id)===null||a===void 0?void 0:a.toString())})),onCountryChange:e=>{var i,s,a;return this.updateGuestInfo(t,{country_id:(a=(s=(i=e.detail)===null||i===void 0?void 0:i.id)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:null,country:e.detail})},countries:this.countries}))),i("div",{class:"flex-grow-1 m-0 p-0 d-flex align-items-center"},i("p",{class:"guest_label"},O.entries.Lcz_Documents),i("div",{class:" d-flex m-0 flex-grow-1 h-100"},i("ir-select",{selectForcedStyles:{borderTopRightRadius:"0px",borderBottomRightRadius:"0px",borderRight:"0"},selectStyles:"rounded-top-0 rounded-bottom-0",onSelectChange:e=>{this.updateGuestInfo(t,{id_info:Object.assign(Object.assign({},this.guests[t].id_info),{type:{code:e.detail,description:""}})})},selectedValue:e.id_info.type.code,showFirstOption:false,data:(o=this.idTypes)===null||o===void 0?void 0:o.map((e=>{var t;return{text:(t=e[`CODE_VALUE_${this.language.toUpperCase()}`])!==null&&t!==void 0?t:e[`CODE_VALUE_EN`],value:e.CODE_NAME}}))}),i("ir-input-text",{autoValidate:this.autoValidate,maxLength:18,placeholder:"12345",class:"flex-grow-1 guest_document",type:"text",inputForcedStyle:{borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px"},value:e.id_info.number,zod:je.pick({number:true}),error:!!this.error["number"]&&!n,wrapKey:"number",inputStyles:"form-control",onTextChange:e=>this.updateGuestInfo(t,{id_info:Object.assign(Object.assign({},this.guests[t].id_info),{number:e.detail})})})))))})))),i("div",{class:"sheet-footer"},i("ir-button",{onClick:()=>this.closeModal.emit(null),class:`flex-fill`,text:O.entries.Lcz_Cancel,btn_color:"secondary"}),i("ir-button",{btn_type:"submit",class:"flex-fill",isLoading:C("/Handle_Exposed_Room_Guests"),text:this.checkIn?O.entries.Lcz_CheckIn:O.entries.Lcz_Save,btn_color:"primary"})))}};Vt.style=Ut+Kt;const Wt="*.sc-ota-label{margin:0;padding:0}.sc-ota-label-h{display:flex;margin-bottom:5px;gap:5px}.label_title.sc-ota-label{min-width:max-content;padding:0;margin:0;font-weight:600}.ota-message-list.sc-ota-label{margin:0 3px;padding:0;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important}.ota-message-item.sc-ota-label{width:100%;line-height:1.5;margin:0;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important}.ota-message-item.sc-ota-label::before{content:'- ';margin-right:0.25rem}.ota-visibility-toggle.sc-ota-label{background:white;color:var(--blue);padding:0;margin:0;margin-left:3px;font-size:12px;border:0}.ota-visibility-toggle.sc-ota-label:hover{color:#355270}.ota-message-list.sc-ota-label{margin:0 3px;padding:0;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important;white-space:normal;list-style:none}.ota-message-item.sc-ota-label{width:100%;line-height:1.5;margin:0 0 0 1.2em;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important;white-space:normal;position:relative}";const qt=Wt;const Xt=class{constructor(t){e(this,t);this.maxVisibleItems=3;this.showAll=false;this.toggleShowAll=()=>{this.showAll=!this.showAll}}render(){if(!this.remarks){return null}const e=this.showAll?this.remarks:this.remarks.slice(0,this.maxVisibleItems);return i(a,null,i("p",{class:"label_title"},this.label),i("ul",{class:"ota-message-list"},e.map(((t,s)=>i("li",{key:G(),class:"ota-message-item"},t.statement," ",this.remarks.length>this.maxVisibleItems&&s===e.length-1&&i("button",{class:"ota-visibility-toggle",onClick:this.toggleShowAll},this.showAll?O.entries.Lcz_ShowLess:O.entries.Lcz_ShowMore))))))}};Xt.style=qt;export{q as igl_book_property,Z as igl_book_property_footer,te as igl_booking_form,ae as igl_booking_overview_page,re as ir_booking_details,pe as ir_booking_extra_note,me as ir_booking_guarantee,ye as ir_booking_header,_e as ir_dialog,De as ir_dropdown,Te as ir_dropdown_item,Ee as ir_events_log,Se as ir_extra_service,Ge as ir_extra_service_config,Fe as ir_extra_services,Xe as ir_guest_info,Je as ir_payment_action,it as ir_payment_actions,ot as ir_payment_details,dt as ir_payment_folio,ft as ir_payment_item,bt as ir_payment_summary,vt as ir_payments_folio,Ot as ir_pickup,Yt as ir_pickup_view,Mt as ir_pms_logs,jt as ir_popover,Nt as ir_reservation_information,$t as ir_room,Vt as ir_room_guests,Xt as ota_label};
//# sourceMappingURL=p-edb3be45.entry.js.map