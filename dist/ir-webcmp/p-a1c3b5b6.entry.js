import{r as t,c as e,g as i,h as s,H as a}from"./p-d239357b.js";import{C as n,c as o}from"./p-2f2e3528.js";const h=".listbox {\n  display: block;\n  position: relative;\n  font: inherit;\n  box-shadow: var(--wa-shadow-m);\n  background: var(--wa-color-surface-raised);\n  border-color: var(--wa-color-surface-border);\n  border-radius: var(--wa-border-radius-m);\n  border-style: var(--wa-border-style);\n  border-width: var(--wa-border-width-s);\n  padding-block: 0.5em;\n  padding-inline: 0;\n  overflow: auto;\n  overscroll-behavior: none;\n\n  /* Make sure it adheres to the popup's auto size */\n  max-width: var(--auto-size-available-width);\n  max-height: var(--auto-size-available-height);\n\n  &::slotted(wa-divider) {\n    --spacing: 0.5em;\n  }\n\n}\n\n::slotted(ir-autocomplete-option) {\n  display: block;\n}\n";const r=h;var l=undefined&&undefined.__decorate||function(t,e,i,s){var a=arguments.length,n=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,i):s,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)if(o=t[h])n=(a<3?o(n):a>3?o(e,i,n):o(e,i))||n;return a>3&&n&&Object.defineProperty(e,i,n),n};const c=class{constructor(i){t(this,i);this.textChange=e(this,"text-change",7);this.comboboxChange=e(this,"combobox-change",7)}get el(){return i(this)}open=false;placement="bottom";name;value="";type="text";defaultValue;size="small";appearance;pill;returnMaskedValue=false;label;hint;withClear;placeholder;readonly;passwordToggle;passwordVisible;withoutSpinButtons;form;required;pattern;minlength;maxlength;min;max;step;autocapitalize;autocorrect;autocomplete="off";autofocus;enterkeyhint;spellcheck;inputmode;withLabel;withHint;mask;disabled;inputClass;options=[];slotStateVersion=0;textChange;comboboxChange;currentOption;listboxRef;inputRef;SLOT_NAMES=["label","start","end","clear-icon","hint"];slotManager=o(null,this.SLOT_NAMES,(()=>{this.slotStateVersion++}));componentWillLoad(){this.slotManager=o(this.el,this.SLOT_NAMES,(()=>{this.slotStateVersion++}));this.slotManager.initialize();this.updateOptionsFromSlot();this.syncSelectedFromValue(this.value)}componentDidLoad(){this.slotManager.setupListeners();this.listboxRef?.addEventListener("click",this.handleOptionClick)}disconnectedCallback(){this.slotManager.destroy();this.listboxRef?.removeEventListener("click",this.handleOptionClick)}async show(){if(this.disabled)return;this.open=true}async focusInput(){if(this.disabled)return;this.inputRef?.focusInput()}async hide(){this.open=false}handleOpenChange(t){if(!this.listboxRef)return;this.listboxRef.hidden=!t;if(!t){this.clearCurrentOption();return}this.ensureCurrentOption();if(this.currentOption){requestAnimationFrame((()=>{if(this.currentOption){this.scrollIntoView(this.currentOption,this.listboxRef,"vertical","auto")}}))}}getOffset(t,e){return{top:Math.round(t.getBoundingClientRect().top-e.getBoundingClientRect().top),left:Math.round(t.getBoundingClientRect().left-e.getBoundingClientRect().left)}}scrollIntoView(t,e,i="vertical",s="smooth"){const a=this.getOffset(t,e);const n=a.top+e.scrollTop;const o=a.left+e.scrollLeft;const h=e.scrollLeft;const r=e.scrollLeft+e.offsetWidth;const l=e.scrollTop;const c=e.scrollTop+e.offsetHeight;if(i==="horizontal"||i==="both"){if(o<h){e.scrollTo({left:o,behavior:s})}else if(o+t.clientWidth>r){e.scrollTo({left:o-e.offsetWidth+t.clientWidth,behavior:s})}}if(i==="vertical"||i==="both"){if(n<l){e.scrollTo({top:n,behavior:s})}else if(n+t.clientHeight>c){e.scrollTo({top:n-e.offsetHeight+t.clientHeight,behavior:s})}}}handleValueChange(t){this.syncSelectedFromValue(t)}getAllOptions(){return this.options}updateOptionsFromSlot(t){const e=t??this.listboxRef?.querySelector("slot");if(!e){this.options=Array.from(this.el.querySelectorAll("ir-autocomplete-option"));return}const i=e.assignedElements({flatten:true});this.options=i.filter((t=>t.tagName.toLowerCase()==="ir-autocomplete-option"))}clearCurrentOption(){const t=this.getAllOptions();t.forEach((t=>{t.current=false;t.tabIndex=-1}));this.currentOption=undefined}ensureCurrentOption(){const t=this.getAllOptions().filter((t=>!t.disabled));if(!t.length){this.clearCurrentOption();return}const e=t.find((t=>t.selected));const i=e??this.currentOption??t[0];if(i){this.setCurrentOption(i,{scroll:false})}}setCurrentOption(t,e={}){if(!t||t.disabled)return;const i=this.getAllOptions();i.forEach((t=>{t.current=false;t.tabIndex=-1}));this.currentOption=t;t.current=true;t.tabIndex=0;if(e.scroll&&this.listboxRef){this.scrollIntoView(t,this.listboxRef,"vertical","auto")}}getOptionLabel(t){if(t.label)return t.label;return t.textContent?.trim()??""}getOptionValue(t){return t.value??this.getOptionLabel(t)}syncSelectedFromValue(t){const e=this.getAllOptions();let i;e.forEach((e=>{const s=this.getOptionValue(e);e.selected=s===t;if(e.selected){i=e}}));if(i){this.currentOption=i}else if(this.currentOption&&this.getOptionValue(this.currentOption)!==t){this.currentOption=undefined}}selectOption(t){if(!t||t.disabled)return;const e=this.getAllOptions();e.forEach((t=>{t.selected=false}));t.selected=true;this.currentOption=t;const i=this.getOptionValue(t);if(i!==this.value){this.value=i;this.comboboxChange.emit(i)}this.hide();requestAnimationFrame((()=>this.inputRef?.focusInput()))}handleOptionClick=t=>{const e=t.target;const i=e?.closest("ir-autocomplete-option");if(!i)return;t.preventDefault();t.stopPropagation();this.selectOption(i)};handleTextChange=t=>{t.stopImmediatePropagation();t.stopPropagation();const e=t.detail??"";if(e===this.value){if(!this.open&&this.getAllOptions().length){this.show()}return}this.value=e;this.textChange.emit(e);if(!this.open&&this.getAllOptions().length){this.show()}};handleOptionsSlotChange=t=>{this.updateOptionsFromSlot(t.target);this.syncSelectedFromValue(this.value);if(this.open){this.ensureCurrentOption()}};handleKeydownChange=t=>{if(t.key==="Escape"&&this.open){t.preventDefault();t.stopPropagation();this.hide();return}if(t.key==="Enter"){if(this.open&&this.currentOption){t.preventDefault();t.stopPropagation();this.selectOption(this.currentOption)}return}if(["ArrowUp","ArrowDown","Home","End"].includes(t.key)){const e=this.getAllOptions().filter((t=>!t.disabled));if(!e.length)return;const i=this.currentOption&&e.includes(this.currentOption)?this.currentOption:e[0];const s=e.indexOf(i);let a=Math.max(0,s);t.preventDefault();if(!this.open){this.show();if(this.currentOption||e.some((t=>t.selected))){return}}if(t.key==="ArrowDown"){a=s+1;if(a>e.length-1)a=0}else if(t.key==="ArrowUp"){a=s-1;if(a<0)a=e.length-1}else if(t.key==="Home"){a=0}else if(t.key==="End"){a=e.length-1}this.setCurrentOption(e[a],{scroll:true})}};render(){return s(a,{key:"922f42ccd8ba363715c39a65d9ba44fd000bc436"},s("wa-popup",{key:"237d96f5361c4459b74c024738f4de3437b18b09",active:this.open,flip:true,shift:true,sync:"width","auto-size":"vertical","auto-size-padding":10,placement:this.placement,exportparts:"popup, arrow, hover-bridge"},s("ir-input",{key:"fb7553992b1ed1f0024cf06ae39eeac81449f3a6",slot:"anchor",ref:t=>this.inputRef=t,onKeyDown:this.handleKeydownChange,"onText-change":this.handleTextChange,name:this.name,value:this.value,type:this.type,defaultValue:this.defaultValue,size:this.size,appearance:this.appearance,pill:this.pill,label:this.label,hint:this.hint,withClear:this.withClear,placeholder:this.placeholder,readonly:this.readonly,passwordToggle:this.passwordToggle,passwordVisible:this.passwordVisible,withoutSpinButtons:this.withoutSpinButtons,form:this.form,required:this.required,pattern:this.pattern,minlength:this.minlength,maxlength:this.maxlength,min:this.min,max:this.max,step:this.step,inputClass:this.inputClass,autocapitalize:this.autocapitalize,autocorrect:this.autocorrect,autocomplete:this.autocomplete,autofocus:this.autofocus,enterkeyhint:this.enterkeyhint,spellcheck:this.spellcheck,inputmode:this.inputmode,withLabel:this.withLabel,withHint:this.withHint,mask:this.mask,returnMaskedValue:this.returnMaskedValue,disabled:this.disabled,exportparts:"base, hint, label, input, start, end, clear-button, password-toggle-button"},this.slotManager.hasSlot("label")&&s("slot",{key:"fa58aacf599a67f93ba252abb3aec11c7168fbe8",name:"label",slot:"label"}),this.slotManager.hasSlot("start")&&s("slot",{key:"5dab3440cf83ae65f90d261ddcc820fcb59dc9ba",name:"start",slot:"start"}),this.slotManager.hasSlot("end")&&s("slot",{key:"1f1180b037522fad64e5d16ce54bfa4e1e6b6abd",name:"end",slot:"end"}),this.slotManager.hasSlot("clear-icon")&&s("slot",{key:"38cf32b9858280a0f94bcd456152660052ee451f",name:"clear-icon",slot:"clear-icon"}),this.slotManager.hasSlot("hint")&&s("slot",{key:"0c5ef52bb4aed0ad1265b4241dcbe720bd3b62b0",name:"hint",slot:"hint"})),s("div",{key:"552f994fdb3db4b44794eed317ee3ebedff60f64",id:"listbox",ref:t=>this.listboxRef=t,role:"listbox","aria-expanded":this.open?"true":"false","aria-multiselectable":"false","aria-labelledby":"label",part:"listbox",class:"listbox",tabindex:"-1",hidden:!this.open,onKeyDown:this.handleKeydownChange},s("slot",{key:"808c69b58bf28dbddd440426cab46f75e739349d",onSlotchange:this.handleOptionsSlotChange}))))}static get watchers(){return{open:["handleOpenChange"],value:["handleValueChange"]}}};l([n()],c.prototype,"hide",null);c.style=r;const d=":host{display:block}";const f=d;const u=class{constructor(e){t(this,e)}value;label;disabled=false;current=false;selected=false;render(){return s(a,{key:"1e1971cc2044e9ab75dd656b3172f5acd93bfdde",role:"option","aria-selected":this.selected?"true":"false","aria-disabled":this.disabled?"true":"false"},s("wa-option",{key:"f86625c4d9c98ccf15543b7d3da077eb6cbbe174",value:this.value,label:this.label,disabled:this.disabled,current:this.current,selected:this.selected,exportparts:"checked-icon, label, start, end"},s("slot",{key:"8ff21f0f8ed12530f07f3a2338740ab24fcfc3ef"}),s("slot",{key:"e49fce2e4fe13bdfddb029f383a9c4c4956166d4",name:"start",slot:"start"}),s("slot",{key:"0b6f53542fa4a5f1b0aac3dfc50416005e4f0632",name:"end",slot:"end"})))}};u.style=f;export{c as ir_autocomplete,u as ir_autocomplete_option};
//# sourceMappingURL=p-a1c3b5b6.entry.js.map