import{r as e,h as t,H as i,c as s,F as a}from"./p-61950c14.js";import{b as o,m as n,B as l,c as r,r as c,a as d,u as h,g as f}from"./p-dc103a4b.js";import{l as b}from"./p-e19fbf2a.js";import{i as p,c as u}from"./p-7b1e39e2.js";import{o as m,e as g,k as y,d as v,z as k,v as x}from"./p-21e4b336.js";import{v as _}from"./p-4ed69de7.js";import{d as w}from"./p-70dd5dc1.js";import{h as D}from"./p-6c4ba7c0.js";import{a as O}from"./p-053e21aa.js";import"./p-bf44a732.js";import"./p-0db2e55e.js";class I{formatVariationBasedOnInfants(e){const t=this.getVariationBasedOnInfants(e);return this.formatVariation(t,e.infants)}calculateVariationAmount(e){var t;return((t=this.getVariationBasedOnInfants(e))===null||t===void 0?void 0:t.discounted_amount)||0}getVariationBasedOnInfants({variations:e,baseVariation:t,infants:i}){const{adult_nbr:s,child_nbr:a}=t;return e.find((e=>e.adult_nbr===s&&e.child_nbr===Math.max(0,a-Math.max(0,i))))||t}formatVariation({child_nbr:e,adult_nbr:t},i){var s,a,o,n;const l=Number(t)||0;const r=Math.max(Number(i)||0,0);const c=l>1?b.entries.Lcz_Adults.toLowerCase():b.entries.Lcz_Adult.toLowerCase();const d=e>1?b.entries.Lcz_Children.toLowerCase():b.entries.Lcz_Child.toLowerCase();const h=r>1?(a=(s=b.entries["Lcz_Infants"])!==null&&s!==void 0?s:"infants")===null||a===void 0?void 0:a.toLowerCase():(n=(o=b===null||b===void 0?void 0:b.entries["Lcz_Infant"])!==null&&o!==void 0?o:"infant")===null||n===void 0?void 0:n.toLowerCase();const f=[`${l} ${c}`,e?`${e} ${d}`:"",r?`${r} ${h}`:""];return f.filter(Boolean).join("&nbsp&nbsp&nbsp&nbsp")}}const C=".sc-igl-application-info-h{display:block}.rate_amount.sc-igl-application-info{display:none;padding:0;margin:0}.booking-header.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;margin-bottom:0.5rem;gap:0.5rem}.non-ref-span.sc-igl-application-info{font-size:12px;color:var(--green)}.booking-roomtype-title.sc-igl-application-info{font-size:1.25rem;margin-right:0.5rem;margin:0;padding:0}.booking-details-container.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin:0}.booking-rateplan.sc-igl-application-info{display:flex;align-items:center;gap:0.5rem;margin:0;padding:0}.booking-rateplan-name.sc-igl-application-info{font-weight:bold;margin:0;padding:0}.booking-tooltip.sc-igl-application-info{margin-right:0.5rem;margin:0;padding:0}.booking-variation.sc-igl-application-info{margin:0;padding:0}.booking-price.sc-igl-application-info{margin:0;padding:0}.booking-footer.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin-bottom:0.5rem}.booking-details-container.sc-igl-application-info{display:none}@media (min-width: 768px){.booking-header.sc-igl-application-info{justify-content:flex-start}.booking-footer.sc-igl-application-info,.booking-price.sc-igl-application-info{display:none}.booking-details-container.sc-igl-application-info,.rate_amount.sc-igl-application-info{display:inline-flex;gap:0.5rem}}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:80%}.guest-info-container.sc-igl-application-info{max-width:300px}.preference-select-container.sc-igl-application-info{max-width:250px}}";const B=C;const N=class{constructor(t){e(this,t);this.bedPreferenceType=[];this.bookingType="PLUS_BOOKING";this.totalNights=1;this.isButtonPressed=false;this.variationService=new I}componentWillLoad(){var e,t;if(p(this.rateplanSelection.roomtype.id)){const i=this.filterRooms();if(i.length>0)this.updateGuest({unit:(t=(e=i[0])===null||e===void 0?void 0:e.id)===null||t===void 0?void 0:t.toString()})}}updateGuest(e){const t=this.rateplanSelection.roomtype.id;const i=this.rateplanSelection.ratePlan.id;let s=[...this.rateplanSelection.guest];s[this.roomIndex]=Object.assign(Object.assign({},s[this.roomIndex]),e);o.ratePlanSelections=Object.assign(Object.assign({},o.ratePlanSelections),{[t]:Object.assign(Object.assign({},o.ratePlanSelections[t]),{[i]:Object.assign(Object.assign({},this.rateplanSelection),{guest:[...s]})})})}handleButtonClicked(e){switch(e.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}getTooltipMessages(){var e,t,i,s,a,o,n;const{ratePlan:l,selected_variation:r}=this.rateplanSelection;let c=r;if((e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr){c=this.variationService.getVariationBasedOnInfants({variations:l.variations,baseVariation:r,infants:(t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr})}if(!c)return;const d=(i=l.variations)===null||i===void 0?void 0:i.find((e=>e.adult_nbr===c.adult_nbr&&e.child_nbr===c.child_nbr));if(!d)return;const h=(a=(s=d.applicable_policies)===null||s===void 0?void 0:s.find((e=>e.type==="cancelation")))===null||a===void 0?void 0:a.combined_statement;const f=(n=(o=d.applicable_policies)===null||o===void 0?void 0:o.find((e=>e.type==="guarantee")))===null||n===void 0?void 0:n.combined_statement;let b="";if(h){b+=`<b><u>Cancellation:</u></b> ${h}<br/>`}if(f){b+=`<b><u>Guarantee:</u></b> ${f}`}return b||undefined}getAmount(){var e,t;if(this.rateplanSelection.is_amount_modified){return this.rateplanSelection.view_mode==="001"?this.rateplanSelection.rp_amount:this.rateplanSelection.rp_amount*this.totalNights}let i=this.rateplanSelection.selected_variation;if((e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr){i=this.variationService.getVariationBasedOnInfants({variations:this.rateplanSelection.ratePlan.variations,baseVariation:this.rateplanSelection.selected_variation,infants:(t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr})}return i.discounted_gross_amount}filterRooms(){var e,t,i,s;const a=[];if(!u.is_frontdesk_enabled){return a}(t=(e=this.rateplanSelection.ratePlan)===null||e===void 0?void 0:e.assignable_units)===null||t===void 0?void 0:t.forEach((e=>{if(e.Is_Fully_Available){a.push({name:e.name,id:e.pr_id})}}));const o=this.rateplanSelection.guest.filter(((e,t)=>t!==this.roomIndex)).map((e=>e.unit));const n=a.filter((e=>!o.includes(e.id.toString())));return this.bookingType==="EDIT_BOOKING"?[...n,this.rateplanSelection.roomtype.id===((i=this.baseData)===null||i===void 0?void 0:i.roomtypeId)?(s=this.baseData)===null||s===void 0?void 0:s.unit:null].filter((e=>!!e)).sort(((e,t)=>e.name.localeCompare(t.name))):n}render(){var e,s,a,l,r,c,d,h,f;const g=this.filterRooms();const y=this.variationService.formatVariationBasedOnInfants({baseVariation:this.rateplanSelection.selected_variation,infants:this.guestInfo.infant_nbr,variations:this.rateplanSelection.ratePlan.variations});return t(i,{key:"fd3a8947d657d090271b09e95ec776c3735d30cc",class:"my-2"},t("div",{key:"57811d34f88b8af59be2d76903edce44702d0ecd",class:"booking-header"},(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&t("span",{key:"5e11a75da701e37c4713d50a937917c0e52e0e9a",class:"booking-roomtype-title"},this.rateplanSelection.roomtype.name),t("div",{key:"993886b37674cbaa7321a4672963008481ea8aca",class:"booking-details-container"},t("div",{key:"d176d51e378ca75aaddfa480438bfa19733a9402",class:"booking-rateplan"},t("p",{key:"fad4c674d77a5fb5fb70c90d96d54692930b8e87",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name," ",this.rateplanSelection.ratePlan.is_non_refundable&&t("span",{key:"c2013123b23f1c0feab1915583f55958764c8d84",class:"non-ref-span"},"Non Refundable")),t("ir-tooltip",{key:"d7fd76bbc00ba83d03c8be3cf79bfa600912a666",class:"booking-tooltip",message:this.getTooltipMessages()})),t("p",{key:"240fb8754b3a4c8bff8d9932c21c1de4c93f2de4",class:"booking-variation",innerHTML:y})),t("p",{key:"cb79842f2f790bac110dcf014751bd296d387941",class:"booking-price"},m((e=this.currency)===null||e===void 0?void 0:e.symbol,this.getAmount()),"/",b.entries.Lcz_Stay)),t("div",{key:"475ce2546d61ced8d1d85b8a345593c5a04b90cf",class:"booking-footer"},t("div",{key:"5b785c7408537fb612668600aa349fddb85d8e51",class:"booking-rateplan"},t("p",{key:"8746dbc63f09bf18dfb622ad0bb9e0370738a1ed",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name),t("ir-tooltip",{key:"99a212c40f5187cf0b4653cfd605f32fe180e323",class:"booking-tooltip",message:this.getTooltipMessages()})),t("p",{key:"d22b0e8fb803e1ebb3feb3952a76583a75aca04d",class:"booking-variation",innerHTML:y})),t("div",{key:"a2b30f3ce39a323f5a56b613637877da021a7cfb",class:"d-flex flex-column flex-md-row  p-0 align-items-md-center aplicationInfoContainer"},t("div",{key:"83a9497e907344007e517637c50a01f76b0affca",class:"mr-1 flex-fill guest-info-container"},t("input",{key:"8fd0ebe1bda317796aa826b929f4b917c020de81",id:_(),type:"email",class:`form-control ${this.isButtonPressed&&((s=this.guestInfo)===null||s===void 0?void 0:s.name)===""&&"border-danger"}`,placeholder:b.entries.Lcz_GuestFirstnameAndLastname,name:"guestName",onInput:e=>{const t=e.target.value;this.updateGuest({name:t});if(o.event_type.type==="EDIT_BOOKING"){n("guest",Object.assign(Object.assign({},o.guest),{name:t}))}},required:true,value:(a=this.guestInfo)===null||a===void 0?void 0:a.name})),t("div",{key:"13201ba2bb7ae92f0c7a5b4204949009473763f3",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},u.is_frontdesk_enabled&&!p(this.rateplanSelection.roomtype.id)&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&t("div",{key:"33a4a75770c1d096c927c23768ab3e9ba97b8de2",class:"mr-1 p-0 flex-fill preference-select-container"},t("select",{key:"76f4087e5848cf47948a7322b694028bcf0d6fb6",class:"form-control input-sm pr-0",id:_(),onChange:e=>this.updateGuest({unit:e.target.value})},t("option",{key:"8bb837ec359d26ebe5839ee0ff5f66e2aa89631d",value:"",selected:((l=this.guestInfo)===null||l===void 0?void 0:l.unit)===""},b.entries.Lcz_Assignunits),g===null||g===void 0?void 0:g.map((e=>{var i;return t("option",{value:e.id,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.unit)===e.id.toString()},e.name)}))))),this.rateplanSelection.roomtype.is_bed_configuration_enabled&&t("div",{key:"410db84366dac4915704b6b8419280f8b7d0b3c8",class:"mr-1 flex-fill"},t("select",{key:"074fc873e3d4bba1c21837396b1c6274209f2200",class:`form-control input-sm ${this.isButtonPressed&&((r=this.guestInfo)===null||r===void 0?void 0:r.bed_preference)===""&&"border-danger"}`,id:_(),onChange:e=>this.updateGuest({bed_preference:e.target.value})},t("option",{key:"4c102fd373407193f75e2cfb90a843b9b94e0b32",value:"",selected:((c=this.guestInfo)===null||c===void 0?void 0:c.bed_preference)===""},b.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((e=>{var i;return t("option",{value:e.CODE_NAME,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.bed_preference)===e.CODE_NAME},e.CODE_VALUE_EN)})))),t("p",{key:"215c5d73310baac6a8b567f4ccbeedc4bf53e412",class:"rate_amount"},m((d=this.currency)===null||d===void 0?void 0:d.symbol,this.getAmount()),"/",b.entries.Lcz_Stay)),this.rateplanSelection.selected_variation.child_nbr>0&&t("div",{key:"384019cdb6fc392809b45d6892d76a1fe893d6b4",style:{gap:"0.5rem",marginTop:"0.5rem"},class:"d-flex  flex-row  p-0 align-items-center aplicationInfoContainer"},t("p",{key:"c9ed2faec59d803de5dcf9f21cd8314ed93e3cb4",class:"m-0 p-0 text-danger"},"Any of the children below 3 years?"),t("div",{key:"f0b7f02571b8d53ca2e5ed7e2fc9b26b0b5442ee",class:"mr-1 flex-fill"},t("select",{key:"4e6ae44ea3ed970b570970f5b7d005f94ff03d2d",class:`form-control input-sm ${this.isButtonPressed&&((h=this.guestInfo)===null||h===void 0?void 0:h.bed_preference)===""&&"border-danger"}`,id:_(),style:{width:"max-content"},onChange:e=>this.updateGuest({infant_nbr:Number(e.target.value)})},t("option",{key:"edc575fd94251d7916b5e9764a64ba3b99c3eb4c",value:"",selected:Number((f=this.guestInfo)===null||f===void 0?void 0:f.infant_nbr)===0},b.entries["No"]||"No"),Array.from({length:this.rateplanSelection.selected_variation.child_nbr},((e,t)=>t+1)).map((e=>{var i;return t("option",{value:e,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.infant_nbr)===e},e)}))))))}};N.style=B;const Y=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const j=Y;const M=class{constructor(t){e(this,t);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.isEventHover=false;this.renderAgain=false;this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new l}async componentWillLoad(){try{this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(e){}}handleOptionalReason(e){this.blockDatesData.OPTIONAL_REASON=e.target.value;this.emitData()}handleReleaseAfterChange(e){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(e.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let e=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){e.setHours(this.entryHour,this.entryMinute,0,0)}else{e.setHours(e.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,e.getMinutes(),0,0)}return e.toLocaleString("default",{month:"short"})+" "+e.getDate()+", "+this.formatNumber(e.getHours())+":"+this.formatNumber(e.getMinutes())}formatNumber(e){return e<10?`0${e}`:e}handleOutOfService(e){this.blockDatesData.OUT_OF_SERVICE=e.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){console.log({fromDate:this.fromDate,toDate:this.toDate});return t(i,{key:"ad8d35c2fa389bb73ddc131d9a6f4890273f4403"},t("div",{key:"28bb1f72c5c95aba8462a18ffacbb69fc8e7a0e2",class:`m-0 p-0 mb-1`},t("div",{key:"8472bd05e47b4bc2e65dfef9f3992cd4e13d4a83",class:"text-left p-0"},t("ir-date-view",{key:"6cd2b50ba7d73de97b7b25c3617d1cfea7c1f64d",from_date:this.fromDate,dateOption:"YYYY-MM-DD",showDateDifference:false,to_date:this.toDate}))),t("div",{key:"41ee7b852bed50f51f4f50f6545fec22b726ac98",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},t("div",{key:"167d5973e0ae3e475f181364a74b87b0ae738e21",class:"mb-1 "},t("label",{key:"b75cb24f7752d6fee0e9f2598cb9b0a212ef6885",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},b.entries.Lcz_Reason,":"),t("div",{key:"7dc316a5e77b179327c019b6ab56cf702f0ebec6",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},t("input",{key:"7a9023a75574c746190aa444c13051c0f8312c6d",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:e=>this.handleOutOfService(e)})),t("span",{key:"bd55b13d6281b251017d6bebf9db8a83678d5707",class:"align-middle out-of-service-label"},b.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?t("div",null,t("div",{class:"mb-1 d-flex  align-items-center"},t("span",{class:"align-middle"},b.entries.Lcz_Or," "),t("div",{class:"d-inline-flex col pr-0 align-middle"},t("input",{class:"form-control",type:"text",placeholder:b.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:e=>this.handleOptionalReason(e)}))),t("div",{class:"mb-1 w-100 pr-0 "},t("span",{class:"text-bold-700 font-medium-1"},b.entries.Lcz_AutomaticReleaseIn,": "),t("div",{class:"d-inline-block"},t("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:e=>this.handleReleaseAfterChange(e)},this.releaseList.map((e=>t("option",{value:+e.CODE_NAME,selected:Number(this.blockDatesData.RELEASE_AFTER_HOURS)==Number(e.CODE_NAME)},e.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?t("div",{class:"d-inline-block releaseTime"},t("em",null,b.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};M.style=j;var T=undefined&&undefined.__rest||function(e,t){var i={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0)i[s]=e[s];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++){if(t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a]))i[s[a]]=e[s[a]]}return i};class E{setBookingInfoFromAutoComplete(e,t){var i,s,a;e.bookedByInfoData={id:t.guest.id,email:t.guest.email,firstName:t.guest.first_name,lastName:t.guest.last_name,countryId:t.guest.country_id,isdCode:(s=(i=t.guest)===null||i===void 0?void 0:i.country_phone_prefix)!==null&&s!==void 0?s:(a=t.guest)===null||a===void 0?void 0:a.country_id.toString(),contactNumber:t.guest.mobile,selectedArrivalTime:t.arrival,emailGuest:t.guest.subscribe_to_news_letter,message:t.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:t.booking_nbr,rooms:t.rooms,from_date:t.from_date,to_date:t.to_date}}resetRoomsInfoAndMessage(e){e.defaultData.roomsInfo=[];e.message=""}onDataRoomUpdate(e,t,i,s,a){let o=t;const{data:n,key:l,changedKey:r}=e.detail;const c=`c_${n.roomCategoryId}`;const d=`p_${n.ratePlanId}`;if(this.shouldClearData(l)){o=new Map}this.initializeRoomCategoryIfNeeded(c,o);if(s){if(r==="rate"){if(o.has(c)&&o.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,n,o,a,i)}}else{if(r!=="rateType"){if(r==="adult_child_offering"){if(o.has(c)&&t.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,n,o,a,i)}}else{this.applyBookingEditToSelectedRoom(c,d,n,o,a,i)}}}}else{this.setSelectedRoomData(c,d,n,o)}this.cleanupEmptyData(c,o);return o}shouldClearData(e){return e==="clearData"||e==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(e,t){if(!t.has(e)){t.set(e,new Map)}}setSelectedRoomData(e,t,i,s){let a=s.get(e);if(i.totalRooms===0||i.inventory===0){a.delete(t)}else{s.set(e,a.set(t,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(e,t){if(t.has(e)){let i=t.get(e);if(i.size===0){t.delete(e)}}}applyBookingEditToSelectedRoom(e,t,i,s,a,o){s.clear();let n={};if(o){n=Object.assign(Object.assign({},i),{guestName:a||"",roomId:""})}else{n=Object.assign({},i)}s.set(e,(new Map).set(t,n))}generateDailyRates(e,t,i){const s=new Date(t);s.setDate(s.getDate()-1);let a=new Date(e);const o=[];while(a<=s){o.push({date:D(a).format("YYYY-MM-DD"),amount:i,cost:null});a.setDate(a.getDate()+1)}return o}extractFirstNameAndLastName(e){const t=e.split(" ");return{first_name:t[0]||null,last_name:t[1]||null}}getBookedRooms({check_in:e,check_out:t,notes:i,identifier:s,override_unit:a,unit:n}){const l=[];const r=w(D(e).format("YYYY-MM-DD"),D(t).format("YYYY-MM-DD"));const c=({is_amount_modified:e,selected_variation:t,view_mode:i,rp_amount:s,ratePlan:a},o)=>{if(e){return i==="002"?s:s/r}let n=t;if(o>0){if(!this.variationService){this.variationService=new I}n=this.variationService.getVariationBasedOnInfants({variations:a.variations,baseVariation:t,infants:o})}return Number(n.discounted_amount)/r};for(const r in o.ratePlanSelections){const d=o.ratePlanSelections[r];for(const o in d){const r=d[o];if(r.reserved>0){for(let o=0;o<r.reserved;o++){const{first_name:d,last_name:h}=this.extractFirstNameAndLastName(r.guest[o].name);l.push({identifier:s,roomtype:r.roomtype,rateplan:r.ratePlan,prepayment_amount_gross:0,unit:a?{id:n}:r.guest[o].unit?{id:r.guest[o].unit}:null,occupancy:{adult_nbr:r.selected_variation.adult_nbr,children_nbr:r.selected_variation.child_nbr-Math.max(r.guest[o].infant_nbr,0),infant_nbr:r.guest[o].infant_nbr},bed_preference:r.guest[o].bed_preference,from_date:D(e).format("YYYY-MM-DD"),to_date:D(t).format("YYYY-MM-DD"),notes:i,days:this.generateDailyRates(e,t,c(r,r.guest[o].infant_nbr)),guest:{email:null,first_name:d,last_name:h,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null,cci:null}})}}}}return l}async prepareBookUserServiceParams({context:e,sourceOption:t,check_in:i}){var s;try{if(!e||!e.dateRangeData){throw new Error("Invalid context: Missing date range data.")}const a=new Date(e.dateRangeData.fromDate);const o=new Date(e.dateRangeData.toDate);const n=(t=null)=>this.getBookedRooms({check_in:a,check_out:o,identifier:t,notes:"",override_unit:e.isEventType("BAR_BOOKING")?true:false,unit:e.isEventType("BAR_BOOKING")?e.bookingData.PR_ID:null});const l=(e,t)=>{var{pickup_info:i,extra_services:s,is_direct:a,is_in_loyalty_mode:o,promo_key:n,extras:l}=e,r=T(e,["pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras"]);return{assign_units:true,check_in:false,is_pms:true,is_direct:a,is_in_loyalty_mode:o,promo_key:n,extras:l,booking:Object.assign(Object.assign({},r),{rooms:t}),extra_services:s,pickup_info:i}};let r=null;switch(e.defaultData.event_type){case"EDIT_BOOKING":{const{booking:t,currentRoomType:i}=e.defaultData;const s=t.rooms.filter((e=>e.identifier!==i.identifier));const a=n(i.identifier);r=l(t,[...s,...a]);break}case"ADD_ROOM":case"SPLIT_BOOKING":{const{booking:t}=e.defaultData;if(!t){throw new Error("Missing booking")}console.log(t);const i=n();r=l(t,[...t===null||t===void 0?void 0:t.rooms,...i]);break}default:{const l=n();const{bookedByInfoData:c}=e;const d=t.type==="TRAVEL_AGENCY";r={assign_units:true,check_in:i,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,extras:g,agent:d?{id:t.tag}:null,booking:{from_date:D(a).format("YYYY-MM-DD"),to_date:D(o).format("YYYY-MM-DD"),remark:c.message||null,booking_nbr:"",property:{id:e.propertyid},booked_on:{date:D().format("YYYY-MM-DD"),hour:(new Date).getHours(),minute:(new Date).getMinutes()},source:d?"":t,rooms:l,currency:e.currency,arrival:{code:c.selectedArrivalTime},guest:{email:c.email===""?null:c.email||null,first_name:c.firstName,last_name:c.lastName,country_id:c.countryId===""?null:c.countryId,city:null,mobile:c.contactNumber===null?"":c.contactNumber,country_phone_prefix:(s=c===null||c===void 0?void 0:c.isdCode)!==null&&s!==void 0?s:null,address:"",dob:null,subscribe_to_news_letter:c.emailGuest||false,cci:c.cardNumber?{nbr:c.cardNumber,holder_name:c.cardHolderName,expiry_month:c.expiryMonth,expiry_year:c.expiryYear}:null}},pickup_info:null};break}}return r}catch(e){console.error(e)}}getRoomCategoryByRoomId(e){var t;return(t=e.roomsInfo)===null||t===void 0?void 0:t.find((t=>t.id===e.RATE_TYPE))}setEditingRoomInfo(e,t){const i=this.getRoomCategoryByRoomId(e);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const a=`p_${e.RATE_PLAN_ID}`;const o={adultCount:e.ADULTS_COUNT,rate:e.RATE,rateType:e.RATE_TYPE,ratePlanId:e.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:e.RATE_PLAN,roomId:e.PR_ID,guestName:e.NAME,cancelation:e.cancelation,guarantee:e.guarantee,adult_child_offering:e.adult_child_offering};t.set(s,(new Map).set(a,o))}}const A=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto;padding-bottom:85px !important}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}";const G=A;const R=class{constructor(t){e(this,t);this.closeBookingWindow=s(this,"closeBookingWindow",7);this.blockedCreated=s(this,"blockedCreated",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.toast=s(this,"toast",7);this.showPaymentDetails=false;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.bookingHistory=[];this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new l;this.bookPropertyService=new E;this.updatedBooking=false;this.MAX_HISTORY_LENGTH=2}async componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this);this.initializeDefaultDateRange();if(!this.bookingData.defaultDateRange){return}console.log("testing");this.initializeDefaultData();this.wasBlockedUnit=this.defaultData.hasOwnProperty("block_exposed_unit_props");n("event_type",{type:this.defaultData.event_type});await this.fetchSetupEntriesAndInitialize();this.initializeEventData()}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(e){if(this.isEventType("SPLIT_BOOKING")){e.stopImmediatePropagation();e.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(e){e.stopImmediatePropagation();e.stopPropagation();const{key:t,data:i}=e.detail;if(t==="select"||t==="blur"&&i!==""){const e=await this.bookingService.getExposedBooking(i.booking_nbr||i,this.language);this.defaultData=Object.assign(Object.assign({},this.defaultData),{booking:e});this.bookPropertyService.setBookingInfoFromAutoComplete(this,e);this.sourceOption=e.source;this.renderPage()}}handleAdultChildChange(e){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}const{adult:t,child:i}=e.detail;this.adultChildCount=Object.assign({},e.detail);this.updateBookingHistory({adults:Number(t),children:Number(i)})}onDateRangeSelect(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.updateBookingHistory({dates:{checkIn:new Date(this.dateRangeData.fromDate),checkOut:new Date(new Date(t.data.toDate))}});console.log("date changed",t);if(t.key==="selectedDateRange"){this.dateRangeData=t.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.checkBookingAvailability()}}}handleSourceDropDown(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;const i=this.sourceOptions.find((e=>e.id===t.toString()));this.sourceOption={code:t,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}gotoSplitPageTwo(){this.gotoPage("page_two")}handleButtonClicked(e){var t,i;switch(e.detail.key){case"save":this.bookUser(false);break;case"cancel":e.stopImmediatePropagation();e.stopPropagation();this.closeWindow();break;case"back":e.stopImmediatePropagation();e.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);break;case"bookAndCheckIn":this.bookUser(true);break;case"next":e.stopImmediatePropagation();e.stopPropagation();if(!((t=this.adultChildCount)===null||t===void 0?void 0:t.adult)){this.animateIrSelect.emit("adult_child_select");break}if(r()>0){this.gotoPage("page_two");break}else if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}this.toast.emit({type:"error",description:b.entries.Lcz_SelectRatePlan,title:b.entries.Lcz_SelectRatePlan});break;case"check":this.checkBookingAvailability();break}}updateBookingHistory(e){var t,i,s,a,o,n,l,r;const c=this.bookingHistory[this.bookingHistory.length-1];const d={dates:{checkIn:((t=e.dates)===null||t===void 0?void 0:t.checkIn)||((i=c===null||c===void 0?void 0:c.dates)===null||i===void 0?void 0:i.checkIn)||new Date(this.dateRangeData.fromDate),checkOut:((s=e.dates)===null||s===void 0?void 0:s.checkOut)||((a=c===null||c===void 0?void 0:c.dates)===null||a===void 0?void 0:a.checkOut)||new Date(this.dateRangeData.toDate)},adults:(n=(o=e.adults)!==null&&o!==void 0?o:c===null||c===void 0?void 0:c.adults)!==null&&n!==void 0?n:this.adultChildCount.adult,children:(r=(l=e.children)!==null&&l!==void 0?l:c===null||c===void 0?void 0:c.children)!==null&&r!==void 0?r:this.adultChildCount.child};this.bookingHistory.push(d);if(this.bookingHistory.length>this.MAX_HISTORY_LENGTH){this.bookingHistory.shift()}}handleKeyDown(e){if(e.key==="Escape"){this.closeWindow()}}initializeDefaultDateRange(){this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE}}initializeDefaultData(){this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange)}async fetchSetupEntriesAndInitialize(){try{const e=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(e)}catch(e){console.error("Error fetching setup entries:",e)}}initializeEventData(){if(this.isEventType("EDIT_BOOKING")){this.initializeEditBookingData()}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.initializePage()}initializeEditBookingData(){var e,t,i;this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};const{currentRoomType:s}=this.defaultData;n("guest",{bed_preference:(e=s.bed_preference)===null||e===void 0?void 0:e.toString(),infant_nbr:s.occupancy.infant_nbr,name:s.guest.last_name?s.guest.first_name+" "+s.guest.last_name:s.guest.first_name,unit:(i=(t=s.unit)===null||t===void 0?void 0:t.id)===null||i===void 0?void 0:i.toString()});this.checkBookingAvailability();this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}initializePage(){switch(this.defaultData.event_type){case"SPLIT_BOOKING":this.showSplitBookingOption=true;this.page="page_one";break;case"BLOCK_DATES":this.page="page_block_date";break;default:this.page="page_one";break}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){for(const e in o.ratePlanSelections){const t=o.ratePlanSelections[e];for(const e in t){const i=t[e];if(i.reserved>0){for(const e of i.guest){if(e.name===""){return true}}}}}return false}isButtonDisabled(){const e=(e,t,i)=>{if(!e){return true}if(e===this.guestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return e(this.guestData,"guestName","")||e(this.bookedByInfoData,"firstName","")||e(this.bookedByInfoData,"lastName","")||e(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(e){this.sourceOptions=e.map((e=>({id:e.id,value:e.description,tag:e.tag,type:e.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:e[0].code,description:e[0].description,tag:e[0].tag,type:e[0].type,id:e[0].id}}}setOtherProperties(e){this.ratePricingMode=e===null||e===void 0?void 0:e.ratePricingMode;this.bookedByInfoData.arrivalTime=e.arrivalTime;this.bedPreferenceType=e.bedPreferenceType}async checkBookingAvailability(){const e=D(this.dateRangeData.fromDate).format("YYYY-MM-DD");const t=D(this.dateRangeData.toDate).format("YYYY-MM-DD");const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.isEventType("EDIT_BOOKING")?[this.defaultData.RATE_TYPE]:[];const a=this.isEventType("BAR_BOOKING")?this.defaultData.roomsInfo.map((e=>e.id)):[];const o=await this.bookingService.getBookingAvailability({from_date:e,to_date:t,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:a,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i,room_type_ids_to_update:s});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:o});if(this.isEventType("EDIT_BOOKING")&&!this.updatedBooking){this.updateBooking()}}catch(e){console.error("Error initializing booking availability:",e)}}updateBooking(){var e,t,i;try{const{currentRoomType:s}=this.defaultData;const a=s.roomtype.id;const o=s.rateplan.id;c({roomTypeId:a,ratePlanId:o,rooms:1,guest:[{bed_preference:(e=s.bed_preference)===null||e===void 0?void 0:e.toString(),infant_nbr:s.occupancy.infant_nbr,name:s.guest.last_name?s.guest.first_name+" "+s.guest.last_name:s.guest.first_name,unit:(i=(t=s.unit)===null||t===void 0?void 0:t.id)===null||i===void 0?void 0:i.toString()}]})}catch(e){console.error(e)}}async checkAndBlockDate(){try{const{block_exposed_unit_props:e}=this.defaultData;await this.bookingService.getBookingAvailability({from_date:e.from_date,to_date:e.to_date,propertyid:this.propertyid,adultChildCount:{adult:2,child:0},language:this.language,room_type_ids:this.defaultData.roomsInfo.map((e=>e.id)),currency:this.currency});const t=o.roomTypes.every((e=>e.is_available_to_book));if(t){await this.handleBlockDate(false)}else{console.log("Blocked date is unavailable. Continuing...")}}catch(e){console.error("Error checking and blocking date:",e)}}async closeWindow(){d();this.closeBookingWindow.emit();if(this.wasBlockedUnit&&!this.didReservation){await this.checkAndBlockDate()}document.removeEventListener("keydown",this.handleKeyDown)}isEventType(e){return this.defaultData.event_type===e}handleBlockDateUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.blockDatesData=t.data}handleGuestInfoUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;if(t.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[t.guestRefKey]=Object.assign(Object.assign({},t.data),{roomId:this.defaultData.PR_ID})}else this.guestData[t.guestRefKey]=t.data}}handleBookedByInfoUpdate(e){e.stopImmediatePropagation();e.stopPropagation();const t=e.detail;this.bookedByInfoData=t.value.data}renderPage(){this.renderAgain=!this.renderAgain}gotoPage(e){this.page=e;this.renderPage()}getPageBlockDatesView(){return t(a,null,t("igl-block-dates-view",{fromDate:this.defaultData.FROM_DATE,toDate:this.defaultData.TO_DATE,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:e=>this.handleBlockDateUpdate(e)}),t("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},t("ir-button",{text:b.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),t("ir-button",{text:b.entries.Lcz_Blockdates,isLoading:O("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})))}handlePageTwoDataUpdateEvent(e){e.stopImmediatePropagation();e.stopPropagation();if(e.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(e)}else{this.handleGuestInfoUpdate(e)}}async handleBlockDate(e=true){const t=this.wasBlockedUnit?this.defaultData.block_exposed_unit_props:(()=>{const e=y(+this.blockDatesData.RELEASE_AFTER_HOURS);return Object.assign({from_date:v(this.defaultData.defaultDateRange.fromDate),to_date:v(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},e)})();await this.bookingService.blockUnit(t);if(e)this.closeWindow()}async bookUser(e){this.setLoadingState(e);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else if(this.isButtonDisabled()){this.isLoading="";return}try{if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}this.didReservation=true;const t=await this.bookPropertyService.prepareBookUserServiceParams({context:this,sourceOption:this.sourceOption,check_in:e});await this.bookingService.doReservation(t);this.resetBookingEvt.emit(null)}catch(e){console.error("Error booking user:",e)}finally{this.resetLoadingState()}}setLoadingState(e){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=e?"bookAndCheckIn":"book"}}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}getCurrentPage(e){return this.page===e}render(){return t(i,{key:"463c99f091e16d415e161fb6f8bb7b7fa50e10ef"},t("div",{key:"66b37f5f24c2054af9bb558279a4509e9aa82007",class:"background-overlay",onClick:()=>this.closeWindow()}),t("div",{key:"51852a3734aa7beb962f23fac05530c5dfc73393",class:"sideWindow pb-5 pb-md-0 "+(this.getCurrentPage("page_block_date")?"block-date":"")},t("div",{key:"1f7d51eda4e8592775e0c30dd2b9b094a6d41772",class:"card position-sticky mb-0 shadow-none p-0 "},t("div",{key:"d55acb926e8866803dd687ee3aec52fd26db21ff",class:"card-header-container mb-2"},t("h3",{key:"6133d1a113536151bc6af16b228c186842162d1c",class:" text-left font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),t("ir-icon",{key:"0f36deb2b18383dc47f043c49127e6dd90085211",class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},t("svg",{key:"a2878ec8b4deaacdfa1ec667d5dc25d89ac4d0ae",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},t("path",{key:"00cac8d1dfc3dc181dd606f815850ac94b55fbc5",fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),t("div",{key:"d8d9cbde7903b35008d9fc6ae9befc6c6f7eb79b",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&t("igl-booking-overview-page",{key:"ca7a1b43703502fd4399f57c93e37da6e5af9d3d",initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&t("igl-booking-form",{key:"5614bf694e13dcc418ddef2a62d646f636817b0f",currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:e=>this.handlePageTwoDataUpdateEvent(e)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};R.style=G;const S=".sc-igl-book-property-footer-h{display:block;margin:0;padding:0}.sc-igl-book-property-footer-h>*.sc-igl-book-property-footer{margin:auto;padding:auto}.gap-30.sc-igl-book-property-footer{gap:30px}";const P=S;const K=class{constructor(t){e(this,t);this.buttonClicked=s(this,"buttonClicked",7);this.disabled=true}isEventType(e){return e===this.eventType}editNext(e){if(this.isEventType("EDIT_BOOKING")){if(e==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton(e,i,s=false,a){return t("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(i)}`:"flex-fill"},t("ir-button",{btn_color:e==="cancel"?"secondary":"primary",text:i,btn_disabled:s,onClickHandler:()=>{this.buttonClicked.emit({key:e})},icon_name:a,iconPosition:"right",style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){return t(i,{key:"bf599e8d7e69958045deab95264336640e640e17"},t("div",{key:"179b81c110a2c58ec0f9a6a7a92ed42adfcbbc57",class:"d-flex justify-content-between gap-30 align-items-center"},this.isEventType("EDIT_BOOKING")?t(a,null,this.renderButton("cancel",b.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${b.entries.Lcz_Next}`,O("/Get_Exposed_Booking_Availability"),"angles_right")):t(a,null,this.renderButton("cancel",b.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${b.entries.Lcz_Next}`,false,"angles_right"))))}};K.style=P;const L=".sc-igl-book-property-header-h{display:block}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const $=L;const z=class{constructor(t){e(this,t);this.splitBookingDropDownChange=s(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=s(this,"sourceDropDownChange",7);this.adultChild=s(this,"adultChild",7);this.checkClicked=s(this,"checkClicked",7);this.buttonClicked=s(this,"buttonClicked",7);this.toast=s(this,"toast",7);this.spiltBookingSelected=s(this,"spiltBookingSelected",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.splitBookingId="";this.bookingData="";this.sourceOptions=[];this.showSplitBookingOption=false;this.sourceOption={code:"",description:"",tag:"",id:"",type:""}}getSplitBookingList(){return t("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},t("label",{class:"mr-lg-1"},b.entries.Lcz_Tobooking,"# "),t("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},t("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:D(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:D(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:b.entries.Lcz_BookingNumber,onComboboxValue:e=>{e.stopImmediatePropagation();this.spiltBookingSelected.emit(e.detail)},isSplitBooking:true})))}getSourceNode(){return t("fieldset",{class:"d-flex text-left  align-items-center"},t("label",{class:"mr-1"},b.entries.Lcz_Source," "),t("div",{class:"btn-group mt-0 flex-fill sourceContainer"},t("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:e=>this.sourceDropDownChange.emit(e.target.value)},this.sourceOptions.map((e=>{if(e.type==="LABEL"){return t("optgroup",{label:e.value})}return t("option",{value:e.id,selected:this.sourceOption.code===e.id},e.value)})))))}handleAdultChildChange(e,t){let i={};if(t===""){i=Object.assign(Object.assign({},this.adultChildCount),{[e]:0})}else{i=Object.assign(Object.assign({},this.adultChildCount),{[e]:t})}this.adultChild.emit(i)}getAdultChildConstraints(){return t("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},t("div",{class:"form-group  my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},t("fieldset",null,t("div",{class:"btn-group ml-0"},t("ir-select",{class:"m-0",onSelectChange:e=>this.handleAdultChildChange("adult",e.detail),select_id:"adult_child_select",firstOption:b.entries.Lcz_AdultsCaption,LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((e,t)=>t+1)).map((e=>({text:e.toString(),value:e.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&t("fieldset",null,t("div",{class:"btn-group ml-1 p-0"},t("ir-select",{onSelectChange:e=>this.handleAdultChildChange("child",e.detail),select_id:"child_select",firstOption:this.renderChildCaption(),LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((e,t)=>t+1)).map((e=>({text:e.toString(),value:e.toString()})))}))),t("ir-button",{btn_id:"check_availability",isLoading:O("/Check_Availability"),icon:"",size:"sm",class:"ml-2",text:b.entries.Lcz_Check,onClickHandler:()=>this.handleButtonClicked()})))}renderChildCaption(){const e=this.adultChildConstraints.child_max_age;let t=b.entries.Lcz_Years;if(e===1){t=b.entries.Lcz_Year}return`${b.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${t}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:b.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const e=D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const t=D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=D(new Date(this.dateRangeData.fromDate));const s=D(new Date(this.dateRangeData.toDate));if(s.isBefore(t)||i.isAfter(e)){this.toast.emit({type:"error",title:`${b.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:b.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${b.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:b.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(e){return this.bookingData.event_type===e}render(){const e=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return t(i,{key:"dda948823510f82f0c3a1ea73c8ac0ef69904c2a"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),e&&this.getSourceNode(),t("div",{key:"0362772ffcd0457d6483af78d9f145768d9e9599",class:`d-flex flex-column flex-lg-row align-items-lg-center ${e?"mt-1":""}`},t("fieldset",{key:"d4bbf105508bb6339853eaf4930e5d5b73ae9ce1",class:"mt-lg-0 mr-1 "},t("igl-date-range",{key:"d532743b6f546c1204a96b592c4b2487f97fb2f2",variant:"booking",dateLabel:b.entries.Lcz_Dates,minDate:this.isEventType("PLUS_BOOKING")?D().add(-1,"months").startOf("month").format("YYYY-MM-DD"):this.minDate,disabled:this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),t("p",{key:"f19cfa8527395ab6f64b85d9573a2c70f2114670",class:"text-right mt-1 message-label"},u.tax_statement))}};z.style=$;const U=".sc-igl-booking-form-h{display:block}.card-title.sc-igl-booking-form{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-booking-form{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-booking-form{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-booking-form{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-booking-form{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-booking-form{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-booking-form{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-booking-form:not(:disabled),[type='button'].sc-igl-booking-form:not(:disabled){cursor:pointer}.row.sc-igl-booking-form{padding:0 0 0 15px;margin:0}";const V=U;const H=class{constructor(t){e(this,t);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.buttonClicked=s(this,"buttonClicked",7);this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let e=0;const t=Object.assign({},this.selectedUnits);const i=(e,t,i,s)=>{if(i&&s===2){return e*t}return e};this.selectedUnits=t;this.guestData=[];this.selectedRooms.forEach(((s,a)=>{s.forEach((s=>{t[a]=s.selectedUnits;e+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let e=1;e<=s.totalRooms;e++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=e}handleOnApplicationInfoDataUpdateEvent(e,t){const i=e.detail;const s=`c_${i.data.roomCategoryId}`;const a=[...this.selectedUnits[s]||[]];a[t]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:a});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:e.detail})}handleEventData(e,t,i){if(t==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(e,i)}else{this.selectedBookedByData=e.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:e.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const e of this.selectedGuestData){if(e.guestName===""||e.preference===""||e.roomId===""){return true}}return false}isButtonDisabled(e){const t=(e,t,i)=>{if(!e){return true}if(e===this.selectedGuestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return this.isLoading===e||t(this.selectedGuestData,"guestName","")||t(this.selectedBookedByData,"isdCode","")||t(this.selectedBookedByData,"contactNumber","")||t(this.selectedBookedByData,"firstName","")||t(this.selectedBookedByData,"lastName","")||t(this.selectedBookedByData,"countryId",-1)||t(this.selectedBookedByData,"selectedArrivalTime","")||t(this.selectedBookedByData,"email","")}render(){return t(i,{key:"6ddc60843d28a901c23c5df759424c1fba3ad899"},t("div",{key:"b626a7d1675b3826ee474524cebd09a5bf6b6df2",class:"d-flex flex-wrap"},t("ir-date-view",{key:"75762b1466e068f3f655bfda58d49c28b330474a",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&t("div",{key:"00fe43edf8b7f066c0dc8690f805b2a7a7d800ed",class:"mt-1 mt-md-0 text-right"},b.entries.Lcz_TotalPrice," ",t("span",{key:"dee2b9958c18c2f3a2502313e7308766f05f1445",class:"font-weight-bold font-medium-1"},m(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(o.ratePlanSelections).map((e=>Object.values(e).map((e=>{const i=e;if(i.reserved===0){return null}return[...new Array(i.reserved)].map(((e,s)=>t("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:i.guest?i.guest[s]:null,bookingType:this.bookingData.event_type,rateplanSelection:i,key:`${i.ratePlan.id}_${s}`,roomIndex:s,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:t("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:e=>{this.handleEventData(e,"propertyBookedBy",0)}}),this.isEditOrAddRoomEvent?t("div",{class:"d-flex p-0 mb-1 mt-2"},t("div",{class:"flex-fill mr-2"},t("ir-button",{icon:"",text:b.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"back"})})),t("div",{class:"flex-fill"},t("ir-button",{isLoading:this.isLoading==="save",onClickHandler:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:b.entries.Lcz_Save}))):t("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},t("div",{class:"flex-fill mr-md-1"},t("ir-button",{icon_name:"angles_left",btn_color:"secondary",btn_styles:"full-width align-items-center justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"back"}),text:b.entries.Lcz_Back,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}})),t("div",{class:"mt-1 mt-md-0 flex-fill"},t("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"book"}),text:b.entries.Lcz_Book}))))}};H.style=V;const W=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const F=W;const q=class{constructor(t){e(this,t);this.roomsDataUpdate=s(this,"roomsDataUpdate",7)}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(e){return e===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const e=D(this.bookingData.FROM_DATE,"YYYY-MM-DD");const t=D();if(e.isAfter(t)){return t.add(-2,"weeks").format("YYYY-MM-DD")}return e.add(-2,"weeks").format("YYYY-MM-DD")}render(){var e;return t(i,{key:"970dd26be5ec9975714f6ae6e1e696e90ac4c94a"},t("igl-book-property-header",{key:"666ea67ead29c3062472f1c6c6bca72593404589",bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),t("div",{key:"a8c5c5ddd6af9a11e81929264662ccd12a719fd8",class:" text-left"},O("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?t("div",{class:"loading-container"},t("div",{class:"loader"})):t(a,null,(e=o.roomTypes)===null||e===void 0?void 0:e.map((e=>t("igl-room-type",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${e.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomType:e,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${e.id}`)?e.id:null,onDataUpdateEvent:e=>this.roomsDataUpdate.emit(e.detail)}))))),t("igl-book-property-footer",{key:"fe3c4b09e96e69d7d4b577df182c0f092070a3bd",class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type}))}};q.style=F;const J=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center;inset:0}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}.date-range-container-cn.sc-igl-date-range{position:relative;width:fit-content}.date-range-container-cn.sc-igl-date-range:focus-within .date-range-container.sc-igl-date-range{border:1px solid #379ff2}.date-range-container.sc-igl-date-range{position:relative;gap:1rem;font-size:0.975rem;line-height:1.45;border-radius:0.21rem;border:1px solid #cacfe7;color:#3b4781;padding:0.75rem 1rem;box-sizing:border-box !important;font-weight:400;background-color:#fff;background-clip:padding-box;height:2rem;pointer-events:none;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.date-range-container-cn.sc-igl-date-range .date-range-input.sc-igl-date-range{position:absolute;width:100% !important}.date-range-container.disabled.sc-igl-date-range{border:none;padding-left:0;padding-right:0}.date-range-input[data-state='disabled'].sc-igl-date-range{cursor:default}";const Q=J;const X=class{constructor(t){e(this,t);this.dateSelectEvent=s(this,"dateSelectEvent",7);this.toast=s(this,"toast",7);this.disabled=false;this.withDateDifference=true;this.variant="default";this.renderAgain=false;this.totalNights=0;this.fromDateStr="from";this.toDateStr="to"}componentWillLoad(){this.initializeDates()}handleDataChange(e,t){if(JSON.stringify(e)!==JSON.stringify(t)){this.initializeDates()}}initializeDates(){let e=new Date;e.setHours(0,0,0,0);e.setDate(e.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights()}return[this.fromDateStr,this.toDateStr]}calculateTotalNights(){this.totalNights=w(D(this.fromDate).format("YYYY-MM-DD"),D(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(e){return e.getDate()+" "+e.toLocaleString("default",{month:"short"}).toLowerCase()+" "+e.getFullYear()}handleDateSelectEvent(e,t=""){this.dateSelectEvent.emit({key:e,data:t})}handleDateChange(e){const{start:t,end:i}=e.detail;this.fromDate=t.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:t.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){if(this.variant==="booking"){return t("div",{class:`p-0 m-0 date-range-container-cn`},t("ir-date-range",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:e=>{this.handleDateChange(e)}}),t("div",{class:`d-flex align-items-center m-0  date-range-container ${this.disabled?"disabled":""}`},t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 448 512"},t("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),t("span",null,D(this.fromDate).format("MMM DD, YYYY")),t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 512 512"},t("path",{fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),t("span",null,D(this.toDate).format("MMM DD, YYYY")),this.totalNights&&t("span",{class:"m-0 p-0"},this.totalNights+(this.totalNights>1?` ${b.entries.Lcz_Nights}`:` ${b.entries.Lcz_Night}`))))}return t(i,null,t("div",{class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},t("ir-date-picker",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,minDate:this.fromDate,"data-state":this.disabled?"disabled":"active",onDateChanged:e=>{this.handleDateChange(e)}}),t("div",{"data-state":this.disabled?"disabled":"active",class:"date-view"},t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},t("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),t("ir-date-view",{showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&t("span",null,this.totalNights&&!this.disabled?t("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${b.entries.Lcz_Nights}`:` ${b.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};X.style=Q;const Z=".sc-igl-property-booked-by-h{display:block}.row.sc-igl-property-booked-by{padding:0 0 0 15px;margin:0}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const ee=Z;const te=class{constructor(t){e(this,t);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.showPaymentDetails=false;this.countryNodeList=[];this.isButtonPressed=false;this.bookingService=new l;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const e=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((t,i)=>(e+i).toString()))}async assignCountryCode(){const e=await this.bookingService.getUserDefaultCountry();const t=e["COUNTRY_ID"];this.country=t;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:t.toString(),countryId:t})}initializeDateData(){const e=new Date;const t=e.getMonth()+1;this.currentMonth=t<10?`0${t}`:t.toString()}populateBookedByData(){var e;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((e=this.defaultData)===null||e===void 0?void 0:e.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(e,t){this.bookedByData[e]=e==="emailGuest"?t.target.checked:t.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(e==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:t.target.value})}}handleNumberInput(e,t){const i=t.target;const s=i.value;const a=/^[0-9]+$/;if(!a.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(e,t)}}async checkUser(){var e;try{const t=this.bookedByData.email;if(k.string().email().safeParse(t).success){const i=await this.bookingService.getUserInfo(t);if(i!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile_without_prefix,countryId:i.country_id,isdCode:(e=i===null||i===void 0?void 0:i.country_phone_prefix)!==null&&e!==void 0?e:i.isdCode.toString()});console.log(this.bookedByData)}else{let e=Object.assign({},this.bookedByData);e=Object.assign(Object.assign({},e),{email:t});this.bookedByData=Object.assign({},e)}}else{let e=Object.assign({},this.bookedByData);e=Object.assign(Object.assign({},e),{email:""});this.bookedByData=Object.assign({},e)}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}catch(e){}}updateGuest(e){var t;n("checkout_guest",Object.assign(Object.assign({},(t=o.checkout_guest)!==null&&t!==void 0?t:{}),e))}handleComboboxChange(e){var t;e.stopImmediatePropagation();e.stopPropagation();const{key:i,data:s}=e.detail;console.log(i,s);if(i==="blur"){if(k.string().email().safeParse(s).success){this.bookedByData.email=s;this.checkUser()}else if(this.bookedByData.email!==""&&s==""){this.bookedByData.email=""}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}if(i==="select"){this.bookedByData.email=s.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:s.id,firstName:s.first_name,lastName:s.last_name,contactNumber:s.mobile_without_prefix,countryId:s.country_id,isdCode:(t=s["country_phone_prefix"])!==null&&t!==void 0?t:s===null||s===void 0?void 0:s.country_id});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}}clearEvent(){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(e){switch(e.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return t(i,{key:"31a1c35e6954b802973a9b02c6ff58cde75cd90f"},t("div",{key:"098067c099975d096468bb6b484623010f0342b5",class:"text-left mt-3"},t("div",{key:"e53fa6d3c57e5298afe8cf13571ef9d0d2847bfd",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},t("label",{key:"6986190d8898747029f71546b89d85ea36fa9d21",class:"p-0 m-0 label-control mr-1 font-weight-bold"},b.entries.Lcz_BookedBy),t("div",{key:"09babe3e7af4138bce33085722f590cbc06bc3e3",class:"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center"},t("ir-autocomplete",{key:"9a03e62d28a116f0e56c299b8a99b2635e857de4",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"text",value:this.bookedByData.email,required:true,class:"flex-fill",placeholder:b.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent(),danger_border:this.isButtonPressed&&this.bookedByData.email!==""&&x(this.bookedByData.email)}),t("ir-tooltip",{key:"3df97425ba85d5b9224d934f1fb39bd0eabd4696",class:"ml-1",message:"Leave empty if email is unavailable"})))),t("div",{key:"84780e7ca18ed79333f041ed11c627eed0dbff3e",class:"bookedDetailsForm text-left mt-2 font-small-3 "},t("div",{key:"b671c024991d5dbf764274bf65b1fb2d40d2ebc8",class:"d-flex flex-column flex-md-row  justify-content-md-between "},t("div",{key:"f3842d9d2c2d5a1bb8c89ece18b9e0d2e4ec22f3",class:"p-0 flex-fill "},t("div",{key:"06fef1ef626f4c6621deef2811a03dd165c39608",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},t("label",{key:"49c19b0ecd9123544be9300520f706becf180979",class:"p-0 m-0 margin3"},b.entries.Lcz_FirstName),t("div",{key:"07c6b05dcbfc5e718f5efc6f12741e8e963848be",class:"p-0 m-0  controlContainer flex-fill  "},t("input",{key:"7a761b4956d5dab48ea4cd59e89dd9516bd32423",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:b.entries.Lcz_FirstName,id:_(),value:this.bookedByData.firstName,onInput:e=>{this.updateGuest({first_name:e.target.value});this.handleDataChange("firstName",e)},required:true}))),t("div",{key:"32de51847f31e6ff8d971976bd3ad488b6cf4c78",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"6eeb421197f6b04451f76fe7522a090131c01880",class:"p-0 m-0 margin3"},b.entries.Lcz_LastName),t("div",{key:"2287cc8e7209732536339b616e16f70caa126fcc",class:"p-0 m-0  controlContainer flex-fill"},t("input",{key:"b1494b76cf3d621332e6223eac97a9756e67526a",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:b.entries.Lcz_LastName,id:_(),value:this.bookedByData.lastName,onInput:e=>this.handleDataChange("lastName",e)}))),t("div",{key:"c97c1e40d321cec55effa062d9248c3d7a9d2897",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"c35d6e7ff711324b7c8741a34c4964dd40988131",class:"p-0 m-0 margin3"},b.entries.Lcz_Country),t("div",{key:"d6c98ecdd6d321f56719cfabac7d5e882ada4948",class:"p-0 m-0  controlContainer flex-fill"},t("select",{key:"d3e02f5203ecdab6f52b545646296feda332f78d",class:`form-control input-sm pr-0`,id:_(),onChange:e=>this.handleDataChange("countryId",e)},t("option",{key:"690c5828d0e85ca8c5fdaae488a22a6fb953cdb9",value:"",selected:this.bookedByData.countryId===""},b.entries.Lcz_Select),this.countryNodeList.map((e=>t("option",{value:e.id,selected:this.bookedByData.countryId===e.id},e.name)))))),t("div",{key:"62950744c1bccce8b7319ab93c9eb99ac21c4a90",class:"form-group p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"9a38ef761431c610ce881f8cfc12d4d8e055413e",class:"p-0 m-0 margin3"},b.entries.Lcz_MobilePhone),t("div",{key:"da65c6275f986e7a7202b1e62ce58ec79909c52d",class:"p-0 m-0 controlContainer flex-fill"},t("ir-phone-input",{key:"4704e353f43a8b91fbe259747c10222151014e98",language:this.language,value:this.bookedByData.contactNumber,phone_prefix:this.bookedByData.isdCode,default_country:this.bookedByData.countryId,onTextChange:e=>{this.handleDataChange("isdCode",{target:{value:e.detail.phone_prefix}});this.handleDataChange("contactNumber",{target:{value:e.detail.mobile}})}}))),t("div",{key:"7f6405f9db55ddf1fca7fc2da14e416ffc1d41eb",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"01374a534598cdf47068709b755c27e25aecc1cf",class:"p-0 m-0 margin3"},b.entries.Lcz_YourArrivalTime),t("div",{key:"38cc0c74a1b11320366863b0d42b208b63cd0a00",class:"p-0 m-0  controlContainer flex-fill"},t("select",{key:"2b7d8544cabcb95d79fb47f566e2cfa1fdfe2f95",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:_(),onChange:e=>this.handleDataChange("selectedArrivalTime",e)},this.arrivalTimeList.map((e=>t("option",{value:e.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===e.CODE_NAME},e.CODE_VALUE_EN))))))),t("div",{key:"6539b97136fd8303ca963a9f7c57c6a26ac8a6d3",class:"p-0 flex-fill  ml-md-3"},t("div",{key:"36e95886833bccceff8b9c9b05441dd3c03757d0",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},t("label",{key:"d13b722217ae5ef29a9be357a950c8320e501a90",class:"p-0 m-0 margin3"},b.entries.Lcz_AnyMessageForUs),t("div",{key:"b962a9f8591b0af249d4a9ecf90fb99e8d879f8c",class:"p-0 m-0  controlContainer flex-fill "},t("textarea",{key:"e2342b628d4dbe2e8d51ef4af2adf88a4e6c41e9",id:_(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:e=>this.handleDataChange("message",e)}))),this.showPaymentDetails&&t(a,{key:"198eefe898c9fced3d3d4e1302b88e27a0f8c589"},t("div",{key:"fa1ed372fc4a36d27e333a62189af9680beaa182",class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"a751183fe6df99de6a8fa8da2a2fc2240d15454d",class:"p-0 m-0 margin3"},b.entries.Lcz_CardNumber),t("div",{key:"03a256626b208a41004f1fc20f19aa284016dfe5",class:"p-0 m-0  controlContainer flex-fill"},t("input",{key:"a95aea4501c8de0f056cc135a4bb207b8c85a46f",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:_(),value:this.bookedByData.cardNumber,onInput:e=>this.handleNumberInput("cardNumber",e)}))),t("div",{key:"53f0d0e4f9e3c1dc532961200832fcc9f24f26e8",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"e31f845509860cb175250015cfc6c7f971ec6ce7",class:"p-0 m-0 margin3"},b.entries.Lcz_CardHolderName),t("div",{key:"01468e90230153fc1d9961ebeddbaa32ef0833d0",class:"p-0 m-0  controlContainer flex-fill"},t("input",{key:"f5466f1e7336dc1b22564e6cdb415bb31cde19d0",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:_(),value:this.bookedByData.cardHolderName,onInput:e=>this.handleDataChange("cardHolderName",e)}))),t("div",{key:"cfad3436b7d0b11745d2cc3fdb9baee0daa4fe82",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},t("label",{key:"b766da16f2f99026154f4c7367573e7babe6e871",class:"p-0 m-0 margin3"},b.entries.Lcz_ExpiryDate),t("div",{key:"ba6c089a5bf7f5828934597bc5eed91b6716ee08",class:"p-0 m-0 row  controlContainer flex-fill"},t("div",{key:"83f93bbe5f899af5a0fd190170167a6437c6b0cb",class:"p-0 m-0"},t("select",{key:"847ca015c0f8842bd441af55e597eb57c217674c",class:"form-control input-sm pr-0",id:_(),onChange:e=>this.handleDataChange("expiryMonth",e)},this.expiryMonths.map((e=>t("option",{value:e,selected:e===this.bookedByData.expiryMonth},e))))),t("div",{key:"52e67d45aff8ddce04aee522f97317ceff937c43",class:"p-0 m-0 ml-1"},t("select",{key:"c64f726a5bb44a3efaee43bb3c6e90a7e0ed62fe",class:"form-control input-sm pr-0",id:_(),onChange:e=>this.handleDataChange("expiryYear",e)},this.expiryYears.map(((e,i)=>t("option",{value:e,selected:i===this.bookedByData.expiryYear},e)))))))),t("div",{key:"3ea968512760d5208d547d9cabf8cd0fc31af50e",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},t("label",{key:"af2dc3f5bd46f0e85876208e1d70250cfae007c0",class:"p-0 m-0",htmlFor:"emailTheGuestId"},b.entries.Lcz_EmailTheGuest),t("div",{key:"3ea5c0743a0c359a3506a93d89bf3a8e7cd07ebf",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},t("input",{key:"52e8450de234e8100ee8d36e7cb499836e927fef",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:e=>this.handleDataChange("emailGuest",e)})))))))}};te.style=ee;const ie=".sc-igl-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-rate-plan span[data-state='focus'].sc-igl-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-rate-plan span[data-disabled].sc-igl-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.non-ref-span.sc-igl-rate-plan{font-size:12px;color:var(--green)}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-rate-plan{width:40%}.rateplan-container.sc-igl-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-rate-plan{max-width:200px}.rate-input-container.sc-igl-rate-plan{max-width:150px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-rate-plan{width:20%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-rate-plan{width:100%}}.total-nights-container.sc-igl-rate-plan{width:max-content}.nightBorder.sc-igl-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const se=ie;const ae=class{constructor(t){e(this,t);this.gotoSplitPageTwoEvent=s(this,"gotoSplitPageTwoEvent",7);this.ratePricingMode=[];this.bookingType="PLUS_BOOKING";this.isBookDisabled=false}disableForm(){const{bookingType:e,shouldBeDisabled:t,ratePlan:i,visibleInventory:s}=this;if(e==="EDIT_BOOKING"&&t){return false}return!i.is_available_to_book||(s===null||s===void 0?void 0:s.visibleInventory)===0}updateRateplanSelection(e){const{roomTypeId:t,ratePlan:i}=this;const s=o.ratePlanSelections;o.ratePlanSelections=Object.assign(Object.assign({},s),{[t]:Object.assign(Object.assign({},s[t]),{[i.id]:Object.assign(Object.assign({},s[t][i.id]),e)})})}handleDataChange(e,t){const i=t.target.value;if(e==="adult_child_offering"){this.handleVariationChange(i)}else if(e==="rate"){this.updateRateplanSelection({view_mode:i})}else if(e==="totalRooms"){c({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:Number(i)})}}bookProperty(){this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){const{visibleInventory:e}=this;if(!e)return"";if(e.is_amount_modified){return e.rp_amount.toString()}const{selected_variation:t,view_mode:i}=e;const s=i==="001"?t===null||t===void 0?void 0:t.discounted_gross_amount:t===null||t===void 0?void 0:t.amount_per_night_gross;return(s===null||s===void 0?void 0:s.toString())||""}formatVariation(e){var t,i,s,a;if(!e)return"";const o=`${e.adult_nbr} ${e.adult_nbr===1?(t=b.entries["Lcz_Adult"])===null||t===void 0?void 0:t.toLowerCase():(i=b.entries["Lcz_Adults"])===null||i===void 0?void 0:i.toLowerCase()}`;const n=e.child_nbr>0?`${e.child_nbr} ${e.child_nbr>1?(s=b.entries["Lcz_Children"])===null||s===void 0?void 0:s.toLowerCase():(a=b.entries["Lcz_Child"])===null||a===void 0?void 0:a.toLowerCase()}`:"";return n?`${o} ${n}`:o}getTooltipMessages(){var e,t,i,s,a;const{ratePlan:o,visibleInventory:n}=this;const l=n===null||n===void 0?void 0:n.selected_variation;if(!l)return;const r=(e=o.variations)===null||e===void 0?void 0:e.find((e=>this.formatVariation(e)===this.formatVariation(l)));if(!r)return;const c=(i=(t=r.applicable_policies)===null||t===void 0?void 0:t.find((e=>e.type==="cancelation")))===null||i===void 0?void 0:i.combined_statement;const d=(a=(s=r.applicable_policies)===null||s===void 0?void 0:s.find((e=>e.type==="guarantee")))===null||a===void 0?void 0:a.combined_statement;let h="";if(c){h+=`<b><u>Cancellation:</u></b> ${c}<br/>`}if(d){h+=`<b><u>Guarantee:</u></b> ${d}`}return h||undefined}async handleVariationChange(e){const{ratePlan:t,roomTypeId:i}=this;const s=t.variations||[];const a=s.find((t=>this.formatVariation(t)===e));if(!a)return;h({params:{selected_variation:a},ratePlanId:t.id,roomTypeId:i})}resetReserved(){const e=Object.entries(o.ratePlanSelections).reduce(((e,[t,i])=>{e[t]=Object.entries(i).reduce(((e,[t,i])=>{e[t]=Object.assign(Object.assign({},i),{reserved:0});return e}),{});return e}),{});o.ratePlanSelections=e}render(){var e,s,n;const{ratePlan:l,bookingType:r,currency:d,ratePricingMode:h,visibleInventory:f}=this;const p=l.is_available_to_book;const u=this.disableForm();const m=f===null||f===void 0?void 0:f.selected_variation;const g=(e=l.variations)===null||e===void 0?void 0:e.map((e=>this.formatVariation(e)));console.log(f);return t(i,{key:"f9389efb778a33c0773ceef26a784bfab719c197"},t("div",{key:"6c5ca4a5b71121d0133975c0fa24ba578570b412",class:`d-flex m-0 p-0 ${p?"flex-column flex-lg-row align-items-lg-center justify-content-lg-between":"align-items-center justify-content-between"}`},t("div",{key:"688597600c55863a3d7bf4ba1624cd8b25056ce4",class:"rateplan-name-container d-flex align-items-center",style:{gap:"0.5rem"}},r==="BAR_BOOKING"?t(a,null,t("span",{class:"font-weight-bold"},l.name.split("/")[0]),t("span",null,"/",l.name.split("/")[1])):t("span",null,l.short_name," ",l.is_non_refundable&&t("span",{class:"non-ref-span"},"Non Refundable")),p&&t("ir-tooltip",{key:"f307b00ac6ef3fd4912a7b9abfdc89eb6c994c97",message:this.getTooltipMessages()})),p?t("div",{class:"d-md-flex justify-content-md-end align-items-md-center flex-fill rateplan-container"},t("div",{class:"mt-1 mt-md-0 flex-fill max-w-300"},t("fieldset",{class:"position-relative"},t("select",{disabled:u,class:"form-control input-sm",id:_(),onChange:e=>this.handleDataChange("adult_child_offering",e)},g===null||g===void 0?void 0:g.map((e=>t("option",{value:e,selected:this.formatVariation(m)===e},e)))))),t("div",{class:"m-0 p-0 mt-1 mt-md-0 d-flex justify-content-between align-items-md-center ml-md-1"},t("div",{class:"d-flex m-0 p-0 rate-total-night-view mt-0"},t("ir-price-input",{disabled:u,onTextChange:e=>this.updateRateplanSelection({is_amount_modified:true,rp_amount:Number(e.detail)}),"aria-label":`${(n=(s=this.visibleInventory)===null||s===void 0?void 0:s.roomtype)===null||n===void 0?void 0:n.name} ${this.ratePlan.short_name}'s rate`,"aria-describedby":`${this.ratePlan.short_name}'s rate`,class:"ir-br-input-none",currency:d.symbol,value:this.renderRate(),placeholder:b.entries.Lcz_Rate||"Rate"}),t("fieldset",{class:"position-relative m-0 total-nights-container p-0"},t("select",{disabled:u,class:"form-control input-sm m-0 nightBorder rounded-0 py-0",id:_(),onChange:e=>this.updateRateplanSelection({view_mode:e.target.value})},h.map((e=>t("option",{value:e.CODE_NAME,selected:(f===null||f===void 0?void 0:f.view_mode)===e.CODE_NAME},e.CODE_VALUE_EN)))))),(r==="PLUS_BOOKING"||r==="ADD_ROOM")&&t("div",{class:"flex-fill mt-lg-0 ml-1 m-0 mt-md-0 p-0"},t("fieldset",{class:"position-relative"},t("select",{disabled:f.visibleInventory===0,class:"form-control input-sm",id:_(),onChange:e=>this.handleDataChange("totalRooms",e)},Array.from({length:(f.visibleInventory||0)+1},((e,t)=>t)).map((e=>t("option",{value:e,selected:f.reserved===e},e))))))),r==="EDIT_BOOKING"&&t(a,null,t("div",{class:"m-0 p-0 mt-lg-0 ml-md-1 mt-md-1 d-none d-md-block"},t("fieldset",{class:"position-relative"},t("input",{disabled:u,type:"radio",name:"ratePlanGroup",value:"1",onChange:()=>{this.resetReserved();c({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:1,guest:[{name:o.guest.name,unit:null,bed_preference:this.visibleInventory.roomtype.is_bed_configuration_enabled?o.guest.bed_preference:null,infant_nbr:this.visibleInventory.selected_variation.child_nbr>0?o.guest.infant_nbr:null}]})},checked:f.reserved===1}))),t("button",{disabled:u,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1 mt-1 d-md-none",onClick:()=>{this.resetReserved();c({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:1,guest:[{name:o.guest.name,unit:null,bed_preference:this.visibleInventory.roomtype.is_bed_configuration_enabled?o.guest.bed_preference:null,infant_nbr:this.visibleInventory.selected_variation.child_nbr>0?o.guest.infant_nbr:null}]});this.bookProperty()}},f.reserved===1?b.entries.Lcz_Current:b.entries.Lcz_Select)),(r==="BAR_BOOKING"||r==="SPLIT_BOOKING")&&t("button",{disabled:u||r==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1 mt-1",onClick:()=>this.bookProperty()},b.entries.Lcz_Book)):t("p",{class:"text-danger m-0 p-0"},b.entries["Lcz_NotAvailable"]||"Not available")))}};ae.style=se;const oe=".sc-igl-room-type-h{display:block}.margin-bottom-8.sc-igl-room-type{margin-bottom:8px !important}";const ne=oe;const le=class{constructor(t){e(this,t);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.bookingType="PLUS_BOOKING";this.ratePricingMode=[];this.roomInfoId=null;this.selectedRooms=[];this.roomsDistributions=[];this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"]}render(){var e,s;const a=this.validBookingTypes.includes(this.bookingType);return t(i,{key:"38cfbcb26719b73032bddfe7216b78ef85f886d1"},a&&((e=this.roomType.rateplans)===null||e===void 0?void 0:e.length)>0&&t("div",{key:"a7a117c3109ff613c0df1c2de3bae4f8fe8b1faa",class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomType.name),(s=this.roomType.rateplans)===null||s===void 0?void 0:s.map((e=>{if(!!e.variations){let i=this.roomInfoId&&this.roomInfoId===this.roomType.id;const s=f(this.roomType.id,e.id);console.log(s);return t("igl-rate-plan",{isBookDisabled:this.isBookDisabled,visibleInventory:s,key:`rate-plan-${e.id}`,ratePricingMode:this.ratePricingMode,class:a?"":"",currency:this.currency,ratePlan:e,roomTypeId:this.roomType.id,bookingType:this.bookingType,shouldBeDisabled:i})}return null})))}};le.style=ne;export{N as igl_application_info,M as igl_block_dates_view,R as igl_book_property,K as igl_book_property_footer,z as igl_book_property_header,H as igl_booking_form,q as igl_booking_overview_page,X as igl_date_range,te as igl_property_booked_by,ae as igl_rate_plan,le as igl_room_type};
//# sourceMappingURL=p-1a9b1459.entry.js.map