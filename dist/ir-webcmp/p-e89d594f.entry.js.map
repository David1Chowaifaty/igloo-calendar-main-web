{"version":3,"names":["irQueueManagerCss","IrQueueManagerStyle0","IrQueueManager","ticket","isLoading","tokenService","Token","data","componentWillLoad","this","setToken","init","handleTicketChange","newValue","oldValue","axios","post","ExceptionMsg","My_Result","map","r","pendingRequests","properties","formatResults","q_name","total_pending","item","split","property","pending","v","trim","undefined","pendingNumber","Number","isNaN","push","render","h","Host","class","length","style","marginTop","d","slot","label","labels","values"],"sources":["src/components/ir-queue-manager/ir-queue-manager.css?tag=ir-queue-manager&encapsulation=scoped","src/components/ir-queue-manager/ir-queue-manager.tsx"],"sourcesContent":[":host {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n","import Token from '@/models/Token';\nimport { Component, Element, Host, Prop, State, Watch, h } from '@stencil/core';\nimport axios from 'axios';\n\n@Component({\n  tag: 'ir-queue-manager',\n  styleUrl: 'ir-queue-manager.css',\n  scoped: true,\n})\nexport class IrQueueManager {\n  @Element() el: HTMLElement;\n\n  @Prop() ticket: string = '';\n\n  @State() isLoading: boolean = true;\n\n  private tokenService = new Token();\n  @State() data: {\n    pendingRequests: number[];\n    properties: string[];\n    q_name: string;\n    total_pending: number;\n  }[];\n  componentWillLoad() {\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue && newValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  private async init() {\n    const { data } = await axios.post('/Get_Q_Summary', {});\n    if (data.ExceptionMsg) {\n      return;\n    }\n    this.data = data.My_Result.map(r => {\n      const { pendingRequests, properties } = this.formatResults(r.properties);\n      return {\n        pendingRequests,\n        properties,\n        q_name: r.q_name,\n        total_pending: r.total_pending,\n      };\n    });\n    this.isLoading = false;\n  }\n  private formatResults(data: string): {\n    properties: string[];\n    pendingRequests: number[];\n  } {\n    const properties: string[] = [];\n    const pendingRequests: number[] = [];\n\n    if (!data) {\n      return { properties, pendingRequests };\n    }\n\n    for (const item of data.split(',')) {\n      const [property, pending] = item.split('|').map(v => v.trim());\n\n      if (!property || pending === undefined) continue;\n\n      const pendingNumber = Number(pending);\n      if (Number.isNaN(pendingNumber)) continue;\n\n      properties.push(property);\n      pendingRequests.push(pendingNumber);\n    }\n\n    return {\n      properties,\n      pendingRequests,\n    };\n  }\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <div class=\"ir-page__container\">\n          <h3 class=\"page-title\">Pending Queues</h3>\n\n          {this.data.length === 0 && <ir-empty-state style={{ marginTop: '20vh' }}></ir-empty-state>}\n          {this.data.map(d => (\n            <wa-card>\n              <p slot=\"header\">\n                {d.q_name} ({d.total_pending} total pending)\n              </p>\n              <ir-queue-chart label={d.q_name} labels={d.properties} values={d.pendingRequests}></ir-queue-chart>\n            </wa-card>\n          ))}\n        </div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"iIAAA,MAAMA,EAAoB,yEAC1B,MAAAC,EAAeD,E,MCQFE,EAAc,M,iDAGjBC,OAAiB,GAEhBC,UAAqB,KAEtBC,aAAe,IAAIC,EAClBC,KAMT,iBAAAC,GACE,GAAIC,KAAKN,OAAQ,CACfM,KAAKJ,aAAaK,SAASD,KAAKN,QAChCM,KAAKE,M,EAIT,kBAAAC,CAAmBC,EAAkBC,GACnC,GAAID,IAAaC,GAAYD,EAAU,CACrCJ,KAAKJ,aAAaK,SAASD,KAAKN,QAChCM,KAAKE,M,EAID,UAAMA,GACZ,MAAMJ,KAAEA,SAAeQ,EAAMC,KAAK,iBAAkB,IACpD,GAAIT,EAAKU,aAAc,CACrB,M,CAEFR,KAAKF,KAAOA,EAAKW,UAAUC,KAAIC,IAC7B,MAAMC,gBAAEA,EAAeC,WAAEA,GAAeb,KAAKc,cAAcH,EAAEE,YAC7D,MAAO,CACLD,kBACAC,aACAE,OAAQJ,EAAEI,OACVC,cAAeL,EAAEK,cAClB,IAEHhB,KAAKL,UAAY,K,CAEX,aAAAmB,CAAchB,GAIpB,MAAMe,EAAuB,GAC7B,MAAMD,EAA4B,GAElC,IAAKd,EAAM,CACT,MAAO,CAAEe,aAAYD,kB,CAGvB,IAAK,MAAMK,KAAQnB,EAAKoB,MAAM,KAAM,CAClC,MAAOC,EAAUC,GAAWH,EAAKC,MAAM,KAAKR,KAAIW,GAAKA,EAAEC,SAEvD,IAAKH,GAAYC,IAAYG,UAAW,SAExC,MAAMC,EAAgBC,OAAOL,GAC7B,GAAIK,OAAOC,MAAMF,GAAgB,SAEjCX,EAAWc,KAAKR,GAChBP,EAAgBe,KAAKH,E,CAGvB,MAAO,CACLX,aACAD,kB,CAGJ,MAAAgB,GACE,GAAI5B,KAAKL,UAAW,CAClB,OAAOkC,EAAA,yB,CAET,OACEA,EAACC,EAAI,KACHD,EAAA,OAAKE,MAAM,sBACTF,EAAA,MAAIE,MAAM,cAAY,kBAErB/B,KAAKF,KAAKkC,SAAW,GAAKH,EAAA,kBAAgBI,MAAO,CAAEC,UAAW,UAC9DlC,KAAKF,KAAKY,KAAIyB,GACbN,EAAA,eACEA,EAAA,KAAGO,KAAK,UACLD,EAAEpB,OAAM,KAAIoB,EAAEnB,cAAa,mBAE9Ba,EAAA,kBAAgBQ,MAAOF,EAAEpB,OAAQuB,OAAQH,EAAEtB,WAAY0B,OAAQJ,EAAEvB,sB","ignoreList":[]}