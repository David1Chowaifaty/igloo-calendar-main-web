import{c as t}from"./p-2925ded6.js";import{d as n}from"./p-15acbbbe.js";import{h as o}from"./p-6c4ba7c0.js";const r={bookings:[],filteredBookings:[],paginatedBookings:[],needsCheckOutBookings:[],outBookings:[],searchTerm:"",pagination:{page:1,pageSize:20,total:0,totalPages:1},today:l()};const{state:e,onChange:s}=t(r);function u(t=n){e.bookings=Array.isArray(t)?[...t]:[];i()}function c(t){e.searchTerm=t??"";i()}function i(){const t=a(e.bookings,e.today);const n=f(t,e.searchTerm);const o=n.length;const{pageSize:r}=e.pagination;const s=o===0?1:Math.ceil(o/r);const u=b(e.pagination.page,1,s);const c=(u-1)*r;const i=n.slice(c,c+r);e.filteredBookings=n;e.pagination={...e.pagination,total:o,totalPages:s,page:u};e.paginatedBookings=i;const g=p(i);e.needsCheckOutBookings=g.needsCheckOut;e.outBookings=g.out}function a(t,n){if(!n){return[]}return t.map((t=>{const o=(t.rooms??[]).filter((t=>k(t.to_date)===n));if(!o.length){return null}return{...t,rooms:o}})).filter((t=>Boolean(t)))}function f(t,n){const o=n?.trim().toLowerCase();if(!o){return t}return t.filter((t=>g(t,o)))}function g(t,n){if(!n){return true}const o=t.booking_nbr?.toLowerCase()??"";if(o.includes(n)){return true}if(h(t.guest).includes(n)){return true}return(t.rooms??[]).some((t=>h(t.guest).includes(n)))}function p(t){return t.reduce(((t,n)=>{const o=n.rooms??[];const r=o.filter((t=>m(t)));if(r.length){t.needsCheckOut.push({...n,rooms:r})}const e=o.filter((t=>d(t)));if(e.length){t.out.push({...n,rooms:e})}return t}),{needsCheckOut:[],out:[]})}function m(t){const n=t.in_out?.code??"";return n==="001"}function d(t){return t.in_out?.code==="002"}function h(t){const n=`${t?.first_name??""} ${t?.last_name??""}`.trim();return n.toLowerCase()}function l(){return o().format("YYYY-MM-DD")}function k(t){if(!t){return""}return t.slice(0,10)}function b(t,n,o){return Math.min(Math.max(t,n),o)}u();export{e as d,c as s};
//# sourceMappingURL=p-67f1b13b.js.map