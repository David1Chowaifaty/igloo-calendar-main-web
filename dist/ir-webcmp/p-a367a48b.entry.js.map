{"version":3,"names":["IglBookPropertyService","hasUnderscore","str","test","variationService","setBookingInfoFromAutoComplete","context","res","bookedByInfoData","id","guest","email","firstName","first_name","lastName","last_name","countryId","country_id","isdCode","country_phone_prefix","toString","contactNumber","mobile","selectedArrivalTime","arrival","emailGuest","subscribe_to_news_letter","message","remark","cardNumber","cardHolderName","expiryMonth","expiryYear","bookingNumber","booking_nbr","rooms","from_date","to_date","resetRoomsInfoAndMessage","defaultData","roomsInfo","onDataRoomUpdate","event","selectedUnits","isEdit","isEditBooking","name","units","data","key","changedKey","detail","roomCategoryKey","roomCategoryId","ratePlanKey","ratePlanId","this","shouldClearData","Map","initializeRoomCategoryIfNeeded","has","get","applyBookingEditToSelectedRoom","setSelectedRoomData","cleanupEmptyData","set","selectedRatePlans","totalRooms","inventory","delete","Array","fill","size","clear","guestName","roomId","calculateAmount","is_amount_modified","selected_variation","view_mode","rp_amount","total_days","nights","length","generateDailyRates","rate_plan","i","variation","amount","infant_nbr","VariationService","getVariationBasedOnInfants","variations","ratePlan","baseVariation","infants","map","n","date","night","discounted_amount","cost","getBookedRooms","check_in","check_out","notes","identifier","override_unit","unit","auto_check_in","roomTypeId","booking_store","ratePlanSelections","roomtype","rateplanId","rateplan","reserved","push","prepayment_amount_gross","occupancy","adult_nbr","children_nbr","Number","child_nbr","Math","max","bed_preference","moment","format","days","city","address","dob","cci","prepareBookUserServiceParams","dateRangeData","Error","fromDate","Date","toDate","generateNewRooms","isEventType","bookingData","PR_ID","modifyBookingDetails","pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras","rest","assign_units","is_pms","is_backend","booking","newBooking","sourceOption","bookingDraft","source","console","log","event_type","currentRoomType","filteredRooms","filter","r","newRooms","in_out","code","previousRooms","isAgent","type","e","value","selectedPaymentMethod","agent","tag","property","propertyid","booked_on","hour","getHours","minute","getMinutes","currency","nbr","holder_name","expiry_month","expiry_year","error","getRoomCategoryByRoomId","find","roomCategory","RATE_TYPE","setEditingRoomInfo","category","room_id","RATE_PLAN_ID","adultCount","ADULTS_COUNT","rate","RATE","rateType","roomCategoryName","ratePlanName","RATE_PLAN","NAME","cancelation","guarantee","adult_child_offering","iglBookPropertyCss","IglBookPropertyStyle0","sheetCss","IglBookPropertyStyle1","IglBookProperty","allowedBookingSources","language","countries","showPaymentDetails","adultChildConstraints","renderAgain","isLoading","bookingHistory","closeBookingWindow","blockedCreated","resetBookingEvt","animateIrButton","animateIrSelect","toast","initialRoomIds","page","showSplitBookingOption","guestData","blockDatesData","ratePricingMode","bedPreferenceType","bookingService","BookingService","bookPropertyService","defaultDateRange","updatedBooking","MAX_HISTORY_LENGTH","didReservation","wasBlockedUnit","componentWillLoad","roomTypes","modifyBookingStore","handleKeyDown","bind","initializeDefaultDateRange","initializeDefaultData","hasOwnProperty","fetchSetupEntriesAndInitialize","componentDidLoad","document","addEventListener","handleBodyOverflow","disconnectedCallback","removeEventListener","clearBooking","stopImmediatePropagation","stopPropagation","renderPage","handleSpiltBookingSelected","getExposedBooking","selects","sources","opt","setBookingDraft","onDateRangeSelect","resetBookingStore","updateBookingHistory","dates","checkIn","checkOut","gotoSplitPageTwo","gotoPage","handleButtonClicked","bookUser","closeWindow","resetReserved","adults","emit","calculateTotalRooms","description","locales","entries","Lcz_SelectRatePlan","title","checkBookingAvailability","partialData","lastEntry","newEntry","children","shift","FROM_DATE","TO_DATE","setupEntries","fetchSetupEntries","setSourceOptions","setOtherProperties","initializeEventData","initializeEditBookingData","initializePage","CHILDREN_COUNT","roomName","GUEST","isGuestDataIncomplete","roomtypeId","RoomGuestSchema","parse","requires_bed_preference","is_bed_configuration_enabled","bookingSource","_sourceOptions","getFilteredSourceOptions","setBookingSelectOptions","option","SOURCE","o","sourceOptions","agentIds","Set","hasAgentOnlyRoomType","some","rt","rps","rateplans","isForAgentOnly","every","rp","agents","forEach","ag","add","candidate","matchesId","arrivalTime","is_in_agent_mode","room_type_ids_to_update","room_type_ids","room","getBookingAvailability","adultChildCount","adult","child","agent_id","updateBooking","roomtype_id","reserveRooms","checkAndBlockDate","block_exposed_unit_props","isAvailable","is_available_to_book","handleBlockDate","warn","el","querySelector","classList","setTimeout","handleBlockDateUpdate","handleGuestInfoUpdate","guestRefKey","handleBookedByInfoUpdate","getPageBlockDatesView","h","Fragment","entryDate","ENTRY_DATE","onDataUpdateEvent","handlePageTwoDataUpdateEvent","auto_close","props","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","dateToFormattedString","NOTES","OPTIONAL_REASON","pr_id","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","blockUnit","setLoadingState","BookingGuestSchema","isEditOrAdd","serviceParams","doReservation","adjustBlockedDatesAfterReservation","resetLoadingState","original_from_date","current_from_date","original_to_date","current_to_date","isBefore","isAfter","getCurrentPage","render","Host","class","onClick","isRequestPending","BLOCK_DATES_TITLE","TITLE","appearance","variant","onClickHandler","library","label","defaultDaterange","eventType","selectedRooms","propertyId","selectedGuestData","defaultGuestData","isEditOrAddRoomEvent","text","Lcz_Cancel","btn_color","Lcz_Blockdates","iglBookPropertyFooterCss","IglBookPropertyFooterStyle0","IglBookPropertyFooter","buttonClicked","editNext","renderButton","disabled","form","shouldRenderTwoButtons","loading","Lcz_Next","icon_name","showBookAndCheckin","calendar_data","checkin_enabled","isSame","icon_position","Lcz_Back","Lcz_Save","Lcz_Book","Lcz_BookAndChekcIn","iglBookPropertyHeaderCss","IglBookPropertyHeaderStyle0","IglBookPropertyHeader","splitBookingId","minDate","bookingDataDefaultDateRange","splitBookings","bookings","splitBookingDropDownChange","checkClicked","spiltBookingSelected","autoValidate","adultAnimationContainer","fetchExposedBookings","getSplitBookingList","mode","debounce","defaultValue","Object","keys","Lcz_Tobooking","placeholder","Lcz_BookingNumber","b","item","getSourceNode","Lcz_Source","onchange","evt","s","target","getAdultChildConstraints","schema","z","number","min","autovalidate","Lcz_AdultsCaption","from","adult_max_nbr","_","child_max_nbr","renderChildCaption","maxAge","child_max_age","years","Lcz_Years","Lcz_Year","Lcz_ChildCaption","Lcz_ChooseBookingNumber","position","initialToDate","initialFromDate","selectedFromDate","selectedToDate","Lcz_CheckInDateShouldBeMAx","replace","Lcz_PlzSelectNumberOfGuests","getMinDate","startOf","getMaxDate","undefined","showSourceNode","dateLabel","Lcz_Dates","maxDate","Lcz_Check","tax_statement","iglBookingFormCss","IglBookingFormStyle0","IglBookingForm","selectedBookedByData","dataUpdateEvent","initializeGuestData","total","newSelectedUnits","getRate","totalNights","isRateModified","preference","dateDifference","TOTAL_PRICE","handleOnApplicationInfoDataUpdateEvent","index","categoryIdKey","updatedUnits","handleEventData","isButtonDisabled","isValidProperty","comparedBy","autoComplete","onSubmit","preventDefault","dateOption","Lcz_TotalPrice","formatAmount","symbol","values","val","guestInfo","bookingType","rateplanSelection","roomIndex","baseData","iglBookingOverviewPageCss","IglBookingOverviewPageStyle0","IglBookingOverviewPage","roomsDataUpdate","getSplitBookings","splitBookingEvents","setMinDate","today","roomType","isBookDisabled","iglPropertyBookedByCss","IglPropertyBookedByStyle0","IglPropertyBookedBy","isButtonPressed","bookedByData","guests","typedEmail","arrivalTimeList","currentMonth","country","paymentMethods","pickerRef","assignCountryCode","initializeDateData","populateBookedByData","allowed_payment_methods","p","is_active","is_payment_gateway","getUserDefaultCountry","_c","c","phone_prefix","dt","month","getMonth","CODE_NAME","getFullYear","handleDataChange","checked","setBookedByGuestManualEditState","handleCreditCardDataChange","handleCountryChange","updateGuest","checkout_guest","handleComboboxSelect","mobile_without_prefix","clearEvent","fetchGuests","fetchExposedGuest","expiryDate","year","slice","style","alignItems","gap","Lcz_BookedBy","ref","String","Boolean","validateEmail","withClear","string","safeParse","success","clearInput","Lcz_FindEmailAddress","paddingBottom","for","shape","trim","Lcz_FirstName","required","autocomplete","Lcz_LastName","Lcz_Country","testId","onCountryChange","formattedValue","countryCode","Lcz_YourArrivalTime","v4","time","selected","CODE_VALUE_EN","Lcz_AnyMessageForUs","rows","Lcz_CardNumber","Lcz_CardHolderName","split","mask","placeholderChar","blocks","MM","IMask","MaskedRange","to","maxLength","YY","Lcz_ExpiryDate","innerHTML","localizables","l","toLowerCase","Lcz_EmailTheGuest"],"sources":["src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts","src/components/igloo-calendar/igl-book-property/igl-book-property.css?tag=igl-book-property&encapsulation=scoped","src/common/sheet.css?tag=igl-book-property&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.css?tag=igl-book-property-footer&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-header/igl-book-property-header.css?tag=igl-book-property-header&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-header/igl-book-property-header.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.css?tag=igl-booking-form&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.css?tag=igl-booking-overview-page&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-property-booked-by/igl-property-booked-by.css?tag=igl-property-booked-by&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-property-booked-by/igl-property-booked-by.tsx"],"sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class IglBookPropertyService {\n  private hasUnderscore(str: string): boolean {\n    return /_+/.test(str);\n  }\n  private variationService: VariationService;\n  public setBookingInfoFromAutoComplete(context, res) {\n    context.bookedByInfoData = {\n      id: res.guest.id,\n      email: res.guest.email,\n      firstName: res.guest.first_name,\n      lastName: res.guest.last_name,\n      countryId: res.guest.country_id,\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\n      contactNumber: res.guest.mobile,\n      selectedArrivalTime: res.arrival,\n      emailGuest: res.guest.subscribe_to_news_letter,\n      message: res.remark,\n      cardNumber: '',\n      cardHolderName: '',\n      expiryMonth: '',\n      expiryYear: '',\n      bookingNumber: res.booking_nbr,\n      rooms: res.rooms,\n      from_date: res.from_date,\n      to_date: res.to_date,\n    };\n  }\n\n  public resetRoomsInfoAndMessage(context) {\n    context.defaultData.roomsInfo = [];\n    context.message = '';\n  }\n\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\n    let units = selectedUnits;\n    const { data, key, changedKey } = event.detail;\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\n    const ratePlanKey = `p_${data.ratePlanId}`;\n\n    if (this.shouldClearData(key)) {\n      units = new Map();\n    }\n\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\n\n    if (isEditBooking) {\n      if (changedKey === 'rate') {\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n        }\n      } else {\n        if (changedKey !== 'rateType') {\n          if (changedKey === 'adult_child_offering') {\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n            }\n          } else {\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n          }\n        }\n      }\n    } else {\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\n    }\n    this.cleanupEmptyData(roomCategoryKey, units);\n    return units;\n  }\n\n  private shouldClearData(key: string | undefined): boolean {\n    return key === 'clearData' || key === 'EDIT_BOOKING';\n  }\n\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (!selectedUnits.has(roomCategoryKey)) {\n      selectedUnits.set(roomCategoryKey, new Map());\n    }\n  }\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n    if (data.totalRooms === 0 || data.inventory === 0) {\n      selectedRatePlans.delete(ratePlanKey);\n    } else {\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\n    }\n  }\n\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (selectedUnits.has(roomCategoryKey)) {\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n      if (selectedRatePlans.size === 0) {\n        selectedUnits.delete(roomCategoryKey);\n      }\n    }\n  }\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\n    selectedUnits.clear();\n    let res = {};\n    if (isEdit) {\n      res = { ...data, guestName: name || '', roomId: '' };\n    } else {\n      res = { ...data };\n    }\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\n  }\n\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  // private extractFirstNameAndLastName(name: string) {\n  //   const names = name.split(' ');\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\n  // }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Date;\n    check_out: Date;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: Number(rateplan.selected_variation.child_nbr ?? 0) - Math.max(Number(rateplan.guest[i].infant_nbr ?? 0), 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n\n  async prepareBookUserServiceParams({ context, check_in }: { context: any; check_in: boolean }) {\n    try {\n      // Validate context structure\n      if (!context || !context.dateRangeData) {\n        throw new Error('Invalid context: Missing date range data.');\n      }\n\n      const fromDate = new Date(context.dateRangeData.fromDate);\n      const toDate = new Date(context.dateRangeData.toDate);\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n      const sourceOption = booking_store.bookingDraft.source;\n      console.log({ sourceOption });\n      console.log({ event_type: context.defaultData.event_type, defaultData: context.defaultData });\n      switch (context.defaultData.event_type) {\n        case 'EDIT_BOOKING': {\n          const { booking, currentRoomType } = context.defaultData;\n\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\n          console.log('currentRoomType', currentRoomType);\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const { booking } = context.defaultData;\n          // console.log(booking);\n          if (!booking) {\n            throw new Error('Missing booking');\n          }\n          const newRooms = generateNewRooms();\n          // const previousRooms = context.defaultData.event_type === 'ADD_ROOM' ? ROOMS ?? [] : booking?.rooms;\n          const previousRooms = booking.rooms;\n          newBooking = modifyBookingDetails(booking, [...previousRooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByInfoData } = context;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras: [...extras.filter(e => e.key !== 'payment_code'), { key: 'payment_code', value: booking_store.selectedPaymentMethod?.code }],\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            booking: {\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByInfoData.message || null,\n              booking_nbr: '',\n              property: {\n                id: context.propertyid,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: context.currency,\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\n              guest: {\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\n                first_name: bookedByInfoData.firstName,\n                last_name: bookedByInfoData.lastName,\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\n                city: null,\n                mobile: bookedByInfoData.contactNumber === null ? '' : this.hasUnderscore(bookedByInfoData.contactNumber) ? '' : bookedByInfoData.contactNumber,\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\n                address: '',\n                dob: null,\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\n                cci: bookedByInfoData.cardNumber\n                  ? {\n                      nbr: bookedByInfoData.cardNumber,\n                      holder_name: bookedByInfoData.cardHolderName,\n                      expiry_month: bookedByInfoData.expiryMonth,\n                      expiry_year: bookedByInfoData.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private getRoomCategoryByRoomId(bookingData) {\n    return bookingData.roomsInfo?.find(roomCategory => {\n      return roomCategory.id === bookingData.RATE_TYPE;\n    });\n  }\n  public setEditingRoomInfo(bookingData, selectedUnits) {\n    const category = this.getRoomCategoryByRoomId(bookingData);\n    const room_id = !category ? '' : `c_${category?.id}`;\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\n    const data = {\n      adultCount: bookingData.ADULTS_COUNT,\n      rate: bookingData.RATE,\n      rateType: bookingData.RATE_TYPE,\n      ratePlanId: bookingData.RATE_PLAN_ID,\n      roomCategoryId: category ? category.id : '',\n      roomCategoryName: category ? category.name : '',\n      totalRooms: 1,\n      ratePlanName: bookingData.RATE_PLAN,\n      roomId: bookingData.PR_ID,\n      guestName: bookingData.NAME,\n      cancelation: bookingData.cancelation,\n      guarantee: bookingData.guarantee,\n      adult_child_offering: bookingData.adult_child_offering,\n    };\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\n  }\n}\n",":host {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100vw;\n  min-height: 100vh;\n  z-index: 99;\n  overflow: hidden;\n  /* min-width: 450px; */\n}\n\n.card-title {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n}\n.card-header-container {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  padding: 1rem 0;\n  justify-content: space-between;\n}\n.fd-book-property__title {\n  margin: 0;\n  padding: 0;\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-l);\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.card-header-container h3 {\n  padding: 0;\n  margin: 0;\n}\n\n.background-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.25);\n}\n\n.formContainer {\n  height: calc(100% - 79px);\n  overflow: auto;\n}\n.gap-30 {\n  gap: 30px;\n}\n.block-date {\n  width: 100%;\n}\n.sideWindow {\n  position: absolute;\n  inset: 0;\n  left: unset;\n  background-color: #ffffff;\n  width: 100%;\n  overflow: auto;\n  animation: slideInFromRight 0.5s;\n}\n.card {\n  top: 0;\n  z-index: 1000;\n}\n\n.close {\n  float: right;\n  font-size: 1.5rem;\n  font-weight: 700;\n  line-height: 1;\n  color: #000;\n  text-shadow: 0 1px 0 #fff;\n  opacity: 0.5;\n  padding: 0;\n  background-color: transparent;\n  border: 0;\n  appearance: none;\n}\n\n.close-icon {\n  position: absolute;\n  top: 18px;\n  right: 33px;\n  outline: none;\n}\n\nbutton:not(:disabled),\n[type='button']:not(:disabled) {\n  cursor: pointer;\n}\n.sheet-footer {\n  width: 100%;\n}\n\n.card-header-container {\n  --spacing: var(--wa-space-l);\n  padding: 0;\n  display: flex;\n  flex-wrap: nowrap;\n  padding-inline-start: var(--spacing);\n  padding-block-end: 0;\n  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));\n  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));\n  border-bottom: 1px solid var(--wa-color-surface-border);\n  padding-bottom: calc(var(--spacing) / 2);\n  background-color: var(--wa-color-surface-default);\n}\n/* .row {\n  padding: 0 0 0 15px;\n  margin: 0;\n} */\n@media only screen and (min-width: 1200px) {\n  .sideWindow {\n    max-width: 70%;\n  }\n}\n@media only screen and (min-width: 2000px) {\n  .sideWindow {\n    max-width: 40%;\n  }\n}\n@media only screen and (min-width: 768px) and (max-width: 1200px) {\n  .sideWindow {\n    max-width: 90%;\n  }\n}\n@media only screen and (min-width: 600px) and (max-width: 768px) {\n  .sideWindow {\n    max-width: 75%;\n  }\n}\n@media only screen and (min-width: 641px) {\n  .block-date {\n    max-width: 450px;\n    padding-bottom: 0 !important;\n  }\n}\n@keyframes slideInFromRight {\n  from {\n    transform: translateX(120%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n@keyframes slideOutToRight {\n  from {\n    transform: translateX(0);\n  }\n  to {\n    transform: translateX(120%);\n  }\n}\n\n.sideWindow--exit {\n  animation: slideOutToRight 0.5s forwards;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, h, Listen, Fragment } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { dateToFormattedString, getReleaseHoursString, handleBodyOverflow } from '@/utils/utils';\nimport { ICountry, IEntries, RoomBlockDetails } from '@/models/IBooking';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyService } from './igl-book-property.service';\nimport { BookingSource, IglBookPropertyPayloadEditBooking, TAdultChildConstraints, TEventType, TPropertyButtonsTypes } from '@/models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, {\n  calculateTotalRooms,\n  modifyBookingStore,\n  reserveRooms,\n  resetBookingStore,\n  resetReserved,\n  setBookingDraft,\n  setBookingSelectOptions,\n} from '@/stores/booking.store';\nimport moment from 'moment';\nimport { BookingGuestSchema, RoomGuestSchema } from './types';\nexport type IHistoryEntry = {\n  dates: { checkIn: Date; checkOut: Date };\n  adults: number;\n  children: number;\n};\n@Component({\n  tag: 'igl-book-property',\n  styleUrls: ['igl-book-property.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBookProperty {\n  @Prop() propertyid: number;\n  @Prop() allowedBookingSources: any;\n  @Prop() language: string;\n  @Prop() countries: ICountry[];\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true, mutable: true }) bookingData: { [key: string]: any };\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n\n  @State() renderAgain: boolean = false;\n  @State() dateRangeData: { [key: string]: any };\n  @State() defaultData: any;\n  @State() isLoading: string;\n  @State() bookingHistory: Array<{\n    dates: { checkIn: Date; checkOut: Date };\n    adults: number;\n    children: number;\n  }> = [];\n\n  @Event() closeBookingWindow: EventEmitter<{ [key: string]: any }>;\n  @Event() blockedCreated: EventEmitter<RoomBlockDetails>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n\n  private initialRoomIds: { roomName: string; ratePlanId: number; roomId: string; roomTypeId: string } | null = null;\n  private page: string;\n  private showSplitBookingOption: boolean = false;\n  private guestData: { [key: string]: any }[] = [];\n  private bookedByInfoData: { [key: string]: any } = {};\n  private blockDatesData: { [key: string]: any } = {};\n  private ratePricingMode: IEntries[] = [];\n  private selectedUnits: Map<string, Map<string, any>> = new Map();\n  private bedPreferenceType: IEntries[] = [];\n  private bookingService: BookingService = new BookingService();\n  private bookPropertyService = new IglBookPropertyService();\n  private defaultDateRange: { from_date: string; to_date: string };\n  private updatedBooking: boolean = false;\n  private MAX_HISTORY_LENGTH: number = 2;\n  private didReservation: boolean;\n  private wasBlockedUnit: boolean;\n\n  async componentWillLoad() {\n    if (booking_store.roomTypes) {\n      modifyBookingStore('roomTypes', []);\n      modifyBookingStore('ratePlanSelections', {});\n    }\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.initializeDefaultDateRange();\n\n    if (!this.bookingData.defaultDateRange) {\n      return;\n    }\n    this.initializeDefaultData();\n    this.wasBlockedUnit = this.defaultData.hasOwnProperty('block_exposed_unit_props');\n    modifyBookingStore('event_type', { type: this.defaultData.event_type });\n    this.fetchSetupEntriesAndInitialize();\n  }\n\n  componentDidLoad() {\n    document.addEventListener('keydown', this.handleKeyDown);\n    handleBodyOverflow(true);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  @Listen('inputCleared')\n  clearBooking(e: CustomEvent) {\n    if (this.isEventType('SPLIT_BOOKING')) {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.bookedByInfoData = {};\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n      this.renderPage();\n    }\n  }\n\n  @Listen('spiltBookingSelected')\n  async handleSpiltBookingSelected(e: CustomEvent<{ key: string; data: unknown }>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { key, data } = e.detail;\n    if (key === 'select' || (key === 'blur' && data !== '')) {\n      const res = await this.bookingService.getExposedBooking((data as any).booking_nbr || (data as string), this.language);\n      this.defaultData = { ...this.defaultData, booking: res };\n      this.bookPropertyService.setBookingInfoFromAutoComplete(this, res);\n      const sourceOption = booking_store.selects.sources.find(opt => opt.code === res.source.code);\n      setBookingDraft({\n        source: sourceOption,\n      });\n      this.renderPage();\n    }\n  }\n  @Listen('dateSelectEvent')\n  onDateRangeSelect(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    resetBookingStore(false);\n    const opt: { [key: string]: any } = event.detail;\n    this.updateBookingHistory({\n      dates: {\n        checkIn: new Date(this.dateRangeData.fromDate),\n        checkOut: new Date(new Date(opt.data.toDate)),\n      },\n    });\n    if (opt.key === 'selectedDateRange') {\n      this.dateRangeData = opt.data;\n      if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n        this.defaultData.roomsInfo = [];\n      } else if (booking_store.bookingDraft.occupancy.adults) {\n        // this.checkBookingAvailability();\n        // this.checkBookingAvailability(dateToFormattedString(new Date(this.dateRangeData.fromDate)), dateToFormattedString(new Date(this.dateRangeData.toDate)));\n      }\n    }\n  }\n\n  @Listen('gotoSplitPageTwoEvent', { target: 'window' })\n  gotoSplitPageTwo() {\n    this.gotoPage('page_two');\n  }\n\n  @Listen('buttonClicked')\n  handleButtonClicked(event: CustomEvent<{ key: TPropertyButtonsTypes; data?: CustomEvent }>) {\n    switch (event.detail.key) {\n      case 'save':\n        this.bookUser(false);\n        break;\n      case 'cancel':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        this.closeWindow();\n        break;\n      case 'back':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (this.isEventType('BAR_BOOKING')) {\n          resetReserved();\n        }\n        this.gotoPage('page_one');\n        break;\n      case 'book':\n        this.bookUser(false);\n        break;\n      case 'bookAndCheckIn':\n        this.bookUser(true);\n        break;\n      case 'next':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (!booking_store.bookingDraft.occupancy?.adults) {\n          this.animateIrSelect.emit('adult_child_select');\n          break;\n        }\n        if (calculateTotalRooms() > 0) {\n          this.gotoPage('page_two');\n          break;\n        } else if (this.defaultData?.roomsInfo.length === 0) {\n          this.animateIrButton.emit('check_availability');\n          break;\n        }\n        this.toast.emit({\n          type: 'error',\n          description: locales.entries.Lcz_SelectRatePlan,\n          title: locales.entries.Lcz_SelectRatePlan,\n        });\n        break;\n      case 'check':\n        this.checkBookingAvailability();\n        break;\n      default:\n        break;\n    }\n  }\n\n  private updateBookingHistory(partialData: Partial<IHistoryEntry>) {\n    const lastEntry = this.bookingHistory[this.bookingHistory.length - 1];\n\n    const newEntry: IHistoryEntry = {\n      dates: {\n        checkIn: partialData.dates?.checkIn || lastEntry?.dates?.checkIn || new Date(this.dateRangeData.fromDate),\n        checkOut: partialData.dates?.checkOut || lastEntry?.dates?.checkOut || new Date(this.dateRangeData.toDate),\n      },\n      adults: partialData.adults ?? lastEntry?.adults ?? booking_store.bookingDraft.occupancy?.adults,\n      children: partialData.children ?? lastEntry?.children ?? booking_store.bookingDraft.occupancy.children,\n    };\n\n    // Update the booking history\n    this.bookingHistory.push(newEntry);\n    if (this.bookingHistory.length > this.MAX_HISTORY_LENGTH) {\n      this.bookingHistory.shift();\n    }\n  }\n\n  private handleKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      this.closeWindow();\n    }\n  }\n\n  private initializeDefaultDateRange() {\n    this.defaultDateRange = {\n      from_date: this.bookingData.FROM_DATE,\n      to_date: this.bookingData.TO_DATE,\n    };\n  }\n\n  private initializeDefaultData() {\n    this.defaultData = this.bookingData;\n    this.dateRangeData = { ...this.defaultData.defaultDateRange };\n    setBookingDraft({\n      dates: {\n        checkIn: moment(this.defaultData.defaultDateRange.fromDate),\n        checkOut: moment(this.defaultData.defaultDateRange.toDate),\n      },\n    });\n  }\n\n  private async fetchSetupEntriesAndInitialize() {\n    try {\n      const setupEntries = await this.fetchSetupEntries();\n      this.setSourceOptions(this.allowedBookingSources);\n      this.setOtherProperties(setupEntries);\n      this.initializeEventData();\n    } catch (error) {\n      console.error('Error fetching setup entries:', error);\n    }\n  }\n\n  private initializeEventData() {\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.initializeEditBookingData();\n    }\n\n    if (!this.isEventType('BAR_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n\n    this.initializePage();\n  }\n\n  private initializeEditBookingData() {\n    setBookingDraft({\n      occupancy: {\n        adults: Number(this.defaultData.ADULTS_COUNT),\n        children: Number(this.defaultData.CHILDREN_COUNT),\n      },\n    });\n    this.initialRoomIds = {\n      roomName: this.defaultData.roomName,\n      ratePlanId: this.defaultData.RATE_PLAN_ID,\n      roomId: this.defaultData.PR_ID,\n      roomTypeId: this.defaultData.RATE_TYPE,\n    };\n    const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n    modifyBookingStore('guest', {\n      bed_preference: currentRoomType.bed_preference?.toString(),\n      infant_nbr: currentRoomType.occupancy.infant_nbr,\n      first_name: GUEST.first_name ?? '',\n      last_name: GUEST.last_name ?? '',\n      // name: currentRoomType.guest.last_name ? currentRoomType.guest.first_name + ' ' + currentRoomType.guest.last_name : currentRoomType.guest.first_name,\n      unit: (currentRoomType.unit as any)?.id?.toString(),\n    });\n    this.checkBookingAvailability();\n    this.bookPropertyService.setEditingRoomInfo(this.defaultData, this.selectedUnits);\n  }\n\n  private initializePage() {\n    switch (this.defaultData.event_type) {\n      case 'SPLIT_BOOKING':\n        this.showSplitBookingOption = true;\n        this.page = 'page_one';\n        break;\n      case 'BLOCK_DATES':\n        this.page = 'page_block_date';\n        break;\n      default:\n        this.page = 'page_one';\n        break;\n    }\n  }\n\n  async fetchSetupEntries() {\n    return await this.bookingService.fetchSetupEntries();\n  }\n\n  private isGuestDataIncomplete() {\n    for (const roomtypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomtypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (const guest of rateplan.guest) {\n            RoomGuestSchema.parse({ ...guest, requires_bed_preference: rateplan.roomtype.is_bed_configuration_enabled });\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  // private isButtonDisabled() {\n  //   const isValidProperty = (property, key, comparedBy) => {\n  //     if (!property) {\n  //       return true;\n  //     }\n  //     if (property === this.guestData) {\n  //       return this.isGuestDataIncomplete();\n  //     }\n  //     if (key === 'selectedArrivalTime') {\n  //       if (property[key] !== undefined) {\n  //         return property[key].code === '';\n  //       } else {\n  //         return true;\n  //       }\n  //     }\n  //     return property[key] === comparedBy || property[key] === undefined;\n  //   };\n  //   return (\n  //     isValidProperty(this.guestData, 'guestName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'firstName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'lastName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'selectedArrivalTime', '')\n  //   );\n  // }\n\n  private setSourceOptions(bookingSource: BookingSource[]) {\n    const _sourceOptions = this.isEventType('BAR_BOOKING') ? this.getFilteredSourceOptions(bookingSource) : bookingSource;\n    setBookingSelectOptions({\n      sources: _sourceOptions,\n    });\n    let sourceOption: BookingSource;\n    if (this.isEventType('EDIT_BOOKING')) {\n      const option = bookingSource.find(option => this.defaultData.SOURCE?.code === option.code);\n      sourceOption = option;\n    } else {\n      sourceOption = _sourceOptions.find(o => o.type !== 'LABEL');\n    }\n    setBookingDraft({\n      source: sourceOption,\n    });\n  }\n  private getFilteredSourceOptions(sourceOptions: BookingSource[]): BookingSource[] {\n    const agentIds = new Set<string>();\n    const hasAgentOnlyRoomType =\n      this.bookingData?.roomsInfo?.some((rt: any) => {\n        const rps = rt?.rateplans ?? [];\n        if (rps.length === 0) return false;\n\n        const isForAgentOnly = rps.every((rp: any) => (rp?.agents?.length ?? 0) > 0);\n        if (isForAgentOnly) {\n          rps.forEach((rp: any) => {\n            (rp?.agents ?? []).forEach((ag: any) => agentIds.add(ag?.id?.toString()));\n          });\n        }\n        return isForAgentOnly;\n      }) ?? false;\n    if (!hasAgentOnlyRoomType) {\n      return sourceOptions;\n    }\n    return sourceOptions.filter((opt: any) => {\n      if (opt?.type === 'LABEL') return true;\n      const candidate = opt?.tag;\n      const matchesId = candidate != null && agentIds.has(candidate);\n      return matchesId;\n    });\n  }\n\n  private setOtherProperties(res: any) {\n    this.ratePricingMode = res?.ratePricingMode;\n    this.bookedByInfoData.arrivalTime = res.arrivalTime;\n    this.bedPreferenceType = res.bedPreferenceType;\n  }\n\n  private async checkBookingAvailability() {\n    resetBookingStore(false);\n    const { source, occupancy } = booking_store.bookingDraft;\n    const from_date = moment(this.dateRangeData.fromDate).format('YYYY-MM-DD');\n    const to_date = moment(this.dateRangeData.toDate).format('YYYY-MM-DD');\n    const is_in_agent_mode = source?.type === 'TRAVEL_AGENCY';\n    try {\n      const room_type_ids_to_update = this.isEventType('EDIT_BOOKING') ? [this.defaultData.RATE_TYPE] : [];\n      const room_type_ids = this.isEventType('BAR_BOOKING') ? this.defaultData.roomsInfo.map(room => room.id) : [];\n      const data = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: occupancy.adults,\n          child: occupancy.children,\n        },\n        language: this.language,\n        room_type_ids,\n        currency: this.currency,\n        agent_id: is_in_agent_mode ? source?.tag : null,\n        is_in_agent_mode,\n        room_type_ids_to_update,\n      });\n      if (!this.isEventType('EDIT_BOOKING')) {\n        this.defaultData.defaultDateRange.fromDate = new Date(this.dateRangeData.fromDate);\n        this.defaultData.defaultDateRange.toDate = new Date(this.dateRangeData.toDate);\n      }\n      this.defaultData = { ...this.defaultData, roomsInfo: data };\n      if (this.isEventType('EDIT_BOOKING') && !this.updatedBooking) {\n        this.updateBooking();\n      }\n    } catch (error) {\n      console.error('Error initializing booking availability:', error);\n    }\n  }\n\n  private updateBooking() {\n    try {\n      const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n      const roomtypeId = currentRoomType.roomtype.id;\n      const rateplanId = currentRoomType.rateplan.id;\n      const guest = {\n        bed_preference: currentRoomType.bed_preference?.toString(),\n        infant_nbr: currentRoomType.occupancy.infant_nbr,\n        last_name: GUEST.last_name,\n        first_name: GUEST.first_name,\n        unit: (currentRoomType.unit as any)?.id?.toString(),\n        roomtype_id: currentRoomType.roomtype.id,\n      };\n      modifyBookingStore('guest', guest);\n      reserveRooms({\n        roomTypeId: roomtypeId,\n        ratePlanId: rateplanId,\n        rooms: 1,\n        guest: [guest],\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  private async checkAndBlockDate() {\n    try {\n      const { block_exposed_unit_props } = this.defaultData;\n      await this.bookingService.getBookingAvailability({\n        from_date: block_exposed_unit_props.from_date,\n        to_date: block_exposed_unit_props.to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: 2,\n          child: 0,\n        },\n        language: this.language,\n        room_type_ids: this.defaultData.roomsInfo.map(room => room.id),\n        currency: this.currency,\n      });\n      const isAvailable = booking_store.roomTypes.every(rt => {\n        if (rt.is_available_to_book) {\n          return true;\n        }\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\n      });\n      if (isAvailable) {\n        await this.handleBlockDate(false);\n      } else {\n        console.warn('Blocked date is unavailable. Continuing...');\n      }\n    } catch (error) {\n      console.error('Error checking and blocking date:', error);\n    }\n  }\n  private async closeWindow() {\n    resetBookingStore(true);\n    handleBodyOverflow(false);\n\n    if (this.wasBlockedUnit && !this.didReservation) {\n      await this.checkAndBlockDate();\n    }\n    const el = document.querySelector('.sideWindow');\n    if (!el) return;\n\n    el.classList.add('sideWindow--exit');\n\n    setTimeout(() => {\n      this.closeBookingWindow.emit();\n      document.removeEventListener('keydown', this.handleKeyDown);\n    }, 300);\n  }\n\n  private isEventType(key: TEventType) {\n    return this.defaultData.event_type === key;\n  }\n\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.blockDatesData = opt.data;\n  }\n\n  private handleGuestInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt = event.detail;\n    if (opt.guestRefKey) {\n      if (this.isEventType('BAR_BOOKING') || this.wasBlockedUnit || this.isEventType('SPLIT_BOOKING')) {\n        this.guestData[opt.guestRefKey] = {\n          ...opt.data,\n          roomId: this.defaultData.PR_ID,\n        };\n      } else this.guestData[opt.guestRefKey] = opt.data;\n    }\n  }\n\n  private handleBookedByInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.bookedByInfoData = opt.value.data;\n  }\n\n  private renderPage() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  private gotoPage(gotoPage: string) {\n    this.page = gotoPage;\n    this.renderPage();\n  }\n\n  private getPageBlockDatesView() {\n    return (\n      <Fragment>\n        <igl-block-dates-view\n          fromDate={this.defaultData.FROM_DATE}\n          toDate={this.defaultData.TO_DATE}\n          entryDate={this.defaultData.ENTRY_DATE}\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\n        ></igl-block-dates-view>\n      </Fragment>\n    );\n  }\n\n  private handlePageTwoDataUpdateEvent(event: CustomEvent<IPageTwoDataUpdateProps>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    if (event.detail.key === 'propertyBookedBy') {\n      this.handleBookedByInfoUpdate(event);\n    } else {\n      this.handleGuestInfoUpdate(event);\n    }\n  }\n\n  private async handleBlockDate(auto_close = true) {\n    const props = this.wasBlockedUnit\n      ? this.defaultData.block_exposed_unit_props\n      : (() => {\n          const releaseData = getReleaseHoursString(+this.blockDatesData.RELEASE_AFTER_HOURS);\n          return {\n            from_date: dateToFormattedString(this.defaultData.defaultDateRange.fromDate),\n            to_date: dateToFormattedString(this.defaultData.defaultDateRange.toDate),\n            NOTES: this.blockDatesData.OPTIONAL_REASON || '',\n            pr_id: this.defaultData.PR_ID.toString(),\n            STAY_STATUS_CODE: this.blockDatesData.OUT_OF_SERVICE ? '004' : this.blockDatesData.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\n            DESCRIPTION: this.blockDatesData.RELEASE_AFTER_HOURS || '',\n            ...releaseData,\n          };\n        })();\n    // const blockedUnit = await transformNewBLockedRooms(result);\n    await this.bookingService.blockUnit(props);\n    // this.blockedCreated.emit(blockedUnit);\n    if (auto_close) this.closeWindow();\n  }\n\n  private async bookUser(check_in: boolean) {\n    // if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n    //   if (this.isGuestDataIncomplete()) {\n    //     this.isLoading = '';\n    //     return;\n    //   }\n    // } else if (this.isButtonDisabled()) {\n    //   this.isLoading = '';\n    //   return;\n    // }\n\n    try {\n      this.setLoadingState(check_in);\n      if (!this.isEventType('EDIT_BOOKING') && !this.isEventType('ADD_ROOM')) {\n        BookingGuestSchema.parse({ first_name: this.bookedByInfoData?.firstName, last_name: this.bookedByInfoData?.lastName });\n      }\n      this.isGuestDataIncomplete();\n      const isEditOrAdd = this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM');\n      if (isEditOrAdd) {\n        this.bookedByInfoData.message = this.defaultData.NOTES;\n      }\n      this.didReservation = true;\n      const serviceParams = await this.bookPropertyService.prepareBookUserServiceParams({\n        context: this,\n        check_in,\n      });\n      await this.bookingService.doReservation(serviceParams);\n      await this.adjustBlockedDatesAfterReservation(serviceParams);\n      this.resetBookingEvt.emit(null);\n      this.resetLoadingState();\n    } catch (error) {\n      console.error('Error booking user:', error);\n      this.isLoading = null;\n    }\n  }\n  private async adjustBlockedDatesAfterReservation(serviceParams: any) {\n    if (!this.wasBlockedUnit) {\n      return;\n    }\n    const original_from_date = moment(this.defaultData.block_exposed_unit_props.from_date, 'YYYY-MM-DD');\n    const current_from_date = moment(serviceParams.booking.from_date, 'YYYY-MM-DD');\n    const original_to_date = moment(this.defaultData.block_exposed_unit_props.to_date, 'YYYY-MM-DD');\n    const current_to_date = moment(serviceParams.booking.to_date, 'YYYY-MM-DD');\n    if (current_to_date.isBefore(original_to_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, from_date: current_to_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    if (current_from_date.isAfter(original_from_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, to_date: current_from_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    return;\n  }\n\n  private setLoadingState(assign_units: boolean) {\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      this.isLoading = 'save';\n    } else {\n      this.isLoading = assign_units ? 'bookAndCheckIn' : 'book';\n    }\n  }\n\n  private resetLoadingState() {\n    this.isLoading = '';\n    setTimeout(() => {\n      this.closeWindow();\n    }, 100);\n  }\n\n  private getCurrentPage(name: string) {\n    return this.page === name;\n  }\n\n  render() {\n    return (\n      <Host data-testid=\"book_property_sheet h-100\">\n        <div class=\"background-overlay\" onClick={() => this.closeWindow()}></div>\n        <div class={'sideWindow sheet-container ' + (this.getCurrentPage('page_block_date') ? 'block-date' : '')}>\n          {isRequestPending('/Get_Setup_Entries_By_TBL_NAME_MULTI') ? (\n            <div class={'loading-container'}>\n              <ir-spinner></ir-spinner>\n            </div>\n          ) : (\n            <Fragment>\n              <div class=\"sheet-header\">\n                <div class=\"card-header-container\">\n                  <h2 class=\"fd-book-property__title\">{this.getCurrentPage('page_block_date') ? this.defaultData.BLOCK_DATES_TITLE : this.defaultData.TITLE}</h2>\n                  {/* <ir-icon\n                    class={'px-2'}\n                    onIconClickHandler={() => {\n                      this.closeWindow();\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={20} width={20}>\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                      />\n                    </svg>\n                  </ir-icon> */}\n                  <ir-custom-button appearance=\"plain\" variant=\"neutral\" size=\"medium\" onClickHandler={() => this.closeWindow()}>\n                    <wa-icon name=\"xmark\" library=\"system\" variant=\"solid\" label=\"Close\" aria-label=\"Close\"></wa-icon>\n                  </ir-custom-button>\n                </div>\n              </div>\n              <div class=\"px-2 sheet-body\">\n                {this.getCurrentPage('page_one') && (\n                  <igl-booking-overview-page\n                    wasBlockedUnit={this.wasBlockedUnit}\n                    initialRoomIds={this.initialRoomIds}\n                    defaultDaterange={this.defaultDateRange}\n                    eventType={this.defaultData.event_type}\n                    selectedRooms={this.selectedUnits}\n                    currency={this.currency}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    ratePricingMode={this.ratePricingMode}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    bookedByInfoData={this.bookedByInfoData}\n                    adultChildConstraints={this.adultChildConstraints}\n                    propertyId={this.propertyid}\n                  ></igl-booking-overview-page>\n                )}\n\n                {this.getCurrentPage('page_two') && (\n                  <igl-booking-form\n                    currency={this.currency}\n                    propertyId={this.propertyid}\n                    showPaymentDetails={this.showPaymentDetails}\n                    selectedGuestData={this.guestData}\n                    countries={this.countries}\n                    isLoading={this.isLoading}\n                    selectedRooms={this.selectedUnits}\n                    bedPreferenceType={this.bedPreferenceType}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    language={this.language}\n                    bookedByInfoData={this.bookedByInfoData}\n                    defaultGuestData={this.defaultData}\n                    isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                    onDataUpdateEvent={event => this.handlePageTwoDataUpdateEvent(event)}\n                  ></igl-booking-form>\n                )}\n                {this.getCurrentPage('page_block_date') ? this.getPageBlockDatesView() : null}\n              </div>\n              {this.getCurrentPage('page_block_date') ? (\n                <div class=\"sheet-footer\">\n                  <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class=\"flex-fill\" onClick={() => this.closeWindow()}></ir-button>\n                  <ir-button\n                    text={locales.entries.Lcz_Blockdates}\n                    isLoading={isRequestPending('/Block_Exposed_Unit')}\n                    class=\"flex-fill\"\n                    onClick={() => this.handleBlockDate()}\n                  ></ir-button>\n                </div>\n              ) : (\n                <igl-book-property-footer\n                  page={this.page}\n                  dateRangeData={this.dateRangeData}\n                  isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                  isLoading={this.isLoading}\n                  class={'sheet-footer'}\n                  eventType={this.bookingData.event_type}\n                ></igl-book-property-footer>\n              )}\n            </Fragment>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  width: 100% !important;\n  background: #000;\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { TIcons } from '@/components/ui/ir-icons/icons';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\nimport { NativeButton } from '@/components/ui/ir-custom-button/ir-custom-button';\n\n@Component({\n  tag: 'igl-book-property-footer',\n  styleUrl: 'igl-book-property-footer.css',\n  scoped: true,\n})\nexport class IglBookPropertyFooter {\n  @Prop() eventType: string;\n  @Prop() page: string;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() isLoading: string;\n\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\n\n  private isEventType(event: string) {\n    return event === this.eventType;\n  }\n  private editNext(label) {\n    if (this.isEventType('EDIT_BOOKING')) {\n      if (label === 'Cancel') {\n        return 'flex-fill';\n      } else {\n        return 'd-none d-md-block  flex-fill';\n      }\n    }\n    return 'flex-fill';\n  }\n\n  private renderButton({\n    label,\n    type = 'button',\n    disabled = false,\n    // icon_name,\n    isLoading,\n    appearance,\n    variant,\n    value,\n    form,\n  }: // icon_position = 'right',\n  {\n    form?: string;\n    type?: 'submit' | 'button';\n    label: string;\n    disabled?: boolean;\n    icon_name?: TIcons;\n    isLoading?: boolean;\n    value: TPropertyButtonsTypes;\n    icon_position?: 'right' | 'left';\n    appearance: NativeButton['appearance'];\n    variant: NativeButton['variant'];\n  }) {\n    return (\n      <div class={this.shouldRenderTwoButtons() ? ` ${this.editNext(label)}` : 'flex-fill'}>\n        {/* <button class={`btn btn-${type === 'cancel' ? 'secondary' : 'primary'} full-width`} onClick={() => this.buttonClicked.emit({ key: type })} disabled={disabled}>\n          {label}\n        </button> */}\n        <ir-custom-button\n          type={type}\n          form={form}\n          size={'medium'}\n          loading={isLoading}\n          appearance={appearance}\n          variant={variant}\n          disabled={disabled}\n          onClickHandler={() => {\n            this.buttonClicked.emit({ key: value });\n          }}\n          class=\"full-width\"\n\n          // icon_name={icon_name}\n          // iconPosition={icon_position}\n          // style={{ '--icon-size': '1rem' }}\n          // icon_style={{ paddingBottom: '1.9px' }}\n        >\n          {label}\n        </ir-custom-button>\n      </div>\n    );\n  }\n\n  private shouldRenderTwoButtons() {\n    return this.isEventType('PLUS_BOOKING') || this.isEventType('ADD_ROOM') || this.isEventType('EDIT_BOOKING');\n  }\n\n  render() {\n    if (this.page === 'page_one') {\n      return (\n        <Host>\n          {/* <div class=\"d-flex justify-content-between gap-30 align-items-center full-width\"> */}\n          {this.isEventType('EDIT_BOOKING') ? (\n            <Fragment>\n              {this.renderButton({ value: 'cancel', label: locales.entries.Lcz_Cancel, appearance: 'filled', variant: 'neutral' })}\n              {this.shouldRenderTwoButtons() &&\n                this.renderButton({\n                  value: 'next',\n                  label: `${locales.entries.Lcz_Next}`,\n\n                  icon_name: 'angles_right',\n                  variant: 'brand',\n                  appearance: 'accent',\n                })}\n            </Fragment>\n          ) : (\n            <Fragment>\n              {this.renderButton({ value: 'cancel', label: locales.entries.Lcz_Cancel, appearance: 'filled', variant: 'neutral' })}\n              {this.shouldRenderTwoButtons() &&\n                this.renderButton({ value: 'next', label: `${locales.entries.Lcz_Next}`, icon_name: 'angles_right', variant: 'brand', appearance: 'accent' })}\n            </Fragment>\n          )}\n          {/* </div> */}\n        </Host>\n      );\n    }\n    const showBookAndCheckin = calendar_data.checkin_enabled && moment(new Date(this.dateRangeData?.fromDate)).isSame(new Date(), 'day');\n    return (\n      <Fragment>\n        {this.isEditOrAddRoomEvent ? (\n          <Fragment>\n            {this.renderButton({ value: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left', appearance: 'filled', variant: 'neutral' })}\n            {this.renderButton({ value: 'save', label: locales.entries.Lcz_Save, isLoading: this.isLoading === 'save', variant: 'brand', appearance: 'accent' })}\n          </Fragment>\n        ) : (\n          <Fragment>\n            {this.renderButton({ value: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left', appearance: 'filled', variant: 'neutral' })}\n            {this.renderButton({\n              value: 'book',\n              type: 'submit',\n              form: 'new_booking_form',\n              label: locales.entries.Lcz_Book,\n              isLoading: this.isLoading === 'book',\n              variant: 'brand',\n              appearance: showBookAndCheckin ? 'outlined' : 'accent',\n            })}\n            {showBookAndCheckin &&\n              this.renderButton({\n                type: 'submit',\n                form: 'new_booking_form',\n                value: 'bookAndCheckIn',\n                label: locales.entries.Lcz_BookAndChekcIn,\n                isLoading: this.isLoading === 'bookAndCheckIn',\n                variant: 'brand',\n                appearance: 'accent',\n              })}\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  text-align: start;\n  gap: 1rem;\n}\n\n.sourceContainer {\n  max-width: 350px;\n}\n.message-label {\n  font-size: 80%;\n}\n.fd-book-property__constraints-container,\n.fd-book-property__header-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n/*md*/\n@media (min-width: 768px) {\n  .fd-book-property__constraints-container,\n  .fd-book-property__header-container {\n    flex-direction: row;\n    align-items: center;\n  }\n  .fd-book-property__adults-select {\n    width: 100px;\n  }\n  .fd-book-property__children-select {\n    width: 170px;\n  }\n}\n\n/*lg*/\n@media (min-width: 1024px) {\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { Component, Host, Prop, h, Event, EventEmitter, State, Fragment } from '@stencil/core';\nimport { TAdultChildConstraints, TPropertyButtonsTypes } from '../../../../models/igl-book-property';\n\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport booking_store, { setBookingDraft } from '@/stores/booking.store';\n\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { Booking } from '@/models/booking.dto';\nimport { z } from 'zod';\n\n@Component({\n  tag: 'igl-book-property-header',\n  styleUrl: 'igl-book-property-header.css',\n  scoped: true,\n})\nexport class IglBookPropertyHeader {\n  @Prop() splitBookingId: any = '';\n  @Prop() bookingData: any = '';\n  @Prop() minDate: string;\n  @Prop() message: string;\n  @Prop() bookingDataDefaultDateRange: { [key: string]: any };\n  @Prop() showSplitBookingOption: boolean = false;\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n  @Prop() splitBookings: any[];\n  @Prop() dateRangeData: any;\n  @Prop() bookedByInfoData: any;\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\n  @Prop() propertyId: number;\n  @Prop() wasBlockedUnit: boolean;\n\n  @State() isLoading: boolean;\n  @State() bookings: Booking[] = [];\n\n  @Event() splitBookingDropDownChange: EventEmitter<any>;\n  @Event() checkClicked: EventEmitter<any>;\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\n  @Event() toast: EventEmitter<IToast>;\n  @Event() spiltBookingSelected: EventEmitter<{ key: string; data: unknown }>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n  @State() autoValidate: boolean;\n\n  private bookingService = new BookingService();\n  adultAnimationContainer: any;\n\n  private async fetchExposedBookings(value: string) {\n    this.isLoading = true;\n    this.bookings = await this.bookingService.fetchExposedBookings(\n      value,\n      this.propertyId,\n      moment(this.bookingDataDefaultDateRange.fromDate).format('YYYY-MM-DD'),\n      moment(this.bookingDataDefaultDateRange.toDate).format('YYYY-MM-DD'),\n    );\n    this.isLoading = false;\n  }\n\n  private getSplitBookingList() {\n    return (\n      <ir-picker\n        mode=\"select-async\"\n        class=\"sourceContainer\"\n        debounce={300}\n        onText-change={e => {\n          this.fetchExposedBookings(e.detail);\n        }}\n        defaultValue={Object.keys(this.bookedByInfoData).length > 1 ? this.bookedByInfoData.bookingNumber?.toString() : ''}\n        value={Object.keys(this.bookedByInfoData).length > 1 ? this.bookedByInfoData.bookingNumber?.toString() : ''}\n        label={`${locales.entries.Lcz_Tobooking}#`}\n        placeholder={locales.entries.Lcz_BookingNumber}\n        loading={this.isLoading}\n        onCombobox-select={e => {\n          const booking = this.bookings?.find(b => b.booking_nbr?.toString() === e.detail.item.value);\n          this.spiltBookingSelected.emit({ key: 'select', data: booking });\n        }}\n      >\n        {this.bookings?.map(b => {\n          const label = `${b.booking_nbr} ${b.guest.first_name} ${b.guest.last_name}`;\n          return (\n            <ir-picker-item value={b.booking_nbr?.toString()} label={label}>\n              {label}\n            </ir-picker-item>\n          );\n        })}\n      </ir-picker>\n    );\n  }\n  private getSourceNode() {\n    const { sources } = booking_store.selects;\n    return (\n      <wa-select\n        size=\"small\"\n        placeholder={locales.entries.Lcz_Source}\n        value={booking_store.bookingDraft.source?.id?.toString()}\n        defaultValue={booking_store.bookingDraft.source?.id}\n        id=\"xSmallSelect\"\n        onwa-hide={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n        }}\n        onchange={evt => {\n          setBookingDraft({ source: sources.find(s => s.id === (evt.target as HTMLSelectElement).value) });\n        }}\n      >\n        {sources.map(option => {\n          if (option.type === 'LABEL') {\n            return <small>{option.description}</small>;\n          }\n          return <wa-option value={option.id?.toString()}>{option.description}</wa-option>;\n        })}\n      </wa-select>\n    );\n  }\n\n  private getAdultChildConstraints() {\n    const { adults, children } = booking_store.bookingDraft.occupancy;\n    return (\n      <Fragment>\n        {/* <wa-animation iterations={2} name=\"bounce\" easing=\"ease-in-out\" duration={2000} ref={el => (this.adultAnimationContainer = el)}> */}\n        <ir-validator value={adults} schema={z.number().min(1)} autovalidate={this.autoValidate}>\n          <wa-select\n            class=\"fd-book-property__adults-select\"\n            onwa-hide={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n            }}\n            onchange={e => {\n              setBookingDraft({\n                occupancy: {\n                  children,\n                  adults: Number((e.target as HTMLSelectElement).value),\n                },\n              });\n            }}\n            value={adults?.toString()}\n            defaultValue={adults?.toString()}\n            placeholder={locales.entries.Lcz_AdultsCaption}\n            size=\"small\"\n          >\n            {Array.from(Array(this.adultChildConstraints.adult_max_nbr), (_, i) => i + 1).map(option => (\n              <wa-option value={option?.toString()}>{option}</wa-option>\n            ))}\n          </wa-select>\n        </ir-validator>\n        {/* </wa-animation> */}\n        {this.adultChildConstraints.child_max_nbr > 0 && (\n          <wa-select\n            class=\"fd-book-property__children-select\"\n            onwa-hide={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n            }}\n            onchange={e =>\n              setBookingDraft({\n                occupancy: {\n                  adults,\n                  children: Number((e.target as HTMLSelectElement).value),\n                },\n              })\n            }\n            defaultValue={children?.toString()}\n            value={children?.toString()}\n            placeholder={this.renderChildCaption()}\n            size=\"small\"\n          >\n            {Array.from(Array(this.adultChildConstraints.child_max_nbr), (_, i) => i + 1).map(option => (\n              <wa-option value={option?.toString()}>{option}</wa-option>\n            ))}\n          </wa-select>\n        )}\n      </Fragment>\n    );\n  }\n\n  private renderChildCaption() {\n    const maxAge = this.adultChildConstraints.child_max_age;\n    let years = locales.entries.Lcz_Years;\n\n    if (maxAge === 1) {\n      years = locales.entries.Lcz_Year;\n    }\n    return `${locales.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${years}`;\n  }\n\n  private handleButtonClicked() {\n    const { occupancy } = booking_store.bookingDraft;\n\n    if (this.isEventType('SPLIT_BOOKING') && Object.keys(this.bookedByInfoData).length <= 1) {\n      this.toast.emit({\n        type: 'error',\n        title: locales.entries.Lcz_ChooseBookingNumber,\n        description: '',\n        position: 'top-right',\n      });\n    } else if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n      const initialToDate = moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date));\n      const initialFromDate = moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date));\n      const selectedFromDate = moment(new Date(this.dateRangeData.fromDate));\n      const selectedToDate = moment(new Date(this.dateRangeData.toDate));\n      if (selectedToDate.isBefore(initialFromDate) || selectedFromDate.isAfter(initialToDate)) {\n        this.toast.emit({\n          type: 'error',\n          title: `${locales.entries.Lcz_CheckInDateShouldBeMAx.replace(\n            '%1',\n            moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date)).format('ddd, DD MMM YYYY'),\n          ).replace('%2', moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date)).format('ddd, DD MMM YYYY'))}  `,\n          description: '',\n          position: 'top-right',\n        });\n        return;\n      } else if (Number(occupancy.adults) === 0) {\n        this.toast.emit({ type: 'error', title: locales.entries.Lcz_PlzSelectNumberOfGuests, description: '', position: 'top-right' });\n        // this.adultAnimationContainer.play = true;\n        this.autoValidate = true;\n      } else {\n        this.buttonClicked.emit({ key: 'check' });\n      }\n    }\n    // else if (this.minDate && new Date(this.dateRangeData.fromDate).getTime() > new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date).getTime()) {\n    //   this.toast.emit({\n    //     type: 'error',\n    //     title: `${locales.entries.Lcz_CheckInDateShouldBeMAx.replace(\n    //       '%1',\n    //       moment(new Date(this.bookedByInfoData.from_date || this.defaultDaterange.from_date)).format('ddd, DD MMM YYYY'),\n    //     ).replace('%2', moment(new Date(this.bookedByInfoData.to_date || this.defaultDaterange.to_date)).format('ddd, DD MMM YYYY'))}  `,\n    //     description: '',\n    //     position: 'top-right',\n    //   });\n    // }\n    else if (Number(occupancy.adults) === 0) {\n      // this.adultAnimationContainer.play = true;\n      this.autoValidate = true;\n      this.toast.emit({ type: 'error', title: locales.entries.Lcz_PlzSelectNumberOfGuests, description: '', position: 'top-right' });\n    } else {\n      this.buttonClicked.emit({ key: 'check' });\n    }\n  }\n\n  private isEventType(key: string) {\n    return this.bookingData.event_type === key;\n  }\n  private getMinDate() {\n    if (this.isEventType('PLUS_BOOKING')) {\n      return moment().add(-1, 'months').startOf('month').format('YYYY-MM-DD');\n    }\n    if (this.wasBlockedUnit) {\n      return this.bookingData?.block_exposed_unit_props.from_date;\n    }\n    return this.minDate;\n  }\n  private getMaxDate() {\n    if (!this.bookingData?.block_exposed_unit_props) {\n      if (this.isEventType('PLUS_BOOKING')) {\n        return moment().add(60, 'days').format('YYYY-MM-DD');\n      }\n      return undefined;\n    }\n    return this.bookingData?.block_exposed_unit_props.to_date;\n  }\n\n  render() {\n    console.log(this.bookingData.event_type);\n    const showSourceNode = this.showSplitBookingOption ? this.getSplitBookingList() : this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM') ? false : true;\n    return (\n      <Host>\n        {this.isEventType('SPLIT_BOOKING') && this.getSplitBookingList()}\n        <div class={`fd-book-property__header-container`}>\n          {showSourceNode && this.getSourceNode()}\n          <igl-date-range\n            data-testid=\"date_picker\"\n            variant=\"booking\"\n            dateLabel={locales.entries.Lcz_Dates}\n            maxDate={this.getMaxDate()}\n            minDate={this.getMinDate()}\n            disabled={(this.isEventType('BAR_BOOKING') && !this.wasBlockedUnit) || this.isEventType('SPLIT_BOOKING')}\n            defaultData={this.bookingDataDefaultDateRange}\n          ></igl-date-range>\n\n          {/* <ir-range-picker\n            onDateRangeChanged={e => {\n              // e.stopImmediatePropagation();\n              // e.stopPropagation();\n              // const { fromDate, toDate } = e.detail;\n              // let to_date = toDate.format('YYYY-MM-DD');\n              // if (\n              //   toDate.isSame(moment(booking_listing.userSelection.to, 'YYYY-MM-DD'), 'days') ||\n              //   toDate.isBefore(moment(booking_listing.userSelection.from, 'YYYY-MM-DD'), 'days')\n              // ) {\n              //   to_date = booking_listing.userSelection.to;\n              // }\n              // booking_listing.userSelection = { ...booking_listing.userSelection, to: to_date, from: fromDate.format('YYYY-MM-DD') };\n            }}\n            allowNullDates={false}\n            // fromDate={moment(booking_listing.userSelection.from, 'YYYY-MM-DD')}\n            // toDate={moment(booking_listing.userSelection.to, 'YYYY-MM-DD')}\n            fromDate={moment()}\n            toDate={moment()}\n          /> */}\n          {!this.isEventType('EDIT_BOOKING') && this.getAdultChildConstraints()}\n          <ir-custom-button loading={isRequestPending('/Check_Availability')} variant=\"brand\" onClickHandler={() => this.handleButtonClicked()}>\n            {locales.entries.Lcz_Check}\n          </ir-custom-button>\n        </div>\n        <p class=\"text-right message-label\">{calendar_data.tax_statement}</p>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n}\n","import { Component, Prop, h, Event, EventEmitter, State } from '@stencil/core';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyPayloadEditBooking, TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport { formatAmount } from '@/utils/utils';\nimport locales from '@/stores/locales.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { ICountry } from '@/models/IBooking';\n@Component({\n  tag: 'igl-booking-form',\n  styleUrl: 'igl-booking-form.css',\n  scoped: true,\n})\nexport class IglBookingForm {\n  @Prop() showPaymentDetails: boolean;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() bookingData: { [key: string]: any };\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() language: string;\n  @Prop() bookedByInfoData: { [key: string]: any };\n  @Prop() propertyId: number;\n  @Prop() bedPreferenceType: any;\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop({ reflect: true }) isLoading: string;\n  @Prop() countries: ICountry[];\n  @Prop() selectedGuestData;\n  @Prop() defaultGuestData: IglBookPropertyPayloadEditBooking;\n\n  @State() selectedBookedByData;\n  @State() guestData: any;\n  @State() selectedUnits: { [key: string]: any } = {};\n\n  @Event() dataUpdateEvent: EventEmitter<IPageTwoDataUpdateProps>;\n  @Event() buttonClicked: EventEmitter<{\n    key: TPropertyButtonsTypes;\n    data?: CustomEvent;\n  }>;\n\n  componentWillLoad() {\n    this.initializeGuestData();\n    this.selectedBookedByData = this.bookedByInfoData;\n  }\n\n  initializeGuestData() {\n    let total = 0;\n    const newSelectedUnits = { ...this.selectedUnits };\n    const getRate = (rate: number, totalNights: number, isRateModified: boolean, preference: number) => {\n      if (isRateModified && preference === 2) {\n        return rate * totalNights;\n      }\n      return rate;\n    };\n    this.selectedUnits = newSelectedUnits;\n    this.guestData = [];\n    this.selectedRooms.forEach((room, key) => {\n      room.forEach(rate_plan => {\n        newSelectedUnits[key] = rate_plan.selectedUnits;\n        total += rate_plan.totalRooms * getRate(rate_plan.rate, this.dateRangeData.dateDifference, rate_plan.isRateModified, rate_plan.rateType);\n        for (let i = 1; i <= rate_plan.totalRooms; i++) {\n          this.guestData.push({\n            guestName: '',\n            roomId: '',\n            preference: '',\n            ...rate_plan,\n          });\n        }\n      });\n    });\n    this.bookingData.TOTAL_PRICE = total;\n  }\n  handleOnApplicationInfoDataUpdateEvent(event: CustomEvent, index: number) {\n    const opt = event.detail;\n    const categoryIdKey = `c_${opt.data.roomCategoryId}`;\n    const updatedUnits = [...(this.selectedUnits[categoryIdKey] || [])];\n    updatedUnits[index] = opt.data.roomId;\n    this.selectedUnits = {\n      ...this.selectedUnits,\n      [categoryIdKey]: updatedUnits,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'applicationInfoUpdateEvent',\n      value: event.detail,\n    });\n  }\n\n  handleEventData(event: any, key: string, index: number) {\n    if (key === 'application-info') {\n      this.handleOnApplicationInfoDataUpdateEvent(event, index);\n    } else {\n      this.selectedBookedByData = event.detail.data;\n      this.dataUpdateEvent.emit({\n        key: 'propertyBookedBy',\n        value: event.detail,\n      });\n    }\n  }\n  isGuestDataIncomplete() {\n    if (this.selectedGuestData.length !== this.guestData.length) {\n      return true;\n    }\n    for (const data of this.selectedGuestData) {\n      if (data.guestName === '' || data.preference === '' || data.roomId === '') {\n        return true;\n      }\n    }\n    return false;\n  }\n  isButtonDisabled(key: string) {\n    const isValidProperty = (property, key, comparedBy) => {\n      if (!property) {\n        return true;\n      }\n      if (property === this.selectedGuestData) {\n        return this.isGuestDataIncomplete();\n      }\n      if (key === 'selectedArrivalTime') {\n        if (property[key] !== undefined) {\n          return property[key].code === '';\n        } else {\n          return true;\n        }\n      }\n      return property[key] === comparedBy || property[key] === undefined;\n    };\n    return (\n      this.isLoading === key ||\n      isValidProperty(this.selectedGuestData, 'guestName', '') ||\n      isValidProperty(this.selectedBookedByData, 'isdCode', '') ||\n      isValidProperty(this.selectedBookedByData, 'contactNumber', '') ||\n      isValidProperty(this.selectedBookedByData, 'firstName', '') ||\n      isValidProperty(this.selectedBookedByData, 'lastName', '') ||\n      isValidProperty(this.selectedBookedByData, 'countryId', -1) ||\n      isValidProperty(this.selectedBookedByData, 'selectedArrivalTime', '') ||\n      isValidProperty(this.selectedBookedByData, 'email', '')\n    );\n  }\n\n  render() {\n    return (\n      <form\n        class=\"d-flex flex-column h-100\"\n        id=\"new_booking_form\"\n        autoComplete=\"off\"\n        onSubmit={e => {\n          e.preventDefault();\n        }}\n      >\n        <div class=\"d-flex flex-wrap\">\n          <ir-date-view\n            class=\"mr-1 flex-fill font-weight-bold font-medium-1\"\n            from_date={new Date(this.dateRangeData.fromDate)}\n            to_date={new Date(this.dateRangeData.toDate)}\n            dateOption=\"DD MMM YYYY\"\n          ></ir-date-view>\n          {this.guestData.length > 1 && (\n            <div class=\"mt-1 mt-md-0 text-right\">\n              {locales.entries.Lcz_TotalPrice} <span class=\"font-weight-bold font-medium-1\">{formatAmount(this.currency.symbol, this.bookingData.TOTAL_PRICE || '0')}</span>\n            </div>\n          )}\n        </div>\n        {Object.values(booking_store.ratePlanSelections).map(val =>\n          Object.values(val).map(ratePlan => {\n            const rp = ratePlan as IRatePlanSelection;\n            if (rp.reserved === 0) {\n              return null;\n            }\n\n            return [...new Array(rp.reserved)].map((_, i) => (\n              <igl-application-info\n                totalNights={Number(this.dateRangeData.dateDifference)}\n                bedPreferenceType={this.bedPreferenceType}\n                currency={this.currency}\n                guestInfo={rp.guest ? rp.guest[i] : null}\n                bookingType={this.bookingData.event_type}\n                rateplanSelection={rp}\n                key={`${rp.ratePlan.id}_${i}`}\n                roomIndex={i}\n                baseData={\n                  this.bookingData.event_type === 'EDIT_BOOKING'\n                    ? {\n                        roomtypeId: this.bookingData.currentRoomType.roomtype.id,\n                        unit: this.bookingData.currentRoomType.unit,\n                      }\n                    : undefined\n                }\n              ></igl-application-info>\n            ));\n          }),\n        )}\n\n        {this.isEditOrAddRoomEvent || this.showSplitBookingOption ? null : (\n          <igl-property-booked-by\n            propertyId={this.propertyId}\n            countries={this.countries}\n            language={this.language}\n            showPaymentDetails={this.showPaymentDetails}\n            defaultData={this.bookedByInfoData}\n            onDataUpdateEvent={event => {\n              this.handleEventData(event, 'propertyBookedBy', 0);\n            }}\n          ></igl-property-booked-by>\n        )}\n      </form>\n    );\n  }\n}\n",":host {\r\n  display: block;\r\n}\r\n:host > * {\r\n  margin: 0;\r\n  padding: auto;\r\n}\r\n.scrollContent {\r\n  height: calc(100% - 79px);\r\n  overflow: auto;\r\n  position: relative;\r\n}\r\n.loading-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  background: white;\r\n  position: absolute;\r\n  inset: 0;\r\n  z-index: 100;\r\n}\r\n.loader {\r\n  width: 1.25rem;\r\n  height: 1.25rem;\r\n  border: 2.5px solid #3f3f3f;\r\n  border-bottom-color: transparent;\r\n  border-radius: 50%;\r\n  display: inline-block;\r\n  box-sizing: border-box;\r\n  animation: rotation 1s linear infinite;\r\n}\r\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TAdultChildConstraints } from '../../../../models/igl-book-property';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport moment from 'moment';\nimport booking_store from '@/stores/booking.store';\n@Component({\n  tag: 'igl-booking-overview-page',\n  styleUrl: 'igl-booking-overview-page.css',\n  scoped: true,\n})\nexport class IglBookingOverviewPage {\n  @Prop() bookingData: any;\n  @Prop() propertyId: number;\n  @Prop() message: string;\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() eventType: string;\n  @Prop() currency: any;\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n  @Prop() ratePricingMode: any;\n  @Prop() dateRangeData: any;\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop() bookedByInfoData: any;\n  @Prop() initialRoomIds: any;\n  @Prop() wasBlockedUnit: boolean;\n\n  @Event() roomsDataUpdate: EventEmitter;\n\n  getSplitBookings() {\n    return (this.bookingData.hasOwnProperty('splitBookingEvents') && this.bookingData.splitBookingEvents) || [];\n  }\n  isEventType(event: string) {\n    return event === this.eventType;\n  }\n  setMinDate() {\n    if (!this.isEventType('EDIT_BOOKING')) {\n      return moment().format('YYYY-MM-DD');\n    }\n    const from_date = moment(this.bookingData.FROM_DATE, 'YYYY-MM-DD');\n    const today = moment();\n    if (from_date.isAfter(today)) {\n      return today.add(-2, 'weeks').format('YYYY-MM-DD');\n    }\n    return from_date.add(-2, 'weeks').format('YYYY-MM-DD');\n  }\n  render() {\n    return (\n      <Host>\n        <igl-book-property-header\n          wasBlockedUnit={this.wasBlockedUnit}\n          bookedByInfoData={this.bookedByInfoData}\n          defaultDaterange={this.defaultDaterange}\n          dateRangeData={this.dateRangeData}\n          minDate={this.setMinDate()}\n          // minDate={this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING') ? this.bookedByInfoData.from_date || this.bookingData.FROM_DATE : undefined}\n          splitBookingId={this.showSplitBookingOption}\n          bookingData={this.bookingData}\n          message={this.message}\n          bookingDataDefaultDateRange={this.bookingData.defaultDateRange}\n          showSplitBookingOption={this.showSplitBookingOption}\n          adultChildConstraints={this.adultChildConstraints}\n          splitBookings={this.getSplitBookings()}\n          propertyId={this.propertyId}\n        ></igl-book-property-header>\n        {/* {this.adultChildCount.adult === 0 && <p class={'col text-left'}>Please select the number of guests</p>} */}\n        <div class=\" text-left\">\n          {isRequestPending('/Check_Availability') && this.isEventType('EDIT_BOOKING') ? (\n            <div class=\"loading-container\">\n              <div class=\"loader\"></div>\n            </div>\n          ) : (\n            <Fragment>\n              {booking_store.roomTypes?.map(roomType => (\n                <igl-room-type\n                  // initialRoomIds={this.initialRoomIds}\n                  isBookDisabled={Object.keys(this.bookedByInfoData).length <= 1}\n                  key={`room-type-${roomType.id}`}\n                  currency={this.currency}\n                  ratePricingMode={this.ratePricingMode}\n                  // dateDifference={this.dateRangeData.dateDifference}\n                  bookingType={this.bookingData.event_type}\n                  roomType={roomType}\n                  class=\"mt-2 mb-1 p-0\"\n                  data-testid={`room_type_${roomType.id}`}\n                  id={roomType.id.toString()}\n                  roomTypeId={this.selectedRooms.has(`c_${roomType.id}`) ? roomType.id : null}\n                  // onDataUpdateEvent={evt => this.roomsDataUpdate.emit(evt.detail)}\n                ></igl-room-type>\n              ))}\n            </Fragment>\n          )}\n        </div>\n\n        {/* <igl-book-property-footer class={'p-0 mb-1 mt-3'} eventType={this.bookingData.event_type}></igl-book-property-footer> */}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.bookedByEmailContainer {\n  flex: auto;\n  max-width: 350px;\n}\n\n.bookedDetailsForm label {\n  min-width: 125px;\n  max-width: 125px;\n}\n.row.sc-igl-booking-form {\n  padding: 0 !important;\n}\n.bookedDetailsForm .form-group {\n  margin-bottom: 10px !important;\n}\n\n.bookedDetailsForm .checkBoxContainer input {\n  height: 1.2rem !important;\n  width: 30px;\n}\n\n.property-booked-by__money-transfer-description * {\n  margin: 0 !important;\n  margin-bottom: 0 !important;\n  margin-top: 0 !important;\n}\n/* reset wrapper itself + all descendants */\n.property-booked-by__money-transfer-description,\n.property-booked-by__money-transfer-description :where(*, *::before, *::after) {\n  margin: 0.5rem !important;\n}\n/* .controlContainer1 .textarea-container {\n  border: 1px solid #ced4da; \n  border-radius: 0.25rem; \n  height: 60px; \n  width: 100%;\n} */\n.controlContainer textarea {\n  height: 60px !important;\n}\n.margin3 {\n  margin-bottom: 5px !important;\n}\n@media (min-width: 768px) {\n  .bookedByEmailContainer {\n    margin-left: 37px;\n  }\n}\n.fd-property-booked-by__guest-form {\n  display: grid;\n  padding: 0;\n  box-sizing: border-box;\n  gap: 0.5rem;\n  width: 100%;\n  flex: 1 1 0%;\n}\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Fragment, Listen } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { IEntries, ICountry } from '@/models/IBooking';\nimport { v4 } from 'uuid';\nimport locales from '@/stores/locales.store';\nimport { TPropertyButtonsTypes } from '@/components';\nimport { z } from 'zod';\nimport { validateEmail } from '@/utils/utils';\nimport booking_store, { BookingStore, modifyBookingStore, setBookedByGuestManualEditState } from '@/stores/booking.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { AllowedPaymentMethod } from '@/models/booking.dto';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { ExposedGuests } from '@/services/booking-service/types';\nimport IMask from 'imask';\nimport { BookingGuestSchema } from '../../types';\n\n@Component({\n  tag: 'igl-property-booked-by',\n  styleUrl: 'igl-property-booked-by.css',\n  scoped: true,\n})\nexport class IglPropertyBookedBy {\n  @Prop() language: string;\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() defaultData: { [key: string]: any };\n  @Prop() countries: ICountry[] = [];\n  @Prop() propertyId: number;\n\n  @State() isButtonPressed: boolean = false;\n  @State() bookedByData: { [key: string]: any } = {\n    id: undefined,\n    email: '',\n    firstName: '',\n    lastName: '',\n    countryId: '',\n    isdCode: '',\n    contactNumber: '',\n    selectedArrivalTime: '',\n    emailGuest: false,\n    message: '',\n    cardNumber: '',\n    cardHolderName: '',\n    expiryMonth: '',\n    expiryYear: '',\n  };\n  @State() guests: ExposedGuests;\n  @State() typedEmail: string;\n\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\n\n  private bookingService: BookingService = new BookingService();\n  private arrivalTimeList: IEntries[] = [];\n  private currentMonth: string = '01';\n  private country;\n  private paymentMethods: AllowedPaymentMethod[] = [];\n  private pickerRef: HTMLIrPickerElement;\n\n  componentWillLoad() {\n    this.assignCountryCode();\n    this.initializeDateData();\n    this.populateBookedByData();\n    this.paymentMethods = calendar_data.property.allowed_payment_methods.filter(p => p.is_active && !p.is_payment_gateway);\n    if (this.paymentMethods.length > 0) {\n      modifyBookingStore('selectedPaymentMethod', { code: this.paymentMethods[0].code });\n    }\n  }\n\n  @Listen('buttonClicked', { target: 'body' })\n  handleButtonClicked(\n    event: CustomEvent<{\n      key: TPropertyButtonsTypes;\n      data?: CustomEvent;\n    }>,\n  ) {\n    switch (event.detail.key) {\n      case 'book':\n      case 'bookAndCheckIn':\n        this.isButtonPressed = true;\n        break;\n    }\n  }\n  private async assignCountryCode() {\n    const country = await this.bookingService.getUserDefaultCountry();\n    const countryId = country['COUNTRY_ID'];\n    this.country = countryId;\n    const _c = this.countries.find(c => c.id?.toString() === countryId?.toString());\n    this.bookedByData = { ...this.bookedByData, isdCode: _c.phone_prefix.toString(), countryId };\n  }\n  private initializeDateData() {\n    const dt = new Date();\n    const month = dt.getMonth() + 1;\n    this.currentMonth = month < 10 ? `0${month}` : month.toString();\n  }\n\n  private populateBookedByData() {\n    this.bookedByData = this.defaultData ? { ...this.bookedByData, ...this.defaultData } : {};\n    this.arrivalTimeList = this.defaultData?.arrivalTime || [];\n    this.bookedByData = { ...this.bookedByData, selectedArrivalTime: this.arrivalTimeList[0].CODE_NAME };\n    if (!this.bookedByData.expiryMonth) {\n      this.bookedByData.expiryMonth = this.currentMonth;\n    }\n    if (!this.bookedByData.expiryYear) {\n      this.bookedByData.expiryYear = new Date().getFullYear();\n    }\n  }\n\n  private handleDataChange(key, event) {\n    this.bookedByData = { ...this.bookedByData, [key]: key === 'emailGuest' ? event.target.checked : event.target.value };\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n    if (key === 'firstName' || key === 'lastName') {\n      setBookedByGuestManualEditState(true);\n    }\n    if (key === 'countryId') {\n      this.bookedByData = {\n        ...this.bookedByData,\n        isdCode: event.target.value,\n      };\n    }\n    // console.log(this.bookedByData);\n  }\n  private handleCreditCardDataChange(key, value: string) {\n    this.bookedByData[key] = value;\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n    if (key === 'countryId') {\n      this.bookedByData = {\n        ...this.bookedByData,\n        isdCode: value,\n      };\n    }\n    // console.log(this.bookedByData);\n  }\n  private handleCountryChange(value) {\n    this.bookedByData = {\n      ...this.bookedByData,\n      isdCode: value,\n      countryId: value,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n  }\n\n  private updateGuest(props: Partial<BookingStore['checkout_guest']>) {\n    modifyBookingStore('checkout_guest', { ...(booking_store.checkout_guest ?? {}), ...props });\n  }\n\n  private handleComboboxSelect(e: CustomEvent) {\n    const guest = this.guests?.find(guest => guest.id?.toString() === e.detail.item.value);\n    if (!guest) {\n      console.warn(`guest not found with id ${e.detail.item.value}`);\n      return;\n    }\n    this.bookedByData.email = guest.email;\n    this.bookedByData = {\n      ...this.bookedByData,\n      id: guest.id,\n      firstName: guest.first_name,\n      lastName: guest.last_name,\n      contactNumber: guest.mobile_without_prefix,\n      countryId: guest.country_id,\n      isdCode: guest['country_phone_prefix'] ?? guest?.country_id,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: this.bookedByData,\n    });\n  }\n\n  private clearEvent() {\n    this.bookedByData = {\n      ...this.bookedByData,\n      id: '',\n      firstName: '',\n      lastName: '',\n      contactNumber: '',\n      email: '',\n      isdCode: this.country.toString(),\n      countryId: this.country,\n    };\n    setBookedByGuestManualEditState(false);\n    this.dataUpdateEvent.emit({\n      key: 'bookedByInfoUpdated',\n      data: { ...this.bookedByData },\n    });\n  }\n\n  private async fetchGuests(email: string) {\n    this.typedEmail = email;\n    this.guests = await this.bookingService.fetchExposedGuest(email, this.propertyId);\n  }\n  private get expiryDate(): string {\n    const { expiryMonth, expiryYear } = this.bookedByData;\n\n    if (!expiryMonth || !expiryYear) {\n      return '';\n    }\n\n    // Normalize year to YY\n    const year = expiryYear.toString().length === 4 ? expiryYear.toString().slice(-2) : expiryYear.toString();\n\n    return `${expiryMonth}/${year}`;\n  }\n  render() {\n    return (\n      <Host>\n        <div class=\"text-left mt-3\">\n          <div class=\"d-flex\" style={{ alignItems: 'flex-end', gap: '0.5rem' }}>\n            <ir-picker\n              class=\"bookedByEmailContainer m-0 p-0\"\n              label={locales.entries.Lcz_BookedBy}\n              value={this.bookedByData.email}\n              ref={el => (this.pickerRef = el)}\n              aria-invalid={String(Boolean(this.isButtonPressed && this.bookedByData.email !== '' && validateEmail(this.bookedByData.email)))}\n              withClear\n              onText-change={event => this.fetchGuests(event.detail)}\n              debounce={300}\n              onInput-picker-blurred={e => {\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                const email = this.typedEmail;\n                if (this.bookedByData.email) {\n                  return;\n                }\n                if (this.guests.length === 0) {\n                  if (z.string().email().safeParse(email).success) {\n                    this.bookedByData = {\n                      ...this.bookedByData,\n                      email,\n                    };\n                  } else {\n                    this.clearEvent();\n                    this.pickerRef.clearInput();\n                  }\n                }\n              }}\n              onCombobox-clear={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.clearEvent();\n              }}\n              loading={isRequestPending('/Fetch_Exposed_Guests')}\n              placeholder={locales.entries.Lcz_FindEmailAddress}\n              mode=\"select-async\"\n              onCombobox-select={this.handleComboboxSelect.bind(this)}\n            >\n              {this.guests?.map(guest => {\n                const label = `${guest.email} - ${guest.first_name} ${guest.last_name}`;\n                return (\n                  <ir-picker-item label={label} value={guest.id?.toString()} key={guest.id}>\n                    {label}\n                  </ir-picker-item>\n                );\n              })}\n            </ir-picker>\n            <div style={{ paddingBottom: '0.5rem' }}>\n              <wa-tooltip for={`main_guest-search-tooltip`}>Leave empty if email is unavailable</wa-tooltip>\n              <wa-icon name=\"circle-info\" id={`main_guest-search-tooltip`}></wa-icon>\n            </div>\n          </div>\n        </div>\n        <div class=\"bookedDetailsForm text-left mt-2 font-small-3 \">\n          <div class=\"d-flex flex-column flex-md-row  justify-content-md-between \" style={{ gap: '1rem' }}>\n            <div class=\"fd-property-booked-by__guest-form \">\n              <ir-validator value={this.bookedByData.firstName} schema={BookingGuestSchema.shape.first_name}>\n                <ir-input\n                  // aria-invalid={String(Boolean(this.isButtonPressed && this.bookedByData.firstName === ''))}\n                  onText-change={event => {\n                    this.updateGuest({ first_name: event.detail });\n                    this.handleDataChange('firstName', { target: { value: event.detail.trim() } });\n                  }}\n                  defaultValue={this.bookedByData.firstName}\n                  value={this.bookedByData.firstName}\n                  label={locales.entries.Lcz_FirstName}\n                  placeholder={locales.entries.Lcz_FirstName}\n                  required\n                  name=\"last_name_custom\"\n                  autocomplete=\"family-name\"\n                ></ir-input>\n              </ir-validator>\n              <ir-validator value={this.bookedByData.lastName} schema={BookingGuestSchema.shape.last_name}>\n                <ir-input\n                  // aria-invalid={String(Boolean(this.isButtonPressed && this.bookedByData.lastName === ''))}\n                  onText-change={event => {\n                    this.updateGuest({ last_name: event.detail });\n                    this.handleDataChange('lastName', { target: { value: event.detail.trim() } });\n                  }}\n                  name=\"first_name_custom\"\n                  autocomplete=\"given-name\"\n                  defaultValue={this.bookedByData.lastName}\n                  value={this.bookedByData.lastName}\n                  label={locales.entries.Lcz_LastName}\n                  placeholder={locales.entries.Lcz_LastName}\n                  required\n                ></ir-input>\n              </ir-validator>\n              <ir-country-picker\n                label={locales.entries.Lcz_Country}\n                variant=\"modern\"\n                testId=\"main_guest_country\"\n                class=\"flex-grow-1 m-0\"\n                onCountryChange={e => this.handleCountryChange(e.detail.id)}\n                countries={this.countries}\n                country={this.countries.find(c => c.id === this.bookedByData.countryId)}\n              ></ir-country-picker>\n              <ir-mobile-input\n                size=\"small\"\n                onMobile-input-change={e => {\n                  this.handleDataChange('contactNumber', { target: { value: e.detail.formattedValue } });\n                }}\n                onMobile-input-country-change={e => this.handleDataChange('isdCode', { target: { value: e.detail.phone_prefix } })}\n                value={this.bookedByData.contactNumber}\n                // required\n                countryCode={this.countries.find(c => c.phone_prefix === this.bookedByData.isdCode)?.code}\n                countries={this.countries}\n              ></ir-mobile-input>\n              <wa-select\n                size=\"small\"\n                label={locales.entries.Lcz_YourArrivalTime}\n                data-testid=\"arrival_time\"\n                aria-disabled={String(Boolean(this.isButtonPressed && this.bookedByData.selectedArrivalTime.code === ''))}\n                id={v4()}\n                defaultValue={this.arrivalTimeList[0].CODE_NAME}\n                value={this.bookedByData.selectedArrivalTime.code}\n                onchange={event => this.handleDataChange('selectedArrivalTime', event)}\n              >\n                {this.arrivalTimeList.map(time => (\n                  <wa-option value={time.CODE_NAME} selected={this.bookedByData.selectedArrivalTime.code === time.CODE_NAME}>\n                    {time.CODE_VALUE_EN}\n                  </wa-option>\n                ))}\n              </wa-select>\n            </div>\n            <div class=\"p-0 flex-fill  ml-md-3 d-flex flex-column\" style={{ gap: '0.5rem' }}>\n              <wa-textarea\n                onchange={event => this.handleDataChange('message', event)}\n                size=\"small\"\n                value={this.bookedByData.message}\n                defaultValue={this.bookedByData.message}\n                label={locales.entries.Lcz_AnyMessageForUs}\n                rows={4}\n              ></wa-textarea>\n              {this.paymentMethods.length > 1 && (\n                <wa-select\n                  label={'Payment Method'}\n                  size=\"small\"\n                  value={booking_store?.selectedPaymentMethod?.code}\n                  onchange={e =>\n                    modifyBookingStore('selectedPaymentMethod', {\n                      code: (e.target as HTMLSelectElement).value,\n                    })\n                  }\n                >\n                  {this.paymentMethods.map(p => (\n                    <wa-option value={p.code}>{p.description}</wa-option>\n                  ))}\n                </wa-select>\n              )}\n              {booking_store.selectedPaymentMethod?.code === '001' && (\n                <Fragment>\n                  <ir-input\n                    value={this.bookedByData.cardNumber}\n                    defaultValue={this.bookedByData.cardNumber}\n                    onText-change={e => this.handleCreditCardDataChange('cardNumber', e.detail.trim())}\n                    label={locales.entries.Lcz_CardNumber}\n                  ></ir-input>\n                  <ir-input\n                    value={this.bookedByData.cardHolderName}\n                    defaultValue={this.bookedByData.cardHolderName}\n                    onText-change={e => this.handleCreditCardDataChange('cardHolderName', e.detail.trim())}\n                    label={locales.entries.Lcz_CardHolderName}\n                  ></ir-input>\n                  <ir-input\n                    onText-change={e => {\n                      const [month, year] = e.detail.split('/');\n                      this.handleCreditCardDataChange('expiryYear', month ?? '');\n                      this.handleCreditCardDataChange('expiryMonth', year ?? '');\n                    }}\n                    value={this.expiryDate}\n                    mask={{\n                      mask: 'MM/YY',\n                      placeholderChar: '_',\n                      blocks: {\n                        MM: {\n                          mask: IMask.MaskedRange,\n                          from: 1,\n                          to: 12,\n                          maxLength: 2,\n                        },\n                        YY: {\n                          mask: IMask.MaskedRange,\n                          from: new Date().getFullYear() % 100,\n                          to: (new Date().getFullYear() % 100) + 20,\n                          maxLength: 2,\n                        },\n                      },\n                    }}\n                    label={locales.entries.Lcz_ExpiryDate}\n                  ></ir-input>\n                </Fragment>\n              )}\n              {booking_store.selectedPaymentMethod?.code === '005' && (\n                <div class=\"form-group mt-md-1 mt-1 p-0 d-flex flex-column flex-md-row align-items-md-center\">\n                  <label class=\"p-0 m-0 margin3\"></label>\n                  <div class=\"p-0 m-0  controlContainer flex-fill\">\n                    <div\n                      class=\"property-booked-by__money-transfer-description\"\n                      innerHTML={this.paymentMethods.find(p => p.code === '005')?.localizables.find(l => l.language.code.toLowerCase() === 'en')?.description}\n                    ></div>\n                  </div>\n                </div>\n              )}\n              <wa-checkbox checked={this.bookedByData.emailGuest} onchange={event => this.handleDataChange('emailGuest', event)}>\n                {locales.entries.Lcz_EmailTheGuest}\n              </wa-checkbox>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}