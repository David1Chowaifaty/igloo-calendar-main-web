import{r as i,h as t,H as s}from"./p-53d64953.js";import{T as e}from"./p-a93581f3.js";import{l as n}from"./p-71768c2d.js";import{R as a}from"./p-429a4d65.js";import{B as o}from"./p-08fe3669.js";import"./p-bf44a732.js";import"./p-a973aec7.js";import"./p-00df8713.js";import"./p-b859bcd5.js";import"./p-ba0d5d8c.js";import"./p-6c4ba7c0.js";const r=".sc-ir-financial-actions-h{display:block}.financial-actions__meta.sc-ir-financial-actions{display:flex;flex-direction:column;gap:1rem}.daily-revenue__table.sc-ir-financial-actions{flex:1 1 0%}@media (min-width: 768px){.financial-actions__meta.sc-ir-financial-actions{flex-direction:row}}";const l=r;const c=class{constructor(t){i(this,t);this.language="";this.ticket="";this.isPageLoading=true;this.tokenService=new e;this.roomService=new a;this.bookingService=new o;this.handleSidebarClose=i=>{i.stopImmediatePropagation();i.stopPropagation();this.sideBarEvent=null}}componentWillLoad(){if(this.ticket){this.tokenService.setToken(this.ticket);this.initializeApp()}}ticketChanged(i,t){if(i===t){return}this.tokenService.setToken(this.ticket);this.initializeApp()}renderSidebarBody(){var i,s;if(!this.sideBarEvent){return}switch(this.sideBarEvent.type){case"booking":return t("ir-booking-details",{slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:this.handleSidebarClose,is_from_front_desk:true,propertyid:this.property_id,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.sideBarEvent.payload.bookingNumber.toString(),ticket:this.ticket,language:this.language,hasRoomAdd:true});case"payment":return t("ir-payment-folio",{bookingNumber:(s=(i=this.sideBarEvent.payload)===null||i===void 0?void 0:i.bookingNumber)===null||s===void 0?void 0:s.toString(),paymentEntries:this.paymentEntries,slot:"sidebar-body",payment:this.sideBarEvent.payload.payment,mode:"new",onCloseModal:this.handleSidebarClose});default:return null}}handleOpenSidebar(i){i.stopImmediatePropagation();i.stopPropagation();this.sideBarEvent=i.detail}async getFinancialAction(i=false){console.log(i)}async initializeApp(){this.isPageLoading=true;try{let i=this.propertyid;if(!i&&!this.p){throw new Error("Property ID or username is required")}if(!i){const t=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});i=t.My_Result.id}this.property_id=i;const t=[this.bookingService.getSetupEntriesByTableNameMulti(["_PAY_TYPE","_PAY_TYPE_GROUP","_PAY_METHOD"]),this.getFinancialAction(),this.roomService.fetchLanguage(this.language)];if(i){t.push(this.roomService.getExposedProperty({id:i,language:this.language,is_backend:true,include_units_hk_status:true}))}const[s]=await Promise.all(t);const{pay_type:e,pay_type_group:n,pay_method:a}=this.bookingService.groupEntryTablesResult(s);this.paymentEntries={groups:n,methods:a,types:e}}catch(i){console.log(i)}finally{this.isPageLoading=false}}render(){var i,e,a;if(this.isPageLoading){return t("ir-loading-screen",null)}return t(s,null,t("ir-toast",null),t("ir-interceptor",null),t("section",{class:"p-2 d-flex flex-column",style:{gap:"1rem"}},t("div",{class:"d-flex align-items-center justify-content-between"},t("h3",{class:"mb-1 mb-md-0"},"Payment Actions"),t("ir-button",{size:"sm",btn_color:"outline",isLoading:this.isLoading==="export",text:(i=n.entries)===null||i===void 0?void 0:i.Lcz_Export,onClickHandler:async i=>{i.stopImmediatePropagation();i.stopPropagation();await this.getFinancialAction(true)},btnStyle:{height:"100%"},iconPosition:"right",icon_name:"file",icon_style:{"--icon-size":"14px"}})),t("div",{class:"financial-actions__meta"},t("ir-financial-filters",{isLoading:this.isLoading==="filter"}),t("ir-financial-table",{class:"financial-actions__table card  w-100"}))),t("ir-sidebar",{sidebarStyles:{width:((e=this.sideBarEvent)===null||e===void 0?void 0:e.type)==="booking"?"80rem":"var(--sidebar-width,40rem)",background:((a=this.sideBarEvent)===null||a===void 0?void 0:a.type)==="booking"?"#F2F3F8":"white"},open:Boolean(this.sideBarEvent),showCloseButton:false,onIrSidebarToggle:this.handleSidebarClose},this.renderSidebarBody()))}static get watchers(){return{ticket:["ticketChanged"]}}};c.style=l;export{c as ir_financial_actions};
//# sourceMappingURL=p-a94a0859.entry.js.map