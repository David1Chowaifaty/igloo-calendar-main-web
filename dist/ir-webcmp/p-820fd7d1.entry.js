import{r as t,c as i,h as e,H as s}from"./p-b4b99085.js";import{P as o,p as l}from"./p-38591831.js";import{i as n}from"./p-9b8f6abc.js";import{l as a}from"./p-2fcb9a1f.js";import"./p-bf44a732.js";import"./p-41fabaeb.js";const r=".sc-ir-option-details-h{display:block}";const c=r;const h=".sc-ir-option-details-h{height:100%}.sheet-container.sc-ir-option-details{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-option-details{height:-webkit-fill-available;height:100vh}@supports (height: 100svh){.sheet-container.sc-ir-option-details{height:100svh}}.sheet-footer.sc-ir-option-details{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem 1rem calc(1rem + env(safe-area-inset-bottom));gap:0.5rem}.sheet-header.sc-ir-option-details{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-option-details{flex:1 1 0%}@media (max-width: 767px){.sheet-footer.sc-ir-option-details{bottom:env(safe-area-inset-bottom)}}@media (min-width: 768px){.sheet-footer.sc-ir-option-details{flex-direction:row;align-items:center}}";const d=h;const p=class{constructor(e){t(this,e);this.closeModal=i(this,"closeModal",7);this.toast=i(this,"toast",7);this.selectedLanguage=null;this.invalid=false;this.paymentOptionService=new o}async componentWillLoad(){var t;if(l.selectedOption.code!=="005"){return}if(!l.languages){const t=await this.paymentOptionService.GetExposedLanguages();l.languages=t}const i=(t=l.selectedOption.localizables)!==null&&t!==void 0?t:[];this.selectedLanguage=l.languages[0].id.toString();if(i.length===0){i.push(this.createBankTransferInfoObject(l.languages[0]))}this.localizationIdx=l.selectedOption.code==="005"?i===null||i===void 0?void 0:i.findIndex((t=>t.language.id.toString()===this.selectedLanguage)):null;l.selectedOption=Object.assign(Object.assign({},l.selectedOption),{localizables:i})}createBankTransferInfoObject(t){return{code:"BANK_TRANSFER_INFO",description:"",id:null,language:t}}async saveOption(t){var i,e;t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();let s=Object.assign(Object.assign({},l.selectedOption),{property_id:this.propertyId,is_active:l.mode==="create"?true:(i=l.selectedOption.is_active)!==null&&i!==void 0?i:false});if((s===null||s===void 0?void 0:s.code)==="005"){const t=(e=s.localizables.find((t=>t.language.code.toLowerCase()==="en")))===null||e===void 0?void 0:e.description;if(!t||t.trim()===""||this.isEditorEmpty(t.trim())){this.selectedLanguage=l.languages.find((t=>t.code.toLowerCase()==="en")).id.toString();this.localizationIdx=l.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage));this.invalid=true;return}}if(s.is_payment_gateway){s.display_order=0;const t=s.data.some((t=>!t.value||t.value===""));if(t){this.invalid=true;return}}await this.paymentOptionService.HandlePaymentMethod(s);this.toast.emit({type:"success",description:"",title:a.entries.Lcz_Saved,position:"top-right"});this.closeModal.emit(s)}isEditorEmpty(t){const i=t.replace(/<\/?[^>]+(>|$)/g,"").replace(/&nbsp;/g,"").trim();return i.length===0}handleSelectChange(t){var i;t.stopImmediatePropagation();t.stopPropagation();if(l.selectedOption.code!=="005"){return}this.selectedLanguage=t.detail;let e=l.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage));const s=(i=l.selectedOption.localizables)!==null&&i!==void 0?i:[];if(e===-1){s.push(this.createBankTransferInfoObject(l.languages.find((t=>t.id.toString()===this.selectedLanguage))));l.selectedOption=Object.assign(Object.assign({},l.selectedOption),{localizables:s});e=s.length-1}this.localizationIdx=e}handleTextAreaChange(t){const i=t.detail;if(i.trim()!==""&&this.invalid){this.invalid=false}const e=[...l.selectedOption.localizables];e[this.localizationIdx]=Object.assign(Object.assign({},e[this.localizationIdx]),{description:i});l.selectedOption=Object.assign(Object.assign({},l.selectedOption),{localizables:e})}handlePaymentGatewayInfoChange(t,i){const e=t.detail;const s=[...l.selectedOption.data];s[i]=Object.assign(Object.assign({},s[i]),{value:e});l.selectedOption=Object.assign(Object.assign({},l.selectedOption),{data:s})}render(){var t,i,o,r,c,h;if(!l.selectedOption){return null}return e(s,null,e("form",{class:"sheet-container",onSubmit:this.saveOption.bind(this)},e("ir-title",{class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:(t=a===null||a===void 0?void 0:a.entries.Lcz_Information)===null||t===void 0?void 0:t.replace("%1",(i=l.selectedOption)===null||i===void 0?void 0:i.description),displayContext:"sidebar"}),e("div",{class:"sheet-body px-1"},l.selectedOption.code==="005"?e("div",null,e("div",{class:"mb-1"},e("ir-select",{selectedValue:this.selectedLanguage,LabelAvailable:false,showFirstOption:false,data:l.languages.map((t=>({text:t.description,value:t.id.toString()})))})),e("div",null,this.invalid&&e("p",{class:"text-danger p-0 m-0"},a.entries.Lcz_YouMustFillEnglishField),e("ir-text-editor",{maxLength:450,placeholder:"",style:{"--ir-editor-height":"250px"},error:this.invalid,value:this.localizationIdx!==null?(c=(r=(o=l.selectedOption)===null||o===void 0?void 0:o.localizables[this.localizationIdx])===null||r===void 0?void 0:r.description)!==null&&c!==void 0?c:"":"",onTextChange:this.handleTextAreaChange.bind(this)}))):e("div",null,(h=l.selectedOption.data)===null||h===void 0?void 0:h.map(((t,i)=>{var s,o;return e("fieldset",{key:t.key},e("ir-input-text",{value:t.value,onTextChange:t=>this.handlePaymentGatewayInfoChange(t,i),id:`input_${t.key}`,label:t.key.replace(/_/g," "),placeholder:"",labelWidth:4,"aria-invalid":this.invalid&&(t.value===null||((o=(s=t.value)!==null&&s!==void 0?s:"")===null||o===void 0?void 0:o.trim())==="")?"true":"false"}))})))),e("div",{class:"sheet-footer"},e("ir-button",{onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,icon:"",text:a.entries.Lcz_Cancel,btn_color:"secondary",btn_type:"button"}),e("ir-button",{btn_type:"submit",btn_styles:"justify-content-center align-items-center",class:"flex-fill",icon:"",isLoading:n("/Handle_Payment_Method"),text:a.entries.Lcz_Save,btn_color:"primary"}))))}};p.style=c+d;export{p as ir_option_details};
//# sourceMappingURL=p-820fd7d1.entry.js.map