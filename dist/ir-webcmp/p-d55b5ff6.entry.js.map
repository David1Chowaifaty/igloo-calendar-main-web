{"version":3,"names":["irHousekeepingCss","IrHousekeepingStyle0","IrHousekeeping","constructor","hostRef","this","language","ticket","isLoading","roomService","RoomService","houseKeepingService","HouseKeepingService","token","Token","componentWillLoad","setToken","initializeApp","handleResetData","e","stopImmediatePropagation","stopPropagation","getExposedHKSetup","propertyid","ticketChanged","newValue","oldValue","propertyId","propertyData","getExposedProperty","id","aname","p","is_backend","My_Result","updateHKStore","property_id","requests","fetchLanguage","unshift","Promise","all","error","console","saveAutomaticCheckInCheckout","SetAutomaticCheckInOut","flag","detail","toast","emit","position","title","description","type","log","render","h","Host","class","borderShown","label","LabelAvailable","showFirstOption","selectedValue","calendar_data","is_automatic_check_in_out","onSelectChange","data","text","value"],"sources":["src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n","import Token from '@/models/Token';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport { updateHKStore } from '@/stores/housekeeping.store';\r\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\nimport { IToast } from '@components/ui/ir-toast/toast';\r\n@Component({\r\n  tag: 'ir-housekeeping',\r\n  styleUrl: 'ir-housekeeping.css',\r\n  scoped: true,\r\n})\r\nexport class IrHousekeeping {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n\r\n  @Prop() propertyid: number;\r\n  @Prop() p: string;\r\n\r\n  @State() isLoading = false;\r\n\r\n  @Event() toast: EventEmitter<IToast>;\r\n\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n  private token = new Token();\r\n\r\n  componentWillLoad() {\r\n    if (this.ticket !== '') {\r\n      this.token.setToken(this.ticket);\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Listen('resetData')\r\n  async handleResetData(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\r\n  }\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.initializeApp();\r\n  }\r\n\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      let propertyId = this.propertyid;\r\n      if (!propertyId) {\r\n        const propertyData = await this.roomService.getExposedProperty({\r\n          id: 0,\r\n          aname: this.p,\r\n          language: this.language,\r\n          is_backend: true,\r\n        });\r\n        propertyId = propertyData.My_Result.id;\r\n      }\r\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\r\n      const requests = [this.houseKeepingService.getExposedHKSetup(propertyId), this.roomService.fetchLanguage(this.language, ['_HK_FRONT'])];\r\n\r\n      if (this.propertyid) {\r\n        requests.unshift(\r\n          this.roomService.getExposedProperty({\r\n            id: propertyId,\r\n            language: this.language,\r\n            is_backend: true,\r\n          }),\r\n        );\r\n      }\r\n\r\n      await Promise.all(requests);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  private saveAutomaticCheckInCheckout(e: CustomEvent): void {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    try {\r\n      this.roomService.SetAutomaticCheckInOut({\r\n        property_id: this.propertyid,\r\n        flag: e.detail === 'auto',\r\n      });\r\n      this.toast.emit({\r\n        position: 'top-right',\r\n        title: 'Saved Successfully',\r\n        description: '',\r\n        type: 'success',\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-interceptor></ir-interceptor>\r\n        <ir-toast></ir-toast>\r\n        <section class=\"p-1\">\r\n          <h3 class=\"mb-2\">Housekeeping & Check-In Setup</h3>\r\n          <div class=\"card p-1\">\r\n            <ir-title borderShown label=\"Check-In Mode\"></ir-title>\r\n            <div class={'d-flex align-items-center'}>\r\n              <p class=\"my-0 py-0 mr-1  \">Check in & Check out guests automatically:</p>\r\n              <ir-select\r\n                LabelAvailable={false}\r\n                showFirstOption={false}\r\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\r\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\r\n                data={[\r\n                  { text: `Yes, as per the property's policy.`, value: 'auto' },\r\n                  { text: 'No, I will do it manually. ', value: 'manual' },\r\n                ]}\r\n              ></ir-select>\r\n            </div>\r\n          </div>\r\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\r\n          <ir-hk-team class=\"mb-1\"></ir-hk-team>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"wRAAA,MAAMA,EAAoB,uCAC1B,MAAAC,EAAeD,E,MCWFE,EAAc,MAL3B,WAAAC,CAAAC,G,uCAMUC,KAAAC,SAAmB,GACnBD,KAAAE,OAAiB,GAKhBF,KAAAG,UAAY,MAIbH,KAAAI,YAAc,IAAIC,EAClBL,KAAAM,oBAAsB,IAAIC,EAC1BP,KAAAQ,MAAQ,IAAIC,C,CAEpB,iBAAAC,GACE,GAAIV,KAAKE,SAAW,GAAI,CACtBF,KAAKQ,MAAMG,SAASX,KAAKE,QACzBF,KAAKY,e,EAIT,qBAAMC,CAAgBC,GACpBA,EAAEC,2BACFD,EAAEE,wBACIhB,KAAKM,oBAAoBW,kBAAkBjB,KAAKkB,W,CAGxD,aAAAC,CAAcC,EAAkBC,GAC9B,GAAID,IAAaC,EAAU,CACzB,M,CAEFrB,KAAKQ,MAAMG,SAASX,KAAKE,QACzBF,KAAKY,e,CAGP,mBAAMA,GACJ,IACEZ,KAAKG,UAAY,KACjB,IAAImB,EAAatB,KAAKkB,WACtB,IAAKI,EAAY,CACf,MAAMC,QAAqBvB,KAAKI,YAAYoB,mBAAmB,CAC7DC,GAAI,EACJC,MAAO1B,KAAK2B,EACZ1B,SAAUD,KAAKC,SACf2B,WAAY,OAEdN,EAAaC,EAAaM,UAAUJ,E,CAEtCK,EAAc,qBAAsB,CAAEtB,MAAOR,KAAKE,OAAQ6B,YAAaT,EAAYrB,SAAUD,KAAKC,WAClG,MAAM+B,EAAW,CAAChC,KAAKM,oBAAoBW,kBAAkBK,GAAatB,KAAKI,YAAY6B,cAAcjC,KAAKC,SAAU,CAAC,eAEzH,GAAID,KAAKkB,WAAY,CACnBc,EAASE,QACPlC,KAAKI,YAAYoB,mBAAmB,CAClCC,GAAIH,EACJrB,SAAUD,KAAKC,SACf2B,WAAY,O,OAKZO,QAAQC,IAAIJ,E,CAClB,MAAOK,GACPC,QAAQD,MAAMA,E,SAEdrC,KAAKG,UAAY,K,EAGb,4BAAAoC,CAA6BzB,GACnCA,EAAEC,2BACFD,EAAEE,kBACF,IACEhB,KAAKI,YAAYoC,uBAAuB,CACtCT,YAAa/B,KAAKkB,WAClBuB,KAAM3B,EAAE4B,SAAW,SAErB1C,KAAK2C,MAAMC,KAAK,CACdC,SAAU,YACVC,MAAO,qBACPC,YAAa,GACbC,KAAM,W,CAER,MAAOX,GACPC,QAAQW,IAAIZ,E,EAGhB,MAAAa,GACE,GAAIlD,KAAKG,UAAW,CAClB,OAAOgD,EAAA,yB,CAET,OACEA,EAACC,EAAI,KACHD,EAAA,uBACAA,EAAA,iBACAA,EAAA,WAASE,MAAM,OACbF,EAAA,MAAIE,MAAM,QAAM,iCAChBF,EAAA,OAAKE,MAAM,YACTF,EAAA,YAAUG,YAAW,KAACC,MAAM,kBAC5BJ,EAAA,OAAKE,MAAO,6BACVF,EAAA,KAAGE,MAAM,oBAAkB,8CAC3BF,EAAA,aACEK,eAAgB,MAChBC,gBAAiB,MACjBC,cAAeC,EAAcC,0BAA4B,OAAS,SAClEC,eAAgB/C,GAAKd,KAAKuC,6BAA6BzB,GACvDgD,KAAM,CACJ,CAAEC,KAAM,qCAAsCC,MAAO,QACrD,CAAED,KAAM,8BAA+BC,MAAO,eAMtDb,EAAA,cAAYE,MAAM,U","ignoreList":[]}