{"version":3,"names":["iglBookingEventCss","IglBookingEventStyle0","IglBookingEvent","currency","is_vacation_rental","language","bookingEvent","allBookingEvents","countries","hideBubbleInfo","updateEventData","dragOverEventData","showRoomNightsDialog","showDialog","resetStretchedBooking","toast","updateBookingEvent","renderElement","position","isShrinking","dayWidth","eventSpace","vertSpace","showInfoPopup","bubbleInfoTopSide","isStretch","eventsService","EventsService","bookingService","BookingService","resizeSide","isDragging","initialX","initialY","currentX","currentY","initialWidth","initialLeft","finalWidth","dragInitPos","dragEndPos","elementRect","isTouchStart","moveDifferenceX","moveDifferenceY","animationFrameId","handleMouseMoveBind","this","handleMouseMove","bind","handleMouseUpBind","handleMouseUp","role","componentWillLoad","componentDidLoad","isNewEvent","hideBubble","setTimeout","async","includes","STATUS_CODE","showEventInfo","STATUS","fetchAndAssignBookingData","renderAgain","disconnectedCallback","cancelAnimationFrame","hideBubbleInfoPopup","event","detail","currentInfoBubbleId","getBookingId","key","moveBookingToHandler","bookingId","moveToDay","toRoomId","FROM_DATE","fromRoomId","isBlockUnit","requestAnimationFrame","resetBookingToInitialPosition","pool","to_date","from_date","previousToDate","moment","add","format","console","log","findRoomType","Number","PR_ID","TO_DATE","isSame","calendar_dates","disabled_cells","get","disabled","reset","checkIfSlotOccupied","reallocateEvent","catch","description","status","newRatePlans","getModalDescription","hideConfirmButton","oldFromDate","defaultDates","oldToDate","diffDays","calculateDaysBetweenDates","shrinkingDirection","fromDate","toDate","isAfter","isBefore","newToDate","subtract","warn","emit","reason","title","rateplans","validateDates","base_date","cursor","counter","locales","entries","Lcz_ThisUnitIsNotAvailable","payload","booking","bookingNumber","BOOKING_NUMBER","identifier","IDENTIFIER","is_direct","error","message","type","closeEventBubble","validStatuses","data","getExposedBooking","base_booking","filteredRooms","rooms","filter","room","ID","length","Error","some","transformedBooking","transformNewBooking","NO_OF_DAYS","NAME","origin","TOTAL_PRICE","POOL","NOTES","BALANCE","channel_booking_nbr","otherBookingData","DEPARTURE_TIME","PHONE","PHONE_PREFIX","PRIVATE_NOTE","ROOM_INFO","sharing_persons","roomId","roomType","roomsInfo","physicalrooms","r","id","buildBarIds","bar","lateCheckout","balance","Lcz_OTA_Modification_Alter","initialRT","targetRT","Lcz_AreYouSureWantToMoveAnotherUnit","mealPlans","checkMealPlan","rateplan_id","RATE_PLAN_ID","roomTypeId","roomTypes","calendar_data","property","roomtypes","Array","isArray","undefined","Lcz_CannotChangeCHBookings","toString","Lcz_ConfrmModiication","Lcz_SameRatesWillBeKept","element","style","left","width","top","handleRevertBooking","fromTime","toTime","isOccupied","eventFromTime","eventToTime","isSameOrAfter","getUniqueId","Date","getTime","isSplitBooking","SPLIT_BOOKING","isHighlightEventType","getEventType","getBookingStatus","getBookedBy","getBookedRoomId","getEventStartingDate","getEventEndingDate","event_type","getEventLegend","legendData","statusId","orderRide","color","getLegendOfStatus","aStatusId","getNoteNode","INTERNAL_NOTE","getBalanceNode","setStayDays","aStayDays","getStayDays","getPosition","startingDate","startingCellClass","getDate","getMonth","getFullYear","bodyContainer","document","querySelector","startingCell","pos","height","getBoundingClientRect","bodyContainerRect","boundingRect","getNumber","aData","parseFloat","startDragging","side","preventDefault","stopPropagation","stopImmediatePropagation","clientX","touches","clientY","offsetX","offsetY","x","y","offsetWidth","offsetLeft","addEventListener","distanceX","distanceY","baseCondition","newWidth","Math","min","max","newLeft","abs","nbOfDays","numberOfDays","round","initialStayDays","isNaN","replace","offset","removeEventListener","updateData","calculateHoverPosition","barRect","barWidth","barLeft","screenWidth","window","innerWidth","hoverLeft","transform","renderEventBookingNumber","showInfo","midPoint","isDepartureAfterHotelCheckout","departureTime","code","t1","time_constraints","check_out_till","t2","computeSplitRole","SPLIT_INDEX","buildSplitIndex","ROOMS","splitRole","getSplitRole","render","legend","noteNode","balanceNode","backgroundColor","calendar_extra","booking_color","foreground","stripe","colorsForegrounds","checkout","h","Host","class","clsName","bookingEventBase","skewedLeft","skewedRight","onTouchStart","onMouseDown","for","formatAmount","symbol","Fragment","bubbleInfoTop","__decorate","ClickOutside","ReloadInterceptor","isActive","onIntercept","constructor","options","autoActivate","activate","handleBeforeUnload","capture","deactivate","e","returnValue","iglBulkBlockCss","IglBulkBlockStyle0","sheetCss","IglBulkBlockStyle1","IglBulkBlock","maxDatesLength","property_id","selectedRoomTypes","Map","selectedUnit","errors","isLoading","blockState","dates","from","to","closeModal","sidebar","dateRefs","reloadInterceptor","minDate","datesSchema","z","array","object","any","refine","val","isMoment","unitSections","datesSections","addBlockDates","periods","parse","scrollIntoView","behavior","block","blockAvailabilityForBrackets","unit_id","block_status_code","brackets","map","p","unBlockUnitByPeriod","Lcz_RequestSubmittedSuccessfully","ZodError","preventClose","handleDateChange","index","date","i","rowFrom","isSameOrBefore","openDatePicker","nextFrom","findIndex","d","addDateRow","last_dates","onSubmit","gap","showFirstOption","selectedValue","text","value","onSelectChange","Lcz_PlzSelectOneListing","Lcz_PlzSelectOneUnit","ref","el","name","j","row_style","checked","onCheckChange","roomtype_id","label","Lcz_From","Lcz_ToExclusive","variant","icon_name","onClickHandler","fromDateMinDate","clone","toDateMinDate","forceDestroyOnUpdate","emitEmptyDate","String","onDateChanged","evt","start","onDatePickerFocus","slot","maxDate","_","Lcz_Cancel","btn_color","Lcz_Confirm","btn_type","iglBulkOperationsCss","IglBulkOperationsStyle0","IglBulkOperationsStyle1","IglBulkOperations","selectedTab","tabs","tabsEl","titleEl","setProperty","onCloseSideBar","displayContext","onTabChanged","iglBulkStopSaleCss","IglBulkStopSaleStyle0","IglBulkStopSaleStyle1","IglBulkStopSale","selectedWeekdays","Set","fill","getDayIndex","dateStr","day","weekdaysSections","generatePeriodsToModify","period","current","lastDay","nextDay","has","selectedRoom","push","room_type_id","night","updateCalendarCells","payloads","prevDisabledCells","roomsInfoById","rt","dayIndexByValue","days","rateByRoomTypeAndDate","restriction","restrictions","dayIndex","rateKey","rp","rate","find","set","haveAvailability","exposed_inventory","rts","is_closed","size","periods_to_modify","isAllOpen","every","result","isAllClosed","setExposedRestrictionPerRoomType","f","Promise","all","firstOption","Lcz_Select","Lcz_Open","Lcz_StopSale","choice","rest","entry","weekdays","onWeekdayChange","Lcz_Save","iglCalBodyCss","IglCalBodyStyle0","IglCalBody","isScrollViewDragging","propertyId","calendarData","today","highlightedDate","dragOverElement","addBookingDatasEvent","showBookingPopup","scrollPageToRoom","selectedRooms","newEvent","currentDate","hkModal","housekeepingService","HouseKeepingService","bookingMap","interactiveTitle","dayRateMap","setHours","getBookingMap","getBookingData","forEach","updateDisabledCellsCache","handleCalendarDataChange","dragOverHighlightElementHandler","gotoRoom","category","getRoomCategoryByRoomId","expanded","toggleCategory","scrollToRoom","addToBeAssignedEvents","addBookingDatas","closeWindow","ind","ev","splice","refClass","roomCategory","getCategoryRooms","getRoomId","getCategoryName","getCategoryId","getTotalPhysicalRooms","getRoomName","roomInfo","getRoomById","physicalRooms","physical_room","bookingEvents","getSelectedCellRefName","selectedDay","getSplitBookingEvents","addNewEvent","keys","Object","startDate","endDate","dateDifference","EMAIL","convertBooking","REFERENCE_TYPE","getTwoDigitNumStr","RELEASE_AFTER_HOURS","ENTRY_DATE","ADULTS_COUNT","COUNTRY","RATE","RATE_PLAN","ARRIVAL_TIME","TITLE","Lcz_NewBookingFor","CATEGORY","defaultDateRange","fromDateStr","toDateStr","editable","popupTitle","BLOCK_DATES_TITLE","Lcz_BlockDatesFor","getDateStr","toISOString","formattedLegendData","splitBookingEvents","num","locale","toLocaleString","month","removeNewEvent","events","clickCell","refKey","hasOwnProperty","disabledCount","dateKey","isCellDisabled","showNewBookingPopup","bookings","startOf","compareTime","createDateWithOffsetAndHour","checkin_checkout_hours","hour","getGeneralCategoryDayColumns","addClass","isCategory","dayInfo","getGeneralRoomDayColumns","roomName","prevDate","isDisabled","isSelected","isCurrentDate","cleaningDates","cleaningTasks","shouldBeCleaned","cleaning_frequency","onClick","Boolean","getRoomCategoryRow","is_active","popoverTitle","xmlns","viewBox","getRoomsByCategory","haveSingleRooms","housekeeping_enabled","openModal","onMouseEnter","onMouseLeave","removeProperty","hk_status","hkStatus","display","getRoomRows","confirmHousekeepingUpdate","setExposedUnitHKStatus","unit","executeHKAction","actions","hkm_id","housekeeper","booking_nbr","RATE_TYPE","leftBtnText","middleBtnText","renderModalMiddleButtonText","middleBtnActive","rightBtnText","renderModalRightButtonText","modalBody","renderModalBody","onConfirmModal","onMiddleModal","autoClose","isMiddleButtonLoading","onCancelModal","clear","categoryIndex","cellKey","getCellKey","is_available_to_book","iglCalFooterCss","IglCalFooterStyle0","IglCalFooter","optionEvent","isLegendOpen","_today","handleOptionEvent","paddingLeft","Lcz_Legend","marginLeft","weekend","isWeekend","currentDay","dayDisplayName","iglCalHeaderCss","IglCalHeaderStyle0","IglCalHeader","gotoRoomEvent","gotoToBeAssignedDate","propertyid","unassignedDates","unassignedRoomsNumber","roomsList","toBeAssignedService","ToBeAssignedService","dateRef","initializeRoomsList","handleUnAssignedDatesChange","newValue","fetchAndAssignUnassignedRooms","handleCalendarDataChanged","concat","assignRoomsToDate","dt","selectedDate","getUnassignedRooms","dateToFormattedString","res","newEndDate","renderView","handleReduceAvailableUnitEvent","showToBeAssigned","handleDateSelect","handleClearSearch","handleFilterRooms","inputElement","target","trim","toLowerCase","handleScrollToRoom","getStringDateFormat","getNewBookingModel","setDate","Lcz_NewBooking","editabled","colorVariants","secondary","Lcz_UnassignedUnitsTooltip","btn_styles","visibleBackgroundOnHover","Lcz_Navigate","Lcz_Today","Lcz_CreateNewBooking","Lcz_StopOpenSale","item","monthsInfo","monthInfo","daysCount","monthName","unassigned_units_nbr","dayTitle","occupancy","iglLegendsCss","IglLegendsStyle0","IglLegends","propertyService","PropertyService","bookingColors","saveState","saveError","loadingIndex","saveTimeout","clearTimeout","handleSaveStateChange","syncCalendarExtra","colors","calendarExtra","booking_colors","updateBookingColor","patch","idx","persistBookingColors","setPropertyCalendarExtra","JSON","stringify","handleNameInput","handleBlur","handleLoaderComplete","currentIndex","legendInfo","l","design","stripeColor","colSpan","marginTop","marginBottom","paddingBottom","previewClass","inputContainerStyle","margin","placeholder","onTextChange","onInputBlur","onLoaderComplete","Lcz_MonthAndYear","Lcz_UnassignedUnits","Lcz_Date","Lcz_Occupancy","Lcz_TotalAvailability","iglReallocationDialogCss","IglReallocationDialogStyle0","IglReallocationDialog","selectedRateplan","showRateplanError","dialogClose","revertBooking","resetModalState","dialogEl","rateplanSelectEl","handleDataChange","newData","resetState","reallocateUnit","validateRateplanSelection","rateplanOptions","option","formatRateplanLabel","suffix","custom_text","hasRateplanRequirement","focusRateplanSelect","selectEl","shadowRoot","focus","handleDialogVisibilityChange","handleRateplanChange","handleCancelClick","hasRateplans","onIrDialogHide","defaultValue","onchange","appearance","loading","isRequestPending","SelectedUnitSchema","coerce","number","iglSplitBookingCss","IglSplitBookingStyle0","IglSplitBookingStyle1","IglSplitBooking","selectedDates","mealPlanOptions","getRoom","generateDates","MFromDate","MToDate","checkBookingAvailability","resetBookingStore","is_in_agent_mode","agent","getBookingAvailability","adultChildCount","adult","child","room_type_ids","agent_id","room_type_ids_to_update","doReservation","oldRooms","canCheckIn","in_out","departure_time","check_in","assigned_units_pool","parent_room_identifier","is_split","roomtype","rateplan","assign_units","is_pms","is_backend","is_in_loyalty_mode","promo_key","extras","remark","booked_on","source","arrival","guest","pickup_info","err","issues","path","updateSelectedUnit","params","merged","roomTypesSource","mealPlanResult","hasExplicitRateplanUpdate","prototype","call","showDateDifference","short_name","is_non_refundable","Lcz_NonRefundable","units","unitMap","assignable_units","Is_Fully_Available","pr_id","showMealPlanSelect","iglTbaCategoryViewCss","IglTbaCategoryViewStyle0","IglTbaCategoryView","categoriesData","categoryId","eventDatas","assignUnitEvent","handleAssignRoomEvent","opt","eventData","RT_ID","assignEvent","getEventView","eventIndex","onAssignRoomEvent","iglToBeAssignedCss","IglToBeAssignedStyle0","IglToBeAssigned","unassignedDatesProp","loadingMessage","showDatesList","orderedDatesList","noScroll","reduceAvailableUnitEvent","addToBeAssignedEvent","highlightToBeAssignedBookingEvent","isGotoToBeAssignedDate","reArrangeData","Lcz_FetchingUnAssignedUnits","handleUnassignedDatesToBeAssignedChange","setMinutes","setSeconds","sort","a","b","parseInt","showForDate","handleAssignUnit","categories","updateCategories","categorisedRooms","roomIds","getUnassignedDates","firstKey","gotoDate","handleToBeAssignedDate","dateStamp","withLoading","showUnassignedDate","getDay","dayOfWeek","getLocalizedDayOfWeek","weekday","toLocaleDateString","getToBeAssignedEntities","getCategoryView","onAssignUnitEvent","Lcz_Assignments","Lcz_AllBookingsAreAssigned","ordDate","Lcz_AllAssignForThisDay","irInteractiveTitleCss","IrInteractiveTitleStyle0","IrInteractiveTitle","irPopoverLeft","cropSize","broomTooltip","lastRenderedTitle","titleContainerRef","popoverInstance","initializePopoverIfNeeded","titleContainer","disposePopover","tempSpan","createElement","visibility","whiteSpace","textContent","body","appendChild","textWidth","removeChild","containerWidth","clientWidth","iconWidth","willOverflow","$","popover","trigger","content","placement","html","sanitize","delay","show","hide","shouldCrop","displayTitle","slice","overflow","textOverflow","alignItems","flexShrink","minWidth","irPriceInputCss","IrPriceInputStyle0","IrPriceInput","readOnly","inputStyle","labelStyle","autoValidate","wrapKey","zod","required","minValue","maxValue","testId","containerClassname","labelContainerClassname","textChange","inputBlur","inputFocus","opts","mask","scale","radix","mapToRadix","normalizeZeros","padFractionalZeros","thousandsSeparator","inputRef","v4","initializeMask","maskOpts","IMask","on","isEmpty","unmaskedValue","hasSpecialClass","className","classList","contains","validateInput","handleInputChange","numValue","toFixed","handleFocus","htmlFor","onInput","onBlur","onFocus","ariaLabel","ariaDescription","irRoomNightsCss","IrRoomNightsStyle0","IrRoomNightsStyle1","IrRoomNights","ticket","rates","initialLoading","inventory","isEndDateBeforeFromDate","defaultTotalNights","isInputFocused","closeRoomNightsDialog","init","isButtonDisabled","amount","fetchBookingAvailability","newDatesArr","getDaysArray","cost","handleInput","inputValue","rate_plan_id","bookingAvailability","selected_variation","adult_nbr","child_nbr","rate_plan_ids","rate_plan","variations","variation","discounted_gross_amount","renderInputField","currency_symbol","renderReadOnlyField","renderRateFields","renderDates","convertDatePrice","handleRoomConfirmation","selectedRoomIndex","extra_services","Lcz_AddingRoomNightsTo","Lcz_Booking","formatDate","Lcz_NoAvailabilityForAdditionalNights","btn_disabled","irSuccessLoaderCss","IrSuccessLoaderStyle0","IrSuccessLoader","spinnerDuration","successDuration","autoStart","active","loaderComplete","phase","spinnerTimer","successTimer","startCycle","clearTimers","onActiveChange","resetCycle","onDurationChange","spinnerDelay","showSuccess","successDelay","handleCompletion","part","irTabsCss","IrTabsStyle0","IrTabs","initialTab","_selectedTab","tabChanged","activeIndicator","tab","t","selectTab","updateActiveIndicator","parentLeft","remSize","fontSize","getComputedStyle","documentElement","handleKeyDown","currentTab","nextIndex","nextTab","tabButton","tabindex","onKeyDown"],"sources":["src/components/igloo-calendar/igl-booking-event/igl-booking-event.css?tag=igl-booking-event&encapsulation=scoped","src/components/igloo-calendar/igl-booking-event/igl-booking-event.tsx","src/utils/ReloadInterceptor.ts","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-block/igl-bulk-block.css?tag=igl-bulk-block&encapsulation=scoped","src/common/sheet.css?tag=igl-bulk-block&encapsulation=scoped","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-block/igl-bulk-block.tsx","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-operations.css?tag=igl-bulk-operations&encapsulation=scoped","src/common/sheet.css?tag=igl-bulk-operations&encapsulation=scoped","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-operations.tsx","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-stop-sale/igl-bulk-stop-sale.css?tag=igl-bulk-stop-sale&encapsulation=scoped","src/common/sheet.css?tag=igl-bulk-stop-sale&encapsulation=scoped","src/components/igloo-calendar/igl-bulk-operations/igl-bulk-stop-sale/igl-bulk-stop-sale.tsx","src/components/igloo-calendar/igl-cal-body/igl-cal-body.css?tag=igl-cal-body&encapsulation=scoped","src/components/igloo-calendar/igl-cal-body/igl-cal-body.tsx","src/components/igloo-calendar/igl-cal-footer/igl-cal-footer.css?tag=igl-cal-footer&encapsulation=scoped","src/components/igloo-calendar/igl-cal-footer/igl-cal-footer.tsx","src/components/igloo-calendar/igl-cal-header/igl-cal-header.css?tag=igl-cal-header&encapsulation=scoped","src/components/igloo-calendar/igl-cal-header/igl-cal-header.tsx","src/components/igloo-calendar/igl-legends/igl-legends.css?tag=igl-legends&encapsulation=scoped","src/components/igloo-calendar/igl-legends/igl-legends.tsx","src/components/igloo-calendar/igl-reallocation-dialog/igl-reallocation-dialog.css?tag=igl-reallocation-dialog&encapsulation=scoped","src/components/igloo-calendar/igl-reallocation-dialog/igl-reallocation-dialog.tsx","src/components/igloo-calendar/igl-split-booking/types.ts","src/components/igloo-calendar/igl-split-booking/igl-split-booking.css?tag=igl-split-booking&encapsulation=scoped","src/common/sheet.css?tag=igl-split-booking&encapsulation=scoped","src/components/igloo-calendar/igl-split-booking/igl-split-booking.tsx","src/components/igloo-calendar/igl-to-be-assigned/igl-tba-category-view/igl-tba-category-view.css?tag=igl-tba-category-view&encapsulation=scoped","src/components/igloo-calendar/igl-to-be-assigned/igl-tba-category-view/igl-tba-category-view.tsx","src/components/igloo-calendar/igl-to-be-assigned/igl-to-be-assigned.css?tag=igl-to-be-assigned&encapsulation=scoped","src/components/igloo-calendar/igl-to-be-assigned/igl-to-be-assigned.tsx","src/components/ui/ir-interactive-title/ir-interactive-title.css?tag=ir-interactive-title&encapsulation=scoped","src/components/ui/ir-interactive-title/ir-interactive-title.tsx","src/components/ui/ir-price-input/ir-price-input.css?tag=ir-price-input&encapsulation=scoped","src/components/ui/ir-price-input/ir-price-input.tsx","src/components/igloo-calendar/ir-room-nights/ir-room-nights.css?tag=ir-room-nights&encapsulation=scoped","src/common/sheet.css?tag=ir-room-nights&encapsulation=scoped","src/components/igloo-calendar/ir-room-nights/ir-room-nights.tsx","src/components/ui/ir-success-loader/ir-success-loader.css?tag=ir-success-loader&encapsulation=shadow","src/components/ui/ir-success-loader/ir-success-loader.tsx","src/components/ui/ir-tabs/ir-tabs.css?tag=ir-tabs&encapsulation=scoped","src/components/ui/ir-tabs/ir-tabs.tsx"],"sourcesContent":[":host {\n  display: block;\n  position: absolute;\n  --ota-bar-width: 2px;\n  --stripe-period: 20px;\n  --split-border-width: 5px;\n  --split-border-color: #000000;\n}\n\n.bookingEventBase {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 4px;\n  background-color: rgb(49, 190, 241);\n  transform: skewX(-22deg);\n  cursor: pointer;\n}\n.bookingEventBase.leftSplit {\n  border-left: var(--split-border-width) solid var(--split-border-color);\n}\n.bookingEventBase.rightSplit {\n  border-right: var(--split-border-width) solid var(--split-border-color);\n}\n.bookingEventBase.fullSplit {\n  border-right: var(--split-border-width) solid var(--split-border-color);\n  border-left: var(--split-border-width) solid var(--split-border-color);\n}\n\n.bookingEventBase.fullSplit.skewedLeft,\n.bookingEventBase.leftSplit.skewedLeft {\n  border-left: 0;\n}\n.bookingEventBase.fullSplit.skewedRight,\n.bookingEventBase.leftSplit.skewedRight {\n  border-right: 0;\n}\n\n.bookingEvent {\n  cursor: pointer;\n}\n\n/* OTA bar width helper */\n.ota-booking-event {\n  border-width: var(--ota-bar-width) !important;\n}\n\n/* Hidden sizing surface (note: fixed missing px) */\n.bookingEventHiddenBase {\n  position: absolute;\n  top: 0;\n  left: -4px;\n  width: calc(100% + 8px);\n}\n\n/* Shared half-tile base for skewed sides */\n.bookingEventBase.skewedLeft::before,\n.bookingEventBase.skewedRight::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 50%;\n  height: 100%;\n  left: -4px;\n  background-color: var(--ir-event-bg);\n  border-radius: 4px;\n}\n\n/* Individual adjustments */\n.bookingEventBase.skewedLeft::before {\n  transform-origin: right;\n  transform: skewX(22deg);\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.bookingEventBase.fullSplit.skewedLeft::before,\n.bookingEventBase.leftSplit.skewedLeft::before {\n  border-left: var(--split-border-width) solid var(--split-border-color) !important;\n  z-index: 2;\n  background-color: transparent;\n}\n.bookingEventBase.fullSplit.skewedRight::before,\n.bookingEventBase.leftRight.skewedRight::before {\n  border-right: var(--split-border-width) solid var(--split-border-color) !important;\n  z-index: 2;\n  background-color: transparent;\n}\n\n/* .bookingEventBase::before {\n  content: '';\n  position: absolute;\n  inset: 0;\n  background: inherit;\n  background-color: var(--ir-event-bg);\n  transform-origin: left;\n  left: 10px;\n  right: -4px;\n  transform: skewX(22deg);\n  border-radius: inherit;\n} */\n\n.bookingEventBase.skewedRight::before {\n  transform-origin: left;\n  transform: skewX(22deg 0deg);\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n\n/* Border variant on skewed halves */\n.bookingEventBase.border.skewedLeft::before {\n  border: var(--ota-bar-width) solid #424242;\n  border-right: 0;\n  border-left: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  top: calc(var(--ota-bar-width) * -1);\n  height: 20px;\n  left: -4px;\n}\n\n.bookingEventBase.border.skewedRight::before {\n  border: var(--ota-bar-width) solid #424242;\n  border-left: 0;\n  border-right: 0;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  top: calc(var(--ota-bar-width) * -1);\n  height: 20px;\n  right: -4px;\n}\n\n.bookingEventBase.striped-bar.fullSplit.skewedLeft.vertical::after,\n.bookingEventBase.striped-bar.leftSplit.skewedLeft.vertical::after {\n  z-index: 1;\n  border-left: var(--split-border-width) solid var(--split-border-color);\n}\n.bookingEventBase.striped-bar.fullSplit.skewedRight.vertical::after,\n.bookingEventBase.striped-bar.rightSplit.skewedRight.vertical::after {\n  z-index: 1;\n  border-right: var(--split-border-width) solid var(--split-border-color);\n}\n\n.bookingEventBase.striped-bar.vertical::after {\n  --stripe-angle: 360deg;\n}\n/* Striped overlay */\n.bookingEventBase.striped-bar::after {\n  content: '';\n  position: absolute;\n  inset: 0;\n  border-radius: 4px;\n\n  /* clean, seamless repeating tile */\n  background: repeating-linear-gradient(\n    var(--stripe-angle, 45deg),\n    var(--ir-event-bg) 0,\n    var(--ir-event-bg) calc(var(--stripe-period) / 2),\n    var(--ir-event-bg-stripe-color) calc(var(--stripe-period) / 2),\n    var(--ir-event-bg-stripe-color) var(--stripe-period)\n  );\n  backface-visibility: hidden;\n}\n.bookingEventBase.skewedRight.striped-bar::after,\n.bookingEventBase.border.skewedRight::after {\n  right: -8px;\n}\n.bookingEventBase.skewedLeft.striped-bar::after,\n.bookingEventBase.border.skewedLeft::after {\n  left: -8px;\n}\n.bookingEventBase.striped-bar.animated::after {\n  background-size: 28.28px 28.28px;\n  backface-visibility: hidden;\n  animation: stripes 0.8s linear infinite;\n  will-change: background-position;\n}\n\n@keyframes stripes {\n  0% {\n    background-position: 0 0;\n  }\n  100% {\n    background-position: 28.28px 0;\n  }\n}\n.bookingEventDragHandle {\n  position: absolute;\n  top: 0;\n  width: 15px;\n  height: 100%;\n  opacity: 0.1;\n  background-color: rgba(0, 0, 0, 0.15);\n  transform: skewX(-22deg);\n  border-radius: 4px;\n  /* display: none; */\n  cursor: pointer;\n}\n\n:host:hover .bookingEventDragHandle {\n  display: block;\n  opacity: 1;\n}\n\n:host.newEvent:hover .bookingEventDragHandle {\n  display: none;\n  opacity: 1;\n}\n\n.leftSide {\n  left: 0;\n}\n.rightSide {\n  right: 0;\n}\n\n/* cancel skew on side wrappers when needed */\n.leftSide.skewedLeft {\n  transform: skewX(0);\n}\n.rightSide.skewedRight {\n  transform: skewX(0);\n}\n\n.bookingEventTitle {\n  position: relative;\n  top: 2px;\n  left: 5px;\n  max-width: calc(100% - 10px);\n  color: #fff;\n  font-size: 0.8em;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n  cursor: pointer;\n}\n\n.legend_circle {\n  width: 10px;\n  height: 10px;\n  margin: 3px 3px 3px 2px;\n  border: 1px solid #fff;\n  border-radius: 100%;\n}\n\n.noteIcon {\n  position: absolute;\n  bottom: -8px;\n  left: 2px;\n}\n\n.balanceIcon {\n  position: absolute;\n  top: -8px;\n  right: 2px;\n}\n.splitBooking {\n  border-right: 2px solid #000000;\n}\n","import { Component, Element, Event, EventEmitter, Fragment, Host, Listen, Prop, State, h } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { buildSplitIndex, calculateDaysBetweenDates, getSplitRole, transformNewBooking } from '@/utils/booking';\nimport { checkMealPlan, formatAmount, isBlockUnit } from '@/utils/utils';\nimport { IRoomNightsData, CalendarModalEvent } from '@/models/property-types';\nimport moment from 'moment';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport { EventsService } from '@/services/events.service';\nimport locales from '@/stores/locales.store';\nimport { ICountry } from '@/models/IBooking';\nimport calendar_dates from '@/stores/calendar-dates.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { ClickOutside } from '@/decorators/ClickOutside';\nexport type BarPosition = { top: string; left: string; width: string; height: string };\n@Component({\n  tag: 'igl-booking-event',\n  styleUrl: 'igl-booking-event.css',\n  scoped: true,\n})\nexport class IglBookingEvent {\n  @Element() private element: HTMLElement;\n\n  @Prop() currency;\n  @Prop() is_vacation_rental: boolean = false;\n  @Prop() language: string;\n  @Prop({ mutable: true }) bookingEvent: { [key: string]: any };\n  @Prop() allBookingEvents: { [key: string]: any } = [];\n  @Prop() countries: ICountry[];\n\n  @Event({ bubbles: true, composed: true }) hideBubbleInfo: EventEmitter;\n  @Event() updateEventData: EventEmitter;\n  @Event() dragOverEventData: EventEmitter;\n  @Event() showRoomNightsDialog: EventEmitter<IRoomNightsData>;\n  @Event() showDialog: EventEmitter<CalendarModalEvent>;\n  @Event() resetStretchedBooking: EventEmitter<string>;\n  @Event() toast: EventEmitter<IToast>;\n  @Event() updateBookingEvent: EventEmitter<{ [key: string]: any }>;\n\n  @State() renderElement: boolean = false;\n  @State() position: { [key: string]: any };\n  @State() isShrinking: boolean | null = null;\n\n  private dayWidth: number = 0;\n  private eventSpace: number = 8;\n\n  private vertSpace: number = 10;\n\n  /* show bubble */\n  private showInfoPopup: boolean = false;\n  private bubbleInfoTopSide: boolean = false;\n  private isStretch = false;\n  /*Services */\n  private eventsService = new EventsService();\n  private bookingService = new BookingService();\n  /* Resize props */\n  private resizeSide: string = '';\n  private isDragging: boolean = false;\n  private initialX: number;\n  private initialY: number;\n  private currentX: number;\n  private currentY: number;\n  private initialWidth: number;\n  private initialLeft: number;\n  private finalWidth: number;\n  private dragInitPos: { [key: string]: any };\n  private dragEndPos: { [key: string]: any };\n  elementRect: { [key: string]: any };\n  private isTouchStart: boolean;\n  private moveDifferenceX: number;\n  private moveDifferenceY: number;\n  private animationFrameId: number | null = null;\n\n  private handleMouseMoveBind = this.handleMouseMove.bind(this);\n  private handleMouseUpBind = this.handleMouseUp.bind(this);\n\n  private role: string = '';\n\n  componentWillLoad() {}\n\n  componentDidLoad() {\n    if (this.isNewEvent()) {\n      if (!this.bookingEvent.hideBubble) {\n        /* auto matically open the popup, calling the method shows bubble either top or bottom based on available space. */\n        setTimeout(async () => {\n          if (['003', '002', '004'].includes(this.bookingEvent.STATUS_CODE)) {\n            this.showEventInfo(true);\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\n            await this.fetchAndAssignBookingData();\n          } else {\n            this.showEventInfo(true);\n          }\n          this.renderAgain();\n        }, 1);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n    }\n  }\n\n  @Listen('hideBubbleInfo', { target: 'window' })\n  hideBubbleInfoPopup(event: CustomEvent) {\n    if (event.detail.currentInfoBubbleId != this.getBookingId() || (event.detail.key === 'hidebubble' && event.detail.currentInfoBubbleId === this.getBookingId())) {\n      this.showInfoPopup = false;\n      this.renderAgain();\n    }\n  }\n\n  @Listen('moveBookingTo', { target: 'window' })\n  async moveBookingToHandler(event: CustomEvent) {\n    try {\n      if (event.detail.bookingId !== this.getBookingId()) {\n        this.showEventInfo(false);\n        return;\n      }\n\n      if (event.detail.moveToDay === 'revert' || event.detail.toRoomId === 'revert') {\n        event.detail.moveToDay = this.bookingEvent.FROM_DATE;\n        event.detail.toRoomId = event.detail.fromRoomId;\n        if (this.isTouchStart && this.moveDifferenceX <= 5 && this.moveDifferenceY <= 5 && !this.isStretch) {\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\n            this.showEventInfo(true);\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\n            await this.fetchAndAssignBookingData();\n          }\n        } else {\n          this.animationFrameId = requestAnimationFrame(() => {\n            this.resetBookingToInitialPosition();\n          });\n          return;\n        }\n      } else {\n        if (this.isTouchStart && this.moveDifferenceX <= 5 && this.moveDifferenceY <= 5 && !this.isStretch) {\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\n            this.showEventInfo(true);\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\n            await this.fetchAndAssignBookingData();\n          }\n        } else {\n          const { pool, to_date, from_date, toRoomId } = event.detail as any;\n          const previousToDate = moment(to_date, 'YYYY-MM-DD').add(-1, 'days').format('YYYY-MM-DD');\n          console.log(this.findRoomType(Number(this.bookingEvent.PR_ID)), this.findRoomType(Number(toRoomId)));\n          if (\n            (!moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD').isSame(moment(to_date, 'YYYY-MM-DD'), 'dates') ||\n              this.findRoomType(Number(this.bookingEvent.PR_ID)) !== this.findRoomType(Number(toRoomId))) &&\n            (calendar_dates.disabled_cells.get(`${toRoomId}_${from_date}`)?.disabled ||\n              (calendar_dates.disabled_cells.get(`${toRoomId}_${to_date}`)?.disabled && calendar_dates.disabled_cells.get(`${toRoomId}_${previousToDate}`)?.disabled)) &&\n            !this.isStretch\n          ) {\n            this.reset('This room isnâ€™t available for the entire selected period. Please choose different dates or a different room.');\n          }\n          if (this.checkIfSlotOccupied(toRoomId, from_date, to_date)) {\n            this.reset('Overlapping Dates');\n          }\n          if (pool) {\n            if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\n              // let fromDate = moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(moment(new Date(from_date)))\n              //   ? this.bookingEvent.defaultDates.from_date\n              //   : from_date;\n              // console.log('room', fromDate, this.bookingEvent.defaultDates.from_date, from_date);\n              await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date).catch(() => {\n                this.resetBookingToInitialPosition();\n              });\n            } else {\n              if (this.isShrinking || !this.isStretch) {\n                // try {\n                //   if (this.bookingEvent.PR_ID.toString() === toRoomId.toString()) {\n                //     await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date);\n                //     return;\n                //   }\n                // } catch (error) {\n                //   this.resetBookingToInitialPosition();\n                //   return;\n                // }\n                const { description, status, newRatePlans } = this.getModalDescription(toRoomId, from_date, to_date);\n                let hideConfirmButton = false;\n                if (status === '400') {\n                  hideConfirmButton = true;\n                }\n                const oldFromDate = this.bookingEvent.defaultDates.from_date;\n                const oldToDate = this.bookingEvent.defaultDates.to_date;\n                const diffDays = calculateDaysBetweenDates(oldFromDate, oldToDate);\n\n                let shrinkingDirection = null;\n                let fromDate = oldFromDate;\n                let toDate = oldToDate;\n                if (this.isShrinking) {\n                  if (moment(from_date, 'YYYY-MM-DD').isAfter(moment(oldFromDate, 'YYYY-MM-DD')) && moment(to_date, 'YYYY-MM-DD').isBefore(moment(oldToDate, 'YYYY-MM-DD'))) {\n                    fromDate = oldFromDate;\n                    toDate = to_date;\n                  } else {\n                    shrinkingDirection = moment(from_date, 'YYYY-MM-DD').isAfter(moment(oldFromDate, 'YYYY-MM-DD'))\n                      ? 'left'\n                      : moment(to_date, 'YYYY-MM-DD').isBefore(moment(oldToDate, 'YYYY-MM-DD'))\n                      ? 'right'\n                      : null;\n                    if (shrinkingDirection === 'left') {\n                      fromDate = from_date;\n                    }\n\n                    if (shrinkingDirection === 'right') {\n                      toDate = to_date;\n                    }\n                  }\n                } else {\n                  console.log('stretching');\n                  if (moment(from_date, 'YYYY-MM-DD').isBefore(moment(oldFromDate, 'YYYY-MM-DD'))) {\n                    fromDate = from_date;\n                    const newToDate = moment(from_date, 'YYYY-MM-DD').add(diffDays, 'days');\n                    toDate = newToDate.isBefore(moment(to_date, 'YYYY-MM-DD'), 'days') ? to_date : newToDate.format('YYYY-MM-DD');\n                  } else if (moment(to_date, 'YYYY-MM-DD').isAfter(moment(oldToDate, 'YYYY-MM-DD'))) {\n                    toDate = to_date;\n                    fromDate = moment(to_date, 'YYYY-MM-DD').subtract(diffDays, 'days').format('YYYY-MM-DD');\n                  }\n                }\n                console.warn({ fromDate, toDate });\n                this.showDialog.emit({\n                  reason: 'reallocate',\n                  ...event.detail,\n                  description,\n                  title: '',\n                  rateplans: newRatePlans,\n                  hideConfirmButton,\n                  from_date: fromDate,\n                  to_date: toDate,\n                });\n              } else {\n                // if (this.checkIfSlotOccupied(toRoomId, from_date, to_date)) {\n                //   this.animationFrameId = requestAnimationFrame(() => {\n                //     this.resetBookingToInitialPosition();\n                //   });\n                //   throw new Error('Overlapping Dates');\n                // } else {\n\n                // let stretchDirection: \"left\" | \"right\"\n                const oldFromDate = this.bookingEvent.defaultDates.from_date;\n                const oldToDate = this.bookingEvent.defaultDates.to_date;\n                // const diffDays = calculateDaysBetweenDates(oldFromDate, oldToDate);\n\n                // let fromDate = oldFromDate;\n\n                // if (moment(from_date, 'YYYY-MM-DD').isBefore(moment(oldFromDate, 'YYYY-MM-DD'))) {\n                //   fromDate = from_date;\n                //   const newToDate = moment(from_date, 'YYYY-MM-DD').add(diffDays, 'days');\n                //   toDate = newToDate.isBefore(moment(to_date, 'YYYY-MM-DD'), 'days') ? to_date : newToDate.format('YYYY-MM-DD');\n                // } else if (moment(to_date, 'YYYY-MM-DD').isAfter(moment(oldToDate, 'YYYY-MM-DD'))) {\n                //   toDate = to_date;\n                //   fromDate = moment(to_date, 'YYYY-MM-DD').subtract(diffDays, 'days').format('YYYY-MM-DD');\n                // }\n                const validateDates = (base_date: string, to_date: string) => {\n                  let cursor = base_date;\n                  let counter = 0;\n                  while (cursor !== to_date) {\n                    if (calendar_dates.disabled_cells.get(`${toRoomId}_${cursor}`)?.disabled) {\n                      counter++;\n                    }\n                    cursor = moment(cursor, 'YYYY-MM-DD').add(1, 'days').format('YYYY-MM-DD');\n                  }\n                  if (counter >= 1) {\n                    this.reset(locales.entries.Lcz_ThisUnitIsNotAvailable);\n                  }\n                };\n\n                if (moment(oldToDate, 'YYYY-MM-DD').isBefore(moment(to_date), 'dates')) {\n                  validateDates(oldToDate, to_date);\n                } else if (moment(oldFromDate, 'YYYY-MM-DD').isAfter(moment(from_date, 'YYYY-MM-DD'), 'dates')) {\n                  validateDates(from_date, oldFromDate);\n                }\n                const payload: IRoomNightsData = {\n                  booking: this.bookingEvent,\n                  bookingNumber: this.bookingEvent.BOOKING_NUMBER,\n                  identifier: this.bookingEvent.IDENTIFIER,\n                  to_date,\n                  pool,\n                  from_date,\n                  defaultDates: this.bookingEvent.defaultDates,\n                };\n                if (!this.bookingEvent.is_direct) {\n                  this.showDialog.emit({ reason: 'stretch', ...payload });\n                } else {\n                  this.showRoomNightsDialog.emit(payload);\n                }\n                // }\n              }\n            }\n            this.isShrinking = null;\n          }\n        }\n      }\n    } catch (error) {\n      this.toast.emit({\n        position: 'top-right',\n        title: error.message,\n        description: '',\n        type: 'error',\n      });\n      console.log('something went wrong');\n    }\n  }\n\n  @ClickOutside()\n  closeEventBubble() {\n    this.showEventInfo(false);\n  }\n  private async fetchAndAssignBookingData() {\n    try {\n      console.log('clicked on book#', this.bookingEvent.BOOKING_NUMBER);\n\n      const validStatuses = ['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'];\n      if (!validStatuses.includes(this.bookingEvent.STATUS)) {\n        return;\n      }\n\n      const data = await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER, 'en');\n      const base_booking = { ...data };\n      const filteredRooms = data.rooms.filter(room => room['assigned_units_pool'] === this.bookingEvent.ID);\n\n      if (filteredRooms.length === 0) {\n        throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty array`);\n      }\n\n      if (filteredRooms.some(room => room['assigned_units_pool'] === null)) {\n        throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty pool`);\n      }\n\n      data.rooms = filteredRooms;\n\n      const transformedBooking = transformNewBooking(data)[0];\n      const {\n        ID,\n        TO_DATE,\n        FROM_DATE,\n        NO_OF_DAYS,\n        STATUS,\n        NAME,\n        IDENTIFIER,\n        origin,\n        TOTAL_PRICE,\n        PR_ID,\n        POOL,\n        BOOKING_NUMBER,\n        NOTES,\n        is_direct,\n        BALANCE,\n        channel_booking_nbr,\n        ...otherBookingData\n      } = transformedBooking;\n      this.bookingEvent = {\n        ...otherBookingData,\n        ...this.bookingEvent,\n        channel_booking_nbr,\n        booking: data,\n        base_booking,\n        DEPARTURE_TIME: otherBookingData.DEPARTURE_TIME,\n        PHONE: otherBookingData.PHONE,\n        PHONE_PREFIX: otherBookingData.PHONE_PREFIX,\n        PRIVATE_NOTE: otherBookingData.PRIVATE_NOTE,\n        origin,\n        BALANCE,\n        TOTAL_PRICE,\n        ROOM_INFO: { ...this.bookingEvent.ROOM_INFO, sharing_persons: otherBookingData.ROOM_INFO.sharing_persons },\n      };\n      this.updateBookingEvent.emit(this.bookingEvent);\n      this.showEventInfo(true);\n    } catch (error) {\n      console.error(error.message);\n    }\n  }\n\n  private reset(message: string) {\n    this.animationFrameId = requestAnimationFrame(() => {\n      this.resetBookingToInitialPosition();\n    });\n    throw new Error(message);\n  }\n\n  private findRoomType = (roomId: number) => {\n    let roomType = this.bookingEvent.roomsInfo.filter(room => room.physicalrooms.some(r => r.id === +roomId));\n    if (roomType.length) {\n      return roomType[0].id;\n    }\n    return null;\n  };\n\n  private buildBarIds() {\n    const bookingId = this.getBookingId();\n    return {\n      bar: `event_${bookingId}`,\n      lateCheckout: `event_late_checkout_${bookingId}`,\n      balance: `event_balance_${bookingId}`,\n    };\n  }\n\n  private getModalDescription(toRoomId: number, from_date, to_date): { status: '200' | '400'; description: string; newRatePlans?: any[] } {\n    if (!this.bookingEvent.is_direct) {\n      if (this.isShrinking) {\n        return {\n          description: locales.entries.Lcz_OTA_Modification_Alter,\n          status: '200',\n        };\n        // return {\n        //   description: `${locales.entries.Lcz_YouWillLoseFutureUpdates}.`,\n        //   status: '200',\n        // };\n      } else {\n        if (\n          moment(from_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.FROM_DATE, 'YYYY-MM-DD')) &&\n          moment(to_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD'))\n        ) {\n          const initialRT = this.findRoomType(this.bookingEvent.PR_ID);\n          const targetRT = this.findRoomType(toRoomId);\n          if (initialRT === targetRT) {\n            return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\n          } else {\n            const mealPlans = checkMealPlan({\n              rateplan_id: this.bookingEvent.RATE_PLAN_ID,\n              roomTypeId: targetRT,\n              roomTypes: calendar_data?.property?.roomtypes,\n            });\n            return {\n              description: locales.entries.Lcz_OTA_Modification_Alter,\n              status: '200',\n              newRatePlans: Array.isArray(mealPlans) ? mealPlans : undefined,\n            };\n            // return {\n            //   description: `${locales.entries.Lcz_YouWillLoseFutureUpdates} ${this.bookingEvent.origin ? this.bookingEvent.origin.Label : ''}. ${\n            //     locales.entries.Lcz_SameRatesWillBeKept + '.'\n            //   }`,\n            //   status: '200',\n            // };\n          }\n        }\n        return { description: locales.entries.Lcz_CannotChangeCHBookings + '.', status: '400' };\n      }\n    } else {\n      if (!this.isShrinking) {\n        const initialRT = this.findRoomType(Number(this.bookingEvent.PR_ID));\n        const targetRT = this.findRoomType(Number(toRoomId));\n        if (initialRT === targetRT) {\n          console.log('same rt');\n          if (this.bookingEvent.PR_ID.toString() === toRoomId.toString()) {\n            //TODO add the description\n            return { description: locales.entries.Lcz_ConfrmModiication + '.', status: '200' };\n          }\n          return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\n        } else {\n          const mealPlans = checkMealPlan({\n            rateplan_id: this.bookingEvent.RATE_PLAN_ID,\n            roomTypeId: targetRT,\n            roomTypes: calendar_data?.property?.roomtypes,\n          });\n\n          return {\n            description: locales.entries.Lcz_SameRatesWillBeKept,\n            status: '200',\n            newRatePlans: Array.isArray(mealPlans) ? mealPlans : undefined,\n          };\n        }\n      }\n      return { description: locales.entries.Lcz_ConfrmModiication + '.', status: '200' };\n    }\n  }\n\n  private resetBookingToInitialPosition() {\n    if (this.isStretch) {\n      this.element.style.left = `${this.initialLeft}px`;\n      this.element.style.width = `${this.initialWidth}px`;\n      this.isStretch = false;\n      this.finalWidth = this.initialWidth;\n      this.isShrinking = null;\n    } else {\n      this.element.style.top = `${this.dragInitPos.top}px`;\n      this.element.style.left = `${this.dragInitPos.left}px`;\n    }\n  }\n\n  @Listen('revertBooking', { target: 'window' })\n  handleRevertBooking(event: CustomEvent<string>) {\n    if (this.bookingEvent.POOL === event.detail) {\n      this.resetBookingToInitialPosition();\n    }\n  }\n\n  /**\n   * Checks if the target room already has a booking overlapping the given date range.\n   *\n   * @param toRoomId   - Room ID to check.\n   * @param from_date  - Start date (YYYY-MM-DD).\n   * @param to_date    - End date (YYYY-MM-DD).\n   * @returns `true` if another booking occupies the slot, otherwise `false`.\n   */\n  private checkIfSlotOccupied(toRoomId: number, from_date: string, to_date: string) {\n    const fromTime = moment(from_date, 'YYYY-MM-DD');\n    const toTime = moment(to_date, 'YYYY-MM-DD');\n    const isOccupied = this.allBookingEvents.some(event => {\n      if (event.POOL === this.bookingEvent.POOL) {\n        return false;\n      }\n      const eventFromTime = moment(event.FROM_DATE, 'YYYY-MM-DD').add(1, 'days');\n      const eventToTime = moment(event.TO_DATE, 'YYYY-MM-DD');\n      return event.PR_ID === +toRoomId && toTime.isSameOrAfter(eventFromTime) && fromTime.isBefore(eventToTime);\n    });\n    return isOccupied;\n  }\n\n  renderAgain() {\n    this.renderElement = !this.renderElement;\n  }\n\n  getUniqueId() {\n    return new Date().getTime();\n  }\n\n  isSplitBooking() {\n    return !!this.bookingEvent.SPLIT_BOOKING;\n  }\n\n  isNewEvent() {\n    return this.getBookingId() === 'NEW_TEMP_EVENT';\n  }\n\n  isHighlightEventType() {\n    return this.getEventType() === 'HIGH_LIGHT';\n  }\n\n  getBookingId() {\n    return this.bookingEvent.ID;\n  }\n\n  getBookingStatus() {\n    return this.bookingEvent.STATUS;\n  }\n\n  getBookedBy() {\n    return this.bookingEvent.NAME;\n  }\n\n  getBookedRoomId() {\n    return this.bookingEvent.PR_ID;\n  }\n\n  getEventStartingDate() {\n    return new Date(this.bookingEvent.FROM_DATE);\n  }\n\n  getEventEndingDate() {\n    return new Date(this.bookingEvent.TO_DATE);\n  }\n\n  getEventType() {\n    return this.bookingEvent.event_type;\n  }\n\n  getEventLegend() {\n    // console.log(this.getBookingStatus());\n    let status = this.bookingEvent?.legendData.statusId[this.getBookingStatus()];\n    let orderRide = this.isNewEvent() ? { color: '#f9f9c9' } : {};\n    return {\n      ...this.bookingEvent?.legendData[status.id],\n      ...status,\n      ...orderRide,\n    };\n  }\n\n  getLegendOfStatus(aStatusId) {\n    // console.log(aStatusId);\n    let status = this.bookingEvent?.legendData.statusId[aStatusId];\n    return { ...this.bookingEvent.legendData[status.id], ...status };\n  }\n\n  getNoteNode() {\n    if (this.bookingEvent.NOTES || this.bookingEvent.INTERNAL_NOTE || this.bookingEvent.PRIVATE_NOTE) {\n      return this.getLegendOfStatus('NOTES');\n    }\n    return null;\n  }\n\n  getBalanceNode() {\n    if (this.bookingEvent.BALANCE !== null && this.bookingEvent.BALANCE >= 1) {\n      return this.getLegendOfStatus('OUTSTANDING-BALANCE');\n    }\n    return null;\n  }\n\n  setStayDays(aStayDays: number) {\n    this.bookingEvent.NO_OF_DAYS = aStayDays;\n    this.renderAgain();\n    // this.updateData({id: this.getBookedRoomId(), data: { NO_OF_DAYS: aStayDays }});\n  }\n\n  getStayDays() {\n    return this.bookingEvent.NO_OF_DAYS;\n  }\n  /**\n   * Calculates the booking bar position and width in the calendar grid.\n   *\n   * @returns {{ top: string; left: string; width: string; height: string }}\n   *          Inline style values used to place the event.\n   */\n  private getPosition(): BarPosition {\n    let startingDate = this.getEventStartingDate();\n    let startingCellClass = '.room_' + this.getBookedRoomId() + '_' + startingDate.getDate() + '_' + (startingDate.getMonth() + 1) + '_' + startingDate.getFullYear();\n    let bodyContainer = document.querySelector('.bodyContainer');\n    let startingCell = document.querySelector(startingCellClass);\n    let pos = { top: '0', left: '0', width: '0', height: '20px' };\n\n    if (!startingCell && bodyContainer && startingCell.getBoundingClientRect() && bodyContainer.getBoundingClientRect()) {\n      console.warn('Failed to locate event cell', startingCellClass, this.bookingEvent);\n      return pos;\n    }\n    let bodyContainerRect = bodyContainer.getBoundingClientRect();\n    let boundingRect = startingCell.getBoundingClientRect();\n    this.dayWidth = this.dayWidth || boundingRect.width;\n    pos.top = boundingRect.top + boundingRect.height / 2 - this.vertSpace - bodyContainerRect.top + 'px';\n    // pos.left = boundingRect.left + this.dayWidth / 2 + this.eventSpace / 2 - bodyContainerRect.left + 'px';\n    // pos.width = this.getStayDays() * this.dayWidth - this.eventSpace + 'px';\n    pos.left =\n      boundingRect.left +\n      (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 0 : this.dayWidth / 2) +\n      this.eventSpace / 2 -\n      bodyContainerRect.left +\n      'px';\n    pos.width =\n      (this.getStayDays() + (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 0.5 : 0)) *\n        this.dayWidth -\n      this.eventSpace +\n      'px';\n    return pos;\n  }\n\n  private getNumber(aData: string) {\n    return aData ? parseFloat(aData) : 0;\n  }\n\n  startDragging(event: any, side: string) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n\n    if (this.isNewEvent() || this.isHighlightEventType()) {\n      return null;\n    }\n\n    this.resizeSide = side;\n    this.isDragging = true;\n\n    this.showEventInfo(false);\n    this.isStretch = side !== 'move';\n    if (side === 'move') {\n      this.initialX = event.clientX || event.touches[0].clientX;\n      this.initialY = event.clientY || event.touches[0].clientY;\n      this.elementRect = this.element.getBoundingClientRect();\n      const offsetX = 0;\n      const offsetY = 0;\n      this.dragInitPos = {\n        id: this.getBookingId(),\n        fromRoomId: this.getBookedRoomId(),\n        top: this.getNumber(this.element.style.top) + offsetY,\n        left: this.getNumber(this.element.style.left) + offsetX,\n      };\n      this.dragInitPos.x = this.dragInitPos.left;\n      this.dragInitPos.y = this.dragInitPos.top;\n      this.dragEndPos = { ...this.dragInitPos };\n      this.element.style.top = `${this.dragInitPos.top}px`;\n      this.element.style.left = `${this.dragInitPos.left}px`;\n      this.isTouchStart = true; // !!(event.touches && event.touches.length);\n      this.dragOverEventData.emit({\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\n        data: this.dragInitPos,\n      });\n    } else {\n      this.initialWidth = this.element.offsetWidth;\n      this.initialLeft = this.element.offsetLeft;\n      this.initialX = event.clientX || event.touches[0].clientX;\n      this.dragOverEventData.emit({\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\n        data: {\n          id: this.getBookingId(),\n          fromRoomId: this.getBookedRoomId(),\n          top: this.getNumber(this.element.style.top),\n          left: this.initialLeft,\n          x: this.initialX,\n          y: event.clientY || event.touches[0].clientY,\n        },\n      });\n    }\n\n    document.addEventListener('mousemove', this.handleMouseMoveBind);\n    document.addEventListener('touchmove', this.handleMouseMoveBind);\n    document.addEventListener('pointermove', this.handleMouseMoveBind);\n\n    document.addEventListener('mouseup', this.handleMouseUpBind);\n    document.addEventListener('touchup', this.handleMouseUpBind);\n    document.addEventListener('pointerup', this.handleMouseUpBind);\n  }\n\n  handleMouseMove(event: any) {\n    if (this.isDragging) {\n      this.currentX = event.clientX || event.touches[0].clientX;\n      let distanceX = this.currentX - this.initialX;\n      if (this.resizeSide === 'move') {\n        this.currentY = event.clientY || event.touches[0].clientY;\n        let distanceY = this.currentY - this.initialY;\n        this.element.style.top = `${this.dragInitPos.top + distanceY}px`;\n        this.element.style.left = `${this.dragInitPos.left + distanceX}px`;\n        this.dragEndPos = {\n          id: this.getBookingId(),\n          fromRoomId: this.getBookedRoomId(),\n          top: this.dragInitPos.top + distanceY,\n          left: this.dragInitPos.left + distanceX,\n        };\n        this.dragEndPos.x = this.dragEndPos.left; // + 18;\n        this.dragEndPos.y = this.dragEndPos.top; // + (this.elementRect.height/2);\n        this.dragOverEventData.emit({ id: 'DRAG_OVER', data: this.dragEndPos });\n      } else {\n        // if (this.bookingEvent.is_direct && !isBlockUnit(this.bookingEvent.STATUS_CODE)) {\n        //   return;\n        // }\n        if (this.role === 'fullSplit') {\n          return;\n        }\n        const baseCondition = !this.bookingEvent.is_direct && !isBlockUnit(this.bookingEvent.STATUS_CODE);\n        let newWidth = this.initialWidth;\n        if (this.resizeSide == 'rightSide') {\n          newWidth = this.initialWidth + distanceX;\n          newWidth = Math.min(newWidth, this.initialX + this.element.offsetWidth);\n          newWidth = Math.max(this.dayWidth - this.eventSpace, newWidth);\n          this.isShrinking = distanceX < 0;\n          if (!this.isShrinking && baseCondition) {\n            return;\n          }\n          if (this.role === 'rightSplit') {\n            return;\n          }\n          this.element.style.width = `${newWidth}px`;\n        } else if (this.resizeSide == 'leftSide') {\n          this.isShrinking = distanceX > 0;\n          if (!this.isShrinking && baseCondition) {\n            return;\n          }\n          if (this.role === 'leftSplit') {\n            return;\n          }\n          newWidth = Math.max(this.dayWidth - this.eventSpace, this.initialWidth - distanceX);\n          let newLeft = this.initialLeft + (this.initialWidth - newWidth);\n          this.element.style.left = `${newLeft}px`;\n          this.element.style.width = `${newWidth}px`;\n        }\n        this.finalWidth = newWidth;\n      }\n    } else {\n      console.log('still mouse move listening...');\n    }\n  }\n\n  handleMouseUp() {\n    if (this.isDragging) {\n      if (this.resizeSide === 'move') {\n        // console.log(\"Initial X::\"+this.dragInitPos.x);\n        // console.log(\"Initial Y::\"+this.dragInitPos.y);\n        // console.log(\"End X::\"+this.dragEndPos.x);\n        // console.log(\"End Y::\"+this.dragEndPos.y);\n        if (this.isTouchStart) {\n          this.moveDifferenceX = Math.abs(this.dragEndPos.x - this.dragInitPos.x);\n          this.moveDifferenceY = Math.abs(this.dragEndPos.y - this.dragInitPos.y);\n        }\n        this.dragOverEventData.emit({\n          id: 'DRAG_OVER_END',\n          data: {\n            ...this.dragEndPos,\n            pool: this.bookingEvent.POOL,\n            nbOfDays: this.bookingEvent.NO_OF_DAYS,\n          },\n        });\n      } else {\n        const finalWidth =\n          this.finalWidth -\n          (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? this.dayWidth / 2 : 0);\n        const numberOfDays = Math.round(finalWidth / this.dayWidth);\n        console.log(finalWidth, this.dayWidth, numberOfDays);\n        let initialStayDays = this.getStayDays();\n        if (initialStayDays != numberOfDays && !isNaN(numberOfDays)) {\n          //this.setStayDays(numberOfDays);\n          if (this.resizeSide == 'leftSide') {\n            this.element.style.left = `${this.initialLeft + (initialStayDays - numberOfDays) * this.dayWidth}px`;\n            // set FROM_DATE = TO_DATE - numberOfDays\n          } else {\n            if (numberOfDays < initialStayDays) {\n              this.isShrinking = true;\n            }\n            // set TO_DATE = FROM_DATE + numberOfDays\n          }\n          // const nbrOfDays =\n          // !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? numberOfDays - 1 : numberOfDays;\n          this.dragOverEventData.emit({\n            id: 'STRETCH_OVER_END',\n            data: {\n              id: this.getBookingId(),\n              fromRoomId: +this.getBookedRoomId(),\n              x: +this.element.style.left.replace('px', ''),\n              y: +this.element.style.top.replace('px', ''),\n              pool: this.bookingEvent.POOL,\n              nbOfDays: numberOfDays,\n            },\n          });\n          const offset = !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? +this.dayWidth / 2 : 0;\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace + offset}px`;\n        } else {\n          this.element.style.left = `${this.initialLeft}px`;\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace}px`;\n        }\n      }\n    } else {\n      console.log('still mouse up listening...');\n    }\n    this.isDragging = false;\n\n    document.removeEventListener('mousemove', this.handleMouseMoveBind);\n    document.removeEventListener('touchmove', this.handleMouseMoveBind);\n    document.removeEventListener('pointermove', this.handleMouseMoveBind);\n\n    document.removeEventListener('mouseup', this.handleMouseUpBind);\n    document.removeEventListener('touchup', this.handleMouseUpBind);\n    document.removeEventListener('pointerup', this.handleMouseUpBind);\n  }\n\n  updateData(data: any) {\n    this.updateEventData.emit(data);\n  }\n  private calculateHoverPosition() {\n    const barRect = this.element.getBoundingClientRect();\n    const barWidth = barRect.width;\n    const barLeft = barRect.left;\n    const screenWidth = window.innerWidth;\n\n    let hoverLeft;\n\n    if (barWidth <= screenWidth) {\n      hoverLeft = barWidth / 2;\n    } else {\n      hoverLeft = screenWidth / 2 - barLeft;\n    }\n    return {\n      position: 'absolute',\n      left: `${hoverLeft}px`,\n      transform: 'translateX(-50%)',\n    };\n  }\n  private renderEventBookingNumber() {\n    if (this.bookingEvent.STATUS === 'TEMP-EVENT' || this.bookingEvent.ID === 'NEW_TEMP_EVENT') {\n      return '';\n    }\n    if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\n      return '';\n    }\n    if (!this.bookingEvent.is_direct) {\n      return ` - ${this.bookingEvent.channel_booking_nbr}`;\n    }\n    return ` - ${this.bookingEvent.BOOKING_NUMBER}`;\n  }\n\n  private showEventInfo(showInfo: boolean) {\n    if (this.isHighlightEventType() || this.bookingEvent.hideBubble) {\n      return null;\n    }\n\n    if (showInfo) {\n      // Calculate which side we need to show the bubble, top side or bottom.\n      let bodyContainer = document.querySelector('.calendarScrollContainer');\n      let bodyContainerRect: { [key: string]: any } = bodyContainer.getBoundingClientRect();\n      let elementRect: { [key: string]: any } = this.element.getBoundingClientRect();\n      let midPoint = bodyContainerRect.height / 2 + bodyContainerRect.top + 50;\n\n      if (elementRect.top < midPoint) {\n        this.bubbleInfoTopSide = false;\n      } else {\n        this.bubbleInfoTopSide = true;\n      }\n    }\n\n    if (showInfo) {\n      this.hideBubbleInfo.emit({\n        key: 'hidePopup',\n        currentInfoBubbleId: this.getBookingId(),\n      });\n    }\n    this.showInfoPopup = showInfo;\n    this.renderAgain();\n  }\n\n  /**\n   * Checks if the booking's departure time is later than the hotel's configured check-out time.\n   *\n   * @returns {boolean} `true` if departure is after `check_out_till`, otherwise `false`.\n   */\n  private isDepartureAfterHotelCheckout(): boolean {\n    const departureTime = this.bookingEvent.DEPARTURE_TIME;\n    if (!departureTime?.code) {\n      return false;\n    }\n    const t1 = moment(calendar_data.property.time_constraints.check_out_till, 'HH:mm');\n    const t2 = moment(departureTime.description, 'HH:mm');\n    return t1.isBefore(t2);\n  }\n  private computeSplitRole() {\n    const SPLIT_INDEX = buildSplitIndex(this.bookingEvent.ROOMS);\n    let splitRole = null;\n    if (SPLIT_INDEX) {\n      splitRole = getSplitRole(SPLIT_INDEX, this.bookingEvent.IDENTIFIER) ?? '';\n    }\n    return splitRole;\n  }\n\n  render() {\n    let legend = this.getEventLegend();\n\n    let noteNode = this.getNoteNode();\n    let balanceNode = this.getBalanceNode();\n\n    let backgroundColor = this.bookingEvent.ROOM_INFO?.calendar_extra ? this.bookingEvent.ROOM_INFO.calendar_extra?.booking_color?.color ?? legend.color : legend.color;\n\n    const { foreground, stripe } = calendar_data.colorsForegrounds?.[backgroundColor] ?? {\n      foreground: '',\n      checkout: '',\n    };\n    backgroundColor = this.bookingEvent.STATUS === 'CHECKED-OUT' ? legend.color : backgroundColor;\n    const isDepartureAfterHotelCheckout = this.isDepartureAfterHotelCheckout();\n    const { balance, bar, lateCheckout } = this.buildBarIds();\n    const splitRole = this.computeSplitRole();\n\n    return (\n      <Host class={`bookingEvent  ${this.isNewEvent() || this.isHighlightEventType() ? 'newEvent' : ''} ${legend.clsName} `} style={this.getPosition()} id={bar}>\n        <div\n          class={{\n            'bookingEventBase': true,\n            'skewedLeft': !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)),\n            'skewedRight': !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)),\n            'striped-bar vertical': this.bookingEvent.STATUS === 'IN-HOUSE',\n            'striped-bar animated': isBlockUnit(this.bookingEvent.STATUS_CODE) && this.bookingEvent.STATUS_CODE === '003',\n            'border border-dark ota-booking-event':\n              !this.bookingEvent.is_direct && !isBlockUnit(this.bookingEvent.STATUS_CODE) && this.bookingEvent.STATUS !== 'TEMP-EVENT' && this.bookingEvent.ID !== 'NEW_TEMP_EVENT',\n            [splitRole]: true,\n          }}\n          style={{\n            'backgroundColor': backgroundColor,\n            '--ir-event-bg': backgroundColor,\n            '--ir-event-bg-stripe-color': stripe,\n          }}\n          onTouchStart={event => this.startDragging(event, 'move')}\n          onMouseDown={event => this.startDragging(event, 'move')}\n        ></div>\n        {isDepartureAfterHotelCheckout && <wa-tooltip for={lateCheckout}>Departure time: {this.bookingEvent.DEPARTURE_TIME?.description}</wa-tooltip>}\n        {balanceNode && <wa-tooltip for={balance}>Balance: {formatAmount(calendar_data.property.currency.symbol, this.bookingEvent.BALANCE)}</wa-tooltip>}\n        {noteNode ? <div class=\"legend_circle noteIcon\" style={{ backgroundColor: noteNode.color }}></div> : null}\n        {(balanceNode || isDepartureAfterHotelCheckout) && (\n          <div class=\"balanceIcon d-flex\">\n            {isDepartureAfterHotelCheckout && <div id={lateCheckout} class=\"legend_circle\" style={{ backgroundColor: '#999999' }}></div>}\n            {balanceNode ? <div id={balance} class=\"legend_circle\" style={{ backgroundColor: '#f34752' }}></div> : null}\n          </div>\n        )}\n\n        <div\n          class=\"bookingEventTitle\"\n          style={{ color: foreground }}\n          onTouchStart={event => this.startDragging(event, 'move')}\n          onMouseDown={event => this.startDragging(event, 'move')}\n        >\n          {this.getBookedBy()}\n          {this.renderEventBookingNumber()}\n        </div>\n        <Fragment>\n          <div\n            class={`bookingEventDragHandle leftSide ${\n              !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 'skewedLeft' : ''\n            }\n            ${!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)) ? 'skewedRight' : ''}`}\n            onTouchStart={event => this.startDragging(event, 'leftSide')}\n            onMouseDown={event => this.startDragging(event, 'leftSide')}\n          ></div>\n          <div\n            class={`bookingEventDragHandle rightSide ${\n              !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 'skewedLeft' : ''\n            }\n              ${!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)) ? 'skewedRight' : ''}`}\n            onTouchStart={event => this.startDragging(event, 'rightSide')}\n            onMouseDown={event => this.startDragging(event, 'rightSide')}\n          ></div>\n        </Fragment>\n\n        {this.showInfoPopup ? (\n          <igl-booking-event-hover\n            is_vacation_rental={this.is_vacation_rental}\n            countries={this.countries}\n            currency={this.currency}\n            class=\"top\"\n            bookingEvent={this.bookingEvent}\n            bubbleInfoTop={this.bubbleInfoTopSide}\n            style={this.calculateHoverPosition()}\n          ></igl-booking-event-hover>\n        ) : null}\n      </Host>\n    );\n  }\n}\n","export class ReloadInterceptor {\n  private isActive = false;\n  private readonly onIntercept: () => void;\n\n  /**\n   * @param onIntercept\n   *   Called whenever a reload is intercepted (F5/Ctrl+R or beforeunload).\n   * @param autoActivate\n   *   If true, will immediately attach listeners.\n   */\n  constructor(options: { onIntercept?: () => void; autoActivate: boolean }) {\n    this.onIntercept = options.onIntercept ?? (() => {});\n    if (options.autoActivate) {\n      this.activate();\n    }\n  }\n\n  /** Begin intercepting reloads & navigations */\n  public activate(): void {\n    if (this.isActive) return;\n    window.addEventListener('beforeunload', this.handleBeforeUnload, { capture: true });\n    this.isActive = true;\n  }\n\n  /** Stop intercepting reloads & navigations */\n  public deactivate(): void {\n    if (!this.isActive) return;\n    window.removeEventListener('beforeunload', this.handleBeforeUnload, { capture: true });\n    this.isActive = false;\n  }\n\n  /** Native â€œAre you sure you want to leave?â€ dialog */\n  private handleBeforeUnload = (e: BeforeUnloadEvent): void => {\n    this.onIntercept();\n    e.preventDefault();\n    e.returnValue = '';\n  };\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 0%;\n  height: 100%;\n}\n.bulk-sheet-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  gap: 1rem;\n}\n.animated-container {\n  transition: all 0.5s ease;\n}\n.physical-room {\n  margin-left: 1rem !important;\n  padding-top: 0.5rem;\n}\n/* target only the last <td> in each .physical-room row */\n.physical-room > td:last-child {\n  padding-left: 1rem; /* or whatever indent you like */\n}\n.room-type-list {\n  padding: 0;\n  margin: 0;\n}\n\n.room-type-list > li,\n.physical-room,\n.room-type-row {\n  list-style: none;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { BookingService } from '@/services/booking-service/booking.service';\nimport calendar_data from '@/stores/calendar-data';\nimport { ReloadInterceptor } from '@/utils/ReloadInterceptor';\nimport { Component, Event, EventEmitter, Fragment, h, Prop, State } from '@stencil/core';\nimport moment, { Moment } from 'moment';\nimport { z, ZodError } from 'zod';\nimport { IToast } from '@components/ui/ir-toast/toast';\n// import calendar_dates from '@/stores/calendar-dates.store';\nimport locales from '@/stores/locales.store';\nexport type RoomStatus = 'open' | 'closed';\nexport type SelectedRooms = {\n  id: string | number;\n  result: RoomStatus;\n};\n\n@Component({\n  tag: 'igl-bulk-block',\n  styleUrls: ['igl-bulk-block.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBulkBlock {\n  @Prop() maxDatesLength = 8;\n  @Prop() property_id: number;\n\n  @State() selectedRoomTypes: Map<string | number, SelectedRooms[]> = new Map();\n  @State() selectedUnit: {\n    roomtype_id: number;\n    unit_id: number;\n  } | null = null;\n  @State() errors: 'dates' | 'rooms';\n  @State() isLoading: boolean;\n  @State() blockState: 'block' | 'unblock' = 'block';\n  @State() dates: {\n    from: Moment | null;\n    to: Moment | null;\n  }[] = [{ from: null, to: null }];\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() toast: EventEmitter<IToast>;\n\n  private sidebar: HTMLIrSidebarElement;\n  private dateRefs: { from?: HTMLIrDatePickerElement; to?: HTMLIrDatePickerElement }[] = [];\n  private reloadInterceptor: ReloadInterceptor;\n  private minDate = moment().format('YYYY-MM-DD');\n  private bookingService = new BookingService();\n\n  private datesSchema = z.array(\n    z.object({\n      from: z\n        .any()\n        .refine((val): val is Moment => moment.isMoment(val), {\n          message: \"Invalid 'from' date; expected a Moment object.\",\n        })\n        .transform((val: Moment) => val.format('YYYY-MM-DD')),\n      to: z\n        .any()\n        .refine((val): val is Moment => moment.isMoment(val), {\n          message: \"Invalid 'to' date; expected a Moment object.\",\n        })\n        .transform((val: Moment) => val.format('YYYY-MM-DD')),\n    }),\n  );\n\n  private unitSections: HTMLUListElement;\n  private datesSections: HTMLTableElement;\n\n  componentDidLoad() {\n    this.reloadInterceptor = new ReloadInterceptor({ autoActivate: false });\n    this.sidebar = document.querySelector('ir-sidebar') as HTMLIrSidebarElement;\n  }\n\n  disconnectedCallback() {\n    this.reloadInterceptor.deactivate();\n  }\n\n  private async addBlockDates() {\n    try {\n      this.errors = null;\n      this.isLoading = true;\n      const periods = this.datesSchema.parse(this.dates);\n      if (!this.selectedUnit) {\n        this.unitSections.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        this.errors = 'rooms';\n        return;\n      }\n      if (this.blockState === 'block') {\n        await this.bookingService.blockAvailabilityForBrackets({\n          unit_id: this.selectedUnit?.unit_id,\n          description: '',\n          property_id: calendar_data.property.id,\n          block_status_code: '002',\n          brackets: periods.map(p => ({\n            from_date: p.from,\n            to_date: p.to,\n          })),\n        });\n      } else {\n        await this.bookingService.unBlockUnitByPeriod({\n          unit_id: this.selectedUnit?.unit_id,\n          from_date: periods[0].from,\n          to_date: periods[0].to,\n        });\n      }\n      this.activate();\n      this.deactivate();\n      this.toast.emit({\n        type: 'success',\n        title: locales.entries.Lcz_RequestSubmittedSuccessfully,\n        description: '',\n      });\n      this.isLoading = false;\n      this.closeModal.emit();\n    } catch (error) {\n      console.log(error);\n      if (error instanceof ZodError) {\n        this.datesSections.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        this.errors = 'dates';\n      }\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private activate() {\n    this.reloadInterceptor.activate();\n    if (this.sidebar) this.sidebar.preventClose = true;\n  }\n\n  private deactivate() {\n    this.reloadInterceptor.deactivate();\n    if (this.sidebar) this.sidebar.preventClose = false;\n  }\n\n  private handleDateChange({ index, date, key }: { index: number; date: Moment; key: 'from' | 'to' }) {\n    // 1) clone and set the new date\n    const dates = [...this.dates];\n    dates[index] = { ...dates[index], [key]: date };\n\n    // 1a) if they just changed the \"from\", always clear that row's \"to\"\n    if (key === 'from' && dates[index].to?.isBefore(date, 'dates')) {\n      dates[index].to = null;\n    }\n\n    // 2) clear any subsequent rows whose \"from\" is on or before the changed date\n    for (let i = index + 1; i < dates.length; i++) {\n      const rowFrom = dates[i]?.from;\n      if (rowFrom && rowFrom.isSameOrBefore(date, 'day')) {\n        dates[i] = { from: null, to: null };\n      }\n    }\n\n    // 3) commit\n    this.dates = dates;\n\n    // 4) open the appropriate picker\n    setTimeout(() => {\n      if (key === 'from') {\n        this.dateRefs[index]?.to.openDatePicker();\n      } else {\n        const nextFrom = dates.findIndex(d => d.from === null);\n        if (nextFrom > -1) {\n          this.dateRefs[nextFrom]?.from.openDatePicker();\n        }\n      }\n    }, 100);\n  }\n\n  private addDateRow() {\n    const last_dates = this.dates[this.dates.length - 1];\n    if (!last_dates.from || !last_dates.to) {\n      this.errors = 'dates';\n      return;\n    }\n    this.errors = null;\n    this.dates = [...this.dates, { from: null, to: null }];\n    setTimeout(() => {\n      this.dateRefs[this.dates.length - 1].to?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }, 100);\n  }\n\n  render() {\n    return (\n      <form\n        class={'bulk-sheet-container'}\n        onSubmit={e => {\n          e.preventDefault();\n          this.addBlockDates();\n        }}\n      >\n        <div class=\"sheet-body px-1\">\n          <div class=\"text-muted text-left pt-0 my-0 d-flex align-items-center pb-1\" style={{ gap: '0.5rem' }}>\n            <p class=\"m-0 p-0\">Select the unit to</p>\n            <ir-select\n              showFirstOption={false}\n              selectedValue={this.blockState}\n              data={[\n                { text: 'Block', value: 'block' },\n                { text: 'Unblock', value: 'unblock' },\n              ]}\n              onSelectChange={e => {\n                this.blockState = e.detail;\n              }}\n            ></ir-select>\n          </div>\n          <div>\n            {this.errors === 'rooms' && (\n              <p class={'text-danger text-left smaller p-0 '} style={{ 'margin-bottom': '0.5rem' }}>\n                {calendar_data.is_vacation_rental ? locales.entries.Lcz_PlzSelectOneListing : locales.entries.Lcz_PlzSelectOneUnit}\n              </p>\n            )}\n            <ul class=\"room-type-list\" ref={el => (this.unitSections = el)}>\n              {calendar_data.roomsInfo.map(roomType => {\n                return (\n                  <Fragment>\n                    <li key={`roomTypeRow-${roomType.id}`} class={`room-type-row`}>\n                      <div class={'d-flex choice-row'}>\n                        <span class=\"pl-1 text-left room-type-name\">{roomType.name}</span>\n                      </div>\n                    </li>\n                    {roomType.physicalrooms.map((room, j) => {\n                      const row_style = j === roomType.physicalrooms.length - 1 ? 'pb-1' : '';\n                      return (\n                        <li key={`physicalRoom-${room.id}-${j}`} class={`physical-room ${row_style}`}>\n                          <div class={'d-flex choice-row'}>\n                            <ir-radio\n                              class=\"pl-1 \"\n                              name=\"unit\"\n                              checked={this.selectedUnit?.unit_id === room.id}\n                              onCheckChange={() =>\n                                (this.selectedUnit = {\n                                  roomtype_id: roomType.id,\n                                  unit_id: room.id,\n                                })\n                              }\n                              label={room.name}\n                            ></ir-radio>\n                          </div>\n                        </li>\n                      );\n                    })}\n                  </Fragment>\n                );\n              })}\n            </ul>\n          </div>\n          {/* Dates */}\n          <table class=\"mt-1\" ref={el => (this.datesSections = el)}>\n            <thead>\n              <tr>\n                <th class=\"text-left\">{locales.entries.Lcz_From}</th>\n                <th class=\"text-left\">{locales.entries.Lcz_ToExclusive}</th>\n                <td>\n                  {this.dates.length !== this.maxDatesLength && this.blockState === 'block' && (\n                    <ir-button\n                      variant=\"icon\"\n                      icon_name=\"plus\"\n                      onClickHandler={() => {\n                        this.addDateRow();\n                      }}\n                    ></ir-button>\n                  )}\n                </td>\n              </tr>\n            </thead>\n            <tbody>\n              {this.dates.map((d, i) => {\n                if (!this.dateRefs[i]) {\n                  this.dateRefs[i] = {};\n                }\n                const fromDateMinDate = i > 0 ? this.dates[i - 1]?.to.clone().add(1, 'days')?.format('YYYY-MM-DD') ?? this.minDate : this.minDate;\n                const toDateMinDate = this.dates[i].from ? this.dates[i]?.from.clone().add(1, 'days')?.format('YYYY-MM-DD') : this.minDate;\n                return (\n                  <tr key={`date_${i}`}>\n                    <td class=\"pr-1 pb-1\">\n                      <ir-date-picker\n                        ref={el => {\n                          this.dateRefs[i].from = el;\n                        }}\n                        forceDestroyOnUpdate\n                        minDate={fromDateMinDate}\n                        data-testid=\"pickup_arrival_date\"\n                        date={d.from?.format('YYYY-MM-DD')}\n                        emitEmptyDate={true}\n                        aria-invalid={String(this.errors === 'dates' && !d.from)}\n                        onDateChanged={evt => {\n                          evt.stopImmediatePropagation();\n                          evt.stopPropagation();\n                          this.handleDateChange({ index: i, date: evt.detail.start, key: 'from' });\n                        }}\n                        onDatePickerFocus={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          if (i === 0) {\n                            return;\n                          }\n                          const index = this.dates.findIndex(d => !d.from || !d.to);\n\n                          if (!this.dates[index]?.from) {\n                            this.dateRefs[index]?.from.openDatePicker();\n                            return;\n                          }\n                          if (!this.dates[index]?.to) {\n                            this.dateRefs[index].to.openDatePicker();\n                          }\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={d.from ? d.from.format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm ${this.errors === 'dates' && !d.to ? 'border-danger' : ''} text-center`}\n                          style={{ width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </td>\n                    <td class=\"pr-1 pb-1\">\n                      <ir-date-picker\n                        forceDestroyOnUpdate\n                        ref={el => {\n                          this.dateRefs[i].to = el;\n                        }}\n                        data-testid=\"pickup_arrival_date\"\n                        date={d.to?.format('YYYY-MM-DD')}\n                        emitEmptyDate={true}\n                        minDate={toDateMinDate}\n                        aria-invalid={String(this.errors === 'dates' && !d.to)}\n                        onDateChanged={evt => {\n                          evt.stopImmediatePropagation();\n                          evt.stopPropagation();\n                          this.handleDateChange({ index: i, date: evt.detail.start, key: 'to' });\n                        }}\n                        maxDate={d.from ? moment(d.from).add(3, 'months').format('YYYY-MM-DD') : undefined}\n                        onDatePickerFocus={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          const index = this.dates.findIndex(d => !d.from || !d.to);\n\n                          if (!this.dates[index]?.from) {\n                            this.dateRefs[index]?.from?.openDatePicker();\n                            return;\n                          }\n                          if (!this.dates[index]?.to) {\n                            this.dateRefs[index].to.openDatePicker();\n                          }\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={d.to ? d.to.format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm \n                          ${this.errors === 'dates' && !d.to ? 'border-danger' : ''}\n                          text-center`}\n                          style={{ width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </td>\n                    {i > 0 && (\n                      <td class=\"pb-1\">\n                        <ir-button\n                          variant=\"icon\"\n                          icon_name=\"minus\"\n                          onClickHandler={() => {\n                            this.dates = this.dates.filter((_, j) => j !== i);\n                          }}\n                        ></ir-button>\n                      </td>\n                    )}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n        <div class={'sheet-footer'}>\n          <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class={'flex-fill'} onClickHandler={() => this.closeModal.emit(null)}></ir-button>\n          <ir-button isLoading={this.isLoading} text={locales.entries.Lcz_Confirm} btn_type=\"submit\" class=\"flex-fill\"></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",".bulk-operations-sheet-container {\n  display: flex;\n  flex-direction: column;\n  height: auto !important;\n  min-height: 100vh;\n  background: white !important;\n  /* gap: 1rem; */\n}\n.animated-container {\n  transition: all 0.5s ease;\n}\n.tabs {\n  position: sticky;\n  top: var(--ir-tabs-top, 54px);\n  background-color: white;\n  z-index: 9999999;\n  padding-top: 1rem;\n  margin-bottom: 1rem;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Tab } from '@/components/ui/ir-tabs/ir-tabs';\nimport { IrToast } from '@/components/ui/ir-toast/ir-toast';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\n\n@Component({\n  tag: 'igl-bulk-operations',\n  styleUrls: ['igl-bulk-operations.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBulkOperations {\n  @Prop() maxDatesLength = 8;\n  @Prop() property_id: number;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() toast: EventEmitter<IrToast>;\n\n  @State() selectedTab: Tab;\n\n  private tabs = [\n    {\n      id: 'stop-sale',\n      label: 'Stop/Open Sale',\n    },\n    {\n      id: 'block',\n      label: 'Block Unit',\n    },\n  ];\n\n  private tabsEl: HTMLIrTabsElement;\n  private titleEl: HTMLIrTitleElement;\n\n  componentDidLoad() {\n    this.tabsEl.style.setProperty('--ir-tabs-top', this.titleEl?.getBoundingClientRect()?.height?.toString() + 'px');\n  }\n\n  render() {\n    return (\n      <div class={'bulk-operations-sheet-container'}>\n        <div class=\"sheet-header d-flex align-items-center\">\n          <ir-title\n            ref={el => (this.titleEl = el)}\n            onCloseSideBar={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              // if (this.isLoading) {\n              //   return;\n              // }\n              this.closeModal.emit(null);\n            }}\n            class=\"px-1 mb-0\"\n            // label={locales.entries.Lcz_BulkStopOpenSale}\n            label={'Bulk Operations'}\n            displayContext=\"sidebar\"\n          ></ir-title>\n        </div>\n        <ir-tabs ref={el => (this.tabsEl = el)} class=\"tabs\" tabs={this.tabs} onTabChanged={e => (this.selectedTab = e.detail)}></ir-tabs>\n        {this.selectedTab?.id === 'stop-sale' ? (\n          <igl-bulk-stop-sale maxDatesLength={this.maxDatesLength} property_id={this.property_id}></igl-bulk-stop-sale>\n        ) : (\n          <igl-bulk-block maxDatesLength={this.maxDatesLength} property_id={this.property_id}></igl-bulk-block>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 0%;\n  height: 100%;\n}\n.bulk-sheet-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  gap: 1rem;\n}\n.animated-container {\n  transition: all 0.5s ease;\n}\n.days-checkbox {\n  gap: 0.5rem;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { BookingService } from '@/services/booking-service/booking.service';\nimport calendar_data from '@/stores/calendar-data';\nimport { ReloadInterceptor } from '@/utils/ReloadInterceptor';\nimport { Component, Event, EventEmitter, h, Prop, State } from '@stencil/core';\nimport moment, { Moment } from 'moment';\nimport { z, ZodError } from 'zod';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport calendar_dates from '@/stores/calendar-dates.store';\nimport locales from '@/stores/locales.store';\nexport type SelectedRooms = { id: string | number; result: 'open' | 'closed' };\n\n@Component({\n  tag: 'igl-bulk-stop-sale',\n  styleUrls: ['igl-bulk-stop-sale.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBulkStopSale {\n  @Prop() maxDatesLength = 8;\n  @Prop() property_id: number;\n\n  @State() selectedRoomTypes: SelectedRooms[] = [];\n  @State() errors: 'dates' | 'rooms' | 'weekdays';\n  @State() isLoading: boolean;\n  @State() dates: {\n    from: Moment | null;\n    to: Moment | null;\n  }[] = [{ from: null, to: null }];\n\n  @State() selectedWeekdays: Set<number> = new Set(\n    Array(7)\n      .fill(null)\n      .map((_, i) => i),\n  );\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() toast: EventEmitter<IToast>;\n\n  private sidebar: HTMLIrSidebarElement;\n  private dateRefs: { from?: HTMLIrDatePickerElement; to?: HTMLIrDatePickerElement }[] = [];\n  // private allRoomTypes: SelectedRooms[] = [];\n  private reloadInterceptor: ReloadInterceptor;\n  private minDate = moment().format('YYYY-MM-DD');\n  private bookingService = new BookingService();\n  private getDayIndex(dateStr: string): number {\n    return moment(dateStr, 'YYYY-MM-DD').day();\n  }\n  private datesSchema = z.array(\n    z.object({\n      from: z\n        .any()\n        .refine((val): val is Moment => moment.isMoment(val), {\n          message: \"Invalid 'from' date; expected a Moment object.\",\n        })\n        .transform((val: Moment) => val.format('YYYY-MM-DD')),\n      to: z\n        .any()\n        .refine((val): val is Moment => moment.isMoment(val), {\n          message: \"Invalid 'to' date; expected a Moment object.\",\n        })\n        .transform((val: Moment) => val.format('YYYY-MM-DD')),\n    }),\n  );\n\n  //sections\n  private unitSections: HTMLTableElement;\n  private weekdaysSections: HTMLIrWeekdaySelectorElement;\n  private datesSections: HTMLTableElement;\n\n  componentDidLoad() {\n    this.reloadInterceptor = new ReloadInterceptor({ autoActivate: false });\n    this.sidebar = document.querySelector('ir-sidebar') as HTMLIrSidebarElement;\n  }\n\n  disconnectedCallback() {\n    this.reloadInterceptor.deactivate();\n  }\n\n  // @Listen('beforeSidebarClose', { target: 'body' })\n  // handleBeforeSidebarClose(e: CustomEvent) {\n  //   e.stopImmediatePropagation();\n  //   e.stopPropagation();\n  //   if (window.confirm('Do you really want to proceed?')) {\n  //     this.deactivate();\n  //     this.sidebar.toggleSidebar();\n  //   }\n  // }\n\n  private async addBlockDates() {\n    const generatePeriodsToModify = periods => {\n      const p = [];\n      for (const period of periods) {\n        let current = period.from;\n        const lastDay = moment(period.to, 'YYYY-MM-DD').add(1, 'days').format('YYYY-MM-DD');\n        while (current !== lastDay) {\n          const nextDay = moment(current, 'YYYY-MM-DD').add(1, 'days').format('YYYY-MM-DD');\n          if (!this.selectedWeekdays.has(this.getDayIndex(current))) {\n            current = nextDay;\n            continue;\n          }\n          for (const selectedRoom of this.selectedRoomTypes) {\n            p.push({\n              room_type_id: selectedRoom.id,\n              night: current,\n            });\n          }\n          current = nextDay;\n        }\n      }\n      return p;\n    };\n    const updateCalendarCells = (\n      payloads: {\n        is_closed: boolean;\n        restrictions: {\n          night: string;\n          room_type_id: number;\n        }[];\n      }[],\n    ) => {\n      const prevDisabledCells = new Map(calendar_dates.disabled_cells);\n\n      // Caches\n      const roomsInfoById = new Map(calendar_data.roomsInfo.map((rt, i) => [rt.id, { roomType: rt, index: i }]));\n      const dayIndexByValue = new Map(calendar_dates.days.map((day, i) => [day.value, i]));\n      const rateByRoomTypeAndDate = new Map<string, any>();\n\n      for (const payload of payloads) {\n        for (const restriction of payload.restrictions) {\n          const { night, room_type_id } = restriction;\n          const { roomType } = roomsInfoById.get(room_type_id);\n\n          if (!roomType) continue;\n\n          const dayIndex = dayIndexByValue.get(night);\n          if (dayIndex === undefined) {\n            console.warn(`Couldn't find date ${night}`);\n            continue;\n          }\n\n          const day = calendar_dates.days[dayIndex];\n          const rateKey = `${room_type_id}_${night}`;\n          let rp = rateByRoomTypeAndDate.get(rateKey);\n          if (!rp) {\n            rp = day.rate.find(r => r.id === room_type_id);\n            if (!rp) {\n              console.warn(`Couldn't find room type ${room_type_id}`);\n              continue;\n            }\n            rateByRoomTypeAndDate.set(rateKey, rp);\n          }\n\n          const haveAvailability = (rp.exposed_inventory as any).rts === 0;\n          for (const room of roomType.physicalrooms) {\n            const key = `${room.id}_${night}`;\n            prevDisabledCells.set(key, {\n              disabled: payload.is_closed ? true : haveAvailability,\n              reason: payload.is_closed ? 'stop_sale' : haveAvailability ? 'inventory' : 'stop_sale',\n            });\n          }\n        }\n      }\n      calendar_dates['disabled_cells'] = new Map(prevDisabledCells);\n    };\n    try {\n      this.errors = null;\n      this.isLoading = true;\n      const periods = this.datesSchema.parse(this.dates);\n      if (this.selectedRoomTypes.length === 0) {\n        this.unitSections.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        this.errors = 'rooms';\n        return;\n      }\n      if (this.selectedWeekdays.size === 0) {\n        this.weekdaysSections.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        this.errors = 'weekdays';\n        return;\n      }\n      this.activate();\n      const periods_to_modify = generatePeriodsToModify(periods);\n      const isAllOpen = this.selectedRoomTypes.every(e => e.result === 'open');\n      const isAllClosed = this.selectedRoomTypes.every(e => e.result === 'closed');\n      if (isAllClosed || isAllOpen) {\n        const payload = {\n          is_closed: isAllClosed,\n          restrictions: periods_to_modify,\n          property_id: this.property_id,\n        };\n        await this.bookingService.setExposedRestrictionPerRoomType(payload);\n        updateCalendarCells([payload]);\n      } else {\n        const payloads = [];\n        for (const room of this.selectedRoomTypes) {\n          const periods = periods_to_modify.filter(f => f.room_type_id === room.id);\n          payloads.push({\n            is_closed: room.result === 'closed',\n            restrictions: periods,\n            property_id: this.property_id,\n          });\n        }\n        await Promise.all(payloads.map(p => this.bookingService.setExposedRestrictionPerRoomType(p)));\n        updateCalendarCells(payloads);\n      }\n      this.deactivate();\n      this.toast.emit({\n        type: 'success',\n        title: locales.entries.Lcz_RequestSubmittedSuccessfully,\n        description: '',\n      });\n      this.isLoading = false;\n      this.closeModal.emit();\n    } catch (error) {\n      console.log(error);\n      if (error instanceof ZodError) {\n        this.datesSections.scrollIntoView({ behavior: 'smooth', block: 'end' });\n        this.errors = 'dates';\n      }\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private activate() {\n    this.reloadInterceptor.activate();\n    if (this.sidebar) this.sidebar.preventClose = true;\n  }\n\n  private deactivate() {\n    this.reloadInterceptor.deactivate();\n    if (this.sidebar) this.sidebar.preventClose = false;\n  }\n\n  private handleDateChange({ index, date, key }: { index: number; date: Moment; key: 'from' | 'to' }) {\n    // 1) clone and set the new date\n    const dates = [...this.dates];\n    dates[index] = { ...dates[index], [key]: date };\n\n    // 1a) if they just changed the â€œfromâ€, always clear that rowâ€™s â€œtoâ€\n    if (key === 'from' && dates[index].to?.isBefore(date, 'dates')) {\n      dates[index].to = null;\n    }\n\n    // 2) clear any subsequent rows whose â€œfromâ€ is on or before the changed date\n    for (let i = index + 1; i < dates.length; i++) {\n      const rowFrom = dates[i]?.from;\n      if (rowFrom && rowFrom.isSameOrBefore(date, 'day')) {\n        dates[i] = { from: null, to: null };\n      }\n    }\n\n    // 3) commit\n    this.dates = dates;\n\n    // 4) open the appropriate picker\n    setTimeout(() => {\n      if (key === 'from') {\n        this.dateRefs[index]?.to.openDatePicker();\n      } else {\n        const nextFrom = dates.findIndex(d => d.from === null);\n        if (nextFrom > -1) {\n          this.dateRefs[nextFrom]?.from.openDatePicker();\n        }\n      }\n    }, 100);\n  }\n\n  private addDateRow() {\n    const last_dates = this.dates[this.dates.length - 1];\n    if (!last_dates.from || !last_dates.to) {\n      this.errors = 'dates';\n      return;\n    }\n    this.errors = null;\n    this.dates = [...this.dates, { from: null, to: null }];\n    setTimeout(() => {\n      this.dateRefs[this.dates.length - 1].to?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }, 100);\n  }\n\n  render() {\n    return (\n      <form\n        class={'bulk-sheet-container'}\n        onSubmit={e => {\n          e.preventDefault();\n          this.addBlockDates();\n        }}\n      >\n        {/* <div class=\"sheet-header d-flex align-items-center\">\n          <ir-title\n            onCloseSideBar={e => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              if (this.isLoading) {\n                return;\n              }\n              this.closeModal.emit(null);\n            }}\n            class=\"px-1 mb-0\"\n            label={locales.entries.Lcz_BulkStopOpenSale}\n            displayContext=\"sidebar\"\n          ></ir-title>\n        </div> */}\n        <div class=\"sheet-body px-1\">\n          <div class=\"text-muted text-left py-0 my-0\">\n            <p>\n              {/* {locales.entries.Lcz_SelectAffectedUnits} */}\n              Select the types to stop or open sales for all related rate plans\n              {/* <span class=\"text-warning\">{locales.entries.Lcz_OperationRequiresSeveralMinutes}</span> */}\n            </p>\n          </div>\n          <div>\n            {this.errors === 'rooms' && (\n              <p class={'text-danger text-left smaller p-0 '} style={{ 'margin-bottom': '0.5rem' }}>\n                {calendar_data.is_vacation_rental ? locales.entries.Lcz_PlzSelectOneListing : locales.entries.Lcz_PlzSelectOneUnit}\n              </p>\n            )}\n            <table ref={el => (this.unitSections = el)}>\n              <thead>\n                <tr>\n                  <th class=\"sr-only\">choice</th>\n                  <th class=\"sr-only\">room type</th>\n                </tr>\n              </thead>\n              <tbody>\n                {calendar_data.roomsInfo.map((roomType, i) => {\n                  const row_style = i === calendar_data.roomsInfo.length - 1 ? '' : 'pb-1';\n                  return (\n                    <tr key={roomType.id}>\n                      <td class={`choice-row ${row_style}`}>\n                        <div class={'d-flex justify-content-end'}>\n                          <ir-select\n                            firstOption={`${locales.entries.Lcz_Select}...`}\n                            data={[\n                              { value: 'open', text: locales.entries.Lcz_Open },\n                              { value: 'closed', text: locales.entries.Lcz_StopSale },\n                            ]}\n                            onSelectChange={e => {\n                              const choice = e.detail as 'open' | 'closed' | undefined;\n                              // drop any existing entry for this roomType\n                              const rest = this.selectedRoomTypes.filter(entry => entry.id !== roomType.id);\n                              // if they actually picked something, append it\n                              if (choice) {\n                                rest.push({ id: roomType.id, result: choice });\n                              }\n                              this.selectedRoomTypes = rest;\n                            }}\n                          ></ir-select>\n                        </div>\n                      </td>\n                      <td class={`pl-1 text-left ${row_style}`}>{roomType.name}</td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n          <p class=\"text-left mt-2 text-muted\">Included days</p>\n          {this.errors === 'weekdays' && <p class={'text-danger text-left smaller m-0 p-0'}>Please select at least one day</p>}\n          <ir-weekday-selector\n            ref={el => (this.weekdaysSections = el)}\n            weekdays={Array.from(this.selectedWeekdays)}\n            onWeekdayChange={e => {\n              e.stopPropagation();\n              e.stopImmediatePropagation();\n              this.selectedWeekdays = new Set(e.detail);\n            }}\n          ></ir-weekday-selector>\n          {/* Dates */}\n          <table class=\"mt-1\" ref={el => (this.datesSections = el)}>\n            <thead>\n              <tr>\n                <th class=\"text-left\">{locales.entries.Lcz_From}</th>\n                <th class=\"text-left\">{locales.entries.Lcz_ToExclusive}</th>\n                <td>\n                  {this.dates.length !== this.maxDatesLength && (\n                    <ir-button\n                      variant=\"icon\"\n                      icon_name=\"plus\"\n                      onClickHandler={() => {\n                        this.addDateRow();\n                      }}\n                    ></ir-button>\n                  )}\n                </td>\n              </tr>\n            </thead>\n            <tbody>\n              {this.dates.map((d, i) => {\n                if (!this.dateRefs[i]) {\n                  this.dateRefs[i] = {};\n                }\n\n                const fromDateMinDate = i > 0 ? this.dates[i - 1]?.to.clone().add(1, 'days')?.format('YYYY-MM-DD') ?? this.minDate : this.minDate;\n                const toDateMinDate = this.dates[i].from ? this.dates[i]?.from.clone()?.format('YYYY-MM-DD') : this.minDate;\n                return (\n                  <tr key={`date_${i}`}>\n                    <td class=\"pr-1 pb-1\">\n                      <ir-date-picker\n                        ref={el => {\n                          this.dateRefs[i].from = el;\n                        }}\n                        forceDestroyOnUpdate\n                        minDate={fromDateMinDate}\n                        data-testid=\"pickup_arrival_date\"\n                        date={d.from?.format('YYYY-MM-DD')}\n                        emitEmptyDate={true}\n                        aria-invalid={String(this.errors === 'dates' && !d.from)}\n                        onDateChanged={evt => {\n                          evt.stopImmediatePropagation();\n                          evt.stopPropagation();\n                          this.handleDateChange({ index: i, date: evt.detail.start, key: 'from' });\n                        }}\n                        onDatePickerFocus={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          if (i === 0) {\n                            return;\n                          }\n                          const index = this.dates.findIndex(d => !d.from || !d.to);\n\n                          if (!this.dates[index]?.from) {\n                            this.dateRefs[index]?.from.openDatePicker();\n                            return;\n                          }\n                          if (!this.dates[index]?.to) {\n                            this.dateRefs[index].to.openDatePicker();\n                          }\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={d.from ? d.from.format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm ${this.errors === 'dates' && !d.to ? 'border-danger' : ''} text-center`}\n                          style={{ width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </td>\n                    <td class=\"pr-1 pb-1\">\n                      <ir-date-picker\n                        forceDestroyOnUpdate\n                        ref={el => {\n                          this.dateRefs[i].to = el;\n                        }}\n                        data-testid=\"pickup_arrival_date\"\n                        date={d.to?.format('YYYY-MM-DD')}\n                        emitEmptyDate={true}\n                        minDate={toDateMinDate}\n                        aria-invalid={String(this.errors === 'dates' && !d.to)}\n                        onDateChanged={evt => {\n                          evt.stopImmediatePropagation();\n                          evt.stopPropagation();\n                          this.handleDateChange({ index: i, date: evt.detail.start, key: 'to' });\n                        }}\n                        onDatePickerFocus={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          const index = this.dates.findIndex(d => !d.from || !d.to);\n\n                          if (!this.dates[index]?.from) {\n                            this.dateRefs[index]?.from?.openDatePicker();\n                            return;\n                          }\n                          if (!this.dates[index]?.to) {\n                            this.dateRefs[index].to.openDatePicker();\n                          }\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={d.to ? d.to.format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm \n                          ${this.errors === 'dates' && !d.to ? 'border-danger' : ''}\n                          text-center`}\n                          style={{ width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </td>\n                    {i > 0 && (\n                      <td class=\"pb-1\">\n                        <ir-button\n                          variant=\"icon\"\n                          icon_name=\"minus\"\n                          onClickHandler={() => {\n                            this.dates = this.dates.filter((_, j) => j !== i);\n                          }}\n                        ></ir-button>\n                      </td>\n                    )}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n        <div class={'sheet-footer'}>\n          <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class={'flex-fill'} onClickHandler={() => this.closeModal.emit(null)}></ir-button>\n          <ir-button isLoading={this.isLoading} text={locales.entries.Lcz_Save} btn_type=\"submit\" class=\"flex-fill\"></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n\n.bodyContainer {\n  position: relative;\n}\n\n.roomRow {\n  width: max-content;\n}\n\n.roomRow:first-child {\n  margin-top: 80px;\n}\n.categoryName {\n  font-weight: bold;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n/* .cellData[data-dirty-room='true'] { \n  border-bottom: 5px solid rgb(80, 80, 80) !important;\n} */\n.cellData[data-dirty-room='true']::after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  height: 100%;\n  left: 30%;\n  right: 30%;\n  background-color: #d4d0be !important;\n}\n\n/* .cellData.disabled[data-dirty-room='true'] {\n  border-bottom: 2px solid rgb(80, 80, 80) !important;\n} */\n.cellData.disabled {\n  background: rgba(153, 153, 153, 15%);\n  cursor: var(--cell-cursor, not-allowed);\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.roomRow .room {\n  cursor: pointer;\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.roomRow .room:hover {\n  background: #e0e0e0;\n}\n.roomRow .room:hover[data-hk-enabled='false'] {\n  background: white;\n  cursor: default;\n}\n.cellData {\n  width: 58px;\n  height: 30px;\n  display: inline-grid;\n  border-top: 1px solid #e0e0e0;\n  border-left: 1px solid #e0e0e0;\n  vertical-align: top;\n}\n.triangle-button {\n  --size: 10px;\n  position: absolute;\n  right: -6px;\n  top: -1px;\n\n  width: 0;\n  height: 0;\n  padding: 0;\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  width: 0;\n  height: 0;\n  border-left: var(--size) solid transparent;\n  border-right: var(--size) solid transparent;\n  border-bottom: var(--size) solid var(--in-toggle-color);\n\n  transform: rotate(45deg);\n}\n.cellData:nth-child(2) {\n  border-left: 0px;\n}\n\n.cellData:last-child {\n  border-right: 1px solid rgba(186, 191, 199, 0.5);\n}\n\n.roomHeaderCell {\n  position: -webkit-sticky;\n  position: sticky;\n  left: 0;\n  background: #fff;\n  border-right: 1px solid #ccc;\n  width: 170px;\n  z-index: 1;\n}\n\n.currentDay {\n  background-color: #e3f3fa;\n}\n\n.dragOverHighlight {\n  background-color: #f5f5dc !important;\n}\n\n.selectedDay {\n  background-color: #f9f9c9 !important;\n}\n\n.categoryTitle {\n  grid-template-columns: 1fr 20px;\n  padding-left: 10px;\n  cursor: pointer;\n  height: 40px;\n  font-size: 0.9em;\n}\n.categoryTitle > :nth-child(1) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.roomTitle {\n  padding-left: 20px;\n  font-size: 0.9em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.roomTitle > :nth-child(1) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.roomTitle.pl10 {\n  padding-left: 10px;\n}\n\n.categoryPriceColumn {\n  align-items: center;\n  height: 40px;\n  -webkit-user-select: none;\n  user-select: none;\n  position: relative;\n}\n\n/* BOOKING EVENT */\n.bookingEventsContainer {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n","import { Component, Host, Listen, Prop, State, h, Event, EventEmitter, Watch, Fragment } from '@stencil/core';\n\nimport moment from 'moment';\n\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { compareTime, createDateWithOffsetAndHour } from '@/utils/booking';\n\nimport calendar_dates from '@/stores/calendar-dates.store';\nimport locales from '@/stores/locales.store';\nimport calendar_data from '@/stores/calendar-data';\n\nimport { PhysicalRoom, RoomHkStatus, RoomType } from '@/models/booking.dto';\nimport { ICountry } from '@/models/IBooking';\n\nexport type RoomCategory = RoomType & { expanded: boolean };\n\n@Component({\n  tag: 'igl-cal-body',\n  styleUrl: 'igl-cal-body.css',\n  scoped: true,\n})\nexport class IglCalBody {\n  @Prop() isScrollViewDragging: boolean;\n  @Prop() propertyId: number;\n  @Prop() calendarData: { [key: string]: any };\n  @Prop() today: String;\n  @Prop() currency;\n  @Prop() language: string;\n  @Prop() countries: ICountry[];\n  @Prop() highlightedDate: string;\n\n  @State() dragOverElement: string = '';\n  @State() renderAgain: boolean = false;\n  @State() selectedRoom: PhysicalRoom;\n  @State() isLoading: 'middle' | 'right' | null = null;\n\n  @Event() addBookingDatasEvent: EventEmitter<any[]>;\n  @Event() showBookingPopup: EventEmitter;\n  @Event({ bubbles: true, composed: true }) scrollPageToRoom: EventEmitter;\n\n  @State() selectedRooms: { [key: string]: any } = {};\n  private fromRoomId: number = -1;\n  private newEvent: { [key: string]: any };\n  private currentDate = new Date();\n  private hkModal: HTMLIrModalElement;\n  private housekeepingService = new HouseKeepingService();\n  private bookingMap = new Map<string | number, string | number>();\n  private interactiveTitle: HTMLIrInteractiveTitleElement[] = [];\n  private dayRateMap = new Map<string, (typeof calendar_dates.days)[0]['rate']>();\n  // private disabledCellsCache = new Map<string, boolean>();\n\n  componentWillLoad() {\n    this.currentDate.setHours(0, 0, 0, 0);\n    this.bookingMap = this.getBookingMap(this.getBookingData());\n    calendar_dates.days.forEach(day => {\n      this.dayRateMap.set(day.day, day.rate);\n    });\n    this.updateDisabledCellsCache();\n  }\n\n  @Watch('calendarData')\n  handleCalendarDataChange() {\n    this.bookingMap = this.getBookingMap(this.getBookingData());\n    this.updateDisabledCellsCache();\n  }\n\n  @Listen('dragOverHighlightElement', { target: 'window' })\n  dragOverHighlightElementHandler(event: CustomEvent) {\n    this.dragOverElement = event.detail.dragOverElement;\n  }\n\n  @Listen('gotoRoomEvent', { target: 'window' })\n  gotoRoom(event: CustomEvent) {\n    let roomId = event.detail.roomId;\n    let category = this.getRoomCategoryByRoomId(roomId);\n    if (!category.expanded) {\n      this.toggleCategory(category);\n      setTimeout(() => {\n        this.scrollToRoom(roomId);\n      }, 10);\n    } else {\n      this.scrollToRoom(roomId);\n    }\n  }\n\n  @Listen('addToBeAssignedEvent', { target: 'window' })\n  addToBeAssignedEvents(event: CustomEvent) {\n    // let roomId = event.detail.roomId;\n    this.addBookingDatas(event.detail.data);\n    this.renderElement();\n  }\n\n  @Listen('closeBookingWindow', { target: 'window' })\n  closeWindow() {\n    let ind = this.getBookingData().findIndex(ev => ev.ID === 'NEW_TEMP_EVENT');\n    if (ind !== -1) {\n      this.getBookingData().splice(ind, 1);\n      console.log('removed item..');\n      this.renderElement();\n    }\n  }\n\n  private scrollToRoom(roomId: number) {\n    this.scrollPageToRoom.emit({\n      key: 'scrollPageToRoom',\n      id: roomId,\n      refClass: 'room_' + roomId,\n    });\n  }\n\n  private getRoomCategoryByRoomId(roomId) {\n    return this.calendarData.roomsInfo.find(roomCategory => {\n      return this.getCategoryRooms(roomCategory).find(room => this.getRoomId(room) === roomId);\n    });\n  }\n\n  private getCategoryName(roomCategory) {\n    return roomCategory.name;\n  }\n\n  private getCategoryId(roomCategory) {\n    return roomCategory.id;\n  }\n\n  private getTotalPhysicalRooms(roomCategory) {\n    return this.getCategoryRooms(roomCategory).length;\n  }\n\n  private getCategoryRooms(roomCategory: RoomCategory) {\n    return (roomCategory && roomCategory.physicalrooms) || [];\n  }\n\n  private getRoomName(roomInfo) {\n    return roomInfo.name;\n  }\n\n  private getRoomId(roomInfo) {\n    return roomInfo.id;\n  }\n\n  private getRoomById(physicalRooms, roomId) {\n    return physicalRooms.find(physical_room => this.getRoomId(physical_room) === roomId);\n  }\n\n  private getBookingData() {\n    return this.calendarData.bookingEvents;\n  }\n\n  private addBookingDatas(aData) {\n    this.addBookingDatasEvent.emit(aData);\n  }\n\n  private getSelectedCellRefName(roomId, selectedDay) {\n    return 'room_' + roomId + '_' + selectedDay.currentDate;\n  }\n\n  // getSplitBookingEvents(newEvent) {\n  //   return this.getBookingData().some(bookingEvent => !['003', '002', '004'].includes(bookingEvent.STATUS_CODE) && newEvent.FROM_DATE === bookingEvent.FROM_DATE);\n  // }\n  private getSplitBookingEvents(newEvent) {\n    console.log(newEvent.FROM_DATE);\n    return this.getBookingData().some(bookingEvent => {\n      if (!['003', '002', '004'].includes(bookingEvent.STATUS_CODE)) {\n        if (\n          new Date(newEvent.FROM_DATE).getTime() >= new Date(bookingEvent.FROM_DATE).getTime() &&\n          new Date(newEvent.FROM_DATE).getTime() <= new Date(bookingEvent.TO_DATE).getTime()\n        ) {\n          return bookingEvent;\n        }\n      }\n    });\n  }\n\n  private addNewEvent(roomCategory) {\n    let keys = Object.keys(this.selectedRooms);\n    let startDate: Date, endDate: Date;\n\n    if (this.selectedRooms[keys[0]].currentDate < this.selectedRooms[keys[1]].currentDate) {\n      startDate = new Date(this.selectedRooms[keys[0]].currentDate);\n      endDate = new Date(this.selectedRooms[keys[1]].currentDate);\n    } else {\n      startDate = new Date(this.selectedRooms[keys[1]].currentDate);\n      endDate = new Date(this.selectedRooms[keys[0]].currentDate);\n    }\n\n    const dateDifference = Math.round(Math.abs((endDate.getTime() - startDate.getTime()) / 86_400_000));\n    this.newEvent = {\n      ID: 'NEW_TEMP_EVENT',\n      NAME: <span>&nbsp;</span>,\n      EMAIL: '',\n      PHONE: '',\n      convertBooking: false,\n      REFERENCE_TYPE: 'PHONE',\n      FROM_DATE: startDate.getFullYear() + '-' + this.getTwoDigitNumStr(startDate.getMonth() + 1) + '-' + this.getTwoDigitNumStr(startDate.getDate()),\n      TO_DATE: endDate.getFullYear() + '-' + this.getTwoDigitNumStr(endDate.getMonth() + 1) + '-' + this.getTwoDigitNumStr(endDate.getDate()),\n      BALANCE: '',\n      NOTES: '',\n      RELEASE_AFTER_HOURS: 0,\n      PR_ID: this.selectedRooms[keys[0]].roomId,\n      ENTRY_DATE: '',\n      NO_OF_DAYS: dateDifference,\n      ADULTS_COUNT: 1,\n      COUNTRY: '',\n      INTERNAL_NOTE: '',\n      RATE: '',\n      TOTAL_PRICE: '',\n      RATE_PLAN: '',\n      ARRIVAL_TIME: '',\n      TITLE: locales.entries.Lcz_NewBookingFor,\n      roomsInfo: [roomCategory],\n      CATEGORY: roomCategory.name,\n      event_type: 'BAR_BOOKING',\n      STATUS: 'TEMP-EVENT',\n      defaultDateRange: {\n        fromDate: null,\n        fromDateStr: '',\n        toDate: null,\n        toDateStr: '',\n        dateDifference,\n        editable: false,\n        message: 'Including 5.00% City Tax - Excluding 11.00% VAT',\n      },\n    };\n\n    let popupTitle = roomCategory.name + ' ' + this.getRoomName(this.getRoomById(this.getCategoryRooms(roomCategory), this.selectedRooms[keys[0]].roomId));\n    this.newEvent.BLOCK_DATES_TITLE = `${locales.entries.Lcz_BlockDatesFor} ${popupTitle}`;\n    this.newEvent.TITLE += popupTitle;\n    this.newEvent.defaultDateRange.toDate = new Date(this.newEvent.TO_DATE + 'T00:00:00');\n    this.newEvent.defaultDateRange.fromDate = new Date(this.newEvent.FROM_DATE + 'T00:00:00');\n    this.newEvent.defaultDateRange.fromDateStr = this.getDateStr(this.newEvent.defaultDateRange.fromDate);\n    this.newEvent.defaultDateRange.toDateStr = this.getDateStr(this.newEvent.defaultDateRange.toDate);\n    this.newEvent.ENTRY_DATE = new Date().toISOString();\n    this.newEvent.legendData = this.calendarData.formattedLegendData;\n\n    let splitBookingEvents = this.getSplitBookingEvents(this.newEvent);\n    if (splitBookingEvents) {\n      this.newEvent.splitBookingEvents = splitBookingEvents;\n    }\n\n    this.getBookingData().push(this.newEvent);\n    return this.newEvent;\n  }\n\n  private getTwoDigitNumStr(num) {\n    return num <= 9 ? '0' + num : num;\n  }\n\n  private getDateStr(date, locale = 'default') {\n    return date.getDate() + ' ' + date.toLocaleString(locale, { month: 'short' }) + ' ' + date.getFullYear();\n  }\n\n  private removeNewEvent() {\n    this.calendarData.bookingEvents = this.calendarData.bookingEvents.filter(events => events.ID !== 'NEW_TEMP_EVENT');\n    this.newEvent = null;\n  }\n\n  // private clickCell(roomId, selectedDay, roomCategory) {\n  //   if (!this.isScrollViewDragging && selectedDay.currentDate >= this.currentDate.getTime()) {\n  //     let refKey = this.getSelectedCellRefName(roomId, selectedDay);\n  //     if (this.selectedRooms.hasOwnProperty(refKey)) {\n  //       this.removeNewEvent();\n  //       delete this.selectedRooms[refKey];\n  //       this.renderElement();\n  //       return;\n  //     } else if (Object.keys(this.selectedRooms).length != 1 || this.fromRoomId != roomId) {\n  //       this.removeNewEvent();\n  //       this.selectedRooms = {};\n  //       this.selectedRooms[refKey] = { ...selectedDay, roomId };\n  //       this.fromRoomId = roomId;\n  //       this.renderElement();\n  //     } else {\n  //       // create bar;\n  //       this.selectedRooms[refKey] = { ...selectedDay, roomId };\n  //       this.addNewEvent(roomCategory);\n  //       this.selectedRooms = {};\n  //       this.renderElement();\n  //       this.showNewBookingPopup(this.newEvent);\n  //     }\n  //   }\n  // }\n  private clickCell(roomId: number, selectedDay: any, roomCategory: RoomCategory) {\n    if (!this.isScrollViewDragging && selectedDay.currentDate >= this.currentDate.getTime()) {\n      let refKey = this.getSelectedCellRefName(roomId, selectedDay);\n      if (this.selectedRooms.hasOwnProperty(refKey)) {\n        this.removeNewEvent();\n        delete this.selectedRooms[refKey];\n        this.renderElement();\n        return;\n      } else if (Object.keys(this.selectedRooms).length != 1 || this.fromRoomId != roomId) {\n        this.removeNewEvent();\n        this.selectedRooms = {};\n        this.selectedRooms[refKey] = { ...selectedDay, roomId };\n        this.fromRoomId = roomId;\n        this.renderElement();\n      } else {\n        const keys = Object.keys(this.selectedRooms);\n        const startDate = moment(this.selectedRooms[keys[0]].value, 'YYYY-MM-DD');\n        const endDate = moment(selectedDay.value, 'YYYY-MM-DD');\n        let cursor = startDate.clone().add(1, 'days');\n        let disabledCount = 0;\n        while (cursor.isBefore(endDate, 'day')) {\n          const dateKey = cursor.format('YYYY-MM-DD');\n          if (this.isCellDisabled(roomId, dateKey)) {\n            disabledCount++;\n          }\n          cursor.add(1, 'days');\n        }\n        if (disabledCount >= 1) {\n          this.selectedRooms = {};\n          this.fromRoomId = roomId;\n          this.renderElement();\n          return;\n        }\n\n        this.selectedRooms[refKey] = { ...selectedDay, roomId };\n        this.addNewEvent(roomCategory);\n        this.selectedRooms = {};\n        this.renderElement();\n        this.showNewBookingPopup(this.newEvent);\n      }\n    }\n  }\n  private showNewBookingPopup(data) {\n    console.log(data);\n    // this.showBookingPopup.emit({key: \"add\", data});\n  }\n\n  private renderElement() {\n    this.renderAgain = !this.renderAgain;\n  }\n  private getBookingMap(bookings: any[]): Map<string | number, string | number> {\n    const bookingMap = new Map<string | number, string | number>();\n    const today = moment().startOf('day');\n\n    for (const booking of bookings) {\n      const fromDate = moment(booking.FROM_DATE, 'YYYY-MM-DD').startOf('day');\n      const toDate = moment(booking.TO_DATE, 'YYYY-MM-DD').startOf('day');\n\n      // Check if today is between fromDate and toDate, inclusive.\n      if (today.isSameOrAfter(fromDate) && today.isSameOrBefore(toDate)) {\n        if (!bookingMap.has(booking.PR_ID)) {\n          bookingMap.set(booking.PR_ID, booking.BOOKING_NUMBER);\n        } else {\n          if (compareTime(moment().toDate(), createDateWithOffsetAndHour(calendar_data.checkin_checkout_hours?.offset, calendar_data.checkin_checkout_hours?.hour))) {\n            bookingMap.set(booking.PR_ID, booking.BOOKING_NUMBER);\n          }\n        }\n      }\n    }\n\n    return bookingMap;\n  }\n  private getGeneralCategoryDayColumns(addClass: string, isCategory: boolean = false, index: number) {\n    return calendar_dates.days.map(dayInfo => {\n      // const isActive = true;\n      return (\n        <div\n          class={`cellData  font-weight-bold categoryPriceColumn ${addClass + '_' + dayInfo.day} ${\n            dayInfo.day === this.today || dayInfo.day === this.highlightedDate ? 'currentDay' : ''\n          }`}\n        >\n          {isCategory ? (\n            <Fragment>\n              <span class={'categoryName'}>\n                {dayInfo.rate[index].exposed_inventory.rts}\n                {/* <button class={'triangle-button'} style={{ '--in-toggle-color': isActive ? 'green' : '#ff4961' }}></button> */}\n                {/* <br />\n              {dayInfo.rate[index].exposed_inventory.offline} */}\n              </span>\n            </Fragment>\n          ) : (\n            ''\n          )}\n        </div>\n      );\n    });\n  }\n\n  private getGeneralRoomDayColumns(roomId: string, roomCategory: RoomCategory, roomName: string) {\n    return this.calendarData.days.map(dayInfo => {\n      const isCellDisabled = this.isCellDisabled(Number(roomId), dayInfo.value);\n      const prevDate = moment(dayInfo.value, 'YYYY-MM-DD').add(-1, 'days').format('YYYY-MM-DD');\n      const isDisabled = (isCellDisabled && Object.keys(this.selectedRooms).length === 0) || (isCellDisabled && this.isCellDisabled(Number(roomId), prevDate));\n      const isSelected = this.selectedRooms.hasOwnProperty(this.getSelectedCellRefName(roomId, dayInfo));\n      const isCurrentDate = dayInfo.day === this.today || dayInfo.day === this.highlightedDate;\n      const cleaningDates = calendar_dates.cleaningTasks.has(+roomId) ? calendar_dates.cleaningTasks.get(+roomId) : null;\n      const shouldBeCleaned = ['001', '003'].includes(calendar_data.cleaning_frequency?.code) ? false : cleaningDates?.has(dayInfo.value);\n      return (\n        <div\n          class={`cellData position-relative roomCell ${isCellDisabled ? 'disabled' : ''} ${'room_' + roomId + '_' + dayInfo.day} ${isCurrentDate ? 'currentDay' : ''} ${\n            this.dragOverElement === roomId + '_' + dayInfo.day ? 'dragOverHighlight' : ''\n          } ${isSelected ? 'selectedDay' : ''}`}\n          style={!isDisabled && { '--cell-cursor': 'default' }}\n          onClick={() => {\n            if (isDisabled) {\n              return;\n            }\n            this.clickCell(Number(roomId), dayInfo, roomCategory);\n          }}\n          aria-label={roomName}\n          role=\"gridcell\"\n          data-room-id={roomId}\n          data-date={dayInfo.value}\n          aria-current={isCurrentDate ? 'date' : undefined}\n          data-room-name={roomName}\n          data-dirty-room={String(shouldBeCleaned)}\n          aria-disabled={String(isDisabled)}\n          aria-selected={Boolean(isSelected)}\n          // tabIndex={-1}\n        >\n          {/* <button class={'triangle-button'} style={{ '--in-toggle-color': isDisabled ? 'green' : '#ff4961' }}></button> */}\n        </div>\n      );\n    });\n  }\n\n  private toggleCategory(roomCategory: RoomCategory) {\n    roomCategory.expanded = !roomCategory.expanded;\n    this.renderElement();\n  }\n\n  private getRoomCategoryRow(roomCategory: RoomCategory, index: number) {\n    if (this.getTotalPhysicalRooms(roomCategory) <= 1 || !roomCategory.is_active) {\n      return null;\n    }\n    return (\n      <div class=\"roomRow\">\n        <div\n          class={`cellData text-left align-items-center roomHeaderCell categoryTitle ${'category_' + this.getCategoryId(roomCategory)}`}\n          onClick={() => this.toggleCategory(roomCategory)}\n        >\n          <div class={'categoryName'}>\n            <ir-interactive-title popoverTitle={this.getCategoryName(roomCategory)}></ir-interactive-title>\n            {/* <ir-popover popoverTitle={this.getCategoryName(roomCategory)}></ir-popover> */}\n          </div>\n          {roomCategory.expanded ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" height={14} width={14}>\n              <path\n                fill=\"#6b6f82\"\n                d=\"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z\"\n              />\n            </svg>\n          ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\" height={14} width={14}>\n              <path\n                fill=\"#6b6f82\"\n                d=\"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z\"\n              />\n            </svg>\n          )}\n          {/* <i class={`la la-angle-${roomCategory.expanded ? 'down' : 'right'}`}></i> */}\n        </div>\n        {this.getGeneralCategoryDayColumns('category_' + this.getCategoryId(roomCategory), true, index)}\n      </div>\n    );\n  }\n\n  /**\n   * Renders a list of active rooms for an expanded room category. Returns an array of JSX elements, including headers and day columns, or an empty array if the category is collapsed or contains no active rooms.\n   *\n   * @param {RoomCategory} roomCategory - The category containing room details.\n   */\n  private getRoomsByCategory(roomCategory: RoomCategory) {\n    // Check accordion is expanded.\n    if (!roomCategory.expanded) {\n      return null;\n    }\n    return this.getCategoryRooms(roomCategory)?.map(room => {\n      if (!room.is_active) {\n        return null;\n      }\n      const haveSingleRooms = this.getTotalPhysicalRooms(roomCategory) <= 1;\n      const name = haveSingleRooms ? this.getCategoryName(roomCategory) : this.getRoomName(room);\n      return (\n        <div class=\"roomRow\">\n          <div\n            class={`cellData room text-left align-items-center roomHeaderCell  roomTitle ${this.getTotalPhysicalRooms(roomCategory) <= 1 ? 'pl10' : ''} ${\n              'room_' + this.getRoomId(room)\n            }`}\n            data-room-name={name}\n            data-hk-enabled={String(calendar_data.housekeeping_enabled)}\n            data-room={this.getRoomId(room)}\n            onClick={() => {\n              if (!calendar_data.housekeeping_enabled) {\n                return;\n              }\n              this.selectedRoom = room;\n              this.hkModal.openModal();\n            }}\n            onMouseEnter={() => {\n              this.interactiveTitle[room.id]?.style?.setProperty('--ir-interactive-hk-bg', '#e0e0e0');\n            }}\n            onMouseLeave={() => {\n              this.interactiveTitle[room.id]?.style?.removeProperty('--ir-interactive-hk-bg');\n            }}\n          >\n            <ir-interactive-title\n              ref={el => {\n                if (el) this.interactiveTitle[room.id] = el;\n              }}\n              style={room.hk_status === '003' && { '--dot-color': '#ededed' }}\n              hkStatus={calendar_data.housekeeping_enabled && room.hk_status !== '001'}\n              popoverTitle={name}\n            >\n              {room.hk_status !== '001' && (\n                <div slot=\"end\" class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                  {room.hk_status === '004' ? (\n                    <svg height={14} width={14} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\">\n                      <title>Inspected</title>\n                      <path\n                        fill=\"green\"\n                        d=\"M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z\"\n                      />\n                    </svg>\n                  ) : (\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"12\" width=\"13.5\" viewBox=\"0 0 576 512\" style={{ display: 'block' }}>\n                      {room.hk_status === '002' && <title>This unit is dirty</title>}\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z\"\n                      />\n                    </svg>\n                  )}\n                </div>\n              )}\n            </ir-interactive-title>\n          </div>\n          {this.getGeneralRoomDayColumns(this.getRoomId(room), roomCategory, name)}\n        </div>\n      );\n    });\n  }\n\n  private getRoomRows() {\n    return this.calendarData.roomsInfo?.map((roomCategory, index) => {\n      if (roomCategory.is_active) {\n        return (\n          <Fragment>\n            {this.getRoomCategoryRow(roomCategory, index)}\n            {roomCategory.expanded && this.getRoomsByCategory(roomCategory)}\n          </Fragment>\n        );\n      } else {\n        return null;\n      }\n    });\n  }\n  private async confirmHousekeepingUpdate(e: CustomEvent, status: RoomHkStatus) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      this.isLoading = status === '004' ? 'right' : 'middle';\n      await this.housekeepingService.setExposedUnitHKStatus({\n        property_id: this.propertyId,\n        // housekeeper: this.selectedRoom?.housekeeper ? { id: this.selectedRoom?.housekeeper?.id } : null,\n        status: {\n          code: status,\n        },\n        unit: {\n          id: this.selectedRoom?.id,\n        },\n      });\n      if (['001', '004'].includes(status)) {\n        await this.housekeepingService.executeHKAction({\n          actions: [\n            {\n              description: 'Cleaned',\n              hkm_id: this.selectedRoom?.housekeeper?.id || null,\n              unit_id: this.selectedRoom?.id,\n              booking_nbr: this.bookingMap.get(this.selectedRoom?.id) ?? null,\n              status: status as any,\n            },\n          ],\n        });\n      }\n    } finally {\n      this.isLoading = null;\n      this.selectedRoom = null;\n      this.hkModal.closeModal();\n    }\n  }\n  render() {\n    return (\n      <Host>\n        <div class=\"bodyContainer\">\n          {this.getRoomRows()}\n          <div class=\"bookingEventsContainer preventPageScroll\">\n            {this.getBookingData()?.map(bookingEvent => {\n              return (\n                <igl-booking-event\n                  data-testid={`booking_${bookingEvent.BOOKING_NUMBER}`}\n                  data-room-name={bookingEvent.roomsInfo?.find(r => r.id === bookingEvent.RATE_TYPE)?.physicalrooms.find(r => r.id === bookingEvent.PR_ID)?.name}\n                  language={this.language}\n                  is_vacation_rental={this.calendarData.is_vacation_rental}\n                  countries={this.countries}\n                  currency={this.currency}\n                  data-component-id={bookingEvent.ID}\n                  bookingEvent={bookingEvent}\n                  allBookingEvents={this.getBookingData()}\n                ></igl-booking-event>\n              );\n            })}\n          </div>\n        </div>\n        <ir-modal\n          ref={el => (this.hkModal = el)}\n          leftBtnText={locales?.entries?.Lcz_Cancel}\n          middleBtnText={this.renderModalMiddleButtonText()}\n          middleBtnActive\n          rightBtnText={this.renderModalRightButtonText()}\n          modalBody={this.renderModalBody()}\n          onConfirmModal={e => this.confirmHousekeepingUpdate(e, '004')}\n          onMiddleModal={e => this.confirmHousekeepingUpdate(e, this.selectedRoom?.hk_status === '002' ? '001' : '002')}\n          autoClose={false}\n          isMiddleButtonLoading={this.isLoading === 'middle'}\n          isLoading={this.isLoading === 'right'}\n          onCancelModal={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.selectedRoom = null;\n            this.hkModal.closeModal();\n          }}\n        ></ir-modal>\n      </Host>\n    );\n  }\n\n  private renderModalBody() {\n    if (!this.selectedRoom) {\n      return null;\n    }\n    return (\n      <p>Update unit {this.selectedRoom?.name} to ...</p>\n      // <ir-select\n      //   showFirstOption={false}\n      //   selectedValue={this.selectedRoom?.hk_status === '001' ? '001' : '002'}\n      //   data={[\n      //     { text: 'Clean', value: '001' },\n      //     { text: 'Dirty', value: '002' },\n      //   ]}\n      //   onSelectChange={e => (this.selectedHKStatus = e.detail)}\n      // ></ir-select>\n    );\n  }\n  private renderModalMiddleButtonText() {\n    if (!this.selectedRoom) {\n      return null;\n    }\n    return this.selectedRoom.hk_status === '002' ? 'Clean' : 'Dirty';\n  }\n  private renderModalRightButtonText() {\n    if (!this.selectedRoom) {\n      return null;\n    }\n    return this.selectedRoom.hk_status !== '004' ? 'Clean & Inspected' : 'Clean';\n  }\n\n  private updateDisabledCellsCache() {\n    calendar_dates.disabled_cells.clear();\n    this.calendarData.roomsInfo?.forEach((roomCategory, categoryIndex) => {\n      if (roomCategory.is_active) {\n        this.getCategoryRooms(roomCategory)?.forEach(room => {\n          if (room.is_active) {\n            this.calendarData.days.forEach(dayInfo => {\n              const cellKey = this.getCellKey(room.id, dayInfo.value);\n              calendar_dates.disabled_cells.set(cellKey, {\n                disabled: !dayInfo.rate[categoryIndex].is_available_to_book,\n                reason: 'stop_sale',\n              });\n            });\n          }\n        });\n      }\n    });\n  }\n\n  private getCellKey(roomId: number, day: string): string {\n    return `${roomId}_${day}`;\n  }\n\n  private isCellDisabled(roomId: number, day: string): boolean {\n    const key = this.getCellKey(roomId, day);\n    if (!calendar_dates.disabled_cells.has(key)) {\n      return false;\n    }\n    const { disabled } = calendar_dates.disabled_cells.get(key);\n    return disabled;\n  }\n}\n",":host {\n  display: block;\n  position: sticky;\n  bottom: 0;\n  width: max-content;\n  z-index: 3;\n}\n\n.footerCell {\n  display: -moz-inline-grid;\n  display: -ms-inline-grid;\n  display: inline-grid;\n  position: -webkit-sticky;\n  position: sticky;\n  bottom: 0;\n  width: 58px;\n  height: 40px;\n  /* color: #b8b6b7; */\n  background: #fff;\n  vertical-align: top;\n  border-top: 1px solid #e0e0e0;\n}\n\n.bottomLeftCell {\n  left: -1px;\n  z-index: 2;\n  width: 170px;\n  text-align: left;\n  padding-left: 15px;\n  color: #000000;\n}\n\n.footerCell i {\n  margin-right: 5px;\n}\n\n.legendBtn {\n  color: #41bff3;\n  cursor: pointer;\n}\n.legendBtn:hover {\n  color: #1e29ca;\n}\n\n.isOnline i {\n  color: #2f9c3f;\n  font-weight: bold;\n}\n\n.isOffline i {\n  font-weight: bold;\n}\n\n.isOffline {\n  color: #a40000;\n}\n\n.dayTitle {\n  font-size: 0.8em;\n  font-weight: 600;\n  display: grid;\n  user-select: none;\n  /* height: 100%;\n  \n  align-items: center;\n  text-align: center;\n  width: 100%; */\n}\n\n.currentDay .dayTitle {\n  font-weight: bold;\n  /* color: #262b31; */\n}\n\n.currentDay {\n  background-color: #e3f3fa;\n}\n\n.dayCapacityPercent {\n  font-size: 0.75em;\n}\n\n.badge-pill {\n  padding-left: 1em;\n  padding-right: 1em;\n  font-size: 0.7em;\n  margin-bottom: 2px;\n}\n\n.weekend {\n  font-weight: bold;\n  color: black;\n}\n","import locales from '@/stores/locales.store';\nimport { isWeekend } from '@/utils/utils';\nimport { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\nimport moment from 'moment';\n\n@Component({\n  tag: 'igl-cal-footer',\n  styleUrl: 'igl-cal-footer.css',\n  scoped: true,\n})\nexport class IglCalFooter {\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\n  @Prop() calendarData: { [key: string]: any };\n  @Prop() isLegendOpen: boolean = false;\n  @Prop() today: String;\n  @Prop() highlightedDate: string;\n\n  private _today = moment().format('YYYY-MM-DD');\n\n  // private isOnline:boolean = false;\n\n  handleOptionEvent(key, data = '') {\n    this.optionEvent.emit({ key, data });\n  }\n\n  render() {\n    return (\n      <Host class=\"footerContainer\">\n        <div class=\"footerCell bottomLeftCell align-items-center preventPageScroll\" style={{ paddingLeft: '10px' }}>\n          <button class=\"m-0 p-0 btn btn-sm  legendBtn d-flex align-items-center\" style={{ gap: '0.25rem' }} onClick={() => this.handleOptionEvent('showLegend')}>\n            {this.isLegendOpen ? (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\" height={16} width={16}>\n                <path\n                  fill=\"currentColor\"\n                  d=\"M105.4 297.4C92.9 309.9 92.9 330.2 105.4 342.7L265.4 502.7C277.9 515.2 298.2 515.2 310.7 502.7C323.2 490.2 323.2 469.9 310.7 457.4L173.3 320L310.6 182.6C323.1 170.1 323.1 149.8 310.6 137.3C298.1 124.8 277.8 124.8 265.3 137.3L105.3 297.3zM457.4 137.4L297.4 297.4C284.9 309.9 284.9 330.2 297.4 342.7L457.4 502.7C469.9 515.2 490.2 515.2 502.7 502.7C515.2 490.2 515.2 469.9 502.7 457.4L365.3 320L502.6 182.6C515.1 170.1 515.1 149.8 502.6 137.3C490.1 124.8 469.8 124.8 457.3 137.3z\"\n                />\n              </svg>\n            ) : (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\" height={16} width={16}>\n                <path\n                  fill=\"currentColor\"\n                  d=\"M535.1 342.6C547.6 330.1 547.6 309.8 535.1 297.3L375.1 137.3C362.6 124.8 342.3 124.8 329.8 137.3C317.3 149.8 317.3 170.1 329.8 182.6L467.2 320L329.9 457.4C317.4 469.9 317.4 490.2 329.9 502.7C342.4 515.2 362.7 515.2 375.2 502.7L535.2 342.7zM183.1 502.6L343.1 342.6C355.6 330.1 355.6 309.8 343.1 297.3L183.1 137.3C170.6 124.8 150.3 124.8 137.8 137.3C125.3 149.8 125.3 170.1 137.8 182.6L275.2 320L137.9 457.4C125.4 469.9 125.4 490.2 137.9 502.7C150.4 515.2 170.7 515.2 183.2 502.7z\"\n                />\n              </svg>\n            )}\n            <span>{locales.entries.Lcz_Legend}</span>\n            <span>v1.05</span>\n            <ir-new-badge style={{ marginLeft: '0.25rem' }}></ir-new-badge>\n          </button>\n          {/* <div class={`${this.isOnline ? 'isOnline' : 'isOffline'}`}>\n            <i class=\"la la-share-alt isOffline\"></i><span>{this.isOnline ? \"Connected\": \"Offline\"}</span>\n          </div> */}\n        </div>\n\n        {this.calendarData.days.map(dayInfo => (\n          <div class=\"footerCell align-items-center\">\n            <div\n              class={{\n                'dayTitle full-height align-items-center': true,\n                'weekend': isWeekend(dayInfo.value),\n                'currentDay': dayInfo.value === this._today || this.highlightedDate === dayInfo.day,\n              }}\n            >\n              {dayInfo.dayDisplayName}\n            </div>\n\n            {/* <div class=\"dayTitle\">{dayInfo.dayDisplayName}</div>\n              <div class=\"dayCapacityPercent\">28.57%</div>\n              <div class=\"preventPageScroll\">\n                <span class=\"badge badge-primary badge-pill\">\n                  {index}\n                </span>\n              </div> */}\n          </div>\n        ))}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  position: absolute;\n  top: 0;\n  height: 100%;\n}\n.svg-icon {\n  height: 20px;\n  width: 20px;\n}\n.darkGrey {\n  background: #ececec;\n}\n.btn {\n  pointer-events: auto;\n}\n.dayTitle.weekend {\n  font-weight: bold;\n  color: #1e9ff2;\n  color: black;\n}\n.stickyCell {\n  display: -ms-inline-grid;\n  display: -moz-inline-grid;\n  display: inline-grid;\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0px;\n  height: 82px;\n  display: inline-block;\n  vertical-align: top;\n  z-index: 2;\n}\n\n.headersContainer {\n  background-color: #ffffff;\n}\n\n.headerCell {\n  display: inline-grid;\n  width: 58px;\n  height: 58px;\n  vertical-align: top;\n  background-color: #ffffff;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.monthsContainer {\n  height: 20px;\n  background-color: #ffffff;\n  margin-bottom: 0.2em;\n}\n\n.monthCell {\n  display: inline-grid;\n  height: 20px;\n  background-color: #ececec;\n  border-right: 1px solid #c7c7c7;\n  vertical-align: top;\n}\n\n.monthCell:nth-child(odd) {\n  background-color: #dddddd;\n}\n\n.monthTitle {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 0.9em;\n  text-transform: uppercase;\n  font-weight: bold;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.topLeftCell {\n  left: 0px;\n  z-index: 3;\n  width: 170px;\n  background-color: #ffffff;\n  display: -ms-inline-grid;\n  display: -moz-inline-grid;\n  display: inline-grid;\n}\n.datePickerHidden {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  opacity: 0;\n  cursor: pointer;\n  /* z-index: 1; */\n  z-index: 1;\n}\n\n.date_btn {\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n\n.date_btn:hover {\n  background: #f6f6f6;\n  border-radius: 0.3rem;\n}\n.caledarBtns {\n  position: relative;\n  cursor: pointer;\n  padding: 0.4rem;\n}\n\n.caledarBtns:hover {\n  background-color: #f6f6f6;\n}\n\n.dayTitle {\n  font-size: 0.8em;\n  font-weight: 600;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.currentDay .dayTitle {\n  font-weight: bold;\n}\n\n.currentDay {\n  background-color: #e3f3fa;\n}\n\n.dayCapacityPercent {\n  font-size: 0.75em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.badge-pill {\n  padding: 3px 1em;\n  font-size: 0.8em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.pointer {\n  cursor: pointer;\n}\n\n.searchContiner {\n  padding-left: 10px;\n  padding-right: 10px;\n}\n\n.searchListContainer {\n  background: #fff;\n  border: 1px solid #ccc;\n  border-bottom: none;\n}\n\n.searchListItem {\n  background: white;\n  border-bottom: 1px solid #ccc;\n  padding-left: 8px;\n}\n\n.badge-light {\n  background-color: #999999;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n.min-width-full {\n  min-width: 100%;\n}\n.header__fd-actions {\n  display: flex;\n  width: 170px;\n  box-sizing: border-box;\n  /* padding: 10px; */\n  gap: 0.875rem;\n\n  flex-direction: column;\n}\n","import { Component, Event, EventEmitter, Host, Prop, h, State, Listen, Watch } from '@stencil/core';\nimport { ToBeAssignedService } from '@/services/toBeAssigned.service';\nimport { dateToFormattedString, isWeekend } from '@/utils/utils';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { handleUnAssignedDatesChange } from '@/stores/unassigned_dates.store';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\n\n@Component({\n  tag: 'igl-cal-header',\n  styleUrl: 'igl-cal-header.css',\n  scoped: true,\n})\nexport class IglCalHeader {\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\n  @Event({ bubbles: true, composed: true }) gotoRoomEvent: EventEmitter<{\n    [key: string]: any;\n  }>;\n  @Event({ bubbles: true, composed: true }) gotoToBeAssignedDate: EventEmitter<{\n    [key: string]: any;\n  }>;\n  @Prop() calendarData: { [key: string]: any };\n  @Prop() today: String;\n  @Prop() propertyid: number;\n  @Prop() unassignedDates;\n  @Prop() to_date: string;\n  @Prop() highlightedDate: string;\n  @State() renderAgain: boolean = false;\n  @State() unassignedRoomsNumber: any = {};\n  // private searchValue: string = '';\n  // private searchList: { [key: string]: any }[] = [];\n  private roomsList: { [key: string]: any }[] = [];\n  private toBeAssignedService = new ToBeAssignedService();\n  dateRef: HTMLIrButtonElement;\n  componentWillLoad() {\n    try {\n      this.initializeRoomsList();\n\n      if (!this.calendarData.is_vacation_rental) {\n        handleUnAssignedDatesChange('unassigned_dates', newValue => {\n          if (Object.keys(newValue).length > 0) {\n            this.fetchAndAssignUnassignedRooms();\n          }\n        });\n      }\n    } catch (error) {\n      console.error('Error in componentWillLoad:', error);\n    }\n  }\n  @Watch('unassignedDates')\n  handleCalendarDataChanged() {\n    this.fetchAndAssignUnassignedRooms();\n  }\n  private initializeRoomsList() {\n    this.roomsList = [];\n    this.calendarData.roomsInfo.forEach(category => {\n      this.roomsList = this.roomsList.concat(...category.physicalrooms);\n    });\n  }\n\n  private async fetchAndAssignUnassignedRooms() {\n    await this.assignRoomsToDate();\n  }\n\n  private async assignRoomsToDate() {\n    try {\n      const { fromDate, toDate, data } = this.unassignedDates;\n      let dt = new Date(fromDate);\n      dt.setHours(0, 0, 0, 0);\n      let endDate = dt.getTime();\n      while (endDate <= new Date(toDate).getTime()) {\n        const selectedDate = moment(endDate).format('D_M_YYYY');\n        if (data[endDate]) {\n          const result = await this.toBeAssignedService.getUnassignedRooms(\n            { from_date: this.calendarData.from_date, to_date: this.calendarData.to_date },\n            this.propertyid,\n            dateToFormattedString(new Date(endDate)),\n            this.calendarData.roomsInfo,\n            this.calendarData.formattedLegendData,\n          );\n          this.unassignedRoomsNumber[selectedDate] = result.length;\n        } else if (this.unassignedRoomsNumber[selectedDate]) {\n          const res = this.unassignedRoomsNumber[selectedDate] - 1;\n          this.unassignedRoomsNumber[selectedDate] = res < 0 ? 0 : res;\n        }\n        const newEndDate = moment(endDate).add(1, 'days').toDate();\n        newEndDate.setHours(0, 0, 0, 0);\n        endDate = newEndDate.getTime();\n        this.renderView();\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  @Listen('reduceAvailableUnitEvent', { target: 'window' })\n  handleReduceAvailableUnitEvent(event: CustomEvent<{ fromDate: string; toDate: string }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const { fromDate, toDate } = event.detail;\n    let endDate = new Date(fromDate).getTime();\n    while (endDate < new Date(toDate).getTime()) {\n      const selectedDate = moment(endDate).format('D_M_YYYY');\n      this.unassignedRoomsNumber[selectedDate] = this.unassignedRoomsNumber[selectedDate] - 1;\n      endDate = moment(endDate).add(1, 'days').toDate().getTime();\n    }\n    this.renderView();\n  }\n\n  showToBeAssigned(dayInfo) {\n    if (this.unassignedRoomsNumber[dayInfo.day] || 0) {\n      this.handleOptionEvent('showAssigned');\n      setTimeout(() => {\n        this.gotoToBeAssignedDate.emit({\n          key: 'gotoToBeAssignedDate',\n          data: dayInfo.currentDate,\n        });\n      }, 100);\n    } else {\n      // do nothing as the value is 0;\n    }\n  }\n\n  handleOptionEvent(key, data: any = '') {\n    this.optionEvent.emit({ key, data });\n  }\n\n  handleDateSelect(event: CustomEvent) {\n    if (Object.keys(event.detail).length > 0) {\n      this.handleOptionEvent('calendar', event.detail);\n    }\n  }\n\n  handleClearSearch() {\n    // this.searchValue = '';\n    // this.searchList = [];\n    this.renderView();\n  }\n\n  handleFilterRooms(event: Event) {\n    const inputElement = event.target as HTMLInputElement;\n    let value = inputElement.value.trim();\n    // this.searchValue = value;\n    value = value.toLowerCase();\n    if (value === '') {\n      this.handleClearSearch();\n    } else {\n      // this.searchList = this.roomsList.filter(room => room.name.toLocaleLowerCase().indexOf(value) != -1);\n    }\n    this.renderView();\n  }\n\n  handleScrollToRoom(roomId) {\n    this.handleClearSearch();\n    this.gotoRoomEvent.emit({ key: 'gotoRoom', roomId });\n  }\n\n  getStringDateFormat(dt) {\n    return dt.getFullYear() + '-' + (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1) + '-' + (dt.getDate() <= 9 ? '0' : '') + dt.getDate();\n  }\n\n  getNewBookingModel() {\n    let today = new Date();\n    today.setHours(0, 0, 0, 0);\n    let from_date = this.getStringDateFormat(today);\n    today.setDate(today.getDate() + 1);\n    today.setHours(0, 0, 0, 0);\n    let to_date = this.getStringDateFormat(today);\n    return {\n      ID: '',\n      NAME: '',\n      EMAIL: '',\n      PHONE: '',\n      REFERENCE_TYPE: 'PHONE',\n      FROM_DATE: from_date, // \"2023-07-09\",\n      TO_DATE: to_date, // \"2023-07-11\",\n      roomsInfo: this.calendarData.roomsInfo,\n      TITLE: locales.entries.Lcz_NewBooking,\n      event_type: 'PLUS_BOOKING',\n      legendData: this.calendarData.formattedLegendData,\n      defaultDateRange: {\n        fromDate: new Date(from_date), //new Date(\"2023-09-10\"),\n        fromDateStr: '', //\"10 Sep 2023\",\n        toDate: new Date(to_date), //new Date(\"2023-09-15\"),\n        toDateStr: '', // \"15 Sep 2023\",\n        dateDifference: 0,\n        editabled: true,\n        message: '',\n      },\n    };\n  }\n\n  renderView() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class=\"stickyCell align-items-center topLeftCell preventPageScroll\">\n          <div class=\"header__fd-actions\">\n            <div class=\"row justify-content-around no-gutters\">\n              {/* {!this.calendarData.is_vacation_rental && (\n              <div\n                class=\"caledarBtns\"\n                onClick={() => this.handleOptionEvent('showAssigned')}\n                data-toggle=\"tooltip\"\n                data-placement=\"bottom\"\n                title={locales.entries.Lcz_UnassignedUnitsTooltip}\n              >\n\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-icon\">\n                  <path\n                    fill=\"#6b6f82\"\n                    d=\"M448 160H320V128H448v32zM48 64C21.5 64 0 85.5 0 112v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zM448 352v32H192V352H448zM48 288c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48H48z\"\n                  />\n                </svg>\n              </div>\n            )} */}\n              {/* <div class=\"caledarBtns\" onClick={() => this.handleOptionEvent('calendar')} data-toggle=\"tooltip\" data-placement=\"bottom\" title={locales.entries.Lcz_Navigate}>\n          \n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class={'svg-icon'}>\n                <path\n                  fill=\"#6b6f82\"\n                  d=\"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z\"\n                />\n              </svg>\n\n              </div> */}\n              {/* <div class=\"caledarBtns\" onClick={() => this.handleOptionEvent('gotoToday')} data-toggle=\"tooltip\" data-placement=\"bottom\" title={locales.entries.Lcz_Today}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-icon\">\n              <path\n                  fill=\"#6b6f82\"\n                  d=\"M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z\"\n                />\n                </svg>\n                </div> */}\n              {!this.calendarData.is_vacation_rental && (\n                <ir-button\n                  variant=\"icon\"\n                  icon_name=\"server\"\n                  style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}\n                  data-toggle=\"tooltip\"\n                  data-placement=\"bottom\"\n                  title={locales.entries.Lcz_UnassignedUnitsTooltip}\n                  onClickHandler={() => this.handleOptionEvent('showAssigned')}\n                  btn_styles=\"caledarBtns\"\n                  visibleBackgroundOnHover\n                ></ir-button>\n              )}\n              <ir-date-picker\n                minDate={moment().add(-2, 'months').startOf('month').format('YYYY-MM-DD')}\n                // autoApply\n                // singleDatePicker\n                onDateChanged={evt => {\n                  console.log('evt', evt);\n                  this.handleDateSelect(evt);\n                }}\n                // class=\"datePickerHidden\"\n                class={'date_btn'}\n                title={locales.entries.Lcz_Navigate}\n                data-toggle=\"tooltip\"\n                data-placement=\"bottom\"\n              >\n                <ir-button\n                  slot=\"trigger\"\n                  btn_styles=\"caledarBtns\"\n                  variant=\"icon\"\n                  icon_name=\"calendar\"\n                  style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}\n                  onClickHandler={() => this.handleOptionEvent('calendar')}\n                  visibleBackgroundOnHover\n                  ref={el => (this.dateRef = el)}\n                ></ir-button>\n              </ir-date-picker>\n\n              <ir-button\n                variant=\"icon\"\n                btn_styles=\"caledarBtns\"\n                class={'pointer'}\n                icon_name=\"clock\"\n                visibleBackgroundOnHover\n                style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}\n                data-toggle=\"tooltip\"\n                data-placement=\"bottom\"\n                title={locales.entries.Lcz_Today}\n                onClickHandler={() => this.handleOptionEvent('gotoToday')}\n              ></ir-button>\n              <ir-button\n                variant=\"icon\"\n                btn_styles=\"caledarBtns\"\n                icon_name=\"plus\"\n                data-toggle=\"tooltip\"\n                data-placement=\"bottom\"\n                data-testid=\"new_booking_btn\"\n                title={locales.entries.Lcz_CreateNewBooking}\n                visibleBackgroundOnHover\n                style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}\n                onClickHandler={() => this.handleOptionEvent('add', this.getNewBookingModel())}\n              ></ir-button>\n              <ir-button\n                variant=\"icon\"\n                btn_styles=\"caledarBtns\"\n                icon_name=\"calendar-xmark\"\n                data-toggle=\"tooltip\"\n                data-placement=\"bottom\"\n                data-testid=\"new_bulk_btn\"\n                title={locales.entries.Lcz_StopOpenSale}\n                visibleBackgroundOnHover\n                style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}\n                onClickHandler={() => this.handleOptionEvent('bulk', this.getNewBookingModel())}\n              ></ir-button>\n              {/* <div\n              class=\"caledarBtns\"\n              onClick={() => this.handleOptionEvent('add', this.getNewBookingModel())}\n              data-toggle=\"tooltip\"\n              data-placement=\"bottom\"\n              title={locales.entries.Lcz_CreateNewBooking}\n            >\n\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-icon\">\n                <path\n                  fill=\"#6b6f82\"\n                  d=\"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z\"\n                />\n              </svg>\n            </div> */}\n            </div>\n            {/* <div class=\"row justify-content-around no-gutters searchContiner\">\n            <ir-m-combobox\n              placeholder={locales.entries.Lcz_FindUnit}\n              options={this.roomsList.map(r => ({\n                label: r.name,\n                value: r.id,\n              }))}\n              onOptionChange={e => {\n                console.log(e.detail.value);\n                this.handleScrollToRoom(e.detail.value);\n              }}\n            ></ir-m-combobox>\n          </div> */}\n            <div class=\"searchContiner\">\n              <ir-picker\n                size=\"small\"\n                onCombobox-select={e => {\n                  this.handleScrollToRoom(Number(e.detail.item.value));\n                }}\n              >\n                {this.roomsList.map(room => (\n                  <ir-picker-item label={room.name} value={room.id}>\n                    {room.name}\n                  </ir-picker-item>\n                ))}\n              </ir-picker>\n            </div>\n          </div>\n        </div>\n        <div class=\"stickyCell headersContainer\">\n          <div class=\"monthsContainer\">\n            {this.calendarData.monthsInfo.map(monthInfo => (\n              <div class=\"monthCell\" style={{ width: monthInfo.daysCount * 58 + 'px' }}>\n                <div class=\"monthTitle\">{monthInfo.monthName}</div>\n              </div>\n            ))}\n          </div>\n          {this.calendarData.days.map(dayInfo => {\n            return (\n              <div\n                class={`headerCell align-items-center ${'day-' + dayInfo.day} ${dayInfo.day === this.today || dayInfo.day === this.highlightedDate ? 'currentDay' : ''}`}\n                data-day={dayInfo.day}\n              >\n                {!this.calendarData.is_vacation_rental && (\n                  <div class=\"preventPageScroll\">\n                    <span\n                      class={`badge badge-${this.unassignedRoomsNumber[dayInfo.day] || dayInfo.unassigned_units_nbr !== 0 ? 'info pointer' : 'light'} badge-pill`}\n                      onClick={() => this.showToBeAssigned(dayInfo)}\n                    >\n                      {this.unassignedRoomsNumber[dayInfo.day] || dayInfo.unassigned_units_nbr}\n                    </span>\n                  </div>\n                )}\n\n                <div class={{ dayTitle: true, weekend: isWeekend(dayInfo.value) }}>{dayInfo.dayDisplayName}</div>\n                <div class=\"dayCapacityPercent\">{dayInfo.occupancy}%</div>\n              </div>\n            );\n          })}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n\n/* Legend */\n\n.legendHeader {\n  font-weight: 500;\n  letter-spacing: 0.05rem;\n  font-size: 1.12rem;\n  padding-top: 5px;\n  margin-bottom: 1rem;\n}\n\n.legendCloseBtn {\n  position: absolute;\n  top: 50%;\n  right: 0;\n  cursor: pointer;\n  font-size: 1.75em;\n  line-height: 1em;\n  padding: 0.4rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 3px;\n  transform: translateY(-50%);\n}\n\n.legendCloseBtn:hover {\n  background-color: #f6f6f6;\n}\n\n.stickyHeader {\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0;\n  background-color: #ffffff;\n  z-index: 1;\n}\n\n.legendRow {\n  position: relative;\n  vertical-align: middle;\n  margin-bottom: 0.3rem;\n}\n\n.legendRow div {\n  display: inline-block;\n  vertical-align: middle;\n}\n\n.legend_skew,\n.legend_skew-bordered,\n.legend_skewsplit {\n  transform: skew(-22deg);\n  width: 15px;\n  height: 16px;\n  border-radius: 4px;\n  background-color: var(--ir-skew-background);\n}\n.legend_skew.striped.vertical {\n  --stripe-period: 17px;\n  --stripe-angle: 360deg;\n}\n.legend_skew.striped {\n  --stripe-period: 6px;\n  background: repeating-linear-gradient(\n    var(--stripe-angle, 45deg),\n    var(--ir-skew-background) 0,\n    var(--ir-skew-background) calc(var(--stripe-period) / 2),\n    var(--ir-event-bg-stripe-color) calc(var(--stripe-period) / 2),\n    var(--ir-event-bg-stripe-color) var(--stripe-period)\n  );\n}\n.legend_skew.split {\n  border-right: 4px solid black;\n}\n.legend_skew-bordered {\n  border: 1px solid black;\n}\n.legend_dirty-unit {\n  background-color: white !important;\n  border: 1px solid #e0e0e0;\n  height: 12px;\n  width: 20px;\n  margin-right: 1rem;\n  position: relative;\n}\n.legend_dirty-unit::after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  height: 100%;\n  left: 30%;\n  right: 30%;\n  background-color: #d4d0be !important;\n}\n\n.legend_circle {\n  border-radius: 100%;\n  width: 10px;\n  height: 10px;\n  margin: 3px 3px 3px 2px;\n}\n\n.legend_skewsplit {\n  border-right: 2px solid #000000;\n}\n.headerCell .blueColor {\n  background-color: #31bef1;\n}\n.greenColor {\n  background-color: #45b16d;\n}\n.yellowColor {\n  background-color: #f4d552;\n}\n.greyColor {\n  background-color: #a0a0a0;\n}\n.redColor {\n  background-color: #f34752;\n}\n.pinkColor {\n  background-color: #f9b4b7;\n}\n\n/* Legend Calendar */\n\n.legendCalendar .legendRow {\n  margin-bottom: 0;\n}\n\n.legendCalendar .legendRow:first-child .legendCal {\n  background-color: #ececec;\n}\n\n.legendCalendar .legendRow div {\n  display: inline-block;\n  vertical-align: middle;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n.total-availability {\n  font-size: 1em !important;\n}\n.legendCalendar .legendCal {\n  width: 80px;\n  height: 25px;\n  text-align: center;\n  display: inline-grid !important;\n  align-content: center;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.legendCalendar .legendCal .badge {\n  margin-top: 0.2rem;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.legendCalendar .legendCal.legendCal-h2 {\n  height: 40px;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.br-t {\n  border-top: 1px solid #a0a0a0;\n}\n.br-s {\n  border-left: 1px solid #a0a0a0;\n  border-right: 1px solid #a0a0a0;\n}\n.br-bt {\n  border-bottom: 1px solid #a0a0a0;\n}\n\n.highphenLegend {\n  font-size: 0.9em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.highphenLegend::before {\n  width: 12px;\n  height: 0.5px;\n  content: ' ';\n  background-color: #000000;\n  vertical-align: middle;\n  display: inline-block;\n  margin-left: 5px;\n  margin-right: 5px;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n/* .badge-pill {\n  padding: 4px 1.1em;\n  font-size: 0.9em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n} */\n.badge-pill {\n  padding: 3px 1em;\n  font-size: 0.8em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n\n.legendRow-editor {\n  vertical-align: top;\n}\n\n.legendColorCell {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding-right: 0.5rem;\n}\n\n.legendColorPicker {\n  appearance: none;\n  border: none;\n  background: none;\n  cursor: pointer;\n  width: 30px;\n  height: 30px;\n  padding: 0;\n}\n\n.legendColorPicker::-webkit-color-swatch {\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n}\n\n.legendColorPicker::-moz-color-swatch {\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n}\n\n.legendDetailsCell {\n  min-width: 220px;\n}\n\n.legendInput,\n.legendTextarea {\n  width: 100%;\n  border: 1px solid #d8d8d8;\n  border-radius: 4px;\n  padding: 0.4rem 0.6rem;\n  font-size: 0.85rem;\n  display: block;\n}\n\n.legendInput {\n  margin-bottom: 0.4rem;\n}\n\n.legendTextarea {\n  resize: vertical;\n}\n\n.legendActionsCell {\n  width: 32px;\n  text-align: right;\n}\n\n.legendRemoveBtn {\n  border: none;\n  background: none;\n  cursor: pointer;\n  font-size: 1.2rem;\n  line-height: 1;\n  color: #a0a0a0;\n  padding: 0;\n}\n\n.legendRemoveBtn:hover,\n.legendRemoveBtn:focus {\n  color: #5c5c5c;\n}\n\n.legendEditorFooter {\n  margin-top: 0.75rem;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.legendAddBtn {\n  border: 1px solid #d8d8d8;\n  border-radius: 4px;\n  background-color: #ffffff;\n  padding: 0.35rem 0.75rem;\n  font-size: 0.85rem;\n  cursor: pointer;\n}\n\n.legendAddBtn:hover,\n.legendAddBtn:focus {\n  border-color: #b3b3b3;\n}\n\n.legendStatus {\n  font-size: 0.75rem;\n}\n\n.legendStatus.saving {\n  color: #6b6f82;\n}\n\n.legendStatus.success {\n  color: #2e7d32;\n}\n\n.legendStatus.error {\n  color: #d32f2f;\n}\n\n.headerCell {\n  width: 70px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.dayTitle {\n  font-size: 0.8em;\n  font-weight: 600;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n.dayCapacityPercent {\n  font-size: 0.75em;\n  -webkit-user-select: none;\n  user-select: none;\n  -webkit-user-drag: none;\n}\n.legend_rectangle {\n  height: 12px;\n  width: 20px;\n  margin-right: 1rem;\n}\n","import { BookingColor } from '@/models/booking.dto';\nimport { PropertyService } from '@/services/property.service';\nimport calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\n\ntype SaveState = 'idle' | 'saving' | 'saved' | 'error';\n\n@Component({\n  tag: 'igl-legends',\n  styleUrl: 'igl-legends.css',\n  scoped: true,\n})\nexport class IglLegends {\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\n  @Prop() legendData: { [key: string]: any };\n  private propertyService = new PropertyService();\n\n  @State() bookingColors: BookingColor[] = [];\n  @State() saveState: SaveState = 'idle';\n  @State() saveError?: string;\n  @State() loadingIndex: number[] = [];\n\n  private saveTimeout?: number;\n\n  disconnectedCallback() {\n    if (this.saveTimeout) {\n      clearTimeout(this.saveTimeout);\n    }\n  }\n\n  @Watch('saveState')\n  handleSaveStateChange(newValue: SaveState) {\n    if (newValue === 'error' || newValue === 'idle') {\n      this.loadingIndex = [];\n    }\n  }\n\n  handleOptionEvent(key, data = '') {\n    this.optionEvent.emit({ key, data });\n  }\n\n  private syncCalendarExtra(colors: BookingColor[]) {\n    const calendarExtra = calendar_data.property.calendar_extra ?? {};\n    calendar_data.property.calendar_extra = {\n      ...calendarExtra,\n      booking_colors: colors.map(color => ({ ...color })),\n    };\n  }\n\n  private get propertyId(): number | null {\n    return calendar_data.property?.id ?? calendar_data.property.id ?? null;\n  }\n\n  private updateBookingColor(index: number, patch: Partial<BookingColor>) {\n    const bookingColors = calendar_data.property.calendar_extra?.booking_colors.map((color, idx) => (idx === index ? { ...color, ...patch } : color));\n    this.syncCalendarExtra(bookingColors);\n    if (this.saveState === 'saved') {\n      this.saveState = 'idle';\n    }\n  }\n\n  private async persistBookingColors() {\n    const propertyId = this.propertyId;\n    if (!propertyId) {\n      return;\n    }\n\n    if (this.saveState === 'saving') {\n      return;\n    }\n    this.saveState = 'saving';\n    this.saveError = undefined;\n\n    try {\n      await this.propertyService.setPropertyCalendarExtra({\n        property_id: propertyId,\n        value: JSON.stringify(calendar_data.property.calendar_extra),\n      });\n      this.saveState = 'saved';\n      if (this.saveTimeout) {\n        clearTimeout(this.saveTimeout);\n      }\n      this.saveTimeout = window.setTimeout(() => {\n        this.saveState = 'idle';\n        this.saveTimeout = undefined;\n      }, 2000);\n    } catch (error) {\n      this.saveState = 'error';\n      this.saveError = error instanceof Error ? error.message : String(error);\n    }\n  }\n\n  private handleNameInput(index: number, value: string) {\n    this.updateBookingColor(index, { name: value });\n  }\n\n  private handleBlur(index: number) {\n    this.persistBookingColors();\n    if (!this.loadingIndex.includes(index)) {\n      this.loadingIndex = [...this.loadingIndex, index];\n    }\n  }\n\n  private handleLoaderComplete(index: number) {\n    this.loadingIndex = this.loadingIndex.filter(currentIndex => currentIndex !== index);\n  }\n\n  render() {\n    return (\n      <Host class=\"legendContainer pr-1 text-left pb-4\">\n        <div class={'w-full'}>\n          <div class={'w-full'}>\n            <div class=\"stickyHeader pt-1 \">\n              <p class=\"legendHeader\">{locales.entries.Lcz_Legend}</p>\n              <div class=\"legendCloseBtn\" onClick={() => this.handleOptionEvent('closeSideMenu')}>\n                {/* <i class=\"ft-chevrons-left\"></i> */}\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\n                  <path\n                    fill=\"#6b6f82\"\n                    d=\"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z\"\n                  />\n                </svg>\n              </div>\n              <hr />\n            </div>\n            <div class=\"mt-2 pl-1\">\n              <table>\n                {(() => {\n                  const legendInfo = this.legendData.find(l => l.id === '14');\n                  return (\n                    <tr>\n                      <td>\n                        <div class={`legend_${legendInfo.design}`} style={{ '--ir-skew-background': legendInfo.color }}></div>\n                      </td>\n                      <td>\n                        <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                          <span class=\"font-small-3\">{legendInfo.name}</span>\n                          <ir-new-badge></ir-new-badge>\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })()}\n\n                {this.legendData.map(legendInfo => {\n                  if (['1', '2', '3', '14'].includes(legendInfo.id)) {\n                    return null;\n                  }\n                  const stripeColor = calendar_data.colorsForegrounds[legendInfo?.color];\n                  return (\n                    <tr key={`legend_${legendInfo.id}`} class=\"legendRow \">\n                      <td>\n                        {legendInfo.design === 'broom' ? (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"12\" width=\"13.5\" viewBox=\"0 0 576 512\" style={{ display: 'block' }}>\n                            <path\n                              fill=\"black\"\n                              d=\"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z\"\n                            />\n                          </svg>\n                        ) : legendInfo.design === 'check' ? (\n                          <svg height={14} width={14} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\">\n                            <path\n                              fill=\"green\"\n                              d=\"M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z\"\n                            />\n                          </svg>\n                        ) : (\n                          <div\n                            class={`legend_${legendInfo.design} ${\n                              ['1', '7'].includes(legendInfo.id.toString()) ? `striped ${legendInfo.id.toString() === '1' ? 'vertical' : ''}` : ''\n                            }`}\n                            style={{ '--ir-skew-background': legendInfo.color, '--ir-event-bg-stripe-color': stripeColor?.stripe, 'backgroundColor': legendInfo.color }}\n                          ></div>\n                        )}\n                      </td>\n                      <td>\n                        <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                          <span class=\"font-small-3\">{legendInfo.name}</span>\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n                <tr>\n                  <td colSpan={2}>\n                    <hr style={{ marginTop: '0.5rem', marginBottom: '0.5rem' }} />\n                  </td>\n                </tr>\n                <tr>\n                  <th colSpan={2} class=\"\" style={{ paddingBottom: '0.5rem' }}>\n                    <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                      <span>Default colors</span>\n                    </div>\n                  </th>\n                </tr>\n                {this.legendData.map(legendInfo => {\n                  if (!['1', '2', '3'].includes(legendInfo.id)) {\n                    return null;\n                  }\n                  const stripeColor = calendar_data.colorsForegrounds[legendInfo?.color];\n                  return (\n                    <tr key={`legend_${legendInfo.id}`} class=\"legendRow \">\n                      <td>\n                        {legendInfo.design === 'broom' ? (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"12\" width=\"13.5\" viewBox=\"0 0 576 512\" style={{ display: 'block' }}>\n                            <path\n                              fill=\"black\"\n                              d=\"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z\"\n                            />\n                          </svg>\n                        ) : legendInfo.design === 'check' ? (\n                          <svg height={14} width={14} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 640\">\n                            <path\n                              fill=\"green\"\n                              d=\"M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z\"\n                            />\n                          </svg>\n                        ) : (\n                          <div\n                            class={`legend_${legendInfo.design} ${\n                              ['1', '7'].includes(legendInfo.id.toString()) ? `striped ${legendInfo.id.toString() === '1' ? 'vertical' : ''}` : ''\n                            }`}\n                            style={{ '--ir-skew-background': legendInfo.color, '--ir-event-bg-stripe-color': stripeColor?.stripe, 'backgroundColor': legendInfo.color }}\n                          ></div>\n                        )}\n                      </td>\n                      <td>\n                        <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n                          <span class=\"font-small-3\">{legendInfo.name}</span>\n                          {legendInfo.id === '14' && <ir-new-badge></ir-new-badge>}\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n                <tr>\n                  <td colSpan={2}>\n                    <hr style={{ marginTop: '0.5rem', marginBottom: '0.5rem' }} />\n                  </td>\n                </tr>\n                <tr>\n                  <th colSpan={2} style={{ paddingBottom: '0.5rem' }}>\n                    <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                      <span>Use your own colors</span>\n                      <ir-new-badge></ir-new-badge>\n                    </div>\n                  </th>\n                </tr>\n                {calendar_data.property.calendar_extra?.booking_colors.map((legendInfo, index) => {\n                  const previewClass = `legend_${legendInfo.design}`;\n                  return (\n                    <tr key={`legend_${index}`} class=\"legendRow \">\n                      <td>\n                        <div class={previewClass} style={{ backgroundColor: legendInfo.color }}></div>\n                      </td>\n                      <td class=\"legendDetailsCell\">\n                        <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                          <ir-input-text\n                            class=\"legendTextarea border-0 m-0 p-0\"\n                            value={legendInfo.name}\n                            inputContainerStyle={{ margin: '0' }}\n                            placeholder=\"Reason for this color\"\n                            onTextChange={event => this.handleNameInput(index, event.detail)}\n                            onInputBlur={() => this.handleBlur(index)}\n                          ></ir-input-text>\n                          {this.loadingIndex.includes(index) && (this.saveState === 'saving' || this.saveState === 'saved') ? (\n                            <ir-success-loader onLoaderComplete={() => this.handleLoaderComplete(index)}></ir-success-loader>\n                          ) : null}\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n              </table>\n            </div>\n            <hr style={{ marginTop: '1rem', marginBottom: '0.5rem' }} />\n            <div class=\"mt-1\">\n              <div class=\"legendCalendar\">\n                <div class=\"legendRow align-items-center\">\n                  <div class=\"legendCal br-t br-s br-bt\">\n                    <strong>MAR 2022</strong>\n                  </div>\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_MonthAndYear}</div>\n                </div>\n                <div class=\"legendRow\">\n                  <div class=\"legendCal headerCell align-items-center br-s\">\n                    <span class=\"badge badge-info  badge-pill\">3</span>\n                  </div>\n                  <div class=\"highphenLegend\">\n                    <div>{locales.entries.Lcz_UnassignedUnits}</div>\n                  </div>\n                </div>\n                <div class=\"legendRow\">\n                  <div class=\"legendCal dayTitle br-s\">Fri 18</div>\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_Date}</div>\n                </div>\n                <div class=\"legendRow\">\n                  <div class=\"legendCal br-s br-bt dayCapacityPercent\">15%</div>\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_Occupancy}</div>\n                </div>\n                <div class=\"legendRow\">\n                  <div class=\"legendCal br-s br-bt  font-weight-bold total-availability\">20</div>\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_TotalAvailability}</div>\n                </div>\n\n                {/* <div class=\"legendRow align-items-center\">\n                  <div class=\"legendCal br-s br-bt font-small-2\">15</div>\n                  <div class=\"highphenLegend\">\n                    <div>{locales.entries.Lcz_OfflineAvailability}</div>\n                  </div>\n                </div> */}\n              </div>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  text-align: start;\n}\n\n.dialog-body {\n  display: grid;\n  gap: 1.5rem;\n}\n\n.dialog-body__description {\n  margin: 0;\n}\n\n.dialog-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.75rem;\n}\n","import { EventsService } from '@/services/events.service';\nimport { Component, Element, Event, EventEmitter, Fragment, Prop, State, Watch, h } from '@stencil/core';\nimport type { IReallocationPayload } from '@/models/property-types';\nimport type { SelectOption } from '@/utils/utils';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n\n@Component({\n  tag: 'igl-reallocation-dialog',\n  styleUrl: 'igl-reallocation-dialog.css',\n  scoped: true,\n})\nexport class IglReallocationDialog {\n  @Element() hostEl!: HTMLElement;\n\n  @Prop() data?: IReallocationPayload;\n\n  @State() selectedRateplan?: string;\n  @State() showRateplanError = false;\n\n  @Event() dialogClose: EventEmitter<boolean>;\n  @Event() revertBooking: EventEmitter<string>;\n  @Event() resetModalState: EventEmitter<void>;\n\n  private dialogEl?: HTMLIrDialogElement;\n  private rateplanSelectEl?: HTMLIrSelectElement;\n  private eventsService = new EventsService();\n\n  @Watch('data')\n  handleDataChange(newData: IReallocationPayload | undefined) {\n    this.resetState(newData);\n    if (newData) {\n      this.dialogEl?.openModal();\n    } else {\n      this.dialogEl?.closeModal();\n    }\n  }\n\n  private async reallocateUnit() {\n    if (!this.data) {\n      return;\n    }\n\n    if (!this.validateRateplanSelection()) {\n      return;\n    }\n\n    const { pool, toRoomId, from_date, to_date } = this.data;\n    try {\n      await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date, this.data.rateplans ? Number(this.selectedRateplan) : undefined);\n    } catch (error) {\n      console.log(error);\n      this.revertBooking.emit(pool);\n    } finally {\n      this.dialogEl?.closeModal();\n      this.resetModalState.emit();\n    }\n  }\n\n  private get rateplanOptions(): SelectOption[] {\n    if (!Array.isArray(this.data?.rateplans)) {\n      return [];\n    }\n\n    return this.data.rateplans.map(option => ({\n      ...option,\n      text: this.formatRateplanLabel(option),\n    }));\n  }\n\n  private formatRateplanLabel(option: SelectOption): string {\n    if (!option) {\n      return '';\n    }\n\n    const suffix = option.custom_text ? ` | ${option.custom_text}` : '';\n    return `${option.text}${suffix}`.trim();\n  }\n\n  private hasRateplanRequirement(): boolean {\n    return this.rateplanOptions.length > 0;\n  }\n\n  private validateRateplanSelection(): boolean {\n    if (!this.hasRateplanRequirement()) {\n      return true;\n    }\n\n    if (!this.selectedRateplan) {\n      this.showRateplanError = true;\n      this.focusRateplanSelect();\n      return false;\n    }\n\n    return true;\n  }\n\n  private focusRateplanSelect() {\n    const selectEl = this.rateplanSelectEl?.shadowRoot?.querySelector('select') ?? this.rateplanSelectEl?.querySelector('select');\n    if (selectEl) {\n      selectEl.focus();\n    }\n  }\n\n  private resetState(data?: IReallocationPayload) {\n    if (!data) {\n      this.selectedRateplan = undefined;\n      this.showRateplanError = false;\n      return;\n    }\n\n    this.selectedRateplan = undefined;\n    this.showRateplanError = false;\n  }\n\n  private handleDialogVisibilityChange = (_: CustomEvent) => {\n    this.dialogClose.emit(false);\n  };\n\n  private handleRateplanChange = (value: string) => {\n    this.selectedRateplan = value;\n    this.showRateplanError = false;\n  };\n\n  private handleCancelClick = () => {\n    this.dialogEl?.closeModal();\n    this.dialogClose.emit(false);\n  };\n\n  render() {\n    const hasRateplans = this.hasRateplanRequirement();\n\n    return (\n      <ir-dialog label={'Alert'} ref={el => (this.dialogEl = el)} onIrDialogHide={this.handleDialogVisibilityChange}>\n        {this.data && (\n          <Fragment>\n            <div class=\"dialog-body\">\n              <p class=\"text-left dialog-body__description m-0 p-0\">{this.data.description}</p>\n              {hasRateplans && (\n                // <ir-select\n                //   ref={el => (this.rateplanSelectEl = el)}\n                //   required\n                //   firstOption=\"Select rate plan...\"\n                //   data={this.rateplanOptions.map(option => ({ text: option.text, value: option.value }))}\n                //   error={this.showRateplanError}\n                //   onSelectChange={this.handleRateplanChange}\n                // ></ir-select>\n                <wa-select\n                  onwa-hide={e => {\n                    e.stopImmediatePropagation();\n                    e.stopPropagation();\n                  }}\n                  defaultValue={''}\n                  onwa-show={e => {\n                    e.stopImmediatePropagation();\n                    e.stopPropagation();\n                  }}\n                  size=\"small\"\n                  aria-invalid={String(this.showRateplanError)}\n                  onchange={e => this.handleRateplanChange((e.target as any).value)}\n                >\n                  <wa-option value=\"\">Select rate plan...</wa-option>\n                  {this.rateplanOptions.map(option => (\n                    <wa-option key={option.value} value={option.value}>\n                      {option.text}\n                    </wa-option>\n                  ))}\n                </wa-select>\n              )}\n            </div>\n            <div class=\"dialog-footer\" slot=\"footer\">\n              <ir-custom-button appearance=\"filled\" variant=\"neutral\" onClickHandler={this.handleCancelClick} size=\"medium\">\n                Cancel\n              </ir-custom-button>\n              <ir-custom-button variant=\"brand\" onClickHandler={() => this.reallocateUnit()} size=\"medium\" loading={isRequestPending('/ReAllocate_Exposed_Room')}>\n                Confirm\n              </ir-custom-button>\n            </div>\n          </Fragment>\n        )}\n      </ir-dialog>\n    );\n  }\n}\n","import { Moment } from 'moment';\nimport { z } from 'zod';\n\nexport type RoomDates = { from_date: Moment; to_date: Moment };\n\nexport const SelectedUnitSchema = z.object({\n  roomtype_id: z.coerce.number(),\n  unit_id: z.coerce.number(),\n  rateplan_id: z.coerce.number(),\n});\n\nexport type SelectedUnit = z.infer<typeof SelectedUnitSchema>;\n",":host {\n  display: block;\n}\n:host {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 0%;\n  height: 100%;\n}\n.bulk-sheet-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  gap: 1rem;\n}\n.animated-container {\n  transition: all 0.5s ease;\n}\n.physical-room {\n  margin-left: 1rem !important;\n  /* padding-top: 0.5rem; */\n}\n/* target only the last <td> in each .physical-room row */\n.physical-room > td:last-child {\n  padding-left: 1rem; /* or whatever indent you like */\n}\n.room-type-list {\n  padding: 0;\n  margin: 0;\n}\n\n.room-type-list > li,\n.physical-room,\n.room-type-row {\n  list-style: none;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Booking, Room } from '@/models/booking.dto';\nimport { PropertyRoomType } from '@/models/IBooking';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { resetBookingStore } from '@/stores/booking.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { checkMealPlan, SelectOption } from '@/utils/utils';\nimport { Component, Event, EventEmitter, Fragment, Prop, State, h } from '@stencil/core';\nimport moment from 'moment';\nimport { ZodError } from 'zod';\nimport { RoomDates, SelectedUnit, SelectedUnitSchema } from './types';\n\n@Component({\n  tag: 'igl-split-booking',\n  styleUrls: ['igl-split-booking.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglSplitBooking {\n  @Prop() booking: Booking;\n  @Prop() identifier: Room['identifier'];\n\n  @State() selectedDates: RoomDates;\n  @State() room: Room;\n  @State() roomTypes: PropertyRoomType[] = [];\n  @State() selectedUnit: Partial<SelectedUnit> = {};\n  @State() isLoading: boolean;\n  @State() errors: Record<string, boolean> | null;\n  @State() mealPlanOptions: SelectOption[] | null = null;\n\n  @Event() closeModal: EventEmitter<null>;\n\n  private defaultDates: RoomDates;\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.room = this.getRoom();\n    this.defaultDates = { ...this.generateDates(this.room) };\n    this.selectedDates = { ...this.defaultDates };\n    console.log(this.booking);\n  }\n\n  private getRoom() {\n    if (!this.booking) {\n      throw new Error('Missing booking');\n    }\n    if (!this.identifier) {\n      throw new Error('Missing Identifier');\n    }\n    const room = this.booking.rooms.find(r => r.identifier === this.identifier);\n    if (!room) {\n      throw new Error(`Couldn't find room with identifier ${this.identifier}`);\n    }\n    return room;\n  }\n\n  private generateDates(room: Room): RoomDates {\n    let MFromDate = moment(room.from_date, 'YYYY-MM-DD');\n    const MToDate = moment(room.to_date, 'YYYY-MM-DD').add(-1, 'days');\n    const today = moment();\n    if (MFromDate.isBefore(today)) {\n      MFromDate = today.clone();\n    }\n    if (MFromDate.isSame(today)) {\n      return { from_date: MFromDate, to_date: MToDate };\n    }\n    if (MFromDate.isSameOrAfter(today)) {\n      return { from_date: MFromDate.clone().add(1, 'days'), to_date: MToDate };\n    }\n    return { from_date: today.clone().add(1, 'days'), to_date: MToDate };\n  }\n\n  private async checkBookingAvailability() {\n    resetBookingStore(false);\n    const from_date = this.selectedDates.from_date.format('YYYY-MM-DD');\n    const to_date = this.selectedDates.to_date.format('YYYY-MM-DD');\n\n    const is_in_agent_mode = this.booking.agent !== null;\n    try {\n      const data = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.booking.property.id,\n        adultChildCount: {\n          adult: 1,\n          child: 0,\n        },\n        language: 'en',\n        room_type_ids: [],\n        currency: this.booking.currency,\n        agent_id: is_in_agent_mode ? this.booking.agent.id : null,\n        is_in_agent_mode,\n        room_type_ids_to_update: [],\n      });\n      this.roomTypes = data as any as PropertyRoomType[];\n    } catch (error) {\n      console.error('Error initializing booking availability:', error);\n    }\n  }\n\n  private async doReservation() {\n    try {\n      this.isLoading = true;\n      this.errors = null;\n      const selectedUnit = SelectedUnitSchema.parse(this.selectedUnit);\n      const oldRooms = this.booking.rooms.filter(r => r.identifier !== this.identifier);\n      const canCheckIn = this.room.in_out?.code === '001' ? (moment().isBefore(this.selectedDates.from_date) ? false : true) : false;\n      let rooms = [\n        ...oldRooms,\n        {\n          ...this.room,\n          from_date: this.room.from_date,\n          to_date: this.selectedDates.from_date.format('YYYY-MM-DD'),\n          days: this.room.days.filter(r => moment(r.date, 'YYYY-MM-DD').isBefore(this.selectedDates.from_date, 'dates')),\n          departure_time: null,\n        },\n        {\n          ...this.room,\n          identifier: null,\n          in_out: canCheckIn\n            ? this.room.in_out\n            : {\n                code: '000',\n              },\n          check_in: canCheckIn,\n          assigned_units_pool: null,\n          parent_room_identifier: this.room.identifier,\n          is_split: true,\n          roomtype: {\n            id: selectedUnit.roomtype_id,\n          },\n          rateplan: {\n            id: selectedUnit.rateplan_id || this.room.rateplan.id,\n          },\n          departure_time: this.room.departure_time,\n          unit: { id: selectedUnit.unit_id },\n          from_date: this.selectedDates.from_date.format('YYYY-MM-DD'),\n          // to_date: this.selectedDates.to_date.format('YYYY-MM-DD'),\n          days: this.room.days.filter(r => moment(r.date, 'YYYY-MM-DD').isSameOrAfter(this.selectedDates.from_date, 'dates')),\n        },\n      ];\n      const booking = {\n        assign_units: true,\n        is_pms: true,\n        is_direct: this.booking.is_direct,\n        is_backend: true,\n        is_in_loyalty_mode: this.booking.is_in_loyalty_mode,\n        promo_key: this.booking.promo_key,\n        extras: this.booking.extras,\n        agent: this.booking.agent,\n        booking: {\n          from_date: this.booking.from_date,\n          to_date: this.booking.to_date,\n          remark: this.booking.remark,\n          booking_nbr: this.booking.booking_nbr,\n          property: this.booking.property,\n          booked_on: this.booking.booked_on,\n          source: this.booking.source,\n          rooms,\n          currency: this.booking.currency,\n          arrival: this.booking.arrival,\n          guest: this.booking.guest,\n        },\n        pickup_info: this.booking.pickup_info,\n      };\n      console.log(booking);\n      await this.bookingService.doReservation(booking);\n      this.closeModal.emit(null);\n    } catch (error) {\n      const err: Record<string, boolean> = {};\n      if (error instanceof ZodError) {\n        console.error(error);\n        error.issues.forEach(i => {\n          err[i.path[0]] = true;\n        });\n        this.errors = { ...err };\n      }\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private updateSelectedUnit(params: Partial<SelectedUnit>) {\n    const merged: Partial<SelectedUnit> = { ...this.selectedUnit, ...params };\n    const roomTypesSource = calendar_data?.property?.roomtypes;\n    const mealPlanResult = checkMealPlan({\n      rateplan_id: this.room.rateplan.id.toString(),\n      roomTypeId: merged?.roomtype_id,\n      roomTypes: roomTypesSource,\n    });\n\n    const hasExplicitRateplanUpdate = Object.prototype.hasOwnProperty.call(params, 'rateplan_id');\n\n    if (Array.isArray(mealPlanResult)) {\n      this.mealPlanOptions = mealPlanResult;\n      if (!hasExplicitRateplanUpdate) {\n        delete merged.rateplan_id;\n      }\n    } else {\n      this.mealPlanOptions = null;\n      if (!hasExplicitRateplanUpdate) {\n        if (mealPlanResult) {\n          merged.rateplan_id = Number(mealPlanResult.value);\n        } else {\n          delete merged.rateplan_id;\n        }\n      }\n    }\n\n    this.selectedUnit = merged;\n  }\n\n  render() {\n    return (\n      <form\n        onSubmit={e => {\n          e.preventDefault();\n          this.doReservation();\n        }}\n        class=\"sheet-container\"\n      >\n        <ir-title class=\"px-1 sheet-header mb-0\" displayContext=\"sidebar\" onCloseSideBar={() => this.closeModal.emit()} label={`Split unit ${this.room?.unit['name']}`}></ir-title>\n        <section class=\"px-1 sheet-body\">\n          <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n            <div>\n              <ir-date-view from_date={this.room.from_date} to_date={this.room.to_date} showDateDifference={false}></ir-date-view>\n            </div>\n            <p class=\"m-0 p-0\">\n              {this.room.rateplan.short_name} {this.room.rateplan.is_non_refundable ? locales.entries.Lcz_NonRefundable : ''}\n            </p>\n          </div>\n          <div class={'d-flex align-items-center mt-1'} style={{ gap: '0.5rem' }}>\n            <span>From:</span>\n            <ir-date-picker\n              data-testid=\"pickup_arrival_date\"\n              date={this.selectedDates?.from_date?.format('YYYY-MM-DD')}\n              maxDate={this.defaultDates?.to_date.format('YYYY-MM-DD')}\n              minDate={this.defaultDates?.from_date.format('YYYY-MM-DD')}\n              emitEmptyDate={true}\n              // aria-invalid={this.errors?.arrival_date && !this.pickupData.arrival_date ? 'true' : 'false'}\n              onDateChanged={evt => {\n                this.selectedDates = {\n                  ...this.selectedDates,\n                  from_date: evt.detail.start,\n                };\n              }}\n            >\n              <input\n                type=\"text\"\n                slot=\"trigger\"\n                value={this.selectedDates.from_date ? this.selectedDates.from_date.format('MMM DD, YYYY') : null}\n                class={`form-control input-sm  text-center`}\n                style={{ width: '120px' }}\n              ></input>\n            </ir-date-picker>\n            <ir-button isLoading={isRequestPending('/Check_Availability')} text=\"Check available units\" size=\"sm\" onClick={() => this.checkBookingAvailability()}></ir-button>\n          </div>\n          {this.errors?.roomtype_id && <p class=\"text-danger text-left mt-2\">Please select a room</p>}\n          <ul class=\"room-type-list mt-2\">\n            {this.roomTypes?.map(roomType => {\n              if (!roomType.is_available_to_book) {\n                return null;\n              }\n              const units = (() => {\n                const unitMap = new Map<number, string>();\n                for (const rateplan of roomType.rateplans ?? []) {\n                  for (const unit of rateplan.assignable_units ?? []) {\n                    if (unit.Is_Fully_Available) {\n                      unitMap.set(unit.pr_id, unit.name);\n                    }\n                  }\n                }\n\n                return Array.from(unitMap, ([id, name]) => ({ id, name }));\n              })();\n              return (\n                <Fragment>\n                  <li key={`roomTypeRow-${roomType.id}`} class={`room-type-row`}>\n                    <div class={'d-flex choice-row'}>\n                      <span class=\"text-left room-type-name\">{roomType.name}</span>\n                    </div>\n                  </li>\n                  {units.map((room, j) => {\n                    const row_style = j === roomType.physicalrooms.length - 1 ? 'pb-1' : '';\n                    const showMealPlanSelect = this.selectedUnit?.unit_id === room.id && Array.isArray(this.mealPlanOptions) && this.mealPlanOptions.length > 0;\n                    return (\n                      <li key={`physicalRoom-${room.id}-${j}`} class={`physical-room ${row_style}`}>\n                        <div class={'d-flex choice-row align-items-center'} style={{ gap: '0.5rem' }}>\n                          <ir-radio\n                            class=\"pl-1\"\n                            name=\"unit\"\n                            checked={this.selectedUnit?.unit_id === room.id}\n                            onCheckChange={() =>\n                              this.updateSelectedUnit({\n                                roomtype_id: roomType.id,\n                                unit_id: room.id,\n                              })\n                            }\n                            label={room.name}\n                          ></ir-radio>\n                          {showMealPlanSelect && (\n                            <ir-select\n                              firstOption=\"Select a new rateplan...\"\n                              error={this.errors?.rateplan_id && !this.selectedUnit?.rateplan_id}\n                              onSelectChange={e => {\n                                const value = e.detail === null || e.detail === undefined || e.detail === '' ? undefined : Number(e.detail);\n                                this.updateSelectedUnit({\n                                  rateplan_id: value,\n                                });\n                              }}\n                              data={this.mealPlanOptions.map(e => ({ ...e, text: e.text + `${e.custom_text ? ' | ' : ''}${e.custom_text}` }))}\n                            ></ir-select>\n                            // <ir-dropdown\n                            //   onOptionChange={e => {\n                            //     this.updateSelectedUnit({\n                            //       rateplan_id: Number(e.detail.toString()),\n                            //     });\n                            //   }}\n                            //   style={{ '--ir-dropdown-menu-min-width': 'max-content' }}\n                            // >\n                            //   <button type=\"button\" class=\"btn btn-sm form-control pr-2 d-flex align-items-center\" style={{ minWidth: '200px' }} slot=\"trigger\">\n                            //     {this.selectedUnit?.rateplan_id ? this.mealPlanOptions.find(r => r.value === this.selectedUnit.rateplan_id.toString()).text : 'Choose a meal plan'}\n                            //   </button>\n                            //   {this.mealPlanOptions.map(o => (\n                            //     <ir-dropdown-item value={o.value}>\n                            //       <p class=\"m-0 p-0\">\n                            //         {o.text} {o.custom_text && <span class=\"m-0 p-0\">| {o.custom_text}</span>}\n                            //       </p>\n                            //     </ir-dropdown-item>\n                            //   ))}\n                            // </ir-dropdown>\n                          )}\n                        </div>\n                      </li>\n                    );\n                  })}\n                </Fragment>\n              );\n            })}\n          </ul>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class={'flex-fill'} onClickHandler={() => this.closeModal.emit(null)}></ir-button>\n          <ir-button isLoading={this.isLoading} text={locales.entries.Lcz_Confirm} btn_type=\"submit\" class=\"flex-fill\"></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\r\n  display: block;\r\n}\r\n","import { Component, Host, Prop, State, h, Event, EventEmitter } from '@stencil/core';\n\n@Component({\n  tag: 'igl-tba-category-view',\n  styleUrl: 'igl-tba-category-view.css',\n  scoped: true,\n})\nexport class IglTbaCategoryView {\n  @Prop() calendarData: { [key: string]: any };\n  @Prop() selectedDate;\n  @Prop() categoriesData: { [key: string]: any } = {};\n  @Prop() categoryId;\n  @Prop({ mutable: true }) eventDatas;\n  @Prop() categoryIndex;\n\n  @State() renderAgain: boolean = false;\n\n  @Event() assignUnitEvent: EventEmitter<{ [key: string]: any }>;\n\n  handleAssignRoomEvent(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n\n    const opt: { [key: string]: any } = event.detail;\n    this.eventDatas = this.eventDatas.filter(eventData => eventData.ID != opt.data.ID);\n    this.calendarData.bookingEvents.push(opt.data);\n    this.assignUnitEvent.emit({\n      key: 'assignUnit',\n      data: {\n        RT_ID: this.categoryId,\n        selectedDate: this.selectedDate,\n        assignEvent: opt.data,\n        calendarData: this.calendarData,\n      },\n    });\n    // if(this.localEventDatas.length){\n    this.renderView();\n    // }\n  }\n\n  getEventView(categoryId, eventDatas) {\n    return eventDatas.map((eventData, ind) => (\n      <igl-tba-booking-view\n        calendarData={this.calendarData}\n        selectedDate={this.selectedDate}\n        eventData={eventData}\n        categoriesData={this.categoriesData}\n        categoryId={categoryId}\n        categoryIndex={this.categoryIndex}\n        eventIndex={ind}\n        onAssignRoomEvent={evt => this.handleAssignRoomEvent(evt)}\n      ></igl-tba-booking-view>\n    ));\n  }\n\n  renderView() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class=\"sectionContainer\">\n          <div class=\"font-weight-bold mt-1 font-small-3\">{this.categoriesData[this.categoryId]?.name}</div>\n          {this.getEventView(this.categoryId, this.eventDatas)}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.custom-dropdown {\n  cursor: pointer;\n  padding: 5px 10px;\n  width: min-content;\n  margin-left: auto;\n  margin-right: auto;\n}\n.dropdown-toggle {\n  all: unset;\n  display: flex;\n  width: max-content;\n  align-items: center;\n  gap: 10px;\n}\n.close_btn_style {\n  padding: 0.4rem;\n}\n.close_btn_style:hover {\n  background-color: #f6f6f6;\n}\n.dropdown-menu {\n  max-height: 250px;\n  overflow-y: auto;\n}\n.tobeAssignedHeader {\n  font-weight: 500;\n  letter-spacing: 0.05rem;\n  font-size: 1.12rem;\n  padding: 0;\n  margin: 0;\n}\n.assignment_header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-top: 5px;\n  margin-bottom: 1rem;\n}\n.dropdown-toggle::after {\n  content: none;\n  display: none;\n}\n.dropdown-toggle .caret-icon {\n  transition: transform 0.2s ease;\n}\n.show .caret-icon {\n  transform: rotate(-180deg);\n}\n.stickyHeader {\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0;\n  background-color: #ffffff;\n  z-index: 1;\n}\n.pointer {\n  cursor: pointer;\n}\n\n.dots {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 3px;\n  padding: 0;\n}\n.dot {\n  width: 5px;\n  height: 5px;\n  margin: 5px 4px 0;\n  background-color: #6b6f82;\n  border-radius: 50%;\n  animation: dotFlashing 1s infinite linear alternate;\n}\n.dot:nth-child(2) {\n  animation-delay: 0.2s;\n}\n.dot:nth-child(3) {\n  animation-delay: 0.4s;\n}\n\n@keyframes dotFlashing {\n  0% {\n    opacity: 0;\n  }\n  50%,\n  100% {\n    opacity: 1;\n  }\n}\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Listen, Fragment, Watch } from '@stencil/core';\nimport { ToBeAssignedService } from '@/services/toBeAssigned.service';\nimport { dateToFormattedString } from '@/utils/utils';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { getUnassignedDates } from '@/stores/unassigned_dates.store';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\n//import { updateCategories } from '@/utils/events.utils';\n\n@Component({\n  tag: 'igl-to-be-assigned',\n  styleUrl: 'igl-to-be-assigned.css',\n  scoped: true,\n})\nexport class IglToBeAssigned {\n  @Prop() unassignedDatesProp: any;\n  @Prop() propertyid: number;\n  @Prop() from_date: string;\n  @Prop() to_date: string;\n  @Prop({ mutable: true }) calendarData: { [key: string]: any };\n\n  @State() loadingMessage: string;\n  @State() showDatesList: boolean = false;\n  @State() renderAgain: boolean = false;\n  @State() orderedDatesList: any[] = [];\n  @State() noScroll = false;\n\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\n  @Event({ bubbles: true, composed: true })\n  reduceAvailableUnitEvent: EventEmitter<{ [key: string]: any }>;\n  @Event() showBookingPopup: EventEmitter;\n  @Event({ bubbles: true, composed: true }) addToBeAssignedEvent: EventEmitter;\n  @Event({ bubbles: true, composed: true })\n  highlightToBeAssignedBookingEvent: EventEmitter;\n\n  private isGotoToBeAssignedDate: boolean = false;\n  private isLoading: boolean = true;\n  private selectedDate = null;\n  private data: { [key: string]: any } = {};\n  private today = new Date();\n  private categoriesData: { [key: string]: any } = {};\n  private toBeAssignedService: ToBeAssignedService = new ToBeAssignedService();\n  private unassignedDates: any;\n\n  componentWillLoad() {\n    this.reArrangeData();\n    this.loadingMessage = locales.entries.Lcz_FetchingUnAssignedUnits;\n  }\n\n  @Watch('unassignedDatesProp')\n  handleUnassignedDatesToBeAssignedChange(newValue: any) {\n    const { fromDate, toDate, data } = newValue;\n    let dt = new Date(fromDate);\n    dt.setHours(0);\n    dt.setMinutes(0);\n    dt.setSeconds(0);\n    let endDate = dt.getTime();\n    while (endDate <= new Date(toDate).getTime()) {\n      if (data && !data[endDate] && this.unassignedDates.hasOwnProperty(endDate)) {\n        delete this.unassignedDates[endDate];\n      } else if (data && data[endDate]) {\n        this.unassignedDates[endDate] = data[endDate];\n      }\n      endDate = moment(endDate).add(1, 'days').toDate().getTime();\n    }\n    this.data = { ...this.unassignedDates };\n    this.orderedDatesList = Object.keys(this.data).sort((a, b) => parseInt(a) - parseInt(b));\n\n    if (this.orderedDatesList.length) {\n      if (!this.data.hasOwnProperty(this.selectedDate)) {\n        this.selectedDate = this.orderedDatesList.length ? this.orderedDatesList[0] : null;\n      }\n      this.showForDate(this.selectedDate, false);\n      this.renderView();\n    } else {\n      this.selectedDate = null;\n    }\n  }\n  handleAssignUnit(event: CustomEvent<{ [key: string]: any }>) {\n    const opt: { [key: string]: any } = event.detail;\n    const data = opt.data;\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n\n    if (opt?.key === 'assignUnit' && this.data) {\n      // Verify data.selectedDate exists in this.data\n      if (data?.selectedDate && this.data[data.selectedDate]) {\n        // Check if categories exist and there's only one category\n        if (this.data[data.selectedDate]?.categories && Object.keys(this.data[data.selectedDate]?.categories || {})?.length === 1) {\n          this.isLoading = true;\n          this.noScroll = true;\n        }\n\n        // Make sure all required properties exist before filtering\n        if (\n          data?.RT_ID &&\n          this.data[data.selectedDate]?.categories &&\n          this.data[data.selectedDate].categories[data.RT_ID] &&\n          Array.isArray(this.data[data.selectedDate].categories[data.RT_ID]) &&\n          data?.assignEvent?.ID\n        ) {\n          this.data[data.selectedDate].categories[data.RT_ID] = this.data[data.selectedDate].categories[data.RT_ID].filter(\n            eventData => eventData && eventData.ID !== data.assignEvent.ID,\n          );\n        }\n\n        // Only update calendarData if it exists in the data\n        if (data?.calendarData) {\n          this.calendarData = data.calendarData;\n        }\n\n        this.renderView();\n      }\n    }\n  }\n\n  async updateCategories(key, calendarData) {\n    try {\n      //console.log(\"called\")\n      let categorisedRooms = {};\n      const result = await this.toBeAssignedService.getUnassignedRooms(\n        { from_date: calendarData.from_date, to_date: calendarData.to_date },\n        this.propertyid,\n        dateToFormattedString(new Date(+key)),\n        calendarData.roomsInfo,\n        calendarData.formattedLegendData,\n      );\n      result.forEach(room => {\n        if (!categorisedRooms.hasOwnProperty(room.RT_ID)) {\n          categorisedRooms[room.RT_ID] = [room];\n        } else {\n          categorisedRooms[room.RT_ID].push(room);\n        }\n      });\n      this.unassignedDates[key].categories = categorisedRooms;\n    } catch (error) {\n      //  toastr.error(error);\n    }\n  }\n\n  async reArrangeData() {\n    try {\n      this.today.setHours(0, 0, 0, 0);\n      this.calendarData.roomsInfo.forEach(category => {\n        this.categoriesData[category.id] = {\n          name: category.name,\n          roomsList: category.physicalrooms,\n          roomIds: category.physicalrooms.map(room => {\n            return room.id;\n          }),\n        };\n      });\n\n      this.selectedDate = null;\n      //this.unassignedDates = await this.toBeAssignedService.getUnassignedDates(this.propertyid, dateToFormattedString(new Date()), this.to_date);\n      this.unassignedDates = getUnassignedDates();\n      console.log(this.unassignedDates);\n\n      this.data = this.unassignedDates;\n      this.orderedDatesList = Object.keys(this.data).sort((a, b) => parseInt(a) - parseInt(b));\n\n      if (!this.selectedDate && this.orderedDatesList.length) {\n        this.selectedDate = this.orderedDatesList[0];\n      }\n    } catch (error) {\n      console.error('Error fetching unassigned dates:', error);\n      //  toastr.error(error);\n    }\n  }\n  async componentDidLoad() {\n    setTimeout(() => {\n      if (!this.isGotoToBeAssignedDate && Object.keys(this.unassignedDates).length > 0) {\n        //console.log(this.isGotoToBeAssignedDate);\n        const firstKey = Object.keys(this.unassignedDates)[0];\n\n        this.showForDate(firstKey);\n      }\n    }, 100);\n  }\n  @Listen('gotoToBeAssignedDate', { target: 'window' })\n  async gotoDate(event: CustomEvent) {\n    this.isGotoToBeAssignedDate = true;\n    this.showForDate(event.detail.data);\n    this.showDatesList = false;\n    this.renderView();\n  }\n  @Listen('highlightToBeAssignedBookingEvent')\n  handleToBeAssignedDate(e: CustomEvent) {\n    this.showBookingPopup.emit({\n      key: 'calendar',\n      data: new Date(e.detail.data.fromDate).getTime() - 86400000,\n      noScroll: false,\n    });\n  }\n  async showForDate(dateStamp, withLoading = true) {\n    try {\n      if (withLoading) {\n        this.isLoading = true;\n      }\n      if (this.showDatesList) {\n        this.showUnassignedDate();\n      }\n      await this.updateCategories(dateStamp, this.calendarData);\n      this.addToBeAssignedEvent.emit({ key: 'tobeAssignedEvents', data: [] });\n      this.showBookingPopup.emit({\n        key: 'calendar',\n        data: parseInt(dateStamp) - 86400000,\n        noScroll: this.noScroll,\n      });\n      if (this.isGotoToBeAssignedDate) {\n        this.isGotoToBeAssignedDate = false;\n      }\n      this.isLoading = false;\n      this.selectedDate = dateStamp;\n      this.renderView();\n    } catch (error) {\n      // toastr.error(error);\n    }\n  }\n\n  getDay(dt) {\n    const currentDate = new Date(dt);\n    const locale = 'default'; //'en-US';\n    const dayOfWeek = this.getLocalizedDayOfWeek(currentDate, locale);\n    // const monthName = currentDate.toLocaleString(\"default\", { month: 'short' })\n    return dayOfWeek + ' ' + currentDate.getDate() + ', ' + currentDate.getFullYear();\n  }\n\n  getLocalizedDayOfWeek(date, locale) {\n    const options = { weekday: 'short' };\n    return date.toLocaleDateString(locale, options);\n  }\n\n  handleOptionEvent(key, data = '') {\n    this.highlightToBeAssignedBookingEvent.emit({\n      key: 'highlightBookingId',\n      data: { bookingId: '----' },\n    });\n    this.addToBeAssignedEvent.emit({ key: 'tobeAssignedEvents', data: [] });\n    this.optionEvent.emit({ key, data });\n  }\n\n  showUnassignedDate() {\n    this.showDatesList = !this.showDatesList;\n  }\n\n  getToBeAssignedEntities() {\n    // toBeAssignedEvents\n  }\n\n  getCategoryView() {\n    if (this.orderedDatesList.length && this.selectedDate && this.data[this.selectedDate]) {\n      return Object.entries(this.data[this.selectedDate].categories).map(([id, eventDatas], ind) => (\n        <igl-tba-category-view\n          calendarData={this.calendarData}\n          selectedDate={this.selectedDate}\n          categoryId={id}\n          categoryIndex={ind}\n          categoriesData={this.categoriesData}\n          eventDatas={eventDatas}\n          onAssignUnitEvent={evt => this.handleAssignUnit(evt)}\n        ></igl-tba-category-view>\n      ));\n    } else {\n      return null;\n    }\n  }\n\n  renderView() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  render() {\n    return (\n      <Host class=\"tobeAssignedContainer pr-1 text-left\">\n        <div>\n          <div>\n            <div class=\"stickyHeader pt-1\">\n              <div class={'assignment_header'}>\n                <p class=\"tobeAssignedHeader \">{locales.entries.Lcz_Assignments}</p>\n                <ir-button\n                  class=\"close_btn\"\n                  variant=\"icon\"\n                  btn_styles=\"close_btn_style\"\n                  icon_name=\"double_caret_left\"\n                  style={colorVariants.secondary}\n                  onClickHandler={() => this.handleOptionEvent('closeSideMenu')}\n                  visibleBackgroundOnHover\n                ></ir-button>\n              </div>\n              <hr />\n              {Object.keys(this.data).length === 0 ? (\n                <p>{locales.entries.Lcz_AllBookingsAreAssigned}</p>\n              ) : this.isLoading ? (\n                <p class=\"d-flex align-items-center\">\n                  <span class=\"p-0\">{this.loadingMessage}</span>\n                  <div class=\"dots\">\n                    <div class=\"dot\"></div>\n                    <div class=\"dot\"></div>\n                    <div class=\"dot\"></div>\n                  </div>\n                </p>\n              ) : (\n                <Fragment>\n                  {this.orderedDatesList.length ? (\n                    <div\n                      class={`custom-dropdown border border-light rounded text-center ` + (this.showDatesList ? 'show' : '')}\n                      id=\"dropdownMenuButton\"\n                      data-toggle=\"dropdown\"\n                      aria-haspopup=\"true\"\n                      aria-expanded=\"false\"\n                    >\n                      <div\n                        class={'dropdown-toggle'}\n                        //onClick={() => this.showUnassignedDate()}\n                      >\n                        <span class=\"font-weight-bold\">{this.data[this.selectedDate].dateStr}</span>\n                        <svg class={'caret-icon'} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" height={14} width={14}>\n                          <path\n                            fill=\"#6b6f82\"\n                            d=\"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z\"\n                          />\n                        </svg>\n                      </div>\n                      <div class=\"dropdown-menu dropdown-menu-right full-width\" aria-labelledby=\"dropdownMenuButton\">\n                        {this.orderedDatesList?.map(ordDate => (\n                          <div class=\"dropdown-item pointer\" onClick={() => this.showForDate(ordDate)}>\n                            {this.data[ordDate].dateStr}\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ) : (\n                    locales.entries.Lcz_AllBookingsAreAssigned\n                  )}\n                </Fragment>\n              )}\n            </div>\n            {!this.isLoading && (\n              <div class=\"scrollabledArea\">\n                {this.orderedDatesList.length ? (\n                  Object.keys(this.data[this.selectedDate].categories).length ? (\n                    this.getCategoryView()\n                  ) : (\n                    <div class=\"mt-1\">{locales.entries.Lcz_AllAssignForThisDay}</div>\n                  )\n                ) : null}\n              </div>\n            )}\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  width: 100%;\n  --hk-green: green;\n}\n* {\n  box-sizing: border-box;\n}\n.popover-title {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  z-index: 10;\n  left: 0;\n  display: flex;\n  align-items: center;\n}\n.popover-container {\n  position: absolute;\n  bottom: 0px;\n  left: var(--ir-popover-left, 10px);\n  background: rgb(0, 0, 0);\n  color: white;\n  min-width: 100%;\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 10px;\n  z-index: 9999;\n  padding: 3.5px 7px;\n  border-radius: 5px;\n  pointer-events: none;\n  opacity: 0;\n  transition: all 100ms ease;\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1.45;\n  text-decoration: none;\n  text-shadow: none;\n  font-size: 0.875rem;\n}\n.popover-container[data-state='show'] {\n  opacity: 1;\n}\n.hk-dot {\n  inset: 0;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: fit-content;\n  padding: 4px;\n  left: auto;\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n  padding-inline: var(--ir-popover-left);\n  background: var(--ir-interactive-hk-bg, white);\n  color: var(--dot-color, black);\n}\n.hk-dot::slotted(*)[name='end'] {\n  height: 12px;\n}\n\n/* .hk-dot::after {\n  content: '';\n  height: 8px;\n  aspect-ratio: 1;\n  border-radius: 9999999px;\n  background: var(--dot-color, #ffffff);\n} */\n","import { Component, Host, Prop, h, Element } from '@stencil/core';\n\n@Component({\n  tag: 'ir-interactive-title',\n  styleUrl: 'ir-interactive-title.css',\n  scoped: true,\n})\nexport class IrInteractiveTitle {\n  @Element() el: HTMLElement;\n\n  /**\n   * The full title string that may be cropped in the UI.\n   */\n  @Prop() popoverTitle: string = '';\n\n  /**\n   * CSS offset for the left position of the popover.\n   * Used as a CSS variable `--ir-popover-left`.\n   */\n  @Prop() irPopoverLeft: string = '10px';\n\n  /**\n   * Whether to show the housekeeping (HK) status dot.\n   */\n  @Prop() hkStatus: boolean = false;\n\n  /**\n   * The number of characters to display before cropping the title with ellipsis.\n   */\n  @Prop() cropSize: number = 20;\n  /**\n   * The message shown when hovering over the broom svg if provided.\n   * @requires hkStatus to be true\n   */\n  @Prop() broomTooltip: string;\n\n  /**\n   * Reference to track if we've initialized popover for current render\n   */\n  private lastRenderedTitle: string = '';\n  private titleContainerRef: HTMLElement;\n  private popoverInstance: any;\n\n  /**\n   * Initialize popover with overflow detection\n   */\n  private initializePopoverIfNeeded(titleContainer: HTMLElement, title: string) {\n    // Only initialize if title changed or first time\n    if (this.lastRenderedTitle === title && this.popoverInstance) {\n      return;\n    }\n    this.disposePopover();\n\n    const tempSpan = document.createElement('span');\n    tempSpan.style.visibility = 'hidden';\n    tempSpan.style.position = 'absolute';\n    tempSpan.style.whiteSpace = 'nowrap';\n    tempSpan.textContent = title;\n    document.body.appendChild(tempSpan);\n\n    const textWidth = tempSpan.offsetWidth;\n    document.body.removeChild(tempSpan);\n\n    const containerWidth = titleContainer.clientWidth;\n    const iconWidth = this.hkStatus ? 20 : 0;\n\n    const willOverflow = textWidth + iconWidth > containerWidth;\n\n    if (willOverflow && typeof $ !== 'undefined') {\n      try {\n        this.popoverInstance = $(titleContainer).popover({\n          trigger: 'hover',\n          content: title,\n          placement: 'top',\n          html: false,\n          sanitize: true,\n          delay: { show: 300, hide: 100 },\n        });\n      } catch (error) {\n        console.error('Failed to initialize popover:', error);\n      }\n    }\n\n    this.lastRenderedTitle = title;\n  }\n\n  private disposePopover() {\n    if (this.popoverInstance && typeof $ !== 'undefined') {\n      try {\n        $(this.titleContainerRef).popover('dispose');\n        this.popoverInstance = null;\n      } catch (error) {\n        console.error('Failed to dispose popover:', error);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    this.disposePopover();\n  }\n\n  render() {\n    const title = this.popoverTitle || '';\n\n    const shouldCrop = title.length > this.cropSize;\n    const displayTitle = shouldCrop ? title.slice(0, this.cropSize) + '...' : title;\n\n    return (\n      <Host style={{ '--ir-popover-left': this.irPopoverLeft }}>\n        <p\n          ref={el => {\n            this.titleContainerRef = el;\n            if (el && title) {\n              setTimeout(() => this.initializePopoverIfNeeded(el, title), 0);\n            }\n          }}\n          class=\"popover-title\"\n          style={{\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '4px',\n          }}\n        >\n          <span\n            class=\"cropped-title\"\n            style={{\n              flexShrink: '1',\n              minWidth: '0',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            {displayTitle}\n          </span>\n          {this.hkStatus && (\n            <div title={this.broomTooltip} class=\"hk-dot\" style={{ flexShrink: '0' }}>\n              <slot name=\"end\"></slot>\n            </div>\n          )}\n        </p>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  --ir-input-border-color: #cacfe7;\n  flex: 1 1 0%;\n}\n\n:host .input-group-text {\n  border-color: var(--ir-input-border-color);\n}\n:host .form-control,\n.currency-label {\n  font-size: 14px !important;\n}\n\n.ir-bl-lbl-none,\n.ir-bl-input-none {\n  border-top-left-radius: 0 !important;\n  border-bottom-left-radius: 0 !important;\n}\n.rate-input:read-only {\n  background: white !important;\n}\n.ir-br-lbl-none,\n.ir-br-input-none {\n  border-top-right-radius: 0 !important;\n  border-bottom-right-radius: 0 !important;\n}\n.ir-br-none {\n  border-right: none;\n}\n.ir-bl-none {\n  border-left: none;\n}\n\n.rate-input-container {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  box-sizing: border-box;\n  flex: 1;\n  padding: 0 !important;\n}\n:host([class='special-style']) .rate-input {\n  background: black !important;\n}\n.rate-input {\n  font-size: 0.875rem;\n  line-height: 0;\n  padding: 0;\n  height: 0;\n  box-sizing: border-box;\n  border-left: 0;\n  padding-left: 0px !important;\n  border-top-left-radius: 0 !important;\n  border-bottom-left-radius: 0 !important;\n}\n\n.currency-label.with-label {\n  border-radius: 0;\n}\n\n.currency-label {\n  box-sizing: border-box;\n  color: #3b4781;\n  border: 1px solid #cacfe7;\n  font-size: 0.875rem;\n  height: 2rem;\n  background: white;\n  border-right: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  pointer-events: none;\n  transition: border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\n}\n.currency-label.disabled,\n.rate-input:disabled {\n  background-color: #eceff1;\n  border-color: rgba(118, 118, 118, 0.3);\n}\n\n.price-input-group:focus-within .currency-label {\n  border-top: 1px solid #1e9ff2;\n  border-bottom: 1px solid #1e9ff2;\n  border-left: 1px solid #1e9ff2;\n}\n:host([data-state='error']) .currency-label,\n:host([data-state='error']) .rate-input,\n.error {\n  border-color: var(--red, #ff4961) !important;\n}\n.price-input:focus {\n  border-right-width: 1px !important;\n}\n\n.is-invalid {\n  background-image: none !important;\n}\n","import { Component, Element, Event, EventEmitter, Prop, h } from '@stencil/core';\nimport { v4 } from 'uuid';\nimport { ZodType } from 'zod';\nimport IMask, { InputMask } from 'imask';\n@Component({\n  tag: 'ir-price-input',\n  styleUrl: 'ir-price-input.css',\n  scoped: true,\n})\nexport class IrPriceInput {\n  @Element() el: HTMLIrPriceInputElement;\n\n  /** The label for the input, optional */\n  @Prop() label?: string;\n  /** The readonly for the input, optional */\n  @Prop() readOnly?: boolean;\n\n  /** Extra classnames for the input, optional */\n  @Prop() inputStyle?: string;\n\n  /** Extra classnames for the label, optional */\n  @Prop() labelStyle?: string;\n\n  /** The disabled for the input, optional */\n  @Prop() disabled?: boolean;\n\n  /** The Currency for the input, optional */\n  @Prop() currency?: string;\n\n  /** The AutoValidate for the input, optional */\n  @Prop() autoValidate?: boolean = true;\n\n  /** Indicates the key to wrap the value (e.g., 'price' or 'cost') */\n  @Prop() wrapKey?: string;\n\n  /**\n   * A Zod schema for validating the input\n   * Example: z.coerce.number()\n   */\n  @Prop() zod?: ZodType<any, any>;\n\n  /** Placeholder text for the input */\n  @Prop() placeholder: string = '';\n\n  /** Initial value for the input */\n  @Prop({ mutable: true }) value: string = '';\n\n  /** Whether the input is required */\n  @Prop() required: boolean = false;\n\n  /** Minimum value for the price */\n  @Prop() minValue?: number;\n\n  /** Maximum value for the price */\n  @Prop() maxValue?: number;\n\n  /** Unique id for testing */\n  @Prop() testId?: string;\n\n  /** Error*/\n  @Prop({ mutable: true }) error: boolean;\n  /**\n   * Extra class names applied to the outer <fieldset> wrapper.\n   * Useful for spacing (e.g., margins/padding), width/layout utilities,\n   * or theming the whole input group from the outside.\n   * Example: \"w-100 mb-2 d-flex align-items-center\"\n   */\n  @Prop() containerClassname: string;\n\n  /**\n   * Extra class names applied to the label container (<div class=\"input-group-prepend\">)\n   * that wraps the <label>. Use this to control label width, alignment,\n   * spacing, or visibility at different breakpoints.\n   * Example: \"min-w-120 text-nowrap pe-2\"\n   */\n  @Prop() labelContainerClassname: string;\n\n  /** Emits the current value on change */\n  @Event() textChange: EventEmitter<string>;\n\n  /** Emits the current value on blur */\n  @Event() inputBlur: EventEmitter<string>;\n\n  /** Emits the current value on focus */\n  @Event() inputFocus: EventEmitter<void>;\n\n  private id: string;\n\n  private opts = {\n    mask: Number,\n    scale: 2,\n    radix: '.',\n    mapToRadix: [','],\n    normalizeZeros: true,\n    padFractionalZeros: true,\n    thousandsSeparator: ',',\n  };\n  private mask: InputMask<any>;\n  private inputRef: HTMLInputElement;\n\n  componentWillLoad() {\n    if (this.el.id) {\n      this.id = this.el.id;\n    } else {\n      this.id = v4();\n    }\n  }\n\n  componentDidLoad() {\n    if (!this.mask) {\n      this.initializeMask();\n    }\n  }\n\n  private initializeMask() {\n    // Create options object with min/max if provided\n    const maskOpts = {\n      ...this.opts,\n    };\n\n    if (this.minValue !== undefined) {\n      maskOpts['min'] = this.minValue;\n    }\n\n    if (this.maxValue !== undefined) {\n      maskOpts['max'] = this.maxValue;\n    }\n\n    this.mask = IMask(this.inputRef, maskOpts);\n\n    // Set initial value if provided\n    if (this.value) {\n      this.mask.value = this.value;\n    }\n\n    this.mask.on('accept', () => {\n      const isEmpty = this.inputRef.value.trim() === '' || this.mask.unmaskedValue === '';\n      if (isEmpty) {\n        this.value = '';\n        this.textChange.emit(null);\n      } else {\n        this.value = this.mask.unmaskedValue;\n        this.textChange.emit(this.value);\n      }\n    });\n  }\n\n  private hasSpecialClass(className: string): boolean {\n    return this.el.classList.contains(className);\n  }\n\n  private validateInput(value: string): void {\n    if (!this.autoValidate) {\n      return;\n    }\n    if (this.zod) {\n      try {\n        this.zod.parse(this.wrapKey ? { [this.wrapKey]: value } : value); // Validate the value using the Zod schema\n        this.error = false; // Clear the error if valid\n      } catch (error) {\n        console.log(error);\n        this.error = true; // Set the error message\n      }\n    }\n  }\n\n  private handleInputChange = (): void => {\n    // The value is already being updated by the mask's 'accept' event\n    // Just validate here if needed\n    this.validateInput(this.value);\n  };\n\n  private handleBlur = (): void => {\n    this.validateInput(this.value);\n\n    // Format to 2 decimal places on blur\n    if (this.value) {\n      const numValue = parseFloat(this.value);\n      this.value = numValue.toFixed(2);\n\n      // Update the mask value to show the formatted value\n      if (this.mask) {\n        this.mask.value = this.value;\n      }\n    }\n\n    // Emit the blur event\n    this.inputBlur.emit(this.value);\n  };\n\n  private handleFocus = (): void => {\n    // Emit the focus event\n    this.inputFocus.emit();\n  };\n\n  render() {\n    return (\n      <fieldset class={`${this.containerClassname} input-group price-input-group m-0 p-0 `}>\n        {this.label && (\n          <div class={`input-group-prepend ${this.labelContainerClassname}`}>\n            <span\n              class={`input-group-text \n                ${this.labelStyle}\n              ${this.hasSpecialClass('ir-bl-lbl-none') ? 'ir-bl-lbl-none' : ''}\n              ${this.hasSpecialClass('ir-br-lbl-none') ? 'ir-br-lbl-none' : ''}\n              ${this.hasSpecialClass('ir-br-none') ? 'ir-br-none' : ''} \n              ${this.hasSpecialClass('ir-bl-none') ? 'ir-bl-none' : ''} \n              `}\n            >\n              <label class={'p-0 m-0 '} htmlFor={this.id}>\n                {this.label}\n              </label>\n            </span>\n          </div>\n        )}\n        <div class=\"position-relative has-icon-left rate-input-container\">\n          {this.currency && (\n            <div>\n              <span class={`input-group-text ${this.disabled ? 'disabled' : ''} currency-label ${this.error ? 'error' : ''} ${this.label ? 'with-label' : ''}`}>\n                {this.currency}\n              </span>\n            </div>\n          )}\n          <input\n            ref={el => (this.inputRef = el)}\n            data-testid={this.testId}\n            disabled={this.disabled}\n            id={this.id}\n            class={`form-control input-sm rate-input \n              ${this.inputStyle}\n              ${this.hasSpecialClass('ir-br-input-none') ? 'ir-br-input-none' : ''} \n              ${this.hasSpecialClass('ir-bl-input-none') ? 'ir-bl-input-none' : ''} \n              ${this.error ? 'error' : ''} py-0 m-0 ${this.currency ? 'ir-bl-none' : ''}`}\n            onInput={this.handleInputChange}\n            onBlur={this.handleBlur}\n            onFocus={this.handleFocus}\n            type=\"text\"\n            placeholder={this.placeholder}\n            readOnly={this.readOnly}\n            aria-label={this.el.ariaLabel ?? 'price-input'}\n            aria-describedby={this.el.ariaDescription ?? 'price-input'}\n          />\n        </div>\n      </fieldset>\n    );\n  }\n}\n",":host {\r\n  display: block;\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n  position: relative;\r\n}\r\n.loading-container {\r\n  position: relative;\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.close-icon {\r\n  position: absolute;\r\n  top: 18px;\r\n  right: 33px;\r\n  outline: none;\r\n}\r\n.close {\r\n  float: right;\r\n  font-size: 1.5rem;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #000;\r\n  text-shadow: 0 1px 0 #fff;\r\n  opacity: 0.5;\r\n\r\n  padding: 0;\r\n  background-color: transparent;\r\n  border: 0;\r\n  appearance: none;\r\n}\r\n.card {\r\n  top: 0;\r\n  z-index: 1000;\r\n}\r\n.card-title {\r\n  border-bottom: 1px solid #e4e5ec;\r\n  width: 100%;\r\n}\r\n.irfontgreen {\r\n  color: #0e930e;\r\n}\r\n.currency {\r\n  display: block;\r\n  position: absolute;\r\n  margin: 0;\r\n  padding: 0;\r\n  height: auto;\r\n  left: 10px;\r\n}\r\n.rate-input {\r\n  font-size: 14px;\r\n  line-height: 0;\r\n  padding: 0;\r\n  height: 0;\r\n  border-left: 0;\r\n  border-radius: 0.25rem !important;\r\n}\r\n.rate-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  box-sizing: border-box;\r\n  flex: 1;\r\n}\r\n.new-currency {\r\n  color: #3b4781;\r\n  border: 1px solid #cacfe7;\r\n  font-size: 0.975rem;\r\n  height: 2rem;\r\n  background: rgb(255, 255, 255);\r\n  padding-right: 0 !important;\r\n  border-right: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  transition: border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\r\n}\r\n.input-group-prepend span[data-state='focus'] {\r\n  border-color: var(--blue);\r\n}\r\n.input-group-prepend span[data-disabled] {\r\n  background-color: #eceff1;\r\n  border-color: rgba(118, 118, 118, 0.3);\r\n}\r\n.rateInputBorder {\r\n  padding-left: 5px !important;\r\n  padding-right: 5px !important;\r\n  border-top-left-radius: 0 !important;\r\n  border-bottom-left-radius: 0 !important;\r\n}\r\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, Prop, State, h, Event, EventEmitter, Fragment } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { convertDatePrice, formatDate, getDaysArray } from '@/utils/utils';\nimport { Booking, Day, IUnit, Room } from '@/models/booking.dto';\nimport { IRoomNightsDataEventPayload } from '@/models/property-types';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { Variation } from '@/models/property';\n\n@Component({\n  tag: 'ir-room-nights',\n  styleUrls: ['ir-room-nights.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrRoomNights {\n  @Prop() bookingNumber: string;\n  @Prop() propertyId: number;\n  @Prop() language: string;\n  @Prop() identifier: string;\n  @Prop() toDate: string;\n  @Prop() fromDate: string;\n  @Prop() pool: string;\n  @Prop() ticket: string;\n  @Prop() defaultDates: { from_date: string; to_date: string };\n\n  @State() bookingEvent: Booking;\n  @State() selectedRoom: Room;\n  @State() rates: Day[] = [];\n  @State() isLoading = false;\n  @State() initialLoading = false;\n  @State() inventory: number | null = null;\n  @State() isEndDateBeforeFromDate: boolean = false;\n  @State() defaultTotalNights = 0;\n  @State() isInputFocused = -1;\n  @State() dates: { from_date: Date; to_date: Date } = { from_date: new Date(), to_date: new Date() };\n\n  @Event() closeRoomNightsDialog: EventEmitter<IRoomNightsDataEventPayload>;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.dates = { from_date: new Date(this.fromDate), to_date: new Date(this.toDate) };\n    this.init();\n  }\n\n  isButtonDisabled() {\n    return this.isLoading || this.rates.some(rate => rate.amount === -1) || this.inventory === 0 || this.inventory === null;\n  }\n  async init() {\n    try {\n      const { from_date } = this.defaultDates;\n      if (moment(from_date, 'YYYY-MM-DD').isBefore(moment(this.fromDate, 'YYYY-MM-DD'))) {\n        this.dates.from_date = new Date(from_date);\n      } else {\n        this.dates.from_date = new Date(this.fromDate);\n      }\n      this.dates.to_date = new Date(this.toDate);\n      this.bookingEvent = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\n      if (this.bookingEvent) {\n        const filteredRooms = this.bookingEvent.rooms.filter(room => room.identifier === this.identifier);\n        this.selectedRoom = filteredRooms[0];\n        const lastDay = this.selectedRoom?.days[this.selectedRoom.days.length - 1];\n        //let first_rate = this.selectedRoom.days[0].amount;\n        if (moment(this.toDate).add(-1, 'days').isSame(moment(lastDay.date))) {\n          console.log('here1');\n          const amount = await this.fetchBookingAvailability(this.fromDate, this.selectedRoom.days[0].date, this.selectedRoom.rateplan.id);\n          const newDatesArr = getDaysArray(this.selectedRoom.days[0].date, this.fromDate);\n          this.isEndDateBeforeFromDate = true;\n          this.rates;\n          this.rates = [\n            ...newDatesArr.map(day => ({\n              amount: amount / newDatesArr.length,\n              date: day,\n              cost: null,\n            })),\n            ...this.selectedRoom.days,\n          ];\n          this.defaultTotalNights = this.rates.length - this.selectedRoom.days.length;\n        } else {\n          console.log('here2');\n          console.log(lastDay);\n          const amount = await this.fetchBookingAvailability(this.bookingEvent.to_date, moment(this.toDate, 'YYYY-MM-DD').format('YYYY-MM-DD'), this.selectedRoom.rateplan.id);\n          const newDatesArr = getDaysArray(lastDay.date, this.toDate);\n          this.rates = [\n            ...this.selectedRoom.days,\n            ...newDatesArr.map(day => ({\n              amount: amount / newDatesArr.length,\n              date: day,\n              cost: null,\n            })),\n          ];\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private handleInput(event: string, index: number) {\n    let inputValue = event;\n    let days = [...this.rates];\n    inputValue = inputValue.replace(/[^0-9.]/g, '');\n    if (inputValue === '') {\n      days[index].amount = -1;\n    } else {\n      if (!isNaN(Number(inputValue))) {\n        days[index].amount = Number(inputValue);\n      }\n    }\n    this.rates = days;\n  }\n  async fetchBookingAvailability(from_date: string, to_date: string, rate_plan_id: number) {\n    try {\n      this.initialLoading = true;\n      const bookingAvailability = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.propertyId,\n        adultChildCount: {\n          adult: this.selectedRoom.rateplan.selected_variation.adult_nbr,\n          child: this.selectedRoom.rateplan.selected_variation.child_nbr,\n        },\n        language: this.language,\n        currency: this.bookingEvent.currency,\n        room_type_ids: [this.selectedRoom.roomtype.id],\n        rate_plan_ids: [rate_plan_id],\n      });\n      console.log(bookingAvailability[0], rate_plan_id);\n      this.inventory = bookingAvailability[0].inventory;\n      const rate_plan = bookingAvailability[0].rateplans.find(rate => rate.id === rate_plan_id);\n      if (!rate_plan || !rate_plan.variations) {\n        this.inventory = null;\n        return null;\n      }\n      const selected_variation: Variation = rate_plan.variations?.find(\n        variation =>\n          variation.adult_nbr === this.selectedRoom.rateplan.selected_variation.adult_nbr && variation.child_nbr === this.selectedRoom.rateplan.selected_variation.child_nbr,\n      );\n      if (!selected_variation) {\n        return null;\n      }\n      return selected_variation.discounted_gross_amount;\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.initialLoading = false;\n    }\n  }\n\n  private renderInputField(index: number, currency_symbol: string, day: Day) {\n    return (\n      <div class=\"col-3 ml-1 position-relative  m-0 p-0 rate-input-container\">\n        <ir-price-input\n          value={day.amount > 0 ? day.amount.toString() : ''}\n          disabled={this.inventory === 0 || this.inventory === null}\n          currency={currency_symbol}\n          aria-label=\"rate\"\n          aria-describedby=\"rate cost\"\n          onTextChange={e => this.handleInput(e.detail, index)}\n        ></ir-price-input>\n      </div>\n    );\n  }\n\n  private renderReadOnlyField(currency_symbol: string, day: Day) {\n    return <p class=\"col-9 ml-1 m-0 p-0\">{`${currency_symbol}${Number(day.amount).toFixed(2)}`}</p>;\n  }\n  private renderRateFields(index: number, currency_symbol: string, day: Day) {\n    if (this.isEndDateBeforeFromDate) {\n      if (index < this.defaultTotalNights) {\n        return this.renderInputField(index, currency_symbol, day);\n      } else {\n        return this.renderReadOnlyField(currency_symbol, day);\n      }\n    } else {\n      return index < this.selectedRoom.days.length ? this.renderReadOnlyField(currency_symbol, day) : this.renderInputField(index, currency_symbol, day);\n    }\n  }\n  renderDates() {\n    const currency_symbol = this.bookingEvent.currency.symbol;\n    // const currency_symbol = getCurrencySymbol(this.bookingEvent.currency.code);\n    return (\n      <div class={'mt-2 m-0'}>\n        {this.rates?.map((day, index) => (\n          <div class={'row m-0 mt-1 align-items-center'}>\n            <p class={'col-2 m-0 p-0'}>{convertDatePrice(day.date)}</p>\n            {this.renderRateFields(index, currency_symbol, day)}\n          </div>\n        ))}\n      </div>\n    );\n  }\n  async handleRoomConfirmation() {\n    try {\n      this.isLoading = true;\n      let oldRooms = [...this.bookingEvent.rooms];\n      let selectedRoomIndex = oldRooms.findIndex(room => room.identifier === this.identifier);\n      if (selectedRoomIndex === -1) {\n        throw new Error('Invalid Pool');\n      }\n      oldRooms[selectedRoomIndex] = {\n        ...oldRooms[selectedRoomIndex],\n        days: this.rates,\n        to_date: moment(this.dates.to_date).format('YYYY-MM-DD'),\n        from_date: moment(this.dates.from_date).format('YYYY-MM-DD'),\n      };\n      const body = {\n        assign_units: true,\n        check_in: true,\n        is_pms: true,\n        is_direct: true,\n        pickup_info: this.bookingEvent.pickup_info,\n        extra_services: this.bookingEvent.extra_services,\n        booking: {\n          booking_nbr: this.bookingNumber,\n          from_date: moment(this.dates.from_date).format('YYYY-MM-DD'),\n          to_date: moment(this.dates.to_date).format('YYYY-MM-DD'),\n          remark: this.bookingEvent.remark,\n          property: this.bookingEvent.property,\n          source: this.bookingEvent.source,\n          currency: this.bookingEvent.currency,\n          arrival: this.bookingEvent.arrival,\n          guest: this.bookingEvent.guest,\n          rooms: oldRooms,\n        },\n      };\n      await this.bookingService.doReservation(body);\n      this.closeRoomNightsDialog.emit({ type: 'confirm', pool: this.pool });\n    } catch (error) {\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    if (!this.bookingEvent) {\n      return (\n        <div class=\"loading-container\">\n          <ir-loading-screen></ir-loading-screen>\n        </div>\n      );\n    }\n    return (\n      <div class=\"sheet-container\">\n        <ir-title\n          class=\"p-1 sheet-header\"\n          onCloseSideBar={() => this.closeRoomNightsDialog.emit({ type: 'cancel', pool: this.pool })}\n          label={`${locales.entries.Lcz_AddingRoomNightsTo} ${this.selectedRoom?.roomtype?.name} ${(this.selectedRoom?.unit as IUnit).name}`}\n          displayContext=\"sidebar\"\n        ></ir-title>\n        <section class={'text-left px-1 pt-0 sheet-body'}>\n          <p class={'font-medium-1'}>\n            {`${locales.entries.Lcz_Booking}#`} {this.bookingNumber}\n          </p>\n          {this.initialLoading ? (\n            <p class={'mt-2 text-secondary'}>{locales.entries['Lcz_CheckingRoomAvailability ']}</p>\n          ) : (\n            <Fragment>\n              <p class={'font-weight-bold font-medium-1'}>{`${formatDate(moment(this.dates.from_date).format('YYYY-MM-DD'), 'YYYY-MM-DD')} - ${formatDate(\n                moment(this.dates.to_date).format('YYYY-MM-DD'),\n                'YYYY-MM-DD',\n              )}`}</p>\n              <p class={'font-medium-1 mb-0'}>\n                {`${this.selectedRoom.rateplan.name}`} {this.selectedRoom.rateplan.is_non_refundable && <span class={'irfontgreen'}>{locales.entries.Lcz_NonRefundable}</span>}\n              </p>\n              {(this.inventory === 0 || this.inventory === null) && <p class=\"font-medium-1 text danger\">{locales.entries.Lcz_NoAvailabilityForAdditionalNights}</p>}\n\n              {this.selectedRoom.rateplan.custom_text && <p class={'text-secondary mt-0'}>{this.selectedRoom.rateplan.custom_text}</p>}\n              {this.renderDates()}\n            </Fragment>\n          )}\n        </section>\n        <section class={'sheet-footer'}>\n          <ir-button\n            btn_color=\"secondary\"\n            btn_disabled={this.isLoading}\n            text={locales?.entries.Lcz_Cancel}\n            class=\"full-width\"\n            btn_styles=\"justify-content-center\"\n            onClickHandler={() => this.closeRoomNightsDialog.emit({ type: 'cancel', pool: this.pool })}\n          ></ir-button>\n\n          {this.inventory > 0 && this.inventory !== null && (\n            <ir-button\n              isLoading={this.isLoading}\n              text={locales?.entries.Lcz_Confirm}\n              btn_disabled={this.isButtonDisabled()}\n              class=\"full-width\"\n              btn_styles=\"justify-content-center\"\n              onClickHandler={this.handleRoomConfirmation.bind(this)}\n            ></ir-button>\n          )}\n        </section>\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.spinner {\n  transform-origin: center;\n  animation: spinner_svv2 0.75s infinite linear;\n}\n@keyframes spinner_svv2 {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\n\ntype LoaderPhase = 'spinner' | 'success';\n\n@Component({\n  tag: 'ir-success-loader',\n  styleUrl: 'ir-success-loader.css',\n  shadow: true,\n})\nexport class IrSuccessLoader {\n  /**\n   * How long the spinner should be shown before transitioning to the success icon.\n   * Value is expressed in milliseconds.\n   */\n  @Prop() spinnerDuration = 1500;\n\n  /**\n   * How long the success icon should be shown before the loader dispatches the completion event.\n   * Value is expressed in milliseconds.\n   */\n  @Prop() successDuration = 1000;\n\n  /**\n   * Whether the loader should automatically start its cycle when it becomes active.\n   */\n  @Prop() autoStart = true;\n\n  /**\n   * Controls the visibility of the loader. Setting this to `true` starts the spinner/success cycle.\n   */\n  @Prop({ mutable: true, reflect: true }) active = true;\n\n  /**\n   * Emit when the loader finishes the success state and should be hidden by the parent.\n   */\n  @Event({ bubbles: true, composed: true }) loaderComplete: EventEmitter<void>;\n\n  @State() private phase: LoaderPhase = 'spinner';\n\n  private spinnerTimer?: number;\n  private successTimer?: number;\n\n  componentWillLoad() {\n    if (this.autoStart && this.active) {\n      this.startCycle();\n    }\n  }\n\n  disconnectedCallback() {\n    this.clearTimers();\n  }\n\n  @Watch('active')\n  protected onActiveChange(isActive: boolean) {\n    if (isActive) {\n      if (this.autoStart) {\n        this.startCycle();\n      }\n    } else {\n      this.resetCycle();\n    }\n  }\n\n  @Watch('spinnerDuration')\n  @Watch('successDuration')\n  protected onDurationChange() {\n    if (this.active && this.autoStart) {\n      this.startCycle();\n    }\n  }\n\n  private startCycle() {\n    this.clearTimers();\n    this.phase = 'spinner';\n    const spinnerDelay = Math.max(0, Number(this.spinnerDuration) || 0);\n    if (spinnerDelay === 0) {\n      this.showSuccess();\n      return;\n    }\n    this.spinnerTimer = window.setTimeout(() => this.showSuccess(), spinnerDelay);\n  }\n\n  private showSuccess() {\n    this.phase = 'success';\n    const successDelay = Math.max(0, Number(this.successDuration) || 0);\n    if (successDelay === 0) {\n      this.handleCompletion();\n      return;\n    }\n    this.successTimer = window.setTimeout(() => this.handleCompletion(), successDelay);\n  }\n\n  private handleCompletion() {\n    this.loaderComplete.emit();\n    this.active = false;\n  }\n\n  private resetCycle() {\n    this.clearTimers();\n    this.phase = 'spinner';\n  }\n\n  private clearTimers() {\n    if (this.spinnerTimer) {\n      clearTimeout(this.spinnerTimer);\n      this.spinnerTimer = undefined;\n    }\n    if (this.successTimer) {\n      clearTimeout(this.successTimer);\n      this.successTimer = undefined;\n    }\n  }\n\n  render() {\n    return (\n      <Host>\n        {this.phase === 'spinner' ? (\n          <svg part=\"spinner\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n              d=\"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z\"\n              class=\"spinner\"\n            />\n          </svg>\n        ) : (\n          <ir-icons part=\"check\" name=\"check\" style={{ color: '#45b16d' }}></ir-icons>\n        )}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: flex;\n  align-items: center;\n  position: relative;\n  overflow-x: auto;\n  gap: 1rem;\n  padding: 0 1rem;\n}\n.tab {\n  font-size: 0.95rem;\n  font-weight: 400;\n  cursor: pointer;\n  position: relative;\n  margin: 0;\n  padding: 0rem;\n  padding-bottom: 1rem;\n  transition: color 0.3s ease;\n  user-select: none;\n  background-color: transparent;\n  border: none;\n  outline: none;\n  flex: 1 1 0%;\n  text-align: center;\n  white-space: nowrap;\n}\n.tab[data-disabled] {\n  cursor: auto;\n}\n.tab:hover {\n  opacity: 80%;\n}\n\n.tab[data-state='selected'],\n.tab[data-state='selected']:hover {\n  color: var(--blue, #1e9ff2);\n  opacity: 100%;\n}\n.active-indicator {\n  padding: 0;\n  bottom: 0px;\n  position: absolute;\n  height: 3px;\n  border-radius: 4px;\n  transition: transform 0.3s ease, width 0.3s ease;\n  background: var(--blue, #1e9ff2);\n}\n","import { Component, Element, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\n\nexport type Tab = { id: string; label: string };\n\n@Component({\n  tag: 'ir-tabs',\n  styleUrl: 'ir-tabs.css',\n  scoped: true,\n})\nexport class IrTabs {\n  @Element() el: HTMLElement;\n\n  /**\n   * Array of tab objects containing id and label\n   * @type {Tab[]}\n   * @default []\n   */\n  @Prop() tabs: Tab[] = [];\n\n  /**\n   * ID of the tab that should be selected initially\n   * @type {string}\n   * @default undefined\n   */\n  @Prop() initialTab: string;\n\n  /**\n   * Whether the tabs are disabled\n   * @type {boolean}\n   * @default false\n   */\n  @Prop() disabled: boolean = false;\n\n  /**\n   * Aria label for the tab list\n   * @type {string}\n   * @default 'Tabs'\n   */\n  @Prop() ariaLabel: string = 'Tabs';\n\n  @State() _selectedTab: Tab;\n\n  /**\n   * Emitted when a tab is selected\n   * @event tabChanged\n   * @type {CustomEvent<Tab>}\n   */\n  @Event() tabChanged: EventEmitter<Tab>;\n\n  private activeIndicator: HTMLSpanElement;\n  private animationFrameId: number;\n\n  componentWillLoad() {\n    const tab = this.tabs?.find(t => t.id === this.initialTab);\n    if (tab) {\n      this.selectTab(tab);\n    } else if (this.tabs?.length > 0) {\n      // Select first tab if no initial tab is specified\n      this.selectTab(this.tabs[0]);\n    }\n  }\n\n  // componentDidLoad() {\n  //   this.updateActiveIndicator();\n  // }\n\n  disconnectedCallback() {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n    }\n  }\n\n  private updateActiveIndicator() {\n    // if (this.animationFrameId) {\n    //   cancelAnimationFrame(this.animationFrameId);\n    // }\n    // this.animationFrameId = requestAnimationFrame(() => {\n    //   const selectedTab = this.el.querySelector(`button.tab[data-state=\"selected\"]`);\n    //   if (selectedTab && this.activeIndicator) {\n    //     const { left, width } = selectedTab.getBoundingClientRect();\n    //     const parentLeft = this.el.getBoundingClientRect().left;\n    //     const position = left - parentLeft;\n    //     this.activeIndicator.style.width = `${width}px`;\n    //     this.activeIndicator.style.transform = `translateX(${position}px)`;\n    //   }\n    // });\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n    }\n    requestAnimationFrame(() => {\n      const selectedTab = this.el.querySelector(`.tab[data-state=\"selected\"]`);\n      if (selectedTab) {\n        const { left, width } = selectedTab.getBoundingClientRect();\n        const parentLeft = this.el.getBoundingClientRect().left;\n        const position = left - parentLeft - this.remSize;\n        this.activeIndicator.style.width = `${width - this.remSize}px`;\n        this.activeIndicator.style.transform = `translateX(${position}px)`;\n      }\n    });\n  }\n  private remSize = (() => {\n    const fontSize = getComputedStyle(document.documentElement).fontSize;\n    return parseFloat(fontSize);\n  })();\n  private selectTab(tab: Tab) {\n    if (this.disabled) return;\n\n    this._selectedTab = tab;\n    this.updateActiveIndicator();\n    this.tabChanged.emit(tab);\n  }\n\n  private handleKeyDown(event: KeyboardEvent, currentTab: Tab) {\n    if (this.disabled) return;\n\n    const currentIndex = this.tabs.findIndex(t => t.id === currentTab.id);\n    let nextIndex = currentIndex;\n\n    switch (event.key) {\n      case 'ArrowRight':\n        event.preventDefault();\n        nextIndex = (currentIndex + 1) % this.tabs.length;\n        break;\n      case 'ArrowLeft':\n        event.preventDefault();\n        nextIndex = currentIndex === 0 ? this.tabs.length - 1 : currentIndex - 1;\n        break;\n      case 'Home':\n        event.preventDefault();\n        nextIndex = 0;\n        break;\n      case 'End':\n        event.preventDefault();\n        nextIndex = this.tabs.length - 1;\n        break;\n      case 'Enter':\n      case ' ':\n        event.preventDefault();\n        this.selectTab(currentTab);\n        return;\n      default:\n        return;\n    }\n\n    const nextTab = this.tabs[nextIndex];\n    if (nextTab) {\n      this.selectTab(nextTab);\n      requestAnimationFrame(() => {\n        const tabButton = this.el.querySelector(`button.tab[data-tab-id=\"${nextTab.id}\"]`) as HTMLButtonElement;\n        if (tabButton) {\n          tabButton.focus();\n        }\n      });\n    }\n  }\n\n  render() {\n    return (\n      <Host role=\"tablist\" aria-label={this.ariaLabel} aria-orientation=\"horizontal\">\n        {this.tabs.map(tab => (\n          <button\n            class=\"tab\"\n            key={tab.id}\n            type=\"button\"\n            data-tab-id={tab.id}\n            role=\"tab\"\n            tabindex={this._selectedTab?.id === tab.id ? 0 : -1}\n            aria-selected={this._selectedTab?.id === tab.id ? 'true' : 'false'}\n            aria-controls={`tabpanel-${tab.id}`}\n            id={`tab-${tab.id}`}\n            disabled={this.disabled}\n            data-state={this._selectedTab?.id === tab.id ? 'selected' : undefined}\n            onClick={() => this.selectTab(tab)}\n            onKeyDown={event => this.handleKeyDown(event, tab)}\n          >\n            {tab.label}\n          </button>\n        ))}\n        <span class=\"active-indicator\" ref={el => (this.activeIndicator = el)}></span>\n      </Host>\n    );\n  }\n}\n"],"mappings":"+uBAAA,MAAMA,EAAqB,6/KAC3B,MAAAC,EAAeD,E,iXCkBFE,EAAe,M,8bAGlBC,SACAC,mBAA8B,MAC9BC,SACiBC,aACjBC,iBAA2C,GAC3CC,UAEkCC,eACjCC,gBACAC,kBACAC,qBACAC,WACAC,sBACAC,MACAC,mBAEAC,cAAyB,MACzBC,SACAC,YAA8B,KAE/BC,SAAmB,EACnBC,WAAqB,EAErBC,UAAoB,GAGpBC,cAAyB,MACzBC,kBAA6B,MAC7BC,UAAY,MAEZC,cAAgB,IAAIC,EACpBC,eAAiB,IAAIC,EAErBC,WAAqB,GACrBC,WAAsB,MACtBC,SACAC,SACAC,SACAC,SACAC,aACAC,YACAC,WACAC,YACAC,WACRC,YACQC,aACAC,gBACAC,gBACAC,iBAAkC,KAElCC,oBAAsBC,KAAKC,gBAAgBC,KAAKF,MAChDG,kBAAoBH,KAAKI,cAAcF,KAAKF,MAE5CK,KAAe,GAEvB,iBAAAC,GAAiB,CAEjB,gBAAAC,GACE,GAAIP,KAAKQ,aAAc,CACrB,IAAKR,KAAKzC,aAAakD,WAAY,CAEjCC,YAAWC,UACT,GAAI,CAAC,MAAO,MAAO,OAAOC,SAASZ,KAAKzC,aAAasD,aAAc,CACjEb,KAAKc,cAAc,K,MACd,GAAI,CAAC,WAAY,YAAa,uBAAwB,eAAeF,SAASZ,KAAKzC,aAAawD,QAAS,OACxGf,KAAKgB,2B,KACN,CACLhB,KAAKc,cAAc,K,CAErBd,KAAKiB,aAAa,GACjB,E,GAKT,oBAAAC,GACE,GAAIlB,KAAKF,iBAAkB,CACzBqB,qBAAqBnB,KAAKF,iB,EAK9B,mBAAAsB,CAAoBC,GAClB,GAAIA,EAAMC,OAAOC,qBAAuBvB,KAAKwB,gBAAmBH,EAAMC,OAAOG,MAAQ,cAAgBJ,EAAMC,OAAOC,sBAAwBvB,KAAKwB,eAAiB,CAC9JxB,KAAKxB,cAAgB,MACrBwB,KAAKiB,a,EAKT,0BAAMS,CAAqBL,GACzB,IACE,GAAIA,EAAMC,OAAOK,YAAc3B,KAAKwB,eAAgB,CAClDxB,KAAKc,cAAc,OACnB,M,CAGF,GAAIO,EAAMC,OAAOM,YAAc,UAAYP,EAAMC,OAAOO,WAAa,SAAU,CAC7ER,EAAMC,OAAOM,UAAY5B,KAAKzC,aAAauE,UAC3CT,EAAMC,OAAOO,SAAWR,EAAMC,OAAOS,WACrC,GAAI/B,KAAKL,cAAgBK,KAAKJ,iBAAmB,GAAKI,KAAKH,iBAAmB,IAAMG,KAAKtB,UAAW,CAClG,GAAIsD,EAAYhC,KAAKzC,aAAasD,aAAc,CAC9Cb,KAAKc,cAAc,K,MACd,GAAI,CAAC,WAAY,YAAa,uBAAwB,eAAeF,SAASZ,KAAKzC,aAAawD,QAAS,OACxGf,KAAKgB,2B,MAER,CACLhB,KAAKF,iBAAmBmC,uBAAsB,KAC5CjC,KAAKkC,+BAA+B,IAEtC,M,MAEG,CACL,GAAIlC,KAAKL,cAAgBK,KAAKJ,iBAAmB,GAAKI,KAAKH,iBAAmB,IAAMG,KAAKtB,UAAW,CAClG,GAAIsD,EAAYhC,KAAKzC,aAAasD,aAAc,CAC9Cb,KAAKc,cAAc,K,MACd,GAAI,CAAC,WAAY,YAAa,uBAAwB,eAAeF,SAASZ,KAAKzC,aAAawD,QAAS,OACxGf,KAAKgB,2B,MAER,CACL,MAAMmB,KAAEA,EAAIC,QAAEA,EAAOC,UAAEA,EAASR,SAAEA,GAAaR,EAAMC,OACrD,MAAMgB,EAAiBC,EAAOH,EAAS,cAAcI,KAAK,EAAG,QAAQC,OAAO,cAC5EC,QAAQC,IAAI3C,KAAK4C,aAAaC,OAAO7C,KAAKzC,aAAauF,QAAS9C,KAAK4C,aAAaC,OAAOhB,KACzF,KACIU,EAAOvC,KAAKzC,aAAawF,QAAS,cAAcC,OAAOT,EAAOH,EAAS,cAAe,UACtFpC,KAAK4C,aAAaC,OAAO7C,KAAKzC,aAAauF,UAAY9C,KAAK4C,aAAaC,OAAOhB,OACjFoB,EAAeC,eAAeC,IAAI,GAAGtB,KAAYQ,MAAce,UAC7DH,EAAeC,eAAeC,IAAI,GAAGtB,KAAYO,MAAYgB,UAAYH,EAAeC,eAAeC,IAAI,GAAGtB,KAAYS,MAAmBc,YAC/IpD,KAAKtB,UACN,CACAsB,KAAKqD,MAAM,+G,CAEb,GAAIrD,KAAKsD,oBAAoBzB,EAAUQ,EAAWD,GAAU,CAC1DpC,KAAKqD,MAAM,oB,CAEb,GAAIlB,EAAM,CACR,GAAIH,EAAYhC,KAAKzC,aAAasD,aAAc,OAKxCb,KAAKrB,cAAc4E,gBAAgBpB,EAAMN,EAAUQ,EAAWD,GAASoB,OAAM,KACjFxD,KAAKkC,+BAA+B,G,KAEjC,CACL,GAAIlC,KAAK5B,cAAgB4B,KAAKtB,UAAW,CAUvC,MAAM+E,YAAEA,EAAWC,OAAEA,EAAMC,aAAEA,GAAiB3D,KAAK4D,oBAAoB/B,EAAUQ,EAAWD,GAC5F,IAAIyB,EAAoB,MACxB,GAAIH,IAAW,MAAO,CACpBG,EAAoB,I,CAEtB,MAAMC,EAAc9D,KAAKzC,aAAawG,aAAa1B,UACnD,MAAM2B,EAAYhE,KAAKzC,aAAawG,aAAa3B,QACjD,MAAM6B,EAAWC,EAA0BJ,EAAaE,GAExD,IAAIG,EAAqB,KACzB,IAAIC,EAAWN,EACf,IAAIO,EAASL,EACb,GAAIhE,KAAK5B,YAAa,CACpB,GAAImE,EAAOF,EAAW,cAAciC,QAAQ/B,EAAOuB,EAAa,gBAAkBvB,EAAOH,EAAS,cAAcmC,SAAShC,EAAOyB,EAAW,eAAgB,CACzJI,EAAWN,EACXO,EAASjC,C,KACJ,CACL+B,EAAqB5B,EAAOF,EAAW,cAAciC,QAAQ/B,EAAOuB,EAAa,eAC7E,OACAvB,EAAOH,EAAS,cAAcmC,SAAShC,EAAOyB,EAAW,eACzD,QACA,KACJ,GAAIG,IAAuB,OAAQ,CACjCC,EAAW/B,C,CAGb,GAAI8B,IAAuB,QAAS,CAClCE,EAASjC,C,OAGR,CACLM,QAAQC,IAAI,cACZ,GAAIJ,EAAOF,EAAW,cAAckC,SAAShC,EAAOuB,EAAa,eAAgB,CAC/EM,EAAW/B,EACX,MAAMmC,EAAYjC,EAAOF,EAAW,cAAcG,IAAIyB,EAAU,QAChEI,EAASG,EAAUD,SAAShC,EAAOH,EAAS,cAAe,QAAUA,EAAUoC,EAAU/B,OAAO,a,MAC3F,GAAIF,EAAOH,EAAS,cAAckC,QAAQ/B,EAAOyB,EAAW,eAAgB,CACjFK,EAASjC,EACTgC,EAAW7B,EAAOH,EAAS,cAAcqC,SAASR,EAAU,QAAQxB,OAAO,a,EAG/EC,QAAQgC,KAAK,CAAEN,WAAUC,WACzBrE,KAAKlC,WAAW6G,KAAK,CACnBC,OAAQ,gBACLvD,EAAMC,OACTmC,cACAoB,MAAO,GACPC,UAAWnB,EACXE,oBACAxB,UAAW+B,EACXhC,QAASiC,G,KAEN,CASL,MAAMP,EAAc9D,KAAKzC,aAAawG,aAAa1B,UACnD,MAAM2B,EAAYhE,KAAKzC,aAAawG,aAAa3B,QAajD,MAAM2C,EAAgB,CAACC,EAAmB5C,KACxC,IAAI6C,EAASD,EACb,IAAIE,EAAU,EACd,MAAOD,IAAW7C,EAAS,CACzB,GAAIa,EAAeC,eAAeC,IAAI,GAAGtB,KAAYoD,MAAW7B,SAAU,CACxE8B,G,CAEFD,EAAS1C,EAAO0C,EAAQ,cAAczC,IAAI,EAAG,QAAQC,OAAO,a,CAE9D,GAAIyC,GAAW,EAAG,CAChBlF,KAAKqD,MAAM8B,EAAQC,QAAQC,2B,GAI/B,GAAI9C,EAAOyB,EAAW,cAAcO,SAAShC,EAAOH,GAAU,SAAU,CACtE2C,EAAcf,EAAW5B,E,MACpB,GAAIG,EAAOuB,EAAa,cAAcQ,QAAQ/B,EAAOF,EAAW,cAAe,SAAU,CAC9F0C,EAAc1C,EAAWyB,E,CAE3B,MAAMwB,EAA2B,CAC/BC,QAASvF,KAAKzC,aACdiI,cAAexF,KAAKzC,aAAakI,eACjCC,WAAY1F,KAAKzC,aAAaoI,WAC9BvD,UACAD,OACAE,YACA0B,aAAc/D,KAAKzC,aAAawG,cAElC,IAAK/D,KAAKzC,aAAaqI,UAAW,CAChC5F,KAAKlC,WAAW6G,KAAK,CAAEC,OAAQ,aAAcU,G,KACxC,CACLtF,KAAKnC,qBAAqB8G,KAAKW,E,GAKrCtF,KAAK5B,YAAc,I,IAIzB,MAAOyH,GACP7F,KAAKhC,MAAM2G,KAAK,CACdxG,SAAU,YACV0G,MAAOgB,EAAMC,QACbrC,YAAa,GACbsC,KAAM,UAERrD,QAAQC,IAAI,uB,EAKhB,gBAAAqD,GACEhG,KAAKc,cAAc,M,CAEb,+BAAME,GACZ,IACE0B,QAAQC,IAAI,mBAAoB3C,KAAKzC,aAAakI,gBAElD,MAAMQ,EAAgB,CAAC,WAAY,YAAa,uBAAwB,eACxE,IAAKA,EAAcrF,SAASZ,KAAKzC,aAAawD,QAAS,CACrD,M,CAGF,MAAMmF,QAAalG,KAAKnB,eAAesH,kBAAkBnG,KAAKzC,aAAakI,eAAgB,MAC3F,MAAMW,EAAe,IAAKF,GAC1B,MAAMG,EAAgBH,EAAKI,MAAMC,QAAOC,GAAQA,EAAK,yBAA2BxG,KAAKzC,aAAakJ,KAElG,GAAIJ,EAAcK,SAAW,EAAG,CAC9B,MAAM,IAAIC,MAAM,WAAW3G,KAAKzC,aAAakI,oC,CAG/C,GAAIY,EAAcO,MAAKJ,GAAQA,EAAK,yBAA2B,OAAO,CACpE,MAAM,IAAIG,MAAM,WAAW3G,KAAKzC,aAAakI,mC,CAG/CS,EAAKI,MAAQD,EAEb,MAAMQ,EAAqBC,EAAoBZ,GAAM,GACrD,MAAMO,GACJA,EAAE1D,QACFA,EAAOjB,UACPA,EAASiF,WACTA,EAAUhG,OACVA,EAAMiG,KACNA,EAAIrB,WACJA,EAAUsB,OACVA,EAAMC,YACNA,EAAWpE,MACXA,EAAKqE,KACLA,EAAI1B,eACJA,EAAc2B,MACdA,EAAKxB,UACLA,EAASyB,QACTA,EAAOC,oBACPA,KACGC,GACDV,EACJ7G,KAAKzC,aAAe,IACfgK,KACAvH,KAAKzC,aACR+J,sBACA/B,QAASW,EACTE,eACAoB,eAAgBD,EAAiBC,eACjCC,MAAOF,EAAiBE,MACxBC,aAAcH,EAAiBG,aAC/BC,aAAcJ,EAAiBI,aAC/BV,SACAI,UACAH,cACAU,UAAW,IAAK5H,KAAKzC,aAAaqK,UAAWC,gBAAiBN,EAAiBK,UAAUC,kBAE3F7H,KAAK/B,mBAAmB0G,KAAK3E,KAAKzC,cAClCyC,KAAKc,cAAc,K,CACnB,MAAO+E,GACPnD,QAAQmD,MAAMA,EAAMC,Q,EAIhB,KAAAzC,CAAMyC,GACZ9F,KAAKF,iBAAmBmC,uBAAsB,KAC5CjC,KAAKkC,+BAA+B,IAEtC,MAAM,IAAIyE,MAAMb,E,CAGVlD,aAAgBkF,IACtB,IAAIC,EAAW/H,KAAKzC,aAAayK,UAAUzB,QAAOC,GAAQA,EAAKyB,cAAcrB,MAAKsB,GAAKA,EAAEC,MAAQL,MACjG,GAAIC,EAASrB,OAAQ,CACnB,OAAOqB,EAAS,GAAGI,E,CAErB,OAAO,IAAI,EAGL,WAAAC,GACN,MAAMzG,EAAY3B,KAAKwB,eACvB,MAAO,CACL6G,IAAK,SAAS1G,IACd2G,aAAc,uBAAuB3G,IACrC4G,QAAS,iBAAiB5G,I,CAItB,mBAAAiC,CAAoB/B,EAAkBQ,EAAWD,GACvD,IAAKpC,KAAKzC,aAAaqI,UAAW,CAChC,GAAI5F,KAAK5B,YAAa,CACpB,MAAO,CACLqF,YAAa0B,EAAQC,QAAQoD,2BAC7B9E,OAAQ,M,KAML,CACL,GACEnB,EAAOF,EAAW,cAAcW,OAAOT,EAAOvC,KAAKzC,aAAauE,UAAW,gBAC3ES,EAAOH,EAAS,cAAcY,OAAOT,EAAOvC,KAAKzC,aAAawF,QAAS,eACvE,CACA,MAAM0F,EAAYzI,KAAK4C,aAAa5C,KAAKzC,aAAauF,OACtD,MAAM4F,EAAW1I,KAAK4C,aAAaf,GACnC,GAAI4G,IAAcC,EAAU,CAC1B,MAAO,CAAEjF,YAAa,GAAG0B,EAAQC,QAAQuD,uCAAwCjF,OAAQ,M,KACpF,CACL,MAAMkF,EAAYC,EAAc,CAC9BC,YAAa9I,KAAKzC,aAAawL,aAC/BC,WAAYN,EACZO,UAAWC,GAAeC,UAAUC,YAEtC,MAAO,CACL3F,YAAa0B,EAAQC,QAAQoD,2BAC7B9E,OAAQ,MACRC,aAAc0F,MAAMC,QAAQV,GAAaA,EAAYW,U,EAU3D,MAAO,CAAE9F,YAAa0B,EAAQC,QAAQoE,2BAA6B,IAAK9F,OAAQ,M,MAE7E,CACL,IAAK1D,KAAK5B,YAAa,CACrB,MAAMqK,EAAYzI,KAAK4C,aAAaC,OAAO7C,KAAKzC,aAAauF,QAC7D,MAAM4F,EAAW1I,KAAK4C,aAAaC,OAAOhB,IAC1C,GAAI4G,IAAcC,EAAU,CAC1BhG,QAAQC,IAAI,WACZ,GAAI3C,KAAKzC,aAAauF,MAAM2G,aAAe5H,EAAS4H,WAAY,CAE9D,MAAO,CAAEhG,YAAa0B,EAAQC,QAAQsE,sBAAwB,IAAKhG,OAAQ,M,CAE7E,MAAO,CAAED,YAAa,GAAG0B,EAAQC,QAAQuD,uCAAwCjF,OAAQ,M,KACpF,CACL,MAAMkF,EAAYC,EAAc,CAC9BC,YAAa9I,KAAKzC,aAAawL,aAC/BC,WAAYN,EACZO,UAAWC,GAAeC,UAAUC,YAGtC,MAAO,CACL3F,YAAa0B,EAAQC,QAAQuE,wBAC7BjG,OAAQ,MACRC,aAAc0F,MAAMC,QAAQV,GAAaA,EAAYW,U,EAI3D,MAAO,CAAE9F,YAAa0B,EAAQC,QAAQsE,sBAAwB,IAAKhG,OAAQ,M,EAIvE,6BAAAxB,GACN,GAAIlC,KAAKtB,UAAW,CAClBsB,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKV,gBAClCU,KAAK4J,QAAQC,MAAME,MAAQ,GAAG/J,KAAKX,iBACnCW,KAAKtB,UAAY,MACjBsB,KAAKT,WAAaS,KAAKX,aACvBW,KAAK5B,YAAc,I,KACd,CACL4B,KAAK4J,QAAQC,MAAMG,IAAM,GAAGhK,KAAKR,YAAYwK,QAC7ChK,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKR,YAAYsK,Q,EAKlD,mBAAAG,CAAoB5I,GAClB,GAAIrB,KAAKzC,aAAa4J,OAAS9F,EAAMC,OAAQ,CAC3CtB,KAAKkC,+B,EAYD,mBAAAoB,CAAoBzB,EAAkBQ,EAAmBD,GAC/D,MAAM8H,EAAW3H,EAAOF,EAAW,cACnC,MAAM8H,EAAS5H,EAAOH,EAAS,cAC/B,MAAMgI,EAAapK,KAAKxC,iBAAiBoJ,MAAKvF,IAC5C,GAAIA,EAAM8F,OAASnH,KAAKzC,aAAa4J,KAAM,CACzC,OAAO,K,CAET,MAAMkD,EAAgB9H,EAAOlB,EAAMS,UAAW,cAAcU,IAAI,EAAG,QACnE,MAAM8H,EAAc/H,EAAOlB,EAAM0B,QAAS,cAC1C,OAAO1B,EAAMyB,SAAWjB,GAAYsI,EAAOI,cAAcF,IAAkBH,EAAS3F,SAAS+F,EAAY,IAE3G,OAAOF,C,CAGT,WAAAnJ,GACEjB,KAAK9B,eAAiB8B,KAAK9B,a,CAG7B,WAAAsM,GACE,OAAO,IAAIC,MAAOC,S,CAGpB,cAAAC,GACE,QAAS3K,KAAKzC,aAAaqN,a,CAG7B,UAAApK,GACE,OAAOR,KAAKwB,iBAAmB,gB,CAGjC,oBAAAqJ,GACE,OAAO7K,KAAK8K,iBAAmB,Y,CAGjC,YAAAtJ,GACE,OAAOxB,KAAKzC,aAAakJ,E,CAG3B,gBAAAsE,GACE,OAAO/K,KAAKzC,aAAawD,M,CAG3B,WAAAiK,GACE,OAAOhL,KAAKzC,aAAayJ,I,CAG3B,eAAAiE,GACE,OAAOjL,KAAKzC,aAAauF,K,CAG3B,oBAAAoI,GACE,OAAO,IAAIT,KAAKzK,KAAKzC,aAAauE,U,CAGpC,kBAAAqJ,GACE,OAAO,IAAIV,KAAKzK,KAAKzC,aAAawF,Q,CAGpC,YAAA+H,GACE,OAAO9K,KAAKzC,aAAa6N,U,CAG3B,cAAAC,GAEE,IAAI3H,EAAS1D,KAAKzC,cAAc+N,WAAWC,SAASvL,KAAK+K,oBACzD,IAAIS,EAAYxL,KAAKQ,aAAe,CAAEiL,MAAO,WAAc,GAC3D,MAAO,IACFzL,KAAKzC,cAAc+N,WAAW5H,EAAOyE,OACrCzE,KACA8H,E,CAIP,iBAAAE,CAAkBC,GAEhB,IAAIjI,EAAS1D,KAAKzC,cAAc+N,WAAWC,SAASI,GACpD,MAAO,IAAK3L,KAAKzC,aAAa+N,WAAW5H,EAAOyE,OAAQzE,E,CAG1D,WAAAkI,GACE,GAAI5L,KAAKzC,aAAa6J,OAASpH,KAAKzC,aAAasO,eAAiB7L,KAAKzC,aAAaoK,aAAc,CAChG,OAAO3H,KAAK0L,kBAAkB,Q,CAEhC,OAAO,I,CAGT,cAAAI,GACE,GAAI9L,KAAKzC,aAAa8J,UAAY,MAAQrH,KAAKzC,aAAa8J,SAAW,EAAG,CACxE,OAAOrH,KAAK0L,kBAAkB,sB,CAEhC,OAAO,I,CAGT,WAAAK,CAAYC,GACVhM,KAAKzC,aAAawJ,WAAaiF,EAC/BhM,KAAKiB,a,CAIP,WAAAgL,GACE,OAAOjM,KAAKzC,aAAawJ,U,CAQnB,WAAAmF,GACN,IAAIC,EAAenM,KAAKkL,uBACxB,IAAIkB,EAAoB,SAAWpM,KAAKiL,kBAAoB,IAAMkB,EAAaE,UAAY,KAAOF,EAAaG,WAAa,GAAK,IAAMH,EAAaI,cACpJ,IAAIC,EAAgBC,SAASC,cAAc,kBAC3C,IAAIC,EAAeF,SAASC,cAAcN,GAC1C,IAAIQ,EAAM,CAAE5C,IAAK,IAAKF,KAAM,IAAKC,MAAO,IAAK8C,OAAQ,QAErD,IAAKF,GAAgBH,GAAiBG,EAAaG,yBAA2BN,EAAcM,wBAAyB,CACnHpK,QAAQgC,KAAK,8BAA+B0H,EAAmBpM,KAAKzC,cACpE,OAAOqP,C,CAET,IAAIG,EAAoBP,EAAcM,wBACtC,IAAIE,EAAeL,EAAaG,wBAChC9M,KAAK3B,SAAW2B,KAAK3B,UAAY2O,EAAajD,MAC9C6C,EAAI5C,IAAMgD,EAAahD,IAAMgD,EAAaH,OAAS,EAAI7M,KAAKzB,UAAYwO,EAAkB/C,IAAM,KAGhG4C,EAAI9C,KACFkD,EAAalD,OACX9J,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YAAc,EAAI9B,KAAK3B,SAAW,GACxJ2B,KAAK1B,WAAa,EAClByO,EAAkBjD,KAClB,KACF8C,EAAI7C,OACD/J,KAAKiM,gBAAkBjM,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YAAc,GAAM,IAC9J9B,KAAK3B,SACP2B,KAAK1B,WACL,KACF,OAAOsO,C,CAGD,SAAAK,CAAUC,GAChB,OAAOA,EAAQC,WAAWD,GAAS,C,CAGrC,aAAAE,CAAc/L,EAAYgM,GACxBhM,EAAMiM,iBACNjM,EAAMkM,kBACNlM,EAAMmM,2BAEN,GAAIxN,KAAKQ,cAAgBR,KAAK6K,uBAAwB,CACpD,OAAO,I,CAGT7K,KAAKjB,WAAasO,EAClBrN,KAAKhB,WAAa,KAElBgB,KAAKc,cAAc,OACnBd,KAAKtB,UAAY2O,IAAS,OAC1B,GAAIA,IAAS,OAAQ,CACnBrN,KAAKf,SAAWoC,EAAMoM,SAAWpM,EAAMqM,QAAQ,GAAGD,QAClDzN,KAAKd,SAAWmC,EAAMsM,SAAWtM,EAAMqM,QAAQ,GAAGC,QAClD3N,KAAKN,YAAcM,KAAK4J,QAAQkD,wBAChC,MAAMc,EAAU,EAChB,MAAMC,EAAU,EAChB7N,KAAKR,YAAc,CACjB2I,GAAInI,KAAKwB,eACTO,WAAY/B,KAAKiL,kBACjBjB,IAAKhK,KAAKiN,UAAUjN,KAAK4J,QAAQC,MAAMG,KAAO6D,EAC9C/D,KAAM9J,KAAKiN,UAAUjN,KAAK4J,QAAQC,MAAMC,MAAQ8D,GAElD5N,KAAKR,YAAYsO,EAAI9N,KAAKR,YAAYsK,KACtC9J,KAAKR,YAAYuO,EAAI/N,KAAKR,YAAYwK,IACtChK,KAAKP,WAAa,IAAKO,KAAKR,aAC5BQ,KAAK4J,QAAQC,MAAMG,IAAM,GAAGhK,KAAKR,YAAYwK,QAC7ChK,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKR,YAAYsK,SAC9C9J,KAAKL,aAAe,KACpBK,KAAKpC,kBAAkB+G,KAAK,CAC1BwD,GAAI,6BACJjC,KAAMlG,KAAKR,a,KAER,CACLQ,KAAKX,aAAeW,KAAK4J,QAAQoE,YACjChO,KAAKV,YAAcU,KAAK4J,QAAQqE,WAChCjO,KAAKf,SAAWoC,EAAMoM,SAAWpM,EAAMqM,QAAQ,GAAGD,QAClDzN,KAAKpC,kBAAkB+G,KAAK,CAC1BwD,GAAI,6BACJjC,KAAM,CACJiC,GAAInI,KAAKwB,eACTO,WAAY/B,KAAKiL,kBACjBjB,IAAKhK,KAAKiN,UAAUjN,KAAK4J,QAAQC,MAAMG,KACvCF,KAAM9J,KAAKV,YACXwO,EAAG9N,KAAKf,SACR8O,EAAG1M,EAAMsM,SAAWtM,EAAMqM,QAAQ,GAAGC,U,CAK3ClB,SAASyB,iBAAiB,YAAalO,KAAKD,qBAC5C0M,SAASyB,iBAAiB,YAAalO,KAAKD,qBAC5C0M,SAASyB,iBAAiB,cAAelO,KAAKD,qBAE9C0M,SAASyB,iBAAiB,UAAWlO,KAAKG,mBAC1CsM,SAASyB,iBAAiB,UAAWlO,KAAKG,mBAC1CsM,SAASyB,iBAAiB,YAAalO,KAAKG,kB,CAG9C,eAAAF,CAAgBoB,GACd,GAAIrB,KAAKhB,WAAY,CACnBgB,KAAKb,SAAWkC,EAAMoM,SAAWpM,EAAMqM,QAAQ,GAAGD,QAClD,IAAIU,EAAYnO,KAAKb,SAAWa,KAAKf,SACrC,GAAIe,KAAKjB,aAAe,OAAQ,CAC9BiB,KAAKZ,SAAWiC,EAAMsM,SAAWtM,EAAMqM,QAAQ,GAAGC,QAClD,IAAIS,EAAYpO,KAAKZ,SAAWY,KAAKd,SACrCc,KAAK4J,QAAQC,MAAMG,IAAM,GAAGhK,KAAKR,YAAYwK,IAAMoE,MACnDpO,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKR,YAAYsK,KAAOqE,MACrDnO,KAAKP,WAAa,CAChB0I,GAAInI,KAAKwB,eACTO,WAAY/B,KAAKiL,kBACjBjB,IAAKhK,KAAKR,YAAYwK,IAAMoE,EAC5BtE,KAAM9J,KAAKR,YAAYsK,KAAOqE,GAEhCnO,KAAKP,WAAWqO,EAAI9N,KAAKP,WAAWqK,KACpC9J,KAAKP,WAAWsO,EAAI/N,KAAKP,WAAWuK,IACpChK,KAAKpC,kBAAkB+G,KAAK,CAAEwD,GAAI,YAAajC,KAAMlG,KAAKP,Y,KACrD,CAIL,GAAIO,KAAKK,OAAS,YAAa,CAC7B,M,CAEF,MAAMgO,GAAiBrO,KAAKzC,aAAaqI,YAAc5D,EAAYhC,KAAKzC,aAAasD,aACrF,IAAIyN,EAAWtO,KAAKX,aACpB,GAAIW,KAAKjB,YAAc,YAAa,CAClCuP,EAAWtO,KAAKX,aAAe8O,EAC/BG,EAAWC,KAAKC,IAAIF,EAAUtO,KAAKf,SAAWe,KAAK4J,QAAQoE,aAC3DM,EAAWC,KAAKE,IAAIzO,KAAK3B,SAAW2B,KAAK1B,WAAYgQ,GACrDtO,KAAK5B,YAAc+P,EAAY,EAC/B,IAAKnO,KAAK5B,aAAeiQ,EAAe,CACtC,M,CAEF,GAAIrO,KAAKK,OAAS,aAAc,CAC9B,M,CAEFL,KAAK4J,QAAQC,MAAME,MAAQ,GAAGuE,K,MACzB,GAAItO,KAAKjB,YAAc,WAAY,CACxCiB,KAAK5B,YAAc+P,EAAY,EAC/B,IAAKnO,KAAK5B,aAAeiQ,EAAe,CACtC,M,CAEF,GAAIrO,KAAKK,OAAS,YAAa,CAC7B,M,CAEFiO,EAAWC,KAAKE,IAAIzO,KAAK3B,SAAW2B,KAAK1B,WAAY0B,KAAKX,aAAe8O,GACzE,IAAIO,EAAU1O,KAAKV,aAAeU,KAAKX,aAAeiP,GACtDtO,KAAK4J,QAAQC,MAAMC,KAAO,GAAG4E,MAC7B1O,KAAK4J,QAAQC,MAAME,MAAQ,GAAGuE,K,CAEhCtO,KAAKT,WAAa+O,C,MAEf,CACL5L,QAAQC,IAAI,gC,EAIhB,aAAAvC,GACE,GAAIJ,KAAKhB,WAAY,CACnB,GAAIgB,KAAKjB,aAAe,OAAQ,CAK9B,GAAIiB,KAAKL,aAAc,CACrBK,KAAKJ,gBAAkB2O,KAAKI,IAAI3O,KAAKP,WAAWqO,EAAI9N,KAAKR,YAAYsO,GACrE9N,KAAKH,gBAAkB0O,KAAKI,IAAI3O,KAAKP,WAAWsO,EAAI/N,KAAKR,YAAYuO,E,CAEvE/N,KAAKpC,kBAAkB+G,KAAK,CAC1BwD,GAAI,gBACJjC,KAAM,IACDlG,KAAKP,WACR0C,KAAMnC,KAAKzC,aAAa4J,KACxByH,SAAU5O,KAAKzC,aAAawJ,a,KAG3B,CACL,MAAMxH,EACJS,KAAKT,aACHS,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YAAc9B,KAAK3B,SAAW,EAAI,GAC1J,MAAMwQ,EAAeN,KAAKO,MAAMvP,EAAaS,KAAK3B,UAClDqE,QAAQC,IAAIpD,EAAYS,KAAK3B,SAAUwQ,GACvC,IAAIE,EAAkB/O,KAAKiM,cAC3B,GAAI8C,GAAmBF,IAAiBG,MAAMH,GAAe,CAE3D,GAAI7O,KAAKjB,YAAc,WAAY,CACjCiB,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKV,aAAeyP,EAAkBF,GAAgB7O,KAAK3B,Y,KAEnF,CACL,GAAIwQ,EAAeE,EAAiB,CAClC/O,KAAK5B,YAAc,I,EAMvB4B,KAAKpC,kBAAkB+G,KAAK,CAC1BwD,GAAI,mBACJjC,KAAM,CACJiC,GAAInI,KAAKwB,eACTO,YAAa/B,KAAKiL,kBAClB6C,GAAI9N,KAAK4J,QAAQC,MAAMC,KAAKmF,QAAQ,KAAM,IAC1ClB,GAAI/N,KAAK4J,QAAQC,MAAMG,IAAIiF,QAAQ,KAAM,IACzC9M,KAAMnC,KAAKzC,aAAa4J,KACxByH,SAAUC,KAGd,MAAMK,GAAUlP,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,aAAe9B,KAAK3B,SAAW,EAAI,EACvK2B,KAAK4J,QAAQC,MAAME,MAAQ,GAAG8E,EAAe7O,KAAK3B,SAAW2B,KAAK1B,WAAa4Q,K,KAC1E,CACLlP,KAAK4J,QAAQC,MAAMC,KAAO,GAAG9J,KAAKV,gBAClCU,KAAK4J,QAAQC,MAAME,MAAQ,GAAG8E,EAAe7O,KAAK3B,SAAW2B,KAAK1B,c,OAGjE,CACLoE,QAAQC,IAAI,8B,CAEd3C,KAAKhB,WAAa,MAElByN,SAAS0C,oBAAoB,YAAanP,KAAKD,qBAC/C0M,SAAS0C,oBAAoB,YAAanP,KAAKD,qBAC/C0M,SAAS0C,oBAAoB,cAAenP,KAAKD,qBAEjD0M,SAAS0C,oBAAoB,UAAWnP,KAAKG,mBAC7CsM,SAAS0C,oBAAoB,UAAWnP,KAAKG,mBAC7CsM,SAAS0C,oBAAoB,YAAanP,KAAKG,kB,CAGjD,UAAAiP,CAAWlJ,GACTlG,KAAKrC,gBAAgBgH,KAAKuB,E,CAEpB,sBAAAmJ,GACN,MAAMC,EAAUtP,KAAK4J,QAAQkD,wBAC7B,MAAMyC,EAAWD,EAAQvF,MACzB,MAAMyF,EAAUF,EAAQxF,KACxB,MAAM2F,EAAcC,OAAOC,WAE3B,IAAIC,EAEJ,GAAIL,GAAYE,EAAa,CAC3BG,EAAYL,EAAW,C,KAClB,CACLK,EAAYH,EAAc,EAAID,C,CAEhC,MAAO,CACLrR,SAAU,WACV2L,KAAM,GAAG8F,MACTC,UAAW,mB,CAGP,wBAAAC,GACN,GAAI9P,KAAKzC,aAAawD,SAAW,cAAgBf,KAAKzC,aAAakJ,KAAO,iBAAkB,CAC1F,MAAO,E,CAET,GAAIzE,EAAYhC,KAAKzC,aAAasD,aAAc,CAC9C,MAAO,E,CAET,IAAKb,KAAKzC,aAAaqI,UAAW,CAChC,MAAO,MAAM5F,KAAKzC,aAAa+J,qB,CAEjC,MAAO,MAAMtH,KAAKzC,aAAakI,gB,CAGzB,aAAA3E,CAAciP,GACpB,GAAI/P,KAAK6K,wBAA0B7K,KAAKzC,aAAakD,WAAY,CAC/D,OAAO,I,CAGT,GAAIsP,EAAU,CAEZ,IAAIvD,EAAgBC,SAASC,cAAc,4BAC3C,IAAIK,EAA4CP,EAAcM,wBAC9D,IAAIpN,EAAsCM,KAAK4J,QAAQkD,wBACvD,IAAIkD,EAAWjD,EAAkBF,OAAS,EAAIE,EAAkB/C,IAAM,GAEtE,GAAItK,EAAYsK,IAAMgG,EAAU,CAC9BhQ,KAAKvB,kBAAoB,K,KACpB,CACLuB,KAAKvB,kBAAoB,I,EAI7B,GAAIsR,EAAU,CACZ/P,KAAKtC,eAAeiH,KAAK,CACvBlD,IAAK,YACLF,oBAAqBvB,KAAKwB,gB,CAG9BxB,KAAKxB,cAAgBuR,EACrB/P,KAAKiB,a,CAQC,6BAAAgP,GACN,MAAMC,EAAgBlQ,KAAKzC,aAAaiK,eACxC,IAAK0I,GAAeC,KAAM,CACxB,OAAO,K,CAET,MAAMC,EAAK7N,EAAO2G,EAAcC,SAASkH,iBAAiBC,eAAgB,SAC1E,MAAMC,EAAKhO,EAAO2N,EAAczM,YAAa,SAC7C,OAAO2M,EAAG7L,SAASgM,E,CAEb,gBAAAC,GACN,MAAMC,EAAcC,EAAgB1Q,KAAKzC,aAAaoT,OACtD,IAAIC,EAAY,KAChB,GAAIH,EAAa,CACfG,EAAYC,EAAaJ,EAAazQ,KAAKzC,aAAaoI,aAAe,E,CAEzE,OAAOiL,C,CAGT,MAAAE,GACE,IAAIC,EAAS/Q,KAAKqL,iBAElB,IAAI2F,EAAWhR,KAAK4L,cACpB,IAAIqF,EAAcjR,KAAK8L,iBAEvB,IAAIoF,EAAkBlR,KAAKzC,aAAaqK,WAAWuJ,eAAiBnR,KAAKzC,aAAaqK,UAAUuJ,gBAAgBC,eAAe3F,OAASsF,EAAOtF,MAAQsF,EAAOtF,MAE9J,MAAM4F,WAAEA,EAAUC,OAAEA,GAAWpI,EAAcqI,oBAAoBL,IAAoB,CACnFG,WAAY,GACZG,SAAU,IAEZN,EAAkBlR,KAAKzC,aAAawD,SAAW,cAAgBgQ,EAAOtF,MAAQyF,EAC9E,MAAMjB,EAAgCjQ,KAAKiQ,gCAC3C,MAAM1H,QAAEA,EAAOF,IAAEA,EAAGC,aAAEA,GAAiBtI,KAAKoI,cAC5C,MAAMwI,EAAY5Q,KAAKwQ,mBAEvB,OACEiB,EAACC,EAAI,CAAAjQ,IAAA,2CAACkQ,MAAO,iBAAiB3R,KAAKQ,cAAgBR,KAAK6K,uBAAyB,WAAa,MAAMkG,EAAOa,WAAY/H,MAAO7J,KAAKkM,cAAe/D,GAAIE,GACpJoJ,EAAA,OAAAhQ,IAAA,2CACEkQ,MAAO,CACLE,iBAAoB,KACpBC,YAAe9R,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YACnIiQ,aAAgB/R,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa3B,UAAUkC,QAAQ,IAAImG,KAAKzK,KAAKzC,aAAawF,UACjI,uBAAwB/C,KAAKzC,aAAawD,SAAW,WACrD,uBAAwBiB,EAAYhC,KAAKzC,aAAasD,cAAgBb,KAAKzC,aAAasD,cAAgB,MACxG,wCACGb,KAAKzC,aAAaqI,YAAc5D,EAAYhC,KAAKzC,aAAasD,cAAgBb,KAAKzC,aAAawD,SAAW,cAAgBf,KAAKzC,aAAakJ,KAAO,iBACvJmK,CAACA,GAAY,MAEf/G,MAAO,CACLqH,gBAAmBA,EACnB,gBAAiBA,EACjB,6BAA8BI,GAEhCU,aAAc3Q,GAASrB,KAAKoN,cAAc/L,EAAO,QACjD4Q,YAAa5Q,GAASrB,KAAKoN,cAAc/L,EAAO,UAEjD4O,GAAiCwB,EAAA,cAAAhQ,IAAA,2CAAYyQ,IAAK5J,GAAY,mBAAmBtI,KAAKzC,aAAaiK,gBAAgB/D,aACnHwN,GAAeQ,EAAA,cAAAhQ,IAAA,2CAAYyQ,IAAK3J,GAAO,YAAY4J,EAAajJ,EAAcC,SAAS/L,SAASgV,OAAQpS,KAAKzC,aAAa8J,UAC1H2J,EAAWS,EAAA,OAAKE,MAAM,yBAAyB9H,MAAO,CAAEqH,gBAAiBF,EAASvF,SAAkB,MACnGwF,GAAehB,IACfwB,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,sBACR1B,GAAiCwB,EAAA,OAAAhQ,IAAA,2CAAK0G,GAAIG,EAAcqJ,MAAM,gBAAgB9H,MAAO,CAAEqH,gBAAiB,aACxGD,EAAcQ,EAAA,OAAKtJ,GAAII,EAASoJ,MAAM,gBAAgB9H,MAAO,CAAEqH,gBAAiB,aAAsB,MAI3GO,EAAA,OAAAhQ,IAAA,2CACEkQ,MAAM,oBACN9H,MAAO,CAAE4B,MAAO4F,GAChBW,aAAc3Q,GAASrB,KAAKoN,cAAc/L,EAAO,QACjD4Q,YAAa5Q,GAASrB,KAAKoN,cAAc/L,EAAO,SAE/CrB,KAAKgL,cACLhL,KAAK8P,4BAER2B,EAACY,EAAQ,CAAA5Q,IAAA,4CACPgQ,EAAA,OAAAhQ,IAAA,2CACEkQ,MAAO,oCACJ3R,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YAAc,aAAe,oBAEjJ9B,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa3B,UAAUkC,QAAQ,IAAImG,KAAKzK,KAAKzC,aAAawF,UAAY,cAAgB,KAChJiP,aAAc3Q,GAASrB,KAAKoN,cAAc/L,EAAO,YACjD4Q,YAAa5Q,GAASrB,KAAKoN,cAAc/L,EAAO,cAElDoQ,EAAA,OAAAhQ,IAAA,2CACEkQ,MAAO,qCACJ3R,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa1B,YAAYkC,SAAS,IAAIkG,KAAKzK,KAAKzC,aAAauE,YAAc,aAAe,sBAE/I9B,KAAKQ,cAAgB+B,EAAO,IAAIkI,KAAKzK,KAAKzC,aAAawG,aAAa3B,UAAUkC,QAAQ,IAAImG,KAAKzK,KAAKzC,aAAawF,UAAY,cAAgB,KAClJiP,aAAc3Q,GAASrB,KAAKoN,cAAc/L,EAAO,aACjD4Q,YAAa5Q,GAASrB,KAAKoN,cAAc/L,EAAO,gBAInDrB,KAAKxB,cACJiT,EAAA,2BACEpU,mBAAoB2C,KAAK3C,mBACzBI,UAAWuC,KAAKvC,UAChBL,SAAU4C,KAAK5C,SACfuU,MAAM,MACNpU,aAAcyC,KAAKzC,aACnB+U,cAAetS,KAAKvB,kBACpBoL,MAAO7J,KAAKqP,2BAEZ,K,GA1rBVkD,EAAA,CADCC,K,qDC/SUC,EACHC,SAAW,MACFC,YAQjB,WAAAC,CAAYC,GACV7S,KAAK2S,YAAcE,EAAQF,aAAW,MAAa,GACnD,GAAIE,EAAQC,aAAc,CACxB9S,KAAK+S,U,EAKF,QAAAA,GACL,GAAI/S,KAAK0S,SAAU,OACnBhD,OAAOxB,iBAAiB,eAAgBlO,KAAKgT,mBAAoB,CAAEC,QAAS,OAC5EjT,KAAK0S,SAAW,I,CAIX,UAAAQ,GACL,IAAKlT,KAAK0S,SAAU,OACpBhD,OAAOP,oBAAoB,eAAgBnP,KAAKgT,mBAAoB,CAAEC,QAAS,OAC/EjT,KAAK0S,SAAW,K,CAIVM,mBAAsBG,IAC5BnT,KAAK2S,cACLQ,EAAE7F,iBACF6F,EAAEC,YAAc,EAAE,ECnCtB,MAAMC,EAAkB,2lBACxB,MAAAC,EAAeD,ECDf,MAAME,EAAW,0pBACjB,MAAAC,EAAeD,E,MCmBFE,EAAY,M,6FACfC,eAAiB,EACjBC,YAECC,kBAA2D,IAAIC,IAC/DC,aAGE,KACFC,OACAC,UACAC,WAAkC,QAClCC,MAGH,CAAC,CAAEC,KAAM,KAAMC,GAAI,OAEhBC,WACArW,MAEDsW,QACAC,SAA+E,GAC/EC,kBACAC,QAAUlS,IAASE,OAAO,cAC1B5D,eAAiB,IAAIC,EAErB4V,YAAcC,EAAEC,MACtBD,EAAEE,OAAO,CACPV,KAAMQ,EACHG,MACAC,QAAQC,GAAuBzS,EAAO0S,SAASD,IAAM,CACpDlP,QAAS,mDAEV+J,WAAWmF,GAAgBA,EAAIvS,OAAO,gBACzC2R,GAAIO,EACDG,MACAC,QAAQC,GAAuBzS,EAAO0S,SAASD,IAAM,CACpDlP,QAAS,iDAEV+J,WAAWmF,GAAgBA,EAAIvS,OAAO,mBAIrCyS,aACAC,cAER,gBAAA5U,GACEP,KAAKwU,kBAAoB,IAAI/B,EAAkB,CAAEK,aAAc,QAC/D9S,KAAKsU,QAAU7H,SAASC,cAAc,a,CAGxC,oBAAAxL,GACElB,KAAKwU,kBAAkBtB,Y,CAGjB,mBAAMkC,GACZ,IACEpV,KAAK+T,OAAS,KACd/T,KAAKgU,UAAY,KACjB,MAAMqB,EAAUrV,KAAK0U,YAAYY,MAAMtV,KAAKkU,OAC5C,IAAKlU,KAAK8T,aAAc,CACtB9T,KAAKkV,aAAaK,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAC9DzV,KAAK+T,OAAS,QACd,M,CAEF,GAAI/T,KAAKiU,aAAe,QAAS,OACzBjU,KAAKnB,eAAe6W,6BAA6B,CACrDC,QAAS3V,KAAK8T,cAAc6B,QAC5BlS,YAAa,GACbkQ,YAAazK,EAAcC,SAAShB,GACpCyN,kBAAmB,MACnBC,SAAUR,EAAQS,KAAIC,IAAC,CACrB1T,UAAW0T,EAAE5B,KACb/R,QAAS2T,EAAE3B,Q,KAGV,OACCpU,KAAKnB,eAAemX,oBAAoB,CAC5CL,QAAS3V,KAAK8T,cAAc6B,QAC5BtT,UAAWgT,EAAQ,GAAGlB,KACtB/R,QAASiT,EAAQ,GAAGjB,I,CAGxBpU,KAAK+S,WACL/S,KAAKkT,aACLlT,KAAKhC,MAAM2G,KAAK,CACdoB,KAAM,UACNlB,MAAOM,EAAQC,QAAQ6Q,iCACvBxS,YAAa,KAEfzD,KAAKgU,UAAY,MACjBhU,KAAKqU,WAAW1P,M,CAChB,MAAOkB,GACPnD,QAAQC,IAAIkD,GACZ,GAAIA,aAAiBqQ,EAAU,CAC7BlW,KAAKmV,cAAcI,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAC/DzV,KAAK+T,OAAS,O,UAGhB/T,KAAKgU,UAAY,K,EAIb,QAAAjB,GACN/S,KAAKwU,kBAAkBzB,WACvB,GAAI/S,KAAKsU,QAAStU,KAAKsU,QAAQ6B,aAAe,I,CAGxC,UAAAjD,GACNlT,KAAKwU,kBAAkBtB,aACvB,GAAIlT,KAAKsU,QAAStU,KAAKsU,QAAQ6B,aAAe,K,CAGxC,gBAAAC,EAAiBC,MAAEA,EAAKC,KAAEA,EAAI7U,IAAEA,IAEtC,MAAMyS,EAAQ,IAAIlU,KAAKkU,OACvBA,EAAMmC,GAAS,IAAKnC,EAAMmC,GAAQ5U,CAACA,GAAM6U,GAGzC,GAAI7U,IAAQ,QAAUyS,EAAMmC,GAAOjC,IAAI7P,SAAS+R,EAAM,SAAU,CAC9DpC,EAAMmC,GAAOjC,GAAK,I,CAIpB,IAAK,IAAImC,EAAIF,EAAQ,EAAGE,EAAIrC,EAAMxN,OAAQ6P,IAAK,CAC7C,MAAMC,EAAUtC,EAAMqC,IAAIpC,KAC1B,GAAIqC,GAAWA,EAAQC,eAAeH,EAAM,OAAQ,CAClDpC,EAAMqC,GAAK,CAAEpC,KAAM,KAAMC,GAAI,K,EAKjCpU,KAAKkU,MAAQA,EAGbxT,YAAW,KACT,GAAIe,IAAQ,OAAQ,CAClBzB,KAAKuU,SAAS8B,IAAQjC,GAAGsC,gB,KACpB,CACL,MAAMC,EAAWzC,EAAM0C,WAAUC,GAAKA,EAAE1C,OAAS,OACjD,GAAIwC,GAAY,EAAG,CACjB3W,KAAKuU,SAASoC,IAAWxC,KAAKuC,gB,KAGjC,I,CAGG,UAAAI,GACN,MAAMC,EAAa/W,KAAKkU,MAAMlU,KAAKkU,MAAMxN,OAAS,GAClD,IAAKqQ,EAAW5C,OAAS4C,EAAW3C,GAAI,CACtCpU,KAAK+T,OAAS,QACd,M,CAEF/T,KAAK+T,OAAS,KACd/T,KAAKkU,MAAQ,IAAIlU,KAAKkU,MAAO,CAAEC,KAAM,KAAMC,GAAI,OAC/C1T,YAAW,KACTV,KAAKuU,SAASvU,KAAKkU,MAAMxN,OAAS,GAAG0N,IAAImB,eAAe,CAAEC,SAAU,SAAUC,MAAO,UAAW,GAC/F,I,CAGL,MAAA3E,GACE,OACEW,EAAA,QAAAhQ,IAAA,2CACEkQ,MAAO,uBACPqF,SAAU7D,IACRA,EAAE7F,iBACFtN,KAAKoV,eAAe,GAGtB3D,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,mBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,gEAAgE9H,MAAO,CAAEoN,IAAK,WACvFxF,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,WAAS,sBAClBF,EAAA,aAAAhQ,IAAA,2CACEyV,gBAAiB,MACjBC,cAAenX,KAAKiU,WACpB/N,KAAM,CACJ,CAAEkR,KAAM,QAASC,MAAO,SACxB,CAAED,KAAM,UAAWC,MAAO,YAE5BC,eAAgBnE,IACdnT,KAAKiU,WAAad,EAAE7R,MAAM,KAIhCmQ,EAAA,OAAAhQ,IAAA,4CACGzB,KAAK+T,SAAW,SACftC,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAO,qCAAsC9H,MAAO,CAAE,gBAAiB,WACvEX,EAAc7L,mBAAqB8H,EAAQC,QAAQmS,wBAA0BpS,EAAQC,QAAQoS,sBAGlG/F,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,iBAAiB8F,IAAKC,GAAO1X,KAAKkV,aAAewC,GACxDxO,EAAclB,UAAU8N,KAAI/N,GAEzB0J,EAACY,EAAQ,KACPZ,EAAA,MAAIhQ,IAAK,eAAesG,EAASI,KAAMwJ,MAAO,iBAC5CF,EAAA,OAAKE,MAAO,qBACVF,EAAA,QAAME,MAAM,iCAAiC5J,EAAS4P,QAGzD5P,EAASE,cAAc6N,KAAI,CAACtP,EAAMoR,KACjC,MAAMC,EAAYD,IAAM7P,EAASE,cAAcvB,OAAS,EAAI,OAAS,GACrE,OACE+K,EAAA,MAAIhQ,IAAK,gBAAgB+E,EAAK2B,MAAMyP,IAAKjG,MAAO,iBAAiBkG,KAC/DpG,EAAA,OAAKE,MAAO,qBACVF,EAAA,YACEE,MAAM,QACNgG,KAAK,OACLG,QAAS9X,KAAK8T,cAAc6B,UAAYnP,EAAK2B,GAC7C4P,cAAe,IACZ/X,KAAK8T,aAAe,CACnBkE,YAAajQ,EAASI,GACtBwN,QAASnP,EAAK2B,IAGlB8P,MAAOzR,EAAKmR,QAGb,SASnBlG,EAAA,SAAAhQ,IAAA,2CAAOkQ,MAAM,OAAO8F,IAAKC,GAAO1X,KAAKmV,cAAgBuC,GACnDjG,EAAA,SAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,aAAaxM,EAAQC,QAAQ8S,UACvCzG,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,aAAaxM,EAAQC,QAAQ+S,iBACvC1G,EAAA,MAAAhQ,IAAA,4CACGzB,KAAKkU,MAAMxN,SAAW1G,KAAK0T,gBAAkB1T,KAAKiU,aAAe,SAChExC,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACRC,UAAU,OACVC,eAAgB,KACdtY,KAAK8W,YAAY,OAO7BrF,EAAA,SAAAhQ,IAAA,4CACGzB,KAAKkU,MAAM4B,KAAI,CAACe,EAAGN,KAClB,IAAKvW,KAAKuU,SAASgC,GAAI,CACrBvW,KAAKuU,SAASgC,GAAK,E,CAErB,MAAMgC,EAAkBhC,EAAI,EAAIvW,KAAKkU,MAAMqC,EAAI,IAAInC,GAAGoE,QAAQhW,IAAI,EAAG,SAASC,OAAO,eAAiBzC,KAAKyU,QAAUzU,KAAKyU,QAC1H,MAAMgE,EAAgBzY,KAAKkU,MAAMqC,GAAGpC,KAAOnU,KAAKkU,MAAMqC,IAAIpC,KAAKqE,QAAQhW,IAAI,EAAG,SAASC,OAAO,cAAgBzC,KAAKyU,QACnH,OACEhD,EAAA,MAAIhQ,IAAK,QAAQ8U,KACf9E,EAAA,MAAIE,MAAM,aACRF,EAAA,kBACEgG,IAAKC,IACH1X,KAAKuU,SAASgC,GAAGpC,KAAOuD,CAAE,EAE5BgB,qBAAoB,KACpBjE,QAAS8D,EAAe,cACZ,sBACZjC,KAAMO,EAAE1C,MAAM1R,OAAO,cACrBkW,cAAe,KAAI,eACLC,OAAO5Y,KAAK+T,SAAW,UAAY8C,EAAE1C,MACnD0E,cAAeC,IACbA,EAAItL,2BACJsL,EAAIvL,kBACJvN,KAAKoW,iBAAiB,CAAEC,MAAOE,EAAGD,KAAMwC,EAAIxX,OAAOyX,MAAOtX,IAAK,QAAS,EAE1EuX,kBAAmB7F,IACjBA,EAAE3F,2BACF2F,EAAE5F,kBACF,GAAIgJ,IAAM,EAAG,CACX,M,CAEF,MAAMF,EAAQrW,KAAKkU,MAAM0C,WAAUC,IAAMA,EAAE1C,OAAS0C,EAAEzC,KAEtD,IAAKpU,KAAKkU,MAAMmC,IAAQlC,KAAM,CAC5BnU,KAAKuU,SAAS8B,IAAQlC,KAAKuC,iBAC3B,M,CAEF,IAAK1W,KAAKkU,MAAMmC,IAAQjC,GAAI,CAC1BpU,KAAKuU,SAAS8B,GAAOjC,GAAGsC,gB,IAI5BjF,EAAA,SACE1L,KAAK,OACLkT,KAAK,UACL5B,MAAOR,EAAE1C,KAAO0C,EAAE1C,KAAK1R,OAAO,gBAAkB,KAChDkP,MAAO,yBAAyB3R,KAAK+T,SAAW,UAAY8C,EAAEzC,GAAK,gBAAkB,iBACrFvK,MAAO,CAAEE,MAAO,YAItB0H,EAAA,MAAIE,MAAM,aACRF,EAAA,kBACEiH,qBAAoB,KACpBjB,IAAKC,IACH1X,KAAKuU,SAASgC,GAAGnC,GAAKsD,CAAE,EACzB,cACW,sBACZpB,KAAMO,EAAEzC,IAAI3R,OAAO,cACnBkW,cAAe,KACflE,QAASgE,EAAa,eACRG,OAAO5Y,KAAK+T,SAAW,UAAY8C,EAAEzC,IACnDyE,cAAeC,IACbA,EAAItL,2BACJsL,EAAIvL,kBACJvN,KAAKoW,iBAAiB,CAAEC,MAAOE,EAAGD,KAAMwC,EAAIxX,OAAOyX,MAAOtX,IAAK,MAAO,EAExEyX,QAASrC,EAAE1C,KAAO5R,EAAOsU,EAAE1C,MAAM3R,IAAI,EAAG,UAAUC,OAAO,cAAgB8G,UACzEyP,kBAAmB7F,IACjBA,EAAE3F,2BACF2F,EAAE5F,kBACF,MAAM8I,EAAQrW,KAAKkU,MAAM0C,WAAUC,IAAMA,EAAE1C,OAAS0C,EAAEzC,KAEtD,IAAKpU,KAAKkU,MAAMmC,IAAQlC,KAAM,CAC5BnU,KAAKuU,SAAS8B,IAAQlC,MAAMuC,iBAC5B,M,CAEF,IAAK1W,KAAKkU,MAAMmC,IAAQjC,GAAI,CAC1BpU,KAAKuU,SAAS8B,GAAOjC,GAAGsC,gB,IAI5BjF,EAAA,SACE1L,KAAK,OACLkT,KAAK,UACL5B,MAAOR,EAAEzC,GAAKyC,EAAEzC,GAAG3R,OAAO,gBAAkB,KAC5CkP,MAAO,qDACL3R,KAAK+T,SAAW,UAAY8C,EAAEzC,GAAK,gBAAkB,4CAEvDvK,MAAO,CAAEE,MAAO,YAIrBwM,EAAI,GACH9E,EAAA,MAAIE,MAAM,QACRF,EAAA,aACE2G,QAAQ,OACRC,UAAU,QACVC,eAAgB,KACdtY,KAAKkU,MAAQlU,KAAKkU,MAAM3N,QAAO,CAAC4S,EAAGvB,IAAMA,IAAMrB,GAAE,KAKtD,OAMf9E,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,gBACVF,EAAA,aAAAhQ,IAAA,2CAAW2V,KAAMjS,EAAQC,QAAQgU,WAAYC,UAAU,YAAY1H,MAAO,YAAa2G,eAAgB,IAAMtY,KAAKqU,WAAW1P,KAAK,QAClI8M,EAAA,aAAAhQ,IAAA,2CAAWuS,UAAWhU,KAAKgU,UAAWoD,KAAMjS,EAAQC,QAAQkU,YAAaC,SAAS,SAAS5H,MAAM,e,eCxX3G,MAAM6H,EAAuB,2XAC7B,MAAAC,EAAeD,ECDf,MAAMjG,EAAW,6rBACjB,MAAAmG,EAAenG,E,MCQFoG,GAAiB,M,6FACpBjG,eAAiB,EACjBC,YAECU,WACArW,MAEA4b,YAEDC,KAAO,CACb,CACE1R,GAAI,YACJ8P,MAAO,kBAET,CACE9P,GAAI,QACJ8P,MAAO,eAIH6B,OACAC,QAER,gBAAAxZ,GACEP,KAAK8Z,OAAOjQ,MAAMmQ,YAAY,gBAAiBha,KAAK+Z,SAASjN,yBAAyBD,QAAQpD,WAAa,K,CAG7G,MAAAqH,GACE,OACEW,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,mCACVF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,0CACTF,EAAA,YAAAhQ,IAAA,2CACEgW,IAAKC,GAAO1X,KAAK+Z,QAAUrC,EAC3BuC,eAAgB9G,IACdA,EAAE3F,2BACF2F,EAAE5F,kBAIFvN,KAAKqU,WAAW1P,KAAK,KAAK,EAE5BgN,MAAM,YAENsG,MAAO,kBACPiC,eAAe,aAGnBzI,EAAA,WAAAhQ,IAAA,2CAASgW,IAAKC,GAAO1X,KAAK8Z,OAASpC,EAAK/F,MAAM,OAAOkI,KAAM7Z,KAAK6Z,KAAMM,aAAchH,GAAMnT,KAAK4Z,YAAczG,EAAE7R,SAC9GtB,KAAK4Z,aAAazR,KAAO,YACxBsJ,EAAA,sBAAoBiC,eAAgB1T,KAAK0T,eAAgBC,YAAa3T,KAAK2T,cAE3ElC,EAAA,kBAAgBiC,eAAgB1T,KAAK0T,eAAgBC,YAAa3T,KAAK2T,c,gBC5DjF,MAAMyG,GAAqB,sTAC3B,MAAAC,GAAeD,GCDf,MAAM7G,GAAW,srBACjB,MAAA+G,GAAe/G,G,MCeFgH,GAAe,M,6FAClB7G,eAAiB,EACjBC,YAECC,kBAAqC,GACrCG,OACAC,UACAE,MAGH,CAAC,CAAEC,KAAM,KAAMC,GAAI,OAEhBoG,iBAAgC,IAAIC,IAC3CpR,MAAM,GACHqR,KAAK,MACL5E,KAAI,CAACqD,EAAG5C,IAAMA,KAGVlC,WACArW,MAEDsW,QACAC,SAA+E,GAE/EC,kBACAC,QAAUlS,IAASE,OAAO,cAC1B5D,eAAiB,IAAIC,EACrB,WAAA6b,CAAYC,GAClB,OAAOrY,EAAOqY,EAAS,cAAcC,K,CAE/BnG,YAAcC,EAAEC,MACtBD,EAAEE,OAAO,CACPV,KAAMQ,EACHG,MACAC,QAAQC,GAAuBzS,EAAO0S,SAASD,IAAM,CACpDlP,QAAS,mDAEV+J,WAAWmF,GAAgBA,EAAIvS,OAAO,gBACzC2R,GAAIO,EACDG,MACAC,QAAQC,GAAuBzS,EAAO0S,SAASD,IAAM,CACpDlP,QAAS,iDAEV+J,WAAWmF,GAAgBA,EAAIvS,OAAO,mBAKrCyS,aACA4F,iBACA3F,cAER,gBAAA5U,GACEP,KAAKwU,kBAAoB,IAAI/B,EAAkB,CAAEK,aAAc,QAC/D9S,KAAKsU,QAAU7H,SAASC,cAAc,a,CAGxC,oBAAAxL,GACElB,KAAKwU,kBAAkBtB,Y,CAajB,mBAAMkC,GACZ,MAAM2F,EAA0B1F,IAC9B,MAAMU,EAAI,GACV,IAAK,MAAMiF,KAAU3F,EAAS,CAC5B,IAAI4F,EAAUD,EAAO7G,KACrB,MAAM+G,EAAU3Y,EAAOyY,EAAO5G,GAAI,cAAc5R,IAAI,EAAG,QAAQC,OAAO,cACtE,MAAOwY,IAAYC,EAAS,CAC1B,MAAMC,EAAU5Y,EAAO0Y,EAAS,cAAczY,IAAI,EAAG,QAAQC,OAAO,cACpE,IAAKzC,KAAKwa,iBAAiBY,IAAIpb,KAAK2a,YAAYM,IAAW,CACzDA,EAAUE,EACV,Q,CAEF,IAAK,MAAME,KAAgBrb,KAAK4T,kBAAmB,CACjDmC,EAAEuF,KAAK,CACLC,aAAcF,EAAalT,GAC3BqT,MAAOP,G,CAGXA,EAAUE,C,EAGd,OAAOpF,CAAC,EAEV,MAAM0F,EACJC,IAQA,MAAMC,EAAoB,IAAI9H,IAAI5Q,EAAeC,gBAGjD,MAAM0Y,EAAgB,IAAI/H,IAAI3K,EAAclB,UAAU8N,KAAI,CAAC+F,EAAItF,IAAM,CAACsF,EAAG1T,GAAI,CAAEJ,SAAU8T,EAAIxF,MAAOE,OACpG,MAAMuF,EAAkB,IAAIjI,IAAI5Q,EAAe8Y,KAAKjG,KAAI,CAAC+E,EAAKtE,IAAM,CAACsE,EAAIxD,MAAOd,MAChF,MAAMyF,EAAwB,IAAInI,IAElC,IAAK,MAAMvO,KAAWoW,EAAU,CAC9B,IAAK,MAAMO,KAAe3W,EAAQ4W,aAAc,CAC9C,MAAMV,MAAEA,EAAKD,aAAEA,GAAiBU,EAChC,MAAMlU,SAAEA,GAAa6T,EAAczY,IAAIoY,GAEvC,IAAKxT,EAAU,SAEf,MAAMoU,EAAWL,EAAgB3Y,IAAIqY,GACrC,GAAIW,IAAa5S,UAAW,CAC1B7G,QAAQgC,KAAK,sBAAsB8W,KACnC,Q,CAGF,MAAMX,EAAM5X,EAAe8Y,KAAKI,GAChC,MAAMC,EAAU,GAAGb,KAAgBC,IACnC,IAAIa,EAAKL,EAAsB7Y,IAAIiZ,GACnC,IAAKC,EAAI,CACPA,EAAKxB,EAAIyB,KAAKC,MAAKrU,GAAKA,EAAEC,KAAOoT,IACjC,IAAKc,EAAI,CACP3Z,QAAQgC,KAAK,2BAA2B6W,KACxC,Q,CAEFS,EAAsBQ,IAAIJ,EAASC,E,CAGrC,MAAMI,EAAoBJ,EAAGK,kBAA0BC,MAAQ,EAC/D,IAAK,MAAMnW,KAAQuB,EAASE,cAAe,CACzC,MAAMxG,EAAM,GAAG+E,EAAK2B,MAAMqT,IAC1BG,EAAkBa,IAAI/a,EAAK,CACzB2B,SAAUkC,EAAQsX,UAAY,KAAOH,EACrC7X,OAAQU,EAAQsX,UAAY,YAAcH,EAAmB,YAAc,a,GAKnFxZ,EAAe,kBAAoB,IAAI4Q,IAAI8H,EAAkB,EAE/D,IACE3b,KAAK+T,OAAS,KACd/T,KAAKgU,UAAY,KACjB,MAAMqB,EAAUrV,KAAK0U,YAAYY,MAAMtV,KAAKkU,OAC5C,GAAIlU,KAAK4T,kBAAkBlN,SAAW,EAAG,CACvC1G,KAAKkV,aAAaK,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAC9DzV,KAAK+T,OAAS,QACd,M,CAEF,GAAI/T,KAAKwa,iBAAiBqC,OAAS,EAAG,CACpC7c,KAAK8a,iBAAiBvF,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAClEzV,KAAK+T,OAAS,WACd,M,CAEF/T,KAAK+S,WACL,MAAM+J,EAAoB/B,EAAwB1F,GAClD,MAAM0H,EAAY/c,KAAK4T,kBAAkBoJ,OAAM7J,GAAKA,EAAE8J,SAAW,SACjE,MAAMC,EAAcld,KAAK4T,kBAAkBoJ,OAAM7J,GAAKA,EAAE8J,SAAW,WACnE,GAAIC,GAAeH,EAAW,CAC5B,MAAMzX,EAAU,CACdsX,UAAWM,EACXhB,aAAcY,EACdnJ,YAAa3T,KAAK2T,mBAEd3T,KAAKnB,eAAese,iCAAiC7X,GAC3DmW,EAAoB,CAACnW,G,KAChB,CACL,MAAMoW,EAAW,GACjB,IAAK,MAAMlV,KAAQxG,KAAK4T,kBAAmB,CACzC,MAAMyB,EAAUyH,EAAkBvW,QAAO6W,GAAKA,EAAE7B,eAAiB/U,EAAK2B,KACtEuT,EAASJ,KAAK,CACZsB,UAAWpW,EAAKyW,SAAW,SAC3Bf,aAAc7G,EACd1B,YAAa3T,KAAK2T,a,OAGhB0J,QAAQC,IAAI5B,EAAS5F,KAAIC,GAAK/V,KAAKnB,eAAese,iCAAiCpH,MACzF0F,EAAoBC,E,CAEtB1b,KAAKkT,aACLlT,KAAKhC,MAAM2G,KAAK,CACdoB,KAAM,UACNlB,MAAOM,EAAQC,QAAQ6Q,iCACvBxS,YAAa,KAEfzD,KAAKgU,UAAY,MACjBhU,KAAKqU,WAAW1P,M,CAChB,MAAOkB,GACPnD,QAAQC,IAAIkD,GACZ,GAAIA,aAAiBqQ,EAAU,CAC7BlW,KAAKmV,cAAcI,eAAe,CAAEC,SAAU,SAAUC,MAAO,QAC/DzV,KAAK+T,OAAS,O,UAGhB/T,KAAKgU,UAAY,K,EAIb,QAAAjB,GACN/S,KAAKwU,kBAAkBzB,WACvB,GAAI/S,KAAKsU,QAAStU,KAAKsU,QAAQ6B,aAAe,I,CAGxC,UAAAjD,GACNlT,KAAKwU,kBAAkBtB,aACvB,GAAIlT,KAAKsU,QAAStU,KAAKsU,QAAQ6B,aAAe,K,CAGxC,gBAAAC,EAAiBC,MAAEA,EAAKC,KAAEA,EAAI7U,IAAEA,IAEtC,MAAMyS,EAAQ,IAAIlU,KAAKkU,OACvBA,EAAMmC,GAAS,IAAKnC,EAAMmC,GAAQ5U,CAACA,GAAM6U,GAGzC,GAAI7U,IAAQ,QAAUyS,EAAMmC,GAAOjC,IAAI7P,SAAS+R,EAAM,SAAU,CAC9DpC,EAAMmC,GAAOjC,GAAK,I,CAIpB,IAAK,IAAImC,EAAIF,EAAQ,EAAGE,EAAIrC,EAAMxN,OAAQ6P,IAAK,CAC7C,MAAMC,EAAUtC,EAAMqC,IAAIpC,KAC1B,GAAIqC,GAAWA,EAAQC,eAAeH,EAAM,OAAQ,CAClDpC,EAAMqC,GAAK,CAAEpC,KAAM,KAAMC,GAAI,K,EAKjCpU,KAAKkU,MAAQA,EAGbxT,YAAW,KACT,GAAIe,IAAQ,OAAQ,CAClBzB,KAAKuU,SAAS8B,IAAQjC,GAAGsC,gB,KACpB,CACL,MAAMC,EAAWzC,EAAM0C,WAAUC,GAAKA,EAAE1C,OAAS,OACjD,GAAIwC,GAAY,EAAG,CACjB3W,KAAKuU,SAASoC,IAAWxC,KAAKuC,gB,KAGjC,I,CAGG,UAAAI,GACN,MAAMC,EAAa/W,KAAKkU,MAAMlU,KAAKkU,MAAMxN,OAAS,GAClD,IAAKqQ,EAAW5C,OAAS4C,EAAW3C,GAAI,CACtCpU,KAAK+T,OAAS,QACd,M,CAEF/T,KAAK+T,OAAS,KACd/T,KAAKkU,MAAQ,IAAIlU,KAAKkU,MAAO,CAAEC,KAAM,KAAMC,GAAI,OAC/C1T,YAAW,KACTV,KAAKuU,SAASvU,KAAKkU,MAAMxN,OAAS,GAAG0N,IAAImB,eAAe,CAAEC,SAAU,SAAUC,MAAO,UAAW,GAC/F,I,CAGL,MAAA3E,GACE,OACEW,EAAA,QAAAhQ,IAAA,2CACEkQ,MAAO,uBACPqF,SAAU7D,IACRA,EAAE7F,iBACFtN,KAAKoV,eAAe,GAkBtB3D,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,mBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kCACTF,EAAA,KAAAhQ,IAAA,kHAMFgQ,EAAA,OAAAhQ,IAAA,4CACGzB,KAAK+T,SAAW,SACftC,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAO,qCAAsC9H,MAAO,CAAE,gBAAiB,WACvEX,EAAc7L,mBAAqB8H,EAAQC,QAAQmS,wBAA0BpS,EAAQC,QAAQoS,sBAGlG/F,EAAA,SAAAhQ,IAAA,2CAAOgW,IAAKC,GAAO1X,KAAKkV,aAAewC,GACrCjG,EAAA,SAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,WAAS,UACnBF,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,WAAS,eAGvBF,EAAA,SAAAhQ,IAAA,4CACGyH,EAAclB,UAAU8N,KAAI,CAAC/N,EAAUwO,KACtC,MAAMsB,EAAYtB,IAAMrN,EAAclB,UAAUtB,OAAS,EAAI,GAAK,OAClE,OACE+K,EAAA,MAAIhQ,IAAKsG,EAASI,IAChBsJ,EAAA,MAAIE,MAAO,cAAckG,KACvBpG,EAAA,OAAKE,MAAO,8BACVF,EAAA,aACE8L,YAAa,GAAGpY,EAAQC,QAAQoY,gBAChCtX,KAAM,CACJ,CAAEmR,MAAO,OAAQD,KAAMjS,EAAQC,QAAQqY,UACvC,CAAEpG,MAAO,SAAUD,KAAMjS,EAAQC,QAAQsY,eAE3CpG,eAAgBnE,IACd,MAAMwK,EAASxK,EAAE7R,OAEjB,MAAMsc,EAAO5d,KAAK4T,kBAAkBrN,QAAOsX,GAASA,EAAM1V,KAAOJ,EAASI,KAE1E,GAAIwV,EAAQ,CACVC,EAAKtC,KAAK,CAAEnT,GAAIJ,EAASI,GAAI8U,OAAQU,G,CAEvC3d,KAAK4T,kBAAoBgK,CAAI,MAKrCnM,EAAA,MAAIE,MAAO,kBAAkBkG,KAAc9P,EAAS4P,MACjD,OAMflG,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,6BAA2B,iBACnC3R,KAAK+T,SAAW,YAActC,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAO,yCAAuC,kCAChFF,EAAA,uBAAAhQ,IAAA,2CACEgW,IAAKC,GAAO1X,KAAK8a,iBAAmBpD,EACpCoG,SAAUzU,MAAM8K,KAAKnU,KAAKwa,kBAC1BuD,gBAAiB5K,IACfA,EAAE5F,kBACF4F,EAAE3F,2BACFxN,KAAKwa,iBAAmB,IAAIC,IAAItH,EAAE7R,OAAO,IAI7CmQ,EAAA,SAAAhQ,IAAA,2CAAOkQ,MAAM,OAAO8F,IAAKC,GAAO1X,KAAKmV,cAAgBuC,GACnDjG,EAAA,SAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,aAAaxM,EAAQC,QAAQ8S,UACvCzG,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,aAAaxM,EAAQC,QAAQ+S,iBACvC1G,EAAA,MAAAhQ,IAAA,4CACGzB,KAAKkU,MAAMxN,SAAW1G,KAAK0T,gBAC1BjC,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACRC,UAAU,OACVC,eAAgB,KACdtY,KAAK8W,YAAY,OAO7BrF,EAAA,SAAAhQ,IAAA,4CACGzB,KAAKkU,MAAM4B,KAAI,CAACe,EAAGN,KAClB,IAAKvW,KAAKuU,SAASgC,GAAI,CACrBvW,KAAKuU,SAASgC,GAAK,E,CAGrB,MAAMgC,EAAkBhC,EAAI,EAAIvW,KAAKkU,MAAMqC,EAAI,IAAInC,GAAGoE,QAAQhW,IAAI,EAAG,SAASC,OAAO,eAAiBzC,KAAKyU,QAAUzU,KAAKyU,QAC1H,MAAMgE,EAAgBzY,KAAKkU,MAAMqC,GAAGpC,KAAOnU,KAAKkU,MAAMqC,IAAIpC,KAAKqE,SAAS/V,OAAO,cAAgBzC,KAAKyU,QACpG,OACEhD,EAAA,MAAIhQ,IAAK,QAAQ8U,KACf9E,EAAA,MAAIE,MAAM,aACRF,EAAA,kBACEgG,IAAKC,IACH1X,KAAKuU,SAASgC,GAAGpC,KAAOuD,CAAE,EAE5BgB,qBAAoB,KACpBjE,QAAS8D,EAAe,cACZ,sBACZjC,KAAMO,EAAE1C,MAAM1R,OAAO,cACrBkW,cAAe,KAAI,eACLC,OAAO5Y,KAAK+T,SAAW,UAAY8C,EAAE1C,MACnD0E,cAAeC,IACbA,EAAItL,2BACJsL,EAAIvL,kBACJvN,KAAKoW,iBAAiB,CAAEC,MAAOE,EAAGD,KAAMwC,EAAIxX,OAAOyX,MAAOtX,IAAK,QAAS,EAE1EuX,kBAAmB7F,IACjBA,EAAE3F,2BACF2F,EAAE5F,kBACF,GAAIgJ,IAAM,EAAG,CACX,M,CAEF,MAAMF,EAAQrW,KAAKkU,MAAM0C,WAAUC,IAAMA,EAAE1C,OAAS0C,EAAEzC,KAEtD,IAAKpU,KAAKkU,MAAMmC,IAAQlC,KAAM,CAC5BnU,KAAKuU,SAAS8B,IAAQlC,KAAKuC,iBAC3B,M,CAEF,IAAK1W,KAAKkU,MAAMmC,IAAQjC,GAAI,CAC1BpU,KAAKuU,SAAS8B,GAAOjC,GAAGsC,gB,IAI5BjF,EAAA,SACE1L,KAAK,OACLkT,KAAK,UACL5B,MAAOR,EAAE1C,KAAO0C,EAAE1C,KAAK1R,OAAO,gBAAkB,KAChDkP,MAAO,yBAAyB3R,KAAK+T,SAAW,UAAY8C,EAAEzC,GAAK,gBAAkB,iBACrFvK,MAAO,CAAEE,MAAO,YAItB0H,EAAA,MAAIE,MAAM,aACRF,EAAA,kBACEiH,qBAAoB,KACpBjB,IAAKC,IACH1X,KAAKuU,SAASgC,GAAGnC,GAAKsD,CAAE,EACzB,cACW,sBACZpB,KAAMO,EAAEzC,IAAI3R,OAAO,cACnBkW,cAAe,KACflE,QAASgE,EAAa,eACRG,OAAO5Y,KAAK+T,SAAW,UAAY8C,EAAEzC,IACnDyE,cAAeC,IACbA,EAAItL,2BACJsL,EAAIvL,kBACJvN,KAAKoW,iBAAiB,CAAEC,MAAOE,EAAGD,KAAMwC,EAAIxX,OAAOyX,MAAOtX,IAAK,MAAO,EAExEuX,kBAAmB7F,IACjBA,EAAE3F,2BACF2F,EAAE5F,kBACF,MAAM8I,EAAQrW,KAAKkU,MAAM0C,WAAUC,IAAMA,EAAE1C,OAAS0C,EAAEzC,KAEtD,IAAKpU,KAAKkU,MAAMmC,IAAQlC,KAAM,CAC5BnU,KAAKuU,SAAS8B,IAAQlC,MAAMuC,iBAC5B,M,CAEF,IAAK1W,KAAKkU,MAAMmC,IAAQjC,GAAI,CAC1BpU,KAAKuU,SAAS8B,GAAOjC,GAAGsC,gB,IAI5BjF,EAAA,SACE1L,KAAK,OACLkT,KAAK,UACL5B,MAAOR,EAAEzC,GAAKyC,EAAEzC,GAAG3R,OAAO,gBAAkB,KAC5CkP,MAAO,qDACL3R,KAAK+T,SAAW,UAAY8C,EAAEzC,GAAK,gBAAkB,4CAEvDvK,MAAO,CAAEE,MAAO,YAIrBwM,EAAI,GACH9E,EAAA,MAAIE,MAAM,QACRF,EAAA,aACE2G,QAAQ,OACRC,UAAU,QACVC,eAAgB,KACdtY,KAAKkU,MAAQlU,KAAKkU,MAAM3N,QAAO,CAAC4S,EAAGvB,IAAMA,IAAMrB,GAAE,KAKtD,OAMf9E,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,gBACVF,EAAA,aAAAhQ,IAAA,2CAAW2V,KAAMjS,EAAQC,QAAQgU,WAAYC,UAAU,YAAY1H,MAAO,YAAa2G,eAAgB,IAAMtY,KAAKqU,WAAW1P,KAAK,QAClI8M,EAAA,aAAAhQ,IAAA,2CAAWuS,UAAWhU,KAAKgU,UAAWoD,KAAMjS,EAAQC,QAAQ4Y,SAAUzE,SAAS,SAAS5H,MAAM,e,kBClfxG,MAAMsM,GAAgB,itFACtB,MAAAC,GAAeD,G,MCoBFE,GAAU,M,0LACbC,qBACAC,WACAC,aACAC,MACAnhB,SACAE,SACAG,UACA+gB,gBAECC,gBAA0B,GAC1Bxd,YAAuB,MACvBoa,aACArH,UAAuC,KAEvC0K,qBACAC,iBACiCC,iBAEjCC,cAAwC,GACzC9c,YAAsB,EACtB+c,SACAC,YAAc,IAAItU,KAClBuU,QACAC,oBAAsB,IAAIC,EAC1BC,WAAa,IAAItL,IACjBuL,iBAAoD,GACpDC,WAAa,IAAIxL,IAGzB,iBAAAvT,GACEN,KAAK+e,YAAYO,SAAS,EAAG,EAAG,EAAG,GACnCtf,KAAKmf,WAAanf,KAAKuf,cAAcvf,KAAKwf,kBAC1Cvc,EAAe8Y,KAAK0D,SAAQ5E,IAC1B7a,KAAKqf,WAAW7C,IAAI3B,EAAIA,IAAKA,EAAIyB,KAAK,IAExCtc,KAAK0f,0B,CAIP,wBAAAC,GACE3f,KAAKmf,WAAanf,KAAKuf,cAAcvf,KAAKwf,kBAC1Cxf,KAAK0f,0B,CAIP,+BAAAE,CAAgCve,GAC9BrB,KAAKye,gBAAkBpd,EAAMC,OAAOmd,e,CAItC,QAAAoB,CAASxe,GACP,IAAIyG,EAASzG,EAAMC,OAAOwG,OAC1B,IAAIgY,EAAW9f,KAAK+f,wBAAwBjY,GAC5C,IAAKgY,EAASE,SAAU,CACtBhgB,KAAKigB,eAAeH,GACpBpf,YAAW,KACTV,KAAKkgB,aAAapY,EAAO,GACxB,G,KACE,CACL9H,KAAKkgB,aAAapY,E,EAKtB,qBAAAqY,CAAsB9e,GAEpBrB,KAAKogB,gBAAgB/e,EAAMC,OAAO4E,MAClClG,KAAK9B,e,CAIP,WAAAmiB,GACE,IAAIC,EAAMtgB,KAAKwf,iBAAiB5I,WAAU2J,GAAMA,EAAG9Z,KAAO,mBAC1D,GAAI6Z,KAAS,EAAG,CACdtgB,KAAKwf,iBAAiBgB,OAAOF,EAAK,GAClC5d,QAAQC,IAAI,kBACZ3C,KAAK9B,e,EAID,YAAAgiB,CAAapY,GACnB9H,KAAK4e,iBAAiBja,KAAK,CACzBlD,IAAK,mBACL0G,GAAIL,EACJ2Y,SAAU,QAAU3Y,G,CAIhB,uBAAAiY,CAAwBjY,GAC9B,OAAO9H,KAAKse,aAAatW,UAAUuU,MAAKmE,GAC/B1gB,KAAK2gB,iBAAiBD,GAAcnE,MAAK/V,GAAQxG,KAAK4gB,UAAUpa,KAAUsB,K,CAI7E,eAAA+Y,CAAgBH,GACtB,OAAOA,EAAa/I,I,CAGd,aAAAmJ,CAAcJ,GACpB,OAAOA,EAAavY,E,CAGd,qBAAA4Y,CAAsBL,GAC5B,OAAO1gB,KAAK2gB,iBAAiBD,GAAcha,M,CAGrC,gBAAAia,CAAiBD,GACvB,OAAQA,GAAgBA,EAAazY,eAAkB,E,CAGjD,WAAA+Y,CAAYC,GAClB,OAAOA,EAAStJ,I,CAGV,SAAAiJ,CAAUK,GAChB,OAAOA,EAAS9Y,E,CAGV,WAAA+Y,CAAYC,EAAerZ,GACjC,OAAOqZ,EAAc5E,MAAK6E,GAAiBphB,KAAK4gB,UAAUQ,KAAmBtZ,G,CAGvE,cAAA0X,GACN,OAAOxf,KAAKse,aAAa+C,a,CAGnB,eAAAjB,CAAgBlT,GACtBlN,KAAK0e,qBAAqB/Z,KAAKuI,E,CAGzB,sBAAAoU,CAAuBxZ,EAAQyZ,GACrC,MAAO,QAAUzZ,EAAS,IAAMyZ,EAAYxC,W,CAMtC,qBAAAyC,CAAsB1C,GAC5Bpc,QAAQC,IAAImc,EAAShd,WACrB,OAAO9B,KAAKwf,iBAAiB5Y,MAAKrJ,IAChC,IAAK,CAAC,MAAO,MAAO,OAAOqD,SAASrD,EAAasD,aAAc,CAC7D,GACE,IAAI4J,KAAKqU,EAAShd,WAAW4I,WAAa,IAAID,KAAKlN,EAAauE,WAAW4I,WAC3E,IAAID,KAAKqU,EAAShd,WAAW4I,WAAa,IAAID,KAAKlN,EAAawF,SAAS2H,UACzE,CACA,OAAOnN,C,MAMP,WAAAkkB,CAAYf,GAClB,IAAIgB,EAAOC,OAAOD,KAAK1hB,KAAK6e,eAC5B,IAAI+C,EAAiBC,EAErB,GAAI7hB,KAAK6e,cAAc6C,EAAK,IAAI3C,YAAc/e,KAAK6e,cAAc6C,EAAK,IAAI3C,YAAa,CACrF6C,EAAY,IAAInX,KAAKzK,KAAK6e,cAAc6C,EAAK,IAAI3C,aACjD8C,EAAU,IAAIpX,KAAKzK,KAAK6e,cAAc6C,EAAK,IAAI3C,Y,KAC1C,CACL6C,EAAY,IAAInX,KAAKzK,KAAK6e,cAAc6C,EAAK,IAAI3C,aACjD8C,EAAU,IAAIpX,KAAKzK,KAAK6e,cAAc6C,EAAK,IAAI3C,Y,CAGjD,MAAM+C,EAAiBvT,KAAKO,MAAMP,KAAKI,KAAKkT,EAAQnX,UAAYkX,EAAUlX,WAAa,QACvF1K,KAAK8e,SAAW,CACdrY,GAAI,iBACJO,KAAMyK,EAAA,iBACNsQ,MAAO,GACPta,MAAO,GACPua,eAAgB,MAChBC,eAAgB,QAChBngB,UAAW8f,EAAUrV,cAAgB,IAAMvM,KAAKkiB,kBAAkBN,EAAUtV,WAAa,GAAK,IAAMtM,KAAKkiB,kBAAkBN,EAAUvV,WACrItJ,QAAS8e,EAAQtV,cAAgB,IAAMvM,KAAKkiB,kBAAkBL,EAAQvV,WAAa,GAAK,IAAMtM,KAAKkiB,kBAAkBL,EAAQxV,WAC7HhF,QAAS,GACTD,MAAO,GACP+a,oBAAqB,EACrBrf,MAAO9C,KAAK6e,cAAc6C,EAAK,IAAI5Z,OACnCsa,WAAY,GACZrb,WAAY+a,EACZO,aAAc,EACdC,QAAS,GACTzW,cAAe,GACf0W,KAAM,GACNrb,YAAa,GACbsb,UAAW,GACXC,aAAc,GACdC,MAAOvd,EAAQC,QAAQud,kBACvB3a,UAAW,CAAC0Y,GACZkC,SAAUlC,EAAa/I,KACvBvM,WAAY,cACZrK,OAAQ,aACR8hB,iBAAkB,CAChBze,SAAU,KACV0e,YAAa,GACbze,OAAQ,KACR0e,UAAW,GACXjB,iBACAkB,SAAU,MACVld,QAAS,oDAIb,IAAImd,EAAavC,EAAa/I,KAAO,IAAM3X,KAAKghB,YAAYhhB,KAAKkhB,YAAYlhB,KAAK2gB,iBAAiBD,GAAe1gB,KAAK6e,cAAc6C,EAAK,IAAI5Z,SAC9I9H,KAAK8e,SAASoE,kBAAoB,GAAG/d,EAAQC,QAAQ+d,qBAAqBF,IAC1EjjB,KAAK8e,SAAS4D,OAASO,EACvBjjB,KAAK8e,SAAS+D,iBAAiBxe,OAAS,IAAIoG,KAAKzK,KAAK8e,SAAS/b,QAAU,aACzE/C,KAAK8e,SAAS+D,iBAAiBze,SAAW,IAAIqG,KAAKzK,KAAK8e,SAAShd,UAAY,aAC7E9B,KAAK8e,SAAS+D,iBAAiBC,YAAc9iB,KAAKojB,WAAWpjB,KAAK8e,SAAS+D,iBAAiBze,UAC5FpE,KAAK8e,SAAS+D,iBAAiBE,UAAY/iB,KAAKojB,WAAWpjB,KAAK8e,SAAS+D,iBAAiBxe,QAC1FrE,KAAK8e,SAASsD,YAAa,IAAI3X,MAAO4Y,cACtCrjB,KAAK8e,SAASxT,WAAatL,KAAKse,aAAagF,oBAE7C,IAAIC,EAAqBvjB,KAAKwhB,sBAAsBxhB,KAAK8e,UACzD,GAAIyE,EAAoB,CACtBvjB,KAAK8e,SAASyE,mBAAqBA,C,CAGrCvjB,KAAKwf,iBAAiBlE,KAAKtb,KAAK8e,UAChC,OAAO9e,KAAK8e,Q,CAGN,iBAAAoD,CAAkBsB,GACxB,OAAOA,GAAO,EAAI,IAAMA,EAAMA,C,CAGxB,UAAAJ,CAAW9M,EAAMmN,EAAS,WAChC,OAAOnN,EAAKjK,UAAY,IAAMiK,EAAKoN,eAAeD,EAAQ,CAAEE,MAAO,UAAa,IAAMrN,EAAK/J,a,CAGrF,cAAAqX,GACN5jB,KAAKse,aAAa+C,cAAgBrhB,KAAKse,aAAa+C,cAAc9a,QAAOsd,GAAUA,EAAOpd,KAAO,mBACjGzG,KAAK8e,SAAW,I,CA2BV,SAAAgF,CAAUhc,EAAgByZ,EAAkBb,GAClD,IAAK1gB,KAAKoe,sBAAwBmD,EAAYxC,aAAe/e,KAAK+e,YAAYrU,UAAW,CACvF,IAAIqZ,EAAS/jB,KAAKshB,uBAAuBxZ,EAAQyZ,GACjD,GAAIvhB,KAAK6e,cAAcmF,eAAeD,GAAS,CAC7C/jB,KAAK4jB,wBACE5jB,KAAK6e,cAAckF,GAC1B/jB,KAAK9B,gBACL,M,MACK,GAAIyjB,OAAOD,KAAK1hB,KAAK6e,eAAenY,QAAU,GAAK1G,KAAK+B,YAAc+F,EAAQ,CACnF9H,KAAK4jB,iBACL5jB,KAAK6e,cAAgB,GACrB7e,KAAK6e,cAAckF,GAAU,IAAKxC,EAAazZ,UAC/C9H,KAAK+B,WAAa+F,EAClB9H,KAAK9B,e,KACA,CACL,MAAMwjB,EAAOC,OAAOD,KAAK1hB,KAAK6e,eAC9B,MAAM+C,EAAYrf,EAAOvC,KAAK6e,cAAc6C,EAAK,IAAIrK,MAAO,cAC5D,MAAMwK,EAAUtf,EAAOgf,EAAYlK,MAAO,cAC1C,IAAIpS,EAAS2c,EAAUpJ,QAAQhW,IAAI,EAAG,QACtC,IAAIyhB,EAAgB,EACpB,MAAOhf,EAAOV,SAASsd,EAAS,OAAQ,CACtC,MAAMqC,EAAUjf,EAAOxC,OAAO,cAC9B,GAAIzC,KAAKmkB,eAAerc,EAAQoc,GAAU,CACxCD,G,CAEFhf,EAAOzC,IAAI,EAAG,O,CAEhB,GAAIyhB,GAAiB,EAAG,CACtBjkB,KAAK6e,cAAgB,GACrB7e,KAAK+B,WAAa+F,EAClB9H,KAAK9B,gBACL,M,CAGF8B,KAAK6e,cAAckF,GAAU,IAAKxC,EAAazZ,UAC/C9H,KAAKyhB,YAAYf,GACjB1gB,KAAK6e,cAAgB,GACrB7e,KAAK9B,gBACL8B,KAAKokB,oBAAoBpkB,KAAK8e,S,GAI5B,mBAAAsF,CAAoBle,GAC1BxD,QAAQC,IAAIuD,E,CAIN,aAAAhI,GACN8B,KAAKiB,aAAejB,KAAKiB,W,CAEnB,aAAAse,CAAc8E,GACpB,MAAMlF,EAAa,IAAItL,IACvB,MAAM0K,EAAQhc,IAAS+hB,QAAQ,OAE/B,IAAK,MAAM/e,KAAW8e,EAAU,CAC9B,MAAMjgB,EAAW7B,EAAOgD,EAAQzD,UAAW,cAAcwiB,QAAQ,OACjE,MAAMjgB,EAAS9B,EAAOgD,EAAQxC,QAAS,cAAcuhB,QAAQ,OAG7D,GAAI/F,EAAMhU,cAAcnG,IAAama,EAAM9H,eAAepS,GAAS,CACjE,IAAK8a,EAAW/D,IAAI7V,EAAQzC,OAAQ,CAClCqc,EAAW3C,IAAIjX,EAAQzC,MAAOyC,EAAQE,e,KACjC,CACL,GAAI8e,EAAYhiB,IAAS8B,SAAUmgB,EAA4Btb,EAAcub,wBAAwBvV,OAAQhG,EAAcub,wBAAwBC,OAAQ,CACzJvF,EAAW3C,IAAIjX,EAAQzC,MAAOyC,EAAQE,e,IAM9C,OAAO0Z,C,CAED,4BAAAwF,CAA6BC,EAAkBC,EAAsB,MAAOxO,GAClF,OAAOpT,EAAe8Y,KAAKjG,KAAIgP,GAG3BrT,EAAA,OACEE,MAAO,kDAAkDiT,EAAW,IAAME,EAAQjK,OAChFiK,EAAQjK,MAAQ7a,KAAKue,OAASuG,EAAQjK,MAAQ7a,KAAKwe,gBAAkB,aAAe,MAGrFqG,EACCpT,EAACY,EAAQ,KACPZ,EAAA,QAAME,MAAO,gBACVmT,EAAQxI,KAAKjG,GAAOqG,kBAAkBC,MAKhC,K,CASb,wBAAAoI,CAAyBjd,EAAgB4Y,EAA4BsE,GAC3E,OAAOhlB,KAAKse,aAAavC,KAAKjG,KAAIgP,IAChC,MAAMX,EAAiBnkB,KAAKmkB,eAAethB,OAAOiF,GAASgd,EAAQzN,OACnE,MAAM4N,EAAW1iB,EAAOuiB,EAAQzN,MAAO,cAAc7U,KAAK,EAAG,QAAQC,OAAO,cAC5E,MAAMyiB,EAAcf,GAAkBxC,OAAOD,KAAK1hB,KAAK6e,eAAenY,SAAW,GAAOyd,GAAkBnkB,KAAKmkB,eAAethB,OAAOiF,GAASmd,GAC9I,MAAME,EAAanlB,KAAK6e,cAAcmF,eAAehkB,KAAKshB,uBAAuBxZ,EAAQgd,IACzF,MAAMM,EAAgBN,EAAQjK,MAAQ7a,KAAKue,OAASuG,EAAQjK,MAAQ7a,KAAKwe,gBACzE,MAAM6G,EAAgBpiB,EAAeqiB,cAAclK,KAAKtT,GAAU7E,EAAeqiB,cAAcniB,KAAK2E,GAAU,KAC9G,MAAMyd,EAAkB,CAAC,MAAO,OAAO3kB,SAASsI,EAAcsc,oBAAoBrV,MAAQ,MAAQkV,GAAejK,IAAI0J,EAAQzN,OAC7H,OACE5F,EAAA,OACEE,MAAO,uCAAuCwS,EAAiB,WAAa,MAAM,QAAUrc,EAAS,IAAMgd,EAAQjK,OAAOuK,EAAgB,aAAe,MACvJplB,KAAKye,kBAAoB3W,EAAS,IAAMgd,EAAQjK,IAAM,oBAAsB,MAC1EsK,EAAa,cAAgB,KACjCtb,OAAQqb,GAAc,CAAE,gBAAiB,WACzCO,QAAS,KACP,GAAIP,EAAY,CACd,M,CAEFllB,KAAK8jB,UAAUjhB,OAAOiF,GAASgd,EAASpE,EAAa,EACtD,aACWsE,EACZ3kB,KAAK,WAAU,eACDyH,EAAM,YACTgd,EAAQzN,MAAK,eACV+N,EAAgB,OAAS7b,UAAS,iBAChCyb,EAAQ,kBACPpM,OAAO2M,GAAgB,gBACzB3M,OAAOsM,GAAW,gBAClBQ,QAAQP,IAInB,G,CAKJ,cAAAlF,CAAeS,GACrBA,EAAaV,UAAYU,EAAaV,SACtChgB,KAAK9B,e,CAGC,kBAAAynB,CAAmBjF,EAA4BrK,GACrD,GAAIrW,KAAK+gB,sBAAsBL,IAAiB,IAAMA,EAAakF,UAAW,CAC5E,OAAO,I,CAET,OACEnU,EAAA,OAAKE,MAAM,WACTF,EAAA,OACEE,MAAO,sEAAsE,YAAc3R,KAAK8gB,cAAcJ,KAC9G+E,QAAS,IAAMzlB,KAAKigB,eAAeS,IAEnCjP,EAAA,OAAKE,MAAO,gBACVF,EAAA,wBAAsBoU,aAAc7lB,KAAK6gB,gBAAgBH,MAG1DA,EAAaV,SACZvO,EAAA,OAAKqU,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IAC/E0H,EAAA,QACEiJ,KAAK,UACL7D,EAAE,8KAINpF,EAAA,OAAKqU,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IAC/E0H,EAAA,QACEiJ,KAAK,UACL7D,EAAE,gLAMT7W,KAAK2kB,6BAA6B,YAAc3kB,KAAK8gB,cAAcJ,GAAe,KAAMrK,G,CAUvF,kBAAA2P,CAAmBtF,GAEzB,IAAKA,EAAaV,SAAU,CAC1B,OAAO,I,CAET,OAAOhgB,KAAK2gB,iBAAiBD,IAAe5K,KAAItP,IAC9C,IAAKA,EAAKof,UAAW,CACnB,OAAO,I,CAET,MAAMK,EAAkBjmB,KAAK+gB,sBAAsBL,IAAiB,EACpE,MAAM/I,EAAOsO,EAAkBjmB,KAAK6gB,gBAAgBH,GAAgB1gB,KAAKghB,YAAYxa,GACrF,OACEiL,EAAA,OAAKE,MAAM,WACTF,EAAA,OACEE,MAAO,wEAAwE3R,KAAK+gB,sBAAsBL,IAAiB,EAAI,OAAS,MACtI,QAAU1gB,KAAK4gB,UAAUpa,KACzB,iBACcmR,EAAI,kBACHiB,OAAO1P,EAAcgd,sBAAqB,YAChDlmB,KAAK4gB,UAAUpa,GAC1Bif,QAAS,KACP,IAAKvc,EAAcgd,qBAAsB,CACvC,M,CAEFlmB,KAAKqb,aAAe7U,EACpBxG,KAAKgf,QAAQmH,WAAW,EAE1BC,aAAc,KACZpmB,KAAKof,iBAAiB5Y,EAAK2B,KAAK0B,OAAOmQ,YAAY,yBAA0B,UAAU,EAEzFqM,aAAc,KACZrmB,KAAKof,iBAAiB5Y,EAAK2B,KAAK0B,OAAOyc,eAAe,yBAAyB,GAGjF7U,EAAA,wBACEgG,IAAKC,IACH,GAAIA,EAAI1X,KAAKof,iBAAiB5Y,EAAK2B,IAAMuP,CAAE,EAE7C7N,MAAOrD,EAAK+f,YAAc,OAAS,CAAE,cAAe,WACpDC,SAAUtd,EAAcgd,sBAAwB1f,EAAK+f,YAAc,MACnEV,aAAclO,GAEbnR,EAAK+f,YAAc,OAClB9U,EAAA,OAAKwH,KAAK,MAAMtH,MAAM,4BAA4B9H,MAAO,CAAEoN,IAAK,WAC7DzQ,EAAK+f,YAAc,MAClB9U,EAAA,OAAK5E,OAAQ,GAAI9C,MAAO,GAAI+b,MAAM,6BAA6BC,QAAQ,eACrEtU,EAAA,0BACAA,EAAA,QACEiJ,KAAK,QACL7D,EAAE,qRAINpF,EAAA,OAAKqU,MAAM,6BAA6BjZ,OAAO,KAAK9C,MAAM,OAAOgc,QAAQ,cAAclc,MAAO,CAAE4c,QAAS,UACtGjgB,EAAK+f,YAAc,OAAS9U,EAAA,mCAC7BA,EAAA,QACEiJ,KAAK,eACL7D,EAAE,ofAQf7W,KAAK+kB,yBAAyB/kB,KAAK4gB,UAAUpa,GAAOka,EAAc/I,GAC/D,G,CAKJ,WAAA+O,GACN,OAAO1mB,KAAKse,aAAatW,WAAW8N,KAAI,CAAC4K,EAAcrK,KACrD,GAAIqK,EAAakF,UAAW,CAC1B,OACEnU,EAACY,EAAQ,KACNrS,KAAK2lB,mBAAmBjF,EAAcrK,GACtCqK,EAAaV,UAAYhgB,KAAKgmB,mBAAmBtF,G,KAGjD,CACL,OAAO,I,KAIL,+BAAMiG,CAA0BxT,EAAgBzP,GACtDyP,EAAE3F,2BACF2F,EAAE5F,kBACF,IACEvN,KAAKgU,UAAYtQ,IAAW,MAAQ,QAAU,eACxC1D,KAAKif,oBAAoB2H,uBAAuB,CACpDjT,YAAa3T,KAAKqe,WAElB3a,OAAQ,CACNyM,KAAMzM,GAERmjB,KAAM,CACJ1e,GAAInI,KAAKqb,cAAclT,MAG3B,GAAI,CAAC,MAAO,OAAOvH,SAAS8C,GAAS,OAC7B1D,KAAKif,oBAAoB6H,gBAAgB,CAC7CC,QAAS,CACP,CACEtjB,YAAa,UACbujB,OAAQhnB,KAAKqb,cAAc4L,aAAa9e,IAAM,KAC9CwN,QAAS3V,KAAKqb,cAAclT,GAC5B+e,YAAalnB,KAAKmf,WAAWhc,IAAInD,KAAKqb,cAAclT,KAAO,KAC3DzE,OAAQA,K,UAMhB1D,KAAKgU,UAAY,KACjBhU,KAAKqb,aAAe,KACpBrb,KAAKgf,QAAQ3K,Y,EAGjB,MAAAvD,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,4CACHgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,iBACR3R,KAAK0mB,cACNjV,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,4CACR3R,KAAKwf,kBAAkB1J,KAAIvY,GAExBkU,EAAA,mCACe,WAAWlU,EAAakI,iBAAgB,iBACrClI,EAAayK,WAAWuU,MAAKrU,GAAKA,EAAEC,KAAO5K,EAAa4pB,aAAYlf,cAAcsU,MAAKrU,GAAKA,EAAEC,KAAO5K,EAAauF,SAAQ6U,KAC1Ira,SAAU0C,KAAK1C,SACfD,mBAAoB2C,KAAKse,aAAajhB,mBACtCI,UAAWuC,KAAKvC,UAChBL,SAAU4C,KAAK5C,SAAQ,oBACJG,EAAakJ,GAChClJ,aAAcA,EACdC,iBAAkBwC,KAAKwf,uBAMjC/N,EAAA,YAAAhQ,IAAA,2CACEgW,IAAKC,GAAO1X,KAAKgf,QAAUtH,EAC3B0P,YAAajiB,GAASC,SAASgU,WAC/BiO,cAAernB,KAAKsnB,8BACpBC,gBAAe,KACfC,aAAcxnB,KAAKynB,6BACnBC,UAAW1nB,KAAK2nB,kBAChBC,eAAgBzU,GAAKnT,KAAK2mB,0BAA0BxT,EAAG,OACvD0U,cAAe1U,GAAKnT,KAAK2mB,0BAA0BxT,EAAGnT,KAAKqb,cAAckL,YAAc,MAAQ,MAAQ,OACvGuB,UAAW,MACXC,sBAAuB/nB,KAAKgU,YAAc,SAC1CA,UAAWhU,KAAKgU,YAAc,QAC9BgU,cAAe7U,IACbA,EAAE3F,2BACF2F,EAAE5F,kBACFvN,KAAKqb,aAAe,KACpBrb,KAAKgf,QAAQ3K,YAAY,I,CAO3B,eAAAsT,GACN,IAAK3nB,KAAKqb,aAAc,CACtB,OAAO,I,CAET,OACE5J,EAAA,wBAAgBzR,KAAKqb,cAAc1D,KAAI,U,CAYnC,2BAAA2P,GACN,IAAKtnB,KAAKqb,aAAc,CACtB,OAAO,I,CAET,OAAOrb,KAAKqb,aAAakL,YAAc,MAAQ,QAAU,O,CAEnD,0BAAAkB,GACN,IAAKznB,KAAKqb,aAAc,CACtB,OAAO,I,CAET,OAAOrb,KAAKqb,aAAakL,YAAc,MAAQ,oBAAsB,O,CAG/D,wBAAA7G,GACNzc,EAAeC,eAAe+kB,QAC9BjoB,KAAKse,aAAatW,WAAWyX,SAAQ,CAACiB,EAAcwH,KAClD,GAAIxH,EAAakF,UAAW,CAC1B5lB,KAAK2gB,iBAAiBD,IAAejB,SAAQjZ,IAC3C,GAAIA,EAAKof,UAAW,CAClB5lB,KAAKse,aAAavC,KAAK0D,SAAQqF,IAC7B,MAAMqD,EAAUnoB,KAAKooB,WAAW5hB,EAAK2B,GAAI2c,EAAQzN,OACjDpU,EAAeC,eAAesZ,IAAI2L,EAAS,CACzC/kB,UAAW0hB,EAAQxI,KAAK4L,GAAeG,qBACvCzjB,OAAQ,aACR,G,SAQN,UAAAwjB,CAAWtgB,EAAgB+S,GACjC,MAAO,GAAG/S,KAAU+S,G,CAGd,cAAAsJ,CAAerc,EAAgB+S,GACrC,MAAMpZ,EAAMzB,KAAKooB,WAAWtgB,EAAQ+S,GACpC,IAAK5X,EAAeC,eAAekY,IAAI3Z,GAAM,CAC3C,OAAO,K,CAET,MAAM2B,SAAEA,GAAaH,EAAeC,eAAeC,IAAI1B,GACvD,OAAO2B,C,uFC9qBX,MAAMklB,GAAkB,gtCACxB,MAAAC,GAAeD,G,MCSFE,GAAY,M,kEACdC,YACDnK,aACAoK,aAAwB,MACxBnK,MACAC,gBAEAmK,OAASpmB,IAASE,OAAO,cAIjC,iBAAAmmB,CAAkBnnB,EAAKyE,EAAO,IAC5BlG,KAAKyoB,YAAY9jB,KAAK,CAAElD,MAAKyE,Q,CAG/B,MAAA4K,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,2CAACkQ,MAAM,mBACVF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,iEAAiE9H,MAAO,CAAEgf,YAAa,SAChGpX,EAAA,UAAAhQ,IAAA,2CAAQkQ,MAAM,0DAA0D9H,MAAO,CAAEoN,IAAK,WAAawO,QAAS,IAAMzlB,KAAK4oB,kBAAkB,eACtI5oB,KAAK0oB,aACJjX,EAAA,OAAKqU,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IAC/E0H,EAAA,QACEiJ,KAAK,eACL7D,EAAE,keAINpF,EAAA,OAAKqU,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IAC/E0H,EAAA,QACEiJ,KAAK,eACL7D,EAAE,oeAIRpF,EAAA,QAAAhQ,IAAA,4CAAO0D,EAAQC,QAAQ0jB,YACvBrX,EAAA,QAAAhQ,IAAA,qDACAgQ,EAAA,gBAAAhQ,IAAA,2CAAcoI,MAAO,CAAEkf,WAAY,eAOtC/oB,KAAKse,aAAavC,KAAKjG,KAAIgP,GAC1BrT,EAAA,OAAKE,MAAM,iCACTF,EAAA,OACEE,MAAO,CACL,0CAA2C,KAC3CqX,QAAWC,EAAUnE,EAAQzN,OAC7B6R,WAAcpE,EAAQzN,QAAUrX,KAAK2oB,QAAU3oB,KAAKwe,kBAAoBsG,EAAQjK,MAGjFiK,EAAQqE,mB,eC/DvB,MAAMC,GAAkB,m1FACxB,MAAAC,GAAeD,G,MCYFE,GAAY,M,0KACdb,YACiCc,cAGAC,qBAGlClL,aACAC,MACAkL,WACAC,gBACAtnB,QACAoc,gBACCvd,YAAuB,MACvB0oB,sBAA6B,GAG9BC,UAAsC,GACtCC,oBAAsB,IAAIC,EAClCC,QACA,iBAAAzpB,GACE,IACEN,KAAKgqB,sBAEL,IAAKhqB,KAAKse,aAAajhB,mBAAoB,CACzC4sB,EAA4B,oBAAoBC,IAC9C,GAAIvI,OAAOD,KAAKwI,GAAUxjB,OAAS,EAAG,CACpC1G,KAAKmqB,+B,MAIX,MAAOtkB,GACPnD,QAAQmD,MAAM,8BAA+BA,E,EAIjD,yBAAAukB,GACEpqB,KAAKmqB,+B,CAEC,mBAAAH,GACNhqB,KAAK4pB,UAAY,GACjB5pB,KAAKse,aAAatW,UAAUyX,SAAQK,IAClC9f,KAAK4pB,UAAY5pB,KAAK4pB,UAAUS,UAAUvK,EAAS7X,cAAc,G,CAI7D,mCAAMkiB,SACNnqB,KAAKsqB,mB,CAGL,uBAAMA,GACZ,IACE,MAAMlmB,SAAEA,EAAQC,OAAEA,EAAM6B,KAAEA,GAASlG,KAAK0pB,gBACxC,IAAIa,EAAK,IAAI9f,KAAKrG,GAClBmmB,EAAGjL,SAAS,EAAG,EAAG,EAAG,GACrB,IAAIuC,EAAU0I,EAAG7f,UACjB,MAAOmX,GAAW,IAAIpX,KAAKpG,GAAQqG,UAAW,CAC5C,MAAM8f,EAAejoB,EAAOsf,GAASpf,OAAO,YAC5C,GAAIyD,EAAK2b,GAAU,CACjB,MAAM5E,QAAejd,KAAK6pB,oBAAoBY,mBAC5C,CAAEpoB,UAAWrC,KAAKse,aAAajc,UAAWD,QAASpC,KAAKse,aAAalc,SACrEpC,KAAKypB,WACLiB,EAAsB,IAAIjgB,KAAKoX,IAC/B7hB,KAAKse,aAAatW,UAClBhI,KAAKse,aAAagF,qBAEpBtjB,KAAK2pB,sBAAsBa,GAAgBvN,EAAOvW,M,MAC7C,GAAI1G,KAAK2pB,sBAAsBa,GAAe,CACnD,MAAMG,EAAM3qB,KAAK2pB,sBAAsBa,GAAgB,EACvDxqB,KAAK2pB,sBAAsBa,GAAgBG,EAAM,EAAI,EAAIA,C,CAE3D,MAAMC,EAAaroB,EAAOsf,GAASrf,IAAI,EAAG,QAAQ6B,SAClDumB,EAAWtL,SAAS,EAAG,EAAG,EAAG,GAC7BuC,EAAU+I,EAAWlgB,UACrB1K,KAAK6qB,Y,EAEP,MAAOhlB,GACPnD,QAAQmD,MAAMA,E,EAKlB,8BAAAilB,CAA+BzpB,GAC7BA,EAAMmM,2BACNnM,EAAMkM,kBACN,MAAMnJ,SAAEA,EAAQC,OAAEA,GAAWhD,EAAMC,OACnC,IAAIugB,EAAU,IAAIpX,KAAKrG,GAAUsG,UACjC,MAAOmX,EAAU,IAAIpX,KAAKpG,GAAQqG,UAAW,CAC3C,MAAM8f,EAAejoB,EAAOsf,GAASpf,OAAO,YAC5CzC,KAAK2pB,sBAAsBa,GAAgBxqB,KAAK2pB,sBAAsBa,GAAgB,EACtF3I,EAAUtf,EAAOsf,GAASrf,IAAI,EAAG,QAAQ6B,SAASqG,S,CAEpD1K,KAAK6qB,Y,CAGP,gBAAAE,CAAiBjG,GACf,GAAI9kB,KAAK2pB,sBAAsB7E,EAAQjK,MAAQ,EAAG,CAChD7a,KAAK4oB,kBAAkB,gBACvBloB,YAAW,KACTV,KAAKwpB,qBAAqB7kB,KAAK,CAC7BlD,IAAK,uBACLyE,KAAM4e,EAAQ/F,aACd,GACD,I,EAMP,iBAAA6J,CAAkBnnB,EAAKyE,EAAY,IACjClG,KAAKyoB,YAAY9jB,KAAK,CAAElD,MAAKyE,Q,CAG/B,gBAAA8kB,CAAiB3pB,GACf,GAAIsgB,OAAOD,KAAKrgB,EAAMC,QAAQoF,OAAS,EAAG,CACxC1G,KAAK4oB,kBAAkB,WAAYvnB,EAAMC,O,EAI7C,iBAAA2pB,GAGEjrB,KAAK6qB,Y,CAGP,iBAAAK,CAAkB7pB,GAChB,MAAM8pB,EAAe9pB,EAAM+pB,OAC3B,IAAI/T,EAAQ8T,EAAa9T,MAAMgU,OAE/BhU,EAAQA,EAAMiU,cACd,GAAIjU,IAAU,GAAI,CAChBrX,KAAKirB,mB,CAIPjrB,KAAK6qB,Y,CAGP,kBAAAU,CAAmBzjB,GACjB9H,KAAKirB,oBACLjrB,KAAKupB,cAAc5kB,KAAK,CAAElD,IAAK,WAAYqG,U,CAG7C,mBAAA0jB,CAAoBjB,GAClB,OAAOA,EAAGhe,cAAgB,KAAOge,EAAGje,WAAa,EAAI,IAAM,KAAOie,EAAGje,WAAa,GAAK,KAAOie,EAAGle,WAAa,EAAI,IAAM,IAAMke,EAAGle,S,CAGnI,kBAAAof,GACE,IAAIlN,EAAQ,IAAI9T,KAChB8T,EAAMe,SAAS,EAAG,EAAG,EAAG,GACxB,IAAIjd,EAAYrC,KAAKwrB,oBAAoBjN,GACzCA,EAAMmN,QAAQnN,EAAMlS,UAAY,GAChCkS,EAAMe,SAAS,EAAG,EAAG,EAAG,GACxB,IAAIld,EAAUpC,KAAKwrB,oBAAoBjN,GACvC,MAAO,CACL9X,GAAI,GACJO,KAAM,GACN+a,MAAO,GACPta,MAAO,GACPwa,eAAgB,QAChBngB,UAAWO,EACXU,QAASX,EACT4F,UAAWhI,KAAKse,aAAatW,UAC7B0a,MAAOvd,EAAQC,QAAQumB,eACvBvgB,WAAY,eACZE,WAAYtL,KAAKse,aAAagF,oBAC9BT,iBAAkB,CAChBze,SAAU,IAAIqG,KAAKpI,GACnBygB,YAAa,GACbze,OAAQ,IAAIoG,KAAKrI,GACjB2gB,UAAW,GACXjB,eAAgB,EAChB8J,UAAW,KACX9lB,QAAS,I,CAKf,UAAA+kB,GACE7qB,KAAKiB,aAAejB,KAAKiB,W,CAG3B,MAAA6P,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,4CACHgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,+DACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,sBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,0CAoCP3R,KAAKse,aAAajhB,oBAClBoU,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACRC,UAAU,SACVxO,MAAO,IAAKgiB,EAAcC,UAAW,cAAe,UAAU,cAClD,UAAS,iBACN,SACfjnB,MAAOM,EAAQC,QAAQ2mB,2BACvBzT,eAAgB,IAAMtY,KAAK4oB,kBAAkB,gBAC7CoD,WAAW,cACXC,yBAAwB,OAG5Bxa,EAAA,kBAAAhQ,IAAA,2CACEgT,QAASlS,IAASC,KAAK,EAAG,UAAU8hB,QAAQ,SAAS7hB,OAAO,cAG5DoW,cAAeC,IACbpW,QAAQC,IAAI,MAAOmW,GACnB9Y,KAAKgrB,iBAAiBlS,EAAI,EAG5BnH,MAAO,WACP9M,MAAOM,EAAQC,QAAQ8mB,aAAY,cACvB,UAAS,iBACN,UAEfza,EAAA,aAAAhQ,IAAA,2CACEwX,KAAK,UACL+S,WAAW,cACX5T,QAAQ,OACRC,UAAU,WACVxO,MAAO,IAAKgiB,EAAcC,UAAW,cAAe,UACpDxT,eAAgB,IAAMtY,KAAK4oB,kBAAkB,YAC7CqD,yBAAwB,KACxBxU,IAAKC,GAAO1X,KAAK+pB,QAAUrS,KAI/BjG,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACR4T,WAAW,cACXra,MAAO,UACP0G,UAAU,QACV4T,yBAAwB,KACxBpiB,MAAO,IAAKgiB,EAAcC,UAAW,cAAe,UAAU,cAClD,UAAS,iBACN,SACfjnB,MAAOM,EAAQC,QAAQ+mB,UACvB7T,eAAgB,IAAMtY,KAAK4oB,kBAAkB,eAE/CnX,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACR4T,WAAW,cACX3T,UAAU,OAAM,cACJ,UAAS,iBACN,SAAQ,cACX,kBACZxT,MAAOM,EAAQC,QAAQgnB,qBACvBH,yBAAwB,KACxBpiB,MAAO,IAAKgiB,EAAcC,UAAW,cAAe,UACpDxT,eAAgB,IAAMtY,KAAK4oB,kBAAkB,MAAO5oB,KAAKyrB,wBAE3Dha,EAAA,aAAAhQ,IAAA,2CACE2W,QAAQ,OACR4T,WAAW,cACX3T,UAAU,iBAAgB,cACd,UAAS,iBACN,SAAQ,cACX,eACZxT,MAAOM,EAAQC,QAAQinB,iBACvBJ,yBAAwB,KACxBpiB,MAAO,IAAKgiB,EAAcC,UAAW,cAAe,UACpDxT,eAAgB,IAAMtY,KAAK4oB,kBAAkB,OAAQ5oB,KAAKyrB,yBA+B9Dha,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBACTF,EAAA,aAAAhQ,IAAA,2CACEob,KAAK,QAAO,oBACO1J,IACjBnT,KAAKurB,mBAAmB1oB,OAAOsQ,EAAE7R,OAAOgrB,KAAKjV,OAAO,GAGrDrX,KAAK4pB,UAAU9T,KAAItP,GAClBiL,EAAA,kBAAgBwG,MAAOzR,EAAKmR,KAAMN,MAAO7Q,EAAK2B,IAC3C3B,EAAKmR,YAOlBlG,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,+BACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,mBACR3R,KAAKse,aAAaiO,WAAWzW,KAAI0W,GAChC/a,EAAA,OAAKE,MAAM,YAAY9H,MAAO,CAAEE,MAAOyiB,EAAUC,UAAY,GAAK,OAChEhb,EAAA,OAAKE,MAAM,cAAc6a,EAAUE,eAIxC1sB,KAAKse,aAAavC,KAAKjG,KAAIgP,GAExBrT,EAAA,OACEE,MAAO,iCAAiC,OAASmT,EAAQjK,OAAOiK,EAAQjK,MAAQ7a,KAAKue,OAASuG,EAAQjK,MAAQ7a,KAAKwe,gBAAkB,aAAe,KAAI,WAC9IsG,EAAQjK,MAEhB7a,KAAKse,aAAajhB,oBAClBoU,EAAA,OAAKE,MAAM,qBACTF,EAAA,QACEE,MAAO,eAAe3R,KAAK2pB,sBAAsB7E,EAAQjK,MAAQiK,EAAQ6H,uBAAyB,EAAI,eAAiB,qBACvHlH,QAAS,IAAMzlB,KAAK+qB,iBAAiBjG,IAEpC9kB,KAAK2pB,sBAAsB7E,EAAQjK,MAAQiK,EAAQ6H,uBAK1Dlb,EAAA,OAAKE,MAAO,CAAEib,SAAU,KAAM5D,QAASC,EAAUnE,EAAQzN,SAAWyN,EAAQqE,gBAC5E1X,EAAA,OAAKE,MAAM,sBAAsBmT,EAAQ+H,UAAS,S,2FC/XlE,MAAMC,GAAgB,syLACtB,MAAAC,GAAeD,G,MCYFE,GAAU,M,kEACZvE,YACDnd,WACA2hB,gBAAkB,IAAIC,EAErBC,cAAgC,GAChCC,UAAuB,OACvBC,UACAC,aAAyB,GAE1BC,YAER,oBAAArsB,GACE,GAAIlB,KAAKutB,YAAa,CACpBC,aAAaxtB,KAAKutB,Y,EAKtB,qBAAAE,CAAsBvD,GACpB,GAAIA,IAAa,SAAWA,IAAa,OAAQ,CAC/ClqB,KAAKstB,aAAe,E,EAIxB,iBAAA1E,CAAkBnnB,EAAKyE,EAAO,IAC5BlG,KAAKyoB,YAAY9jB,KAAK,CAAElD,MAAKyE,Q,CAGvB,iBAAAwnB,CAAkBC,GACxB,MAAMC,EAAgB1kB,EAAcC,SAASgI,gBAAkB,GAC/DjI,EAAcC,SAASgI,eAAiB,IACnCyc,EACHC,eAAgBF,EAAO7X,KAAIrK,IAAK,IAAUA,M,CAI9C,cAAY4S,GACV,OAAOnV,EAAcC,UAAUhB,IAAMe,EAAcC,SAAShB,IAAM,I,CAG5D,kBAAA2lB,CAAmBzX,EAAe0X,GACxC,MAAMZ,EAAgBjkB,EAAcC,SAASgI,gBAAgB0c,eAAe/X,KAAI,CAACrK,EAAOuiB,IAASA,IAAQ3X,EAAQ,IAAK5K,KAAUsiB,GAAUtiB,IAC1IzL,KAAK0tB,kBAAkBP,GACvB,GAAIntB,KAAKotB,YAAc,QAAS,CAC9BptB,KAAKotB,UAAY,M,EAIb,0BAAMa,GACZ,MAAM5P,EAAare,KAAKqe,WACxB,IAAKA,EAAY,CACf,M,CAGF,GAAIre,KAAKotB,YAAc,SAAU,CAC/B,M,CAEFptB,KAAKotB,UAAY,SACjBptB,KAAKqtB,UAAY9jB,UAEjB,UACQvJ,KAAKitB,gBAAgBiB,yBAAyB,CAClDva,YAAa0K,EACbhH,MAAO8W,KAAKC,UAAUllB,EAAcC,SAASgI,kBAE/CnR,KAAKotB,UAAY,QACjB,GAAIptB,KAAKutB,YAAa,CACpBC,aAAaxtB,KAAKutB,Y,CAEpBvtB,KAAKutB,YAAc7d,OAAOhP,YAAW,KACnCV,KAAKotB,UAAY,OACjBptB,KAAKutB,YAAchkB,SAAS,GAC3B,I,CACH,MAAO1D,GACP7F,KAAKotB,UAAY,QACjBptB,KAAKqtB,UAAYxnB,aAAiBc,MAAQd,EAAMC,QAAU8S,OAAO/S,E,EAI7D,eAAAwoB,CAAgBhY,EAAegB,GACrCrX,KAAK8tB,mBAAmBzX,EAAO,CAAEsB,KAAMN,G,CAGjC,UAAAiX,CAAWjY,GACjBrW,KAAKiuB,uBACL,IAAKjuB,KAAKstB,aAAa1sB,SAASyV,GAAQ,CACtCrW,KAAKstB,aAAe,IAAIttB,KAAKstB,aAAcjX,E,EAIvC,oBAAAkY,CAAqBlY,GAC3BrW,KAAKstB,aAAettB,KAAKstB,aAAa/mB,QAAOioB,GAAgBA,IAAiBnY,G,CAGhF,MAAAvF,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,2CAACkQ,MAAM,uCACVF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,UACVF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,UACVF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,sBACTF,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,gBAAgBxM,EAAQC,QAAQ0jB,YACzCrX,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,iBAAiB8T,QAAS,IAAMzlB,KAAK4oB,kBAAkB,kBAEhEnX,EAAA,OAAAhQ,IAAA,2CAAKqkB,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IAC/E0H,EAAA,QAAAhQ,IAAA,2CACEiZ,KAAK,UACL7D,EAAE,oVAIRpF,EAAA,MAAAhQ,IAAA,8CAEFgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,aACTF,EAAA,SAAAhQ,IAAA,4CACG,MACC,MAAMgtB,EAAazuB,KAAKsL,WAAWiR,MAAKmS,GAAKA,EAAEvmB,KAAO,OACtD,OACEsJ,EAAA,UACEA,EAAA,UACEA,EAAA,OAAKE,MAAO,UAAU8c,EAAWE,SAAU9kB,MAAO,CAAE,uBAAwB4kB,EAAWhjB,UAEzFgG,EAAA,UACEA,EAAA,OAAKE,MAAO,4BAA6B9H,MAAO,CAAEoN,IAAK,WACrDxF,EAAA,QAAME,MAAM,gBAAgB8c,EAAW9W,MACvClG,EAAA,uBAKT,EAfA,GAiBAzR,KAAKsL,WAAWwK,KAAI2Y,IACnB,GAAI,CAAC,IAAK,IAAK,IAAK,MAAM7tB,SAAS6tB,EAAWtmB,IAAK,CACjD,OAAO,I,CAET,MAAMymB,EAAc1lB,EAAcqI,kBAAkBkd,GAAYhjB,OAChE,OACEgG,EAAA,MAAIhQ,IAAK,UAAUgtB,EAAWtmB,KAAMwJ,MAAM,cACxCF,EAAA,UACGgd,EAAWE,SAAW,QACrBld,EAAA,OAAKqU,MAAM,6BAA6BjZ,OAAO,KAAK9C,MAAM,OAAOgc,QAAQ,cAAclc,MAAO,CAAE4c,QAAS,UACvGhV,EAAA,QACEiJ,KAAK,QACL7D,EAAE,ifAGJ4X,EAAWE,SAAW,QACxBld,EAAA,OAAK5E,OAAQ,GAAI9C,MAAO,GAAI+b,MAAM,6BAA6BC,QAAQ,eACrEtU,EAAA,QACEiJ,KAAK,QACL7D,EAAE,qRAINpF,EAAA,OACEE,MAAO,UAAU8c,EAAWE,UAC1B,CAAC,IAAK,KAAK/tB,SAAS6tB,EAAWtmB,GAAGsB,YAAc,WAAWglB,EAAWtmB,GAAGsB,aAAe,IAAM,WAAa,KAAO,KAEpHI,MAAO,CAAE,uBAAwB4kB,EAAWhjB,MAAO,6BAA8BmjB,GAAatd,OAAQJ,gBAAmBud,EAAWhjB,UAI1IgG,EAAA,UACEA,EAAA,OAAKE,MAAO,4BAA6B9H,MAAO,CAAEoN,IAAK,WACrDxF,EAAA,QAAME,MAAM,gBAAgB8c,EAAW9W,QAGxC,IAGTlG,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIotB,QAAS,GACXpd,EAAA,MAAAhQ,IAAA,2CAAIoI,MAAO,CAAEilB,UAAW,SAAUC,aAAc,cAGpDtd,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIotB,QAAS,EAAGld,MAAM,GAAG9H,MAAO,CAAEmlB,cAAe,WAC/Cvd,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,4BAA4B9H,MAAO,CAAEoN,IAAK,WACnDxF,EAAA,QAAAhQ,IAAA,iEAILzB,KAAKsL,WAAWwK,KAAI2Y,IACnB,IAAK,CAAC,IAAK,IAAK,KAAK7tB,SAAS6tB,EAAWtmB,IAAK,CAC5C,OAAO,I,CAET,MAAMymB,EAAc1lB,EAAcqI,kBAAkBkd,GAAYhjB,OAChE,OACEgG,EAAA,MAAIhQ,IAAK,UAAUgtB,EAAWtmB,KAAMwJ,MAAM,cACxCF,EAAA,UACGgd,EAAWE,SAAW,QACrBld,EAAA,OAAKqU,MAAM,6BAA6BjZ,OAAO,KAAK9C,MAAM,OAAOgc,QAAQ,cAAclc,MAAO,CAAE4c,QAAS,UACvGhV,EAAA,QACEiJ,KAAK,QACL7D,EAAE,ifAGJ4X,EAAWE,SAAW,QACxBld,EAAA,OAAK5E,OAAQ,GAAI9C,MAAO,GAAI+b,MAAM,6BAA6BC,QAAQ,eACrEtU,EAAA,QACEiJ,KAAK,QACL7D,EAAE,qRAINpF,EAAA,OACEE,MAAO,UAAU8c,EAAWE,UAC1B,CAAC,IAAK,KAAK/tB,SAAS6tB,EAAWtmB,GAAGsB,YAAc,WAAWglB,EAAWtmB,GAAGsB,aAAe,IAAM,WAAa,KAAO,KAEpHI,MAAO,CAAE,uBAAwB4kB,EAAWhjB,MAAO,6BAA8BmjB,GAAatd,OAAQJ,gBAAmBud,EAAWhjB,UAI1IgG,EAAA,UACEA,EAAA,OAAKE,MAAO,4BAA6B9H,MAAO,CAAEoN,IAAK,WACrDxF,EAAA,QAAME,MAAM,gBAAgB8c,EAAW9W,MACtC8W,EAAWtmB,KAAO,MAAQsJ,EAAA,uBAG5B,IAGTA,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIotB,QAAS,GACXpd,EAAA,MAAAhQ,IAAA,2CAAIoI,MAAO,CAAEilB,UAAW,SAAUC,aAAc,cAGpDtd,EAAA,MAAAhQ,IAAA,4CACEgQ,EAAA,MAAAhQ,IAAA,2CAAIotB,QAAS,EAAGhlB,MAAO,CAAEmlB,cAAe,WACtCvd,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,4BAA4B9H,MAAO,CAAEoN,IAAK,WACnDxF,EAAA,QAAAhQ,IAAA,mEACAgQ,EAAA,gBAAAhQ,IAAA,gDAILyH,EAAcC,SAASgI,gBAAgB0c,eAAe/X,KAAI,CAAC2Y,EAAYpY,KACtE,MAAM4Y,EAAe,UAAUR,EAAWE,SAC1C,OACEld,EAAA,MAAIhQ,IAAK,UAAU4U,IAAS1E,MAAM,cAChCF,EAAA,UACEA,EAAA,OAAKE,MAAOsd,EAAcplB,MAAO,CAAEqH,gBAAiBud,EAAWhjB,UAEjEgG,EAAA,MAAIE,MAAM,qBACRF,EAAA,OAAKE,MAAM,4BAA4B9H,MAAO,CAAEoN,IAAK,WACnDxF,EAAA,iBACEE,MAAM,kCACN0F,MAAOoX,EAAW9W,KAClBuX,oBAAqB,CAAEC,OAAQ,KAC/BC,YAAY,wBACZC,aAAchuB,GAASrB,KAAKquB,gBAAgBhY,EAAOhV,EAAMC,QACzDguB,YAAa,IAAMtvB,KAAKsuB,WAAWjY,KAEpCrW,KAAKstB,aAAa1sB,SAASyV,KAAWrW,KAAKotB,YAAc,UAAYptB,KAAKotB,YAAc,SACvF3b,EAAA,qBAAmB8d,iBAAkB,IAAMvvB,KAAKuuB,qBAAqBlY,KACnE,OAGL,MAKb5E,EAAA,MAAAhQ,IAAA,2CAAIoI,MAAO,CAAEilB,UAAW,OAAQC,aAAc,YAC9Ctd,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,QACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,gCACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,6BACTF,EAAA,UAAAhQ,IAAA,yDAEFgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBAAkBxM,EAAQC,QAAQoqB,mBAE/C/d,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,aACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,gDACTF,EAAA,QAAAhQ,IAAA,2CAAMkQ,MAAM,gCAA8B,MAE5CF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBACTF,EAAA,OAAAhQ,IAAA,4CAAM0D,EAAQC,QAAQqqB,uBAG1Bhe,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,aACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,2BAAyB,UACpCF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBAAkBxM,EAAQC,QAAQsqB,WAE/Cje,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,aACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,2CAAyC,OACpDF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBAAkBxM,EAAQC,QAAQuqB,gBAE/Cle,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,aACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,6DAA2D,MACtEF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,kBAAkBxM,EAAQC,QAAQwqB,4B,iFC/S/D,MAAMC,GAA2B,0RACjC,MAAAC,GAAeD,G,MCUFE,GAAqB,M,4LAGxB7pB,KAEC8pB,iBACAC,kBAAoB,MAEpBC,YACAC,cACAC,gBAEDC,SACAC,iBACA3xB,cAAgB,IAAIC,EAG5B,gBAAA2xB,CAAiBC,GACfxwB,KAAKywB,WAAWD,GAChB,GAAIA,EAAS,CACXxwB,KAAKqwB,UAAUlK,W,KACV,CACLnmB,KAAKqwB,UAAUhc,Y,EAIX,oBAAMqc,GACZ,IAAK1wB,KAAKkG,KAAM,CACd,M,CAGF,IAAKlG,KAAK2wB,4BAA6B,CACrC,M,CAGF,MAAMxuB,KAAEA,EAAIN,SAAEA,EAAQQ,UAAEA,EAASD,QAAEA,GAAYpC,KAAKkG,KACpD,UACQlG,KAAKrB,cAAc4E,gBAAgBpB,EAAMN,EAAUQ,EAAWD,EAASpC,KAAKkG,KAAKpB,UAAYjC,OAAO7C,KAAKgwB,kBAAoBzmB,U,CACnI,MAAO1D,GACPnD,QAAQC,IAAIkD,GACZ7F,KAAKmwB,cAAcxrB,KAAKxC,E,SAExBnC,KAAKqwB,UAAUhc,aACfrU,KAAKowB,gBAAgBzrB,M,EAIzB,mBAAYisB,GACV,IAAKvnB,MAAMC,QAAQtJ,KAAKkG,MAAMpB,WAAY,CACxC,MAAO,E,CAGT,OAAO9E,KAAKkG,KAAKpB,UAAUgR,KAAI+a,IAAM,IAChCA,EACHzZ,KAAMpX,KAAK8wB,oBAAoBD,M,CAI3B,mBAAAC,CAAoBD,GAC1B,IAAKA,EAAQ,CACX,MAAO,E,CAGT,MAAME,EAASF,EAAOG,YAAc,MAAMH,EAAOG,cAAgB,GACjE,MAAO,GAAGH,EAAOzZ,OAAO2Z,IAAS1F,M,CAG3B,sBAAA4F,GACN,OAAOjxB,KAAK4wB,gBAAgBlqB,OAAS,C,CAG/B,yBAAAiqB,GACN,IAAK3wB,KAAKixB,yBAA0B,CAClC,OAAO,I,CAGT,IAAKjxB,KAAKgwB,iBAAkB,CAC1BhwB,KAAKiwB,kBAAoB,KACzBjwB,KAAKkxB,sBACL,OAAO,K,CAGT,OAAO,I,CAGD,mBAAAA,GACN,MAAMC,EAAWnxB,KAAKswB,kBAAkBc,YAAY1kB,cAAc,WAAa1M,KAAKswB,kBAAkB5jB,cAAc,UACpH,GAAIykB,EAAU,CACZA,EAASE,O,EAIL,UAAAZ,CAAWvqB,GACjB,IAAKA,EAAM,CACTlG,KAAKgwB,iBAAmBzmB,UACxBvJ,KAAKiwB,kBAAoB,MACzB,M,CAGFjwB,KAAKgwB,iBAAmBzmB,UACxBvJ,KAAKiwB,kBAAoB,K,CAGnBqB,6BAAgCnY,IACtCnZ,KAAKkwB,YAAYvrB,KAAK,MAAM,EAGtB4sB,qBAAwBla,IAC9BrX,KAAKgwB,iBAAmB3Y,EACxBrX,KAAKiwB,kBAAoB,KAAK,EAGxBuB,kBAAoB,KAC1BxxB,KAAKqwB,UAAUhc,aACfrU,KAAKkwB,YAAYvrB,KAAK,MAAM,EAG9B,MAAAmM,GACE,MAAM2gB,EAAezxB,KAAKixB,yBAE1B,OACExf,EAAA,aAAAhQ,IAAA,2CAAWwW,MAAO,QAASR,IAAKC,GAAO1X,KAAKqwB,SAAW3Y,EAAKga,eAAgB1xB,KAAKsxB,8BAC9EtxB,KAAKkG,MACJuL,EAACY,EAAQ,CAAA5Q,IAAA,4CACPgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,eACTF,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,8CAA8C3R,KAAKkG,KAAKzC,aAChEguB,GASChgB,EAAA,aAAAhQ,IAAA,uDACa0R,IACTA,EAAE3F,2BACF2F,EAAE5F,iBAAiB,EAErBokB,aAAc,GAAE,YACLxe,IACTA,EAAE3F,2BACF2F,EAAE5F,iBAAiB,EAErBsP,KAAK,QAAO,eACEjE,OAAO5Y,KAAKiwB,mBAC1B2B,SAAUze,GAAKnT,KAAKuxB,qBAAsBpe,EAAEiY,OAAe/T,QAE3D5F,EAAA,aAAAhQ,IAAA,2CAAW4V,MAAM,IAAE,uBAClBrX,KAAK4wB,gBAAgB9a,KAAI+a,GACxBpf,EAAA,aAAWhQ,IAAKovB,EAAOxZ,MAAOA,MAAOwZ,EAAOxZ,OACzCwZ,EAAOzZ,UAMlB3F,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,gBAAgBsH,KAAK,UAC9BxH,EAAA,oBAAAhQ,IAAA,2CAAkBowB,WAAW,SAASzZ,QAAQ,UAAUE,eAAgBtY,KAAKwxB,kBAAmB3U,KAAK,UAAQ,UAG7GpL,EAAA,oBAAAhQ,IAAA,2CAAkB2W,QAAQ,QAAQE,eAAgB,IAAMtY,KAAK0wB,iBAAkB7T,KAAK,SAASiV,QAASC,EAAiB,6BAA2B,a,uECxKzJ,MAAMC,GAAqBrd,EAAEE,OAAO,CACzCmD,YAAarD,EAAEsd,OAAOC,SACtBvc,QAAShB,EAAEsd,OAAOC,SAClBppB,YAAa6L,EAAEsd,OAAOC,WCRxB,MAAMC,GAAqB,+oBAC3B,MAAAC,GAAeD,GCDf,MAAM5e,GAAW,+qBACjB,MAAA8e,GAAe9e,G,MCiBF+e,GAAe,M,gEAClB/sB,QACAG,WAEC6sB,cACA/rB,KACAyC,UAAgC,GAChC6K,aAAsC,GACtCE,UACAD,OACAye,gBAAyC,KAEzCne,WAEDtQ,aACAlF,eAAiB,IAAIC,EAE7B,iBAAAwB,GACEN,KAAKwG,KAAOxG,KAAKyyB,UACjBzyB,KAAK+D,aAAe,IAAK/D,KAAK0yB,cAAc1yB,KAAKwG,OACjDxG,KAAKuyB,cAAgB,IAAKvyB,KAAK+D,cAC/BrB,QAAQC,IAAI3C,KAAKuF,Q,CAGX,OAAAktB,GACN,IAAKzyB,KAAKuF,QAAS,CACjB,MAAM,IAAIoB,MAAM,kB,CAElB,IAAK3G,KAAK0F,WAAY,CACpB,MAAM,IAAIiB,MAAM,qB,CAElB,MAAMH,EAAOxG,KAAKuF,QAAQe,MAAMiW,MAAKrU,GAAKA,EAAExC,aAAe1F,KAAK0F,aAChE,IAAKc,EAAM,CACT,MAAM,IAAIG,MAAM,sCAAsC3G,KAAK0F,a,CAE7D,OAAOc,C,CAGD,aAAAksB,CAAclsB,GACpB,IAAImsB,EAAYpwB,EAAOiE,EAAKnE,UAAW,cACvC,MAAMuwB,EAAUrwB,EAAOiE,EAAKpE,QAAS,cAAcI,KAAK,EAAG,QAC3D,MAAM+b,EAAQhc,IACd,GAAIowB,EAAUpuB,SAASga,GAAQ,CAC7BoU,EAAYpU,EAAM/F,O,CAEpB,GAAIma,EAAU3vB,OAAOub,GAAQ,CAC3B,MAAO,CAAElc,UAAWswB,EAAWvwB,QAASwwB,E,CAE1C,GAAID,EAAUpoB,cAAcgU,GAAQ,CAClC,MAAO,CAAElc,UAAWswB,EAAUna,QAAQhW,IAAI,EAAG,QAASJ,QAASwwB,E,CAEjE,MAAO,CAAEvwB,UAAWkc,EAAM/F,QAAQhW,IAAI,EAAG,QAASJ,QAASwwB,E,CAGrD,8BAAMC,GACZC,EAAkB,OAClB,MAAMzwB,EAAYrC,KAAKuyB,cAAclwB,UAAUI,OAAO,cACtD,MAAML,EAAUpC,KAAKuyB,cAAcnwB,QAAQK,OAAO,cAElD,MAAMswB,EAAmB/yB,KAAKuF,QAAQytB,QAAU,KAChD,IACE,MAAM9sB,QAAalG,KAAKnB,eAAeo0B,uBAAuB,CAC5D5wB,YACAD,UACAqnB,WAAYzpB,KAAKuF,QAAQ4D,SAAShB,GAClC+qB,gBAAiB,CACfC,MAAO,EACPC,MAAO,GAET91B,SAAU,KACV+1B,cAAe,GACfj2B,SAAU4C,KAAKuF,QAAQnI,SACvBk2B,SAAUP,EAAmB/yB,KAAKuF,QAAQytB,MAAM7qB,GAAK,KACrD4qB,mBACAQ,wBAAyB,KAE3BvzB,KAAKiJ,UAAY/C,C,CACjB,MAAOL,GACPnD,QAAQmD,MAAM,2CAA4CA,E,EAItD,mBAAM2tB,GACZ,IACExzB,KAAKgU,UAAY,KACjBhU,KAAK+T,OAAS,KACd,MAAMD,EAAeke,GAAmB1c,MAAMtV,KAAK8T,cACnD,MAAM2f,EAAWzzB,KAAKuF,QAAQe,MAAMC,QAAO2B,GAAKA,EAAExC,aAAe1F,KAAK0F,aACtE,MAAMguB,EAAa1zB,KAAKwG,KAAKmtB,QAAQxjB,OAAS,MAAS5N,IAASgC,SAASvE,KAAKuyB,cAAclwB,WAAa,MAAQ,KAAQ,MACzH,IAAIiE,EAAQ,IACPmtB,EACH,IACKzzB,KAAKwG,KACRnE,UAAWrC,KAAKwG,KAAKnE,UACrBD,QAASpC,KAAKuyB,cAAclwB,UAAUI,OAAO,cAC7CsZ,KAAM/b,KAAKwG,KAAKuV,KAAKxV,QAAO2B,GAAK3F,EAAO2F,EAAEoO,KAAM,cAAc/R,SAASvE,KAAKuyB,cAAclwB,UAAW,WACrGuxB,eAAgB,MAElB,IACK5zB,KAAKwG,KACRd,WAAY,KACZiuB,OAAQD,EACJ1zB,KAAKwG,KAAKmtB,OACV,CACExjB,KAAM,OAEZ0jB,SAAUH,EACVI,oBAAqB,KACrBC,uBAAwB/zB,KAAKwG,KAAKd,WAClCsuB,SAAU,KACVC,SAAU,CACR9rB,GAAI2L,EAAakE,aAEnBkc,SAAU,CACR/rB,GAAI2L,EAAahL,aAAe9I,KAAKwG,KAAK0tB,SAAS/rB,IAErDyrB,eAAgB5zB,KAAKwG,KAAKotB,eAC1B/M,KAAM,CAAE1e,GAAI2L,EAAa6B,SACzBtT,UAAWrC,KAAKuyB,cAAclwB,UAAUI,OAAO,cAE/CsZ,KAAM/b,KAAKwG,KAAKuV,KAAKxV,QAAO2B,GAAK3F,EAAO2F,EAAEoO,KAAM,cAAc/L,cAAcvK,KAAKuyB,cAAclwB,UAAW,aAG9G,MAAMkD,EAAU,CACd4uB,aAAc,KACdC,OAAQ,KACRxuB,UAAW5F,KAAKuF,QAAQK,UACxByuB,WAAY,KACZC,mBAAoBt0B,KAAKuF,QAAQ+uB,mBACjCC,UAAWv0B,KAAKuF,QAAQgvB,UACxBC,OAAQx0B,KAAKuF,QAAQivB,OACrBxB,MAAOhzB,KAAKuF,QAAQytB,MACpBztB,QAAS,CACPlD,UAAWrC,KAAKuF,QAAQlD,UACxBD,QAASpC,KAAKuF,QAAQnD,QACtBqyB,OAAQz0B,KAAKuF,QAAQkvB,OACrBvN,YAAalnB,KAAKuF,QAAQ2hB,YAC1B/d,SAAUnJ,KAAKuF,QAAQ4D,SACvBurB,UAAW10B,KAAKuF,QAAQmvB,UACxBC,OAAQ30B,KAAKuF,QAAQovB,OACrBruB,QACAlJ,SAAU4C,KAAKuF,QAAQnI,SACvBw3B,QAAS50B,KAAKuF,QAAQqvB,QACtBC,MAAO70B,KAAKuF,QAAQsvB,OAEtBC,YAAa90B,KAAKuF,QAAQuvB,aAE5BpyB,QAAQC,IAAI4C,SACNvF,KAAKnB,eAAe20B,cAAcjuB,GACxCvF,KAAKqU,WAAW1P,KAAK,K,CACrB,MAAOkB,GACP,MAAMkvB,EAA+B,GACrC,GAAIlvB,aAAiBqQ,EAAU,CAC7BxT,QAAQmD,MAAMA,GACdA,EAAMmvB,OAAOvV,SAAQlJ,IACnBwe,EAAIxe,EAAE0e,KAAK,IAAM,IAAI,IAEvBj1B,KAAK+T,OAAS,IAAKghB,E,UAGrB/0B,KAAKgU,UAAY,K,EAIb,kBAAAkhB,CAAmBC,GACzB,MAAMC,EAAgC,IAAKp1B,KAAK8T,gBAAiBqhB,GACjE,MAAME,EAAkBnsB,GAAeC,UAAUC,UACjD,MAAMksB,EAAiBzsB,EAAc,CACnCC,YAAa9I,KAAKwG,KAAK0tB,SAAS/rB,GAAGsB,WACnCT,WAAYosB,GAAQpd,YACpB/O,UAAWosB,IAGb,MAAME,EAA4B5T,OAAO6T,UAAUxR,eAAeyR,KAAKN,EAAQ,eAE/E,GAAI9rB,MAAMC,QAAQgsB,GAAiB,CACjCt1B,KAAKwyB,gBAAkB8C,EACvB,IAAKC,EAA2B,QACvBH,EAAOtsB,W,MAEX,CACL9I,KAAKwyB,gBAAkB,KACvB,IAAK+C,EAA2B,CAC9B,GAAID,EAAgB,CAClBF,EAAOtsB,YAAcjG,OAAOyyB,EAAeje,M,KACtC,QACE+d,EAAOtsB,W,GAKpB9I,KAAK8T,aAAeshB,C,CAGtB,MAAAtkB,GACE,OACEW,EAAA,QAAAhQ,IAAA,2CACEuV,SAAU7D,IACRA,EAAE7F,iBACFtN,KAAKwzB,eAAe,EAEtB7hB,MAAM,mBAENF,EAAA,YAAAhQ,IAAA,2CAAUkQ,MAAM,yBAAyBuI,eAAe,UAAUD,eAAgB,IAAMja,KAAKqU,WAAW1P,OAAQsT,MAAO,cAAcjY,KAAKwG,MAAMqgB,KAAK,YACrJpV,EAAA,WAAAhQ,IAAA,2CAASkQ,MAAM,mBACbF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,4BAA4B9H,MAAO,CAAEoN,IAAK,WACnDxF,EAAA,OAAAhQ,IAAA,4CACEgQ,EAAA,gBAAAhQ,IAAA,2CAAcY,UAAWrC,KAAKwG,KAAKnE,UAAWD,QAASpC,KAAKwG,KAAKpE,QAASszB,mBAAoB,SAEhGjkB,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,WACN3R,KAAKwG,KAAK0tB,SAASyB,WAAU,IAAG31B,KAAKwG,KAAK0tB,SAAS0B,kBAAoBzwB,EAAQC,QAAQywB,kBAAoB,KAGhHpkB,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,iCAAkC9H,MAAO,CAAEoN,IAAK,WAC1DxF,EAAA,QAAAhQ,IAAA,qDACAgQ,EAAA,kBAAAhQ,IAAA,yDACc,sBACZ6U,KAAMtW,KAAKuyB,eAAelwB,WAAWI,OAAO,cAC5CyW,QAASlZ,KAAK+D,cAAc3B,QAAQK,OAAO,cAC3CgS,QAASzU,KAAK+D,cAAc1B,UAAUI,OAAO,cAC7CkW,cAAe,KAEfE,cAAeC,IACb9Y,KAAKuyB,cAAgB,IAChBvyB,KAAKuyB,cACRlwB,UAAWyW,EAAIxX,OAAOyX,MACvB,GAGHtH,EAAA,SAAAhQ,IAAA,2CACEsE,KAAK,OACLkT,KAAK,UACL5B,MAAOrX,KAAKuyB,cAAclwB,UAAYrC,KAAKuyB,cAAclwB,UAAUI,OAAO,gBAAkB,KAC5FkP,MAAO,qCACP9H,MAAO,CAAEE,MAAO,YAGpB0H,EAAA,aAAAhQ,IAAA,2CAAWuS,UAAW+d,EAAiB,uBAAwB3a,KAAK,wBAAwByF,KAAK,KAAK4I,QAAS,IAAMzlB,KAAK6yB,8BAE3H7yB,KAAK+T,QAAQiE,aAAevG,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,8BAA4B,wBAClEF,EAAA,MAAAhQ,IAAA,2CAAIkQ,MAAM,uBACP3R,KAAKiJ,WAAW6M,KAAI/N,IACnB,IAAKA,EAASsgB,qBAAsB,CAClC,OAAO,I,CAET,MAAMyN,EAAQ,MACZ,MAAMC,EAAU,IAAIliB,IACpB,IAAK,MAAMqgB,KAAYnsB,EAASjD,WAAa,GAAI,CAC/C,IAAK,MAAM+hB,KAAQqN,EAAS8B,kBAAoB,GAAI,CAClD,GAAInP,EAAKoP,mBAAoB,CAC3BF,EAAQvZ,IAAIqK,EAAKqP,MAAOrP,EAAKlP,K,GAKnC,OAAOtO,MAAM8K,KAAK4hB,GAAS,EAAE5tB,EAAIwP,MAAK,CAAQxP,KAAIwP,UACnD,EAXa,GAYd,OACElG,EAACY,EAAQ,KACPZ,EAAA,MAAIhQ,IAAK,eAAesG,EAASI,KAAMwJ,MAAO,iBAC5CF,EAAA,OAAKE,MAAO,qBACVF,EAAA,QAAME,MAAM,4BAA4B5J,EAAS4P,QAGpDme,EAAMhgB,KAAI,CAACtP,EAAMoR,KAChB,MAAMC,EAAYD,IAAM7P,EAASE,cAAcvB,OAAS,EAAI,OAAS,GACrE,MAAMyvB,EAAqBn2B,KAAK8T,cAAc6B,UAAYnP,EAAK2B,IAAMkB,MAAMC,QAAQtJ,KAAKwyB,kBAAoBxyB,KAAKwyB,gBAAgB9rB,OAAS,EAC1I,OACE+K,EAAA,MAAIhQ,IAAK,gBAAgB+E,EAAK2B,MAAMyP,IAAKjG,MAAO,iBAAiBkG,KAC/DpG,EAAA,OAAKE,MAAO,uCAAwC9H,MAAO,CAAEoN,IAAK,WAChExF,EAAA,YACEE,MAAM,OACNgG,KAAK,OACLG,QAAS9X,KAAK8T,cAAc6B,UAAYnP,EAAK2B,GAC7C4P,cAAe,IACb/X,KAAKk1B,mBAAmB,CACtBld,YAAajQ,EAASI,GACtBwN,QAASnP,EAAK2B,KAGlB8P,MAAOzR,EAAKmR,OAEbwe,GACC1kB,EAAA,aACE8L,YAAY,2BACZ1X,MAAO7F,KAAK+T,QAAQjL,cAAgB9I,KAAK8T,cAAchL,YACvDwO,eAAgBnE,IACd,MAAMkE,EAAQlE,EAAE7R,SAAW,MAAQ6R,EAAE7R,SAAWiI,WAAa4J,EAAE7R,SAAW,GAAKiI,UAAY1G,OAAOsQ,EAAE7R,QACpGtB,KAAKk1B,mBAAmB,CACtBpsB,YAAauO,GACb,EAEJnR,KAAMlG,KAAKwyB,gBAAgB1c,KAAI3C,IAAC,IAAUA,EAAGiE,KAAMjE,EAAEiE,KAAO,GAAGjE,EAAE6d,YAAc,MAAQ,KAAK7d,EAAE6d,qBAuBjG,IAGA,MAKnBvf,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,gBACVF,EAAA,aAAAhQ,IAAA,2CAAW2V,KAAMjS,EAAQC,QAAQgU,WAAYC,UAAU,YAAY1H,MAAO,YAAa2G,eAAgB,IAAMtY,KAAKqU,WAAW1P,KAAK,QAClI8M,EAAA,aAAAhQ,IAAA,2CAAWuS,UAAWhU,KAAKgU,UAAWoD,KAAMjS,EAAQC,QAAQkU,YAAaC,SAAS,SAAS5H,MAAM,e,kBCvV3G,MAAMykB,GAAwB,6CAC9B,MAAAC,GAAeD,G,MCMFE,GAAkB,M,0EACrBhY,aACAkM,aACA+L,eAAyC,GACzCC,WACiBC,WACjBvO,cAECjnB,YAAuB,MAEvBy1B,gBAET,qBAAAC,CAAsBt1B,GACpBA,EAAMmM,2BACNnM,EAAMkM,kBAEN,MAAMqpB,EAA8Bv1B,EAAMC,OAC1CtB,KAAKy2B,WAAaz2B,KAAKy2B,WAAWlwB,QAAOswB,GAAaA,EAAUpwB,IAAMmwB,EAAI1wB,KAAKO,KAC/EzG,KAAKse,aAAa+C,cAAc/F,KAAKsb,EAAI1wB,MACzClG,KAAK02B,gBAAgB/xB,KAAK,CACxBlD,IAAK,aACLyE,KAAM,CACJ4wB,MAAO92B,KAAKw2B,WACZhM,aAAcxqB,KAAKwqB,aACnBuM,YAAaH,EAAI1wB,KACjBoY,aAActe,KAAKse,gBAIvBte,KAAK6qB,Y,CAIP,YAAAmM,CAAaR,EAAYC,GACvB,OAAOA,EAAW3gB,KAAI,CAAC+gB,EAAWvW,IAChC7O,EAAA,wBACE6M,aAActe,KAAKse,aACnBkM,aAAcxqB,KAAKwqB,aACnBqM,UAAWA,EACXN,eAAgBv2B,KAAKu2B,eACrBC,WAAYA,EACZtO,cAAeloB,KAAKkoB,cACpB+O,WAAY3W,EACZ4W,kBAAmBpe,GAAO9Y,KAAK22B,sBAAsB7d,M,CAK3D,UAAA+R,GACE7qB,KAAKiB,aAAejB,KAAKiB,W,CAG3B,MAAA6P,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,4CACHgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,oBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,sCAAsC3R,KAAKu2B,eAAev2B,KAAKw2B,aAAa7e,MACtF3X,KAAKg3B,aAAah3B,KAAKw2B,WAAYx2B,KAAKy2B,a,eChEnD,MAAMU,GAAqB,0jDAC3B,MAAAC,GAAeD,G,MCaFE,GAAe,M,wUAClBC,oBACA7N,WACApnB,UACAD,QACiBkc,aAEhBiZ,eACAC,cAAyB,MACzBv2B,YAAuB,MACvBw2B,iBAA0B,GAC1BC,SAAW,MAEXjP,YAETkP,yBACShZ,iBACiCiZ,qBAE1CC,kCAEQC,uBAAkC,MAClC9jB,UAAqB,KACrBwW,aAAe,KACftkB,KAA+B,GAC/BqY,MAAQ,IAAI9T,KACZ8rB,eAAyC,GACzC1M,oBAA2C,IAAIC,EAC/CJ,gBAER,iBAAAppB,GACEN,KAAK+3B,gBACL/3B,KAAKu3B,eAAiBpyB,EAAQC,QAAQ4yB,2B,CAIxC,uCAAAC,CAAwC/N,GACtC,MAAM9lB,SAAEA,EAAQC,OAAEA,EAAM6B,KAAEA,GAASgkB,EACnC,IAAIK,EAAK,IAAI9f,KAAKrG,GAClBmmB,EAAGjL,SAAS,GACZiL,EAAG2N,WAAW,GACd3N,EAAG4N,WAAW,GACd,IAAItW,EAAU0I,EAAG7f,UACjB,MAAOmX,GAAW,IAAIpX,KAAKpG,GAAQqG,UAAW,CAC5C,GAAIxE,IAASA,EAAK2b,IAAY7hB,KAAK0pB,gBAAgB1F,eAAenC,GAAU,QACnE7hB,KAAK0pB,gBAAgB7H,E,MACvB,GAAI3b,GAAQA,EAAK2b,GAAU,CAChC7hB,KAAK0pB,gBAAgB7H,GAAW3b,EAAK2b,E,CAEvCA,EAAUtf,EAAOsf,GAASrf,IAAI,EAAG,QAAQ6B,SAASqG,S,CAEpD1K,KAAKkG,KAAO,IAAKlG,KAAK0pB,iBACtB1pB,KAAKy3B,iBAAmB9V,OAAOD,KAAK1hB,KAAKkG,MAAMkyB,MAAK,CAACC,EAAGC,IAAMC,SAASF,GAAKE,SAASD,KAErF,GAAIt4B,KAAKy3B,iBAAiB/wB,OAAQ,CAChC,IAAK1G,KAAKkG,KAAK8d,eAAehkB,KAAKwqB,cAAe,CAChDxqB,KAAKwqB,aAAexqB,KAAKy3B,iBAAiB/wB,OAAS1G,KAAKy3B,iBAAiB,GAAK,I,CAEhFz3B,KAAKw4B,YAAYx4B,KAAKwqB,aAAc,OACpCxqB,KAAK6qB,Y,KACA,CACL7qB,KAAKwqB,aAAe,I,EAGxB,gBAAAiO,CAAiBp3B,GACf,MAAMu1B,EAA8Bv1B,EAAMC,OAC1C,MAAM4E,EAAO0wB,EAAI1wB,KACjB7E,EAAMmM,2BACNnM,EAAMkM,kBAEN,GAAIqpB,GAAKn1B,MAAQ,cAAgBzB,KAAKkG,KAAM,CAE1C,GAAIA,GAAMskB,cAAgBxqB,KAAKkG,KAAKA,EAAKskB,cAAe,CAEtD,GAAIxqB,KAAKkG,KAAKA,EAAKskB,eAAekO,YAAc/W,OAAOD,KAAK1hB,KAAKkG,KAAKA,EAAKskB,eAAekO,YAAc,KAAKhyB,SAAW,EAAG,CACzH1G,KAAKgU,UAAY,KACjBhU,KAAK03B,SAAW,I,CAIlB,GACExxB,GAAM4wB,OACN92B,KAAKkG,KAAKA,EAAKskB,eAAekO,YAC9B14B,KAAKkG,KAAKA,EAAKskB,cAAckO,WAAWxyB,EAAK4wB,QAC7CztB,MAAMC,QAAQtJ,KAAKkG,KAAKA,EAAKskB,cAAckO,WAAWxyB,EAAK4wB,SAC3D5wB,GAAM6wB,aAAatwB,GACnB,CACAzG,KAAKkG,KAAKA,EAAKskB,cAAckO,WAAWxyB,EAAK4wB,OAAS92B,KAAKkG,KAAKA,EAAKskB,cAAckO,WAAWxyB,EAAK4wB,OAAOvwB,QACxGswB,GAAaA,GAAaA,EAAUpwB,KAAOP,EAAK6wB,YAAYtwB,I,CAKhE,GAAIP,GAAMoY,aAAc,CACtBte,KAAKse,aAAepY,EAAKoY,Y,CAG3Bte,KAAK6qB,Y,GAKX,sBAAM8N,CAAiBl3B,EAAK6c,GAC1B,IAEE,IAAIsa,EAAmB,GACvB,MAAM3b,QAAejd,KAAK6pB,oBAAoBY,mBAC5C,CAAEpoB,UAAWic,EAAajc,UAAWD,QAASkc,EAAalc,SAC3DpC,KAAKypB,WACLiB,EAAsB,IAAIjgB,MAAMhJ,IAChC6c,EAAatW,UACbsW,EAAagF,qBAEfrG,EAAOwC,SAAQjZ,IACb,IAAKoyB,EAAiB5U,eAAexd,EAAKswB,OAAQ,CAChD8B,EAAiBpyB,EAAKswB,OAAS,CAACtwB,E,KAC3B,CACLoyB,EAAiBpyB,EAAKswB,OAAOxb,KAAK9U,E,KAGtCxG,KAAK0pB,gBAAgBjoB,GAAKi3B,WAAaE,C,CACvC,MAAO/yB,G,EAKX,mBAAMkyB,GACJ,IACE/3B,KAAKue,MAAMe,SAAS,EAAG,EAAG,EAAG,GAC7Btf,KAAKse,aAAatW,UAAUyX,SAAQK,IAClC9f,KAAKu2B,eAAezW,EAAS3X,IAAM,CACjCwP,KAAMmI,EAASnI,KACfiS,UAAW9J,EAAS7X,cACpB4wB,QAAS/Y,EAAS7X,cAAc6N,KAAItP,GAC3BA,EAAK2B,KAEf,IAGHnI,KAAKwqB,aAAe,KAEpBxqB,KAAK0pB,gBAAkBoP,IACvBp2B,QAAQC,IAAI3C,KAAK0pB,iBAEjB1pB,KAAKkG,KAAOlG,KAAK0pB,gBACjB1pB,KAAKy3B,iBAAmB9V,OAAOD,KAAK1hB,KAAKkG,MAAMkyB,MAAK,CAACC,EAAGC,IAAMC,SAASF,GAAKE,SAASD,KAErF,IAAKt4B,KAAKwqB,cAAgBxqB,KAAKy3B,iBAAiB/wB,OAAQ,CACtD1G,KAAKwqB,aAAexqB,KAAKy3B,iBAAiB,E,EAE5C,MAAO5xB,GACPnD,QAAQmD,MAAM,mCAAoCA,E,EAItD,sBAAMtF,GACJG,YAAW,KACT,IAAKV,KAAK83B,wBAA0BnW,OAAOD,KAAK1hB,KAAK0pB,iBAAiBhjB,OAAS,EAAG,CAEhF,MAAMqyB,EAAWpX,OAAOD,KAAK1hB,KAAK0pB,iBAAiB,GAEnD1pB,KAAKw4B,YAAYO,E,IAElB,I,CAGL,cAAMC,CAAS33B,GACbrB,KAAK83B,uBAAyB,KAC9B93B,KAAKw4B,YAAYn3B,EAAMC,OAAO4E,MAC9BlG,KAAKw3B,cAAgB,MACrBx3B,KAAK6qB,Y,CAGP,sBAAAoO,CAAuB9lB,GACrBnT,KAAK2e,iBAAiBha,KAAK,CACzBlD,IAAK,WACLyE,KAAM,IAAIuE,KAAK0I,EAAE7R,OAAO4E,KAAK9B,UAAUsG,UAAY,MACnDgtB,SAAU,O,CAGd,iBAAMc,CAAYU,EAAWC,EAAc,MACzC,IACE,GAAIA,EAAa,CACfn5B,KAAKgU,UAAY,I,CAEnB,GAAIhU,KAAKw3B,cAAe,CACtBx3B,KAAKo5B,oB,OAEDp5B,KAAK24B,iBAAiBO,EAAWl5B,KAAKse,cAC5Cte,KAAK43B,qBAAqBjzB,KAAK,CAAElD,IAAK,qBAAsByE,KAAM,KAClElG,KAAK2e,iBAAiBha,KAAK,CACzBlD,IAAK,WACLyE,KAAMqyB,SAASW,GAAa,MAC5BxB,SAAU13B,KAAK03B,WAEjB,GAAI13B,KAAK83B,uBAAwB,CAC/B93B,KAAK83B,uBAAyB,K,CAEhC93B,KAAKgU,UAAY,MACjBhU,KAAKwqB,aAAe0O,EACpBl5B,KAAK6qB,Y,CACL,MAAOhlB,G,EAKX,MAAAwzB,CAAO9O,GACL,MAAMxL,EAAc,IAAItU,KAAK8f,GAC7B,MAAM9G,EAAS,UACf,MAAM6V,EAAYt5B,KAAKu5B,sBAAsBxa,EAAa0E,GAE1D,OAAO6V,EAAY,IAAMva,EAAY1S,UAAY,KAAO0S,EAAYxS,a,CAGtE,qBAAAgtB,CAAsBjjB,EAAMmN,GAC1B,MAAM5Q,EAAU,CAAE2mB,QAAS,SAC3B,OAAOljB,EAAKmjB,mBAAmBhW,EAAQ5Q,E,CAGzC,iBAAA+V,CAAkBnnB,EAAKyE,EAAO,IAC5BlG,KAAK63B,kCAAkClzB,KAAK,CAC1ClD,IAAK,qBACLyE,KAAM,CAAEvE,UAAW,UAErB3B,KAAK43B,qBAAqBjzB,KAAK,CAAElD,IAAK,qBAAsByE,KAAM,KAClElG,KAAKyoB,YAAY9jB,KAAK,CAAElD,MAAKyE,Q,CAG/B,kBAAAkzB,GACEp5B,KAAKw3B,eAAiBx3B,KAAKw3B,a,CAG7B,uBAAAkC,G,CAIA,eAAAC,GACE,GAAI35B,KAAKy3B,iBAAiB/wB,QAAU1G,KAAKwqB,cAAgBxqB,KAAKkG,KAAKlG,KAAKwqB,cAAe,CACrF,OAAO7I,OAAOvc,QAAQpF,KAAKkG,KAAKlG,KAAKwqB,cAAckO,YAAY5iB,KAAI,EAAE3N,EAAIsuB,GAAanW,IACpF7O,EAAA,yBACE6M,aAActe,KAAKse,aACnBkM,aAAcxqB,KAAKwqB,aACnBgM,WAAYruB,EACZ+f,cAAe5H,EACfiW,eAAgBv2B,KAAKu2B,eACrBE,WAAYA,EACZmD,kBAAmB9gB,GAAO9Y,KAAKy4B,iBAAiB3f,M,KAG/C,CACL,OAAO,I,EAIX,UAAA+R,GACE7qB,KAAKiB,aAAejB,KAAKiB,W,CAG3B,MAAA6P,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,2CAACkQ,MAAM,wCACVF,EAAA,OAAAhQ,IAAA,4CACEgQ,EAAA,OAAAhQ,IAAA,4CACEgQ,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,qBACTF,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,qBACVF,EAAA,KAAAhQ,IAAA,2CAAGkQ,MAAM,uBAAuBxM,EAAQC,QAAQy0B,iBAChDpoB,EAAA,aAAAhQ,IAAA,2CACEkQ,MAAM,YACNyG,QAAQ,OACR4T,WAAW,kBACX3T,UAAU,oBACVxO,MAAOgiB,EAAcC,UACrBxT,eAAgB,IAAMtY,KAAK4oB,kBAAkB,iBAC7CqD,yBAAwB,QAG5Bxa,EAAA,MAAAhQ,IAAA,6CACCkgB,OAAOD,KAAK1hB,KAAKkG,MAAMQ,SAAW,EACjC+K,EAAA,SAAItM,EAAQC,QAAQ00B,4BAClB95B,KAAKgU,UACPvC,EAAA,KAAGE,MAAM,6BACPF,EAAA,QAAME,MAAM,OAAO3R,KAAKu3B,gBACxB9lB,EAAA,OAAKE,MAAM,QACTF,EAAA,OAAKE,MAAM,QACXF,EAAA,OAAKE,MAAM,QACXF,EAAA,OAAKE,MAAM,UAIfF,EAACY,EAAQ,KACNrS,KAAKy3B,iBAAiB/wB,OACrB+K,EAAA,OACEE,MAAO,4DAA8D3R,KAAKw3B,cAAgB,OAAS,IACnGrvB,GAAG,qBAAoB,cACX,WAAU,gBACR,OAAM,gBACN,SAEdsJ,EAAA,OACEE,MAAO,mBAGPF,EAAA,QAAME,MAAM,oBAAoB3R,KAAKkG,KAAKlG,KAAKwqB,cAAc5P,SAC7DnJ,EAAA,OAAKE,MAAO,aAAcmU,MAAM,6BAA6BC,QAAQ,cAAclZ,OAAQ,GAAI9C,MAAO,IACpG0H,EAAA,QACEiJ,KAAK,UACL7D,EAAE,+KAIRpF,EAAA,OAAKE,MAAM,+CAA8C,kBAAiB,sBACvE3R,KAAKy3B,kBAAkB3hB,KAAIikB,GAC1BtoB,EAAA,OAAKE,MAAM,wBAAwB8T,QAAS,IAAMzlB,KAAKw4B,YAAYuB,IAChE/5B,KAAKkG,KAAK6zB,GAASnf,aAM5BzV,EAAQC,QAAkC,8BAKhDpF,KAAKgU,WACLvC,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,mBACR3R,KAAKy3B,iBAAiB/wB,OACrBib,OAAOD,KAAK1hB,KAAKkG,KAAKlG,KAAKwqB,cAAckO,YAAYhyB,OACnD1G,KAAK25B,kBAELloB,EAAA,OAAKE,MAAM,QAAQxM,EAAQC,QAAQ40B,yBAEnC,Q,6GC1VpB,MAAMC,GAAwB,42CAC9B,MAAAC,GAAeD,G,MCMFE,GAAkB,M,iDAMrBtU,aAAuB,GAMvBuU,cAAwB,OAKxB5T,SAAoB,MAKpB6T,SAAmB,GAKnBC,aAKAC,kBAA4B,GAC5BC,kBACAC,gBAKA,yBAAAC,CAA0BC,EAA6B91B,GAE7D,GAAI7E,KAAKu6B,oBAAsB11B,GAAS7E,KAAKy6B,gBAAiB,CAC5D,M,CAEFz6B,KAAK46B,iBAEL,MAAMC,EAAWpuB,SAASquB,cAAc,QACxCD,EAAShxB,MAAMkxB,WAAa,SAC5BF,EAAShxB,MAAM1L,SAAW,WAC1B08B,EAAShxB,MAAMmxB,WAAa,SAC5BH,EAASI,YAAcp2B,EACvB4H,SAASyuB,KAAKC,YAAYN,GAE1B,MAAMO,EAAYP,EAAS7sB,YAC3BvB,SAASyuB,KAAKG,YAAYR,GAE1B,MAAMS,EAAiBX,EAAeY,YACtC,MAAMC,EAAYx7B,KAAKwmB,SAAW,GAAK,EAEvC,MAAMiV,EAAeL,EAAYI,EAAYF,EAE7C,GAAIG,UAAuBC,IAAM,YAAa,CAC5C,IACE17B,KAAKy6B,gBAAkBiB,EAAEf,GAAgBgB,QAAQ,CAC/CC,QAAS,QACTC,QAASh3B,EACTi3B,UAAW,MACXC,KAAM,MACNC,SAAU,KACVC,MAAO,CAAEC,KAAM,IAAKC,KAAM,M,CAE5B,MAAOt2B,GACPnD,QAAQmD,MAAM,gCAAiCA,E,EAInD7F,KAAKu6B,kBAAoB11B,C,CAGnB,cAAA+1B,GACN,GAAI56B,KAAKy6B,wBAA0BiB,IAAM,YAAa,CACpD,IACEA,EAAE17B,KAAKw6B,mBAAmBmB,QAAQ,WAClC37B,KAAKy6B,gBAAkB,I,CACvB,MAAO50B,GACPnD,QAAQmD,MAAM,6BAA8BA,E,GAKlD,oBAAA3E,GACElB,KAAK46B,gB,CAGP,MAAA9pB,GACE,MAAMjM,EAAQ7E,KAAK6lB,cAAgB,GAEnC,MAAMuW,EAAav3B,EAAM6B,OAAS1G,KAAKq6B,SACvC,MAAMgC,EAAeD,EAAav3B,EAAMy3B,MAAM,EAAGt8B,KAAKq6B,UAAY,MAAQx1B,EAE1E,OACE4M,EAACC,EAAI,CAAAjQ,IAAA,2CAACoI,MAAO,CAAE,oBAAqB7J,KAAKo6B,gBACvC3oB,EAAA,KAAAhQ,IAAA,2CACEgW,IAAKC,IACH1X,KAAKw6B,kBAAoB9iB,EACzB,GAAIA,GAAM7S,EAAO,CACfnE,YAAW,IAAMV,KAAK06B,0BAA0BhjB,EAAI7S,IAAQ,E,GAGhE8M,MAAM,gBACN9H,MAAO,CACLmxB,WAAY,SACZuB,SAAU,SACVC,aAAc,WACd/V,QAAS,OACTgW,WAAY,SACZxlB,IAAK,QAGPxF,EAAA,QAAAhQ,IAAA,2CACEkQ,MAAM,gBACN9H,MAAO,CACL6yB,WAAY,IACZC,SAAU,IACVJ,SAAU,SACVC,aAAc,aAGfH,GAEFr8B,KAAKwmB,UACJ/U,EAAA,OAAAhQ,IAAA,2CAAKoD,MAAO7E,KAAKs6B,aAAc3oB,MAAM,SAAS9H,MAAO,CAAE6yB,WAAY,MACjEjrB,EAAA,QAAAhQ,IAAA,2CAAMkW,KAAK,U,eC3IzB,MAAMilB,GAAkB,wtEACxB,MAAAC,GAAeD,G,MCQFE,GAAY,M,oKAIf7kB,MAEA8kB,SAGAC,WAGAC,WAGA75B,SAGAhG,SAGA8/B,aAAyB,KAGzBC,QAMAC,IAGAhO,YAAsB,GAGL/X,MAAgB,GAGjCgmB,SAAoB,MAGpBC,SAGAC,SAGAC,OAGiB33B,MAOjB43B,mBAQAC,wBAGCC,WAGAC,UAGAC,WAED11B,GAEA21B,KAAO,CACbC,KAAMl7B,OACNm7B,MAAO,EACPC,MAAO,IACPC,WAAY,CAAC,KACbC,eAAgB,KAChBC,mBAAoB,KACpBC,mBAAoB,KAEdN,KACAO,SAER,iBAAAh+B,GACE,GAAIN,KAAK0X,GAAGvP,GAAI,CACdnI,KAAKmI,GAAKnI,KAAK0X,GAAGvP,E,KACb,CACLnI,KAAKmI,GAAKo2B,G,EAId,gBAAAh+B,GACE,IAAKP,KAAK+9B,KAAM,CACd/9B,KAAKw+B,gB,EAID,cAAAA,GAEN,MAAMC,EAAW,IACZz+B,KAAK89B,MAGV,GAAI99B,KAAKs9B,WAAa/zB,UAAW,CAC/Bk1B,EAAS,OAASz+B,KAAKs9B,Q,CAGzB,GAAIt9B,KAAKu9B,WAAah0B,UAAW,CAC/Bk1B,EAAS,OAASz+B,KAAKu9B,Q,CAGzBv9B,KAAK+9B,KAAOW,EAAM1+B,KAAKs+B,SAAUG,GAGjC,GAAIz+B,KAAKqX,MAAO,CACdrX,KAAK+9B,KAAK1mB,MAAQrX,KAAKqX,K,CAGzBrX,KAAK+9B,KAAKY,GAAG,UAAU,KACrB,MAAMC,EAAU5+B,KAAKs+B,SAASjnB,MAAMgU,SAAW,IAAMrrB,KAAK+9B,KAAKc,gBAAkB,GACjF,GAAID,EAAS,CACX5+B,KAAKqX,MAAQ,GACbrX,KAAK29B,WAAWh5B,KAAK,K,KAChB,CACL3E,KAAKqX,MAAQrX,KAAK+9B,KAAKc,cACvB7+B,KAAK29B,WAAWh5B,KAAK3E,KAAKqX,M,KAKxB,eAAAynB,CAAgBC,GACtB,OAAO/+B,KAAK0X,GAAGsnB,UAAUC,SAASF,E,CAG5B,aAAAG,CAAc7nB,GACpB,IAAKrX,KAAKk9B,aAAc,CACtB,M,CAEF,GAAIl9B,KAAKo9B,IAAK,CACZ,IACEp9B,KAAKo9B,IAAI9nB,MAAMtV,KAAKm9B,QAAU,CAAE,CAACn9B,KAAKm9B,SAAU9lB,GAAUA,GAC1DrX,KAAK6F,MAAQ,K,CACb,MAAOA,GACPnD,QAAQC,IAAIkD,GACZ7F,KAAK6F,MAAQ,I,GAKXs5B,kBAAoB,KAG1Bn/B,KAAKk/B,cAAcl/B,KAAKqX,MAAM,EAGxBiX,WAAa,KACnBtuB,KAAKk/B,cAAcl/B,KAAKqX,OAGxB,GAAIrX,KAAKqX,MAAO,CACd,MAAM+nB,EAAWjyB,WAAWnN,KAAKqX,OACjCrX,KAAKqX,MAAQ+nB,EAASC,QAAQ,GAG9B,GAAIr/B,KAAK+9B,KAAM,CACb/9B,KAAK+9B,KAAK1mB,MAAQrX,KAAKqX,K,EAK3BrX,KAAK49B,UAAUj5B,KAAK3E,KAAKqX,MAAM,EAGzBioB,YAAc,KAEpBt/B,KAAK69B,WAAWl5B,MAAM,EAGxB,MAAAmM,GACE,OACEW,EAAA,YAAAhQ,IAAA,2CAAUkQ,MAAO,GAAG3R,KAAKy9B,6DACtBz9B,KAAKiY,OACJxG,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAO,uBAAuB3R,KAAK09B,2BACtCjsB,EAAA,QAAAhQ,IAAA,2CACEkQ,MAAO,sCACH3R,KAAKi9B,6BACPj9B,KAAK8+B,gBAAgB,kBAAoB,iBAAmB,qBAC5D9+B,KAAK8+B,gBAAgB,kBAAoB,iBAAmB,qBAC5D9+B,KAAK8+B,gBAAgB,cAAgB,aAAe,sBACpD9+B,KAAK8+B,gBAAgB,cAAgB,aAAe,uBAGtDrtB,EAAA,SAAAhQ,IAAA,2CAAOkQ,MAAO,WAAY4tB,QAASv/B,KAAKmI,IACrCnI,KAAKiY,SAKdxG,EAAA,OAAAhQ,IAAA,2CAAKkQ,MAAM,wDACR3R,KAAK5C,UACJqU,EAAA,OAAAhQ,IAAA,4CACEgQ,EAAA,QAAAhQ,IAAA,2CAAMkQ,MAAO,oBAAoB3R,KAAKoD,SAAW,WAAa,qBAAqBpD,KAAK6F,MAAQ,QAAU,MAAM7F,KAAKiY,MAAQ,aAAe,MACzIjY,KAAK5C,WAIZqU,EAAA,SAAAhQ,IAAA,2CACEgW,IAAKC,GAAO1X,KAAKs+B,SAAW5mB,EAAG,cAClB1X,KAAKw9B,OAClBp6B,SAAUpD,KAAKoD,SACf+E,GAAInI,KAAKmI,GACTwJ,MAAO,oDACH3R,KAAKg9B,6BACLh9B,KAAK8+B,gBAAgB,oBAAsB,mBAAqB,sBAChE9+B,KAAK8+B,gBAAgB,oBAAsB,mBAAqB,sBAChE9+B,KAAK6F,MAAQ,QAAU,eAAe7F,KAAK5C,SAAW,aAAe,KACzEoiC,QAASx/B,KAAKm/B,kBACdM,OAAQz/B,KAAKsuB,WACboR,QAAS1/B,KAAKs/B,YACdv5B,KAAK,OACLqpB,YAAapvB,KAAKovB,YAClB2N,SAAU/8B,KAAK+8B,SAAQ,aACX/8B,KAAK0X,GAAGioB,WAAa,cAAa,mBAC5B3/B,KAAK0X,GAAGkoB,iBAAmB,iB,eChPzD,MAAMC,GAAkB,usDACxB,MAAAC,GAAeD,GCDf,MAAMtsB,GAAW,0pBACjB,MAAAwsB,GAAexsB,G,MCaFysB,GAAY,M,sFACfx6B,cACA6Y,WACA/gB,SACAoI,WACArB,OACAD,SACAjC,KACA89B,OACAl8B,aAECxG,aACA8d,aACA6kB,MAAe,GACflsB,UAAY,MACZmsB,eAAiB,MACjBC,UAA2B,KAC3BC,wBAAmC,MACnCC,mBAAqB,EACrBC,gBAAkB,EAClBrsB,MAA4C,CAAE7R,UAAW,IAAIoI,KAAQrI,QAAS,IAAIqI,MAElF+1B,sBAED3hC,eAAiB,IAAIC,EAE7B,iBAAAwB,GACEN,KAAKkU,MAAQ,CAAE7R,UAAW,IAAIoI,KAAKzK,KAAKoE,UAAWhC,QAAS,IAAIqI,KAAKzK,KAAKqE,SAC1ErE,KAAKygC,M,CAGP,gBAAAC,GACE,OAAO1gC,KAAKgU,WAAahU,KAAKkgC,MAAMt5B,MAAK0V,GAAQA,EAAKqkB,UAAY,KAAM3gC,KAAKogC,YAAc,GAAKpgC,KAAKogC,YAAc,I,CAErH,UAAMK,GACJ,IACE,MAAMp+B,UAAEA,GAAcrC,KAAK+D,aAC3B,GAAIxB,EAAOF,EAAW,cAAckC,SAAShC,EAAOvC,KAAKoE,SAAU,eAAgB,CACjFpE,KAAKkU,MAAM7R,UAAY,IAAIoI,KAAKpI,E,KAC3B,CACLrC,KAAKkU,MAAM7R,UAAY,IAAIoI,KAAKzK,KAAKoE,S,CAEvCpE,KAAKkU,MAAM9R,QAAU,IAAIqI,KAAKzK,KAAKqE,QACnCrE,KAAKzC,mBAAqByC,KAAKnB,eAAesH,kBAAkBnG,KAAKwF,cAAexF,KAAK1C,UACzF,GAAI0C,KAAKzC,aAAc,CACrB,MAAM8I,EAAgBrG,KAAKzC,aAAa+I,MAAMC,QAAOC,GAAQA,EAAKd,aAAe1F,KAAK0F,aACtF1F,KAAKqb,aAAehV,EAAc,GAClC,MAAM6U,EAAUlb,KAAKqb,cAAcU,KAAK/b,KAAKqb,aAAaU,KAAKrV,OAAS,GAExE,GAAInE,EAAOvC,KAAKqE,QAAQ7B,KAAK,EAAG,QAAQQ,OAAOT,EAAO2Y,EAAQ5E,OAAQ,CACpE5T,QAAQC,IAAI,SACZ,MAAMg+B,QAAe3gC,KAAK4gC,yBAAyB5gC,KAAKoE,SAAUpE,KAAKqb,aAAaU,KAAK,GAAGzF,KAAMtW,KAAKqb,aAAa6Y,SAAS/rB,IAC7H,MAAM04B,EAAcC,EAAa9gC,KAAKqb,aAAaU,KAAK,GAAGzF,KAAMtW,KAAKoE,UACtEpE,KAAKqgC,wBAA0B,KAE/BrgC,KAAKkgC,MAAQ,IACRW,EAAY/qB,KAAI+E,IAAG,CACpB8lB,OAAQA,EAASE,EAAYn6B,OAC7B4P,KAAMuE,EACNkmB,KAAM,YAEL/gC,KAAKqb,aAAaU,MAEvB/b,KAAKsgC,mBAAqBtgC,KAAKkgC,MAAMx5B,OAAS1G,KAAKqb,aAAaU,KAAKrV,M,KAChE,CACLhE,QAAQC,IAAI,SACZD,QAAQC,IAAIuY,GACZ,MAAMylB,QAAe3gC,KAAK4gC,yBAAyB5gC,KAAKzC,aAAa6E,QAASG,EAAOvC,KAAKqE,OAAQ,cAAc5B,OAAO,cAAezC,KAAKqb,aAAa6Y,SAAS/rB,IACjK,MAAM04B,EAAcC,EAAa5lB,EAAQ5E,KAAMtW,KAAKqE,QACpDrE,KAAKkgC,MAAQ,IACRlgC,KAAKqb,aAAaU,QAClB8kB,EAAY/qB,KAAI+E,IAAG,CACpB8lB,OAAQA,EAASE,EAAYn6B,OAC7B4P,KAAMuE,EACNkmB,KAAM,S,GAKd,MAAOl7B,GACPnD,QAAQC,IAAIkD,E,EAGR,WAAAm7B,CAAY3/B,EAAegV,GACjC,IAAI4qB,EAAa5/B,EACjB,IAAI0a,EAAO,IAAI/b,KAAKkgC,OACpBe,EAAaA,EAAWhyB,QAAQ,WAAY,IAC5C,GAAIgyB,IAAe,GAAI,CACrBllB,EAAK1F,GAAOsqB,QAAU,C,KACjB,CACL,IAAK3xB,MAAMnM,OAAOo+B,IAAc,CAC9BllB,EAAK1F,GAAOsqB,OAAS99B,OAAOo+B,E,EAGhCjhC,KAAKkgC,MAAQnkB,C,CAEf,8BAAM6kB,CAAyBv+B,EAAmBD,EAAiB8+B,GACjE,IACElhC,KAAKmgC,eAAiB,KACtB,MAAMgB,QAA4BnhC,KAAKnB,eAAeo0B,uBAAuB,CAC3E5wB,YACAD,UACAqnB,WAAYzpB,KAAKqe,WACjB6U,gBAAiB,CACfC,MAAOnzB,KAAKqb,aAAa6Y,SAASkN,mBAAmBC,UACrDjO,MAAOpzB,KAAKqb,aAAa6Y,SAASkN,mBAAmBE,WAEvDhkC,SAAU0C,KAAK1C,SACfF,SAAU4C,KAAKzC,aAAaH,SAC5Bi2B,cAAe,CAACrzB,KAAKqb,aAAa4Y,SAAS9rB,IAC3Co5B,cAAe,CAACL,KAElBx+B,QAAQC,IAAIw+B,EAAoB,GAAID,GACpClhC,KAAKogC,UAAYe,EAAoB,GAAGf,UACxC,MAAMoB,EAAYL,EAAoB,GAAGr8B,UAAUyX,MAAKD,GAAQA,EAAKnU,KAAO+4B,IAC5E,IAAKM,IAAcA,EAAUC,WAAY,CACvCzhC,KAAKogC,UAAY,KACjB,OAAO,I,CAET,MAAMgB,EAAgCI,EAAUC,YAAYllB,MAC1DmlB,GACEA,EAAUL,YAAcrhC,KAAKqb,aAAa6Y,SAASkN,mBAAmBC,WAAaK,EAAUJ,YAActhC,KAAKqb,aAAa6Y,SAASkN,mBAAmBE,YAE7J,IAAKF,EAAoB,CACvB,OAAO,I,CAET,OAAOA,EAAmBO,uB,CAC1B,MAAO97B,GACPnD,QAAQmD,MAAMA,E,SAEd7F,KAAKmgC,eAAiB,K,EAIlB,gBAAAyB,CAAiBvrB,EAAewrB,EAAyBhnB,GAC/D,OACEpJ,EAAA,OAAKE,MAAM,8DACTF,EAAA,kBACE4F,MAAOwD,EAAI8lB,OAAS,EAAI9lB,EAAI8lB,OAAOl3B,WAAa,GAChDrG,SAAUpD,KAAKogC,YAAc,GAAKpgC,KAAKogC,YAAc,KACrDhjC,SAAUykC,EAAe,aACd,OAAM,mBACA,YACjBxS,aAAclc,GAAKnT,KAAKghC,YAAY7tB,EAAE7R,OAAQ+U,K,CAM9C,mBAAAyrB,CAAoBD,EAAyBhnB,GACnD,OAAOpJ,EAAA,KAAGE,MAAM,sBAAsB,GAAGkwB,IAAkBh/B,OAAOgY,EAAI8lB,QAAQtB,QAAQ,K,CAEhF,gBAAA0C,CAAiB1rB,EAAewrB,EAAyBhnB,GAC/D,GAAI7a,KAAKqgC,wBAAyB,CAChC,GAAIhqB,EAAQrW,KAAKsgC,mBAAoB,CACnC,OAAOtgC,KAAK4hC,iBAAiBvrB,EAAOwrB,EAAiBhnB,E,KAChD,CACL,OAAO7a,KAAK8hC,oBAAoBD,EAAiBhnB,E,MAE9C,CACL,OAAOxE,EAAQrW,KAAKqb,aAAaU,KAAKrV,OAAS1G,KAAK8hC,oBAAoBD,EAAiBhnB,GAAO7a,KAAK4hC,iBAAiBvrB,EAAOwrB,EAAiBhnB,E,EAGlJ,WAAAmnB,GACE,MAAMH,EAAkB7hC,KAAKzC,aAAaH,SAASgV,OAEnD,OACEX,EAAA,OAAKE,MAAO,YACT3R,KAAKkgC,OAAOpqB,KAAI,CAAC+E,EAAKxE,IACrB5E,EAAA,OAAKE,MAAO,mCACVF,EAAA,KAAGE,MAAO,iBAAkBswB,EAAiBpnB,EAAIvE,OAChDtW,KAAK+hC,iBAAiB1rB,EAAOwrB,EAAiBhnB,M,CAMzD,4BAAMqnB,GACJ,IACEliC,KAAKgU,UAAY,KACjB,IAAIyf,EAAW,IAAIzzB,KAAKzC,aAAa+I,OACrC,IAAI67B,EAAoB1O,EAAS7c,WAAUpQ,GAAQA,EAAKd,aAAe1F,KAAK0F,aAC5E,GAAIy8B,KAAuB,EAAG,CAC5B,MAAM,IAAIx7B,MAAM,e,CAElB8sB,EAAS0O,GAAqB,IACzB1O,EAAS0O,GACZpmB,KAAM/b,KAAKkgC,MACX99B,QAASG,EAAOvC,KAAKkU,MAAM9R,SAASK,OAAO,cAC3CJ,UAAWE,EAAOvC,KAAKkU,MAAM7R,WAAWI,OAAO,eAEjD,MAAMy4B,EAAO,CACX/G,aAAc,KACdN,SAAU,KACVO,OAAQ,KACRxuB,UAAW,KACXkvB,YAAa90B,KAAKzC,aAAau3B,YAC/BsN,eAAgBpiC,KAAKzC,aAAa6kC,eAClC78B,QAAS,CACP2hB,YAAalnB,KAAKwF,cAClBnD,UAAWE,EAAOvC,KAAKkU,MAAM7R,WAAWI,OAAO,cAC/CL,QAASG,EAAOvC,KAAKkU,MAAM9R,SAASK,OAAO,cAC3CgyB,OAAQz0B,KAAKzC,aAAak3B,OAC1BtrB,SAAUnJ,KAAKzC,aAAa4L,SAC5BwrB,OAAQ30B,KAAKzC,aAAao3B,OAC1Bv3B,SAAU4C,KAAKzC,aAAaH,SAC5Bw3B,QAAS50B,KAAKzC,aAAaq3B,QAC3BC,MAAO70B,KAAKzC,aAAas3B,MACzBvuB,MAAOmtB,UAGLzzB,KAAKnB,eAAe20B,cAAc0H,GACxCl7B,KAAKwgC,sBAAsB77B,KAAK,CAAEoB,KAAM,UAAW5D,KAAMnC,KAAKmC,M,CAC9D,MAAO0D,G,SAEP7F,KAAKgU,UAAY,K,EAGrB,MAAAlD,GACE,IAAK9Q,KAAKzC,aAAc,CACtB,OACEkU,EAAA,OAAKE,MAAM,qBACTF,EAAA,0B,CAIN,OACEA,EAAA,OAAKE,MAAM,mBACTF,EAAA,YACEE,MAAM,mBACNsI,eAAgB,IAAMja,KAAKwgC,sBAAsB77B,KAAK,CAAEoB,KAAM,SAAU5D,KAAMnC,KAAKmC,OACnF8V,MAAO,GAAG9S,EAAQC,QAAQi9B,0BAA0BriC,KAAKqb,cAAc4Y,UAAUtc,SAAS3X,KAAKqb,cAAcwL,MAAelP,OAC5HuC,eAAe,YAEjBzI,EAAA,WAASE,MAAO,kCACdF,EAAA,KAAGE,MAAO,iBACP,GAAGxM,EAAQC,QAAQk9B,eAAc,IAAGtiC,KAAKwF,eAE3CxF,KAAKmgC,eACJ1uB,EAAA,KAAGE,MAAO,uBAAwBxM,EAAQC,QAAQ,kCAElDqM,EAACY,EAAQ,KACPZ,EAAA,KAAGE,MAAO,kCAAmC,GAAG4wB,EAAWhgC,EAAOvC,KAAKkU,MAAM7R,WAAWI,OAAO,cAAe,mBAAmB8/B,EAC/HhgC,EAAOvC,KAAKkU,MAAM9R,SAASK,OAAO,cAClC,iBAEFgP,EAAA,KAAGE,MAAO,sBACP,GAAG3R,KAAKqb,aAAa6Y,SAASvc,OAAM,IAAG3X,KAAKqb,aAAa6Y,SAAS0B,mBAAqBnkB,EAAA,QAAME,MAAO,eAAgBxM,EAAQC,QAAQywB,qBAErI71B,KAAKogC,YAAc,GAAKpgC,KAAKogC,YAAc,OAAS3uB,EAAA,KAAGE,MAAM,6BAA6BxM,EAAQC,QAAQo9B,uCAE3GxiC,KAAKqb,aAAa6Y,SAASlD,aAAevf,EAAA,KAAGE,MAAO,uBAAwB3R,KAAKqb,aAAa6Y,SAASlD,aACvGhxB,KAAKgiC,gBAIZvwB,EAAA,WAASE,MAAO,gBACdF,EAAA,aACE4H,UAAU,YACVopB,aAAcziC,KAAKgU,UACnBoD,KAAMjS,GAASC,QAAQgU,WACvBzH,MAAM,aACNqa,WAAW,yBACX1T,eAAgB,IAAMtY,KAAKwgC,sBAAsB77B,KAAK,CAAEoB,KAAM,SAAU5D,KAAMnC,KAAKmC,SAGpFnC,KAAKogC,UAAY,GAAKpgC,KAAKogC,YAAc,MACxC3uB,EAAA,aACEuC,UAAWhU,KAAKgU,UAChBoD,KAAMjS,GAASC,QAAQkU,YACvBmpB,aAAcziC,KAAK0gC,mBACnB/uB,MAAM,aACNqa,WAAW,yBACX1T,eAAgBtY,KAAKkiC,uBAAuBhiC,KAAKF,S,kBC/R/D,MAAM0iC,GAAqB,4JAC3B,MAAAC,GAAeD,G,MCQFE,GAAe,M,wEAKlBC,gBAAkB,KAMlBC,gBAAkB,IAKlBC,UAAY,KAKoBC,OAAS,KAKPC,eAEzBC,MAAqB,UAE9BC,aACAC,aAER,iBAAA9iC,GACE,GAAIN,KAAK+iC,WAAa/iC,KAAKgjC,OAAQ,CACjChjC,KAAKqjC,Y,EAIT,oBAAAniC,GACElB,KAAKsjC,a,CAIG,cAAAC,CAAe7wB,GACvB,GAAIA,EAAU,CACZ,GAAI1S,KAAK+iC,UAAW,CAClB/iC,KAAKqjC,Y,MAEF,CACLrjC,KAAKwjC,Y,EAMC,gBAAAC,GACR,GAAIzjC,KAAKgjC,QAAUhjC,KAAK+iC,UAAW,CACjC/iC,KAAKqjC,Y,EAID,UAAAA,GACNrjC,KAAKsjC,cACLtjC,KAAKkjC,MAAQ,UACb,MAAMQ,EAAen1B,KAAKE,IAAI,EAAG5L,OAAO7C,KAAK6iC,kBAAoB,GACjE,GAAIa,IAAiB,EAAG,CACtB1jC,KAAK2jC,cACL,M,CAEF3jC,KAAKmjC,aAAezzB,OAAOhP,YAAW,IAAMV,KAAK2jC,eAAeD,E,CAG1D,WAAAC,GACN3jC,KAAKkjC,MAAQ,UACb,MAAMU,EAAer1B,KAAKE,IAAI,EAAG5L,OAAO7C,KAAK8iC,kBAAoB,GACjE,GAAIc,IAAiB,EAAG,CACtB5jC,KAAK6jC,mBACL,M,CAEF7jC,KAAKojC,aAAe1zB,OAAOhP,YAAW,IAAMV,KAAK6jC,oBAAoBD,E,CAG/D,gBAAAC,GACN7jC,KAAKijC,eAAet+B,OACpB3E,KAAKgjC,OAAS,K,CAGR,UAAAQ,GACNxjC,KAAKsjC,cACLtjC,KAAKkjC,MAAQ,S,CAGP,WAAAI,GACN,GAAItjC,KAAKmjC,aAAc,CACrB3V,aAAaxtB,KAAKmjC,cAClBnjC,KAAKmjC,aAAe55B,S,CAEtB,GAAIvJ,KAAKojC,aAAc,CACrB5V,aAAaxtB,KAAKojC,cAClBpjC,KAAKojC,aAAe75B,S,EAIxB,MAAAuH,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,4CACFzB,KAAKkjC,QAAU,UACdzxB,EAAA,OAAKqyB,KAAK,UAAU/5B,MAAM,KAAK8C,OAAO,KAAKkZ,QAAQ,YAAYD,MAAM,8BACnErU,EAAA,QACEoF,EAAE,6JACFlF,MAAM,aAIVF,EAAA,YAAUqyB,KAAK,QAAQnsB,KAAK,QAAQ9N,MAAO,CAAE4B,MAAO,a,iJC5H9D,MAAMs4B,GAAY,qvBAClB,MAAAC,GAAeD,G,MCQFE,GAAM,M,wFAQTpqB,KAAc,GAOdqqB,WAOA9gC,SAAoB,MAOpBu8B,UAAoB,OAEnBwE,aAOAC,WAEDC,gBACAvkC,iBAER,iBAAAQ,GACE,MAAMgkC,EAAMtkC,KAAK6Z,MAAM0C,MAAKgoB,GAAKA,EAAEp8B,KAAOnI,KAAKkkC,aAC/C,GAAII,EAAK,CACPtkC,KAAKwkC,UAAUF,E,MACV,GAAItkC,KAAK6Z,MAAMnT,OAAS,EAAG,CAEhC1G,KAAKwkC,UAAUxkC,KAAK6Z,KAAK,G,EAQ7B,oBAAA3Y,GACE,GAAIlB,KAAKF,iBAAkB,CACzBqB,qBAAqBnB,KAAKF,iB,EAItB,qBAAA2kC,GAcN,GAAIzkC,KAAKF,iBAAkB,CACzBqB,qBAAqBnB,KAAKF,iB,CAE5BmC,uBAAsB,KACpB,MAAM2X,EAAc5Z,KAAK0X,GAAGhL,cAAc,+BAC1C,GAAIkN,EAAa,CACf,MAAM9P,KAAEA,EAAIC,MAAEA,GAAU6P,EAAY9M,wBACpC,MAAM43B,EAAa1kC,KAAK0X,GAAG5K,wBAAwBhD,KACnD,MAAM3L,EAAW2L,EAAO46B,EAAa1kC,KAAK2kC,QAC1C3kC,KAAKqkC,gBAAgBx6B,MAAME,MAAQ,GAAGA,EAAQ/J,KAAK2kC,YACnD3kC,KAAKqkC,gBAAgBx6B,MAAMgG,UAAY,cAAc1R,M,KAInDwmC,QAAU,MAChB,MAAMC,EAAWC,iBAAiBp4B,SAASq4B,iBAAiBF,SAC5D,OAAOz3B,WAAWy3B,EACnB,EAHiB,GAIV,SAAAJ,CAAUF,GAChB,GAAItkC,KAAKoD,SAAU,OAEnBpD,KAAKmkC,aAAeG,EACpBtkC,KAAKykC,wBACLzkC,KAAKokC,WAAWz/B,KAAK2/B,E,CAGf,aAAAS,CAAc1jC,EAAsB2jC,GAC1C,GAAIhlC,KAAKoD,SAAU,OAEnB,MAAMorB,EAAexuB,KAAK6Z,KAAKjD,WAAU2tB,GAAKA,EAAEp8B,KAAO68B,EAAW78B,KAClE,IAAI88B,EAAYzW,EAEhB,OAAQntB,EAAMI,KACZ,IAAK,aACHJ,EAAMiM,iBACN23B,GAAazW,EAAe,GAAKxuB,KAAK6Z,KAAKnT,OAC3C,MACF,IAAK,YACHrF,EAAMiM,iBACN23B,EAAYzW,IAAiB,EAAIxuB,KAAK6Z,KAAKnT,OAAS,EAAI8nB,EAAe,EACvE,MACF,IAAK,OACHntB,EAAMiM,iBACN23B,EAAY,EACZ,MACF,IAAK,MACH5jC,EAAMiM,iBACN23B,EAAYjlC,KAAK6Z,KAAKnT,OAAS,EAC/B,MACF,IAAK,QACL,IAAK,IACHrF,EAAMiM,iBACNtN,KAAKwkC,UAAUQ,GACf,OACF,QACE,OAGJ,MAAME,EAAUllC,KAAK6Z,KAAKorB,GAC1B,GAAIC,EAAS,CACXllC,KAAKwkC,UAAUU,GACfjjC,uBAAsB,KACpB,MAAMkjC,EAAYnlC,KAAK0X,GAAGhL,cAAc,2BAA2Bw4B,EAAQ/8B,QAC3E,GAAIg9B,EAAW,CACbA,EAAU9T,O,MAMlB,MAAAvgB,GACE,OACEW,EAACC,EAAI,CAAAjQ,IAAA,2CAACpB,KAAK,UAAS,aAAaL,KAAK2/B,UAAS,mBAAmB,cAC/D3/B,KAAK6Z,KAAK/D,KAAIwuB,GACb7yB,EAAA,UACEE,MAAM,MACNlQ,IAAK6iC,EAAIn8B,GACTpC,KAAK,SAAQ,cACAu+B,EAAIn8B,GACjB9H,KAAK,MACL+kC,SAAUplC,KAAKmkC,cAAch8B,KAAOm8B,EAAIn8B,GAAK,GAAK,EAAC,gBACpCnI,KAAKmkC,cAAch8B,KAAOm8B,EAAIn8B,GAAK,OAAS,QAAO,gBACnD,YAAYm8B,EAAIn8B,KAC/BA,GAAI,OAAOm8B,EAAIn8B,KACf/E,SAAUpD,KAAKoD,SAAQ,aACXpD,KAAKmkC,cAAch8B,KAAOm8B,EAAIn8B,GAAK,WAAaoB,UAC5Dkc,QAAS,IAAMzlB,KAAKwkC,UAAUF,GAC9Be,UAAWhkC,GAASrB,KAAK+kC,cAAc1jC,EAAOijC,IAE7CA,EAAIrsB,SAGTxG,EAAA,QAAAhQ,IAAA,2CAAMkQ,MAAM,mBAAmB8F,IAAKC,GAAO1X,KAAKqkC,gBAAkB3sB,I","ignoreList":[]}