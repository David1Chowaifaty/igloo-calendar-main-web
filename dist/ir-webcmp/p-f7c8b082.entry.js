import{r as t,h as e,H as i}from"./p-acddcbeb.js";import{T as r}from"./p-f8b7c0cd.js";import{d as s}from"./p-67f1b13b.js";import{R as a}from"./p-ac9c6afc.js";import{B as o}from"./p-bcfb97b4.js";import"./p-bf44a732.js";import"./p-2925ded6.js";import"./p-15acbbbe.js";import"./p-6c4ba7c0.js";import"./p-d6d6fb27.js";import"./p-e58470d9.js";import"./p-bfb03024.js";import"./p-ea7580c2.js";const n=".sc-ir-departures-h{box-sizing:border-box !important}.sc-ir-departures-h *.sc-ir-departures,.sc-ir-departures-h *.sc-ir-departures::before,.sc-ir-departures-h *.sc-ir-departures::after{box-sizing:inherit !important;padding:0;margin:0}[hidden].sc-ir-departures{display:none !important}";const p=n;const h=".sc-ir-departures-h{display:flex;flex-direction:column;gap:var(--wa-space-l, 1.5rem);min-height:100vh}.page-title.sc-ir-departures{font-family:var(--wa-font-family-heading);font-weight:var(--wa-font-weight-heading);line-height:var(--wa-line-height-condensed);text-wrap:balance;font-size:var(--wa-font-size-xl)}";const d=h;const l=class{constructor(e){t(this,e)}ticket;propertyid;language="en";p;bookingNumber;booking;paymentEntries;isPageLoading;payment;tokenService=new r;roomService=new a;bookingService=new o;paymentFolioRef;componentWillLoad(){if(this.ticket){this.tokenService.setToken(this.ticket);this.init()}}handleTicketChange(t,e){if(t!==e&&t){this.tokenService.setToken(this.ticket);this.init()}}handleOpen(t){this.bookingNumber=t.detail}handleBookingPayment(t){t.stopImmediatePropagation();t.stopPropagation();const{booking_nbr:e,payment:i}=t.detail;this.booking=s.bookings.find((t=>t.booking_nbr===e));const r=this.paymentEntries.types.find((t=>t.CODE_NAME===i.payment_type.code));this.payment={...i,payment_type:{code:r.CODE_NAME,description:r.CODE_VALUE_EN,operation:r.NOTES}};this.paymentFolioRef.openFolio()}async init(){try{this.isPageLoading=true;const[t,e,i]=await Promise.all([this.roomService.getExposedProperty({id:this.propertyid||0,language:this.language,aname:this.p}),this.roomService.fetchLanguage(this.language),this.bookingService.getSetupEntriesByTableNameMulti(["_BED_PREFERENCE_TYPE","_DEPARTURE_TIME","_PAY_TYPE","_PAY_TYPE_GROUP","_PAY_METHOD"])]);const{pay_type:r,pay_type_group:s,pay_method:a}=this.bookingService.groupEntryTablesResult(i);this.paymentEntries={types:r,groups:s,methods:a}}catch(t){}finally{this.isPageLoading=false}}render(){if(this.isPageLoading){return e("ir-loading-screen",null)}return e(i,null,e("ir-toast",{style:{display:"none"}}),e("ir-interceptor",{style:{display:"none"}}),e("h3",{class:"page-title"},"Departures"),e("ir-departures-filter",null),e("ir-departures-table",null),e("ir-drawer",{onDrawerHide:t=>{t.stopImmediatePropagation();t.stopPropagation();this.bookingNumber=null},withoutHeader:true,open:!!this.bookingNumber,style:{"--ir-drawer-width":"80rem","--ir-drawer-background-color":"#F2F3F8","--ir-drawer-padding-left":"0","--ir-drawer-padding-right":"0","--ir-drawer-padding-top":"0","--ir-drawer-padding-bottom":"0"}},this.bookingNumber&&e("ir-booking-details",{hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:()=>this.bookingNumber=null,is_from_front_desk:true,propertyid:this.propertyid,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.bookingNumber.toString(),ticket:this.ticket,language:this.language,hasRoomAdd:true})),e("ir-payment-folio",{style:{height:"auto"},bookingNumber:this.booking?.booking_nbr,paymentEntries:this.paymentEntries,payment:this.payment,mode:"payment-action",ref:t=>this.paymentFolioRef=t,onCloseModal:()=>{this.booking=null;this.payment=null}}))}static get watchers(){return{ticket:["handleTicketChange"]}}};l.style=p+d;export{l as ir_departures};
//# sourceMappingURL=p-f7c8b082.entry.js.map