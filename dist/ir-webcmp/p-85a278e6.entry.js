import{r as t,c as e,h as i,F as s}from"./p-d239357b.js";import{B as n}from"./p-eda18d5e.js";import{R as r}from"./p-34b319c3.js";import{l as o}from"./p-4e493fea.js";import{T as a}from"./p-f8b7c0cd.js";import{i as c}from"./p-6fec77c0.js";import"./p-bf44a732.js";import"./p-e7d273da.js";import"./p-e1644f24.js";import"./p-6c4ba7c0.js";import"./p-99cb260a.js";import"./p-c5894a47.js";import"./p-94f15b90.js";const l=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}.loading-container.sc-ir-guest-info{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}";const h=l;const u=".sc-ir-guest-info-h{height:100%}.sheet-container.sc-ir-guest-info{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-guest-info{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-guest-info{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-guest-info{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-guest-info{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-guest-info{flex-direction:row;align-items:center}}";const d=u;const p=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.resetBookingEvt=e(this,"resetBookingEvt",7);this.toast=e(this,"toast",7)}language;headerShown;email;booking_nbr;ticket;isInSideBar;countries;guest=null;isLoading=true;autoValidate=false;closeSideBar;resetBookingEvt;toast;bookingService=new n;roomService=new r;token=new a;async componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}if(!!this.token.getToken())this.init()}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.init()}async init(){try{console.log("first");this.isLoading=true;const[t,e,i]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language),!o||!o.entries||Object.keys(o.entries).length===0?this.roomService.fetchLanguage(this.language):Promise.resolve(null)]);if(i){o.entries=i.entries;o.direction=i.direction}this.countries=e;this.guest={...t,mobile:t.mobile_without_prefix}}catch(t){console.log(t)}finally{this.isLoading=false}}handleInputChange(t){this.guest={...this.guest,...t}}async editGuest(){try{this.autoValidate=true;await this.bookingService.editExposedGuest(this.guest,this.booking_nbr??null);this.toast.emit({type:"success",description:"",title:"Saved Successfully",position:"top-right"});this.closeSideBar.emit(null);this.resetBookingEvt.emit(null)}catch(t){console.log(t)}}render(){if(this.isLoading&&this.isInSideBar){i("div",{class:"loading-container"},i("ir-spinner",null))}if(this.isLoading){return null}return i("form",{class:"p-0 sheet-container",onSubmit:async t=>{t.preventDefault();await this.editGuest()}},!this.isInSideBar&&[i("ir-toast",null),i("ir-interceptor",null)],this.headerShown&&i("ir-title",{class:"px-1 sheet-header",displayContext:"sidebar",label:o.entries.Lcz_GuestDetails}),i("div",{class:this.isInSideBar?"sheet-body":"card-content collapse show "},i("div",{class:this.headerShown?"card-body px-1 pt-0":"pt-0"},i("ir-input-text",{autoValidate:this.autoValidate,label:o.entries?.Lcz_FirstName,name:"firstName",value:this.guest?.first_name,required:true,onTextChange:t=>this.handleInputChange({first_name:t.detail})}),i("ir-input-text",{autoValidate:this.autoValidate,label:o.entries?.Lcz_LastName,name:"lastName",value:this.guest?.last_name,required:true,onTextChange:t=>this.handleInputChange({last_name:t.detail})}),i("ir-input-text",{label:o.entries?.Lcz_Email,name:"email",value:this.guest?.email,required:true,onTextChange:t=>this.handleInputChange({email:t.detail})}),i("ir-input-text",{label:o.entries?.Lcz_AlternativeEmail,name:"altEmail",value:this.guest?.alternative_email,onTextChange:t=>this.handleInputChange({alternative_email:t.detail})}),i("ir-country-picker",{country:this.countries.find((t=>t.id===this.guest.country_id)),label:o.entries?.Lcz_Country,onCountryChange:t=>this.handleInputChange({country_id:t.detail.id}),countries:this.countries}),i("ir-phone-input",{onTextChange:t=>{t.stopImmediatePropagation();t.stopPropagation();const{mobile:e,phone_prefix:i}=t.detail;if(e!==this.guest.mobile){this.handleInputChange({mobile:e})}if(i!==this.guest.country_phone_prefix)this.handleInputChange({country_phone_prefix:i})},phone_prefix:this.guest.country_phone_prefix,value:this.guest.mobile,language:this.language,label:o.entries?.Lcz_MobilePhone,countries:this.countries}),i("div",{class:"mb-2"},i("ir-textarea",{variant:"prepend",onTextChange:t=>this.handleInputChange({notes:t.detail}),value:this.guest?.notes,label:o.entries?.Lcz_PrivateNote})),i("div",{class:"p-0 m-0"},i("label",{class:`check-container m-0 p-0`},i("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange({subscribe_to_news_letter:t.target.checked})}),i("span",{class:"checkmark m-0 p-0"}),i("span",{class:"m-0 p-0  check-label"},o.entries.Lcz_Newsletter)),!this.isInSideBar&&i(s,null,i("hr",null),i("ir-button",{btn_styles:"d-flex align-items-center justify-content-center",text:o.entries.Lcz_Save,onClickHandler:this.editGuest.bind(this),isLoading:c("/Edit_Exposed_Guest"),color:"btn-primary"}))))),this.isInSideBar&&i("div",{class:"sheet-footer"},i("ir-button",{"data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill m-0 p-0",btn_styles:"w-100 m-0  justify-content-center align-items-center",btn_color:"secondary",text:o.entries.Lcz_Cancel}),i("ir-button",{"data-testid":"save",isLoading:c("/Edit_Exposed_Guest"),btn_disabled:this.isLoading,class:"flex-fill m-0",btn_type:"submit",btn_styles:"w-100 m-0  justify-content-center align-items-center",text:o.entries.Lcz_Save})))}static get watchers(){return{ticket:["ticketChanged"]}}};p.style=h+d;export{p as ir_guest_info};
//# sourceMappingURL=p-85a278e6.entry.js.map