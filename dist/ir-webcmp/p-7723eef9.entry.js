import{r as e,c as t,h as i,F as a,H as o}from"./p-d239357b.js";import{l as s}from"./p-4e493fea.js";import{c as r}from"./p-99cb260a.js";import{h as n}from"./p-6c4ba7c0.js";import{i as l}from"./p-6fec77c0.js";import{B as d,b as c,s as h,m as p,f as b}from"./p-ae6a57a8.js";import{z as f}from"./p-748cfd41.js";import{j as u,A as m}from"./p-ae2f332f.js";import{I as y}from"./p-518eace5.js";import{B as g}from"./p-990efbf2.js";import{v as k}from"./p-4ed69de7.js";import"./p-c5894a47.js";import"./p-bf44a732.js";import"./p-8af1cf5e.js";const v=".sc-igl-book-property-footer-h{width:100% !important;background:#000}";const D=v;const _=class{constructor(i){e(this,i);this.buttonClicked=t(this,"buttonClicked",7)}eventType;page;isEditOrAddRoomEvent;dateRangeData;isLoading;buttonClicked;isEventType(e){return e===this.eventType}editNext(e){if(this.isEventType("EDIT_BOOKING")){if(e==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton({label:e,type:t="button",disabled:a=false,isLoading:o,appearance:s,variant:r,value:n,form:l}){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("ir-custom-button",{type:t,form:l,size:"medium",loading:o,appearance:s,variant:r,disabled:a,onClickHandler:()=>{this.buttonClicked.emit({key:n})},class:"full-width"},e))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){if(this.page==="page_one"){return i(o,null,this.isEventType("EDIT_BOOKING")?i(a,null,this.renderButton({value:"cancel",label:s.entries.Lcz_Cancel,appearance:"filled",variant:"neutral"}),this.shouldRenderTwoButtons()&&this.renderButton({value:"next",label:`${s.entries.Lcz_Next}`,icon_name:"angles_right",variant:"brand",appearance:"accent"})):i(a,null,this.renderButton({value:"cancel",label:s.entries.Lcz_Cancel,appearance:"filled",variant:"neutral"}),this.shouldRenderTwoButtons()&&this.renderButton({value:"next",label:`${s.entries.Lcz_Next}`,icon_name:"angles_right",variant:"brand",appearance:"accent"})))}const e=r.checkin_enabled&&n(new Date(this.dateRangeData?.fromDate)).isSame(new Date,"day");return i(a,null,this.isEditOrAddRoomEvent?i(a,null,this.renderButton({value:"back",icon_position:"left",label:s.entries.Lcz_Back,icon_name:"angles_left",appearance:"filled",variant:"neutral"}),this.renderButton({value:"save",label:s.entries.Lcz_Save,isLoading:this.isLoading==="save",variant:"brand",appearance:"accent"})):i(a,null,this.renderButton({value:"back",icon_position:"left",label:s.entries.Lcz_Back,icon_name:"angles_left",appearance:"filled",variant:"neutral"}),this.renderButton({value:"book",type:"submit",form:"new_booking_form",label:s.entries.Lcz_Book,isLoading:this.isLoading==="book",variant:"brand",appearance:e?"outlined":"accent"}),e&&this.renderButton({type:"submit",form:"new_booking_form",value:"bookAndCheckIn",label:s.entries.Lcz_BookAndChekcIn,isLoading:this.isLoading==="bookAndCheckIn",variant:"brand",appearance:"accent"})))}};_.style=D;const x=".sc-igl-book-property-header-h{display:flex;flex-direction:column;text-align:start;gap:1rem}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}.fd-book-property__constraints-container.sc-igl-book-property-header,.fd-book-property__header-container.sc-igl-book-property-header{display:flex;flex-direction:column;gap:0.5rem;flex-wrap:wrap}@media (min-width: 768px){.fd-book-property__constraints-container.sc-igl-book-property-header,.fd-book-property__header-container.sc-igl-book-property-header{flex-direction:row;align-items:center}.fd-book-property__adults-select.sc-igl-book-property-header{width:100px}.fd-book-property__children-select.sc-igl-book-property-header{width:170px}}";const w=x;const B=class{constructor(i){e(this,i);this.splitBookingDropDownChange=t(this,"splitBookingDropDownChange",7);this.checkClicked=t(this,"checkClicked",7);this.buttonClicked=t(this,"buttonClicked",7);this.toast=t(this,"toast",7);this.spiltBookingSelected=t(this,"spiltBookingSelected",7);this.animateIrSelect=t(this,"animateIrSelect",7)}splitBookingId="";bookingData="";minDate;message;bookingDataDefaultDateRange;showSplitBookingOption=false;adultChildConstraints;splitBookings;dateRangeData;bookedByInfoData;defaultDaterange;propertyId;wasBlockedUnit;isLoading;bookings=[];splitBookingDropDownChange;checkClicked;buttonClicked;toast;spiltBookingSelected;animateIrSelect;autoValidate;bookingService=new d;adultAnimationContainer;async fetchExposedBookings(e){this.isLoading=true;this.bookings=await this.bookingService.fetchExposedBookings(e,this.propertyId,n(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),n(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"));this.isLoading=false}getSplitBookingList(){return i("ir-picker",{mode:"select-async",class:"sourceContainer",debounce:300,"onText-change":e=>{this.fetchExposedBookings(e.detail)},defaultValue:Object.keys(this.bookedByInfoData).length>1?this.bookedByInfoData.bookingNumber?.toString():"",value:Object.keys(this.bookedByInfoData).length>1?this.bookedByInfoData.bookingNumber?.toString():"",label:`${s.entries.Lcz_Tobooking}#`,placeholder:s.entries.Lcz_BookingNumber,loading:this.isLoading,"onCombobox-select":e=>{const t=this.bookings?.find((t=>t.booking_nbr?.toString()===e.detail.item.value));this.spiltBookingSelected.emit({key:"select",data:t})}},this.bookings?.map((e=>{const t=`${e.booking_nbr} ${e.guest.first_name} ${e.guest.last_name}`;return i("ir-picker-item",{value:e.booking_nbr?.toString(),label:t},t)})))}getSourceNode(){const{sources:e}=c.selects;return i("wa-select",{size:"small",placeholder:s.entries.Lcz_Source,value:c.bookingDraft.source?.id?.toString(),defaultValue:c.bookingDraft.source?.id,id:"xSmallSelect","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:t=>{h({source:e.find((e=>e.id===t.target.value))})}},e.map((e=>{if(e.type==="LABEL"){return i("small",null,e.description)}return i("wa-option",{value:e.id?.toString()},e.description)})))}getAdultChildConstraints(){const{adults:e,children:t}=c.bookingDraft.occupancy;return i(a,null,i("ir-validator",{value:e,schema:f.number().min(1),autovalidate:this.autoValidate},i("wa-select",{class:"fd-book-property__adults-select","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:e=>{h({occupancy:{children:t,adults:Number(e.target.value)}})},value:e?.toString(),defaultValue:e?.toString(),placeholder:s.entries.Lcz_AdultsCaption,size:"small"},Array.from(Array(this.adultChildConstraints.adult_max_nbr),((e,t)=>t+1)).map((e=>i("wa-option",{value:e?.toString()},e))))),this.adultChildConstraints.child_max_nbr>0&&i("wa-select",{class:"fd-book-property__children-select","onwa-hide":e=>{e.stopImmediatePropagation();e.stopPropagation()},onchange:t=>h({occupancy:{adults:e,children:Number(t.target.value)}}),defaultValue:t?.toString(),value:t?.toString(),placeholder:this.renderChildCaption(),size:"small"},Array.from(Array(this.adultChildConstraints.child_max_nbr),((e,t)=>t+1)).map((e=>i("wa-option",{value:e?.toString()},e)))))}renderChildCaption(){const e=this.adultChildConstraints.child_max_age;let t=s.entries.Lcz_Years;if(e===1){t=s.entries.Lcz_Year}return`${s.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${t}`}handleButtonClicked(){const{occupancy:e}=c.bookingDraft;if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:s.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=n(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const i=n(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const a=n(new Date(this.dateRangeData.fromDate));const o=n(new Date(this.dateRangeData.toDate));if(o.isBefore(i)||a.isAfter(t)){this.toast.emit({type:"error",title:`${s.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",n(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",n(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(Number(e.adults)===0){this.toast.emit({type:"error",title:s.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.autoValidate=true}else{this.buttonClicked.emit({key:"check"})}}else if(Number(e.adults)===0){this.autoValidate=true;this.toast.emit({type:"error",title:s.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(e){return this.bookingData.event_type===e}getMinDate(){if(this.isEventType("PLUS_BOOKING")){return n().add(-1,"months").startOf("month").format("YYYY-MM-DD")}if(this.wasBlockedUnit){return this.bookingData?.block_exposed_unit_props.from_date}return this.minDate}getMaxDate(){if(!this.bookingData?.block_exposed_unit_props){return undefined}return this.bookingData?.block_exposed_unit_props.to_date}render(){console.log(this.bookingData.event_type);const e=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return i(o,{key:"6d61918e2525cc33b832a27363a22d9b1a2293c8"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),i("div",{key:"45307a5dbafd62cbefc30289306abb014999d7b0",class:`fd-book-property__header-container`},e&&this.getSourceNode(),i("igl-date-range",{key:"aae4f59462addd19f46bf8ef0744974994a51260","data-testid":"date_picker",variant:"booking",dateLabel:s.entries.Lcz_Dates,maxDate:this.getMaxDate(),minDate:this.getMinDate(),disabled:this.isEventType("BAR_BOOKING")&&!this.wasBlockedUnit||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange}),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints(),i("ir-custom-button",{key:"4808b3a216db83f9e88b27ca1d6abfb1029c960f",loading:l("/Check_Availability"),variant:"brand",onClickHandler:()=>this.handleButtonClicked()},s.entries.Lcz_Check)),i("p",{key:"fb39d7245190dcb3e8f9ac05feecf9f29d8e5033",class:"text-right message-label"},r.tax_statement))}};B.style=w;const I=".sc-igl-booking-form-h{display:flex;flex-direction:column}";const C=I;const O=class{constructor(i){e(this,i);this.dataUpdateEvent=t(this,"dataUpdateEvent",7);this.buttonClicked=t(this,"buttonClicked",7)}showPaymentDetails;currency;isEditOrAddRoomEvent;dateRangeData;bookingData;showSplitBookingOption;language;bookedByInfoData;propertyId;bedPreferenceType;selectedRooms;isLoading;countries;selectedGuestData;defaultGuestData;selectedBookedByData;guestData;selectedUnits={};dataUpdateEvent;buttonClicked;componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let e=0;const t={...this.selectedUnits};const i=(e,t,i,a)=>{if(i&&a===2){return e*t}return e};this.selectedUnits=t;this.guestData=[];this.selectedRooms.forEach(((a,o)=>{a.forEach((a=>{t[o]=a.selectedUnits;e+=a.totalRooms*i(a.rate,this.dateRangeData.dateDifference,a.isRateModified,a.rateType);for(let e=1;e<=a.totalRooms;e++){this.guestData.push({guestName:"",roomId:"",preference:"",...a})}}))}));this.bookingData.TOTAL_PRICE=e}handleOnApplicationInfoDataUpdateEvent(e,t){const i=e.detail;const a=`c_${i.data.roomCategoryId}`;const o=[...this.selectedUnits[a]||[]];o[t]=i.data.roomId;this.selectedUnits={...this.selectedUnits,[a]:o};this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:e.detail})}handleEventData(e,t,i){if(t==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(e,i)}else{this.selectedBookedByData=e.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:e.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const e of this.selectedGuestData){if(e.guestName===""||e.preference===""||e.roomId===""){return true}}return false}isButtonDisabled(e){const t=(e,t,i)=>{if(!e){return true}if(e===this.selectedGuestData){return this.isGuestDataIncomplete()}if(t==="selectedArrivalTime"){if(e[t]!==undefined){return e[t].code===""}else{return true}}return e[t]===i||e[t]===undefined};return this.isLoading===e||t(this.selectedGuestData,"guestName","")||t(this.selectedBookedByData,"isdCode","")||t(this.selectedBookedByData,"contactNumber","")||t(this.selectedBookedByData,"firstName","")||t(this.selectedBookedByData,"lastName","")||t(this.selectedBookedByData,"countryId",-1)||t(this.selectedBookedByData,"selectedArrivalTime","")||t(this.selectedBookedByData,"email","")}render(){return i("form",{key:"59dcae848f450ec4c043bdb3f716f23cd4a340a9",class:"d-flex flex-column h-100",id:"new_booking_form",autoComplete:"off",onSubmit:e=>{e.preventDefault()}},i("div",{key:"0e44c344a49e1279392db32375f03dbd668c9026",class:"d-flex flex-wrap"},i("ir-date-view",{key:"d0bf7a01f758dfd6f41891d34866208a1178ec7a",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{key:"00a5d256f40cee5e5484f183e8e58f66a4571fb1",class:"mt-1 mt-md-0 text-right"},s.entries.Lcz_TotalPrice," ",i("span",{key:"d20db19291820296233a9c517d20228a6071cb69",class:"font-weight-bold font-medium-1"},u(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(c.ratePlanSelections).map((e=>Object.values(e).map((e=>{const t=e;if(t.reserved===0){return null}return[...new Array(t.reserved)].map(((e,a)=>i("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:t.guest?t.guest[a]:null,bookingType:this.bookingData.event_type,rateplanSelection:t,key:`${t.ratePlan.id}_${a}`,roomIndex:a,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countries:this.countries,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:e=>{this.handleEventData(e,"propertyBookedBy",0)}}))}};O.style=C;const Y=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const M=Y;const N=class{constructor(i){e(this,i);this.roomsDataUpdate=t(this,"roomsDataUpdate",7)}bookingData;propertyId;message;showSplitBookingOption;eventType;currency;adultChildConstraints;ratePricingMode;dateRangeData;defaultDaterange;selectedRooms;bookedByInfoData;initialRoomIds;wasBlockedUnit;roomsDataUpdate;getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(e){return e===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return n().format("YYYY-MM-DD")}const e=n(this.bookingData.FROM_DATE,"YYYY-MM-DD");const t=n();if(e.isAfter(t)){return t.add(-2,"weeks").format("YYYY-MM-DD")}return e.add(-2,"weeks").format("YYYY-MM-DD")}render(){return i(o,{key:"e64e8b54b3c69c6e195083fe36fed933b7302167"},i("igl-book-property-header",{key:"c0260549b00ee5283eddea3e6e0bd22f0c49b0c3",wasBlockedUnit:this.wasBlockedUnit,bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"0046b56cf0d750db35409c8044fa7907920f9800",class:" text-left"},l("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(a,null,c.roomTypes?.map((e=>i("igl-room-type",{isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-type-${e.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,bookingType:this.bookingData.event_type,roomType:e,class:"mt-2 mb-1 p-0","data-testid":`room_type_${e.id}`,id:e.id.toString(),roomTypeId:this.selectedRooms.has(`c_${e.id}`)?e.id:null}))))))}};N.style=M;const T=".sc-igl-property-booked-by-h{display:block}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.row.sc-igl-booking-form.sc-igl-property-booked-by{padding:0 !important}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.property-booked-by__money-transfer-description.sc-igl-property-booked-by *.sc-igl-property-booked-by{margin:0 !important;margin-bottom:0 !important;margin-top:0 !important}.property-booked-by__money-transfer-description.sc-igl-property-booked-by,.property-booked-by__money-transfer-description.sc-igl-property-booked-by .sc-igl-property-booked-by:where(*,*.sc-igl-property-booked-by::before,*.sc-igl-property-booked-by::after){margin:0.5rem !important}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}.fd-property-booked-by__guest-form.sc-igl-property-booked-by{display:grid;padding:0;box-sizing:border-box;gap:0.5rem;width:100%;flex:1 1 0%}";const E=T;const A=class{constructor(i){e(this,i);this.dataUpdateEvent=t(this,"dataUpdateEvent",7)}language;showPaymentDetails=false;defaultData;countries=[];propertyId;isButtonPressed=false;bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""};guests;typedEmail;dataUpdateEvent;bookingService=new d;arrivalTimeList=[];currentMonth="01";country;paymentMethods=[];pickerRef;componentWillLoad(){this.assignCountryCode();this.initializeDateData();this.populateBookedByData();this.paymentMethods=r.property.allowed_payment_methods.filter((e=>e.is_active&&!e.is_payment_gateway));if(this.paymentMethods.length>0){p("selectedPaymentMethod",{code:this.paymentMethods[0].code})}}handleButtonClicked(e){switch(e.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}async assignCountryCode(){const e=await this.bookingService.getUserDefaultCountry();const t=e["COUNTRY_ID"];this.country=t;const i=this.countries.find((e=>e.id?.toString()===t?.toString()));this.bookedByData={...this.bookedByData,isdCode:i.phone_prefix.toString(),countryId:t}}initializeDateData(){const e=new Date;const t=e.getMonth()+1;this.currentMonth=t<10?`0${t}`:t.toString()}populateBookedByData(){this.bookedByData=this.defaultData?{...this.bookedByData,...this.defaultData}:{};this.arrivalTimeList=this.defaultData?.arrivalTime||[];this.bookedByData={...this.bookedByData,selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME};if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}}handleDataChange(e,t){this.bookedByData={...this.bookedByData,[e]:e==="emailGuest"?t.target.checked:t.target.value};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}});if(e==="firstName"||e==="lastName"){b(true)}if(e==="countryId"){this.bookedByData={...this.bookedByData,isdCode:t.target.value}}}handleCreditCardDataChange(e,t){this.bookedByData[e]=t;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}});if(e==="countryId"){this.bookedByData={...this.bookedByData,isdCode:t}}}handleCountryChange(e){const t=this.countries?.find((t=>t.id===e));this.bookedByData={...this.bookedByData,isdCode:this.bookedByData?.contactNumber?this.bookedByData?.isdCode:t?.phone_prefix,countryId:e};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}})}updateGuest(e){p("checkout_guest",{...c.checkout_guest??{},...e})}handleComboboxSelect(e){const t=this.guests?.find((t=>t.id?.toString()===e.detail.item.value));if(!t){console.warn(`guest not found with id ${e.detail.item.value}`);return}this.bookedByData.email=t.email;this.bookedByData={...this.bookedByData,id:t.id,firstName:t.first_name,lastName:t.last_name,contactNumber:t.mobile_without_prefix,countryId:t.country_id,isdCode:t["country_phone_prefix"]??t?.country_id};this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}clearEvent(){this.bookedByData={...this.bookedByData,id:"",firstName:"",lastName:"",contactNumber:"",email:"",isdCode:this.country.toString(),countryId:this.country};b(false);this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:{...this.bookedByData}})}async fetchGuests(e){this.typedEmail=e;this.guests=await this.bookingService.fetchExposedGuest(e,this.propertyId)}get expiryDate(){const{expiryMonth:e,expiryYear:t}=this.bookedByData;if(!e||!t){return""}const i=t.toString().length===4?t.toString().slice(-2):t.toString();return`${e}/${i}`}render(){return i(o,{key:"0b56346f6cf6e6331c56efb828f04d37d14c46d2"},i("div",{key:"530523215864d400feb2da13e25995563849024f",class:"text-left mt-3"},i("div",{key:"89fc12469700d8a1cee5837059dbb6f1d1bf2593",class:"d-flex",style:{alignItems:"flex-end",gap:"0.5rem"}},i("ir-picker",{key:"3be23eb304d4a16f6ca01024e2c858209d6809fd",class:"bookedByEmailContainer m-0 p-0",label:s.entries.Lcz_BookedBy,value:this.bookedByData.email,ref:e=>this.pickerRef=e,"aria-invalid":String(Boolean(this.isButtonPressed&&this.bookedByData.email!==""&&m(this.bookedByData.email))),withClear:true,"onText-change":e=>this.fetchGuests(e.detail),debounce:300,"onInput-picker-blurred":e=>{e.stopPropagation();e.stopImmediatePropagation();const t=this.typedEmail;if(this.bookedByData.email){return}if(this.guests.length===0){if(f.string().email().safeParse(t).success){this.bookedByData={...this.bookedByData,email:t}}else{this.clearEvent();this.pickerRef.clearInput()}}},"onCombobox-clear":e=>{e.stopImmediatePropagation();e.stopPropagation();this.clearEvent()},loading:l("/Fetch_Exposed_Guests"),placeholder:s.entries.Lcz_FindEmailAddress,mode:"select-async","onCombobox-select":this.handleComboboxSelect.bind(this)},this.guests?.map((e=>{const t=`${e.email} - ${e.first_name} ${e.last_name}`;return i("ir-picker-item",{label:t,value:e.id?.toString(),key:e.id},t)}))),i("div",{key:"8727981d6e74aab6ad028426a6158602c01e8d8c",style:{paddingBottom:"0.5rem"}},i("wa-tooltip",{key:"35eaf2ba293acc8b95438aee85f727fa0960d66f",for:`main_guest-search-tooltip`},"Leave empty if email is unavailable"),i("wa-icon",{key:"3f4ec607241cd421066ed223f291221f6f7920b9",name:"circle-info",id:`main_guest-search-tooltip`})))),i("div",{key:"7eee0c0cd23b7e1d16ed0a4e064729aaedb189bf",class:"bookedDetailsForm text-left mt-2 font-small-3 "},i("div",{key:"c0c18c5247fa228f840ff301469d0b1c809e6c35",class:"d-flex flex-column flex-md-row  justify-content-md-between ",style:{gap:"1rem"}},i("div",{key:"10e944a63ded759c11f94b90e0ae2fed5eac0fe6",class:"fd-property-booked-by__guest-form "},i("ir-validator",{key:"cdd6668ddca41e724b043f1f57f920e0cef09dba",value:this.bookedByData.firstName,schema:g.shape.first_name},i("ir-input",{key:"3559f5fdb4991c09b1a7657a46df2086601e620b","onText-change":e=>{this.updateGuest({first_name:e.detail});this.handleDataChange("firstName",{target:{value:e.detail.trim()}})},defaultValue:this.bookedByData.firstName,value:this.bookedByData.firstName,label:s.entries.Lcz_FirstName,placeholder:s.entries.Lcz_FirstName,required:true,name:"last_name_custom",autocomplete:"family-name"})),i("ir-validator",{key:"7dd0da00f476f22135d97ada73f82f25f4512135",value:this.bookedByData.lastName,schema:g.shape.last_name},i("ir-input",{key:"0a3eb05f9434974b24f17621bd4c97a84ecd63a1","onText-change":e=>{this.updateGuest({last_name:e.detail});this.handleDataChange("lastName",{target:{value:e.detail.trim()}})},name:"first_name_custom",autocomplete:"given-name",defaultValue:this.bookedByData.lastName,value:this.bookedByData.lastName,label:s.entries.Lcz_LastName,placeholder:s.entries.Lcz_LastName,required:true})),i("ir-country-picker",{key:"484c98f21cceffdbfcae1aff3311b01b42ba8cde",label:s.entries.Lcz_Country,variant:"modern",testId:"main_guest_country",class:"flex-grow-1 m-0",onCountryChange:e=>this.handleCountryChange(e.detail.id),countries:this.countries,country:this.countries.find((e=>e.id===this.bookedByData.countryId))}),i("ir-mobile-input",{key:"f961077ecbc5ac0d113764f36612feb5447a4e9c",size:"small","onMobile-input-change":e=>{this.handleDataChange("contactNumber",{target:{value:e.detail.formattedValue}})},"onMobile-input-country-change":e=>this.handleDataChange("isdCode",{target:{value:e.detail.phone_prefix}}),value:this.bookedByData.contactNumber,countryCode:this.countries.find((e=>e.phone_prefix===this.bookedByData.isdCode))?.code,countries:this.countries}),i("wa-select",{key:"20257d342a0c540d1ec2e32b571dbb01463e7aee",size:"small",label:s.entries.Lcz_YourArrivalTime,"data-testid":"arrival_time","aria-disabled":String(Boolean(this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code==="")),id:k(),defaultValue:this.arrivalTimeList[0].CODE_NAME,value:this.bookedByData.selectedArrivalTime.code,onchange:e=>this.handleDataChange("selectedArrivalTime",e)},this.arrivalTimeList.map((e=>i("wa-option",{value:e.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===e.CODE_NAME},e.CODE_VALUE_EN))))),i("div",{key:"0ad5521792b071112d319753517a83ff2496c43c",class:"p-0 flex-fill  ml-md-3 d-flex flex-column",style:{gap:"0.5rem"}},i("wa-textarea",{key:"3b94edc711e1a0616f5e875405e0031d3cfadced",onchange:e=>this.handleDataChange("message",e),size:"small",value:this.bookedByData.message,defaultValue:this.bookedByData.message,label:s.entries.Lcz_AnyMessageForUs,rows:4}),this.paymentMethods.length>1&&i("wa-select",{key:"5fc3f0666ab5786ce4aa9eb873f1a4fe00cfcfca",label:"Payment Method",size:"small",value:c?.selectedPaymentMethod?.code,onchange:e=>p("selectedPaymentMethod",{code:e.target.value})},this.paymentMethods.map((e=>i("wa-option",{value:e.code},e.description)))),c.selectedPaymentMethod?.code==="001"&&i(a,{key:"e0d8d48b5c21d27763e6e0d8fd058d9aedaa1975"},i("ir-input",{key:"39e080d9496363e4f49cd6894d3e1c510a850461",value:this.bookedByData.cardNumber,defaultValue:this.bookedByData.cardNumber,"onText-change":e=>this.handleCreditCardDataChange("cardNumber",e.detail.trim()),label:s.entries.Lcz_CardNumber}),i("ir-input",{key:"4f9df6b7a530a096f6a36fca5becd86d76aa990a",value:this.bookedByData.cardHolderName,defaultValue:this.bookedByData.cardHolderName,"onText-change":e=>this.handleCreditCardDataChange("cardHolderName",e.detail.trim()),label:s.entries.Lcz_CardHolderName}),i("ir-input",{key:"b7fbcc9864152ffed84c561372d123db0b6b0956","onText-change":e=>{const[t,i]=e.detail.split("/");this.handleCreditCardDataChange("expiryYear",t??"");this.handleCreditCardDataChange("expiryMonth",i??"")},value:this.expiryDate,mask:{mask:"MM/YY",placeholderChar:"_",blocks:{MM:{mask:y.MaskedRange,from:1,to:12,maxLength:2},YY:{mask:y.MaskedRange,from:(new Date).getFullYear()%100,to:(new Date).getFullYear()%100+20,maxLength:2}}},label:s.entries.Lcz_ExpiryDate})),c.selectedPaymentMethod?.code==="005"&&i("div",{key:"5129c44c9ab078099c1780873bc7bbed9d6104e9",class:"form-group mt-md-1 mt-1 p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"023abeea4451b8f15b0598a9d2eee98a3864542d",class:"p-0 m-0 margin3"}),i("div",{key:"20f1b114c0a6442f0bfd6de4452d247e9b5a5c9d",class:"p-0 m-0  controlContainer flex-fill"},i("div",{key:"2bb5b79943757b681e475e3482db21f799b27f2c",class:"property-booked-by__money-transfer-description",innerHTML:this.paymentMethods.find((e=>e.code==="005"))?.localizables.find((e=>e.language.code.toLowerCase()==="en"))?.description}))),i("wa-checkbox",{key:"2a9ec524d1783e1d9fb1d1efea3935448feae2d2",checked:this.bookedByData.emailGuest,onchange:e=>this.handleDataChange("emailGuest",e)},s.entries.Lcz_EmailTheGuest)))))}};A.style=E;export{_ as igl_book_property_footer,B as igl_book_property_header,O as igl_booking_form,N as igl_booking_overview_page,A as igl_property_booked_by};
//# sourceMappingURL=p-7723eef9.entry.js.map