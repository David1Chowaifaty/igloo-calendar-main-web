import{r as t,c as e,h as i,F as s,H as o,g as a}from"./p-ee49d535.js";import{B as n}from"./p-f93ca8fe.js";import{l as r}from"./p-806fad31.js";import{v as h}from"./p-4ed69de7.js";import"./p-06203439.js";import"./p-e016a0cc.js";import"./p-6c4ba7c0.js";import"./p-08469bc4.js";import"./p-4eb12235.js";import"./p-8e74896a.js";const c=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const l=c;const d=class{constructor(i){t(this,i);this.comboboxValue=e(this,"comboboxValue",7);this.inputCleared=e(this,"inputCleared",7);this.toast=e(this,"toast",7);this.bookingService=new n;this.no_result_found="";this.duration=300;this.placeholder="";this.propertyId=undefined;this.isSplitBooking=false;this.type="text";this.name="";this.inputId=h();this.required=false;this.disabled=false;this.value=undefined;this.from_date="";this.to_date="";this.danger_border=undefined;this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputFocused=false}componentWillLoad(){this.no_result_found=r.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const o=t+s;const a=o*this.selectedIndex;let n=a-e/2+t/2;n=Math.max(0,Math.min(n,i.scrollHeight-e));i.scrollTo({top:n,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return i("div",{class:`position-absolute border rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,e)=>i("p",{role:"button",onKeyDown:t=>this.handleItemKeyDown(t,e),"data-selected":this.selectedIndex===e,tabIndex:0,onClick:()=>this.selectItem(e)},this.isSplitBooking?i(s,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):i("div",{class:"d-flex align-items-center flex-fill"},i("p",{class:"p-0 m-0"},`${t.email}`," ",i("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&i("div",{class:"loader-container d-flex align-items-center justify-content-center"},i("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&i("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return i(o,{key:"8fa8663f91709dbdcfc4f223a98a9abb4a8bd139"},i("div",{key:"18abf531825f7e90625c1047371cc634032fcff9",class:"d-flex align-items-center "},i("label",{key:"4f37cc692ab0fff05a1ff3f197e40c99855b5287","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},i("svg",{key:"8be77f87625f28f9c7370c79a500513f878fddd3",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},i("path",{key:"ba0940e70732ae105978769a9baf75bd368d099c",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("input",{key:"1cedb6fcd624e95ca6f9ee597d540d931d212bbc",required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),autoComplete:"none",onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&i("button",{key:"09948123d0b019d5e5849568471e59063e25b564",type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},i("p",{key:"def2132d6affe64f16321cbeea193e7960a100e3",class:"sr-only"},"clear input"),i("svg",{key:"6415c9973734ec556be65978b0445694e6c0a81e",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i("path",{key:"0b8043a42845fae748a8ae41e0df56985ecd9704",d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return a(this)}};d.style=l;const p=".sc-ir-country-picker-h{display:block;margin:0;padding:0;box-sizing:border-box}.combobox-menu.sc-ir-country-picker{max-height:200px;overflow:auto}";const f=p;const u=class{constructor(i){t(this,i);this.countryChange=e(this,"countryChange",7);this.countries=[];this.country=undefined;this.error=undefined;this.propertyCountry=undefined;this.label=undefined;this.inputValue=undefined;this.selectedCountry=undefined;this.filteredCountries=[];this.searching=false}componentWillLoad(){this.filteredCountries=[...this.countries];if(this.country){this.inputValue=this.country.name;this.selectedCountry=this.country}}handleCountryChange(t,e){if((t===null||t===void 0?void 0:t.id)!==(e===null||e===void 0?void 0:e.id)){this.inputValue=this.country.name;this.selectedCountry=t}}filterCountries(){if(this.inputValue===""&&this.country){this.selectCountry(null)}clearTimeout(this.debounceTimeout);this.debounceTimeout=setTimeout((()=>{if(!this.inputValue){this.filteredCountries=[...this.countries]}else{this.filteredCountries=this.countries.filter((t=>t.name.toLowerCase().includes(this.inputValue.toLowerCase())))}}),300)}selectCountry(t){this.selectedCountry=t;this.inputValue=t.name;this.filteredCountries=[...this.countries];this.countryChange.emit(t)}scrollToSelected(){setTimeout((()=>{const t=document.querySelector(`.dropdown-item.active`);if(t){t.scrollIntoView({behavior:"instant",block:"center"})}}),100)}render(){var t,e,o;const a=this.filteredCountries.length>0&&this.propertyCountry&&(!this.searching||this.searching&&this.inputValue==="");return i("form",{key:"d07093a9b78e958f4dd5a07b8322158a64c31820",class:"dropdown m-0 p-0"},i("ir-input-text",{key:"7c897fac87955a20b47d59ef6aa16287a170f365",onTextChange:t=>{if(!this.searching){this.searching=true}this.inputValue=t.detail;this.filterCountries()},label:this.label,error:this.error,placeholder:"",class:"m-0 p-0",value:this.inputValue,id:"dropdownMenuCombobox",LabelAvailable:!!this.label,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onInputFocus:()=>this.scrollToSelected(),onInputBlur:()=>this.searching=false}),i("div",{key:"4ac65b5f92886744738aa8a158fc12da4072bf03",class:"dropdown-menu combobox-menu","aria-labelledby":"dropdownMenuCombobox"},a&&i(s,{key:"d8a0a4d28f9105c72a482ac876363f4a6832e9ff"},i("button",{key:"54e8b691749a589719cd66c818dba51e660e9c23",type:"button",class:`dropdown-item d-flex align-items-center ${((t=this.selectedCountry)===null||t===void 0?void 0:t.id)===this.propertyCountry.id?"active":""}`,onClick:()=>{this.selectCountry(this.propertyCountry)}},i("img",{key:"3d4616de798d572d5563cbd00ea2cb083f0d9d18",src:this.propertyCountry.flag,alt:this.propertyCountry.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),i("p",{key:"bf17f2359a765c04ae9c71d340fd62f1f91f9e61",class:"pl-1 m-0"},this.propertyCountry.name)),i("div",{key:"a181762a9c9c6fce0fa4fc7cc85b27a2065222ec",class:"dropdown-divider"})),(e=this.filteredCountries)===null||e===void 0?void 0:e.map((t=>{var e;return i("button",{key:t.id,type:"button",class:`dropdown-item d-flex align-items-center ${((e=this.selectedCountry)===null||e===void 0?void 0:e.id)===t.id?"active":""}`,onClick:()=>{this.selectCountry(t)}},i("img",{src:t.flag,alt:t.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),i("p",{class:"pl-1 m-0"},t.name))})),((o=this.filteredCountries)===null||o===void 0?void 0:o.length)===0&&i("p",{key:"0033f9dea97d12d7a81e0d677275fbd4d217996c",class:"dropdown-item-text"},"Invalid Country")))}static get watchers(){return{country:["handleCountryChange"]}}};u.style=f;const b=".sc-ir-phone-input-h{display:block}.input-container.sc-ir-phone-input{display:flex;align-items:center;padding:0 !important}.input-container.sc-ir-phone-input:focus-within{border-color:#1e9ff2}.border-theme.sc-ir-phone-input{border-color:#cacfe7}.input-container.sc-ir-phone-input input.sc-ir-phone-input{flex:1;border:0}.input-container.sc-ir-phone-input input.sc-ir-phone-input:focus{outline:none}.dropdown-trigger.sc-ir-phone-input{display:flex;align-items:center;gap:8px;background:white;border:0;border-right:1px solid #cacfe7}.ir-dropdown-container.sc-ir-phone-input{position:absolute;z-index:1000;bottom:-30px;width:100%;left:0;background:white}.input-container.sc-ir-phone-input label.sc-ir-phone-input{display:flex;align-items:center;justify-content:center;margin:0;padding:0 5px}.flag.sc-ir-phone-input{height:1rem;aspect-ratio:4/3;border-radius:3px}.is-invalid.sc-ir-phone-input{border-color:#ff4961}.phone_prefix_label.sc-ir-phone-input{padding:0 0.5rem;margin:0}";const m=b;const g=class{constructor(i){t(this,i);this.textChange=e(this,"textChange",7);this.bookingService=new n;this.label=undefined;this.value="";this.disabled=false;this.error=false;this.token=undefined;this.language=undefined;this.default_country=null;this.phone_prefix=null;this.placeholder=undefined;this.countries=[];this.inputValue="";this.isDropdownVisible=false;this.currentCountry=undefined}async componentWillLoad(){if(this.countries.length===0){const t=await this.bookingService.getCountries(this.language);this.countries=t}if(this.phone_prefix){this.setCountryFromPhonePrefix()}else{if(this.default_country){this.setCurrentCountry(this.default_country)}}this.inputValue=this.value}handleValueChange(t,e){if(t!==e){this.inputValue=t}}handlePhoneChange(t,e){if(t!==e){this.setCountryFromPhonePrefix()}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isDropdownVisible=false}}handleInputChange(t){var e;let i=t.target;let s=i.value;s=s.replace(/[^+\d]+/g,"");i.value=s;this.inputValue=s;this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.inputValue})}setCountryFromPhonePrefix(){var t;console.log(this.phone_prefix);let e=this.countries.find((t=>t.phone_prefix===this.phone_prefix));if(!e){e=this.countries.find((t=>t.id.toString()===this.phone_prefix));if(!e){return}}console.log(e);this.currentCountry=Object.assign({},e);this.textChange.emit({phone_prefix:(t=this.currentCountry)===null||t===void 0?void 0:t.phone_prefix,mobile:this.value})}setCurrentCountry(t){var e;const i=this.countries.find((e=>e.id===t));if(!i){throw new Error("Invalid country id")}this.currentCountry=Object.assign({},i);this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.value})}render(){var t,e;return i(o,{key:"f34f91bd1519b79a02cd1459742bfb486bf05b00"},i("div",{key:"4998a55219d17eedc9c7aa54f1997996b846a3f6",class:"form-group mr-0"},i("div",{key:"61c907ee7244e682b55cad9d27dd392c27c70bbe",class:"input-group row m-0 p-0 position-relative"},this.label&&i("div",{key:"9d6b9c0eed851b5abbefd9f5352e5f4eec6d4752",class:`input-group-prepend col-3 p-0 text-dark border-none`},i("label",{key:"5fbb69898034d1719f378b534e9726c13b4c55bf",class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.label)),i("div",{key:"1577cb2c09c5e043e51770f796fda907db836953",class:"form-control  input-container  flex-fill"+(this.error?" is-invalid":"")},i("button",{key:"9f9a997fea7dc15975f38e9f528f04e4cd101f3f",onClick:()=>this.isDropdownVisible=!this.isDropdownVisible,class:"dropdown-trigger"},this.currentCountry?i("img",{src:(t=this.currentCountry)===null||t===void 0?void 0:t.flag,class:"flag"}):i("p",{class:"p-0 m-0 "},r.entries.Lcz_Select),i("svg",{key:"4acd12cbf5100bf09613633caab44d3ee996b3e9",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},i("path",{key:"a6edf0a9f7eecee2264bcb79bb2ddba4131230fd",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),i("p",{key:"0b03005ce609880bc4903d632c966708646f0ac3",class:"phone_prefix_label"},(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix),i("input",{key:"cf4b4e45d9f5bd96e0d03a4c59f2f02f9a791e9c",type:"text",placeholder:this.placeholder,required:true,value:this.inputValue,disabled:this.disabled,onInput:t=>this.handleInputChange(t)}))," ",this.isDropdownVisible&&i("div",{key:"8a05784549e0b8cd9eb33e584e6e9d389f35e6c5",class:"ir-dropdown-container"},i("ir-combobox",{key:"88ade0448c50eb529dd839d43ce3931c6be8f1e8",onComboboxValueChange:t=>{this.setCurrentCountry(+t.detail.data);this.isDropdownVisible=false},class:"bg-white",autoFocus:true,placeholder:"Search country",data:this.countries.map((t=>({id:t.id.toString(),name:`${t.name} (${t.phone_prefix})`,image:t.flag})))})))))}get el(){return a(this)}static get watchers(){return{value:["handleValueChange"],phone_prefix:["handlePhoneChange"]}}};g.style=m;const x=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}.tooltip-inner-custom.sc-ir-tooltip{min-width:max-content !important}";const v=x;const y=class{constructor(e){t(this,e);this.message=undefined;this.withHtml=true;this.customSlot=false;this.open=undefined}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){return i(o,{key:"baf9a0edd13496b0c4556b0757d358a025ea411f",class:"m-0 p-0"},i("span",{key:"eee068dce3c0f81742228160017aa85e0ff8fef1",class:"m-0 p-0 d-flex align-items-center justify-content-center",onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},!this.customSlot?i("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"16",width:"16",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})):i("slot",{name:"tooltip-trigger"})),this.open&&i("div",{key:"c845481eee9edf87e62d6764f27ae6e9e333aa8f",class:"tooltip bottom show position-absolute",role:"tooltip"},i("div",{key:"0b0388c66c580d87c43c48bac9d01aecf52f51fe",class:"tooltip-arrow"}),i("div",{key:"72f8edf44bf4f9c2d8254d755fd69c6bd567aad9",class:`tooltip-inner fit ${this.customSlot&&"tooltip-inner-custom"}`},i("span",{key:"99bf1913a97b0a415db0006a44ef8d322d5524ce",innerHTML:this.message}))))}};y.style=v;export{d as ir_autocomplete,u as ir_country_picker,g as ir_phone_input,y as ir_tooltip};
//# sourceMappingURL=p-ed70c7e0.entry.js.map