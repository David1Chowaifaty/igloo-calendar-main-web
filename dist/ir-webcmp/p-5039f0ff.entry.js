import{r as t,c as e,h as i,H as s,F as n,g as o}from"./p-a62d0400.js";import{g as a,e as r,a as l,c,b as h,d,f,t as u,B as b,h as p,i as g,j as m,k as y,l as k,m as v,n as w,o as x,p as _,q as D,r as C,s as O,u as E,v as T,w as I,x as B}from"./p-b8012398.js";import{l as M}from"./p-389c26bd.js";import{c as A}from"./p-bb593e1b.js";import{v as N}from"./p-4ed69de7.js";import{T as R,a as S}from"./p-1296c4bd.js";import{i as L,a as j}from"./p-bd1c6681.js";import{h as Y}from"./p-6c4ba7c0.js";import{t as z,c as P,_ as H,a as U,g as G,b as V,d as K}from"./p-9384b2de.js";import{i as F,r as W}from"./p-12b292f3.js";import{c as q}from"./p-80497476.js";import{c as X}from"./p-7dbe3a8e.js";import{R as J}from"./p-87e56763.js";import{P as Z}from"./p-3be46a67.js";const Q=".sc-igl-application-info-h{display:block}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:80%}.guest-info-container.sc-igl-application-info{max-width:300px}.preference-select-container.sc-igl-application-info{max-width:250px}}";const tt=Q;const et=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.userRate=0;this.guestInfo=undefined;this.currency=undefined;this.roomsList=[];this.guestRefKey=undefined;this.bedPreferenceType=[];this.selectedUnits=[];this.bookingType="PLUS_BOOKING";this.defaultGuestPreference=undefined;this.index=undefined;this.defaultGuestRoomId=undefined;this.dateDifference=undefined;this.filterdRoomList=[];this.isButtonPressed=false;this.guestData=undefined}componentWillLoad(){if(this.guestInfo.isRateModified&&this.guestInfo.rateType===2){this.userRate=this.guestInfo.rate*this.dateDifference}else{this.userRate=this.guestInfo.rate}this.guestData=this.guestInfo?Object.assign({},this.guestInfo):{};this.guestData.roomId="";if(this.defaultGuestRoomId&&this.roomsList.filter((t=>t.id.toString()===this.defaultGuestRoomId.toString())).length>0){this.guestData.roomId=this.defaultGuestRoomId}this.guestData.preference=+this.defaultGuestPreference||"";this.updateRoomList()}componentDidLoad(){this.timeout=setTimeout((()=>{this.updateData()}),200)}disconnectedCallback(){clearTimeout(this.timeout)}async handleSelctedUnits(){this.updateRoomList()}updateRoomList(){const t=[...this.selectedUnits];t[this.index]=-1;this.filterdRoomList=this.roomsList.filter((e=>!t.includes(e.id)||e.name===""))}updateData(){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",guestRefKey:this.guestRefKey,data:Object.assign({},this.guestData)})}handleDataChange(t,e){this.guestData[t]=+e;if(e===""){this.guestData["roomName"]=e}if(t==="roomId"&&e!==""){this.guestData["roomName"]=this.filterdRoomList.find((t=>t.id===+e)).name||""}this.updateData()}handleGuestNameChange(t){this.guestData.guestName=t.target.value;this.updateData()}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}render(){return i(s,{key:"9e7ddbd6e6b4d5acfd6994d06edf4eb49f1fa2bc"},i("div",{key:"10f0b714856c481ba4acdf79cfb3ca643d227b7f",class:"text-left mt-1 "},i("div",{key:"b01b9ffb12ea8ccf0d6387812cf99ff17f943201",class:" mb-1 "},this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING"?i("span",{class:"h5 mr-1"},this.guestInfo.roomCategoryName):null,i("span",{key:"50eb5cfb3a818ff9a8a9c91dedaa7b31a2e77ddf",class:" font-weight-bold"},this.guestInfo.ratePlanName.replace(this.guestInfo.roomCategoryName+"/",""),i("ir-tooltip",{key:"a6cd36bc8f112d3ff7cb6ea65768339dd789813c",class:" mr-1",message:this.guestInfo.cancelation+this.guestInfo.guarantee})),i("span",{key:"80baf8fc1ce54f5a3949d03fd85387516be05e65"},this.guestInfo.adult_child_offering)),i("div",{key:"43806d8201c85d1b773e5035e0c5deb9a1db284c",class:"d-flex flex-column flex-md-row m-0 p-0 align-items-md-center aplicationInfoContainer "},i("div",{key:"f1870ba87b12889393233730febd4fbe22268416",class:"mr-1 flex-fill guest-info-container"},i("input",{key:"6b0d16203bf4e43b76a7b212cbdc1eaee5e866a4",id:N(),type:"email",class:`form-control ${this.isButtonPressed&&this.guestData.guestName===""&&"border-danger"}`,placeholder:M.entries.Lcz_GuestFirstnameAndLastname,name:"guestName",onInput:t=>this.handleGuestNameChange(t),required:true,value:this.guestData.guestName})),i("div",{key:"36707c425d9a1e6f4144ece5b871ffc38ea97007",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},A.is_frontdesk_enabled&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")?i("div",{class:"mr-1 p-0 flex-fill  preference-select-container"},i("select",{class:`form-control  input-sm pr-0`,id:N(),onChange:t=>this.handleDataChange("roomId",t.target.value)},i("option",{value:"",selected:this.guestData.roomId===""},M.entries.Lcz_Assignunits),this.filterdRoomList.map((t=>i("option",{value:t.id,selected:+this.guestData.roomId===t.id},t.name))))):null,this.guestData.is_bed_configuration_enabled&&i("div",{key:"e1fae3f7dd6294c9cb5038dde8fdb40b74f1a03d",class:"mr-1 flex-fill"},i("select",{key:"cd2c69c47a2997b155e07e0c5fe0a116c4ed51ff",class:`form-control input-sm ${this.isButtonPressed&&(this.guestData.preference===""||this.guestData.preference===0)&&"border-danger"}`,id:N(),onChange:t=>this.handleDataChange("preference",t.target.value)},i("option",{key:"6134882af24a338a7682137cbfc931e8b4b444fb",value:"",selected:this.guestData.preference===""},M.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((t=>i("option",{value:+t.CODE_NAME,selected:this.guestData.preference===+t.CODE_NAME},t.CODE_VALUE_EN))))),i("div",{key:"37469c0019cfdff7bde640d47172dea53dae0bb1",class:""},a(this.currency.code)+Number(this.userRate).toFixed(2),"/",M.entries.Lcz_Stay)))))}static get watchers(){return{selectedUnits:["handleSelctedUnits"]}}};et.style=tt;var it=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++){if(e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n]))i[s[n]]=t[s[n]]}return i};class st extends R{async getCalendarData(t,e,i){try{const s=this.getToken();if(s!==null){const{data:n}=await S.post(`/Get_Exposed_Calendar?Ticket=${s}`,{propertyid:t,from_date:e,to_date:i,extras:r});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}const o=n.My_Result.months;const a=[];const d=await l(o);const f=o.map((t=>{a.push({daysCount:t.days.length,monthName:t.description});return t.days.map((e=>({day:c(e.description,t.description),currentDate:h(e.description,t.description),dayDisplayName:e.description,rate:e.room_types,unassigned_units_nbr:e.unassigned_units_nbr,occupancy:e.occupancy})))})).flat();return Promise.resolve({ExceptionCode:null,ExceptionMsg:"",My_Params_Get_Rooming_Data:{AC_ID:t,FROM:n.My_Params_Get_Exposed_Calendar.from_date,TO:n.My_Params_Get_Exposed_Calendar.to_date},days:f,months:a,myBookings:d,defaultMonths:o})}}catch(t){console.error(t)}}async fetchGuest(t){try{const e=this.getToken();if(e!==null){const{data:i}=await S.post(`/Get_Exposed_Guest?Ticket=${e}`,{email:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}}catch(t){console.log(t);throw new Error(t)}}async fetchPMSLogs(t){try{const e=this.getToken();if(e!==null){const{data:i}=await S.post(`/Get_Exposed_PMS_Logs?Ticket=${e}`,{booking_nbr:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}}catch(t){console.log(t);throw new Error(t)}}async editExposedGuest(t,e){try{const i=this.getToken();if(i!==null){const{data:s}=await S.post(`/Edit_Exposed_Guest?Ticket=${i}`,Object.assign(Object.assign({},t),{book_nbr:e}));if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return s.My_Result}}catch(t){console.log(t);throw new Error(t)}}async getBookingAvailability(t){try{const e=this.getToken();if(e){const{adultChildCount:i,currency:s}=t,n=it(t,["adultChildCount","currency"]);const{data:o}=await S.post(`/Get_Exposed_Booking_Availability?Ticket=${e}`,Object.assign(Object.assign({},n),{adult_nbr:i.adult,child_nbr:i.child,currency_ref:s.code,is_backend:true}));if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o["My_Result"]}else{throw new Error("Token doesn't exist")}}catch(t){console.error(t);throw new Error(t)}}async getCountries(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/Get_Exposed_Countries?Ticket=${e}`,{language:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}}catch(t){console.error(t);throw new Error(t)}}async fetchSetupEntries(){try{const t=this.getToken();if(t){const{data:e}=await S.post(`/Get_Setup_Entries_By_TBL_NAME_MULTI?Ticket=${t}`,{TBL_NAMES:["_ARRIVAL_TIME","_RATE_PRICING_MODE","_BED_PREFERENCE_TYPE"]});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}const i=e.My_Result;return{arrivalTime:i.filter((t=>t.TBL_NAME==="_ARRIVAL_TIME")),ratePricingMode:i.filter((t=>t.TBL_NAME==="_RATE_PRICING_MODE")),bedPreferenceType:i.filter((t=>t.TBL_NAME==="_BED_PREFERENCE_TYPE"))}}}catch(t){console.error(t);throw new Error(t)}}async getBlockedInfo(){try{const t=this.getToken();if(t){const{data:e}=await S.post(`/Get_Setup_Entries_By_TBL_NAME_MULTI?Ticket=${t}`,{TBL_NAMES:["_CALENDAR_BLOCKED_TILL"]});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}}catch(t){console.error(t);throw new Error(t)}}async getUserDefaultCountry(){try{const t=this.getToken();if(t){const{data:e}=await S.post(`/Get_Country_By_IP?Ticket=${t}`,{IP:""});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e["My_Result"]}}catch(t){console.error(t);throw new Error(t)}}async blockUnit(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/Block_Exposed_Unit?Ticket=${e}`,t);if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}console.log(i);return i["My_Params_Block_Exposed_Unit"]}}catch(t){console.error(t);throw new Error(t)}}async getUserInfo(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/GET_EXPOSED_GUEST?Ticket=${e}`,{email:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}async getExposedBooking(t,e,i=true){try{const s=this.getToken();if(s){const{data:n}=await S.post(`/Get_Exposed_Booking?Ticket=${s}`,{booking_nbr:t,language:e,extras:i?r:null});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}else{throw new Error("Invalid Token")}}catch(t){console.error(t)}}generateDays(t,e,i){const s=new Date(t);const n=new Date(e);const o=[];while(s<n){o.push({date:s.toISOString().split("T")[0],amount:i,cost:null});s.setDate(s.getDate()+1)}return o}calculateTotalRate(t,e,i,s){if(i&&s===2){return+t}return+t/+e}async fetchExposedGuest(t,e){try{const i=this.getToken();if(i){const{data:s}=await S.post(`/Fetch_Exposed_Guests?Ticket=${i}`,{email:t,property_id:e});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return s["My_Result"]}else{throw new Error("Token doesn't exist")}}catch(t){console.error(t);throw new Error(t)}}async fetchExposedBookings(t,e,i,s){try{const n=this.getToken();if(n){const{data:o}=await S.post(`/Fetch_Exposed_Bookings?Ticket=${n}`,{booking_nbr:t,property_id:e,from_date:i,to_date:s});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o["My_Result"]}else{throw new Error("Token doesn't exist")}}catch(t){console.error(t);throw new Error(t)}}async getPCICardInfoURL(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/Get_PCI_Card_Info_URL?Ticket=${e}`,{BOOK_NBR:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i["My_Result"]}else{throw new Error("Token doesn't exist")}}catch(t){console.error(t);throw new Error(t)}}async doReservation(t){const e=this.getToken();if(!e){throw new Error("Missing token")}const{data:i}=await S.post(`/DoReservation?Ticket=${e}`,Object.assign(Object.assign({},t),{extras:t.extras?t.extras:r}));if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}console.log(i["My_Result"]);return i["My_Result"]}async bookUser(t,e,i,s,n,o,a,r,l,c,h,f,u,b,p,g=null){try{const m=this.getToken();if(m){const m=d(i);const y=d(s);let k={email:t.email===""?null:t.email||null,first_name:t.firstName,last_name:t.lastName,country_id:t.countryId===""?null:t.countryId,city:null,mobile:t.contactNumber===null?"":t.contactNumber,phone_prefix:null,address:"",dob:null,subscribe_to_news_letter:t.emailGuest||false,cci:t.cardNumber?{nbr:t.cardNumber,holder_name:t.cardHolderName,expiry_month:t.expiryMonth,expiry_year:t.expiryYear}:null};if(f){k=Object.assign(Object.assign({},f),{email:f.email===""?null:f.email})}if(t.id){k=Object.assign(Object.assign({},k),{id:t.id})}const v={assign_units:true,check_in:e,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,extras:g,booking:{booking_nbr:h||"",from_date:m,to_date:y,remark:t.message||null,property:{id:r},source:a,currency:c,arrival:{code:u?u:t.selectedArrivalTime},guest:k,rooms:[...n.map((t=>({identifier:p||null,roomtype:{id:t.roomCategoryId,name:t.roomCategoryName,physicalrooms:null,rateplans:null,availabilities:null,inventory:t.inventory,rate:t.rate/o},rateplan:{id:t.ratePlanId,name:t.ratePlanName,rate_restrictions:null,variations:null,cancelation:t.cancelation,guarantee:t.guarantee},unit:typeof b==="undefined"&&t.roomId===""?null:{id:+b||+t.roomId},occupancy:{adult_nbr:t.adultCount,children_nbr:t.childrenCount,infant_nbr:null},bed_preference:t.preference,from_date:m,to_date:y,notes:null,days:this.generateDays(m,y,this.calculateTotalRate(t.rate,o,t.isRateModified,t.rateType)),guest:{email:null,first_name:t.guestName,last_name:null,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null}}))),...l]}};console.log("book user payload",v);const w=await this.doReservation(v);return w}else{throw new Error("Invalid token")}}catch(t){console.error(t);throw new Error(t)}}}const nt=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const ot=nt;const at=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new st;this.defaultData=undefined;this.fromDate=undefined;this.toDate=undefined;this.entryDate=undefined;this.entryHour=undefined;this.isEventHover=false;this.entryMinute=undefined;this.renderAgain=false}async componentWillLoad(){try{this.bookingService.setToken(A.token);this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(t){}}handleOptionalReason(t){this.blockDatesData.OPTIONAL_REASON=t.target.value;this.emitData()}handleReleaseAfterChange(t){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(t.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let t=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){t.setHours(this.entryHour,this.entryMinute,0,0)}else{t.setHours(t.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,t.getMinutes(),0,0)}return t.toLocaleString("default",{month:"short"})+" "+t.getDate()+", "+this.formatNumber(t.getHours())+":"+this.formatNumber(t.getMinutes())}formatNumber(t){return t<10?`0${t}`:t}handleOutOfService(t){this.blockDatesData.OUT_OF_SERVICE=t.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){return i(s,{key:"33d870a6e3906b77eece0aadf7927a6d2f39cd30"},i("div",{key:"e70de36c7e354b63cede6ef7d8e9a54c972c45c2",class:`m-0 p-0 mb-1`},i("div",{key:"a117f81a211f41c95456b1b2d97aa240656544ae",class:"text-left p-0"},i("ir-date-view",{key:"2b4dd29f9263c6ab2c781073d0e0ab9be088b491",from_date:this.fromDate,dateOption:"DD MMM YYYY",showDateDifference:false,to_date:this.toDate}))),i("div",{key:"d4de0d5e59f192a82730582266fd6bd5ece09cd0",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},i("div",{key:"fbae2c940d686793fb40eaf423f358bafb4c2383",class:"mb-1 "},i("label",{key:"4f41cb24c0d6676fdb5236a0b811573ebd2762e9",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},M.entries.Lcz_Reason,":"),i("div",{key:"415b0caac88aa8108703f772d01ff7bfee6fce54",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},i("input",{key:"c6980fb960700df3494dc85bc153690e9113bede",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:t=>this.handleOutOfService(t)})),i("span",{key:"bd64adfa657761075cf56ab36d3f0f3427ecb2de",class:"align-middle out-of-service-label"},M.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?i("div",null,i("div",{class:"mb-1 d-flex  align-items-center"},i("span",{class:"align-middle"},M.entries.Lcz_Or," "),i("div",{class:"d-inline-flex col pr-0 align-middle"},i("input",{class:"form-control",type:"text",placeholder:M.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:t=>this.handleOptionalReason(t)}))),i("div",{class:"mb-1 w-100 pr-0 "},i("span",{class:"text-bold-700 font-medium-1"},M.entries.Lcz_AutomaticReleaseIn,": "),i("div",{class:"d-inline-block"},i("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:t=>this.handleReleaseAfterChange(t)},this.releaseList.map((t=>i("option",{value:+t.CODE_NAME,selected:this.blockDatesData.RELEASE_AFTER_HOURS==+t.CODE_NAME},t.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?i("div",{class:"d-inline-block releaseTime"},i("em",null,M.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};at.style=ot;class rt{setBookingInfoFromAutoComplete(t,e){t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:e.guest.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,n){let o=e;const{data:a,key:r,changedKey:l}=t.detail;const c=`c_${a.roomCategoryId}`;const h=`p_${a.ratePlanId}`;if(this.shouldClearData(r)){o=new Map}this.initializeRoomCategoryIfNeeded(c,o);if(s){if(l==="rate"){if(o.has(c)&&o.get(c).has(h)){this.applyBookingEditToSelectedRoom(c,h,a,o,n,i)}}else{if(l!=="rateType"){if(l==="adult_child_offering"){if(o.has(c)&&e.get(c).has(h)){this.applyBookingEditToSelectedRoom(c,h,a,o,n,i)}}else{this.applyBookingEditToSelectedRoom(c,h,a,o,n,i)}}}}else{this.setSelectedRoomData(c,h,a,o)}this.cleanupEmptyData(c,o);return o}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let n=s.get(t);if(i.totalRooms===0||i.inventory===0){n.delete(e)}else{s.set(t,n.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,n,o){s.clear();let a={};if(o){a=Object.assign(Object.assign({},i),{guestName:n||"",roomId:""})}else{a=Object.assign({},i)}s.set(t,(new Map).set(e,a))}async prepareBookUserServiceParams(t,e,i){try{const s=t.isEventType("EDIT_BOOKING")?t.getArrivalTimeForBooking():t.isEventType("ADD_ROOM")?t.bookingData.ARRIVAL.code:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.selectedArrivalTime.code:"";const n=t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:undefined;const o=t.isEventType("EDIT_BOOKING")||t.isEventType("ADD_ROOM")?t.bookingData.BOOKING_NUMBER:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.bookingNumber:undefined;let a=[];if(t.isEventType("ADD_ROOM")){a=t.bookingData.ROOMS}else if(t.isEventType("SPLIT_BOOKING")){a=t.bookedByInfoData.rooms}else if(t.isEventType("EDIT_BOOKING")){a=t.defaultData.ROOMS.filter((e=>e.identifier!==t.bookingData.IDENTIFIER))}return[t.bookedByInfoData,e,new Date(t.dateRangeData.fromDate),new Date(t.dateRangeData.toDate),t.guestData,t.dateRangeData.dateDifference,i,t.propertyid,a,t.currency,o,t.bookingData.GUEST,s,n,t.bookingData.IDENTIFIER]}catch(t){console.error(t)}}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const n=`p_${t.RATE_PLAN_ID}`;const o={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(n,o))}}class lt extends R{constructor(){super(...arguments);this.bookingService=new st}async reallocateEvent(t,e,i,s){try{const n=this.getToken();if(n){console.log(t,e,i,s);const{data:o}=await S.post(`/ReAllocate_Exposed_Room?Ticket=${n}`,{pool:t,destination_pr_id:e,from_date:i,to_date:s,extras:r});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}console.log(o);return o}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}async deleteEvent(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/UnBlock_Exposed_Unit?Ticket=${e}`,{POOL:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}else{throw new Error("Invalid Token")}}catch(t){console.log(t);throw new Error(t)}}async updateBlockedEvent(t){try{const e=this.getToken();if(e){const i=f(+t.RELEASE_AFTER_HOURS);await this.deleteEvent(t.POOL);this.bookingService.setToken(e);const s=await this.bookingService.blockUnit(Object.assign({from_date:this.formatDate(t.FROM_DATE),to_date:this.formatDate(t.TO_DATE),pr_id:t.PR_ID,STAY_STATUS_CODE:t.OUT_OF_SERVICE?"004":t.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:t.RELEASE_AFTER_HOURS||"",NOTES:t.OPTIONAL_REASON||""},i));return s}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}formatDate(t){return t.split("/").join("-")}}const ct=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto;padding-bottom:85px !important}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.row.sc-igl-book-property{padding:0 0 0 15px;margin:0}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}";const ht=ct;const dt=class{constructor(i){t(this,i);this.closeBookingWindow=e(this,"closeBookingWindow",7);this.bookingCreated=e(this,"bookingCreated",7);this.blockedCreated=e(this,"blockedCreated",7);this.resetBookingData=e(this,"resetBookingData",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.toast=e(this,"toast",7);this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new st;this.bookPropertyService=new rt;this.eventsService=new lt;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.buttonName=""}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}else return}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();const{key:e,data:i}=t.detail;if(e==="select"){const t=await this.bookingService.getExposedBooking(i.booking_nbr,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}else if(e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}async componentWillLoad(){this.bookingService.setToken(A.token);this.eventsService.setToken(A.token);this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE};this.handleKeyDown=this.handleKeyDown.bind(this);if(!this.bookingData.defaultDateRange){return}this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange);try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);if(this.isEventType("EDIT_BOOKING")){this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}if(this.defaultData.event_type==="SPLIT_BOOKING"){this.showSplitBookingOption=true;this.page="page_one"}else if(this.defaultData.event_type==="BLOCK_DATES"){this.page="page_block_date"}else{this.page="page_one"}}catch(t){console.error("Error fetching setup entries:",t)}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){if(this.guestData.length===0){return true}for(const t of this.guestData){if(t.guestName===""||(t.preference===""||t.preference===0)&&t.is_bed_configuration_enabled){return true}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.id,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag,type:t[0].type,id:t[0].id}}}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.adultChildCount=Object.assign({},t.detail)}async initializeBookingAvailability(t,e){const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.defaultData.roomsInfo.map((t=>t.id));const n=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:s,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:n.roomtypes})}catch(t){}}getRoomCategoryByRoomId(t){var e;return(e=this.defaultData.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.physicalrooms.find((e=>e.id===+t))))}getSplitBookings(){return this.defaultData.hasOwnProperty("splitBookingEvents")&&this.defaultData.splitBookingEvents||[]}closeWindow(){this.dateRangeData={};this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.initializeBookingAvailability(d(new Date(this.dateRangeData.fromDate)),d(new Date(this.dateRangeData.toDate)))}}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}renderPage(){this.renderAgain=!this.renderAgain}gotoSplitPageTwo(){this.gotoPage("page_two")}gotoPage(t){this.page=t;this.renderPage()}showSplitBooking(){this.showSplitBookingOption=true;this.gotoPage("page_one")}getPageBlockDatesView(){return i(n,null,i("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),i("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},i("button",{class:"btn btn-secondary flex-fill",onClick:()=>this.closeWindow()},M.entries.Lcz_Cancel),i("button",{class:"btn btn-primary flex-fill",onClick:()=>this.handleBlockDate()},M.entries.Lcz_Blockdates)))}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);this.buttonName="book";break;case"bookAndCheckIn":this.bookUser(true);this.buttonName="bookAndCheckIn";break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(this.selectedUnits.size>0){this.gotoPage("page_two");break}else{if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}}this.toast.emit({type:"error",description:M.entries.Lcz_SelectRatePlan,title:M.entries.Lcz_SelectRatePlan});break;case"check":this.initializeBookingAvailability(d(new Date(this.dateRangeData.fromDate)),d(new Date(this.dateRangeData.toDate)));break}}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(){const t=f(+this.blockDatesData.RELEASE_AFTER_HOURS);const e=await this.bookingService.blockUnit(Object.assign({from_date:d(this.defaultData.defaultDateRange.fromDate),to_date:d(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t));const i=await u(e);this.blockedCreated.emit(i);this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else{if(this.isButtonDisabled()){this.isLoading="";return}}try{if(["003","002","004"].includes(this.defaultData.STATUS_CODE)){this.eventsService.deleteEvent(this.defaultData.POOL)}if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}const e=await this.bookPropertyService.prepareBookUserServiceParams(this,t,this.sourceOption);await this.bookingService.bookUser(...e);this.resetBookingData.emit(null)}catch(t){}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}getArrivalTimeForBooking(){return this.bookedByInfoData.arrivalTime.find((t=>t.CODE_VALUE_EN===this.defaultData.ARRIVAL_TIME)).CODE_NAME}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}onRoomDataUpdate(t){const e=this.bookPropertyService.onDataRoomUpdate(t,this.selectedUnits,this.isEventType("EDIT_BOOKING"),this.isEventType("EDIT_BOOKING")||this.isEventType("SPLIT_BOOKING")||this.isEventType("BAR_BOOKING"),this.defaultData.NAME);this.selectedUnits=new Map(e);this.renderPage()}getCurrentPage(t){return this.page===t}render(){return i(s,{key:"8117abdfaf7ea013c3ddca6e4eaed2835ef3c0f0"},i("div",{key:"e263b57fdd4afdf1fff39f7ab2ff3883ff5d560e",class:"background-overlay",onClick:()=>this.closeWindow()}),i("div",{key:"b93952caaa6848540aa5cf3347f2b415416b74bf",class:"sideWindow pb-5 pb-md-0 "+(this.getCurrentPage("page_block_date")?"block-date":"")},i("div",{key:"b68bbfef584974fb79f6cf4ba3b10721dbf432b0",class:"card position-sticky mb-0 shadow-none p-0 "},i("div",{key:"6fb333d05f0225b6f27e2b805d0ea82b2fc814b7",class:"d-flex mt-2 align-items-center justify-content-between  "},i("h3",{key:"3d300f2627d48ddbb3c465a2a2194e8967c4bf6d",class:"card-title text-left pb-1 font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),i("ir-icon",{key:"74fbe216f3231e5ecd2fd58ddeaee9825d61c8c4",class:"close close-icon",onIconClickHandler:()=>{this.closeWindow()}},i("svg",{key:"497bf12d71434fe8b6bcf5d95787ed53c2766a33",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"1290b2980aa79f62bbb76e52fd5795c29f801174",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{key:"43a1452d5203be10cd9ecb76ec5d060916066c63",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&i("igl-booking-overview-page",{key:"0a893b21cd18695319b8f5821cc4c9792573656f",initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,onRoomsDataUpdate:t=>{this.onRoomDataUpdate(t)},sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&i("igl-pagetwo",{key:"4f65a3f58b1662aa11a98101f51a7a7599f48372",currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};dt.style=ht;const ft=".sc-igl-book-property-footer-h{display:block;margin:0;padding:0}.sc-igl-book-property-footer-h>*.sc-igl-book-property-footer{margin:auto;padding:auto}.gap-30.sc-igl-book-property-footer{gap:30px}";const ut=ft;const bt=class{constructor(i){t(this,i);this.buttonClicked=e(this,"buttonClicked",7);this.eventType=undefined;this.disabled=true}isEventType(t){return t===this.eventType}editNext(t){if(this.isEventType("EDIT_BOOKING")){if(t==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton(t,e,s=false,n){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("ir-button",{btn_color:t==="cancel"?"secondary":"primary",text:e,btn_disabled:s,onClickHanlder:()=>{this.buttonClicked.emit({key:t})},icon_name:n,iconPostion:"right",style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){return i(s,{key:"1c1b3b203de19a641835d7d63369aa2771277672"},i("div",{key:"c6f63cef6e45e2cedeb7a8768fa7b16156fa8ae8",class:"d-flex justify-content-between gap-30 align-items-center"},this.isEventType("EDIT_BOOKING")?i(n,null,this.renderButton("cancel",M.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${M.entries.Lcz_Next}`,L("/Get_Exposed_Booking_Availability"),"angles_right")):i(n,null,this.renderButton("cancel",M.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${M.entries.Lcz_Next}`,false,"angles_right"))))}};bt.style=ut;const pt=".sc-igl-book-property-header-h{display:block}.row.sc-igl-book-property-header{padding:0 0 0 15px;margin:0}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const gt=pt;const mt=class{constructor(i){t(this,i);this.splitBookingDropDownChange=e(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=e(this,"sourceDropDownChange",7);this.adultChild=e(this,"adultChild",7);this.checkClicked=e(this,"checkClicked",7);this.buttonClicked=e(this,"buttonClicked",7);this.toast=e(this,"toast",7);this.spiltBookingSelected=e(this,"spiltBookingSelected",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.sourceOption={code:"",description:"",tag:"",id:"",type:""};this.splitBookingId="";this.bookingData="";this.minDate=undefined;this.sourceOptions=[];this.message=undefined;this.bookingDataDefaultDateRange=undefined;this.showSplitBookingOption=false;this.adultChildConstraints=undefined;this.splitBookings=undefined;this.adultChildCount=undefined;this.dateRangeData=undefined;this.bookedByInfoData=undefined;this.defaultDaterange=undefined;this.propertyId=undefined}getSplitBookingList(){return i("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},i("label",{class:"mr-lg-1"},M.entries.Lcz_Tobooking,"# "),i("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},i("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:Y(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:Y(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:M.entries.Lcz_BookingNumber,onComboboxValue:t=>{t.stopImmediatePropagation();this.spiltBookingSelected.emit(t.detail)},isSplitBooking:true})))}getSourceNode(){return i("fieldset",{class:"d-flex text-left  align-items-center"},i("label",{class:"mr-1"},M.entries.Lcz_Source," "),i("div",{class:"btn-group mt-0 flex-fill sourceContainer"},i("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:t=>this.sourceDropDownChange.emit(t.target.value)},this.sourceOptions.map((t=>{if(t.type==="LABEL"){return i("optgroup",{label:t.value})}return i("option",{value:t.id,selected:this.sourceOption.code===t.id},t.value)})))))}handleAdultChildChange(t,e){let i={};if(e===""){i=Object.assign(Object.assign({},this.adultChildCount),{[t]:0})}else{i=Object.assign(Object.assign({},this.adultChildCount),{[t]:e})}this.adultChild.emit(i)}getAdultChildConstraints(){return i("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},i("div",{class:"form-group my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},i("fieldset",null,i("div",{class:"btn-group "},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("adult",t.detail),select_id:"adult_child_select",firstOption:M.entries.Lcz_AdultsCaption,LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&i("fieldset",null,i("div",{class:"btn-group ml-1"},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("child",t.detail),select_id:"child_select",firstOption:this.renderChildCaption(),LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),i("ir-button",{btn_id:"check_availability",isLoading:L("/Get_Exposed_Booking_Availability"),icon:"",size:"sm",class:"ml-2",text:M.entries.Lcz_Check,onClickHanlder:()=>this.handleButtonClicked()})))}renderChildCaption(){const t=this.adultChildConstraints.child_max_age;let e=M.entries.Lcz_Years;if(t===1){e=M.entries.Lcz_Year}return`${M.entries.Lcz_ChildCaption} < ${this.adultChildConstraints.child_max_age} ${e}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:M.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=Y(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const e=Y(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=Y(new Date(this.dateRangeData.fromDate));const s=Y(new Date(this.dateRangeData.toDate));if(s.isBefore(e)||i.isAfter(t)){this.toast.emit({type:"error",title:`${M.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",Y(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",Y(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:M.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${M.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",Y(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",Y(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:M.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(t){return this.bookingData.event_type===t}render(){const t=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return i(s,{key:"55b62ea25933b51ecf1a7052d24a843643a2e8f2"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),t&&this.getSourceNode(),i("div",{key:"f14db7d62fa5aefeb952a523380dc24673302092",class:`d-flex flex-column flex-lg-row align-items-lg-center ${t?"mt-1":""}`},i("fieldset",{key:"ffb400ea8577bd6142702c5b65f120cabb34598f",class:"mt-lg-0  "},i("igl-date-range",{key:"85df3428f3d308a04ec291741744fdd78e6a669f",dateLabel:M.entries.Lcz_Dates,minDate:this.isEventType("PLUS_BOOKING")?Y().add(-1,"months").startOf("month").format("YYYY-MM-DD"):this.minDate,disabled:this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),i("p",{key:"ff20b95b2fc9723cd256c2b8ffaf798fb18f7940",class:"text-right mt-1 message-label"},A.tax_statement))}};mt.style=gt;class yt extends R{constructor(){super(...arguments);this.bookingService=new st}async reallocateEvent(t,e,i,s){try{const n=this.getToken();if(n){console.log(t,e,i,s);const{data:o}=await S.post(`/ReAllocate_Exposed_Room?Ticket=${n}`,{pool:t,destination_pr_id:e,from_date:i,to_date:s,extras:r});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}console.log(o);return o}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}async deleteEvent(t){try{const e=this.getToken();if(e){const{data:i}=await S.post(`/UnBlock_Exposed_Unit?Ticket=${e}`,{POOL:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}else{throw new Error("Invalid Token")}}catch(t){console.log(t);throw new Error(t)}}async updateBlockedEvent(t){try{const e=this.getToken();if(e){const i=f(+t.RELEASE_AFTER_HOURS);await this.deleteEvent(t.POOL);this.bookingService.setToken(e);const s=await this.bookingService.blockUnit(Object.assign({from_date:this.formatDate(t.FROM_DATE),to_date:this.formatDate(t.TO_DATE),pr_id:t.PR_ID,STAY_STATUS_CODE:t.OUT_OF_SERVICE?"004":t.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:t.RELEASE_AFTER_HOURS||"",NOTES:t.OPTIONAL_REASON||""},i));return s}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}formatDate(t){return t.split("/").join("-")}}const kt=".sc-igl-booking-event-h{display:block;position:absolute}.bookingEventBase.sc-igl-booking-event{position:absolute;background-color:rgb(49, 190, 241);width:100%;height:100%;border-radius:4px;transform:skewX(-22deg)}.bookingEventBase.skewedLeft.sc-igl-booking-event::before{content:'';position:absolute;top:0px;bottom:0;left:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:right;transform:skewX(22deg);border-radius:4px;border-top-left-radius:0;border-bottom-left-radius:0}.bookingEventBase.skewedRight.sc-igl-booking-event::before{content:'';position:absolute;top:0;bottom:0;right:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:left;transform:skewX(22deg);border-radius:4px;border-top-right-radius:0;border-bottom-right-radius:0}.bookingEventBase.border.skewedLeft.sc-igl-booking-event::before{border:1px solid #424242;border-right:0;border-left:0;border-top-right-radius:0;border-bottom-right-radius:0;top:-1px;height:20px;left:-4px}.bookingEventBase.border.skewedRight.sc-igl-booking-event::before{border:1px solid #424242;border-left:0;border-right:0;border-top-left-radius:0;border-bottom-left-radius:0;top:-1px;height:20px;right:-4px}.bookingEvent.sc-igl-booking-event{cursor:pointer}.bookingEventBase.sc-igl-booking-event{cursor:pointer}.bookingEventHiddenBase.sc-igl-booking-event{position:absolute;top:0;left:-4px;width:calc(100% + 8)}.bookingEventDragHandle.sc-igl-booking-event{position:absolute;top:0;width:15px;height:100%;opacity:0.1;background-color:rgba(0, 0, 0, 0.15);transform:skewX(-22deg);border-radius:4px;cursor:pointer}.splitBooking.sc-igl-booking-event{border-right:2px solid #000000}.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:block;opacity:1}.newEvent.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:none;opacity:1}.leftSide.sc-igl-booking-event{left:0}.leftSide.skewedLeft.sc-igl-booking-event{transform:skewX(0)}.rightSide.skewedRight.sc-igl-booking-event{transform:skewX(0)}.rightSide.sc-igl-booking-event{right:0}.bookingEventTitle.sc-igl-booking-event{color:#fff;font-size:0.8em;position:relative;max-width:calc(100% - 10px);overflow:hidden;text-overflow:ellipsis;top:2px;left:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none;cursor:pointer}.legend_circle.sc-igl-booking-event{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px;border:1px solid #fff}.noteIcon.sc-igl-booking-event{position:absolute;bottom:-8px;left:2px}.balanceIcon.sc-igl-booking-event{position:absolute;top:-8px;right:2px}";const vt=kt;var wt=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++){if(e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n]))i[s[n]]=t[s[n]]}return i};const xt=class{constructor(i){t(this,i);this.hideBubbleInfo=e(this,"hideBubbleInfo",7);this.updateEventData=e(this,"updateEventData",7);this.dragOverEventData=e(this,"dragOverEventData",7);this.showRoomNightsDialog=e(this,"showRoomNightsDialog",7);this.showDialog=e(this,"showDialog",7);this.resetStreachedBooking=e(this,"resetStreachedBooking",7);this.toast=e(this,"toast",7);this.updateBookingEvent=e(this,"updateBookingEvent",7);this.dayWidth=0;this.eventSpace=8;this.vertSpace=10;this.showInfoPopup=false;this.bubbleInfoTopSide=false;this.isStreatch=false;this.eventsService=new yt;this.bookingService=new b;this.resizeSide="";this.isDragging=false;this.animationFrameId=null;this.handleMouseMoveBind=this.handleMouseMove.bind(this);this.handleMouseUpBind=this.handleMouseUp.bind(this);this.handleClickOutsideBind=this.handleClickOutside.bind(this);this.currency=undefined;this.is_vacation_rental=false;this.language=undefined;this.bookingEvent=undefined;this.allBookingEvents=[];this.countryNodeList=undefined;this.renderElement=false;this.position=undefined;this.isShrinking=null}componentWillLoad(){this.bookingService.setToken(A.token);this.eventsService.setToken(A.token);window.addEventListener("click",this.handleClickOutsideBind)}async fetchAndAssignBookingData(){try{console.log("clicked on book#",this.bookingEvent.BOOKING_NUMBER);const t=["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"];if(!t.includes(this.bookingEvent.STATUS)){return}const e=await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER,"en");const i=e.rooms.filter((t=>t["assigned_units_pool"]===this.bookingEvent.ID));if(i.length===0){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty array`)}if(i.some((t=>t["assigned_units_pool"]===null))){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty pool`)}e.rooms=i;const s=z(e)[0];const n=wt(s,["ID","TO_DATE","FROM_DATE","NO_OF_DAYS","STATUS","NAME","IDENTIFIER","PR_ID","POOL","BOOKING_NUMBER","NOTES","is_direct","BALANCE"]);this.bookingEvent=Object.assign(Object.assign(Object.assign({},n),this.bookingEvent),{PHONE_PREFIX:n.PHONE_PREFIX,PRIVATE_NOTE:n.PRIVATE_NOTE});this.updateBookingEvent.emit(this.bookingEvent);this.showEventInfo(true)}catch(t){console.error(t.message)}}componentDidLoad(){if(this.isNewEvent()){if(!this.bookingEvent.hideBubble){setTimeout((async()=>{if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}else{this.showEventInfo(true)}this.renderAgain()}),1)}}}disconnectedCallback(){window.removeEventListener("click",this.handleClickOutsideBind);if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}}handleClickOutside(t){const e=t.target;if(!this.element.contains(e)){this.showEventInfo(false)}}hideBubbleInfoPopup(t){if(t.detail.currentInfoBubbleId!=this.getBookingId()||t.detail.key==="hidebubble"&&t.detail.currentInfoBubbleId===this.getBookingId()){this.showInfoPopup=false;this.renderAgain()}}async moveBookingToHandler(t){try{if(t.detail.bookingId!==this.getBookingId()){this.showEventInfo(false);return}if(t.detail.moveToDay==="revert"||t.detail.toRoomId==="revert"){t.detail.moveToDay=this.bookingEvent.FROM_DATE;t.detail.toRoomId=t.detail.fromRoomId;if(this.isTouchStart&&this.moveDiffereneX<=5&&this.moveDiffereneY<=5&&!this.isStreatch){if(F(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));return}}else{if(this.isTouchStart&&this.moveDiffereneX<=5&&this.moveDiffereneY<=5&&!this.isStreatch){if(F(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{const{pool:e,to_date:i,from_date:s,toRoomId:n}=t.detail;if(this.checkIfSlotOccupied(n,s,i)){this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));throw new Error("Overlapping Dates")}if(e){if(F(this.bookingEvent.STATUS_CODE)){await this.eventsService.reallocateEvent(e,n,s,i).catch((()=>{this.resetBookingToInitialPosition()}))}else{if(this.isShrinking||!this.isStreatch){console.log(this.bookingEvent.PR_ID.toString()===n.toString(),this.bookingEvent.PR_ID.toString(),n.toString());const{description:e,status:o}=this.getModalDescription(n,s,i);let a=false;if(o==="400"){a=true}this.showDialog.emit(Object.assign(Object.assign({},t.detail),{description:e,title:"",hideConfirmButton:a}))}else{this.showRoomNightsDialog.emit({bookingNumber:this.bookingEvent.BOOKING_NUMBER,identifier:this.bookingEvent.IDENTIFIER,to_date:i,pool:e,from_date:s})}}this.isShrinking=null}}}}catch(t){this.toast.emit({position:"top-right",title:t.message,description:"",type:"error"});console.log("something went wrong")}}getModalDescription(t,e,i){console.log(`toRoomId: ${t}`,"\n",`new from_date: ${e}`,"\n",`new to_date: ${i}`,"\n",`old from_date: ${this.bookingEvent.FROM_DATE}`,"\n",`old to_date: ${this.bookingEvent.TO_DATE}`);const s=t=>{let e=this.bookingEvent.roomsInfo.filter((e=>e.physicalrooms.some((e=>e.id===+t))));if(e.length){return e[0].id}return null};if(!this.bookingEvent.is_direct){if(this.isShrinking){return{description:`${M.entries.Lcz_YouWillLoseFutureUpdates}.`,status:"200"}}else{if(Y(e,"YYYY-MM-DD").isSame(Y(this.bookingEvent.FROM_DATE,"YYYY-MM-DD"))&&Y(i,"YYYY-MM-DD").isSame(Y(this.bookingEvent.TO_DATE,"YYYY-MM-DD"))){const e=s(this.bookingEvent.PR_ID);const i=s(t);if(e===i){return{description:`${M.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:`${M.entries.Lcz_YouWillLoseFutureUpdates} ${this.bookingEvent.origin?this.bookingEvent.origin.Label:""}. ${M.entries.Lcz_SameRatesWillBeKept}`,status:"200"}}}return{description:M.entries.Lcz_CannotChangeCHBookings,status:"400"}}}else{if(!this.isShrinking){const e=s(this.bookingEvent.PR_ID);const i=s(t);if(e===i){console.log("same rt");return{description:`${M.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:M.entries.Lcz_SameRatesWillBeKept,status:"200"}}}return{description:M.entries.Lcz_ConfrmModiication,status:"200"}}}resetBookingToInitialPosition(){if(this.isStreatch){this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${this.initialWidth}px`;this.isStreatch=false;this.finalWidth=this.initialWidth;this.isShrinking=null}else{this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`}}handleRevertBooking(t){if(this.bookingEvent.POOL===t.detail){this.resetBookingToInitialPosition()}}checkIfSlotOccupied(t,e,i){const s=Y(e,"YYYY-MM-DD");const n=Y(i,"YYYY-MM-DD");const o=this.allBookingEvents.some((e=>{if(e.POOL===this.bookingEvent.POOL){return false}const i=Y(e.FROM_DATE,"YYYY-MM-DD").add(1,"days");const o=Y(e.TO_DATE,"YYYY-MM-DD");return e.PR_ID===+t&&n.isSameOrAfter(i)&&s.isBefore(o)}));return o}renderAgain(){this.renderElement=!this.renderElement}getUniqueId(){return(new Date).getTime()}isSplitBooking(){return!!this.bookingEvent.SPLIT_BOOKING}isNewEvent(){return this.getBookingId()==="NEW_TEMP_EVENT"}isHighlightEventType(){return this.getEventType()==="HIGH_LIGHT"}getBookingId(){return this.bookingEvent.ID}getBookingStatus(){return this.bookingEvent.STATUS}getBookedBy(){return this.bookingEvent.NAME}getBookedRoomId(){return this.bookingEvent.PR_ID}getEventStartingDate(){return new Date(this.bookingEvent.FROM_DATE)}getEventEndingDate(){return new Date(this.bookingEvent.TO_DATE)}getEventType(){return this.bookingEvent.event_type}getEventLegend(){var t,e;let i=(t=this.bookingEvent)===null||t===void 0?void 0:t.legendData.statusId[this.getBookingStatus()];let s=this.isNewEvent()?{color:"#f9f9c9"}:{};return Object.assign(Object.assign(Object.assign({},(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData[i.id]),i),s)}getLegendOfStatus(t){var e;let i=(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData.statusId[t];return Object.assign(Object.assign({},this.bookingEvent.legendData[i.id]),i)}getNoteNode(){if(this.bookingEvent.NOTES||this.bookingEvent.INTERNAL_NOTE||this.bookingEvent.PRIVATE_NOTE){return this.getLegendOfStatus("NOTES")}return null}getBalanceNode(){if(this.bookingEvent.BALANCE!==null&&this.bookingEvent.BALANCE>=1){return this.getLegendOfStatus("OUTSTANDING-BALANCE")}return null}setStayDays(t){this.bookingEvent.NO_OF_DAYS=t;this.renderAgain()}getStayDays(){return this.bookingEvent.NO_OF_DAYS}getPosition(){let t=this.getEventStartingDate();let e=".room_"+this.getBookedRoomId()+"_"+t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear();let i=document.querySelector(".bodyContainer");let s=document.querySelector(e);let n={top:"0",left:"0",width:"0",height:"20px"};if(s&&i&&s.getBoundingClientRect()&&i.getBoundingClientRect()){let t=i.getBoundingClientRect();let e=s.getBoundingClientRect();this.dayWidth=this.dayWidth||e.width;n.top=e.top+e.height/2-this.vertSpace-t.top+"px";n.left=e.left+(!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?0:this.dayWidth/2)+this.eventSpace/2-t.left+"px";n.width=(this.getStayDays()+(!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?.5:0))*this.dayWidth-this.eventSpace+"px"}else{console.log(this.bookingEvent);console.log("Locating event cell failed ",e)}return n}getNumber(t){return t?parseFloat(t):0}startDragging(t,e){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();if(this.isNewEvent()||this.isHighlightEventType()){return null}this.resizeSide=e;this.isDragging=true;this.showEventInfo(false);this.isStreatch=e!=="move";if(e==="move"){this.initialX=t.clientX||t.touches[0].clientX;this.initialY=t.clientY||t.touches[0].clientY;this.elementRect=this.element.getBoundingClientRect();const e=0;const i=0;this.dragInitPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top)+i,left:this.getNumber(this.element.style.left)+e};this.dragInitPos.x=this.dragInitPos.left;this.dragInitPos.y=this.dragInitPos.top;this.dragEndPos=Object.assign({},this.dragInitPos);this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`;this.isTouchStart=true;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:this.dragInitPos})}else{this.initialWidth=this.element.offsetWidth;this.initialLeft=this.element.offsetLeft;this.initialX=t.clientX||t.touches[0].clientX;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:{id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top),left:this.initialLeft,x:this.initialX,y:t.clientY||t.touches[0].clientY}})}document.addEventListener("mousemove",this.handleMouseMoveBind);document.addEventListener("touchmove",this.handleMouseMoveBind);document.addEventListener("pointermove",this.handleMouseMoveBind);document.addEventListener("mouseup",this.handleMouseUpBind);document.addEventListener("touchup",this.handleMouseUpBind);document.addEventListener("pointerup",this.handleMouseUpBind)}handleMouseMove(t){if(this.isDragging){this.currentX=t.clientX||t.touches[0].clientX;let e=this.currentX-this.initialX;if(this.resizeSide==="move"){this.currentY=t.clientY||t.touches[0].clientY;let i=this.currentY-this.initialY;this.element.style.top=`${this.dragInitPos.top+i}px`;this.element.style.left=`${this.dragInitPos.left+e}px`;this.dragEndPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.dragInitPos.top+i,left:this.dragInitPos.left+e};this.dragEndPos.x=this.dragEndPos.left;this.dragEndPos.y=this.dragEndPos.top;this.dragOverEventData.emit({id:"DRAG_OVER",data:this.dragEndPos})}else{if(!this.bookingEvent.is_direct&&!F(this.bookingEvent.STATUS_CODE)){return}let t=this.initialWidth;if(this.resizeSide=="rightSide"){t=this.initialWidth+e;t=Math.min(t,this.initialX+this.element.offsetWidth);t=Math.max(this.dayWidth-this.eventSpace,t);this.element.style.width=`${t}px`;this.isShrinking=e<0}else if(this.resizeSide=="leftSide"){this.isShrinking=e>0;t=Math.max(this.dayWidth-this.eventSpace,this.initialWidth-e);let i=this.initialLeft+(this.initialWidth-t);this.element.style.left=`${i}px`;this.element.style.width=`${t}px`}this.finalWidth=t}}else{console.log("still mouse move listening...")}}handleMouseUp(){if(this.isDragging){if(this.resizeSide==="move"){if(this.isTouchStart){this.moveDiffereneX=Math.abs(this.dragEndPos.x-this.dragInitPos.x);this.moveDiffereneY=Math.abs(this.dragEndPos.y-this.dragInitPos.y)}this.dragOverEventData.emit({id:"DRAG_OVER_END",data:Object.assign(Object.assign({},this.dragEndPos),{pool:this.bookingEvent.POOL,nbOfDays:this.bookingEvent.NO_OF_DAYS})})}else{let t=Math.round(this.finalWidth/this.dayWidth);let e=this.getStayDays();if(e!=t&&!isNaN(t)){if(this.resizeSide=="leftSide"){this.element.style.left=`${this.initialLeft+(e-t)*this.dayWidth}px`}else{if(t<e){this.isShrinking=true}}this.dragOverEventData.emit({id:"STRETCH_OVER_END",data:{id:this.getBookingId(),fromRoomId:+this.getBookedRoomId(),x:+this.element.style.left.replace("px",""),y:+this.element.style.top.replace("px",""),pool:this.bookingEvent.POOL,nbOfDays:t}});this.element.style.width=`${t*this.dayWidth-this.eventSpace}px`}else{this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${t*this.dayWidth-this.eventSpace}px`}}}else{console.log("still mouse up listening...")}this.isDragging=false;document.removeEventListener("mousemove",this.handleMouseMoveBind);document.removeEventListener("touchmove",this.handleMouseMoveBind);document.removeEventListener("pointermove",this.handleMouseMoveBind);document.removeEventListener("mouseup",this.handleMouseUpBind);document.removeEventListener("touchup",this.handleMouseUpBind);document.removeEventListener("pointerup",this.handleMouseUpBind)}updateData(t){this.updateEventData.emit(t)}renderEventBookingNumber(){if(this.bookingEvent.STATUS==="TEMP-EVENT"||this.bookingEvent.ID==="NEW_TEMP_EVENT"){return""}if(F(this.bookingEvent.STATUS_CODE)){return""}if(!this.bookingEvent.is_direct){return` - ${this.bookingEvent.channel_booking_nbr}`}return` - ${this.bookingEvent.BOOKING_NUMBER}`}showEventInfo(t){if(this.isHighlightEventType()||this.bookingEvent.hideBubble){return null}if(t){let t=document.querySelector(".calendarScrollContainer");let e=t.getBoundingClientRect();let i=this.element.getBoundingClientRect();let s=e.height/2+e.top+50;if(i.top<s){this.bubbleInfoTopSide=false}else{this.bubbleInfoTopSide=true}}if(t){this.hideBubbleInfo.emit({key:"hidePopup",currentInfoBubbleId:this.getBookingId()})}this.showInfoPopup=t;this.renderAgain()}render(){let t=this.getEventLegend();let e=this.getNoteNode();let o=this.getBalanceNode();return i(s,{key:"72b7c1f85387982e1134d53f72c4a54afbddd895",class:`bookingEvent  ${this.isNewEvent()||this.isHighlightEventType()?"newEvent":""} ${t.clsName} `,style:this.getPosition(),id:"event_"+this.getBookingId()},i("div",{key:"f42081d9fee9022beeb68ab480771a58c73e06dd",class:`bookingEventBase ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n          ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}\n          ${!this.bookingEvent.is_direct&&!F(this.bookingEvent.STATUS_CODE)&&this.bookingEvent.STATUS!=="TEMP-EVENT"&&this.bookingEvent.ID!=="NEW_TEMP_EVENT"&&"border border-dark"}  ${this.isSplitBooking()?"splitBooking":""}`,style:{backgroundColor:t.color,"--ir-event-bg":t.color},onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")}),e?i("div",{class:"legend_circle noteIcon",style:{backgroundColor:e.color}}):null,o?i("div",{class:"legend_circle balanceIcon",style:{backgroundColor:o.color}}):null,i("div",{key:"19eeaf522639272305843a72e3abd90afd3de902",class:"bookingEventTitle",onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")},this.getBookedBy(),this.renderEventBookingNumber()),i(n,{key:"a329dc0e976574ebab5a038c45f953ea107ef8d2"},i("div",{key:"122d84cde785b1df0da38ad6582ae70f96e8e917",class:`bookingEventDragHandle leftSide ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n            ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"leftSide"),onMouseDown:t=>this.startDragging(t,"leftSide")}),i("div",{key:"9e0d0f36a3e6a4c07a29521915e0e566e14780e4",class:`bookingEventDragHandle rightSide ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n              ${!this.isNewEvent()&&Y(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"rightSide"),onMouseDown:t=>this.startDragging(t,"rightSide")})),this.showInfoPopup?i("igl-booking-event-hover",{is_vacation_rental:this.is_vacation_rental,countryNodeList:this.countryNodeList,currency:this.currency,class:"top",bookingEvent:this.bookingEvent,bubbleInfoTop:this.bubbleInfoTopSide}):null)}get element(){return o(this)}};xt.style=vt;const _t=(t,e="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:e}).format(t);const Dt=".sc-igl-booking-event-hover-h{display:block;position:relative;z-index:100}.btn.sc-igl-booking-event-hover{padding-left:4px !important;padding-right:4px !important}.balance_amount.sc-igl-booking-event-hover{color:#ff4961;font-size:0.75rem}.user-notes.sc-igl-booking-event-hover{margin-left:4px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:5;line-clamp:5;overflow:hidden;max-width:100%;height:auto}.events_btns.sc-igl-booking-event-hover{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem}.mx-01.sc-igl-booking-event-hover{--m:5px;margin-left:var(--m) !important;margin-right:var(--m) !important}.pointerContainer.sc-igl-booking-event-hover{position:absolute;left:50%;height:10px;width:350px;transform:translate(-50%, 0)}.pointerContainerTop.sc-igl-booking-event-hover{top:-26px}.iglPopOver.sc-igl-booking-event-hover{background-color:#fff;padding:10px;border:1px solid #656ee7;border-radius:6px;position:absolute;transform:translate(-50%, 10px);left:50%;box-shadow:1px 0px 20px rgba(0, 0, 0, 0.2)}.iglPopOver.infoBubble.sc-igl-booking-event-hover{width:350px}.iglPopOver.blockedView.sc-igl-booking-event-hover{max-width:400px;width:400px}.iglPopOver.newBookingOptions.sc-igl-booking-event-hover{overflow-wrap:break-word !important;min-width:230px;width:fit-content}.bubblePointer.sc-igl-booking-event-hover{position:absolute;width:0;height:0;left:50%;border-left:10px solid transparent;border-right:10px solid transparent;transform:translate(-50%, 0px)}.bubblePointTop.sc-igl-booking-event-hover{border-top:10px solid #656ee7}.bubblePointBottom.sc-igl-booking-event-hover{border-bottom:10px solid #656ee7}.bubbleInfoAbove.sc-igl-booking-event-hover{bottom:35px}.updateBtnIcon.sc-igl-booking-event-hover{margin-right:4px}.icon-image.sc-igl-booking-event-hover{height:1.5rem;width:1.5rem;margin-right:5px}";const Ct=Dt;const Ot=class{constructor(i){t(this,i);this.showBookingPopup=e(this,"showBookingPopup",7);this.hideBubbleInfo=e(this,"hideBubbleInfo",7);this.deleteButton=e(this,"deleteButton",7);this.bookingCreated=e(this,"bookingCreated",7);this.todayTimeStamp=(new Date).setHours(0,0,0,0);this.eventService=new lt;this.hideButtons=false;this.bookingEvent=undefined;this.bubbleInfoTop=false;this.currency=undefined;this.countryNodeList=undefined;this.is_vacation_rental=false;this.isLoading=undefined;this.shouldHideUnassignUnit=false}componentWillLoad(){this.eventService.setToken(A.token);let t=this.bookingEvent.roomsInfo.find((t=>t.id===this.bookingEvent.RATE_TYPE));if(t){console.log(t.physicalrooms.length===1);this.shouldHideUnassignUnit=t.physicalrooms.length===1}if(Y(this.bookingEvent.TO_DATE,"YYYY-MM-DD").isBefore(Y())){this.hideButtons=true}this.handleKeyDown=this.handleKeyDown.bind(this)}handleKeyDown(t){if(t.key==="Escape"){this.hideBubble()}else return}hideBubble(){this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()});document.removeEventListener("keydown",this.handleKeyDown)}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}getBookingId(){return this.bookingEvent.ID}getTotalOccupants(){var t,e,i;const{CHILDREN_COUNT:s,ADULTS_COUNT:n}=this.bookingEvent;if(s===0){return`${n} ${n>1?M.entries.Lcz_AdultsCaption.toLowerCase():(t=M.entries.Lcz_Single_Adult)===null||t===void 0?void 0:t.toLowerCase()}`}return`${n} ${n>1?M.entries.Lcz_AdultsCaption.toLowerCase():(e=M.entries.Lcz_Single_Adult)===null||e===void 0?void 0:e.toLowerCase()}, ${s} ${s>1?M.entries.Lcz_ChildCaption.toLowerCase():(i=M.entries.Lcz_Single_Child)===null||i===void 0?void 0:i.toLowerCase()}`}getPhoneNumber(){return this.bookingEvent.PHONE}getCountry(){return p(this.bookingEvent.COUNTRY,this.countryNodeList).name}getPhoneCode(){if(this.bookingEvent.PHONE_PREFIX){return this.bookingEvent.PHONE_PREFIX}return p(this.bookingEvent.COUNTRY,this.countryNodeList).phone_prefix}renderPhone(){return this.bookingEvent.COUNTRY?`${this.bookingEvent.is_direct?this.getPhoneCode()+"-":""}${this.getPhoneNumber()} - ${this.getCountry()}`:this.getPhoneNumber()}getGuestNote(){return this.bookingEvent.NOTES&&i("p",{class:"user-notes p-0 my-0"},this.bookingEvent.NOTES)}getInternalNote(){return this.bookingEvent.INTERNAL_NOTE}getTotalPrice(){return this.bookingEvent.TOTAL_PRICE}getCheckInDate(){return this.bookingEvent.FROM_DATE_STR}getCheckOutDate(){return this.bookingEvent.TO_DATE_STR}getArrivalTime(){return this.bookingEvent.ARRIVAL_TIME}getRatePlan(){return this.bookingEvent.RATE_PLAN}getEntryDate(){return this.bookingEvent.ENTRY_DATE}getReleaseAfterHours(){return this.bookingEvent.RELEASE_AFTER_HOURS}isNewBooking(){return this.getBookingId()==="NEW_TEMP_EVENT"}isCheckedIn(){return this.bookingEvent.STATUS==="CHECKED-IN"}isCheckedOut(){return this.bookingEvent.STATUS==="CHECKED-OUT"}isBlockedDateEvent(){return this.bookingEvent.STATUS==="BLOCKED"||this.bookingEvent.STATUS==="BLOCKED-WITH-DATES"}getRoomId(){return this.bookingEvent.PR_ID}getCategoryByRoomId(t){return this.bookingEvent.roomsInfo.find((e=>e.physicalrooms.find((e=>e.id===t))))}hasSplitBooking(){return this.bookingEvent.hasOwnProperty("splitBookingEvents")&&this.bookingEvent.splitBookingEvents}canCheckIn(){if(!this.fromTimeStamp){let t=new Date(this.getCheckInDate());t.setHours(0,0,0,0);this.fromTimeStamp=t.getTime()}if(!this.toTimeStamp){let t=new Date(this.getCheckOutDate());t.setHours(0,0,0,0);this.toTimeStamp=t.getTime()}if(this.isCheckedIn()||this.isCheckedOut()){return false}if(this.fromTimeStamp<=this.todayTimeStamp&&this.todayTimeStamp<=this.toTimeStamp){return true}else{return false}}canCheckOut(){if(this.isCheckedIn()&&this.todayTimeStamp<=this.toTimeStamp){return true}else{return false}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookingEvent=Object.assign(Object.assign({},this.bookingEvent),e.data)}handleEditBooking(){this.bookingEvent.TITLE=M.entries.Lcz_EditBookingFor;this.handleBookingOption("EDIT_BOOKING")}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}handleAddRoom(){let t=new Date(this.bookingEvent.FROM_DATE);t.setHours(0,0,0,0);let e=this.getStringDateFormat(t);let i=new Date(this.bookingEvent.TO_DATE);i.setHours(0,0,0,0);let s=this.getStringDateFormat(i);let n={ID:"",NAME:"",BOOKING_NUMBER:this.bookingEvent.BOOKING_NUMBER,FROM_DATE:e,TO_DATE:s,roomsInfo:this.bookingEvent.roomsInfo,ARRIVAL:this.bookingEvent.ARRIVAL,ADD_ROOM_TO_BOOKING:this.bookingEvent.ID,TITLE:"Add Room to #"+this.bookingEvent.BOOKING_NUMBER,event_type:"ADD_ROOM",ROOMS:this.bookingEvent.ROOMS,GUEST:this.bookingEvent.GUEST,message:this.bookingEvent.NOTES,SOURCE:this.bookingEvent.SOURCE,defaultDateRange:{fromDate:t,fromDateStr:"",toDate:i,toDateStr:"",dateDifference:0,editabled:true,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};this.handleBookingOption("ADD_ROOM",n)}handleCustomerCheckIn(){console.log("Handle Customer Check In")}handleCustomerCheckOut(){console.log("Handle Customer Check Out")}handleDeleteEvent(){this.hideBubble();this.deleteButton.emit(this.bookingEvent.POOL);console.log("Delete Event")}async handleUpdateBlockedDates(){try{this.isLoading="update";setTimeout((()=>{this.hideBubble()}),50);await this.eventService.updateBlockedEvent(this.bookingEvent);this.isLoading=""}catch(t){}}handleConvertBlockedDateToBooking(){this.handleBookingOption("BAR_BOOKING")}getRoomInfo(){const t=+this.bookingEvent.PR_ID;let e={};for(const i of this.bookingEvent.roomsInfo){for(const s of i.physicalrooms){if(t===s.id){e.CATEGORY=i.name;e.ROOM_NAME=s.name;e.ROOMS_INFO=i;return e}}}return e}renderTitle(t,e){switch(t){case"EDIT_BOOKING":return`${M.entries.Lcz_EditBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`;case"ADD_ROOM":return`${M.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;case"SPLIT_BOOKING":return M.entries.Lcz_Adding+` ${e.CATEGORY} ${e.ROOM_NAME}`;default:return`${M.entries.Lcz_NewBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`}}handleBookingOption(t,e=null){const i=this.getRoomInfo();let s=e?e:this.bookingEvent;s.event_type=t;s.TITLE=this.renderTitle(t,i);if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){s.roomsInfo=[i.ROOMS_INFO]}this.showBookingPopup.emit({key:"add",data:Object.assign({},s)});this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}renderNote(){const{is_direct:t,ota_notes:e}=this.bookingEvent;const s=this.getGuestNote();const o=M.entries.Lcz_Note+":";if(!t&&e){return i("div",{class:"row p-0 m-0"},i("div",{class:"col-12 px-0 text-wrap d-flex"},i("ota-label",{label:o,remarks:e})))}else if(t&&s){return i("div",{class:"row p-0 m-0"},i("div",{class:"col-12 px-0 text-wrap d-flex"},i(n,null,i("span",{class:"font-weight-bold"},o," "),s)))}return null}getInfoElement(){var t,e,s,o;return i("div",{class:`iglPopOver infoBubble ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},i("div",{class:`row p-0 m-0  ${this.bookingEvent.BALANCE>1?"pb-0":"pb-1"}`},i("div",{class:"px-0  col-8 font-weight-bold font-medium-1 d-flex align-items-center"},i("img",{src:(e=(t=this.bookingEvent)===null||t===void 0?void 0:t.origin)===null||e===void 0?void 0:e.Icon,alt:(o=(s=this.bookingEvent)===null||s===void 0?void 0:s.origin)===null||o===void 0?void 0:o.Label,class:"icon-image"}),i("p",{class:"p-0 m-0"},!this.bookingEvent.is_direct?this.bookingEvent.channel_booking_nbr:this.bookingEvent.BOOKING_NUMBER)),i("div",{class:"pr-0 col-4 text-right"},_t(this.getTotalPrice(),this.currency.code))),this.bookingEvent.BALANCE>1&&i("p",{class:"pr-0 m-0 p-0 text-right balance_amount"},M.entries.Lcz_Balance,": ",_t(this.bookingEvent.BALANCE,this.currency.code)),i("div",{class:"row p-0 m-0"},i("div",{class:"px-0 pr-0 col-12"},i("ir-date-view",{from_date:this.bookingEvent.defaultDates.from_date,to_date:this.bookingEvent.defaultDates.to_date,showDateDifference:false}))),this.getArrivalTime()&&i("div",{class:"row p-0 m-0"},i("div",{class:"px-0 col-12"},i("span",{class:"font-weight-bold"},M.entries.Lcz_ArrivalTime,": "),this.getArrivalTime())),this.getTotalOccupants()&&i("div",{class:"row p-0 m-0"},i("div",{class:"px-0  col-12"},i("span",{class:"font-weight-bold"},M.entries.Lcz_Occupancy,": "),this.getTotalOccupants())),this.getPhoneNumber()&&i("div",{class:"row p-0 m-0"},i("div",{class:"px-0  col-12 text-wrap"},i("span",{class:"font-weight-bold"},M.entries.Lcz_Phone,": "),this.renderPhone())),this.getRatePlan()&&i("div",{class:"row p-0 m-0"},i("div",{class:"px-0  col-12"},i("span",{class:"font-weight-bold"},M.entries.Lcz_RatePlan,": "),this.getRatePlan())),this.bookingEvent.PRIVATE_NOTE&&i("div",{class:"row p-0 m-0"},i("div",{class:"px-0  col-12 text-wrap"},i("span",{class:"font-weight-bold"},M.entries.Lcz_PrivateNote,": "),this.bookingEvent.PRIVATE_NOTE)),this.renderNote(),this.getInternalNote()?i("div",{class:"row p-0 m-0"},i("div",{class:"col-12 px-0 text-wrap"},this.bookingEvent.is_direct?i(n,null,i("span",{class:"font-weight-bold"},M.entries.Lcz_InternalRemark,": "),this.getInternalNote()):i("ota-label",{label:`${M.entries.Lcz_InternalRemark}:`,remarks:this.bookingEvent.ota_notes}))):null,i("div",{class:"row p-0 m-0 mt-2"},i("div",{class:"full-width btn-group  btn-group-sm font-small-3",role:"group"},i("button",{type:"button",class:`btn btn-primary events_btns ${this.hideButtons?"mr-0":"mr-1"} ${this.shouldHideUnassignUnit?"w-50":""}`,onClick:t=>{this.handleEditBooking()}},i("ir-icons",{name:"edit",style:{"--icon-size":"0.875rem"}}),i("span",null,M.entries.Lcz_Edit)),this.bookingEvent.is_direct&&this.bookingEvent.IS_EDITABLE&&!this.hideButtons&&i("button",{type:"button",class:`btn btn-primary events_btns ${!this.shouldHideUnassignUnit?"mr-1":"w-50"}`,onClick:t=>{this.handleAddRoom()}},i("ir-icons",{name:"square_plus",style:{"--icon-size":"0.875rem"}}),i("span",null,M.entries.Lcz_AddRoom)),this.hideButtons?null:!this.shouldHideUnassignUnit&&i("button",{type:"button",class:"btn btn-primary events_btns",onClick:t=>{this.handleDeleteEvent()}},i("ir-icons",{name:"xmark",style:{"--icon-size":"0.875rem"}}),i("span",{class:"m-0 p-0"},M.entries.Lcz_Unassign)))))}getNewBookingOptions(){const t=this.bookingEvent.roomsInfo[0].rateplans.some((t=>t.is_active));return i("div",{class:`iglPopOver newBookingOptions ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},t?i(n,null,i("button",{type:"button",class:"d-block full-width btn btn-sm btn-primary mb-1 font-small-3 square",onClick:t=>{this.handleBookingOption("BAR_BOOKING")}},M.entries.Lcz_CreateNewBooking),this.hasSplitBooking()?i("button",{type:"button",class:"d-block full-width btn btn-sm btn-primary mb-1 font-small-3 square",onClick:t=>{this.handleBookingOption("SPLIT_BOOKING")}},M.entries.Lcz_AssignUnitToExistingBooking):null):i("p",{class:"text-danger"},M.entries.Lcz_NoRatePlanDefined),i("button",{type:"button",class:"d-block full-width btn btn-sm btn-primary font-small-3 square",onClick:t=>{this.handleBookingOption("BLOCK_DATES")}},M.entries.Lcz_Blockdates))}getBlockedView(){return i("div",{class:`iglPopOver blockedView ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},i("igl-block-dates-view",{isEventHover:true,entryHour:this.bookingEvent.ENTRY_HOUR,entryMinute:this.bookingEvent.ENTRY_MINUTE,defaultData:this.bookingEvent,fromDate:Y(this.bookingEvent.defaultDates.from_date,"YYYY-MM-DD").format("DD MM YYYY"),toDate:Y(this.bookingEvent.defaultDates.to_date,"YYYY-MM-DD").format("DD MM YYYY"),entryDate:this.getEntryDate(),onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),i("div",{class:"row p-0 m-0 mt-2"},i("div",{class:"full-width btn-group btn-group-sm font-small-3",role:"group"},i("button",{disabled:this.isLoading==="update",type:"button",class:"btn btn-primary mr-1 events_btns",onClick:t=>{this.handleUpdateBlockedDates()}},this.isLoading==="update"?i("i",{class:"la la-circle-o-notch spinner mx-1"}):i("ir-icons",{name:"edit",style:{"--icon-size":"0.875rem"}}),i("span",null,M.entries.Lcz_Update)),i("button",{type:"button",class:"btn btn-primary events_btns",onClick:t=>{this.handleConvertBlockedDateToBooking()}},M.entries.Lcz_ConvertToBooking),i("button",{type:"button",class:"btn btn-danger ml-1 events_btns",onClick:t=>{this.handleDeleteEvent()}},i("ir-icons",{name:"trash",style:{"--icon-size":"0.875rem"}}),i("span",null,M.entries.Lcz_Delete)))))}render(){return i(s,{key:"423937bf3e14f02026c712fb36ba55a220ef443f"},i("div",{key:"dfde52edfec5ac5d609d9ee62cd0da2d829e21e3",class:`pointerContainer ${this.bubbleInfoTop?"pointerContainerTop":""}`},i("div",{key:"5d4a31d8e0b1f96864e715e0692017ce44d3f541",class:`bubblePointer ${this.bubbleInfoTop?"bubblePointTop":"bubblePointBottom"}`})),this.isBlockedDateEvent()?this.getBlockedView():null,this.isNewBooking()?this.getNewBookingOptions():null,!this.isBlockedDateEvent()&&!this.isNewBooking()?this.getInfoElement():null)}get element(){return o(this)}};Ot.style=Ct;const Et=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const Tt=Et;const It=class{constructor(i){t(this,i);this.roomsDataUpdate=e(this,"roomsDataUpdate",7);this.bookingData=undefined;this.propertyId=undefined;this.message=undefined;this.showSplitBookingOption=undefined;this.eventType=undefined;this.currency=undefined;this.adultChildConstraints=undefined;this.ratePricingMode=undefined;this.dateRangeData=undefined;this.defaultDaterange=undefined;this.selectedRooms=undefined;this.adultChildCount=undefined;this.sourceOptions=undefined;this.bookedByInfoData=undefined;this.initialRoomIds=undefined}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const t=Y(this.bookingData.FROM_DATE,"YYYY-MM-DD");const e=Y();if(t.isAfter(e)){return e.add(-2,"weeks").format("YYYY-MM-DD")}return t.add(-2,"weeks").format("YYYY-MM-DD")}render(){var t,e;return i(s,{key:"10bb0647f1dda45256d5ebf4958db6e7617ea096"},i("igl-book-property-header",{key:"63fd9d685f7ae67eca115abcfdd593d6e6916d2b",bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"3c37f4c8c090eb15fd4e31db20c06bfab2308562",class:" text-left"},L("/Get_Exposed_Booking_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(n,null,(e=(t=this.bookingData)===null||t===void 0?void 0:t.roomsInfo)===null||e===void 0?void 0:e.map((t=>i("igl-booking-rooms",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomTypeData:t,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,defaultData:this.selectedRooms.get(`c_${t.id}`),onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)}))))),i("igl-book-property-footer",{key:"c934d624a9e3fe51a25070a00631539b0b76a80a",class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type,disabled:this.selectedRooms.size===0}))}};It.style=Tt;const Bt=".sc-igl-booking-room-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-booking-room-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-booking-room-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-booking-room-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-booking-room-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-state='focus'].sc-igl-booking-room-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-disabled].sc-igl-booking-room-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:40%}.rateplan-container.sc-igl-booking-room-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-booking-room-rate-plan{max-width:200px}.rate-input-container.sc-igl-booking-room-rate-plan{max-width:100px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:35%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-booking-room-rate-plan{width:100%}}.total-nights-container.sc-igl-booking-room-rate-plan{width:max-content}.nightBorder.sc-igl-booking-room-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const Mt=Bt;const At=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.gotoSplitPageTwoEvent=e(this,"gotoSplitPageTwoEvent",7);this.defaultData=undefined;this.ratePlanData=undefined;this.totalAvailableRooms=undefined;this.index=undefined;this.ratePricingMode=[];this.currency=undefined;this.physicalrooms=undefined;this.shouldBeDisabled=undefined;this.dateDifference=undefined;this.bookingType="PLUS_BOOKING";this.fullyBlocked=undefined;this.isBookDisabled=false;this.defaultRoomId=undefined;this.selectedRoom=undefined;this.is_bed_configuration_enabled=undefined;this.isInputFocused=false;this.selectedData=undefined;this.ratePlanChangedState=false}getAvailableRooms(t){let e=[];t.forEach((t=>{if(t.Is_Fully_Available){e.push({name:t.name,id:t.pr_id})}}));return e}componentWillLoad(){this.updateSelectedRatePlan(this.ratePlanData)}disableForm(){if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){return false}else{return this.selectedData.is_closed||this.totalAvailableRooms===0||A.is_frontdesk_enabled&&this.selectedData.physicalRooms.length===0}}setAvailableRooms(t){let e=this.getAvailableRooms(t);if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){if(this.selectedRoom){e.push({id:this.selectedRoom.roomId,name:this.selectedRoom.roomName});e.sort(((t,e)=>{if(t.name<e.name){return-1}if(t.name>e.name){return 1}return 0}))}}return e}getSelectedOffering(t){return this.ratePlanData.variations.find((e=>e.adult_child_offering===t))}updateSelectedRatePlan(t){var e;this.selectedData={is_bed_configuration_enabled:this.is_bed_configuration_enabled,ratePlanId:t.id,adult_child_offering:t.variations[0].adult_child_offering,rateType:1,totalRooms:0,rate:(e=t.variations[0].amount)!==null&&e!==void 0?e:0,ratePlanName:t.name,adultCount:t.variations[0].adult_nbr,childrenCount:t.variations[0].child_nbr,cancelation:t.cancelation,guarantee:t.guarantee,isRateModified:false,defaultSelectedRate:0,index:this.index,is_closed:t.is_closed,physicalRooms:this.setAvailableRooms(this.ratePlanData.assignable_units),dateDifference:this.dateDifference};if(this.defaultData){for(const[t,e]of Object.entries(this.defaultData)){this.selectedData[t]=e}this.selectedData["rateType"]=1}}componentDidLoad(){if(this.defaultData){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"physicalRooms",data:this.selectedData})}}async ratePlanDataChanged(t){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t.variations[0].adult_child_offering,adultCount:t.variations[0].adult_nbr,childrenCount:t.variations[0].child_nbr,rate:this.handleRateDaysUpdate(),physicalRooms:this.setAvailableRooms(t.assignable_units)});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}handleRateDaysUpdate(){if(this.selectedData.isRateModified){return this.selectedData.defaultSelectedRate}const t=this.getSelectedOffering(this.selectedData.adult_child_offering);return t?t.amount:0}handleInput(t){const e=t.target;let i=e.value.replace(/[^0-9.]/g,"");const s=/^\d*\.?\d*$/;if(!s.test(i)){i=i.substring(0,i.length-1)}e.value=i;if(i){this.selectedData.isRateModified=true;this.handleDataChange("rate",t)}else{this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:-1,totalRooms:0});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}}handleDataChange(t,e){const i=e.target.value;switch(t){case"adult_child_offering":this.updateOffering(i);break;case"rate":this.updateRate(i);break;default:this.updateGenericData(t,i);break}this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:t,data:this.selectedData})}updateOffering(t){const e=this.getSelectedOffering(t);if(e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t,adultCount:e.adult_nbr,childrenCount:e.child_nbr,rate:e.amount,isRateModified:false})}}updateRate(t){const e=t===""?0:Number(t);this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:e,totalRooms:t===""?0:this.selectedData.totalRooms,defaultSelectedRate:this.selectedData.rateType===2?e/this.dateDifference:e})}updateGenericData(t,e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{[t]:e===""?0:parseInt(e)})}bookProperty(){this.dataUpdateEvent.emit({key:"clearData",data:this.selectedData});this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){if(this.selectedData.isRateModified){console.log("selectedData.rate",this.selectedData.rate);return this.selectedData.rate===-1?"":this.selectedData.rate}return this.selectedData.rateType===1?Number(this.selectedData.rate).toFixed(2):Number(this.selectedData.rate/this.dateDifference).toFixed(2)}render(){return i(s,{key:"a034867af1eb7a8c4a17c619de19ec0cac96ffd1"},i("div",{key:"e5ed1c1cbca838ec8d2dcaacf4f736a333bd84b6",class:"d-flex flex-column m-0 p-0 flex-lg-row align-items-lg-center justify-content-lg-between "},i("div",{key:"584d2771ba66e6ba521c6048f8b0aa50b6fda427",class:"rateplan-name-container"},this.bookingType==="BAR_BOOKING"?i(n,null,i("span",{class:"font-weight-bold\t"},this.ratePlanData.name.split("/")[0]),i("span",null,"/",this.ratePlanData.name.split("/")[1])):i("span",null,this.ratePlanData.short_name),i("ir-tooltip",{key:"544bcec810e0eb07521ee8c371a4b58216d79967",message:this.ratePlanData.cancelation+this.ratePlanData.guarantee})),i("div",{key:"4f23e501566f807262dbbae160c667fc2273372a",class:"d-md-flex justify-content-md-end  align-items-md-center flex-fill rateplan-container"},i("div",{key:"c33b9536cb8c33e9f9da5ae50cae6d34ab23324c",class:"mt-1 mt-md-0 flex-fill max-w-300"},i("fieldset",{key:"0587315c40815c22d3fe274d45006d2ad533f0ee",class:"position-relative"},i("select",{key:"13a47a893c93874240644c985a8e307b6e42639f",disabled:this.disableForm(),class:"form-control  input-sm",id:N(),onChange:t=>this.handleDataChange("adult_child_offering",t)},this.ratePlanData.variations.map((t=>i("option",{value:t.adult_child_offering,selected:this.selectedData.adult_child_offering===t.adult_child_offering},t.adult_child_offering)))))),i("div",{key:"37da66fd94a035c3acae6e7ea1c87e700f2398a5",class:"m-0 p-0 mt-1 mt-md-0 d-flex justify-content-between align-items-md-center ml-md-1 "},i("div",{key:"150e6a6f6f03ab08361a929c89e209e0851c4019",class:" d-flex  m-0 p-0 rate-total-night-view  mt-0"},i("fieldset",{key:"a8d83407a5f0766c446115d4ff290e1d56548e36",class:"position-relative has-icon-left m-0 p-0 rate-input-container  "},i("div",{key:"ebfda851cb40c59270c08ec4fbb7fd39a060105a",class:"input-group-prepend"},i("span",{key:"f3441d4cfad04f81bfc616970dcdaee13aec9a8c","data-disabled":this.disableForm(),"data-state":this.isInputFocused?"focus":"",class:"input-group-text new-currency",id:"basic-addon1"},a(this.currency.code))),i("input",{key:"a1d40a0d7e67a833c60e93ba2426337cf63f73b2",onFocus:()=>this.isInputFocused=true,onBlur:()=>this.isInputFocused=false,disabled:this.disableForm(),type:"text",class:"form-control pl-0 input-sm rate-input py-0 m-0 rounded-0 rateInputBorder",value:this.renderRate(),id:N(),placeholder:M.entries.Lcz_Rate||"Rate",onInput:t=>this.handleInput(t)})),i("fieldset",{key:"cf2c15d69f7cf5a4e2c10fe8323744991963c3ac",class:"position-relative m-0 total-nights-container p-0 "},i("select",{key:"98f8c3c2b16201ed9115e179d9511e5c4eb57fdd",disabled:this.disableForm(),class:"form-control input-sm m-0 nightBorder rounded-0 m-0  py-0",id:N(),onChange:t=>this.handleDataChange("rateType",t)},this.ratePricingMode.map((t=>i("option",{value:t.CODE_NAME,selected:this.selectedData.rateType===+t.CODE_NAME},t.CODE_VALUE_EN)))))),this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"?i("div",{class:"flex-fill  mt-lg-0 ml-1 m-0 mt-md-0 p-0"},i("fieldset",{class:"position-relative"},i("select",{disabled:this.selectedData.rate===0||this.disableForm(),class:"form-control input-sm",id:N(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:this.totalAvailableRooms+1},((t,e)=>e)).map((t=>i("option",{value:t,selected:this.selectedData.totalRooms===t},t)))))):null),this.bookingType==="EDIT_BOOKING"?i(n,null,i("div",{class:" m-0 p-0  mt-lg-0  ml-md-1 mt-md-1 d-none d-md-block"},i("fieldset",{class:"position-relative"},i("input",{disabled:this.disableForm(),type:"radio",name:"ratePlanGroup",value:"1",onChange:t=>this.handleDataChange("totalRooms",t),checked:this.selectedData.totalRooms===1}))),i("button",{disabled:this.selectedData.rate===-1||this.disableForm(),type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 d-md-none ",onClick:()=>this.bookProperty()},this.selectedData.totalRooms===1?M.entries.Lcz_Current:M.entries.Lcz_Select)):null,this.bookingType==="BAR_BOOKING"||this.bookingType==="SPLIT_BOOKING"?i("button",{disabled:this.selectedData.rate===-1||this.disableForm()||this.bookingType==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 ",onClick:()=>this.bookProperty()},M.entries.Lcz_Book):null)))}static get watchers(){return{ratePlanData:["ratePlanDataChanged"]}}};At.style=Mt;const Nt=".sc-igl-booking-rooms-h{display:block}.margin-bottom-8.sc-igl-booking-rooms{margin-bottom:8px !important}";const Rt=Nt;const St=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"];this.roomTypeData=undefined;this.defaultData=undefined;this.bookingType="PLUS_BOOKING";this.dateDifference=undefined;this.ratePricingMode=[];this.roomInfoId=null;this.currency=undefined;this.selectedRooms=[];this.totalRooms=undefined;this.isBookDisabled=undefined;this.initialRoomIds=undefined;this.roomsDistributions=[]}componentWillLoad(){this.initializeRoomData()}initializeRoomData(){const{inventory:t,rateplans:e}=this.roomTypeData;this.totalRooms=t||0;this.selectedRooms=new Array(e.length).fill(0);this.roomsDistributions=this.calculateInitialDistributions(e,t)}handleRoomTypeData(){this.initializeRoomData()}calculateInitialDistributions(t,e){let i=new Array(t.length).fill(e);if(this.defaultData&&this.bookingType!=="EDIT_BOOKING"&&e>0){let t=[];let e=0;this.defaultData.forEach((s=>{this.selectedRooms[s.index]=s.totalRooms;i[s.index]=s.totalRooms;e+=s.totalRooms;t.push(s.index)}));if(t.length<i.length){i.forEach(((s,n)=>{if(!t.includes(n)){if(e===this.totalRooms){i[n]=0}else{i[n]=i[n]-e}}else{if(e<this.totalRooms){i[n]=this.totalRooms-e+i[n]}}}))}}else{i.fill(e)}return i}onRoomDataUpdate(t,e){t.stopImmediatePropagation();const{detail:{data:i,changedKey:s}}=t;let n=Object.assign({},i);if(s==="totalRooms"){this.handleTotalRoomsUpdate(e,n.totalRooms)}n=Object.assign(Object.assign({},n),{roomCategoryId:this.roomTypeData.id,roomCategoryName:this.roomTypeData.name,inventory:this.roomTypeData.inventory});this.dataUpdateEvent.emit({key:i.key,data:n,changedKey:s})}handleTotalRoomsUpdate(t,e){if(this.selectedRooms[t]!==e){this.selectedRooms[t]=e;this.updateRatePlanTotalRooms(t)}}updateRatePlanTotalRooms(t){const e=t=>this.selectedRooms.reduce(((e,i,s)=>s!==t?e+i:e),0);const i=this.selectedRooms.map(((i,s)=>{if(s===t){return this.roomsDistributions[s]}const n=e(s);const o=this.totalRooms-n;return o>0?o:0}));if(JSON.stringify(this.roomsDistributions)!==JSON.stringify(i)){this.roomsDistributions=[...i]}}render(){const t=this.validBookingTypes.includes(this.bookingType);return i(s,{key:"5b769fac02363d59dc7ed4e0400b97badb0f25f0"},t&&this.roomTypeData.rateplans.length>0&&i("div",{key:"3d05bb856afb15ce606d093428f24aa24d066505",class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomTypeData.name),this.roomTypeData.rateplans.map(((e,s)=>{if(e.variations!==null){let n=this.roomInfoId&&this.roomInfoId===this.roomTypeData.id;let o=-1;if(n&&this.initialRoomIds){o=this.initialRoomIds.roomId}return i("igl-booking-room-rate-plan",{is_bed_configuration_enabled:this.roomTypeData.is_bed_configuration_enabled,index:s,isBookDisabled:this.isBookDisabled,key:`rate-plan-${e.id}`,ratePricingMode:this.ratePricingMode,class:t?"":"",currency:this.currency,dateDifference:this.dateDifference,ratePlanData:e,totalAvailableRooms:this.roomsDistributions[s],bookingType:this.bookingType,defaultData:this.defaultData&&this.defaultData.get(`p_${e.id}`)||null,shouldBeDisabled:n,onDataUpdateEvent:t=>this.onRoomDataUpdate(t,s),physicalrooms:this.roomTypeData.physicalrooms,defaultRoomId:o,selectedRoom:this.initialRoomIds})}else{return null}})))}static get watchers(){return{roomTypeData:["handleRoomTypeData"]}}};St.style=Rt;const Lt=".sc-igl-cal-body-h{display:block}.bodyContainer.sc-igl-cal-body{position:relative}.roomRow.sc-igl-cal-body{width:max-content}.roomRow.sc-igl-cal-body:first-child{margin-top:80px}.categoryName.sc-igl-cal-body{font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.cellData.sc-igl-cal-body{width:58px;height:30px;display:inline-grid;border-top:1px solid #e0e0e0;border-left:1px solid #e0e0e0;vertical-align:top}.cellData.sc-igl-cal-body:nth-child(2){border-left:0px}.cellData.sc-igl-cal-body:last-child{border-right:1px solid #e0e0e0}.roomHeaderCell.sc-igl-cal-body{position:-webkit-sticky;position:sticky;left:0;background:#fff;border-right:1px solid #ccc;width:170px;z-index:1}.currentDay.sc-igl-cal-body{background-color:#e3f3fa}.dragOverHighlight.sc-igl-cal-body{background-color:#f5f5dc !important}.selectedDay.sc-igl-cal-body{background-color:#f9f9c9 !important}.categoryTitle.sc-igl-cal-body{grid-template-columns:1fr 20px;padding-left:10px;cursor:pointer;height:40px;font-size:0.9em}.categoryTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.sc-igl-cal-body{padding-left:20px;font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.roomTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.pl10.sc-igl-cal-body{padding-left:10px}.categoryPriceColumn.sc-igl-cal-body{align-items:center;height:40px;-webkit-user-select:none;user-select:none}.bookingEventsContainer.sc-igl-cal-body{position:absolute;top:0;left:0}";const jt=Lt;const Yt=class{constructor(i){t(this,i);this.showBookingPopup=e(this,"showBookingPopup",7);this.scrollPageToRoom=e(this,"scrollPageToRoom",7);this.addBookingDatasEvent=e(this,"addBookingDatasEvent",7);this.selectedRooms={};this.fromRoomId=-1;this.currentDate=new Date;this.isScrollViewDragging=undefined;this.calendarData=undefined;this.today=undefined;this.currency=undefined;this.language=undefined;this.countryNodeList=undefined;this.dragOverElement="";this.renderAgain=false;this.highlightedDate=undefined}componentWillLoad(){this.currentDate.setHours(0,0,0,0)}dragOverHighlightElementHandler(t){this.dragOverElement=t.detail.dragOverElement}gotoRoom(t){let e=t.detail.roomId;let i=this.getRoomCategoryByRoomId(e);if(!i.expanded){this.toggleCategory(i);setTimeout((()=>{this.scrollToRoom(e)}),10)}else{this.scrollToRoom(e)}}addToBeAssignedEvents(t){this.addBookingDatas(t.detail.data);this.renderElement()}scrollToRoom(t){this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:t,refClass:"room_"+t})}getRoomCategoryByRoomId(t){return this.calendarData.roomsInfo.find((e=>this.getCategoryRooms(e).find((e=>this.getRoomId(e)===t))))}getCategoryName(t){return t.name}getCategoryId(t){return t.id}getTotalPhysicalRooms(t){return this.getCategoryRooms(t).length}getCategoryRooms(t){return t&&t.physicalrooms||[]}getRoomName(t){return t.name}getRoomId(t){return t.id}getRoomById(t,e){return t.find((t=>this.getRoomId(t)===e))}getBookingData(){return this.calendarData.bookingEvents}addBookingDatas(t){this.addBookingDatasEvent.emit(t)}getSelectedCellRefName(t,e){return"room_"+t+"_"+e.currentDate}getSplitBookingEvents(t){console.log(t.FROM_DATE);return this.getBookingData().some((e=>{if(!["003","002","004"].includes(e.STATUS_CODE)){if(new Date(t.FROM_DATE).getTime()>=new Date(e.FROM_DATE).getTime()&&new Date(t.FROM_DATE).getTime()<=new Date(e.TO_DATE).getTime()){return e}}}))}closeWindow(){let t=this.getBookingData().findIndex((t=>t.ID==="NEW_TEMP_EVENT"));if(t!==-1){this.getBookingData().splice(t,1);console.log("removed item..");this.renderElement()}}addNewEvent(t){let e=Object.keys(this.selectedRooms);let s,n;if(this.selectedRooms[e[0]].currentDate<this.selectedRooms[e[1]].currentDate){s=new Date(this.selectedRooms[e[0]].currentDate);n=new Date(this.selectedRooms[e[1]].currentDate)}else{s=new Date(this.selectedRooms[e[1]].currentDate);n=new Date(this.selectedRooms[e[0]].currentDate)}this.newEvent={ID:"NEW_TEMP_EVENT",NAME:i("span",null," "),EMAIL:"",PHONE:"",convertBooking:false,REFERENCE_TYPE:"PHONE",FROM_DATE:s.getFullYear()+"-"+this.getTwoDigitNumStr(s.getMonth()+1)+"-"+this.getTwoDigitNumStr(s.getDate()),TO_DATE:n.getFullYear()+"-"+this.getTwoDigitNumStr(n.getMonth()+1)+"-"+this.getTwoDigitNumStr(n.getDate()),BALANCE:"",NOTES:"",RELEASE_AFTER_HOURS:0,PR_ID:this.selectedRooms[e[0]].roomId,ENTRY_DATE:"",NO_OF_DAYS:(n-s)/864e5,ADULTS_COUNT:1,COUNTRY:"",INTERNAL_NOTE:"",RATE:"",TOTAL_PRICE:"",RATE_PLAN:"",ARRIVAL_TIME:"",TITLE:M.entries.Lcz_NewBookingFor,roomsInfo:[t],CATEGORY:t.name,event_type:"BAR_BOOKING",STATUS:"TEMP-EVENT",defaultDateRange:{fromDate:null,fromDateStr:"",toDate:null,toDateStr:"",dateDifference:(n-s)/864e5,editable:false,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};let o=t.name+" "+this.getRoomName(this.getRoomById(this.getCategoryRooms(t),this.selectedRooms[e[0]].roomId));this.newEvent.BLOCK_DATES_TITLE=M.entries.Lcz_BlockDatesFor+o;this.newEvent.TITLE+=o;this.newEvent.defaultDateRange.toDate=new Date(this.newEvent.TO_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDate=new Date(this.newEvent.FROM_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDateStr=this.getDateStr(this.newEvent.defaultDateRange.fromDate);this.newEvent.defaultDateRange.toDateStr=this.getDateStr(this.newEvent.defaultDateRange.toDate);this.newEvent.ENTRY_DATE=(new Date).toISOString();this.newEvent.legendData=this.calendarData.formattedLegendData;let a=this.getSplitBookingEvents(this.newEvent);if(a){this.newEvent.splitBookingEvents=a}this.getBookingData().push(this.newEvent);return this.newEvent}getTwoDigitNumStr(t){return t<=9?"0"+t:t}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}removeNewEvent(){this.calendarData.bookingEvents=this.calendarData.bookingEvents.filter((t=>t.ID!=="NEW_TEMP_EVENT"));this.newEvent=null}clickCell(t,e,i){if(!this.isScrollViewDragging&&e.currentDate>=this.currentDate.getTime()){let s=this.getSelectedCellRefName(t,e);if(this.selectedRooms.hasOwnProperty(s)){this.removeNewEvent();delete this.selectedRooms[s];this.renderElement();return}else if(Object.keys(this.selectedRooms).length!=1||this.fromRoomId!=t){this.removeNewEvent();this.selectedRooms={};this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.fromRoomId=t;this.renderElement()}else{this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.addNewEvent(i);this.selectedRooms={};this.renderElement();this.showNewBookingPopup(this.newEvent)}}}showNewBookingPopup(t){console.log(t)}renderElement(){this.renderAgain=!this.renderAgain}getGeneralCategoryDayColumns(t,e=false,s){return q.days.map((n=>i("div",{class:`cellData  font-weight-bold categoryPriceColumn ${t+"_"+n.day} ${n.day===this.today||n.day===this.highlightedDate?"currentDay":""}`},e?i("span",{class:"categoryName"},n.rate[s].exposed_inventory.rts):"")))}getGeneralRoomDayColumns(t,e){return this.calendarData.days.map((s=>i("div",{class:`cellData ${"room_"+t+"_"+s.day} ${s.day===this.today||s.day===this.highlightedDate?"currentDay":""} ${this.dragOverElement===t+"_"+s.day?"dragOverHighlight":""} ${this.selectedRooms.hasOwnProperty(this.getSelectedCellRefName(t,s))?"selectedDay":""}`,onClick:()=>this.clickCell(t,s,e)})))}toggleCategory(t){t.expanded=!t.expanded;this.renderElement()}getRoomCategoryRow(t,e){if(this.getTotalPhysicalRooms(t)<=1){return null}return i("div",{class:"roomRow"},i("div",{class:`cellData text-left align-items-center roomHeaderCell categoryTitle ${"category_"+this.getCategoryId(t)}`,onClick:()=>this.toggleCategory(t)},i("div",{class:"categoryName"},i("ir-popover",{popoverTitle:this.getCategoryName(t)})),t.expanded?i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},i("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:14,width:14},i("path",{fill:"#6b6f82",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"}))),this.getGeneralCategoryDayColumns("category_"+this.getCategoryId(t),true,e))}getRoomsByCategory(t){var e;if(!t.expanded){return[]}return(e=this.getCategoryRooms(t))===null||e===void 0?void 0:e.map((e=>i("div",{class:"roomRow"},i("div",{class:`cellData text-left align-items-center roomHeaderCell  roomTitle ${this.getTotalPhysicalRooms(t)<=1?"pl10":""} ${"room_"+this.getRoomId(e)}`,"data-room":this.getRoomId(e)},i("ir-popover",{popoverTitle:this.getTotalPhysicalRooms(t)<=1?this.getCategoryName(t):this.getRoomName(e)})),this.getGeneralRoomDayColumns(this.getRoomId(e),t))))}getRoomRows(){return this.calendarData.roomsInfo.map(((t,e)=>{if(t.is_active){return[this.getRoomCategoryRow(t,e),this.getRoomsByCategory(t)]}else{return null}}))}render(){var t;return i(s,{key:"05fee2fe5a3601c037d7f2681232dbb69cf35921"},i("div",{key:"26cdb3997a0757d2568aa8b38ea6f1fde78ac005",class:"bodyContainer"},this.getRoomRows(),i("div",{key:"8d62e0e9c5b4e8552ebbaee13d06cfa9d4852a74",class:"bookingEventsContainer preventPageScroll"},(t=this.getBookingData())===null||t===void 0?void 0:t.map((t=>i("igl-booking-event",{language:this.language,is_vacation_rental:this.calendarData.is_vacation_rental,countryNodeList:this.countryNodeList,currency:this.currency,"data-component-id":t.ID,bookingEvent:t,allBookingEvents:this.getBookingData()}))))))}};Yt.style=jt;const zt=".sc-igl-cal-footer-h{display:block;position:sticky;bottom:0;width:max-content;z-index:3}.footerCell.sc-igl-cal-footer{display:-moz-inline-grid;display:-ms-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;bottom:0;width:58px;height:40px;background:#fff;vertical-align:top;border-top:1px solid #e0e0e0}.bottomLeftCell.sc-igl-cal-footer{left:-1px;z-index:2;width:170px;text-align:left;padding-left:15px;color:#000000}.footerCell.sc-igl-cal-footer i.sc-igl-cal-footer{margin-right:5px}.legendBtn.sc-igl-cal-footer{color:#41bff3;cursor:pointer}.isOnline.sc-igl-cal-footer i.sc-igl-cal-footer{color:#2f9c3f;font-weight:bold}.isOffline.sc-igl-cal-footer i.sc-igl-cal-footer{font-weight:bold}.isOffline.sc-igl-cal-footer{color:#a40000}.dayTitle.sc-igl-cal-footer{font-size:0.8em;font-weight:600;display:grid;user-select:none}.currentDay.sc-igl-cal-footer .dayTitle.sc-igl-cal-footer{font-weight:bold}.currentDay.sc-igl-cal-footer{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-footer{font-size:0.75em}.badge-pill.sc-igl-cal-footer{padding-left:1em;padding-right:1em;font-size:0.7em;margin-bottom:2px}";const $t=zt;const Pt=class{constructor(i){t(this,i);this.optionEvent=e(this,"optionEvent",7);this.calendarData=undefined;this.today=undefined;this.highlightedDate=undefined}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return i(s,{key:"c4759d9e32de5c9c075d74721641985745d66634",class:"footerContainer"},i("div",{key:"05840cf572dba1235690e1f592c121f994e2c6d5",class:"footerCell bottomLeftCell align-items-center preventPageScroll"},i("div",{key:"be5e697c75c769f84ca1957811a6fa5da26479d5",class:"legendBtn",onClick:()=>this.handleOptionEvent("showLegend")},i("i",{key:"7cf252f442400c6aaedbc9a5caf1cd49647384c6",class:"la la-square"}),i("u",{key:"695d08cf764f6fc236b49dfdf011d45a8aaf6ea6"},M.entries.Lcz_Legend),i("span",{key:"037031b017812fbd81355d5a20ebf34b2643683d"}," - v75"))),this.calendarData.days.map((t=>i("div",{class:"footerCell align-items-center"},i("div",{class:`dayTitle full-height align-items-center ${t.day===this.today||this.highlightedDate===t.day?"currentDay":""}`},t.dayDisplayName)))))}};Pt.style=$t;class Ht extends R{async getUnassignedDates(t,e,i){try{const s=this.getToken();if(s){const{data:n}=await S.post(`/Get_UnAssigned_Dates?Ticket=${s}`,{propertyid:t,from_date:e,to_date:i});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return this.convertUnassignedDates(n.My_Result)}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}async getUnassignedRooms(t,e,i,s,n){try{const o=this.getToken();if(o){const{data:a}=await S.post(`/Get_Aggregated_UnAssigned_Rooms?Ticket=${o}`,{propertyid:e,specific_date:i});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}return this.transformToAssignable(t,a,s,n)}else{throw new Error("Invalid Token")}}catch(t){console.error(t);throw new Error(t)}}async assignUnit(t,e,i){try{const s=this.getToken();if(s){const{data:n}=await S.post(`/Assign_Exposed_Room?Ticket=${s}`,{booking_nbr:t,identifier:e,pr_id:i,extras:r});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n);return n["My_Result"]}else{throw new Error("Invalid token")}}catch(t){console.error(t);throw new Error(t)}}cleanSpacesAndSpecialChars(t){const e=/[^a-zA-Z0-9]+/g;return t.replace(e,"")}transformToAssignable(t,e,i,s){const n=[];e.My_Result.forEach((e=>{e.unassigned_rooms.forEach((e=>{let o={roomTypeName:e.room_type_name,ID:e.identifier,NAME:e.guest_name,identifier:e.identifier,FROM_DATE:e.unassigned_date,TO_DATE:e.unassigned_date,BOOKING_NUMBER:e.book_nbr,STATUS:"IN-HOUSE",defaultDateRange:{fromDate:undefined,toDate:undefined,fromDateTimeStamp:0,toDateTimeStamp:0,fromDateStr:"",toDateStr:"",dateDifference:0},NO_OF_DAYS:1,roomsInfo:i,legendData:s,availableRooms:[],RT_ID:this.getRoomTypeId(e.room_type_name,i)};this.updateAvailableRooms(t,e,o,s,i);this.addDefaultDateRange(o);n.push(o)}))}));return n}addDefaultDateRange(t){t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=d(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=d(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS}getRoomTypeId(t,e){return e.find((e=>this.cleanSpacesAndSpecialChars(e.name)===this.cleanSpacesAndSpecialChars(t))).id||null}updateAvailableRooms(t,e,i,s,n){const o=[];e.assignable_units.forEach((e=>{if(e.Is_Fully_Available&&!e.Is_Not_Available){const a=g(e.from_date,e.to_date);const r=Y(new Date(t.from_date)).isAfter(Y(new Date(e.from_date)))?t.from_date:e.from_date;const l=Y(new Date(t.to_date)).isBefore(Y(new Date(e.to_date)))&&Y(new Date(t.to_date)).isAfter(Y(new Date(e.from_date)))?t.to_date:e.to_date;o.push({RT_ID:i.RT_ID,STATUS:"PENDING-CONFIRMATION",FROM_DATE:r,roomName:e.name,PR_ID:e.pr_id,TO_DATE:l,NO_OF_DAYS:a,ID:"NEW_TEMP_EVENT",NAME:"",NOTES:"",BALANCE:"",INTERNAL_NOTE:"",hideBubble:true,legendData:s,roomsInfo:n});i.TO_DATE=e.to_date;i.NO_OF_DAYS=a}}));i.availableRooms=o}convertUnassignedDates(t){let e={};t.forEach((t=>{let i=new Date(t.date);i.setHours(0,0,0,0);e[i.getTime()]={categories:{},dateStr:t.description}}));return e}}const Ut={unassigned_dates:{}};let{state:Gt,onChange:Vt}=X(Ut);function Kt(t){Gt.unassigned_dates=Object.assign(Object.assign({},Gt.unassigned_dates),t);console.log(Gt.unassigned_dates)}function Ft(){return Gt.unassigned_dates}function Wt(t,e){const i=qt(t);const s=qt(e);Object.keys(Gt.unassigned_dates).forEach((t=>{const e=parseInt(t);if(i<=e&&e<=s){delete Gt.unassigned_dates[t]}}))}function qt(t){const e=new Date(t);e.setHours(0,0,0,0);return e.getTime()}const Xt={secondary:{"--icon-button-color":"#6b6f82","--icon-button-hover-color":"#104064"},danger:{"--icon-button-color":"#ff4961","--icon-button-hover-color":"#ff6377"}};const Jt=".sc-igl-cal-header-h{display:block;position:absolute;top:0;height:100%}.svg-icon.sc-igl-cal-header{height:20px;width:20px}.darkGrey.sc-igl-cal-header{background:#ececec}.btn.sc-igl-cal-header{pointer-events:auto}.stickyCell.sc-igl-cal-header{display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;top:0px;height:82px;display:inline-block;vertical-align:top;z-index:2}.headersContainer.sc-igl-cal-header{background-color:#ffffff}.headerCell.sc-igl-cal-header{display:inline-grid;width:58px;height:58px;vertical-align:top;background-color:#ffffff;border-bottom:1px solid #e0e0e0}.monthsContainer.sc-igl-cal-header{height:20px;background-color:#ffffff;margin-bottom:0.2em}.monthCell.sc-igl-cal-header{display:inline-grid;height:20px;background-color:#ececec;border-right:1px solid #c7c7c7;vertical-align:top}.monthCell.sc-igl-cal-header:nth-child(odd){background-color:#dddddd}.monthTitle.sc-igl-cal-header{overflow:hidden;text-overflow:ellipsis;font-size:0.9em;text-transform:uppercase;font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.topLeftCell.sc-igl-cal-header{left:0px;z-index:3;width:170px;background-color:#ffffff;display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid}.datePickerHidden.sc-igl-cal-header{position:absolute;height:100%;width:100%;opacity:0;cursor:pointer;z-index:1}.date_btn.sc-igl-cal-header{cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative}.date_btn.sc-igl-cal-header:hover{background:#f6f6f6;border-radius:0.3rem}.caledarBtns.sc-igl-cal-header{position:relative;cursor:pointer;padding:0.4rem}.caledarBtns.sc-igl-cal-header:hover{background-color:#f6f6f6}.dayTitle.sc-igl-cal-header{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.currentDay.sc-igl-cal-header .dayTitle.sc-igl-cal-header{font-weight:bold}.currentDay.sc-igl-cal-header{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-header{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-cal-header{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.pointer.sc-igl-cal-header{cursor:pointer}.searchContiner.sc-igl-cal-header{padding-left:10px;padding-right:10px}.searchListContainer.sc-igl-cal-header{background:#fff;border:1px solid #ccc;border-bottom:none}.searchListItem.sc-igl-cal-header{background:white;border-bottom:1px solid #ccc;padding-left:8px}.badge-light.sc-igl-cal-header{background-color:#999999;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.min-width-full.sc-igl-cal-header{min-width:100%}";const Zt=Jt;const Qt=class{constructor(i){t(this,i);this.optionEvent=e(this,"optionEvent",7);this.gotoRoomEvent=e(this,"gotoRoomEvent",7);this.gotoToBeAssignedDate=e(this,"gotoToBeAssignedDate",7);this.searchValue="";this.searchList=[];this.roomsList=[];this.toBeAssignedService=new Ht;this.calendarData=undefined;this.today=undefined;this.propertyid=undefined;this.unassignedDates=undefined;this.to_date=undefined;this.highlightedDate=undefined;this.renderAgain=false;this.unassignedRoomsNumber={}}componentWillLoad(){this.toBeAssignedService.setToken(A.token);try{this.initializeRoomsList();if(!this.calendarData.is_vacation_rental){Vt("unassigned_dates",(t=>{if(Object.keys(t).length>0){this.fetchAndAssignUnassignedRooms()}}))}}catch(t){console.error("Error in componentWillLoad:",t)}}handleCalendarDataChanged(){this.fetchAndAssignUnassignedRooms()}initializeRoomsList(){this.roomsList=[];this.calendarData.roomsInfo.forEach((t=>{this.roomsList=this.roomsList.concat(...t.physicalrooms)}))}async fetchAndAssignUnassignedRooms(){await this.assignRoomsToDate()}async assignRoomsToDate(){try{const{fromDate:t,toDate:e,data:i}=this.unassignedDates;let s=new Date(t);s.setHours(0,0,0,0);let n=s.getTime();while(n<=new Date(e).getTime()){const t=Y(n).format("D_M_YYYY");if(i[n]){const e=await this.toBeAssignedService.getUnassignedRooms({from_date:this.calendarData.from_date,to_date:this.calendarData.to_date},this.propertyid,d(new Date(n)),this.calendarData.roomsInfo,this.calendarData.formattedLegendData);this.unassignedRoomsNumber[t]=e.length}else if(this.unassignedRoomsNumber[t]){const e=this.unassignedRoomsNumber[t]-1;this.unassignedRoomsNumber[t]=e<0?0:e}const e=Y(n).add(1,"days").toDate();e.setHours(0,0,0,0);n=e.getTime();this.renderView()}}catch(t){console.error(t)}}handleReduceAvailableUnitEvent(t){t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i}=t.detail;let s=new Date(e).getTime();while(s<new Date(i).getTime()){const t=Y(s).format("D_M_YYYY");this.unassignedRoomsNumber[t]=this.unassignedRoomsNumber[t]-1;s=Y(s).add(1,"days").toDate().getTime()}this.renderView()}showToBeAssigned(t){if(this.unassignedRoomsNumber[t.day]||0){this.handleOptionEvent("showAssigned");setTimeout((()=>{this.gotoToBeAssignedDate.emit({key:"gotoToBeAssignedDate",data:t.currentDate})}),100)}}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}handleDateSelect(t){if(Object.keys(t.detail).length>0){this.handleOptionEvent("calendar",t.detail)}}handleClearSearch(){this.searchValue="";this.searchList=[];this.renderView()}handleFilterRooms(t){const e=t.target;let i=e.value.trim();this.searchValue=i;i=i.toLowerCase();if(i===""){this.handleClearSearch()}else{this.searchList=this.roomsList.filter((t=>t.name.toLocaleLowerCase().indexOf(i)!=-1))}this.renderView()}handleScrollToRoom(t){this.handleClearSearch();this.gotoRoomEvent.emit({key:"gotoRoom",roomId:t})}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}getNewBookingModel(){let t=new Date;t.setHours(0,0,0,0);let e=this.getStringDateFormat(t);t.setDate(t.getDate()+1);t.setHours(0,0,0,0);let i=this.getStringDateFormat(t);return{ID:"",NAME:"",EMAIL:"",PHONE:"",REFERENCE_TYPE:"PHONE",FROM_DATE:e,TO_DATE:i,roomsInfo:this.calendarData.roomsInfo,TITLE:M.entries.Lcz_NewBooking,event_type:"PLUS_BOOKING",legendData:this.calendarData.formattedLegendData,defaultDateRange:{fromDate:new Date(e),fromDateStr:"",toDate:new Date(i),toDateStr:"",dateDifference:0,editabled:true,message:""}}}renderView(){this.renderAgain=!this.renderAgain}render(){return i(s,{key:"427dbe13b15e7a80fc0e594a6c6f57305670b713"},i("div",{key:"6422f2fde6783412cd10ccd61be261136a7839bb",class:"stickyCell align-items-center topLeftCell preventPageScroll"},i("div",{key:"90bbbbafbaceb42bb4032b89f11c5281afdacf3e",class:"row justify-content-around no-gutters"},!this.calendarData.is_vacation_rental&&i("ir-button",{key:"2961e649a674d077013b40cbb52ce97e36d6fc1f",variant:"icon",icon_name:"server",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:M.entries.Lcz_UnassignedUnitsTooltip,onClickHanlder:()=>this.handleOptionEvent("showAssigned"),btn_styles:"caledarBtns",visibleBackgroundOnHover:true}),i("ir-button",{key:"83442b556ec10429a8f8acc9a3c33a97e6b30f4c",btn_styles:"caledarBtns",class:"date_btn",variant:"icon",icon_name:"calendar",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:M.entries.Lcz_Navigate,onClickHanlder:()=>this.handleOptionEvent("calendar"),visibleBackgroundOnHover:true},i("ir-date-picker",{key:"266fe8247c54a41261724d44b7b47b1703dabe65",minDate:Y().add(-2,"months").startOf("month").format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{console.log("evt",t);this.handleDateSelect(t)},class:"datePickerHidden"})),i("ir-button",{key:"a7de0c7fd9d6e6aca3cb460c66ee0b0d81782b57",variant:"icon",btn_styles:"caledarBtns",class:"pointer",icon_name:"clock",visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:M.entries.Lcz_Today,onClickHanlder:()=>this.handleOptionEvent("gotoToday")}),i("ir-button",{key:"13835c176e3ebb65883ab9b497129c517474fded",variant:"icon",btn_styles:"caledarBtns",icon_name:"plus","data-toggle":"tooltip","data-placement":"bottom",title:M.entries.Lcz_CreateNewBooking,visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),onClickHanlder:()=>this.handleOptionEvent("add",this.getNewBookingModel())})),i("div",{key:"aeb179c3befb56627e2304241d7559e59e81b17b",class:"row justify-content-around no-gutters searchContiner"},i("fieldset",{key:"4de3cc65a0892dc34b6ee865668bc283f55c73c1",class:`form-group position-relative ${this.searchValue!=""?"show":""}`},i("input",{key:"517f205135c8bb140ecbb923c2133da3a8cfa287",type:"text",class:"form-control form-control-sm input-sm",id:"iconLeft7",value:this.searchValue,placeholder:M.entries.Lcz_FindUnit,onInput:t=>this.handleFilterRooms(t)}),this.searchValue!==""?i("div",{class:"form-control-position pointer",onClick:()=>this.handleClearSearch(),"data-toggle":"tooltip","data-placement":"top","data-original-title":"Clear Selection"},i("i",{class:"la la-close font-small-4"})):null,this.searchList.length?i("div",{class:"position-absolute searchListContainer dropdown-menu dropdown-menu-left min-width-full"},this.searchList.map((t=>i("div",{class:"searchListItem1 dropdown-item px-1 text-left pointer",onClick:()=>this.handleScrollToRoom(t.id)},t.name)))):null))),i("div",{key:"3c092d3cc236c8f7b17d29d02fcffe5657ea553d",class:"stickyCell headersContainer"},i("div",{key:"52528ef32559adc937697bf443244d063d4adac9",class:"monthsContainer"},this.calendarData.monthsInfo.map((t=>i("div",{class:"monthCell",style:{width:t.daysCount*58+"px"}},i("div",{class:"monthTitle"},t.monthName))))),this.calendarData.days.map((t=>i("div",{class:`headerCell align-items-center ${"day-"+t.day} ${t.day===this.today||t.day===this.highlightedDate?"currentDay":""}`,"data-day":t.day},!this.calendarData.is_vacation_rental&&i("div",{class:"preventPageScroll"},i("span",{class:`badge badge-${this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr!==0?"info pointer":"light"} badge-pill`,onClick:()=>this.showToBeAssigned(t)},this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr)),i("div",{class:"dayTitle"},t.dayDisplayName),i("div",{class:"dayCapacityPercent"},t.occupancy,"%"))))))}static get watchers(){return{unassignedDates:["handleCalendarDataChanged"]}}};Qt.style=Zt;const te=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center;inset:0}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}";const ee=te;const ie=class{constructor(i){t(this,i);this.dateSelectEvent=e(this,"dateSelectEvent",7);this.toast=e(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.withDateDifference=true;this.renderAgain=false}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:this.fromDateStr,toDateStr:this.toDateStr,dateDifference:this.totalNights})}}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}calculateTotalNights(){this.totalNights=P(Y(this.fromDate).format("YYYY-MM-DD"),Y(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){return i(s,{key:"0112708f033e5ed0bf807367b9955bc9e794e302"},i("div",{key:"e9e97488a86ec193f25b7f7243eca8da66037051",class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},i("ir-date-picker",{key:"9c001e9d82f8254d3e63a5861f0b1dfc1fcc1d03",maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),i("div",{key:"b8bab51d30a8ebf429570761a24831d7f6d930ca","data-state":this.disabled?"disabled":"active",class:"date-view"},i("svg",{key:"0dbdff27237f573f5378df04e8d7fc329c916d0f",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},i("path",{key:"cdf53aaebf6e8c2451e618c573115bf5252a65f2",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),i("ir-date-view",{key:"8ce8db7888c6034d976f269b047f6d0ac1e37178",showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&i("span",{key:"0c2090c8e1edb53b24222d42e8e8546cc6ef0caa"},this.totalNights&&!this.disabled?i("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${M.entries.Lcz_Nights}`:` ${M.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};ie.style=ee;const se=".sc-igl-legends-h{display:block}.legendHeader.sc-igl-legends{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding-top:5px;margin-bottom:1rem}.legendCloseBtn.sc-igl-legends{position:absolute;top:50%;right:0;cursor:pointer;font-size:1.75em;line-height:1em;padding:0.4rem;display:flex;align-items:center;justify-content:center;border-radius:3px;transform:translateY(-50%)}.legendCloseBtn.sc-igl-legends:hover{background-color:#f6f6f6}.stickyHeader.sc-igl-legends{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.legendRow.sc-igl-legends{position:relative;vertical-align:middle;margin-bottom:0.3rem}.legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle}.legend_skew.sc-igl-legends,.legend_skew-bordered.sc-igl-legends,.legend_skewsplit.sc-igl-legends{transform:skew(-30deg);width:15px;height:16px}.legend_skew-bordered.sc-igl-legends{border:1px solid black}.legend_circle.sc-igl-legends{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px}.legend_skewsplit.sc-igl-legends{border-right:2px solid #000000}.headerCell.sc-igl-legends .blueColor.sc-igl-legends{background-color:#31bef1}.greenColor.sc-igl-legends{background-color:#45b16d}.yellowColor.sc-igl-legends{background-color:#f4d552}.greyColor.sc-igl-legends{background-color:#a0a0a0}.redColor.sc-igl-legends{background-color:#f34752}.pinkColor.sc-igl-legends{background-color:#f9b4b7}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends{margin-bottom:0}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends:first-child .legendCal.sc-igl-legends{background-color:#ececec}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.total-availability.sc-igl-legends{font-size:1em !important}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends{width:80px;height:25px;text-align:center;display:inline-grid !important;align-content:center;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends .badge.sc-igl-legends{margin-top:0.2rem;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.legendCal-h2.sc-igl-legends{height:40px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.br-t.sc-igl-legends{border-top:1px solid #a0a0a0}.br-s.sc-igl-legends{border-left:1px solid #a0a0a0;border-right:1px solid #a0a0a0}.br-bt.sc-igl-legends{border-bottom:1px solid #a0a0a0}.highphenLegend.sc-igl-legends{font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.highphenLegend.sc-igl-legends::before{width:12px;height:0.5px;content:' ';background-color:#000000;vertical-align:middle;display:inline-block;margin-left:5px;margin-right:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-legends{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.headerCell.sc-igl-legends{width:70px;display:flex;align-items:center;justify-content:center}.dayTitle.sc-igl-legends{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.dayCapacityPercent.sc-igl-legends{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}";const ne=se;const oe=class{constructor(i){t(this,i);this.optionEvent=e(this,"optionEvent",7);this.legendData=undefined}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return i(s,{key:"cc43d823caeebf9928e174c25385855e9ce31be5",class:"legendContainer pr-1 text-left"},i("div",{key:"f1d031cdc323d4d62cc6f161e13c5c97c3509a66",class:"w-full"},i("div",{key:"e4e38cd9f7eaf15fd9f1365b69f594b89337c106",class:"w-full"},i("div",{key:"c5be9e360c022ab78f385a7129d06a16b7f9ec44",class:"stickyHeader pt-1 "},i("p",{key:"419d3f5586467a81e2c956b6aa2468a7a26e6750",class:"legendHeader"},M.entries.Lcz_Legend),i("div",{key:"e8ef2ab34a35a68129c7136776c20c1522249332",class:"legendCloseBtn",onClick:()=>this.handleOptionEvent("closeSideMenu")},i("svg",{key:"15e0c4beb164de5160a8b83cdc090f4e4ac7a4a8",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},i("path",{key:"83d009d38c89d9cb631966931b06fc5872853d7e",fill:"#6b6f82",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"}))),i("hr",{key:"808bd84a7d9654e09f24b2ad77ed745af2448f16"})),i("div",{key:"30093996ce63bd5dab651a65e4fb55c88ce496cc",class:"mt-2 pl-1"},this.legendData.map((t=>i("div",{class:"legendRow "},i("div",{class:`legend_${t.design} mr-1`,style:{backgroundColor:t.color}}),i("span",{class:"font-small-3"},t.name))))),i("hr",{key:"659f60a60fb7f5e235367956a9e108099400c1af"}),i("div",{key:"eeb9917796c572582e10cab3019d6e1aba12036e",class:"mt-2"},i("div",{key:"459ebb15bd39353a6ad85b0a72b5018e92566333",class:"legendCalendar"},i("div",{key:"ab69457624f64429502877318fb423873b63e9da",class:"legendRow align-items-center"},i("div",{key:"8929e3dfe853189bf864f5e792b3fd55ddbb3138",class:"legendCal br-t br-s br-bt"},i("strong",{key:"1ce77039539af84c31d5a7e773681b7a176e4835"},"MAR 2022")),i("div",{key:"b4d142fa55bfaae18d0238486710176b8a123836",class:"highphenLegend"},M.entries.Lcz_MonthAndYear)),i("div",{key:"64703ac23a65a08c87e9e34f7fc048a0fb1f46d5",class:"legendRow"},i("div",{key:"82884ff4347d9e054326e855a18ee6a0bdde66d4",class:"legendCal headerCell align-items-center br-s"},i("span",{key:"1fbb32fba304e47aac67a8def03e4b4ecf52da15",class:"badge badge-info  badge-pill"},"3")),i("div",{key:"8bb79779387e514ed50f3f1492a92cbfa40695ab",class:"highphenLegend"},i("div",{key:"690b01435e5797e5423c315bf79126e722c56ac1"},M.entries.Lcz_UnassignedUnits))),i("div",{key:"9d79969ad6613bdd39b643b051bc42743c540cd4",class:"legendRow"},i("div",{key:"3347ed8722e92c3ece94f41a1534ccbfa5de3c6e",class:"legendCal dayTitle br-s"},"Fri 18"),i("div",{key:"2fe60b74ad95ec689246fc395b8344f60e017d17",class:"highphenLegend"},M.entries.Lcz_Date)),i("div",{key:"338e3bca15f9200020b0815dec4a3c1e02ed773e",class:"legendRow"},i("div",{key:"8eb7c6a7c3a7db390cbc5ee1c4169a47406325ae",class:"legendCal br-s br-bt dayCapacityPercent"},"15%"),i("div",{key:"aae87f53ee41957c944b28f6417fc84262d949f4",class:"highphenLegend"},M.entries.Lcz_Occupancy)),i("div",{key:"ee5b70407130dbbc77d0951840234c086fe1e848",class:"legendRow"},i("div",{key:"cf2fc2a9642cbfce61f06c6d95715a009649a3db",class:"legendCal br-s br-bt  font-weight-bold total-availability"},"20"),i("div",{key:"d0e190e9c7c94aef4d840cd80c409d17cd0b8c30",class:"highphenLegend"},M.entries.Lcz_TotalAvailability)))))))}};oe.style=ne;const ae=".sc-igl-pagetwo-h{display:block}.card-title.sc-igl-pagetwo{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-pagetwo{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-pagetwo{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-pagetwo{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-pagetwo{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-pagetwo:not(:disabled),[type='button'].sc-igl-pagetwo:not(:disabled){cursor:pointer}.row.sc-igl-pagetwo{padding:0 0 0 15px;margin:0}";const re=ae;const le=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.buttonClicked=e(this,"buttonClicked",7);this.showPaymentDetails=undefined;this.currency=undefined;this.isEditOrAddRoomEvent=undefined;this.dateRangeData=undefined;this.bookingData=undefined;this.showSplitBookingOption=undefined;this.language=undefined;this.bookedByInfoData=undefined;this.propertyId=undefined;this.bedPreferenceType=undefined;this.selectedRooms=undefined;this.isLoading=undefined;this.countryNodeList=undefined;this.selectedGuestData=undefined;this.defaultGuestData=undefined;this.selectedBookedByData=undefined;this.guestData=undefined;this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const e=Object.assign({},this.selectedUnits);const i=(t,e,i,s)=>{if(i&&s===2){return t*e}return t};this.selectedUnits=e;this.guestData=[];this.selectedRooms.forEach(((s,n)=>{s.forEach((s=>{e[n]=s.selectedUnits;t+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,e){const i=t.detail;const s=`c_${i.data.roomCategoryId}`;const n=[...this.selectedUnits[s]||[]];n[e]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:n});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,e,i){if(e==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,i)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const e=(t,e,i)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return this.isLoading===t||e(this.selectedGuestData,"guestName","")||e(this.selectedBookedByData,"isdCode","")||e(this.selectedBookedByData,"contactNumber","")||e(this.selectedBookedByData,"firstName","")||e(this.selectedBookedByData,"lastName","")||e(this.selectedBookedByData,"countryId",-1)||e(this.selectedBookedByData,"selectedArrivalTime","")||e(this.selectedBookedByData,"email","")}render(){return i(s,{key:"7a87f4429f3f4ba2a8b8098e89d507cf2114e34f"},i("div",{key:"0c59d4c8f63e77ddcb39ab54620c8d481baf4756",class:"d-flex flex-wrap"},i("ir-date-view",{key:"6c413bb99b3124d3ed9f6c3754995d6e18b40fc4",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:this.dateRangeData.fromDateStr,to_date:this.dateRangeData.toDateStr,dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{key:"fabf9057d48425efce9dff7d70a639c744a7df58",class:"mt-1 mt-md-0 text-right"},M.entries.Lcz_TotalPrice," ",i("span",{key:"aa00c23cc991017912ce9555059b72f652ddfd8a",class:"font-weight-bold font-medium-1"},a(this.currency.code)+this.bookingData.TOTAL_PRICE||"$0.00"))),this.guestData.map(((t,e)=>i("igl-application-info",{dateDifference:this.dateRangeData.dateDifference,defaultGuestPreference:this.defaultGuestData.bed_preference,defaultGuestRoomId:this.defaultGuestData.PR_ID,currency:this.currency,bedPreferenceType:this.bedPreferenceType,index:e,selectedUnits:this.selectedUnits[`c_${t.roomCategoryId}`],guestInfo:t,guestRefKey:e,bookingType:this.bookingData.event_type,roomsList:t.physicalRooms,onDataUpdateEvent:t=>this.handleEventData(t,"application-info",e)}))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>this.handleEventData(t,"propertyBookedBy",0)}),this.isEditOrAddRoomEvent?i("div",{class:"d-flex p-0 mb-1 mt-2"},i("div",{class:"flex-fill mr-2"},i("ir-button",{icon:"",text:M.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"})})),i("div",{class:"flex-fill"},i("ir-button",{isLoading:this.isLoading==="save",onClickHanlder:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:M.entries.Lcz_Save}))):i("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},i("div",{class:"flex-fill mr-md-1"},i("ir-button",{icon_name:"angles_left",btn_color:"secondary",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"}),text:M.entries.Lcz_Back,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}})),i("div",{class:"mt-1 mt-md-0 flex-fill"},i("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"book"}),text:M.entries.Lcz_Book}))))}};le.style=re;const ce=".sc-igl-property-booked-by-h{display:block}.row.sc-igl-property-booked-by{padding:0 0 0 15px;margin:0}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const he=ce;const de=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.bookingService=new st;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.language=undefined;this.showPaymentDetails=false;this.defaultData=undefined;this.countryNodeList=[];this.propertyId=undefined;this.isButtonPressed=false;this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.bookingService.setToken(A.token);this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const t=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((e,i)=>(t+i).toString()))}async assignCountryCode(){const t=await this.bookingService.getUserDefaultCountry();const e=t["COUNTRY_ID"];this.country=e;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.toString(),countryId:e})}initializeDateData(){const t=new Date;const e=t.getMonth()+1;this.currentMonth=e<10?`0${e}`:e.toString()}populateBookedByData(){var t;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((t=this.defaultData)===null||t===void 0?void 0:t.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(t,e){this.bookedByData[t]=t==="emailGuest"?e.target.checked:e.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(t==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.target.value})}console.log(this.bookedByData)}handleNumberInput(t,e){const i=e.target;const s=i.value;const n=/^[0-9]+$/;if(!n.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(t,e)}}async handleEmailInput(t,e){const i=e.target;const s=i.value;if(this.isValidEmail(s)){this.handleDataChange(t,e)}}async checkUser(){try{const t=this.bookedByData.email;if(this.isValidEmail(t)){const e=await this.bookingService.getUserInfo(t);if(e!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:e.id,firstName:e.first_name,lastName:e.last_name,contactNumber:e.mobile,countryId:e.country_id,isdCode:e.country_id.toString()})}else{this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:undefined,firstName:"",lastName:"",contactNumber:"",countryId:"",isdCode:""})}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}}catch(t){}}isValidEmail(t){const e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;return e.test(t)}handleComboboxChange(t){t.stopImmediatePropagation();t.stopPropagation();const{key:e,data:i}=t.detail;switch(e){case"blur":if(i!==""){this.bookedByData.email=i;this.checkUser()}break;case"select":this.bookedByData.email=i.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile,countryId:i.country_id,isdCode:i.country_id.toString()});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData});break}}clearEvent(){this.bookedByData.email="";this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return i(s,{key:"c6fe8d8ee3483e34b19f226d8d6bef2210c178d5"},i("div",{key:"d314fb1d87d9c01ea11a7f370e321633cd060f43",class:"text-left mt-3"},i("div",{key:"4c0b26638992181276865a0f28894e1eaaf18e28",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},i("label",{key:"ae1e09dd3ecf3b7e5596e5bd5df1b9cbaa9b8f41",class:"p-0 m-0 label-control mr-1 font-weight-bold"},M.entries.Lcz_BookedBy),i("div",{key:"6bd219809bfb316ba74acb2b2c2c714553593d74",class:"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center"},i("ir-autocomplete",{key:"aca6096b8fb5175eb3199ff40510f98ddd055574",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"email",value:this.bookedByData.email,required:true,class:"flex-fill",placeholder:M.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent()}),i("ir-tooltip",{key:"e2a5f161c122fb7a407c24a06f7fc6584040881e",class:"ml-1",message:"Leave empty if email is unavailable"})))),i("div",{key:"2b83fdfe3b273b99bc2d0428893f1d23d3a8d0d3",class:"bookedDetailsForm text-left mt-2 font-small-3 "},i("div",{key:"b2f84a1c7522575a33a6892ed2291dc71a509958",class:"d-flex flex-column flex-md-row  justify-content-md-between "},i("div",{key:"7816391c85bda17b80aa3e00852b39fff958ff70",class:"p-0 flex-fill "},i("div",{key:"32168d85fcb430226e1160b087b6fb4654079669",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},i("label",{key:"51f35c554e470e54b6f8a7a68dbad1aba7097340",class:"p-0 m-0 margin3"},M.entries.Lcz_FirstName),i("div",{key:"442fa42beb54464c474ebea8ea4cbf394b890c39",class:"p-0 m-0  controlContainer flex-fill  "},i("input",{key:"b7435b224582c419263f6219f2ddaa070e1ee18a",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:M.entries.Lcz_FirstName,id:N(),value:this.bookedByData.firstName,onInput:t=>this.handleDataChange("firstName",t),required:true}))),i("div",{key:"c819367bd08452615f72750a7e4392d0186fb01d",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"22ded57ea17b54cea77cf1bca77a9fdd1ce60d36",class:"p-0 m-0 margin3"},M.entries.Lcz_LastName),i("div",{key:"0cf5b8dbbb27af47442a9221bdb3c7e980c32444",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"3c021d3316c74249b4f2370c442dbf450a77095d",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:M.entries.Lcz_LastName,id:N(),value:this.bookedByData.lastName,onInput:t=>this.handleDataChange("lastName",t)}))),i("div",{key:"0c02d2e51cbed6d105ae7afbf3786d5bdd74a7a9",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"5cbdf2ea859a0ac237a6bd5bea0cb4fde761c5ae",class:"p-0 m-0 margin3"},M.entries.Lcz_Country),i("div",{key:"acd0d054cd2db0872036f11f22a90f35d46e5159",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"da803cba43e9c4062ec55cbd6c3696519e3a43a6",class:`form-control input-sm pr-0`,id:N(),onChange:t=>this.handleDataChange("countryId",t)},i("option",{key:"b508d52f67c4262cf3c4e9ccd9a9bf52afe42d99",value:"",selected:this.bookedByData.countryId===""},M.entries.Lcz_Select),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.countryId===t.id},t.name)))))),i("div",{key:"0a26974c2e01afbd3a9afe3e40f83e1cb6176f6a",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"fe9871a9e20393c1646e74f24e2f57241ec133fa",class:"p-0 m-0 margin3"},M.entries.Lcz_MobilePhone),i("div",{key:"4dd12c61763e75eb1f3116ac30332f8e5b585743",class:"p-0 m-0  d-flex  controlContainer flex-fill"},i("div",{key:"e53c7873755226c67fc160152cc8b7d12b02b151",class:" p-0 m-0"},i("select",{key:"ec832d8a0b5321c70f9adc1114b0905a734def20",class:`form-control input-sm pr-0`,id:N(),onChange:t=>this.handleDataChange("isdCode",t)},i("option",{key:"f35d76efbc7fbe8b51b32085a0285bd70c60c0ce",value:"",selected:this.bookedByData.isdCode===""},M.entries.Lcz_Isd),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.isdCode===t.id.toString()},t.phone_prefix))))),i("div",{key:"cdd9126a95d74868e6a5f41c74dcadee57b17bcb",class:"flex-fill p-0 m-0"},i("input",{key:"5a8cc3e3624f724e9c529b45872e2993d47ba30c",class:`form-control\n                     \n                      `,type:"tel",placeholder:M.entries.Lcz_ContactNumber,id:N(),value:this.bookedByData.contactNumber,onInput:t=>this.handleNumberInput("contactNumber",t)})))),i("div",{key:"fea32615cb634a0ed2168653ad47f369fff90d86",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"c46e046bb02d52938defe38151f8a906b0b18023",class:"p-0 m-0 margin3"},M.entries.Lcz_YourArrivalTime),i("div",{key:"d8dc9a890400268154abd03ddc9684439910e777",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"c3bb9a0e6403b94735ac4d798cd62ad11990778a",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:N(),onChange:t=>this.handleDataChange("selectedArrivalTime",t)},this.arrivalTimeList.map((t=>i("option",{value:t.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===t.CODE_NAME},t.CODE_VALUE_EN))))))),i("div",{key:"e127518843ee87df2e2adb9376fa229e58983cef",class:"p-0 flex-fill  ml-md-3"},i("div",{key:"ab6a0c2d7baad70350974e761a9b71a2c8a5f79b",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},i("label",{key:"08be648d1e43d3a35df8e54fef710d07d62cd777",class:"p-0 m-0 margin3"},M.entries.Lcz_AnyMessageForUs),i("div",{key:"f018a9c14e7508dfd0f1cfeff76a43f06aa8390e",class:"p-0 m-0  controlContainer flex-fill "},i("textarea",{key:"0866b1096201c01cdec6ef92b3f90db3a4d09c6d",id:N(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:t=>this.handleDataChange("message",t)}))),this.showPaymentDetails&&i(n,{key:"0488b9b1cfcda466770b5b60f30638f7449510de"},i("div",{key:"cc898ea7cb03c890ef8c90af3b741dc04526354a",class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"4db78ff0085ad59be662a3b7c017bc853dd2b45c",class:"p-0 m-0 margin3"},M.entries.Lcz_CardNumber),i("div",{key:"e02483f8e5dd3b81297b669ad6b2e9f2ebe068ff",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"cfa71772b8e67a3fd0f2530fc695ef116100c532",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:N(),value:this.bookedByData.cardNumber,onInput:t=>this.handleNumberInput("cardNumber",t)}))),i("div",{key:"8469963e3907b1f64b83fc273bd7288731692e7b",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"9ecef93da9c66d747918b3825416e3beb055594b",class:"p-0 m-0 margin3"},M.entries.Lcz_CardHolderName),i("div",{key:"ad48211c7b59c3afc9f7f655eab51ede3af5bd7d",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"981ce8d16831e4c5432e54247c4c64b829be8785",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:N(),value:this.bookedByData.cardHolderName,onInput:t=>this.handleDataChange("cardHolderName",t)}))),i("div",{key:"7cf1cecbc796b54cfa5dd323933b911a7776fc6f",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"d4d317f476ba01c7b048f40302b55f9e3f26d59a",class:"p-0 m-0 margin3"},M.entries.Lcz_ExpiryDate),i("div",{key:"d74523ab77e748f65bdd655f2ee809ac44d17bea",class:"p-0 m-0 row  controlContainer flex-fill"},i("div",{key:"bb4782ca5a4cdd957d40739c2c74a1e8c1ffc0a2",class:"p-0 m-0"},i("select",{key:"013929df8862fe4aaf9e262632bcad5b45b05bde",class:"form-control input-sm pr-0",id:N(),onChange:t=>this.handleDataChange("expiryMonth",t)},this.expiryMonths.map((t=>i("option",{value:t,selected:t===this.bookedByData.expiryMonth},t))))),i("div",{key:"1d90aa867b442395db20e6ed62df3f1664d1bc45",class:"p-0 m-0 ml-1"},i("select",{key:"7360165fc1b231ab1907f0074e39d24702e33ec1",class:"form-control input-sm pr-0",id:N(),onChange:t=>this.handleDataChange("expiryYear",t)},this.expiryYears.map(((t,e)=>i("option",{value:t,selected:e===this.bookedByData.expiryYear},t)))))))),i("div",{key:"765954485b755437d4876da874867f499f94e647",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},i("label",{key:"750ebfe0f0294687f763fc7d1526b3df64ac61e3",class:"p-0 m-0",htmlFor:"emailTheGuestId"},M.entries.Lcz_EmailTheGuest),i("div",{key:"5fde2849b195bcacd285acc8b21af3cd1934799a",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},i("input",{key:"af4856366408c083696d43b845303e25f4bbcd52",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:t=>this.handleDataChange("emailGuest",t)})))))))}};de.style=he;const fe=".sc-igl-tba-booking-view-h{display:block}.guestTitle.sc-igl-tba-booking-view{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:2px;margin-bottom:5px;margin-top:5px;padding-left:5px;padding-right:5px}.guestTitle.selectedOrder.sc-igl-tba-booking-view{background-color:#f9f9c9}.pointer.sc-igl-tba-booking-view{cursor:pointer}hr.sc-igl-tba-booking-view{margin-top:8px;margin-bottom:0px}.bookingContainer.sc-igl-tba-booking-view{background-color:#ececec}.actionsContainer.sc-igl-tba-booking-view{display:flex;align-items:center;padding:5px !important;width:100%;gap:16px}.room-select.sc-igl-tba-booking-view{flex:1}.selectContainer.sc-igl-tba-booking-view{width:195px;margin-right:8px}.buttonsContainer.sc-igl-tba-booking-view{box-sizing:border-box}.btn-secondary.sc-igl-tba-booking-view{margin-right:8px !important}";const ue=fe;const be=class{constructor(i){t(this,i);this.highlightToBeAssignedBookingEvent=e(this,"highlightToBeAssignedBookingEvent",7);this.addToBeAssignedEvent=e(this,"addToBeAssignedEvent",7);this.scrollPageToRoom=e(this,"scrollPageToRoom",7);this.assignRoomEvent=e(this,"assignRoomEvent",7);this.highlightSection=false;this.allRoomsList=[];this.toBeAssignedService=new Ht;this.calendarData=undefined;this.selectedDate=undefined;this.eventData={};this.categoriesData={};this.categoryId=undefined;this.categoryIndex=undefined;this.eventIndex=undefined;this.renderAgain=false;this.selectedRoom=-1}onSelectRoom(t){if(t.stopImmediatePropagation){t.stopImmediatePropagation();t.stopPropagation()}this.selectedRoom=parseInt(t.target.value)}componentShouldUpdate(t,e,i){if(i==="selectedDate"&&t!==e){this.highlightSection=false;this.selectedRoom=-1;return true}else if(i==="eventData"&&t!==e){this.selectedRoom=-1;return true}return true}componentWillLoad(){this.toBeAssignedService.setToken(A.token);if(this.categoryIndex===0&&this.eventIndex===0){setTimeout((()=>{this.handleHighlightAvailability()}),100)}}async handleAssignUnit(t){try{t.stopImmediatePropagation();t.stopPropagation();if(this.selectedRoom){await this.toBeAssignedService.assignUnit(this.eventData.BOOKING_NUMBER,this.eventData.ID,this.selectedRoom);let t=Object.assign(Object.assign({},this.eventData),{PR_ID:this.selectedRoom});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[t]});this.assignRoomEvent.emit({key:"assignRoom",data:t})}}catch(t){}}handleHighlightAvailability(){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:this.eventData.ID,fromDate:this.eventData.FROM_DATE}});if(!this.selectedDate){return}let t=[];let e=[];t=this.eventData.availableRooms.map((t=>{e.push({calendar_cell:null,id:t.PR_ID,name:t.roomName});return Object.assign(Object.assign({},t),{defaultDateRange:this.eventData.defaultDateRange,identifier:this.eventData.identifier})}));this.allRoomsList=e;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:t});this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:this.categoryId,refClass:"category_"+this.categoryId});this.renderView()}handleCloseAssignment(t){t.stopImmediatePropagation();t.stopPropagation();this.highlightSection=false;this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.onSelectRoom({target:{value:""}});this.selectedRoom=-1;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.renderView()}highlightBookingEvent(t){let e=t.detail.data;if(e.bookingId!=this.eventData.ID){this.highlightSection=false;this.selectedRoom=-1;this.renderView()}else{this.highlightSection=true;this.renderView()}}renderView(){this.renderAgain=!this.renderAgain}render(){return i(s,{key:"e5f24cb46f361a2f86e4c4dd4e41e11a1073b1e3"},i("div",{key:"2dca20a3ef317f9f748b884b2e3de0c5fe472d4f",class:"bookingContainer",onClick:()=>this.handleHighlightAvailability()},i("div",{key:"3a1215dfa9d436c0f3f060999d1d4c3c3d075405",class:`guestTitle ${this.highlightSection?"selectedOrder":""} pointer font-small-3`,"data-toggle":"tooltip","data-placement":"top","data-original-title":"Click to assign unit"},`Book# ${this.eventData.BOOKING_NUMBER} - ${this.eventData.NAME}`),i("div",{key:"75cd2de8295a1951cb9a16b65497286a27b477b5",class:"row m-0 p-0 actionsContainer"},i("select",{key:"e502ff6395649a74ccc67a4041bf894f85cd6880",class:"form-control input-sm room-select",id:N(),onChange:t=>this.onSelectRoom(t)},i("option",{key:"32b39780f490cb5693ad9af83a892198626436b9",value:"",selected:this.selectedRoom==-1},M.entries.Lcz_AssignUnit),this.allRoomsList.map((t=>i("option",{value:t.id,selected:this.selectedRoom==t.id},t.name)))),this.highlightSection?i("div",{class:"d-flex buttonsContainer"},i("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:t=>this.handleCloseAssignment(t)},i("svg",{class:"m-0 p-0",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"9",viewBox:"0 0 384 512"},i("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("ir-button",{isLoading:L("/Assign_Exposed_Room"),size:"sm",text:M.entries.Lcz_Assign,onClickHanlder:t=>this.handleAssignUnit(t),btn_disabled:this.selectedRoom===-1})):null),i("hr",{key:"a7ed7f7f7274b825712316e008d94d3551f54e44"})))}};be.style=ue;const pe=".sc-igl-tba-category-view-h{display:block}";const ge=pe;const me=class{constructor(i){t(this,i);this.assignUnitEvent=e(this,"assignUnitEvent",7);this.calendarData=undefined;this.selectedDate=undefined;this.categoriesData={};this.categoryId=undefined;this.eventDatas=undefined;this.categoryIndex=undefined;this.renderAgain=false}componentWillLoad(){}handleAssignRoomEvent(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.eventDatas=this.eventDatas.filter((t=>t.ID!=e.data.ID));this.calendarData.bookingEvents.push(e.data);this.assignUnitEvent.emit({key:"assignUnit",data:{RT_ID:this.categoryId,selectedDate:this.selectedDate,assignEvent:e.data,calendarData:this.calendarData}});this.renderView()}getEventView(t,e){return e.map(((e,s)=>i("igl-tba-booking-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,eventData:e,categoriesData:this.categoriesData,categoryId:t,categoryIndex:this.categoryIndex,eventIndex:s,onAssignRoomEvent:t=>this.handleAssignRoomEvent(t)})))}renderView(){this.renderAgain=!this.renderAgain}render(){return i(s,{key:"edf45872eb3ad519a0fbc9073fdec99ed98418c4"},i("div",{key:"53f5ff76d0df95972d6afd539e563cc52240bda8",class:"sectionContainer"},i("div",{key:"b9e966e80301dccc8e9e9128956a44747725840b",class:"font-weight-bold mt-1 font-small-3"},this.categoriesData[this.categoryId].name),this.getEventView(this.categoryId,this.eventDatas)))}};me.style=ge;const ye=".sc-igl-to-be-assigned-h{display:block}.custom-dropdown.sc-igl-to-be-assigned{cursor:pointer;padding:5px 10px;width:min-content;margin-left:auto;margin-right:auto}.dropdown-toggle.sc-igl-to-be-assigned{all:unset;display:flex;width:max-content;align-items:center;gap:10px}.close_btn_style.sc-igl-to-be-assigned{padding:0.4rem}.close_btn_style.sc-igl-to-be-assigned:hover{background-color:#f6f6f6}.dropdown-menu.sc-igl-to-be-assigned{max-height:250px;overflow-y:auto}.tobeAssignedHeader.sc-igl-to-be-assigned{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding:0;margin:0}.assignment_header.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:space-between;padding-top:5px;margin-bottom:1rem}.dropdown-toggle.sc-igl-to-be-assigned::after{content:none;display:none}.dropdown-toggle.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transition:transform 0.2s ease}.show.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transform:rotate(-180deg)}.stickyHeader.sc-igl-to-be-assigned{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.pointer.sc-igl-to-be-assigned{cursor:pointer}.dots.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:center;margin:0 3px;padding:0}.dot.sc-igl-to-be-assigned{width:5px;height:5px;margin:5px 4px 0;background-color:#6b6f82;border-radius:50%;animation:dotFlashing 1s infinite linear alternate}.dot.sc-igl-to-be-assigned:nth-child(2){animation-delay:0.2s}.dot.sc-igl-to-be-assigned:nth-child(3){animation-delay:0.4s}@keyframes dotFlashing{0%{opacity:0}50%,100%{opacity:1}}";const ke=ye;const ve=class{constructor(i){t(this,i);this.optionEvent=e(this,"optionEvent",7);this.reduceAvailableUnitEvent=e(this,"reduceAvailableUnitEvent",7);this.showBookingPopup=e(this,"showBookingPopup",7);this.addToBeAssignedEvent=e(this,"addToBeAssignedEvent",7);this.highlightToBeAssignedBookingEvent=e(this,"highlightToBeAssignedBookingEvent",7);this.isGotoToBeAssignedDate=false;this.isLoading=true;this.selectedDate=null;this.data={};this.today=new Date;this.categoriesData={};this.toBeAssignedService=new Ht;this.unassignedDatesProp=undefined;this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.calendarData=undefined;this.loadingMessage=undefined;this.showDatesList=false;this.renderAgain=false;this.orderedDatesList=[];this.noScroll=false}componentWillLoad(){this.toBeAssignedService.setToken(A.token);this.reArrangeData();this.loadingMessage=M.entries.Lcz_FetchingUnAssignedUnits}handleUnassignedDatesToBeAssignedChange(t){const{fromDate:e,toDate:i,data:s}=t;let n=new Date(e);n.setHours(0);n.setMinutes(0);n.setSeconds(0);let o=n.getTime();while(o<=new Date(i).getTime()){if(s&&!s[o]&&this.unassignedDates.hasOwnProperty(o)){delete this.unassignedDates[o]}else if(s&&s[o]){this.unassignedDates[o]=s[o]}o=Y(o).add(1,"days").toDate().getTime()}this.data=Object.assign({},this.unassignedDates);this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(this.orderedDatesList.length){if(!this.data.hasOwnProperty(this.selectedDate)){this.selectedDate=this.orderedDatesList.length?this.orderedDatesList[0]:null}this.showForDate(this.selectedDate,false);this.renderView()}else{this.selectedDate=null}}handleAssignUnit(t){const e=t.detail;const i=e.data;t.stopImmediatePropagation();t.stopPropagation();if(e.key==="assignUnit"){if(Object.keys(this.data[i.selectedDate].categories).length===1){this.isLoading=true;this.noScroll=true}this.data[i.selectedDate].categories[i.RT_ID]=this.data[i.selectedDate].categories[i.RT_ID].filter((t=>t.ID!=i.assignEvent.ID));this.calendarData=i.calendarData;this.renderView()}}async updateCategories(t,e){try{let i={};const s=await this.toBeAssignedService.getUnassignedRooms({from_date:e.from_date,to_date:e.to_date},this.propertyid,d(new Date(+t)),e.roomsInfo,e.formattedLegendData);s.forEach((t=>{if(!i.hasOwnProperty(t.RT_ID)){i[t.RT_ID]=[t]}else{i[t.RT_ID].push(t)}}));this.unassignedDates[t].categories=i}catch(t){}}async reArrangeData(){try{this.today.setHours(0,0,0,0);this.calendarData.roomsInfo.forEach((t=>{this.categoriesData[t.id]={name:t.name,roomsList:t.physicalrooms,roomIds:t.physicalrooms.map((t=>t.id))}}));this.selectedDate=null;this.unassignedDates=Ft();console.log(this.unassignedDates);this.data=this.unassignedDates;this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(!this.selectedDate&&this.orderedDatesList.length){this.selectedDate=this.orderedDatesList[0]}}catch(t){console.error("Error fetching unassigned dates:",t)}}async componentDidLoad(){setTimeout((()=>{if(!this.isGotoToBeAssignedDate&&Object.keys(this.unassignedDates).length>0){const t=Object.keys(this.unassignedDates)[0];this.showForDate(t)}}),100)}async gotoDate(t){this.isGotoToBeAssignedDate=true;this.showForDate(t.detail.data);this.showDatesList=false;this.renderView()}handleToBeAssignedDate(t){this.showBookingPopup.emit({key:"calendar",data:new Date(t.detail.data.fromDate).getTime()-864e5,noScroll:false})}async showForDate(t,e=true){try{if(e){this.isLoading=true}if(this.showDatesList){this.showUnassignedDate()}await this.updateCategories(t,this.calendarData);this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.showBookingPopup.emit({key:"calendar",data:parseInt(t)-864e5,noScroll:this.noScroll});if(this.isGotoToBeAssignedDate){this.isGotoToBeAssignedDate=false}this.isLoading=false;this.selectedDate=t;this.renderView()}catch(t){}}getDay(t){const e=new Date(t);const i="default";const s=this.getLocalizedDayOfWeek(e,i);return s+" "+e.getDate()+", "+e.getFullYear()}getLocalizedDayOfWeek(t,e){const i={weekday:"short"};return t.toLocaleDateString(e,i)}handleOptionEvent(t,e=""){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.optionEvent.emit({key:t,data:e})}showUnassignedDate(){this.showDatesList=!this.showDatesList}getToBeAssignedEntities(){}getCategoryView(){if(this.orderedDatesList.length&&this.selectedDate&&this.data[this.selectedDate]){return Object.entries(this.data[this.selectedDate].categories).map((([t,e],s)=>i("igl-tba-category-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,categoryId:t,categoryIndex:s,categoriesData:this.categoriesData,eventDatas:e,onAssignUnitEvent:t=>this.handleAssignUnit(t)})))}else{return null}}renderView(){this.renderAgain=!this.renderAgain}render(){var t;return i(s,{key:"d0b549182ce21427ea905cff5bf72875b5bb2ea3",class:"tobeAssignedContainer pr-1 text-left"},i("div",{key:"c1c4c3a9385b315b75694a52bf939d02c99344b4"},i("div",{key:"9a6d2f583aa896843d96d46266fd42d42dd059a6"},i("div",{key:"3e16dae7e770ce66313ca62310507e402b79d45a",class:"stickyHeader pt-1"},i("div",{key:"00d47d21c0e5452acb3657d979d0c64bfc50a919",class:"assignment_header"},i("p",{key:"8da84574a122fe3096d34d4a38f7a63326c73df0",class:"tobeAssignedHeader "},M.entries.Lcz_Assignments),i("ir-button",{key:"4c7854d86cca6c1ddbc47a120f3b61cb54aa933c",class:"close_btn",variant:"icon",btn_styles:"close_btn_style",icon_name:"double_caret_left",style:Xt.secondary,onClickHanlder:()=>this.handleOptionEvent("closeSideMenu"),visibleBackgroundOnHover:true})),i("hr",{key:"1eda65ec723f1851f0dc28ca29a5e8fad9e173d0"}),Object.keys(this.data).length===0?i("p",null,M.entries.Lcz_AllBookingsAreAssigned):this.isLoading?i("p",{class:"d-flex align-items-center"},i("span",{class:"p-0"},this.loadingMessage),i("div",{class:"dots"},i("div",{class:"dot"}),i("div",{class:"dot"}),i("div",{class:"dot"}))):i(n,null,this.orderedDatesList.length?i("div",{class:`custom-dropdown border border-light rounded text-center `+(this.showDatesList?"show":""),id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},i("div",{class:"dropdown-toggle"},i("span",{class:"font-weight-bold"},this.data[this.selectedDate].dateStr),i("svg",{class:"caret-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},i("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),i("div",{class:"dropdown-menu dropdown-menu-right full-width","aria-labelledby":"dropdownMenuButton"},(t=this.orderedDatesList)===null||t===void 0?void 0:t.map((t=>i("div",{class:"dropdown-item pointer",onClick:()=>this.showForDate(t)},this.data[t].dateStr))))):M.entries.Lcz_AllBookingsAreAssigned)),!this.isLoading&&i("div",{key:"b9f302247c43a40118c0dbde203cf01fc4b92dd7",class:"scrollabledArea"},this.orderedDatesList.length?Object.keys(this.data[this.selectedDate].categories).length?this.getCategoryView():i("div",{class:"mt-1"},M.entries.Lcz_AllAssignForThisDay):null))))}static get watchers(){return{unassignedDatesProp:["handleUnassignedDatesToBeAssignedChange"]}}};ve.style=ke;class we extends R{async fetchData(t,e){try{const i=this.getToken();if(i!==null){const{data:s}=await S.post(`/Get_Exposed_Property?Ticket=${i}`,{id:t,language:e});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}const n=s.My_Result;A.adultChildConstraints=n.adult_child_constraints;A.allowedBookingSources=n.allowed_booking_sources;A.allowed_payment_methods=n.allowed_booking_methods;A.currency=n.currency;A.is_vacation_rental=n.is_vacation_rental;A.pickup_service=n.pickup_service;A.max_nights=n.max_nights;A.roomsInfo=n.roomtypes;A.taxes=n.taxes;A.id=n.id;A.country=n.country;A.name=n.name;A.tax_statement=n.tax_statement;A.is_frontdesk_enabled=n.is_frontdesk_enabled;A.is_pms_enabled=n.is_pms_enabled;return s}}catch(t){console.log(t);throw new Error(t)}}async fetchLanguage(t,e=["_PMS_FRONT"]){try{const i=this.getToken();if(i!==null){const{data:s}=await S.post(`/Get_Exposed_Language?Ticket=${i}`,{code:t,sections:e});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}let n=this.transformArrayToObject(s.My_Result.entries);M.entries=Object.assign(Object.assign({},M.entries),n);M.direction=s.My_Result.direction;return{entries:n,direction:s.My_Result.direction}}}catch(t){console.log(t);throw new Error(t)}}transformArrayToObject(t){let e={};for(const i of t){e[i.code]=i.description}return e}}const xe=Object.create(null);xe["open"]="0";xe["close"]="1";xe["ping"]="2";xe["pong"]="3";xe["message"]="4";xe["upgrade"]="5";xe["noop"]="6";const _e=Object.create(null);Object.keys(xe).forEach((t=>{_e[xe[t]]=t}));const De={type:"error",data:"parser error"};const Ce=typeof Blob==="function"||typeof Blob!=="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]";const Oe=typeof ArrayBuffer==="function";const Ee=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer;const Te=({type:t,data:e},i,s)=>{if(Ce&&e instanceof Blob){if(i){return s(e)}else{return Ie(e,s)}}else if(Oe&&(e instanceof ArrayBuffer||Ee(e))){if(i){return s(e)}else{return Ie(new Blob([e]),s)}}return s(xe[t]+(e||""))};const Ie=(t,e)=>{const i=new FileReader;i.onload=function(){const t=i.result.split(",")[1];e("b"+(t||""))};return i.readAsDataURL(t)};function Be(t){if(t instanceof Uint8Array){return t}else if(t instanceof ArrayBuffer){return new Uint8Array(t)}else{return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}}let Me;function Ae(t,e){if(Ce&&t.data instanceof Blob){return t.data.arrayBuffer().then(Be).then(e)}else if(Oe&&(t.data instanceof ArrayBuffer||Ee(t.data))){return e(Be(t.data))}Te(t,false,(t=>{if(!Me){Me=new TextEncoder}e(Me.encode(t))}))}const Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const Re=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(let t=0;t<Ne.length;t++){Re[Ne.charCodeAt(t)]=t}const Se=t=>{let e=t.length*.75,i=t.length,s,n=0,o,a,r,l;if(t[t.length-1]==="="){e--;if(t[t.length-2]==="="){e--}}const c=new ArrayBuffer(e),h=new Uint8Array(c);for(s=0;s<i;s+=4){o=Re[t.charCodeAt(s)];a=Re[t.charCodeAt(s+1)];r=Re[t.charCodeAt(s+2)];l=Re[t.charCodeAt(s+3)];h[n++]=o<<2|a>>4;h[n++]=(a&15)<<4|r>>2;h[n++]=(r&3)<<6|l&63}return c};const Le=typeof ArrayBuffer==="function";const je=(t,e)=>{if(typeof t!=="string"){return{type:"message",data:ze(t,e)}}const i=t.charAt(0);if(i==="b"){return{type:"message",data:Ye(t.substring(1),e)}}const s=_e[i];if(!s){return De}return t.length>1?{type:_e[i],data:t.substring(1)}:{type:_e[i]}};const Ye=(t,e)=>{if(Le){const i=Se(t);return ze(i,e)}else{return{base64:true,data:t}}};const ze=(t,e)=>{switch(e){case"blob":if(t instanceof Blob){return t}else{return new Blob([t])}case"arraybuffer":default:if(t instanceof ArrayBuffer){return t}else{return t.buffer}}};const $e=String.fromCharCode(30);const Pe=(t,e)=>{const i=t.length;const s=new Array(i);let n=0;t.forEach(((t,o)=>{Te(t,false,(t=>{s[o]=t;if(++n===i){e(s.join($e))}}))}))};const He=(t,e)=>{const i=t.split($e);const s=[];for(let t=0;t<i.length;t++){const n=je(i[t],e);s.push(n);if(n.type==="error"){break}}return s};function Ue(){return new TransformStream({transform(t,e){Ae(t,(i=>{const s=i.length;let n;if(s<126){n=new Uint8Array(1);new DataView(n.buffer).setUint8(0,s)}else if(s<65536){n=new Uint8Array(3);const t=new DataView(n.buffer);t.setUint8(0,126);t.setUint16(1,s)}else{n=new Uint8Array(9);const t=new DataView(n.buffer);t.setUint8(0,127);t.setBigUint64(1,BigInt(s))}if(t.data&&typeof t.data!=="string"){n[0]|=128}e.enqueue(n);e.enqueue(i)}))}})}let Ge;function Ve(t){return t.reduce(((t,e)=>t+e.length),0)}function Ke(t,e){if(t[0].length===e){return t.shift()}const i=new Uint8Array(e);let s=0;for(let n=0;n<e;n++){i[n]=t[0][s++];if(s===t[0].length){t.shift();s=0}}if(t.length&&s<t[0].length){t[0]=t[0].slice(s)}return i}function Fe(t,e){if(!Ge){Ge=new TextDecoder}const i=[];let s=0;let n=-1;let o=false;return new TransformStream({transform(a,r){i.push(a);while(true){if(s===0){if(Ve(i)<1){break}const t=Ke(i,1);o=(t[0]&128)===128;n=t[0]&127;if(n<126){s=3}else if(n===126){s=1}else{s=2}}else if(s===1){if(Ve(i)<2){break}const t=Ke(i,2);n=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0);s=3}else if(s===2){if(Ve(i)<8){break}const t=Ke(i,8);const e=new DataView(t.buffer,t.byteOffset,t.length);const o=e.getUint32(0);if(o>Math.pow(2,53-32)-1){r.enqueue(De);break}n=o*Math.pow(2,32)+e.getUint32(4);s=3}else{if(Ve(i)<n){break}const t=Ke(i,n);r.enqueue(je(o?t:Ge.decode(t),e));s=0}if(n===0||n>t){r.enqueue(De);break}}}})}const We=4;function qe(t){if(t)return Xe(t)}function Xe(t){for(var e in qe.prototype){t[e]=qe.prototype[e]}return t}qe.prototype.on=qe.prototype.addEventListener=function(t,e){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e);return this};qe.prototype.once=function(t,e){function i(){this.off(t,i);e.apply(this,arguments)}i.fn=e;this.on(t,i);return this};qe.prototype.off=qe.prototype.removeListener=qe.prototype.removeAllListeners=qe.prototype.removeEventListener=function(t,e){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var s;for(var n=0;n<i.length;n++){s=i[n];if(s===e||s.fn===e){i.splice(n,1);break}}if(i.length===0){delete this._callbacks["$"+t]}return this};qe.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=new Array(arguments.length-1),i=this._callbacks["$"+t];for(var s=1;s<arguments.length;s++){e[s-1]=arguments[s]}if(i){i=i.slice(0);for(var s=0,n=i.length;s<n;++s){i[s].apply(this,e)}}return this};qe.prototype.emitReserved=qe.prototype.emit;qe.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};qe.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Je=(()=>{if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else{return Function("return this")()}})();function Ze(t,...e){return e.reduce(((e,i)=>{if(t.hasOwnProperty(i)){e[i]=t[i]}return e}),{})}const Qe=Je.setTimeout;const ti=Je.clearTimeout;function ei(t,e){if(e.useNativeTimers){t.setTimeoutFn=Qe.bind(Je);t.clearTimeoutFn=ti.bind(Je)}else{t.setTimeoutFn=Je.setTimeout.bind(Je);t.clearTimeoutFn=Je.clearTimeout.bind(Je)}}const ii=1.33;function si(t){if(typeof t==="string"){return ni(t)}return Math.ceil((t.byteLength||t.size)*ii)}function ni(t){let e=0,i=0;for(let s=0,n=t.length;s<n;s++){e=t.charCodeAt(s);if(e<128){i+=1}else if(e<2048){i+=2}else if(e<55296||e>=57344){i+=3}else{s++;i+=4}}return i}function oi(t){let e="";for(let i in t){if(t.hasOwnProperty(i)){if(e.length)e+="&";e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i])}}return e}function ai(t){let e={};let i=t.split("&");for(let t=0,s=i.length;t<s;t++){let s=i[t].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class ri extends Error{constructor(t,e,i){super(t);this.description=e;this.context=i;this.type="TransportError"}}class li extends qe{constructor(t){super();this.writable=false;ei(this,t);this.opts=t;this.query=t.query;this.socket=t.socket}onError(t,e,i){super.emitReserved("error",new ri(t,e,i));return this}open(){this.readyState="opening";this.doOpen();return this}close(){if(this.readyState==="opening"||this.readyState==="open"){this.doClose();this.onClose()}return this}send(t){if(this.readyState==="open"){this.write(t)}}onOpen(){this.readyState="open";this.writable=true;super.emitReserved("open")}onData(t){const e=je(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed";super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){if(this.opts.port&&(this.opts.secure&&Number(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)){return":"+this.opts.port}else{return""}}_query(t){const e=oi(t);return e.length?"?"+e:""}}const ci="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),hi=64,di={};let fi=0,ui=0,bi;function pi(t){let e="";do{e=ci[t%hi]+e;t=Math.floor(t/hi)}while(t>0);return e}function gi(){const t=pi(+new Date);if(t!==bi)return fi=0,bi=t;return t+"."+pi(fi++)}for(;ui<hi;ui++)di[ci[ui]]=ui;let mi=false;try{mi=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const yi=mi;function ki(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||yi)){return new XMLHttpRequest}}catch(t){}if(!e){try{return new(Je[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}function vi(){}function wi(){}const xi=function(){const t=new ki({xdomain:false});return null!=t.responseType}();class _i extends li{constructor(t){super(t);this.polling=false;if(typeof location!=="undefined"){const e="https:"===location.protocol;let i=location.port;if(!i){i=e?"443":"80"}this.xd=typeof location!=="undefined"&&t.hostname!==location.hostname||i!==t.port}const e=t&&t.forceBase64;this.supportsBinary=xi&&!e;if(this.opts.withCredentials){this.cookieJar=vi()}}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused";t()};if(this.polling||!this.writable){let t=0;if(this.polling){t++;this.once("pollComplete",(function(){--t||e()}))}if(!this.writable){t++;this.once("drain",(function(){--t||e()}))}}else{e()}}poll(){this.polling=true;this.doPoll();this.emitReserved("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&t.type==="open"){this.onOpen()}if("close"===t.type){this.onClose({description:"transport closed by the server"});return false}this.onPacket(t)};He(t,this.socket.binaryType).forEach(e);if("closed"!==this.readyState){this.polling=false;this.emitReserved("pollComplete");if("open"===this.readyState){this.poll()}}}doClose(){const t=()=>{this.write([{type:"close"}])};if("open"===this.readyState){t()}else{this.once("open",t)}}write(t){this.writable=false;Pe(t,(t=>{this.doWrite(t,(()=>{this.writable=true;this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http";const e=this.query||{};if(false!==this.opts.timestampRequests){e[this.opts.timestampParam]=gi()}if(!this.supportsBinary&&!e.sid){e.b64=1}return this.createUri(t,e)}request(t={}){Object.assign(t,{xd:this.xd,cookieJar:this.cookieJar},this.opts);return new Di(this.uri(),t)}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e);i.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this));t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)}));this.pollXhr=t}}class Di extends qe{constructor(t,e){super();ei(this,e);this.opts=e;this.method=e.method||"GET";this.uri=t;this.data=undefined!==e.data?e.data:null;this.create()}create(){var t;const e=Ze(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd;const i=this.xhr=new ki(e);try{i.open(this.method,this.uri,true);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(true);for(let t in this.opts.extraHeaders){if(this.opts.extraHeaders.hasOwnProperty(t)){i.setRequestHeader(t,this.opts.extraHeaders[t])}}}}catch(t){}if("POST"===this.method){try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}}try{i.setRequestHeader("Accept","*/*")}catch(t){}(t=this.opts.cookieJar)===null||t===void 0?void 0:t.addCookies(i);if("withCredentials"in i){i.withCredentials=this.opts.withCredentials}if(this.opts.requestTimeout){i.timeout=this.opts.requestTimeout}i.onreadystatechange=()=>{var t;if(i.readyState===3){(t=this.opts.cookieJar)===null||t===void 0?void 0:t.parseCookies(i)}if(4!==i.readyState)return;if(200===i.status||1223===i.status){this.onLoad()}else{this.setTimeoutFn((()=>{this.onError(typeof i.status==="number"?i.status:0)}),0)}};i.send(this.data)}catch(t){this.setTimeoutFn((()=>{this.onError(t)}),0);return}if(typeof document!=="undefined"){this.index=Di.requestsCount++;Di.requests[this.index]=this}}onError(t){this.emitReserved("error",t,this.xhr);this.cleanup(true)}cleanup(t){if("undefined"===typeof this.xhr||null===this.xhr){return}this.xhr.onreadystatechange=wi;if(t){try{this.xhr.abort()}catch(t){}}if(typeof document!=="undefined"){delete Di.requests[this.index]}this.xhr=null}onLoad(){const t=this.xhr.responseText;if(t!==null){this.emitReserved("data",t);this.emitReserved("success");this.cleanup()}}abort(){this.cleanup()}}Di.requestsCount=0;Di.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",Ci)}else if(typeof addEventListener==="function"){const t="onpagehide"in Je?"pagehide":"unload";addEventListener(t,Ci,false)}}function Ci(){for(let t in Di.requests){if(Di.requests.hasOwnProperty(t)){Di.requests[t].abort()}}}const Oi=(()=>{const t=typeof Promise==="function"&&typeof Promise.resolve==="function";if(t){return t=>Promise.resolve().then(t)}else{return(t,e)=>e(t,0)}})();const Ei=Je.WebSocket||Je.MozWebSocket;const Ti="arraybuffer";const Ii=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class Bi extends li{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check()){return}const t=this.uri();const e=this.opts.protocols;const i=Ii?{}:Ze(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders){i.headers=this.opts.extraHeaders}try{this.ws=!Ii?e?new Ei(t,e):new Ei(t):new Ei(t,e,i)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType;this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref){this.ws._socket.unref()}this.onOpen()};this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t});this.ws.onmessage=t=>this.onData(t.data);this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;Te(i,this.supportsBinary,(t=>{try{{this.ws.send(t)}}catch(t){}if(s){Oi((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){if(typeof this.ws!=="undefined"){this.ws.close();this.ws=null}}uri(){const t=this.opts.secure?"wss":"ws";const e=this.query||{};if(this.opts.timestampRequests){e[this.opts.timestampParam]=gi()}if(!this.supportsBinary){e.b64=1}return this.createUri(t,e)}check(){return!!Ei}}class Mi extends li{get name(){return"webtransport"}doOpen(){if(typeof WebTransport!=="function"){return}this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]);this.transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)}));this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((t=>{const e=Fe(Number.MAX_SAFE_INTEGER,this.socket.binaryType);const i=t.readable.pipeThrough(e).getReader();const s=Ue();s.readable.pipeTo(t.writable);this.writer=s.writable.getWriter();const n=()=>{i.read().then((({done:t,value:e})=>{if(t){return}this.onPacket(e);n()})).catch((t=>{}))};n();const o={type:"open"};if(this.query.sid){o.data=`{"sid":"${this.query.sid}"}`}this.writer.write(o).then((()=>this.onOpen()))}))}))}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;this.writer.write(i).then((()=>{if(s){Oi((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){var t;(t=this.transport)===null||t===void 0?void 0:t.close()}}const Ai={websocket:Bi,webtransport:Mi,polling:_i};const Ni=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;const Ri=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Si(t){if(t.length>2e3){throw"URI too long"}const e=t,i=t.indexOf("["),s=t.indexOf("]");if(i!=-1&&s!=-1){t=t.substring(0,i)+t.substring(i,s).replace(/:/g,";")+t.substring(s,t.length)}let n=Ni.exec(t||""),o={},a=14;while(a--){o[Ri[a]]=n[a]||""}if(i!=-1&&s!=-1){o.source=e;o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":");o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":");o.ipv6uri=true}o.pathNames=Li(o,o["path"]);o.queryKey=ji(o,o["query"]);return o}function Li(t,e){const i=/\/{2,9}/g,s=e.replace(i,"/").split("/");if(e.slice(0,1)=="/"||e.length===0){s.splice(0,1)}if(e.slice(-1)=="/"){s.splice(s.length-1,1)}return s}function ji(t,e){const i={};e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,s){if(e){i[e]=s}}));return i}class Yi extends qe{constructor(t,e={}){super();this.binaryType=Ti;this.writeBuffer=[];if(t&&"object"===typeof t){e=t;t=null}if(t){t=Si(t);e.hostname=t.host;e.secure=t.protocol==="https"||t.protocol==="wss";e.port=t.port;if(t.query)e.query=t.query}else if(e.host){e.hostname=Si(e.host).host}ei(this,e);this.secure=null!=e.secure?e.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(e.hostname&&!e.port){e.port=this.secure?"443":"80"}this.hostname=e.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=e.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?"443":"80");this.transports=e.transports||["polling","websocket","webtransport"];this.writeBuffer=[];this.prevBufferLen=0;this.opts=Object.assign({path:"/engine.io",agent:false,withCredentials:false,upgrade:true,timestampParam:"t",rememberUpgrade:false,addTrailingSlash:true,rejectUnauthorized:true,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:false},e);this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":"");if(typeof this.opts.query==="string"){this.opts.query=ai(this.opts.query)}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingTimeoutTimer=null;if(typeof addEventListener==="function"){if(this.opts.closeOnBeforeunload){this.beforeunloadEventListener=()=>{if(this.transport){this.transport.removeAllListeners();this.transport.close()}};addEventListener("beforeunload",this.beforeunloadEventListener,false)}if(this.hostname!=="localhost"){this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})};addEventListener("offline",this.offlineEventListener,false)}}this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=We;e.transport=t;if(this.id)e.sid=this.id;const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new Ai[t](i)}open(){let t;if(this.opts.rememberUpgrade&&Yi.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){t="websocket"}else if(0===this.transports.length){this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);return}else{t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){this.transports.shift();this.open();return}t.open();this.setTransport(t)}setTransport(t){if(this.transport){this.transport.removeAllListeners()}this.transport=t;t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t);let i=false;Yi.priorWebsocketSuccess=false;const s=()=>{if(i)return;e.send([{type:"ping",data:"probe"}]);e.once("packet",(t=>{if(i)return;if("pong"===t.type&&"probe"===t.data){this.upgrading=true;this.emitReserved("upgrading",e);if(!e)return;Yi.priorWebsocketSuccess="websocket"===e.name;this.transport.pause((()=>{if(i)return;if("closed"===this.readyState)return;c();this.setTransport(e);e.send([{type:"upgrade"}]);this.emitReserved("upgrade",e);e=null;this.upgrading=false;this.flush()}))}else{const t=new Error("probe error");t.transport=e.name;this.emitReserved("upgradeError",t)}}))};function n(){if(i)return;i=true;c();e.close();e=null}const o=t=>{const i=new Error("probe error: "+t);i.transport=e.name;n();this.emitReserved("upgradeError",i)};function a(){o("transport closed")}function r(){o("socket closed")}function l(t){if(e&&t.name!==e.name){n()}}const c=()=>{e.removeListener("open",s);e.removeListener("error",o);e.removeListener("close",a);this.off("close",r);this.off("upgrading",l)};e.once("open",s);e.once("error",o);e.once("close",a);this.once("close",r);this.once("upgrading",l);if(this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"){this.setTimeoutFn((()=>{if(!i){e.open()}}),200)}else{e.open()}}onOpen(){this.readyState="open";Yi.priorWebsocketSuccess="websocket"===this.transport.name;this.emitReserved("open");this.flush();if("open"===this.readyState&&this.opts.upgrade){let t=0;const e=this.upgrades.length;for(;t<e;t++){this.probe(this.upgrades[t])}}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.emitReserved("packet",t);this.emitReserved("heartbeat");this.resetPingTimeout();switch(t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data;this.onError(e);break;case"message":this.emitReserved("data",t.data);this.emitReserved("message",t.data);break}}}onHandshake(t){this.emitReserved("handshake",t);this.id=t.sid;this.transport.query.sid=t.sid;this.upgrades=this.filterUpgrades(t.upgrades);this.pingInterval=t.pingInterval;this.pingTimeout=t.pingTimeout;this.maxPayload=t.maxPayload;this.onOpen();if("closed"===this.readyState)return;this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout);if(this.opts.autoUnref){this.pingTimeoutTimer.unref()}}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emitReserved("drain")}else{this.flush()}}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t);this.prevBufferLen=t.length;this.emitReserved("flush")}}getWritablePackets(){const t=this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1;if(!t){return this.writeBuffer}let e=1;for(let t=0;t<this.writeBuffer.length;t++){const i=this.writeBuffer[t].data;if(i){e+=si(i)}if(t>0&&e>this.maxPayload){return this.writeBuffer.slice(0,t)}e+=2}return this.writeBuffer}write(t,e,i){this.sendPacket("message",t,e,i);return this}send(t,e,i){this.sendPacket("message",t,e,i);return this}sendPacket(t,e,i,s){if("function"===typeof e){s=e;e=undefined}if("function"===typeof i){s=i;i=null}if("closing"===this.readyState||"closed"===this.readyState){return}i=i||{};i.compress=false!==i.compress;const n={type:t,data:e,options:i};this.emitReserved("packetCreate",n);this.writeBuffer.push(n);if(s)this.once("flush",s);this.flush()}close(){const t=()=>{this.onClose("forced close");this.transport.close()};const e=()=>{this.off("upgrade",e);this.off("upgradeError",e);t()};const i=()=>{this.once("upgrade",e);this.once("upgradeError",e)};if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";if(this.writeBuffer.length){this.once("drain",(()=>{if(this.upgrading){i()}else{t()}}))}else if(this.upgrading){i()}else{t()}}return this}onError(t){Yi.priorWebsocketSuccess=false;this.emitReserved("error",t);this.onClose("transport error",t)}onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.clearTimeoutFn(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();if(typeof removeEventListener==="function"){removeEventListener("beforeunload",this.beforeunloadEventListener,false);removeEventListener("offline",this.offlineEventListener,false)}this.readyState="closed";this.id=null;this.emitReserved("close",t,e);this.writeBuffer=[];this.prevBufferLen=0}}filterUpgrades(t){const e=[];let i=0;const s=t.length;for(;i<s;i++){if(~this.transports.indexOf(t[i]))e.push(t[i])}return e}}Yi.protocol=We;function zi(t,e="",i){let s=t;i=i||typeof location!=="undefined"&&location;if(null==t)t=i.protocol+"//"+i.host;if(typeof t==="string"){if("/"===t.charAt(0)){if("/"===t.charAt(1)){t=i.protocol+t}else{t=i.host+t}}if(!/^(https?|wss?):\/\//.test(t)){if("undefined"!==typeof i){t=i.protocol+"//"+t}else{t="https://"+t}}s=Si(t)}if(!s.port){if(/^(http|ws)$/.test(s.protocol)){s.port="80"}else if(/^(http|ws)s$/.test(s.protocol)){s.port="443"}}s.path=s.path||"/";const n=s.host.indexOf(":")!==-1;const o=n?"["+s.host+"]":s.host;s.id=s.protocol+"://"+o+":"+s.port+e;s.href=s.protocol+"://"+o+(i&&i.port===s.port?"":":"+s.port);return s}const $i=typeof ArrayBuffer==="function";const Pi=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;const Hi=Object.prototype.toString;const Ui=typeof Blob==="function"||typeof Blob!=="undefined"&&Hi.call(Blob)==="[object BlobConstructor]";const Gi=typeof File==="function"||typeof File!=="undefined"&&Hi.call(File)==="[object FileConstructor]";function Vi(t){return $i&&(t instanceof ArrayBuffer||Pi(t))||Ui&&t instanceof Blob||Gi&&t instanceof File}function Ki(t,e){if(!t||typeof t!=="object"){return false}if(Array.isArray(t)){for(let e=0,i=t.length;e<i;e++){if(Ki(t[e])){return true}}return false}if(Vi(t)){return true}if(t.toJSON&&typeof t.toJSON==="function"&&arguments.length===1){return Ki(t.toJSON(),true)}for(const e in t){if(Object.prototype.hasOwnProperty.call(t,e)&&Ki(t[e])){return true}}return false}function Fi(t){const e=[];const i=t.data;const s=t;s.data=Wi(i,e);s.attachments=e.length;return{packet:s,buffers:e}}function Wi(t,e){if(!t)return t;if(Vi(t)){const i={_placeholder:true,num:e.length};e.push(t);return i}else if(Array.isArray(t)){const i=new Array(t.length);for(let s=0;s<t.length;s++){i[s]=Wi(t[s],e)}return i}else if(typeof t==="object"&&!(t instanceof Date)){const i={};for(const s in t){if(Object.prototype.hasOwnProperty.call(t,s)){i[s]=Wi(t[s],e)}}return i}return t}function qi(t,e){t.data=Xi(t.data,e);delete t.attachments;return t}function Xi(t,e){if(!t)return t;if(t&&t._placeholder===true){const i=typeof t.num==="number"&&t.num>=0&&t.num<e.length;if(i){return e[t.num]}else{throw new Error("illegal attachments")}}else if(Array.isArray(t)){for(let i=0;i<t.length;i++){t[i]=Xi(t[i],e)}}else if(typeof t==="object"){for(const i in t){if(Object.prototype.hasOwnProperty.call(t,i)){t[i]=Xi(t[i],e)}}}return t}const Ji=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];const Zi=5;var Qi;(function(t){t[t["CONNECT"]=0]="CONNECT";t[t["DISCONNECT"]=1]="DISCONNECT";t[t["EVENT"]=2]="EVENT";t[t["ACK"]=3]="ACK";t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR";t[t["BINARY_EVENT"]=5]="BINARY_EVENT";t[t["BINARY_ACK"]=6]="BINARY_ACK"})(Qi||(Qi={}));class ts{constructor(t){this.replacer=t}encode(t){if(t.type===Qi.EVENT||t.type===Qi.ACK){if(Ki(t)){return this.encodeAsBinary({type:t.type===Qi.EVENT?Qi.BINARY_EVENT:Qi.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}}return[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;if(t.type===Qi.BINARY_EVENT||t.type===Qi.BINARY_ACK){e+=t.attachments+"-"}if(t.nsp&&"/"!==t.nsp){e+=t.nsp+","}if(null!=t.id){e+=t.id}if(null!=t.data){e+=JSON.stringify(t.data,this.replacer)}return e}encodeAsBinary(t){const e=Fi(t);const i=this.encodeAsString(e.packet);const s=e.buffers;s.unshift(i);return s}}function es(t){return Object.prototype.toString.call(t)==="[object Object]"}class is extends qe{constructor(t){super();this.reviver=t}add(t){let e;if(typeof t==="string"){if(this.reconstructor){throw new Error("got plaintext data when reconstructing a packet")}e=this.decodeString(t);const i=e.type===Qi.BINARY_EVENT;if(i||e.type===Qi.BINARY_ACK){e.type=i?Qi.EVENT:Qi.ACK;this.reconstructor=new ss(e);if(e.attachments===0){super.emitReserved("decoded",e)}}else{super.emitReserved("decoded",e)}}else if(Vi(t)||t.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{e=this.reconstructor.takeBinaryData(t);if(e){this.reconstructor=null;super.emitReserved("decoded",e)}}}else{throw new Error("Unknown type: "+t)}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(Qi[i.type]===undefined){throw new Error("unknown packet type "+i.type)}if(i.type===Qi.BINARY_EVENT||i.type===Qi.BINARY_ACK){const s=e+1;while(t.charAt(++e)!=="-"&&e!=t.length){}const n=t.substring(s,e);if(n!=Number(n)||t.charAt(e)!=="-"){throw new Error("Illegal attachments")}i.attachments=Number(n)}if("/"===t.charAt(e+1)){const s=e+1;while(++e){const i=t.charAt(e);if(","===i)break;if(e===t.length)break}i.nsp=t.substring(s,e)}else{i.nsp="/"}const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const s=e+1;while(++e){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=this.tryParse(t.substr(e));if(is.isPayloadValid(i.type,s)){i.data=s}else{throw new Error("invalid payload")}}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return false}}static isPayloadValid(t,e){switch(t){case Qi.CONNECT:return es(e);case Qi.DISCONNECT:return e===undefined;case Qi.CONNECT_ERROR:return typeof e==="string"||es(e);case Qi.EVENT:case Qi.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]==="number"||typeof e[0]==="string"&&Ji.indexOf(e[0])===-1);case Qi.ACK:case Qi.BINARY_ACK:return Array.isArray(e)}}destroy(){if(this.reconstructor){this.reconstructor.finishedReconstruction();this.reconstructor=null}}}class ss{constructor(t){this.packet=t;this.buffers=[];this.reconPack=t}takeBinaryData(t){this.buffers.push(t);if(this.buffers.length===this.reconPack.attachments){const t=qi(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null}finishedReconstruction(){this.reconPack=null;this.buffers=[]}}const ns=Object.freeze({__proto__:null,protocol:Zi,get PacketType(){return Qi},Encoder:ts,Decoder:is});function os(t,e,i){t.on(e,i);return function s(){t.off(e,i)}}const as=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class rs extends qe{constructor(t,e,i){super();this.connected=false;this.recovered=false;this.receiveBuffer=[];this.sendBuffer=[];this._queue=[];this._queueSeq=0;this.ids=0;this.acks={};this.flags={};this.io=t;this.nsp=e;if(i&&i.auth){this.auth=i.auth}this._opts=Object.assign({},i);if(this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[os(t,"open",this.onopen.bind(this)),os(t,"packet",this.onpacket.bind(this)),os(t,"error",this.onerror.bind(this)),os(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;this.subEvents();if(!this.io["_reconnecting"])this.io.open();if("open"===this.io._readyState)this.onopen();return this}open(){return this.connect()}send(...t){t.unshift("message");this.emit.apply(this,t);return this}emit(t,...e){if(as.hasOwnProperty(t)){throw new Error('"'+t.toString()+'" is a reserved event name')}e.unshift(t);if(this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile){this._addToQueue(e);return this}const i={type:Qi.EVENT,data:e};i.options={};i.options.compress=this.flags.compress!==false;if("function"===typeof e[e.length-1]){const t=this.ids++;const s=e.pop();this._registerAckCallback(t,s);i.id=t}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;const n=this.flags.volatile&&(!s||!this.connected);if(n);else if(this.connected){this.notifyOutgoingListeners(i);this.packet(i)}else{this.sendBuffer.push(i)}this.flags={};return this}_registerAckCallback(t,e){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===undefined){this.acks[t]=e;return}const n=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++){if(this.sendBuffer[e].id===t){this.sendBuffer.splice(e,1)}}e.call(this,new Error("operation has timed out"))}),s);const o=(...t)=>{this.io.clearTimeoutFn(n);e.apply(this,t)};o.withError=true;this.acks[t]=o}emitWithAck(t,...e){return new Promise(((i,s)=>{const n=(t,e)=>t?s(t):i(e);n.withError=true;e.push(n);this.emit(t,...e)}))}_addToQueue(t){let e;if(typeof t[t.length-1]==="function"){e=t.pop()}const i={id:this._queueSeq++,tryCount:0,pending:false,args:t,flags:Object.assign({fromQueue:true},this.flags)};t.push(((t,...s)=>{if(i!==this._queue[0]){return}const n=t!==null;if(n){if(i.tryCount>this._opts.retries){this._queue.shift();if(e){e(t)}}}else{this._queue.shift();if(e){e(null,...s)}}i.pending=false;return this._drainQueue()}));this._queue.push(i);this._drainQueue()}_drainQueue(t=false){if(!this.connected||this._queue.length===0){return}const e=this._queue[0];if(e.pending&&!t){return}e.pending=true;e.tryCount++;this.flags=e.flags;this.emit.apply(this,e.args)}packet(t){t.nsp=this.nsp;this.io._packet(t)}onopen(){if(typeof this.auth=="function"){this.auth((t=>{this._sendConnectPacket(t)}))}else{this._sendConnectPacket(this.auth)}}_sendConnectPacket(t){this.packet({type:Qi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){if(!this.connected){this.emitReserved("connect_error",t)}}onclose(t,e){this.connected=false;delete this.id;this.emitReserved("disconnect",t,e);this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{const e=this.sendBuffer.some((e=>String(e.id)===t));if(!e){const e=this.acks[t];delete this.acks[t];if(e.withError){e.call(this,new Error("socket has been disconnected"))}}}))}onpacket(t){const e=t.nsp===this.nsp;if(!e)return;switch(t.type){case Qi.CONNECT:if(t.data&&t.data.sid){this.onconnect(t.data.sid,t.data.pid)}else{this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"))}break;case Qi.EVENT:case Qi.BINARY_EVENT:this.onevent(t);break;case Qi.ACK:case Qi.BINARY_ACK:this.onack(t);break;case Qi.DISCONNECT:this.ondisconnect();break;case Qi.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data;this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];if(null!=t.id){e.push(this.ack(t.id))}if(this.connected){this.emitEvent(e)}else{this.receiveBuffer.push(Object.freeze(e))}}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e){i.apply(this,t)}}super.emit.apply(this,t);if(this._pid&&t.length&&typeof t[t.length-1]==="string"){this._lastOffset=t[t.length-1]}}ack(t){const e=this;let i=false;return function(...s){if(i)return;i=true;e.packet({type:Qi.ACK,id:t,data:s})}}onack(t){const e=this.acks[t.id];if(typeof e!=="function"){return}delete this.acks[t.id];if(e.withError){t.data.unshift(null)}e.apply(this,t.data)}onconnect(t,e){this.id=t;this.recovered=e&&this._pid===e;this._pid=e;this.connected=true;this.emitBuffered();this.emitReserved("connect");this._drainQueue(true)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t)));this.receiveBuffer=[];this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t);this.packet(t)}));this.sendBuffer=[]}ondisconnect(){this.destroy();this.onclose("io server disconnect")}destroy(){if(this.subs){this.subs.forEach((t=>t()));this.subs=undefined}this.io["_destroy"](this)}disconnect(){if(this.connected){this.packet({type:Qi.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this}close(){return this.disconnect()}compress(t){this.flags.compress=t;return this}get volatile(){this.flags.volatile=true;return this}timeout(t){this.flags.timeout=t;return this}onAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.push(t);return this}prependAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.unshift(t);return this}offAny(t){if(!this._anyListeners){return this}if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyListeners=[]}return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.push(t);return this}prependAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.unshift(t);return this}offAnyOutgoing(t){if(!this._anyOutgoingListeners){return this}if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyOutgoingListeners=[]}return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e){i.apply(this,t.data)}}}}function ls(t){t=t||{};this.ms=t.min||100;this.max=t.max||1e4;this.factor=t.factor||2;this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0;this.attempts=0}ls.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random();var i=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-i:t+i}return Math.min(t,this.max)|0};ls.prototype.reset=function(){this.attempts=0};ls.prototype.setMin=function(t){this.ms=t};ls.prototype.setMax=function(t){this.max=t};ls.prototype.setJitter=function(t){this.jitter=t};class cs extends qe{constructor(t,e){var i;super();this.nsps={};this.subs=[];if(t&&"object"===typeof t){e=t;t=undefined}e=e||{};e.path=e.path||"/socket.io";this.opts=e;ei(this,e);this.reconnection(e.reconnection!==false);this.reconnectionAttempts(e.reconnectionAttempts||Infinity);this.reconnectionDelay(e.reconnectionDelay||1e3);this.reconnectionDelayMax(e.reconnectionDelayMax||5e3);this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5);this.backoff=new ls({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==e.timeout?2e4:e.timeout);this._readyState="closed";this.uri=t;const s=e.parser||ns;this.encoder=new s.Encoder;this.decoder=new s.Decoder;this._autoConnect=e.autoConnect!==false;if(this._autoConnect)this.open()}reconnection(t){if(!arguments.length)return this._reconnection;this._reconnection=!!t;return this}reconnectionAttempts(t){if(t===undefined)return this._reconnectionAttempts;this._reconnectionAttempts=t;return this}reconnectionDelay(t){var e;if(t===undefined)return this._reconnectionDelay;this._reconnectionDelay=t;(e=this.backoff)===null||e===void 0?void 0:e.setMin(t);return this}randomizationFactor(t){var e;if(t===undefined)return this._randomizationFactor;this._randomizationFactor=t;(e=this.backoff)===null||e===void 0?void 0:e.setJitter(t);return this}reconnectionDelayMax(t){var e;if(t===undefined)return this._reconnectionDelayMax;this._reconnectionDelayMax=t;(e=this.backoff)===null||e===void 0?void 0:e.setMax(t);return this}timeout(t){if(!arguments.length)return this._timeout;this._timeout=t;return this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Yi(this.uri,this.opts);const e=this.engine;const i=this;this._readyState="opening";this.skipReconnect=false;const s=os(e,"open",(function(){i.onopen();t&&t()}));const n=e=>{this.cleanup();this._readyState="closed";this.emitReserved("error",e);if(t){t(e)}else{this.maybeReconnectOnOpen()}};const o=os(e,"error",n);if(false!==this._timeout){const t=this._timeout;const i=this.setTimeoutFn((()=>{s();n(new Error("timeout"));e.close()}),t);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}this.subs.push(s);this.subs.push(o);return this}connect(t){return this.open(t)}onopen(){this.cleanup();this._readyState="open";this.emitReserved("open");const t=this.engine;this.subs.push(os(t,"ping",this.onping.bind(this)),os(t,"data",this.ondata.bind(this)),os(t,"error",this.onerror.bind(this)),os(t,"close",this.onclose.bind(this)),os(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){Oi((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];if(!i){i=new rs(this,t,e);this.nsps[t]=i}else if(this._autoConnect&&!i.active){i.connect()}return i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){const e=this.nsps[t];if(e.active){return}}this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++){this.engine.write(e[i],t.options)}}cleanup(){this.subs.forEach((t=>t()));this.subs.length=0;this.decoder.destroy()}_close(){this.skipReconnect=true;this._reconnecting=false;this.onclose("forced close");if(this.engine)this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup();this.backoff.reset();this._readyState="closed";this.emitReserved("close",t,e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts){this.backoff.reset();this.emitReserved("reconnect_failed");this._reconnecting=false}else{const e=this.backoff.duration();this._reconnecting=true;const i=this.setTimeoutFn((()=>{if(t.skipReconnect)return;this.emitReserved("reconnect_attempt",t.backoff.attempts);if(t.skipReconnect)return;t.open((e=>{if(e){t._reconnecting=false;t.reconnect();this.emitReserved("reconnect_error",e)}else{t.onreconnect()}}))}),e);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=false;this.backoff.reset();this.emitReserved("reconnect",t)}}const hs={};function ds(t,e){if(typeof t==="object"){e=t;t=undefined}e=e||{};const i=zi(t,e.path||"/socket.io");const s=i.source;const n=i.id;const o=i.path;const a=hs[n]&&o in hs[n]["nsps"];const r=e.forceNew||e["force new connection"]||false===e.multiplex||a;let l;if(r){l=new cs(s,e)}else{if(!hs[n]){hs[n]=new cs(s,e)}l=hs[n]}if(i.query&&!e.query){e.query=i.queryKey}return l.socket(i.path,e)}Object.assign(ds,{Manager:cs,Socket:rs,io:ds,connect:ds});const fs=".sc-igloo-calendar-h{display:block;position:relative;background-color:#ffffff;height:100%;text-align:center}.igl-calendar.sc-igloo-calendar{display:grid;grid-template-columns:1fr;height:100%}.calendarScrollContainer.sc-igloo-calendar{width:100%;height:100%;overflow:auto;position:relative;white-space:nowrap;border-left:2px solid grey}.showToBeAssigned.sc-igloo-calendar,.showLegend.sc-igloo-calendar{grid-template-columns:330px 1fr}#calendarContainer.sc-igloo-calendar{position:absolute}.legendContainer.sc-igloo-calendar,.tobeAssignedContainer.sc-igloo-calendar{display:none;height:100%;overflow-y:auto;padding-left:0.5em !important;padding-right:0.5em !important}.showToBeAssigned.sc-igloo-calendar .tobeAssignedContainer.sc-igloo-calendar{display:block}.showLegend.sc-igloo-calendar .legendContainer.sc-igloo-calendar{display:block}.tobeBooked.sc-igloo-calendar{padding-top:8px;padding-bottom:8px;text-align:left}";const us=fs;const bs=class{constructor(i){t(this,i);this.dragOverHighlightElement=e(this,"dragOverHighlightElement",7);this.moveBookingTo=e(this,"moveBookingTo",7);this.calculateUnassignedDates=e(this,"calculateUnassignedDates",7);this.reduceAvailableUnitEvent=e(this,"reduceAvailableUnitEvent",7);this.revertBooking=e(this,"revertBooking",7);this.bookingService=new st;this.roomService=new we;this.eventsService=new lt;this.toBeAssignedService=new Ht;this.countryNodeList=[];this.visibleCalendarCells={x:[],y:[]};this.today="";this.reachedEndOfCalendar=false;this.scrollViewDragPos={top:0,left:0,x:0,y:0};this.onScrollContentMoveHandler=t=>{if(t.buttons!==1){return}const e=t.clientX-this.scrollViewDragPos.x;const i=t.clientY-this.scrollViewDragPos.y;this.scrollContainer.scrollTop=this.scrollViewDragPos.top-i;this.scrollContainer.scrollLeft=this.scrollViewDragPos.left-e;if(Math.abs(e)>5||Math.abs(i)>5){this.scrollViewDragging=true}};this.onScrollContentMoveEndHandler=()=>{document.removeEventListener("mousemove",this.onScrollContentMoveHandler);document.removeEventListener("mouseup",this.onScrollContentMoveEndHandler)};this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.language=undefined;this.baseurl=undefined;this.loadingMessage=undefined;this.currencyName=undefined;this.ticket="";this.calendarData=new Object;this.days=new Array;this.scrollViewDragging=false;this.dialogData=null;this.bookingItem=null;this.editBookingItem=null;this.showLegend=false;this.showPaymentDetails=false;this.showToBeAssigned=false;this.unassignedDates={};this.roomNightsData=null;this.renderAgain=false;this.showBookProperty=false;this.totalAvailabilityQueue=[];this.highlightedDate=undefined;this.calDates=undefined}ticketChanged(){A.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.eventsService.setToken(this.ticket);this.toBeAssignedService.setToken(this.ticket);this.initializeApp()}componentWillLoad(){console.info("without session storage");this.calDates={from:this.from_date,to:this.to_date};if(this.baseurl){S.defaults.baseURL=this.baseurl}if(this.ticket!==""){A.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.eventsService.setToken(this.ticket);this.toBeAssignedService.setToken(this.ticket);this.initializeApp()}Vt("unassigned_dates",(t=>{if(Object.keys(t).length===0&&this.highlightedDate!==""){this.highlightedDate=""}}))}setUpCalendarData(t,e){this.calendarData.currency=t["My_Result"].currency;this.calendarData.allowedBookingSources=t["My_Result"].allowed_booking_sources;this.calendarData.adultChildConstraints=t["My_Result"].adult_child_constraints;this.calendarData.legendData=this.getLegendData(t);this.calendarData.is_vacation_rental=t["My_Result"].is_vacation_rental;this.calendarData.from_date=e.My_Params_Get_Rooming_Data.FROM;this.calendarData.to_date=e.My_Params_Get_Rooming_Data.TO;this.calendarData.startingDate=new Date(e.My_Params_Get_Rooming_Data.FROM).getTime();this.calendarData.endingDate=new Date(e.My_Params_Get_Rooming_Data.TO).getTime();this.calendarData.formattedLegendData=m(this.calendarData.legendData);let i=e.myBookings||[];i=i.filter((t=>{const e=Y(t.TO_DATE,"YYYY-MM-DD");const i=Y(t.FROM_DATE,"YYYY-MM-DD");return!e.isSame(i)}));this.calendarData.bookingEvents=i;this.calendarData.toBeAssignedEvents=[]}async initializeApp(){try{const[t,e,i,s]=await Promise.all([this.roomService.fetchLanguage(this.language),this.roomService.fetchData(this.propertyid,this.language),this.bookingService.getCalendarData(this.propertyid,this.from_date,this.to_date),this.bookingService.getCountries(this.language)]);q.days=i.days;q.months=i.months;this.setRoomsData(e);this.countryNodeList=s;this.setUpCalendarData(e,i);let n=e["My_Result"]["allowed_payment_methods"];this.showPaymentDetails=n.some((t=>t.code==="001"||t.code==="004"));this.updateBookingEventsDateRange(this.calendarData.bookingEvents);this.updateBookingEventsDateRange(this.calendarData.toBeAssignedEvents);this.today=this.transformDateForScroll(new Date);let o=new Date(this.calendarData.startingDate);o.setHours(0,0,0,0);this.days=i.days;this.calendarData.days=this.days;this.calendarData.monthsInfo=i.months;q.fromDate=this.calendarData.from_date;q.toDate=this.calendarData.to_date;setTimeout((()=>{this.scrollToElement(this.today)}),200);if(!this.calendarData.is_vacation_rental){const t=await this.toBeAssignedService.getUnassignedDates(this.propertyid,d(new Date),this.to_date);this.unassignedDates={fromDate:this.from_date,toDate:this.to_date,data:Object.assign(Object.assign({},this.unassignedDates),t)};this.calendarData=Object.assign(Object.assign({},this.calendarData),{unassignedDates:t});Kt(t)}this.socket=ds("https://realtime.igloorooms.com/");this.socket.on("MSG",(async t=>{let e=JSON.parse(t);if(e){const{REASON:i,KEY:s,PAYLOAD:n}=e;if(s.toString()===this.propertyid.toString()){let o;console.log(i);if(i==="DELETE_CALENDAR_POOL"||i==="GET_UNASSIGNED_DATES"){o=n}else{o=JSON.parse(n)}const a=["DORESERVATION","BLOCK_EXPOSED_UNIT","ASSIGN_EXPOSED_ROOM","REALLOCATE_EXPOSED_ROOM_BLOCK"];if(a.includes(i)){let r;if(i==="BLOCK_EXPOSED_UNIT"||i==="REALLOCATE_EXPOSED_ROOM_BLOCK"){r=[await u(o)]}else{r=y(o);console.log(r)}this.AddOrUpdateRoomBookings(r,undefined)}else if(i==="DELETE_CALENDAR_POOL"){console.log("delete calendar pool");this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.filter((t=>t.POOL!==o))})}else if(i==="GET_UNASSIGNED_DATES"){function l(t){const e={};const i=t.split("|");i.forEach((t=>{const i=t.split(":");e[i[0]]=i[1]}));return e}const c=l(o);if(!this.calendarData.is_vacation_rental&&new Date(c.FROM_DATE).getTime()>=this.calendarData.startingDate&&new Date(c.TO_DATE).getTime()<=this.calendarData.endingDate){const h=await this.toBeAssignedService.getUnassignedDates(this.propertyid,d(new Date(c.FROM_DATE)),d(new Date(c.TO_DATE)));Kt(h);this.unassignedDates={fromDate:d(new Date(c.FROM_DATE)),toDate:d(new Date(c.TO_DATE)),data:h};if(Object.keys(h).length===0){Wt(d(new Date(c.FROM_DATE)),d(new Date(c.TO_DATE)));this.reduceAvailableUnitEvent.emit({fromDate:d(new Date(c.FROM_DATE)),toDate:d(new Date(c.TO_DATE))})}}}else if(i==="UPDATE_CALENDAR_AVAILABILITY"){this.totalAvailabilityQueue.push(o);if(this.totalAvailabilityQueue.length>0){clearTimeout(this.availabilityTimeout)}this.availabilityTimeout=setTimeout((()=>{this.updateTotalAvailability()}),1e3)}else if(i==="CHANGE_IN_DUE_AMOUNT"){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((t=>{if(o.pools.includes(t.ID)){return Object.assign(Object.assign({},t),{BALANCE:o.due_amount})}return t}))]})}else if(i==="CHANGE_IN_BOOK_STATUS"){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((t=>{if(o.pools.includes(t.ID)){return Object.assign(Object.assign({},t),{STATUS:t.STATUS!=="IN-HOUSE"?k[o.status_code]:o.status_code==="001"?k[o.status_code]:"IN-HOUSE"})}return t}))]})}else if(i==="NON_TECHNICAL_CHANGE_IN_BOOKING"){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((t=>{if(t.BOOKING_NUMBER===o.booking_nbr){return Object.assign(Object.assign({},t),{PRIVATE_NOTE:v(o.extras)})}return t}))]})}else{return}}}}))}catch(t){console.error("Initializing Calendar Error",t)}}updateTotalAvailability(){let t=[...q.days];this.totalAvailabilityQueue.forEach((e=>{let i=new Date(e.date);i.setMilliseconds(0);i.setSeconds(0);i.setMinutes(0);i.setHours(0);const s=t.findIndex((t=>t.currentDate===i.getTime()));if(s!=-1){const i=t[s].rate.findIndex((t=>t.id===e.room_type_id));if(i!=-1){t[s].rate[i].exposed_inventory.rts=e.availability}}}));q.days=[...t]}componentDidLoad(){this.scrollToElement(this.today)}async handleDeleteEvent(t){try{t.stopImmediatePropagation();t.preventDefault();await this.eventsService.deleteEvent(t.detail)}catch(t){}}scrollPageToRoom(t){let e=t.detail.refClass;this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const i=this.element.querySelector(".topLeftCell");const s=this.element.querySelector("."+e);if(s){this.scrollContainer.scrollTo({top:0});const t=s.getBoundingClientRect();const e=this.scrollContainer.getBoundingClientRect();const n=i.getBoundingClientRect();this.scrollContainer.scrollTo({top:t.top-e.top-n.height-t.height})}}handleShowDialog(t){this.dialogData=t.detail;let e=this.element.querySelector("ir-modal");if(e){e.openModal()}}handleShowRoomNightsDialog(t){this.roomNightsData=t.detail}handleBookingDatasChange(t){t.stopPropagation();t.stopImmediatePropagation();let e=[...this.calendarData.bookingEvents];e=e.filter((t=>t.ID!=="NEW_TEMP_EVENT"));e.push(...t.detail.filter((t=>t.STATUS==="PENDING-CONFIRMATION")));this.updateBookingEventsDateRange(t.detail);this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:e})}handleUpdateBookingEvent(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.detail;this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((t=>{if(e.ID===t.ID){return e}return t}))})}showBookingPopupEventDataHandler(t){t.preventDefault();t.stopImmediatePropagation();this.onOptionSelect(t)}updateEventDataHandler(t){let e=this.calendarData.bookingEvents.find((e=>e.id===t.detail.id));if(e&&t.detail&&t.detail.data){Object.entries(t.detail.data).forEach((([t,i])=>{e[t]=i}))}}dragOverEventDataHandler(t){if(t.detail.id==="CALCULATE_DRAG_OVER_BOUNDS"){let e=document.querySelector("igl-cal-header .topLeftCell");let i=document.querySelectorAll(".headersContainer .headerCell");let s=document.querySelectorAll(".bodyContainer .roomRow .roomTitle");this.visibleCalendarCells={x:[],y:[]};i.forEach((t=>{const i=t;this.visibleCalendarCells.x.push({left:i.offsetLeft+e.offsetWidth,width:i.offsetWidth,id:i.getAttribute("data-day")})}));s.forEach((t=>{const e=t;this.visibleCalendarCells.y.push({top:e.offsetTop,height:e.offsetHeight,id:e.getAttribute("data-room")})}));this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER"){this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER_END"){this.highlightDragOver(false,t.detail.data)}else if(t.detail.id==="STRETCH_OVER_END"){this.highlightDragOver(false,t.detail.data)}}checkBookingAvailability(t){return this.calendarData.bookingEvents.some((e=>e.ID===t.ID||e.FROM_DATE===t.FROM_DATE&&e.TO_DATE===t.TO_DATE&&e.PR_ID===t.PR_ID))}updateBookingEventsDateRange(t){const e=Y();t.forEach((t=>{t.legendData=this.calendarData.formattedLegendData;t.defaultDateRange={};t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=this.getDateStr(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=this.getDateStr(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS;t.roomsInfo=[...this.calendarData.roomsInfo];if(!w(t.STATUS_CODE)){const i=Y(t.TO_DATE,"YYYY-MM-DD");const s=Y(t.FROM_DATE,"YYYY-MM-DD");if(t.STATUS!=="PENDING"){if(s.isSame(e,"day")&&e.hour()>=12){t.STATUS=k["000"]}else if(e.isAfter(s,"day")&&e.isBefore(i,"day")){t.STATUS=k["000"]}else if(i.isSame(e,"day")&&e.hour()<12){t.STATUS=k["000"]}else if(i.isSame(e,"day")&&e.hour()>=12||i.isBefore(e,"day")){t.STATUS=k["003"]}}}}))}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}A.roomsInfo=s;this.calendarData.roomsInfo=s}getLegendData(t){return t["My_Result"].calendar_legends}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}scrollToElement(t){this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const e=this.element.querySelector(".topLeftCell");const i=this.element.querySelector(".day-"+t);if(i){this.scrollContainer.scrollTo({left:0});const t=i.getBoundingClientRect();const s=this.scrollContainer.getBoundingClientRect();const n=e.getBoundingClientRect();this.scrollContainer.scrollTo({left:t.left-s.left-n.width-t.width})}}AddOrUpdateRoomBookings(t,e){let i=[...this.calendarData.bookingEvents];t.forEach((t=>{if(!this.checkBookingAvailability(t)){i=i.filter((e=>e.ID!==t.ID))}}));this.updateBookingEventsDateRange(t);if(e){i=i.filter((t=>t.POOL===e))}t.forEach((t=>{if(!i.some((e=>e.ID===t.ID))){i.push(t)}}));this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:i})}transformDateForScroll(t){return Y(t).format("D_M_YYYY")}shouldRenderCalendarView(){return this.calendarData&&this.calendarData.days&&this.calendarData.days.length}onOptionSelect(t){const e=t.detail;const i=this.element.querySelector("#iglooCalendar");switch(e.key){case"showAssigned":i.classList.remove("showLegend");i.classList.remove("showToBeAssigned");i.classList.toggle("showToBeAssigned");this.showLegend=false;this.showToBeAssigned=true;break;case"showLegend":i.classList.remove("showToBeAssigned");i.classList.remove("showLegend");i.classList.toggle("showLegend");this.showLegend=true;this.showToBeAssigned=false;break;case"calendar":let t=new Date;if(e.data.start!==undefined&&e.data.end!==undefined){t=e.data.start.toDate();this.handleDateSearch(e.data)}else{t=new Date(e.data);t.setDate(t.getDate()+1);if(!(e===null||e===void 0?void 0:e.noScroll)){this.scrollToElement(t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear())}}this.highlightedDate=this.transformDateForScroll(t);break;case"search":break;case"add":if(e.data.event_type!=="EDIT_BOOKING"){this.bookingItem=e.data}else{this.editBookingItem=e.data}break;case"gotoToday":this.scrollToElement(this.today);break;case"closeSideMenu":this.closeSideMenu();this.highlightedDate="";this.showBookProperty=false;break}}async addDatesToCalendar(t,e){const i=await this.bookingService.getCalendarData(this.propertyid,t,e);const s=i.myBookings||[];this.updateBookingEventsDateRange(s);if(new Date(t).getTime()<new Date(this.calendarData.startingDate).getTime()){this.calendarData.startingDate=new Date(t).getTime();this.calendarData.from_date=t;q.fromDate=this.calendarData.from_date;this.days=[...i.days,...this.days];let e=[...i.months];if(this.calendarData.monthsInfo[0].monthName===i.months[i.months.length-1].monthName){this.calendarData.monthsInfo[0].daysCount=this.calendarData.monthsInfo[0].daysCount+i.months[i.months.length-1].daysCount;e.pop()}let n=JSON.parse(JSON.stringify(s));n=n.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].FROM_DATE=t.FROM_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=x(t.FROM_DATE,this.calendarData.bookingEvents[e].TO_DATE);return false}return true}));q.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...e,...this.calendarData.monthsInfo],bookingEvents:[...this.calendarData.bookingEvents,...n]})}else{this.calendarData.endingDate=new Date(e).getTime();this.calendarData.to_date=e;q.toDate=this.calendarData.to_date;let n=[...i.months];this.days=[...this.days,...i.days];if(this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].monthName===i.months[0].monthName){this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount=this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount+i.months[0].daysCount;n.shift()}let o=JSON.parse(JSON.stringify(s));o=o.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].TO_DATE=t.TO_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=x(this.calendarData.bookingEvents[e].FROM_DATE,t.TO_DATE);return false}return true}));q.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...this.calendarData.monthsInfo,...n],bookingEvents:[...this.calendarData.bookingEvents,...o]});const a=await this.toBeAssignedService.getUnassignedDates(this.propertyid,t,e);this.calendarData.unassignedDates=Object.assign(Object.assign({},this.calendarData.unassignedDates),a);this.unassignedDates={fromDate:t,toDate:e,data:a};Kt(a)}}async handleDateSearch(t){const e=Y(t.start).toDate();const i=Y(this.calDates.from).toDate();const s=t.end.toDate();const n=this.calendarData.endingDate;if(e.getTime()<new Date(this.calDates.from).getTime()){await this.addDatesToCalendar(Y(e).add(-1,"days").format("YYYY-MM-DD"),Y(i).add(-1,"days").format("YYYY-MM-DD"));this.calDates=Object.assign(Object.assign({},this.calDates),{from:t.start.add(-1,"days").format("YYYY-MM-DD")});this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>i.getTime()&&e.getTime()<n&&s.getTime()<n){this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>n){const t=_(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(t,Y(s).add(2,"months").format("YYYY-MM-DD"));this.scrollToElement(this.transformDateForScroll(e))}}closeSideMenu(){const t=this.element.querySelector("#iglooCalendar");t.classList.remove("showToBeAssigned");t.classList.remove("showLegend");this.showLegend=false;this.showToBeAssigned=false}dragScrollContent(t){this.scrollViewDragging=false;let e=t&&t.target?this.hasAncestorWithClass(t.target,"preventPageScroll"):false;if(!e&&t.buttons===1){this.scrollViewDragPos={left:this.scrollContainer.scrollLeft,top:this.scrollContainer.scrollTop,x:t.clientX,y:t.clientY};document.addEventListener("mousemove",this.onScrollContentMoveHandler);document.addEventListener("mouseup",this.onScrollContentMoveEndHandler)}}calendarScrolling(){if(this.scrollContainer){if(this.highlightedDate){const t=document.querySelector(`.day-${this.highlightedDate}`);if(t){const{left:e,right:i}=t.getBoundingClientRect();const s=e>=0&&i<=window.innerWidth;if(!s){this.highlightedDate=""}}}const t=this.scrollContainer.getBoundingClientRect();let e=170;let i=t.width-e;let s=t.x+e;let n=t.x+t.width;let o=Array.from(this.element.querySelectorAll(".monthCell"));if(o.length){o.map((async t=>{let e=t.getBoundingClientRect();if(o.indexOf(t)===o.length-1){if(e.x+e.width<=n&&!this.reachedEndOfCalendar){this.reachedEndOfCalendar=true;const t=D(new Date(this.calendarData.endingDate));const e=_(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(e,t);this.reachedEndOfCalendar=false}}if(e.x+e.width<s);else if(e.x>n);else{let o=t.querySelector(".monthTitle");let a=0;let r=e.width;if(e.x<s){a=Math.abs(e.x)-s;a=e.x<0?Math.abs(e.x)+s:Math.abs(a);r=e.x+e.width>n?i:e.x+e.width-s}else{r=i-r>r?r:i-e.x+s}o.style.marginLeft=a+"px";o.style.width=r+"px"}}))}}}hasAncestorWithClass(t,e){let i=t;while(i!==null){if(i.matches(`.${e}`)){return true}i=i.parentElement}return false}async highlightDragOver(t,e){let i,s;if(e){i=this.visibleCalendarCells.x.find((t=>t.left<e.x&&e.x<=t.left+t.width));s=this.visibleCalendarCells.y.find((t=>t.top<e.y&&e.y<=t.top+t.height))}if(t&&i&&s){this.dragOverHighlightElement.emit({dragOverElement:s.id+"_"+i.id})}else{this.dragOverHighlightElement.emit({dragOverElement:""})}if(!t){this.moveBookingTo.emit({bookingId:e.id,fromRoomId:e.fromRoomId,toRoomId:s&&s.id||"revert",moveToDay:i&&i.id||"revert",pool:e.pool,from_date:C(i&&i.id),to_date:O(i&&i.id,e.nbOfDays)})}}handleModalConfirm(){const{pool:t,toRoomId:e,from_date:i,to_date:s}=this.dialogData;this.eventsService.reallocateEvent(t,e,i,s).then((()=>{this.dialogData=null})).catch((()=>{this.revertBooking.emit(t)}))}handleModalCancel(){this.revertBooking.emit(this.dialogData.pool);this.dialogData=null}handleRoomNightsDialogClose(t){if(t.detail.type==="cancel"){this.revertBooking.emit(this.roomNightsData.pool)}this.roomNightsData=null}handleSideBarToggle(t){if(t.detail){if(this.editBookingItem){this.editBookingItem=null}if(this.roomNightsData){this.revertBooking.emit(this.roomNightsData.pool);this.roomNightsData=null}if(this.dialogData){this.revertBooking.emit(this.dialogData.pool);this.dialogData=null}}}handleCloseBookingWindow(){this.bookingItem=null}render(){var t,e;return i(s,{key:"e5534411071e60f5a5eacdf063f36afceec457d4"},i("ir-toast",{key:"b7426b064aa57f8c420e8a4fba530f735c93e711"}),i("ir-interceptor",{key:"e22de24e015b8fe95f49daecdf82b80498b5c12e"}),i("div",{key:"96d4818911c94e9cfb9844260119e813de5e1cad",id:"iglooCalendar",class:"igl-calendar"},this.shouldRenderCalendarView()?[this.showToBeAssigned?i("igl-to-be-assigned",{unassignedDatesProp:this.unassignedDates,to_date:this.to_date,from_date:this.from_date,propertyid:this.propertyid,class:"tobeAssignedContainer",calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)}):null,this.showLegend?i("igl-legends",{class:"legendContainer",legendData:this.calendarData.legendData,onOptionEvent:t=>this.onOptionSelect(t)}):null,i("div",{class:"calendarScrollContainer",onMouseDown:t=>this.dragScrollContent(t),onScroll:()=>this.calendarScrolling()},i("div",{id:"calendarContainer"},i("igl-cal-header",{unassignedDates:this.unassignedDates,to_date:this.to_date,propertyid:this.propertyid,today:this.today,calendarData:this.calendarData,highlightedDate:this.highlightedDate,onOptionEvent:t=>this.onOptionSelect(t)}),i("igl-cal-body",{language:this.language,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,today:this.today,highlightedDate:this.highlightedDate,isScrollViewDragging:this.scrollViewDragging,calendarData:this.calendarData}),i("igl-cal-footer",{highlightedDate:this.highlightedDate,today:this.today,calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)})))]:i("ir-loading-screen",{message:"Preparing Calendar Data"})),this.bookingItem&&i("igl-book-property",{key:"32c542f6db4ed3f8a21197d97a6226d4d15334c3",allowedBookingSources:this.calendarData.allowedBookingSources,adultChildConstraints:this.calendarData.adultChildConstraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}),i("ir-sidebar",{key:"b506771b2095d95d0763526ea61f2327211fb565",onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:this.roomNightsData!==null||this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING",showCloseButton:false,sidebarStyles:{width:this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:this.roomNightsData?"white":"#F2F3F8"}},this.roomNightsData&&i("ir-room-nights",{key:"19620f431b6c657ce294e582dc86ed0faeb7da48",slot:"sidebar-body",pool:this.roomNightsData.pool,onCloseRoomNightsDialog:this.handleRoomNightsDialogClose.bind(this),language:this.language,bookingNumber:this.roomNightsData.bookingNumber,identifier:this.roomNightsData.identifier,toDate:this.roomNightsData.to_date,fromDate:this.roomNightsData.from_date,ticket:this.ticket,propertyId:this.propertyid}),this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING"&&i("ir-booking-details",{key:"a65b5f0bc5bdf943eafb3a803cfb42adf86b7712",slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:()=>this.editBookingItem=null,is_from_front_desk:true,propertyid:this.propertyid,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.editBookingItem.BOOKING_NUMBER,ticket:this.ticket,baseurl:this.baseurl,language:this.language,hasRoomAdd:true})),i("ir-modal",{key:"c6288540d8d11bd84b359b5ac5578e3df07e32ce",modalTitle:"",rightBtnActive:this.dialogData?!this.dialogData.hideConfirmButton:true,leftBtnText:(t=M===null||M===void 0?void 0:M.entries)===null||t===void 0?void 0:t.Lcz_Cancel,rightBtnText:(e=M===null||M===void 0?void 0:M.entries)===null||e===void 0?void 0:e.Lcz_Confirm,modalBody:this.dialogData?this.dialogData.description:"",onConfirmModal:this.handleModalConfirm.bind(this),onCancelModal:this.handleModalCancel.bind(this)}))}get element(){return o(this)}static get watchers(){return{ticket:["ticketChanged"]}}};bs.style=us;const ps=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const gs=ps;const ms=class{constructor(i){t(this,i);this.comboboxValue=e(this,"comboboxValue",7);this.inputCleared=e(this,"inputCleared",7);this.toast=e(this,"toast",7);this.bookingService=new st;this.no_result_found="";this.duration=300;this.placeholder="";this.propertyId=undefined;this.isSplitBooking=false;this.type="text";this.name="";this.inputId=N();this.required=false;this.disabled=false;this.value=undefined;this.from_date="";this.to_date="";this.danger_border=undefined;this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputFocused=false}componentWillLoad(){this.bookingService.setToken(A.token);this.no_result_found=M.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const n=t+s;const o=n*this.selectedIndex;let a=o-e/2+t/2;a=Math.max(0,Math.min(a,i.scrollHeight-e));i.scrollTo({top:a,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return i("div",{class:`position-absolute border rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,e)=>i("p",{role:"button",onKeyDown:t=>this.handleItemKeyDown(t,e),"data-selected":this.selectedIndex===e,tabIndex:0,onClick:()=>this.selectItem(e)},this.isSplitBooking?i(n,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):i("div",{class:"d-flex align-items-center flex-fill"},i("p",{class:"p-0 m-0"},`${t.email}`," ",i("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&i("div",{class:"loader-container d-flex align-items-center justify-content-center"},i("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&i("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return i(s,{key:"b084901b89a526cac132d217a31799224cdc1157"},i("div",{key:"90c66c8e4401297bcd81fc109bcba98174d73313",class:"d-flex align-items-center "},i("label",{key:"14fd2c75fdb57109d253f5ce20409c4b04400e99","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},i("svg",{key:"67ed21e9cebeafbe55417882cc7270d3a92050c7",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},i("path",{key:"e92f04c0e502377c9edd56bf368af47779b9524e",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("input",{key:"6447aede09043b8d50f925b24f0984538201b5a3",required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&i("button",{key:"a3d642c7c72297042f2fb368c13cca91ad9b32ca",type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},i("p",{key:"d607ec727393af020fbe57e73a6cfbe7554c0a49",class:"sr-only"},"clear input"),i("svg",{key:"339fb89f01319fbc74e65a548cbbd27dff189edc",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i("path",{key:"6366fa3d50f282807854f2c65d0389b66e293fab",d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return o(this)}};ms.style=gs;const ys={clock:{d:"M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z",viewBox:"0 0 512 512"},check:{viewBox:"0 0 448 512",d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},danger:{viewBox:"0 0 512 512",d:"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"},bell:{viewBox:"0 0 448 512",d:"M224 0c-17.7 0-32 14.3-32 32V51.2C119 66 64 130.6 64 208v18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416H416c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3H224 160c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"},burger_menu:{viewBox:"0 0 448 512",d:"M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"},home:{viewBox:"0 0 576 512",d:"M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"},xmark:{viewBox:"0 0 384 512",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"},minus:{viewBox:"0 0 448 512",d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"},user:{viewBox:"0 0 448 512",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"},heart:{viewBox:"0 0 512 512",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"},user_group:{viewBox:"0 0 640 512",d:"M96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3zM609.3 512H471.4c5.4-9.4 8.6-20.3 8.6-32v-8c0-60.7-27.1-115.2-69.8-151.8c2.4-.1 4.7-.2 7.1-.2h61.4C567.8 320 640 392.2 640 481.3c0 17-13.8 30.7-30.7 30.7zM432 256c-31 0-59-12.6-79.3-32.9C372.4 196.5 384 163.6 384 128c0-26.8-6.6-52.1-18.3-74.3C384.3 40.1 407.2 32 432 32c61.9 0 112 50.1 112 112s-50.1 112-112 112z"},search:{viewBox:"0 0 512 512",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"},arrow_right:{viewBox:"0 0 448 512",d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"},arrow_left:{viewBox:"0 0 448 512",d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},circle_info:{viewBox:"0 0 512 512",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"},calendar:{viewBox:" 0 0 448 512",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"},globe:{viewBox:"0 0 256 256",d:"M128 24a104 104 0 1 0 104 104A104.12 104.12 0 0 0 128 24m88 104a87.6 87.6 0 0 1-3.33 24h-38.51a157.4 157.4 0 0 0 0-48h38.51a87.6 87.6 0 0 1 3.33 24m-114 40h52a115.1 115.1 0 0 1-26 45a115.3 115.3 0 0 1-26-45m-3.9-16a140.8 140.8 0 0 1 0-48h59.88a140.8 140.8 0 0 1 0 48ZM40 128a87.6 87.6 0 0 1 3.33-24h38.51a157.4 157.4 0 0 0 0 48H43.33A87.6 87.6 0 0 1 40 128m114-40h-52a115.1 115.1 0 0 1 26-45a115.3 115.3 0 0 1 26 45m52.33 0h-35.62a135.3 135.3 0 0 0-22.3-45.6A88.29 88.29 0 0 1 206.37 88Zm-98.74-45.6A135.3 135.3 0 0 0 85.29 88H49.63a88.29 88.29 0 0 1 57.96-45.6M49.63 168h35.66a135.3 135.3 0 0 0 22.3 45.6A88.29 88.29 0 0 1 49.63 168m98.78 45.6a135.3 135.3 0 0 0 22.3-45.6h35.66a88.29 88.29 0 0 1-57.96 45.6"},facebook:{viewBox:"0 0 512 512",d:"M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"},twitter:{viewBox:"0 0 512 512",d:"M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"},whatsapp:{viewBox:"0 0 448 512",d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7 .9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},instagram:{viewBox:"0 0 448 512",d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},youtube:{viewBox:"0 0 576 512",d:"M549.7 124.1c-6.3-23.7-24.8-42.3-48.3-48.6C458.8 64 288 64 288 64S117.2 64 74.6 75.5c-23.5 6.3-42 24.9-48.3 48.6-11.4 42.9-11.4 132.3-11.4 132.3s0 89.4 11.4 132.3c6.3 23.7 24.8 41.5 48.3 47.8C117.2 448 288 448 288 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zm-317.5 213.5V175.2l142.7 81.2-142.7 81.2z"},angle_left:{viewBox:"0 0 320 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},circle_check:{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z",viewBox:"0 0 512 512"},eraser:{viewBox:"0 0 576 512",d:"M290.7 57.4L57.4 290.7c-25 25-25 65.5 0 90.5l80 80c12 12 28.3 18.7 45.3 18.7H288h9.4H512c17.7 0 32-14.3 32-32s-14.3-32-32-32H387.9L518.6 285.3c25-25 25-65.5 0-90.5L381.3 57.4c-25-25-65.5-25-90.5 0zM297.4 416H288l-105.4 0-80-80L227.3 211.3 364.7 348.7 297.4 416z"},file:{viewBox:"0 0 384 512",d:"M48 448V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm90.9 233.3c-8.1-10.5-23.2-12.3-33.7-4.2s-12.3 23.2-4.2 33.7L161.6 320l-44.5 57.3c-8.1 10.5-6.3 25.5 4.2 33.7s25.5 6.3 33.7-4.2L192 359.1l37.1 47.6c8.1 10.5 23.2 12.3 33.7 4.2s12.3-23.2 4.2-33.7L222.4 320l44.5-57.3c8.1-10.5 6.3-25.5-4.2-33.7s-25.5-6.3-33.7 4.2L192 280.9l-37.1-47.6z"},edit:{viewBox:"0 0 512 512",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"},trash:{viewBox:"0 0 448 512",d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"},plus:{viewBox:"0 0 448 512",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"},reciept:{viewBox:"0 0 384 512",d:"M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM80 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm16 96H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm0 32v64H288V256H96zM240 416h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H240c-8.8 0-16-7.2-16-16s7.2-16 16-16z"},print:{viewBox:"0 0 512 512",d:"M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zM432 248a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"},menu_list:{viewBox:"0 0 512 512",d:"M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"},save:{viewBox:"0 0 448 512",d:"M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"},credit_card:{viewBox:"0 0 576 512",d:"M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"},closed_eye:{viewBox:"0 0 640 512",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"},open_eye:{viewBox:"0 0 576 512",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"},server:{viewBox:"0 0 512 512",d:"M448 160H320V128H448v32zM48 64C21.5 64 0 85.5 0 112v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zM448 352v32H192V352H448zM48 288c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48H48z"},double_caret_left:{viewBox:"0 0 512 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},square_plus:{viewBox:"0 0 448 512",d:"M64 80c-8.8 0-16 7.2-16 16l0 320c0 8.8 7.2 16 16 16l320 0c8.8 0 16-7.2 16-16l0-320c0-8.8-7.2-16-16-16L64 80zM0 96C0 60.7 28.7 32 64 32l320 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM200 344l0-64-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l64 0 0-64c0-13.3 10.7-24 24-24s24 10.7 24 24l0 64 64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0 0 64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"},angles_left:{viewBox:"0 0 512 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},angle_right:{viewBox:"0 0 320 512",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"},angles_right:{viewBox:"0 0 512 512",d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"}};const ks={secondary:{"--icon-button-color":"#6b6f82","--icon-button-hover-color":"#104064"},danger:{"--icon-button-color":"#ff4961","--icon-button-hover-color":"#ff6377"}};const vs=".sc-ir-booking-details-h{overflow-x:hidden;--ir-dialog-max-width:20rem}.confirmed.sc-ir-booking-details{color:#fff;display:flex;align-items:center}.bg-ir-green.sc-ir-booking-details{background:#629a4c;padding:0.2rem 0.3rem}.h-28.sc-ir-booking-details{height:2rem}.mx-01.sc-ir-booking-details{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}.bg-ir-red.sc-ir-booking-details{background:#ff4961;padding:0.2rem 0.3rem}.bg-ir-orange.sc-ir-booking-details{background:#ff9149;padding:0.2rem 0.3rem}.date-margin.sc-ir-booking-details{margin-right:5px}.pickup-margin.sc-ir-booking-details{margin-bottom:7px !important}.header-date.sc-ir-booking-details{padding-left:5px !important}.pointer.sc-ir-booking-details{cursor:pointer}.sc-ir-booking-details:root{--sidebar-width:50rem}.sm-padding-right.sc-ir-booking-details{padding-right:0.2rem}.sm-padding-left.sc-ir-booking-details{padding-left:0.2rem}.sm-padding-top.sc-ir-booking-details{padding-top:0.2rem}.sm-padding-bottom.sc-ir-booking-details{padding-bottom:0.2rem}.info-notes.sc-ir-booking-details{list-style:none;padding-left:0}.light-blue-bg.sc-ir-booking-details{background-color:#acecff;padding:0.2rem 0.3rem}.iframeHeight.sc-ir-booking-details{height:17.5rem}.btn-outline.sc-ir-booking-details{background:transparent;border:1px solid #104064;color:#104064}.btn-outline.sc-ir-booking-details:hover,.btn-outline.sc-ir-booking-details:active{background:#104064;color:white}.dialog-title.sc-ir-booking-details{width:fit-content}.list-title.sc-ir-booking-details{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-booking-details{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-booking-details{color:#629a4c;font-weight:600}.list-item.red.sc-ir-booking-details{color:#ff4961;font-weight:600}";const ws=vs;const xs=class{constructor(i){t(this,i);this.toast=e(this,"toast",7);this.bookingChanged=e(this,"bookingChanged",7);this.closeSidebar=e(this,"closeSidebar",7);this.bookingService=new b;this.roomService=new J;this.language="";this.ticket="";this.bookingNumber="";this.baseurl="";this.propertyid=undefined;this.is_from_front_desk=false;this.hasPrint=false;this.hasReceipt=false;this.hasDelete=false;this.hasMenu=false;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.hasCloseButton=false;this.bookingItem=null;this.statusData=[];this.tempStatus=null;this.showPaymentDetails=undefined;this.bookingData=undefined;this.countryNodeList=undefined;this.calendarData={};this.guestData=null;this.defaultTexts=undefined;this.rerenderFlag=false;this.sidebarState=null;this.isUpdateClicked=false;this.pms_status=undefined;this.isPMSLogLoading=false;this.userCountry=null}componentDidLoad(){if(this.baseurl){S.defaults.baseURL=this.baseurl}if(this.ticket!==""){A.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}}async ticketChanged(){A.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){var t;try{const[e,i,s,n]=await Promise.all([this.roomService.fetchData(this.propertyid,this.language),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language),this.bookingService.getExposedBooking(this.bookingNumber,this.language)]);if(!M.entries){M.entries=i.entries;M.direction=i.direction}this.defaultTexts=i;this.countryNodeList=s;if((t=n.guest)===null||t===void 0?void 0:t.country_id){this.userCountry=this.countryNodeList.find((t=>t.id===n.guest.country_id))||null}const{allowed_payment_methods:o,currency:a,allowed_booking_sources:r,adult_child_constraints:l,calendar_legends:c}=e["My_Result"];this.calendarData={currency:a,allowed_booking_sources:r,adult_child_constraints:l,legendData:c};this.setRoomsData(e);const h=["001","004"];this.showPaymentDetails=o.some((t=>h.includes(t.code)));this.guestData=n.guest;this.bookingData=n;this.rerenderFlag=!this.rerenderFlag}catch(t){console.error("Error initializing app:",t)}}handleIconClick(t){const e=t.target;switch(e.id){case"pickup":this.sidebarState="pickup";return;case"close":this.closeSidebar.emit(null);return;case"print":window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=B&TK=${this.ticket}`);return;case"receipt":window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=I&TK=${this.ticket}`);return;case"book-delete":return;case"menu":window.location.href="https://x.igloorooms.com/manage/acbookinglist.aspx";return;case"room-add":this.bookingItem={ID:"",NAME:this.bookingData.guest.last_name,EMAIL:this.bookingData.guest.email,PHONE:this.bookingData.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingData.from_date,ARRIVAL:this.bookingData.arrival,TO_DATE:this.bookingData.to_date,TITLE:`${M.entries.Lcz_AddingUnitToBooking}# ${this.bookingData.booking_nbr}`,defaultDateRange:{fromDate:new Date(this.bookingData.from_date),fromDateStr:"",toDate:new Date(this.bookingData.to_date),toDateStr:"",dateDifference:0,message:""},event_type:"ADD_ROOM",BOOKING_NUMBER:this.bookingData.booking_nbr,ADD_ROOM_TO_BOOKING:this.bookingData.booking_nbr,GUEST:this.bookingData.guest,message:this.bookingData.remark,SOURCE:this.bookingData.source,ROOMS:this.bookingData.rooms};return;case"add-payment":return}}handleEditSidebar(){this.sidebarState="guest"}handleSelectChange(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.target;this.tempStatus=e.selectedValue}openEditSidebar(){const t=document.querySelector("ir-sidebar#editGuestInfo");t.open=true}async updateStatus(){if(this.tempStatus!==""&&this.tempStatus!==null){try{this.isUpdateClicked=true;await S.post(`/Change_Exposed_Booking_Status?Ticket=${this.ticket}`,{book_nbr:this.bookingNumber,status:this.tempStatus});this.toast.emit({type:"success",description:"",title:M.entries.Lcz_StatusUpdatedSuccessfully,position:"top-right"});await this.resetBookingData()}catch(t){console.log(t)}finally{this.isUpdateClicked=false}}else{this.toast.emit({type:"error",description:"",title:M.entries.Lcz_SelectStatus,position:"top-right"})}}async openPMSLogsDialog(){var t;try{(t=this.dialogRef)===null||t===void 0?void 0:t.openModal();if(!this.pms_status){this.isPMSLogLoading=true;this.pms_status=await this.bookingService.fetchPMSLogs(this.bookingData.booking_nbr)}}catch(t){console.log(t)}finally{if(this.isPMSLogLoading){this.isPMSLogLoading=false}}}handleEditInitiated(t){this.bookingItem=t.detail}handleCloseBookingWindow(){this.bookingItem=null}handleDeleteFinish(t){this.bookingData=Object.assign(Object.assign({},this.bookingData),{rooms:this.bookingData.rooms.filter((e=>e.identifier!==t.detail))})}async resetBookingData(){try{const t=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);this.bookingData=Object.assign({},t);this.bookingChanged.emit(this.bookingData)}catch(t){console.log(t)}}async handleResetBookingData(t){t.stopPropagation();t.stopImmediatePropagation();if(t.detail){return this.bookingData=t.detail}await this.resetBookingData()}renderPhoneNumber(){const{mobile:t,country_phone_prefix:e,country_id:i}=this.bookingData.guest;if(!t){return null}if(this.bookingData.is_direct){if(e){return e+" "+t}if(i){const e=this.countryNodeList.find((t=>t.id===i));if(!e){throw new Error("Invalid country id")}return e.phone_prefix+" "+t}}return t}render(){var t,e,s,o,a,r,l,c,h,d,f,u;if(!this.bookingData){return null}let b="";switch(this.bookingData.status.code){case"001":b="bg-ir-orange";break;case"002":b="bg-ir-green";break;case"003":b="bg-ir-red";break;case"004":b="bg-ir-red";break}return[i(n,null,!this.is_from_front_desk&&i(n,null,i("ir-toast",null),i("ir-interceptor",null))),i("div",{class:"fluid-container p-1"},i("div",{class:"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1"},i("div",{class:"m-0 p-0 mb-1 mb-lg-0 mt-md-0  d-flex justify-content-start align-items-center"},i("p",{class:"font-size-large m-0 p-0"},`${this.defaultTexts.entries.Lcz_Booking}#${this.bookingNumber}`),i("p",{class:"m-0 p-0 ml-1"},!this.bookingData.is_direct&&i("span",{class:"mr-1 m-0"},this.bookingData.channel_booking_nbr," "),i("span",{class:"date-margin"},H(this.bookingData.booked_on.date)),U(this.bookingData.booked_on.hour.toString(),this.bookingData.booked_on.minute.toString()))),i("div",{class:"d-flex justify-content-end align-items-center"},i("span",{class:`confirmed btn-sm m-0 mr-2 ${b}`},this.bookingData.status.description),this.bookingData.allowed_actions.length>0&&this.bookingData.is_editable&&i(n,null,i("ir-select",{selectContainerStyle:"h-28",selectStyles:"d-flex status-select align-items-center h-28",firstOption:M.entries.Lcz_Select,id:"update-status",size:"sm","label-available":"false",data:this.bookingData.allowed_actions.map((t=>({text:t.description,value:t.code}))),textSize:"sm",class:"sm-padding-right m-0 "}),i("ir-button",{onClickHanlder:this.updateStatus.bind(this),btn_styles:"h-28",isLoading:this.isUpdateClicked,btn_disabled:this.isUpdateClicked,id:"update-status-btn",size:"sm",text:"Update"})),A.is_pms_enabled&&i("button",{type:"button",class:"btn btn-outline btn-sm ml-1",onClick:this.openPMSLogsDialog.bind(this)},M.entries.Lcz_pms),this.hasReceipt&&i("ir-button",{variant:"icon",id:"receipt",icon_name:"reciept",class:"mx-1",style:{"--icon-size":"1.65rem"}}),this.hasPrint&&i("ir-button",{variant:"icon",id:"print",icon_name:"print",class:"mr-1",style:{"--icon-size":"1.65rem"}}),this.hasDelete&&i("ir-button",{variant:"icon",id:"book-delete",icon_name:"trash",class:"mr-1",style:Object.assign(Object.assign({},ks.danger),{"--icon-size":"1.65rem"})}),this.hasMenu&&i("ir-button",{variant:"icon",class:"mr-1",id:"menu",icon_name:"menu_list",style:{"--icon-size":"1.65rem"}}),this.hasCloseButton&&i("ir-button",{id:"close",variant:"icon",style:{"--icon-size":"1.65rem"},icon_name:"xmark",class:"ml-2",onClickHanlder:t=>{t.stopPropagation();t.stopImmediatePropagation();this.closeSidebar.emit(null)}})))),i("div",{class:"fluid-container p-1 text-left mx-0"},i("div",{class:"row m-0"},i("div",{class:"col-12 p-0 mx-0 pr-lg-1 col-lg-6"},i("div",{class:"card"},i("div",{class:"p-1"},i("p",null,this.bookingData.property.name||""),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Source}:`,value:this.bookingData.origin.Label,image:{src:this.bookingData.origin.Icon,alt:this.bookingData.origin.Label}}),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_BookedBy}:`,value:`${this.bookingData.guest.first_name} ${this.bookingData.guest.last_name}`,iconShown:true}),this.bookingData.guest.mobile&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Phone}:`,value:this.renderPhoneNumber()}),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Email}:`,value:this.bookingData.guest.email}),this.bookingData.guest.alternative_email&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_AlternativeEmail}:`,value:this.bookingData.guest.alternative_email}),((e=(t=this.bookingData)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.address)&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Address}:`,value:this.bookingData.guest.address}),this.userCountry&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Country}:`,value:this.userCountry.name,country:true,image:{src:this.userCountry.flag,alt:this.userCountry.name}}),this.bookingData.is_direct&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_ArrivalTime}:`,value:this.bookingData.arrival.description}),this.bookingData.promo_key&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Coupon}:`,value:this.bookingData.promo_key}),this.bookingData.agent&&i("ir-label",{label:`${(s=this.defaultTexts.entries.Lcz_AgentCode)===null||s===void 0?void 0:s.split(":")[0]}:`,value:this.bookingData.agent.name}),this.bookingData.is_in_loyalty_mode&&!this.bookingData.promo_key&&i("div",{class:"d-flex align-items-center"},i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},i("path",{fill:"#fc6c85",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"})),i("p",{class:"m-0 p-0 ml-1"},this.defaultTexts.entries.Lcz_LoyaltyDiscountApplied)),this.bookingData.is_direct?i("ir-label",{class:"m-0 p-0",label:`${this.defaultTexts.entries.Lcz_Note}:`,value:this.bookingData.remark}):i("ota-label",{class:"m-0 p-0",label:`${this.defaultTexts.entries.Lcz_Note}:`,remarks:this.bookingData.ota_notes,maxVisibleItems:(o=this.bookingData.ota_notes)===null||o===void 0?void 0:o.length}),i("div",{class:"d-flex align-items-center justify-content-between"},i("ir-label",{label:`${M.entries.Lcz_PrivateNote}:`,placeholder:M.entries.Lcz_VisibleToHotelOnly,value:G(this.bookingData.extras),ignore_value:true}),i("ir-button",{variant:"icon",icon_name:"edit",style:ks.secondary,onClickHanlder:t=>{t.stopImmediatePropagation();t.stopPropagation();this.sidebarState="extra_note"}})))),i("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},i("ir-date-view",{from_date:this.bookingData.from_date,to_date:this.bookingData.to_date}),this.hasRoomAdd&&this.bookingData.is_direct&&this.bookingData.is_editable&&i("ir-button",{id:"room-add",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),i("div",{class:"card p-0 mx-0"},this.bookingData.rooms.map(((t,e)=>{const s=t.rateplan.name;const n=t.roomtype.name;return[i("ir-room",{isEditable:this.bookingData.is_editable,defaultTexts:this.defaultTexts,legendData:this.calendarData.legendData,roomsInfo:this.calendarData.roomsInfo,myRoomTypeFoodCat:n,mealCodeName:s,currency:this.bookingData.currency.code,hasRoomEdit:this.hasRoomEdit&&this.bookingData.status.code!=="003"&&this.bookingData.is_direct,hasRoomDelete:this.hasRoomDelete&&this.bookingData.status.code!=="003"&&this.bookingData.is_direct,hasCheckIn:this.hasCheckIn,hasCheckOut:this.hasCheckOut,bookingEvent:this.bookingData,bookingIndex:e,ticket:this.ticket,onDeleteFinished:this.handleDeleteFinish.bind(this)}),e!==this.bookingData.rooms.length-1&&i("hr",{class:"mr-2 ml-2 my-0 p-0"})]}))),A.pickup_service.is_enabled&&this.bookingData.is_direct&&this.bookingData.is_editable&&i("div",{class:"mb-1"},i("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},i("p",{class:"font-size-large p-0 m-0 "},M.entries.Lcz_Pickup),i("ir-button",{id:"pickup",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},ks.secondary),{"--icon-size":"1.5rem"})})),this.bookingData.pickup_info&&i("div",{class:"card"},i("div",{class:"p-1"},i("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},i("p",{class:"font-weight-bold mr-1 py-0 my-0"},M.entries.Lcz_Date,": ",i("span",{class:"font-weight-normal"},Y(this.bookingData.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),this.bookingData.pickup_info.hour&&this.bookingData.pickup_info.minute&&i("p",{class:"font-weight-bold flex-fill py-0 my-0"},M.entries.Lcz_Time,":",i("span",{class:"font-weight-normal"}," ",U(this.bookingData.pickup_info.hour.toString(),this.bookingData.pickup_info.minute.toString()))),i("p",{class:"font-weight-bold py-0 my-0"},M.entries.Lcz_DueUponBooking,":"," ",i("span",{class:"font-weight-normal"},this.bookingData.pickup_info.currency.symbol,this.bookingData.pickup_info.total))),i("p",{class:"font-weight-bold py-0 my-0"},M.entries.Lcz_FlightDetails,":",i("span",{class:"font-weight-normal"}," ",`${this.bookingData.pickup_info.details}`)),i("p",{class:"py-0 my-0 pickup-margin"},`${this.bookingData.pickup_info.selected_option.vehicle.description}`),i("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},M.entries.Lcz_NbrOfVehicles,":",i("span",{class:"font-weight-normal"}," ",`${this.bookingData.pickup_info.nbr_of_units}`)),i("p",{class:"small py-0 my-0 pickup-margin"},A.pickup_service.pickup_instruction.description,A.pickup_service.pickup_cancelation_prepayment.description))))),i("div",{class:"col-12 p-0 m-0 pl-lg-1 col-lg-6"},i("ir-payment-details",{defaultTexts:this.defaultTexts,bookingDetails:this.bookingData})))),i("ir-sidebar",{open:this.sidebarState!==null,side:"right",id:"editGuestInfo",onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.sidebarState=null},showCloseButton:false},this.renderSidbarContent()),i(n,null,this.bookingItem&&i("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()})),i(n,null,i("ir-dialog",{ref:t=>this.dialogRef=t},i("div",{slot:"modal-body",class:"p-1"},i("h3",{class:" text-left mb-1 dialog-title "},M.entries.Lcz_PMS_Logs),!this.isPMSLogLoading&&i(n,null,i("div",{class:"d-flex align-items-center"},i("p",{class:"list-title"},M.entries.Lcz_SentAt),((a=this.pms_status)===null||a===void 0?void 0:a.sent_date)?i("p",{class:"list-item"},(r=this.pms_status)===null||r===void 0?void 0:r.sent_date," ",U((l=this.pms_status)===null||l===void 0?void 0:l.sent_hour.toString(),(c=this.pms_status)===null||c===void 0?void 0:c.sent_minute.toString())):i("p",{class:`list-item ${((h=this.pms_status)===null||h===void 0?void 0:h.sent_date)?"green":"red"}`},((d=this.pms_status)===null||d===void 0?void 0:d.is_acknowledged)?M.entries.Lcz_YES:M.entries.Lcz_NO)),i("div",{class:"d-flex align-items-center"},i("h4",{class:"list-title"},M.entries.Lcz_Acknowledged),i("p",{class:`list-item ${((f=this.pms_status)===null||f===void 0?void 0:f.is_acknowledged)?"green":"red"}`},((u=this.pms_status)===null||u===void 0?void 0:u.is_acknowledged)?M.entries.Lcz_YES:M.entries.Lcz_NO))))))]}renderSidbarContent(){var t;switch(this.sidebarState){case"guest":return i("ir-guest-info",{slot:"sidebar-body",booking_nbr:this.bookingNumber,defaultTexts:this.defaultTexts,email:(t=this.bookingData)===null||t===void 0?void 0:t.guest.email,language:this.language,onCloseSideBar:()=>this.sidebarState=null});case"pickup":return i("ir-pickup",{slot:"sidebar-body",defaultPickupData:this.bookingData.pickup_info,bookingNumber:this.bookingData.booking_nbr,numberOfPersons:this.bookingData.occupancy.adult_nbr+this.bookingData.occupancy.children_nbr,onCloseModal:()=>this.sidebarState=null});case"extra_note":return i("ir-booking-extra-note",{slot:"sidebar-body",booking:this.bookingData,onCloseModal:()=>this.sidebarState=null});default:return null}}get element(){return o(this)}static get watchers(){return{ticket:["ticketChanged"]}}};xs.style=ws;const _s=".sc-ir-booking-extra-note-h{display:block}";const Ds=_s;const Cs=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new b;this.booking=undefined;this.isLoading=false;this.note=""}componentWillLoad(){this.bookingService.setToken(A.token);if(this.booking.extras){this.setNote(G(this.booking.extras))}}setNote(t){this.note=t}async savePrivateNote(){try{this.isLoading=true;let t=this.booking.extras||[];const e={key:"private_note",value:this.note};if(t.length===0){t.push(e)}else{const i=t.findIndex((t=>t.key==="private_note"));if(i===-1){t.push(e)}else{t[i]=e}}const i=await this.bookingService.doReservation({assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,booking:this.booking,Is_Non_Technical_Change:true,extras:t});this.resetBookingData.emit(i);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return i(s,{key:"8a99f30caa83cc305f12313414525a79ce00a9a9",class:"px-0"},i("ir-title",{key:"8610153955b8b6c028d3ea1e356c9b4759722404",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:M.entries.Lcz_PrivateNote,displayContext:"sidebar"}),i("form",{key:"cc38235b6551d47ac46f1d0a6c557e56b099116d",class:"px-1",onSubmit:t=>{t.preventDefault();this.savePrivateNote()}},i("ir-textarea",{key:"e11897b1b0e74b1942b6774c7d2f351f0a130707",placeholder:M.entries.Lcz_PrivateNote_MaxChar,label:"",value:this.note,maxLength:150,onTextChange:t=>this.setNote(t.detail)}),i("div",{key:"608827c29b8c89bb71877bf6a57c95c1dc959ed7",class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{key:"7a1fd52b3d09de83e94c816310f76f82c59922b3",onClickHanlder:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`,icon:"",text:M.entries.Lcz_Cancel,btn_color:"secondary"}),i("ir-button",{key:"84c8e36f5e3dd035dfff316e5a64564a18e12a45",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center ml-sm-1",icon:"",isLoading:this.isLoading,text:M.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"}))))}};Cs.style=Ds;const Os=".sc-ir-button-h{--icon-button-color:#6b6f82;--icon-button-hover-color:#104064}.button-icon.sc-ir-button{padding:0;margin-top:0}.button-icon[data-state='loading'].sc-ir-button{display:none}.button-text.sc-ir-button{padding:0 5px}.bounce-3.sc-ir-button{animation:bounce 1s 1}.ir-button-class.sc-ir-button{display:inline-flex !important;justify-content:center;align-items:center;box-sizing:border-box}.icon-button.sc-ir-button{all:unset;box-sizing:border-box;border-radius:0.25rem;display:inline-flex;align-items:center;justify-content:center;color:var(--icon-button-color);padding:0.2rem;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.icon-button.sc-ir-button:hover{color:var(--icon-button-hover-color)}.icon-button.sc-ir-button:hover.hovered_bg{background:var('--ir-icon-bg-hover', #f6f6f6)}.icon-button.sc-ir-button:disabled{pointer-events:none}.icon-loader.sc-ir-button{margin:0;padding:0;width:var(--icon-size, 1.25rem);height:var(--icon-size, 1.25rem);border-radius:50%;background:radial-gradient(farthest-side, var(--icon-button-color) 94%, #0000) top/2px 2px no-repeat, conic-gradient(#0000 30%, var(--icon-button-color));-webkit-mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);animation:l13 1s infinite linear}.btn_loader.sc-ir-button{width:15px;height:10px;--c:no-repeat linear-gradient(#ffffff 0 0);background:var(--c) 0% 50%, var(--c) 50% 50%, var(--c) 100% 50%;background-size:20% 100%;animation:l1 1s infinite linear}@keyframes l13{100%{transform:rotate(1turn)}}@keyframes l1{0%{background-size:20% 100%, 20% 100%, 20% 100%}33%{background-size:20% 10%, 20% 100%, 20% 100%}50%{background-size:20% 100%, 20% 10%, 20% 100%}66%{background-size:20% 100%, 20% 100%, 20% 10%}100%{background-size:20% 100%, 20% 100%, 20% 100%}}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}@keyframes ping{75%,100%{transform:scale(1.2)}}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Es=Os;const Ts=class{constructor(i){t(this,i);this.clickHanlder=e(this,"clickHanlder",7);this.name=undefined;this.text=undefined;this.icon="ft-save";this.btn_color="primary";this.size="md";this.textSize="md";this.btn_block=true;this.btn_disabled=false;this.btn_type="button";this.isLoading=false;this.btn_styles=undefined;this.btn_id=N();this.variant="default";this.icon_name=undefined;this.visibleBackgroundOnHover=false;this.iconPostion="left";this.icon_style=undefined}handleButtonAnimation(t){if(!this.buttonEl||t.detail!==this.btn_id){return}t.stopImmediatePropagation();t.stopPropagation();this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}render(){if(this.variant==="icon"){return i("button",{id:this.btn_id,class:`icon-button ${this.btn_styles} ${this.visibleBackgroundOnHover?"hovered_bg":""}`,ref:t=>this.buttonEl=t,onClick:()=>this.clickHanlder.emit(),type:this.btn_type,disabled:this.btn_disabled},this.isLoading?i("span",{class:"icon-loader"}):i("ir-icons",{name:this.icon_name}))}let t=this.btn_block?"btn-block":"";return i("button",{id:this.btn_id,ref:t=>this.buttonEl=t,onClick:()=>this.clickHanlder.emit(),class:`btn btn-${this.btn_color} ${this.btn_styles} ir-button-class  btn-${this.size} text-${this.textSize} ${t}`,type:this.btn_type,disabled:this.btn_disabled||this.isLoading},this.text&&i("span",{class:"button-text m-0"},this.text),this.isLoading&&i("div",{class:"btn_loader m-0 p-0"}))}};Ts.style=Es;const Is=[{isCSS:true,link:"https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap-extended.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/colors.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/menu/menu-types/horizontal-menu.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/colors/palette-gradient.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/components.css"},{isCSS:true,link:"https://x.igloorooms.com/assets/css/style.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/icheck.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/custom.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/pages/login-register.css"}];const Bs=class{constructor(e){t(this,e);this.extraResources="";this.resources=Is}componentWillLoad(){this.parseRefs()}componentDidLoad(){this.initializeStyles()}hrefsChanged(){this.parseRefs();this.initializeStyles()}parseRefs(){if(this.extraResources!=="")this.resources.push(JSON.parse(this.extraResources))}appendTag(t,e){const i=document.createElement(t);const s=[];Object.keys(e).forEach((t=>{i.setAttribute(t,e[t]);s.push(`[${t}="${e[t]}"]`)}));const n=`${t}${s.join("")}`;const o=document.querySelector(n);if(!o){document.head.appendChild(i)}}initializeStyles(){this.resources.forEach((t=>{if(t.isCSS){this.appendTag("link",{href:t.link,rel:"stylesheet",type:"text/css"})}if(t.isJS){this.appendTag("script",{src:t.link})}}))}render(){return i(s,{key:"9dbe8a73aeb89ad5be96e6991c9a78052215a0f8"},i("slot",{key:"dc88ddf2bdd7c7bb5c216a902ee7bc23823dddf3"}))}static get watchers(){return{extraResources:["hrefsChanged"]}}};const Ms="input.sc-ir-date-picker{all:unset;box-sizing:border-box !important;padding:0;margin:0;width:100%;text-align:center}input.sc-ir-date-picker:disabled{text-align:start;font-size:14px;width:100%}.sc-ir-date-picker-h{position:relative;box-sizing:border-box}.icon.sc-ir-date-picker{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}";const As=Ms;const Ns=class{constructor(i){t(this,i);this.dateChanged=e(this,"dateChanged",7);this.fromDate=undefined;this.toDate=undefined;this.opens=undefined;this.autoApply=undefined;this.firstDay=1;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.daysOfWeek=["Su","Mo","Tu","We","Th","Fr","Sa"];this.format="MMM DD, YYYY";this.separator=" - ";this.applyLabel="Apply";this.cancelLabel="Cancel";this.fromLabel="Form";this.toLabel="To";this.customRangeLabel="Custom";this.weekLabel="W";this.disabled=false;this.singleDatePicker=false;this.minDate=undefined;this.maxDate=undefined;this.maxSpan={days:240}}componentDidLoad(){this.dateRangeInput=this.element.querySelector(".date-range-input");$(this.dateRangeInput).daterangepicker({singleDatePicker:this.singleDatePicker,opens:this.opens,startDate:Y(this.fromDate),endDate:Y(this.toDate),minDate:Y(this.minDate||Y(new Date).format("YYYY-MM-DD")),maxDate:this.maxDate?Y(this.maxDate):undefined,maxSpan:this.maxSpan,autoApply:this.autoApply,locale:{format:this.format,separator:this.separator,applyLabel:this.applyLabel,cancelLabel:this.cancelLabel,fromLabel:this.fromLabel,toLabel:this.toLabel,customRangeLabel:this.customRangeLabel,weekLabel:this.weekLabel,daysOfWeek:this.daysOfWeek,monthNames:this.monthNames,firstDay:this.firstDay}},((t,e)=>{this.dateChanged.emit({start:t,end:e})}))}render(){return i(s,{key:"862d9eda2bfe972557653e91bc56eb6df0b96d61"},i("input",{key:"32178f990c4bf8ed2d5b0ba4381f83c889693372",class:"date-range-input",type:"text",disabled:this.disabled}))}get element(){return o(this)}};Ns.style=As;const Rs=".sc-ir-date-view-h{display:block;font-size:13.65px !important;width:100%}.mx-01.sc-ir-date-view{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Ss=Rs;const Ls=class{constructor(e){t(this,e);this.from_date=undefined;this.to_date=undefined;this.showDateDifference=true;this.dateOption="YYYY-MM-DD";this.dates=undefined}componentWillLoad(){this.initializeDates()}handleFromDateChange(t,e){if(t!==e){this.initializeDates()}}handleToDateChange(t,e){if(t!==e){this.initializeDates()}}initializeDates(){this.convertDate("from_date",this.from_date);this.convertDate("to_date",this.to_date);const t=Y(this.dates.from_date,"MMM DD, YYYY").format("YYYY-MM-DD");const e=Y(this.dates.to_date,"MMM DD, YYYY").format("YYYY-MM-DD");this.dates.date_diffrence=P(t,e)}convertDate(t,e){this.dates=this.dates||{from_date:"",to_date:"",date_diffrence:0};if(typeof e==="string"){this.dates[t]=Y(e,this.dateOption).format("MMM DD, YYYY")}else if(e instanceof Date){this.dates[t]=Y(e).format("MMM DD, YYYY")}else if(Y.isMoment(e)){this.dates[t]=e.format("MMM DD, YYYY")}else{console.error("Unsupported date type")}}render(){return i(s,{key:"8f727d4d31569f157abd49e9f913e080db9e3e2a",class:"d-flex align-items-center"},i("span",{key:"f50f22aba1658f8ca83f7fcd3bb02616b1a5c56e"},this.dates.from_date)," ",i("svg",{key:"d410f9e418d13ed7098581076ca42e8ed23e6eb7",xmlns:"http://www.w3.org/2000/svg",class:"mx-01",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{key:"c2aec3d147b0ce712c41666d844ff33271901453",fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),i("span",{key:"2408309fa1ea5e00eacd7d97bb9b026b75b0814a"},this.dates.to_date," ",this.showDateDifference&&i("span",{key:"faa4f04bd5d8baa538bc7599f891efd408583560",class:"mx-01"},this.dates.date_diffrence,"   ",this.dates.date_diffrence>1?` ${M.entries.Lcz_Nights}`:` ${M.entries.Lcz_Night}`)))}static get watchers(){return{from_date:["handleFromDateChange"],to_date:["handleToDateChange"]}}};Ls.style=Ss;const js=":host{display:block;margin:0;padding:0;box-sizing:border-box}.backdrop{opacity:0;background:rgba(0, 0, 0, 0.2);position:fixed;inset:0;z-index:99999998}.backdrop[data-state='opened']{animation:overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards}.backdrop[data-state='closed']{opacity:0;pointer-events:none}.modal-container{box-sizing:border-box;margin:0;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;position:fixed;z-index:99999999;overflow-y:auto;top:50%;left:50%;background:white;transform:translate(-50%, -50%);width:90%;min-height:fit-content;height:fit-content;max-width:var(--ir-dialog-max-width, 40rem);max-height:85vh;border-radius:8px;padding:0;animation:contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1)}.modal-footer ::slotted(*){flex-direction:row;align-items:center;justify-content:end;gap:8px;--ir-btn-width:inherit}.modal-footer{--ir-btn-width:100%}.modal-title ::slotted(*){font-size:18px;font-weight:600;color:#101828;margin-bottom:8px}.modal-body ::slotted(*){font-size:14px;font-weight:400;color:#475467;padding:0;margin:0}@keyframes overlayShow{from{opacity:0}to{opacity:1}}@keyframes contentShow{from{opacity:0;transform:translate(-50%, -48%) scale(0.96)}to{opacity:1;transform:translate(-50%, -50%) scale(1)}}.dialog-close-button{position:absolute;top:15px;right:15px}";const Ys=js;const zs=class{constructor(i){t(this,i);this.openChange=e(this,"openChange",7);this.open=false;this.isOpen=false}componentWillLoad(){if(this.open){this.openModal()}}componentDidLoad(){this.prepareFocusTrap()}async openModal(){this.isOpen=true;document.body.style.overflow="hidden";setTimeout((()=>{this.prepareFocusTrap()}),10);this.openChange.emit(this.isOpen)}async closeModal(){console.log("close");if(!this.isOpen){return}document.body.style.overflow="visible";this.isOpen=false;this.openChange.emit(this.isOpen)}handleOpenChange(){if(this.open){this.openModal()}else{this.closeModal()}}prepareFocusTrap(){const t='button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';const e=this.el.shadowRoot.querySelectorAll(t);if(e.length===0)return;this.firstFocusableElement=e[0];this.lastFocusableElement=e[e.length-1];this.firstFocusableElement.focus()}handleKeyDown(t){if(!this.isOpen){return}let e=t.key==="Tab";if(t.key==="Escape"&&this.isOpen){this.closeModal()}if(!e){return}if(!t.shiftKey&&document.activeElement===this.lastFocusableElement){this.firstFocusableElement.focus();t.preventDefault()}if(t.shiftKey&&document.activeElement===this.firstFocusableElement){this.lastFocusableElement.focus();t.preventDefault()}}disconnectedCallback(){document.body.style.overflow="visible"}render(){return i(s,{key:"8d1fa25514ed1aa9a824b31cebf7f1efd728e218"},i("div",{key:"a6872306b76fa602909c65091ff3adbb15ff9c56",class:"backdrop","data-state":this.isOpen?"opened":"closed",onClick:()=>this.closeModal()}),this.isOpen&&i("div",{key:"fa17186589f22c23b6c389726e5fdfbe4d3a419c",class:"modal-container",tabIndex:-1,role:"dialog","aria-labelledby":"dialog1Title","aria-describedby":"dialog1Desc"},i("ir-icon",{key:"d53e1e6e1396c2dd28cad21742c5ccfb71e9606f",id:"close",class:"dialog-close-button",onIconClickHandler:()=>this.closeModal()},i("svg",{key:"b28cdf4a4b02ce3e68f0c72b99fd8a94a65b217a",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:18,width:18},i("path",{key:"1a5d7eb8e5be128f7a81c0a76c2f6d816bf41c79",fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("div",{key:"f7a26bc194c44474ec58c82c046174ba600e321c",class:"modal-title",id:"dialog1Title"},i("slot",{key:"7857834cda334eb88ff7af076a1268f719fa510e",name:"modal-title"})),i("div",{key:"07987be17e11a5411ad9388ccfab99a8b31b0a82",class:"modal-body",id:"dialog1Desc"},i("slot",{key:"bd8d984744905281828c3d11fe03942194a99a90",name:"modal-body"})),i("div",{key:"89ece0acb69888852678bcd3a490f7ca98cab5db",class:"modal-footer"},i("slot",{key:"3240d8bdcfaccc23fc3452d40ac654709551781f",name:"modal-footer"}))))}get el(){return o(this)}static get watchers(){return{open:["handleOpenChange"]}}};zs.style=Ys;const $s=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}";const Ps=$s;const Hs=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new b;this.setupDataCountries=null;this.setupDataCountriesCode=null;this.defaultTexts=undefined;this.language=undefined;this.email=undefined;this.booking_nbr=undefined;this.countries=undefined;this.submit=false;this.guest=null;this.isLoading=false}async componentWillLoad(){this.bookingService.setToken(A.token);await this.init()}async init(){try{const[t,e]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language)]);this.countries=e;this.guest=t}catch(t){console.log(t)}}handleInputChange(t,e){this.guest=Object.assign(Object.assign({},this.guest),{[t]:e})}async editGuest(){try{this.isLoading=true;await this.bookingService.editExposedGuest(this.guest,this.booking_nbr);this.closeSideBar.emit(null);this.resetBookingData.emit(null)}catch(t){console.log(t)}finally{this.isLoading=false;console.log("done")}}render(){var t,e,s,n,o,a;if(!this.guest){return null}return[i("div",{class:"p-0"},i("div",{class:"position-sticky mb-1 shadow-none p-0"},i("div",{class:"d-flex align-items-center justify-content-between ir-card-header py-1 p-0"},i("h3",{class:"card-title text-left font-medium-2 px-1 my-0"},this.defaultTexts.entries.Lcz_GuestDetails),i("ir-icon",{class:"close close-icon px-1",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{class:"card-content collapse show"},i("div",{class:"card-body pt-0 px-1"},i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_FirstName,name:"firstName",submited:this.submit,value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:t=>this.handleInputChange("first_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_LastName,name:"lastName",submited:this.submit,value:(e=this.guest)===null||e===void 0?void 0:e.last_name,required:true,onTextChange:t=>this.handleInputChange("last_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Email,name:"email",submited:this.submit,value:(s=this.guest)===null||s===void 0?void 0:s.email,required:true,onTextChange:t=>this.handleInputChange("email",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_AlternativeEmail,name:"altEmail",value:(n=this.guest)===null||n===void 0?void 0:n.alternative_email,onTextChange:t=>this.handleInputChange("alternative_email",t.detail)}),i("ir-select",{selectContainerStyle:"mb-1",required:true,name:"country",submited:this.submit,label:this.defaultTexts.entries.Lcz_Country,selectedValue:(a=(o=this.guest.country_id)===null||o===void 0?void 0:o.toString())!==null&&a!==void 0?a:"",data:this.countries.map((t=>({value:t.id.toString(),text:t.name}))),firstOption:"...",onSelectChange:t=>this.handleInputChange("country_id",t.detail)}),i("div",{class:"form-group mr-0"},i("div",{class:"input-group row m-0 p-0"},i("div",{class:`input-group-prepend col-3 p-0 text-dark border-none`},i("label",{class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.defaultTexts.entries.Lcz_MobilePhone,"*")),i("select",{class:` form-control text-md  col-2 py-0 mobilePrefixSelect`,onInput:t=>this.handleInputChange("country_phone_prefix",t.target.value),required:true},i("option",{value:null},"..."),this.countries.map((t=>{var e;return i("option",{selected:((e=this.guest.country_phone_prefix)===null||e===void 0?void 0:e.toString())===t.phone_prefix.toString(),value:t.phone_prefix},t.phone_prefix)}))),i("input",{type:"text",required:true,value:this.guest.mobile,class:"form-control flex-fill mobilePrefixInput",onInput:t=>this.handleInputChange("mobile",t.target.value)}))),i("div",{class:"p-0 m-0"},i("label",{class:`check-container m-0 p-0`},i("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange("subscribe_to_news_letter",t.target.checked)}),i("span",{class:"checkmark m-0 p-0"}),i("span",{class:"m-0 p-0  check-label"},this.defaultTexts.entries.Lcz_Newsletter))),i("hr",null),i("ir-button",{isLoading:this.isLoading,btn_disabled:this.isLoading,btn_styles:"d-flex align-items-center justify-content-center",text:this.defaultTexts.entries.Lcz_Save,onClickHanlder:this.editGuest.bind(this),color:"btn-primary"}))))]}};Hs.style=Ps;const Us=".sc-ir-icon-h{margin:0;padding:0}.icon-button.sc-ir-icon{all:unset;margin:0;padding:0;color:#104064}.icon-button.sc-ir-icon:hover{cursor:pointer;color:#1a6aa7}";const Gs=Us;const Vs=class{constructor(i){t(this,i);this.iconClickHandler=e(this,"iconClickHandler",7);this.icon="ft-check"}render(){return i("button",{key:"f54ada8fcfcd32c5b26e50067dcb0a221881eb04",class:"icon-button",onClick:()=>this.iconClickHandler.emit()},i("slot",{key:"b37311519166859fc5f56e496ac2189b6229de0c",name:"icon"}))}};Vs.style=Gs;const Ks=".sc-ir-icons-h{display:block}.icon.sc-ir-icons{height:var(--icon-size, 1.25rem);width:var(--icon-size, 1.25rem);margin:0;padding:0}";const Fs=Ks;const Ws=class{constructor(e){t(this,e);this.name=undefined;this.svgClassName=undefined}render(){const t=ys[this.name]||null;if(!t){return null}return i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:t.viewBox,class:"icon ${this.svgClassName}"},i("path",{fill:"currentColor",d:t.d}))}};Ws.style=Fs;const qs=".sc-ir-input-text-h{margin:0;padding:0}.border-theme.sc-ir-input-text{border:1px solid #cacfe7}.icon-container.sc-ir-input-text{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}input.sc-ir-input-text:focus{border-color:#1e9ff2 !important}.input-container.sc-ir-input-text{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.input-container.sc-ir-input-text input.sc-ir-input-text{padding-left:5px !important;padding-right:5px !important;border-left:0;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.icon-container[data-state='focus'].sc-ir-input-text{border-color:var(--blue)}.icon-container[data-disabled].sc-ir-input-text{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.danger-border.sc-ir-input-text{border-color:var(--red)}";const Xs=qs;const Js=class{constructor(i){t(this,i);this.textChange=e(this,"textChange",7);this.inputBlur=e(this,"inputBlur",7);this.name=undefined;this.value=undefined;this.label="<label>";this.placeholder="<placeholder>";this.inputStyles="";this.required=undefined;this.LabelAvailable=true;this.readonly=false;this.type="text";this.submited=false;this.inputStyle=true;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.variant="default";this.disabled=false;this.error=false;this.valid=undefined;this.initial=true;this.inputFocused=false}connectedCallback(){}disconnectedCallback(){}watchHandler(t){if(t!==""&&this.required){this.valid=true}}watchHandler2(t){if(t&&this.required){this.initial=false}}handleInputChange(t){this.initial=false;if(this.required){this.valid=t.target.checkValidity();const e=t.target.value;this.textChange.emit(e)}else{this.textChange.emit(t.target.value)}}render(){const t=N();if(this.variant==="icon"){return i("fieldset",{class:"position-relative has-icon-left input-container"},i("label",{htmlFor:t,class:"input-group-prepend bg-white m-0"},i("span",{"data-disabled":this.disabled,"data-state":this.inputFocused?"focus":"",class:`input-group-text icon-container bg-white ${this.error&&"danger-border"}`,id:"basic-addon1"},i("slot",{name:"icon"}))),i("input",{type:"text",onFocus:()=>this.inputFocused=true,required:this.required,onBlur:t=>{this.inputFocused=false;this.inputBlur.emit(t)},disabled:this.disabled,class:`form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder ${this.error&&"danger-border"}`,id:t,value:this.value,placeholder:this.placeholder,onInput:this.handleInputChange.bind(this)}))}let e="form-control";let s=i("div",{class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},i("label",{class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(!this.LabelAvailable){s=""}if(this.inputStyle===false){e=""}if(this.required&&!this.valid&&!this.initial){e=`${e} border-danger`}return i("div",{class:"form-group"},i("div",{class:"input-group row m-0"},s,i("input",{readOnly:this.readonly,type:this.type,class:`${e} ${this.error?"border-danger":""} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12} ${this.readonly&&"bg-white"} ${this.inputStyles}`,onBlur:t=>this.inputBlur.emit(t),placeholder:this.placeholder,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled})))}static get watchers(){return{value:["watchHandler"],submited:["watchHandler2"]}}};Js.style=Xs;const Zs=".loader.sc-ir-interceptor{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-interceptor{padding:20px;display:flex;align-items:center;justify-content:center;border-radius:5px;background:white}.loadingScreenContainer.sc-ir-interceptor{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:100000;background:rgba(0, 0, 0, 0.2);pointer-events:all;display:flex;align-items:center;justify-content:center}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Qs=Zs;const tn=class{constructor(i){t(this,i);this.toast=e(this,"toast",7);this.isShown=false;this.isLoading=false;this.isUnassignedUnit=false;this.endpointsCount=0;this.handledEndpoints=["/Get_Exposed_Calendar","/ReAllocate_Exposed_Room","/Get_Exposed_Bookings"]}componentWillLoad(){this.setupAxiosInterceptors()}setupAxiosInterceptors(){S.interceptors.request.use(this.handleRequest.bind(this),this.handleError.bind(this));S.interceptors.response.use(this.handleResponse.bind(this),this.handleError.bind(this))}extractEndpoint(t){return t.split("?")[0]}isHandledEndpoint(t){return this.handledEndpoints.includes(t)}handleRequest(t){const e=this.extractEndpoint(t.url);j[e]="pending";if(this.isHandledEndpoint(e)){if(this.endpointsCount>0){this.isLoading=true}}if(e==="/Get_Exposed_Calendar"){this.endpointsCount=this.endpointsCount+1}return t}handleResponse(t){var e;const i=this.extractEndpoint(t.config.url);if(this.isHandledEndpoint(i)){this.isLoading=false}j[i]="done";if((e=t.data.ExceptionMsg)===null||e===void 0?void 0:e.trim()){this.handleError(t.data.ExceptionMsg);throw new Error(t.data.ExceptionMsg)}return t}handleError(t){this.toast.emit({type:"error",title:t,description:"",position:"top-right"});return Promise.reject(t)}render(){return i(s,{key:"de952b3bbf1d94d8ebb0857ad99023bd9400b7d7"},this.isLoading&&i("div",{key:"bf743e71f1e679e6b0633358bb865cbaa3fe30b7",class:"loadingScreenContainer"},i("div",{key:"bba6778a7558085c4b5d7c9fddaa0f42a6b9be22",class:"loaderContainer"},i("span",{key:"80a93e11411fea61de8ae28d8c3390f7e1ac0680",class:"loader"}))))}};tn.style=Qs;const en=".logo.sc-ir-label{height:1.5rem;width:1.5rem}.sc-ir-label-h{display:flex;margin-bottom:5px;gap:5px;align-items:center}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}.label_message.sc-ir-label{margin:0 3px;padding:0}.label_title.sc-ir-label{min-width:max-content}.label_placeholder.sc-ir-label{color:#cacfe7}.icon-container.sc-ir-label{margin:0;padding:0}.country.sc-ir-label{height:16px;width:23px;border-radius:3px}svg.sc-ir-label{margin:0;padding:0}";const sn=en;const nn=class{constructor(i){t(this,i);this.editSidebar=e(this,"editSidebar",7);this.label=undefined;this.value=undefined;this.iconShown=false;this.image=undefined;this.country=false;this.imageStyle="";this.icon_name="edit";this.icon_style=undefined;this.ignore_value=false;this.placeholder=undefined}openEditSidebar(){this.editSidebar.emit()}render(){if(!this.placeholder&&!this.value&&!this.ignore_value){return null}return i(s,{class:this.image?"align-items-center":""},i("strong",{class:"label_title"},this.label),this.image&&i("img",{src:this.image.src,class:`p-0 m-0 ${this.country?"country":"logo"} ${this.image.style}`,alt:this.image.src}),this.value?i("p",{class:"label_message"},this.value):i("p",{class:"label_placeholder"},this.placeholder),this.iconShown&&i("div",{class:"icon-container"},i("ir-button",{variant:"icon",icon_name:this.icon_name,style:Object.assign(Object.assign({},ks.secondary),{"--icon-size":"1.1rem"}),onClickHanlder:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openEditSidebar()}})))}};nn.style=sn;const on=".sc-ir-loading-screen-h{display:fixed;height:100vh;width:100vw;z-index:1000;top:0;left:0;display:flex;align-items:center;justify-content:center;background:white}.loader.sc-ir-loading-screen{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-loading-screen{position:absolute;z-index:100001;padding:20px;top:50%;left:50%;transform:translate(-50%, -50%);background:white;display:flex;align-items:center;justify-content:center;gap:20px;border-radius:5px}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const an=on;const rn=class{constructor(e){t(this,e);this.message=""}render(){return i(s,{key:"e60d68460e4e9dc29e06362f5c4bf0b7d8ada9b6"},i("span",{key:"582ad098cc9447893264130be4b7bdf75b729bb6",class:"loader"}))}};rn.style=an;const ln=".backdropModal.sc-ir-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-modal{padding:10px;background:white;border-radius:5px}.modal.sc-ir-modal{z-index:1001 !important}.modal-dialog.sc-ir-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-modal{gap:10px}.ir-modal.sc-ir-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const cn=ln;const hn=class{constructor(i){t(this,i);this.confirmModal=e(this,"confirmModal",7);this.cancelModal=e(this,"cancelModal",7);this.modalTitle="Modal Title";this.modalBody="Modal Body";this.rightBtnActive=true;this.leftBtnActive=true;this.rightBtnText="Confirm";this.leftBtnText="Close";this.rightBtnColor="primary";this.leftBtnColor="secondary";this.btnPosition="right";this.iconAvailable=false;this.icon="";this.isOpen=false;this.item={}}async closeModal(){this.isOpen=false}async openModal(){this.isOpen=true}btnClickHandler(t){let e=t.target;let i=e.name;if(i===this.leftBtnText){this.cancelModal.emit();this.item={};this.closeModal()}else if(i===this.rightBtnText){this.confirmModal.emit(this.item);this.item={};this.closeModal()}}render(){return[i("div",{key:"392e75fe8a5e5c78d53dca906ce5bc48a248c6bd",class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{this.cancelModal.emit();this.closeModal()}}),i("div",{key:"0d67369f127078631c3498abb48040b938f62a87","data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},i("div",{key:"e60a8d548a83523c672ec8a29e074bf61db100b8",class:`ir-alert-content p-2`},i("div",{key:"20819a1e86d48c32e0aea725295f34d726c5dec6",class:`ir-alert-header align-items-center border-0 py-0 m-0 `}),i("div",{key:"c7e23c1e0a4eba5797c0d2a305f0c5aba26d2187",class:"modal-body text-left p-0 mb-2"},i("div",{key:"088c53f027ad8856ed644b0ad97ff7092f66f91e"},this.modalBody)),i("div",{key:"e047ef305345834b913a0b191516092804a2b55c",class:`ir-alert-footer border-0  d-flex justify-content-${this.btnPosition==="center"?"center":this.btnPosition==="left"?"start":"end"}`},this.leftBtnActive&&i("ir-button",{key:"2ad6ed54958da4254662faafed0d12ea226144d7",icon:"",btn_color:this.leftBtnColor,btn_block:true,text:this.leftBtnText,name:this.leftBtnText}),this.rightBtnActive&&i("ir-button",{key:"1d00126ca69a9be1f2ffb74ff896076c5be252f9",icon:"",btn_color:this.rightBtnColor,btn_block:true,text:this.rightBtnText,name:this.rightBtnText}))))]}};hn.style=cn;const dn=".sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}.total-cost-container.sc-ir-payment-details{background:#7cbebe;color:white;padding:0.5rem;border-radius:5px}.payment-actions.sc-ir-payment-details{display:flex;align-items:center;justify-content:center;height:100%;gap:0.5rem}";const fn=dn;const un=class{constructor(i){t(this,i);this.resetBookingData=e(this,"resetBookingData",7);this.toast=e(this,"toast",7);this.paymentService=new Z;this.bookingService=new b;this.bookingDetails=undefined;this.defaultTexts=undefined;this.newTableRow=false;this.collapsedPayment=false;this.collapsedGuarantee=false;this.flag=false;this.confirmModal=false;this.toBeDeletedItem=undefined;this.paymentDetailsUrl="";this.paymentExceptionMessage="";this.modal_mode=null}async componentWillLoad(){try{this.paymentService.setToken(A.token);this.bookingService.setToken(A.token);this.initializeItemToBeAdded()}catch(t){if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentExceptionMessage=t}}}initializeItemToBeAdded(){this.itemToBeAdded={id:-1,date:Y().format("YYYY-MM-DD"),amount:null,currency:this.bookingDetails.currency,designation:"",reference:""}}async _processPaymentSave(){if(this.itemToBeAdded.amount===null){this.toast.emit({type:"error",title:this.defaultTexts.entries.Lcz_EnterAmount,description:"",position:"top-right"});return}if(Number(this.itemToBeAdded.amount)>Number(this.bookingDetails.financial.due_amount)){this.modal_mode="save";this.openModal();return}this._handleSave()}async _handleSave(){try{await this.paymentService.AddPayment(this.itemToBeAdded,this.bookingDetails.booking_nbr);this.initializeItemToBeAdded();this.resetBookingData.emit(null)}catch(t){console.log(t)}}handlePaymentInputChange(t,e,i){if(t==="amount"){if(!isNaN(e)||e===""){if(e===""){this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:null})}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:parseFloat(e)})}}else if(i&&i.target){let t=i.target;let e=t.value;e=e.replace(/[^\d-]|(?<!^)-/g,"");t.value=e}}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:e})}}async cancelPayment(){try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.bookingDetails.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.bookingDetails=Object.assign(Object.assign({},this.bookingDetails),{financial:Object.assign(Object.assign({},this.bookingDetails.financial),{payments:t})});this.confirmModal=!this.confirmModal;this.resetBookingData.emit(null);this.toBeDeletedItem=null;this.modal_mode=null}catch(t){console.log(t)}}async handleConfirmModal(t){t.stopImmediatePropagation();t.stopPropagation();if(this.modal_mode==="delete"){await this.cancelPayment()}else{await this._handleSave()}}openModal(){const t=document.querySelector(".delete-record-modal");t.openModal()}async handleCancelModal(t){t.stopImmediatePropagation();t.stopPropagation();try{if(this.modal_mode==="save"){this.initializeItemToBeAdded()}}catch(t){console.log(t)}}handleBookingDetails(){if(this.newTableRow){this.newTableRow=false}}handleDateChange(t){this.handlePaymentInputChange("date",t.detail.end.format("YYYY-MM-DD"))}_renderTableRow(t,e="normal"){var s;return i(n,null,i("tr",null,i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},H(t.date)):i("ir-date-picker",{minDate:Y().add(-2,"months").startOf("month").format("YYYY-MM-DD"),singleDatePicker:true,autoApply:true,onDateChanged:this.handleDateChange.bind(this)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center "},e==="normal"?i("span",{class:"sm-padding-right"},V(t.amount,this.bookingDetails.currency.code)):i("input",{type:"text",class:"border-0  form-control py-0 m-0 w-100",value:this.itemToBeAdded.amount===null?"":Number(this.itemToBeAdded.amount).toFixed(2),onInput:t=>this.handlePaymentInputChange("amount",+t.target.value,t)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},t.designation):i("input",{class:"border-0 w-100 form-control py-0 m-0",onInput:t=>this.handlePaymentInputChange("designation",t.target.value),type:"text"})),i("td",{rowSpan:2,class:"border payments-height border-light border-bottom-0 text-center"},i("div",{class:"payment-actions"},e==="add"&&i("ir-button",{variant:"icon",icon_name:"save",style:Xt.secondary,isLoading:e==="add"&&L("/Do_Payment"),class:"m-0",onClickHanlder:()=>{this._processPaymentSave()}}),i("ir-button",{variant:"icon",icon_name:"trash",style:Xt.danger,isLoading:((s=this.toBeDeletedItem)===null||s===void 0?void 0:s.id)===(t===null||t===void 0?void 0:t.id)&&L("/Cancel_Payment"),onClickHanlder:e==="add"?()=>{this.newTableRow=false;this.initializeItemToBeAdded()}:()=>{this.modal_mode="delete";this.toBeDeletedItem=t;this.openModal()}})))),i("tr",null,i("td",{colSpan:3,class:"border border-light payments-height border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left "},t.reference):i("input",{class:"border-0 w-100  form-control py-0 m-0",onKeyPress:t=>{if(t.key==="Enter"){this.newTableRow=false;this._handleSave()}},onInput:t=>this.handlePaymentInputChange("reference",t.target.value),type:"text"}))))}bookingGuarantee(){var t,e,s,n,o,a,r,l,c,h,d,f,u,b,p,g,m,y,k,v,w,x,_,D,C,O,E,T;if(this.bookingDetails.is_direct&&!this.bookingDetails.guest.cci){return null}return i("div",null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_BookingGuarantee),i("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":`.guarrantee`,"aria-expanded":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",variant:"icon",icon_name:"credit_card",onClickHanlder:async()=>{if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.bookingDetails.booking_nbr)}this.collapsedGuarantee=!this.collapsedGuarantee}})),i("div",{class:"collapse guarrantee "},this.bookingDetails.is_direct?[i("div",null,((e=(t=this.bookingDetails)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.cci)&&"Card:"," ",i("span",null,((o=(n=(s=this.bookingDetails)===null||s===void 0?void 0:s.guest)===null||n===void 0?void 0:n.cci)===null||o===void 0?void 0:o.nbr)||"")," ",((l=(r=(a=this.bookingDetails)===null||a===void 0?void 0:a.guest)===null||r===void 0?void 0:r.cci)===null||l===void 0?void 0:l.expiry_month)&&"Expiry: ",i("span",null," ",((d=(h=(c=this.bookingDetails)===null||c===void 0?void 0:c.guest)===null||h===void 0?void 0:h.cci)===null||d===void 0?void 0:d.expiry_month)||""," ",((b=(u=(f=this.bookingDetails)===null||f===void 0?void 0:f.guest)===null||u===void 0?void 0:u.cci)===null||b===void 0?void 0:b.expiry_year)&&"/"+((m=(g=(p=this.bookingDetails)===null||p===void 0?void 0:p.guest)===null||g===void 0?void 0:g.cci)===null||m===void 0?void 0:m.expiry_year))),i("div",null,((k=(y=this.bookingDetails)===null||y===void 0?void 0:y.guest)===null||k===void 0?void 0:k.cci.holder_name)&&"Name:"," ",i("span",null,((x=(w=(v=this.bookingDetails)===null||v===void 0?void 0:v.guest)===null||w===void 0?void 0:w.cci)===null||x===void 0?void 0:x.holder_name)||"")," ",((C=(D=(_=this.bookingDetails)===null||_===void 0?void 0:_.guest)===null||D===void 0?void 0:D.cci)===null||C===void 0?void 0:C.cvc)&&"- CVC:"," ",i("span",null," ",((T=(E=(O=this.bookingDetails)===null||O===void 0?void 0:O.guest)===null||E===void 0?void 0:E.cci)===null||T===void 0?void 0:T.cvc)||""))]:this.paymentDetailsUrl?i("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"}):i("div",{class:"text-center"},this.paymentExceptionMessage)))}_renderDueDate(t){return i("tr",null,i("td",{class:"pr-1"},H(t.date)),i("td",{class:"pr-1"},V(t.amount,this.bookingDetails.currency.code)),i("td",{class:"pr-1"},t.description),i("td",{class:"collapse font-size-small roomName"},t.room))}render(){var t,e,s,o;if(!this.bookingDetails.financial){return null}return[i("div",{class:"card m-0"},i("div",{class:"p-1"},this.bookingDetails.financial.gross_cost>0&&this.bookingDetails.financial.gross_cost!==null&&i("div",{class:"mb-2 h4 total-cost-container"},this.defaultTexts.entries.Lcz_TotalCost,": ",i("span",null,V(this.bookingDetails.financial.gross_cost,this.bookingDetails.currency.code))),i("div",{class:"mb-2 h4"},this.defaultTexts.entries.Lcz_DueBalance,":"," ",i("span",{class:"danger font-weight-bold"},V(this.bookingDetails.financial.due_amount,this.bookingDetails.currency.code))),this.bookingGuarantee(),i("div",{class:"mt-2"},i("div",null,((e=(t=this.bookingDetails.financial)===null||t===void 0?void 0:t.due_dates)===null||e===void 0?void 0:e.length)>0&&i(n,null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_PaymentDueDates),i("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":`.roomName`,"aria-expanded":"false","aria-controls":"myCollapse",variant:"icon",icon_name:this.collapsedPayment?"closed_eye":"open_eye",onClickHanlder:()=>{this.collapsedPayment=!this.collapsedPayment},style:{"--icon-size":"1.5rem"}})),i("table",null,(s=this.bookingDetails.financial.due_dates)===null||s===void 0?void 0:s.map((t=>this._renderDueDate(t))))))),i("div",{class:"mt-2 d-flex  flex-column rounded payment-container"},i("div",{class:"d-flex align-items-center justify-content-between"},i("strong",null,this.defaultTexts.entries.Lcz_Payments),i("ir-button",{id:"add-payment",variant:"icon",icon_name:"square_plus",style:{"--icon-size":"1.5rem"},onClickHanlder:()=>{this.newTableRow=true}})),i("table",{class:"mt-1"},i("thead",null,i("tr",null,i("th",{class:"border border-light border-bottom-0 text-center payment_date"},this.defaultTexts.entries.Lcz_Dates),i("th",{class:"border border-light border-bottom-0 text-center w-60"},this.defaultTexts.entries.Lcz_Amount),i("th",{class:"border border-light border-bottom-0 text-center designation"},this.defaultTexts.entries.Lcz_Designation),i("th",{class:"border border-light border-bottom-0 text-center action_icons"},i("span",{class:"sr-only"},"payment actions")))),i("tbody",null,(o=this.bookingDetails.financial.payments)===null||o===void 0?void 0:o.map((t=>this._renderTableRow(t))),this.newTableRow?this._renderTableRow(null,"add"):null))))),i("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:this.modal_mode==="delete"?this.defaultTexts.entries.Lcz_IfDeletedPermantlyLost:this.defaultTexts.entries.Lcz_EnteringAmountGreaterThanDue,iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.modal_mode==="delete"?this.defaultTexts.entries.Lcz_Delete:this.defaultTexts.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modal_mode==="delete"?"danger":"primary",onConfirmModal:this.handleConfirmModal.bind(this),onCancelModal:this.handleCancelModal.bind(this)})]}static get watchers(){return{bookingDetails:["handleBookingDetails"]}}};un.style=fn;class bn{async savePickup(t,e,i){try{const s=t.arrival_time.split(":");await S.post(`/Do_Pickup?Ticket=${A.token}`,{booking_nbr:e,is_remove:i,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){const e=t.hour&&t.minute?W(t.hour)+":"+W(t.minute):"";return{arrival_date:t.date,arrival_time:e,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let e=[];A.pickup_service.allowed_options.forEach((i=>{if(e.filter((t=>t.value===i.location.id)).length===0){e.push({text:t+" "+i.location.description,value:i.location.id})}}));return e}validateForm(t){if(t.arrival_time.split(":").length!==2){return{error:true,cause:"arrival_time"}}if(t.flight_details===""){return{error:true,cause:"flight_details"}}if(t.vehicle_type_code===""){return{error:true,cause:"vehicle_type_code"}}if(t.number_of_vehicles===0){return{error:true,cause:"number_of_vehicles"}}return{error:false}}getNumberOfVehicles(t,e){let i=Math.ceil(e/t);let s=i>1?i:1;let n=i>1?2:3;return Array.from({length:i+n},((t,e)=>s+e))}getPickUpPersonStatus(t){const e=A.pickup_service.allowed_pricing_models.find((e=>e.code===t));if(!e){return null}return e.description}updateDue(t){const e=this.getPickUpPersonStatus(t.code);if(!e){return}if(e==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const pn=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}";const gn=pn;const mn=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.resetBookingData=e(this,"resetBookingData",7);this.pickupService=new bn;this.defaultPickupData=undefined;this.numberOfPersons=0;this.bookingNumber=undefined;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:Y().format("YYYY-MM-DD"),selected_option:undefined};this.vehicleCapacity=[];this.cause=null}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=A.pickup_service.allowed_options.filter((e=>e.location.id===t.location));this.pickupData=Object.assign({},t)}}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e===""){this.updatePickupData("location",-1)}if(e!==""){this.allowedOptionsByLocation=A.pickup_service.allowed_options.filter((t=>t.location.id.toString()===e));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:e,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency});const i=this.el.querySelector("#pickup-time");if(!i){setTimeout((()=>{this.initializeInputMask()}),100)}}}initializeInputMask(){const t=this.el.querySelector("#pickup-time");if(t){Inputmask("Hh:Mm",{placeholder:"HH:mm",definitions:{H:{validator:"[0-2]"},h:{validator:function(t,e,i){var s=e.buffer[i-1];if(s==="2"){return/[0-3]/.test(t)}else{return/[0-9]/.test(t)}}},M:{validator:"[0-5]"},m:{validator:"[0-9]"}},insertMode:true,showMaskOnHover:false,inputmode:"numeric",alias:"datetime",oncomplete:()=>{this.updatePickupData("arrival_time",t.value)},oncleared:()=>{this.updatePickupData("arrival_time","")},onincomplete:()=>{this.updatePickupData("arrival_time",t.value)}}).mask(t)}}handleVehicleQuantityChange(t){if(t.detail===""){return}const e=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:e,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:e}).toFixed(2)})}componentDidLoad(){if(this.defaultPickupData){this.initializeInputMask()}}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let e=A.pickup_service.allowed_options.find((e=>e.location.id===+this.pickupData.location&&e.vehicle.code===t.detail));if(!e){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code})}updatePickupData(t,e){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:e})}async savePickup(){try{this.isLoading=true;const t=this.pickupService.validateForm(this.pickupData);if(t.error){this.cause=t.cause;return}if(this.cause){this.cause=null}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return i(s,{key:"1a16cd01e1a53928198351fb8df42ab7eb48e151",class:"p-0"},i("ir-title",{key:"bc65f0f9840cc48ffd60bcf5fb97f8c88ec5aa0b",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:M.entries.Lcz_Pickup,displayContext:"sidebar"}),i("section",{key:"0bd9a297725d16f2efd268e03cfdf28b1a464d4f",class:"px-1"},i("ir-select",{key:"6d12bee7ab4e6d1817d2dd4dc6eb72c59b069c47",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:M.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",LabelAvailable:false,data:this.pickupService.getAvailableLocations(M.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&i(n,{key:"66fd053fc91e9b1063525f4b4c3910caf5a9a047"},i("div",{key:"5b8bb91de330c28e1c37360fbb2de36c387238c1",class:"d-flex"},i("div",{key:"4d2463c71612ea0eaede7850123c0f85b0e106db",class:"form-group  mr-1"},i("div",{key:"e77482b75b762e9510a9dcdfe1e9a8907247e35b",class:"input-group row m-0"},i("div",{key:"360036ba36ddcd15367654168bfe1cd92ebf999d",class:`input-group-prepend col-5 p-0 text-dark border-0`},i("label",{key:"72a346a5955e35e0e2b4281c2721c3828dd714fe",class:`input-group-text  flex-grow-1 text-dark border-theme `},M.entries.Lcz_ArrivalDate)),i("div",{key:"ad3178048605b7cae379071cc12b71aef7dc5597",class:"form-control form-control-md col-7 d-flex align-items-center pl-0"},i("ir-date-picker",{key:"f96c523a4463f3494d0808eb673f7d25c89ace56",minDate:Y().format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{this.updatePickupData("arrival_date",t.detail.start.format("YYYY-MM-DD"))}})))),i("div",{key:"f1894927286f17060785c2ece3e8b2bc95373c91",class:"form-group"},i("div",{key:"2f5d4720db00d222495fecb53c8aea0fbd36c8e0",class:"input-group  row m-0"},i("div",{key:"d242b0363e7adcf67bdbc984a5fe88ee4e797c97",class:`input-group-prepend col-4 col-sm-3 p-0 text-dark border-0`},i("label",{key:"67ce35b9c0555e1d60fa6b757686bafdbcb74812",htmlFor:"pickup",class:`input-group-text flex-grow-1 text-dark border-theme`},M.entries.Lcz_Time)),i("input",{key:"93cd1de67b1deeda6383e9f54a6c6f822537dd2b",type:"text",value:this.pickupData.arrival_time,id:"pickup-time",class:`form-control col-8 col-sm-4 ${this.cause==="arrival_time"&&"border-danger"}`})))),i("ir-input-text",{key:"9990c6481707e709605dfc5e477f1ab516fbed94",value:this.pickupData.flight_details,label:M.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",inputStyles:this.cause==="flight_details"?"border-danger":""}),i("ir-select",{key:"0469049ab068038b196c1564f60c18f528eeedcd",selectContainerStyle:"mb-1",selectStyles:this.cause==="vehicle_type_code"?"border-danger":"",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:M.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",LabelAvailable:false,data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),i("div",{key:"64cd045786dc033c8e54c58d89591fe5d7c4f6ac",class:"d-flex flex-column flex-md-row"},i("ir-select",{key:"b904dc1984a1d5ae540d7d399866cd7d3f2c9b29",labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectStyles:this.cause==="number_of_vehicles"?"border-danger":"",selectedValue:this.pickupData.number_of_vehicles,labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:M.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),i("ir-input-text",{key:"873f2625b3c9a88e2ef5cd09772d08a3ecba7342",labelBorder:"theme",readonly:true,value:this.pickupData.due_upon_booking,labelWidth:7,label:`${M.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`,placeholder:"",class:""}))),i("div",{key:"4442b23bec54beda7adce3e0480835a497c7cfa6",class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{key:"e3bb21067b6ba2f4e39c446d6371d45b04ced325",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  ${this.defaultPickupData||this.pickupData.location!==-1?"mr-sm-1":""}`,icon:"",text:M.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&i("ir-button",{key:"705f0329720a22275bbe9ffaed023e5e650fc23c",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:this.isLoading,text:M.entries.Lcz_Save,btn_color:"primary",onClick:this.savePickup.bind(this)}))))}get el(){return o(this)}};mn.style=gn;const yn=".sc-ir-popover-h{display:block;width:100%}*.sc-ir-popover{box-sizing:border-box}.popover-title.sc-ir-popover{position:relative;width:100%;height:100%;margin:0;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;z-index:10;left:0}.popover-container.sc-ir-popover{position:absolute;bottom:0px;left:var(--ir-popover-left, 10px);background:rgb(0, 0, 0);color:white;min-width:100%;box-shadow:rgba(0, 0, 0, 0.2) 0px 2px 10px;z-index:9999;padding:3.5px 7px;border-radius:5px;pointer-events:none;opacity:0;transition:all 100ms ease;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-style:normal;font-weight:400;line-height:1.45;text-decoration:none;text-shadow:none;font-size:0.875rem}.popover-container[data-state='show'].sc-ir-popover{opacity:1}";const kn=yn;const vn=class{constructor(e){t(this,e);this.handleMouseEnter=()=>{if(!this.showPopover){return}if(this.showPopover){this.isHovered=true}};this.handleMouseLeave=()=>{if(!this.showPopover){return}this.isHovered=false};this.popoverTitle=undefined;this.isHovered=false;this.showPopover=false;this.irPopoverLeft="10px"}componentWillLoad(){this.checkTitleWidth()}checkTitleWidth(){requestAnimationFrame((()=>{const t=this.el.querySelector(".popover-title");if(t){const e=t.scrollWidth;this.showPopover=e>150}}))}render(){return i(s,{key:"ddfb6d8ce2a89e20b776b33c797c7945b51cb383",style:{"--ir-popover-left":this.irPopoverLeft}},i("p",{key:"1e48981aafb60c6191457e781ba6be34444c8304",class:"popover-title",onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter},this.popoverTitle),this.showPopover&&this.isHovered&&i("div",{key:"c7c9a13f2bf0c1d69bdc57157a948ddac9f40b71","data-state":"show",class:"popover-container"},this.popoverTitle))}get el(){return o(this)}};vn.style=kn;const wn=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.3rem 0.5rem;border-radius:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.subtotal_row.sc-ir-room{padding-top:8px}.room_actions_btns.sc-ir-room{gap:0.5rem}.night-cost.sc-ir-room{color:#7cbebe}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const xn=wn;const _n=class{constructor(i){t(this,i);this.deleteFinished=e(this,"deleteFinished",7);this.pressCheckIn=e(this,"pressCheckIn",7);this.pressCheckOut=e(this,"pressCheckOut",7);this.editInitiated=e(this,"editInitiated",7);this.bookingEvent=undefined;this.bookingIndex=undefined;this.isEditable=undefined;this.mealCodeName=undefined;this.myRoomTypeFoodCat=undefined;this.currency="USD";this.legendData=undefined;this.roomsInfo=undefined;this.collapsed=false;this.defaultTexts=undefined;this.ticket=undefined;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.item=undefined;this.isLoading=false;this.isModelOpen=false}componentWillLoad(){if(this.bookingEvent){this.item=this.bookingEvent.rooms[this.bookingIndex]}}handleBookingEventChange(){this.item=this.bookingEvent.rooms[this.bookingIndex]}componentDidLoad(){this.modal=this.element.querySelector("ir-modal")}handleClick(t){let e=t.target;if(e.id=="checkin"){this.pressCheckIn.emit(this.item)}else if(e.id=="checkout"){this.pressCheckOut.emit(this.item)}}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}handleEditClick(){var t,e,i,s,n,o;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.item["assigned_units_pool"],NAME:E(this.item.guest.first_name,this.item.guest.last_name),EMAIL:this.bookingEvent.guest.email,PHONE:this.bookingEvent.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingEvent.from_date,TO_DATE:this.bookingEvent.to_date,TITLE:`${this.defaultTexts.entries.Lcz_EditBookingFor} ${(e=(t=this.item)===null||t===void 0?void 0:t.roomtype)===null||e===void 0?void 0:e.name} ${((s=(i=this.item)===null||i===void 0?void 0:i.unit)===null||s===void 0?void 0:s.name)||""}`,defaultDateRange:{dateDifference:this.item.days.length,fromDate:new Date(this.item.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.item.from_date+"T00:00:00")),toDate:new Date(this.item.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.item.to_date+"T00:00:00")),message:""},bed_preference:this.item.bed_preference,adult_child_offering:this.item.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.item.rateplan.selected_variation.adult_nbr,ARRIVAL:this.bookingEvent.arrival,ARRIVAL_TIME:this.bookingEvent.arrival.description,BOOKING_NUMBER:this.bookingEvent.booking_nbr,cancelation:this.item.rateplan.cancelation,channel_booking_nbr:this.bookingEvent.channel_booking_nbr,CHILDREN_COUNT:this.item.rateplan.selected_variation.child_nbr,COUNTRY:this.bookingEvent.guest.country_id,ENTRY_DATE:this.bookingEvent.from_date,FROM_DATE_STR:this.bookingEvent.format.from_date,guarantee:this.item.rateplan.guarantee,GUEST:this.bookingEvent.guest,IDENTIFIER:this.item.identifier,is_direct:this.bookingEvent.is_direct,IS_EDITABLE:this.bookingEvent.is_editable,NO_OF_DAYS:this.item.days.length,NOTES:this.bookingEvent.remark,origin:this.bookingEvent.origin,POOL:this.item["assigned_units_pool"],PR_ID:(n=this.item.unit)===null||n===void 0?void 0:n.id,RATE:this.item.total,RATE_PLAN:this.item.rateplan.name,RATE_PLAN_ID:this.item.rateplan.id,RATE_TYPE:this.item.roomtype.id,ROOMS:this.bookingEvent.rooms,SOURCE:this.bookingEvent.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.bookingEvent.format.to_date,TOTAL_PRICE:this.bookingEvent.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((o=this.item.unit)===null||o===void 0?void 0:o.name)||""})}handleDeleteClick(){this.modal.openModal()}async deleteRoom(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];t=t.filter((t=>t.identifier!==this.item.identifier));const e={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.bookingEvent.booking_nbr,from_date:this.bookingEvent.from_date,to_date:this.bookingEvent.to_date,remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};console.log("body:",e);const{data:i}=await S.post(`/DoReservation?Ticket=${this.ticket}`,e);if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}this.deleteFinished.emit(this.item.identifier)}catch(t){}finally{this.isLoading=false}}render(){console.log(this.item);return i(s,{key:"1293934a8148cca0c6319cb6cb684f9af8107cd1",class:"p-1 d-flex m-0"},i("ir-button",{key:"30d5378adac31e02ed5120e5e73500263bf56ee8",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${this.item.identifier.split(" ").join("")}`,"aria-expanded":"false","aria-controls":"collapseExample",class:"mr-1",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHanlder:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}}),i("div",{key:"8b45130f148ce9710eb6b32e3a58286c1317d7b6",class:"flex-fill m-0 "},i("div",{key:"1d9ad1cc79baaba2053a6e9100637f89a6b2b8e7",class:"d-flex align-items-start justify-content-between sm-mb-1"},i("p",{key:"e2e25533fa3abf403a2168f35bc2f8665336c3b5",class:"m-0 p-0"},i("strong",{key:"e3d12cf0a549393e6f4101456c8eafd8a2ebb227",class:"m-0 p-0"},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.item.rateplan.is_non_refundable&&` - ${this.defaultTexts.entries.Lcz_NonRefundable}`," "),i("div",{key:"d980fa1e25cc24fc81ac3948e0493711ec5da573",class:"d-flex m-0 p-0 align-items-center room_actions_btns"},i("span",{key:"b8d473ae20bee20d69a23f989e099ec77abd4aa3",class:"p-0 m-0 font-weight-bold"},V(this.item["gross_total"],this.currency)),this.hasRoomEdit&&this.isEditable&&i("ir-button",{key:"2a178422c18aead865a4b2b64c80a20a3202e7c1",id:`roomEdit-${this.item.identifier}`,variant:"icon",icon_name:"edit",style:Xt.secondary,onClickHanlder:this.handleEditClick.bind(this)}),this.hasRoomDelete&&this.isEditable&&i("ir-button",{key:"3b55a133a0248d319c715b9727a45e078ac64868",variant:"icon",onClickHanlder:this.handleDeleteClick.bind(this),id:`roomDelete-${this.item.identifier}`,icon_name:"trash",style:Xt.danger}))),i("div",{key:"15bc60332779c7468e8a81423d8b362b2f70da3d",class:"d-flex align-items-center sm-mb-1"},i("ir-date-view",{key:"7bb1ee906dba1ec4bba766ca5a7339107e33af36",class:"mr-1",from_date:this.item.from_date,to_date:this.item.to_date,showDateDifference:false}),this.hasCheckIn&&i("ir-button",{key:"f3afb69633cb63959faf3e825db9f96aa84dac20",id:"checkin",icon:"",class:"mr-1",btn_color:"info",size:"sm",text:"Check in"}),this.hasCheckOut&&i("ir-button",{key:"d0f12eec30aa8244fd27ccdfd2e6768d52c2c995",id:"checkout",icon:"",btn_color:"info",size:"sm",text:"Check out"})),i("div",{key:"cef29db6eec631ed74f3694347cf15b2cc2cf6b3",class:"d-flex justify-content-end"},A.is_frontdesk_enabled&&this.item.unit&&i("span",{key:"4a893d6fd6625f3765cb274168ef748f67e06ad6",class:`light-blue-bg ${this.hasCheckIn||this.hasCheckOut?"mr-2":""} `},this.item.unit.name)),i("div",{key:"394baefc3e1a1689fdd7183e0cc3e101ff5df50d"},i("span",{key:"dde7f6df1b6746bfb8500d1180356b9e937f3766",class:"mr-1"},`${this.item.guest.first_name||""} ${this.item.guest.last_name||""}`),this.item.rateplan.selected_variation.adult_nbr>0&&i("span",{key:"934b028b68345ffde346f6205a96278bcc14b475"}," ",this.item.rateplan.selected_variation.adult_child_offering)),i("div",{key:"98a8458efc2bf764cef4ea0780f495514a5acb63",class:"collapse",id:`roomCollapse-${this.item.identifier.split(" ").join("")}`},i("div",{key:"f84b3e5b21b7817ab79564eb46b976faf6cd0a23",class:"d-flex sm-mb-1 sm-mt-1"},i("div",{key:"739641f6b6977869410564e8168017e9befb6368",class:" sm-padding-top"},i("strong",{key:"f17ea79cee51db0bc46f4690e9110b957c02ffe4",class:"sm-padding-right"},`${this.defaultTexts.entries.Lcz_Breakdown}:`)),i("div",{key:"1961eeedc5462cfa76b7fddaf0fef9739603e08d",class:"flex-fill"},i("table",{key:"08a260af4e1322fd02c38174f6a24e6ade7ed54b"},this.item.days.length>0&&this.item.days.map((t=>i("tr",null,i("td",{class:"pr-2 text-right"},K(t.date)),i("td",{class:"text-right"},V(t.amount,this.currency)),t.cost>0&&t.cost!==null&&i("td",{class:"pl-2 text-left night-cost"},V(t.cost,this.currency))))),i("tr",{key:"5837394a6157d033603c8c925388baba11d223dd",class:""},i("th",{key:"04590a5b5b983a97c9120fb0807e61c7c6e4b7b8",class:"text-right pr-2 subtotal_row"},this.defaultTexts.entries.Lcz_SubTotal),i("th",{key:"4393129e9252be7b62a5ee589231b6bbac897698",class:"text-right subtotal_row"},V(this.item.total,this.currency)),this.item.gross_cost>0&&this.item.gross_cost!==null&&i("th",{key:"a7d30923d1427ce12556d3be0f0f177741f10567",class:"pl-2 text-right night-cost"},V(this.item.cost,this.currency))),this.bookingEvent.is_direct?i(n,null,(()=>{const t=A.taxes.filter((t=>t.pct>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name," (",t.pct,"%)"),i("td",{class:"text-right"},V(this.item.total*t.pct/100,this.currency)),this.item.gross_cost>0&&this.item.gross_cost!==null&&i("td",{class:"pl-2 text-right night-cost"},V(this.item.cost*t.pct/100,this.currency)))))})()):i(n,null,(()=>{const t=this.item.ota_taxes.filter((t=>t.amount>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name),i("td",{class:"text-right"},t.currency.symbol,t.amount))))})())))),i("div",{key:"9a951278e1b8bda378dea56083acff65ed1be4be",class:"sm-mb-1",innerHTML:this.item.rateplan.cancelation||""}),i("div",{key:"7d56dd98dee59b6b712a3f6b347db6321a5642fe",class:"sm-mb-1",innerHTML:this.item.rateplan.guarantee||""}),this.bookingEvent.is_direct&&i("ir-label",{key:"20c623b5754328bef4c42b76fecb2f7384408327",label:`${this.defaultTexts.entries.Lcz_MealPlan}:`,value:this.mealCodeName}))),i("ir-modal",{key:"b66e952734e15b2037614b2f7a0921653db1e091",onConfirmModal:this.deleteRoom.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:`${this.defaultTexts.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.item.roomtype.name} ${this.item.unit?this.item.unit.name:""} ${this.defaultTexts.entries.Lcz_FromThisBooking}`}))}get element(){return o(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};_n.style=xn;const Dn=".sc-ir-room-nights-h{display:block;box-sizing:border-box;margin:0;position:relative}.loading-container.sc-ir-room-nights{position:relative;height:100%;width:100%;display:flex;align-items:center;justify-content:center}.close-icon.sc-ir-room-nights{position:absolute;top:18px;right:33px;outline:none}.close.sc-ir-room-nights{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.card.sc-ir-room-nights{top:0;z-index:1000}.card-title.sc-ir-room-nights{border-bottom:1px solid #e4e5ec;width:100%}.irfontgreen.sc-ir-room-nights{color:#0e930e}.currency.sc-ir-room-nights{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-ir-room-nights{font-size:14px;line-height:0;padding:0;height:0;border-left:0;border-radius:0.25rem !important}.rate-input-container.sc-ir-room-nights{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-ir-room-nights{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-ir-room-nights span[data-state='focus'].sc-ir-room-nights{border-color:var(--blue)}.input-group-prepend.sc-ir-room-nights span[data-disabled].sc-ir-room-nights{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.rateInputBorder.sc-ir-room-nights{padding-left:5px !important;padding-right:5px !important;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}";const Cn=Dn;const On=class{constructor(i){t(this,i);this.closeRoomNightsDialog=e(this,"closeRoomNightsDialog",7);this.bookingService=new st;this.bookingNumber=undefined;this.baseUrl=undefined;this.propertyId=undefined;this.language=undefined;this.identifier=undefined;this.toDate=undefined;this.fromDate=undefined;this.pool=undefined;this.ticket=undefined;this.bookingEvent=undefined;this.selectedRoom=undefined;this.rates=[];this.isLoading=false;this.initialLoading=false;this.inventory=null;this.isEndDateBeforeFromDate=false;this.defaultTotalNights=0;this.isInputFocused=-1;this.dates={from_date:new Date,to_date:new Date}}componentWillLoad(){this.bookingService.setToken(A.token);if(this.baseUrl){S.defaults.baseURL=this.baseUrl}this.dates={from_date:new Date(this.fromDate),to_date:new Date(this.toDate)};this.init()}isButtonDisabled(){return this.isLoading||this.rates.some((t=>t.amount===-1))||this.inventory===0||this.inventory===null}async init(){var t;console.log(this.fromDate,this.toDate);try{this.bookingEvent=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);if(this.bookingEvent){const e=this.bookingEvent.rooms.filter((t=>t.identifier===this.identifier));this.selectedRoom=e[0];const i=(t=this.selectedRoom)===null||t===void 0?void 0:t.days[this.selectedRoom.days.length-1];if(Y(this.toDate).add(-1,"days").isSame(Y(i.date))){const t=await this.fetchBookingAvailability(this.fromDate,this.selectedRoom.days[0].date,this.selectedRoom.rateplan.id,this.selectedRoom.rateplan.selected_variation.adult_child_offering);const e=T(this.selectedRoom.days[0].date,this.fromDate);this.isEndDateBeforeFromDate=true;this.rates=[...e.map((i=>({amount:t/e.length,date:i,cost:null}))),...this.selectedRoom.days];this.defaultTotalNights=this.rates.length-this.selectedRoom.days.length}else{const t=await this.fetchBookingAvailability(i.date,Y(this.toDate,"YYYY-MM-DD").add(-1,"days").format("YYYY-MM-DD"),this.selectedRoom.rateplan.id,this.selectedRoom.rateplan.selected_variation.adult_child_offering);const e=T(i.date,this.toDate);this.rates=[...this.selectedRoom.days,...e.map((i=>({amount:t/e.length,date:i,cost:null})))]}}if(Y(this.rates[0].date).isAfter(this.fromDate)){this.dates.from_date=new Date(this.fromDate)}else{this.dates.from_date=new Date(this.rates[0].date)}if(Y(this.rates[this.rates.length-1].date).isBefore(this.toDate)){this.dates.to_date=new Date(this.toDate)}else{this.dates.to_date=new Date(this.rates[this.rates.length-1].date)}}catch(t){console.log(t)}}handleInput(t,e){let i=t.target;let s=i.value;let n=[...this.rates];s=s.replace(/[^0-9.]/g,"");if(s===""){n[e].amount=-1}else{const t=s.split(".");if(t.length>2){s=s.substring(0,s.length-1);i.value=s}else if(t.length===2&&t[1].length>2){s=`${t[0]}.${t[1].substring(0,2)}`;i.value=s}if(!isNaN(Number(s))){n[e].amount=Number(s)}}this.rates=n;console.log(this.rates)}async fetchBookingAvailability(t,e,i,s){var n;try{this.initialLoading=true;const o=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyId,adultChildCount:{adult:this.selectedRoom.rateplan.selected_variation.adult_nbr,child:this.selectedRoom.rateplan.selected_variation.child_nbr},language:this.language,currency:this.bookingEvent.currency,room_type_ids:[this.selectedRoom.roomtype.id]});this.inventory=o.roomtypes[0].inventory;const a=o.roomtypes[0].rateplans.find((t=>t.id===i));if(!a||!a.variations){this.inventory=null;return null}const{amount:r}=(n=a.variations)===null||n===void 0?void 0:n.find((t=>t.adult_child_offering===s));return r}catch(t){console.log(t)}finally{this.initialLoading=false}}renderInputField(t,e,s){return i("fieldset",{class:"col-2 ml-1 position-relative has-icon-left m-0 p-0 rate-input-container"},i("div",{class:"input-group-prepend bg-white"},i("span",{"data-disabled":this.inventory===0||this.inventory===null,"data-state":this.isInputFocused===t?"focus":"",class:"input-group-text new-currency bg-white",id:"basic-addon1"},e)),i("input",{onFocus:()=>this.isInputFocused=t,onBlur:()=>this.isInputFocused=-1,disabled:this.inventory===0||this.inventory===null,type:"text",class:"form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder",id:N(),value:s.amount>0?s.amount:"",placeholder:M.entries.Lcz_Rate||"Rate",onInput:e=>this.handleInput(e,t)}))}renderReadOnlyField(t,e){return i("p",{class:"col-9 ml-1 m-0 p-0"},`${t}${Number(e.amount).toFixed(2)}`)}renderRateFields(t,e,i){if(this.isEndDateBeforeFromDate){if(t<this.defaultTotalNights){return this.renderInputField(t,e,i)}else{return this.renderReadOnlyField(e,i)}}else{return t<this.selectedRoom.days.length?this.renderReadOnlyField(e,i):this.renderInputField(t,e,i)}}renderDates(){var t;const e=a(this.bookingEvent.currency.code);return i("div",{class:"mt-2 m-0"},(t=this.rates)===null||t===void 0?void 0:t.map(((t,s)=>i("div",{class:"row m-0 mt-1 align-items-center"},i("p",{class:"col-2 m-0 p-0"},I(t.date)),this.renderRateFields(s,e,t)))))}async handleRoomConfirmation(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];let e=t.findIndex((t=>t.identifier===this.identifier));if(e===-1){throw new Error("Invalid Pool")}t[e]=Object.assign(Object.assign({},t[e]),{days:this.rates,to_date:Y(this.dates.to_date).format("YYYY-MM-DD"),from_date:Y(this.dates.from_date).format("YYYY-MM-DD")});const i={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.bookingNumber,from_date:Y(this.dates.from_date).format("YYYY-MM-DD"),to_date:Y(this.dates.to_date).format("YYYY-MM-DD"),remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};await this.bookingService.doReservation(i);this.closeRoomNightsDialog.emit({type:"confirm",pool:this.pool})}catch(t){}finally{this.isLoading=false}}render(){var t,e,o;if(!this.bookingEvent){return i("div",{class:"loading-container"},i("ir-loading-screen",null))}return i(s,null,i("div",{class:"card position-sticky mb-0 shadow-none p-0 "},i("div",{class:"d-flex mt-2 align-items-center justify-content-between "},i("h3",{class:"card-title text-left pb-1 font-medium-2 px-2"},M.entries.Lcz_AddingRoomNightsTo," ",(e=(t=this.selectedRoom)===null||t===void 0?void 0:t.roomtype)===null||e===void 0?void 0:e.name," ",((o=this.selectedRoom)===null||o===void 0?void 0:o.unit).name),i("button",{type:"button",class:"close close-icon",onClick:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool})},i("ir-icon",{icon:"ft-x",class:"m-0"})))),i("section",{class:"text-left px-2"},i("p",{class:"font-medium-1"},`${M.entries.Lcz_Booking}#`," ",this.bookingNumber),this.initialLoading?i("p",{class:"mt-2 text-secondary"},M.entries["Lcz_CheckingRoomAvailability "]):i(n,null,i("p",{class:"font-weight-bold font-medium-1"},`${B(Y(this.dates.from_date).format("YYYY-MM-DD"),"YYYY-MM-DD")} - ${B(Y(this.dates.to_date).format("YYYY-MM-DD"),"YYYY-MM-DD")}`),i("p",{class:"font-medium-1 mb-0"},`${this.selectedRoom.rateplan.name}`," ",this.selectedRoom.rateplan.is_non_refundable&&i("span",{class:"irfontgreen"},M.entries.Lcz_NonRefundable)),(this.inventory===0||this.inventory===null)&&i("p",{class:"font-medium-1 text danger"},M.entries.Lcz_NoAvailabilityForAdditionalNights),this.selectedRoom.rateplan.custom_text&&i("p",{class:"text-secondary mt-0"},this.selectedRoom.rateplan.custom_text),this.renderDates())),i("section",{class:"d-flex align-items-center mt-2 px-2"},i("ir-button",{btn_color:"secondary",btn_disabled:this.isLoading,text:M===null||M===void 0?void 0:M.entries.Lcz_Cancel,class:"full-width",btn_styles:"justify-content-center",onClickHanlder:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool})}),this.inventory>0&&this.inventory!==null&&i("ir-button",{isLoading:this.isLoading,text:M===null||M===void 0?void 0:M.entries.Lcz_Confirm,btn_disabled:this.isButtonDisabled(),class:"ml-1 full-width",btn_styles:"justify-content-center",onClickHanlder:this.handleRoomConfirmation.bind(this)})))}};On.style=Cn;const En=".border-theme.sc-ir-select{border:1px solid #cacfe7}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}.bounce-3.sc-ir-select{animation:bounce 1s 1}";const Tn=En;const In=class{constructor(i){t(this,i);this.selectChange=e(this,"selectChange",7);this.count=0;this.name=undefined;this.data=undefined;this.label="<label>";this.selectStyles=undefined;this.selectContainerStyle=undefined;this.selectedValue=null;this.required=undefined;this.LabelAvailable=true;this.firstOption="Select";this.selectStyle=true;this.showFirstOption=true;this.submited=false;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.select_id=N();this.initial=true;this.valid=false}watchHandler(t){if(t!==null&&this.required){this.valid=true}}watchHandler2(t){if(t&&this.required){this.initial=false}}handleButtonAnimation(t){console.log(t.detail,this.select_id,t.detail===this.select_id);if(!this.selectEl||t.detail!==this.select_id){return}console.log("first1");t.stopImmediatePropagation();t.stopPropagation();this.selectEl.classList.add("border-danger")}componentwillload(){}disconnectedCallback(){}handleSelectChange(t){this.selectEl.classList.remove("border-danger");if(this.required){this.initial=false;this.valid=t.target.checkValidity();this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}else{this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}}render(){let t="form-control";let e=i("div",{key:"0efaaea1626bc3c1b400e715be29ab550c796d72",class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},i("label",{key:"2cea275d5cb75b8b1b55cfdb0b1cebe5aaf989dd",htmlFor:this.select_id,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(this.selectStyle===false){t=""}if(this.required&&!this.valid&&!this.initial){t=`${t} border-danger`}if(!this.LabelAvailable){e=""}return i("div",{key:"8c4b7b5766f3d95a69654e0493227548af500f98",class:`form-group m-0 ${this.selectContainerStyle}`},i("div",{key:"88c59791882e3f8a20cc35f4ddb869cf6643128c",class:"input-group row m-0"},e,i("select",{key:"9fa5a7a760c43215903f1f398276d2e8132e5a37",ref:t=>this.selectEl=t,id:this.select_id,class:`${this.selectStyles} ${t} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12}`,onInput:this.handleSelectChange.bind(this),required:this.required},this.showFirstOption&&i("option",{key:"3fbced1dd22576ce89cb9ccda3a30f8d329c2883",value:""},this.firstOption),this.data.map((t=>{if(this.selectedValue===t.value){return i("option",{selected:true,value:t.value},t.text)}else{return i("option",{value:t.value},t.text)}})))))}static get watchers(){return{selectedValue:["watchHandler"],submited:["watchHandler2"]}}};In.style=Tn;const Bn=".backdrop{position:fixed;top:0;left:0;width:100%;height:100vh;cursor:pointer;background:rgba(0, 0, 0, 0.5);z-index:99;transition:all 0.5s;opacity:0;pointer-events:none;transition:all 0.5s}.backdrop.active{opacity:1;pointer-events:all}.sidebar-right{position:fixed;top:0;right:-120%;bottom:0;width:var(--sidebar-width, 40rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:100;overflow-y:hidden;color:var(--sidebar-color, #000);background-color:var(--sidebar-backgound, #fff);padding:var(--ir-sidebar-padding, 0.5rem 0)}.sidebar-right.active{right:0;overflow-y:auto}.sidebar-left{position:fixed;top:0;left:-100%;bottom:0;width:var(--sidebar-width, 30rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:200;overflow-y:hidden;color:var(--sidebar-color, #000);background:var(--sidebar-backgound, #fff);padding:var(--ir-sidebar-padding, 0.5rem 0)}.sidebar-left.active{left:0;overflow-y:scroll}.close{position:absolute;top:0.5rem;right:1rem;width:1rem;height:1rem;cursor:pointer}";const Mn=Bn;const An=class{constructor(i){t(this,i);this.irSidebarToggle=e(this,"irSidebarToggle",7);this.name=undefined;this.side="right";this.showCloseButton=true;this.open=false;this.sidebarStyles=undefined}applyStyles(){for(const t in this.sidebarStyles){if(this.sidebarStyles.hasOwnProperty(t)){this.sidebarRef.style[t]=this.sidebarStyles[t]}}}handleSidebarStylesChange(){this.applyStyles()}componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidLoad(){this.applyStyles();document.addEventListener("keydown",this.handleKeyDown)}handleKeyDown(t){if(t.key==="Escape"){return this.toggleSidebar()}else{return}}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}async toggleSidebar(){this.irSidebarToggle.emit(this.open)}render(){let t="";if(this.open){t="active"}else{t=""}return[i("div",{key:"bba006848bcd3d23d2a2c501648ebf50f849df00",class:`backdrop ${t}`,onClick:()=>{this.toggleSidebar()}}),i("div",{key:"26fe733f4fa639154015cae9716d0b0fc4bfb63e",ref:t=>this.sidebarRef=t,class:`sidebar-${this.side} ${t}`},this.showCloseButton&&i("ir-icon",{key:"1a76b648b9f78bd7b7a88de89ce3e2d0f2dd2aa3",class:"close",onIconClickHandler:()=>{this.toggleSidebar()}},i("svg",{key:"89cb74a7dfd4e84f868496a531cc27501c972ec8",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"7f5252feebe794641b6ee534767e3feacf579a6f",fill:"#6b6f82",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("slot",{key:"fe1e4ec56e6717d43986e2815bf95816f6b31b4b",name:"sidebar-body"}))]}static get watchers(){return{sidebarStyles:["handleSidebarStylesChange"]}}};An.style=Mn;const Nn=class{constructor(i){t(this,i);this.textChange=e(this,"textChange",7);this.rows=3;this.cols=5;this.text="";this.label="<label>";this.placeholder="<placeholder>";this.value="";this.maxLength=undefined}connectedCallback(){}disconnectedCallback(){}render(){return i("div",{key:"8725aae3af7652c5ae8934fba341d097f169d684",class:"form-group"},i("label",{key:"768eff0873c578eed5e445d40b3dfd4c44f30c34"},this.label),i("textarea",{key:"fe4752b7bdac1ca880be3f03110f2184645888bb",maxLength:this.maxLength,rows:this.rows,value:this.value,class:"form-control",placeholder:this.placeholder,onInput:t=>this.textChange.emit(t.target.value)}))}};const Rn=".sc-ir-title-h{padding:0px 0;margin-bottom:20px;display:flex;align-items:center;width:100%}[display-context='sidebar'].sc-ir-title-h{padding:15px 0;justify-content:space-between !important;width:100% !important;border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important}.title-body.sc-ir-title{margin:0;padding:0}@media only screen and (max-width: 641px){.sc-ir-title-h{flex-direction:column;gap:8px;align-items:flex-start}[display-context='sidebar'].sc-ir-title-h{flex-direction:row}}";const Sn=Rn;const Ln=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.label=undefined;this.displayContext="default";this.justifyContent="start"}componentDidLoad(){this.el.style.justifyContent=this.justifyContent}handleJustifyContentChange(t,e){if(t!==e){this.el.style.justifyContent=t}}render(){return i(s,{key:"100614c65cf8639c31d4a8f0839505f41d86942a"},i("h4",{key:"0dab36aa03842555e9fc57a96437a1fd229e84eb",class:"text-left font-medium-2 py-0 my-0"},this.label),this.displayContext==="sidebar"&&i("ir-icon",{key:"45445590514295ca482e5ae9c19341a48f3ff95e",class:"close",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},i("svg",{key:"2d88fb55c39d1cf08059662cca3cfaf9702c3503",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"38a42da51c29772f22cce3fb903d889d8d77daba",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),this.displayContext!=="sidebar"&&i("div",{key:"a1f887e1431ec5764d364b23e5b702f7989b5057",class:"title-body"},i("slot",{key:"a29d9986483a0b694616f5acf04d3ea0d95ca007",name:"title-body"})))}get el(){return o(this)}static get watchers(){return{justifyContent:["handleJustifyContentChange"]}}};Ln.style=Sn;const jn="button.sc-ir-toast,p.sc-ir-toast,h3.sc-ir-toast,div.sc-ir-toast{all:unset}.sc-ir-toast-h{--rd-viewport-padding:25px;--rd-success:#2b9a66;position:fixed;bottom:0;right:0;display:flex;flex-direction:column;padding:var(--rd-viewport-padding);gap:10px;max-width:100vw;margin:0;list-style:none;z-index:2147483647;outline:none;pointer-events:none;-webkit-user-select:none;user-select:none}@media (prefers-color-scheme: dark){.sc-ir-toast-h{--rd-success:#33b074}}p.sc-ir-toast{color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3}h1.sc-ir-toast,h2.sc-ir-toast,h3.sc-ir-toast,h4.sc-ir-toast,h5.sc-ir-toast,h6.sc-ir-toast{font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}[position='top-left'].sc-ir-toast-h{top:0;left:0}[position='top-right'].sc-ir-toast-h{top:0;right:0}[position='bottom-left'].sc-ir-toast-h{bottom:0;left:0}[position='bottom-right'].sc-ir-toast-h{bottom:0;right:0}.icon-container.sc-ir-toast{height:25px;width:25px;border-radius:25px;display:flex;align-items:center;justify-content:center;padding:0;margin:0}.icon-container.sc-ir-toast>svg.sc-ir-toast{margin:0;color:white;stroke-width:5px}.success.sc-ir-toast{background-color:var(--rd-success)}.error.sc-ir-toast{background-color:red}.ToastRoot.sc-ir-toast{background-color:hsl(0, 0%, 100%);border-radius:0.5rem;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;padding:15px;display:grid;grid-template-areas:'title action' 'description action';grid-template-columns:auto max-content;column-gap:15px;align-items:center;pointer-events:none;opacity:0;border:1px solid hsl(214.3, 31.8%, 91.4%);position:relative}.ToastRoot[data-state='open'].sc-ir-toast{pointer-events:all;animation:slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1)}.ToastRoot[data-state='closed'].sc-ir-toast{pointer-events:none;animation:hide 100ms ease-in}@-webkit-keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}@keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}.ToastTitle.sc-ir-toast{grid-area:title;font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}.ToastDescription.sc-ir-toast{grid-area:description;margin:0;margin-top:5px;color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3;overflow:hidden;text-overflow:ellipsis}.ToastAction.sc-ir-toast{grid-area:action}";const Yn=jn;const zn=class{constructor(e){t(this,e);this.position="bottom-left";this.toasts=[]}onToast(t){const e=t.detail;this.showToast(e)}showToast(t){const e={positionClass:"toast-top-right",closeButton:true,timeOut:t.duration||5e3};switch(t.type){case"success":toastr.success(t.title,"",e);break;case"error":toastr.error(t.title,"",e);break}}render(){return i(s,{key:"f35a7136e6d852b8f99a840609fa94044af1f315"})}get element(){return o(this)}};zn.style=Yn;const $n=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}.tooltip-inner-custom.sc-ir-tooltip{min-width:max-content !important}";const Pn=$n;const Hn=class{constructor(e){t(this,e);this.message=undefined;this.withHtml=true;this.customSlot=false;this.open=undefined}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){return i(s,{key:"002ce57803faa189d15bcbe2fd38d10c09e8cc08",class:"m-0 p-0"},i("span",{key:"62dc15cc28c122981903b17e7e2e0068cbe89939",onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},!this.customSlot?i("svg",{"data-toggle":"tooltip","data-placement":"top",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",class:"tooltip-icon",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})):i("slot",{name:"tooltip-trigger"})),this.open&&i("div",{key:"02456be86e276f93fe643446e2554f2b77b8ac15",class:"tooltip bottom show position-absolute",role:"tooltip"},i("div",{key:"1b077aacc38eeb83a08c7c42f3813be7eae24f3f",class:"tooltip-arrow"}),i("div",{key:"1e1b54f85f61a933758a59aa83f543dffe8cb759",class:`tooltip-inner fit ${this.customSlot&&"tooltip-inner-custom"}`},i("span",{key:"c012576a917c5f1cd9af81783de80b5b6b989f27",innerHTML:this.message}))))}};Hn.style=Pn;const Un="*.sc-ota-label{margin:0;padding:0}.sc-ota-label-h{display:flex;margin-bottom:5px;gap:5px;width:100%}strong.sc-ota-label{margin:0;padding:0}ul.sc-ota-label{margin:0 3px;padding:0;list-style:none;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important}li.sc-ota-label{width:100%;line-height:1.5;margin:0;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important}button.sc-ota-label{background:white;color:var(--blue);padding:0;margin:0;margin-left:3px;font-size:12px;border:0}button.sc-ota-label:hover{color:#355270}";const Gn=Un;const Vn=class{constructor(e){t(this,e);this.toggleShowAll=()=>{this.showAll=!this.showAll};this.label=undefined;this.remarks=undefined;this.maxVisibleItems=3;this.showAll=false}render(){if(!this.remarks){return null}const t=this.showAll?this.remarks:this.remarks.slice(0,this.maxVisibleItems);return i(s,null,i("strong",null,this.label),i("ul",null,t.map(((e,s)=>i("li",{key:N()},"- ",e.statement," ",this.remarks.length>this.maxVisibleItems&&s===t.length-1&&i("button",{onClick:this.toggleShowAll},this.showAll?M.entries.Lcz_ShowLess:M.entries.Lcz_ShowMore))))))}};Vn.style=Gn;export{et as igl_application_info,at as igl_block_dates_view,dt as igl_book_property,bt as igl_book_property_footer,mt as igl_book_property_header,xt as igl_booking_event,Ot as igl_booking_event_hover,It as igl_booking_overview_page,At as igl_booking_room_rate_plan,St as igl_booking_rooms,Yt as igl_cal_body,Pt as igl_cal_footer,Qt as igl_cal_header,ie as igl_date_range,oe as igl_legends,le as igl_pagetwo,de as igl_property_booked_by,be as igl_tba_booking_view,me as igl_tba_category_view,ve as igl_to_be_assigned,bs as igloo_calendar,ms as ir_autocomplete,xs as ir_booking_details,Cs as ir_booking_extra_note,Ts as ir_button,Bs as ir_common,Ns as ir_date_picker,Ls as ir_date_view,zs as ir_dialog,Hs as ir_guest_info,Vs as ir_icon,Ws as ir_icons,Js as ir_input_text,tn as ir_interceptor,nn as ir_label,rn as ir_loading_screen,hn as ir_modal,un as ir_payment_details,mn as ir_pickup,vn as ir_popover,_n as ir_room,On as ir_room_nights,In as ir_select,An as ir_sidebar,Nn as ir_textarea,Ln as ir_title,zn as ir_toast,Hn as ir_tooltip,Vn as ota_label};
//# sourceMappingURL=p-5039f0ff.entry.js.map