{"version":3,"names":["irPriceInputCss","IrPriceInputStyle0","IrPriceInput","constructor","hostRef","this","autoValidate","placeholder","value","required","opts","mask","Number","scale","radix","mapToRadix","normalizeZeros","padFractionalZeros","thousandsSeparator","handleInputChange","validateInput","handleBlur","numValue","parseFloat","toFixed","inputBlur","emit","handleFocus","inputFocus","componentWillLoad","el","id","v4","componentDidLoad","initializeMask","maskOpts","Object","assign","minValue","undefined","maxValue","IMask","inputRef","on","isEmpty","trim","unmaskedValue","textChange","hasSpecialClass","className","classList","contains","zod","parse","wrapKey","error","console","log","render","h","key","class","label","labelStyle","htmlFor","currency","disabled","ref","testId","inputStyle","onInput","onBlur","onFocus","type","readOnly","_a","ariaLabel","_b","ariaDescription"],"sources":["src/components/ui/ir-price-input/ir-price-input.css?tag=ir-price-input&encapsulation=scoped","src/components/ui/ir-price-input/ir-price-input.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  --ir-input-border-color: #cacfe7;\r\n  flex: 1 1 0%;\r\n}\r\n\r\n:host .input-group-text {\r\n  border-color: var(--ir-input-border-color);\r\n}\r\n:host .form-control,\r\n.currency-label {\r\n  font-size: 14px !important;\r\n}\r\n\r\n.ir-bl-lbl-none,\r\n.ir-bl-input-none {\r\n  border-top-left-radius: 0 !important;\r\n  border-bottom-left-radius: 0 !important;\r\n}\r\n.rate-input:read-only {\r\n  background: white !important;\r\n}\r\n.ir-br-lbl-none,\r\n.ir-br-input-none {\r\n  border-top-right-radius: 0 !important;\r\n  border-bottom-right-radius: 0 !important;\r\n}\r\n.ir-br-none {\r\n  border-right: none;\r\n}\r\n.ir-bl-none {\r\n  border-left: none;\r\n}\r\n\r\n.rate-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  box-sizing: border-box;\r\n  flex: 1;\r\n  padding: 0 !important;\r\n}\r\n:host([class='special-style']) .rate-input {\r\n  background: black !important;\r\n}\r\n.rate-input {\r\n  font-size: 0.875rem;\r\n  line-height: 0;\r\n  padding: 0;\r\n  height: 0;\r\n  box-sizing: border-box;\r\n  border-left: 0;\r\n  padding-left: 0px !important;\r\n  border-top-left-radius: 0 !important;\r\n  border-bottom-left-radius: 0 !important;\r\n}\r\n\r\n.currency-label.with-label {\r\n  border-radius: 0;\r\n}\r\n\r\n.currency-label {\r\n  box-sizing: border-box;\r\n  color: #3b4781;\r\n  border: 1px solid #cacfe7;\r\n  font-size: 0.875rem;\r\n  height: 2rem;\r\n  background: white;\r\n  border-right: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  pointer-events: none;\r\n  transition: border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\r\n}\r\n.currency-label.disabled,\r\n.rate-input:disabled {\r\n  background-color: #eceff1;\r\n  border-color: rgba(118, 118, 118, 0.3);\r\n}\r\n\r\n.price-input-group:focus-within .currency-label {\r\n  border-top: 1px solid #1e9ff2;\r\n  border-bottom: 1px solid #1e9ff2;\r\n  border-left: 1px solid #1e9ff2;\r\n}\r\n:host([data-state='error']) .currency-label,\r\n:host([data-state='error']) .rate-input,\r\n.error {\r\n  border-color: var(--red, #ff4961) !important;\r\n}\r\n.price-input:focus {\r\n  border-right-width: 1px !important;\r\n}\r\n\r\n.is-invalid {\r\n  background-image: none !important;\r\n}\r\n","import { Component, Element, Event, EventEmitter, Prop, State, h } from '@stencil/core';\r\nimport { v4 } from 'uuid';\r\nimport { ZodType } from 'zod';\r\nimport IMask, { InputMask } from 'imask';\r\n@Component({\r\n  tag: 'ir-price-input',\r\n  styleUrl: 'ir-price-input.css',\r\n  scoped: true,\r\n})\r\nexport class IrPriceInput {\r\n  @Element() el: HTMLIrPriceInputElement;\r\n\r\n  /** The label for the input, optional */\r\n  @Prop() label?: string;\r\n  /** The readonly for the input, optional */\r\n  @Prop() readOnly?: boolean;\r\n\r\n  /** Extra classnames for the input, optional */\r\n  @Prop() inputStyle?: string;\r\n\r\n  /** Extra classnames for the label, optional */\r\n  @Prop() labelStyle?: string;\r\n\r\n  /** The disabled for the input, optional */\r\n  @Prop() disabled?: boolean;\r\n\r\n  /** The Currency for the input, optional */\r\n  @Prop() currency?: string;\r\n\r\n  /** The AutoValidate for the input, optional */\r\n  @Prop() autoValidate?: boolean = true;\r\n\r\n  /** Indicates the key to wrap the value (e.g., 'price' or 'cost') */\r\n  @Prop() wrapKey?: string;\r\n\r\n  /**\r\n   * A Zod schema for validating the input\r\n   * Example: z.coerce.number()\r\n   */\r\n  @Prop() zod?: ZodType<any, any>;\r\n\r\n  /** Placeholder text for the input */\r\n  @Prop() placeholder: string = '';\r\n\r\n  /** Initial value for the input */\r\n  @Prop({ mutable: true }) value: string = '';\r\n\r\n  /** Whether the input is required */\r\n  @Prop() required: boolean = false;\r\n\r\n  /** Minimum value for the price */\r\n  @Prop() minValue?: number;\r\n\r\n  /** Maximum value for the price */\r\n  @Prop() maxValue?: number;\r\n\r\n  /** Unique id for testing */\r\n  @Prop() testId?: string;\r\n\r\n  /** Error*/\r\n  @State() error: boolean;\r\n\r\n  /** Emits the current value on change */\r\n  @Event() textChange: EventEmitter<string>;\r\n\r\n  /** Emits the current value on blur */\r\n  @Event() inputBlur: EventEmitter<string>;\r\n\r\n  /** Emits the current value on focus */\r\n  @Event() inputFocus: EventEmitter<void>;\r\n\r\n  private id: string;\r\n\r\n  private opts = {\r\n    mask: Number,\r\n    scale: 2,\r\n    radix: '.',\r\n    mapToRadix: [','],\r\n    normalizeZeros: true,\r\n    padFractionalZeros: true,\r\n    thousandsSeparator: ',',\r\n  };\r\n  private mask: InputMask<any>;\r\n  private inputRef: HTMLInputElement;\r\n\r\n  componentWillLoad() {\r\n    if (this.el.id) {\r\n      this.id = this.el.id;\r\n    } else {\r\n      this.id = v4();\r\n    }\r\n  }\r\n\r\n  componentDidLoad() {\r\n    if (!this.mask) {\r\n      this.initializeMask();\r\n    }\r\n  }\r\n\r\n  private initializeMask() {\r\n    // Create options object with min/max if provided\r\n    const maskOpts = {\r\n      ...this.opts,\r\n    };\r\n\r\n    if (this.minValue !== undefined) {\r\n      maskOpts['min'] = this.minValue;\r\n    }\r\n\r\n    if (this.maxValue !== undefined) {\r\n      maskOpts['max'] = this.maxValue;\r\n    }\r\n\r\n    this.mask = IMask(this.inputRef, maskOpts);\r\n\r\n    // Set initial value if provided\r\n    if (this.value) {\r\n      this.mask.value = this.value;\r\n    }\r\n\r\n    this.mask.on('accept', () => {\r\n      const isEmpty = this.inputRef.value.trim() === '' || this.mask.unmaskedValue === '';\r\n      if (isEmpty) {\r\n        this.value = '';\r\n        this.textChange.emit(null);\r\n      } else {\r\n        this.value = this.mask.unmaskedValue;\r\n        this.textChange.emit(this.value);\r\n      }\r\n    });\r\n  }\r\n\r\n  private hasSpecialClass(className: string): boolean {\r\n    return this.el.classList.contains(className);\r\n  }\r\n\r\n  private validateInput(value: string): void {\r\n    if (!this.autoValidate) {\r\n      return;\r\n    }\r\n    if (this.zod) {\r\n      try {\r\n        this.zod.parse(this.wrapKey ? { [this.wrapKey]: value } : value); // Validate the value using the Zod schema\r\n        this.error = false; // Clear the error if valid\r\n      } catch (error) {\r\n        console.log(error);\r\n        this.error = true; // Set the error message\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleInputChange = (): void => {\r\n    // The value is already being updated by the mask's 'accept' event\r\n    // Just validate here if needed\r\n    this.validateInput(this.value);\r\n  };\r\n\r\n  private handleBlur = (): void => {\r\n    this.validateInput(this.value);\r\n\r\n    // Format to 2 decimal places on blur\r\n    if (this.value) {\r\n      const numValue = parseFloat(this.value);\r\n      this.value = numValue.toFixed(2);\r\n\r\n      // Update the mask value to show the formatted value\r\n      if (this.mask) {\r\n        this.mask.value = this.value;\r\n      }\r\n    }\r\n\r\n    // Emit the blur event\r\n    this.inputBlur.emit(this.value);\r\n  };\r\n\r\n  private handleFocus = (): void => {\r\n    // Emit the focus event\r\n    this.inputFocus.emit();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <fieldset class=\"input-group price-input-group m-0 p-0\">\r\n        {this.label && (\r\n          <div class=\"input-group-prepend\">\r\n            <span\r\n              class={`input-group-text \r\n                ${this.labelStyle}\r\n              ${this.hasSpecialClass('ir-bl-lbl-none') ? 'ir-bl-lbl-none' : ''}\r\n              ${this.hasSpecialClass('ir-br-lbl-none') ? 'ir-br-lbl-none' : ''}\r\n              ${this.hasSpecialClass('ir-br-none') ? 'ir-br-none' : ''} \r\n              ${this.hasSpecialClass('ir-bl-none') ? 'ir-bl-none' : ''} \r\n              `}\r\n            >\r\n              <label class={'p-0 m-0 '} htmlFor={this.id}>\r\n                {this.label}\r\n              </label>\r\n            </span>\r\n          </div>\r\n        )}\r\n        <div class=\"position-relative has-icon-left rate-input-container\">\r\n          {this.currency && (\r\n            <div class={`input-group-prepend`}>\r\n              <span class={`input-group-text ${this.disabled ? 'disabled' : ''} currency-label ${this.error ? 'error' : ''} ${this.label ? 'with-label' : ''}`}>\r\n                {this.currency}\r\n              </span>\r\n            </div>\r\n          )}\r\n          <input\r\n            ref={el => (this.inputRef = el)}\r\n            data-testid={this.testId}\r\n            disabled={this.disabled}\r\n            id={this.id}\r\n            class={`form-control input-sm rate-input \r\n              ${this.inputStyle}\r\n              ${this.hasSpecialClass('ir-br-input-none') ? 'ir-br-input-none' : ''} \r\n              ${this.hasSpecialClass('ir-bl-input-none') ? 'ir-bl-input-none' : ''} \r\n              ${this.error ? 'error' : ''} py-0 m-0 ${this.currency ? 'ir-bl-none' : ''}`}\r\n            onInput={this.handleInputChange}\r\n            onBlur={this.handleBlur}\r\n            onFocus={this.handleFocus}\r\n            type=\"text\"\r\n            placeholder={this.placeholder}\r\n            readOnly={this.readOnly}\r\n            aria-label={this.el.ariaLabel ?? 'price-input'}\r\n            aria-describedby={this.el.ariaDescription ?? 'price-input'}\r\n          />\r\n        </div>\r\n      </fieldset>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}