import{r as t,c as e,h as i,F as s,H as a,g as o}from"./p-ee49d535.js";import{B as n}from"./p-3ad7e14a.js";import{d as r,k as l,o as h,u as d}from"./p-e1656223.js";import{t as c,g as f,f as b}from"./p-0d7b0fa2.js";import{E as p}from"./p-01b55a0b.js";import{l as u}from"./p-806fad31.js";import{c as m}from"./p-6bab2172.js";import{i as g}from"./p-c71f0e9e.js";import{c as y}from"./p-ac6e77ff.js";import{a as k,_ as v,b as _}from"./p-b2679b77.js";import{h as x}from"./p-6c4ba7c0.js";import{P as w}from"./p-24cdb067.js";import{a as D}from"./p-06203439.js";import"./p-b364a44f.js";import"./p-4eb12235.js";class O{setBookingInfoFromAutoComplete(t,e){t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:e.guest.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,a){let o=e;const{data:n,key:r,changedKey:l}=t.detail;const h=`c_${n.roomCategoryId}`;const d=`p_${n.ratePlanId}`;if(this.shouldClearData(r)){o=new Map}this.initializeRoomCategoryIfNeeded(h,o);if(s){if(l==="rate"){if(o.has(h)&&o.get(h).has(d)){this.applyBookingEditToSelectedRoom(h,d,n,o,a,i)}}else{if(l!=="rateType"){if(l==="adult_child_offering"){if(o.has(h)&&e.get(h).has(d)){this.applyBookingEditToSelectedRoom(h,d,n,o,a,i)}}else{this.applyBookingEditToSelectedRoom(h,d,n,o,a,i)}}}}else{this.setSelectedRoomData(h,d,n,o)}this.cleanupEmptyData(h,o);return o}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let a=s.get(t);if(i.totalRooms===0||i.inventory===0){a.delete(e)}else{s.set(t,a.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,a,o){s.clear();let n={};if(o){n=Object.assign(Object.assign({},i),{guestName:a||"",roomId:""})}else{n=Object.assign({},i)}s.set(t,(new Map).set(e,n))}async prepareBookUserServiceParams(t,e,i){try{const s=t.isEventType("EDIT_BOOKING")?t.getArrivalTimeForBooking():t.isEventType("ADD_ROOM")?t.bookingData.ARRIVAL.code:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.selectedArrivalTime.code:"";const a=t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:undefined;const o=t.isEventType("EDIT_BOOKING")||t.isEventType("ADD_ROOM")?t.bookingData.BOOKING_NUMBER:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.bookingNumber:undefined;let n=[];if(t.isEventType("ADD_ROOM")){n=t.bookingData.ROOMS}else if(t.isEventType("SPLIT_BOOKING")){n=t.bookedByInfoData.rooms}else if(t.isEventType("EDIT_BOOKING")){n=t.defaultData.ROOMS.filter((e=>e.identifier!==t.bookingData.IDENTIFIER))}return{bookedByInfoData:t.bookedByInfoData,check_in:e,fromDate:new Date(t.dateRangeData.fromDate),toDate:new Date(t.dateRangeData.toDate),guestData:t.guestData,totalNights:t.dateRangeData.dateDifference,source:i,propertyid:t.propertyid,rooms:n,pickup_info:t.bookingData.PICKUP_INFO||null,currency:t.currency,bookingNumber:o,defaultGuest:t.bookingData.GUEST,arrivalTime:s,pr_id:a,identifier:t.bookingData.IDENTIFIER,extras:null}}catch(t){console.error(t)}}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const a=`p_${t.RATE_PLAN_ID}`;const o={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(a,o))}}const C=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto;padding-bottom:85px !important}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.row.sc-igl-book-property{padding:0 0 0 15px;margin:0}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}";const I=C;const T=class{constructor(i){t(this,i);this.closeBookingWindow=e(this,"closeBookingWindow",7);this.bookingCreated=e(this,"bookingCreated",7);this.blockedCreated=e(this,"blockedCreated",7);this.resetBookingData=e(this,"resetBookingData",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.toast=e(this,"toast",7);this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new n;this.bookPropertyService=new O;this.eventsService=new p;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.buttonName=""}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}else return}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();const{key:e,data:i}=t.detail;if(e==="select"){const t=await this.bookingService.getExposedBooking(i.booking_nbr,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}else if(e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}async componentWillLoad(){this.bookingService.setToken(m.token);this.eventsService.setToken(m.token);this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE};this.handleKeyDown=this.handleKeyDown.bind(this);if(!this.bookingData.defaultDateRange){return}this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange);try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);if(this.isEventType("EDIT_BOOKING")){this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}if(this.defaultData.event_type==="SPLIT_BOOKING"){this.showSplitBookingOption=true;this.page="page_one"}else if(this.defaultData.event_type==="BLOCK_DATES"){this.page="page_block_date"}else{this.page="page_one"}}catch(t){console.error("Error fetching setup entries:",t)}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){if(this.guestData.length===0){return true}for(const t of this.guestData){if(t.guestName===""||(t.preference===""||t.preference===0)&&t.is_bed_configuration_enabled){return true}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.id,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag,type:t[0].type,id:t[0].id}}}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.adultChildCount=Object.assign({},t.detail)}async initializeBookingAvailability(t,e){const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.defaultData.roomsInfo.map((t=>t.id));const a=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:s,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:a.roomtypes})}catch(t){}}getRoomCategoryByRoomId(t){var e;return(e=this.defaultData.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.physicalrooms.find((e=>e.id===+t))))}getSplitBookings(){return this.defaultData.hasOwnProperty("splitBookingEvents")&&this.defaultData.splitBookingEvents||[]}closeWindow(){this.dateRangeData={};this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.initializeBookingAvailability(r(new Date(this.dateRangeData.fromDate)),r(new Date(this.dateRangeData.toDate)))}}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}renderPage(){this.renderAgain=!this.renderAgain}gotoSplitPageTwo(){this.gotoPage("page_two")}gotoPage(t){this.page=t;this.renderPage()}showSplitBooking(){this.showSplitBookingOption=true;this.gotoPage("page_one")}getPageBlockDatesView(){return i(s,null,i("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),i("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},i("ir-button",{text:u.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),i("ir-button",{text:u.entries.Lcz_Blockdates,isLoading:g("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})))}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);this.buttonName="book";break;case"bookAndCheckIn":this.bookUser(true);this.buttonName="bookAndCheckIn";break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(this.selectedUnits.size>0){this.gotoPage("page_two");break}else{if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}}this.toast.emit({type:"error",description:u.entries.Lcz_SelectRatePlan,title:u.entries.Lcz_SelectRatePlan});break;case"check":this.initializeBookingAvailability(r(new Date(this.dateRangeData.fromDate)),r(new Date(this.dateRangeData.toDate)));break}}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(){const t=l(+this.blockDatesData.RELEASE_AFTER_HOURS);const e=await this.bookingService.blockUnit(Object.assign({from_date:r(this.defaultData.defaultDateRange.fromDate),to_date:r(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t));const i=await c(e);this.blockedCreated.emit(i);this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else{console.log(this.isButtonDisabled());if(this.isButtonDisabled()){this.isLoading="";return}}try{if(["003","002","004"].includes(this.defaultData.STATUS_CODE)){this.eventsService.deleteEvent(this.defaultData.POOL)}if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}const e=await this.bookPropertyService.prepareBookUserServiceParams(this,t,this.sourceOption);await this.bookingService.bookUser(e);this.resetBookingData.emit(null)}catch(t){}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}getArrivalTimeForBooking(){return this.bookedByInfoData.arrivalTime.find((t=>t.CODE_VALUE_EN===this.defaultData.ARRIVAL_TIME)).CODE_NAME}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}onRoomDataUpdate(t){const e=this.bookPropertyService.onDataRoomUpdate(t,this.selectedUnits,this.isEventType("EDIT_BOOKING"),this.isEventType("EDIT_BOOKING")||this.isEventType("SPLIT_BOOKING")||this.isEventType("BAR_BOOKING"),this.defaultData.NAME);this.selectedUnits=new Map(e);this.renderPage()}getCurrentPage(t){return this.page===t}render(){return i(a,{key:"dd8eda0235f7ec815394e9173a5194fa64c6f6d6"},i("div",{key:"9ad954d7307bcb1361b3d89c09b5f298892c6298",class:"background-overlay",onClick:()=>this.closeWindow()}),i("div",{key:"906e4774cddac4795b9c74f4f50795e5b3e548d8",class:"sideWindow pb-5 pb-md-0 "+(this.getCurrentPage("page_block_date")?"block-date":"")},i("div",{key:"72f421ed5736277e2a39ffdf97cc87f2f9d85d18",class:"card position-sticky mb-0 shadow-none p-0 "},i("div",{key:"49e9bc0026340a568975361b1353a6ebd5450a9a",class:"card-header-container mb-2"},i("h3",{key:"f121cc4396fdb964754c7cfee4244a764c6e7fc1",class:" text-left font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),i("ir-icon",{key:"1e7952b3f26e8d545794f5c78211e8449037b5a3",class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},i("svg",{key:"e5d73fb81d45779a528c8e3b362e72f656855a64",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"871bdcb30ab9373119b376634a8d9aede3648925",fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{key:"470fe3bb68c225e1193eeb5bc3423b9af8b707c5",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&i("igl-booking-overview-page",{key:"d087cde0c3582bcb988d79d62b0e150069ad531c",initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,onRoomsDataUpdate:t=>{this.onRoomDataUpdate(t)},sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&i("igl-pagetwo",{key:"85fb78f81612922d50fc735005aef74b0565ebac",currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};T.style=I;const B=".sc-ir-booking-extra-note-h{display:block}";const S=B;const N=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new n;this.booking=undefined;this.isLoading=false;this.note=""}componentWillLoad(){this.bookingService.setToken(m.token);if(this.booking.extras){this.setNote(f(this.booking.extras))}}setNote(t){this.note=t}async savePrivateNote(){try{this.isLoading=true;let t=this.booking.extras||[];const e={key:"private_note",value:this.note};if(t.length===0){t.push(e)}else{const i=t.findIndex((t=>t.key==="private_note"));if(i===-1){t.push(e)}else{t[i]=e}}const i=await this.bookingService.doReservation({assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,booking:this.booking,Is_Non_Technical_Change:true,extras:t});this.resetBookingData.emit(i);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return i(a,{key:"deef0d543272c93a43b014910997c6a6dc006413",class:"px-0"},i("ir-title",{key:"f7782be78c17be16b439f2fc8695948a47c1feff",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:u.entries.Lcz_PrivateNote,displayContext:"sidebar"}),i("form",{key:"42ca14787664b3ed48dabb81d85694f86bbb85dc",class:"px-1",onSubmit:t=>{t.preventDefault();this.savePrivateNote()}},i("ir-textarea",{key:"fdda794d49cbede6385fb7eb5a27bf32beecffcb",placeholder:u.entries.Lcz_PrivateNote_MaxChar,label:"",value:this.note,maxLength:150,onTextChange:t=>this.setNote(t.detail)}),i("div",{key:"bbb94a7d3cd5a9556415cfb303956f552b1993d2",class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{key:"0f3368b0caaf74361cf18eb7a121541832d526cb",onClickHanlder:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`,icon:"",text:u.entries.Lcz_Cancel,btn_color:"secondary"}),i("ir-button",{key:"c7d6b5b5bdc6c9bde44dd4fa3a84d98d93485dc9",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center ml-sm-1",icon:"",isLoading:this.isLoading,text:u.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"}))))}};N.style=S;const E=":host{display:block;margin:0;padding:0;box-sizing:border-box}.backdrop{opacity:0;background:rgba(0, 0, 0, 0.2);position:fixed;inset:0;z-index:99999998}.backdrop[data-state='opened']{animation:overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards}.backdrop[data-state='closed']{opacity:0;pointer-events:none}.modal-container{box-sizing:border-box;margin:0;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;position:fixed;z-index:99999999;overflow-y:auto;top:50%;left:50%;background:white;transform:translate(-50%, -50%);width:90%;min-height:fit-content;height:fit-content;max-width:var(--ir-dialog-max-width, 40rem);max-height:85vh;border-radius:8px;padding:0;animation:contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1)}.modal-footer ::slotted(*){flex-direction:row;align-items:center;justify-content:end;gap:8px;--ir-btn-width:inherit}.modal-footer{--ir-btn-width:100%}.modal-title ::slotted(*){font-size:18px;font-weight:600;color:#101828;margin-bottom:8px}.modal-body ::slotted(*){font-size:14px;font-weight:400;color:#475467;padding:0;margin:0}@keyframes overlayShow{from{opacity:0}to{opacity:1}}@keyframes contentShow{from{opacity:0;transform:translate(-50%, -48%) scale(0.96)}to{opacity:1;transform:translate(-50%, -50%) scale(1)}}.dialog-close-button{position:absolute;top:15px;right:15px}";const j=E;const L=class{constructor(i){t(this,i);this.openChange=e(this,"openChange",7);this.open=false;this.isOpen=false}componentWillLoad(){if(this.open){this.openModal()}}componentDidLoad(){this.prepareFocusTrap()}async openModal(){this.isOpen=true;document.body.style.overflow="hidden";setTimeout((()=>{this.prepareFocusTrap()}),10);this.openChange.emit(this.isOpen)}async closeModal(){console.log("close");if(!this.isOpen){return}document.body.style.overflow="visible";this.isOpen=false;this.openChange.emit(this.isOpen)}handleOpenChange(){if(this.open){this.openModal()}else{this.closeModal()}}prepareFocusTrap(){const t='button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';const e=this.el.shadowRoot.querySelectorAll(t);if(e.length===0)return;this.firstFocusableElement=e[0];this.lastFocusableElement=e[e.length-1];this.firstFocusableElement.focus()}handleKeyDown(t){if(!this.isOpen){return}let e=t.key==="Tab";if(t.key==="Escape"&&this.isOpen){this.closeModal()}if(!e){return}if(!t.shiftKey&&document.activeElement===this.lastFocusableElement){this.firstFocusableElement.focus();t.preventDefault()}if(t.shiftKey&&document.activeElement===this.firstFocusableElement){this.lastFocusableElement.focus();t.preventDefault()}}disconnectedCallback(){document.body.style.overflow="visible"}render(){return i(a,{key:"08a4013a5f9379252fafdba5b7839ed446460853"},i("div",{key:"a9528d6113dd7bb9afc88568b838f9236db6d8c4",class:"backdrop","data-state":this.isOpen?"opened":"closed",onClick:()=>this.closeModal()}),this.isOpen&&i("div",{key:"285d35578417c7e8adee7608e6fde41e10beedf3",class:"modal-container",tabIndex:-1,role:"dialog","aria-labelledby":"dialog1Title","aria-describedby":"dialog1Desc"},i("ir-icon",{key:"e9b0ad823cce979395ab2e4e4fa0fe04e125298d",id:"close",class:"dialog-close-button",onIconClickHandler:()=>this.closeModal()},i("svg",{key:"caa6d3d43f9d2d28743bb48bdcd39304cbfc9c01",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:18,width:18},i("path",{key:"0a885b0f7809dad2a5e43bc99907d7f1c95c41c3",fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("div",{key:"f1e46107dc228a9ce41dfbbcb1eee49148f6dd71",class:"modal-title",id:"dialog1Title"},i("slot",{key:"596d4ac5df2a2e99357cecf1a6339dbe41ab0b90",name:"modal-title"})),i("div",{key:"16847a59b09191130a4539205d8a092f4ad9251d",class:"modal-body",id:"dialog1Desc"},i("slot",{key:"3dca97cb8bdb78e9958f4bb356fe11f6d57fc9b7",name:"modal-body"})),i("div",{key:"b3a74d7eec1c3b64eaa81240b44d5ae3c5e65b56",class:"modal-footer"},i("slot",{key:"71224ae00ce572df9981785957097468c3d1af47",name:"modal-footer"}))))}get el(){return o(this)}static get watchers(){return{open:["handleOpenChange"]}}};L.style=j;const A=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}";const M=A;const R=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new n;this.setupDataCountries=null;this.setupDataCountriesCode=null;this.defaultTexts=undefined;this.language=undefined;this.email=undefined;this.booking_nbr=undefined;this.countries=undefined;this.submit=false;this.guest=null;this.isLoading=false}async componentWillLoad(){this.bookingService.setToken(m.token);await this.init()}async init(){try{const[t,e]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language)]);this.countries=e;this.guest=t}catch(t){console.log(t)}}handleInputChange(t,e){this.guest=Object.assign(Object.assign({},this.guest),{[t]:e})}async editGuest(){try{this.isLoading=true;await this.bookingService.editExposedGuest(this.guest,this.booking_nbr);this.closeSideBar.emit(null);this.resetBookingData.emit(null)}catch(t){console.log(t)}finally{this.isLoading=false;console.log("done")}}render(){var t,e,s,a,o,n;if(!this.guest){return null}return[i("div",{class:"p-0"},i("div",{class:"position-sticky mb-1 shadow-none p-0"},i("div",{class:"d-flex align-items-center justify-content-between ir-card-header py-1 p-0"},i("h3",{class:"card-title text-left font-medium-2 px-1 my-0"},this.defaultTexts.entries.Lcz_GuestDetails),i("ir-icon",{class:"close close-icon px-1",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{class:"card-content collapse show"},i("div",{class:"card-body pt-0 px-1"},i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_FirstName,name:"firstName",submited:this.submit,value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:t=>this.handleInputChange("first_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_LastName,name:"lastName",submited:this.submit,value:(e=this.guest)===null||e===void 0?void 0:e.last_name,required:true,onTextChange:t=>this.handleInputChange("last_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Email,name:"email",submited:this.submit,value:(s=this.guest)===null||s===void 0?void 0:s.email,required:true,onTextChange:t=>this.handleInputChange("email",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_AlternativeEmail,name:"altEmail",value:(a=this.guest)===null||a===void 0?void 0:a.alternative_email,onTextChange:t=>this.handleInputChange("alternative_email",t.detail)}),i("ir-select",{selectContainerStyle:"mb-1",required:true,name:"country",submited:this.submit,label:this.defaultTexts.entries.Lcz_Country,selectedValue:(n=(o=this.guest.country_id)===null||o===void 0?void 0:o.toString())!==null&&n!==void 0?n:"",data:this.countries.map((t=>({value:t.id.toString(),text:t.name}))),firstOption:"...",onSelectChange:t=>this.handleInputChange("country_id",t.detail)}),i("div",{class:"form-group mr-0"},i("div",{class:"input-group row m-0 p-0"},i("div",{class:`input-group-prepend col-3 p-0 text-dark border-none`},i("label",{class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.defaultTexts.entries.Lcz_MobilePhone,"*")),i("select",{class:` form-control text-md  col-2 py-0 mobilePrefixSelect`,onInput:t=>this.handleInputChange("country_phone_prefix",t.target.value),required:true},i("option",{value:null},"..."),this.countries.map((t=>{var e;return i("option",{selected:((e=this.guest.country_phone_prefix)===null||e===void 0?void 0:e.toString())===t.phone_prefix.toString(),value:t.phone_prefix},t.phone_prefix)}))),i("input",{type:"text",required:true,value:this.guest.mobile,class:"form-control flex-fill mobilePrefixInput",onInput:t=>this.handleInputChange("mobile",t.target.value)}))),i("div",{class:"p-0 m-0"},i("label",{class:`check-container m-0 p-0`},i("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange("subscribe_to_news_letter",t.target.checked)}),i("span",{class:"checkmark m-0 p-0"}),i("span",{class:"m-0 p-0  check-label"},this.defaultTexts.entries.Lcz_Newsletter))),i("hr",null),i("ir-button",{isLoading:this.isLoading,btn_disabled:this.isLoading,btn_styles:"d-flex align-items-center justify-content-center",text:this.defaultTexts.entries.Lcz_Save,onClickHanlder:this.editGuest.bind(this),color:"btn-primary"}))))]}};R.style=M;const P=".logo.sc-ir-label{height:1.5rem;width:1.5rem}.sc-ir-label-h{display:flex;margin-bottom:5px;gap:5px;align-items:center}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}.label_message.sc-ir-label{margin:0 3px;padding:0}.label_title.sc-ir-label{min-width:max-content}.label_placeholder.sc-ir-label{color:#cacfe7;padding:0 !important;margin:0 !important}.icon-container.sc-ir-label{margin:0;padding:0}.country.sc-ir-label{height:16px;width:23px;border-radius:3px}svg.sc-ir-label{margin:0;padding:0}";const G=P;const Y=class{constructor(i){t(this,i);this.editSidebar=e(this,"editSidebar",7);this.label=undefined;this.value=undefined;this.iconShown=false;this.image=undefined;this.country=false;this.imageStyle="";this.icon_name="edit";this.icon_style=undefined;this.ignore_value=false;this.placeholder=undefined}openEditSidebar(){this.editSidebar.emit()}render(){if(!this.placeholder&&!this.value&&!this.ignore_value){return null}return i(a,{class:this.image?"align-items-center":""},i("strong",{class:"label_title"},this.label),this.image&&i("img",{src:this.image.src,class:`p-0 m-0 ${this.country?"country":"logo"} ${this.image.style}`,alt:this.image.src}),this.value?i("p",{class:"label_message"},this.value):i("p",{class:"label_placeholder"},this.placeholder),this.iconShown&&i("div",{class:"icon-container"},i("ir-button",{variant:"icon",icon_name:this.icon_name,style:Object.assign(Object.assign({},y.secondary),{"--icon-size":"1.1rem"}),onClickHanlder:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openEditSidebar()}})))}};Y.style=G;const z=".sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}.total-cost-container.sc-ir-payment-details{background:#7cbebe;color:white;padding:0.5rem;border-radius:5px}.payment-actions.sc-ir-payment-details{display:flex;align-items:center;justify-content:center;height:100%;gap:0.5rem}";const $=z;const K=class{constructor(i){t(this,i);this.resetBookingData=e(this,"resetBookingData",7);this.resetExposedCancelationDueAmount=e(this,"resetExposedCancelationDueAmount",7);this.toast=e(this,"toast",7);this.paymentService=new w;this.bookingService=new n;this.paymentBackground="white";this.bookingDetails=undefined;this.defaultTexts=undefined;this.paymentActions=undefined;this.newTableRow=false;this.collapsedPayment=false;this.collapsedGuarantee=false;this.flag=false;this.confirmModal=false;this.toBeDeletedItem=undefined;this.paymentDetailsUrl="";this.paymentExceptionMessage="";this.modal_mode=null;this.itemToBeAdded=undefined}handlePaymentGeneration(t){const e=t.detail;this.newTableRow=true;this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{amount:e.amount,date:e.due_on});this.paymentBackground="rgba(250, 253, 174)"}async componentWillLoad(){try{this.paymentService.setToken(m.token);this.bookingService.setToken(m.token);this.initializeItemToBeAdded()}catch(t){if(this.bookingDetails.guest.cci){return}if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentExceptionMessage=t}}}initializeItemToBeAdded(){this.itemToBeAdded={id:-1,date:x().format("YYYY-MM-DD"),amount:null,currency:this.bookingDetails.currency,designation:"",reference:""};this.paymentBackground="white"}async _processPaymentSave(){if(this.itemToBeAdded.amount===null){this.toast.emit({type:"error",title:this.defaultTexts.entries.Lcz_EnterAmount,description:"",position:"top-right"});return}if(Number(this.itemToBeAdded.amount)>Number(this.bookingDetails.financial.due_amount)){this.modal_mode="save";this.openModal();return}this._handleSave()}async _handleSave(){this.paymentBackground="white";try{await this.paymentService.AddPayment(this.itemToBeAdded,this.bookingDetails.booking_nbr);this.initializeItemToBeAdded();this.resetBookingData.emit(null);this.resetExposedCancelationDueAmount.emit(null)}catch(t){console.log(t)}}handlePaymentInputChange(t,e,i){this.paymentBackground="white";if(t==="amount"){if(!isNaN(e)||e===""){if(e===""){this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:null})}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:parseFloat(e)})}}else if(i&&i.target){let t=i.target;let e=t.value;e=e.replace(/[^\d-]|(?<!^)-/g,"");t.value=e}}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:e})}}async cancelPayment(){try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.bookingDetails.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.bookingDetails=Object.assign(Object.assign({},this.bookingDetails),{financial:Object.assign(Object.assign({},this.bookingDetails.financial),{payments:t})});this.confirmModal=!this.confirmModal;this.resetBookingData.emit(null);this.resetExposedCancelationDueAmount.emit(null);this.toBeDeletedItem=null;this.modal_mode=null}catch(t){console.log(t)}}async handleConfirmModal(t){this.paymentBackground="white";t.stopImmediatePropagation();t.stopPropagation();if(this.modal_mode==="delete"){await this.cancelPayment()}else{await this._handleSave()}}openModal(){const t=document.querySelector(".delete-record-modal");t.openModal()}async handleCancelModal(t){t.stopImmediatePropagation();t.stopPropagation();try{this.paymentBackground="white";if(this.modal_mode==="save"){this.initializeItemToBeAdded()}}catch(t){console.log(t)}}handleBookingDetails(){if(this.newTableRow){this.newTableRow=false}}handleDateChange(t){this.handlePaymentInputChange("date",t.detail.end.format("YYYY-MM-DD"))}_renderTableRow(t,e="normal"){var a,o;return i(s,null,i("tr",null,i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},k(t.date)):i("ir-date-picker",{date:((a=this.itemToBeAdded)===null||a===void 0?void 0:a.date)?new Date(this.itemToBeAdded.date):new Date,minDate:x().add(-2,"months").startOf("month").format("YYYY-MM-DD"),singleDatePicker:true,autoApply:true,onDateChanged:this.handleDateChange.bind(this)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center "},e==="normal"?i("span",{class:"sm-padding-right"},h(this.bookingDetails.currency.symbol,t.amount)):i("input",{type:"text",class:"border-0 text-center form-control py-0 m-0 w-100",value:this.itemToBeAdded.amount,onBlur:t=>{t.target.value=Number(this.itemToBeAdded.amount).toFixed(2)},onInput:t=>this.handlePaymentInputChange("amount",+t.target.value,t)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},t.designation):i("input",{class:"border-0 w-100 form-control py-0 m-0",onInput:t=>this.handlePaymentInputChange("designation",t.target.value),type:"text"})),i("td",{rowSpan:2,class:"border payments-height border-light border-bottom-0 text-center"},i("div",{class:"payment-actions"},e==="add"&&i("ir-button",{variant:"icon",icon_name:"save",style:y.secondary,isLoading:e==="add"&&g("/Do_Payment"),class:"m-0",onClickHanlder:()=>{this._processPaymentSave()}}),i("ir-button",{variant:"icon",icon_name:"trash",style:y.danger,isLoading:((o=this.toBeDeletedItem)===null||o===void 0?void 0:o.id)===(t===null||t===void 0?void 0:t.id)&&g("/Cancel_Payment"),onClickHanlder:e==="add"?()=>{this.newTableRow=false;this.initializeItemToBeAdded()}:()=>{this.modal_mode="delete";this.toBeDeletedItem=t;this.openModal()}})))),i("tr",null,i("td",{colSpan:3,class:"border border-light payments-height border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left "},t.reference):i("input",{class:"border-0 w-100  form-control py-0 m-0",onKeyPress:t=>{if(t.key==="Enter"){this.newTableRow=false;this._handleSave()}},onInput:t=>this.handlePaymentInputChange("reference",t.target.value),type:"text"}))))}bookingGuarantee(){var t,e,s,a,o,n,r,l,h,d,c,f,b,p,u,m,g,y,k,v,_,x,w,D,O,C,I,T;if(this.bookingDetails.is_direct&&!this.bookingDetails.guest.cci){return null}return i("div",null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_BookingGuarantee),i("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":`.guarrantee`,"aria-expanded":this.collapsedGuarantee?"true":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",variant:"icon",icon_name:"credit_card",onClickHanlder:async()=>{if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr&&!this.bookingDetails.guest.cci){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.bookingDetails.booking_nbr)}this.collapsedGuarantee=!this.collapsedGuarantee}})),i("div",{class:"collapse guarrantee "},this.bookingDetails.guest.cci?[i("div",null,((e=(t=this.bookingDetails)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.cci)&&"Card:"," ",i("span",null,((o=(a=(s=this.bookingDetails)===null||s===void 0?void 0:s.guest)===null||a===void 0?void 0:a.cci)===null||o===void 0?void 0:o.nbr)||"")," ",((l=(r=(n=this.bookingDetails)===null||n===void 0?void 0:n.guest)===null||r===void 0?void 0:r.cci)===null||l===void 0?void 0:l.expiry_month)&&"Expiry: ",i("span",null," ",((c=(d=(h=this.bookingDetails)===null||h===void 0?void 0:h.guest)===null||d===void 0?void 0:d.cci)===null||c===void 0?void 0:c.expiry_month)||""," ",((p=(b=(f=this.bookingDetails)===null||f===void 0?void 0:f.guest)===null||b===void 0?void 0:b.cci)===null||p===void 0?void 0:p.expiry_year)&&"/"+((g=(m=(u=this.bookingDetails)===null||u===void 0?void 0:u.guest)===null||m===void 0?void 0:m.cci)===null||g===void 0?void 0:g.expiry_year))),i("div",null,((k=(y=this.bookingDetails)===null||y===void 0?void 0:y.guest)===null||k===void 0?void 0:k.cci.holder_name)&&"Name:"," ",i("span",null,((x=(_=(v=this.bookingDetails)===null||v===void 0?void 0:v.guest)===null||_===void 0?void 0:_.cci)===null||x===void 0?void 0:x.holder_name)||"")," ",((O=(D=(w=this.bookingDetails)===null||w===void 0?void 0:w.guest)===null||D===void 0?void 0:D.cci)===null||O===void 0?void 0:O.cvc)&&"- CVC:"," ",i("span",null," ",((T=(I=(C=this.bookingDetails)===null||C===void 0?void 0:C.guest)===null||I===void 0?void 0:I.cci)===null||T===void 0?void 0:T.cvc)||""))]:this.paymentDetailsUrl?i("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"}):i("div",{class:"text-center"},this.paymentExceptionMessage)))}_renderDueDate(t){return i("tr",null,i("td",{class:"pr-1"},k(t.date)),i("td",{class:"pr-1"},h(this.bookingDetails.currency.symbol,t.amount)),i("td",{class:"pr-1"},t.description),i("td",{class:"collapse font-size-small roomName"},t.room))}render(){var t,e,a,o;if(!this.bookingDetails.financial){return null}return[i("div",{class:"card m-0"},i("div",{class:"p-1"},this.bookingDetails.financial.gross_cost>0&&this.bookingDetails.financial.gross_cost!==null&&i("div",{class:"mb-2 h4 total-cost-container"},this.defaultTexts.entries.Lcz_TotalCost,": ",i("span",null,h(this.bookingDetails.currency.symbol,this.bookingDetails.financial.gross_cost))),i("div",{class:" h4"},this.defaultTexts.entries.Lcz_DueBalance,":"," ",i("span",{class:"danger font-weight-bold"},h(this.bookingDetails.currency.symbol,this.bookingDetails.financial.due_amount))),this.bookingGuarantee(),i("div",{class:"mt-2"},i("div",null,((e=(t=this.bookingDetails.financial)===null||t===void 0?void 0:t.due_dates)===null||e===void 0?void 0:e.length)>0&&i(s,null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_PaymentDueDates),i("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":`.roomName`,"aria-expanded":this.collapsedPayment?"true":"false","aria-controls":"myCollapse",variant:"icon",icon_name:this.collapsedPayment?"closed_eye":"open_eye",onClickHanlder:()=>{this.collapsedPayment=!this.collapsedPayment},style:{"--icon-size":"1.5rem"}})),i("table",null,(a=this.bookingDetails.financial.due_dates)===null||a===void 0?void 0:a.map((t=>this._renderDueDate(t))))))),i("div",{class:"mt-2 d-flex  flex-column rounded payment-container"},i("div",{class:"d-flex align-items-center justify-content-between"},i("strong",null,this.defaultTexts.entries.Lcz_Payments," history"),i("ir-button",{id:"add-payment",variant:"icon",icon_name:"square_plus",style:{"--icon-size":"1.5rem"},onClickHanlder:()=>{this.newTableRow=true}})),i("table",{class:"mt-1",style:{backgroundColor:this.paymentBackground}},i("thead",null,i("tr",null,i("th",{class:"border border-light border-bottom-0 text-center payment_date"},this.defaultTexts.entries.Lcz_Dates),i("th",{class:"border border-light border-bottom-0 text-center w-60"},this.defaultTexts.entries.Lcz_Amount),i("th",{class:"border border-light border-bottom-0 text-center designation"},this.defaultTexts.entries.Lcz_Designation),i("th",{class:"border border-light border-bottom-0 text-center action_icons"},i("span",{class:"sr-only"},"payment actions")))),i("tbody",null,(o=this.bookingDetails.financial.payments)===null||o===void 0?void 0:o.map((t=>this._renderTableRow(t))),this.newTableRow?this._renderTableRow(null,"add"):null))))),i("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:this.modal_mode==="delete"?this.defaultTexts.entries.Lcz_IfDeletedPermantlyLost:this.defaultTexts.entries.Lcz_EnteringAmountGreaterThanDue,iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.modal_mode==="delete"?this.defaultTexts.entries.Lcz_Delete:this.defaultTexts.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modal_mode==="delete"?"danger":"primary",onConfirmModal:this.handleConfirmModal.bind(this),onCancelModal:this.handleCancelModal.bind(this)})]}static get watchers(){return{bookingDetails:["handleBookingDetails"]}}};K.style=$;class H{async savePickup(t,e,i){try{const s=t.arrival_time.split(":");await D.post(`/Do_Pickup`,{booking_nbr:e,is_remove:i,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){const e=t.hour&&t.minute?d(t.hour)+":"+d(t.minute):"";return{arrival_date:t.date,arrival_time:e,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let e=[];m.pickup_service.allowed_options.forEach((i=>{if(e.filter((t=>t.value===i.location.id)).length===0){e.push({text:t+" "+i.location.description,value:i.location.id})}}));return e}validateForm(t){if(t.arrival_time.split(":").length!==2){return{error:true,cause:"arrival_time"}}if(t.flight_details===""){return{error:true,cause:"flight_details"}}if(t.vehicle_type_code===""){return{error:true,cause:"vehicle_type_code"}}if(t.number_of_vehicles===0){return{error:true,cause:"number_of_vehicles"}}return{error:false}}getNumberOfVehicles(t,e){let i=Math.ceil(e/t);let s=i>1?i:1;let a=i>1?2:3;return Array.from({length:i+a},((t,e)=>s+e))}getPickUpPersonStatus(t){const e=m.pickup_service.allowed_pricing_models.find((e=>e.code===t));if(!e){return null}return e.description}updateDue(t){const e=this.getPickUpPersonStatus(t.code);if(!e){return}if(e==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const U=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}";const W=U;const F=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.resetBookingData=e(this,"resetBookingData",7);this.pickupService=new H;this.defaultPickupData=undefined;this.numberOfPersons=0;this.bookingNumber=undefined;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:x().format("YYYY-MM-DD"),selected_option:undefined};this.vehicleCapacity=[];this.cause=null}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=m.pickup_service.allowed_options.filter((e=>e.location.id===t.location));this.pickupData=Object.assign({},t)}}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e===""){this.updatePickupData("location",-1)}if(e!==""){this.allowedOptionsByLocation=m.pickup_service.allowed_options.filter((t=>t.location.id.toString()===e));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:e,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency});const i=this.el.querySelector("#pickup-time");if(!i){setTimeout((()=>{this.initializeInputMask()}),100)}}}initializeInputMask(){const t=this.el.querySelector("#pickup-time");if(t){Inputmask("Hh:Mm",{placeholder:"HH:mm",definitions:{H:{validator:"[0-2]"},h:{validator:function(t,e,i){var s=e.buffer[i-1];if(s==="2"){return/[0-3]/.test(t)}else{return/[0-9]/.test(t)}}},M:{validator:"[0-5]"},m:{validator:"[0-9]"}},insertMode:true,showMaskOnHover:false,inputmode:"numeric",alias:"datetime",oncomplete:()=>{this.updatePickupData("arrival_time",t.value)},oncleared:()=>{this.updatePickupData("arrival_time","")},onincomplete:()=>{this.updatePickupData("arrival_time",t.value)}}).mask(t)}}handleVehicleQuantityChange(t){if(t.detail===""){return}const e=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:e,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:e}).toFixed(2)})}componentDidLoad(){if(this.defaultPickupData){this.initializeInputMask()}}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let e=m.pickup_service.allowed_options.find((e=>e.location.id===+this.pickupData.location&&e.vehicle.code===t.detail));if(!e){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code})}updatePickupData(t,e){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:e})}async savePickup(){try{this.isLoading=true;const t=this.pickupService.validateForm(this.pickupData);if(t.error){this.cause=t.cause;return}if(this.cause){this.cause=null}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return i(a,{key:"cc99e9af57c0fb6dd1d70d128d1eed0720b6bede",class:"p-0"},i("ir-title",{key:"5a527cdedc3bb1b53b4926c67ff20216b649348a",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:u.entries.Lcz_Pickup,displayContext:"sidebar"}),i("section",{key:"ea2340b882b42b02e3add080aa5dd45b1c44dc26",class:"px-1"},i("ir-select",{key:"0d8ca50c8b4839dced85d5d52f5f6d181f3c4048",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:u.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",LabelAvailable:false,data:this.pickupService.getAvailableLocations(u.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&i(s,{key:"e865b88b4b71ac5db5a27e3e580d2a7088e39960"},i("div",{key:"72e0d9eda6f3e0314073d2c82ecbc5701e934efa",class:"d-flex"},i("div",{key:"2e0ecf96787bdcec06e0aa024eaa98966c8ea24d",class:"form-group  mr-1"},i("div",{key:"d81c256f6ce9a36acd05be215a40bb90c26e3d17",class:"input-group row m-0"},i("div",{key:"374dff7db573fe5b7aa9e9fddf3e05c2ee35a558",class:`input-group-prepend col-5 p-0 text-dark border-0`},i("label",{key:"8406a8c98302cea0993c3238e78f27399db1c95c",class:`input-group-text  flex-grow-1 text-dark border-theme `},u.entries.Lcz_ArrivalDate)),i("div",{key:"b19985ac868ba00f4c59595907e258d972c0a7a8",class:"form-control form-control-md col-7 d-flex align-items-center pl-0"},i("ir-date-picker",{key:"41cfac55d15084dd471c600b2034b8d189d0f540",minDate:x().format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{this.updatePickupData("arrival_date",t.detail.start.format("YYYY-MM-DD"))}})))),i("div",{key:"fab67cf4bb47cd5ab3749940c89085f98ff9e996",class:"form-group"},i("div",{key:"286e1884fe8ef1ec597694f0a6e993901b91ad67",class:"input-group  row m-0"},i("div",{key:"14f9d72a8d65a16fdd0059462c3cf350bfaca74e",class:`input-group-prepend col-4 col-sm-3 p-0 text-dark border-0`},i("label",{key:"f0ad45ce15a4c0cc4cdd0c82c12d3828a577edc4",htmlFor:"pickup",class:`input-group-text flex-grow-1 text-dark border-theme`},u.entries.Lcz_Time)),i("input",{key:"1f576c13407e61c14915ce3fc6f05aad3f7aa0f2",type:"text",value:this.pickupData.arrival_time,id:"pickup-time",class:`form-control col-8 col-sm-4 ${this.cause==="arrival_time"&&"border-danger"}`})))),i("ir-input-text",{key:"8e4a143dedc6cd17d4ef768626be82b40e38dee2",value:this.pickupData.flight_details,label:u.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",inputStyles:this.cause==="flight_details"?"border-danger":""}),i("ir-select",{key:"06afc5e849cf95e23f5230e2e05ec1030f935d13",selectContainerStyle:"mb-1",selectStyles:this.cause==="vehicle_type_code"?"border-danger":"",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:u.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",LabelAvailable:false,data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),i("div",{key:"06b85b1f9672e513af1cdddb5bb68f302efc03ff",class:"d-flex flex-column flex-md-row"},i("ir-select",{key:"c5ef054052aea8fc37a6b6b3e82ab3530563400f",labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectStyles:this.cause==="number_of_vehicles"?"border-danger":"",selectedValue:this.pickupData.number_of_vehicles,labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:u.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),i("ir-input-text",{key:"831c6d27f3eb90a6b26ec0563c8f66fa73374445",labelBorder:"theme",readonly:true,value:this.pickupData.due_upon_booking,labelWidth:7,label:`${u.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`,placeholder:"",class:""}))),i("div",{key:"bf8e712ee47a9e319cb544328bf93409947d559e",class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{key:"73372698d7db9b7cf4f9339cdfed58a95392d20b",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  ${this.defaultPickupData||this.pickupData.location!==-1?"mr-sm-1":""}`,icon:"",text:u.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&i("ir-button",{key:"50d348c7b026c212171ca36e8a94c4a8116abcda",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:this.isLoading,text:u.entries.Lcz_Save,btn_color:"primary",onClick:this.savePickup.bind(this)}))))}get el(){return o(this)}};F.style=W;const V=".sc-ir-pickup-view-h{display:block}";const q=V;const Q=class{constructor(e){t(this,e);this.booking=undefined}render(){if(!m.pickup_service.is_enabled||!this.booking.is_editable){return null}return i(a,null,i("div",{class:"mb-1"},i("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},i("p",{class:"font-size-large p-0 m-0 "},u.entries.Lcz_Pickup),i("ir-button",{id:"pickup",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},y.secondary),{"--icon-size":"1.5rem"})})),this.booking.pickup_info&&i("div",{class:"card"},i("div",{class:"p-1"},i("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},i("p",{class:"font-weight-bold mr-1 py-0 my-0"},u.entries.Lcz_Date,": ",i("span",{class:"font-weight-normal"},x(this.booking.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),this.booking.pickup_info.hour&&this.booking.pickup_info.minute&&i("p",{class:"font-weight-bold flex-fill py-0 my-0"},u.entries.Lcz_Time,":",i("span",{class:"font-weight-normal"}," ",v(this.booking.pickup_info.hour.toString(),this.booking.pickup_info.minute.toString()))),i("p",{class:"font-weight-bold py-0 my-0"},u.entries.Lcz_DueUponBooking,":"," ",i("span",{class:"font-weight-normal"},this.booking.pickup_info.currency.symbol,this.booking.pickup_info.total))),i("p",{class:"font-weight-bold py-0 my-0"},u.entries.Lcz_FlightDetails,":",i("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.details}`)),i("p",{class:"py-0 my-0 pickup-margin"},`${this.booking.pickup_info.selected_option.vehicle.description}`),i("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},u.entries.Lcz_NbrOfVehicles,":",i("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.nbr_of_units}`)),i("p",{class:"small py-0 my-0 pickup-margin"},m.pickup_service.pickup_instruction.description,m.pickup_service.pickup_cancelation_prepayment.description)))))}};Q.style=q;const J=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.3rem 0.5rem;border-radius:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.subtotal_row.sc-ir-room{padding-top:8px}.room_actions_btns.sc-ir-room{gap:0.5rem}.night-cost.sc-ir-room{color:#7cbebe}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const X=J;const Z=class{constructor(i){t(this,i);this.deleteFinished=e(this,"deleteFinished",7);this.pressCheckIn=e(this,"pressCheckIn",7);this.pressCheckOut=e(this,"pressCheckOut",7);this.editInitiated=e(this,"editInitiated",7);this.bookingEvent=undefined;this.bookingIndex=undefined;this.isEditable=undefined;this.mealCodeName=undefined;this.myRoomTypeFoodCat=undefined;this.currency="USD";this.legendData=undefined;this.roomsInfo=undefined;this.collapsed=false;this.defaultTexts=undefined;this.ticket=undefined;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.item=undefined;this.isLoading=false;this.isModelOpen=false}componentWillLoad(){if(this.bookingEvent){this.item=this.bookingEvent.rooms[this.bookingIndex]}}handleBookingEventChange(){this.item=this.bookingEvent.rooms[this.bookingIndex]}componentDidLoad(){this.modal=this.element.querySelector("ir-modal")}handleClick(t){let e=t.target;if(e.id=="checkin"){this.pressCheckIn.emit(this.item)}else if(e.id=="checkout"){this.pressCheckOut.emit(this.item)}}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}handleEditClick(){var t,e,i,s,a,o;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.item["assigned_units_pool"],NAME:b(this.item.guest.first_name,this.item.guest.last_name),EMAIL:this.bookingEvent.guest.email,PHONE:this.bookingEvent.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingEvent.from_date,TO_DATE:this.bookingEvent.to_date,TITLE:`${this.defaultTexts.entries.Lcz_EditBookingFor} ${(e=(t=this.item)===null||t===void 0?void 0:t.roomtype)===null||e===void 0?void 0:e.name} ${((s=(i=this.item)===null||i===void 0?void 0:i.unit)===null||s===void 0?void 0:s.name)||""}`,defaultDateRange:{dateDifference:this.item.days.length,fromDate:new Date(this.item.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.item.from_date+"T00:00:00")),toDate:new Date(this.item.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.item.to_date+"T00:00:00")),message:""},bed_preference:this.item.bed_preference,adult_child_offering:this.item.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.item.rateplan.selected_variation.adult_nbr,ARRIVAL:this.bookingEvent.arrival,ARRIVAL_TIME:this.bookingEvent.arrival.description,BOOKING_NUMBER:this.bookingEvent.booking_nbr,cancelation:this.item.rateplan.cancelation,channel_booking_nbr:this.bookingEvent.channel_booking_nbr,CHILDREN_COUNT:this.item.rateplan.selected_variation.child_nbr,COUNTRY:this.bookingEvent.guest.country_id,ENTRY_DATE:this.bookingEvent.from_date,FROM_DATE_STR:this.bookingEvent.format.from_date,guarantee:this.item.rateplan.guarantee,GUEST:this.bookingEvent.guest,IDENTIFIER:this.item.identifier,is_direct:this.bookingEvent.is_direct,IS_EDITABLE:this.bookingEvent.is_editable,NO_OF_DAYS:this.item.days.length,NOTES:this.bookingEvent.remark,origin:this.bookingEvent.origin,POOL:this.item["assigned_units_pool"],PR_ID:(a=this.item.unit)===null||a===void 0?void 0:a.id,RATE:this.item.total,RATE_PLAN:this.item.rateplan.name,RATE_PLAN_ID:this.item.rateplan.id,RATE_TYPE:this.item.roomtype.id,ROOMS:this.bookingEvent.rooms,SOURCE:this.bookingEvent.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.bookingEvent.format.to_date,TOTAL_PRICE:this.bookingEvent.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((o=this.item.unit)===null||o===void 0?void 0:o.name)||"",PICKUP_INFO:this.bookingEvent.pickup_info})}handleDeleteClick(){this.modal.openModal()}async deleteRoom(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];t=t.filter((t=>t.identifier!==this.item.identifier));const e={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.bookingEvent.booking_nbr,from_date:this.bookingEvent.from_date,to_date:this.bookingEvent.to_date,remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};console.log("body:",e);const{data:i}=await D.post(`/DoReservation`,e);if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}this.irModalRef.closeModal();this.deleteFinished.emit(this.item.identifier)}catch(t){}finally{this.isLoading=false}}render(){var t,e;return i(a,{key:"043c855eaeec636d283c13a12261b7e5d794f5f7",class:"p-1 d-flex m-0"},i("ir-button",{key:"d5bc81b8b383a969f322d0131c84e98ae7fb9d0e",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${(t=this.item.identifier)===null||t===void 0?void 0:t.split(" ").join("")}`,"aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"mr-1",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHanlder:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}}),i("div",{key:"c6d070dbff10d459f4fa6aa5501269365afdce97",class:"flex-fill m-0 "},i("div",{key:"0d00a12e6333649b825a40768bc4ca20c39dde42",class:"d-flex align-items-start justify-content-between sm-mb-1"},i("p",{key:"6aa880ff279787d0851f6b81c05f7feb2d402995",class:"m-0 p-0"},i("strong",{key:"b04627ad5e769649b1399eb2b4b52ed030e09a34",class:"m-0 p-0"},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.item.rateplan.is_non_refundable&&` - ${this.defaultTexts.entries.Lcz_NonRefundable}`," "),i("div",{key:"f8d07b59a8e37d42b518f22a3caa0105ab1a18c4",class:"d-flex m-0 p-0 align-items-center room_actions_btns"},i("span",{key:"7bc11a236e4843ab0923e896ba35729a80ebdcf2",class:"p-0 m-0 font-weight-bold"},h(this.currency,this.item["gross_total"])),this.hasRoomEdit&&this.isEditable&&i("ir-button",{key:"c06e2aaa6108f2767bd6f778df9fb901614339e3",id:`roomEdit-${this.item.identifier}`,variant:"icon",icon_name:"edit",style:y.secondary,onClickHanlder:this.handleEditClick.bind(this)}),this.hasRoomDelete&&this.isEditable&&i("ir-button",{key:"968f88fa79c3c2c6b2a619df096d7f52c5773019",variant:"icon",onClickHanlder:this.handleDeleteClick.bind(this),id:`roomDelete-${this.item.identifier}`,icon_name:"trash",style:y.danger}))),i("div",{key:"2356e50f742e972c3fd245b841b3d9e72677a64c",class:"d-flex align-items-center sm-mb-1"},i("ir-date-view",{key:"1960527d86f7df606919644b4b0df1de307d1918",class:"mr-1",from_date:this.item.from_date,to_date:this.item.to_date,showDateDifference:false}),this.hasCheckIn&&i("ir-button",{key:"d180a7327dd3775b61c4e74fb21aea2720d0eeb1",id:"checkin",icon:"",class:"mr-1",btn_color:"info",size:"sm",text:"Check in"}),this.hasCheckOut&&i("ir-button",{key:"c5cda600d05a052b27d1c18f8218b9b49b2d6d49",id:"checkout",icon:"",btn_color:"info",size:"sm",text:"Check out"})),i("div",{key:"2412ce7875c9561637768ba131e884416574ae97",class:"d-flex justify-content-end"},m.is_frontdesk_enabled&&this.item.unit&&i("span",{key:"b35f540d8479f2ea52a6166836865add57eb2b8a",class:`light-blue-bg ${this.hasCheckIn||this.hasCheckOut?"mr-2":""} `},this.item.unit.name)),i("div",{key:"9e2c7343ad4eae60d67cd988b7e2b405f8826c87"},i("span",{key:"1d95b406443f8170ac2a686660be78cf1f53bdef",class:"mr-1"},`${this.item.guest.first_name||""} ${this.item.guest.last_name||""}`),this.item.rateplan.selected_variation.adult_nbr>0&&i("span",{key:"aaf29a2b2751a8db9dea162b25a8a2e9161ba05e"}," ",this.item.rateplan.selected_variation.adult_child_offering)),i("div",{key:"b292a74d094a9e8950a84fe80b14e91545df04d0",class:"collapse",id:`roomCollapse-${(e=this.item.identifier)===null||e===void 0?void 0:e.split(" ").join("")}`},i("div",{key:"5cf093faf49c62fc7ad23f5d5e2e78510c132214",class:"d-flex sm-mb-1 sm-mt-1"},i("div",{key:"4c127f493ba0d60cbba287f823e7514060dbfb61",class:" sm-padding-top"},i("strong",{key:"07e93298204404b4b418afac489e8d64a0c1d426",class:"sm-padding-right"},`${this.defaultTexts.entries.Lcz_Breakdown}:`)),i("div",{key:"2fd4fb8b8e2664975dd43e11750306992e4c30ee",class:"flex-fill"},i("table",{key:"9f7b40744bd0e254c6eec5969f72ea9a50cce4c8"},this.item.days.length>0&&this.item.days.map((t=>i("tr",null,i("td",{class:"pr-2 text-right"},_(t.date)),i("td",{class:"text-right"},h(this.currency,t.amount)),t.cost>0&&t.cost!==null&&i("td",{class:"pl-2 text-left night-cost"},h(this.currency,t.cost))))),i("tr",{key:"8e55795f5ba18bb05f015c5ab97dea19c968d29e",class:""},i("th",{key:"d917bd0a73810af37d33f0677173b6b9c85f36c0",class:"text-right pr-2 subtotal_row"},this.defaultTexts.entries.Lcz_SubTotal),i("th",{key:"74f2ddda2eeb05781341f15b234e531cf5f938d4",class:"text-right subtotal_row"},h(this.currency,this.item.total)),this.item.gross_cost>0&&this.item.gross_cost!==null&&i("th",{key:"5c9e3ca537d25cfaa8562ebbbfc127b6d1c4f967",class:"pl-2 text-right night-cost"},h(this.currency,this.item.cost))),this.bookingEvent.is_direct?i(s,null,(()=>{const t=m.taxes.filter((t=>t.pct>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name," (",t.pct,"%)"),i("td",{class:"text-right"},h(this.currency,this.item.total*t.pct/100)),this.item.gross_cost>0&&this.item.gross_cost!==null&&i("td",{class:"pl-2 text-right night-cost"},h(this.currency,this.item.cost*t.pct/100)))))})()):i(s,null,(()=>{const t=this.item.ota_taxes.filter((t=>t.amount>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name),i("td",{class:"text-right"},t.currency.symbol,t.amount))))})())))),i("div",{key:"a9fc3505f1863d41f169b4efdfbd490f3f9c1a54",class:"sm-mb-1",innerHTML:this.item.rateplan.cancelation||""}),i("div",{key:"277a9ce32378983d7828ca527c2665a502fbe423",class:"sm-mb-1",innerHTML:this.item.rateplan.guarantee||""}),this.bookingEvent.is_direct&&i("ir-label",{key:"b27f731b413050c71eec9a2f55ca31448b4ef477",label:`${this.defaultTexts.entries.Lcz_MealPlan}:`,value:this.mealCodeName}))),i("ir-modal",{key:"2bfdb1b5feecc29235c44044dae62fbd5727a44a",autoClose:false,ref:t=>this.irModalRef=t,isLoading:this.isLoading,onConfirmModal:this.deleteRoom.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:`${this.defaultTexts.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.item.roomtype.name} ${this.item.unit?this.item.unit.name:""} ${this.defaultTexts.entries.Lcz_FromThisBooking}`}))}get element(){return o(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};Z.style=X;const tt=":host{width:var(--ir-spinner-size, 1.25rem);height:var(--ir-spinner-size, 1.25rem);border:var(--ir-spinner-border-width, 2.5px) solid var(--ir-spinner-color, #3f3f3f);border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const et=tt;const it=class{constructor(e){t(this,e);this.size=undefined;this.borderWidth=undefined;this.unit="rem";this.color=undefined}componentWillLoad(){this.initStyles()}handleSpinnerSizeChange(){this.initStyles()}handleSpinnerBorderWidthChange(){this.initStyles()}handleSpinnerUnitChange(){this.initStyles()}handleSpinnerColorChange(){this.initStyles()}initStyles(){if(this.size){this.applyCssElement(`${this.size}${this.unit}`,"--ir-spinner-size")}if(this.borderWidth){this.applyCssElement(`${this.borderWidth}${this.unit}`,"--ir-spinner-size")}if(this.color){this.applyCssElement(`${this.color}`,"--ir-spinner-color")}}applyCssElement(t,e){this.el.style.setProperty(e,t)}render(){return i(a,{key:"5e8ea39009f06af4a71b9a4bb047197cc23a7132"})}get el(){return o(this)}static get watchers(){return{size:["handleSpinnerSizeChange"],borderWidth:["handleSpinnerBorderWidthChange"],unit:["handleSpinnerUnitChange"],color:["handleSpinnerColorChange"]}}};it.style=et;const st=class{constructor(i){t(this,i);this.textChange=e(this,"textChange",7);this.rows=3;this.cols=5;this.text="";this.label="<label>";this.placeholder="<placeholder>";this.value="";this.maxLength=undefined;this.textareaClassname=undefined;this.error=false}handleAriaInvalidChange(t){this.error=t==="true"}connectedCallback(){}disconnectedCallback(){}render(){return i("div",{key:"884931e2f40b0f42e396764f383d863a837c57fb",class:"form-group"},i("label",{key:"378d303e68da3ded31e66b0fbad5d0b9262671a3"},this.label),i("textarea",{key:"7bfa146049c4a4a111ad5b4abfac0f59af15ff0c",maxLength:this.maxLength,rows:this.rows,value:this.value,class:`form-control ${this.textareaClassname} ${this.error?"border-danger":""}`,placeholder:this.placeholder,onInput:t=>this.textChange.emit(t.target.value)}))}static get watchers(){return{"aria-invalid":["handleAriaInvalidChange"]}}};export{T as igl_book_property,N as ir_booking_extra_note,L as ir_dialog,R as ir_guest_info,Y as ir_label,K as ir_payment_details,F as ir_pickup,Q as ir_pickup_view,Z as ir_room,it as ir_spinner,st as ir_textarea};
//# sourceMappingURL=p-a791779d.entry.js.map