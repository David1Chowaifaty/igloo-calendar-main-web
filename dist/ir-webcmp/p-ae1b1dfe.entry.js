import{r as e,c as a,h as t,H as n,g as i,F as c}from"./p-acddcbeb.js";import{c as s,t as l,u as r,a as o,b as d,d as p}from"./p-8a6645e7.js";import{l as f}from"./p-e58470d9.js";import{c as h}from"./p-d6d6fb27.js";import"./p-2925ded6.js";const m=".sc-ir-channel-general-h{display:block}.label-style.sc-ir-channel-general{width:6.25rem;text-align:end;padding-right:0.625rem !important}.connection-status.sc-ir-channel-general{display:flex;align-items:center;justify-content:space-between;margin-top:0.625rem !important}.connection-title.sc-ir-channel-general{border-bottom:1px solid #e4e5ec}.ml-18.sc-ir-channel-general{margin-left:18% !important}.status-message.sc-ir-channel-general{display:flex;align-items:center;gap:0.3125rem;font-size:0.81rem;margin:0;padding:0}";const b=m;const u=class{constructor(t){e(this,t);this.connectionStatus=a(this,"connectionStatus",7)}channel_status=null;buttonClicked=false;connection_status_message="";status=false;connectionStatus;componentWillLoad(){if(this.channel_status==="create"||!s.isConnectedToChannel){return}this.connection_status_message=s.isConnectedToChannel?s.selectedChannel.properties.find((e=>e.id===s.channel_settings.hotel_id))?.name:"";this.status=true}handleTestConnectionClicked(e){e.preventDefault();this.buttonClicked=true;if(!s.channel_settings?.hotel_id){return}const a=l();this.status=a;this.connection_status_message=a?s.selectedChannel.properties.find((e=>e.id===s.channel_settings.hotel_id))?.name:f.entries?.Lcz_IncorrectConnection;this.buttonClicked=false;this.connectionStatus.emit(this.status)}render(){return t(n,{key:"d35b64613a874ae10e994f1c566f3b9ab847c6cd",class:"px-1"},t("section",{key:"4d0a859b70e02728fcba09e4f6732fa8da560dae",class:"ml-18"},t("fieldset",{key:"cd9d60656f03a9e4c9cd6e79fb405dd46491d722",class:"d-flex align-items-center"},t("label",{key:"c7081fbb0727f3617d024525e1d6cb9cfcce7ef5",htmlFor:"hotel_channels",class:"m-0 p-0 label-style"},f.entries?.Lcz_Channel),t("ir-combobox",{key:"c25d3b8c55a71f7449f343fe0aba93cea4545a40",input_id:"hotel_channels",disabled:s.isConnectedToChannel,class:"flex-fill",value:s.selectedChannel?.name,onComboboxValueChange:e=>{o(e.detail.data.toString())},data:s.channels.map((e=>({id:e.id,name:e.name})))})),t("fieldset",{key:"43832696fe9bc1edcbcb9b8507b63d9fb57d7f19",class:"d-flex align-items-center mt-1"},t("label",{key:"69c73c41453a2ae9916a93fb98dceba5cd570fd9",htmlFor:"hotel_title",class:"m-0 p-0 label-style"},f.entries?.Lcz_Title),t("div",{key:"1d041078d61f0345ac6fe8962eb284eed7c3c163",class:"flex-fill"},t("input",{key:"94f42994ca9568e1cd5ec8d08dbcc30c527ea22c",id:"hotel_title",value:s.channel_settings?.hotel_title,onInput:e=>r("hotel_title",e.target.value),class:"form-control  flex-fill"})))),s.selectedChannel&&t("form",{key:"d489132073c5860de758080eec997e12ebef67c1",onSubmit:this.handleTestConnectionClicked.bind(this),class:"mt-3 connection-container"},t("h3",{key:"73fe6eaf2bc2cb1f30996bef154fc726875814d7",class:"text-left font-medium-2  py-0 my-0 connection-title py-1 mb-2"},f.entries?.Lcz_ConnectionSettings),t("div",{key:"c65e599e13d3e82b303faa1f8b7ab8a930f697d1",class:"ml-18"},t("fieldset",{key:"fe69b492b74f2979d433de135feb3fb65e58d675",class:"d-flex align-items-center my-1"},t("label",{key:"f776d70b8aaaa1758f8bf2da062d0b3050103cd1",htmlFor:"hotel_id",class:"m-0 p-0 label-style"},f.entries?.Lcz_HotelID),t("div",{key:"a5733dd4a1c45d71abd4aa985724c5922039a692",class:"flex-fill"},t("input",{key:"e55c737904f697ebd9d3bab27c52875eca642903",id:"hotel_id",class:`form-control  flex-fill bg-white ${this.buttonClicked&&!s.channel_settings?.hotel_id&&"border-danger"}`,value:s.channel_settings?.hotel_id,onInput:e=>r("hotel_id",e.target.value)}))),t("div",{key:"21d1b4b6e9f8ac5659a67a4f1eebe2da4fa6bbb4",class:"connection-status"},t("div",{key:"a6236fe5e924c2e9b042ad9ab9a08b3bd39b1920",class:"status-message"},this.connection_status_message&&(this.status?t("ir-icons",{name:"circle_check",style:{color:"green"}}):t("ir-icons",{name:"danger",style:{color:"yellow"}})),t("span",{key:"e1e6828016e44111c39a9aa3b899ccdf2e6634af"},this.connection_status_message)),t("button",{key:"38064e335ea72690d1bbf8b710dce6d3c99d8a1b",class:"btn btn-outline-secondary btn-sm",type:"submit"},f.entries?.Lcz_TestConnection)))))}};u.style=b;const g=".sc-ir-channel-header-h{display:block;position:relative;padding:0;margin:0;border-bottom:1px solid #e4e5ec}ul.sc-ir-channel-header{display:flex;align-items:center;gap:2rem;padding:0}li.sc-ir-channel-header{list-style:none !important}.tab.sc-ir-channel-header{font-size:0.95rem;font-weight:400;cursor:pointer;position:relative;margin:0;padding:0;transition:color 0.3s ease;user-select:none}.tab[data-disabled].sc-ir-channel-header{cursor:auto}.tab.sc-ir-channel-header:hover{opacity:80%}.tab[data-state='selected'].sc-ir-channel-header,.tab[data-state='selected'].sc-ir-channel-header:hover{color:var(--blue);opacity:100%}.active-indicator.sc-ir-channel-header{padding:0;bottom:0px;position:absolute;height:3px;border-radius:4px;transition:transform 0.3s ease, width 0.3s ease;background:var(--blue)}";const y=g;const x=class{constructor(t){e(this,t);this.tabChanged=a(this,"tabChanged",7)}get el(){return i(this)}headerTitles=[];selectedIndex=0;tabChanged;activeIndicator;animationFrameId;componentDidLoad(){this.updateActiveIndicator()}disconnectedCallback(){if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}}handleTabSelection(e){this.selectedIndex=e;this.updateActiveIndicator();this.tabChanged.emit(this.headerTitles[this.selectedIndex].id)}updateActiveIndicator(){if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}requestAnimationFrame((()=>{const e=this.el.querySelector(`li.tab[data-state="selected"]`);if(e){const{left:a,width:t}=e.getBoundingClientRect();const n=this.el.getBoundingClientRect().left;const i=a-n;this.activeIndicator.style.width=`${t}px`;this.activeIndicator.style.transform=`translateX(${i}px)`}}))}render(){return t(n,{key:"d347f450a95d16ee7d7e7dd7b821eca040b855a7"},t("ul",{key:"3a5c1bbb1baf6927ce2c97e9adea2e6f43b0350a",class:"px-1"},this.headerTitles.map(((e,a)=>t("li",{class:`tab ${e.disabled?"text-light":""}`,key:e.id,onClick:()=>{if(!e.disabled)this.handleTabSelection(a)},"data-disabled":e.disabled,"data-state":this.selectedIndex===a?"selected":""},e.name)))),t("span",{key:"1d39442b809e9d699e02ad9cf4729c30668c76ec",class:"active-indicator",ref:e=>this.activeIndicator=e}))}};x.style=y;class v{removedMapping(e,a){let t=[...s.mappedChannels];if(a){const a=h.roomsInfo.find((a=>a.id.toString()===e));t=t.filter((e=>a.rateplans.find((a=>a.id.toString()===e.ir_id))===undefined))}s.mappedChannels=t.filter((a=>a.ir_id!==e))}checkMappingExists(e,a,t){const n=e.toString();const i=t?.toString();if(a){const e=s.mappedChannels.find((e=>e.type==="room_type"&&e.channel_id.toString()===n));if(!e){return{hide:false,result:undefined,occupancy:undefined}}const a=h.roomsInfo.find((a=>a.id.toString()===e.ir_id));if(!a){throw new Error("Invalid Room type")}return{hide:false,occupancy:a.occupancy_default.adult_nbr,result:a}}if(!i){throw new Error("Missing room type id")}const c=s.mappedChannels.find((e=>e.type==="room_type"&&e.channel_id.toString()===i));if(!c){return{hide:true,result:undefined,occupancy:undefined}}const l=h.roomsInfo.find((e=>e.id.toString()===c.ir_id));if(!l){throw new Error("Invalid Room type")}let r;for(const e of s.mappedChannels){if(e.type!=="rate_plan"||e.channel_id.toString()!==n){continue}const a=this.resolveRatePlanContext(e);if(a&&a.parentChannelId===i){r=a;break}}if(!r){return{hide:false,result:undefined,occupancy:undefined}}if(r.room.id.toString()!==l.id.toString()){return{hide:false,result:undefined,occupancy:undefined}}return{hide:false,occupancy:l.occupancy_default.adult_nbr,result:r.ratePlan}}resolveRatePlanContext(e){if(e.type!=="rate_plan"){return undefined}const a=h.roomsInfo.find((a=>a.rateplans.some((a=>a.id.toString()===e.ir_id))));if(!a){return undefined}const t=a.rateplans.find((a=>a.id.toString()===e.ir_id));if(!t){return undefined}const n=s.mappedChannels.find((e=>e.type==="room_type"&&e.ir_id===a.id.toString()));return{room:a,ratePlan:t,parentChannelId:n?.channel_id?.toString()}}getAppropriateRooms(e,a){if(e){const e=h.roomsInfo.filter((e=>s.mappedChannels.find((a=>a.ir_id.toString()===e.id.toString()))===undefined&&e.is_active));return e.map((e=>({id:e.id.toString(),name:e.name,occupancy:e.occupancy_default.adult_nbr})))}if(!a){throw new Error("Missing roomType id")}const t=s.mappedChannels.find((e=>e.channel_id.toString()===a));if(!t){throw new Error("Invalid room type id")}const n=h.roomsInfo.find((e=>e.id.toString()===t.ir_id));return n.rateplans.filter((e=>s.mappedChannels.find((a=>e.id.toString()===a.ir_id))===undefined&&e["is_active"])).map((e=>({id:e.id.toString(),name:`${e["short_name"]} ${e["is_non_refundable"]?"Non-refundable":""}`,occupancy:n.occupancy_default.adult_nbr})))}}const w=".sc-ir-channel-mapping-h{display:block;box-sizing:border-box;font-size:12px !important;line-height:14px !important}*.sc-ir-channel-mapping{padding:0;margin:0;box-sizing:border-box}.submap-text.sc-ir-channel-mapping{padding-left:10px}.text-blue.sc-ir-channel-mapping{color:var(--blue)}.text-red.sc-ir-channel-mapping{color:var(--red)}.not_mapped_btn.sc-ir-channel-mapping{color:#ff4961}.not_mapped_btn.sc-ir-channel-mapping:hover{color:#ff1635}li.sc-ir-channel-mapping{list-style:none !important}.refresh-btn.sc-ir-channel-mapping{all:unset;color:var(--blue);cursor:pointer}.refresh-btn.sc-ir-channel-mapping:hover{color:#104064}.selected-map.sc-ir-channel-mapping{flex:1}.selected-map-title.sc-ir-channel-mapping{flex:1}.mapped_row.sc-ir-channel-mapping{display:flex;align-items:center}.mapped_item.sc-ir-channel-mapping+svg.sc-ir-channel-mapping{display:block;flex:0 0 4.166666666666666%;max-width:4.166666666666666%;margin:0}.mapped_row.sc-ir-channel-mapping .mapped_item.sc-ir-channel-mapping{flex:0 0 45.83333333333333%;display:block;max-width:45.83333333333333%}.mapped_item.sc-ir-channel-mapping{margin:0;padding:0;line-height:22px}.mapped_name.sc-ir-channel-mapping{margin-right:5px}.gap-3.sc-ir-channel-mapping{gap:5px}.channel_name.sc-ir-channel-mapping{color:rgba(0, 0, 0, 0.88);font-size:14px;font-weight:700}.mapped_row.rate_plan.sc-ir-channel-mapping,.mapped_row.room_type.sc-ir-channel-mapping{margin-bottom:0px}";const _=w;const k=class{constructor(a){e(this,a)}activeMapField="";availableRooms=[];mappingService=new v;setActiveField(e,a,t){const n=t?.toString();const i=this.mappingService.getAppropriateRooms(a,n);if(i){this.availableRooms=i}this.activeMapField=e.toString()}renderMappingStatus(e,a,n,i){if(e.hide){return t("div",null)}if(e.result){return t(c,null,t("div",{class:"pl-2 flex-fill d-sm-none mapped_item text-blue d-flex align-items-center"},t("span",{class:"m-0 p-0 d-flex align-items-center selected-map"},t("span",{class:"selected-map-title"},n?e.result.name:e.result["short_name"]," ",e.result["is_non_refundable"]?"Non-refundable":""),t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{fill:"var(--blue)",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),e.occupancy),t("ir-icon",{class:"ml-1 p-0",onIconClickHandler:()=>this.mappingService.removedMapping(e.result.id.toString(),n)},t("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{fill:"var(--blue)",d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"})))),t("div",{class:"pl-2 flex-fill d-none mapped_item text-blue d-sm-flex align-items-center"},t("span",{class:"mapped_name"},n?e.result.name:e.result["short_name"]," ",e.result["is_non_refundable"]?"Non-refundable":""),t("div",{class:"d-flex align-items-center gap-3 flex-fill"},t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{fill:"var(--blue)",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),t("span",null,e.occupancy)),t("ir-button",{variant:"icon",onClickHandler:()=>this.mappingService.removedMapping(e.result.id.toString(),n),icon_name:"trash",style:{"--icon-size":"1rem","--icon-button-color":"#1e9ff2","--icon-button-hover-color":"#104064 "}})))}return t("div",{class:"pl-2  flex-fill mapped_item"},this.activeMapField===a?t("ir-combobox",{autoFocus:true,placeholder:f.entries?.Lcz_NotMapped,data:this.availableRooms,onComboboxValueChange:e=>{d(e.detail.data,this.activeMapField,n);this.activeMapField=""}}):t("span",{class:"cursor-pointer  not_mapped_btn",onClick:()=>this.setActiveField(a,n,i)},f.entries.Lcz_NotMapped))}render(){return t(n,{key:"294e54ce6cc48bf9ca3d78fcff8049838e9cfabb",class:"py-md-2 px-md-2"},t("div",{key:"196121e990599e53b49c5c13ada2ebef4c7eaa4f",class:"d-flex p-0 m-0 w-100 justify-content-end"},t("button",{key:"80be96d8d0ea9d702d2cfcc5d0c5194e003c6d10",onClick:()=>{p()},class:"btn refresh-btn"},f.entries?.Lcz_Refresh)),t("section",{key:"df344f71592559c2b25a97f8659474050fe9fffd",class:"w-100"},t("div",{key:"d7de021c609a5189155ebfd434406f700abc082c",class:"pt-1 mapped_row"},t("p",{key:"5cf2f6d43db4c55bd0c638e34cf3b0082eee9ad5",class:"mapped_item channel_name"},s.selectedChannel?.name),t("svg",{key:"8ab16df0cc6d42acc84aae95b21c2d580559fe87",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{key:"5547fcfd77f5dfce83fab8e5f12cd409a4582a84",d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"})),t("p",{key:"e7fb09221b908618dff7e0c39058a16a1817519b",class:"pl-2 mapped_item channel_name"},"igloorooms")),t("div",{key:"481eba51e6754d989732076796c258d54b6a3996"},s.selectedChannel?.property?.room_types?.map((e=>{const a=this.mappingService.checkMappingExists(e.id.toString(),true);return t(c,null,t("div",{key:e.id,class:"mapped_row room_type pt-1"},t("p",{class:"mapped_item"},e.name),t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"})),this.renderMappingStatus(a,e.id,true)),e.rate_plans.map((a=>{const n=this.mappingService.checkMappingExists(a.id.toString(),false,e.id.toString());return t("div",{key:a.id,class:" mapped_row rate_plan"},t("p",{class:"pl-1 submap-text mapped_item"},a.name),!n.hide&&t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},t("path",{fill:"currentColor",d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"})),this.renderMappingStatus(n,a.id,false,e.id))})))})))))}};k.style=_;export{u as ir_channel_general,x as ir_channel_header,k as ir_channel_mapping};
//# sourceMappingURL=p-ae1b1dfe.entry.js.map