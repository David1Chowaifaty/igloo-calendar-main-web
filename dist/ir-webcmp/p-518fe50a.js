import{Q as t}from"./p-b29f6fd8.js";import{c as n}from"./p-2925ded6.js";import{h as o}from"./p-6c4ba7c0.js";const r={bookings:[],filteredBookings:[],paginatedBookings:[],needsCheckOutBookings:[],futureRooms:[],outBookings:[],searchTerm:"",pagination:{page:1,pageSize:20,total:0,totalPages:1,currentPage:1,showing:{from:0,to:0}},today:w()};const{state:e,onChange:u}=n(r);function s(t=[]){e.bookings=Array.isArray(t)?[...t]:[];Y()}function a(t){const n=Number.isFinite(t)&&t>0?Math.floor(t):0;const o=i(n,e.pagination.pageSize);const r=c(e.pagination.currentPage,Math.max(o,1));e.pagination={...e.pagination,total:n,totalPages:Math.max(o,1),currentPage:r,showing:f(r,e.pagination.pageSize,n)}}function i(t,n){if(!t||!n){return 0}return Math.ceil(t/n)}function c(t,n){if(!Number.isFinite(t)||t<=0){return 1}const o=Math.floor(t);return Math.min(Math.max(o,1),Math.max(n,1))}function f(t,n,o){if(!o||!n){return{from:0,to:0}}const r=(t-1)*n+1;return{from:Math.max(r,1),to:Math.min(r+n-1,o)}}function g(t){e.searchTerm=t??"";Y()}function h(t){const n=c(t,Math.max(e.pagination.totalPages,1));e.pagination={...e.pagination,currentPage:n,showing:f(n,e.pagination.pageSize,e.pagination.total)};Y()}function M(t){if(!Number.isFinite(t)||t<=0){return}const n=Math.floor(t);e.pagination={...e.pagination,pageSize:n,currentPage:1,showing:f(1,n,e.pagination.total)};Y()}function m(t){e.today=o(t,"YYYY-MM-DD").format("YYYY-MM-DD");Y()}function Y(){const t=d(e.searchTerm);e.filteredBookings=t;e.paginatedBookings=t;const n=D(t);e.needsCheckOutBookings=n.needsCheckOut;e.outBookings=n.out;e.futureRooms=n.futureRooms}function d(t){const n=e.bookings;const o=t?.trim().toLowerCase();if(!o){return n}return n.filter((t=>p(t,o)))}function p(t,n){if(!n){return true}const o=t.booking_nbr?.toLowerCase()??"";if(o.includes(n)){return true}if(l(t.guest).includes(n)){return true}return(t.rooms??[]).some((t=>l(t.guest).includes(n)))}function D(t){return t.reduce(((t,n)=>{const o=n.rooms??[];const r=o.filter((t=>b(t)));if(r.length){t.needsCheckOut.push({...n,rooms:r})}const e=o.filter((t=>k(t)));if(e.length){t.out.push({...n,rooms:e})}const u=o.filter((t=>P(t)));if(u.length){t.out.push({...n,rooms:u})}return t}),{needsCheckOut:[],out:[],futureRooms:[]})}function b(n){return t({to_date:n.to_date,inOutCode:n.in_out.code})}function k(t){return t.in_out?.code==="002"}function P(t){return o().isBefore(o(t.to_date,"YYYY-MM-DD"),"date")}function l(t){const n=`${t?.first_name??""} ${t?.last_name??""}`.trim();return n.toLowerCase()}function w(){return o().format("YYYY-MM-DD")}s();export{m as a,a as b,h as c,e as d,M as e,s as i,u as o,g as s};
//# sourceMappingURL=p-518fe50a.js.map