import{r as e,g as t,h as r,H as i}from"./p-d239357b.js";import{T as a}from"./p-f8b7c0cd.js";import{i as s}from"./p-6fec77c0.js";import{a as n}from"./p-bf44a732.js";import"./p-c5894a47.js";const u=".sc-ir-queue-manager-h{display:flex;flex-direction:column;height:100%}.queue-page.sc-ir-queue-manager{display:flex;flex-direction:column;gap:1rem}.queue-grid.sc-ir-queue-manager{display:flex;flex-direction:column;gap:1rem}.queue-grid.sc-ir-queue-manager wa-card.sc-ir-queue-manager{width:100%}.queue-item.sc-ir-queue-manager{display:grid;align-items:center;gap:0.75rem;margin-bottom:0.5rem}.queue-page__header.sc-ir-queue-manager{display:flex;align-items:center;gap:1rem;margin-bottom:1rem}.page-title.sc-ir-queue-manager{margin-bottom:0}.queue-item__property.sc-ir-queue-manager{font-size:0.9rem;line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.queue-item__status.sc-ir-queue-manager{display:grid;grid-template-columns:repeat(4, 1fr);align-items:center}.queue-item__progress.sc-ir-queue-manager{grid-column:span 3}.queue-item__count.sc-ir-queue-manager{text-align:right;font-size:0.85rem}@media (min-width: 768px){.queue-grid.sc-ir-queue-manager{display:grid;grid-template-columns:repeat(2, 1fr)}}@media (min-width: 1024px){.queue-item.sc-ir-queue-manager{grid-template-columns:300px 1fr}}";const m=u;const c=class{constructor(t){e(this,t)}get el(){return t(this)}ticket="";isLoading=true;tokenService=new a;data;componentWillLoad(){if(this.ticket){this.tokenService.setToken(this.ticket);this.init()}}handleTicketChange(e,t){if(e!==t&&e){this.tokenService.setToken(this.ticket);this.init()}}async init(){await this.fetchData();this.isLoading=false}async fetchData(){const{data:e}=await n.post("/Get_Q_Summary",{});if(e.ExceptionMsg){return}this.data=e.My_Result.map((e=>{const{pendingRequests:t,properties:r}=this.formatResults(e.properties);return{pendingRequests:t,properties:r,q_name:e.q_name,total_pending:e.total_pending}}))}formatResults(e){if(!e){return{properties:[],pendingRequests:[]}}const t=e.split(",").map((e=>{const[t,r]=e.split("|").map((e=>e.trim()));const i=Number(r);if(!t||Number.isNaN(i)){return null}return{property:t,pending:i}})).filter((e=>e!==null));t.sort(((e,t)=>t.pending-e.pending));return{properties:t.map((e=>e.property)),pendingRequests:t.map((e=>e.pending))}}render(){if(this.isLoading){return r("ir-loading-screen",null)}return r(i,null,r("ir-interceptor",null),r("ir-toast",null),r("div",{class:"ir-page__container"},r("div",{class:"queue-page__header"},r("h3",{class:"page-title"},"Pending Queues"),r("ir-custom-button",{onClickHandler:()=>{this.fetchData()},appearance:"filled",loading:s("/Get_Q_Summary")},r("wa-icon",{name:"refresh"}))),this.data.length===0&&r("ir-empty-state",{style:{marginTop:"20vh"}}),r("div",{class:"queue-grid"},this.data.map((e=>r("wa-card",null,r("p",{slot:"header"},e.q_name," (",e.total_pending," total pending)"),e.properties.map(((t,i)=>{const a=e.pendingRequests[i];const s=e.total_pending>0?a/e.total_pending*100:0;return r("div",{class:"queue-item"},r("span",{class:"queue-item__property"},t),r("div",{class:"queue-item__status"},r("wa-progress-bar",{class:"queue-item__progress",value:s}),r("span",{class:"queue-item__count"},a," (",s.toFixed(2),"%)")))}))))))))}static get watchers(){return{ticket:["handleTicketChange"]}}};c.style=m;export{c as ir_queue_manager};
//# sourceMappingURL=p-c7b0df2d.entry.js.map