{"version":3,"names":["irHkTasksCss","IrHkTasksStyle0","IrHkTasks","constructor","hostRef","this","language","ticket","isLoading","isCleaningLoading","selectedDuration","selectedHouseKeeper","selectedRoom","archiveOpened","hkNameCache","roomService","RoomService","houseKeepingService","HouseKeepingService","token","Token","table_sorting","Map","componentWillLoad","baseUrl","setBaseUrl","setToken","init","ticketChanged","newValue","oldValue","handleCloseSidebar","e","stopImmediatePropagation","stopPropagation","isSidebarOpen","handleSortingChanged","field","direction","detail","console","log","set","handleSkipSelectedTask","modalCauses","task","cause","_a","modal","openModal","setLoading","propertyId","propertyid","p","Error","propertyData","getExposedProperty","id","aname","is_backend","include_units_hk_status","My_Result","property_id","requests","getHkTasks","from_date","moment","format","to_date","getExposedHKSetup","fetchLanguage","push","results","Promise","all","tasksResult","tasks","updateTasks","error","buildHousekeeperNameCache","_b","housekeeping_store","hk_criteria","housekeepers","forEach","hk","name","updateTasksStore","map","t","Object","assign","v4","housekeeper","hkm_id","hkName","_c","find","handleHeaderButtonPress","sortingArray","Array","from","entries","key","value","url","fetchTasksWithFilters","downloadFile","handleSelectedTaskCleaningEvent","handleModalConfirmation","hkTasksStore","selectedTasks","length","booking_nbr","date","unit","editHkSkip","BOOK_NBR","DATE","COMMENT","HK_SKIP_ID","HK_SKIP_REASON_CODE","PR_ID","executeHKAction","actions","description","unit_id","clearSelectedTasks","closeModal","applyFilters","isApplyFiltersLoading","filters","export_to_excel","cleaning_periods","cleaning_frequencies","dusty_units","highlight_check_ins","cleaning_frequency","code","dusty_window","highlight_window","is_export_to_excel","render","h","Host","class","style","gap","onApplyFilters","onRowSelectChange","updateSelectedTasks","autoClose","ref","el","onConfirmModal","bind","onCancelModal","iconAvailable","icon","leftBtnText","locales","Lcz_Cancel","rightBtnText","Lcz_Confirm","leftBtnColor","rightBtnColor","modalTitle","Lcz_Confirmation","modalBody","_d","open","onIrSidebarToggle","showCloseButton","getToken","slot","PropertyService","params","data","axios","post","ExceptionMsg","calendar_data","adultChildConstraints","adult_child_constraints","allowedBookingSources","allowed_booking_sources","allowed_payment_methods","currency","is_vacation_rental","pickup_service","max_nights","roomsInfo","roomtypes","taxes","country","is_automatic_check_in_out","tax_statement","is_frontdesk_enabled","is_pms_enabled","spitTime","time_constraints","check_out_till","split","checkin_checkout_hours","offset","city","gmt_offset","hour","Number","minute","getCountrySales","My_Params_Get_Country_Sales","Link_excel","setExposedCleaningFrequency","getMonthlyStats","My_Params_Get_Monthly_Stats","irHousekeepingCss","IrHousekeepingStyle0","IrHousekeeping","propertyService","initializeApp","handleResetData","include_sales_rate_plans","updateHKStore","housekeeping_enabled","selectedCleaningFrequency","saveAutomaticCheckInCheckout","SetAutomaticCheckInOut","default_properties","flag","toast","emit","position","title","type","saveCleaningFrequency","Lcz_HouseKeepingAndCheckInSetup","borderShown","label","Lcz_CheckInOutGuestsAutomatically","LabelAvailable","showFirstOption","selectedValue","onSelectChange","text","Lcz_YesAsPerPropertyPolicy","Lcz_NoIWillDoItManually","Lcz_CleaningFrequency","v","isRequestPending","irMonthlyBookingsReportCss","IrMonthlyBookingsReportStyle0","IrMonthlyBookingsReport","isPageLoading","reports","tokenService","baseFilters","firstOfMonth","startOf","lastOfMonth","endOf","include_previous_year","handleTicketChange","handleApplyFiltersChange","getReports","isExportToExcel","getReportObj","report","day","Date","units_booked","Units_booked","occupancy_percent","Occupancy","adr","ADR","rooms_revenue","Rooms_Revenue","total_guests","Total_Guests","add","currentReports","enrichedReports","DailyStats","rest","__rest$1","stats","previousYearReports","formattedReports","current","previous","prev","last_year","size","btn_color","Lcz_Export","onClickHandler","async","btnStyle","height","iconPosition","icon_name","icon_style","alignItems","Occupancy_Difference_From_Previous_Month","cardTitle","AverageOccupancy","toFixed","subtitle","_e","_f","TotalUnitsBooked","_g","toString","_j","_h","reduce","curr","_k","PeakDays","_m","_l","pd","concat","join","Math","max","_o","OccupancyPercent","irSalesByCountryCss","IrSalesByCountryStyle0","IrSalesByCountry","countries","bookingService","BookingService","FROM_DATE","TO_DATE","BOOK_CASE","WINDOW","salesFilters","getCountries","mappedCountries","formatSalesData","COUNTRY","country_id","COUNTRY_ID","nights","NIGHTS","percentage","PCT","revenue","REVENUE","number_of_guests","filterParams","__rest","currentSales","AC_ID","shouldFetchPreviousYear","enrichedSales","previousYearSales","subtract","toLowerCase","record","salesData","sort","a","b","records","irUserManagementCss","IrUserManagementStyle0","IrUserManagement","isSuperAdmin","users","allowedUsersTypes","userService","UserService","userTypes","superAdminId","fetchUsers","fetchUserTypes","socket","io","on","msg","handleSocketMessage","msgAsObject","JSON","parse","REASON","KEY","PAYLOAD","result","reasonHandlers","EMAIL_VERIFIED","updateUserVerificationStatus","handler","call","warn","idx","findIndex","u","is_email_verified","getExposedPropertyUsers","u1","u2","priority","p1","p2","username","localeCompare","res","getSetupEntriesByTableName","getLov","allowedUsers","allowed_user_types","toUpperCase","f","CODE_NAME","disconnectedCallback","disconnect","suppressToastEndpoints","Lcz_ExtranetUsers","baseUserTypeCode","userTypeCode","haveAdminPrivileges","includes"],"sources":["src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.css?tag=ir-hk-tasks&encapsulation=scoped","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.tsx","src/services/property.service.ts","src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.css?tag=ir-monthly-bookings-report&encapsulation=scoped","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.tsx","src/components/ir-sales-by-country/ir-sales-by-country.css?tag=ir-sales-by-country&encapsulation=scoped","src/components/ir-sales-by-country/ir-sales-by-country.tsx","src/components/ir-user-management/ir-user-management.css?tag=ir-user-management&encapsulation=scoped","src/components/ir-user-management/ir-user-management.tsx"],"sourcesContent":[":host {\n  display: block;\n  box-sizing: border-box;\n}\n:host * {\n  box-sizing: border-box;\n}\n\n@media only screen and (min-width: 900px) {\n  /* td {\n    min-width: 140px !important;\n    width: max-content !important;\n  } */\n}\n@media only screen and (max-width: 900px) {\n  /* td {\n    min-width: 100px !important;\n  } */\n  /* .table-container {\n    width: max-content !important;\n  } */\n}\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n}\n\n.tasks-view {\n  display: flex;\n  flex-direction: column;\n}\n/*lg*/\n@media (min-width: 1024px) {\n  .tasks-view {\n    flex-direction: row;\n  }\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { IPendingActions, Task } from '@/models/housekeeping';\nimport Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport housekeeping_store from '@/stores/housekeeping.store';\n// import { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, h, Element, Watch, Event, EventEmitter, Listen } from '@stencil/core';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { TaskFilters } from './types';\nimport { downloadFile } from '@/utils/utils';\nimport { updateTasks as updateTasksStore, updateSelectedTasks, clearSelectedTasks, hkTasksStore, setLoading } from '@/stores/hk-tasks.store';\n\n@Component({\n  tag: 'ir-hk-tasks',\n  styleUrl: 'ir-hk-tasks.css',\n  scoped: true,\n})\nexport class IrHkTasks {\n  @Element() el: HTMLElement;\n\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n  @State() isCleaningLoading = false;\n  @State() selectedDuration = '';\n  @State() selectedHouseKeeper = '0';\n  @State() selectedRoom: IPendingActions | null = null;\n  @State() archiveOpened = false;\n  @State() property_id: number;\n  @State() isSidebarOpen: boolean;\n  @State() isApplyFiltersLoading: boolean;\n  @State() filters: TaskFilters;\n  @State() modalCauses: { task?: Task; cause: 'skip' | 'clean' };\n\n  @Event({ bubbles: true, composed: true }) clearSelectedHkTasks: EventEmitter<void>;\n\n  private hkNameCache: Record<number, string> = {};\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private token = new Token();\n  private table_sorting: Map<string, 'ASC' | 'DESC'> = new Map();\n  private modal: HTMLIrModalElement;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.init();\n  }\n\n  @Listen('closeSideBar')\n  handleCloseSidebar(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.isSidebarOpen = false;\n  }\n  @Listen('sortingChanged')\n  handleSortingChanged(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { field, direction } = e.detail;\n    console.log(e.detail);\n    if (field === 'date') {\n      return;\n    }\n    this.table_sorting.set(field, direction);\n  }\n  @Listen('skipSelectedTask')\n  handleSkipSelectedTask(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { task: e.detail, cause: 'skip' };\n    this.modal?.openModal();\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      setLoading(true);\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [\n        this.houseKeepingService.getHkTasks({ property_id: this.property_id, from_date: moment().format('YYYY-MM-DD'), to_date: moment().format('YYYY-MM-DD') }),\n        this.houseKeepingService.getExposedHKSetup(this.property_id),\n        this.roomService.fetchLanguage(this.language),\n      ];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      const tasksResult = results[0] as any;\n      // updateTaskList();\n      if (tasksResult?.tasks) {\n        this.updateTasks(tasksResult.tasks);\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n      setLoading(false);\n    }\n  }\n\n  private buildHousekeeperNameCache() {\n    this.hkNameCache = {};\n    housekeeping_store.hk_criteria?.housekeepers?.forEach(hk => {\n      if (hk.id != null && hk.name != null) {\n        this.hkNameCache[hk.id] = hk.name;\n      }\n    });\n  }\n\n  private updateTasks(tasks: any[]) {\n    this.buildHousekeeperNameCache();\n    updateTasksStore(\n      tasks.map(t => ({\n        ...t,\n        id: v4(),\n        housekeeper: (() => {\n          const name = this.hkNameCache[t.hkm_id];\n          if (name) {\n            return name;\n          }\n          const hkName = housekeeping_store.hk_criteria?.housekeepers?.find(hk => hk.id === t.hkm_id)?.name;\n          this.hkNameCache[t.hkm_id] = hkName;\n          return hkName;\n        })(),\n      })),\n    );\n  }\n  @Listen('headerButtonPress')\n  async handleHeaderButtonPress(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { name } = e.detail;\n    switch (name) {\n      case 'cleaned':\n        this.modal?.openModal();\n        break;\n      case 'export':\n        const sortingArray: { key: string; value: string }[] = Array.from(this.table_sorting.entries()).map(([key, value]) => ({\n          key,\n          value,\n        }));\n        console.log(sortingArray);\n        const { url } = await this.fetchTasksWithFilters(true);\n        downloadFile(url);\n        break;\n      case 'archive':\n        this.isSidebarOpen = true;\n        break;\n    }\n  }\n  @Listen('cleanSelectedTask')\n  handleSelectedTaskCleaningEvent(e: CustomEvent<Task>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { task: e.detail, cause: 'clean' };\n    this.modal?.openModal();\n  }\n\n  private async handleModalConfirmation(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      if (hkTasksStore.selectedTasks.length === 0) {\n        return;\n      }\n      this.isCleaningLoading = true;\n      if (this.modalCauses?.cause === 'skip') {\n        const { booking_nbr, date, unit } = this.modalCauses.task;\n        await this.houseKeepingService.editHkSkip({\n          BOOK_NBR: booking_nbr,\n          DATE: date,\n          COMMENT: '',\n          HK_SKIP_ID: -1,\n          HK_SKIP_REASON_CODE: '001',\n          PR_ID: unit.id,\n        });\n      } else {\n        await this.houseKeepingService.executeHKAction({\n          actions: hkTasksStore.selectedTasks.map(t => ({ description: 'Cleaned', hkm_id: t.hkm_id === 0 ? null : t.hkm_id, unit_id: t.unit.id, booking_nbr: t.booking_nbr })),\n        });\n      }\n      await this.fetchTasksWithFilters();\n    } finally {\n      clearSelectedTasks();\n      if (this.modalCauses) {\n        this.modalCauses = null;\n      }\n      this.isCleaningLoading = false;\n      // this.clearSelectedTasks.emit();\n      this.modal.closeModal();\n    }\n  }\n\n  private async applyFilters(e: CustomEvent) {\n    try {\n      this.isApplyFiltersLoading = true;\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.filters = { ...e.detail };\n      await this.fetchTasksWithFilters();\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isApplyFiltersLoading = false;\n    }\n  }\n\n  private async fetchTasksWithFilters(export_to_excel: boolean = false) {\n    const { cleaning_periods, housekeepers, cleaning_frequencies, dusty_units, highlight_check_ins } = this.filters ?? {};\n\n    const { tasks, url } = await this.houseKeepingService.getHkTasks({\n      housekeepers,\n      cleaning_frequency: cleaning_frequencies?.code,\n      dusty_window: dusty_units?.code,\n      highlight_window: highlight_check_ins?.code,\n      property_id: this.property_id,\n      from_date: moment().format('YYYY-MM-DD'),\n      to_date: cleaning_periods?.code || moment().format('YYYY-MM-DD'),\n      is_export_to_excel: export_to_excel,\n    });\n    console.log(tasks);\n    if (tasks) {\n      this.updateTasks(tasks);\n    }\n    return { tasks, url };\n  }\n\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host data-testid=\"hk_tasks_base\">\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-1 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <h3>Housekeeping Tasks</h3>\n          <div class=\"tasks-view \" style={{ gap: '1rem' }}>\n            <ir-tasks-filters\n              isLoading={this.isApplyFiltersLoading}\n              onApplyFilters={e => {\n                this.applyFilters(e);\n              }}\n            ></ir-tasks-filters>\n            <div class=\"d-flex w-100 flex-column\" style={{ gap: '1rem' }}>\n              <ir-tasks-table\n                onRowSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  updateSelectedTasks(e.detail);\n                }}\n                class=\"flex-grow-1 w-100\"\n              ></ir-tasks-table>\n              {/* <ir-tasks-table-pagination></ir-tasks-table-pagination> */}\n            </div>\n          </div>\n        </section>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.modal = el)}\n          isLoading={this.isCleaningLoading}\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\n          onCancelModal={() => {\n            if (this.modalCauses) {\n              clearSelectedTasks();\n              this.modalCauses = null;\n            }\n          }}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={locales.entries.Lcz_Confirm}\n          leftBtnColor=\"secondary\"\n          rightBtnColor={'primary'}\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={\n            this.modalCauses\n              ? this.modalCauses?.cause === 'clean'\n                ? `Update ${this.modalCauses?.task?.unit?.name} to Clean`\n                : 'Skip cleaning and reschedule for tomorrow.'\n              : 'Update selected unit(s) to Clean'\n          }\n        ></ir-modal>\n        <ir-sidebar\n          open={this.isSidebarOpen}\n          id=\"editGuestInfo\"\n          onIrSidebarToggle={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.isSidebarOpen = false;\n          }}\n          // sidebarStyles={{\n          //   width: '80vw',\n          // }}\n          showCloseButton={false}\n        >\n          {this.isSidebarOpen && <ir-hk-archive ticket={this.token.getToken()} propertyId={this.property_id} slot=\"sidebar-body\"></ir-hk-archive>}\n        </ir-sidebar>\n        {/* <ir-title class=\"d-none d-md-flex\" label={locales.entries.Lcz_HousekeepingTasks} justifyContent=\"space-between\">\n            <ir-button slot=\"title-body\" text={locales.entries.Lcz_Archive} size=\"sm\"></ir-button>\n          </ir-title> */}\n      </Host>\n    );\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport { downloadFile } from '@/utils/utils';\nimport axios from 'axios';\nexport type CountrySalesParams = {\n  AC_ID: number;\n  WINDOW: number;\n  FROM_DATE: string;\n  TO_DATE: string;\n  BOOK_CASE: string;\n  is_export_to_excel: boolean;\n};\nexport type MonthlyStatsParams = {\n  property_id: number;\n  from_date: string;\n  to_date: string;\n  is_export_to_excel?: boolean;\n};\nexport interface MonthlyStatsResults {\n  AverageOccupancy: number;\n  DailyStats: DailyStat[];\n  ExcelLink: null;\n  PeakDays: PeakDay[];\n  Occupancy_Difference_From_Previous_Month: number;\n  TotalUnitsBooked: number;\n}\n\nexport interface PeakDay {\n  Date: string;\n  OccupancyPercent: number;\n}\n\nexport interface DailyStat {\n  Date: string;\n  Occupancy: number;\n  Units_booked: number;\n  Rooms_Revenue: number;\n  ADR: number;\n  Total_Guests: number | undefined;\n}\nexport class PropertyService {\n  public async getExposedProperty(params: {\n    id: number | null;\n    language: string;\n    is_backend?: boolean;\n    aname?: string;\n    include_units_hk_status?: boolean;\n    include_sales_rate_plans?: boolean;\n  }) {\n    try {\n      const { data } = await axios.post(`/Get_Exposed_Property`, params);\n      if (data.ExceptionMsg !== '') {\n        throw new Error(data.ExceptionMsg);\n      }\n      const results = data.My_Result;\n      calendar_data.adultChildConstraints = results.adult_child_constraints;\n      calendar_data.allowedBookingSources = results.allowed_booking_sources;\n      calendar_data.allowed_payment_methods = results.allowed_payment_methods;\n      calendar_data.currency = results.currency;\n      calendar_data.is_vacation_rental = results.is_vacation_rental;\n      calendar_data.pickup_service = results.pickup_service;\n      calendar_data.max_nights = results.max_nights;\n      calendar_data.roomsInfo = results.roomtypes;\n      calendar_data.taxes = results.taxes;\n      calendar_data.id = results.id;\n      calendar_data.country = results.country;\n      calendar_data.name = results.name;\n      calendar_data.is_automatic_check_in_out = results.is_automatic_check_in_out;\n      calendar_data.tax_statement = results.tax_statement;\n      calendar_data.is_frontdesk_enabled = results.is_frontdesk_enabled;\n      calendar_data.is_pms_enabled = results.is_pms_enabled;\n      const spitTime = results?.time_constraints?.check_out_till?.split(':');\n      calendar_data.checkin_checkout_hours = {\n        offset: results.city.gmt_offset,\n        hour: Number(spitTime[0] || 0),\n        minute: Number(spitTime[1] || 0),\n      };\n      return data;\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n  public async getCountrySales(params: CountrySalesParams) {\n    const { data } = await axios.post('/Get_Country_Sales', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    if (params.is_export_to_excel) {\n      downloadFile(data.My_Params_Get_Country_Sales.Link_excel);\n    }\n    return data.My_Result;\n  }\n  public async setExposedCleaningFrequency(params: { property_id: number; code: string }) {\n    const { data } = await axios.post('/Set_Exposed_Cleaning_Frequency', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    return data.My_Result;\n  }\n  public async getMonthlyStats(params: MonthlyStatsParams): Promise<MonthlyStatsResults> {\n    const { data } = await axios.post('/Get_Monthly_Stats', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    if (params.is_export_to_excel) {\n      downloadFile(data.My_Params_Get_Monthly_Stats.Link_excel);\n    }\n    return data.My_Result;\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport calendar_data from '@/stores/calendar-data';\nimport housekeeping_store, { updateHKStore } from '@/stores/housekeeping.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport locales from '@/stores/locales.store';\nimport { PropertyService } from '@/services/property.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n@Component({\n  tag: 'ir-housekeeping',\n  styleUrl: 'ir-housekeeping.css',\n  scoped: true,\n})\nexport class IrHousekeeping {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n\n  @Event() toast: EventEmitter<IToast>;\n\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private propertyService = new PropertyService();\n  private token = new Token();\n  modal: HTMLIrModalElement;\n  selectedCleaningFrequency: any;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  async initializeApp() {\n    try {\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_sales_rate_plans: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\n      const requests: Array<Promise<any>> = [];\n      if (calendar_data.housekeeping_enabled) {\n        requests.push(this.houseKeepingService.getExposedHKSetup(propertyId));\n      }\n      requests.push(this.roomService.fetchLanguage(this.language, ['_HK_FRONT', '_PMS_FRONT']));\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: propertyId,\n            language: this.language,\n            is_backend: true,\n            include_sales_rate_plans: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private async saveAutomaticCheckInCheckout(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.roomService.SetAutomaticCheckInOut({\n        property_id: housekeeping_store.default_properties.property_id,\n        flag: e.detail === 'auto',\n      });\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async saveCleaningFrequency(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.propertyService.setExposedCleaningFrequency({\n        property_id: housekeeping_store.default_properties.property_id,\n        code: this.selectedCleaningFrequency,\n      });\n      calendar_data.cleaning_frequency = { code: this.selectedCleaningFrequency, description: '' };\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n      this.modal.closeModal();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    console.log(calendar_data.cleaning_frequency);\n    return (\n      <Host>\n        <ir-interceptor></ir-interceptor>\n        <ir-toast></ir-toast>\n        <section class=\"p-1\">\n          <h3 class=\"mb-2\">{locales.entries.Lcz_HouseKeepingAndCheckInSetup}</h3>\n          <div class=\"card p-1\">\n            <ir-title borderShown label=\"Operations Settings\"></ir-title>\n            <div class={'d-flex align-items-center mb-1'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CheckInOutGuestsAutomatically}</p>\n              <ir-select\n                LabelAvailable={false}\n                showFirstOption={false}\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\n                data={[\n                  { text: locales.entries.Lcz_YesAsPerPropertyPolicy, value: 'auto' },\n                  { text: locales.entries.Lcz_NoIWillDoItManually, value: 'manual' },\n                ]}\n              ></ir-select>\n            </div>\n            <div class={'d-flex align-items-center'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CleaningFrequency}:</p>\n              <ir-select\n                LabelAvailable={false}\n                showFirstOption={false}\n                selectedValue={this.selectedCleaningFrequency}\n                onSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.selectedCleaningFrequency = e.detail;\n                  this.modal.openModal();\n                }}\n                data={housekeeping_store?.hk_criteria?.cleaning_frequencies.map(v => ({\n                  text: v.description,\n                  value: v.code,\n                }))}\n              ></ir-select>\n            </div>\n          </div>\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\n          {calendar_data.housekeeping_enabled && <ir-hk-team class=\"mb-1\"></ir-hk-team>}\n          <ir-modal\n            autoClose={false}\n            ref={el => (this.modal = el)}\n            isLoading={isRequestPending('/Set_Exposed_Cleaning_Frequency')}\n            onConfirmModal={this.saveCleaningFrequency.bind(this)}\n            iconAvailable={true}\n            onCancelModal={() => {\n              this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n            }}\n            icon=\"ft-alert-triangle danger h1\"\n            leftBtnText={locales.entries.Lcz_Cancel}\n            rightBtnText={locales.entries.Lcz_Confirm}\n            leftBtnColor=\"secondary\"\n            rightBtnColor={'primary'}\n            modalTitle={locales.entries.Lcz_Confirmation}\n            modalBody={'This action will reschedule all cleaning tasks. Do you want to continue?'}\n          ></ir-modal>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { DailyReport, DailyReportFilter } from './types';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { RoomService } from '@/services/room.service';\nimport { DailyStat, MonthlyStatsResults, PropertyService } from '@/services/property.service';\n\n@Component({\n  tag: 'ir-monthly-bookings-report',\n  styleUrl: 'ir-monthly-bookings-report.css',\n  scoped: true,\n})\nexport class IrMonthlyBookingsReport {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isPageLoading = true;\n  @State() isLoading: 'export' | 'filter' | null = null;\n\n  @State() reports: DailyReport[] = [];\n  @State() filters: DailyReportFilter;\n  @State() property_id: number;\n  @State() stats: Omit<MonthlyStatsResults, 'DailyStats'>;\n\n  private baseFilters: DailyReportFilter;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n\n  componentWillLoad() {\n    this.baseFilters = {\n      date: {\n        description: moment().format('MMMM YYYY'),\n        firstOfMonth: moment().startOf('month').format('YYYY-MM-DD'),\n        lastOfMonth: moment().endOf('month').format('YYYY-MM-DD'),\n      },\n      include_previous_year: false,\n    };\n    this.filters = this.baseFilters;\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Listen('applyFilters')\n  handleApplyFiltersChange(e: CustomEvent<DailyReportFilter>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.filters = e.detail;\n    this.getReports();\n  }\n\n  private async init() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.roomService.fetchLanguage(this.language), this.getReports()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getReports(isExportToExcel = false) {\n    try {\n      const getReportObj = (report: DailyStat): DailyReport => {\n        return {\n          day: report.Date,\n          units_booked: report.Units_booked,\n          occupancy_percent: report.Occupancy,\n          adr: report.ADR,\n          rooms_revenue: report.Rooms_Revenue,\n          total_guests: report?.Total_Guests,\n        };\n      };\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n      const { date, include_previous_year } = this.filters;\n\n      const requests = [\n        this.propertyService.getMonthlyStats({\n          from_date: date.firstOfMonth,\n          to_date: date.lastOfMonth,\n          property_id: this.property_id,\n          is_export_to_excel: isExportToExcel,\n        }),\n      ];\n\n      if (include_previous_year) {\n        requests.push(\n          this.propertyService.getMonthlyStats({\n            from_date: moment(date.firstOfMonth, 'YYYY-MM-DD').add(-1, 'year').format('YYYY-MM-DD'),\n            to_date: moment(date.lastOfMonth, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'),\n            property_id: this.property_id,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      const currentReports = results[0];\n      let enrichedReports: DailyReport[] = [];\n      const { DailyStats, ...rest } = currentReports;\n\n      this.stats = { ...rest };\n\n      if (include_previous_year && results[isExportToExcel ? 1 : 2]) {\n        const previousYearReports = results[isExportToExcel ? 1 : 2];\n        let formattedReports = previousYearReports.DailyStats.map(getReportObj);\n        enrichedReports = DailyStats.map(getReportObj).map(current => {\n          const previous = formattedReports.find(prev => prev.day === moment(current.day, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'));\n          return {\n            ...current,\n            last_year: previous ?? null,\n          };\n        });\n      } else {\n        enrichedReports = DailyStats.map(getReportObj);\n      }\n      this.reports = [...enrichedReports];\n    } catch (e) {\n      console.log(e);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Daily Occupancy</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries?.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getReports(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <section>\n            <div class=\"d-flex flex-column flex-md-row w-100\" style={{ gap: '1rem', alignItems: 'stretch' }}>\n              <ir-report-stats-card\n                icon={this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? 'arrow-trend-down' : 'arrow-trend-up'}\n                cardTitle=\"Average Occupancy\"\n                value={this.stats.AverageOccupancy ? this.stats?.AverageOccupancy.toFixed(2) + '%' : null}\n                subtitle={`${this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? '' : '+'}${this.stats?.Occupancy_Difference_From_Previous_Month.toFixed(\n                  2,\n                )}% from last month`}\n              ></ir-report-stats-card>\n\n              <ir-report-stats-card\n                icon=\"hotel\"\n                cardTitle=\"Total Units\"\n                value={this.stats?.TotalUnitsBooked ? this.stats?.TotalUnitsBooked.toString() : null}\n                subtitle=\"Booked\"\n              ></ir-report-stats-card>\n\n              <ir-report-stats-card\n                icon=\"user_group\"\n                cardTitle=\"Total Guests\"\n                value={this.reports?.reduce((prev, curr) => prev + curr.total_guests, 0)?.toString()}\n                subtitle=\"Stayed\"\n              ></ir-report-stats-card>\n\n              <ir-report-stats-card\n                icon=\"calendar\"\n                cardTitle=\"Peak Days\"\n                value={this.stats?.PeakDays.length === 0 ? null : this.stats?.PeakDays?.map(pd => moment(pd.Date, 'YYYY-MM-DD').format('D').concat('th')).join(' - ')}\n                subtitle={`${Math.max(...(this.stats.PeakDays?.map(pd => pd.OccupancyPercent) || []))}% occupancy`}\n              ></ir-report-stats-card>\n            </div>\n            <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n              <ir-monthly-bookings-report-filter isLoading={this.isLoading === 'filter'} class=\"filters-card\" baseFilters={this.baseFilters}></ir-monthly-bookings-report-filter>\n              <ir-monthly-bookings-report-table reports={this.reports}></ir-monthly-bookings-report-table>\n            </div>\n          </section>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { BaseSalesRecord, CountrySalesFilter, MappedCountries, SalesRecord } from './types';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry } from '@/models/IBooking';\n\n@Component({\n  tag: 'ir-sales-by-country',\n  styleUrl: 'ir-sales-by-country.css',\n  scoped: true,\n})\nexport class IrSalesByCountry {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isLoading: 'filter' | 'export' | null = null;\n  @State() isPageLoading = true;\n  @State() property_id: number;\n  @State() salesData: SalesRecord[];\n  @State() salesFilters: CountrySalesFilter;\n  @State() countries: MappedCountries = new Map();\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private bookingService = new BookingService();\n\n  private baseFilters = {\n    FROM_DATE: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    TO_DATE: moment().format('YYYY-MM-DD'),\n    BOOK_CASE: '001',\n    WINDOW: 7,\n    include_previous_year: false,\n  };\n\n  componentWillLoad() {\n    this.salesFilters = this.baseFilters;\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n  private async initializeApp() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.bookingService.getCountries(this.language), this.roomService.fetchLanguage(this.language), this.getCountrySales()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const [countries] = await Promise.all(requests);\n      const mappedCountries = new Map();\n      (countries as ICountry[]).map(country => {\n        mappedCountries.set(country.id, {\n          flag: country.flag,\n          name: country.name,\n        });\n      });\n      this.countries = mappedCountries;\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getCountrySales(isExportToExcel = false) {\n    const formatSalesData = (data): Omit<BaseSalesRecord, 'id'> => {\n      return {\n        country: data.COUNTRY,\n        country_id: data.COUNTRY_ID,\n        nights: data.NIGHTS,\n        percentage: data.PCT,\n        revenue: data.REVENUE,\n        number_of_guests: data.Total_Guests,\n      };\n    };\n    try {\n      const { include_previous_year, ...filterParams } = this.salesFilters;\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n\n      const currentSales = await this.propertyService.getCountrySales({\n        AC_ID: this.property_id,\n        is_export_to_excel: isExportToExcel,\n        ...filterParams,\n      });\n\n      const shouldFetchPreviousYear = !isExportToExcel && include_previous_year;\n\n      let enrichedSales: SalesRecord[] = [];\n\n      if (shouldFetchPreviousYear) {\n        const previousYearSales = await this.propertyService.getCountrySales({\n          AC_ID: this.property_id,\n          is_export_to_excel: false,\n          ...filterParams,\n          FROM_DATE: moment(filterParams.FROM_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n          TO_DATE: moment(filterParams.TO_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n        });\n\n        enrichedSales = currentSales.map(current => {\n          const previous = previousYearSales.find(prev => prev.COUNTRY.toLowerCase() === current.COUNTRY.toLowerCase());\n          return {\n            id: v4(),\n            ...formatSalesData(current),\n            last_year: previous ? formatSalesData(previous) : null,\n          };\n        });\n      } else {\n        enrichedSales = currentSales.map(record => ({\n          id: v4(),\n          ...formatSalesData(record),\n          last_year: null,\n        }));\n      }\n\n      this.salesData = enrichedSales.sort((a, b) => {\n        if (a.country_id === 0) return -1;\n        if (b.country_id === 0) return 1;\n        return 0;\n      });\n    } catch (error) {\n      console.error('Failed to fetch sales data:', error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Sales by Country</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getCountrySales(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n            <ir-sales-filters\n              isLoading={this.isLoading === 'filter'}\n              onApplyFilters={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.salesFilters = e.detail;\n                this.getCountrySales();\n              }}\n              class=\"filters-card\"\n              baseFilters={this.baseFilters}\n            ></ir-sales-filters>\n            <ir-sales-table mappedCountries={this.countries} class=\"card mb-0\" records={this.salesData}></ir-sales-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  height: 100%;\n}\n","import Token from '@/models/Token';\nimport { User } from '@/models/Users';\nimport { BookingService } from '@/services/booking.service';\nimport { RoomService } from '@/services/room.service';\nimport { UserService } from '@/services/user.service';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { AllowedUser } from './types';\nimport { bookingReasons } from '@/models/IBooking';\nimport { io, Socket } from 'socket.io-client';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'ir-user-management',\n  styleUrl: 'ir-user-management.css',\n  scoped: true,\n})\nexport class IrUserManagement {\n  @Prop() language: string = '';\n  @Prop() baseUrl: string;\n  @Prop() ticket: string;\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() isSuperAdmin: boolean = true;\n  @Prop() userTypeCode: string | number;\n  @Prop() baseUserTypeCode: string | number;\n  @Prop() userId: string | number;\n\n  @State() isLoading = true;\n  @State() users: User[] = [];\n  @State() property_id: number;\n  @State() allowedUsersTypes: AllowedUser[] = [];\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private userService = new UserService();\n  private bookingService = new BookingService();\n\n  private userTypes: Map<number | string, string> = new Map();\n  private socket: Socket;\n\n  private superAdminId = '5';\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.fetchUsers();\n  }\n\n  private async initializeApp() {\n    try {\n      if (this.baseUrl) {\n        this.token.setBaseUrl(this.baseUrl);\n      }\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.fetchUserTypes(), this.fetchUsers(), this.roomService.fetchLanguage(this.language, ['_USER_MGT'])];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.socket = io('https://realtime.igloorooms.com/');\n      this.socket.on('MSG', async msg => {\n        await this.handleSocketMessage(msg);\n      });\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private async handleSocketMessage(msg: string) {\n    const msgAsObject = JSON.parse(msg);\n    if (!msgAsObject) {\n      return;\n    }\n\n    const { REASON, KEY, PAYLOAD }: { REASON: bookingReasons; KEY: any; PAYLOAD: any } = msgAsObject;\n\n    if (KEY.toString() !== this.property_id.toString()) {\n      return;\n    }\n\n    let result = JSON.parse(PAYLOAD);\n    console.log(KEY, result);\n    // const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n    //   DORESERVATION: this.updateUserVerificationStatus,\n    // };\n    const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n      EMAIL_VERIFIED: this.updateUserVerificationStatus,\n    };\n    const handler = reasonHandlers[REASON];\n    if (handler) {\n      await handler.call(this, result);\n    } else {\n      console.warn(`Unhandled REASON: ${REASON}`);\n    }\n  }\n\n  public updateUserVerificationStatus(result: { id: string | number }) {\n    const users = [...this.users];\n    const idx = users.findIndex(u => u.id === result.id);\n    if (idx === -1) {\n      console.warn(`User ${result.id} not found`);\n      return;\n    }\n    users[idx] = {\n      ...users[idx],\n      is_email_verified: true,\n    };\n    this.users = users;\n  }\n\n  private async fetchUsers() {\n    const users = await this.userService.getExposedPropertyUsers({ property_id: this.propertyid });\n    this.users = [...users].sort((u1: User, u2: User) => {\n      const priority = (u: User) => {\n        const t = u.type.toString();\n        if (t === this.superAdminId) return 0;\n        if (t === '17') return 1;\n        return 2;\n      };\n      //sort by priority\n      const p1 = priority(u1),\n        p2 = priority(u2);\n      if (p1 !== p2) {\n        return p1 - p2;\n      }\n      // //sort by user id\n      // if (p1 === 1) {\n      //   const id1 = u1.id.toString(),\n      //     id2 = u2.id.toString(),\n      //     me = this.userId.toString();\n      //   if (id1 === me) return -1; // u1 is me  goes before u2\n      //   if (id2 === me) return 1; // u2 is me  u1 goes after\n      // }\n\n      // 3) sort by username\n      return u1.username.localeCompare(u2.username);\n    });\n  }\n  private async fetchUserTypes() {\n    const res = await Promise.all([this.bookingService.getSetupEntriesByTableName('_USER_TYPE'), this.bookingService.getLov()]);\n    const allowedUsers = res[1]?.My_Result?.allowed_user_types;\n    for (const e of res[0]) {\n      const value = e[`CODE_VALUE_${this.language?.toUpperCase() ?? 'EN'}`];\n      if (allowedUsers.find(f => f.code === e.CODE_NAME)) {\n        this.allowedUsersTypes.push({ code: e.CODE_NAME, value });\n      }\n      this.userTypes.set(e.CODE_NAME.toString(), value);\n    }\n  }\n  disconnectedCallback() {\n    this.socket.disconnect();\n  }\n  render() {\n    if (this.isLoading) {\n      return (\n        <Host>\n          <ir-toast></ir-toast>\n          <ir-interceptor></ir-interceptor>\n          <ir-loading-screen></ir-loading-screen>\n        </Host>\n      );\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor suppressToastEndpoints={['/Change_User_Pwd', '/Handle_Exposed_User']}></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex  pb-2 align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">{locales.entries.Lcz_ExtranetUsers}</h3>\n          </div>\n\n          <div class=\"\" style={{ gap: '1rem' }}>\n            <ir-user-management-table\n              property_id={this.property_id}\n              baseUserTypeCode={this.baseUserTypeCode}\n              allowedUsersTypes={this.allowedUsersTypes}\n              userTypeCode={this.userTypeCode}\n              haveAdminPrivileges={[this.superAdminId, '17'].includes(this.userTypeCode?.toString())}\n              userTypes={this.userTypes}\n              class=\"card\"\n              isSuperAdmin={this.userTypeCode?.toString() === this.superAdminId}\n              users={this.users}\n            ></ir-user-management-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}