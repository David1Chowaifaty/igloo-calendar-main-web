import{r as t,h as e,H as i,c as s,F as n,g as o}from"./p-ee49d535.js";import{b as r,m as a,B as l,c,r as h,a as d,u,g as f}from"./p-5e9dba2a.js";import{l as p}from"./p-806fad31.js";import{i as b,c as g}from"./p-8e74896a.js";import{f as m,e as v,g as y,d as k,i as w,a as x,b as _,z as D,v as C,c as O,h as E,j as A,k as B,l as M,Z as T,r as I,m as S,n as Y,o as N}from"./p-e8210c5c.js";import{v as L}from"./p-4ed69de7.js";import{c as j,t as R,a as z,b as F,d as P,g as H,f as V}from"./p-ab96d87a.js";import{h as U}from"./p-6c4ba7c0.js";import{i as G,a as K}from"./p-c71f0e9e.js";import{a as W}from"./p-06203439.js";import{H as q}from"./p-f055842b.js";import{c as X}from"./p-4eb12235.js";import{R as J}from"./p-4bd413fa.js";import{T as Z}from"./p-972be3f6.js";import{P as Q}from"./p-a2cce413.js";import{_ as tt,a as et,b as it}from"./p-84f11abc.js";import"./p-27b56378.js";class st{formatVariationBasedOnInfants(t){const e=this.getVariationBasedOnInfants(t);return this.formatVariation(e,t.infants)}calculateVariationAmount(t){var e;return((e=this.getVariationBasedOnInfants(t))===null||e===void 0?void 0:e.discounted_amount)||0}getVariationBasedOnInfants({variations:t,baseVariation:e,infants:i}){const{adult_nbr:s,child_nbr:n}=e;return t.find((t=>t.adult_nbr===s&&t.child_nbr===Math.max(0,n-Math.max(0,i))))||e}formatVariation({child_nbr:t,adult_nbr:e},i){var s,n,o,r;const a=Number(e)||0;const l=Math.max(Number(i)||0,0);const c=a>1?p.entries.Lcz_Adults.toLowerCase():p.entries.Lcz_Adult.toLowerCase();const h=t>1?p.entries.Lcz_Children.toLowerCase():p.entries.Lcz_Child.toLowerCase();const d=l>1?(n=(s=p.entries["Lcz_Infants"])!==null&&s!==void 0?s:"infants")===null||n===void 0?void 0:n.toLowerCase():(r=(o=p===null||p===void 0?void 0:p.entries["Lcz_Infant"])!==null&&o!==void 0?o:"infant")===null||r===void 0?void 0:r.toLowerCase();const u=[`${a} ${c}`,t?`${t} ${h}`:"",l?`${l} ${d}`:""];return u.filter(Boolean).join("&nbsp&nbsp&nbsp&nbsp")}}const nt=".sc-igl-application-info-h{display:block}.rate_amount.sc-igl-application-info{display:none;padding:0;margin:0}.booking-header.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;margin-bottom:0.5rem;gap:0.5rem}.non-ref-span.sc-igl-application-info{font-size:12px;color:var(--green)}.booking-roomtype-title.sc-igl-application-info{font-size:1.25rem;margin-right:0.5rem;margin:0;padding:0}.booking-details-container.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin:0}.booking-rateplan.sc-igl-application-info{display:flex;align-items:center;gap:0.5rem;margin:0;padding:0}.booking-rateplan-name.sc-igl-application-info{font-weight:bold;margin:0;padding:0}.booking-tooltip.sc-igl-application-info{margin-right:0.5rem;margin:0;padding:0}.booking-variation.sc-igl-application-info{margin:0;padding:0}.booking-price.sc-igl-application-info{margin:0;padding:0}.booking-footer.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin-bottom:0.5rem}.booking-details-container.sc-igl-application-info{display:none}@media (min-width: 768px){.booking-header.sc-igl-application-info{justify-content:flex-start}.booking-footer.sc-igl-application-info,.booking-price.sc-igl-application-info{display:none}.booking-details-container.sc-igl-application-info,.rate_amount.sc-igl-application-info{display:inline-flex;gap:0.5rem}}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:80%}.guest-info-container.sc-igl-application-info{max-width:300px}.preference-select-container.sc-igl-application-info{max-width:250px}}";const ot=nt;const rt=class{constructor(e){t(this,e);this.variationService=new st;this.rateplanSelection=undefined;this.guestInfo=undefined;this.currency=undefined;this.bedPreferenceType=[];this.bookingType="PLUS_BOOKING";this.roomIndex=undefined;this.totalNights=1;this.baseData=undefined;this.isButtonPressed=false}componentWillLoad(){var t,e;if(b(this.rateplanSelection.roomtype.id)){const i=this.filterRooms();if(i.length>0)this.updateGuest({unit:(e=(t=i[0])===null||t===void 0?void 0:t.id)===null||e===void 0?void 0:e.toString()})}}updateGuest(t){const e=this.rateplanSelection.roomtype.id;const i=this.rateplanSelection.ratePlan.id;let s=[...this.rateplanSelection.guest];s[this.roomIndex]=Object.assign(Object.assign({},s[this.roomIndex]),t);r.ratePlanSelections=Object.assign(Object.assign({},r.ratePlanSelections),{[e]:Object.assign(Object.assign({},r.ratePlanSelections[e]),{[i]:Object.assign(Object.assign({},this.rateplanSelection),{guest:[...s]})})})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}getTooltipMessages(){var t,e,i,s,n,o,r;const{ratePlan:a,selected_variation:l}=this.rateplanSelection;let c=l;if((t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr){c=this.variationService.getVariationBasedOnInfants({variations:a.variations,baseVariation:l,infants:(e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr})}if(!c)return;const h=(i=a.variations)===null||i===void 0?void 0:i.find((t=>t.adult_nbr===c.adult_nbr&&t.child_nbr===c.child_nbr));if(!h)return;const d=(n=(s=h.applicable_policies)===null||s===void 0?void 0:s.find((t=>t.type==="cancelation")))===null||n===void 0?void 0:n.combined_statement;const u=(r=(o=h.applicable_policies)===null||o===void 0?void 0:o.find((t=>t.type==="guarantee")))===null||r===void 0?void 0:r.combined_statement;let f="";if(d){f+=`<b><u>Cancellation:</u></b> ${d}<br/>`}if(u){f+=`<b><u>Guarantee:</u></b> ${u}`}return f||undefined}getAmount(){var t,e;if(this.rateplanSelection.is_amount_modified){return this.rateplanSelection.view_mode==="001"?this.rateplanSelection.rp_amount:this.rateplanSelection.rp_amount*this.totalNights}let i=this.rateplanSelection.selected_variation;if((t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr){i=this.variationService.getVariationBasedOnInfants({variations:this.rateplanSelection.ratePlan.variations,baseVariation:this.rateplanSelection.selected_variation,infants:(e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr})}return i.discounted_gross_amount}filterRooms(){var t,e,i,s;const n=[];if(!g.is_frontdesk_enabled){return n}(e=(t=this.rateplanSelection.ratePlan)===null||t===void 0?void 0:t.assignable_units)===null||e===void 0?void 0:e.forEach((t=>{if(t.Is_Fully_Available){n.push({name:t.name,id:t.pr_id})}}));const o=this.rateplanSelection.guest.filter(((t,e)=>e!==this.roomIndex)).map((t=>t.unit));const r=n.filter((t=>!o.includes(t.id.toString())));return this.bookingType==="EDIT_BOOKING"?[...r,this.rateplanSelection.roomtype.id===((i=this.baseData)===null||i===void 0?void 0:i.roomtypeId)?(s=this.baseData)===null||s===void 0?void 0:s.unit:null].filter((t=>!!t)).sort(((t,e)=>t.name.localeCompare(e.name))):r}render(){var t,s,n,o,l,c,h,d,u,f,v,y,k;const w=this.filterRooms();const x=this.variationService.formatVariationBasedOnInfants({baseVariation:this.rateplanSelection.selected_variation,infants:this.guestInfo.infant_nbr,variations:this.rateplanSelection.ratePlan.variations});return e(i,{key:"e20f00fa856652e40ce7646fbfe5ed622ed0ea1c",class:"my-2"},e("div",{key:"c7478afc5c20e8b9c3281d2bef35825e294c5948",class:"booking-header"},(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&e("span",{key:"d8ee5fe042a910e5b062db10a2a5286215c88adf",class:"booking-roomtype-title"},this.rateplanSelection.roomtype.name),e("div",{key:"320d58e64c019c487ef1f6dd942c4bcd40f46d03",class:"booking-details-container"},e("div",{key:"0ab9c735787d3e4577637447ddfc228f28788142",class:"booking-rateplan"},e("p",{key:"348f0fb657122f8a22b2ec2387c531074aeec8f9",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name," ",this.rateplanSelection.ratePlan.is_non_refundable&&e("span",{key:"d7171c22f8831e72ecc85abef9dd426dd7331db3",class:"non-ref-span"},"Non Refundable")),e("ir-tooltip",{key:"7058c546d2b85b949d61ee827dacc2f6620ec60f",class:"booking-tooltip",message:this.getTooltipMessages()})),e("p",{key:"5d85fd89cfe7c99ef5700b0ee2eff50042df50bb",class:"booking-variation",innerHTML:x})),e("p",{key:"b49e7c5884d730c596239a11ace99ec3a76c5146",class:"booking-price"},m((t=this.currency)===null||t===void 0?void 0:t.symbol,this.getAmount()),"/",p.entries.Lcz_Stay)),e("div",{key:"d76c993bf2272ae4ab9df96da7a74a8974711ef4",class:"booking-footer"},e("div",{key:"62c603b3e4d41dabccbad52ff53e2fe6532f2487",class:"booking-rateplan"},e("p",{key:"61933ce1495bfe4ddded0f59dd7a81d4f4853bcb",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name),e("ir-tooltip",{key:"3e71bed258f555ca86253767574dbf2d88c05796",class:"booking-tooltip",message:this.getTooltipMessages()})),e("p",{key:"42881bb8773e05eb69668e32a88d6d90270b4bab",class:"booking-variation",innerHTML:x})),e("div",{key:"a58e58070d1b080047acfc1d83c21e1f87701a1b",class:"d-flex flex-column flex-md-row  p-0 align-items-md-center aplicationInfoContainer"},e("div",{key:"fd1169923f63651d3f8019ab2b696bca2d6d9f94",class:"mr-1 mb-1 mb-md-0 flex-fill guest-info-container"},e("input",{key:"efdefccbd9cf54657cfb3395c71f0159fef7a6f3",id:L(),type:"email",class:`form-control ${this.isButtonPressed&&((s=this.guestInfo)===null||s===void 0?void 0:s.first_name)===""&&"border-danger"}`,placeholder:(n=p.entries["Lcz_GuestFirstname"])!==null&&n!==void 0?n:"Guest first name",name:"guestName",onInput:t=>{const e=t.target.value;this.updateGuest({first_name:e});if(r.event_type.type==="EDIT_BOOKING"){a("guest",Object.assign(Object.assign({},r.guest),{name:e}))}},required:true,value:(o=this.guestInfo)===null||o===void 0?void 0:o.first_name})),e("div",{key:"de2a6eed3d20aa6cd01c385a01ddfdf5f5b26eab",class:"mr-1 flex-fill guest-info-container"},e("input",{key:"a8ea8d150ba614ca2c066edfd85200a7d79a00e5",id:L(),type:"email",class:`form-control ${this.isButtonPressed&&((l=this.guestInfo)===null||l===void 0?void 0:l.last_name)===""&&"border-danger"}`,placeholder:(c=p.entries["Lcz_GuestLastname"])!==null&&c!==void 0?c:"Guest last name",name:"guestName",onInput:t=>{const e=t.target.value;this.updateGuest({last_name:e});if(r.event_type.type==="EDIT_BOOKING"){a("guest",Object.assign(Object.assign({},r.guest),{name:e}))}},required:true,value:(h=this.guestInfo)===null||h===void 0?void 0:h.last_name})),e("div",{key:"565a840fa063f120ab6ff319fcc962692739a7a9",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},g.is_frontdesk_enabled&&!b(this.rateplanSelection.roomtype.id)&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&e("div",{key:"45f20c08a387a175cec2f66f452f0bdcbf17bda6",class:"mr-1 p-0 flex-fill preference-select-container"},e("select",{key:"df68dccfe5724a763850c52fbd0df872bd140f68",class:"form-control input-sm pr-0",id:L(),onChange:t=>this.updateGuest({unit:t.target.value})},e("option",{key:"fdfe6a3e354638e3b757bfb7b8968b7a5989ec7d",value:"",selected:((d=this.guestInfo)===null||d===void 0?void 0:d.unit)===""},p.entries.Lcz_Assignunits),w===null||w===void 0?void 0:w.map((t=>{var i;return e("option",{value:t.id,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.unit)===t.id.toString()},t.name)}))))),this.rateplanSelection.roomtype.is_bed_configuration_enabled&&e("div",{key:"cd596bee081e590c7541b4fe380b322adc76d6c1",class:"mr-1 flex-fill"},e("select",{key:"f086d3ef0fa0d204a817e08506c4aa1426d3b2d9",class:`form-control input-sm ${this.isButtonPressed&&((u=this.guestInfo)===null||u===void 0?void 0:u.bed_preference)===""&&"border-danger"}`,id:L(),onChange:t=>this.updateGuest({bed_preference:t.target.value})},e("option",{key:"f88a4055288b068f0eb9618521e544a177514413",value:"",selected:((f=this.guestInfo)===null||f===void 0?void 0:f.bed_preference)===""},p.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((t=>{var i;return e("option",{value:t.CODE_NAME,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.bed_preference)===t.CODE_NAME},t.CODE_VALUE_EN)})))),e("p",{key:"305c51072c1b9a82da2c51dfa7845feed017ba07",class:"rate_amount"},m((v=this.currency)===null||v===void 0?void 0:v.symbol,this.getAmount()),"/",p.entries.Lcz_Stay)),this.rateplanSelection.selected_variation.child_nbr>0&&e("div",{key:"e355f1be64e15953ce8c3e3aa9e7aa30399d6bf6",style:{gap:"0.5rem",marginTop:"0.5rem"},class:"d-flex  flex-row  p-0 align-items-center aplicationInfoContainer"},e("p",{key:"3a8271c4e2c27912c1a347ed8fa3eda7d8575991",class:"m-0 p-0 text-danger"},"Any of the children below 3 years?"),e("div",{key:"71b4727db33b300985f9d00ab2ee58a5b0f0641e",class:"mr-1 flex-fill"},e("select",{key:"4b7a300400f5b31d5a95262284d6c16ffad27ef8",class:`form-control input-sm ${this.isButtonPressed&&((y=this.guestInfo)===null||y===void 0?void 0:y.bed_preference)===""&&"border-danger"}`,id:L(),style:{width:"max-content"},onChange:t=>this.updateGuest({infant_nbr:Number(t.target.value)})},e("option",{key:"dbc74a492564b6f02861342473acd2ccde4db82d",value:"",selected:Number((k=this.guestInfo)===null||k===void 0?void 0:k.infant_nbr)===0},p.entries["No"]||"No"),Array.from({length:this.rateplanSelection.selected_variation.child_nbr},((t,e)=>e+1)).map((t=>{var i;return e("option",{value:t,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.infant_nbr)===t},t)}))))))}};rt.style=ot;const at=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const lt=at;const ct=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new l;this.defaultData=undefined;this.fromDate=undefined;this.toDate=undefined;this.entryDate=undefined;this.entryHour=undefined;this.isEventHover=false;this.entryMinute=undefined;this.renderAgain=false}async componentWillLoad(){try{this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(t){}}handleOptionalReason(t){this.blockDatesData.OPTIONAL_REASON=t.target.value;this.emitData()}handleReleaseAfterChange(t){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(t.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let t=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){t.setHours(this.entryHour,this.entryMinute,0,0)}else{t.setHours(t.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,t.getMinutes(),0,0)}return t.toLocaleString("default",{month:"short"})+" "+t.getDate()+", "+this.formatNumber(t.getHours())+":"+this.formatNumber(t.getMinutes())}formatNumber(t){return t<10?`0${t}`:t}handleOutOfService(t){this.blockDatesData.OUT_OF_SERVICE=t.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){return e(i,{key:"bd47c87076b88f1a27685749b6cb2fe2ebac8644"},e("div",{key:"e47719d7fb7e5cd339222bef1cf7a3cdc8c0d7c5",class:`m-0 p-0 mb-1`},e("div",{key:"b62663cb32850bdb7047d52b87483a35950cb4b1",class:"text-left p-0"},e("ir-date-view",{key:"140433c5de6cf987703cf42f8530b0109323ef35",from_date:this.fromDate,dateOption:"DD MMM YYYY",showDateDifference:false,to_date:this.toDate}))),e("div",{key:"a192149471505b441610acb8257174da9c4c08d0",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},e("div",{key:"825bcf39baac6486c0d3c7832e9e8713b08d3196",class:"mb-1 "},e("label",{key:"bd43ce09822ce7af6c1ac6a120d25db5c751d63f",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},p.entries.Lcz_Reason,":"),e("div",{key:"764e3b1d4edd8145d448d30ed1c8b7a33116322d",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},e("input",{key:"21bac22756ea7920b17586fd44360b2ca4451d29",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:t=>this.handleOutOfService(t)})),e("span",{key:"1fb8c1b0fd3a1348f9fed590d082c040a1e6faab",class:"align-middle out-of-service-label"},p.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?e("div",null,e("div",{class:"mb-1 d-flex  align-items-center"},e("span",{class:"align-middle"},p.entries.Lcz_Or," "),e("div",{class:"d-inline-flex col pr-0 align-middle"},e("input",{class:"form-control",type:"text",placeholder:p.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:t=>this.handleOptionalReason(t)}))),e("div",{class:"mb-1 w-100 pr-0 "},e("span",{class:"text-bold-700 font-medium-1"},p.entries.Lcz_AutomaticReleaseIn,": "),e("div",{class:"d-inline-block"},e("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:t=>this.handleReleaseAfterChange(t)},this.releaseList.map((t=>e("option",{value:+t.CODE_NAME,selected:Number(this.blockDatesData.RELEASE_AFTER_HOURS)==Number(t.CODE_NAME)},t.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?e("div",{class:"d-inline-block releaseTime"},e("em",null,p.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};ct.style=lt;var ht=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++){if(e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n]))i[s[n]]=t[s[n]]}return i};class dt{setBookingInfoFromAutoComplete(t,e){var i,s,n;t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:(s=(i=e.guest)===null||i===void 0?void 0:i.country_phone_prefix)!==null&&s!==void 0?s:(n=e.guest)===null||n===void 0?void 0:n.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,n){let o=e;const{data:r,key:a,changedKey:l}=t.detail;const c=`c_${r.roomCategoryId}`;const h=`p_${r.ratePlanId}`;if(this.shouldClearData(a)){o=new Map}this.initializeRoomCategoryIfNeeded(c,o);if(s){if(l==="rate"){if(o.has(c)&&o.get(c).has(h)){this.applyBookingEditToSelectedRoom(c,h,r,o,n,i)}}else{if(l!=="rateType"){if(l==="adult_child_offering"){if(o.has(c)&&e.get(c).has(h)){this.applyBookingEditToSelectedRoom(c,h,r,o,n,i)}}else{this.applyBookingEditToSelectedRoom(c,h,r,o,n,i)}}}}else{this.setSelectedRoomData(c,h,r,o)}this.cleanupEmptyData(c,o);return o}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let n=s.get(t);if(i.totalRooms===0||i.inventory===0){n.delete(e)}else{s.set(t,n.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,n,o){s.clear();let r={};if(o){r=Object.assign(Object.assign({},i),{guestName:n||"",roomId:""})}else{r=Object.assign({},i)}s.set(t,(new Map).set(e,r))}generateDailyRates(t,e,i){const s=new Date(e);s.setDate(s.getDate()-1);let n=new Date(t);const o=[];while(n<=s){o.push({date:U(n).format("YYYY-MM-DD"),amount:i,cost:null});n.setDate(n.getDate()+1)}return o}getBookedRooms({check_in:t,check_out:e,notes:i,identifier:s,override_unit:n,unit:o,auto_check_in:a}){const l=[];const c=j(U(t).format("YYYY-MM-DD"),U(e).format("YYYY-MM-DD"));const h=({is_amount_modified:t,selected_variation:e,view_mode:i,rp_amount:s,ratePlan:n},o)=>{if(t){return i==="002"?s:s/c}let r=e;if(o>0){if(!this.variationService){this.variationService=new st}r=this.variationService.getVariationBasedOnInfants({variations:n.variations,baseVariation:e,infants:o})}return Number(r.discounted_amount)/c};for(const c in r.ratePlanSelections){const d=r.ratePlanSelections[c];for(const r in d){const c=d[r];if(c.reserved>0){for(let r=0;r<c.reserved;r++){const{first_name:d,last_name:u}=c.guest[r];l.push({identifier:s,roomtype:c.roomtype,rateplan:c.ratePlan,prepayment_amount_gross:0,unit:n?{id:o}:c.guest[r].unit?{id:c.guest[r].unit}:null,occupancy:{adult_nbr:c.selected_variation.adult_nbr,children_nbr:c.selected_variation.child_nbr-Math.max(c.guest[r].infant_nbr,0),infant_nbr:c.guest[r].infant_nbr},bed_preference:c.guest[r].bed_preference,from_date:U(t).format("YYYY-MM-DD"),to_date:U(e).format("YYYY-MM-DD"),notes:i,check_in:a,days:this.generateDailyRates(t,e,h(c,c.guest[r].infant_nbr)),guest:{email:null,first_name:d,last_name:u,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null,cci:null}})}}}}return l}async prepareBookUserServiceParams({context:t,sourceOption:e,check_in:i}){var s,n;try{if(!t||!t.dateRangeData){throw new Error("Invalid context: Missing date range data.")}const o=new Date(t.dateRangeData.fromDate);const r=new Date(t.dateRangeData.toDate);const a=(e=null,i=false)=>this.getBookedRooms({check_in:o,check_out:r,identifier:e,notes:"",override_unit:t.isEventType("BAR_BOOKING")?true:false,unit:t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:null,auto_check_in:i});const l=(t,e)=>{var{pickup_info:i,extra_services:s,is_direct:n,is_in_loyalty_mode:o,promo_key:r,extras:a}=t,l=ht(t,["pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras"]);return{assign_units:true,is_pms:true,is_direct:n,is_in_loyalty_mode:o,promo_key:r,extras:a,booking:Object.assign(Object.assign({},l),{rooms:e}),extra_services:s,pickup_info:i}};let c=null;switch(t.defaultData.event_type){case"EDIT_BOOKING":{const{booking:e,currentRoomType:i}=t.defaultData;const n=e.rooms.filter((t=>t.identifier!==i.identifier));console.log("currentRoomType",i);const o=a(i.identifier,((s=i.in_out)===null||s===void 0?void 0:s.code)==="001");c=l(e,[...n,...o]);break}case"ADD_ROOM":case"SPLIT_BOOKING":{const{booking:e}=t.defaultData;if(!e){throw new Error("Missing booking")}console.log(e);const i=a();c=l(e,[...e===null||e===void 0?void 0:e.rooms,...i]);break}default:{const s=a(null,i);const{bookedByInfoData:l}=t;const h=e.type==="TRAVEL_AGENCY";c={assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,extras:v,agent:h?{id:e.tag}:null,booking:{from_date:U(o).format("YYYY-MM-DD"),to_date:U(r).format("YYYY-MM-DD"),remark:l.message||null,booking_nbr:"",property:{id:t.propertyid},booked_on:{date:U().format("YYYY-MM-DD"),hour:(new Date).getHours(),minute:(new Date).getMinutes()},source:h?"":e,rooms:s,currency:t.currency,arrival:{code:l.selectedArrivalTime},guest:{email:l.email===""?null:l.email||null,first_name:l.firstName,last_name:l.lastName,country_id:l.countryId===""?null:l.countryId,city:null,mobile:l.contactNumber===null?"":l.contactNumber,country_phone_prefix:(n=l===null||l===void 0?void 0:l.isdCode)!==null&&n!==void 0?n:null,address:"",dob:null,subscribe_to_news_letter:l.emailGuest||false,cci:l.cardNumber?{nbr:l.cardNumber,holder_name:l.cardHolderName,expiry_month:l.expiryMonth,expiry_year:l.expiryYear}:null}},pickup_info:null};break}}return c}catch(t){console.error(t)}}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const n=`p_${t.RATE_PLAN_ID}`;const o={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(n,o))}}const ut=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto;padding-bottom:85px !important}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}";const ft=ut;const pt=class{constructor(e){t(this,e);this.closeBookingWindow=s(this,"closeBookingWindow",7);this.blockedCreated=s(this,"blockedCreated",7);this.resetBookingData=s(this,"resetBookingData",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.toast=s(this,"toast",7);this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new l;this.bookPropertyService=new dt;this.updatedBooking=false;this.MAX_HISTORY_LENGTH=2;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.bookingHistory=[]}async componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this);this.initializeDefaultDateRange();if(!this.bookingData.defaultDateRange){return}console.log("testing");this.initializeDefaultData();this.wasBlockedUnit=this.defaultData.hasOwnProperty("block_exposed_unit_props");a("event_type",{type:this.defaultData.event_type});await this.fetchSetupEntriesAndInitialize();this.initializeEventData()}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();t.stopPropagation();const{key:e,data:i}=t.detail;if(e==="select"||e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i.booking_nbr||i,this.language);this.defaultData=Object.assign(Object.assign({},this.defaultData),{booking:t});this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}const{adult:e,child:i}=t.detail;this.adultChildCount=Object.assign({},t.detail);this.updateBookingHistory({adults:Number(e),children:Number(i)})}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.updateBookingHistory({dates:{checkIn:new Date(this.dateRangeData.fromDate),checkOut:new Date(new Date(e.data.toDate))}});console.log("date changed",e);if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.checkBookingAvailability()}}}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}gotoSplitPageTwo(){this.gotoPage("page_two")}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);break;case"bookAndCheckIn":this.bookUser(true);break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(c()>0){this.gotoPage("page_two");break}else if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}this.toast.emit({type:"error",description:p.entries.Lcz_SelectRatePlan,title:p.entries.Lcz_SelectRatePlan});break;case"check":this.checkBookingAvailability();break}}updateBookingHistory(t){var e,i,s,n,o,r,a,l;const c=this.bookingHistory[this.bookingHistory.length-1];const h={dates:{checkIn:((e=t.dates)===null||e===void 0?void 0:e.checkIn)||((i=c===null||c===void 0?void 0:c.dates)===null||i===void 0?void 0:i.checkIn)||new Date(this.dateRangeData.fromDate),checkOut:((s=t.dates)===null||s===void 0?void 0:s.checkOut)||((n=c===null||c===void 0?void 0:c.dates)===null||n===void 0?void 0:n.checkOut)||new Date(this.dateRangeData.toDate)},adults:(r=(o=t.adults)!==null&&o!==void 0?o:c===null||c===void 0?void 0:c.adults)!==null&&r!==void 0?r:this.adultChildCount.adult,children:(l=(a=t.children)!==null&&a!==void 0?a:c===null||c===void 0?void 0:c.children)!==null&&l!==void 0?l:this.adultChildCount.child};this.bookingHistory.push(h);if(this.bookingHistory.length>this.MAX_HISTORY_LENGTH){this.bookingHistory.shift()}}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}}initializeDefaultDateRange(){this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE}}initializeDefaultData(){this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange)}async fetchSetupEntriesAndInitialize(){try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t)}catch(t){console.error("Error fetching setup entries:",t)}}initializeEventData(){if(this.isEventType("EDIT_BOOKING")){this.initializeEditBookingData()}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.initializePage()}initializeEditBookingData(){var t,e,i,s,n;this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};const{currentRoomType:o,GUEST:r}=this.defaultData;console.log(r);a("guest",{bed_preference:(t=o.bed_preference)===null||t===void 0?void 0:t.toString(),infant_nbr:o.occupancy.infant_nbr,first_name:(e=r.first_name)!==null&&e!==void 0?e:"",last_name:(i=r.last_name)!==null&&i!==void 0?i:"",unit:(n=(s=o.unit)===null||s===void 0?void 0:s.id)===null||n===void 0?void 0:n.toString()});this.checkBookingAvailability();this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}initializePage(){switch(this.defaultData.event_type){case"SPLIT_BOOKING":this.showSplitBookingOption=true;this.page="page_one";break;case"BLOCK_DATES":this.page="page_block_date";break;default:this.page="page_one";break}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){for(const t in r.ratePlanSelections){const e=r.ratePlanSelections[t];for(const t in e){const i=e[t];if(i.reserved>0){for(const t of i.guest){if(t.first_name===""||t.last_name===""){return true}}}}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.id,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag,type:t[0].type,id:t[0].id}}}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}async checkBookingAvailability(){const t=U(this.dateRangeData.fromDate).format("YYYY-MM-DD");const e=U(this.dateRangeData.toDate).format("YYYY-MM-DD");const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.isEventType("EDIT_BOOKING")?[this.defaultData.RATE_TYPE]:[];const n=this.isEventType("BAR_BOOKING")?this.defaultData.roomsInfo.map((t=>t.id)):[];const o=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:n,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i,room_type_ids_to_update:s});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:o});if(this.isEventType("EDIT_BOOKING")&&!this.updatedBooking){this.updateBooking()}}catch(t){console.error("Error initializing booking availability:",t)}}updateBooking(){var t,e,i;try{const{currentRoomType:s,GUEST:n}=this.defaultData;const o=s.roomtype.id;const r=s.rateplan.id;h({roomTypeId:o,ratePlanId:r,rooms:1,guest:[{bed_preference:(t=s.bed_preference)===null||t===void 0?void 0:t.toString(),infant_nbr:s.occupancy.infant_nbr,last_name:n.last_name,first_name:n.first_name,unit:(i=(e=s.unit)===null||e===void 0?void 0:e.id)===null||i===void 0?void 0:i.toString()}]})}catch(t){console.error(t)}}async checkAndBlockDate(){try{const{block_exposed_unit_props:t}=this.defaultData;await this.bookingService.getBookingAvailability({from_date:t.from_date,to_date:t.to_date,propertyid:this.propertyid,adultChildCount:{adult:2,child:0},language:this.language,room_type_ids:this.defaultData.roomsInfo.map((t=>t.id)),currency:this.currency});const e=r.roomTypes.every((t=>t.is_available_to_book));if(e){await this.handleBlockDate(false)}else{console.log("Blocked date is unavailable. Continuing...")}}catch(t){console.error("Error checking and blocking date:",t)}}async closeWindow(){d();this.closeBookingWindow.emit();if(this.wasBlockedUnit&&!this.didReservation){await this.checkAndBlockDate()}document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}renderPage(){this.renderAgain=!this.renderAgain}gotoPage(t){this.page=t;this.renderPage()}getPageBlockDatesView(){return e(n,null,e("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),e("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},e("ir-button",{text:p.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),e("ir-button",{text:p.entries.Lcz_Blockdates,isLoading:G("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})))}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(t=true){const e=this.wasBlockedUnit?this.defaultData.block_exposed_unit_props:(()=>{const t=y(+this.blockDatesData.RELEASE_AFTER_HOURS);return Object.assign({from_date:k(this.defaultData.defaultDateRange.fromDate),to_date:k(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t)})();await this.bookingService.blockUnit(e);if(t)this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else if(this.isButtonDisabled()){this.isLoading="";return}try{if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}this.didReservation=true;const e=await this.bookPropertyService.prepareBookUserServiceParams({context:this,sourceOption:this.sourceOption,check_in:t});await this.bookingService.doReservation(e);this.resetBookingData.emit(null)}catch(t){console.error("Error booking user:",t)}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}getCurrentPage(t){return this.page===t}render(){return e(i,{key:"18f2c41a0e516b024bd005d71a6a205a1b3b017d"},e("div",{key:"c2a47b73b8129df7f90aababf4a5f4802a9a8ba4",class:"background-overlay",onClick:()=>this.closeWindow()}),e("div",{key:"7eb198357142707e09a9c03fb1cf1798867595be",class:"sideWindow pb-5 pb-md-0 "+(this.getCurrentPage("page_block_date")?"block-date":"")},e("div",{key:"d76146a59ea57c584ca58d5b4a6bc80277daa9a7",class:"card position-sticky mb-0 shadow-none p-0 "},e("div",{key:"09aaa8dfe270cc94107e1b168d3de514c65ab470",class:"card-header-container mb-2"},e("h3",{key:"6c90df45408a7c05f8fdf622806a2b302151e260",class:" text-left font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),e("ir-icon",{key:"08f3e19c67eef5f3b4932088b0ab0e7dd3307bec",class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},e("svg",{key:"a6c81d2f3ccec77b0dcaf591a44943eae93976ac",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{key:"a6b9e497b4ec5669f056ab3f9fd85e5187c7d629",fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("div",{key:"97dcdef5d58a631b59418d2078c8e405eb4110e6",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&e("igl-booking-overview-page",{key:"75570fe6afa82ef4758325eeb4bdce729dfba306",initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&e("igl-booking-form",{key:"1506c8db0668a3bcf398e568f1c49b26cca07de0",currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};pt.style=ft;const bt=".sc-igl-book-property-footer-h{display:block;margin:0;padding:0}.sc-igl-book-property-footer-h>*.sc-igl-book-property-footer{margin:auto;padding:auto}.gap-30.sc-igl-book-property-footer{gap:30px}";const gt=bt;const mt=class{constructor(e){t(this,e);this.buttonClicked=s(this,"buttonClicked",7);this.eventType=undefined;this.disabled=true}isEventType(t){return t===this.eventType}editNext(t){if(this.isEventType("EDIT_BOOKING")){if(t==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton(t,i,s=false,n){return e("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(i)}`:"flex-fill"},e("ir-button",{btn_color:t==="cancel"?"secondary":"primary",text:i,btn_disabled:s,onClickHandler:()=>{this.buttonClicked.emit({key:t})},icon_name:n,iconPosition:"right",style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){return e(i,{key:"c30d3beffe3210b52eaff2f3265fef49c5c6b175"},e("div",{key:"de6d9f929a8c2dbe98bb644892fa96797095424a",class:"d-flex justify-content-between gap-30 align-items-center"},this.isEventType("EDIT_BOOKING")?e(n,null,this.renderButton("cancel",p.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${p.entries.Lcz_Next}`,G("/Get_Exposed_Booking_Availability"),"angles_right")):e(n,null,this.renderButton("cancel",p.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${p.entries.Lcz_Next}`,false,"angles_right"))))}};mt.style=gt;const vt=".sc-igl-book-property-header-h{display:block}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const yt=vt;const kt=class{constructor(e){t(this,e);this.splitBookingDropDownChange=s(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=s(this,"sourceDropDownChange",7);this.adultChild=s(this,"adultChild",7);this.checkClicked=s(this,"checkClicked",7);this.buttonClicked=s(this,"buttonClicked",7);this.toast=s(this,"toast",7);this.spiltBookingSelected=s(this,"spiltBookingSelected",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.sourceOption={code:"",description:"",tag:"",id:"",type:""};this.splitBookingId="";this.bookingData="";this.minDate=undefined;this.sourceOptions=[];this.message=undefined;this.bookingDataDefaultDateRange=undefined;this.showSplitBookingOption=false;this.adultChildConstraints=undefined;this.splitBookings=undefined;this.adultChildCount=undefined;this.dateRangeData=undefined;this.bookedByInfoData=undefined;this.defaultDaterange=undefined;this.propertyId=undefined}getSplitBookingList(){return e("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},e("label",{class:"mr-lg-1"},p.entries.Lcz_Tobooking,"# "),e("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},e("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:U(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:U(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:p.entries.Lcz_BookingNumber,onComboboxValue:t=>{t.stopImmediatePropagation();this.spiltBookingSelected.emit(t.detail)},isSplitBooking:true})))}getSourceNode(){return e("fieldset",{class:"d-flex text-left  align-items-center"},e("label",{class:"mr-1"},p.entries.Lcz_Source," "),e("div",{class:"btn-group mt-0 flex-fill sourceContainer"},e("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:t=>this.sourceDropDownChange.emit(t.target.value)},this.sourceOptions.map((t=>{if(t.type==="LABEL"){return e("optgroup",{label:t.value})}return e("option",{value:t.id,selected:this.sourceOption.code===t.id},t.value)})))))}handleAdultChildChange(t,e){let i={};if(e===""){i=Object.assign(Object.assign({},this.adultChildCount),{[t]:0})}else{i=Object.assign(Object.assign({},this.adultChildCount),{[t]:e})}this.adultChild.emit(i)}getAdultChildConstraints(){return e("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},e("div",{class:"form-group  my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},e("fieldset",null,e("div",{class:"btn-group ml-0"},e("ir-select",{class:"m-0",onSelectChange:t=>this.handleAdultChildChange("adult",t.detail),select_id:"adult_child_select",firstOption:p.entries.Lcz_AdultsCaption,LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&e("fieldset",null,e("div",{class:"btn-group ml-1 p-0"},e("ir-select",{onSelectChange:t=>this.handleAdultChildChange("child",t.detail),select_id:"child_select",firstOption:this.renderChildCaption(),LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),e("ir-button",{btn_id:"check_availability",isLoading:G("/Check_Availability"),icon:"",size:"sm",class:"ml-2",text:p.entries.Lcz_Check,onClickHandler:()=>this.handleButtonClicked()})))}renderChildCaption(){const t=this.adultChildConstraints.child_max_age;let e=p.entries.Lcz_Years;if(t===1){e=p.entries.Lcz_Year}return`${p.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${e}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:p.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=U(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const e=U(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=U(new Date(this.dateRangeData.fromDate));const s=U(new Date(this.dateRangeData.toDate));if(s.isBefore(e)||i.isAfter(t)){this.toast.emit({type:"error",title:`${p.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",U(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",U(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:p.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${p.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",U(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",U(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:p.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(t){return this.bookingData.event_type===t}render(){const t=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return e(i,{key:"e371d228eb4a8a4d6c8996631f637fe19c347483"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),t&&this.getSourceNode(),e("div",{key:"584fc9f8062a3e40f6d9ef1ffa1f588b03fb21a9",class:`d-flex flex-column flex-lg-row align-items-lg-center ${t?"mt-1":""}`},e("fieldset",{key:"6505b25ae251f486514911cbd328d2a5758c85ad",class:"mt-lg-0 mr-1 "},e("igl-date-range",{key:"1a9d25d200f739e89c4eb40aed15823b85b43128",variant:"booking",dateLabel:p.entries.Lcz_Dates,minDate:this.isEventType("PLUS_BOOKING")?U().add(-1,"months").startOf("month").format("YYYY-MM-DD"):this.minDate,disabled:this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),e("p",{key:"d40109f4c06e138dfd642c0052514de6808ea412",class:"text-right mt-1 message-label"},g.tax_statement))}};kt.style=yt;class wt{constructor(){this.bookingService=new l}async reallocateEvent(t,e,i,s){try{console.log(t,e,i,s);const{data:n}=await W.post(`/ReAllocate_Exposed_Room`,{pool:t,destination_pr_id:e,from_date:i,to_date:s,extras:v});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n);return n}catch(t){console.error(t);throw new Error(t)}}async deleteEvent(t){try{const{data:e}=await W.post(`/UnBlock_Exposed_Unit`,{POOL:t});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}catch(t){console.log(t);throw new Error(t)}}async updateBlockedEvent(t){try{const e=y(+t.RELEASE_AFTER_HOURS);await this.deleteEvent(t.POOL);const i=await this.bookingService.blockUnit(Object.assign({from_date:this.formatDate(t.FROM_DATE),to_date:this.formatDate(t.TO_DATE),pr_id:t.PR_ID,STAY_STATUS_CODE:t.OUT_OF_SERVICE?"004":t.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:t.RELEASE_AFTER_HOURS||"",NOTES:t.OPTIONAL_REASON||""},e));return i}catch(t){console.error(t);throw new Error(t)}}formatDate(t){return t.split("/").join("-")}}const xt=".sc-igl-booking-event-h{display:block;position:absolute}.bookingEventBase.sc-igl-booking-event{position:absolute;background-color:rgb(49, 190, 241);width:100%;height:100%;border-radius:4px;transform:skewX(-22deg)}.bookingEventBase.skewedLeft.sc-igl-booking-event::before{content:'';position:absolute;top:0px;bottom:0;left:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:right;transform:skewX(22deg);border-radius:4px;border-top-left-radius:0;border-bottom-left-radius:0}.bookingEventBase.skewedRight.sc-igl-booking-event::before{content:'';position:absolute;top:0;bottom:0;right:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:left;transform:skewX(22deg);border-radius:4px;border-top-right-radius:0;border-bottom-right-radius:0}.bookingEventBase.border.skewedLeft.sc-igl-booking-event::before{border:2px solid #424242;border-right:0;border-left:0;border-top-right-radius:0;border-bottom-right-radius:0;top:-1px;height:20px;left:-4px}.ota-booking-event.sc-igl-booking-event{border-width:2px !important}.bookingEventBase.border.skewedRight.sc-igl-booking-event::before{border:2px solid #424242;border-left:0;border-right:0;border-top-left-radius:0;border-bottom-left-radius:0;top:-1px;height:20px;right:-4px}.bookingEvent.sc-igl-booking-event{cursor:pointer}.bookingEventBase.sc-igl-booking-event{cursor:pointer}.bookingEventHiddenBase.sc-igl-booking-event{position:absolute;top:0;left:-4px;width:calc(100% + 8)}.bookingEventDragHandle.sc-igl-booking-event{position:absolute;top:0;width:15px;height:100%;opacity:0.1;background-color:rgba(0, 0, 0, 0.15);transform:skewX(-22deg);border-radius:4px;cursor:pointer}.splitBooking.sc-igl-booking-event{border-right:2px solid #000000}.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:block;opacity:1}.newEvent.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:none;opacity:1}.leftSide.sc-igl-booking-event{left:0}.leftSide.skewedLeft.sc-igl-booking-event{transform:skewX(0)}.rightSide.skewedRight.sc-igl-booking-event{transform:skewX(0)}.rightSide.sc-igl-booking-event{right:0}.bookingEventTitle.sc-igl-booking-event{color:#fff;font-size:0.8em;position:relative;max-width:calc(100% - 10px);overflow:hidden;text-overflow:ellipsis;top:2px;left:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none;cursor:pointer}.legend_circle.sc-igl-booking-event{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px;border:1px solid #fff}.noteIcon.sc-igl-booking-event{position:absolute;bottom:-8px;left:2px}.balanceIcon.sc-igl-booking-event{position:absolute;top:-8px;right:2px}";const _t=xt;var Dt=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++){if(e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n]))i[s[n]]=t[s[n]]}return i};const Ct=class{constructor(e){t(this,e);this.hideBubbleInfo=s(this,"hideBubbleInfo",7);this.updateEventData=s(this,"updateEventData",7);this.dragOverEventData=s(this,"dragOverEventData",7);this.showRoomNightsDialog=s(this,"showRoomNightsDialog",7);this.showDialog=s(this,"showDialog",7);this.resetStreachedBooking=s(this,"resetStreachedBooking",7);this.toast=s(this,"toast",7);this.updateBookingEvent=s(this,"updateBookingEvent",7);this.dayWidth=0;this.eventSpace=8;this.vertSpace=10;this.showInfoPopup=false;this.bubbleInfoTopSide=false;this.isStreatch=false;this.eventsService=new wt;this.bookingService=new l;this.resizeSide="";this.isDragging=false;this.animationFrameId=null;this.handleMouseMoveBind=this.handleMouseMove.bind(this);this.handleMouseUpBind=this.handleMouseUp.bind(this);this.handleClickOutsideBind=this.handleClickOutside.bind(this);this.currency=undefined;this.is_vacation_rental=false;this.language=undefined;this.bookingEvent=undefined;this.allBookingEvents=[];this.countryNodeList=undefined;this.renderElement=false;this.position=undefined;this.isShrinking=null}componentWillLoad(){window.addEventListener("click",this.handleClickOutsideBind)}async fetchAndAssignBookingData(){try{console.log("clicked on book#",this.bookingEvent.BOOKING_NUMBER);const t=["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"];if(!t.includes(this.bookingEvent.STATUS)){return}const e=await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER,"en");const i=e.rooms.filter((t=>t["assigned_units_pool"]===this.bookingEvent.ID));if(i.length===0){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty array`)}if(i.some((t=>t["assigned_units_pool"]===null))){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty pool`)}e.rooms=i;const s=R(e)[0];const n=Dt(s,["ID","TO_DATE","FROM_DATE","NO_OF_DAYS","STATUS","NAME","IDENTIFIER","PR_ID","POOL","BOOKING_NUMBER","NOTES","is_direct","BALANCE"]);this.bookingEvent=Object.assign(Object.assign(Object.assign({},n),this.bookingEvent),{booking:e,PHONE:n.PHONE,PHONE_PREFIX:n.PHONE_PREFIX,PRIVATE_NOTE:n.PRIVATE_NOTE});this.updateBookingEvent.emit(this.bookingEvent);this.showEventInfo(true)}catch(t){console.error(t.message)}}componentDidLoad(){if(this.isNewEvent()){if(!this.bookingEvent.hideBubble){setTimeout((async()=>{if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}else{this.showEventInfo(true)}this.renderAgain()}),1)}}}disconnectedCallback(){window.removeEventListener("click",this.handleClickOutsideBind);if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}}handleClickOutside(t){const e=t.target;if(!this.element.contains(e)){this.showEventInfo(false)}}hideBubbleInfoPopup(t){if(t.detail.currentInfoBubbleId!=this.getBookingId()||t.detail.key==="hidebubble"&&t.detail.currentInfoBubbleId===this.getBookingId()){this.showInfoPopup=false;this.renderAgain()}}async moveBookingToHandler(t){try{if(t.detail.bookingId!==this.getBookingId()){this.showEventInfo(false);return}if(t.detail.moveToDay==="revert"||t.detail.toRoomId==="revert"){t.detail.moveToDay=this.bookingEvent.FROM_DATE;t.detail.toRoomId=t.detail.fromRoomId;if(this.isTouchStart&&this.moveDiffereneX<=5&&this.moveDiffereneY<=5&&!this.isStreatch){if(w(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));return}}else{if(this.isTouchStart&&this.moveDiffereneX<=5&&this.moveDiffereneY<=5&&!this.isStreatch){if(w(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{const{pool:e,to_date:i,from_date:s,toRoomId:n}=t.detail;if(this.checkIfSlotOccupied(n,s,i)){this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));throw new Error("Overlapping Dates")}if(e){if(w(this.bookingEvent.STATUS_CODE)){await this.eventsService.reallocateEvent(e,n,s,i).catch((()=>{this.resetBookingToInitialPosition()}))}else{if(this.isShrinking||!this.isStreatch){const{description:e,status:o}=this.getModalDescription(n,s,i);let r=false;if(o==="400"){r=true}const a=this.bookingEvent.defaultDates.from_date;const l=this.bookingEvent.defaultDates.to_date;const c=U(l,"YYYY-MM-DD").diff(U(a,"YYYY-MM-DD"),"days");let h=null;let d=a;let u=l;if(this.isShrinking){if(U(s,"YYYY-MM-DD").isAfter(U(a,"YYYY-MM-DD"))&&U(i,"YYYY-MM-DD").isBefore(U(l,"YYYY-MM-DD"))){d=a;u=i}else{h=U(s,"YYYY-MM-DD").isAfter(U(a,"YYYY-MM-DD"))?"left":U(i,"YYYY-MM-DD").isBefore(U(l,"YYYY-MM-DD"))?"right":null;if(h==="left"){d=s}if(h==="right"){u=i}}}else{if(U(s,"YYYY-MM-DD").isBefore(U(a,"YYYY-MM-DD"))){d=s;u=U(s,"YYYY-MM-DD").add(c,"days").format("YYYY-MM-DD")}else if(U(i,"YYYY-MM-DD").isAfter(U(l,"YYYY-MM-DD"))){u=i;d=U(i,"YYYY-MM-DD").subtract(c,"days").format("YYYY-MM-DD")}}this.showDialog.emit(Object.assign(Object.assign({reason:"reallocate"},t.detail),{description:e,title:"",hideConfirmButton:r,from_date:d,to_date:u}))}else{this.showRoomNightsDialog.emit({bookingNumber:this.bookingEvent.BOOKING_NUMBER,identifier:this.bookingEvent.IDENTIFIER,to_date:i,pool:e,from_date:s,defaultDates:this.bookingEvent.defaultDates})}}this.isShrinking=null}}}}catch(t){this.toast.emit({position:"top-right",title:t.message,description:"",type:"error"});console.log("something went wrong")}}getModalDescription(t,e,i){const s=t=>{let e=this.bookingEvent.roomsInfo.filter((e=>e.physicalrooms.some((e=>e.id===+t))));if(e.length){return e[0].id}return null};if(!this.bookingEvent.is_direct){if(this.isShrinking){return{description:`${p.entries.Lcz_YouWillLoseFutureUpdates}.`,status:"200"}}else{if(U(e,"YYYY-MM-DD").isSame(U(this.bookingEvent.FROM_DATE,"YYYY-MM-DD"))&&U(i,"YYYY-MM-DD").isSame(U(this.bookingEvent.TO_DATE,"YYYY-MM-DD"))){const e=s(this.bookingEvent.PR_ID);const i=s(t);if(e===i){return{description:`${p.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:`${p.entries.Lcz_YouWillLoseFutureUpdates} ${this.bookingEvent.origin?this.bookingEvent.origin.Label:""}. ${p.entries.Lcz_SameRatesWillBeKept}`,status:"200"}}}return{description:p.entries.Lcz_CannotChangeCHBookings,status:"400"}}}else{if(!this.isShrinking){const e=s(this.bookingEvent.PR_ID);const i=s(t);if(e===i){console.log("same rt");return{description:`${p.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:p.entries.Lcz_SameRatesWillBeKept,status:"200"}}}return{description:p.entries.Lcz_ConfrmModiication,status:"200"}}}resetBookingToInitialPosition(){if(this.isStreatch){this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${this.initialWidth}px`;this.isStreatch=false;this.finalWidth=this.initialWidth;this.isShrinking=null}else{this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`}}handleRevertBooking(t){if(this.bookingEvent.POOL===t.detail){this.resetBookingToInitialPosition()}}checkIfSlotOccupied(t,e,i){const s=U(e,"YYYY-MM-DD");const n=U(i,"YYYY-MM-DD");const o=this.allBookingEvents.some((e=>{if(e.POOL===this.bookingEvent.POOL){return false}const i=U(e.FROM_DATE,"YYYY-MM-DD").add(1,"days");const o=U(e.TO_DATE,"YYYY-MM-DD");return e.PR_ID===+t&&n.isSameOrAfter(i)&&s.isBefore(o)}));return o}renderAgain(){this.renderElement=!this.renderElement}getUniqueId(){return(new Date).getTime()}isSplitBooking(){return!!this.bookingEvent.SPLIT_BOOKING}isNewEvent(){return this.getBookingId()==="NEW_TEMP_EVENT"}isHighlightEventType(){return this.getEventType()==="HIGH_LIGHT"}getBookingId(){return this.bookingEvent.ID}getBookingStatus(){return this.bookingEvent.STATUS}getBookedBy(){return this.bookingEvent.NAME}getBookedRoomId(){return this.bookingEvent.PR_ID}getEventStartingDate(){return new Date(this.bookingEvent.FROM_DATE)}getEventEndingDate(){return new Date(this.bookingEvent.TO_DATE)}getEventType(){return this.bookingEvent.event_type}getEventLegend(){var t,e;let i=(t=this.bookingEvent)===null||t===void 0?void 0:t.legendData.statusId[this.getBookingStatus()];let s=this.isNewEvent()?{color:"#f9f9c9"}:{};return Object.assign(Object.assign(Object.assign({},(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData[i.id]),i),s)}getLegendOfStatus(t){var e;let i=(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData.statusId[t];return Object.assign(Object.assign({},this.bookingEvent.legendData[i.id]),i)}getNoteNode(){if(this.bookingEvent.NOTES||this.bookingEvent.INTERNAL_NOTE||this.bookingEvent.PRIVATE_NOTE){return this.getLegendOfStatus("NOTES")}return null}getBalanceNode(){if(this.bookingEvent.BALANCE!==null&&this.bookingEvent.BALANCE>=1){return this.getLegendOfStatus("OUTSTANDING-BALANCE")}return null}setStayDays(t){this.bookingEvent.NO_OF_DAYS=t;this.renderAgain()}getStayDays(){return this.bookingEvent.NO_OF_DAYS}getPosition(){let t=this.getEventStartingDate();let e=".room_"+this.getBookedRoomId()+"_"+t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear();let i=document.querySelector(".bodyContainer");let s=document.querySelector(e);let n={top:"0",left:"0",width:"0",height:"20px"};if(s&&i&&s.getBoundingClientRect()&&i.getBoundingClientRect()){let t=i.getBoundingClientRect();let e=s.getBoundingClientRect();this.dayWidth=this.dayWidth||e.width;n.top=e.top+e.height/2-this.vertSpace-t.top+"px";n.left=e.left+(!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?0:this.dayWidth/2)+this.eventSpace/2-t.left+"px";n.width=(this.getStayDays()+(!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?.5:0))*this.dayWidth-this.eventSpace+"px"}else{console.log(this.bookingEvent);console.log("Locating event cell failed ",e)}return n}getNumber(t){return t?parseFloat(t):0}startDragging(t,e){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();if(this.isNewEvent()||this.isHighlightEventType()){return null}this.resizeSide=e;this.isDragging=true;this.showEventInfo(false);this.isStreatch=e!=="move";if(e==="move"){this.initialX=t.clientX||t.touches[0].clientX;this.initialY=t.clientY||t.touches[0].clientY;this.elementRect=this.element.getBoundingClientRect();const e=0;const i=0;this.dragInitPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top)+i,left:this.getNumber(this.element.style.left)+e};this.dragInitPos.x=this.dragInitPos.left;this.dragInitPos.y=this.dragInitPos.top;this.dragEndPos=Object.assign({},this.dragInitPos);this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`;this.isTouchStart=true;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:this.dragInitPos})}else{this.initialWidth=this.element.offsetWidth;this.initialLeft=this.element.offsetLeft;this.initialX=t.clientX||t.touches[0].clientX;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:{id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top),left:this.initialLeft,x:this.initialX,y:t.clientY||t.touches[0].clientY}})}document.addEventListener("mousemove",this.handleMouseMoveBind);document.addEventListener("touchmove",this.handleMouseMoveBind);document.addEventListener("pointermove",this.handleMouseMoveBind);document.addEventListener("mouseup",this.handleMouseUpBind);document.addEventListener("touchup",this.handleMouseUpBind);document.addEventListener("pointerup",this.handleMouseUpBind)}handleMouseMove(t){if(this.isDragging){this.currentX=t.clientX||t.touches[0].clientX;let e=this.currentX-this.initialX;if(this.resizeSide==="move"){this.currentY=t.clientY||t.touches[0].clientY;let i=this.currentY-this.initialY;this.element.style.top=`${this.dragInitPos.top+i}px`;this.element.style.left=`${this.dragInitPos.left+e}px`;this.dragEndPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.dragInitPos.top+i,left:this.dragInitPos.left+e};this.dragEndPos.x=this.dragEndPos.left;this.dragEndPos.y=this.dragEndPos.top;this.dragOverEventData.emit({id:"DRAG_OVER",data:this.dragEndPos})}else{if(!this.bookingEvent.is_direct&&!w(this.bookingEvent.STATUS_CODE)){return}let t=this.initialWidth;if(this.resizeSide=="rightSide"){t=this.initialWidth+e;t=Math.min(t,this.initialX+this.element.offsetWidth);t=Math.max(this.dayWidth-this.eventSpace,t);this.element.style.width=`${t}px`;this.isShrinking=e<0}else if(this.resizeSide=="leftSide"){this.isShrinking=e>0;t=Math.max(this.dayWidth-this.eventSpace,this.initialWidth-e);let i=this.initialLeft+(this.initialWidth-t);this.element.style.left=`${i}px`;this.element.style.width=`${t}px`}this.finalWidth=t}}else{console.log("still mouse move listening...")}}handleMouseUp(){if(this.isDragging){if(this.resizeSide==="move"){if(this.isTouchStart){this.moveDiffereneX=Math.abs(this.dragEndPos.x-this.dragInitPos.x);this.moveDiffereneY=Math.abs(this.dragEndPos.y-this.dragInitPos.y)}this.dragOverEventData.emit({id:"DRAG_OVER_END",data:Object.assign(Object.assign({},this.dragEndPos),{pool:this.bookingEvent.POOL,nbOfDays:this.bookingEvent.NO_OF_DAYS})})}else{const t=this.finalWidth-(!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?this.dayWidth/2:0);const e=Math.round(t/this.dayWidth);console.log(t,this.dayWidth,e);let i=this.getStayDays();if(i!=e&&!isNaN(e)){if(this.resizeSide=="leftSide"){this.element.style.left=`${this.initialLeft+(i-e)*this.dayWidth}px`}else{if(e<i){this.isShrinking=true}}this.dragOverEventData.emit({id:"STRETCH_OVER_END",data:{id:this.getBookingId(),fromRoomId:+this.getBookedRoomId(),x:+this.element.style.left.replace("px",""),y:+this.element.style.top.replace("px",""),pool:this.bookingEvent.POOL,nbOfDays:e}});const t=!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?+this.dayWidth/2:0;this.element.style.width=`${e*this.dayWidth-this.eventSpace+t}px`}else{this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${e*this.dayWidth-this.eventSpace}px`}}}else{console.log("still mouse up listening...")}this.isDragging=false;document.removeEventListener("mousemove",this.handleMouseMoveBind);document.removeEventListener("touchmove",this.handleMouseMoveBind);document.removeEventListener("pointermove",this.handleMouseMoveBind);document.removeEventListener("mouseup",this.handleMouseUpBind);document.removeEventListener("touchup",this.handleMouseUpBind);document.removeEventListener("pointerup",this.handleMouseUpBind)}updateData(t){this.updateEventData.emit(t)}calculateHoverPosition(){const t=this.element.getBoundingClientRect();const e=t.width;const i=t.left;const s=window.innerWidth;let n;if(e<=s){n=e/2}else{n=s/2-i}return{position:"absolute",left:`${n}px`,transform:"translateX(-50%)"}}renderEventBookingNumber(){if(this.bookingEvent.STATUS==="TEMP-EVENT"||this.bookingEvent.ID==="NEW_TEMP_EVENT"){return""}if(w(this.bookingEvent.STATUS_CODE)){return""}if(!this.bookingEvent.is_direct){return` - ${this.bookingEvent.channel_booking_nbr}`}return` - ${this.bookingEvent.BOOKING_NUMBER}`}showEventInfo(t){if(this.isHighlightEventType()||this.bookingEvent.hideBubble){return null}if(t){let t=document.querySelector(".calendarScrollContainer");let e=t.getBoundingClientRect();let i=this.element.getBoundingClientRect();let s=e.height/2+e.top+50;if(i.top<s){this.bubbleInfoTopSide=false}else{this.bubbleInfoTopSide=true}}if(t){this.hideBubbleInfo.emit({key:"hidePopup",currentInfoBubbleId:this.getBookingId()})}this.showInfoPopup=t;this.renderAgain()}render(){let t=this.getEventLegend();let s=this.getNoteNode();let o=this.getBalanceNode();return e(i,{key:"7b7432af46b9d28777345e310b4ca98d7d040d30",class:`bookingEvent  ${this.isNewEvent()||this.isHighlightEventType()?"newEvent":""} ${t.clsName} `,style:this.getPosition(),id:"event_"+this.getBookingId()},e("div",{key:"9f1155e485fe4abb1883f858308ffb7a6127ede3",class:`bookingEventBase  ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n          ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}\n          ${!this.bookingEvent.is_direct&&!w(this.bookingEvent.STATUS_CODE)&&this.bookingEvent.STATUS!=="TEMP-EVENT"&&this.bookingEvent.ID!=="NEW_TEMP_EVENT"&&"border border-dark ota-booking-event"}  ${this.isSplitBooking()?"splitBooking":""}`,style:{backgroundColor:t.color,"--ir-event-bg":t.color},onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")}),s?e("div",{class:"legend_circle noteIcon",style:{backgroundColor:s.color}}):null,o?e("div",{class:"legend_circle balanceIcon",style:{backgroundColor:o.color}}):null,e("div",{key:"836a289f2be67a89d1cbb9fccb42d13201964f37",class:"bookingEventTitle",onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")},this.getBookedBy(),this.renderEventBookingNumber()),e(n,{key:"0c1834f95b4ddf069e8224a3f83cfb033d705f46"},e("div",{key:"ca0d404bb93b6992e43847f8bb0708f146135abc",class:`bookingEventDragHandle leftSide ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n            ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"leftSide"),onMouseDown:t=>this.startDragging(t,"leftSide")}),e("div",{key:"7f457ad740f61ea2bc39a4ef25cd53cabb3723ce",class:`bookingEventDragHandle rightSide ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n              ${!this.isNewEvent()&&U(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"rightSide"),onMouseDown:t=>this.startDragging(t,"rightSide")})),this.showInfoPopup?e("igl-booking-event-hover",{is_vacation_rental:this.is_vacation_rental,countryNodeList:this.countryNodeList,currency:this.currency,class:"top",bookingEvent:this.bookingEvent,bubbleInfoTop:this.bubbleInfoTopSide,style:this.calculateHoverPosition()}):null)}get element(){return o(this)}};Ct.style=_t;const Ot=".sc-igl-booking-event-hover-h{display:block;position:relative;z-index:100}.btn.sc-igl-booking-event-hover{padding-left:4px !important;padding-right:4px !important}.balance_amount.sc-igl-booking-event-hover{color:#ff4961;font-size:0.75rem}.user-notes.sc-igl-booking-event-hover{margin-left:4px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:5;line-clamp:5;overflow:hidden;max-width:100%;height:auto}.events_btns.sc-igl-booking-event-hover{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem}.mx-01.sc-igl-booking-event-hover{--m:5px;margin-left:var(--m) !important;margin-right:var(--m) !important}.pointerContainerTop.sc-igl-booking-event-hover{top:-26px}.pointerContainer.sc-igl-booking-event-hover{position:absolute;height:10px;width:350px;left:var(--el-left, 50%);transform:translateX(-50%)}.iglPopOver.sc-igl-booking-event-hover{position:absolute;background-color:#fff;padding:10px;border:1px solid #656ee7;border-radius:6px;left:var(--el-left, 50%);transform:translateX(-50%) translateY(10px);box-shadow:1px 0px 20px rgba(0, 0, 0, 0.2)}.iglPopOver.infoBubble.sc-igl-booking-event-hover{min-width:350px}.iglPopOver.blockedView.sc-igl-booking-event-hover{max-width:400px;width:400px}.iglPopOver.newBookingOptions.sc-igl-booking-event-hover{overflow-wrap:break-word !important;min-width:230px;width:fit-content}.bubblePointer.sc-igl-booking-event-hover{position:absolute;width:0;height:0;left:50%;border-left:10px solid transparent;border-right:10px solid transparent;transform:translate(-50%, 0px)}.bubblePointTop.sc-igl-booking-event-hover{border-top:10px solid #656ee7}.bubblePointBottom.sc-igl-booking-event-hover{border-bottom:10px solid #656ee7}.bubbleInfoAbove.sc-igl-booking-event-hover{bottom:35px}.updateBtnIcon.sc-igl-booking-event-hover{margin-right:4px}.icon-image.sc-igl-booking-event-hover{height:1.5rem;width:1.5rem;margin-right:5px}";const Et=Ot;const At=class{constructor(e){t(this,e);this.showBookingPopup=s(this,"showBookingPopup",7);this.hideBubbleInfo=s(this,"hideBubbleInfo",7);this.deleteButton=s(this,"deleteButton",7);this.bookingCreated=s(this,"bookingCreated",7);this.showDialog=s(this,"showDialog",7);this.eventService=new wt;this.hideButtons=false;this.bookingEvent=undefined;this.bubbleInfoTop=false;this.currency=undefined;this.countryNodeList=undefined;this.is_vacation_rental=false;this.isLoading=undefined;this.shouldHideUnassignUnit=false;this.canCheckInOrCheckout=undefined}componentWillLoad(){let t=this.bookingEvent.roomsInfo.find((t=>t.id===this.bookingEvent.RATE_TYPE));if(t){this.shouldHideUnassignUnit=t.physicalrooms.length===1}if(U(this.bookingEvent.TO_DATE,"YYYY-MM-DD").isBefore(U())){this.hideButtons=true}this.canCheckInOrCheckout=U(new Date).isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&U(new Date).isBefore(new Date(this.bookingEvent.TO_DATE),"days");this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}handleBookingEventChange(t,e){if(t!==e)this.canCheckInOrCheckout=U(new Date).isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&U(new Date).isBefore(new Date(this.bookingEvent.TO_DATE),"days")}getBookingId(){return this.bookingEvent.ID}hideBubble(){this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()});document.removeEventListener("keydown",this.handleKeyDown)}handleKeyDown(t){if(t.key==="Escape"){this.hideBubble()}else return}getTotalOccupants(){var t,e,i;const{CHILDREN_COUNT:s,ADULTS_COUNT:n}=this.bookingEvent;if(s===0){return`${n} ${n>1?p.entries.Lcz_AdultsCaption.toLowerCase():(t=p.entries.Lcz_Single_Adult)===null||t===void 0?void 0:t.toLowerCase()}`}return`${n} ${n>1?p.entries.Lcz_AdultsCaption.toLowerCase():(e=p.entries.Lcz_Single_Adult)===null||e===void 0?void 0:e.toLowerCase()}, ${s} ${s>1?p.entries.Lcz_ChildCaption.toLowerCase():(i=p.entries.Lcz_Single_Child)===null||i===void 0?void 0:i.toLowerCase()}`}getPhoneNumber(){return this.bookingEvent.PHONE}getCountry(){return x(this.bookingEvent.COUNTRY,this.countryNodeList).name}getPhoneCode(){if(this.bookingEvent.PHONE_PREFIX){return this.bookingEvent.PHONE_PREFIX}return x(this.bookingEvent.COUNTRY,this.countryNodeList).phone_prefix}renderPhone(){return this.bookingEvent.COUNTRY?`${this.bookingEvent.is_direct?this.getPhoneCode()+"-":""}${this.getPhoneNumber()} - ${this.getCountry()}`:this.getPhoneNumber()}getInternalNote(){return this.bookingEvent.INTERNAL_NOTE}getTotalPrice(){return this.bookingEvent.TOTAL_PRICE}getArrivalTime(){return this.bookingEvent.ARRIVAL_TIME}getRatePlan(){return this.bookingEvent.RATE_PLAN}getEntryDate(){return this.bookingEvent.ENTRY_DATE}isNewBooking(){return this.getBookingId()==="NEW_TEMP_EVENT"}isCheckedIn(){return this.bookingEvent.STATUS==="IN-HOUSE"}isBlockedDateEvent(){return this.bookingEvent.STATUS==="BLOCKED"||this.bookingEvent.STATUS==="BLOCKED-WITH-DATES"}hasSplitBooking(){return this.bookingEvent.hasOwnProperty("splitBookingEvents")&&this.bookingEvent.splitBookingEvents}canCheckIn(){if(!g.checkin_enabled||g.is_automatic_check_in_out){return false}if(this.isCheckedIn()){return false}if(this.canCheckInOrCheckout){return true}return false}canCheckOut(){if(!g.checkin_enabled||g.is_automatic_check_in_out){return false}if(this.isCheckedIn()&&this.canCheckInOrCheckout){return true}else{return false}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookingEvent=Object.assign(Object.assign({},this.bookingEvent),e.data)}handleEditBooking(){this.bookingEvent.TITLE=p.entries.Lcz_EditBookingFor;this.handleBookingOption("EDIT_BOOKING")}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}handleAddRoom(){var t;let e=new Date(this.bookingEvent.FROM_DATE);e.setHours(0,0,0,0);let i=this.getStringDateFormat(e);let s=new Date(this.bookingEvent.TO_DATE);s.setHours(0,0,0,0);let n=this.getStringDateFormat(s);let o={ID:"",NAME:"",BOOKING_NUMBER:this.bookingEvent.BOOKING_NUMBER,FROM_DATE:i,TO_DATE:n,roomsInfo:this.bookingEvent.roomsInfo,ARRIVAL:this.bookingEvent.ARRIVAL,ADD_ROOM_TO_BOOKING:this.bookingEvent.ID,TITLE:"Add Room to #"+this.bookingEvent.BOOKING_NUMBER,event_type:"ADD_ROOM",ROOMS:this.bookingEvent.ROOMS,GUEST:this.bookingEvent.GUEST,message:this.bookingEvent.NOTES,SOURCE:this.bookingEvent.SOURCE,booking:(t=this.bookingEvent)===null||t===void 0?void 0:t.booking,defaultDateRange:{fromDate:e,fromDateStr:"",toDate:s,toDateStr:"",dateDifference:0,editabled:true,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};this.handleBookingOption("ADD_ROOM",o)}handleCustomerCheckIn(){this.showDialog.emit({reason:"checkin",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:""})}handleCustomerCheckOut(){this.showDialog.emit({reason:"checkout",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:""})}handleDeleteEvent(){this.hideBubble();this.deleteButton.emit(this.bookingEvent.POOL);console.log("Delete Event")}async handleUpdateBlockedDates(){try{this.isLoading="update";setTimeout((()=>{this.hideBubble()}),50);await this.eventService.updateBlockedEvent(this.bookingEvent);this.isLoading=""}catch(t){}}handleConvertBlockedDateToBooking(){this.handleBookingOption("BAR_BOOKING")}getRoomInfo(){const t=+this.bookingEvent.PR_ID;let e={};for(const i of this.bookingEvent.roomsInfo){for(const s of i.physicalrooms){if(t===s.id){e.CATEGORY=i.name;e.ROOM_NAME=s.name;e.ROOMS_INFO=i;return e}}}return e}renderTitle(t,e){switch(t){case"EDIT_BOOKING":return`${p.entries.Lcz_EditBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`;case"ADD_ROOM":return`${p.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;case"SPLIT_BOOKING":return p.entries.Lcz_Adding+` ${e.CATEGORY} ${e.ROOM_NAME}`;default:return`${p.entries.Lcz_NewBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`}}handleBookingOption(t,e=null){const i=this.getRoomInfo();let s=e?e:this.bookingEvent;s.event_type=t;s.TITLE=this.renderTitle(t,i);if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){s.roomsInfo=[i.ROOMS_INFO]}if(t==="BAR_BOOKING"&&this.bookingEvent.STATUS!=="TEMP-EVENT"){const{FROM_DATE:t,TO_DATE:e,PR_ID:i,RELEASE_AFTER_HOURS:n,ENTRY_DATE:o,OPTIONAL_REASON:r,ENTRY_MINUTE:a,ENTRY_HOUR:l,STATUS_CODE:c}=this.bookingEvent;s.block_exposed_unit_props={from_date:t,to_date:e,NOTES:r,pr_id:i,STAY_STATUS_CODE:c,DESCRIPTION:n,BLOCKED_TILL_DATE:o,BLOCKED_TILL_HOUR:l,BLOCKED_TILL_MINUTE:a};this.handleDeleteEvent()}this.showBookingPopup.emit({key:"add",data:Object.assign({},s)});this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}getInfoElement(){var t,i,s,n,o;return e("div",{class:`iglPopOver infoBubble ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},e("div",{class:`row p-0 m-0  ${this.bookingEvent.BALANCE>1?"pb-0":"pb-1"}`},e("div",{class:"px-0  col-8 font-weight-bold font-medium-1 d-flex align-items-center"},e("img",{src:(i=(t=this.bookingEvent)===null||t===void 0?void 0:t.origin)===null||i===void 0?void 0:i.Icon,alt:(n=(s=this.bookingEvent)===null||s===void 0?void 0:s.origin)===null||n===void 0?void 0:n.Label,class:"icon-image"}),e("p",{class:"p-0 m-0"},!this.bookingEvent.is_direct?this.bookingEvent.channel_booking_nbr:this.bookingEvent.BOOKING_NUMBER)),e("div",{class:"pr-0 col-4 text-right"},m(this.currency.symbol,this.getTotalPrice()))),this.bookingEvent.BALANCE>1&&e("p",{class:"pr-0 m-0 p-0 text-right balance_amount"},p.entries.Lcz_Balance,": ",m(this.currency.symbol,this.bookingEvent.BALANCE)),e("div",{class:"row p-0 m-0"},e("div",{class:"px-0 pr-0 col-12"},e("ir-date-view",{from_date:this.bookingEvent.defaultDates.from_date,to_date:this.bookingEvent.defaultDates.to_date,showDateDifference:false}))),this.getArrivalTime()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_ArrivalTime}:`,content:this.getArrivalTime()}),this.getTotalOccupants()&&e("ir-label",{class:"m-0 p-0",containerStyle:{padding:"0",margin:"0"},labelText:`${p.entries.Lcz_Occupancy}:`,content:this.getTotalOccupants()}),this.getPhoneNumber()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_Phone}:`,content:this.renderPhone()}),this.getRatePlan()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_RatePlan}:`,content:this.getRatePlan()}),this.bookingEvent.PRIVATE_NOTE&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_BookingPrivateNote}:`,display:"inline",content:this.bookingEvent.PRIVATE_NOTE}),this.bookingEvent.is_direct?e("ir-label",{containerStyle:{padding:"0",margin:"0"},labelText:`${p.entries.Lcz_GuestRemark}:`,display:"inline",content:this.bookingEvent.NOTES}):e("ota-label",{class:"m-0 p-0",label:`${p.entries.Lcz_ChannelNotes||"Channel notes"}:`,remarks:this.bookingEvent.ota_notes,maxVisibleItems:(o=this.bookingEvent.ota_notes)===null||o===void 0?void 0:o.length}),this.getInternalNote()&&e("ir-label",{labelText:`${p.entries.Lcz_InternalRemark}:`,content:this.getInternalNote()}),e("div",{class:"row p-0 m-0 mt-2"},e("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},e("ir-button",{style:{"--icon-size":"0.875rem"},onClickHandler:()=>this.handleEditBooking(),class:"w-100",btn_block:true,text:p.entries.Lcz_Edit,icon_name:"edit",btn_styles:"h-100",size:"sm"}),this.bookingEvent.is_direct&&this.bookingEvent.IS_EDITABLE&&!this.hideButtons&&e("ir-button",{style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_AddRoom,icon_name:"square_plus",size:"sm",btn_styles:"h-100",onClickHandler:()=>this.handleAddRoom()}),this.canCheckIn()&&e("ir-button",{style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_CheckIn,onClickHandler:()=>this.handleCustomerCheckIn(),icon_name:"edit",btn_styles:"h-100",size:"sm"}),this.canCheckOut()&&e("ir-button",{btn_styles:"h-100",style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_CheckOut,icon_name:"edit",onClickHandler:()=>this.handleCustomerCheckOut(),size:"sm"}),this.hideButtons?null:!this.shouldHideUnassignUnit&&e("ir-button",{btn_styles:"h-100",style:{"--icon-size":"0.875rem"},size:"sm",text:p.entries.Lcz_Unassign,icon_name:"xmark",onClickHandler:t=>{this.handleDeleteEvent()}}))))}getNewBookingOptions(){const t=this.bookingEvent.roomsInfo[0].rateplans.some((t=>t.is_active));return e("div",{class:`iglPopOver d-flex flex-column newBookingOptions ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`,style:{gap:"0.5rem"}},t?e(n,null,e("ir-button",{size:"sm",btn_block:true,text:p.entries.Lcz_CreateNewBooking,onClickHandler:t=>{this.handleBookingOption("BAR_BOOKING")}}),this.hasSplitBooking()&&e("ir-button",{size:"sm",btn_block:true,text:p.entries.Lcz_AssignUnitToExistingBooking,onClickHandler:t=>{this.handleBookingOption("SPLIT_BOOKING")}})):e("p",{class:"text-danger"},p.entries.Lcz_NoRatePlanDefined),e("ir-button",{size:"sm",text:p.entries.Lcz_Blockdates,btn_block:true,onClickHandler:t=>{this.handleBookingOption("BLOCK_DATES")}}))}getBlockedView(){return e("div",{class:`iglPopOver blockedView ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},e("igl-block-dates-view",{isEventHover:true,entryHour:this.bookingEvent.ENTRY_HOUR,entryMinute:this.bookingEvent.ENTRY_MINUTE,defaultData:this.bookingEvent,fromDate:U(this.bookingEvent.defaultDates.from_date,"YYYY-MM-DD").format("DD MM YYYY"),toDate:U(this.bookingEvent.defaultDates.to_date,"YYYY-MM-DD").format("DD MM YYYY"),entryDate:this.getEntryDate(),onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),e("div",{class:"row p-0 m-0 mt-2"},e("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},e("ir-button",{btn_disabled:this.isLoading==="update",text:p.entries.Lcz_Update,onClickHandler:t=>{this.handleUpdateBlockedDates()},icon_name:"edit",size:"sm",btn_styles:"h-100",isLoading:this.isLoading==="update",style:{"--icon-size":"0.875rem"},btn_block:true,class:"w-100"}),e("ir-button",{class:"w-100 h-100 my-0",btn_block:true,btn_styles:"h-100",size:"sm",text:p.entries.Lcz_ConvertToBooking,onClickHandler:()=>{this.handleConvertBlockedDateToBooking()}}),e("ir-button",{class:"w-100",btn_styles:"h-100",btn_block:true,size:"sm",style:{"--icon-size":"0.875rem"},icon_name:"trash",btn_color:"danger",onClickHandler:t=>{this.handleDeleteEvent()},text:p.entries.Lcz_Delete}))))}render(){return e(i,{key:"59b11ad3c4644fce5e11c21fa463b8b217daae40"},e("div",{key:"38503db1b0fadbce11d92ae8130a2b5827d8c3b6",class:`pointerContainer ${this.bubbleInfoTop?"pointerContainerTop":""}`},e("div",{key:"1b7fbfef5a065018c69b8ef1565d58b64f9d0657",class:`bubblePointer ${this.bubbleInfoTop?"bubblePointTop":"bubblePointBottom"}`})),this.isBlockedDateEvent()?this.getBlockedView():null,this.isNewBooking()?this.getNewBookingOptions():null,!this.isBlockedDateEvent()&&!this.isNewBooking()?this.getInfoElement():null)}get element(){return o(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};At.style=Et;const Bt=".sc-igl-booking-form-h{display:block}.card-title.sc-igl-booking-form{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-booking-form{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-booking-form{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-booking-form{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-booking-form{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-booking-form{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-booking-form{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-booking-form:not(:disabled),[type='button'].sc-igl-booking-form:not(:disabled){cursor:pointer}.row.sc-igl-booking-form{padding:0 0 0 15px;margin:0}";const Mt=Bt;const Tt=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.buttonClicked=s(this,"buttonClicked",7);this.showPaymentDetails=undefined;this.currency=undefined;this.isEditOrAddRoomEvent=undefined;this.dateRangeData=undefined;this.bookingData=undefined;this.showSplitBookingOption=undefined;this.language=undefined;this.bookedByInfoData=undefined;this.propertyId=undefined;this.bedPreferenceType=undefined;this.selectedRooms=undefined;this.isLoading=undefined;this.countryNodeList=undefined;this.selectedGuestData=undefined;this.defaultGuestData=undefined;this.selectedBookedByData=undefined;this.guestData=undefined;this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const e=Object.assign({},this.selectedUnits);const i=(t,e,i,s)=>{if(i&&s===2){return t*e}return t};this.selectedUnits=e;this.guestData=[];this.selectedRooms.forEach(((s,n)=>{s.forEach((s=>{e[n]=s.selectedUnits;t+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,e){const i=t.detail;const s=`c_${i.data.roomCategoryId}`;const n=[...this.selectedUnits[s]||[]];n[e]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:n});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,e,i){if(e==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,i)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const e=(t,e,i)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return this.isLoading===t||e(this.selectedGuestData,"guestName","")||e(this.selectedBookedByData,"isdCode","")||e(this.selectedBookedByData,"contactNumber","")||e(this.selectedBookedByData,"firstName","")||e(this.selectedBookedByData,"lastName","")||e(this.selectedBookedByData,"countryId",-1)||e(this.selectedBookedByData,"selectedArrivalTime","")||e(this.selectedBookedByData,"email","")}render(){var t;const s=g.checkin_enabled&&U(new Date((t=this.dateRangeData)===null||t===void 0?void 0:t.fromDate)).isSame(new Date,"day");return e(i,{key:"12df69527af5060078b7d2fcd0be3377b23115da"},e("div",{key:"c2d4c42fa95ecfb7670a45d122a3625c5f87ad35",class:"d-flex flex-wrap"},e("ir-date-view",{key:"72f398b82b8f4b826b87c5a02579c899da9a71e9",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&e("div",{key:"ca7c6f54f93992e295ef74781abc4ba689c2f3d7",class:"mt-1 mt-md-0 text-right"},p.entries.Lcz_TotalPrice," ",e("span",{key:"47e9d07747a3d15bc59a909f02c282317eb0d9d3",class:"font-weight-bold font-medium-1"},m(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(r.ratePlanSelections).map((t=>Object.values(t).map((t=>{const i=t;if(i.reserved===0){return null}return[...new Array(i.reserved)].map(((t,s)=>e("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:i.guest?i.guest[s]:null,bookingType:this.bookingData.event_type,rateplanSelection:i,key:`${i.ratePlan.id}_${s}`,roomIndex:s,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:e("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>{this.handleEventData(t,"propertyBookedBy",0)}}),this.isEditOrAddRoomEvent?e("div",{class:"d-flex p-0 mb-1 mt-2"},e("div",{class:"flex-fill mr-2"},e("ir-button",{icon:"",text:p.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"back"})})),e("div",{class:"flex-fill"},e("ir-button",{isLoading:this.isLoading==="save",onClickHandler:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:p.entries.Lcz_Save}))):e("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},e("div",{class:"flex-fill mr-md-1"},e("ir-button",{icon_name:"angles_left",btn_color:"secondary",btn_styles:"full-width align-items-center justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"back"}),text:p.entries.Lcz_Back,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}})),e("div",{class:`mt-1 mt-md-0 flex-fill ${s?"mr-md-1":""}`},e("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"book"}),text:p.entries.Lcz_Book})),s&&e("div",{class:"mt-1 mt-md-0 flex-fill"},e("ir-button",{isLoading:this.isLoading==="bookAndCheckIn",btn_styles:"full-width align-items-center justify-content-center",onClickHandler:()=>this.buttonClicked.emit({key:"bookAndCheckIn"}),text:p.entries.Lcz_BookAndChekcIn}))))}};Tt.style=Mt;const It=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const St=It;const Yt=class{constructor(e){t(this,e);this.roomsDataUpdate=s(this,"roomsDataUpdate",7);this.bookingData=undefined;this.propertyId=undefined;this.message=undefined;this.showSplitBookingOption=undefined;this.eventType=undefined;this.currency=undefined;this.adultChildConstraints=undefined;this.ratePricingMode=undefined;this.dateRangeData=undefined;this.defaultDaterange=undefined;this.selectedRooms=undefined;this.adultChildCount=undefined;this.sourceOptions=undefined;this.bookedByInfoData=undefined;this.initialRoomIds=undefined}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const t=U(this.bookingData.FROM_DATE,"YYYY-MM-DD");const e=U();if(t.isAfter(e)){return e.add(-2,"weeks").format("YYYY-MM-DD")}return t.add(-2,"weeks").format("YYYY-MM-DD")}render(){var t;return e(i,{key:"61a7b2f93e71aecd044d918d2b63a206a89e1c90"},e("igl-book-property-header",{key:"d593354ee0d743795e23283ec0856d7a1b08d854",bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),e("div",{key:"60677cff868b32fec71c95311efa558139ca9562",class:" text-left"},G("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?e("div",{class:"loading-container"},e("div",{class:"loader"})):e(n,null,(t=r.roomTypes)===null||t===void 0?void 0:t.map((t=>e("igl-room-type",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomType:t,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)}))))),e("igl-book-property-footer",{key:"171bb18005cf3a5cf49d3c4cc34779ad44ae50aa",class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type}))}};Yt.style=St;const Nt=".sc-igl-cal-body-h{display:block}.bodyContainer.sc-igl-cal-body{position:relative}.roomRow.sc-igl-cal-body{width:max-content}.roomRow.sc-igl-cal-body:first-child{margin-top:80px}.categoryName.sc-igl-cal-body{font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.roomRow.sc-igl-cal-body .room.sc-igl-cal-body{cursor:pointer;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.roomRow.sc-igl-cal-body .room.sc-igl-cal-body:hover{background:#e0e0e0}.cellData.sc-igl-cal-body{width:58px;height:30px;display:inline-grid;border-top:1px solid #e0e0e0;border-left:1px solid #e0e0e0;vertical-align:top}.cellData.sc-igl-cal-body:nth-child(2){border-left:0px}.cellData.sc-igl-cal-body:last-child{border-right:1px solid rgba(186, 191, 199, 0.5)}.roomHeaderCell.sc-igl-cal-body{position:-webkit-sticky;position:sticky;left:0;background:#fff;border-right:1px solid #ccc;width:170px;z-index:1}.currentDay.sc-igl-cal-body{background-color:#e3f3fa}.dragOverHighlight.sc-igl-cal-body{background-color:#f5f5dc !important}.selectedDay.sc-igl-cal-body{background-color:#f9f9c9 !important}.categoryTitle.sc-igl-cal-body{grid-template-columns:1fr 20px;padding-left:10px;cursor:pointer;height:40px;font-size:0.9em}.categoryTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.sc-igl-cal-body{padding-left:20px;font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.roomTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.pl10.sc-igl-cal-body{padding-left:10px}.categoryPriceColumn.sc-igl-cal-body{align-items:center;height:40px;-webkit-user-select:none;user-select:none}.bookingEventsContainer.sc-igl-cal-body{position:absolute;top:0;left:0}";const Lt=Nt;const jt=class{constructor(e){t(this,e);this.addBookingDatasEvent=s(this,"addBookingDatasEvent",7);this.showBookingPopup=s(this,"showBookingPopup",7);this.scrollPageToRoom=s(this,"scrollPageToRoom",7);this.selectedRooms={};this.fromRoomId=-1;this.currentDate=new Date;this.housekeepingService=new q;this.isScrollViewDragging=undefined;this.propertyId=undefined;this.calendarData=undefined;this.today=undefined;this.currency=undefined;this.language=undefined;this.countryNodeList=undefined;this.highlightedDate=undefined;this.dragOverElement="";this.renderAgain=false;this.selectedRoom=undefined}componentWillLoad(){this.currentDate.setHours(0,0,0,0)}dragOverHighlightElementHandler(t){this.dragOverElement=t.detail.dragOverElement}gotoRoom(t){let e=t.detail.roomId;let i=this.getRoomCategoryByRoomId(e);if(!i.expanded){this.toggleCategory(i);setTimeout((()=>{this.scrollToRoom(e)}),10)}else{this.scrollToRoom(e)}}addToBeAssignedEvents(t){this.addBookingDatas(t.detail.data);this.renderElement()}scrollToRoom(t){this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:t,refClass:"room_"+t})}getRoomCategoryByRoomId(t){return this.calendarData.roomsInfo.find((e=>this.getCategoryRooms(e).find((e=>this.getRoomId(e)===t))))}getCategoryName(t){return t.name}getCategoryId(t){return t.id}getTotalPhysicalRooms(t){return this.getCategoryRooms(t).length}getCategoryRooms(t){return t&&t.physicalrooms||[]}getRoomName(t){return t.name}getRoomId(t){return t.id}getRoomById(t,e){return t.find((t=>this.getRoomId(t)===e))}getBookingData(){return this.calendarData.bookingEvents}addBookingDatas(t){this.addBookingDatasEvent.emit(t)}getSelectedCellRefName(t,e){return"room_"+t+"_"+e.currentDate}getSplitBookingEvents(t){console.log(t.FROM_DATE);return this.getBookingData().some((e=>{if(!["003","002","004"].includes(e.STATUS_CODE)){if(new Date(t.FROM_DATE).getTime()>=new Date(e.FROM_DATE).getTime()&&new Date(t.FROM_DATE).getTime()<=new Date(e.TO_DATE).getTime()){return e}}}))}closeWindow(){let t=this.getBookingData().findIndex((t=>t.ID==="NEW_TEMP_EVENT"));if(t!==-1){this.getBookingData().splice(t,1);console.log("removed item..");this.renderElement()}}addNewEvent(t){let i=Object.keys(this.selectedRooms);let s,n;if(this.selectedRooms[i[0]].currentDate<this.selectedRooms[i[1]].currentDate){s=new Date(this.selectedRooms[i[0]].currentDate);n=new Date(this.selectedRooms[i[1]].currentDate)}else{s=new Date(this.selectedRooms[i[1]].currentDate);n=new Date(this.selectedRooms[i[0]].currentDate)}this.newEvent={ID:"NEW_TEMP_EVENT",NAME:e("span",null," "),EMAIL:"",PHONE:"",convertBooking:false,REFERENCE_TYPE:"PHONE",FROM_DATE:s.getFullYear()+"-"+this.getTwoDigitNumStr(s.getMonth()+1)+"-"+this.getTwoDigitNumStr(s.getDate()),TO_DATE:n.getFullYear()+"-"+this.getTwoDigitNumStr(n.getMonth()+1)+"-"+this.getTwoDigitNumStr(n.getDate()),BALANCE:"",NOTES:"",RELEASE_AFTER_HOURS:0,PR_ID:this.selectedRooms[i[0]].roomId,ENTRY_DATE:"",NO_OF_DAYS:(n-s)/864e5,ADULTS_COUNT:1,COUNTRY:"",INTERNAL_NOTE:"",RATE:"",TOTAL_PRICE:"",RATE_PLAN:"",ARRIVAL_TIME:"",TITLE:p.entries.Lcz_NewBookingFor,roomsInfo:[t],CATEGORY:t.name,event_type:"BAR_BOOKING",STATUS:"TEMP-EVENT",defaultDateRange:{fromDate:null,fromDateStr:"",toDate:null,toDateStr:"",dateDifference:(n-s)/864e5,editable:false,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};let o=t.name+" "+this.getRoomName(this.getRoomById(this.getCategoryRooms(t),this.selectedRooms[i[0]].roomId));this.newEvent.BLOCK_DATES_TITLE=`${p.entries.Lcz_BlockDatesFor} ${o}`;this.newEvent.TITLE+=o;this.newEvent.defaultDateRange.toDate=new Date(this.newEvent.TO_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDate=new Date(this.newEvent.FROM_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDateStr=this.getDateStr(this.newEvent.defaultDateRange.fromDate);this.newEvent.defaultDateRange.toDateStr=this.getDateStr(this.newEvent.defaultDateRange.toDate);this.newEvent.ENTRY_DATE=(new Date).toISOString();this.newEvent.legendData=this.calendarData.formattedLegendData;let r=this.getSplitBookingEvents(this.newEvent);if(r){this.newEvent.splitBookingEvents=r}this.getBookingData().push(this.newEvent);return this.newEvent}getTwoDigitNumStr(t){return t<=9?"0"+t:t}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}removeNewEvent(){this.calendarData.bookingEvents=this.calendarData.bookingEvents.filter((t=>t.ID!=="NEW_TEMP_EVENT"));this.newEvent=null}clickCell(t,e,i){if(!this.isScrollViewDragging&&e.currentDate>=this.currentDate.getTime()){let s=this.getSelectedCellRefName(t,e);if(this.selectedRooms.hasOwnProperty(s)){this.removeNewEvent();delete this.selectedRooms[s];this.renderElement();return}else if(Object.keys(this.selectedRooms).length!=1||this.fromRoomId!=t){this.removeNewEvent();this.selectedRooms={};this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.fromRoomId=t;this.renderElement()}else{this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.addNewEvent(i);this.selectedRooms={};this.renderElement();this.showNewBookingPopup(this.newEvent)}}}showNewBookingPopup(t){console.log(t)}renderElement(){this.renderAgain=!this.renderAgain}getGeneralCategoryDayColumns(t,i=false,s){return z.days.map((n=>e("div",{class:`cellData  font-weight-bold categoryPriceColumn ${t+"_"+n.day} ${n.day===this.today||n.day===this.highlightedDate?"currentDay":""}`},i?e("span",{class:"categoryName"},n.rate[s].exposed_inventory.rts):"")))}getGeneralRoomDayColumns(t,i){return this.calendarData.days.map((s=>e("div",{class:`cellData ${"room_"+t+"_"+s.day} ${s.day===this.today||s.day===this.highlightedDate?"currentDay":""} ${this.dragOverElement===t+"_"+s.day?"dragOverHighlight":""} ${this.selectedRooms.hasOwnProperty(this.getSelectedCellRefName(t,s))?"selectedDay":""}`,onClick:()=>this.clickCell(t,s,i)})))}toggleCategory(t){t.expanded=!t.expanded;this.renderElement()}getRoomCategoryRow(t,i){if(this.getTotalPhysicalRooms(t)<=1||!t.is_active){return null}return e("div",{class:"roomRow"},e("div",{class:`cellData text-left align-items-center roomHeaderCell categoryTitle ${"category_"+this.getCategoryId(t)}`,onClick:()=>this.toggleCategory(t)},e("div",{class:"categoryName"},e("ir-interactive-title",{popoverTitle:this.getCategoryName(t)})),t.expanded?e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"})):e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"}))),this.getGeneralCategoryDayColumns("category_"+this.getCategoryId(t),true,i))}getRoomsByCategory(t){var i;if(!t.expanded){return[]}return(i=this.getCategoryRooms(t))===null||i===void 0?void 0:i.map((i=>{if(!i.is_active){return null}return e("div",{class:"roomRow"},e("div",{class:`cellData room text-left align-items-center roomHeaderCell  roomTitle ${this.getTotalPhysicalRooms(t)<=1?"pl10":""} ${"room_"+this.getRoomId(i)}`,"data-room":this.getRoomId(i),onClick:()=>{this.selectedRoom=i;this.hkModal.openModal()}},e("ir-interactive-title",{hkStatus:i.hk_status!=="001",popoverTitle:this.getTotalPhysicalRooms(t)<=1?this.getCategoryName(t):this.getRoomName(i)})),this.getGeneralRoomDayColumns(this.getRoomId(i),t))}))}getRoomRows(){var t;return(t=this.calendarData.roomsInfo)===null||t===void 0?void 0:t.map(((t,e)=>{if(t.is_active){return[this.getRoomCategoryRow(t,e),this.getRoomsByCategory(t)]}else{return null}}))}render(){var t,s,n;return e(i,{key:"dc3e463844d4f7e83a82816b7449ee66022ca137"},e("div",{key:"6b6b5261c081d2f37f24425db70a66fc8cc32abe",class:"bodyContainer"},this.getRoomRows(),e("div",{key:"39ccb6ae207e5241f45927825150e301d75fa5b2",class:"bookingEventsContainer preventPageScroll"},(t=this.getBookingData())===null||t===void 0?void 0:t.map((t=>e("igl-booking-event",{language:this.language,is_vacation_rental:this.calendarData.is_vacation_rental,countryNodeList:this.countryNodeList,currency:this.currency,"data-component-id":t.ID,bookingEvent:t,allBookingEvents:this.getBookingData()}))))),e("ir-modal",{key:"2e25adbda38b3b827876aeb3daa79afc9ed77db4",ref:t=>this.hkModal=t,leftBtnText:(s=p===null||p===void 0?void 0:p.entries)===null||s===void 0?void 0:s.Lcz_Cancel,rightBtnText:(n=p===null||p===void 0?void 0:p.entries)===null||n===void 0?void 0:n.Lcz_Update,modalBody:this.renderModalBody(),onConfirmModal:async t=>{var e,i;t.stopImmediatePropagation();t.stopPropagation();await this.housekeepingService.setExposedUnitHKStatus({property_id:this.propertyId,status:{code:((e=this.selectedRoom)===null||e===void 0?void 0:e.hk_status)==="001"?"002":"001"},unit:{id:(i=this.selectedRoom)===null||i===void 0?void 0:i.id}});this.selectedRoom=null;this.hkModal.closeModal()},autoClose:false,isLoading:G("/Set_Exposed_Unit_HK_Status"),onCancelModal:t=>{t.stopImmediatePropagation();t.stopPropagation();this.selectedRoom=null}}))}renderModalBody(){var t,i;if(!this.selectedRoom){return null}return e("p",null,"Update unit ",(t=this.selectedRoom)===null||t===void 0?void 0:t.name," status to ",e("b",null,((i=this.selectedRoom)===null||i===void 0?void 0:i.hk_status)==="001"?"Dirty":"Clean"))}};jt.style=Lt;const Rt=".sc-igl-cal-footer-h{display:block;position:sticky;bottom:0;width:max-content;z-index:3}.footerCell.sc-igl-cal-footer{display:-moz-inline-grid;display:-ms-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;bottom:0;width:58px;height:40px;background:#fff;vertical-align:top;border-top:1px solid #e0e0e0}.bottomLeftCell.sc-igl-cal-footer{left:-1px;z-index:2;width:170px;text-align:left;padding-left:15px;color:#000000}.footerCell.sc-igl-cal-footer i.sc-igl-cal-footer{margin-right:5px}.legendBtn.sc-igl-cal-footer{color:#41bff3;cursor:pointer}.isOnline.sc-igl-cal-footer i.sc-igl-cal-footer{color:#2f9c3f;font-weight:bold}.isOffline.sc-igl-cal-footer i.sc-igl-cal-footer{font-weight:bold}.isOffline.sc-igl-cal-footer{color:#a40000}.dayTitle.sc-igl-cal-footer{font-size:0.8em;font-weight:600;display:grid;user-select:none}.currentDay.sc-igl-cal-footer .dayTitle.sc-igl-cal-footer{font-weight:bold}.currentDay.sc-igl-cal-footer{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-footer{font-size:0.75em}.badge-pill.sc-igl-cal-footer{padding-left:1em;padding-right:1em;font-size:0.7em;margin-bottom:2px}";const zt=Rt;const $t=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.calendarData=undefined;this.today=undefined;this.highlightedDate=undefined}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return e(i,{key:"a12541f46ae04c4de7d688addb5e0814542e38d2",class:"footerContainer"},e("div",{key:"f0639515b89500f5c45c83b645eb9e24eff63416",class:"footerCell bottomLeftCell align-items-center preventPageScroll"},e("div",{key:"66d2150afae110aafc44cdec772938600d66e139",class:"legendBtn",onClick:()=>this.handleOptionEvent("showLegend")},e("i",{key:"9de56a03a015c39450a71b22fc869c4d1b54bb18",class:"la la-square"}),e("u",{key:"04054e10eac689bdc48c260b008c83be984d7c09"},p.entries.Lcz_Legend),e("span",{key:"52722135a4f8af736e3a5bb2daff0df6d6df24db"}," - v99.18"))),this.calendarData.days.map((t=>e("div",{class:"footerCell align-items-center"},e("div",{class:`dayTitle full-height align-items-center ${t.day===this.today||this.highlightedDate===t.day?"currentDay":""}`},t.dayDisplayName)))))}};$t.style=zt;class Ft{async getUnassignedDates(t,e,i){try{const{data:s}=await W.post(`/Get_UnAssigned_Dates`,{propertyid:t,from_date:e,to_date:i});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return this.convertUnassignedDates(s.My_Result)}catch(t){console.error(t);throw new Error(t)}}async getUnassignedRooms(t,e,i,s,n){try{const{data:o}=await W.post(`/Get_Aggregated_UnAssigned_Rooms`,{propertyid:e,specific_date:i});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return this.transformToAssignable(t,o,s,n)}catch(t){console.error(t);throw new Error(t)}}async assignUnit(t){try{const{data:e}=await W.post(`/Assign_Exposed_Room`,Object.assign(Object.assign({},t),{extras:v}));if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}console.log(e);return e["My_Result"]}catch(t){console.error(t);throw new Error(t)}}cleanSpacesAndSpecialChars(t){const e=/[^a-zA-Z0-9]+/g;return t.replace(e,"")}transformToAssignable(t,e,i,s){const n=[];e.My_Result.forEach((e=>{e.unassigned_rooms.forEach((e=>{let o={roomTypeName:e.room_type_name,ID:e.identifier,NAME:e.guest_name,identifier:e.identifier,FROM_DATE:e.unassigned_date,TO_DATE:e.unassigned_date,BOOKING_NUMBER:e.book_nbr,STATUS:"IN-HOUSE",defaultDateRange:{fromDate:undefined,toDate:undefined,fromDateTimeStamp:0,toDateTimeStamp:0,fromDateStr:"",toDateStr:"",dateDifference:0},NO_OF_DAYS:1,roomsInfo:i,legendData:s,availableRooms:[],RT_ID:this.getRoomTypeId(e.room_type_name,i)};this.updateAvailableRooms(t,e,o,s,i);this.addDefaultDateRange(o);n.push(o)}))}));return n}addDefaultDateRange(t){t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=k(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=k(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS}getRoomTypeId(t,e){var i;return((i=e.find((e=>this.cleanSpacesAndSpecialChars(e.name)===this.cleanSpacesAndSpecialChars(t))))===null||i===void 0?void 0:i.id)||null}updateAvailableRooms(t,e,i,s,n){const o=[];e.assignable_units.forEach((e=>{if(e.Is_Fully_Available&&!e.Is_Not_Available){const r=_(e.from_date,e.to_date);const a=U(new Date(t.from_date)).isAfter(U(new Date(e.from_date)))?t.from_date:e.from_date;const l=U(new Date(t.to_date)).isBefore(U(new Date(e.to_date)))&&U(new Date(t.to_date)).isAfter(U(new Date(e.from_date)))?t.to_date:e.to_date;o.push({RT_ID:i.RT_ID,STATUS:"PENDING-CONFIRMATION",FROM_DATE:a,roomName:e.name,PR_ID:e.pr_id,TO_DATE:l,NO_OF_DAYS:r,ID:"NEW_TEMP_EVENT",NAME:"",NOTES:"",BALANCE:"",INTERNAL_NOTE:"",hideBubble:true,legendData:s,roomsInfo:n});i.TO_DATE=e.to_date;i.NO_OF_DAYS=r}}));i.availableRooms=o}convertUnassignedDates(t){let e={};t.forEach((t=>{let i=new Date(t.date);i.setHours(0,0,0,0);e[i.getTime()]={categories:{},dateStr:t.description}}));return e}}const Pt={unassigned_dates:{}};let{state:Ht,onChange:Vt}=X(Pt);function Ut(t){Ht.unassigned_dates=Object.assign(Object.assign({},Ht.unassigned_dates),t)}function Gt(){return Ht.unassigned_dates}function Kt(t,e){const i=Wt(t);const s=Wt(e);Object.keys(Ht.unassigned_dates).forEach((t=>{const e=parseInt(t);if(i<=e&&e<=s){delete Ht.unassigned_dates[t]}}))}function Wt(t){const e=new Date(t);e.setHours(0,0,0,0);return e.getTime()}const qt={clock:{d:"M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z",viewBox:"0 0 512 512"},check:{viewBox:"0 0 448 512",d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},"heart-fill":{viewBox:"0 0 512 512",d:"M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"},"envelope-circle-check":{viewBox:"0 0 640 512",d:"M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0l57.4-43c23.9-59.8 79.7-103.3 146.3-109.8l13.9-10.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176 0 384c0 35.3 28.7 64 64 64l296.2 0C335.1 417.6 320 378.5 320 336c0-5.6 .3-11.1 .8-16.6l-26.4 19.8zM640 336a144 144 0 1 0 -288 0 144 144 0 1 0 288 0zm-76.7-43.3c6.2 6.2 6.2 16.4 0 22.6l-72 72c-6.2 6.2-16.4 6.2-22.6 0l-40-40c-6.2-6.2-6.2-16.4 0-22.6s16.4-6.2 22.6 0L480 353.4l60.7-60.7c6.2-6.2 16.4-6.2 22.6 0z"},danger:{viewBox:"0 0 512 512",d:"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"},bell:{viewBox:"0 0 448 512",d:"M224 0c-17.7 0-32 14.3-32 32V51.2C119 66 64 130.6 64 208v18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416H416c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3H224 160c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"},burger_menu:{viewBox:"0 0 448 512",d:"M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"},home:{viewBox:"0 0 576 512",d:"M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"},xmark:{viewBox:"0 0 384 512",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"},minus:{viewBox:"0 0 448 512",d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"},user:{viewBox:"0 0 448 512",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"},heart:{viewBox:"0 0 512 512",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"},user_group:{viewBox:"0 0 640 512",d:"M96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3zM609.3 512H471.4c5.4-9.4 8.6-20.3 8.6-32v-8c0-60.7-27.1-115.2-69.8-151.8c2.4-.1 4.7-.2 7.1-.2h61.4C567.8 320 640 392.2 640 481.3c0 17-13.8 30.7-30.7 30.7zM432 256c-31 0-59-12.6-79.3-32.9C372.4 196.5 384 163.6 384 128c0-26.8-6.6-52.1-18.3-74.3C384.3 40.1 407.2 32 432 32c61.9 0 112 50.1 112 112s-50.1 112-112 112z"},search:{viewBox:"0 0 512 512",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"},arrow_right:{viewBox:"0 0 448 512",d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"},arrow_left:{viewBox:"0 0 448 512",d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},circle_info:{viewBox:"0 0 512 512",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"},calendar:{viewBox:" 0 0 448 512",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"},"xmark-fill":{viewBox:"0 0 512 512",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"},globe:{viewBox:"0 0 256 256",d:"M128 24a104 104 0 1 0 104 104A104.12 104.12 0 0 0 128 24m88 104a87.6 87.6 0 0 1-3.33 24h-38.51a157.4 157.4 0 0 0 0-48h38.51a87.6 87.6 0 0 1 3.33 24m-114 40h52a115.1 115.1 0 0 1-26 45a115.3 115.3 0 0 1-26-45m-3.9-16a140.8 140.8 0 0 1 0-48h59.88a140.8 140.8 0 0 1 0 48ZM40 128a87.6 87.6 0 0 1 3.33-24h38.51a157.4 157.4 0 0 0 0 48H43.33A87.6 87.6 0 0 1 40 128m114-40h-52a115.1 115.1 0 0 1 26-45a115.3 115.3 0 0 1 26 45m52.33 0h-35.62a135.3 135.3 0 0 0-22.3-45.6A88.29 88.29 0 0 1 206.37 88Zm-98.74-45.6A135.3 135.3 0 0 0 85.29 88H49.63a88.29 88.29 0 0 1 57.96-45.6M49.63 168h35.66a135.3 135.3 0 0 0 22.3 45.6A88.29 88.29 0 0 1 49.63 168m98.78 45.6a135.3 135.3 0 0 0 22.3-45.6h35.66a88.29 88.29 0 0 1-57.96 45.6"},facebook:{viewBox:"0 0 512 512",d:"M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"},twitter:{viewBox:"0 0 512 512",d:"M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"},whatsapp:{viewBox:"0 0 448 512",d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7 .9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},instagram:{viewBox:"0 0 448 512",d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},youtube:{viewBox:"0 0 576 512",d:"M549.7 124.1c-6.3-23.7-24.8-42.3-48.3-48.6C458.8 64 288 64 288 64S117.2 64 74.6 75.5c-23.5 6.3-42 24.9-48.3 48.6-11.4 42.9-11.4 132.3-11.4 132.3s0 89.4 11.4 132.3c6.3 23.7 24.8 41.5 48.3 47.8C117.2 448 288 448 288 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zm-317.5 213.5V175.2l142.7 81.2-142.7 81.2z"},angle_left:{viewBox:"0 0 320 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},circle_check:{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z",viewBox:"0 0 512 512"},eraser:{viewBox:"0 0 576 512",d:"M290.7 57.4L57.4 290.7c-25 25-25 65.5 0 90.5l80 80c12 12 28.3 18.7 45.3 18.7H288h9.4H512c17.7 0 32-14.3 32-32s-14.3-32-32-32H387.9L518.6 285.3c25-25 25-65.5 0-90.5L381.3 57.4c-25-25-65.5-25-90.5 0zM297.4 416H288l-105.4 0-80-80L227.3 211.3 364.7 348.7 297.4 416z"},file:{viewBox:"0 0 384 512",d:"M48 448V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm90.9 233.3c-8.1-10.5-23.2-12.3-33.7-4.2s-12.3 23.2-4.2 33.7L161.6 320l-44.5 57.3c-8.1 10.5-6.3 25.5 4.2 33.7s25.5 6.3 33.7-4.2L192 359.1l37.1 47.6c8.1 10.5 23.2 12.3 33.7 4.2s12.3-23.2 4.2-33.7L222.4 320l44.5-57.3c8.1-10.5 6.3-25.5-4.2-33.7s-25.5-6.3-33.7 4.2L192 280.9l-37.1-47.6z"},edit:{viewBox:"0 0 512 512",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"},trash:{viewBox:"0 0 448 512",d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"},plus:{viewBox:"0 0 448 512",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"},reciept:{viewBox:"0 0 384 512",d:"M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM80 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm16 96H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm0 32v64H288V256H96zM240 416h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H240c-8.8 0-16-7.2-16-16s7.2-16 16-16z"},print:{viewBox:"0 0 512 512",d:"M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zM432 248a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"},menu_list:{viewBox:"0 0 512 512",d:"M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"},save:{viewBox:"0 0 448 512",d:"M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"},credit_card:{viewBox:"0 0 576 512",d:"M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"},closed_eye:{viewBox:"0 0 640 512",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"},open_eye:{viewBox:"0 0 576 512",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"},server:{viewBox:"0 0 512 512",d:"M448 160H320V128H448v32zM48 64C21.5 64 0 85.5 0 112v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zM448 352v32H192V352H448zM48 288c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48H48z"},double_caret_left:{viewBox:"0 0 512 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},square_plus:{viewBox:"0 0 448 512",d:"M64 80c-8.8 0-16 7.2-16 16l0 320c0 8.8 7.2 16 16 16l320 0c8.8 0 16-7.2 16-16l0-320c0-8.8-7.2-16-16-16L64 80zM0 96C0 60.7 28.7 32 64 32l320 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM200 344l0-64-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l64 0 0-64c0-13.3 10.7-24 24-24s24 10.7 24 24l0 64 64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0 0 64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"},angles_left:{viewBox:"0 0 512 512",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},angle_right:{viewBox:"0 0 320 512",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"},angles_right:{viewBox:"0 0 512 512",d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"},outline_user:{viewBox:"0 0 448 512",d:"M304 128a80 80 0 1 0 -160 0 80 80 0 1 0 160 0zM96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM49.3 464l349.5 0c-8.9-63.3-63.3-112-129-112l-91.4 0c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304l91.4 0C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7L29.7 512C13.3 512 0 498.7 0 482.3z"},key:{viewBox:"0 0 512 512",d:"M336 352c97.2 0 176-78.8 176-176S433.2 0 336 0S160 78.8 160 176c0 18.7 2.9 36.8 8.3 53.7L7 391c-4.5 4.5-7 10.6-7 17l0 80c0 13.3 10.7 24 24 24l80 0c13.3 0 24-10.7 24-24l0-40 40 0c13.3 0 24-10.7 24-24l0-40 40 0c6.4 0 12.5-2.5 17-7l33.3-33.3c16.9 5.4 35 8.3 53.7 8.3zM376 96a40 40 0 1 1 0 80 40 40 0 1 1 0-80z"},unlock:{viewBox:"0 0 448 512",d:"M144 144c0-44.2 35.8-80 80-80c31.9 0 59.4 18.6 72.3 45.7c7.6 16 26.7 22.8 42.6 15.2s22.8-26.7 15.2-42.6C331 33.7 281.5 0 224 0C144.5 0 80 64.5 80 144l0 48-16 0c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-192c0-35.3-28.7-64-64-64l-240 0 0-48z"},circle_plus:{viewBox:"0 0 15 15",d:"M7.49991 0.876892C3.84222 0.876892 0.877075 3.84204 0.877075 7.49972C0.877075 11.1574 3.84222 14.1226 7.49991 14.1226C11.1576 14.1226 14.1227 11.1574 14.1227 7.49972C14.1227 3.84204 11.1576 0.876892 7.49991 0.876892ZM1.82707 7.49972C1.82707 4.36671 4.36689 1.82689 7.49991 1.82689C10.6329 1.82689 13.1727 4.36671 13.1727 7.49972C13.1727 10.6327 10.6329 13.1726 7.49991 13.1726C4.36689 13.1726 1.82707 10.6327 1.82707 7.49972ZM7.50003 4C7.77617 4 8.00003 4.22386 8.00003 4.5V7H10.5C10.7762 7 11 7.22386 11 7.5C11 7.77614 10.7762 8 10.5 8H8.00003V10.5C8.00003 10.7761 7.77617 11 7.50003 11C7.22389 11 7.00003 10.7761 7.00003 10.5V8H4.50003C4.22389 8 4.00003 7.77614 4.00003 7.5C4.00003 7.22386 4.22389 7 4.50003 7H7.00003V4.5C7.00003 4.22386 7.22389 4 7.50003 4Z"},"arrow-right-from-bracket":{d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z",viewBox:"0 0 512 512"}};const Xt={secondary:{"--icon-button-color":"#6b6f82","--icon-button-hover-color":"#104064"},danger:{"--icon-button-color":"#ff4961","--icon-button-hover-color":"#ff6377"}};const Jt=".sc-igl-cal-header-h{display:block;position:absolute;top:0;height:100%}.svg-icon.sc-igl-cal-header{height:20px;width:20px}.darkGrey.sc-igl-cal-header{background:#ececec}.btn.sc-igl-cal-header{pointer-events:auto}.stickyCell.sc-igl-cal-header{display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;top:0px;height:82px;display:inline-block;vertical-align:top;z-index:2}.headersContainer.sc-igl-cal-header{background-color:#ffffff}.headerCell.sc-igl-cal-header{display:inline-grid;width:58px;height:58px;vertical-align:top;background-color:#ffffff;border-bottom:1px solid #e0e0e0}.monthsContainer.sc-igl-cal-header{height:20px;background-color:#ffffff;margin-bottom:0.2em}.monthCell.sc-igl-cal-header{display:inline-grid;height:20px;background-color:#ececec;border-right:1px solid #c7c7c7;vertical-align:top}.monthCell.sc-igl-cal-header:nth-child(odd){background-color:#dddddd}.monthTitle.sc-igl-cal-header{overflow:hidden;text-overflow:ellipsis;font-size:0.9em;text-transform:uppercase;font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.topLeftCell.sc-igl-cal-header{left:0px;z-index:3;width:170px;background-color:#ffffff;display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid}.datePickerHidden.sc-igl-cal-header{position:absolute;height:100%;width:100%;opacity:0;cursor:pointer;z-index:1}.date_btn.sc-igl-cal-header{cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative}.date_btn.sc-igl-cal-header:hover{background:#f6f6f6;border-radius:0.3rem}.caledarBtns.sc-igl-cal-header{position:relative;cursor:pointer;padding:0.4rem}.caledarBtns.sc-igl-cal-header:hover{background-color:#f6f6f6}.dayTitle.sc-igl-cal-header{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.currentDay.sc-igl-cal-header .dayTitle.sc-igl-cal-header{font-weight:bold}.currentDay.sc-igl-cal-header{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-header{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-cal-header{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.pointer.sc-igl-cal-header{cursor:pointer}.searchContiner.sc-igl-cal-header{padding-left:10px;padding-right:10px}.searchListContainer.sc-igl-cal-header{background:#fff;border:1px solid #ccc;border-bottom:none}.searchListItem.sc-igl-cal-header{background:white;border-bottom:1px solid #ccc;padding-left:8px}.badge-light.sc-igl-cal-header{background-color:#999999;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.min-width-full.sc-igl-cal-header{min-width:100%}";const Zt=Jt;const Qt=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.gotoRoomEvent=s(this,"gotoRoomEvent",7);this.gotoToBeAssignedDate=s(this,"gotoToBeAssignedDate",7);this.searchValue="";this.searchList=[];this.roomsList=[];this.toBeAssignedService=new Ft;this.calendarData=undefined;this.today=undefined;this.propertyid=undefined;this.unassignedDates=undefined;this.to_date=undefined;this.highlightedDate=undefined;this.renderAgain=false;this.unassignedRoomsNumber={}}componentWillLoad(){try{this.initializeRoomsList();if(!this.calendarData.is_vacation_rental){Vt("unassigned_dates",(t=>{if(Object.keys(t).length>0){this.fetchAndAssignUnassignedRooms()}}))}}catch(t){console.error("Error in componentWillLoad:",t)}}handleCalendarDataChanged(){this.fetchAndAssignUnassignedRooms()}initializeRoomsList(){this.roomsList=[];this.calendarData.roomsInfo.forEach((t=>{this.roomsList=this.roomsList.concat(...t.physicalrooms)}))}async fetchAndAssignUnassignedRooms(){await this.assignRoomsToDate()}async assignRoomsToDate(){try{const{fromDate:t,toDate:e,data:i}=this.unassignedDates;let s=new Date(t);s.setHours(0,0,0,0);let n=s.getTime();while(n<=new Date(e).getTime()){const t=U(n).format("D_M_YYYY");if(i[n]){const e=await this.toBeAssignedService.getUnassignedRooms({from_date:this.calendarData.from_date,to_date:this.calendarData.to_date},this.propertyid,k(new Date(n)),this.calendarData.roomsInfo,this.calendarData.formattedLegendData);this.unassignedRoomsNumber[t]=e.length}else if(this.unassignedRoomsNumber[t]){const e=this.unassignedRoomsNumber[t]-1;this.unassignedRoomsNumber[t]=e<0?0:e}const e=U(n).add(1,"days").toDate();e.setHours(0,0,0,0);n=e.getTime();this.renderView()}}catch(t){console.error(t)}}handleReduceAvailableUnitEvent(t){t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i}=t.detail;let s=new Date(e).getTime();while(s<new Date(i).getTime()){const t=U(s).format("D_M_YYYY");this.unassignedRoomsNumber[t]=this.unassignedRoomsNumber[t]-1;s=U(s).add(1,"days").toDate().getTime()}this.renderView()}showToBeAssigned(t){if(this.unassignedRoomsNumber[t.day]||0){this.handleOptionEvent("showAssigned");setTimeout((()=>{this.gotoToBeAssignedDate.emit({key:"gotoToBeAssignedDate",data:t.currentDate})}),100)}}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}handleDateSelect(t){if(Object.keys(t.detail).length>0){this.handleOptionEvent("calendar",t.detail)}}handleClearSearch(){this.searchValue="";this.searchList=[];this.renderView()}handleFilterRooms(t){const e=t.target;let i=e.value.trim();this.searchValue=i;i=i.toLowerCase();if(i===""){this.handleClearSearch()}else{this.searchList=this.roomsList.filter((t=>t.name.toLocaleLowerCase().indexOf(i)!=-1))}this.renderView()}handleScrollToRoom(t){this.handleClearSearch();this.gotoRoomEvent.emit({key:"gotoRoom",roomId:t})}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}getNewBookingModel(){let t=new Date;t.setHours(0,0,0,0);let e=this.getStringDateFormat(t);t.setDate(t.getDate()+1);t.setHours(0,0,0,0);let i=this.getStringDateFormat(t);return{ID:"",NAME:"",EMAIL:"",PHONE:"",REFERENCE_TYPE:"PHONE",FROM_DATE:e,TO_DATE:i,roomsInfo:this.calendarData.roomsInfo,TITLE:p.entries.Lcz_NewBooking,event_type:"PLUS_BOOKING",legendData:this.calendarData.formattedLegendData,defaultDateRange:{fromDate:new Date(e),fromDateStr:"",toDate:new Date(i),toDateStr:"",dateDifference:0,editabled:true,message:""}}}renderView(){this.renderAgain=!this.renderAgain}render(){return e(i,{key:"a1bb9b34e5499473b9d2cdd290884b4c80a0275c"},e("div",{key:"55412f82659955011ef40d2eeaef75fdfef2ec53",class:"stickyCell align-items-center topLeftCell preventPageScroll"},e("div",{key:"ba8755cc4a2adb39a90219622808fefc6cc696ec",class:"row justify-content-around no-gutters"},!this.calendarData.is_vacation_rental&&e("ir-button",{key:"4cdb0598057b31282c28685e7db13438d6975e8b",variant:"icon",icon_name:"server",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:p.entries.Lcz_UnassignedUnitsTooltip,onClickHandler:()=>this.handleOptionEvent("showAssigned"),btn_styles:"caledarBtns",visibleBackgroundOnHover:true}),e("ir-button",{key:"bc45cafcf7f22ce4548778066c1528ef91e0efc2",btn_styles:"caledarBtns",class:"date_btn",variant:"icon",icon_name:"calendar",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:p.entries.Lcz_Navigate,onClickHandler:()=>this.handleOptionEvent("calendar"),visibleBackgroundOnHover:true},e("ir-date-picker",{key:"46f6fa8e49a421e8c6219c1740e38ef585190388",minDate:U().add(-2,"months").startOf("month").format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{console.log("evt",t);this.handleDateSelect(t)},class:"datePickerHidden"})),e("ir-button",{key:"2be121043e2289b25ccdc3753e644a1b04628107",variant:"icon",btn_styles:"caledarBtns",class:"pointer",icon_name:"clock",visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:p.entries.Lcz_Today,onClickHandler:()=>this.handleOptionEvent("gotoToday")}),e("ir-button",{key:"443d12a31cabaa94a0c1ce7d39f768ed6326e08e",variant:"icon",btn_styles:"caledarBtns",icon_name:"plus","data-toggle":"tooltip","data-placement":"bottom",title:p.entries.Lcz_CreateNewBooking,visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"}),onClickHandler:()=>this.handleOptionEvent("add",this.getNewBookingModel())})),e("div",{key:"d5da4df5b1fc4248928af883bfb4a8de660c52a9",class:"row justify-content-around no-gutters searchContiner"},e("fieldset",{key:"1dd0d195aeaa3c84792cec0ae403af70ef2d5f07",class:`form-group position-relative ${this.searchValue!=""?"show":""}`},e("input",{key:"f78f86c00b9cb2bcba0db81379bfb76511850709",type:"text",class:"form-control form-control-sm input-sm",id:"iconLeft7",value:this.searchValue,placeholder:p.entries.Lcz_FindUnit,onInput:t=>this.handleFilterRooms(t)}),this.searchValue!==""?e("div",{class:"form-control-position pointer",onClick:()=>this.handleClearSearch(),"data-toggle":"tooltip","data-placement":"top","data-original-title":"Clear Selection"},e("i",{class:"la la-close font-small-4"})):null,this.searchList.length?e("div",{class:"position-absolute searchListContainer dropdown-menu dropdown-menu-left min-width-full"},this.searchList.map((t=>e("div",{class:"searchListItem1 dropdown-item px-1 text-left pointer",onClick:()=>this.handleScrollToRoom(t.id)},t.name)))):null))),e("div",{key:"f762a8a5101abf227cb627c36b61e13c90e0788a",class:"stickyCell headersContainer"},e("div",{key:"1880958f2648102856274ec501115320d47b740b",class:"monthsContainer"},this.calendarData.monthsInfo.map((t=>e("div",{class:"monthCell",style:{width:t.daysCount*58+"px"}},e("div",{class:"monthTitle"},t.monthName))))),this.calendarData.days.map((t=>e("div",{class:`headerCell align-items-center ${"day-"+t.day} ${t.day===this.today||t.day===this.highlightedDate?"currentDay":""}`,"data-day":t.day},!this.calendarData.is_vacation_rental&&e("div",{class:"preventPageScroll"},e("span",{class:`badge badge-${this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr!==0?"info pointer":"light"} badge-pill`,onClick:()=>this.showToBeAssigned(t)},this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr)),e("div",{class:"dayTitle"},t.dayDisplayName),e("div",{class:"dayCapacityPercent"},t.occupancy,"%"))))))}static get watchers(){return{unassignedDates:["handleCalendarDataChanged"]}}};Qt.style=Zt;const te=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center;inset:0}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}.date-range-container-cn.sc-igl-date-range{position:relative;width:fit-content}.date-range-container-cn.sc-igl-date-range:focus-within .date-range-container.sc-igl-date-range{border:1px solid #379ff2}.date-range-container.sc-igl-date-range{position:relative;gap:1rem;font-size:0.975rem;line-height:1.45;border-radius:0.21rem;border:1px solid #cacfe7;color:#3b4781;padding:0.75rem 1rem;box-sizing:border-box !important;font-weight:400;background-color:#fff;background-clip:padding-box;height:2rem;pointer-events:none;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.date-range-container-cn.sc-igl-date-range .date-range-input.sc-igl-date-range{position:absolute;width:100% !important}.date-range-container.disabled.sc-igl-date-range{border:none;padding-left:0;padding-right:0}.date-range-input[data-state='disabled'].sc-igl-date-range{cursor:default}";const ee=te;const ie=class{constructor(e){t(this,e);this.dateSelectEvent=s(this,"dateSelectEvent",7);this.toast=s(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.withDateDifference=true;this.variant="default";this.renderAgain=false}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights()}return[this.fromDateStr,this.toDateStr]}calculateTotalNights(){this.totalNights=j(U(this.fromDate).format("YYYY-MM-DD"),U(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){if(this.variant==="booking"){return e("div",{class:`p-0 m-0 date-range-container-cn`},e("ir-date-picker",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),e("div",{class:`d-flex align-items-center m-0  date-range-container ${this.disabled?"disabled":""}`},e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),e("span",null,U(this.fromDate).format("MMM DD, YYYY")),e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),e("span",null,U(this.toDate).format("MMM DD, YYYY")),this.totalNights&&e("span",{class:"m-0 p-0"},this.totalNights+(this.totalNights>1?` ${p.entries.Lcz_Nights}`:` ${p.entries.Lcz_Night}`))))}return e(i,null,e("div",{class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},e("ir-date-picker",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),e("div",{"data-state":this.disabled?"disabled":"active",class:"date-view"},e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),e("ir-date-view",{showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&e("span",null,this.totalNights&&!this.disabled?e("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${p.entries.Lcz_Nights}`:` ${p.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};ie.style=ee;const se=".sc-igl-legends-h{display:block}.legendHeader.sc-igl-legends{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding-top:5px;margin-bottom:1rem}.legendCloseBtn.sc-igl-legends{position:absolute;top:50%;right:0;cursor:pointer;font-size:1.75em;line-height:1em;padding:0.4rem;display:flex;align-items:center;justify-content:center;border-radius:3px;transform:translateY(-50%)}.legendCloseBtn.sc-igl-legends:hover{background-color:#f6f6f6}.stickyHeader.sc-igl-legends{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.legendRow.sc-igl-legends{position:relative;vertical-align:middle;margin-bottom:0.3rem}.legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle}.legend_skew.sc-igl-legends,.legend_skew-bordered.sc-igl-legends,.legend_skewsplit.sc-igl-legends{transform:skew(-30deg);width:15px;height:16px}.legend_skew-bordered.sc-igl-legends{border:1px solid black}.legend_circle.sc-igl-legends{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px}.legend_skewsplit.sc-igl-legends{border-right:2px solid #000000}.headerCell.sc-igl-legends .blueColor.sc-igl-legends{background-color:#31bef1}.greenColor.sc-igl-legends{background-color:#45b16d}.yellowColor.sc-igl-legends{background-color:#f4d552}.greyColor.sc-igl-legends{background-color:#a0a0a0}.redColor.sc-igl-legends{background-color:#f34752}.pinkColor.sc-igl-legends{background-color:#f9b4b7}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends{margin-bottom:0}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends:first-child .legendCal.sc-igl-legends{background-color:#ececec}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.total-availability.sc-igl-legends{font-size:1em !important}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends{width:80px;height:25px;text-align:center;display:inline-grid !important;align-content:center;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends .badge.sc-igl-legends{margin-top:0.2rem;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.legendCal-h2.sc-igl-legends{height:40px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.br-t.sc-igl-legends{border-top:1px solid #a0a0a0}.br-s.sc-igl-legends{border-left:1px solid #a0a0a0;border-right:1px solid #a0a0a0}.br-bt.sc-igl-legends{border-bottom:1px solid #a0a0a0}.highphenLegend.sc-igl-legends{font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.highphenLegend.sc-igl-legends::before{width:12px;height:0.5px;content:' ';background-color:#000000;vertical-align:middle;display:inline-block;margin-left:5px;margin-right:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-legends{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.headerCell.sc-igl-legends{width:70px;display:flex;align-items:center;justify-content:center}.dayTitle.sc-igl-legends{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.dayCapacityPercent.sc-igl-legends{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}";const ne=se;const oe=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.legendData=undefined}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return e(i,{key:"04f4a855e5d3481f0d3219ab6456c1f46eb9da38",class:"legendContainer pr-1 text-left"},e("div",{key:"ec4be7dd9aa8d478365a0312dba128116bca5fa9",class:"w-full"},e("div",{key:"d4e35449b1cbe65b0bcbf2f575ded962cbca35f4",class:"w-full"},e("div",{key:"7f8ca08e0eaedbe7e8975ea5a1022ccd15858e4c",class:"stickyHeader pt-1 "},e("p",{key:"5cd85fe0fe65503b8fb9ed4691febbbfed881ecd",class:"legendHeader"},p.entries.Lcz_Legend),e("div",{key:"d9a131e61eab0606ed41bd6b88d928a7ab8ddc83",class:"legendCloseBtn",onClick:()=>this.handleOptionEvent("closeSideMenu")},e("svg",{key:"c32815807a4a398a0e23415ea079b8fc95ec372d",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"d142c913eadc9a4ab14d5bc800b8c693f4765304",fill:"#6b6f82",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"}))),e("hr",{key:"b9797b09ecf83e1be5fb117c5866f1d81e06d821"})),e("div",{key:"534f3b99f7b0567a445917fa44912650f65a49a9",class:"mt-2 pl-1"},this.legendData.map((t=>e("div",{class:"legendRow "},e("div",{class:`legend_${t.design} mr-1`,style:{backgroundColor:t.color}}),e("span",{class:"font-small-3"},t.name))))),e("hr",{key:"28a27dd5f47546351eec3cf779351341ce5e7077"}),e("div",{key:"3f620fb6acbfa0311450016d1444681a827f2035",class:"mt-2"},e("div",{key:"189478423b050cb2d53178bdbdebac4decd7a079",class:"legendCalendar"},e("div",{key:"a68f2b773cd3683e2eeb83bc34d9378992891fda",class:"legendRow align-items-center"},e("div",{key:"c97934b0555f1d9f04818139d77cfabe16088ab3",class:"legendCal br-t br-s br-bt"},e("strong",{key:"08f49f415d4c8d944151df3141fe78599eaa26a3"},"MAR 2022")),e("div",{key:"7874a9ba359c353f4c642fc7d1c9ec96d3ed76d7",class:"highphenLegend"},p.entries.Lcz_MonthAndYear)),e("div",{key:"b6cf7d97740ea79852bd51bc0bebe8c96acc0048",class:"legendRow"},e("div",{key:"2aeaece91ad8973c7c141312c9d000b28917cee4",class:"legendCal headerCell align-items-center br-s"},e("span",{key:"b9b54842795bda9b4f52349b7e2a61e8a0bd4127",class:"badge badge-info  badge-pill"},"3")),e("div",{key:"9ec8d83f5390c49abe501b4313df774d53fb8162",class:"highphenLegend"},e("div",{key:"6608f47e8ea78ddcd80cacf002c543d191d5c7aa"},p.entries.Lcz_UnassignedUnits))),e("div",{key:"dc923321fe0b60e4b7b1e03b70e6bbc08e5a064f",class:"legendRow"},e("div",{key:"74d9e97857dec3f50036ea3f65c038de9e413d1e",class:"legendCal dayTitle br-s"},"Fri 18"),e("div",{key:"f5c83f1963ea8f3f733ea56c81d0f44d62cca5b8",class:"highphenLegend"},p.entries.Lcz_Date)),e("div",{key:"386b1296e5564f848e71bdaf0df34247f3403382",class:"legendRow"},e("div",{key:"b562ff78774b20442834eb48056ddae5d5bf63f3",class:"legendCal br-s br-bt dayCapacityPercent"},"15%"),e("div",{key:"cd5329de4de6817b62b4485beca4f98c152c5a34",class:"highphenLegend"},p.entries.Lcz_Occupancy)),e("div",{key:"2abe4c2ea267e3e122a6cfd99323fa38a4a31b89",class:"legendRow"},e("div",{key:"bb8fdc411efdd960b272ff1630996f3bffd1943a",class:"legendCal br-s br-bt  font-weight-bold total-availability"},"20"),e("div",{key:"8d74e28e376cef8cc06a1c1cab4dc7ba9fec8fd9",class:"highphenLegend"},p.entries.Lcz_TotalAvailability)))))))}};oe.style=ne;const re=".sc-igl-property-booked-by-h{display:block}.row.sc-igl-property-booked-by{padding:0 0 0 15px;margin:0}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.row.sc-igl-booking-form.sc-igl-property-booked-by{padding:0 !important}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const ae=re;const le=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.bookingService=new l;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.language=undefined;this.showPaymentDetails=false;this.defaultData=undefined;this.countryNodeList=[];this.propertyId=undefined;this.isButtonPressed=false;this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const t=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((e,i)=>(t+i).toString()))}async assignCountryCode(){const t=await this.bookingService.getUserDefaultCountry();const e=t["COUNTRY_ID"];this.country=e;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.toString(),countryId:e})}initializeDateData(){const t=new Date;const e=t.getMonth()+1;this.currentMonth=e<10?`0${e}`:e.toString()}populateBookedByData(){var t;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((t=this.defaultData)===null||t===void 0?void 0:t.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(t,e){this.bookedByData[t]=t==="emailGuest"?e.target.checked:e.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(t==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.target.value})}}handleCountryChange(t){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:t,countryId:t});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleNumberInput(t,e){const i=e.target;const s=i.value;const n=/^[0-9]+$/;if(!n.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(t,e)}}async checkUser(){var t;try{const e=this.bookedByData.email;if(D.string().email().safeParse(e).success){const i=await this.bookingService.getUserInfo(e);if(i!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile_without_prefix,countryId:i.country_id,isdCode:(t=i===null||i===void 0?void 0:i.country_phone_prefix)!==null&&t!==void 0?t:i.isdCode.toString()});console.log(this.bookedByData)}else{let t=Object.assign({},this.bookedByData);t=Object.assign(Object.assign({},t),{email:e});this.bookedByData=Object.assign({},t)}}else{let t=Object.assign({},this.bookedByData);t=Object.assign(Object.assign({},t),{email:""});this.bookedByData=Object.assign({},t)}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}catch(t){}}updateGuest(t){var e;a("checkout_guest",Object.assign(Object.assign({},(e=r.checkout_guest)!==null&&e!==void 0?e:{}),t))}handleComboboxChange(t){var e;t.stopImmediatePropagation();t.stopPropagation();const{key:i,data:s}=t.detail;console.log(i,s);if(i==="blur"){if(D.string().email().safeParse(s).success){this.bookedByData.email=s;this.checkUser()}else if(this.bookedByData.email!==""&&s==""){this.bookedByData.email=""}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}if(i==="select"){this.bookedByData.email=s.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:s.id,firstName:s.first_name,lastName:s.last_name,contactNumber:s.mobile_without_prefix,countryId:s.country_id,isdCode:(e=s["country_phone_prefix"])!==null&&e!==void 0?e:s===null||s===void 0?void 0:s.country_id});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}}clearEvent(){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return e(i,{key:"42089364999b89ae8bc088acbdde9fd5897c37d5"},e("div",{key:"979c4eefe565527a21873544fcdbadc5b06a0804",class:"text-left mt-3"},e("div",{key:"a65f93ea0e964a1cb0c29088562f0512be3e3a19",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},e("label",{key:"962c8a8dfd8041c6dc35633bbe6cbe77a5c57d6d",class:"p-0 m-0 label-control mr-1 font-weight-bold"},p.entries.Lcz_BookedBy),e("div",{key:"7f2cec9e6bd2a78da9b1fd29d1954a52f3ef5b58",class:"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center"},e("ir-autocomplete",{key:"b2706cdd9ffe07e1c45f14754034aabad60b7f34",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"text",value:this.bookedByData.email,required:true,class:"flex-fill",placeholder:p.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent(),danger_border:this.isButtonPressed&&this.bookedByData.email!==""&&C(this.bookedByData.email)}),e("ir-tooltip",{key:"b8bf2817894fdbe828ef47942c80d60a30023373",class:"ml-1",message:"Leave empty if email is unavailable"})))),e("div",{key:"fb7a14736c1935b70b40494b98e6f2efc864758f",class:"bookedDetailsForm text-left mt-2 font-small-3 "},e("div",{key:"3778a553444f4442d4f50ba82c12499c3ae4581a",class:"d-flex flex-column flex-md-row  justify-content-md-between "},e("div",{key:"f7b69c4f8fbd5c34b4ea164e22ad47ef6d0cceb0",class:"p-0 flex-fill "},e("div",{key:"676b2bd7e977142e3659c88b547507c3af13993b",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},e("label",{key:"3a59a8aca488e47adaf25ce58610faa074f8c901",class:"p-0 m-0 margin3"},p.entries.Lcz_FirstName),e("div",{key:"0a0b47ec618e5ddb3ceccfa8c246ac8bb8b89a3f",class:"p-0 m-0  controlContainer flex-fill  "},e("input",{key:"406488c0004457bbf101fed14f7eebbd76b20b70",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:p.entries.Lcz_FirstName,id:L(),value:this.bookedByData.firstName,onInput:t=>{this.updateGuest({first_name:t.target.value});this.handleDataChange("firstName",t)},required:true}))),e("div",{key:"3753d21ea4f6c03ff09a4fdeac814c2dfd6d5bf0",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"5262a89093c8c66a6924b62e656520d51bc4e824",class:"p-0 m-0 margin3"},p.entries.Lcz_LastName),e("div",{key:"6f6604d89f56bb9a316e575e3db822bdb7f828e3",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"18287fb09f1810924d2b1e5a4956b0f71f51b79c",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:p.entries.Lcz_LastName,id:L(),value:this.bookedByData.lastName,onInput:t=>this.handleDataChange("lastName",t)}))),e("div",{key:"189dfe0593dfb7b72681a12b9ba98ed75b70b4f2",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"b60531e4cf22ef90f140cd0cde341095ba7bb165",class:"p-0 m-0 margin3"},p.entries.Lcz_Country),e("ir-country-picker",{key:"90c46206f372ec294e120abdc980d5480abd1d18",class:"flex-grow-1 m-0",onCountryChange:t=>this.handleCountryChange(t.detail.id),countries:this.countryNodeList,country:this.countryNodeList.find((t=>t.id===this.bookedByData.countryId))})),e("div",{key:"850a6706d562c9c6cc1176e450bb78737c6c9d21",class:"form-group p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"3d1145e8e0c75bcb449b373f1f51193e1a152d0e",class:"p-0 m-0 margin3"},p.entries.Lcz_MobilePhone),e("div",{key:"5dc58ab83b96b2125e821c41e1e30528e7815781",class:"p-0 m-0 controlContainer flex-fill"},e("ir-phone-input",{key:"dc3cb8ec310af4ccf16a8783ed09ce5ab16acf1b",language:this.language,value:this.bookedByData.contactNumber,phone_prefix:this.bookedByData.isdCode,default_country:this.bookedByData.countryId,onTextChange:t=>{this.handleDataChange("isdCode",{target:{value:t.detail.phone_prefix}});this.handleDataChange("contactNumber",{target:{value:t.detail.mobile}})}}))),e("div",{key:"9f8a5999aae3ff57d8748cbc75ea7f9a5ecba4de",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"1483f16a8bb49b912c1ccdaff84f24129229c363",class:"p-0 m-0 margin3"},p.entries.Lcz_YourArrivalTime),e("div",{key:"eb42990b09a02b1a007f3d2a4bfc170c4a261269",class:"p-0 m-0  controlContainer flex-fill"},e("select",{key:"0be47dd3517a28ce10a55cbf8edfec3c3b733f85",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:L(),onChange:t=>this.handleDataChange("selectedArrivalTime",t)},this.arrivalTimeList.map((t=>e("option",{value:t.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===t.CODE_NAME},t.CODE_VALUE_EN))))))),e("div",{key:"a11ac6916b319fb63e4e90c7fd399620bf5e3578",class:"p-0 flex-fill  ml-md-3"},e("div",{key:"09c1b51a13dad8b0ccba8af64e1af0c46453947c",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},e("label",{key:"508dcb1e20319b32a637b7208c6e5f5fee10392e",class:"p-0 m-0 margin3"},p.entries.Lcz_AnyMessageForUs),e("div",{key:"f67ed9b5eae1c43175bc002e36818848bbad7da3",class:"p-0 m-0  controlContainer flex-fill "},e("textarea",{key:"ecbe8bc1f06836bb5b4696d60b4e351c148fc2a3",id:L(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:t=>this.handleDataChange("message",t)}))),this.showPaymentDetails&&e(n,{key:"704c9be6e938a1c204c9736acbe5c2497546e7ad"},e("div",{key:"e8213ca3bfd9759bcc9cb3459ddce095a44f274e",class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"973d4a0ba61711cb5dc30be61a5d8b2cc9f615a2",class:"p-0 m-0 margin3"},p.entries.Lcz_CardNumber),e("div",{key:"3f49f1a1b0b4fd4a86c6ecfb69468cca589c9849",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"3377ef366d87048c4e3c695778f73fdb0a7f9da5",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:L(),value:this.bookedByData.cardNumber,onInput:t=>this.handleNumberInput("cardNumber",t)}))),e("div",{key:"c88af9b367943580e47419033a06ded2a4587a7b",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"e0d9dfb94eafcb1cb109701149c17b2f48d8ae88",class:"p-0 m-0 margin3"},p.entries.Lcz_CardHolderName),e("div",{key:"1ec9ef2c322f77d586718a6ee0b870896a8656cc",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"ed986fc404cdabcd9f422e9ffc769a2a7e5bd740",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:L(),value:this.bookedByData.cardHolderName,onInput:t=>this.handleDataChange("cardHolderName",t)}))),e("div",{key:"5fc77d846a89abe7a3c0654f3680a6c0638e1929",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"5b2fca676d6738fb30983cced9e0e6b9a422d474",class:"p-0 m-0 margin3"},p.entries.Lcz_ExpiryDate),e("div",{key:"13cb63af66930c00eab03ad326453706fd09e48d",class:"p-0 m-0 row  controlContainer flex-fill"},e("div",{key:"be575dbba7d789cf2a13c934eaf6577b016299c4",class:"p-0 m-0"},e("select",{key:"8c2909fd0733d8b0d959f2f3450882004005b408",class:"form-control input-sm pr-0",id:L(),onChange:t=>this.handleDataChange("expiryMonth",t)},this.expiryMonths.map((t=>e("option",{value:t,selected:t===this.bookedByData.expiryMonth},t))))),e("div",{key:"5e366d1dbe1a683acc5c4f643a1e055e17940f8f",class:"p-0 m-0 ml-1"},e("select",{key:"e13a0315a4d2c4b1adb95a857707c6be028c9e17",class:"form-control input-sm pr-0",id:L(),onChange:t=>this.handleDataChange("expiryYear",t)},this.expiryYears.map(((t,i)=>e("option",{value:t,selected:i===this.bookedByData.expiryYear},t)))))))),e("div",{key:"e527f3ea3a012f7ec15bab8feebead11ef2a3298",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},e("label",{key:"9e5c171098303a755bce2ae29135586e1bbe714c",class:"p-0 m-0",htmlFor:"emailTheGuestId"},p.entries.Lcz_EmailTheGuest),e("div",{key:"8a91f51bb8a3ebccd57fec6003664cba9d1bafd1",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},e("input",{key:"495e255f201f9cb9bcbadbf2b4926133c27897d7",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:t=>this.handleDataChange("emailGuest",t)})))))))}};le.style=ae;const ce=".sc-igl-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-rate-plan span[data-state='focus'].sc-igl-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-rate-plan span[data-disabled].sc-igl-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.non-ref-span.sc-igl-rate-plan{font-size:12px;color:var(--green)}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-rate-plan{width:40%}.rateplan-container.sc-igl-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-rate-plan{max-width:200px}.rate-input-container.sc-igl-rate-plan{max-width:150px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-rate-plan{width:20%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-rate-plan{width:100%}}.total-nights-container.sc-igl-rate-plan{width:max-content}.nightBorder.sc-igl-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const he=ce;const de=class{constructor(e){t(this,e);this.gotoSplitPageTwoEvent=s(this,"gotoSplitPageTwoEvent",7);this.ratePlan=undefined;this.roomTypeId=undefined;this.ratePricingMode=[];this.currency=undefined;this.shouldBeDisabled=undefined;this.bookingType="PLUS_BOOKING";this.isBookDisabled=false;this.visibleInventory=undefined}disableForm(){const{bookingType:t,shouldBeDisabled:e,ratePlan:i,visibleInventory:s}=this;if(t==="EDIT_BOOKING"&&e){return false}return!i.is_available_to_book||(s===null||s===void 0?void 0:s.visibleInventory)===0}updateRateplanSelection(t){const{roomTypeId:e,ratePlan:i}=this;const s=r.ratePlanSelections;r.ratePlanSelections=Object.assign(Object.assign({},s),{[e]:Object.assign(Object.assign({},s[e]),{[i.id]:Object.assign(Object.assign({},s[e][i.id]),t)})})}handleDataChange(t,e){const i=e.target.value;if(t==="adult_child_offering"){this.handleVariationChange(i)}else if(t==="rate"){this.updateRateplanSelection({view_mode:i})}else if(t==="totalRooms"){h({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:Number(i)})}}bookProperty(){this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){const{visibleInventory:t}=this;if(!t)return"";if(t.is_amount_modified){return t.rp_amount.toString()}const{selected_variation:e,view_mode:i}=t;const s=i==="001"?e===null||e===void 0?void 0:e.discounted_gross_amount:e===null||e===void 0?void 0:e.amount_per_night_gross;return(s===null||s===void 0?void 0:s.toString())||""}formatVariation(t){var e,i,s,n;if(!t)return"";const o=`${t.adult_nbr} ${t.adult_nbr===1?(e=p.entries["Lcz_Adult"])===null||e===void 0?void 0:e.toLowerCase():(i=p.entries["Lcz_Adults"])===null||i===void 0?void 0:i.toLowerCase()}`;const r=t.child_nbr>0?`${t.child_nbr} ${t.child_nbr>1?(s=p.entries["Lcz_Children"])===null||s===void 0?void 0:s.toLowerCase():(n=p.entries["Lcz_Child"])===null||n===void 0?void 0:n.toLowerCase()}`:"";return r?`${o} ${r}`:o}getTooltipMessages(){var t,e,i,s,n;const{ratePlan:o,visibleInventory:r}=this;const a=r===null||r===void 0?void 0:r.selected_variation;if(!a)return;const l=(t=o.variations)===null||t===void 0?void 0:t.find((t=>this.formatVariation(t)===this.formatVariation(a)));if(!l)return;const c=(i=(e=l.applicable_policies)===null||e===void 0?void 0:e.find((t=>t.type==="cancelation")))===null||i===void 0?void 0:i.combined_statement;const h=(n=(s=l.applicable_policies)===null||s===void 0?void 0:s.find((t=>t.type==="guarantee")))===null||n===void 0?void 0:n.combined_statement;let d="";if(c){d+=`<b><u>Cancellation:</u></b> ${c}<br/>`}if(h){d+=`<b><u>Guarantee:</u></b> ${h}`}return d||undefined}async handleVariationChange(t){const{ratePlan:e,roomTypeId:i}=this;const s=e.variations||[];const n=s.find((e=>this.formatVariation(e)===t));if(!n)return;u({params:{selected_variation:n},ratePlanId:e.id,roomTypeId:i})}resetReserved(){const t=Object.entries(r.ratePlanSelections).reduce(((t,[e,i])=>{t[e]=Object.entries(i).reduce(((t,[e,i])=>{t[e]=Object.assign(Object.assign({},i),{reserved:0});return t}),{});return t}),{});r.ratePlanSelections=t}render(){var t,s,o;const{ratePlan:a,bookingType:l,currency:c,ratePricingMode:d,visibleInventory:u}=this;const f=a.is_available_to_book;const b=this.disableForm();const g=u===null||u===void 0?void 0:u.selected_variation;const m=(t=a.variations)===null||t===void 0?void 0:t.map((t=>this.formatVariation(t)));console.log(u);return e(i,{key:"5a00d42fd07d59011a155848cc366b3bb93afb14"},e("div",{key:"36a6699856237d9b717c927088dd4ff4f807df99",class:`d-flex m-0 p-0 ${f?"flex-column flex-lg-row align-items-lg-center justify-content-lg-between":"align-items-center justify-content-between"}`},e("div",{key:"22779a94227719a24f77e69d263949a20e79e638",class:"rateplan-name-container d-flex align-items-center",style:{gap:"0.5rem"}},l==="BAR_BOOKING"?e(n,null,e("span",{class:"font-weight-bold"},a.name.split("/")[0]),e("span",null,"/",a.name.split("/")[1])):e("span",null,a.short_name," ",a.is_non_refundable&&e("span",{class:"non-ref-span"},"Non Refundable")),f&&e("ir-tooltip",{key:"9ab57bc12a04f02252e9dbfcbe41bf0b88c9cbb9",message:this.getTooltipMessages()})),f?e("div",{class:"d-md-flex justify-content-md-end align-items-md-center flex-fill rateplan-container"},e("div",{class:"mt-1 mt-md-0 flex-fill max-w-300"},e("fieldset",{class:"position-relative"},e("select",{disabled:b,class:"form-control input-sm",id:L(),onChange:t=>this.handleDataChange("adult_child_offering",t)},m===null||m===void 0?void 0:m.map((t=>e("option",{value:t,selected:this.formatVariation(g)===t},t)))))),e("div",{class:"m-0 p-0 mt-1 mt-md-0 d-flex justify-content-between align-items-md-center ml-md-1"},e("div",{class:"d-flex m-0 p-0 rate-total-night-view mt-0"},e("ir-price-input",{disabled:b,onTextChange:t=>this.updateRateplanSelection({is_amount_modified:true,rp_amount:Number(t.detail)}),"aria-label":`${(o=(s=this.visibleInventory)===null||s===void 0?void 0:s.roomtype)===null||o===void 0?void 0:o.name} ${this.ratePlan.short_name}'s rate`,"aria-describedby":`${this.ratePlan.short_name}'s rate`,class:"ir-br-input-none",currency:c.symbol,value:this.renderRate(),placeholder:p.entries.Lcz_Rate||"Rate"}),e("fieldset",{class:"position-relative m-0 total-nights-container p-0"},e("select",{disabled:b,class:"form-control input-sm m-0 nightBorder rounded-0 py-0",id:L(),onChange:t=>this.updateRateplanSelection({view_mode:t.target.value})},d.map((t=>e("option",{value:t.CODE_NAME,selected:(u===null||u===void 0?void 0:u.view_mode)===t.CODE_NAME},t.CODE_VALUE_EN)))))),(l==="PLUS_BOOKING"||l==="ADD_ROOM")&&e("div",{class:"flex-fill mt-lg-0 ml-1 m-0 mt-md-0 p-0"},e("fieldset",{class:"position-relative"},e("select",{disabled:u.visibleInventory===0,class:"form-control input-sm",id:L(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:(u.visibleInventory||0)+1},((t,e)=>e)).map((t=>e("option",{value:t,selected:u.reserved===t},t))))))),l==="EDIT_BOOKING"&&e(n,null,e("div",{class:"m-0 p-0 mt-lg-0 ml-md-1 mt-md-1 d-none d-md-block"},e("fieldset",{class:"position-relative"},e("input",{disabled:b,type:"radio",name:"ratePlanGroup",value:"1",onChange:()=>{this.resetReserved();h({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:1,guest:[{last_name:r.guest.last_name,first_name:r.guest.first_name,unit:null,bed_preference:this.visibleInventory.roomtype.is_bed_configuration_enabled?r.guest.bed_preference:null,infant_nbr:this.visibleInventory.selected_variation.child_nbr>0?r.guest.infant_nbr:null}]})},checked:u.reserved===1}))),e("button",{disabled:b,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1 mt-1 d-md-none",onClick:()=>{this.resetReserved();h({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:1,guest:[{last_name:r.guest.last_name,first_name:r.guest.first_name,unit:null,bed_preference:this.visibleInventory.roomtype.is_bed_configuration_enabled?r.guest.bed_preference:null,infant_nbr:this.visibleInventory.selected_variation.child_nbr>0?r.guest.infant_nbr:null}]});this.bookProperty()}},u.reserved===1?p.entries.Lcz_Current:p.entries.Lcz_Select)),(l==="BAR_BOOKING"||l==="SPLIT_BOOKING")&&e("button",{disabled:b||l==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1 mt-1",onClick:()=>this.bookProperty()},p.entries.Lcz_Book)):e("p",{class:"text-danger m-0 p-0"},p.entries["Lcz_NotAvailable"]||"Not available")))}};de.style=he;const ue=".sc-igl-room-type-h{display:block}.margin-bottom-8.sc-igl-room-type{margin-bottom:8px !important}";const fe=ue;const pe=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"];this.roomType=undefined;this.bookingType="PLUS_BOOKING";this.dateDifference=undefined;this.ratePricingMode=[];this.roomInfoId=null;this.currency=undefined;this.initialRoomIds=undefined;this.isBookDisabled=undefined;this.selectedRooms=[];this.totalRooms=undefined;this.roomsDistributions=[]}render(){var t,s;const n=this.validBookingTypes.includes(this.bookingType);return e(i,{key:"742e5d22de4746f2c334c5929f1e528ba7ad6e5a"},n&&((t=this.roomType.rateplans)===null||t===void 0?void 0:t.length)>0&&e("div",{key:"beac5558ecaef5e07b533a5e270a6cfedc5048ce",class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomType.name),(s=this.roomType.rateplans)===null||s===void 0?void 0:s.map((t=>{if(!!t.variations){let i=this.roomInfoId&&this.roomInfoId===this.roomType.id;const s=f(this.roomType.id,t.id);console.log(s);return e("igl-rate-plan",{isBookDisabled:this.isBookDisabled,visibleInventory:s,key:`rate-plan-${t.id}`,ratePricingMode:this.ratePricingMode,class:n?"":"",currency:this.currency,ratePlan:t,roomTypeId:this.roomType.id,bookingType:this.bookingType,shouldBeDisabled:i})}return null})))}};pe.style=fe;const be=".sc-igl-tba-booking-view-h{display:block}.guestTitle.sc-igl-tba-booking-view{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:2px;margin-bottom:5px;margin-top:5px;padding-left:5px;padding-right:5px}.guestTitle.selectedOrder.sc-igl-tba-booking-view{background-color:#f9f9c9}.pointer.sc-igl-tba-booking-view{cursor:pointer}hr.sc-igl-tba-booking-view{margin-top:8px;margin-bottom:0px}.bookingContainer.sc-igl-tba-booking-view{background-color:#ececec}.actionsContainer.sc-igl-tba-booking-view{display:flex;align-items:center;padding:5px !important;width:100%;gap:16px}.room-select.sc-igl-tba-booking-view{flex:1}.selectContainer.sc-igl-tba-booking-view{width:195px;margin-right:8px}.buttonsContainer.sc-igl-tba-booking-view{box-sizing:border-box;display:flex;align-items:center;justify-content:flex-end;padding:0;margin:0;gap:0.5rem}";const ge=be;const me=class{constructor(e){t(this,e);this.highlightToBeAssignedBookingEvent=s(this,"highlightToBeAssignedBookingEvent",7);this.addToBeAssignedEvent=s(this,"addToBeAssignedEvent",7);this.scrollPageToRoom=s(this,"scrollPageToRoom",7);this.assignRoomEvent=s(this,"assignRoomEvent",7);this.highlightSection=false;this.allRoomsList=[];this.toBeAssignedService=new Ft;this.calendarData=undefined;this.selectedDate=undefined;this.eventData={};this.categoriesData={};this.categoryId=undefined;this.categoryIndex=undefined;this.eventIndex=undefined;this.renderAgain=false;this.selectedRoom=-1;this.isLoading=null}componentShouldUpdate(t,e,i){if(i==="selectedDate"&&t!==e){this.highlightSection=false;this.selectedRoom=-1;return true}else if(i==="eventData"&&t!==e){this.selectedRoom=-1;return true}return true}componentWillLoad(){if(this.categoryIndex===0&&this.eventIndex===0){setTimeout((()=>{this.handleHighlightAvailability()}),100)}}highlightBookingEvent(t){let e=t.detail.data;if(e.bookingId!=this.eventData.ID){this.highlightSection=false;this.selectedRoom=-1;this.renderView()}else{this.highlightSection=true;this.renderView()}}onSelectRoom(t){if(t.stopImmediatePropagation){t.stopImmediatePropagation();t.stopPropagation()}this.selectedRoom=parseInt(t.target.value)}async handleAssignUnit(t,e=false){try{t.stopImmediatePropagation();t.stopPropagation();if(this.selectedRoom){this.isLoading=e?"checkin":"default";await this.toBeAssignedService.assignUnit({booking_nbr:this.eventData.BOOKING_NUMBER,identifier:this.eventData.ID,pr_id:this.selectedRoom,check_in:e});let t=Object.assign(Object.assign({},this.eventData),{PR_ID:this.selectedRoom});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[t]});this.assignRoomEvent.emit({key:"assignRoom",data:t})}}catch(t){console.log(t)}finally{this.isLoading=null}}handleHighlightAvailability(){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:this.eventData.ID,fromDate:this.eventData.FROM_DATE}});if(!this.selectedDate){return}let t=[];let e=[];t=this.eventData.availableRooms.map((t=>{e.push({calendar_cell:null,id:t.PR_ID,name:t.roomName});return Object.assign(Object.assign({},t),{defaultDateRange:this.eventData.defaultDateRange,identifier:this.eventData.identifier})}));this.allRoomsList=e;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:t});this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:this.categoryId,refClass:"category_"+this.categoryId});this.renderView()}handleCloseAssignment(t){t.stopImmediatePropagation();t.stopPropagation();this.highlightSection=false;this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.onSelectRoom({target:{value:""}});this.selectedRoom=-1;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.renderView()}renderView(){this.renderAgain=!this.renderAgain}canCheckIn(){if(!g.checkin_enabled){return false}if(U(new Date).isSameOrAfter(new Date(this.eventData.FROM_DATE),"days")&&U(new Date).isBefore(new Date(this.eventData.TO_DATE),"days")){return true}return false}render(){return e(i,{key:"2c103cf2c3c7ced09b4f4a73f065f1872b7288a2"},e("div",{key:"3c7cb622636892b2aa6c1e688d4d0343133549b1",class:"bookingContainer",onClick:()=>this.handleHighlightAvailability()},e("div",{key:"299651e5fdb5628a203b8e86262f2de633829b09",class:`guestTitle ${this.highlightSection?"selectedOrder":""} pointer font-small-3`,"data-toggle":"tooltip","data-placement":"top","data-original-title":"Click to assign unit"},`Book# ${this.eventData.BOOKING_NUMBER} - ${this.eventData.NAME}`),e("div",{key:"e451a3ddf963d72cb8d060c4ae304eabd362aefa",class:"row m-0 p-0 actionsContainer"},e("select",{key:"48bef6325a6f17fe1a2ed8763d4397d300f241a0",class:"form-control input-sm room-select flex-grow-1",id:L(),onChange:t=>this.onSelectRoom(t)},e("option",{key:"9c650f67c94a88ef8a2d0c9fba91a2b3836d8f3c",value:"",selected:this.selectedRoom==-1},p.entries.Lcz_AssignUnit),this.allRoomsList.map((t=>e("option",{value:t.id,selected:this.selectedRoom==t.id},t.name)))),this.highlightSection?e("div",{class:"buttonsContainer bg-red"},e("button",{type:"button",class:"btn btn-secondary btn-sm mx-0",onClick:t=>this.handleCloseAssignment(t)},e("svg",{class:"m-0 p-0",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"9",viewBox:"0 0 384 512"},e("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})))):null),e("div",{key:"cad44a9960cdd96ef7f2767ff0e814fadc8d1111",class:"d-flex align-items-center ",style:{gap:"0.5rem",paddingInline:"5px"}},e("ir-button",{key:"f2325b5536ab3823e3c8e21c2cf604d2484aeb5c",isLoading:this.isLoading==="default",size:"sm",class:"flex-grow-1",text:p.entries.Lcz_Assign,onClickHandler:t=>this.handleAssignUnit(t),btn_disabled:this.selectedRoom===-1}),this.canCheckIn()&&e("ir-button",{key:"ffcbfb304c3df00ec3906dffe6701d8f4cc14c6b",isLoading:this.isLoading==="checkin",size:"sm",class:"flex-grow-1",text:p.entries.Lcz_AssignedAndChecIn,onClickHandler:t=>this.handleAssignUnit(t,true),btn_disabled:this.selectedRoom===-1})),e("hr",{key:"49e098cea9ec40296399ebc58f095b35f38dbd72"})))}};me.style=ge;const ve=".sc-igl-tba-category-view-h{display:block}";const ye=ve;const ke=class{constructor(e){t(this,e);this.assignUnitEvent=s(this,"assignUnitEvent",7);this.calendarData=undefined;this.selectedDate=undefined;this.categoriesData={};this.categoryId=undefined;this.eventDatas=undefined;this.categoryIndex=undefined;this.renderAgain=false}componentWillLoad(){}handleAssignRoomEvent(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.eventDatas=this.eventDatas.filter((t=>t.ID!=e.data.ID));this.calendarData.bookingEvents.push(e.data);this.assignUnitEvent.emit({key:"assignUnit",data:{RT_ID:this.categoryId,selectedDate:this.selectedDate,assignEvent:e.data,calendarData:this.calendarData}});this.renderView()}getEventView(t,i){return i.map(((i,s)=>e("igl-tba-booking-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,eventData:i,categoriesData:this.categoriesData,categoryId:t,categoryIndex:this.categoryIndex,eventIndex:s,onAssignRoomEvent:t=>this.handleAssignRoomEvent(t)})))}renderView(){this.renderAgain=!this.renderAgain}render(){var t;return e(i,{key:"6d7644cc1b86754316c943695e2703c26913860c"},e("div",{key:"91e60fc7dcb4bbc9ece285979f87d33d55e22510",class:"sectionContainer"},e("div",{key:"568c15054e8ad866f1bc00d44fd8e1ac9c90e609",class:"font-weight-bold mt-1 font-small-3"},(t=this.categoriesData[this.categoryId])===null||t===void 0?void 0:t.name),this.getEventView(this.categoryId,this.eventDatas)))}};ke.style=ye;const we=".sc-igl-to-be-assigned-h{display:block}.custom-dropdown.sc-igl-to-be-assigned{cursor:pointer;padding:5px 10px;width:min-content;margin-left:auto;margin-right:auto}.dropdown-toggle.sc-igl-to-be-assigned{all:unset;display:flex;width:max-content;align-items:center;gap:10px}.close_btn_style.sc-igl-to-be-assigned{padding:0.4rem}.close_btn_style.sc-igl-to-be-assigned:hover{background-color:#f6f6f6}.dropdown-menu.sc-igl-to-be-assigned{max-height:250px;overflow-y:auto}.tobeAssignedHeader.sc-igl-to-be-assigned{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding:0;margin:0}.assignment_header.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:space-between;padding-top:5px;margin-bottom:1rem}.dropdown-toggle.sc-igl-to-be-assigned::after{content:none;display:none}.dropdown-toggle.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transition:transform 0.2s ease}.show.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transform:rotate(-180deg)}.stickyHeader.sc-igl-to-be-assigned{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.pointer.sc-igl-to-be-assigned{cursor:pointer}.dots.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:center;margin:0 3px;padding:0}.dot.sc-igl-to-be-assigned{width:5px;height:5px;margin:5px 4px 0;background-color:#6b6f82;border-radius:50%;animation:dotFlashing 1s infinite linear alternate}.dot.sc-igl-to-be-assigned:nth-child(2){animation-delay:0.2s}.dot.sc-igl-to-be-assigned:nth-child(3){animation-delay:0.4s}@keyframes dotFlashing{0%{opacity:0}50%,100%{opacity:1}}";const xe=we;const _e=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.reduceAvailableUnitEvent=s(this,"reduceAvailableUnitEvent",7);this.showBookingPopup=s(this,"showBookingPopup",7);this.addToBeAssignedEvent=s(this,"addToBeAssignedEvent",7);this.highlightToBeAssignedBookingEvent=s(this,"highlightToBeAssignedBookingEvent",7);this.isGotoToBeAssignedDate=false;this.isLoading=true;this.selectedDate=null;this.data={};this.today=new Date;this.categoriesData={};this.toBeAssignedService=new Ft;this.unassignedDatesProp=undefined;this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.calendarData=undefined;this.loadingMessage=undefined;this.showDatesList=false;this.renderAgain=false;this.orderedDatesList=[];this.noScroll=false}componentWillLoad(){this.reArrangeData();this.loadingMessage=p.entries.Lcz_FetchingUnAssignedUnits}handleUnassignedDatesToBeAssignedChange(t){const{fromDate:e,toDate:i,data:s}=t;let n=new Date(e);n.setHours(0);n.setMinutes(0);n.setSeconds(0);let o=n.getTime();while(o<=new Date(i).getTime()){if(s&&!s[o]&&this.unassignedDates.hasOwnProperty(o)){delete this.unassignedDates[o]}else if(s&&s[o]){this.unassignedDates[o]=s[o]}o=U(o).add(1,"days").toDate().getTime()}this.data=Object.assign({},this.unassignedDates);this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(this.orderedDatesList.length){if(!this.data.hasOwnProperty(this.selectedDate)){this.selectedDate=this.orderedDatesList.length?this.orderedDatesList[0]:null}this.showForDate(this.selectedDate,false);this.renderView()}else{this.selectedDate=null}}handleAssignUnit(t){var e,i;const s=t.detail;const n=s.data;t.stopImmediatePropagation();t.stopPropagation();if(s.key==="assignUnit"){if(Object.keys(this.data[n.selectedDate].categories).length===1){this.isLoading=true;this.noScroll=true}this.data[n.selectedDate].categories[n.RT_ID]=(i=(e=this.data[n.selectedDate])===null||e===void 0?void 0:e.categories[n.RT_ID])===null||i===void 0?void 0:i.filter((t=>t.ID!=n.assignEvent.ID));this.calendarData=n.calendarData;this.renderView()}}async updateCategories(t,e){try{let i={};const s=await this.toBeAssignedService.getUnassignedRooms({from_date:e.from_date,to_date:e.to_date},this.propertyid,k(new Date(+t)),e.roomsInfo,e.formattedLegendData);s.forEach((t=>{if(!i.hasOwnProperty(t.RT_ID)){i[t.RT_ID]=[t]}else{i[t.RT_ID].push(t)}}));this.unassignedDates[t].categories=i}catch(t){}}async reArrangeData(){try{this.today.setHours(0,0,0,0);this.calendarData.roomsInfo.forEach((t=>{this.categoriesData[t.id]={name:t.name,roomsList:t.physicalrooms,roomIds:t.physicalrooms.map((t=>t.id))}}));this.selectedDate=null;this.unassignedDates=Gt();console.log(this.unassignedDates);this.data=this.unassignedDates;this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(!this.selectedDate&&this.orderedDatesList.length){this.selectedDate=this.orderedDatesList[0]}}catch(t){console.error("Error fetching unassigned dates:",t)}}async componentDidLoad(){setTimeout((()=>{if(!this.isGotoToBeAssignedDate&&Object.keys(this.unassignedDates).length>0){const t=Object.keys(this.unassignedDates)[0];this.showForDate(t)}}),100)}async gotoDate(t){this.isGotoToBeAssignedDate=true;this.showForDate(t.detail.data);this.showDatesList=false;this.renderView()}handleToBeAssignedDate(t){this.showBookingPopup.emit({key:"calendar",data:new Date(t.detail.data.fromDate).getTime()-864e5,noScroll:false})}async showForDate(t,e=true){try{if(e){this.isLoading=true}if(this.showDatesList){this.showUnassignedDate()}await this.updateCategories(t,this.calendarData);this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.showBookingPopup.emit({key:"calendar",data:parseInt(t)-864e5,noScroll:this.noScroll});if(this.isGotoToBeAssignedDate){this.isGotoToBeAssignedDate=false}this.isLoading=false;this.selectedDate=t;this.renderView()}catch(t){}}getDay(t){const e=new Date(t);const i="default";const s=this.getLocalizedDayOfWeek(e,i);return s+" "+e.getDate()+", "+e.getFullYear()}getLocalizedDayOfWeek(t,e){const i={weekday:"short"};return t.toLocaleDateString(e,i)}handleOptionEvent(t,e=""){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.optionEvent.emit({key:t,data:e})}showUnassignedDate(){this.showDatesList=!this.showDatesList}getToBeAssignedEntities(){}getCategoryView(){if(this.orderedDatesList.length&&this.selectedDate&&this.data[this.selectedDate]){return Object.entries(this.data[this.selectedDate].categories).map((([t,i],s)=>e("igl-tba-category-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,categoryId:t,categoryIndex:s,categoriesData:this.categoriesData,eventDatas:i,onAssignUnitEvent:t=>this.handleAssignUnit(t)})))}else{return null}}renderView(){this.renderAgain=!this.renderAgain}render(){var t;return e(i,{key:"a200b705f84e41bd59552aad12a9e4e4e00e149d",class:"tobeAssignedContainer pr-1 text-left"},e("div",{key:"6da0238bfae45309c3124dc675caa83d5e0c7abd"},e("div",{key:"a52896cc9882ced2e36fcb589ce80bd09dd48bfe"},e("div",{key:"3996ad3871d67383fe0a163ebdd976f0335432d4",class:"stickyHeader pt-1"},e("div",{key:"c2f5ad8b3da851b80bbb51854396594f67334888",class:"assignment_header"},e("p",{key:"084519cecbdc21dd58569650081eb52746ed1032",class:"tobeAssignedHeader "},p.entries.Lcz_Assignments),e("ir-button",{key:"d2a0a8afe255fa227936fed97bbcdd5d7d5ce326",class:"close_btn",variant:"icon",btn_styles:"close_btn_style",icon_name:"double_caret_left",style:Xt.secondary,onClickHandler:()=>this.handleOptionEvent("closeSideMenu"),visibleBackgroundOnHover:true})),e("hr",{key:"289d54f6cc6ad516905a48a1dbfdad84ead1b0ad"}),Object.keys(this.data).length===0?e("p",null,p.entries.Lcz_AllBookingsAreAssigned):this.isLoading?e("p",{class:"d-flex align-items-center"},e("span",{class:"p-0"},this.loadingMessage),e("div",{class:"dots"},e("div",{class:"dot"}),e("div",{class:"dot"}),e("div",{class:"dot"}))):e(n,null,this.orderedDatesList.length?e("div",{class:`custom-dropdown border border-light rounded text-center `+(this.showDatesList?"show":""),id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},e("div",{class:"dropdown-toggle"},e("span",{class:"font-weight-bold"},this.data[this.selectedDate].dateStr),e("svg",{class:"caret-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),e("div",{class:"dropdown-menu dropdown-menu-right full-width","aria-labelledby":"dropdownMenuButton"},(t=this.orderedDatesList)===null||t===void 0?void 0:t.map((t=>e("div",{class:"dropdown-item pointer",onClick:()=>this.showForDate(t)},this.data[t].dateStr))))):p.entries.Lcz_AllBookingsAreAssigned)),!this.isLoading&&e("div",{key:"0de9759f77d6cf7614bcbb066fad724d7a71c00e",class:"scrollabledArea"},this.orderedDatesList.length?Object.keys(this.data[this.selectedDate].categories).length?this.getCategoryView():e("div",{class:"mt-1"},p.entries.Lcz_AllAssignForThisDay):null))))}static get watchers(){return{unassignedDatesProp:["handleUnassignedDatesToBeAssignedChange"]}}};_e.style=xe;const De=Object.create(null);De["open"]="0";De["close"]="1";De["ping"]="2";De["pong"]="3";De["message"]="4";De["upgrade"]="5";De["noop"]="6";const Ce=Object.create(null);Object.keys(De).forEach((t=>{Ce[De[t]]=t}));const Oe={type:"error",data:"parser error"};const Ee=typeof Blob==="function"||typeof Blob!=="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]";const Ae=typeof ArrayBuffer==="function";const Be=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer;const Me=({type:t,data:e},i,s)=>{if(Ee&&e instanceof Blob){if(i){return s(e)}else{return Te(e,s)}}else if(Ae&&(e instanceof ArrayBuffer||Be(e))){if(i){return s(e)}else{return Te(new Blob([e]),s)}}return s(De[t]+(e||""))};const Te=(t,e)=>{const i=new FileReader;i.onload=function(){const t=i.result.split(",")[1];e("b"+(t||""))};return i.readAsDataURL(t)};function Ie(t){if(t instanceof Uint8Array){return t}else if(t instanceof ArrayBuffer){return new Uint8Array(t)}else{return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}}let Se;function Ye(t,e){if(Ee&&t.data instanceof Blob){return t.data.arrayBuffer().then(Ie).then(e)}else if(Ae&&(t.data instanceof ArrayBuffer||Be(t.data))){return e(Ie(t.data))}Me(t,false,(t=>{if(!Se){Se=new TextEncoder}e(Se.encode(t))}))}const Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const Le=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(let t=0;t<Ne.length;t++){Le[Ne.charCodeAt(t)]=t}const je=t=>{let e=t.length*.75,i=t.length,s,n=0,o,r,a,l;if(t[t.length-1]==="="){e--;if(t[t.length-2]==="="){e--}}const c=new ArrayBuffer(e),h=new Uint8Array(c);for(s=0;s<i;s+=4){o=Le[t.charCodeAt(s)];r=Le[t.charCodeAt(s+1)];a=Le[t.charCodeAt(s+2)];l=Le[t.charCodeAt(s+3)];h[n++]=o<<2|r>>4;h[n++]=(r&15)<<4|a>>2;h[n++]=(a&3)<<6|l&63}return c};const Re=typeof ArrayBuffer==="function";const ze=(t,e)=>{if(typeof t!=="string"){return{type:"message",data:Fe(t,e)}}const i=t.charAt(0);if(i==="b"){return{type:"message",data:$e(t.substring(1),e)}}const s=Ce[i];if(!s){return Oe}return t.length>1?{type:Ce[i],data:t.substring(1)}:{type:Ce[i]}};const $e=(t,e)=>{if(Re){const i=je(t);return Fe(i,e)}else{return{base64:true,data:t}}};const Fe=(t,e)=>{switch(e){case"blob":if(t instanceof Blob){return t}else{return new Blob([t])}case"arraybuffer":default:if(t instanceof ArrayBuffer){return t}else{return t.buffer}}};const Pe=String.fromCharCode(30);const He=(t,e)=>{const i=t.length;const s=new Array(i);let n=0;t.forEach(((t,o)=>{Me(t,false,(t=>{s[o]=t;if(++n===i){e(s.join(Pe))}}))}))};const Ve=(t,e)=>{const i=t.split(Pe);const s=[];for(let t=0;t<i.length;t++){const n=ze(i[t],e);s.push(n);if(n.type==="error"){break}}return s};function Ue(){return new TransformStream({transform(t,e){Ye(t,(i=>{const s=i.length;let n;if(s<126){n=new Uint8Array(1);new DataView(n.buffer).setUint8(0,s)}else if(s<65536){n=new Uint8Array(3);const t=new DataView(n.buffer);t.setUint8(0,126);t.setUint16(1,s)}else{n=new Uint8Array(9);const t=new DataView(n.buffer);t.setUint8(0,127);t.setBigUint64(1,BigInt(s))}if(t.data&&typeof t.data!=="string"){n[0]|=128}e.enqueue(n);e.enqueue(i)}))}})}let Ge;function Ke(t){return t.reduce(((t,e)=>t+e.length),0)}function We(t,e){if(t[0].length===e){return t.shift()}const i=new Uint8Array(e);let s=0;for(let n=0;n<e;n++){i[n]=t[0][s++];if(s===t[0].length){t.shift();s=0}}if(t.length&&s<t[0].length){t[0]=t[0].slice(s)}return i}function qe(t,e){if(!Ge){Ge=new TextDecoder}const i=[];let s=0;let n=-1;let o=false;return new TransformStream({transform(r,a){i.push(r);while(true){if(s===0){if(Ke(i)<1){break}const t=We(i,1);o=(t[0]&128)===128;n=t[0]&127;if(n<126){s=3}else if(n===126){s=1}else{s=2}}else if(s===1){if(Ke(i)<2){break}const t=We(i,2);n=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0);s=3}else if(s===2){if(Ke(i)<8){break}const t=We(i,8);const e=new DataView(t.buffer,t.byteOffset,t.length);const o=e.getUint32(0);if(o>Math.pow(2,53-32)-1){a.enqueue(Oe);break}n=o*Math.pow(2,32)+e.getUint32(4);s=3}else{if(Ke(i)<n){break}const t=We(i,n);a.enqueue(ze(o?t:Ge.decode(t),e));s=0}if(n===0||n>t){a.enqueue(Oe);break}}}})}const Xe=4;function Je(t){if(t)return Ze(t)}function Ze(t){for(var e in Je.prototype){t[e]=Je.prototype[e]}return t}Je.prototype.on=Je.prototype.addEventListener=function(t,e){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e);return this};Je.prototype.once=function(t,e){function i(){this.off(t,i);e.apply(this,arguments)}i.fn=e;this.on(t,i);return this};Je.prototype.off=Je.prototype.removeListener=Je.prototype.removeAllListeners=Je.prototype.removeEventListener=function(t,e){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var s;for(var n=0;n<i.length;n++){s=i[n];if(s===e||s.fn===e){i.splice(n,1);break}}if(i.length===0){delete this._callbacks["$"+t]}return this};Je.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=new Array(arguments.length-1),i=this._callbacks["$"+t];for(var s=1;s<arguments.length;s++){e[s-1]=arguments[s]}if(i){i=i.slice(0);for(var s=0,n=i.length;s<n;++s){i[s].apply(this,e)}}return this};Je.prototype.emitReserved=Je.prototype.emit;Je.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};Je.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Qe=(()=>{if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else{return Function("return this")()}})();function ti(t,...e){return e.reduce(((e,i)=>{if(t.hasOwnProperty(i)){e[i]=t[i]}return e}),{})}const ei=Qe.setTimeout;const ii=Qe.clearTimeout;function si(t,e){if(e.useNativeTimers){t.setTimeoutFn=ei.bind(Qe);t.clearTimeoutFn=ii.bind(Qe)}else{t.setTimeoutFn=Qe.setTimeout.bind(Qe);t.clearTimeoutFn=Qe.clearTimeout.bind(Qe)}}const ni=1.33;function oi(t){if(typeof t==="string"){return ri(t)}return Math.ceil((t.byteLength||t.size)*ni)}function ri(t){let e=0,i=0;for(let s=0,n=t.length;s<n;s++){e=t.charCodeAt(s);if(e<128){i+=1}else if(e<2048){i+=2}else if(e<55296||e>=57344){i+=3}else{s++;i+=4}}return i}function ai(t){let e="";for(let i in t){if(t.hasOwnProperty(i)){if(e.length)e+="&";e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i])}}return e}function li(t){let e={};let i=t.split("&");for(let t=0,s=i.length;t<s;t++){let s=i[t].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class ci extends Error{constructor(t,e,i){super(t);this.description=e;this.context=i;this.type="TransportError"}}class hi extends Je{constructor(t){super();this.writable=false;si(this,t);this.opts=t;this.query=t.query;this.socket=t.socket}onError(t,e,i){super.emitReserved("error",new ci(t,e,i));return this}open(){this.readyState="opening";this.doOpen();return this}close(){if(this.readyState==="opening"||this.readyState==="open"){this.doClose();this.onClose()}return this}send(t){if(this.readyState==="open"){this.write(t)}}onOpen(){this.readyState="open";this.writable=true;super.emitReserved("open")}onData(t){const e=ze(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed";super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){if(this.opts.port&&(this.opts.secure&&Number(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)){return":"+this.opts.port}else{return""}}_query(t){const e=ai(t);return e.length?"?"+e:""}}const di="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ui=64,fi={};let pi=0,bi=0,gi;function mi(t){let e="";do{e=di[t%ui]+e;t=Math.floor(t/ui)}while(t>0);return e}function vi(){const t=mi(+new Date);if(t!==gi)return pi=0,gi=t;return t+"."+mi(pi++)}for(;bi<ui;bi++)fi[di[bi]]=bi;let yi=false;try{yi=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const ki=yi;function wi(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||ki)){return new XMLHttpRequest}}catch(t){}if(!e){try{return new(Qe[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}function xi(){}function _i(){}const Di=function(){const t=new wi({xdomain:false});return null!=t.responseType}();class Ci extends hi{constructor(t){super(t);this.polling=false;if(typeof location!=="undefined"){const e="https:"===location.protocol;let i=location.port;if(!i){i=e?"443":"80"}this.xd=typeof location!=="undefined"&&t.hostname!==location.hostname||i!==t.port}const e=t&&t.forceBase64;this.supportsBinary=Di&&!e;if(this.opts.withCredentials){this.cookieJar=xi()}}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused";t()};if(this.polling||!this.writable){let t=0;if(this.polling){t++;this.once("pollComplete",(function(){--t||e()}))}if(!this.writable){t++;this.once("drain",(function(){--t||e()}))}}else{e()}}poll(){this.polling=true;this.doPoll();this.emitReserved("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&t.type==="open"){this.onOpen()}if("close"===t.type){this.onClose({description:"transport closed by the server"});return false}this.onPacket(t)};Ve(t,this.socket.binaryType).forEach(e);if("closed"!==this.readyState){this.polling=false;this.emitReserved("pollComplete");if("open"===this.readyState){this.poll()}}}doClose(){const t=()=>{this.write([{type:"close"}])};if("open"===this.readyState){t()}else{this.once("open",t)}}write(t){this.writable=false;He(t,(t=>{this.doWrite(t,(()=>{this.writable=true;this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http";const e=this.query||{};if(false!==this.opts.timestampRequests){e[this.opts.timestampParam]=vi()}if(!this.supportsBinary&&!e.sid){e.b64=1}return this.createUri(t,e)}request(t={}){Object.assign(t,{xd:this.xd,cookieJar:this.cookieJar},this.opts);return new Oi(this.uri(),t)}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e);i.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this));t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)}));this.pollXhr=t}}class Oi extends Je{constructor(t,e){super();si(this,e);this.opts=e;this.method=e.method||"GET";this.uri=t;this.data=undefined!==e.data?e.data:null;this.create()}create(){var t;const e=ti(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd;const i=this.xhr=new wi(e);try{i.open(this.method,this.uri,true);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(true);for(let t in this.opts.extraHeaders){if(this.opts.extraHeaders.hasOwnProperty(t)){i.setRequestHeader(t,this.opts.extraHeaders[t])}}}}catch(t){}if("POST"===this.method){try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}}try{i.setRequestHeader("Accept","*/*")}catch(t){}(t=this.opts.cookieJar)===null||t===void 0?void 0:t.addCookies(i);if("withCredentials"in i){i.withCredentials=this.opts.withCredentials}if(this.opts.requestTimeout){i.timeout=this.opts.requestTimeout}i.onreadystatechange=()=>{var t;if(i.readyState===3){(t=this.opts.cookieJar)===null||t===void 0?void 0:t.parseCookies(i)}if(4!==i.readyState)return;if(200===i.status||1223===i.status){this.onLoad()}else{this.setTimeoutFn((()=>{this.onError(typeof i.status==="number"?i.status:0)}),0)}};i.send(this.data)}catch(t){this.setTimeoutFn((()=>{this.onError(t)}),0);return}if(typeof document!=="undefined"){this.index=Oi.requestsCount++;Oi.requests[this.index]=this}}onError(t){this.emitReserved("error",t,this.xhr);this.cleanup(true)}cleanup(t){if("undefined"===typeof this.xhr||null===this.xhr){return}this.xhr.onreadystatechange=_i;if(t){try{this.xhr.abort()}catch(t){}}if(typeof document!=="undefined"){delete Oi.requests[this.index]}this.xhr=null}onLoad(){const t=this.xhr.responseText;if(t!==null){this.emitReserved("data",t);this.emitReserved("success");this.cleanup()}}abort(){this.cleanup()}}Oi.requestsCount=0;Oi.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",Ei)}else if(typeof addEventListener==="function"){const t="onpagehide"in Qe?"pagehide":"unload";addEventListener(t,Ei,false)}}function Ei(){for(let t in Oi.requests){if(Oi.requests.hasOwnProperty(t)){Oi.requests[t].abort()}}}const Ai=(()=>{const t=typeof Promise==="function"&&typeof Promise.resolve==="function";if(t){return t=>Promise.resolve().then(t)}else{return(t,e)=>e(t,0)}})();const Bi=Qe.WebSocket||Qe.MozWebSocket;const Mi="arraybuffer";const Ti=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class Ii extends hi{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check()){return}const t=this.uri();const e=this.opts.protocols;const i=Ti?{}:ti(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders){i.headers=this.opts.extraHeaders}try{this.ws=!Ti?e?new Bi(t,e):new Bi(t):new Bi(t,e,i)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType;this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref){this.ws._socket.unref()}this.onOpen()};this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t});this.ws.onmessage=t=>this.onData(t.data);this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;Me(i,this.supportsBinary,(t=>{try{{this.ws.send(t)}}catch(t){}if(s){Ai((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){if(typeof this.ws!=="undefined"){this.ws.close();this.ws=null}}uri(){const t=this.opts.secure?"wss":"ws";const e=this.query||{};if(this.opts.timestampRequests){e[this.opts.timestampParam]=vi()}if(!this.supportsBinary){e.b64=1}return this.createUri(t,e)}check(){return!!Bi}}class Si extends hi{get name(){return"webtransport"}doOpen(){if(typeof WebTransport!=="function"){return}this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]);this.transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)}));this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((t=>{const e=qe(Number.MAX_SAFE_INTEGER,this.socket.binaryType);const i=t.readable.pipeThrough(e).getReader();const s=Ue();s.readable.pipeTo(t.writable);this.writer=s.writable.getWriter();const n=()=>{i.read().then((({done:t,value:e})=>{if(t){return}this.onPacket(e);n()})).catch((t=>{}))};n();const o={type:"open"};if(this.query.sid){o.data=`{"sid":"${this.query.sid}"}`}this.writer.write(o).then((()=>this.onOpen()))}))}))}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;this.writer.write(i).then((()=>{if(s){Ai((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){var t;(t=this.transport)===null||t===void 0?void 0:t.close()}}const Yi={websocket:Ii,webtransport:Si,polling:Ci};const Ni=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;const Li=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ji(t){if(t.length>2e3){throw"URI too long"}const e=t,i=t.indexOf("["),s=t.indexOf("]");if(i!=-1&&s!=-1){t=t.substring(0,i)+t.substring(i,s).replace(/:/g,";")+t.substring(s,t.length)}let n=Ni.exec(t||""),o={},r=14;while(r--){o[Li[r]]=n[r]||""}if(i!=-1&&s!=-1){o.source=e;o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":");o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":");o.ipv6uri=true}o.pathNames=Ri(o,o["path"]);o.queryKey=zi(o,o["query"]);return o}function Ri(t,e){const i=/\/{2,9}/g,s=e.replace(i,"/").split("/");if(e.slice(0,1)=="/"||e.length===0){s.splice(0,1)}if(e.slice(-1)=="/"){s.splice(s.length-1,1)}return s}function zi(t,e){const i={};e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,s){if(e){i[e]=s}}));return i}class $i extends Je{constructor(t,e={}){super();this.binaryType=Mi;this.writeBuffer=[];if(t&&"object"===typeof t){e=t;t=null}if(t){t=ji(t);e.hostname=t.host;e.secure=t.protocol==="https"||t.protocol==="wss";e.port=t.port;if(t.query)e.query=t.query}else if(e.host){e.hostname=ji(e.host).host}si(this,e);this.secure=null!=e.secure?e.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(e.hostname&&!e.port){e.port=this.secure?"443":"80"}this.hostname=e.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=e.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?"443":"80");this.transports=e.transports||["polling","websocket","webtransport"];this.writeBuffer=[];this.prevBufferLen=0;this.opts=Object.assign({path:"/engine.io",agent:false,withCredentials:false,upgrade:true,timestampParam:"t",rememberUpgrade:false,addTrailingSlash:true,rejectUnauthorized:true,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:false},e);this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":"");if(typeof this.opts.query==="string"){this.opts.query=li(this.opts.query)}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingTimeoutTimer=null;if(typeof addEventListener==="function"){if(this.opts.closeOnBeforeunload){this.beforeunloadEventListener=()=>{if(this.transport){this.transport.removeAllListeners();this.transport.close()}};addEventListener("beforeunload",this.beforeunloadEventListener,false)}if(this.hostname!=="localhost"){this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})};addEventListener("offline",this.offlineEventListener,false)}}this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Xe;e.transport=t;if(this.id)e.sid=this.id;const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new Yi[t](i)}open(){let t;if(this.opts.rememberUpgrade&&$i.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){t="websocket"}else if(0===this.transports.length){this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);return}else{t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){this.transports.shift();this.open();return}t.open();this.setTransport(t)}setTransport(t){if(this.transport){this.transport.removeAllListeners()}this.transport=t;t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t);let i=false;$i.priorWebsocketSuccess=false;const s=()=>{if(i)return;e.send([{type:"ping",data:"probe"}]);e.once("packet",(t=>{if(i)return;if("pong"===t.type&&"probe"===t.data){this.upgrading=true;this.emitReserved("upgrading",e);if(!e)return;$i.priorWebsocketSuccess="websocket"===e.name;this.transport.pause((()=>{if(i)return;if("closed"===this.readyState)return;c();this.setTransport(e);e.send([{type:"upgrade"}]);this.emitReserved("upgrade",e);e=null;this.upgrading=false;this.flush()}))}else{const t=new Error("probe error");t.transport=e.name;this.emitReserved("upgradeError",t)}}))};function n(){if(i)return;i=true;c();e.close();e=null}const o=t=>{const i=new Error("probe error: "+t);i.transport=e.name;n();this.emitReserved("upgradeError",i)};function r(){o("transport closed")}function a(){o("socket closed")}function l(t){if(e&&t.name!==e.name){n()}}const c=()=>{e.removeListener("open",s);e.removeListener("error",o);e.removeListener("close",r);this.off("close",a);this.off("upgrading",l)};e.once("open",s);e.once("error",o);e.once("close",r);this.once("close",a);this.once("upgrading",l);if(this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"){this.setTimeoutFn((()=>{if(!i){e.open()}}),200)}else{e.open()}}onOpen(){this.readyState="open";$i.priorWebsocketSuccess="websocket"===this.transport.name;this.emitReserved("open");this.flush();if("open"===this.readyState&&this.opts.upgrade){let t=0;const e=this.upgrades.length;for(;t<e;t++){this.probe(this.upgrades[t])}}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.emitReserved("packet",t);this.emitReserved("heartbeat");this.resetPingTimeout();switch(t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data;this.onError(e);break;case"message":this.emitReserved("data",t.data);this.emitReserved("message",t.data);break}}}onHandshake(t){this.emitReserved("handshake",t);this.id=t.sid;this.transport.query.sid=t.sid;this.upgrades=this.filterUpgrades(t.upgrades);this.pingInterval=t.pingInterval;this.pingTimeout=t.pingTimeout;this.maxPayload=t.maxPayload;this.onOpen();if("closed"===this.readyState)return;this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout);if(this.opts.autoUnref){this.pingTimeoutTimer.unref()}}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emitReserved("drain")}else{this.flush()}}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t);this.prevBufferLen=t.length;this.emitReserved("flush")}}getWritablePackets(){const t=this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1;if(!t){return this.writeBuffer}let e=1;for(let t=0;t<this.writeBuffer.length;t++){const i=this.writeBuffer[t].data;if(i){e+=oi(i)}if(t>0&&e>this.maxPayload){return this.writeBuffer.slice(0,t)}e+=2}return this.writeBuffer}write(t,e,i){this.sendPacket("message",t,e,i);return this}send(t,e,i){this.sendPacket("message",t,e,i);return this}sendPacket(t,e,i,s){if("function"===typeof e){s=e;e=undefined}if("function"===typeof i){s=i;i=null}if("closing"===this.readyState||"closed"===this.readyState){return}i=i||{};i.compress=false!==i.compress;const n={type:t,data:e,options:i};this.emitReserved("packetCreate",n);this.writeBuffer.push(n);if(s)this.once("flush",s);this.flush()}close(){const t=()=>{this.onClose("forced close");this.transport.close()};const e=()=>{this.off("upgrade",e);this.off("upgradeError",e);t()};const i=()=>{this.once("upgrade",e);this.once("upgradeError",e)};if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";if(this.writeBuffer.length){this.once("drain",(()=>{if(this.upgrading){i()}else{t()}}))}else if(this.upgrading){i()}else{t()}}return this}onError(t){$i.priorWebsocketSuccess=false;this.emitReserved("error",t);this.onClose("transport error",t)}onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.clearTimeoutFn(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();if(typeof removeEventListener==="function"){removeEventListener("beforeunload",this.beforeunloadEventListener,false);removeEventListener("offline",this.offlineEventListener,false)}this.readyState="closed";this.id=null;this.emitReserved("close",t,e);this.writeBuffer=[];this.prevBufferLen=0}}filterUpgrades(t){const e=[];let i=0;const s=t.length;for(;i<s;i++){if(~this.transports.indexOf(t[i]))e.push(t[i])}return e}}$i.protocol=Xe;function Fi(t,e="",i){let s=t;i=i||typeof location!=="undefined"&&location;if(null==t)t=i.protocol+"//"+i.host;if(typeof t==="string"){if("/"===t.charAt(0)){if("/"===t.charAt(1)){t=i.protocol+t}else{t=i.host+t}}if(!/^(https?|wss?):\/\//.test(t)){if("undefined"!==typeof i){t=i.protocol+"//"+t}else{t="https://"+t}}s=ji(t)}if(!s.port){if(/^(http|ws)$/.test(s.protocol)){s.port="80"}else if(/^(http|ws)s$/.test(s.protocol)){s.port="443"}}s.path=s.path||"/";const n=s.host.indexOf(":")!==-1;const o=n?"["+s.host+"]":s.host;s.id=s.protocol+"://"+o+":"+s.port+e;s.href=s.protocol+"://"+o+(i&&i.port===s.port?"":":"+s.port);return s}const Pi=typeof ArrayBuffer==="function";const Hi=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;const Vi=Object.prototype.toString;const Ui=typeof Blob==="function"||typeof Blob!=="undefined"&&Vi.call(Blob)==="[object BlobConstructor]";const Gi=typeof File==="function"||typeof File!=="undefined"&&Vi.call(File)==="[object FileConstructor]";function Ki(t){return Pi&&(t instanceof ArrayBuffer||Hi(t))||Ui&&t instanceof Blob||Gi&&t instanceof File}function Wi(t,e){if(!t||typeof t!=="object"){return false}if(Array.isArray(t)){for(let e=0,i=t.length;e<i;e++){if(Wi(t[e])){return true}}return false}if(Ki(t)){return true}if(t.toJSON&&typeof t.toJSON==="function"&&arguments.length===1){return Wi(t.toJSON(),true)}for(const e in t){if(Object.prototype.hasOwnProperty.call(t,e)&&Wi(t[e])){return true}}return false}function qi(t){const e=[];const i=t.data;const s=t;s.data=Xi(i,e);s.attachments=e.length;return{packet:s,buffers:e}}function Xi(t,e){if(!t)return t;if(Ki(t)){const i={_placeholder:true,num:e.length};e.push(t);return i}else if(Array.isArray(t)){const i=new Array(t.length);for(let s=0;s<t.length;s++){i[s]=Xi(t[s],e)}return i}else if(typeof t==="object"&&!(t instanceof Date)){const i={};for(const s in t){if(Object.prototype.hasOwnProperty.call(t,s)){i[s]=Xi(t[s],e)}}return i}return t}function Ji(t,e){t.data=Zi(t.data,e);delete t.attachments;return t}function Zi(t,e){if(!t)return t;if(t&&t._placeholder===true){const i=typeof t.num==="number"&&t.num>=0&&t.num<e.length;if(i){return e[t.num]}else{throw new Error("illegal attachments")}}else if(Array.isArray(t)){for(let i=0;i<t.length;i++){t[i]=Zi(t[i],e)}}else if(typeof t==="object"){for(const i in t){if(Object.prototype.hasOwnProperty.call(t,i)){t[i]=Zi(t[i],e)}}}return t}const Qi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];const ts=5;var es;(function(t){t[t["CONNECT"]=0]="CONNECT";t[t["DISCONNECT"]=1]="DISCONNECT";t[t["EVENT"]=2]="EVENT";t[t["ACK"]=3]="ACK";t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR";t[t["BINARY_EVENT"]=5]="BINARY_EVENT";t[t["BINARY_ACK"]=6]="BINARY_ACK"})(es||(es={}));class is{constructor(t){this.replacer=t}encode(t){if(t.type===es.EVENT||t.type===es.ACK){if(Wi(t)){return this.encodeAsBinary({type:t.type===es.EVENT?es.BINARY_EVENT:es.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}}return[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;if(t.type===es.BINARY_EVENT||t.type===es.BINARY_ACK){e+=t.attachments+"-"}if(t.nsp&&"/"!==t.nsp){e+=t.nsp+","}if(null!=t.id){e+=t.id}if(null!=t.data){e+=JSON.stringify(t.data,this.replacer)}return e}encodeAsBinary(t){const e=qi(t);const i=this.encodeAsString(e.packet);const s=e.buffers;s.unshift(i);return s}}function ss(t){return Object.prototype.toString.call(t)==="[object Object]"}class ns extends Je{constructor(t){super();this.reviver=t}add(t){let e;if(typeof t==="string"){if(this.reconstructor){throw new Error("got plaintext data when reconstructing a packet")}e=this.decodeString(t);const i=e.type===es.BINARY_EVENT;if(i||e.type===es.BINARY_ACK){e.type=i?es.EVENT:es.ACK;this.reconstructor=new os(e);if(e.attachments===0){super.emitReserved("decoded",e)}}else{super.emitReserved("decoded",e)}}else if(Ki(t)||t.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{e=this.reconstructor.takeBinaryData(t);if(e){this.reconstructor=null;super.emitReserved("decoded",e)}}}else{throw new Error("Unknown type: "+t)}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(es[i.type]===undefined){throw new Error("unknown packet type "+i.type)}if(i.type===es.BINARY_EVENT||i.type===es.BINARY_ACK){const s=e+1;while(t.charAt(++e)!=="-"&&e!=t.length){}const n=t.substring(s,e);if(n!=Number(n)||t.charAt(e)!=="-"){throw new Error("Illegal attachments")}i.attachments=Number(n)}if("/"===t.charAt(e+1)){const s=e+1;while(++e){const i=t.charAt(e);if(","===i)break;if(e===t.length)break}i.nsp=t.substring(s,e)}else{i.nsp="/"}const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const s=e+1;while(++e){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=this.tryParse(t.substr(e));if(ns.isPayloadValid(i.type,s)){i.data=s}else{throw new Error("invalid payload")}}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return false}}static isPayloadValid(t,e){switch(t){case es.CONNECT:return ss(e);case es.DISCONNECT:return e===undefined;case es.CONNECT_ERROR:return typeof e==="string"||ss(e);case es.EVENT:case es.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]==="number"||typeof e[0]==="string"&&Qi.indexOf(e[0])===-1);case es.ACK:case es.BINARY_ACK:return Array.isArray(e)}}destroy(){if(this.reconstructor){this.reconstructor.finishedReconstruction();this.reconstructor=null}}}class os{constructor(t){this.packet=t;this.buffers=[];this.reconPack=t}takeBinaryData(t){this.buffers.push(t);if(this.buffers.length===this.reconPack.attachments){const t=Ji(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null}finishedReconstruction(){this.reconPack=null;this.buffers=[]}}const rs=Object.freeze({__proto__:null,protocol:ts,get PacketType(){return es},Encoder:is,Decoder:ns});function as(t,e,i){t.on(e,i);return function s(){t.off(e,i)}}const ls=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class cs extends Je{constructor(t,e,i){super();this.connected=false;this.recovered=false;this.receiveBuffer=[];this.sendBuffer=[];this._queue=[];this._queueSeq=0;this.ids=0;this.acks={};this.flags={};this.io=t;this.nsp=e;if(i&&i.auth){this.auth=i.auth}this._opts=Object.assign({},i);if(this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[as(t,"open",this.onopen.bind(this)),as(t,"packet",this.onpacket.bind(this)),as(t,"error",this.onerror.bind(this)),as(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;this.subEvents();if(!this.io["_reconnecting"])this.io.open();if("open"===this.io._readyState)this.onopen();return this}open(){return this.connect()}send(...t){t.unshift("message");this.emit.apply(this,t);return this}emit(t,...e){if(ls.hasOwnProperty(t)){throw new Error('"'+t.toString()+'" is a reserved event name')}e.unshift(t);if(this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile){this._addToQueue(e);return this}const i={type:es.EVENT,data:e};i.options={};i.options.compress=this.flags.compress!==false;if("function"===typeof e[e.length-1]){const t=this.ids++;const s=e.pop();this._registerAckCallback(t,s);i.id=t}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;const n=this.flags.volatile&&(!s||!this.connected);if(n);else if(this.connected){this.notifyOutgoingListeners(i);this.packet(i)}else{this.sendBuffer.push(i)}this.flags={};return this}_registerAckCallback(t,e){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===undefined){this.acks[t]=e;return}const n=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++){if(this.sendBuffer[e].id===t){this.sendBuffer.splice(e,1)}}e.call(this,new Error("operation has timed out"))}),s);const o=(...t)=>{this.io.clearTimeoutFn(n);e.apply(this,t)};o.withError=true;this.acks[t]=o}emitWithAck(t,...e){return new Promise(((i,s)=>{const n=(t,e)=>t?s(t):i(e);n.withError=true;e.push(n);this.emit(t,...e)}))}_addToQueue(t){let e;if(typeof t[t.length-1]==="function"){e=t.pop()}const i={id:this._queueSeq++,tryCount:0,pending:false,args:t,flags:Object.assign({fromQueue:true},this.flags)};t.push(((t,...s)=>{if(i!==this._queue[0]){return}const n=t!==null;if(n){if(i.tryCount>this._opts.retries){this._queue.shift();if(e){e(t)}}}else{this._queue.shift();if(e){e(null,...s)}}i.pending=false;return this._drainQueue()}));this._queue.push(i);this._drainQueue()}_drainQueue(t=false){if(!this.connected||this._queue.length===0){return}const e=this._queue[0];if(e.pending&&!t){return}e.pending=true;e.tryCount++;this.flags=e.flags;this.emit.apply(this,e.args)}packet(t){t.nsp=this.nsp;this.io._packet(t)}onopen(){if(typeof this.auth=="function"){this.auth((t=>{this._sendConnectPacket(t)}))}else{this._sendConnectPacket(this.auth)}}_sendConnectPacket(t){this.packet({type:es.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){if(!this.connected){this.emitReserved("connect_error",t)}}onclose(t,e){this.connected=false;delete this.id;this.emitReserved("disconnect",t,e);this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{const e=this.sendBuffer.some((e=>String(e.id)===t));if(!e){const e=this.acks[t];delete this.acks[t];if(e.withError){e.call(this,new Error("socket has been disconnected"))}}}))}onpacket(t){const e=t.nsp===this.nsp;if(!e)return;switch(t.type){case es.CONNECT:if(t.data&&t.data.sid){this.onconnect(t.data.sid,t.data.pid)}else{this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"))}break;case es.EVENT:case es.BINARY_EVENT:this.onevent(t);break;case es.ACK:case es.BINARY_ACK:this.onack(t);break;case es.DISCONNECT:this.ondisconnect();break;case es.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data;this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];if(null!=t.id){e.push(this.ack(t.id))}if(this.connected){this.emitEvent(e)}else{this.receiveBuffer.push(Object.freeze(e))}}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e){i.apply(this,t)}}super.emit.apply(this,t);if(this._pid&&t.length&&typeof t[t.length-1]==="string"){this._lastOffset=t[t.length-1]}}ack(t){const e=this;let i=false;return function(...s){if(i)return;i=true;e.packet({type:es.ACK,id:t,data:s})}}onack(t){const e=this.acks[t.id];if(typeof e!=="function"){return}delete this.acks[t.id];if(e.withError){t.data.unshift(null)}e.apply(this,t.data)}onconnect(t,e){this.id=t;this.recovered=e&&this._pid===e;this._pid=e;this.connected=true;this.emitBuffered();this.emitReserved("connect");this._drainQueue(true)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t)));this.receiveBuffer=[];this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t);this.packet(t)}));this.sendBuffer=[]}ondisconnect(){this.destroy();this.onclose("io server disconnect")}destroy(){if(this.subs){this.subs.forEach((t=>t()));this.subs=undefined}this.io["_destroy"](this)}disconnect(){if(this.connected){this.packet({type:es.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this}close(){return this.disconnect()}compress(t){this.flags.compress=t;return this}get volatile(){this.flags.volatile=true;return this}timeout(t){this.flags.timeout=t;return this}onAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.push(t);return this}prependAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.unshift(t);return this}offAny(t){if(!this._anyListeners){return this}if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyListeners=[]}return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.push(t);return this}prependAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.unshift(t);return this}offAnyOutgoing(t){if(!this._anyOutgoingListeners){return this}if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyOutgoingListeners=[]}return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e){i.apply(this,t.data)}}}}function hs(t){t=t||{};this.ms=t.min||100;this.max=t.max||1e4;this.factor=t.factor||2;this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0;this.attempts=0}hs.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random();var i=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-i:t+i}return Math.min(t,this.max)|0};hs.prototype.reset=function(){this.attempts=0};hs.prototype.setMin=function(t){this.ms=t};hs.prototype.setMax=function(t){this.max=t};hs.prototype.setJitter=function(t){this.jitter=t};class ds extends Je{constructor(t,e){var i;super();this.nsps={};this.subs=[];if(t&&"object"===typeof t){e=t;t=undefined}e=e||{};e.path=e.path||"/socket.io";this.opts=e;si(this,e);this.reconnection(e.reconnection!==false);this.reconnectionAttempts(e.reconnectionAttempts||Infinity);this.reconnectionDelay(e.reconnectionDelay||1e3);this.reconnectionDelayMax(e.reconnectionDelayMax||5e3);this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5);this.backoff=new hs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==e.timeout?2e4:e.timeout);this._readyState="closed";this.uri=t;const s=e.parser||rs;this.encoder=new s.Encoder;this.decoder=new s.Decoder;this._autoConnect=e.autoConnect!==false;if(this._autoConnect)this.open()}reconnection(t){if(!arguments.length)return this._reconnection;this._reconnection=!!t;return this}reconnectionAttempts(t){if(t===undefined)return this._reconnectionAttempts;this._reconnectionAttempts=t;return this}reconnectionDelay(t){var e;if(t===undefined)return this._reconnectionDelay;this._reconnectionDelay=t;(e=this.backoff)===null||e===void 0?void 0:e.setMin(t);return this}randomizationFactor(t){var e;if(t===undefined)return this._randomizationFactor;this._randomizationFactor=t;(e=this.backoff)===null||e===void 0?void 0:e.setJitter(t);return this}reconnectionDelayMax(t){var e;if(t===undefined)return this._reconnectionDelayMax;this._reconnectionDelayMax=t;(e=this.backoff)===null||e===void 0?void 0:e.setMax(t);return this}timeout(t){if(!arguments.length)return this._timeout;this._timeout=t;return this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new $i(this.uri,this.opts);const e=this.engine;const i=this;this._readyState="opening";this.skipReconnect=false;const s=as(e,"open",(function(){i.onopen();t&&t()}));const n=e=>{this.cleanup();this._readyState="closed";this.emitReserved("error",e);if(t){t(e)}else{this.maybeReconnectOnOpen()}};const o=as(e,"error",n);if(false!==this._timeout){const t=this._timeout;const i=this.setTimeoutFn((()=>{s();n(new Error("timeout"));e.close()}),t);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}this.subs.push(s);this.subs.push(o);return this}connect(t){return this.open(t)}onopen(){this.cleanup();this._readyState="open";this.emitReserved("open");const t=this.engine;this.subs.push(as(t,"ping",this.onping.bind(this)),as(t,"data",this.ondata.bind(this)),as(t,"error",this.onerror.bind(this)),as(t,"close",this.onclose.bind(this)),as(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){Ai((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];if(!i){i=new cs(this,t,e);this.nsps[t]=i}else if(this._autoConnect&&!i.active){i.connect()}return i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){const e=this.nsps[t];if(e.active){return}}this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++){this.engine.write(e[i],t.options)}}cleanup(){this.subs.forEach((t=>t()));this.subs.length=0;this.decoder.destroy()}_close(){this.skipReconnect=true;this._reconnecting=false;this.onclose("forced close");if(this.engine)this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup();this.backoff.reset();this._readyState="closed";this.emitReserved("close",t,e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts){this.backoff.reset();this.emitReserved("reconnect_failed");this._reconnecting=false}else{const e=this.backoff.duration();this._reconnecting=true;const i=this.setTimeoutFn((()=>{if(t.skipReconnect)return;this.emitReserved("reconnect_attempt",t.backoff.attempts);if(t.skipReconnect)return;t.open((e=>{if(e){t._reconnecting=false;t.reconnect();this.emitReserved("reconnect_error",e)}else{t.onreconnect()}}))}),e);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=false;this.backoff.reset();this.emitReserved("reconnect",t)}}const us={};function fs(t,e){if(typeof t==="object"){e=t;t=undefined}e=e||{};const i=Fi(t,e.path||"/socket.io");const s=i.source;const n=i.id;const o=i.path;const r=us[n]&&o in us[n]["nsps"];const a=e.forceNew||e["force new connection"]||false===e.multiplex||r;let l;if(a){l=new ds(s,e)}else{if(!us[n]){us[n]=new ds(s,e)}l=us[n]}if(i.query&&!e.query){e.query=i.queryKey}return l.socket(i.path,e)}Object.assign(fs,{Manager:ds,Socket:cs,io:fs,connect:fs});const ps=".sc-igloo-calendar-h{display:block;position:relative;background-color:#ffffff;height:100%;text-align:center}.igl-calendar.sc-igloo-calendar{display:grid;grid-template-columns:1fr;height:100%}.calendarScrollContainer.sc-igloo-calendar{width:100%;height:100%;overflow:auto;position:relative;white-space:nowrap;border-left:2px solid grey}.showToBeAssigned.sc-igloo-calendar,.showLegend.sc-igloo-calendar{grid-template-columns:330px 1fr}#calendarContainer.sc-igloo-calendar{position:absolute}.legendContainer.sc-igloo-calendar,.tobeAssignedContainer.sc-igloo-calendar{display:none;height:100%;overflow-y:auto;padding-left:0.5em !important;padding-right:0.5em !important}.showToBeAssigned.sc-igloo-calendar .tobeAssignedContainer.sc-igloo-calendar{display:block}.showLegend.sc-igloo-calendar .legendContainer.sc-igloo-calendar{display:block}.tobeBooked.sc-igloo-calendar{padding-top:8px;padding-bottom:8px;text-align:left}";const bs=ps;const gs=class{constructor(e){t(this,e);this.dragOverHighlightElement=s(this,"dragOverHighlightElement",7);this.moveBookingTo=s(this,"moveBookingTo",7);this.calculateUnassignedDates=s(this,"calculateUnassignedDates",7);this.reduceAvailableUnitEvent=s(this,"reduceAvailableUnitEvent",7);this.revertBooking=s(this,"revertBooking",7);this.bookingService=new l;this.roomService=new J;this.eventsService=new wt;this.toBeAssignedService=new Ft;this.countryNodeList=[];this.visibleCalendarCells={x:[],y:[]};this.today="";this.reachedEndOfCalendar=false;this.token=new Z;this.scrollViewDragPos={top:0,left:0,x:0,y:0};this.onScrollContentMoveHandler=t=>{if(t.buttons!==1){return}const e=t.clientX-this.scrollViewDragPos.x;const i=t.clientY-this.scrollViewDragPos.y;this.scrollContainer.scrollTop=this.scrollViewDragPos.top-i;this.scrollContainer.scrollLeft=this.scrollViewDragPos.left-e;if(Math.abs(e)>5||Math.abs(i)>5){this.scrollViewDragging=true}};this.onScrollContentMoveEndHandler=()=>{document.removeEventListener("mousemove",this.onScrollContentMoveHandler);document.removeEventListener("mouseup",this.onScrollContentMoveEndHandler)};this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.language=undefined;this.loadingMessage=undefined;this.currencyName=undefined;this.ticket="";this.p=undefined;this.calendarData=new Object;this.property_id=undefined;this.days=new Array;this.scrollViewDragging=false;this.dialogData=null;this.bookingItem=null;this.editBookingItem=null;this.showLegend=false;this.showPaymentDetails=false;this.showToBeAssigned=false;this.unassignedDates={};this.roomNightsData=null;this.renderAgain=false;this.showBookProperty=false;this.totalAvailabilityQueue=[];this.highlightedDate=undefined;this.calDates=undefined;this.isAuthenticated=false}componentWillLoad(){this.init()}componentDidLoad(){this.scrollToElement(this.today)}async handleDeleteEvent(t){try{t.stopImmediatePropagation();t.preventDefault();await this.eventsService.deleteEvent(t.detail)}catch(t){}}scrollPageToRoom(t){let e=t.detail.refClass;this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const i=this.element.querySelector(".topLeftCell");const s=this.element.querySelector("."+e);if(s){this.scrollContainer.scrollTo({top:0});const t=s.getBoundingClientRect();const e=this.scrollContainer.getBoundingClientRect();const n=i.getBoundingClientRect();this.scrollContainer.scrollTo({top:t.top-e.top-n.height-t.height})}}handleShowDialog(t){var e;t.stopImmediatePropagation();t.stopPropagation();this.dialogData=t.detail;(e=this.calendarModalEl)===null||e===void 0?void 0:e.openModal()}handleShowRoomNightsDialog(t){this.roomNightsData=t.detail}handleBookingDatasChange(t){t.stopPropagation();t.stopImmediatePropagation();let e=[...this.calendarData.bookingEvents];e=e.filter((t=>t.ID!=="NEW_TEMP_EVENT"));e.push(...t.detail.filter((t=>t.STATUS==="PENDING-CONFIRMATION")));this.updateBookingEventsDateRange(t.detail);this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:e})}handleUpdateBookingEvent(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.detail;this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((t=>{if(e.ID===t.ID){return e}return t}))})}showBookingPopupEventDataHandler(t){t.preventDefault();t.stopImmediatePropagation();this.onOptionSelect(t)}updateEventDataHandler(t){let e=this.calendarData.bookingEvents.find((e=>e.id===t.detail.id));if(e&&t.detail&&t.detail.data){Object.entries(t.detail.data).forEach((([t,i])=>{e[t]=i}))}}dragOverEventDataHandler(t){if(t.detail.id==="CALCULATE_DRAG_OVER_BOUNDS"){let e=document.querySelector("igl-cal-header .topLeftCell");let i=document.querySelectorAll(".headersContainer .headerCell");let s=document.querySelectorAll(".bodyContainer .roomRow .roomTitle");this.visibleCalendarCells={x:[],y:[]};i.forEach((t=>{const i=t;this.visibleCalendarCells.x.push({left:i.offsetLeft+e.offsetWidth,width:i.offsetWidth,id:i.getAttribute("data-day")})}));s.forEach((t=>{const e=t;this.visibleCalendarCells.y.push({top:e.offsetTop,height:e.offsetHeight,id:e.getAttribute("data-room")})}));this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER"){this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER_END"){this.highlightDragOver(false,t.detail.data)}else if(t.detail.id==="STRETCH_OVER_END"){this.highlightDragOver(false,t.detail.data)}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}init(){this.calDates={from:this.from_date,to:this.to_date};if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}this.calDates={from:this.from_date,to:this.to_date};Vt("unassigned_dates",(t=>{if(Object.keys(t).length===0&&this.highlightedDate!==""){this.highlightedDate=""}}))}renderModalBody(){var t,e;switch((t=this.dialogData)===null||t===void 0?void 0:t.reason){case"checkin":{return`Are you sure you want to Check In this unit?`}case"checkout":{return"Are you sure you want to Check Out this unit?"}case"reallocate":return((e=this.dialogData)===null||e===void 0?void 0:e.description)||"";default:return"Unknown modal content"}}setUpCalendarData(t,e){console.log(t);this.calendarData.currency=t["My_Result"].currency;this.calendarData.allowedBookingSources=t["My_Result"].allowed_booking_sources;this.calendarData.adultChildConstraints=t["My_Result"].adult_child_constraints;console.log(this.calendarData.allowedBookingSources);this.calendarData.legendData=this.getLegendData(t);this.calendarData.is_vacation_rental=t["My_Result"].is_vacation_rental;this.calendarData.from_date=e.My_Params_Get_Rooming_Data.FROM;this.calendarData.to_date=e.My_Params_Get_Rooming_Data.TO;this.calendarData.startingDate=new Date(e.My_Params_Get_Rooming_Data.FROM).getTime();this.calendarData.endingDate=new Date(e.My_Params_Get_Rooming_Data.TO).getTime();this.calendarData.formattedLegendData=O(this.calendarData.legendData);let i=e.myBookings||[];i=i.filter((t=>{const e=U(t.TO_DATE,"YYYY-MM-DD");const i=U(t.FROM_DATE,"YYYY-MM-DD");return!e.isSame(i)}));this.calendarData.bookingEvents=i;this.calendarData.toBeAssignedEvents=[]}async initializeApp(){try{let t=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}let e=null;if(!t){console.log(t);const i=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});e=i;t=i.My_Result.id}this.property_id=t;const i=[this.bookingService.getCalendarData(t,this.from_date,this.to_date),this.bookingService.getCountries(this.language),this.roomService.fetchLanguage(this.language)];if(this.propertyid){i.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true}))}const s=await Promise.all(i);if(!e){e=s[s.length-1]}const[n,o]=s;z.days=n.days;z.months=n.months;this.setRoomsData(e);this.countryNodeList=o;this.setUpCalendarData(e,n);let r=e["My_Result"]["allowed_payment_methods"];this.showPaymentDetails=r.some((t=>t.code==="001"||t.code==="004"));this.updateBookingEventsDateRange(this.calendarData.bookingEvents);this.updateBookingEventsDateRange(this.calendarData.toBeAssignedEvents);this.today=this.transformDateForScroll(new Date);let a=new Date(this.calendarData.startingDate);a.setHours(0,0,0,0);this.days=n.days;this.calendarData.days=this.days;this.calendarData.monthsInfo=n.months;z.fromDate=this.calendarData.from_date;z.toDate=this.calendarData.to_date;setTimeout((()=>{this.scrollToElement(this.today)}),200);if(!this.calendarData.is_vacation_rental){const t=await this.toBeAssignedService.getUnassignedDates(this.property_id,k(new Date),this.to_date);this.unassignedDates={fromDate:this.from_date,toDate:this.to_date,data:Object.assign(Object.assign({},this.unassignedDates),t)};this.calendarData=Object.assign(Object.assign({},this.calendarData),{unassignedDates:t});Ut(t)}this.socket=fs("https://realtime.igloorooms.com/");this.socket.on("MSG",(async t=>{await this.handleSocketMessage(t)}))}catch(t){console.error("Initializing Calendar Error",t)}}async handleSocketMessage(t){const e=JSON.parse(t);if(!e){return}const{REASON:i,KEY:s,PAYLOAD:n}=e;if(s.toString()!==this.property_id.toString()){return}let o;if(["DELETE_CALENDAR_POOL","GET_UNASSIGNED_DATES"].includes(i)){o=n}else{o=JSON.parse(n)}console.log(s,o);const r={DORESERVATION:this.handleDoReservation,BLOCK_EXPOSED_UNIT:this.handleBlockExposedUnit,ASSIGN_EXPOSED_ROOM:this.handleAssignExposedRoom,REALLOCATE_EXPOSED_ROOM_BLOCK:this.handleReallocateExposedRoomBlock,DELETE_CALENDAR_POOL:this.handleDeleteCalendarPool,GET_UNASSIGNED_DATES:this.handleGetUnassignedDates,UPDATE_CALENDAR_AVAILABILITY:this.handleUpdateCalendarAvailability,CHANGE_IN_DUE_AMOUNT:this.handleChangeInDueAmount,CHANGE_IN_BOOK_STATUS:this.handleChangeInBookStatus,NON_TECHNICAL_CHANGE_IN_BOOKING:this.handleNonTechnicalChangeInBooking,ROOM_STATUS_CHANGED:this.handleRoomStatusChanged,UNIT_HK_STATUS_CHANGED:this.handleUnitHKStatusChanged};const a=r[i];if(a){await a.call(this,o)}else{console.warn(`Unhandled REASON: ${i}`)}}handleRoomStatusChanged(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((e=>{if(e.IDENTIFIER===t.room_identifier){return Object.assign(Object.assign({},e),{CHECKIN:t.status==="001",CHECKOUT:t.status==="002",STATUS:F[t.status==="001"?"000":"003"]})}return e}))]})}handleUnitHKStatusChanged(t){console.log("hk unit change",t);const e=[...this.calendarData.roomsInfo];const i=e.findIndex((e=>e.id===t.ROOM_CATEGORY_ID));if(i!==-1){const s=Object.assign({},e[i]);const n=s.physicalrooms.findIndex((e=>e.id===t.PR_ID));if(n!==-1){const o=[...s.physicalrooms];const r=Object.assign({},o[n]);r.hk_status=t.HKS_CODE;o[n]=r;s.physicalrooms=o;e[i]=s;this.calendarData=Object.assign(Object.assign({},this.calendarData),{roomsInfo:e})}}}async handleDoReservation(t){const e=R(t);this.AddOrUpdateRoomBookings(e)}async handleBlockExposedUnit(t){const e=[await P(t)];this.AddOrUpdateRoomBookings(e)}async handleAssignExposedRoom(t){console.log(t);const e=R(t);this.AddOrUpdateRoomBookings(e)}async handleReallocateExposedRoomBlock(t){await this.handleBlockExposedUnit(t)}async handleDeleteCalendarPool(t){console.log("delete calendar pool");this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.filter((e=>e.POOL!==t))})}async handleGetUnassignedDates(t){const e=this.parseDateRange(t);if(!this.calendarData.is_vacation_rental&&new Date(e.FROM_DATE).getTime()>=this.calendarData.startingDate&&new Date(e.TO_DATE).getTime()<=this.calendarData.endingDate){const t=await this.toBeAssignedService.getUnassignedDates(this.property_id,k(new Date(e.FROM_DATE)),k(new Date(e.TO_DATE)));Ut(t);this.unassignedDates={fromDate:k(new Date(e.FROM_DATE)),toDate:k(new Date(e.TO_DATE)),data:t};if(Object.keys(t).length===0){Kt(k(new Date(e.FROM_DATE)),k(new Date(e.TO_DATE)));this.reduceAvailableUnitEvent.emit({fromDate:k(new Date(e.FROM_DATE)),toDate:k(new Date(e.TO_DATE))})}}}parseDateRange(t){const e={};const i=t.split("|");i.forEach((t=>{const i=t.split(":");e[i[0]]=i[1]}));return e}handleUpdateCalendarAvailability(t){this.totalAvailabilityQueue.push(t);if(this.totalAvailabilityQueue.length>0){clearTimeout(this.availabilityTimeout)}this.availabilityTimeout=setTimeout((()=>{this.updateTotalAvailability()}),1e3)}handleChangeInDueAmount(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(t.pools.includes(e.ID)){return Object.assign(Object.assign({},e),{BALANCE:t.due_amount})}return e}))})}handleChangeInBookStatus(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(t.pools.includes(e.ID)){return Object.assign(Object.assign({},e),{STATUS:e.STATUS!=="IN-HOUSE"?F[t.status_code]:t.status_code==="001"?F[t.status_code]:"IN-HOUSE"})}return e}))})}handleNonTechnicalChangeInBooking(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(e.BOOKING_NUMBER===t.booking_nbr){return Object.assign(Object.assign({},e),{PRIVATE_NOTE:H(t.extras)})}return e}))})}checkBookingAvailability(t){return this.calendarData.bookingEvents.some((e=>e.ID===t.ID||e.FROM_DATE===t.FROM_DATE&&e.TO_DATE===t.TO_DATE&&e.PR_ID===t.PR_ID))}updateBookingEventsDateRange(t){const e=U();t.forEach((t=>{t.legendData=this.calendarData.formattedLegendData;t.defaultDateRange={};t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=this.getDateStr(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=this.getDateStr(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS;t.roomsInfo=[...this.calendarData.roomsInfo];if(!w(t.STATUS_CODE)){if(g.checkin_enabled){if(t.CHECKOUT){t.STATUS=F["003"]}if(t.CHECKIN){t.STATUS=F["000"]}}else{const i=U(t.TO_DATE,"YYYY-MM-DD");const s=U(t.FROM_DATE,"YYYY-MM-DD");if(t.STATUS!=="PENDING"){if(s.isSame(e,"day")&&e.hour()>=12){t.STATUS=F["000"]}else if(e.isAfter(s,"day")&&e.isBefore(i,"day")){t.STATUS=F["000"]}else if(i.isSame(e,"day")&&e.hour()<12){t.STATUS=F["000"]}else if(i.isSame(e,"day")&&e.hour()>=12||i.isBefore(e,"day")){t.STATUS=F["003"]}}}}}))}updateTotalAvailability(){let t=[...z.days];this.totalAvailabilityQueue.forEach((e=>{let i=new Date(e.date);i.setMilliseconds(0);i.setSeconds(0);i.setMinutes(0);i.setHours(0);const s=t.findIndex((t=>t.currentDate===i.getTime()));if(s!=-1){const i=t[s].rate.findIndex((t=>t.id===e.room_type_id));if(i!=-1){t[s].rate[i].exposed_inventory.rts=e.availability}}}));z.days=[...t]}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}g.roomsInfo=s;this.calendarData.roomsInfo=s}getLegendData(t){return t["My_Result"].calendar_legends}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}scrollToElement(t){this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const e=this.element.querySelector(".topLeftCell");const i=this.element.querySelector(".day-"+t);if(i){this.scrollContainer.scrollTo({left:0});const t=i.getBoundingClientRect();const s=this.scrollContainer.getBoundingClientRect();const n=e.getBoundingClientRect();this.scrollContainer.scrollTo({left:t.left-s.left-n.width-t.width})}}AddOrUpdateRoomBookings(t,e=undefined){let i=[...this.calendarData.bookingEvents];t.forEach((t=>{if(!this.checkBookingAvailability(t)){i=i.filter((e=>e.ID!==t.ID))}}));this.updateBookingEventsDateRange(t);if(e){i=i.filter((t=>t.POOL===e))}t.forEach((t=>{if(!i.some((e=>e.ID===t.ID))){i.push(t)}}));this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:i})}transformDateForScroll(t){return U(t).format("D_M_YYYY")}shouldRenderCalendarView(){return this.calendarData&&this.calendarData.days&&this.calendarData.days.length}onOptionSelect(t){const e=t.detail;const i=this.element.querySelector("#iglooCalendar");switch(e.key){case"showAssigned":i.classList.remove("showLegend");i.classList.remove("showToBeAssigned");i.classList.toggle("showToBeAssigned");this.showLegend=false;this.showToBeAssigned=true;break;case"showLegend":i.classList.remove("showToBeAssigned");i.classList.remove("showLegend");i.classList.toggle("showLegend");this.showLegend=true;this.showToBeAssigned=false;break;case"calendar":let t=new Date;if(e.data.start!==undefined&&e.data.end!==undefined){t=e.data.start.toDate();this.handleDateSearch(e.data)}else{t=new Date(e.data);t.setDate(t.getDate()+1);if(!(e===null||e===void 0?void 0:e.noScroll)){this.scrollToElement(t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear())}}this.highlightedDate=this.transformDateForScroll(t);break;case"search":break;case"add":if(e.data.event_type!=="EDIT_BOOKING"){this.bookingItem=e.data}else{this.editBookingItem=e.data}break;case"gotoToday":this.scrollToElement(this.today);break;case"closeSideMenu":this.closeSideMenu();this.highlightedDate="";this.showBookProperty=false;break}}async addDatesToCalendar(t,e){const i=await this.bookingService.getCalendarData(this.property_id,t,e);const s=i.myBookings||[];this.updateBookingEventsDateRange(s);if(new Date(t).getTime()<new Date(this.calendarData.startingDate).getTime()){this.calendarData.startingDate=new Date(t).getTime();this.calendarData.from_date=t;z.fromDate=this.calendarData.from_date;this.days=[...i.days,...this.days];let e=[...i.months];if(this.calendarData.monthsInfo[0].monthName===i.months[i.months.length-1].monthName){this.calendarData.monthsInfo[0].daysCount=this.calendarData.monthsInfo[0].daysCount+i.months[i.months.length-1].daysCount;e.pop()}let n=JSON.parse(JSON.stringify(s));n=n.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].FROM_DATE=t.FROM_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=j(t.FROM_DATE,this.calendarData.bookingEvents[e].TO_DATE);return false}return true}));z.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...e,...this.calendarData.monthsInfo],bookingEvents:[...this.calendarData.bookingEvents,...n]})}else{this.calendarData.endingDate=new Date(e).getTime();this.calendarData.to_date=e;z.toDate=this.calendarData.to_date;let n=[...i.months];this.days=[...this.days,...i.days];if(this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].monthName===i.months[0].monthName){this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount=this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount+i.months[0].daysCount;n.shift()}let o=JSON.parse(JSON.stringify(s));o=o.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].TO_DATE=t.TO_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=j(this.calendarData.bookingEvents[e].FROM_DATE,t.TO_DATE);return false}return true}));z.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...this.calendarData.monthsInfo,...n],bookingEvents:[...this.calendarData.bookingEvents,...o]});const r=await this.toBeAssignedService.getUnassignedDates(this.property_id,t,e);this.calendarData.unassignedDates=Object.assign(Object.assign({},this.calendarData.unassignedDates),r);this.unassignedDates={fromDate:t,toDate:e,data:r};Ut(r)}}async handleDateSearch(t){const e=U(t.start).toDate();const i=U(this.calDates.from).toDate();const s=t.end.toDate();const n=this.calendarData.endingDate;if(e.getTime()<new Date(this.calDates.from).getTime()){await this.addDatesToCalendar(U(e).add(-1,"days").format("YYYY-MM-DD"),U(i).add(-1,"days").format("YYYY-MM-DD"));this.calDates=Object.assign(Object.assign({},this.calDates),{from:t.start.add(-1,"days").format("YYYY-MM-DD")});this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>i.getTime()&&e.getTime()<n&&s.getTime()<n){this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>n){const t=E(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(t,U(s).add(2,"months").format("YYYY-MM-DD"));this.scrollToElement(this.transformDateForScroll(e))}}closeSideMenu(){const t=this.element.querySelector("#iglooCalendar");t.classList.remove("showToBeAssigned");t.classList.remove("showLegend");this.showLegend=false;this.showToBeAssigned=false}dragScrollContent(t){this.scrollViewDragging=false;let e=t&&t.target?this.hasAncestorWithClass(t.target,"preventPageScroll"):false;if(!e&&t.buttons===1){this.scrollViewDragPos={left:this.scrollContainer.scrollLeft,top:this.scrollContainer.scrollTop,x:t.clientX,y:t.clientY};document.addEventListener("mousemove",this.onScrollContentMoveHandler);document.addEventListener("mouseup",this.onScrollContentMoveEndHandler)}}calendarScrolling(){if(this.scrollContainer){if(this.highlightedDate){const t=document.querySelector(`.day-${this.highlightedDate}`);if(t){const{left:e,right:i}=t.getBoundingClientRect();const s=e>=0&&i<=window.innerWidth;if(!s){this.highlightedDate=""}}}const t=this.scrollContainer.getBoundingClientRect();let e=170;let i=t.width-e;let s=t.x+e;let n=t.x+t.width;let o=Array.from(this.element.querySelectorAll(".monthCell"));if(o.length){o.map((async t=>{let e=t.getBoundingClientRect();if(o.indexOf(t)===o.length-1){if(e.x+e.width<=n&&!this.reachedEndOfCalendar){this.reachedEndOfCalendar=true;const t=A(new Date(this.calendarData.endingDate));const e=E(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(e,t);this.reachedEndOfCalendar=false}}if(e.x+e.width<s);else if(e.x>n);else{let o=t.querySelector(".monthTitle");let r=0;let a=e.width;if(e.x<s){r=Math.abs(e.x)-s;r=e.x<0?Math.abs(e.x)+s:Math.abs(r);a=e.x+e.width>n?i:e.x+e.width-s}else{a=i-a>a?a:i-e.x+s}o.style.marginLeft=r+"px";o.style.width=a+"px"}}))}}}hasAncestorWithClass(t,e){let i=t;while(i!==null){if(i.matches(`.${e}`)){return true}i=i.parentElement}return false}async highlightDragOver(t,e){let i,s;if(e){i=this.visibleCalendarCells.x.find((t=>t.left<e.x&&e.x<=t.left+t.width));s=this.visibleCalendarCells.y.find((t=>t.top<e.y&&e.y<=t.top+t.height))}if(t&&i&&s){this.dragOverHighlightElement.emit({dragOverElement:s.id+"_"+i.id})}else{this.dragOverHighlightElement.emit({dragOverElement:""})}if(!t){this.moveBookingTo.emit({bookingId:e.id,fromRoomId:e.fromRoomId,toRoomId:s&&s.id||"revert",moveToDay:i&&i.id||"revert",pool:e.pool,from_date:B(i&&i.id),to_date:M(i&&i.id,e.nbOfDays)})}}handleModalConfirm(){var t;const e=()=>{this.dialogData=null};try{switch((t=this.dialogData)===null||t===void 0?void 0:t.reason){case"checkin":case"checkout":{const{bookingNumber:t,roomIdentifier:i}=this.dialogData;const s=this.dialogData.reason==="checkin"?"001":"002";this.bookingService.handleExposedRoomInOut({booking_nbr:t,room_identifier:i,status:s}).finally(e);break}case"reallocate":{if(!this.dialogData){console.warn("No dialog data available for reallocation.");return}const{pool:t,toRoomId:i,from_date:s,to_date:n}=this.dialogData;this.eventsService.reallocateEvent(t,i,s,n).then(e).catch((()=>{console.error("Reallocation failed. Reverting booking.");this.revertBooking.emit(t)})).finally(e);break}default:e();break}}catch(t){console.error("Error handling modal confirm:",t);e()}}handleModalCancel(){var t;if(((t=this.dialogData)===null||t===void 0?void 0:t.reason)==="reallocate"){this.revertBooking.emit(this.dialogData.pool)}this.dialogData=null}handleRoomNightsDialogClose(t){if(t.detail.type==="cancel"){this.revertBooking.emit(this.roomNightsData.pool)}this.roomNightsData=null}handleSideBarToggle(t){var e;if(t.detail){if(this.editBookingItem){this.editBookingItem=null}if(this.roomNightsData){this.revertBooking.emit(this.roomNightsData.pool);this.roomNightsData=null}if(((e=this.dialogData)===null||e===void 0?void 0:e.reason)==="reallocate"){this.revertBooking.emit(this.dialogData.pool);this.dialogData=null}}}handleCloseBookingWindow(){this.bookingItem=null}render(){var t,s,n;return e(i,{key:"ae1625bd334541c40cb740999fcee48b875abd5a"},e("ir-toast",{key:"b7ea75abaa7cd4d695e55f1e2156d61badbeaf37"}),e("ir-interceptor",{key:"55df4aeeefe6d1d4ab7888cb56d46c4f43fd0bbf"}),e("div",{key:"8821d628d3d105d909c4ada0caff6f5657adb076",id:"iglooCalendar",class:"igl-calendar"},this.shouldRenderCalendarView()?[this.showToBeAssigned?e("igl-to-be-assigned",{unassignedDatesProp:this.unassignedDates,to_date:this.to_date,from_date:this.from_date,propertyid:this.property_id,class:"tobeAssignedContainer",calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)}):null,this.showLegend?e("igl-legends",{class:"legendContainer",legendData:this.calendarData.legendData,onOptionEvent:t=>this.onOptionSelect(t)}):null,e("div",{class:"calendarScrollContainer",onMouseDown:t=>this.dragScrollContent(t),onScroll:()=>this.calendarScrolling()},e("div",{id:"calendarContainer"},e("igl-cal-header",{unassignedDates:this.unassignedDates,to_date:this.to_date,propertyid:this.property_id,today:this.today,calendarData:this.calendarData,highlightedDate:this.highlightedDate,onOptionEvent:t=>this.onOptionSelect(t)}),e("igl-cal-body",{propertyId:this.property_id,language:this.language,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,today:this.today,highlightedDate:this.highlightedDate,isScrollViewDragging:this.scrollViewDragging,calendarData:this.calendarData}),e("igl-cal-footer",{highlightedDate:this.highlightedDate,today:this.today,calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)})))]:e("ir-loading-screen",{message:"Preparing Calendar Data"})),this.bookingItem&&e("igl-book-property",{key:"fc6770993c33b569f09baaf95f1b17f8ef4eec45",allowedBookingSources:this.calendarData.allowedBookingSources,adultChildConstraints:this.calendarData.adultChildConstraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.property_id,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}),e("ir-sidebar",{key:"9a65afb427168cf192d325e16f2ca0c90d8f06bd",onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:this.roomNightsData!==null||this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING",showCloseButton:false,sidebarStyles:{width:this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:this.roomNightsData?"white":"#F2F3F8"}},this.roomNightsData&&e("ir-room-nights",{key:"e95668f47386ab6acd417e94a50cd9f077dab615",slot:"sidebar-body",pool:this.roomNightsData.pool,onCloseRoomNightsDialog:this.handleRoomNightsDialogClose.bind(this),language:this.language,bookingNumber:this.roomNightsData.bookingNumber,identifier:this.roomNightsData.identifier,toDate:this.roomNightsData.to_date,fromDate:this.roomNightsData.from_date,defaultDates:this.roomNightsData.defaultDates,ticket:this.ticket,propertyId:this.property_id}),this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING"&&e("ir-booking-details",{key:"e4e02e1d97e196a5ec6eb0c4dc24d5d8f3e58a49",slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:()=>this.editBookingItem=null,is_from_front_desk:true,propertyid:this.property_id,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.editBookingItem.BOOKING_NUMBER,ticket:this.ticket,language:this.language,hasRoomAdd:true})),e("ir-modal",{key:"2c1d9a5dfcc764d31ded936e47e5be37e40bf131",ref:t=>this.calendarModalEl=t,modalTitle:"",rightBtnActive:((t=this.dialogData)===null||t===void 0?void 0:t.reason)==="reallocate"?!this.dialogData.hideConfirmButton:true,leftBtnText:(s=p===null||p===void 0?void 0:p.entries)===null||s===void 0?void 0:s.Lcz_Cancel,rightBtnText:(n=p===null||p===void 0?void 0:p.entries)===null||n===void 0?void 0:n.Lcz_Confirm,modalBody:this.renderModalBody(),onConfirmModal:this.handleModalConfirm.bind(this),onCancelModal:this.handleModalCancel.bind(this)}))}get element(){return o(this)}static get watchers(){return{ticket:["ticketChanged"]}}};gs.style=bs;const ms=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const vs=ms;const ys=class{constructor(e){t(this,e);this.comboboxValue=s(this,"comboboxValue",7);this.inputCleared=s(this,"inputCleared",7);this.toast=s(this,"toast",7);this.bookingService=new l;this.no_result_found="";this.duration=300;this.placeholder="";this.propertyId=undefined;this.isSplitBooking=false;this.type="text";this.name="";this.inputId=L();this.required=false;this.disabled=false;this.value=undefined;this.from_date="";this.to_date="";this.danger_border=undefined;this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputFocused=false}componentWillLoad(){this.no_result_found=p.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const n=t+s;const o=n*this.selectedIndex;let r=o-e/2+t/2;r=Math.max(0,Math.min(r,i.scrollHeight-e));i.scrollTo({top:r,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return e("div",{class:`position-absolute border rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,i)=>e("p",{role:"button",onKeyDown:t=>this.handleItemKeyDown(t,i),"data-selected":this.selectedIndex===i,tabIndex:0,onClick:()=>this.selectItem(i)},this.isSplitBooking?e(n,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):e("div",{class:"d-flex align-items-center flex-fill"},e("p",{class:"p-0 m-0"},`${t.email}`," ",e("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&e("div",{class:"loader-container d-flex align-items-center justify-content-center"},e("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&e("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return e(i,{key:"8fa8663f91709dbdcfc4f223a98a9abb4a8bd139"},e("div",{key:"18abf531825f7e90625c1047371cc634032fcff9",class:"d-flex align-items-center "},e("label",{key:"4f37cc692ab0fff05a1ff3f197e40c99855b5287","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},e("svg",{key:"8be77f87625f28f9c7370c79a500513f878fddd3",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},e("path",{key:"ba0940e70732ae105978769a9baf75bd368d099c",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),e("input",{key:"1cedb6fcd624e95ca6f9ee597d540d931d212bbc",required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),autoComplete:"none",onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&e("button",{key:"09948123d0b019d5e5849568471e59063e25b564",type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},e("p",{key:"def2132d6affe64f16321cbeea193e7960a100e3",class:"sr-only"},"clear input"),e("svg",{key:"6415c9973734ec556be65978b0445694e6c0a81e",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e("path",{key:"0b8043a42845fae748a8ae41e0df56985ecd9704",d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return o(this)}};ys.style=vs;const ks=".sc-ir-booking-details-h{overflow-x:hidden;--ir-dialog-max-width:20rem}.sc-ir-booking-details-h *.sc-ir-booking-details{font-family:inherit !important}.font-medium.sc-ir-booking-details{font-weight:600}.sc-ir-booking-details-h th.sc-ir-booking-details{font-weight:600}.h-28.sc-ir-booking-details{height:2rem}.mx-01.sc-ir-booking-details{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}.date-margin.sc-ir-booking-details{margin-right:5px}.pickup-margin.sc-ir-booking-details{margin-bottom:7px !important}.header-date.sc-ir-booking-details{padding-left:5px !important}.pointer.sc-ir-booking-details{cursor:pointer}.sc-ir-booking-details:root{--sidebar-width:50rem}.loading-container.sc-ir-booking-details{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.sm-padding-right.sc-ir-booking-details{padding-right:0.2rem}.sm-padding-left.sc-ir-booking-details{padding-left:0.2rem}.sm-padding-top.sc-ir-booking-details{padding-top:0.2rem}.sm-padding-bottom.sc-ir-booking-details{padding-bottom:0.2rem}.info-notes.sc-ir-booking-details{list-style:none;padding-left:0}.light-blue-bg.sc-ir-booking-details{background-color:#acecff;padding:0.2rem 0.3rem}.iframeHeight.sc-ir-booking-details{height:17.5rem}.dialog-title.sc-ir-booking-details{width:fit-content}";const ws=ks;const xs=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.bookingChanged=s(this,"bookingChanged",7);this.closeSidebar=s(this,"closeSidebar",7);this.bookingService=new l;this.roomService=new J;this.paymentService=new Q;this.token=new Z;this.printingBaseUrl="https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2";this.language="en";this.ticket="";this.bookingNumber="";this.propertyid=undefined;this.is_from_front_desk=false;this.p=undefined;this.hasPrint=false;this.hasReceipt=false;this.hasDelete=false;this.hasMenu=false;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.hasCloseButton=false;this.bookingItem=null;this.statusData=[];this.showPaymentDetails=undefined;this.booking=undefined;this.countries=undefined;this.calendarData={};this.guestData=null;this.rerenderFlag=false;this.sidebarState=null;this.sidebarPayload=undefined;this.isUpdateClicked=false;this.pms_status=undefined;this.isPMSLogLoading=false;this.paymentActions=undefined;this.property_id=undefined;this.selectedService=undefined;this.bedPreference=undefined;this.roomGuest=undefined}componentWillLoad(){if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}handleSideBarEvents(t){this.sidebarState=t.detail.type;this.sidebarPayload=t.detail.payload}handleIconClick(t){const e=t.target;switch(e.id){case"pickup":this.sidebarState="pickup";return;case"close":this.closeSidebar.emit(null);return;case"print":this.openPrintingScreen();return;case"receipt":this.openPrintingScreen("invoice");return;case"book-delete":return;case"menu":window.location.href="https://x.igloorooms.com/manage/acbookinglist.aspx";return;case"room-add":this.bookingItem={ID:"",NAME:this.booking.guest.last_name,EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,ARRIVAL:this.booking.arrival,TO_DATE:this.booking.to_date,TITLE:`${p.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,defaultDateRange:{fromDate:new Date(this.booking.from_date),fromDateStr:"",toDate:new Date(this.booking.to_date),toDateStr:"",dateDifference:0,message:""},event_type:"ADD_ROOM",booking:this.booking,BOOKING_NUMBER:this.booking.booking_nbr,ADD_ROOM_TO_BOOKING:this.booking.booking_nbr,GUEST:this.booking.guest,message:this.booking.remark,SOURCE:this.booking.source,ROOMS:this.booking.rooms};return;case"extra_service_btn":this.sidebarState="extra_service";return;case"add-payment":return}}async handleResetExposedCancellationDueAmount(t){t.stopImmediatePropagation();t.stopPropagation();const e=await this.paymentService.GetExposedCancellationDueAmount({booking_nbr:this.booking.booking_nbr,currency_id:this.booking.currency.id});this.paymentActions=[...e]}handleEditInitiated(t){this.bookingItem=t.detail}async handleResetBooking(t){t.stopPropagation();t.stopImmediatePropagation();if(t.detail){return this.booking=t.detail}await this.resetBooking()}handleEditExtraService(t){this.selectedService=t.detail;this.sidebarState="extra_service"}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){var t,e;try{const[i,s,n,o,r]=await Promise.all([this.roomService.getExposedProperty({id:this.propertyid||0,language:this.language,aname:this.p}),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language),this.bookingService.getExposedBooking(this.bookingNumber,this.language),this.bookingService.getSetupEntriesByTableName("_BED_PREFERENCE_TYPE")]);this.property_id=(t=i===null||i===void 0?void 0:i.My_Result)===null||t===void 0?void 0:t.id;this.bedPreference=r;if((o===null||o===void 0?void 0:o.booking_nbr)&&((e=o===null||o===void 0?void 0:o.currency)===null||e===void 0?void 0:e.id)&&o.is_direct){this.paymentService.GetExposedCancellationDueAmount({booking_nbr:o.booking_nbr,currency_id:o.currency.id}).then((t=>{this.paymentActions=t}))}if(!(p===null||p===void 0?void 0:p.entries)){p.entries=s.entries;p.direction=s.direction}this.countries=n;const a=i===null||i===void 0?void 0:i.My_Result;if(a){const{allowed_payment_methods:t,currency:e,allowed_booking_sources:s,adult_child_constraints:n,calendar_legends:o,aname:r}=a;this.printingBaseUrl=this.printingBaseUrl.replace("%1",r).replace("%2",this.bookingNumber);this.calendarData={currency:e,allowed_booking_sources:s,adult_child_constraints:n,legendData:o};this.setRoomsData(i);const l=["001","004"];this.showPaymentDetails=t===null||t===void 0?void 0:t.some((t=>l.includes(t.code)))}else{console.warn("Room response is missing 'My_Result'.")}this.guestData=o.guest;this.booking=o}catch(t){console.error("Error initializing app:",t)}}async openPrintingScreen(t="print",e="new"){if(e==="old"){if(t==="invoice"){return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`)}return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`)}let i=this.printingBaseUrl;if(t==="invoice"){i=i+"&mode=invoice"}const{data:s}=await W.post(`Get_ShortLiving_Token`);if(!s.ExceptionMsg){i=i+`&token=${s.My_Result}`}window.open(i)}handleCloseBookingWindow(){this.bookingItem=null}handleDeleteFinish(t){this.booking=Object.assign(Object.assign({},this.booking),{rooms:this.booking.rooms.filter((e=>e.identifier!==t.detail))})}async resetBooking(){try{const t=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);this.booking=Object.assign({},t);this.bookingChanged.emit(this.booking)}catch(t){console.log(t)}}renderSidebarContent(){var t,i,s,n,o,r;const a=()=>{this.sidebarState=null};switch(this.sidebarState){case"guest":return e("ir-guest-info",{isInSideBar:true,headerShown:true,slot:"sidebar-body",booking_nbr:this.bookingNumber,email:(t=this.booking)===null||t===void 0?void 0:t.guest.email,language:this.language,onCloseSideBar:a});case"pickup":return e("ir-pickup",{slot:"sidebar-body",defaultPickupData:this.booking.pickup_info,bookingNumber:this.booking.booking_nbr,numberOfPersons:this.booking.occupancy.adult_nbr+this.booking.occupancy.children_nbr,onCloseModal:a});case"extra_note":return e("ir-booking-extra-note",{slot:"sidebar-body",booking:this.booking,onCloseModal:()=>this.sidebarState=null});case"extra_service":return e("ir-extra-service-config",{service:this.selectedService,booking:{from_date:this.booking.from_date,to_date:this.booking.to_date,booking_nbr:this.booking.booking_nbr,currency:this.booking.currency},slot:"sidebar-body",onCloseModal:()=>{a();if(this.selectedService){this.selectedService=null}}});case"room-guest":return e("ir-room-guests",{countries:this.countries,language:this.language,identifier:(i=this.sidebarPayload)===null||i===void 0?void 0:i.identifier,bookingNumber:this.booking.booking_nbr,roomName:(s=this.sidebarPayload)===null||s===void 0?void 0:s.roomName,totalGuests:(n=this.sidebarPayload)===null||n===void 0?void 0:n.totalGuests,sharedPersons:(o=this.sidebarPayload)===null||o===void 0?void 0:o.sharing_persons,slot:"sidebar-body",checkIn:(r=this.sidebarPayload)===null||r===void 0?void 0:r.checkin,onCloseModal:a});default:return null}}render(){if(!this.booking){return e("div",{class:"loading-container"},e("ir-spinner",null))}return[e(n,null,!this.is_from_front_desk&&e(n,null,e("ir-toast",null),e("ir-interceptor",null))),e("ir-booking-header",{booking:this.booking,hasCloseButton:this.hasCloseButton,hasDelete:this.hasDelete,hasMenu:this.hasMenu,hasPrint:this.hasPrint,hasReceipt:this.hasReceipt}),e("div",{class:"fluid-container p-1 text-left mx-0"},e("div",{class:"row m-0"},e("div",{class:"col-12 p-0 mx-0 pr-lg-1 col-lg-6"},e("ir-reservation-information",{countries:this.countries,booking:this.booking}),e("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},e("ir-date-view",{from_date:this.booking.from_date,to_date:this.booking.to_date}),this.hasRoomAdd&&this.booking.is_direct&&this.booking.is_editable&&e("ir-button",{id:"room-add",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),e("div",{class:"card p-0 mx-0"},this.booking.rooms.map(((t,i)=>{const s=this.handleRoomCheckin(t);const n=this.handleRoomCheckout(t);return[e("ir-room",{room:t,language:this.language,bedPreferences:this.bedPreference,isEditable:this.booking.is_editable,legendData:this.calendarData.legendData,roomsInfo:this.calendarData.roomsInfo,myRoomTypeFoodCat:t.roomtype.name,mealCodeName:t.rateplan.short_name,currency:this.booking.currency.symbol,hasRoomEdit:this.hasRoomEdit&&this.booking.status.code!=="003"&&this.booking.is_direct,hasRoomDelete:this.hasRoomDelete&&this.booking.status.code!=="003"&&this.booking.is_direct,hasCheckIn:s,hasCheckOut:n,booking:this.booking,bookingIndex:i,onDeleteFinished:this.handleDeleteFinish.bind(this)}),i!==this.booking.rooms.length-1&&e("hr",{class:"mr-2 ml-2 my-0 p-0"})]}))),e("ir-pickup-view",{booking:this.booking}),e("section",null,e("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},e("p",{class:"font-size-large p-0 m-0 "},p.entries.Lcz_ExtraServices),e("ir-button",{id:"extra_service_btn",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),e("ir-extra-services",{booking:{booking_nbr:this.booking.booking_nbr,currency:this.booking.currency,extra_services:this.booking.extra_services}}))),e("div",{class:"col-12 p-0 m-0 pl-lg-1 col-lg-6"},e("ir-payment-details",{paymentActions:this.paymentActions,bookingDetails:this.booking})))),e("ir-sidebar",{open:this.sidebarState!==null,side:"right",id:"editGuestInfo",style:{"--sidebar-width":this.sidebarState==="room-guest"?"60rem":undefined},onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.sidebarState=null},showCloseButton:false},this.renderSidebarContent()),e(n,null,this.bookingItem&&e("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countries,currency:this.calendarData.currency,language:this.language,propertyid:this.property_id,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))]}handleRoomCheckout(t){if(!g.checkin_enabled||g.is_automatic_check_in_out){return false}return t.in_out.code==="001"}handleRoomCheckin(t){if(!g.checkin_enabled||g.is_automatic_check_in_out){return false}if(!t.unit){return false}if(t.in_out&&t.in_out.code!=="000"){return false}if(U(new Date).isSameOrAfter(new Date(t.from_date),"days")&&U(new Date).isBefore(new Date(t.to_date),"days")){return true}return false}get element(){return o(this)}static get watchers(){return{ticket:["ticketChanged"]}}};xs.style=ws;const _s=".sc-ir-booking-extra-note-h{display:block}";const Ds=_s;const Cs=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetbooking=s(this,"resetbooking",7);this.bookingService=new l;this.booking=undefined;this.isLoading=false;this.note=""}componentWillLoad(){if(this.booking.extras){this.setNote(H(this.booking.extras))}}setNote(t){this.note=t}async savePrivateNote(){try{this.isLoading=true;let t=this.booking.extras||[];const e={key:"private_note",value:this.note};if(t.length===0){t.push(e)}else{const i=t.findIndex((t=>t.key==="private_note"));if(i===-1){t.push(e)}else{t[i]=e}}const i=await this.bookingService.doReservation({assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,booking:this.booking,Is_Non_Technical_Change:true,extras:t});this.resetbooking.emit(i);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return e(i,{key:"1defc45c744bc8b370e5cc5db0ca5519df5e1cd3",class:"px-0"},e("ir-title",{key:"c26a6497ec317fded8d265acc0254db82cf97512",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:p.entries.Lcz_PrivateNote,displayContext:"sidebar"}),e("form",{key:"c2fa6aca28dfeb671129e15061c6ec673151cd79",class:"px-1",onSubmit:t=>{t.preventDefault();this.savePrivateNote()}},e("ir-textarea",{key:"d39a49bffc5a40955c8b0bc2b6695174e30dbe32",placeholder:p.entries.Lcz_PrivateNote_MaxChar,label:"",value:this.note,maxLength:150,onTextChange:t=>this.setNote(t.detail)}),e("div",{key:"c323384502e8f2af9672287d1cdbea8698068b68",class:"d-flex flex-column flex-sm-row mt-3"},e("ir-button",{key:"962bf088324704fb66c2b3c8aa32fa818bb0bc01",onClickHandler:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`,icon:"",text:p.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{key:"1d9a7b797816b131261f0c0a723a63ad4ee46827",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center ml-sm-1",icon:"",isLoading:this.isLoading,text:p.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"}))))}};Cs.style=Ds;const Os=".sc-ir-booking-header-h{display:block}.confirmed.sc-ir-booking-header{color:#fff;display:flex;align-items:center}.bg-ir-green.sc-ir-booking-header{background:#629a4c;padding:0.2rem 0.3rem}.bg-ir-red.sc-ir-booking-header{background:#ff4961;padding:0.2rem 0.3rem}.bg-ir-orange.sc-ir-booking-header{background:#ff9149;padding:0.2rem 0.3rem}";const Es=Os;const As=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.closeSidebar=s(this,"closeSidebar",7);this.resetbooking=s(this,"resetbooking",7);this.openSidebar=s(this,"openSidebar",7);this.confirmationBG={"001":"bg-ir-orange","002":"bg-ir-green","003":"bg-ir-red","004":"bg-ir-red"};this.bookingService=new l;this.booking=undefined;this.hasReceipt=undefined;this.hasPrint=undefined;this.hasDelete=undefined;this.hasMenu=undefined;this.hasCloseButton=undefined;this.bookingStatus=null;this.currentDialogStatus=undefined}handleSelectChange(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.target;this.bookingStatus=e.selectedValue}async updateStatus(){if(!this.bookingStatus||this.bookingStatus==="-1"){this.toast.emit({type:"error",description:"",title:p.entries.Lcz_SelectStatus,position:"top-right"});return}try{await this.bookingService.changeExposedBookingStatus({book_nbr:this.booking.booking_nbr,status:this.bookingStatus});this.toast.emit({type:"success",description:"",title:p.entries.Lcz_StatusUpdatedSuccessfully,position:"top-right"});this.bookingStatus=null;this.resetbooking.emit(null)}catch(t){console.log(t)}}openDialog(t){const{type:e}=t;this.currentDialogStatus=e;this.dialogRef.openModal()}renderDialogBody(){switch(this.currentDialogStatus){case"pms":return e("ir-pms-logs",{slot:"modal-body",bookingNumber:this.booking.booking_nbr});case"events-log":return e("ir-events-log",{slot:"modal-body",bookingNumber:this.booking.booking_nbr})}}render(){return e("div",{key:"7e420777f46d3950268d72f6af594ca8dc3e38d7",class:"fluid-container px-1"},e("div",{key:"fe4a7c60180294e7cc44e8073bfc892319484ba9",class:"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1"},e("div",{key:"313c4832c4264a1186fdd33b42f149d613aab0ec",class:"m-0 p-0 mb-1 mb-lg-0 mt-md-0"},e("p",{key:"88b9b373414a6d4b8a49c9a57ba5fed1cd4ad670",class:"font-size-large m-0 p-0"},`${p.entries.Lcz_Booking}#${this.booking.booking_nbr}`),e("p",{key:"dccbdd4fb8b15c4dffad9603b6fbc1f2f46dd6f3",class:"m-0 p-0"},!this.booking.is_direct&&e("span",{key:"997f81412a9d95c333d408407f480f62b9324b56",class:"mr-1 m-0"},this.booking.channel_booking_nbr))),e("div",{key:"5fc3b218b07beec4e18666e6d5dc89c876596624",class:"d-flex justify-content-end align-items-center",style:{gap:"1rem",flexWrap:"wrap"}},e("span",{key:"b8c4d4c0a8b536ce4abf386a0f56fc662f097756",class:`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.status.code]}`},this.booking.status.description),this.booking.allowed_actions.length>0&&this.booking.is_editable&&e("div",{key:"89c6fe5764f1e14e480c718353dd0218c12b4367",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.25rem"}},e("ir-select",{key:"9bd6c31ccf07aaa88415f651506ef55f5bb991ec",selectContainerStyle:"h-28",selectStyles:"d-flex status-select align-items-center h-28",firstOption:p.entries.Lcz_Select,id:"update-status",size:"sm","label-available":"false",data:this.booking.allowed_actions.map((t=>({text:t.description,value:t.code}))),textSize:"sm",class:"sm-padding-right m-0 ",selectedValue:this.bookingStatus}),e("ir-button",{key:"32b9c15192115bd58ecbbad8bf67209d923d3bc3",onClickHandler:this.updateStatus.bind(this),btn_styles:"h-28",isLoading:G("/Change_Exposed_Booking_Status"),btn_disabled:G("/Change_Exposed_Booking_Status"),id:"update-status-btn",size:"sm",text:"Update"})),e("ir-button",{key:"a4581617452245003b61418f3839742ea058f998",size:"sm",btn_color:"outline",text:p.entries.Lcz_EventsLog,onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openDialog({type:"events-log"})}}),g.is_pms_enabled&&e("ir-button",{key:"81013233d4534e60861882903b3e6a33d8bcc1b2",size:"sm",btn_color:"outline",text:p.entries.Lcz_pms,onClick:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openDialog({type:"pms"})}}),this.hasReceipt&&e("ir-button",{key:"40eab89aecea7356729b47482f17789a6fbe1500",variant:"icon",id:"receipt",icon_name:"reciept",class:"",style:{"--icon-size":"1.65rem"}}),this.hasPrint&&e("ir-button",{key:"123ff475c032b747241c864a4087670f8993ce08",variant:"icon",id:"print",icon_name:"print",class:"",style:{"--icon-size":"1.65rem"}}),this.hasDelete&&e("ir-button",{key:"738092db0f501fd9ca95efb48acd129e3dc11964",variant:"icon",id:"book-delete",icon_name:"trash",class:"",style:Object.assign(Object.assign({},Xt.danger),{"--icon-size":"1.65rem"})}),this.hasMenu&&e("ir-button",{key:"4ecb9243d3f3d2a7c6214de386a509b27380793f",variant:"icon",class:"mr-1",id:"menu",icon_name:"menu_list",style:{"--icon-size":"1.65rem"}}),this.hasCloseButton&&e("ir-button",{key:"365d92d1ad1f0054a3ea550460ef168e0c972d8e",id:"close",variant:"icon",style:{"--icon-size":"1.65rem"},icon_name:"xmark",class:"ml-2",onClickHandler:t=>{t.stopPropagation();t.stopImmediatePropagation();this.closeSidebar.emit(null)}}))),e("ir-dialog",{key:"091c1dad022e01506c2193cebcee87bcde395df6",onOpenChange:t=>{if(!t.detail){this.currentDialogStatus=null}},style:this.currentDialogStatus==="events-log"&&{"--ir-dialog-max-width":"400px"},ref:t=>this.dialogRef=t},this.renderDialogBody()))}};As.style=Es;const Bs=".sc-ir-button-h{--icon-button-color:#6b6f82;--icon-button-hover-color:#104064}.button-icon.sc-ir-button{padding:0;margin-top:0}.button-icon[data-state='loading'].sc-ir-button{display:none}.button-text.sc-ir-button{padding:0 5px}.bounce-3.sc-ir-button{animation:bounce 1s 1}.btn-link.sc-ir-button{color:var(--blue, #1e9ff2)}.ir-button-class.sc-ir-button{display:inline-flex !important;justify-content:center;align-items:center;box-sizing:border-box}.btn-outline.sc-ir-button{background:transparent;border:1px solid #104064;color:#104064}.btn-outline.sc-ir-button:hover,.btn-outline.sc-ir-button:active{background:#104064;color:white}.icon-button.sc-ir-button{all:unset;box-sizing:border-box;border-radius:0.25rem;display:inline-flex;align-items:center;justify-content:center;color:var(--icon-button-color);padding:0.2rem;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.icon-button.sc-ir-button:hover{color:var(--icon-button-hover-color)}.icon-button.sc-ir-button:hover.hovered_bg{background:var('--ir-icon-bg-hover', #f6f6f6)}.icon-button.sc-ir-button:disabled{pointer-events:none}.icon-loader.sc-ir-button{margin:0;padding:0;width:var(--icon-size, 1.25rem);height:var(--icon-size, 1.25rem);border-radius:50%;background:radial-gradient(farthest-side, var(--icon-button-color) 94%, #0000) top/2px 2px no-repeat, conic-gradient(#0000 30%, var(--icon-button-color));-webkit-mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);animation:l13 1s infinite linear}.btn_loader.sc-ir-button{width:15px;height:10px;--c:no-repeat linear-gradient(#ffffff 0 0);background:var(--c) 0% 50%, var(--c) 50% 50%, var(--c) 100% 50%;background-size:20% 100%;animation:l1 1s infinite linear}@keyframes l13{100%{transform:rotate(1turn)}}@keyframes l1{0%{background-size:20% 100%, 20% 100%, 20% 100%}33%{background-size:20% 10%, 20% 100%, 20% 100%}50%{background-size:20% 100%, 20% 10%, 20% 100%}66%{background-size:20% 100%, 20% 100%, 20% 10%}100%{background-size:20% 100%, 20% 100%, 20% 100%}}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}@keyframes ping{75%,100%{transform:scale(1.2)}}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Ms=Bs;const Ts=class{constructor(e){t(this,e);this.clickHandler=s(this,"clickHandler",7);this.name=undefined;this.text=undefined;this.icon="ft-save";this.btn_color="primary";this.size="md";this.textSize="md";this.btn_block=true;this.btn_disabled=false;this.btn_type="button";this.isLoading=false;this.btn_styles=undefined;this.btn_id=L();this.variant="default";this.icon_name=undefined;this.visibleBackgroundOnHover=false;this.iconPosition="left";this.icon_style=undefined;this.btnStyle=undefined;this.labelStyle=undefined;this.renderContentAsHtml=false}handleButtonAnimation(t){if(!this.buttonEl||t.detail!==this.btn_id){return}t.stopImmediatePropagation();t.stopPropagation();this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}async bounce(){this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}render(){if(this.variant==="icon"){return e("button",{id:this.btn_id,class:`icon-button ${this.btn_styles} ${this.visibleBackgroundOnHover?"hovered_bg":""}`,ref:t=>this.buttonEl=t,onClick:()=>this.clickHandler.emit(),type:this.btn_type,disabled:this.btn_disabled},this.isLoading?e("span",{class:"icon-loader"}):e("ir-icons",{class:"m-0 p-0",name:this.icon_name}))}let t=this.btn_block?"btn-block":"";return e("button",{id:this.btn_id,ref:t=>this.buttonEl=t,onClick:()=>this.clickHandler.emit(),class:`btn btn-${this.btn_color} ${this.btn_styles} ir-button-class  btn-${this.size} text-${this.textSize} ${t}`,type:this.btn_type,style:this.btnStyle,disabled:this.btn_disabled||this.isLoading},this.icon_name&&this.iconPosition==="left"&&e("ir-icons",{name:this.icon_name,style:this.icon_style}),this.text&&(this.renderContentAsHtml?e("span",{class:"button-text m-0",innerHTML:this.text,style:this.labelStyle}):e("span",{style:this.labelStyle,class:"button-text m-0"},this.text)),this.isLoading?e("div",{class:"btn_loader m-0 p-0"}):this.iconPosition==="right"&&e("ir-icons",{style:this.icon_style,name:this.icon_name}))}};Ts.style=Ms;const Is=".sc-ir-combobox-h{display:block;position:relative;padding:0;margin:0;box-sizing:border-box}ul.sc-ir-combobox{position:absolute;box-sizing:border-box;margin:0;margin-top:2px;width:max-content;max-height:80px;border-radius:0.21rem;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto;min-width:100%}ul[data-position='bottom-right'].sc-ir-combobox{right:0}.list-item-image.sc-ir-combobox{height:1rem;aspect-ratio:4/3;border-radius:4px;margin-right:10px}.dropdown-item.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox,span.sc-ir-combobox,loader-container.sc-ir-combobox{padding:0px 16px;margin:0px;margin-top:2px;width:100%;border-radius:2px}ul.sc-ir-combobox li.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox{display:flex;align-items:center;flex-wrap:wrap;gap:3px}ul.sc-ir-combobox li.sc-ir-combobox p.sc-ir-combobox{margin:0;padding:0}ul.sc-ir-combobox li.sc-ir-combobox:hover{background:#f4f5fa}ul.sc-ir-combobox li[data-selected].sc-ir-combobox,ul.sc-ir-combobox li[data-selected].sc-ir-combobox:hover{color:#fff;text-decoration:none;background-color:#666ee8}";const Ss=Is;const Ys=class{constructor(e){t(this,e);this.comboboxValueChange=s(this,"comboboxValueChange",7);this.inputCleared=s(this,"inputCleared",7);this.toast=s(this,"toast",7);this.data=[];this.duration=300;this.placeholder=undefined;this.value=undefined;this.disabled=false;this.autoFocus=false;this.input_id=L();this.selectedIndex=-1;this.actualIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputValue="";this.filteredData=[];this.componentShouldAutoFocus=false}componentWillLoad(){this.filteredData=this.data}componentDidLoad(){if(this.autoFocus){this.focusInput()}}watchHandler(t,e){if(t!==e&&t===true){this.focusInput()}}handleKeyDown(t){var e;const i=this.filteredData.length;if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition();break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition();break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}focusInput(){requestAnimationFrame((()=>{var t;(t=this.inputRef)===null||t===void 0?void 0:t.focus()}))}adjustScrollPosition(){var t;const e=(t=this.el)===null||t===void 0?void 0:t.querySelector(`[data-selected]`);if(!e)return;e.scrollIntoView({block:"center"})}selectItem(t){if(this.filteredData[t]){this.isItemSelected=true;this.comboboxValueChange.emit({key:"select",data:this.filteredData[t].id});this.inputValue="";this.resetCombobox();if(this.autoFocus){this.focusInput()}}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}handleFocus(){this.isComboBoxVisible=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.selectedIndex=-1;this.isComboBoxVisible=false}async fetchData(){try{this.isLoading=true;this.filteredData=this.data.filter((t=>t.name.toLowerCase().startsWith(this.inputValue)));this.selectedIndex=-1}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{this.filteredData=this.data}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.blurTimout=setTimeout((()=>{if(!this.isItemSelected){this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}),300)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);clearTimeout(this.blurTimout);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}}renderDropdown(){var t;if(!this.isComboBoxVisible){return null}return e("ul",{"data-position":this.filteredData.length>0&&this.filteredData[0].occupancy?"bottom-right":"bottom-left"},(t=this.filteredData)===null||t===void 0?void 0:t.map(((t,i)=>e("li",{onMouseEnter:()=>this.selectedIndex=i,role:"button",key:t.id,onKeyDown:t=>this.handleItemKeyDown(t,i),"data-selected":this.selectedIndex===i,tabIndex:0,onClick:()=>this.selectItem(i)},t.image&&e("img",{src:t.image,class:"list-item-image"}),e("p",null,t.name),t.occupancy&&e(n,null,e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),e("p",null,t.occupancy))))),this.filteredData.length===0&&!this.isLoading&&e("span",{class:"text-center"},p.entries.Lcz_NoResultsFound))}handleSubmit(t){t.preventDefault();t.stopPropagation();console.log("object");if(!this.filteredData.length){return}this.selectItem(this.selectedIndex===-1?0:this.selectedIndex)}render(){return e("form",{key:"957d7f92dbdb85ef0135671f4c7c6316025f0a29",onSubmit:this.handleSubmit.bind(this),class:"m-0 p-0"},e("input",{key:"c3196f75dfdc023503853c2b7e231ebaa511d13a",type:"text",class:"form-control bg-white",id:this.input_id,ref:t=>this.inputRef=t,disabled:this.disabled,value:this.value,placeholder:this.placeholder,onKeyDown:this.handleKeyDown.bind(this),onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),autoFocus:this.autoFocus}),this.renderDropdown())}get el(){return o(this)}static get watchers(){return{isComboBoxVisible:["watchHandler"]}}};Ys.style=Ss;const Ns=[{isCSS:true,link:"https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap-extended.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/colors.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/menu/menu-types/horizontal-menu.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/colors/palette-gradient.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/components.css"},{isCSS:true,link:"https://x.igloorooms.com/assets/css/style.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/icheck.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/custom.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/pages/login-register.css"}];const Ls=class{constructor(e){t(this,e);this.extraResources="";this.resources=Ns}componentWillLoad(){this.parseRefs()}componentDidLoad(){this.initializeStyles()}hrefsChanged(){this.parseRefs();this.initializeStyles()}parseRefs(){if(this.extraResources!=="")this.resources.push(JSON.parse(this.extraResources))}appendTag(t,e){const i=document.createElement(t);const s=[];Object.keys(e).forEach((t=>{i.setAttribute(t,e[t]);s.push(`[${t}="${e[t]}"]`)}));const n=`${t}${s.join("")}`;const o=document.querySelector(n);if(!o){document.head.appendChild(i)}}initializeStyles(){this.resources.forEach((t=>{if(t.isCSS){this.appendTag("link",{href:t.link,rel:"stylesheet",type:"text/css"})}if(t.isJS){this.appendTag("script",{src:t.link})}}))}render(){return e(i,{key:"34d4b4fa30c2656c27b3f48efb7e61c5cd7cbdae"},e("slot",{key:"b02a0ce647b83586c82fc1d4a54ae9cea320de3e"}))}static get watchers(){return{extraResources:["hrefsChanged"]}}};const js=".sc-ir-country-picker-h{display:block;margin:0;padding:0;box-sizing:border-box}.combobox-menu.sc-ir-country-picker{max-height:200px;overflow:auto}";const Rs=js;const zs=class{constructor(e){t(this,e);this.countryChange=s(this,"countryChange",7);this.countries=[];this.country=undefined;this.error=undefined;this.propertyCountry=undefined;this.label=undefined;this.inputValue=undefined;this.selectedCountry=undefined;this.filteredCountries=[];this.searching=false}componentWillLoad(){this.filteredCountries=[...this.countries];if(this.country){this.inputValue=this.country.name;this.selectedCountry=this.country}}handleCountryChange(t,e){if((t===null||t===void 0?void 0:t.id)!==(e===null||e===void 0?void 0:e.id)){this.inputValue=this.country.name;this.selectedCountry=t}}filterCountries(){if(this.inputValue===""&&this.country){this.selectCountry(null)}clearTimeout(this.debounceTimeout);this.debounceTimeout=setTimeout((()=>{if(!this.inputValue){this.filteredCountries=[...this.countries]}else{this.filteredCountries=this.countries.filter((t=>t.name.toLowerCase().includes(this.inputValue.toLowerCase())))}}),300)}selectCountry(t){this.selectedCountry=t;this.inputValue=t.name;this.filteredCountries=[...this.countries];this.countryChange.emit(t)}scrollToSelected(){setTimeout((()=>{const t=document.querySelector(`.dropdown-item.active`);if(t){t.scrollIntoView({behavior:"instant",block:"center"})}}),100)}render(){var t,i,s;const o=this.filteredCountries.length>0&&this.propertyCountry&&(!this.searching||this.searching&&this.inputValue==="");return e("form",{key:"c1e901021e394a37eb73a39c64b58c624a70faf0",class:"dropdown m-0 p-0"},e("ir-input-text",{key:"8451ff375ce89c77c19b18e47289140d5008cd38",onTextChange:t=>{if(!this.searching){this.searching=true}this.inputValue=t.detail;this.filterCountries()},label:this.label,error:this.error,placeholder:"",class:"m-0 p-0",value:this.inputValue,id:"dropdownMenuCombobox",LabelAvailable:!!this.label,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onInputFocus:()=>this.scrollToSelected(),onInputBlur:()=>this.searching=false}),e("div",{key:"7cea47652532b394da9844974c47c24536cd20d2",class:"dropdown-menu combobox-menu","aria-labelledby":"dropdownMenuCombobox"},o&&e(n,{key:"2af71c0a5b757afeb754a8d826f3ccb82150e7e5"},e("button",{key:"735be10393ec14082abd1489c9b57b3fe72906c9",type:"button",class:`dropdown-item d-flex align-items-center ${((t=this.selectedCountry)===null||t===void 0?void 0:t.id)===this.propertyCountry.id?"active":""}`,onClick:()=>{this.selectCountry(this.propertyCountry)}},e("img",{key:"3616075fb71a3732e2666a7960615f17d72b363c",src:this.propertyCountry.flag,alt:this.propertyCountry.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),e("p",{key:"566269c15f59db3f0cf7db0d479097a1e2aca40a",class:"pl-1 m-0"},this.propertyCountry.name)),e("div",{key:"54cf35aa914e92085829da344b1b02bf2e138c66",class:"dropdown-divider"})),(i=this.filteredCountries)===null||i===void 0?void 0:i.map((t=>{var i;return e("button",{key:t.id,type:"button",class:`dropdown-item d-flex align-items-center ${((i=this.selectedCountry)===null||i===void 0?void 0:i.id)===t.id?"active":""}`,onClick:()=>{this.selectCountry(t)}},e("img",{src:t.flag,alt:t.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),e("p",{class:"pl-1 m-0"},t.name))})),((s=this.filteredCountries)===null||s===void 0?void 0:s.length)===0&&e("p",{key:"93431ba2184338f008e0e1d5d02b4b6f72293c50",class:"dropdown-item-text"},"Invalid Country")))}static get watchers(){return{country:["handleCountryChange"]}}};zs.style=Rs;const $s="input.sc-ir-date-picker{all:unset;box-sizing:border-box !important;padding:0;margin:0;width:100%;text-align:center}input.sc-ir-date-picker:disabled{text-align:start;font-size:14px;width:100%}.sc-ir-date-picker-h{position:relative;box-sizing:border-box}.icon.sc-ir-date-picker{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}";const Fs=$s;const Ps=class{constructor(e){t(this,e);this.dateChanged=s(this,"dateChanged",7);this.fromDate=undefined;this.toDate=undefined;this.date=undefined;this.opens=undefined;this.autoApply=undefined;this.firstDay=1;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.daysOfWeek=["Su","Mo","Tu","We","Th","Fr","Sa"];this.format="MMM DD, YYYY";this.separator=" - ";this.applyLabel="Apply";this.cancelLabel="Cancel";this.fromLabel="Form";this.toLabel="To";this.customRangeLabel="Custom";this.weekLabel="W";this.disabled=false;this.singleDatePicker=false;this.minDate=undefined;this.maxDate=undefined;this.maxSpan={days:240}}handleMinDateChange(){$(this.dateRangeInput).data("daterangepicker").remove();this.initializeDateRangePicker()}datePropChanged(){this.updateDateRangePickerDates()}async openDatePicker(){this.openDatePickerTimeout=setTimeout((()=>{this.dateRangeInput.click()}),20)}updateDateRangePickerDates(){const t=$(this.dateRangeInput).data("daterangepicker");if(!t){console.error("Date range picker not initialized.");return}if(this.singleDatePicker){const e=this.date?U(this.date):U();t.setStartDate(e);t.setEndDate(e)}else{const e=this.fromDate?U(this.fromDate):U();const i=this.toDate?U(this.toDate):e.clone().add(1,"days");t.setStartDate(e);t.setEndDate(i)}}componentWillLoad(){if(!document.getElementById("ir-daterangepicker-style")){const t=document.createElement("style");t.id="ir-daterangepicker-style";t.textContent=`\n        .daterangepicker {\n          margin-top: 14px;\n        }\n      `;document.head.appendChild(t)}}componentDidLoad(){this.dateRangeInput=this.element.querySelector(".date-range-input");this.initializeDateRangePicker();this.updateDateRangePickerDates()}initializeDateRangePicker(){$(this.dateRangeInput).daterangepicker({singleDatePicker:this.singleDatePicker,opens:this.opens,startDate:U(this.fromDate),endDate:U(this.toDate),minDate:U(this.minDate||U(new Date).format("YYYY-MM-DD")),maxDate:this.maxDate?U(this.maxDate):undefined,maxSpan:this.maxSpan,autoApply:this.autoApply,locale:{format:this.format,separator:this.separator,applyLabel:this.applyLabel,cancelLabel:this.cancelLabel,fromLabel:this.fromLabel,toLabel:this.toLabel,customRangeLabel:this.customRangeLabel,weekLabel:this.weekLabel,daysOfWeek:this.daysOfWeek,monthNames:this.monthNames,firstDay:this.firstDay}},((t,e)=>{this.dateChanged.emit({start:t,end:e})}))}disconnectedCallback(){if(this.openDatePickerTimeout){clearTimeout(this.openDatePickerTimeout)}$(this.dateRangeInput).data("daterangepicker").remove()}render(){return e(i,{key:"812422e1ba9c71e91e3713e153baed5c1246c939"},e("input",{key:"cfcb86b4ff83e01b9a243b2e402b2330cbac850b",class:"date-range-input",type:"text",disabled:this.disabled}))}get element(){return o(this)}static get watchers(){return{minDate:["handleMinDateChange"],date:["datePropChanged"]}}};Ps.style=Fs;const Hs=".sc-ir-date-view-h{display:block;font-size:13.65px !important;width:100%}.mx-01.sc-ir-date-view{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Vs=Hs;const Us=class{constructor(e){t(this,e);this.from_date=undefined;this.to_date=undefined;this.showDateDifference=true;this.dateOption="YYYY-MM-DD";this.dates=undefined}componentWillLoad(){this.initializeDates()}handleFromDateChange(t,e){if(t!==e){this.initializeDates()}}handleToDateChange(t,e){if(t!==e){this.initializeDates()}}initializeDates(){this.convertDate("from_date",this.from_date);this.convertDate("to_date",this.to_date);const t=U(this.dates.from_date,"MMM DD, YYYY").format("YYYY-MM-DD");const e=U(this.dates.to_date,"MMM DD, YYYY").format("YYYY-MM-DD");this.dates.date_diffrence=j(t,e)}convertDate(t,e){this.dates=this.dates||{from_date:"",to_date:"",date_diffrence:0};if(!e){return}if(typeof e==="string"){this.dates[t]=U(e,this.dateOption).format("MMM DD, YYYY")}else if(e instanceof Date){this.dates[t]=U(e).format("MMM DD, YYYY")}else if(U.isMoment(e)){this.dates[t]=e.format("MMM DD, YYYY")}else{console.error("Unsupported date type")}}render(){return e(i,{key:"3ea0b8d1c3516095cc8ce9e1de3636c77ccd21bb",class:"d-flex align-items-center"},e("span",{key:"9f35ab934c053a77eaee02fa2da4c98fc42e33c0"},this.dates.from_date)," ",e("svg",{key:"3391d01b6bce701e4556f9b645335844d4ebeb6c",xmlns:"http://www.w3.org/2000/svg",class:"mx-01",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{key:"8b2e81ae1867857a2a2c59acb1fbeb8e635a5396",fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),e("span",{key:"b0ee10b5ec4faadb9960dc154517ad2b86f89ff2"},this.dates.to_date," ",this.showDateDifference&&e("span",{key:"8b574ade34eb15a3e2352a39e8d3e30873dad8d3",class:"mx-01"},this.dates.date_diffrence,"   ",this.dates.date_diffrence>1?` ${p.entries.Lcz_Nights}`:` ${p.entries.Lcz_Night}`)))}static get watchers(){return{from_date:["handleFromDateChange"],to_date:["handleToDateChange"]}}};Us.style=Vs;const Gs=":host{display:block;margin:0;padding:0;box-sizing:border-box}.backdrop{opacity:0;background:rgba(0, 0, 0, 0.2);position:fixed;inset:0;z-index:99999998}.backdrop[data-state='opened']{animation:overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards}.backdrop[data-state='closed']{opacity:0;pointer-events:none}.modal-container{box-sizing:border-box;margin:0;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;position:fixed;z-index:99999999;overflow-y:auto;top:50%;left:50%;background:white;transform:translate(-50%, -50%);width:90%;min-height:fit-content;height:fit-content;max-width:var(--ir-dialog-max-width, 40rem);max-height:85vh;border-radius:8px;padding:0;animation:contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1)}.modal-footer ::slotted(*){flex-direction:row;align-items:center;justify-content:end;gap:8px;--ir-btn-width:inherit}.modal-footer{--ir-btn-width:100%}.modal-title ::slotted(*){font-size:18px;font-weight:600;color:#101828;margin-bottom:8px}.modal-body ::slotted(*){font-size:14px;font-weight:400;color:#475467;padding:0;margin:0}@keyframes overlayShow{from{opacity:0}to{opacity:1}}@keyframes contentShow{from{opacity:0;transform:translate(-50%, -48%) scale(0.96)}to{opacity:1;transform:translate(-50%, -50%) scale(1)}}.dialog-close-button{position:absolute;top:15px;right:15px}";const Ks=Gs;const Ws=class{constructor(e){t(this,e);this.openChange=s(this,"openChange",7);this.open=false;this.isOpen=false}componentWillLoad(){if(this.open){this.openModal()}}componentDidLoad(){this.prepareFocusTrap()}async openModal(){this.isOpen=true;document.body.style.overflow="hidden";setTimeout((()=>{this.prepareFocusTrap()}),10);this.openChange.emit(this.isOpen)}async closeModal(){console.log("close");if(!this.isOpen){return}document.body.style.overflow="visible";this.isOpen=false;this.openChange.emit(this.isOpen)}handleOpenChange(){if(this.open){this.openModal()}else{this.closeModal()}}prepareFocusTrap(){const t='button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';const e=this.el.shadowRoot.querySelectorAll(t);if(e.length===0)return;this.firstFocusableElement=e[0];this.lastFocusableElement=e[e.length-1];this.firstFocusableElement.focus()}handleKeyDown(t){if(!this.isOpen){return}let e=t.key==="Tab";if(t.key==="Escape"&&this.isOpen){this.closeModal()}if(!e){return}if(!t.shiftKey&&document.activeElement===this.lastFocusableElement){this.firstFocusableElement.focus();t.preventDefault()}if(t.shiftKey&&document.activeElement===this.firstFocusableElement){this.lastFocusableElement.focus();t.preventDefault()}}disconnectedCallback(){document.body.style.overflow="visible"}render(){return e(i,{key:"d2ae10789f9d7867e2336553f62c27937b6a8865"},e("div",{key:"9aa5f9f45267d11f6fbda57a6a1a40bb565c31e5",class:"backdrop","data-state":this.isOpen?"opened":"closed",onClick:()=>this.closeModal()}),this.isOpen&&e("div",{key:"cba048266e2aad16324730832224f6ed490e6e37",class:"modal-container",tabIndex:-1,role:"dialog","aria-labelledby":"dialog1Title","aria-describedby":"dialog1Desc"},e("ir-icon",{key:"52126a8c007abfce46633922e1191fdb14879232",id:"close",class:"dialog-close-button",onIconClickHandler:()=>this.closeModal()},e("svg",{key:"d581ae2b82b64774dfc1f306bd7145d98c643aef",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:18,width:18},e("path",{key:"ba8cb223dfe9ca4e5102cd4f37a87383cf8028d5",fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),e("div",{key:"3fb8529a57fe80bcaae7c14a8be5063456f265d2",class:"modal-title",id:"dialog1Title"},e("slot",{key:"e2503896d6c382f1a44186a56ba53ac71e591e8c",name:"modal-title"})),e("div",{key:"f4042d9d2853af5a0d83e36bacc37ecbe13b9b7a",class:"modal-body",id:"dialog1Desc"},e("slot",{key:"726a93e567f92d906502486ca8e7f68593e8d206",name:"modal-body"})),e("div",{key:"a68683da4fc5f63321c76f48176e2709e713b48d",class:"modal-footer"},e("slot",{key:"74f0c250abb7b5080f02bfdd7a72910aed698e6a",name:"modal-footer"}))))}get el(){return o(this)}static get watchers(){return{open:["handleOpenChange"]}}};Ws.style=Ks;const qs=".sc-ir-events-log-h{display:block}.beta.sc-ir-events-log{background:var(--red);color:white;padding:0.2rem 0.3rem;font-size:12px;border-radius:4px;margin:0}.event-row.sc-ir-events-log{padding-bottom:0.5rem}.list-title.sc-ir-events-log{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-events-log{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-events-log{color:#629a4c;font-weight:600}.list-item.red.sc-ir-events-log{color:#ff4961;font-weight:600}.dates-row.sc-ir-events-log{display:flex;align-items:center;gap:0.875rem}";const Xs=qs;const Js=class{constructor(e){t(this,e);this.bookingService=new l;this.bookingNumber=undefined;this.bookingEvents=undefined}componentWillLoad(){this.init()}async init(){try{this.bookingEvents=await this.bookingService.getExposedBookingEvents(this.bookingNumber)}catch(t){console.error(t)}}render(){var t;return e("div",{key:"1202228b163e039ebd05f2c5c4eab67ad27a3eb8",class:"p-1"},e("div",{key:"e69dbff764220d21b71dcb3c3f95a14e60cf6ac8",class:"d-flex  align-items-center",style:{gap:"0.5rem"}},e("h3",{key:"334b4d9d5a4d4e4cfd413185e0d3ce29ba26954f",class:" text-left p-0 m-0  dialog-title "},p.entries.Lcz_EventsLog)),G("/Get_Exposed_Booking_Events")?e("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},e("ir-spinner",null)):e(n,null,e("table",{class:" dialog-container-height"},e("thead",{style:{opacity:"0"}},e("tr",null,e("th",null,"date"),e("th",null,"user"),e("th",null,"status"))),e("tbody",null,(t=this.bookingEvents)===null||t===void 0?void 0:t.map((t=>e("tr",{key:t.id,class:"pb-1"},e("td",{class:"event-row dates-row"},e("span",null,t.date),e("span",null,String(t.hour).padStart(2,"0"),":",String(t.minute).padStart(2,"0"),":",String(t.second).padStart(2,"0"))),e("td",{class:"pl-3 event-row "},t.type),e("td",{class:"pl-1 event-row "},t.user))))))))}};Js.style=Xs;const Zs=".sc-ir-extra-service-h{display:block}.extra-service-container.sc-ir-extra-service{display:flex;align-items:center;justify-content:space-between;gap:0.5rem}.extra-service-container.sc-ir-extra-service *.sc-ir-extra-service{padding:0;margin:0;box-sizing:border-box}.extra-service-actions.sc-ir-extra-service{display:flex;align-items:center;gap:0.5rem}.extra-service-conditional-date.sc-ir-extra-service{margin-top:0.5rem}";const Qs=Zs;const tn=class{constructor(e){t(this,e);this.editExtraService=s(this,"editExtraService",7);this.resetBookingData=s(this,"resetBookingData",7);this.bookingService=new l;this.service=undefined;this.bookingNumber=undefined;this.currencySymbol=undefined}async deleteService(){try{await this.bookingService.doBookingExtraService({service:this.service,is_remove:true,booking_nbr:this.bookingNumber});this.resetBookingData.emit(null)}catch(t){console.log(t)}}render(){return e(i,{key:"cc7f04864115a6cf90bb887920f474fe3c7bd2b0"},e("div",{key:"7f1f0c8efc43aba08052a6638c3e5fe36da0dd20",class:"p-1"},e("div",{key:"95b8a79644d367bc8fae1a5cd2293cb6eb364f06",class:"extra-service-container"},e("p",{key:"37e289fab2fd6e71d8b72fdc2e6cad5b480f747d",class:"extra-service-description"},this.service.description),e("div",{key:"b6a9a273450bdcf5a4d9789fbfd290fdbf5b5517",class:"extra-service-actions"},this.service.price&&e("p",{key:"9471b2970df39fa976de926b6c6575e6519b52a2",class:"extra-service-price p-0 m-0 font-weight-bold"},m(this.currencySymbol,this.service.price)),e("ir-button",{key:"c320a5591408c55f82fa20352c8ffc8893b521ed",id:`serviceEdit-${this.service.booking_system_id}`,class:"extra-service-edit-btn m-0 p-0",variant:"icon",icon_name:"edit",style:Xt.secondary,onClickHandler:()=>this.editExtraService.emit(this.service)}),e("ir-button",{key:"824d7fd7d0b7b931ab4978f9c8526a4ee0577492",class:"extra-service-delete-btn m-0 p-0",variant:"icon",onClickHandler:()=>this.irModalRef.openModal(),id:`roomDelete-${this.service.booking_system_id}`,icon_name:"trash",style:Xt.danger}))),e("div",{key:"4648780d1d83317d1790b9f52ccaec71cadf03c4",class:"extra-service-conditional-date"},this.service.start_date&&this.service.end_date?e("ir-date-view",{class:"extra-service-date-view mr-1",from_date:this.service.start_date,to_date:this.service.end_date,showDateDifference:false}):this.service.start_date&&e("p",{class:"extra-service-date-view"},U(new Date(this.service.start_date)).format("MMM DD, YYYY")))),e("ir-modal",{key:"ce2b59371c51c67f076b64bbac0c31d40e1e4ad6",autoClose:false,ref:t=>this.irModalRef=t,isLoading:G("/Do_Booking_Extra_Service"),onConfirmModal:this.deleteService.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:p.entries.Lcz_Cancel,rightBtnText:p.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:p.entries.Lcz_Confirmation,modalBody:`${p.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${p.entries.Lcz_ThisService} ${p.entries.Lcz_FromThisBooking}`}))}};tn.style=Qs;const en=D.object({type:D.object({code:D.union([D.string().min(3),D.literal("")]).optional(),description:D.union([D.string(),D.literal("")]).optional()}),number:D.union([D.string().min(2),D.literal("")]).optional()});const sn=D.object({id:D.number().optional(),first_name:D.union([D.string().min(2),D.literal("")]).optional(),last_name:D.union([D.string().min(2),D.literal("")]).optional(),country_id:D.coerce.number().min(0).optional(),dob:D.string().optional().refine((t=>t===undefined||U(t,"DD/MM/YYYY",true).isValid()||t===""),"Invalid date format").transform((t=>{if(t===undefined||t==="")return null;const e=U(t,"DD/MM/YYYY",true).isValid();return e?null:t})),id_info:en.optional()});const nn=D.array(sn);const on=D.object({booking_system_id:D.number().optional(),cost:D.coerce.number().nullable(),currency_id:D.number().min(1),description:D.string().min(1),end_date:D.string().nullable(),price:D.coerce.number(),start_date:D.string().nullable(),system_id:D.number().optional()});const rn=".sc-ir-extra-service-config-h{display:block;--ir-input-border-color:#cacfe7}.sc-ir-extra-service-config-h .input-group-text.sc-ir-extra-service-config{border-color:var(--ir-input-border-color)}.currency-ph.sc-ir-extra-service-config{padding:0;margin:0;color:#3b4781;display:flex;align-items:center;justify-content:center;padding:0 0 0 0.25rem;border-top:1px solid var(--ir-input-border-color);border-bottom:1px solid var(--ir-input-border-color);border-left:1px solid transparent;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.service-description-input.sc-ir-extra-service-config{height:70px !important}.service-description.sc-ir-extra-service-config .input-group-prepend.sc-ir-extra-service-config{background-color:#f4f5fa;border:1px solid var(--ir-input-border-color);border-top-left-radius:0.25rem;border-bottom-left-radius:0.25rem}.service-date-container.sc-ir-extra-service-config{padding:0;margin:0;display:flex;align-items:center;position:relative;width:100%;justify-content:center}.service-date-container.sc-ir-extra-service-config .btn-container.sc-ir-extra-service-config{position:absolute;right:5px;margin:0;display:flex;align-items:center;justify-content:center;padding:0}.service-description.sc-ir-extra-service-config .input-group-text.sc-ir-extra-service-config{height:fit-content;border:0;padding-top:0.75rem !important}.price-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config,.cost-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config{border-top:1px solid #1e9ff2;border-bottom:1px solid #1e9ff2;border-left:1px solid #1e9ff2}.currency-ph[data-state='error'].sc-ir-extra-service-config{border-color:var(--red, #ff4961)}.price-input.sc-ir-extra-service-config:focus{border-right-width:1px !important}.is-invalid.sc-ir-extra-service-config{background-image:none !important}.price-input.sc-ir-extra-service-config,.cost-input.sc-ir-extra-service-config{border-left:0}.row-group.sc-ir-extra-service-config{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 640px){.row-group.sc-ir-extra-service-config{flex-direction:row;align-items:center;gap:0}.cost-label.sc-ir-extra-service-config{border-top-left-radius:0;border-bottom-left-radius:0;border-left:0}.until-prepend.sc-ir-extra-service-config,.cost-input-placeholder.sc-ir-extra-service-config{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.date-from.sc-ir-extra-service-config,.price-input.sc-ir-extra-service-config{border-right-width:0 !important;border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}}";const an=rn;const ln=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingData=s(this,"resetBookingData",7);this.bookingService=new l;this.booking=undefined;this.service=undefined;this.s_service=undefined;this.error=undefined;this.fromDateClicked=undefined;this.toDateClicked=undefined}componentWillLoad(){if(this.service){this.s_service=Object.assign({},this.service)}}async saveAmenity(){try{on.parse(this.s_service);await this.bookingService.doBookingExtraService({service:this.s_service,booking_nbr:this.booking.booking_nbr,is_remove:false});this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){if(t instanceof T){this.error=true}console.error(t)}}updateService(t){let e=this.s_service;if(!e){e={cost:null,description:null,end_date:null,start_date:null,price:null,currency_id:this.booking.currency.id}}this.s_service=Object.assign(Object.assign({},e),t)}validatePrice(){var t,e,i,s;if(((t=this.s_service)===null||t===void 0?void 0:t.price)===undefined||((i=(e=this.s_service)===null||e===void 0?void 0:e.price)===null||i===void 0?void 0:i.toString())===""){return false}const n=on.pick({price:true});const o=n.safeParse({price:(s=this.s_service)===null||s===void 0?void 0:s.price});return o.success}render(){var t,s,n,o,r,a,l,c,h,d,u,f,b,g;return e(i,{key:"3f79671811e51823e9bc3c3fb32aaddde3ab798b",class:"p-0"},e("ir-title",{key:"453c35acc59be7857d4ad139949831f022dcafcd",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:p.entries.Lcz_ExtraServices,displayContext:"sidebar"}),e("section",{key:"4b2b12dca006ab4e2db3c2dffe6e1a04f84e9db2",class:"px-1"},e("fieldset",{key:"4ff9d244c60abd0d10ef4ab7299a8e0e22af7dd8",class:"input-group mb-1 mt-3 service-description"},e("div",{key:"897d7a14f7752a7bac3128abfa30c8a25d862aa5",class:"input-group-prepend"},e("span",{key:"f87cb983dc43afec09f052facde73ada2e7e8562",class:"input-group-text"},p.entries.Lcz_Description)),e("textarea",{key:"4c96445d3e0f407384649273b324ab88fe9219f8",value:(t=this.s_service)===null||t===void 0?void 0:t.description,class:`form-control service-description-input ${this.error&&!((s=this.s_service)===null||s===void 0?void 0:s.description)?"is-invalid":""}`,style:{height:"7rem"},maxLength:250,onChange:t=>this.updateService({description:t.target.value}),"aria-label":"Amenity description"})),e("div",{key:"7f8a11847439c23e19020b1c34ce2f9c6a15bb6e",class:"row-group mb-1"},e("div",{key:"79a69e4522d84057e533579bd1eeed650dc62b4c",class:"input-group"},e("div",{key:"e80c425ad3103e98e7e968c9f13fc8fd680cf794",class:"input-group-prepend"},e("span",{key:"cd25f0c5edb4c3eff4b69591d10eb25fdff76af8",class:"input-group-text",id:"basic-addon1"},p.entries.Lcz_DatesOn)),e("div",{key:"5ec6a3a035a858fb303688d4b82bd49179cf04ac",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from"},e("div",{key:"ce8957fd24687e6dc24751fdf4d01928bca7f134",class:"service-date-container"},e("ir-date-picker",{key:"5204e7fb1a9d6d486c807111ee1a6530e978fac9",date:((n=this.s_service)===null||n===void 0?void 0:n.start_date)?new Date((o=this.s_service)===null||o===void 0?void 0:o.start_date):new Date(this.booking.from_date),class:`hidden-date-picker ${!((r=this.s_service)===null||r===void 0?void 0:r.start_date)?"hidden-date s":""}`,autoApply:true,singleDatePicker:true,minDate:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:t=>this.updateService({start_date:t.detail.start.format("YYYY-MM-DD")})}),((a=this.s_service)===null||a===void 0?void 0:a.start_date)&&e("div",{key:"b400d9a293885d3a7664c9530481ae04dac0f368",class:"btn-container"},e("ir-button",{key:"ae9191397469b1b37c22cb667cc4d50d24ec1923",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateService({start_date:null})}}))))),e("div",{key:"ddcfd52b7597a4c1961bfca060de05859a0ac006",class:"input-group"},e("div",{key:"3acebfff0175eb35bd7a89533528b749889eb6c4",class:"input-group-prepend "},e("span",{key:"b13c9234d68d8e9c5d3d797eb01a4f8d4479788c",class:"input-group-text until-prepend",id:"basic-addon1"},p.entries.Lcz_TillAndIncluding)),e("div",{key:"cff0397d673ea9d10ce97c27f24f676bb1d8b974",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center"},e("div",{key:"2718bb3e71ca09844667406323edcd4e5ab24119",class:"service-date-container"},e("ir-date-picker",{key:"d3ecea6886378c3f3d154f47d84c36ca71a1d4cc",date:((l=this.s_service)===null||l===void 0?void 0:l.end_date)?new Date((c=this.s_service)===null||c===void 0?void 0:c.end_date):new Date(this.booking.to_date),class:`hidden-date-picker ${!((h=this.s_service)===null||h===void 0?void 0:h.end_date)?"hidden-dates":""}`,autoApply:true,singleDatePicker:true,minDate:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateService({end_date:t.detail.start.format("YYYY-MM-DD")})}}),((d=this.s_service)===null||d===void 0?void 0:d.end_date)&&e("div",{key:"407ffaa31516fcd22a8c9b4ece1aeb18d26a02cc",class:"btn-container"},e("ir-button",{key:"03231ee5d7c188a421904d6f1b577defe6a935fe",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateService({end_date:null})}})))))),e("div",{key:"bf8b74254487d2e0dfc59c4b058dc024a8203d9a",class:"row-group"},e("ir-price-input",{key:"8b44b90e09e6de7b4321cf85610c7fd302e6eb75",label:"Price",currency:this.booking.currency.symbol,class:"ir-br-input-none",value:(f=(u=this.s_service)===null||u===void 0?void 0:u.price)===null||f===void 0?void 0:f.toString(),zod:on.pick({price:true}),"aria-label":p.entries.Lcz_Price,wrapKey:"price","aria-describedby":"service price",autoValidate:false,"data-state":this.error&&!this.validatePrice()?"error":"",onTextChange:t=>this.updateService({price:parseFloat(t.detail)})}),e("ir-price-input",{key:"93b6d28be1a3b99688780b0f9a4898d60142ff73",autoValidate:false,label:p.entries.Lcz_Cost,labelStyle:"cost-label",currency:this.booking.currency.symbol,value:(g=(b=this.s_service)===null||b===void 0?void 0:b.cost)===null||g===void 0?void 0:g.toString(),zod:on.pick({cost:true}),onTextChange:t=>this.updateService({cost:parseFloat(t.detail)}),wrapKey:"cost","aria-label":"Cost","aria-describedby":"service cost"})),e("div",{key:"321fe0de56ba448a5624e19fd7b5c816ee90e46d",class:"d-flex flex-column flex-sm-row mt-3"},e("ir-button",{key:"a839f5f822887b3ad84f3064f8cedcba3d9166d0",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill mr-sm-1`,icon:"",text:p.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{key:"94316a7f80c06c19f54740ad0450a733cd90e3c6",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:G("/Do_Booking_Extra_Service"),text:p.entries.Lcz_Save,btn_color:"primary",onClick:this.saveAmenity.bind(this)}))))}};ln.style=an;const cn=".sc-ir-extra-services-h{display:block}";const hn=cn;const dn=class{constructor(e){t(this,e);this.booking=undefined}render(){var t;return e(i,{key:"fceaf5a00751b9ec31fa055565d639ceaf2a829a",class:"card p-0 "},(t=this.booking.extra_services)===null||t===void 0?void 0:t.map(((t,i)=>e(n,null,e("ir-extra-service",{bookingNumber:this.booking.booking_nbr,currencySymbol:this.booking.currency.symbol,key:t.booking_system_id,service:t}),i!==this.booking.extra_services.length-1&&e("hr",{class:"mr-2 ml-2 my-0 p-0"})))))}};dn.style=hn;const un=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}.loading-container.sc-ir-guest-info{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}";const fn=un;const pn=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.resetbooking=s(this,"resetbooking",7);this.bookingService=new l;this.roomService=new J;this.token=new Z;this.language=undefined;this.headerShown=undefined;this.email=undefined;this.booking_nbr=undefined;this.ticket=undefined;this.isInSideBar=undefined;this.countries=undefined;this.guest=null;this.isLoading=false}async componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}if(!!this.token.getToken())this.init()}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.init()}async init(){try{console.log("first");this.isLoading=true;const[t,e,i]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language),!p||!p.entries||Object.keys(p.entries).length===0?this.roomService.fetchLanguage(this.language):Promise.resolve(null)]);if(i){p.entries=i.entries;p.direction=i.direction}this.countries=e;this.guest=Object.assign(Object.assign({},t),{mobile:t.mobile_without_prefix})}catch(t){console.log(t)}finally{this.isLoading=false}}handleInputChange(t){this.guest=Object.assign(Object.assign({},this.guest),t)}async editGuest(){var t;try{await this.bookingService.editExposedGuest(this.guest,(t=this.booking_nbr)!==null&&t!==void 0?t:null);this.closeSideBar.emit(null);this.resetbooking.emit(null)}catch(t){console.log(t)}}render(){var t,i,s,n,o;if(this.isLoading&&this.isInSideBar){e("div",{class:"loading-container"},e("ir-spinner",null))}if(this.isLoading){return null}return[e("div",{class:"p-0"},this.headerShown&&e("div",{class:"position-sticky mb-1 shadow-none p-0"},e("div",{class:"d-flex align-items-center justify-content-between ir-card-header py-1 p-0"},e("h3",{class:"card-title text-left font-medium-2 px-1 my-0"},p.entries.Lcz_GuestDetails),e("ir-icon",{class:"close close-icon px-1",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("div",{class:"card-content collapse show"},e("div",{class:this.headerShown?"card-body px-1":"pt-0"},e("ir-input-text",{placeholder:"",label:p.entries.Lcz_FirstName,name:"firstName",value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:t=>this.handleInputChange({first_name:t.detail})}),e("ir-input-text",{placeholder:"",label:p.entries.Lcz_LastName,name:"lastName",value:(i=this.guest)===null||i===void 0?void 0:i.last_name,required:true,onTextChange:t=>this.handleInputChange({last_name:t.detail})}),e("ir-input-text",{placeholder:"",label:p.entries.Lcz_Email,name:"email",value:(s=this.guest)===null||s===void 0?void 0:s.email,required:true,onTextChange:t=>this.handleInputChange({email:t.detail})}),e("ir-input-text",{placeholder:"",label:p.entries.Lcz_AlternativeEmail,name:"altEmail",value:(n=this.guest)===null||n===void 0?void 0:n.alternative_email,onTextChange:t=>this.handleInputChange({alternative_email:t.detail})}),e("ir-country-picker",{country:this.countries.find((t=>t.id===this.guest.country_id)),label:p.entries.Lcz_Country,onCountryChange:t=>this.handleInputChange({country_id:t.detail.id}),countries:this.countries}),e("ir-phone-input",{onTextChange:t=>{t.stopImmediatePropagation();t.stopPropagation();const{mobile:e,phone_prefix:i}=t.detail;if(e!==this.guest.mobile){this.handleInputChange({mobile:e})}if(i!==this.guest.country_phone_prefix)this.handleInputChange({country_phone_prefix:i})},phone_prefix:this.guest.country_phone_prefix,value:this.guest.mobile,language:this.language,label:p.entries.Lcz_MobilePhone,countries:this.countries}),e("div",{class:"mb-2"},e("ir-textarea",{variant:"prepend",onTextChange:t=>this.handleInputChange({notes:t.detail}),value:(o=this.guest)===null||o===void 0?void 0:o.notes,label:p.entries.Lcz_PrivateNote})),e("div",{class:"p-0 m-0"},e("label",{class:`check-container m-0 p-0`},e("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange({subscribe_to_news_letter:t.target.checked})}),e("span",{class:"checkmark m-0 p-0"}),e("span",{class:"m-0 p-0  check-label"},p.entries.Lcz_Newsletter))),e("hr",null),e("ir-button",{isLoading:G("/Edit_Exposed_Guest"),btn_disabled:this.isLoading,btn_styles:"d-flex align-items-center justify-content-center",text:p.entries.Lcz_Save,onClickHandler:this.editGuest.bind(this),color:"btn-primary"}))))]}static get watchers(){return{ticket:["ticketChanged"]}}};pn.style=fn;const bn=".sc-ir-icon-h{margin:0;padding:0}.icon-button.sc-ir-icon{all:unset;margin:0;padding:0;color:#6b6f82}.icon-button.sc-ir-icon:hover{cursor:pointer;color:#104064}";const gn=bn;const mn=class{constructor(e){t(this,e);this.iconClickHandler=s(this,"iconClickHandler",7);this.icon="ft-check"}render(){return e("button",{key:"9c3efd9f784015a1982d9588ce97199905571c96",class:"icon-button",onClick:()=>this.iconClickHandler.emit()},e("slot",{key:"bffa9eef2fd49718e829c4556bc98ca822346975",name:"icon"}))}};mn.style=gn;const vn=".sc-ir-icons-h{display:block;box-sizing:border-box;margin:0;padding:0}.icon.sc-ir-icons{height:var(--icon-size, 1.25rem);width:var(--icon-size, 1.25rem);margin:0;padding:0}";const yn=vn;const kn=class{constructor(e){t(this,e);this.name=undefined;this.svgClassName=undefined;this.color=undefined}render(){const t=qt[this.name]||null;if(!t){return null}return e("svg",{xmlns:"http://www.w3.org/2000/svg",color:this.color,viewBox:t.viewBox,class:`icon ${this.svgClassName}`},e("path",{fill:"currentColor",d:t.d}))}};kn.style=yn;function wn(t){return typeof t==="string"||t instanceof String}function xn(t){var e;return typeof t==="object"&&t!=null&&(t==null||(e=t.constructor)==null?void 0:e.name)==="Object"}function _n(t,e){if(Array.isArray(e))return _n(t,((t,i)=>e.includes(i)));return Object.entries(t).reduce(((t,i)=>{let[s,n]=i;if(e(n,s))t[s]=n;return t}),{})}const Dn={NONE:"NONE",LEFT:"LEFT",FORCE_LEFT:"FORCE_LEFT",RIGHT:"RIGHT",FORCE_RIGHT:"FORCE_RIGHT"};function Cn(t){switch(t){case Dn.LEFT:return Dn.FORCE_LEFT;case Dn.RIGHT:return Dn.FORCE_RIGHT;default:return t}}function On(t){return t.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function En(t,e){if(e===t)return true;const i=Array.isArray(e),s=Array.isArray(t);let n;if(i&&s){if(e.length!=t.length)return false;for(n=0;n<e.length;n++)if(!En(e[n],t[n]))return false;return true}if(i!=s)return false;if(e&&t&&typeof e==="object"&&typeof t==="object"){const i=e instanceof Date,s=t instanceof Date;if(i&&s)return e.getTime()==t.getTime();if(i!=s)return false;const o=e instanceof RegExp,r=t instanceof RegExp;if(o&&r)return e.toString()==t.toString();if(o!=r)return false;const a=Object.keys(e);for(n=0;n<a.length;n++)if(!Object.prototype.hasOwnProperty.call(t,a[n]))return false;for(n=0;n<a.length;n++)if(!En(t[a[n]],e[a[n]]))return false;return true}else if(e&&t&&typeof e==="function"&&typeof t==="function"){return e.toString()===t.toString()}return false}class An{constructor(t){Object.assign(this,t);while(this.value.slice(0,this.startChangePos)!==this.oldValue.slice(0,this.startChangePos)){--this.oldSelection.start}if(this.insertedCount){while(this.value.slice(this.cursorPos)!==this.oldValue.slice(this.oldSelection.end)){if(this.value.length-this.cursorPos<this.oldValue.length-this.oldSelection.end)++this.oldSelection.end;else++this.cursorPos}}}get startChangePos(){return Math.min(this.cursorPos,this.oldSelection.start)}get insertedCount(){return this.cursorPos-this.startChangePos}get inserted(){return this.value.substr(this.startChangePos,this.insertedCount)}get removedCount(){return Math.max(this.oldSelection.end-this.startChangePos||this.oldValue.length-this.value.length,0)}get removed(){return this.oldValue.substr(this.startChangePos,this.removedCount)}get head(){return this.value.substring(0,this.startChangePos)}get tail(){return this.value.substring(this.startChangePos+this.insertedCount)}get removeDirection(){if(!this.removedCount||this.insertedCount)return Dn.NONE;return(this.oldSelection.end===this.cursorPos||this.oldSelection.start===this.cursorPos)&&this.oldSelection.end===this.oldSelection.start?Dn.RIGHT:Dn.LEFT}}function Bn(t,e){return new Bn.InputMask(t,e)}function Mn(t){if(t==null)throw new Error("mask property should be defined");if(t instanceof RegExp)return Bn.MaskedRegExp;if(wn(t))return Bn.MaskedPattern;if(t===Date)return Bn.MaskedDate;if(t===Number)return Bn.MaskedNumber;if(Array.isArray(t)||t===Array)return Bn.MaskedDynamic;if(Bn.Masked&&t.prototype instanceof Bn.Masked)return t;if(Bn.Masked&&t instanceof Bn.Masked)return t.constructor;if(t instanceof Function)return Bn.MaskedFunction;console.warn("Mask not found for mask",t);return Bn.Masked}function Tn(t){if(!t)throw new Error("Options in not defined");if(Bn.Masked){if(t.prototype instanceof Bn.Masked)return{mask:t};const{mask:e=undefined,...i}=t instanceof Bn.Masked?{mask:t}:xn(t)&&t.mask instanceof Bn.Masked?t:{};if(e){const t=e.mask;return{..._n(e,((t,e)=>!e.startsWith("_"))),mask:e.constructor,_mask:t,...i}}}if(!xn(t))return{mask:t};return{...t}}function In(t){if(Bn.Masked&&t instanceof Bn.Masked)return t;const e=Tn(t);const i=Mn(e.mask);if(!i)throw new Error("Masked class is not found for provided mask "+e.mask+", appropriate module needs to be imported manually before creating mask.");if(e.mask===i)delete e.mask;if(e._mask){e.mask=e._mask;delete e._mask}return new i(e)}Bn.createMask=In;class Sn{get selectionStart(){let t;try{t=this._unsafeSelectionStart}catch{}return t!=null?t:this.value.length}get selectionEnd(){let t;try{t=this._unsafeSelectionEnd}catch{}return t!=null?t:this.value.length}select(t,e){if(t==null||e==null||t===this.selectionStart&&e===this.selectionEnd)return;try{this._unsafeSelect(t,e)}catch{}}get isActive(){return false}}Bn.MaskElement=Sn;const Yn=90;const Nn=89;class Ln extends Sn{constructor(t){super();this.input=t;this._onKeydown=this._onKeydown.bind(this);this._onInput=this._onInput.bind(this);this._onBeforeinput=this._onBeforeinput.bind(this);this._onCompositionEnd=this._onCompositionEnd.bind(this)}get rootElement(){var t,e,i;return(t=(e=(i=this.input).getRootNode)==null?void 0:e.call(i))!=null?t:document}get isActive(){return this.input===this.rootElement.activeElement}bindEvents(t){this.input.addEventListener("keydown",this._onKeydown);this.input.addEventListener("input",this._onInput);this.input.addEventListener("beforeinput",this._onBeforeinput);this.input.addEventListener("compositionend",this._onCompositionEnd);this.input.addEventListener("drop",t.drop);this.input.addEventListener("click",t.click);this.input.addEventListener("focus",t.focus);this.input.addEventListener("blur",t.commit);this._handlers=t}_onKeydown(t){if(this._handlers.redo&&(t.keyCode===Yn&&t.shiftKey&&(t.metaKey||t.ctrlKey)||t.keyCode===Nn&&t.ctrlKey)){t.preventDefault();return this._handlers.redo(t)}if(this._handlers.undo&&t.keyCode===Yn&&(t.metaKey||t.ctrlKey)){t.preventDefault();return this._handlers.undo(t)}if(!t.isComposing)this._handlers.selectionChange(t)}_onBeforeinput(t){if(t.inputType==="historyUndo"&&this._handlers.undo){t.preventDefault();return this._handlers.undo(t)}if(t.inputType==="historyRedo"&&this._handlers.redo){t.preventDefault();return this._handlers.redo(t)}}_onCompositionEnd(t){this._handlers.input(t)}_onInput(t){if(!t.isComposing)this._handlers.input(t)}unbindEvents(){this.input.removeEventListener("keydown",this._onKeydown);this.input.removeEventListener("input",this._onInput);this.input.removeEventListener("beforeinput",this._onBeforeinput);this.input.removeEventListener("compositionend",this._onCompositionEnd);this.input.removeEventListener("drop",this._handlers.drop);this.input.removeEventListener("click",this._handlers.click);this.input.removeEventListener("focus",this._handlers.focus);this.input.removeEventListener("blur",this._handlers.commit);this._handlers={}}}Bn.HTMLMaskElement=Ln;class jn extends Ln{constructor(t){super(t);this.input=t}get _unsafeSelectionStart(){return this.input.selectionStart!=null?this.input.selectionStart:this.value.length}get _unsafeSelectionEnd(){return this.input.selectionEnd}_unsafeSelect(t,e){this.input.setSelectionRange(t,e)}get value(){return this.input.value}set value(t){this.input.value=t}}Bn.HTMLMaskElement=Ln;class Rn extends Ln{get _unsafeSelectionStart(){const t=this.rootElement;const e=t.getSelection&&t.getSelection();const i=e&&e.anchorOffset;const s=e&&e.focusOffset;if(s==null||i==null||i<s){return i}return s}get _unsafeSelectionEnd(){const t=this.rootElement;const e=t.getSelection&&t.getSelection();const i=e&&e.anchorOffset;const s=e&&e.focusOffset;if(s==null||i==null||i>s){return i}return s}_unsafeSelect(t,e){if(!this.rootElement.createRange)return;const i=this.rootElement.createRange();i.setStart(this.input.firstChild||this.input,t);i.setEnd(this.input.lastChild||this.input,e);const s=this.rootElement;const n=s.getSelection&&s.getSelection();if(n){n.removeAllRanges();n.addRange(i)}}get value(){return this.input.textContent||""}set value(t){this.input.textContent=t}}Bn.HTMLContenteditableMaskElement=Rn;class zn{constructor(){this.states=[];this.currentIndex=0}get currentState(){return this.states[this.currentIndex]}get isEmpty(){return this.states.length===0}push(t){if(this.currentIndex<this.states.length-1)this.states.length=this.currentIndex+1;this.states.push(t);if(this.states.length>zn.MAX_LENGTH)this.states.shift();this.currentIndex=this.states.length-1}go(t){this.currentIndex=Math.min(Math.max(this.currentIndex+t,0),this.states.length-1);return this.currentState}undo(){return this.go(-1)}redo(){return this.go(+1)}clear(){this.states.length=0;this.currentIndex=0}}zn.MAX_LENGTH=100;class $n{constructor(t,e){this.el=t instanceof Sn?t:t.isContentEditable&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"?new Rn(t):new jn(t);this.masked=In(e);this._listeners={};this._value="";this._unmaskedValue="";this._rawInputValue="";this.history=new zn;this._saveSelection=this._saveSelection.bind(this);this._onInput=this._onInput.bind(this);this._onChange=this._onChange.bind(this);this._onDrop=this._onDrop.bind(this);this._onFocus=this._onFocus.bind(this);this._onClick=this._onClick.bind(this);this._onUndo=this._onUndo.bind(this);this._onRedo=this._onRedo.bind(this);this.alignCursor=this.alignCursor.bind(this);this.alignCursorFriendly=this.alignCursorFriendly.bind(this);this._bindEvents();this.updateValue();this._onChange()}maskEquals(t){var e;return t==null||((e=this.masked)==null?void 0:e.maskEquals(t))}get mask(){return this.masked.mask}set mask(t){if(this.maskEquals(t))return;if(!(t instanceof Bn.Masked)&&this.masked.constructor===Mn(t)){this.masked.updateOptions({mask:t});return}const e=t instanceof Bn.Masked?t:In({mask:t});e.unmaskedValue=this.masked.unmaskedValue;this.masked=e}get value(){return this._value}set value(t){if(this.value===t)return;this.masked.value=t;this.updateControl("auto")}get unmaskedValue(){return this._unmaskedValue}set unmaskedValue(t){if(this.unmaskedValue===t)return;this.masked.unmaskedValue=t;this.updateControl("auto")}get rawInputValue(){return this._rawInputValue}set rawInputValue(t){if(this.rawInputValue===t)return;this.masked.rawInputValue=t;this.updateControl();this.alignCursor()}get typedValue(){return this.masked.typedValue}set typedValue(t){if(this.masked.typedValueEquals(t))return;this.masked.typedValue=t;this.updateControl("auto")}get displayValue(){return this.masked.displayValue}_bindEvents(){this.el.bindEvents({selectionChange:this._saveSelection,input:this._onInput,drop:this._onDrop,click:this._onClick,focus:this._onFocus,commit:this._onChange,undo:this._onUndo,redo:this._onRedo})}_unbindEvents(){if(this.el)this.el.unbindEvents()}_fireEvent(t,e){const i=this._listeners[t];if(!i)return;i.forEach((t=>t(e)))}get selectionStart(){return this._cursorChanging?this._changingCursorPos:this.el.selectionStart}get cursorPos(){return this._cursorChanging?this._changingCursorPos:this.el.selectionEnd}set cursorPos(t){if(!this.el||!this.el.isActive)return;this.el.select(t,t);this._saveSelection()}_saveSelection(){if(this.displayValue!==this.el.value){console.warn("Element value was changed outside of mask. Syncronize mask using `mask.updateValue()` to work properly.")}this._selection={start:this.selectionStart,end:this.cursorPos}}updateValue(){this.masked.value=this.el.value;this._value=this.masked.value;this._unmaskedValue=this.masked.unmaskedValue;this._rawInputValue=this.masked.rawInputValue}updateControl(t){const e=this.masked.unmaskedValue;const i=this.masked.value;const s=this.masked.rawInputValue;const n=this.displayValue;const o=this.unmaskedValue!==e||this.value!==i||this._rawInputValue!==s;this._unmaskedValue=e;this._value=i;this._rawInputValue=s;if(this.el.value!==n)this.el.value=n;if(t==="auto")this.alignCursor();else if(t!=null)this.cursorPos=t;if(o)this._fireChangeEvents();if(!this._historyChanging&&(o||this.history.isEmpty))this.history.push({unmaskedValue:e,selection:{start:this.selectionStart,end:this.cursorPos}})}updateOptions(t){const{mask:e,...i}=t;const s=!this.maskEquals(e);const n=this.masked.optionsIsChanged(i);if(s)this.mask=e;if(n)this.masked.updateOptions(i);if(s||n)this.updateControl()}updateCursor(t){if(t==null)return;this.cursorPos=t;this._delayUpdateCursor(t)}_delayUpdateCursor(t){this._abortUpdateCursor();this._changingCursorPos=t;this._cursorChanging=setTimeout((()=>{if(!this.el)return;this.cursorPos=this._changingCursorPos;this._abortUpdateCursor()}),10)}_fireChangeEvents(){this._fireEvent("accept",this._inputEvent);if(this.masked.isComplete)this._fireEvent("complete",this._inputEvent)}_abortUpdateCursor(){if(this._cursorChanging){clearTimeout(this._cursorChanging);delete this._cursorChanging}}alignCursor(){this.cursorPos=this.masked.nearestInputPos(this.masked.nearestInputPos(this.cursorPos,Dn.LEFT))}alignCursorFriendly(){if(this.selectionStart!==this.cursorPos)return;this.alignCursor()}on(t,e){if(!this._listeners[t])this._listeners[t]=[];this._listeners[t].push(e);return this}off(t,e){if(!this._listeners[t])return this;if(!e){delete this._listeners[t];return this}const i=this._listeners[t].indexOf(e);if(i>=0)this._listeners[t].splice(i,1);return this}_onInput(t){this._inputEvent=t;this._abortUpdateCursor();const e=new An({value:this.el.value,cursorPos:this.cursorPos,oldValue:this.displayValue,oldSelection:this._selection});const i=this.masked.rawInputValue;const s=this.masked.splice(e.startChangePos,e.removed.length,e.inserted,e.removeDirection,{input:true,raw:true}).offset;const n=i===this.masked.rawInputValue?e.removeDirection:Dn.NONE;let o=this.masked.nearestInputPos(e.startChangePos+s,n);if(n!==Dn.NONE)o=this.masked.nearestInputPos(o,Dn.NONE);this.updateControl(o);delete this._inputEvent}_onChange(){if(this.displayValue!==this.el.value)this.updateValue();this.masked.doCommit();this.updateControl();this._saveSelection()}_onDrop(t){t.preventDefault();t.stopPropagation()}_onFocus(t){this.alignCursorFriendly()}_onClick(t){this.alignCursorFriendly()}_onUndo(){this._applyHistoryState(this.history.undo())}_onRedo(){this._applyHistoryState(this.history.redo())}_applyHistoryState(t){if(!t)return;this._historyChanging=true;this.unmaskedValue=t.unmaskedValue;this.el.select(t.selection.start,t.selection.end);this._saveSelection();this._historyChanging=false}destroy(){this._unbindEvents();this._listeners.length=0;delete this.el}}Bn.InputMask=$n;class Fn{static normalize(t){return Array.isArray(t)?t:[t,new Fn]}constructor(t){Object.assign(this,{inserted:"",rawInserted:"",tailShift:0,skip:false},t)}aggregate(t){this.inserted+=t.inserted;this.rawInserted+=t.rawInserted;this.tailShift+=t.tailShift;this.skip=this.skip||t.skip;return this}get offset(){return this.tailShift+this.inserted.length}get consumed(){return Boolean(this.rawInserted)||this.skip}equals(t){return this.inserted===t.inserted&&this.tailShift===t.tailShift&&this.rawInserted===t.rawInserted&&this.skip===t.skip}}Bn.ChangeDetails=Fn;class Pn{constructor(t,e,i){if(t===void 0){t=""}if(e===void 0){e=0}this.value=t;this.from=e;this.stop=i}toString(){return this.value}extend(t){this.value+=String(t)}appendTo(t){return t.append(this.toString(),{tail:true}).aggregate(t._appendPlaceholder())}get state(){return{value:this.value,from:this.from,stop:this.stop}}set state(t){Object.assign(this,t)}unshift(t){if(!this.value.length||t!=null&&this.from>=t)return"";const e=this.value[0];this.value=this.value.slice(1);return e}shift(){if(!this.value.length)return"";const t=this.value[this.value.length-1];this.value=this.value.slice(0,-1);return t}}class Hn{constructor(t){this._value="";this._update({...Hn.DEFAULTS,...t});this._initialized=true}updateOptions(t){if(!this.optionsIsChanged(t))return;this.withValueRefresh(this._update.bind(this,t))}_update(t){Object.assign(this,t)}get state(){return{_value:this.value,_rawInputValue:this.rawInputValue}}set state(t){this._value=t._value}reset(){this._value=""}get value(){return this._value}set value(t){this.resolve(t,{input:true})}resolve(t,e){if(e===void 0){e={input:true}}this.reset();this.append(t,e,"");this.doCommit()}get unmaskedValue(){return this.value}set unmaskedValue(t){this.resolve(t,{})}get typedValue(){return this.parse?this.parse(this.value,this):this.unmaskedValue}set typedValue(t){if(this.format){this.value=this.format(t,this)}else{this.unmaskedValue=String(t)}}get rawInputValue(){return this.extractInput(0,this.displayValue.length,{raw:true})}set rawInputValue(t){this.resolve(t,{raw:true})}get displayValue(){return this.value}get isComplete(){return true}get isFilled(){return this.isComplete}nearestInputPos(t,e){return t}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return Math.min(this.displayValue.length,e-t)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return this.displayValue.slice(t,e)}extractTail(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return new Pn(this.extractInput(t,e),t)}appendTail(t){if(wn(t))t=new Pn(String(t));return t.appendTo(this)}_appendCharRaw(t,e){if(!t)return new Fn;this._value+=t;return new Fn({inserted:t,rawInserted:t})}_appendChar(t,e,i){if(e===void 0){e={}}const s=this.state;let n;[t,n]=this.doPrepareChar(t,e);if(t){n=n.aggregate(this._appendCharRaw(t,e));if(!n.rawInserted&&this.autofix==="pad"){const i=this.state;this.state=s;let o=this.pad(e);const r=this._appendCharRaw(t,e);o=o.aggregate(r);if(r.rawInserted||o.equals(n)){n=o}else{this.state=i}}}if(n.inserted){let t;let o=this.doValidate(e)!==false;if(o&&i!=null){const e=this.state;if(this.overwrite===true){t=i.state;for(let t=0;t<n.rawInserted.length;++t){i.unshift(this.displayValue.length-n.tailShift)}}let s=this.appendTail(i);o=s.rawInserted.length===i.toString().length;if(!(o&&s.inserted)&&this.overwrite==="shift"){this.state=e;t=i.state;for(let t=0;t<n.rawInserted.length;++t){i.shift()}s=this.appendTail(i);o=s.rawInserted.length===i.toString().length}if(o&&s.inserted)this.state=e}if(!o){n=new Fn;this.state=s;if(i&&t)i.state=t}}return n}_appendPlaceholder(){return new Fn}_appendEager(){return new Fn}append(t,e,i){if(!wn(t))throw new Error("value should be string");const s=wn(i)?new Pn(String(i)):i;if(e!=null&&e.tail)e._beforeTailState=this.state;let n;[t,n]=this.doPrepare(t,e);for(let i=0;i<t.length;++i){const o=this._appendChar(t[i],e,s);if(!o.rawInserted&&!this.doSkipInvalid(t[i],e,s))break;n.aggregate(o)}if((this.eager===true||this.eager==="append")&&e!=null&&e.input&&t){n.aggregate(this._appendEager())}if(s!=null){n.tailShift+=this.appendTail(s).tailShift}return n}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}this._value=this.displayValue.slice(0,t)+this.displayValue.slice(e);return new Fn}withValueRefresh(t){if(this._refreshing||!this._initialized)return t();this._refreshing=true;const e=this.rawInputValue;const i=this.value;const s=t();this.rawInputValue=e;if(this.value&&this.value!==i&&i.indexOf(this.value)===0){this.append(i.slice(this.displayValue.length),{},"");this.doCommit()}delete this._refreshing;return s}runIsolated(t){if(this._isolated||!this._initialized)return t(this);this._isolated=true;const e=this.state;const i=t(this);this.state=e;delete this._isolated;return i}doSkipInvalid(t,e,i){return Boolean(this.skipInvalid)}doPrepare(t,e){if(e===void 0){e={}}return Fn.normalize(this.prepare?this.prepare(t,this,e):t)}doPrepareChar(t,e){if(e===void 0){e={}}return Fn.normalize(this.prepareChar?this.prepareChar(t,this,e):t)}doValidate(t){return(!this.validate||this.validate(this.value,this,t))&&(!this.parent||this.parent.doValidate(t))}doCommit(){if(this.commit)this.commit(this.value,this)}splice(t,e,i,s,n){if(i===void 0){i=""}if(s===void 0){s=Dn.NONE}if(n===void 0){n={input:true}}const o=t+e;const r=this.extractTail(o);const a=this.eager===true||this.eager==="remove";let l;if(a){s=Cn(s);l=this.extractInput(0,o,{raw:true})}let c=t;const h=new Fn;if(s!==Dn.NONE){c=this.nearestInputPos(t,e>1&&t!==0&&!a?Dn.NONE:s);h.tailShift=c-t}h.aggregate(this.remove(c));if(a&&s!==Dn.NONE&&l===this.rawInputValue){if(s===Dn.FORCE_LEFT){let t;while(l===this.rawInputValue&&(t=this.displayValue.length)){h.aggregate(new Fn({tailShift:-1})).aggregate(this.remove(t-1))}}else if(s===Dn.FORCE_RIGHT){r.unshift()}}return h.aggregate(this.append(i,n,r))}maskEquals(t){return this.mask===t}optionsIsChanged(t){return!En(this,t)}typedValueEquals(t){const e=this.typedValue;return t===e||Hn.EMPTY_VALUES.includes(t)&&Hn.EMPTY_VALUES.includes(e)||(this.format?this.format(t,this)===this.format(this.typedValue,this):false)}pad(t){return new Fn}}Hn.DEFAULTS={skipInvalid:true};Hn.EMPTY_VALUES=[undefined,null,""];Bn.Masked=Hn;class Vn{constructor(t,e){if(t===void 0){t=[]}if(e===void 0){e=0}this.chunks=t;this.from=e}toString(){return this.chunks.map(String).join("")}extend(t){if(!String(t))return;t=wn(t)?new Pn(String(t)):t;const e=this.chunks[this.chunks.length-1];const i=e&&(e.stop===t.stop||t.stop==null)&&t.from===e.from+e.toString().length;if(t instanceof Pn){if(i){e.extend(t.toString())}else{this.chunks.push(t)}}else if(t instanceof Vn){if(t.stop==null){let e;while(t.chunks.length&&t.chunks[0].stop==null){e=t.chunks.shift();e.from+=t.from;this.extend(e)}}if(t.toString()){t.stop=t.blockIndex;this.chunks.push(t)}}}appendTo(t){if(!(t instanceof Bn.MaskedPattern)){const e=new Pn(this.toString());return e.appendTo(t)}const e=new Fn;for(let i=0;i<this.chunks.length;++i){const s=this.chunks[i];const n=t._mapPosToBlock(t.displayValue.length);const o=s.stop;let r;if(o!=null&&(!n||n.index<=o)){if(s instanceof Vn||t._stops.indexOf(o)>=0){e.aggregate(t._appendPlaceholder(o))}r=s instanceof Vn&&t._blocks[o]}if(r){const i=r.appendTail(s);e.aggregate(i);const n=s.toString().slice(i.rawInserted.length);if(n)e.aggregate(t.append(n,{tail:true}))}else{e.aggregate(t.append(s.toString(),{tail:true}))}}return e}get state(){return{chunks:this.chunks.map((t=>t.state)),from:this.from,stop:this.stop,blockIndex:this.blockIndex}}set state(t){const{chunks:e,...i}=t;Object.assign(this,i);this.chunks=e.map((t=>{const e="chunks"in t?new Vn:new Pn;e.state=t;return e}))}unshift(t){if(!this.chunks.length||t!=null&&this.from>=t)return"";const e=t!=null?t-this.from:t;let i=0;while(i<this.chunks.length){const t=this.chunks[i];const s=t.unshift(e);if(t.toString()){if(!s)break;++i}else{this.chunks.splice(i,1)}if(s)return s}return""}shift(){if(!this.chunks.length)return"";let t=this.chunks.length-1;while(0<=t){const e=this.chunks[t];const i=e.shift();if(e.toString()){if(!i)break;--t}else{this.chunks.splice(t,1)}if(i)return i}return""}}class Un{constructor(t,e){this.masked=t;this._log=[];const{offset:i,index:s}=t._mapPosToBlock(e)||(e<0?{index:0,offset:0}:{index:this.masked._blocks.length,offset:0});this.offset=i;this.index=s;this.ok=false}get block(){return this.masked._blocks[this.index]}get pos(){return this.masked._blockStartPos(this.index)+this.offset}get state(){return{index:this.index,offset:this.offset,ok:this.ok}}set state(t){Object.assign(this,t)}pushState(){this._log.push(this.state)}popState(){const t=this._log.pop();if(t)this.state=t;return t}bindBlock(){if(this.block)return;if(this.index<0){this.index=0;this.offset=0}if(this.index>=this.masked._blocks.length){this.index=this.masked._blocks.length-1;this.offset=this.block.displayValue.length}}_pushLeft(t){this.pushState();for(this.bindBlock();0<=this.index;--this.index,this.offset=((e=this.block)==null?void 0:e.displayValue.length)||0){var e;if(t())return this.ok=true}return this.ok=false}_pushRight(t){this.pushState();for(this.bindBlock();this.index<this.masked._blocks.length;++this.index,this.offset=0){if(t())return this.ok=true}return this.ok=false}pushLeftBeforeFilled(){return this._pushLeft((()=>{if(this.block.isFixed||!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,Dn.FORCE_LEFT);if(this.offset!==0)return true}))}pushLeftBeforeInput(){return this._pushLeft((()=>{if(this.block.isFixed)return;this.offset=this.block.nearestInputPos(this.offset,Dn.LEFT);return true}))}pushLeftBeforeRequired(){return this._pushLeft((()=>{if(this.block.isFixed||this.block.isOptional&&!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,Dn.LEFT);return true}))}pushRightBeforeFilled(){return this._pushRight((()=>{if(this.block.isFixed||!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,Dn.FORCE_RIGHT);if(this.offset!==this.block.value.length)return true}))}pushRightBeforeInput(){return this._pushRight((()=>{if(this.block.isFixed)return;this.offset=this.block.nearestInputPos(this.offset,Dn.NONE);return true}))}pushRightBeforeRequired(){return this._pushRight((()=>{if(this.block.isFixed||this.block.isOptional&&!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,Dn.NONE);return true}))}}class Gn{constructor(t){Object.assign(this,t);this._value="";this.isFixed=true}get value(){return this._value}get unmaskedValue(){return this.isUnmasking?this.value:""}get rawInputValue(){return this._isRawInput?this.value:""}get displayValue(){return this.value}reset(){this._isRawInput=false;this._value=""}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this._value.length}this._value=this._value.slice(0,t)+this._value.slice(e);if(!this._value)this._isRawInput=false;return new Fn}nearestInputPos(t,e){if(e===void 0){e=Dn.NONE}const i=0;const s=this._value.length;switch(e){case Dn.LEFT:case Dn.FORCE_LEFT:return i;case Dn.NONE:case Dn.RIGHT:case Dn.FORCE_RIGHT:default:return s}}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this._value.length}return this._isRawInput?e-t:0}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this._value.length}if(i===void 0){i={}}return i.raw&&this._isRawInput&&this._value.slice(t,e)||""}get isComplete(){return true}get isFilled(){return Boolean(this._value)}_appendChar(t,e){if(e===void 0){e={}}if(this.isFilled)return new Fn;const i=this.eager===true||this.eager==="append";const s=this.char===t;const n=s&&(this.isUnmasking||e.input||e.raw)&&(!e.raw||!i)&&!e.tail;const o=new Fn({inserted:this.char,rawInserted:n?this.char:""});this._value=this.char;this._isRawInput=n&&(e.raw||e.input);return o}_appendEager(){return this._appendChar(this.char,{tail:true})}_appendPlaceholder(){const t=new Fn;if(this.isFilled)return t;this._value=t.inserted=this.char;return t}extractTail(){return new Pn("")}appendTail(t){if(wn(t))t=new Pn(String(t));return t.appendTo(this)}append(t,e,i){const s=this._appendChar(t[0],e);if(i!=null){s.tailShift+=this.appendTail(i).tailShift}return s}doCommit(){}get state(){return{_value:this._value,_rawInputValue:this.rawInputValue}}set state(t){this._value=t._value;this._isRawInput=Boolean(t._rawInputValue)}pad(t){return this._appendPlaceholder()}}class Kn{constructor(t){const{parent:e,isOptional:i,placeholderChar:s,displayChar:n,lazy:o,eager:r,...a}=t;this.masked=In(a);Object.assign(this,{parent:e,isOptional:i,placeholderChar:s,displayChar:n,lazy:o,eager:r})}reset(){this.isFilled=false;this.masked.reset()}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.value.length}if(t===0&&e>=1){this.isFilled=false;return this.masked.remove(t,e)}return new Fn}get value(){return this.masked.value||(this.isFilled&&!this.isOptional?this.placeholderChar:"")}get unmaskedValue(){return this.masked.unmaskedValue}get rawInputValue(){return this.masked.rawInputValue}get displayValue(){return this.masked.value&&this.displayChar||this.value}get isComplete(){return Boolean(this.masked.value)||this.isOptional}_appendChar(t,e){if(e===void 0){e={}}if(this.isFilled)return new Fn;const i=this.masked.state;let s=this.masked._appendChar(t,this.currentMaskFlags(e));if(s.inserted&&this.doValidate(e)===false){s=new Fn;this.masked.state=i}if(!s.inserted&&!this.isOptional&&!this.lazy&&!e.input){s.inserted=this.placeholderChar}s.skip=!s.inserted&&!this.isOptional;this.isFilled=Boolean(s.inserted);return s}append(t,e,i){return this.masked.append(t,this.currentMaskFlags(e),i)}_appendPlaceholder(){if(this.isFilled||this.isOptional)return new Fn;this.isFilled=true;return new Fn({inserted:this.placeholderChar})}_appendEager(){return new Fn}extractTail(t,e){return this.masked.extractTail(t,e)}appendTail(t){return this.masked.appendTail(t)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.value.length}return this.masked.extractInput(t,e,i)}nearestInputPos(t,e){if(e===void 0){e=Dn.NONE}const i=0;const s=this.value.length;const n=Math.min(Math.max(t,i),s);switch(e){case Dn.LEFT:case Dn.FORCE_LEFT:return this.isComplete?n:i;case Dn.RIGHT:case Dn.FORCE_RIGHT:return this.isComplete?n:s;case Dn.NONE:default:return n}}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.value.length}return this.value.slice(t,e).length}doValidate(t){return this.masked.doValidate(this.currentMaskFlags(t))&&(!this.parent||this.parent.doValidate(this.currentMaskFlags(t)))}doCommit(){this.masked.doCommit()}get state(){return{_value:this.value,_rawInputValue:this.rawInputValue,masked:this.masked.state,isFilled:this.isFilled}}set state(t){this.masked.state=t.masked;this.isFilled=t.isFilled}currentMaskFlags(t){var e;return{...t,_beforeTailState:(t==null||(e=t._beforeTailState)==null?void 0:e.masked)||(t==null?void 0:t._beforeTailState)}}pad(t){return new Fn}}Kn.DEFAULT_DEFINITIONS={0:/\d/,a:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./};class Wn extends Hn{updateOptions(t){super.updateOptions(t)}_update(t){const e=t.mask;if(e)t.validate=t=>t.search(e)>=0;super._update(t)}}Bn.MaskedRegExp=Wn;class qn extends Hn{constructor(t){super({...qn.DEFAULTS,...t,definitions:Object.assign({},Kn.DEFAULT_DEFINITIONS,t==null?void 0:t.definitions)})}updateOptions(t){super.updateOptions(t)}_update(t){t.definitions=Object.assign({},this.definitions,t.definitions);super._update(t);this._rebuildMask()}_rebuildMask(){const t=this.definitions;this._blocks=[];this.exposeBlock=undefined;this._stops=[];this._maskedBlocks={};const e=this.mask;if(!e||!t)return;let i=false;let s=false;for(let n=0;n<e.length;++n){if(this.blocks){const t=e.slice(n);const i=Object.keys(this.blocks).filter((e=>t.indexOf(e)===0));i.sort(((t,e)=>e.length-t.length));const s=i[0];if(s){const{expose:t,repeat:e,...i}=Tn(this.blocks[s]);const o={lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar,overwrite:this.overwrite,autofix:this.autofix,...i,repeat:e,parent:this};const r=e!=null?new Bn.RepeatBlock(o):In(o);if(r){this._blocks.push(r);if(t)this.exposeBlock=r;if(!this._maskedBlocks[s])this._maskedBlocks[s]=[];this._maskedBlocks[s].push(this._blocks.length-1)}n+=s.length-1;continue}}let o=e[n];let r=o in t;if(o===qn.STOP_CHAR){this._stops.push(this._blocks.length);continue}if(o==="{"||o==="}"){i=!i;continue}if(o==="["||o==="]"){s=!s;continue}if(o===qn.ESCAPE_CHAR){++n;o=e[n];if(!o)break;r=false}const a=r?new Kn({isOptional:s,lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar,...Tn(t[o]),parent:this}):new Gn({char:o,eager:this.eager,isUnmasking:i});this._blocks.push(a)}}get state(){return{...super.state,_blocks:this._blocks.map((t=>t.state))}}set state(t){if(!t){this.reset();return}const{_blocks:e,...i}=t;this._blocks.forEach(((t,i)=>t.state=e[i]));super.state=i}reset(){super.reset();this._blocks.forEach((t=>t.reset()))}get isComplete(){return this.exposeBlock?this.exposeBlock.isComplete:this._blocks.every((t=>t.isComplete))}get isFilled(){return this._blocks.every((t=>t.isFilled))}get isFixed(){return this._blocks.every((t=>t.isFixed))}get isOptional(){return this._blocks.every((t=>t.isOptional))}doCommit(){this._blocks.forEach((t=>t.doCommit()));super.doCommit()}get unmaskedValue(){return this.exposeBlock?this.exposeBlock.unmaskedValue:this._blocks.reduce(((t,e)=>t+=e.unmaskedValue),"")}set unmaskedValue(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.unmaskedValue=t;this.appendTail(e);this.doCommit()}else super.unmaskedValue=t}get value(){return this.exposeBlock?this.exposeBlock.value:this._blocks.reduce(((t,e)=>t+=e.value),"")}set value(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.value=t;this.appendTail(e);this.doCommit()}else super.value=t}get typedValue(){return this.exposeBlock?this.exposeBlock.typedValue:super.typedValue}set typedValue(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.typedValue=t;this.appendTail(e);this.doCommit()}else super.typedValue=t}get displayValue(){return this._blocks.reduce(((t,e)=>t+=e.displayValue),"")}appendTail(t){return super.appendTail(t).aggregate(this._appendPlaceholder())}_appendEager(){var t;const e=new Fn;let i=(t=this._mapPosToBlock(this.displayValue.length))==null?void 0:t.index;if(i==null)return e;if(this._blocks[i].isFilled)++i;for(let t=i;t<this._blocks.length;++t){const i=this._blocks[t]._appendEager();if(!i.inserted)break;e.aggregate(i)}return e}_appendCharRaw(t,e){if(e===void 0){e={}}const i=this._mapPosToBlock(this.displayValue.length);const s=new Fn;if(!i)return s;for(let o=i.index,r;r=this._blocks[o];++o){var n;const i=r._appendChar(t,{...e,_beforeTailState:(n=e._beforeTailState)==null||(n=n._blocks)==null?void 0:n[o]});s.aggregate(i);if(i.consumed)break}return s}extractTail(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=new Vn;if(t===e)return i;this._forEachBlocksInRange(t,e,((t,e,s,n)=>{const o=t.extractTail(s,n);o.stop=this._findStopBefore(e);o.from=this._blockStartPos(e);if(o instanceof Vn)o.blockIndex=e;i.extend(o)}));return i}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}if(i===void 0){i={}}if(t===e)return"";let s="";this._forEachBlocksInRange(t,e,((t,e,n,o)=>{s+=t.extractInput(n,o,i)}));return s}_findStopBefore(t){let e;for(let i=0;i<this._stops.length;++i){const s=this._stops[i];if(s<=t)e=s;else break}return e}_appendPlaceholder(t){const e=new Fn;if(this.lazy&&t==null)return e;const i=this._mapPosToBlock(this.displayValue.length);if(!i)return e;const s=i.index;const n=t!=null?t:this._blocks.length;this._blocks.slice(s,n).forEach((i=>{if(!i.lazy||t!=null){var s;e.aggregate(i._appendPlaceholder((s=i._blocks)==null?void 0:s.length))}}));return e}_mapPosToBlock(t){let e="";for(let i=0;i<this._blocks.length;++i){const s=this._blocks[i];const n=e.length;e+=s.displayValue;if(t<=e.length){return{index:i,offset:t-n}}}}_blockStartPos(t){return this._blocks.slice(0,t).reduce(((t,e)=>t+=e.displayValue.length),0)}_forEachBlocksInRange(t,e,i){if(e===void 0){e=this.displayValue.length}const s=this._mapPosToBlock(t);if(s){const t=this._mapPosToBlock(e);const n=t&&s.index===t.index;const o=s.offset;const r=t&&n?t.offset:this._blocks[s.index].displayValue.length;i(this._blocks[s.index],s.index,o,r);if(t&&!n){for(let e=s.index+1;e<t.index;++e){i(this._blocks[e],e,0,this._blocks[e].displayValue.length)}i(this._blocks[t.index],t.index,0,t.offset)}}}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=super.remove(t,e);this._forEachBlocksInRange(t,e,((t,e,s,n)=>{i.aggregate(t.remove(s,n))}));return i}nearestInputPos(t,e){if(e===void 0){e=Dn.NONE}if(!this._blocks.length)return 0;const i=new Un(this,t);if(e===Dn.NONE){if(i.pushRightBeforeInput())return i.pos;i.popState();if(i.pushLeftBeforeInput())return i.pos;return this.displayValue.length}if(e===Dn.LEFT||e===Dn.FORCE_LEFT){if(e===Dn.LEFT){i.pushRightBeforeFilled();if(i.ok&&i.pos===t)return t;i.popState()}i.pushLeftBeforeInput();i.pushLeftBeforeRequired();i.pushLeftBeforeFilled();if(e===Dn.LEFT){i.pushRightBeforeInput();i.pushRightBeforeRequired();if(i.ok&&i.pos<=t)return i.pos;i.popState();if(i.ok&&i.pos<=t)return i.pos;i.popState()}if(i.ok)return i.pos;if(e===Dn.FORCE_LEFT)return 0;i.popState();if(i.ok)return i.pos;i.popState();if(i.ok)return i.pos;return 0}if(e===Dn.RIGHT||e===Dn.FORCE_RIGHT){i.pushRightBeforeInput();i.pushRightBeforeRequired();if(i.pushRightBeforeFilled())return i.pos;if(e===Dn.FORCE_RIGHT)return this.displayValue.length;i.popState();if(i.ok)return i.pos;i.popState();if(i.ok)return i.pos;return this.nearestInputPos(t,Dn.LEFT)}return t}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}let i=0;this._forEachBlocksInRange(t,e,((t,e,s,n)=>{i+=t.totalInputPositions(s,n)}));return i}maskedBlock(t){return this.maskedBlocks(t)[0]}maskedBlocks(t){const e=this._maskedBlocks[t];if(!e)return[];return e.map((t=>this._blocks[t]))}pad(t){const e=new Fn;this._forEachBlocksInRange(0,this.displayValue.length,(i=>e.aggregate(i.pad(t))));return e}}qn.DEFAULTS={...Hn.DEFAULTS,lazy:true,placeholderChar:"_"};qn.STOP_CHAR="`";qn.ESCAPE_CHAR="\\";qn.InputDefinition=Kn;qn.FixedDefinition=Gn;Bn.MaskedPattern=qn;class Xn extends qn{get _matchFrom(){return this.maxLength-String(this.from).length}constructor(t){super(t)}updateOptions(t){super.updateOptions(t)}_update(t){const{to:e=this.to||0,from:i=this.from||0,maxLength:s=this.maxLength||0,autofix:n=this.autofix,...o}=t;this.to=e;this.from=i;this.maxLength=Math.max(String(e).length,s);this.autofix=n;const r=String(this.from).padStart(this.maxLength,"0");const a=String(this.to).padStart(this.maxLength,"0");let l=0;while(l<a.length&&a[l]===r[l])++l;o.mask=a.slice(0,l).replace(/0/g,"\\0")+"0".repeat(this.maxLength-l);super._update(o)}get isComplete(){return super.isComplete&&Boolean(this.value)}boundaries(t){let e="";let i="";const[,s,n]=t.match(/^(\D*)(\d*)(\D*)/)||[];if(n){e="0".repeat(s.length)+n;i="9".repeat(s.length)+n}e=e.padEnd(this.maxLength,"0");i=i.padEnd(this.maxLength,"9");return[e,i]}doPrepareChar(t,e){if(e===void 0){e={}}let i;[t,i]=super.doPrepareChar(t.replace(/\D/g,""),e);if(!t)i.skip=!this.isComplete;return[t,i]}_appendCharRaw(t,e){if(e===void 0){e={}}if(!this.autofix||this.value.length+1>this.maxLength)return super._appendCharRaw(t,e);const i=String(this.from).padStart(this.maxLength,"0");const s=String(this.to).padStart(this.maxLength,"0");const[n,o]=this.boundaries(this.value+t);if(Number(o)<this.from)return super._appendCharRaw(i[this.value.length],e);if(Number(n)>this.to){if(!e.tail&&this.autofix==="pad"&&this.value.length+1<this.maxLength){return super._appendCharRaw(i[this.value.length],e).aggregate(this._appendCharRaw(t,e))}return super._appendCharRaw(s[this.value.length],e)}return super._appendCharRaw(t,e)}doValidate(t){const e=this.value;const i=e.search(/[^0]/);if(i===-1&&e.length<=this._matchFrom)return true;const[s,n]=this.boundaries(e);return this.from<=Number(n)&&Number(s)<=this.to&&super.doValidate(t)}pad(t){const e=new Fn;if(this.value.length===this.maxLength)return e;const i=this.value;const s=this.maxLength-this.value.length;if(s){this.reset();for(let i=0;i<s;++i){e.aggregate(super._appendCharRaw("0",t))}i.split("").forEach((t=>this._appendCharRaw(t)))}return e}}Bn.MaskedRange=Xn;const Jn="d{.}`m{.}`Y";class Zn extends qn{static extractPatternOptions(t){const{mask:e,pattern:i,...s}=t;return{...s,mask:wn(e)?e:i}}constructor(t){super(Zn.extractPatternOptions({...Zn.DEFAULTS,...t}))}updateOptions(t){super.updateOptions(t)}_update(t){const{mask:e,pattern:i,blocks:s,...n}={...Zn.DEFAULTS,...t};const o=Object.assign({},Zn.GET_DEFAULT_BLOCKS());if(t.min)o.Y.from=t.min.getFullYear();if(t.max)o.Y.to=t.max.getFullYear();if(t.min&&t.max&&o.Y.from===o.Y.to){o.m.from=t.min.getMonth()+1;o.m.to=t.max.getMonth()+1;if(o.m.from===o.m.to){o.d.from=t.min.getDate();o.d.to=t.max.getDate()}}Object.assign(o,this.blocks,s);super._update({...n,mask:wn(e)?e:i,blocks:o})}doValidate(t){const e=this.date;return super.doValidate(t)&&(!this.isComplete||this.isDateExist(this.value)&&e!=null&&(this.min==null||this.min<=e)&&(this.max==null||e<=this.max))}isDateExist(t){return this.format(this.parse(t,this),this).indexOf(t)>=0}get date(){return this.typedValue}set date(t){this.typedValue=t}get typedValue(){return this.isComplete?super.typedValue:null}set typedValue(t){super.typedValue=t}maskEquals(t){return t===Date||super.maskEquals(t)}optionsIsChanged(t){return super.optionsIsChanged(Zn.extractPatternOptions(t))}}Zn.GET_DEFAULT_BLOCKS=()=>({d:{mask:Xn,from:1,to:31,maxLength:2},m:{mask:Xn,from:1,to:12,maxLength:2},Y:{mask:Xn,from:1900,to:9999}});Zn.DEFAULTS={...qn.DEFAULTS,mask:Date,pattern:Jn,format:(t,e)=>{if(!t)return"";const i=String(t.getDate()).padStart(2,"0");const s=String(t.getMonth()+1).padStart(2,"0");const n=t.getFullYear();return[i,s,n].join(".")},parse:(t,e)=>{const[i,s,n]=t.split(".").map(Number);return new Date(n,s-1,i)}};Bn.MaskedDate=Zn;class Qn extends Hn{constructor(t){super({...Qn.DEFAULTS,...t});this.currentMask=undefined}updateOptions(t){super.updateOptions(t)}_update(t){super._update(t);if("mask"in t){this.exposeMask=undefined;this.compiledMasks=Array.isArray(t.mask)?t.mask.map((t=>{const{expose:e,...i}=Tn(t);const s=In({overwrite:this._overwrite,eager:this._eager,skipInvalid:this._skipInvalid,...i});if(e)this.exposeMask=s;return s})):[]}}_appendCharRaw(t,e){if(e===void 0){e={}}const i=this._applyDispatch(t,e);if(this.currentMask){i.aggregate(this.currentMask._appendChar(t,this.currentMaskFlags(e)))}return i}_applyDispatch(t,e,i){if(t===void 0){t=""}if(e===void 0){e={}}if(i===void 0){i=""}const s=e.tail&&e._beforeTailState!=null?e._beforeTailState._value:this.value;const n=this.rawInputValue;const o=e.tail&&e._beforeTailState!=null?e._beforeTailState._rawInputValue:n;const r=n.slice(o.length);const a=this.currentMask;const l=new Fn;const c=a==null?void 0:a.state;this.currentMask=this.doDispatch(t,{...e},i);if(this.currentMask){if(this.currentMask!==a){this.currentMask.reset();if(o){this.currentMask.append(o,{raw:true});l.tailShift=this.currentMask.value.length-s.length}if(r){l.tailShift+=this.currentMask.append(r,{raw:true,tail:true}).tailShift}}else if(c){this.currentMask.state=c}}return l}_appendPlaceholder(){const t=this._applyDispatch();if(this.currentMask){t.aggregate(this.currentMask._appendPlaceholder())}return t}_appendEager(){const t=this._applyDispatch();if(this.currentMask){t.aggregate(this.currentMask._appendEager())}return t}appendTail(t){const e=new Fn;if(t)e.aggregate(this._applyDispatch("",{},t));return e.aggregate(this.currentMask?this.currentMask.appendTail(t):super.appendTail(t))}currentMaskFlags(t){var e,i;return{...t,_beforeTailState:((e=t._beforeTailState)==null?void 0:e.currentMaskRef)===this.currentMask&&((i=t._beforeTailState)==null?void 0:i.currentMask)||t._beforeTailState}}doDispatch(t,e,i){if(e===void 0){e={}}if(i===void 0){i=""}return this.dispatch(t,this,e,i)}doValidate(t){return super.doValidate(t)&&(!this.currentMask||this.currentMask.doValidate(this.currentMaskFlags(t)))}doPrepare(t,e){if(e===void 0){e={}}let[i,s]=super.doPrepare(t,e);if(this.currentMask){let t;[i,t]=super.doPrepare(i,this.currentMaskFlags(e));s=s.aggregate(t)}return[i,s]}doPrepareChar(t,e){if(e===void 0){e={}}let[i,s]=super.doPrepareChar(t,e);if(this.currentMask){let t;[i,t]=super.doPrepareChar(i,this.currentMaskFlags(e));s=s.aggregate(t)}return[i,s]}reset(){var t;(t=this.currentMask)==null||t.reset();this.compiledMasks.forEach((t=>t.reset()))}get value(){return this.exposeMask?this.exposeMask.value:this.currentMask?this.currentMask.value:""}set value(t){if(this.exposeMask){this.exposeMask.value=t;this.currentMask=this.exposeMask;this._applyDispatch()}else super.value=t}get unmaskedValue(){return this.exposeMask?this.exposeMask.unmaskedValue:this.currentMask?this.currentMask.unmaskedValue:""}set unmaskedValue(t){if(this.exposeMask){this.exposeMask.unmaskedValue=t;this.currentMask=this.exposeMask;this._applyDispatch()}else super.unmaskedValue=t}get typedValue(){return this.exposeMask?this.exposeMask.typedValue:this.currentMask?this.currentMask.typedValue:""}set typedValue(t){if(this.exposeMask){this.exposeMask.typedValue=t;this.currentMask=this.exposeMask;this._applyDispatch();return}let e=String(t);if(this.currentMask){this.currentMask.typedValue=t;e=this.currentMask.unmaskedValue}this.unmaskedValue=e}get displayValue(){return this.currentMask?this.currentMask.displayValue:""}get isComplete(){var t;return Boolean((t=this.currentMask)==null?void 0:t.isComplete)}get isFilled(){var t;return Boolean((t=this.currentMask)==null?void 0:t.isFilled)}remove(t,e){const i=new Fn;if(this.currentMask){i.aggregate(this.currentMask.remove(t,e)).aggregate(this._applyDispatch())}return i}get state(){var t;return{...super.state,_rawInputValue:this.rawInputValue,compiledMasks:this.compiledMasks.map((t=>t.state)),currentMaskRef:this.currentMask,currentMask:(t=this.currentMask)==null?void 0:t.state}}set state(t){const{compiledMasks:e,currentMaskRef:i,currentMask:s,...n}=t;if(e)this.compiledMasks.forEach(((t,i)=>t.state=e[i]));if(i!=null){this.currentMask=i;this.currentMask.state=s}super.state=n}extractInput(t,e,i){return this.currentMask?this.currentMask.extractInput(t,e,i):""}extractTail(t,e){return this.currentMask?this.currentMask.extractTail(t,e):super.extractTail(t,e)}doCommit(){if(this.currentMask)this.currentMask.doCommit();super.doCommit()}nearestInputPos(t,e){return this.currentMask?this.currentMask.nearestInputPos(t,e):super.nearestInputPos(t,e)}get overwrite(){return this.currentMask?this.currentMask.overwrite:this._overwrite}set overwrite(t){this._overwrite=t}get eager(){return this.currentMask?this.currentMask.eager:this._eager}set eager(t){this._eager=t}get skipInvalid(){return this.currentMask?this.currentMask.skipInvalid:this._skipInvalid}set skipInvalid(t){this._skipInvalid=t}get autofix(){return this.currentMask?this.currentMask.autofix:this._autofix}set autofix(t){this._autofix=t}maskEquals(t){return Array.isArray(t)?this.compiledMasks.every(((e,i)=>{if(!t[i])return;const{mask:s,...n}=t[i];return En(e,n)&&e.maskEquals(s)})):super.maskEquals(t)}typedValueEquals(t){var e;return Boolean((e=this.currentMask)==null?void 0:e.typedValueEquals(t))}}Qn.DEFAULTS={...Hn.DEFAULTS,dispatch:(t,e,i,s)=>{if(!e.compiledMasks.length)return;const n=e.rawInputValue;const o=e.compiledMasks.map(((o,r)=>{const a=e.currentMask===o;const l=a?o.displayValue.length:o.nearestInputPos(o.displayValue.length,Dn.FORCE_LEFT);if(o.rawInputValue!==n){o.reset();o.append(n,{raw:true})}else if(!a){o.remove(l)}o.append(t,e.currentMaskFlags(i));o.appendTail(s);return{index:r,weight:o.rawInputValue.length,totalInputPositions:o.totalInputPositions(0,Math.max(l,o.nearestInputPos(o.displayValue.length,Dn.FORCE_LEFT)))}}));o.sort(((t,e)=>e.weight-t.weight||e.totalInputPositions-t.totalInputPositions));return e.compiledMasks[o[0].index]}};Bn.MaskedDynamic=Qn;class to extends qn{constructor(t){super({...to.DEFAULTS,...t})}updateOptions(t){super.updateOptions(t)}_update(t){const{enum:e,...i}=t;if(e){const t=e.map((t=>t.length));const s=Math.min(...t);const n=Math.max(...t)-s;i.mask="*".repeat(s);if(n)i.mask+="["+"*".repeat(n)+"]";this.enum=e}super._update(i)}_appendCharRaw(t,e){if(e===void 0){e={}}const i=Math.min(this.nearestInputPos(0,Dn.FORCE_RIGHT),this.value.length);const s=this.enum.filter((e=>this.matchValue(e,this.unmaskedValue+t,i)));if(s.length){if(s.length===1){this._forEachBlocksInRange(0,this.value.length,((t,i)=>{const n=s[0][i];if(i>=this.value.length||n===t.value)return;t.reset();t._appendChar(n,e)}))}const t=super._appendCharRaw(s[0][this.value.length],e);if(s.length===1){s[0].slice(this.unmaskedValue.length).split("").forEach((e=>t.aggregate(super._appendCharRaw(e))))}return t}return new Fn({skip:!this.isComplete})}extractTail(t,e){if(t===void 0){t=0}return new Pn("",t)}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}if(t===e)return new Fn;const i=Math.min(super.nearestInputPos(0,Dn.FORCE_RIGHT),this.value.length);let s;for(s=t;s>=0;--s){const t=this.enum.filter((t=>this.matchValue(t,this.value.slice(i,s),i)));if(t.length>1)break}const n=super.remove(s,e);n.tailShift+=s-t;return n}get isComplete(){return this.enum.indexOf(this.value)>=0}}to.DEFAULTS={...qn.DEFAULTS,matchValue:(t,e,i)=>t.indexOf(e,i)===i};Bn.MaskedEnum=to;class eo extends Hn{updateOptions(t){super.updateOptions(t)}_update(t){super._update({...t,validate:t.mask})}}Bn.MaskedFunction=eo;var io;class so extends Hn{constructor(t){super({...so.DEFAULTS,...t})}updateOptions(t){super.updateOptions(t)}_update(t){super._update(t);this._updateRegExps()}_updateRegExps(){const t="^"+(this.allowNegative?"[+|\\-]?":"");const e="\\d*";const i=(this.scale?"("+On(this.radix)+"\\d{0,"+this.scale+"})?":"")+"$";this._numberRegExp=new RegExp(t+e+i);this._mapToRadixRegExp=new RegExp("["+this.mapToRadix.map(On).join("")+"]","g");this._thousandsSeparatorRegExp=new RegExp(On(this.thousandsSeparator),"g")}_removeThousandsSeparators(t){return t.replace(this._thousandsSeparatorRegExp,"")}_insertThousandsSeparators(t){const e=t.split(this.radix);e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,this.thousandsSeparator);return e.join(this.radix)}doPrepareChar(t,e){if(e===void 0){e={}}const[i,s]=super.doPrepareChar(this._removeThousandsSeparators(this.scale&&this.mapToRadix.length&&(e.input&&e.raw||!e.input&&!e.raw)?t.replace(this._mapToRadixRegExp,this.radix):t),e);if(t&&!i)s.skip=true;if(i&&!this.allowPositive&&!this.value&&i!=="-")s.aggregate(this._appendChar("-"));return[i,s]}_separatorsCount(t,e){if(e===void 0){e=false}let i=0;for(let s=0;s<t;++s){if(this._value.indexOf(this.thousandsSeparator,s)===s){++i;if(e)t+=this.thousandsSeparator.length}}return i}_separatorsCountFromSlice(t){if(t===void 0){t=this._value}return this._separatorsCount(this._removeThousandsSeparators(t).length,true)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}[t,e]=this._adjustRangeWithSeparators(t,e);return this._removeThousandsSeparators(super.extractInput(t,e,i))}_appendCharRaw(t,e){if(e===void 0){e={}}const i=e.tail&&e._beforeTailState?e._beforeTailState._value:this._value;const s=this._separatorsCountFromSlice(i);this._value=this._removeThousandsSeparators(this.value);const n=this._value;this._value+=t;const o=this.number;let r=!isNaN(o);let a=false;if(r){let t;if(this.min!=null&&this.min<0&&this.number<this.min)t=this.min;if(this.max!=null&&this.max>0&&this.number>this.max)t=this.max;if(t!=null){if(this.autofix){this._value=this.format(t,this).replace(so.UNMASKED_RADIX,this.radix);a||(a=n===this._value&&!e.tail)}else{r=false}}r&&(r=Boolean(this._value.match(this._numberRegExp)))}let l;if(!r){this._value=n;l=new Fn}else{l=new Fn({inserted:this._value.slice(n.length),rawInserted:a?"":t,skip:a})}this._value=this._insertThousandsSeparators(this._value);const c=e.tail&&e._beforeTailState?e._beforeTailState._value:this._value;const h=this._separatorsCountFromSlice(c);l.tailShift+=(h-s)*this.thousandsSeparator.length;return l}_findSeparatorAround(t){if(this.thousandsSeparator){const e=t-this.thousandsSeparator.length+1;const i=this.value.indexOf(this.thousandsSeparator,e);if(i<=t)return i}return-1}_adjustRangeWithSeparators(t,e){const i=this._findSeparatorAround(t);if(i>=0)t=i;const s=this._findSeparatorAround(e);if(s>=0)e=s+this.thousandsSeparator.length;return[t,e]}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}[t,e]=this._adjustRangeWithSeparators(t,e);const i=this.value.slice(0,t);const s=this.value.slice(e);const n=this._separatorsCount(i.length);this._value=this._insertThousandsSeparators(this._removeThousandsSeparators(i+s));const o=this._separatorsCountFromSlice(i);return new Fn({tailShift:(o-n)*this.thousandsSeparator.length})}nearestInputPos(t,e){if(!this.thousandsSeparator)return t;switch(e){case Dn.NONE:case Dn.LEFT:case Dn.FORCE_LEFT:{const i=this._findSeparatorAround(t-1);if(i>=0){const s=i+this.thousandsSeparator.length;if(t<s||this.value.length<=s||e===Dn.FORCE_LEFT){return i}}break}case Dn.RIGHT:case Dn.FORCE_RIGHT:{const e=this._findSeparatorAround(t);if(e>=0){return e+this.thousandsSeparator.length}}}return t}doCommit(){if(this.value){const t=this.number;let e=t;if(this.min!=null)e=Math.max(e,this.min);if(this.max!=null)e=Math.min(e,this.max);if(e!==t)this.unmaskedValue=this.format(e,this);let i=this.value;if(this.normalizeZeros)i=this._normalizeZeros(i);if(this.padFractionalZeros&&this.scale>0)i=this._padFractionalZeros(i);this._value=i}super.doCommit()}_normalizeZeros(t){const e=this._removeThousandsSeparators(t).split(this.radix);e[0]=e[0].replace(/^(\D*)(0*)(\d*)/,((t,e,i,s)=>e+s));if(t.length&&!/\d$/.test(e[0]))e[0]=e[0]+"0";if(e.length>1){e[1]=e[1].replace(/0*$/,"");if(!e[1].length)e.length=1}return this._insertThousandsSeparators(e.join(this.radix))}_padFractionalZeros(t){if(!t)return t;const e=t.split(this.radix);if(e.length<2)e.push("");e[1]=e[1].padEnd(this.scale,"0");return e.join(this.radix)}doSkipInvalid(t,e,i){if(e===void 0){e={}}const s=this.scale===0&&t!==this.thousandsSeparator&&(t===this.radix||t===so.UNMASKED_RADIX||this.mapToRadix.includes(t));return super.doSkipInvalid(t,e,i)&&!s}get unmaskedValue(){return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix,so.UNMASKED_RADIX)}set unmaskedValue(t){super.unmaskedValue=t}get typedValue(){return this.parse(this.unmaskedValue,this)}set typedValue(t){this.rawInputValue=this.format(t,this).replace(so.UNMASKED_RADIX,this.radix)}get number(){return this.typedValue}set number(t){this.typedValue=t}get allowNegative(){return this.min!=null&&this.min<0||this.max!=null&&this.max<0}get allowPositive(){return this.min!=null&&this.min>0||this.max!=null&&this.max>0}typedValueEquals(t){return(super.typedValueEquals(t)||so.EMPTY_VALUES.includes(t)&&so.EMPTY_VALUES.includes(this.typedValue))&&!(t===0&&this.value==="")}}io=so;so.UNMASKED_RADIX=".";so.EMPTY_VALUES=[...Hn.EMPTY_VALUES,0];so.DEFAULTS={...Hn.DEFAULTS,mask:Number,radix:",",thousandsSeparator:"",mapToRadix:[io.UNMASKED_RADIX],min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,scale:2,normalizeZeros:true,padFractionalZeros:false,parse:Number,format:t=>t.toLocaleString("en-US",{useGrouping:false,maximumFractionDigits:20})};Bn.MaskedNumber=so;const no={MASKED:"value",UNMASKED:"unmaskedValue",TYPED:"typedValue"};function oo(t,e,i){if(e===void 0){e=no.MASKED}if(i===void 0){i=no.MASKED}const s=In(t);return t=>s.runIsolated((s=>{s[e]=t;return s[i]}))}function ro(t,e,i,s){return oo(e,i,s)(t)}Bn.PIPE_TYPE=no;Bn.createPipe=oo;Bn.pipe=ro;class ao extends qn{get repeatFrom(){var t;return(t=Array.isArray(this.repeat)?this.repeat[0]:this.repeat===Infinity?0:this.repeat)!=null?t:0}get repeatTo(){var t;return(t=Array.isArray(this.repeat)?this.repeat[1]:this.repeat)!=null?t:Infinity}constructor(t){super(t)}updateOptions(t){super.updateOptions(t)}_update(t){var e,i,s;const{repeat:n,...o}=Tn(t);this._blockOpts=Object.assign({},this._blockOpts,o);const r=In(this._blockOpts);this.repeat=(e=(i=n!=null?n:r.repeat)!=null?i:this.repeat)!=null?e:Infinity;super._update({mask:"m".repeat(Math.max(this.repeatTo===Infinity&&((s=this._blocks)==null?void 0:s.length)||0,this.repeatFrom)),blocks:{m:r},eager:r.eager,overwrite:r.overwrite,skipInvalid:r.skipInvalid,lazy:r.lazy,placeholderChar:r.placeholderChar,displayChar:r.displayChar})}_allocateBlock(t){if(t<this._blocks.length)return this._blocks[t];if(this.repeatTo===Infinity||this._blocks.length<this.repeatTo){this._blocks.push(In(this._blockOpts));this.mask+="m";return this._blocks[this._blocks.length-1]}}_appendCharRaw(t,e){if(e===void 0){e={}}const i=new Fn;for(let a=(s=(n=this._mapPosToBlock(this.displayValue.length))==null?void 0:n.index)!=null?s:Math.max(this._blocks.length-1,0),l,c;l=(o=this._blocks[a])!=null?o:c=!c&&this._allocateBlock(a);++a){var s,n,o,r;const h=l._appendChar(t,{...e,_beforeTailState:(r=e._beforeTailState)==null||(r=r._blocks)==null?void 0:r[a]});if(h.skip&&c){this._blocks.pop();this.mask=this.mask.slice(1);break}i.aggregate(h);if(h.consumed)break}return i}_trimEmptyTail(t,e){var i,s;if(t===void 0){t=0}const n=Math.max(((i=this._mapPosToBlock(t))==null?void 0:i.index)||0,this.repeatFrom,0);let o;if(e!=null)o=(s=this._mapPosToBlock(e))==null?void 0:s.index;if(o==null)o=this._blocks.length-1;let r=0;for(let t=o;n<=t;--t,++r){if(this._blocks[t].unmaskedValue)break}if(r){this._blocks.splice(o-r+1,r);this.mask=this.mask.slice(r)}}reset(){super.reset();this._trimEmptyTail()}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=super.remove(t,e);this._trimEmptyTail(t,e);return i}totalInputPositions(t,e){if(t===void 0){t=0}if(e==null&&this.repeatTo===Infinity)return Infinity;return super.totalInputPositions(t,e)}get state(){return super.state}set state(t){this._blocks.length=t._blocks.length;this.mask=this.mask.slice(0,this._blocks.length);super.state=t}}Bn.RepeatBlock=ao;try{globalThis.IMask=Bn}catch{}const lo=".sc-ir-input-text-h{margin:0;padding:0;display:inline}.border-theme.sc-ir-input-text{border:1px solid #cacfe7}.icon-container.sc-ir-input-text{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}input.sc-ir-input-text:focus{border-color:#1e9ff2 !important}.ir-input[data-state='empty'].sc-ir-input-text{color:#bbbfc6}.input-container.sc-ir-input-text{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.input-container.sc-ir-input-text input.sc-ir-input-text{padding-left:5px !important;padding-right:5px !important;border-left:0;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.icon-container[data-state='focus'].sc-ir-input-text{border-color:var(--blue)}.icon-container[data-disabled].sc-ir-input-text{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.danger-border.sc-ir-input-text{border-color:var(--red)}";const co=lo;const ho=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.inputBlur=s(this,"inputBlur",7);this.inputFocus=s(this,"inputFocus",7);this.name=undefined;this.value=undefined;this.label="";this.placeholder="";this.inputStyles="";this.required=undefined;this.LabelAvailable=true;this.readonly=false;this.type="text";this.submitted=false;this.inputStyle=true;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.variant="default";this.disabled=false;this.error=false;this.mask=undefined;this.autoValidate=true;this.zod=undefined;this.wrapKey=undefined;this.initial=true;this.inputFocused=false;this.isError=false}componentWillLoad(){if(this.el.id){this.id=this.el.id}else{this.id=L()}}componentDidLoad(){if(this.mask)this.initMask()}handleMaskChange(){this.initMask()}watchHandler2(t){if(t&&this.required){this.initial=false}}handleErrorChange(t,e){if(t!==e){this.validateInput(this.value,true)}}handleAriaInvalidChange(t){if(t==="true"){this.isError=true}else{this.isError=false}}validateInput(t,e=false){if(!this.autoValidate&&!e){return}if(this.zod){try{this.zod.parse(this.wrapKey?{[this.wrapKey]:t}:t);this.error=false}catch(t){console.log(t);this.error=true}}}handleInputChange(t){this.initial=false;const e=t.target.value;if(this.maskInstance){this.maskInstance.value=e}const i=this.maskInstance?this.maskInstance.value:e;this.textChange.emit(i)}initMask(){if(!this.mask||this.maskInstance){return}this.maskInstance=Bn(this.inputRef,this.mask);this.maskInstance.on("accept",(()=>{this.inputRef.value=this.maskInstance.value;this.textChange.emit(this.maskInstance.value)}))}handleBlur(t){this.validateInput(this.value,this.submitted);this.inputFocused=false;this.inputBlur.emit(t)}render(){if(this.variant==="icon"){return e("fieldset",{class:"position-relative has-icon-left input-container"},e("label",{htmlFor:this.id,class:"input-group-prepend bg-white m-0"},e("span",{"data-disabled":this.disabled,"data-state":this.inputFocused?"focus":"",class:`input-group-text icon-container bg-white ${(this.error||this.isError)&&"danger-border"}`,id:"basic-addon1"},e("slot",{name:"icon"}))),e("input",{"data-state":!!this.value?"":this.mask?"empty":"",ref:t=>this.inputRef=t,type:this.type,onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},required:this.required,onBlur:this.handleBlur.bind(this),disabled:this.disabled,class:`ir-input form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder ${(this.error||this.isError)&&"danger-border"}`,id:this.id,value:this.value,placeholder:this.placeholder,onInput:this.handleInputChange.bind(this)}))}let t="form-control";let i=e("div",{class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},e("label",{htmlFor:this.id,class:` input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(!this.LabelAvailable){i=""}if(this.inputStyle===false){t=""}if(this.required&&!this.initial){t=`${t} border-danger`}return e("div",{class:"form-group"},e("div",{class:"input-group row m-0"},i,e("input",{"data-state":!!this.value?"":this.mask?"empty":"",id:this.id,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:`ir-input ${t} ${this.error||this.isError?"border-danger":""} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12} ${this.readonly&&"bg-white"} ${this.inputStyles}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:this.placeholder,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled})))}get el(){return o(this)}static get watchers(){return{mask:["handleMaskChange"],submitted:["watchHandler2"],error:["handleErrorChange"],"aria-invalid":["handleAriaInvalidChange"]}}};ho.style=co;const uo=".sc-ir-interactive-title-h{display:block;width:100%;--hk-green:green}*.sc-ir-interactive-title{box-sizing:border-box}.popover-title.sc-ir-interactive-title{position:relative;width:100%;height:100%;margin:0;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;z-index:10;left:0;display:flex;align-items:center}.popover-container.sc-ir-interactive-title{position:absolute;bottom:0px;left:var(--ir-popover-left, 10px);background:rgb(0, 0, 0);color:white;min-width:100%;box-shadow:rgba(0, 0, 0, 0.2) 0px 2px 10px;z-index:9999;padding:3.5px 7px;border-radius:5px;pointer-events:none;opacity:0;transition:all 100ms ease;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-style:normal;font-weight:400;line-height:1.45;text-decoration:none;text-shadow:none;font-size:0.875rem}.popover-container[data-state='show'].sc-ir-interactive-title{opacity:1}.hk-dot.sc-ir-interactive-title{inset:0;position:absolute;display:flex;align-items:center;justify-content:center;width:fit-content;padding:4px;left:auto;padding-inline:var(--ir-popover-left);color:var(--dot-color, #ffffff)}";const fo=uo;const po=class{constructor(e){t(this,e);this.popoverTitle=undefined;this.irPopoverLeft="10px";this.hkStatus=undefined;this.cropSize=15}componentWillLoad(){this.croppedTitle=this.popoverTitle}componentDidLoad(){this.initializePopover()}initializePopover(){const t=this.el.querySelector(".popover-title");if(t){const e=t.scrollWidth>t.offsetWidth;if(e){this.croppedTitle=this.popoverTitle.slice(0,this.cropSize)+"...";this.croppedTitleEl.innerHTML=this.croppedTitle;$(t).popover({trigger:"hover",content:this.popoverTitle,placement:"top"})}else{$(t).popover("dispose")}}}render(){return e(i,{key:"9bc7e29c2f22168657f426faf3a2aeee96f9add2",style:{"--ir-popover-left":this.irPopoverLeft}},e("p",{key:"552737d042c61f95920d8983b86cb585c2bfb961",class:"popover-title",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e("span",{key:"78ce7cab83460c9180970f2760de0c5e6e994131",ref:t=>this.croppedTitleEl=t,class:"croppedTitle"},this.croppedTitle),this.hkStatus&&e("div",{key:"74c4997ff003ea916db8a2f8fab590d2c06d8059",title:"This unit is dirty",class:`hk-dot`},e("svg",{key:"02f4e25f73eef5ff0c790811207710adb34b2ebd",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"13.5",viewBox:"0 0 576 512"},e("path",{key:"944b60e7f0fcb09836bf9c1ec2936cec444c3a0d",d:"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z"})))))}get el(){return o(this)}};po.style=fo;const bo=".page-loader.sc-ir-interceptor{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-interceptor{padding:20px;display:flex;align-items:center;justify-content:center;border-radius:5px;background:white}.loadingScreenContainer.sc-ir-interceptor{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:100000;background:rgba(0, 0, 0, 0.2);pointer-events:all;display:flex;align-items:center;justify-content:center}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const go=bo;const mo=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.isShown=false;this.isLoading=false;this.isUnassignedUnit=false;this.endpointsCount=0;this.isPageLoadingStoped=null;this.handledEndpoints=["/Get_Exposed_Calendar","/ReAllocate_Exposed_Room","/Get_Exposed_Bookings"]}handleStopPageLoading(t){this.isLoading=false;this.isPageLoadingStoped=t.detail}componentWillLoad(){this.setupAxiosInterceptors()}setupAxiosInterceptors(){W.interceptors.request.use(this.handleRequest.bind(this),this.handleError.bind(this));W.interceptors.response.use(this.handleResponse.bind(this),this.handleError.bind(this))}extractEndpoint(t){return t.split("?")[0]}isHandledEndpoint(t){return this.handledEndpoints.includes(t)}handleRequest(t){const e=this.extractEndpoint(t.url);K[e]="pending";t.params=t.params||{};if(this.isHandledEndpoint(e)&&this.isPageLoadingStoped!==e){if(e!=="/Get_Exposed_Calendar"){this.isLoading=true}else{if(this.endpointsCount>0){this.isLoading=true}}}if(e==="/Get_Exposed_Calendar"){this.endpointsCount=this.endpointsCount+1}return t}handleResponse(t){var e;const i=this.extractEndpoint(t.config.url);if(this.isHandledEndpoint(i)){this.isLoading=false;this.isPageLoadingStoped=null}K[i]="done";if((e=t.data.ExceptionMsg)===null||e===void 0?void 0:e.trim()){this.handleError(t.data.ExceptionMsg);throw new Error(t.data.ExceptionMsg)}return t}handleError(t){this.toast.emit({type:"error",title:t,description:"",position:"top-right"});return Promise.reject(t)}render(){return e(i,{key:"1b21207befc42fff6bdec3ad99197878da25afbd"},this.isLoading&&!this.isPageLoadingStoped&&e("div",{key:"107a5203c99bd7e2099d293919f850bc1a3fb751",class:"loadingScreenContainer"},e("div",{key:"9071a8e29c1dce976b63cd6417a9b9e742ecefc0",class:"loaderContainer"},e("span",{key:"974a33aa71683b329ecff1c5986bab825fb9da38",class:"page-loader"}))))}};mo.style=go;const vo=".logo.sc-ir-label{height:1.5rem;width:1.5rem}.sc-ir-label-h{display:flex;gap:5px;align-items:center}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}.label_message.sc-ir-label{margin:0 3px;padding:0}.label_title.sc-ir-label{min-width:max-content;padding:0;margin:0;font-weight:600}.label_placeholder.sc-ir-label{color:#cacfe7;padding:0 !important;margin:0 !important}.icon-container.sc-ir-label{margin:0;padding:0}.country.sc-ir-label{height:16px;width:23px;border-radius:3px}svg.sc-ir-label{margin:0;padding:0}.label_wrapper_inline.sc-ir-label{display:inline;max-width:100%;gap:5px;margin-bottom:5px}.label_wrapper_flex.sc-ir-label{display:flex;align-items:center;gap:5px;max-width:100%;margin-bottom:5px}.label_title.sc-ir-label{font-weight:600;white-space:nowrap;display:inline}.label_message.sc-ir-label{display:inline;white-space:normal;word-break:break-word}";const yo=vo;const ko=class{constructor(e){t(this,e);this.labelText=undefined;this.content=undefined;this.display="flex";this.renderContentAsHtml=false;this.image=null;this.isCountryImage=false;this.imageStyle="";this.ignoreEmptyContent=false;this.placeholder=undefined;this.containerStyle=undefined}render(){var t,s,n;if(!this.placeholder&&!this.content&&!this.ignoreEmptyContent){return null}return e(i,{class:this.image?"align-items-center":""},e("div",{class:`${this.display==="inline"?"label_wrapper_inline":"label_wrapper_flex"} `,style:this.containerStyle},this.labelText&&e("p",{class:"label_title"},this.labelText),e("slot",{name:"prefix"}),this.image&&e("img",{src:this.image.src,alt:(t=this.image.alt)!==null&&t!==void 0?t:this.image.src,class:`p-0 m-0 ${this.isCountryImage?"country":"logo"} ${(s=this.image.style)!==null&&s!==void 0?s:""} ${(n=this.imageStyle)!==null&&n!==void 0?n:""}`}),this.content?this.renderContentAsHtml?e("p",{class:"label_message",innerHTML:this.content}):e("p",{class:"label_message"},this.content):e("p",{class:"label_placeholder"},this.placeholder),e("slot",null),e("slot",{name:"suffix"})))}};ko.style=yo;const wo=".sc-ir-loading-screen-h{display:fixed;height:100vh;width:100vw;z-index:1000;top:0;left:0;display:flex;align-items:center;justify-content:center;background:white}.loader.sc-ir-loading-screen{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-loading-screen{position:absolute;z-index:100001;padding:20px;top:50%;left:50%;transform:translate(-50%, -50%);background:white;display:flex;align-items:center;justify-content:center;gap:20px;border-radius:5px}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const xo=wo;const _o=class{constructor(e){t(this,e);this.message=""}render(){return e(i,{key:"739267a690cc0eedbfe54e68c44aa5ef4e5f6e01"},e("span",{key:"0bd18c152d261d8d1b89f01fc3b487b255446489",class:"loader"}))}};_o.style=xo;const Do=".backdropModal.sc-ir-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-modal{padding:10px;background:white;border-radius:5px}.ir-alert-header.sc-ir-modal{display:flex;font-size:1rem;font-weight:700}.modal.sc-ir-modal{z-index:1001 !important}.modal-dialog.sc-ir-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-modal{gap:10px}.ir-modal.sc-ir-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const Co=Do;const Oo=class{constructor(e){t(this,e);this.confirmModal=s(this,"confirmModal",7);this.cancelModal=s(this,"cancelModal",7);this.modalTitle="Modal Title";this.modalBody="Modal Body";this.showTitle=undefined;this.rightBtnActive=true;this.leftBtnActive=true;this.rightBtnText="Confirm";this.leftBtnText="Close";this.isLoading=false;this.autoClose=true;this.rightBtnColor="primary";this.leftBtnColor="secondary";this.btnPosition="right";this.iconAvailable=false;this.icon="";this.isOpen=false;this.item={}}async closeModal(){this.isOpen=false}async openModal(){this.isOpen=true}btnClickHandler(t){let e=t.target;let i=e.name;if(i===this.leftBtnText){this.cancelModal.emit();this.item={};this.closeModal()}else if(i===this.rightBtnText){this.confirmModal.emit(this.item);this.item={};if(this.autoClose){this.closeModal()}}}render(){return[e("div",{key:"388c0a5b8e38abea4f0f2b10ab21b373685334c3",class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{this.cancelModal.emit();if(this.autoClose&&!this.isLoading){this.closeModal()}}}),e("div",{key:"e1270ab114da58af1057f934f0cf8d1854c27e18","data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},e("div",{key:"916b0b1e0005f29daaac9c5445901f934e6e87f1",class:`ir-alert-content p-2`},this.showTitle&&e("div",{key:"a413a86b915d1fbfe31ff0f80af5d357623d522d",class:`ir-alert-header`},e("p",{key:"00e885e1a9365a017febc2d22f814bc1f5c7e7fa"},this.modalTitle)),e("div",{key:"2dc988c82c713d08a916c3756d3c24a7435b5bf7",class:"modal-body text-left p-0 mb-2"},e("div",{key:"302a0b26b76d1a0a6e33600c538350c82fa38083"},this.modalBody)),e("div",{key:"574fe8ae91b4b67c5e48cf1ae6255b90b18176a9",class:`ir-alert-footer border-0  d-flex justify-content-${this.btnPosition==="center"?"center":this.btnPosition==="left"?"start":"end"}`},this.leftBtnActive&&e("ir-button",{key:"bed95ef273ea6eb10fbaa8557fb0d0015bd07c3d",btn_disabled:this.isLoading,icon:"",btn_color:this.leftBtnColor,btn_block:true,text:this.leftBtnText,name:this.leftBtnText}),this.rightBtnActive&&e("ir-button",{key:"3f94c5578bc59ec842ba96d6380b97905b05c342",icon:"",btn_color:this.rightBtnColor,btn_disabled:this.isLoading,isLoading:this.isLoading,btn_block:true,text:this.rightBtnText,name:this.rightBtnText}))))]}};Oo.style=Co;const Eo=".sc-ir-payment-actions-h{display:block}.sc-ir-payment-actions-h p.sc-ir-payment-actions,.sc-ir-payment-actions-h div.sc-ir-payment-actions,.sc-ir-payment-actions-h span.sc-ir-payment-actions,.sc-ir-payment-actions-h ir-icons.sc-ir-payment-actions{box-sizing:border-box;padding:0;margin:0}.action-container.sc-ir-payment-actions td.sc-ir-payment-actions{padding:0px 0.5rem;padding-bottom:0.5rem}.action-container.sc-ir-payment-actions .amount_action.sc-ir-payment-actions{padding-inline-start:0}.overdue_action.sc-ir-payment-actions{color:#ff4961;border-radius:0.25rem;display:flex;align-items:center;gap:0.5rem}.future_action.sc-ir-payment-actions{border-radius:0.25rem;color:#1e9ff2;display:flex;align-items:center;justify-content:start;gap:0.5rem}.date_action.sc-ir-payment-actions{font-weight:500}.amount_action.sc-ir-payment-actions{font-weight:600}";const Ao=Eo;const Bo=class{constructor(e){t(this,e);this.generatePayment=s(this,"generatePayment",7);this.booking=undefined;this.paymentAction=undefined}render(){var t,s;if(((t=this.paymentAction)===null||t===void 0?void 0:t.filter((t=>t.amount!==0)).length)==0){return null}return e(i,null,e("div",{class:"my-1"},e("span",{class:"font-medium"},"Payment actions")),e("table",null,e("thead",null,e("th",null,e("p",{class:"sr-only"},"Amount")),e("th",null,e("p",{class:"sr-only"},"Due date")),e("th",null,e("p",{class:"sr-only"},"Pay")),e("th",null,e("p",{class:"sr-only"},"Status"))),e("tbody",null,(s=this.paymentAction)===null||s===void 0?void 0:s.map((t=>{if(!t.due_on){return null}return e("tr",{class:"action-container"},e("td",{class:"amount_action"},m(t.currency.symbol,t.amount)),e("td",{class:"date_action"},U(new Date(t.due_on)).format("ddd, DD MMM YYYY")),t.amount>0&&e("td",null,e("ir-button",{btn_color:"outline",text:"Pay",size:"sm",onClickHandler:()=>this.generatePayment.emit(t)})),t.type==="overdue"&&t.amount>0&&e("td",null,e("div",{class:"overdue_action"},e("svg",{height:16,width:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e("path",{fill:"currentColor",d:"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})),e("span",null,"Overdue"))),t.type==="future"&&t.amount>0&&e("td",null,e("div",{class:"future_action "},e("svg",{xmlns:"http://www.w3.org/2000/svg",height:16,width:16,viewBox:"0 0 512 512"},e("path",{fill:"currentColor",d:"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"})),e("span",null,U(new Date(t.due_on)).isSame(new Date)?"Today":"Future"))))})))))}};Bo.style=Ao;const Mo=".sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}.total-cost-container.sc-ir-payment-details{background:#7cbebe;color:white;padding:0.5rem;border-radius:5px}.payment-actions.sc-ir-payment-details{display:flex;align-items:center;justify-content:center;height:100%;gap:0.5rem}.payment_action_beta_container.sc-ir-payment-details{border:1px solid var(--red);position:relative;padding:4px;box-sizing:border-box;border-radius:4px}.beta.sc-ir-payment-details{position:absolute;top:4px;background:var(--red);color:white;padding:0.2rem 0.3rem;font-size:12px;border-radius:4px;right:4px;margin:0}";const To=Mo;const Io=class{constructor(e){t(this,e);this.resetBookingData=s(this,"resetBookingData",7);this.resetExposedCancelationDueAmount=s(this,"resetExposedCancelationDueAmount",7);this.toast=s(this,"toast",7);this.paymentService=new Q;this.bookingService=new l;this.paymentBackground="white";this.bookingDetails=undefined;this.paymentActions=undefined;this.newTableRow=false;this.collapsedPayment=false;this.collapsedGuarantee=false;this.flag=false;this.confirmModal=false;this.toBeDeletedItem=undefined;this.paymentDetailsUrl="";this.paymentExceptionMessage="";this.modal_mode=null;this.itemToBeAdded=undefined}handlePaymentGeneration(t){const e=t.detail;this.newTableRow=true;this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{amount:e.amount,date:e.due_on});this.paymentBackground="rgba(250, 253, 174)"}async componentWillLoad(){try{this.initializeItemToBeAdded()}catch(t){if(this.bookingDetails.guest.cci){return}if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentExceptionMessage=t}}}initializeItemToBeAdded(){this.itemToBeAdded={id:-1,date:U().format("YYYY-MM-DD"),amount:null,currency:this.bookingDetails.currency,designation:"",reference:""};this.paymentBackground="white"}async _processPaymentSave(){if(this.itemToBeAdded.amount===null){this.toast.emit({type:"error",title:p.entries.Lcz_EnterAmount,description:"",position:"top-right"});return}if(Number(this.itemToBeAdded.amount)>Number(this.bookingDetails.financial.due_amount)){this.modal_mode="save";this.openModal();return}this._handleSave()}async _handleSave(){this.paymentBackground="white";try{await this.paymentService.AddPayment(this.itemToBeAdded,this.bookingDetails.booking_nbr);this.initializeItemToBeAdded();this.resetBookingData.emit(null);this.resetExposedCancelationDueAmount.emit(null)}catch(t){console.log(t)}}handlePaymentInputChange(t,e,i){this.paymentBackground="white";if(t==="amount"){if(!isNaN(e)||e===""){if(e===""){this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:null})}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:parseFloat(e)})}}else if(i&&i.target){let t=i.target;let e=t.value;e=e.replace(/[^\d-]|(?<!^)-/g,"");t.value=e}}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:e})}}async cancelPayment(){try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.bookingDetails.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.bookingDetails=Object.assign(Object.assign({},this.bookingDetails),{financial:Object.assign(Object.assign({},this.bookingDetails.financial),{payments:t})});this.confirmModal=!this.confirmModal;this.resetBookingData.emit(null);this.resetExposedCancelationDueAmount.emit(null);this.toBeDeletedItem=null;this.modal_mode=null}catch(t){console.log(t)}}async handleConfirmModal(t){this.paymentBackground="white";t.stopImmediatePropagation();t.stopPropagation();if(this.modal_mode==="delete"){await this.cancelPayment()}else{await this._handleSave()}}openModal(){const t=document.querySelector(".delete-record-modal");t.openModal()}async handleCancelModal(t){t.stopImmediatePropagation();t.stopPropagation();try{this.paymentBackground="white";if(this.modal_mode==="save"){this.initializeItemToBeAdded()}}catch(t){console.log(t)}}handleBookingDetails(){if(this.newTableRow){this.newTableRow=false}}handleDateChange(t){this.handlePaymentInputChange("date",t.detail.end.format("YYYY-MM-DD"))}_renderTableRow(t,i="normal"){var s,o;return e(n,null,e("tr",null,e("td",{class:"border payments-height border-light border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left"},tt(t.date)):e("ir-date-picker",{date:((s=this.itemToBeAdded)===null||s===void 0?void 0:s.date)?new Date(this.itemToBeAdded.date):new Date,minDate:U().add(-2,"months").startOf("month").format("YYYY-MM-DD"),singleDatePicker:true,autoApply:true,onDateChanged:this.handleDateChange.bind(this)})),e("td",{class:"border payments-height border-light border-bottom-0 text-center "},i==="normal"?e("span",{class:"sm-padding-right"},m(this.bookingDetails.currency.symbol,t.amount)):e("input",{type:"text",class:"border-0 text-center form-control py-0 m-0 w-100",value:this.itemToBeAdded.amount,onBlur:t=>{t.target.value=Number(this.itemToBeAdded.amount).toFixed(2)},onInput:t=>this.handlePaymentInputChange("amount",+t.target.value,t)})),e("td",{class:"border payments-height border-light border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left"},t.designation):e("input",{class:"border-0 w-100 form-control py-0 m-0",onInput:t=>this.handlePaymentInputChange("designation",t.target.value),type:"text"})),e("td",{rowSpan:2,class:"border payments-height border-light border-bottom-0 text-center"},e("div",{class:"payment-actions"},i==="add"&&e("ir-button",{variant:"icon",icon_name:"save",style:Xt.secondary,isLoading:i==="add"&&G("/Do_Payment"),class:"m-0",onClickHandler:()=>{this._processPaymentSave()}}),e("ir-button",{variant:"icon",icon_name:"trash",style:Xt.danger,isLoading:((o=this.toBeDeletedItem)===null||o===void 0?void 0:o.id)===(t===null||t===void 0?void 0:t.id)&&G("/Cancel_Payment"),onClickHandler:i==="add"?()=>{this.newTableRow=false;this.initializeItemToBeAdded()}:()=>{this.modal_mode="delete";this.toBeDeletedItem=t;this.openModal()}})))),e("tr",null,e("td",{colSpan:3,class:"border border-light payments-height border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left "},t.reference):e("input",{class:"border-0 w-100  form-control py-0 m-0",onKeyPress:t=>{if(t.key==="Enter"){this.newTableRow=false;this._handleSave()}},onInput:t=>this.handlePaymentInputChange("reference",t.target.value),type:"text"}))))}bookingGuarantee(){var t,i,s,n,o,r,a,l,c,h,d,u,f,b,g,m,v,y,k,w,x,_,D,C,O,E,A,B;const M=this.bookingDetails.is_direct?this.getPaymentMethod():null;if(this.bookingDetails.is_direct&&!M&&!this.bookingDetails.guest.cci){return null}return e("div",{class:"mb-1"},e("div",{class:"d-flex align-items-center"},e("span",{class:"mr-1 font-medium"},p.entries.Lcz_BookingGuarantee,!!M&&e("span",null,": ",M)),(!this.bookingDetails.is_direct||this.bookingDetails.is_direct&&this.bookingDetails.guest.cci)&&e("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":`.guarrantee`,"aria-expanded":this.collapsedGuarantee?"true":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",variant:"icon",icon_name:"credit_card",onClickHandler:async()=>{if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr&&!this.bookingDetails.guest.cci){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.bookingDetails.booking_nbr)}this.collapsedGuarantee=!this.collapsedGuarantee}})),e("div",{class:"collapse guarrantee "},this.bookingDetails.guest.cci?[e("div",null,((i=(t=this.bookingDetails)===null||t===void 0?void 0:t.guest)===null||i===void 0?void 0:i.cci)&&"Card:"," ",e("span",null,((o=(n=(s=this.bookingDetails)===null||s===void 0?void 0:s.guest)===null||n===void 0?void 0:n.cci)===null||o===void 0?void 0:o.nbr)||"")," ",((l=(a=(r=this.bookingDetails)===null||r===void 0?void 0:r.guest)===null||a===void 0?void 0:a.cci)===null||l===void 0?void 0:l.expiry_month)&&"Expiry: ",e("span",null," ",((d=(h=(c=this.bookingDetails)===null||c===void 0?void 0:c.guest)===null||h===void 0?void 0:h.cci)===null||d===void 0?void 0:d.expiry_month)||""," ",((b=(f=(u=this.bookingDetails)===null||u===void 0?void 0:u.guest)===null||f===void 0?void 0:f.cci)===null||b===void 0?void 0:b.expiry_year)&&"/"+((v=(m=(g=this.bookingDetails)===null||g===void 0?void 0:g.guest)===null||m===void 0?void 0:m.cci)===null||v===void 0?void 0:v.expiry_year))),e("div",null,((k=(y=this.bookingDetails)===null||y===void 0?void 0:y.guest)===null||k===void 0?void 0:k.cci.holder_name)&&"Name:"," ",e("span",null,((_=(x=(w=this.bookingDetails)===null||w===void 0?void 0:w.guest)===null||x===void 0?void 0:x.cci)===null||_===void 0?void 0:_.holder_name)||"")," ",((O=(C=(D=this.bookingDetails)===null||D===void 0?void 0:D.guest)===null||C===void 0?void 0:C.cci)===null||O===void 0?void 0:O.cvc)&&"- CVC:"," ",e("span",null," ",((B=(A=(E=this.bookingDetails)===null||E===void 0?void 0:E.guest)===null||A===void 0?void 0:A.cci)===null||B===void 0?void 0:B.cvc)||""))]:this.paymentDetailsUrl?e("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"}):e("div",{class:"text-center"},this.paymentExceptionMessage)))}checkPaymentCode(t){var e,i,s;console.log(g.allowed_payment_methods);return(s=(i=(e=g.allowed_payment_methods)===null||e===void 0?void 0:e.find((e=>e.code===t)))===null||i===void 0?void 0:i.description)!==null&&s!==void 0?s:null}getPaymentMethod(){var t,e,i,s;let n=null;const o=(e=(t=this.bookingDetails)===null||t===void 0?void 0:t.extras)===null||e===void 0?void 0:e.find((t=>t.key==="payment_code"));if(this.bookingDetails.agent){const t=(s=(i=this.bookingDetails)===null||i===void 0?void 0:i.extras)===null||s===void 0?void 0:s.find((t=>t.key==="agent_payment_mode"));if(t){n=t.value==="001"?p.entries.Lcz_OnCredit:o?this.checkPaymentCode(o.value):null}}else{if(o){n=this.checkPaymentCode(o.value)}}return n}_renderDueDate(t){return e("tr",null,e("td",{class:"pr-1"},tt(t.date)),e("td",{class:"pr-1"},m(this.bookingDetails.currency.symbol,t.amount)),e("td",{class:"pr-1"},t.description),e("td",{class:"collapse font-size-small roomName"},t.room))}render(){var t,i;if(!this.bookingDetails.financial){return null}return[e("div",{class:"card m-0"},e("div",{class:"p-1"},this.bookingDetails.financial.gross_cost>0&&this.bookingDetails.financial.gross_cost!==null&&e("div",{class:"mb-2 h4 total-cost-container"},p.entries.Lcz_TotalCost,": ",e("span",null,m(this.bookingDetails.currency.symbol,this.bookingDetails.financial.gross_cost))),e("div",{class:" h4"},"Balance: ",e("span",{class:"danger font-weight-bold"},m(this.bookingDetails.currency.symbol,this.bookingDetails.financial.due_amount))),e("div",{class:"mb-2 h4"},"Collected:"," ",e("span",{class:""},m(this.bookingDetails.currency.symbol,this.bookingDetails.financial.payments?this.bookingDetails.financial.payments.reduce(((t,e)=>t+e.amount),0):0))),this.bookingGuarantee(),((t=this.paymentActions)===null||t===void 0?void 0:t.filter((t=>t.amount!==0)).length)>0&&this.bookingDetails.is_direct&&e("div",{class:"payment_action_beta_container"},e("p",{class:"beta"},"Beta"),e("ir-payment-actions",{paymentAction:this.paymentActions,booking:this.bookingDetails})),e("div",{class:"mt-2 d-flex  flex-column rounded payment-container"},e("div",{class:"d-flex align-items-center justify-content-between"},e("span",{class:"font-medium"},p.entries.Lcz_Payments," history"),e("ir-button",{id:"add-payment",variant:"icon",icon_name:"square_plus",style:{"--icon-size":"1.5rem"},onClickHandler:()=>{this.newTableRow=true}})),e("table",{class:"mt-1",style:{backgroundColor:this.paymentBackground}},e("thead",null,e("tr",null,e("th",{class:"border border-light border-bottom-0 text-center payment_date"},p.entries.Lcz_Dates),e("th",{class:"border border-light border-bottom-0 text-center w-60"},p.entries.Lcz_Amount),e("th",{class:"border border-light border-bottom-0 text-center designation"},p.entries.Lcz_Designation),e("th",{class:"border border-light border-bottom-0 text-center action_icons"},e("span",{class:"sr-only"},"payment actions")))),e("tbody",null,(i=this.bookingDetails.financial.payments)===null||i===void 0?void 0:i.map((t=>this._renderTableRow(t))),this.newTableRow?this._renderTableRow(null,"add"):null))))),e("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:p.entries.Lcz_Confirmation,modalBody:this.modal_mode==="delete"?p.entries.Lcz_IfDeletedPermantlyLost:p.entries.Lcz_EnteringAmountGreaterThanDue,iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:p.entries.Lcz_Cancel,rightBtnText:this.modal_mode==="delete"?p.entries.Lcz_Delete:p.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modal_mode==="delete"?"danger":"primary",onConfirmModal:this.handleConfirmModal.bind(this),onCancelModal:this.handleCancelModal.bind(this)})]}static get watchers(){return{bookingDetails:["handleBookingDetails"]}}};Io.style=To;const So=".sc-ir-phone-input-h{display:block}.input-container.sc-ir-phone-input{display:flex;align-items:center;padding:0 !important}.input-container.sc-ir-phone-input:focus-within{border-color:#1e9ff2}.border-theme.sc-ir-phone-input{border-color:#cacfe7}.input-container.sc-ir-phone-input input.sc-ir-phone-input{flex:1;border:0}.input-container.sc-ir-phone-input input.sc-ir-phone-input:focus{outline:none}.dropdown-trigger.sc-ir-phone-input{display:flex;align-items:center;gap:8px;background:white;border:0;border-right:1px solid #cacfe7}.ir-dropdown-container.sc-ir-phone-input{position:absolute;z-index:1000;bottom:-30px;width:100%;left:0;background:white}.input-container.sc-ir-phone-input label.sc-ir-phone-input{display:flex;align-items:center;justify-content:center;margin:0;padding:0 5px}.flag.sc-ir-phone-input{height:1rem;aspect-ratio:4/3;border-radius:3px}.is-invalid.sc-ir-phone-input{border-color:#ff4961}.phone_prefix_label.sc-ir-phone-input{padding:0 0.5rem;margin:0}";const Yo=So;const No=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.bookingService=new l;this.label=undefined;this.value="";this.disabled=false;this.error=false;this.token=undefined;this.language=undefined;this.default_country=null;this.phone_prefix=null;this.placeholder=undefined;this.countries=[];this.inputValue="";this.isDropdownVisible=false;this.currentCountry=undefined}async componentWillLoad(){if(this.countries.length===0){const t=await this.bookingService.getCountries(this.language);this.countries=t}if(this.phone_prefix){this.setCountryFromPhonePrefix()}else{if(this.default_country){this.setCurrentCountry(this.default_country)}}this.inputValue=this.value}handleValueChange(t,e){if(t!==e){this.inputValue=t}}handlePhoneChange(t,e){if(t!==e){this.setCountryFromPhonePrefix()}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isDropdownVisible=false}}handleInputChange(t){var e;let i=t.target;let s=i.value;s=s.replace(/[^+\d]+/g,"");i.value=s;this.inputValue=s;this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.inputValue})}setCountryFromPhonePrefix(){var t;console.log(this.phone_prefix);let e=this.countries.find((t=>t.phone_prefix===this.phone_prefix));if(!e){e=this.countries.find((t=>t.id.toString()===this.phone_prefix));if(!e){return}}console.log(e);this.currentCountry=Object.assign({},e);this.textChange.emit({phone_prefix:(t=this.currentCountry)===null||t===void 0?void 0:t.phone_prefix,mobile:this.value})}setCurrentCountry(t){var e;const i=this.countries.find((e=>e.id===t));if(!i){throw new Error("Invalid country id")}this.currentCountry=Object.assign({},i);this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.value})}render(){var t,s;return e(i,{key:"c45de10433eb63750175f5502d1cd8856ae26083"},e("div",{key:"440f4853cfcb1164a31435a255f2ee0e8090ad0a",class:"form-group mr-0"},e("div",{key:"ec92e1cdc420f882c23aa6016ad02af33658143d",class:"input-group row m-0 p-0 position-relative"},this.label&&e("div",{key:"8244b5c2e1e6364d6852d6e703035644c7a9930c",class:`input-group-prepend col-3 p-0 text-dark border-none`},e("label",{key:"12626af6082ca67df61d4641f33a000ad552ecb0",class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.label)),e("div",{key:"439c9dc1f8dcb04d0e76643596e3f160cd2c99cb",class:"form-control  input-container  flex-fill"+(this.error?" is-invalid":"")},e("button",{key:"b4cf29524adb58afb15ea7a4822547d5920ffc91",onClick:()=>this.isDropdownVisible=!this.isDropdownVisible,class:"dropdown-trigger"},this.currentCountry?e("img",{src:(t=this.currentCountry)===null||t===void 0?void 0:t.flag,class:"flag"}):e("p",{class:"p-0 m-0 "},p.entries.Lcz_Select),e("svg",{key:"c02dcf4afffa0e3378bcb00aef170d78c65ad9ea",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{key:"e8d2d21d07908f8b4b2f58f095c8d9c125ac864b",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),e("p",{key:"dcaba60d2df1ee7f03ce43c28d150480c2683bcd",class:"phone_prefix_label"},(s=this.currentCountry)===null||s===void 0?void 0:s.phone_prefix),e("input",{key:"7e6865a13d60c249248d70eed330e613e17bceb8",type:"text",placeholder:this.placeholder,required:true,value:this.inputValue,disabled:this.disabled,onInput:t=>this.handleInputChange(t)}))," ",this.isDropdownVisible&&e("div",{key:"001619d49fb584799180ec86ea00dbe750f1d5a3",class:"ir-dropdown-container"},e("ir-combobox",{key:"223352290e37164c4f2403ecf46dcc397c30bc38",onComboboxValueChange:t=>{this.setCurrentCountry(+t.detail.data);this.isDropdownVisible=false},class:"bg-white",autoFocus:true,placeholder:"Search country",data:this.countries.map((t=>({id:t.id.toString(),name:`${t.name} (${t.phone_prefix})`,image:t.flag})))})))))}get el(){return o(this)}static get watchers(){return{value:["handleValueChange"],phone_prefix:["handlePhoneChange"]}}};No.style=Yo;class Lo{async savePickup(t,e,i){try{const s=t.arrival_time.split(":");await W.post(`/Do_Pickup`,{booking_nbr:e,is_remove:i,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){const e=t.hour&&t.minute?I(t.hour)+":"+I(t.minute):"";return{arrival_date:t.date,arrival_time:e,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let e=[];g.pickup_service.allowed_options.forEach((i=>{if(e.filter((t=>t.value===i.location.id)).length===0){e.push({text:t+" "+i.location.description,value:i.location.id})}}));return e}validateForm(t){if(t.arrival_time.split(":").length!==2){return{error:true,cause:"arrival_time"}}if(t.flight_details===""){return{error:true,cause:"flight_details"}}if(t.vehicle_type_code===""){return{error:true,cause:"vehicle_type_code"}}if(t.number_of_vehicles===0){return{error:true,cause:"number_of_vehicles"}}return{error:false}}getNumberOfVehicles(t,e){let i=Math.ceil(e/t);let s=i>1?i:1;let n=i>1?2:3;return Array.from({length:i+n},((t,e)=>s+e))}getPickUpPersonStatus(t){const e=g.pickup_service.allowed_pricing_models.find((e=>e.code===t));if(!e){return null}return e.description}updateDue(t){const e=this.getPickUpPersonStatus(t.code);if(!e){return}if(e==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const jo=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}";const Ro=jo;const zo=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingData=s(this,"resetBookingData",7);this.pickupService=new Lo;this.defaultPickupData=undefined;this.numberOfPersons=0;this.bookingNumber=undefined;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:U().format("YYYY-MM-DD"),selected_option:undefined};this.vehicleCapacity=[];this.cause=null}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=g.pickup_service.allowed_options.filter((e=>e.location.id===t.location));this.pickupData=Object.assign({},t)}}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e===""){this.updatePickupData("location",-1)}if(e!==""){this.allowedOptionsByLocation=g.pickup_service.allowed_options.filter((t=>t.location.id.toString()===e));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:e,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency});const i=this.el.querySelector("#pickup-time");if(!i){setTimeout((()=>{this.initializeInputMask()}),100)}}}initializeInputMask(){const t=this.el.querySelector("#pickup-time");if(t){Inputmask("Hh:Mm",{placeholder:"HH:mm",definitions:{H:{validator:"[0-2]"},h:{validator:function(t,e,i){var s=e.buffer[i-1];if(s==="2"){return/[0-3]/.test(t)}else{return/[0-9]/.test(t)}}},M:{validator:"[0-5]"},m:{validator:"[0-9]"}},insertMode:true,showMaskOnHover:false,inputmode:"numeric",alias:"datetime",oncomplete:()=>{this.updatePickupData("arrival_time",t.value)},oncleared:()=>{this.updatePickupData("arrival_time","")},onincomplete:()=>{this.updatePickupData("arrival_time",t.value)}}).mask(t)}}handleVehicleQuantityChange(t){if(t.detail===""){return}const e=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:e,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:e}).toFixed(2)})}componentDidLoad(){if(this.defaultPickupData){this.initializeInputMask()}}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let e=g.pickup_service.allowed_options.find((e=>e.location.id===+this.pickupData.location&&e.vehicle.code===t.detail));if(!e){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code})}updatePickupData(t,e){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:e})}async savePickup(){try{this.isLoading=true;const t=this.pickupService.validateForm(this.pickupData);if(t.error){this.cause=t.cause;return}if(this.cause){this.cause=null}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return e(i,{key:"cbd08b33c43237f3f07531e0ff24ed6617dc7582",class:"p-0"},e("ir-title",{key:"a2be55b001c5dfaf289f9668b697419c54c75d2f",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:p.entries.Lcz_Pickup,displayContext:"sidebar"}),e("section",{key:"1b4e000294da863f9cb8e2b24397d15c97412f52",class:"px-1"},e("ir-select",{key:"872cc29024bd724e3519f05cbb28a57d3abc33f3",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:p.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",LabelAvailable:false,data:this.pickupService.getAvailableLocations(p.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&e(n,{key:"9ccf89b30047536e71a3070cfbce57af9b9b34cd"},e("div",{key:"074da0bf06125e97b6f8395eb72d8940e7a5e4e3",class:"d-flex"},e("div",{key:"b1b1bdbfee88c4fd0b068cb6d89ef6b98c20189c",class:"form-group  mr-1"},e("div",{key:"55eb9d1d7fce699091755fa156738819d2ecc26a",class:"input-group row m-0"},e("div",{key:"81a24269b5591e2d7c39b442cd562c3c7ca4406e",class:`input-group-prepend col-5 p-0 text-dark border-0`},e("label",{key:"b3b2811ad2cdb1407d09376ea2171366dcc28102",class:`input-group-text  flex-grow-1 text-dark border-theme `},p.entries.Lcz_ArrivalDate)),e("div",{key:"5750fd637eda278ddf14f412ccc3e25526854764",class:"form-control form-control-md col-7 d-flex align-items-center pl-0"},e("ir-date-picker",{key:"73f658246913ea4cc136933658320c0f84c94b15",minDate:U().format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{this.updatePickupData("arrival_date",t.detail.start.format("YYYY-MM-DD"))}})))),e("div",{key:"f029d9c670285860c78a7af18d367750f09ccd63",class:"form-group"},e("div",{key:"7b7ac8921b3e1c55322643f331c30b1f7f1e4c36",class:"input-group  row m-0"},e("div",{key:"d1ce8452c5e7d2b0cd61731d13939e0c680d7bda",class:`input-group-prepend col-4 col-sm-3 p-0 text-dark border-0`},e("label",{key:"a623a18ab54ba0982b2a12a78d8930523d8a9e84",htmlFor:"pickup",class:`input-group-text flex-grow-1 text-dark border-theme`},p.entries.Lcz_Time)),e("input",{key:"ef6e3b2ea14dc010085c967a5cd8e7e808a8c2a7",type:"text",value:this.pickupData.arrival_time,id:"pickup-time",class:`form-control col-8 col-sm-4 ${this.cause==="arrival_time"&&"border-danger"}`})))),e("ir-input-text",{key:"30a612be24b27cb0d5eccd7f3340031e94340960",value:this.pickupData.flight_details,label:p.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",inputStyles:this.cause==="flight_details"?"border-danger":""}),e("ir-select",{key:"763abd3df4465117b18a4657db5272fc5a788c9d",selectContainerStyle:"mb-1",selectStyles:this.cause==="vehicle_type_code"?"border-danger":"",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:p.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",LabelAvailable:false,data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),e("div",{key:"7e49e9e97fd311b0473212f1feb1d1df8207d1c2",class:"d-flex flex-column flex-md-row"},e("ir-select",{key:"956c1812069687a824098f02aa7915ae8c7e2c81",labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectStyles:this.cause==="number_of_vehicles"?"border-danger":"",selectedValue:this.pickupData.number_of_vehicles,labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:p.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),e("ir-input-text",{key:"b912336092beff9923af23e9342970d5be12d6f1",labelBorder:"theme",readonly:true,value:this.pickupData.due_upon_booking,labelWidth:7,label:`${p.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`,placeholder:"",class:""}))),e("div",{key:"ba5eb3e2134ee99858df263171ecf9a3bbfaba20",class:"d-flex flex-column flex-sm-row mt-3"},e("ir-button",{key:"84cd25ea5b1e8cb4d1fbc277552e137a732d1c4b",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  ${this.defaultPickupData||this.pickupData.location!==-1?"mr-sm-1":""}`,icon:"",text:p.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&e("ir-button",{key:"b313f3fdd553fe38eb4ae54372b19d7d45d7a409",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:this.isLoading,text:p.entries.Lcz_Save,btn_color:"primary",onClick:this.savePickup.bind(this)}))))}get el(){return o(this)}};zo.style=Ro;const $o=".sc-ir-pickup-view-h{display:block}";const Fo=$o;const Po=class{constructor(e){t(this,e);this.booking=undefined}render(){if(!g.pickup_service.is_enabled||!this.booking.is_editable){return null}return e(i,null,e("div",{class:"mb-1"},e("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},e("p",{class:"font-size-large p-0 m-0 "},p.entries.Lcz_Pickup),e("ir-button",{id:"pickup",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.5rem"})})),this.booking.pickup_info&&e("div",{class:"card"},e("div",{class:"p-1"},e("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},e("p",{class:"font-weight-bold mr-1 py-0 my-0"},p.entries.Lcz_Date,": ",e("span",{class:"font-weight-normal"},U(this.booking.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),this.booking.pickup_info.hour&&this.booking.pickup_info.minute&&e("p",{class:"font-weight-bold flex-fill py-0 my-0"},p.entries.Lcz_Time,":",e("span",{class:"font-weight-normal"}," ",et(this.booking.pickup_info.hour.toString(),this.booking.pickup_info.minute.toString()))),e("p",{class:"font-weight-bold py-0 my-0"},p.entries.Lcz_DueUponBooking,":"," ",e("span",{class:"font-weight-normal"},this.booking.pickup_info.currency.symbol,this.booking.pickup_info.total))),e("p",{class:"font-weight-bold py-0 my-0"},p.entries.Lcz_FlightDetails,":",e("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.details}`)),e("p",{class:"py-0 my-0 pickup-margin"},`${this.booking.pickup_info.selected_option.vehicle.description}`),e("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},p.entries.Lcz_NbrOfVehicles,":",e("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.nbr_of_units}`)),e("p",{class:"small py-0 my-0 pickup-margin"},g.pickup_service.pickup_instruction.description,g.pickup_service.pickup_cancelation_prepayment.description)))))}};Po.style=Fo;const Ho=".sc-ir-pms-logs-h{display:block}.dialog-container-height.sc-ir-pms-logs{height:4rem}.list-title.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-pms-logs{color:#629a4c;font-weight:600}.list-item.red.sc-ir-pms-logs{color:#ff4961;font-weight:600}";const Vo=Ho;const Uo=class{constructor(e){t(this,e);this.bookingService=new l;this.bookingNumber=undefined;this.pmsLogs=undefined}componentWillLoad(){this.init()}async init(){try{this.pmsLogs=await this.bookingService.fetchPMSLogs(this.bookingNumber)}catch(t){console.error(t)}}render(){var t,i,s,n,o,r,a,l;return e("div",{key:"553ee780263b98708c35ff73f62ff133693f9997",class:"p-1"},e("h3",{key:"6eeb9c5cfe7de0b6e4b963f715697aeddbb1c685",class:" text-left mb-1 dialog-title "},p.entries.Lcz_PMS_Logs),G("/Get_Exposed_PMS_Logs")?e("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},e("ir-spinner",null)):e("div",{class:"dialog-container-height"},e("div",{class:"d-flex align-items-center ",style:{paddingBottom:"0.5rem"}},e("p",{class:"list-title p-0 m-0"},p.entries.Lcz_SentAt),((t=this.pmsLogs)===null||t===void 0?void 0:t.sent_date)?e("p",{class:"list-item"},(i=this.pmsLogs)===null||i===void 0?void 0:i.sent_date," ",et((s=this.pmsLogs)===null||s===void 0?void 0:s.sent_hour.toString(),(n=this.pmsLogs)===null||n===void 0?void 0:n.sent_minute.toString())):e("p",{class:`list-item ${((o=this.pmsLogs)===null||o===void 0?void 0:o.sent_date)?"green":"red"}`},((r=this.pmsLogs)===null||r===void 0?void 0:r.is_acknowledged)?p.entries.Lcz_YES:p.entries.Lcz_NO)),e("div",{class:"d-flex align-items-center p-0 m-0"},e("h4",{class:"list-title p-0 m-0"},p.entries.Lcz_Acknowledged),e("p",{class:`list-item  ${((a=this.pmsLogs)===null||a===void 0?void 0:a.is_acknowledged)?"green":"red"}`},((l=this.pmsLogs)===null||l===void 0?void 0:l.is_acknowledged)?p.entries.Lcz_YES:p.entries.Lcz_NO))))}};Uo.style=Vo;const Go=".sc-ir-price-input-h{display:block;--ir-input-border-color:#cacfe7;flex:1 1 0%}.sc-ir-price-input-h .input-group-text.sc-ir-price-input{border-color:var(--ir-input-border-color)}.sc-ir-price-input-h .form-control.sc-ir-price-input,.currency-label.sc-ir-price-input{font-size:14px !important}.ir-bl-lbl-none.sc-ir-price-input,.ir-bl-input-none.sc-ir-price-input{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.ir-br-lbl-none.sc-ir-price-input,.ir-br-input-none.sc-ir-price-input{border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}.ir-br-none.sc-ir-price-input{border-right:none}.ir-bl-none.sc-ir-price-input{border-left:none}.rate-input-container.sc-ir-price-input{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1;padding:0 !important}[class='special-style'].sc-ir-price-input-h .rate-input.sc-ir-price-input{background:black !important}.rate-input.sc-ir-price-input{font-size:0.875rem;line-height:0;padding:0;height:0;box-sizing:border-box;border-left:0;padding-left:0px !important;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.currency-label.with-label.sc-ir-price-input{border-radius:0}.currency-label.sc-ir-price-input{box-sizing:border-box;color:#3b4781;border:1px solid #cacfe7;font-size:0.875rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;pointer-events:none;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.currency-label.disabled.sc-ir-price-input,.rate-input.sc-ir-price-input:disabled{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.price-input-group.sc-ir-price-input:focus-within .currency-label.sc-ir-price-input{border-top:1px solid #1e9ff2;border-bottom:1px solid #1e9ff2;border-left:1px solid #1e9ff2}[data-state='error'].sc-ir-price-input-h .currency-label.sc-ir-price-input,[data-state='error'].sc-ir-price-input-h .rate-input.sc-ir-price-input,.error.sc-ir-price-input{border-color:var(--red, #ff4961) !important}.price-input.sc-ir-price-input:focus{border-right-width:1px !important}.is-invalid.sc-ir-price-input{background-image:none !important}";const Ko=Go;const Wo=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.inputBlur=s(this,"inputBlur",7);this.inputFocus=s(this,"inputFocus",7);this.handleInputChange=t=>{const e=t.target;this.value=e.value;this.textChange.emit(this.value)};this.handleBlur=()=>{this.validateInput(this.value);if(this.value){this.value=parseFloat(this.value).toFixed(2)}this.inputBlur.emit(this.value)};this.handleFocus=()=>{this.inputFocus.emit()};this.label=undefined;this.inputStyle=undefined;this.labelStyle=undefined;this.disabled=undefined;this.currency=undefined;this.autoValidate=true;this.wrapKey=undefined;this.zod=undefined;this.placeholder="";this.value="";this.required=false;this.minValue=undefined;this.maxValue=undefined;this.error=undefined}componentWillLoad(){if(this.el.id){this.id=this.el.id}else{this.id=L()}}hasSpecialClass(t){return this.el.classList.contains(t)}validateInput(t){if(!this.autoValidate){return}if(this.zod){try{this.zod.parse(this.wrapKey?{[this.wrapKey]:t}:t);this.error=false}catch(t){console.log(t);this.error=true}}}render(){var t,i;return e("fieldset",{key:"a8ad1c1197cd75f73fc3f0d73e317402382e50a4",class:"input-group price-input-group m-0 p-0"},this.label&&e("div",{key:"5582283cecd411a19f58aa8f8ec90fcecf96eefc",class:"input-group-prepend"},e("span",{key:"009d92a210df65783b882075e27092ade3073576",class:`input-group-text \n                ${this.labelStyle}\n              ${this.hasSpecialClass("ir-bl-lbl-none")?"ir-bl-lbl-none":""}\n              ${this.hasSpecialClass("ir-br-lbl-none")?"ir-br-lbl-none":""}\n              ${this.hasSpecialClass("ir-br-none")?"ir-br-none":""} \n              ${this.hasSpecialClass("ir-bl-none")?"ir-bl-none":""} \n              `},e("label",{key:"1c0a0181229e917c54c271d1c5e62aaa5f842e06",class:"p-0 m-0 ",htmlFor:this.id},this.label))),e("div",{key:"73627b3d320d34f429ada4b3436de4de08165f07",class:"position-relative has-icon-left rate-input-container"},this.currency&&e("div",{key:"77bb61bccca8b737bad5a041e4a34dead6ee7059",class:`input-group-prepend`},e("span",{key:"14158069b42f2df59c229f37d14748bdffa5b656",class:`input-group-text ${this.disabled?"disabled":""} currency-label ${this.error?"error":""} ${this.label?"with-label":""}`},this.currency)),e("input",{key:"72dd8284d1ed972e39bbd466294a00a07ff5b804",disabled:this.disabled,id:this.id,class:`form-control input-sm rate-input \n              ${this.inputStyle}\n              ${this.hasSpecialClass("ir-br-input-none")?"ir-br-input-none":""} \n              ${this.hasSpecialClass("ir-bl-input-none")?"ir-bl-input-none":""} \n              ${this.error?"error":""} py-0 m-0 ${this.currency?"ir-bl-none":""}`,onInput:this.handleInputChange,onBlur:this.handleBlur,onFocus:this.handleFocus,type:"number",step:"0.01","aria-label":(t=this.el.ariaLabel)!==null&&t!==void 0?t:"price-input","aria-describedby":(i=this.el.ariaDescription)!==null&&i!==void 0?i:"price-input",value:this.value})))}get el(){return o(this)}};Wo.style=Ko;const qo=".sc-ir-reservation-information-h{display:block}";const Xo=qo;const Jo=class{constructor(e){t(this,e);this.openSidebar=s(this,"openSidebar",7);this.booking=undefined;this.countries=undefined;this.userCountry=null}componentWillLoad(){var t,e,i;const s=(e=(t=this.booking)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.country_id;this.userCountry=s?((i=this.countries)===null||i===void 0?void 0:i.find((t=>t.id===s)))||null:null}handleEditClick(t,e){t.stopImmediatePropagation();t.stopPropagation();this.openSidebar.emit({type:e})}renderPhoneNumber(){const{mobile_without_prefix:t,country_phone_prefix:e,country_id:i}=this.booking.guest;if(!t){return null}if(e){return e+" "+t}if(i){const e=this.countries.find((t=>t.id===i));if(!e){throw new Error("Invalid country id")}return e.phone_prefix+" "+t}return t}render(){var t,i,s,n,o,r;const a=H(this.booking.extras);return e("div",{key:"416bf3e28899d580a735b94dca15d1fec188c64a",class:"card"},e("div",{key:"fe7a329f2e717c0deed6f0dbe999a6ea21ca971c",class:"p-1"},e("p",{key:"eb7eae49358a83840a6f33cc7d21212430e3ce2c"},this.booking.property.name||""),e("ir-label",{key:"c131a9e900c32d9b5b7b23e403c1c4e3f288d4bf",labelText:`${p.entries.Lcz_Source}:`,content:this.booking.origin.Label,image:{src:this.booking.origin.Icon,alt:this.booking.origin.Label}}),e("ir-label",{key:"70d26d042b6555ff12af8be76ec44bd83573e008",renderContentAsHtml:true,labelText:`${p.entries.Lcz_BookedOn}:`,content:`${tt(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${et(this.booking.booked_on.hour.toString(),this.booking.booked_on.minute.toString())}`}),e("ir-label",{key:"24c565050a11ab7d4ff12852223f211b9b74cb00",labelText:`${p.entries.Lcz_BookedBy}:`,content:`${this.booking.guest.first_name} ${this.booking.guest.last_name}`},((t=this.booking.guest)===null||t===void 0?void 0:t.nbr_confirmed_bookings)>1&&!this.booking.agent&&e("div",{key:"b3bcd66084388daf893bc3e453a75acf04802adc",class:"m-0 p-0",slot:"prefix"},e("ir-tooltip",{key:"924b457c8da934676760c4a6436ded80520f8297",message:`${p.entries.Lcz_BookingsNbr}`.replace("%1",this.booking.guest.nbr_confirmed_bookings.toString()),customSlot:true},e("div",{key:"69d4e44d93e61f83f494e76d45bf593045252b43",class:"d-flex align-items-center m-0 p-0",slot:"tooltip-trigger",style:{gap:"0.25rem"}},e("p",{key:"4a68c4cd866242b07942719cf4088b76fdc33525",class:"p-0 m-0",style:{color:"#FB0AAD"}},this.booking.guest.nbr_confirmed_bookings),e("ir-icons",{key:"a18785ae507efdb9c79b01f3dcb5766a6cf6d57a",style:{"--icon-size":"1rem"},color:"#FB0AAD",name:"heart-fill"})))),e("ir-button",{key:"d28b26a3290fdc18ee4d4f772f3caa89590c9ace",slot:"suffix",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},Xt.secondary),{"--icon-size":"1.1rem"}),onClickHandler:t=>this.handleEditClick(t,"guest")})),this.booking.guest.mobile&&e("ir-label",{key:"bd80c3dcb19cd3f5c6dbf0d24b1497c1e64e712d",labelText:`${p.entries.Lcz_Phone}:`,content:this.renderPhoneNumber()}),!this.booking.agent&&e("ir-label",{key:"5cfc5b28dadc3ced532d99c40d719dbdb117eb3b",labelText:`${p.entries.Lcz_Email}:`,content:this.booking.guest.email}),this.booking.guest.alternative_email&&e("ir-label",{key:"91d533d732c36ca5ad24b81c77e1604abb643177",labelText:`${p.entries.Lcz_AlternativeEmail}:`,content:this.booking.guest.alternative_email}),((s=(i=this.booking)===null||i===void 0?void 0:i.guest)===null||s===void 0?void 0:s.address)&&e("ir-label",{key:"cc6f63bf29ac5d7ff160eae5a5e23cc25e6800db",labelText:`${p.entries.Lcz_Address}:`,content:this.booking.guest.address}),this.userCountry&&e("ir-label",{key:"09e80774929d9080746a3935426e0ed710e4b531",labelText:`${p.entries.Lcz_Country}:`,isCountryImage:true,content:this.userCountry.name,image:{src:this.userCountry.flag,alt:this.userCountry.name}}),((n=this.booking.guest)===null||n===void 0?void 0:n.notes)&&e("ir-label",{key:"e94e37b2a717e60d668ebde2bac257fecfb482a6",display:"inline",labelText:`${p.entries.Lcz_GuestPrivateNote}:`,content:(o=this.booking.guest)===null||o===void 0?void 0:o.notes}),this.booking.is_direct&&e("ir-label",{key:"3966aa58f9ac55b1cbe161562946142c510d363e",labelText:`${p.entries.Lcz_ArrivalTime}:`,content:this.booking.arrival.description}),this.booking.promo_key&&e("ir-label",{key:"b6351fb9838ef8215a2cd27193c89b806d326b55",labelText:`${p.entries.Lcz_Coupon}:`,content:this.booking.promo_key}),this.booking.is_in_loyalty_mode&&!this.booking.promo_key&&e("div",{key:"c0eac38d5358bed7000f64f6013ff02c995a6798",class:"d-flex align-items-center"},e("svg",{key:"c5ee31364177476994bee1f1b13c04eeaf22b9c6",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"3df1e9bb74a53b80c24afed99dbe5615b0bedd38",fill:"#fc6c85",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"})),e("p",{key:"f453e3abe92dbd60e8f507b334c6a001e5b1beef",class:"m-0 p-0 ml-1"},p.entries.Lcz_LoyaltyDiscountApplied)),this.booking.is_direct?e("ir-label",{labelText:`${p.entries.Lcz_GuestRemark}:`,display:"inline",content:this.booking.remark}):e("ota-label",{class:"m-0 p-0",label:`${p.entries.Lcz_ChannelNotes||"Channel notes"}:`,remarks:this.booking.ota_notes,maxVisibleItems:(r=this.booking.ota_notes)===null||r===void 0?void 0:r.length}),e("div",{key:"3d29cb103d6e9cfe1484aabd70c02e12cd803f5a",class:"d-flex align-items-center justify-content-between"},e("ir-label",{key:"b7825d73df3185564830b81eed9b3943a3f5171b",labelText:`${p.entries.Lcz_BookingPrivateNote}:`,placeholder:p.entries.Lcz_VisibleToHotelOnly,content:a,display:a?"inline":"flex"}),e("ir-button",{key:"cbd74bc71e43d979c13e8fff20712bc61a0b0571",variant:"icon",icon_name:"edit",style:Xt.secondary,onClickHandler:t=>this.handleEditClick(t,"extra_note")}))))}};Jo.style=Xo;const Zo=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.1rem 0.3rem;border-radius:5px;display:block;max-width:100px;box-sizing:border-box;display:inline-block;overflow:hidden;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default}.room_statements.sc-ir-room{display:block;width:100%}.room_statements.sc-ir-room{display:block;width:100%}.room_guest_name.sc-ir-room{width:fit-content;padding:0 !important;margin:0}.room_guest_name.sc-ir-room .button-text.sc-ir-room{padding:0 !important}.room_statements.sc-ir-room span.sc-ir-room{display:inline;white-space:normal;line-height:1.5;word-break:break-word}.room_statements.sc-ir-room b.sc-ir-room{display:inline;margin-right:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.subtotal_row.sc-ir-room{padding-top:8px;font-weight:600}.room_actions_btns.sc-ir-room{gap:0.5rem}.night-cost.sc-ir-room{color:#7cbebe}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Qo=Zo;const tr=class{constructor(e){t(this,e);this.deleteFinished=s(this,"deleteFinished",7);this.pressCheckIn=s(this,"pressCheckIn",7);this.pressCheckOut=s(this,"pressCheckOut",7);this.editInitiated=s(this,"editInitiated",7);this.resetbooking=s(this,"resetbooking",7);this.openSidebar=s(this,"openSidebar",7);this.bookingService=new l;this.booking=undefined;this.bookingIndex=undefined;this.isEditable=undefined;this.room=undefined;this.mealCodeName=undefined;this.myRoomTypeFoodCat=undefined;this.currency="USD";this.language="en";this.legendData=undefined;this.roomsInfo=undefined;this.bedPreferences=undefined;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.collapsed=false;this.isLoading=false;this.modalReason=null;this.mainGuest=undefined}componentWillLoad(){this.mainGuest=this.getMainGuest()}handleClick(t){let e=t.target;if(e.id=="checkin"){this.pressCheckIn.emit(this.room)}else if(e.id=="checkout"){this.pressCheckOut.emit(this.room)}}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}handleEditClick(){var t,e,i,s,n,o,r,a;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.room["assigned_units_pool"],NAME:V((t=this.mainGuest)===null||t===void 0?void 0:t.first_name,(e=this.mainGuest)===null||e===void 0?void 0:e.last_name),EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,TO_DATE:this.booking.to_date,TITLE:`${p.entries.Lcz_EditBookingFor} ${(s=(i=this.room)===null||i===void 0?void 0:i.roomtype)===null||s===void 0?void 0:s.name} ${((o=(n=this.room)===null||n===void 0?void 0:n.unit)===null||o===void 0?void 0:o.name)||""}`,defaultDateRange:{dateDifference:this.room.days.length,fromDate:new Date(this.room.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.room.from_date+"T00:00:00")),toDate:new Date(this.room.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.room.to_date+"T00:00:00")),message:""},bed_preference:this.room.bed_preference,adult_child_offering:this.room.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.room.rateplan.selected_variation.adult_nbr,ARRIVAL:this.booking.arrival,ARRIVAL_TIME:this.booking.arrival.description,BOOKING_NUMBER:this.booking.booking_nbr,cancelation:this.room.rateplan.cancelation,channel_booking_nbr:this.booking.channel_booking_nbr,CHILDREN_COUNT:this.room.rateplan.selected_variation.child_nbr,COUNTRY:this.booking.guest.country_id,ENTRY_DATE:this.booking.from_date,FROM_DATE_STR:this.booking.format.from_date,guarantee:this.room.rateplan.guarantee,GUEST:this.mainGuest,IDENTIFIER:this.room.identifier,is_direct:this.booking.is_direct,IS_EDITABLE:this.booking.is_editable,NO_OF_DAYS:this.room.days.length,NOTES:this.booking.remark,origin:this.booking.origin,POOL:this.room["assigned_units_pool"],PR_ID:(r=this.room.unit)===null||r===void 0?void 0:r.id,RATE:this.room.total,RATE_PLAN:this.room.rateplan.name,RATE_PLAN_ID:this.room.rateplan.id,RATE_TYPE:this.room.roomtype.id,ROOMS:this.booking.rooms,SOURCE:this.booking.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.booking.format.to_date,TOTAL_PRICE:this.booking.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((a=this.room.unit)===null||a===void 0?void 0:a.name)||"",PICKUP_INFO:this.booking.pickup_info,booking:this.booking,currentRoomType:this.room})}openModal(t){if(!t){return}this.modalReason=t;this.modal.openModal()}async handleModalConfirmation(t){try{t.stopImmediatePropagation();t.stopPropagation();if(!this.modalReason){return}this.isLoading=true;switch(this.modalReason){case"delete":await this.deleteRoom();break;case"checkin":case"checkout":await this.bookingService.handleExposedRoomInOut({booking_nbr:this.booking.booking_nbr,room_identifier:this.room.identifier,status:this.modalReason==="checkin"?"001":"002"});this.resetbooking.emit(null);break}}catch(t){console.log(t)}finally{this.isLoading=false;this.modalReason=null;this.modal.closeModal()}}async deleteRoom(){let t=[...this.booking.rooms];t=t.filter((t=>t.identifier!==this.room.identifier));const e={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.booking.booking_nbr,from_date:this.booking.from_date,to_date:this.booking.to_date,remark:this.booking.remark,property:this.booking.property,source:this.booking.source,currency:this.booking.currency,arrival:this.booking.arrival,guest:this.booking.guest,rooms:t},extras:this.booking.extras,pickup_info:this.booking.pickup_info};await this.bookingService.doReservation(e);this.deleteFinished.emit(this.room.identifier)}formatVariation({adult_nbr:t,child_nbr:e},{infant_nbr:i}){const s=e;const n=t>1?p.entries.Lcz_Adults.toLowerCase():p.entries.Lcz_Adult.toLowerCase();const o=s>1?p.entries.Lcz_Children.toLowerCase():p.entries.Lcz_Child.toLowerCase();const r=i>1?p.entries.Lcz_Infants.toLowerCase():p.entries.Lcz_Infant.toLowerCase();const a=[`${t} ${n}`,s?`${s} ${o}`:"",i?`${i} ${r}`:""];return a.filter(Boolean).join("&nbsp&nbsp&nbsp&nbsp")}getBedName(){var t;const e=this.bedPreferences.find((t=>t.CODE_NAME===this.room.bed_preference.toString()));if(!e){throw new Error(`bed with code ${this.room.bed_preference} not found`)}return(t=e[`CODE_VALUE_${this.language}`])!==null&&t!==void 0?t:e.CODE_VALUE_EN}renderModalMessage(){switch(this.modalReason){case"delete":return`${p.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.room.roomtype.name} ${this.room.unit?this.room.unit.name:""} ${p.entries.Lcz_FromThisBooking}`;case"checkin":return`Are you sure you want to Check In this unit?\n`;case"checkout":return`Are you sure you want to Check Out this unit?`;default:return""}}handleCheckIn(){const{adult_nbr:t,children_nbr:e,infant_nbr:i}=this.room.occupancy;if(this.room.sharing_persons.length<t+e+i){return this.showGuestModal()}return this.renderModalMessage()}getMainGuest(){var t;return(t=this.room.sharing_persons)===null||t===void 0?void 0:t.find((t=>t.is_main))}render(){var t,s,o,r;return e(i,{key:"df6912a44f6220e4235aa0cc4855021424d62997",class:"p-1 d-flex m-0"},e("ir-button",{key:"dd520d34512f457e1d6720c6a6bb83808035ba65",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${(t=this.room.identifier)===null||t===void 0?void 0:t.split(" ").join("")}`,"aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"mr-1",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}}),e("div",{key:"94ddc29b7f6203a3936162882fbe38976947e353",class:"flex-fill m-0 "},e("div",{key:"712d79d3700b9ad0fe696ee9bdd84026d8dededa",class:"d-flex align-rooms-start justify-content-between sm-mb-1"},e("p",{key:"81c41e4a8493ee42de99f6f08c40ecefdb0316a4",class:"m-0 p-0"},e("span",{key:"06ad433f61775ac75c88e51da45f53cd09648bbd",class:"m-0 p-0",style:{fontWeight:"600"}},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.room.rateplan.is_non_refundable&&` - ${p.entries.Lcz_NonRefundable}`," "),e("div",{key:"c39125001655f305084f3d06117973504a411e5e",class:"d-flex m-0 p-0 align-rooms-center room_actions_btns"},e("span",{key:"f010d7ed20b005c3b7077cfeb8f9c1d2a159d019",class:"p-0 m-0 font-weight-bold"},m(this.currency,this.room["gross_total"])),this.hasRoomEdit&&this.isEditable&&e("ir-button",{key:"1d30a0e6536e0e31307ec32133b5d9b5a9bce2d2",id:`roomEdit-${this.room.identifier}`,variant:"icon",icon_name:"edit",style:Xt.secondary,onClickHandler:this.handleEditClick.bind(this)}),this.hasRoomDelete&&this.isEditable&&e("ir-button",{key:"af05dd89effb41417ba6c4fe04a6ecb11b3bb2f6",variant:"icon",onClickHandler:this.openModal.bind(this,"delete"),id:`roomDelete-${this.room.identifier}`,icon_name:"trash",style:Xt.danger}))),e("div",{key:"70f76497d8128b664ce8df9d00e1416a90c372fe",class:"d-flex align-rooms-center sm-mb-1"},e("ir-date-view",{key:"386925c1b66514058f546ef2d0fa6aeb8b1ef677",class:"mr-1  flex-grow-1",style:{width:"fit-content"},from_date:this.room.from_date,to_date:this.room.to_date,showDateDifference:false}),!b(this.room.roomtype.id)&&g.is_frontdesk_enabled&&this.room.unit&&e("div",{key:"3bfb54a323c19ab1431e584023c66505de126b5d",class:"d-flex justify-content-center align-items-center"},e("ir-tooltip",{key:"e541ceae082e23abed64710a46f1b85de8f118e4",message:this.room.unit.name,customSlot:true},e("span",{key:"c466d6db143fb272414d9f35f19374f2b7c9fa59",slot:"tooltip-trigger",class:`light-blue-bg  ${this.hasCheckIn||this.hasCheckOut?"mr-2":""} `},this.room.unit.name))),this.hasCheckIn&&e("ir-button",{key:"2e89ddcfc444b8970f50589a53413ec6c4e791dd",onClickHandler:this.handleCheckIn.bind(this),id:"checkin",btn_color:"outline",size:"sm",text:p.entries.Lcz_CheckIn}),this.hasCheckOut&&e("ir-button",{key:"0bacb8c6df26469caa0c89d2b34c388fac358b4a",onClickHandler:this.openModal.bind(this,"checkout"),id:"checkout",btn_color:"outline",size:"sm",text:p.entries.Lcz_CheckOut})),e("div",{key:"d8a004f1bfeff043298ad1b67017a7feaa1bab68",class:"d-flex align-items-center"},e("span",{key:"2d5fa431c08308af2f6e5add0ca0e4be4a53adb7",class:"mr-1"},`${((s=this.mainGuest)===null||s===void 0?void 0:s.first_name)||""} ${((o=this.mainGuest)===null||o===void 0?void 0:o.last_name)||""}`),this.room.rateplan.selected_variation.adult_nbr>0&&(this.room.unit?e("ir-button",{btn_color:"link",renderContentAsHtml:true,onClickHandler:()=>this.showGuestModal(),size:"sm",btn_styles:"room_guest_name",text:this.formatVariation(this.room.rateplan.selected_variation,this.room.occupancy)}):e("span",{innerHTML:this.formatVariation(this.room.rateplan.selected_variation,this.room.occupancy)})),this.room.bed_preference&&e("span",{key:"682d185cdddd70e8625379d2465fed78090670c5"},"(",this.getBedName(),")")),e("div",{key:"78bdeb5d27bfda957271066d2d3049dc0ad5da14",class:"collapse",id:`roomCollapse-${(r=this.room.identifier)===null||r===void 0?void 0:r.split(" ").join("")}`},e("div",{key:"cd89c618d3fede1606f10e8c3742686a1019dbd6",class:"d-flex sm-mb-1 sm-mt-1"},e("div",{key:"712068d8602043749249b3b997ba38eb87f3a7ca",class:" sm-padding-top"},e("p",{key:"b8e8467fd844ed4a0056abb5c67d9b40fcabd16c",class:"sm-padding-right",style:{fontWeight:"600"}},`${p.entries.Lcz_Breakdown}:`)),e("div",{key:"ca51b090eef5475a60dbef912eb808cb01d5fe10",class:"flex-fill"},e("table",{key:"054ec0129b70bf22af129ba3bcaa2298d1eb9585"},this.room.days.length>0&&this.room.days.map((t=>e("tr",null,e("td",{class:"pr-2 text-right"},it(t.date)),e("td",{class:"text-right"},m(this.currency,t.amount)),t.cost>0&&t.cost!==null&&e("td",{class:"pl-2 text-left night-cost"},m(this.currency,t.cost))))),e("tr",{key:"8f3cfbd592ce27e5fe259cf39d0595478c36f42e",class:""},e("th",{key:"c31cac396127e1352ebf6926b29de80514b6e504",class:"text-right pr-2 subtotal_row"},p.entries.Lcz_SubTotal),e("th",{key:"f5eadda87ef911bd7a3eb2f58fbce61311f44d98",class:"text-right subtotal_row"},m(this.currency,this.room.total)),this.room.gross_cost>0&&this.room.gross_cost!==null&&e("th",{key:"49431ea624f0b9e67ad90559c62bb8969b44ca53",class:"pl-2 text-right night-cost"},m(this.currency,this.room.cost))),this.booking.is_direct?e(n,null,(()=>{const t=g.taxes.filter((t=>t.pct>0));return t.map((t=>e("tr",null,e("td",{class:"text-right pr-2"},t.is_exlusive?p.entries.Lcz_Excluding:p.entries.Lcz_Including," ",t.name," (",t.pct,"%)"),e("td",{class:"text-right"},m(this.currency,this.room.total*t.pct/100)),this.room.gross_cost>0&&this.room.gross_cost!==null&&e("td",{class:"pl-2 text-right night-cost"},m(this.currency,this.room.cost*t.pct/100)))))})()):e(n,null,(()=>{const t=this.room.ota_taxes.filter((t=>t.amount>0));return t.map((t=>e("tr",null,e("td",{class:"text-right pr-2"},t.is_exlusive?p.entries.Lcz_Excluding:p.entries.Lcz_Including," ",t.name),e("td",{class:"text-right"},t.currency.symbol,t.amount))))})())))),this.booking.is_direct&&e(n,{key:"f256a5f79de6f43ace048421862d873d71b1db6a"},this.room.rateplan.cancelation&&e("ir-label",{key:"fb885cdc0dfd5336b1f5281c012618113a973338",labelText:`${p.entries.Lcz_Cancellation}:`,display:"inline",content:this.room.rateplan.cancelation||"",renderContentAsHtml:true}),this.room.rateplan.guarantee&&e("ir-label",{key:"60051e97fb7cae8be31665bf350c77331c25868f",labelText:`${p.entries.Lcz_Guarantee}:`,display:"inline",content:this.room.rateplan.guarantee||"",renderContentAsHtml:true})))),e("ir-modal",{key:"767a4304dd1510ca0edd20638ed59ba8c4b9101d",autoClose:false,ref:t=>this.modal=t,isLoading:this.isLoading,onConfirmModal:this.handleModalConfirmation.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:p.entries.Lcz_Cancel,rightBtnText:this.modalReason==="delete"?p.entries.Lcz_Delete:p.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modalReason==="delete"?"danger":"primary",modalTitle:p.entries.Lcz_Confirmation,modalBody:this.renderModalMessage()}))}showGuestModal(){var t;const{adult_nbr:e,children_nbr:i,infant_nbr:s}=this.room.occupancy;this.openSidebar.emit({type:"room-guest",payload:{roomName:(t=this.room.unit)===null||t===void 0?void 0:t.name,sharing_persons:this.room.sharing_persons,totalGuests:e+i+s,checkin:this.hasCheckIn,identifier:this.room.identifier}})}get element(){return o(this)}};tr.style=Qo;const er={id:-1,full_name:"",country_id:null,dob:"",id_info:{type:{code:null,description:null},number:""},address:null,alternative_email:null,cci:null,city:null,country:undefined,country_phone_prefix:null,email:null,first_name:"",last_name:"",mobile:null,nbr_confirmed_bookings:0,notes:null,password:null,subscribe_to_news_letter:null};const ir={mask:Date,pattern:"DD/MM/YYYY",lazy:false,min:new Date(1900,0,1),max:new Date,format:t=>U(t).format("DD/MM/YYYY"),parse:t=>U(t,"DD/MM/YYYY").toDate(),autofix:true,blocks:{YYYY:{mask:Bn.MaskedRange,from:1970,to:(new Date).getFullYear(),placeholderChar:"Y"},MM:{mask:Bn.MaskedRange,from:1,to:12,placeholderChar:"M"},DD:{mask:Bn.MaskedRange,from:1,to:31,placeholderChar:"D"}}};const sr=".sc-ir-room-guests-h{display:block;height:100%;position:relative;text-align:start !important}.id-select.sc-ir-room-guests{border-top-right-radius:0;border-bottom-right-radius:0;border-right-width:0}.sc-ir-room-guests-h{display:block;width:100%}.guest-grid.sc-ir-room-guests>*.sc-ir-room-guests{height:100%}.guests-labels.sc-ir-room-guests{display:none}.guest_label.sc-ir-room-guests{width:100px;color:#6b6f82}.sharing_persons_label.sc-ir-room-guests{display:none}.loading-container.sc-ir-room-guests{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.guest_document.sc-ir-room-guests input.sc-ir-room-guests{border-top-left-radius:0;border-bottom-left-radius:0}.guests-labels.sc-ir-room-guests *.sc-ir-room-guests,.sharing_persons_label.sc-ir-room-guests{margin-bottom:0.5rem;padding-bottom:0}@media (min-width: 768px){.sharing_persons_label.sc-ir-room-guests{display:block}.guest_country_picker.sc-ir-room-guests{margin-bottom:3px}.guest-grid.sc-ir-room-guests{display:grid;grid-template-columns:2fr 2fr 2fr 2fr 5fr;gap:0.5rem;align-items:flex-start}.guest_label.sc-ir-room-guests,.sharing_persons_heading.sc-ir-room-guests,.main_guest_heading.sc-ir-room-guests{display:none}}";const nr=sr;const or=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetbooking=s(this,"resetbooking",7);this.bookingService=new l;this.roomName=undefined;this.identifier=undefined;this.sharedPersons=[];this.totalGuests=0;this.countries=undefined;this.checkIn=undefined;this.language="en";this.bookingNumber=undefined;this.guests=[];this.idTypes=[];this.error={};this.isLoading=undefined;this.submitted=undefined;this.propertyCountry=undefined}componentWillLoad(){this.init();this.initializeGuests()}async init(){try{this.isLoading=true;const[t,e]=await Promise.all([this.bookingService.getUserDefaultCountry(),this.bookingService.getSetupEntriesByTableName("_ID_TYPE")]);this.idTypes=e;if(t){this.propertyCountry=this.countries.find((e=>e.id===t.COUNTRY_ID))}}catch(t){console.error(t)}finally{this.isLoading=false}}initializeGuests(){var t,e;let i=[];if(this.totalGuests>this.sharedPersons.length){const s=this.totalGuests-this.sharedPersons.length;i=[...this.sharedPersons,...Array(s).fill(Object.assign(Object.assign({},er),{id_info:Object.assign(Object.assign({},er.id_info),{type:{code:((t=this.idTypes[0])===null||t===void 0?void 0:t.CODE_NAME)||"001",description:((e=this.idTypes[0])===null||e===void 0?void 0:e.CODE_VALUE_EN)||""},number:""})}))]}else{i=[...this.sharedPersons]}i=i.map((t=>Object.assign(Object.assign({},t),{dob:new Date(t.dob).getFullYear()===1900?null:t.dob})));this.guests=i.map((t=>Object.assign(Object.assign({},t),{dob:t.dob?U(new Date(t.dob)).format("DD/MM/YYYY"):""})))}updateGuestInfo(t,e){const i=[...this.guests];let s=i[t];s=Object.assign(Object.assign({},s),e);i[t]=s;this.guests=[...i]}async saveGuests(){try{this.submitted=true;this.error={};nn.parse(this.guests);await this.bookingService.handleExposedRoomGuests({booking_nbr:this.bookingNumber,identifier:this.identifier,guests:this.guests});if(this.checkIn){await this.bookingService.handleExposedRoomInOut({booking_nbr:this.bookingNumber,room_identifier:this.identifier,status:"001"})}this.closeModal.emit(null);this.resetbooking.emit(null)}catch(t){console.log(t);if(t instanceof T){let e={};t.issues.map((t=>({[t.path[0].toString()]:true})));this.error=Object.assign({},e)}}}render(){if(this.isLoading){return e("div",{class:"loading-container"},e("ir-spinner",null))}return e("div",{class:"h-100 d-flex flex-column",style:{minWidth:"300px"}},e("ir-title",{class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:`Room ${this.roomName}`,displayContext:"sidebar"}),e("section",{class:"d-flex flex-column px-1 h-100 "},e("div",{class:""},e("div",{class:"guest-grid guests-labels"},e("p",{class:""},p.entries.Lcz_MainGuest),e("p",{class:""}),e("p",{class:" "},p.entries.Lcz_DOB),e("p",{class:""},p.entries.Lcz_Nationality),e("p",{class:" "},p.entries.Lcz_Documents)),e("h5",{class:"main_guest_heading"},p.entries.Lcz_MainGuest),this.guests.map(((t,i)=>{var s,o;return e(n,null,i===1&&e("div",{class:"d-flex mx-0 px-0"},e("h5",{class:"mx-0 px-0 sharing_persons_heading"},p.entries.Lcz_PersonsSharingRoom),e("p",{class:"mx-0 px-0 sharing_persons_label"},p.entries.Lcz_PersonsSharingRoom)),e("div",{key:i,class:"guest-grid"},e("div",{class:"m-0 p-0 d-flex align-items-center h-100"},e("p",{class:"guest_label"},"First name"),e("ir-input-text",{class:"flex-grow-1 h-100",id:`first_name_${i}`,zod:sn.pick({first_name:true}),error:!!this.error["first_name"],autoValidate:false,wrapKey:"first_name",LabelAvailable:false,submitted:this.submitted,placeholder:"First name",onTextChange:t=>this.updateGuestInfo(i,{first_name:t.detail}),value:t.first_name})),e("div",{class:"m-0 p-0 d-flex align-items-center h-100"},e("p",{class:"guest_label"},"Last name"),e("ir-input-text",{class:"flex-grow-1 h-100",id:`last_name_${i}`,zod:sn.pick({last_name:true}),error:!!this.error["last_name"],autoValidate:false,wrapKey:"last_name",LabelAvailable:false,submitted:this.submitted,placeholder:"Last name",onTextChange:t=>this.updateGuestInfo(i,{last_name:t.detail}),value:t.last_name})),e("div",{class:"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center"},e("p",{class:"guest_label"},p.entries.Lcz_DOB),e("ir-input-text",{class:"flex-grow-1 h-100",id:`dob_${i}`,zod:sn.pick({dob:true}),error:!!this.error["dob"],autoValidate:false,wrapKey:"dob",submitted:this.submitted,mask:ir,LabelAvailable:false,placeholder:"dd/mm/yyyy",onTextChange:t=>{this.updateGuestInfo(i,{dob:t.detail})},value:t.dob})),e("div",{class:" m-0 p-0 d-flex align-items-center"},e("p",{class:"guest_label"},p.entries.Lcz_Nationality),e("div",{class:"mx-0 flex-grow-1  h-100"},e("ir-country-picker",{class:"h-100",propertyCountry:this.propertyCountry,id:`{locales.entries.Lcz_Nationality}_${i}`,error:!!this.error["country_id"]&&!t.country_id,country:(s=this.countries)===null||s===void 0?void 0:s.find((e=>{var i,s,n;return((i=e.id)===null||i===void 0?void 0:i.toString())===((n=(s=t.country)===null||s===void 0?void 0:s.id)===null||n===void 0?void 0:n.toString())})),onCountryChange:t=>this.updateGuestInfo(i,{country_id:t.detail.id.toString(),country:t.detail}),countries:this.countries}))),e("div",{class:"flex-grow-1 m-0 p-0 d-flex align-items-center"},e("p",{class:"guest_label"},p.entries.Lcz_Documents),e("div",{class:" d-flex m-0 flex-grow-1 h-100"},e("ir-select",{selectStyles:"id-select",onSelectChange:t=>{this.updateGuestInfo(i,{id_info:Object.assign(Object.assign({},this.guests[i].id_info),{type:{code:t.detail,description:""}})})},selectedValue:t.id_info.type.code,showFirstOption:false,LabelAvailable:false,data:(o=this.idTypes)===null||o===void 0?void 0:o.map((t=>{var e;return{text:(e=t[`CODE_VALUE_${this.language.toUpperCase()}`])!==null&&e!==void 0?e:t[`CODE_VALUE_EN`],value:t.CODE_NAME}}))}),e("ir-input-text",{placeholder:"12345",class:"flex-grow-1 guest_document",type:"text",value:t.id_info.number,zod:en.pick({number:true}),error:!!this.error["number"],autoValidate:false,wrapKey:"number",inputStyles:"form-control",submitted:this.submitted,LabelAvailable:false,onTextChange:t=>this.updateGuestInfo(i,{id_info:Object.assign(Object.assign({},this.guests[i].id_info),{number:t.detail})})})))))}))),e("div",{class:"d-flex flex-column flex-sm-row mt-3 action-buttons "},e("ir-button",{onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill mr-sm-1`,icon:"",text:p.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:G("/Handle_Exposed_Room_Guests"),text:this.checkIn?p.entries.Lcz_CheckIn:p.entries.Lcz_Save,btn_color:"primary",onClickHandler:this.saveGuests.bind(this)}))))}};or.style=nr;const rr=".sc-ir-room-nights-h{display:block;box-sizing:border-box;margin:0;position:relative}.loading-container.sc-ir-room-nights{position:relative;height:100%;width:100%;display:flex;align-items:center;justify-content:center}.close-icon.sc-ir-room-nights{position:absolute;top:18px;right:33px;outline:none}.close.sc-ir-room-nights{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.card.sc-ir-room-nights{top:0;z-index:1000}.card-title.sc-ir-room-nights{border-bottom:1px solid #e4e5ec;width:100%}.irfontgreen.sc-ir-room-nights{color:#0e930e}.currency.sc-ir-room-nights{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-ir-room-nights{font-size:14px;line-height:0;padding:0;height:0;border-left:0;border-radius:0.25rem !important}.rate-input-container.sc-ir-room-nights{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-ir-room-nights{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-ir-room-nights span[data-state='focus'].sc-ir-room-nights{border-color:var(--blue)}.input-group-prepend.sc-ir-room-nights span[data-disabled].sc-ir-room-nights{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.rateInputBorder.sc-ir-room-nights{padding-left:5px !important;padding-right:5px !important;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}";const ar=rr;const lr=class{constructor(e){t(this,e);this.closeRoomNightsDialog=s(this,"closeRoomNightsDialog",7);this.bookingService=new l;this.bookingNumber=undefined;this.propertyId=undefined;this.language=undefined;this.identifier=undefined;this.toDate=undefined;this.fromDate=undefined;this.pool=undefined;this.ticket=undefined;this.defaultDates=undefined;this.bookingEvent=undefined;this.selectedRoom=undefined;this.rates=[];this.isLoading=false;this.initialLoading=false;this.inventory=null;this.isEndDateBeforeFromDate=false;this.defaultTotalNights=0;this.isInputFocused=-1;this.dates={from_date:new Date,to_date:new Date}}componentWillLoad(){this.dates={from_date:new Date(this.fromDate),to_date:new Date(this.toDate)};this.init()}isButtonDisabled(){return this.isLoading||this.rates.some((t=>t.amount===-1))||this.inventory===0||this.inventory===null}async init(){var t;try{const{from_date:e}=this.defaultDates;if(U(e,"YYYY-MM-DD").isBefore(U(this.fromDate,"YYYY-MM-DD"))){this.dates.from_date=new Date(e)}else{this.dates.from_date=new Date(this.fromDate)}this.dates.to_date=new Date(this.toDate);this.bookingEvent=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);if(this.bookingEvent){const e=this.bookingEvent.rooms.filter((t=>t.identifier===this.identifier));this.selectedRoom=e[0];const i=(t=this.selectedRoom)===null||t===void 0?void 0:t.days[this.selectedRoom.days.length-1];if(U(this.toDate).add(-1,"days").isSame(U(i.date))){console.log("here1");const t=await this.fetchBookingAvailability(this.fromDate,this.selectedRoom.days[0].date,this.selectedRoom.rateplan.id);const e=S(this.selectedRoom.days[0].date,this.fromDate);this.isEndDateBeforeFromDate=true;this.rates=[...e.map((i=>({amount:t/e.length,date:i,cost:null}))),...this.selectedRoom.days];this.defaultTotalNights=this.rates.length-this.selectedRoom.days.length}else{console.log("here2");console.log(i);const t=await this.fetchBookingAvailability(this.bookingEvent.to_date,U(this.toDate,"YYYY-MM-DD").format("YYYY-MM-DD"),this.selectedRoom.rateplan.id);const e=S(i.date,this.toDate);this.rates=[...this.selectedRoom.days,...e.map((i=>({amount:t/e.length,date:i,cost:null})))]}}}catch(t){console.log(t)}}handleInput(t,e){let i=t;let s=[...this.rates];i=i.replace(/[^0-9.]/g,"");if(i===""){s[e].amount=-1}else{if(!isNaN(Number(i))){s[e].amount=Number(i)}}this.rates=s}async fetchBookingAvailability(t,e,i){var s;try{this.initialLoading=true;const n=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyId,adultChildCount:{adult:this.selectedRoom.rateplan.selected_variation.adult_nbr,child:this.selectedRoom.rateplan.selected_variation.child_nbr},language:this.language,currency:this.bookingEvent.currency,room_type_ids:[this.selectedRoom.roomtype.id],rate_plan_ids:[i]});console.log(n[0],i);this.inventory=n[0].inventory;const o=n[0].rateplans.find((t=>t.id===i));if(!o||!o.variations){this.inventory=null;return null}const r=(s=o.variations)===null||s===void 0?void 0:s.find((t=>t.adult_nbr===this.selectedRoom.rateplan.selected_variation.adult_nbr&&t.child_nbr===this.selectedRoom.rateplan.selected_variation.child_nbr));if(!r){return null}return r.discounted_gross_amount}catch(t){console.error(t)}finally{this.initialLoading=false}}renderInputField(t,i,s){return e("div",{class:"col-3 ml-1 position-relative  m-0 p-0 rate-input-container"},e("ir-price-input",{value:s.amount>0?s.amount.toString():"",disabled:this.inventory===0||this.inventory===null,currency:i,"aria-label":"rate","aria-describedby":"rate cost",onTextChange:e=>this.handleInput(e.detail,t)}))}renderReadOnlyField(t,i){return e("p",{class:"col-9 ml-1 m-0 p-0"},`${t}${Number(i.amount).toFixed(2)}`)}renderRateFields(t,e,i){if(this.isEndDateBeforeFromDate){if(t<this.defaultTotalNights){return this.renderInputField(t,e,i)}else{return this.renderReadOnlyField(e,i)}}else{return t<this.selectedRoom.days.length?this.renderReadOnlyField(e,i):this.renderInputField(t,e,i)}}renderDates(){var t;const i=this.bookingEvent.currency.symbol;return e("div",{class:"mt-2 m-0"},(t=this.rates)===null||t===void 0?void 0:t.map(((t,s)=>e("div",{class:"row m-0 mt-1 align-items-center"},e("p",{class:"col-2 m-0 p-0"},Y(t.date)),this.renderRateFields(s,i,t)))))}async handleRoomConfirmation(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];let e=t.findIndex((t=>t.identifier===this.identifier));if(e===-1){throw new Error("Invalid Pool")}t[e]=Object.assign(Object.assign({},t[e]),{days:this.rates,to_date:U(this.dates.to_date).format("YYYY-MM-DD"),from_date:U(this.dates.from_date).format("YYYY-MM-DD")});const i={assign_units:true,check_in:true,is_pms:true,is_direct:true,pickup_info:this.bookingEvent.pickup_info,extra_services:this.bookingEvent.extra_services,booking:{booking_nbr:this.bookingNumber,from_date:U(this.dates.from_date).format("YYYY-MM-DD"),to_date:U(this.dates.to_date).format("YYYY-MM-DD"),remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};await this.bookingService.doReservation(i);this.closeRoomNightsDialog.emit({type:"confirm",pool:this.pool})}catch(t){}finally{this.isLoading=false}}render(){var t,s,o;if(!this.bookingEvent){return e("div",{class:"loading-container"},e("ir-loading-screen",null))}console.log(this.inventory);return e(i,null,e("div",{class:"card position-sticky mb-0 shadow-none p-0 "},e("div",{class:"d-flex mt-2 align-items-center justify-content-between "},e("h3",{class:"card-title text-left pb-1 font-medium-2 px-2"},p.entries.Lcz_AddingRoomNightsTo," ",(s=(t=this.selectedRoom)===null||t===void 0?void 0:t.roomtype)===null||s===void 0?void 0:s.name," ",((o=this.selectedRoom)===null||o===void 0?void 0:o.unit).name),e("button",{type:"button",class:"close close-icon",onClick:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool})},e("ir-icon",{icon:"ft-x",class:"m-0"})))),e("section",{class:"text-left px-2"},e("p",{class:"font-medium-1"},`${p.entries.Lcz_Booking}#`," ",this.bookingNumber),this.initialLoading?e("p",{class:"mt-2 text-secondary"},p.entries["Lcz_CheckingRoomAvailability "]):e(n,null,e("p",{class:"font-weight-bold font-medium-1"},`${N(U(this.dates.from_date).format("YYYY-MM-DD"),"YYYY-MM-DD")} - ${N(U(this.dates.to_date).format("YYYY-MM-DD"),"YYYY-MM-DD")}`),e("p",{class:"font-medium-1 mb-0"},`${this.selectedRoom.rateplan.name}`," ",this.selectedRoom.rateplan.is_non_refundable&&e("span",{class:"irfontgreen"},p.entries.Lcz_NonRefundable)),(this.inventory===0||this.inventory===null)&&e("p",{class:"font-medium-1 text danger"},p.entries.Lcz_NoAvailabilityForAdditionalNights),this.selectedRoom.rateplan.custom_text&&e("p",{class:"text-secondary mt-0"},this.selectedRoom.rateplan.custom_text),this.renderDates())),e("section",{class:"d-flex align-items-center mt-2 px-2"},e("ir-button",{btn_color:"secondary",btn_disabled:this.isLoading,text:p===null||p===void 0?void 0:p.entries.Lcz_Cancel,class:"full-width",btn_styles:"justify-content-center",onClickHandler:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool})}),this.inventory>0&&this.inventory!==null&&e("ir-button",{isLoading:this.isLoading,text:p===null||p===void 0?void 0:p.entries.Lcz_Confirm,btn_disabled:this.isButtonDisabled(),class:"ml-1 full-width",btn_styles:"justify-content-center",onClickHandler:this.handleRoomConfirmation.bind(this)})))}};lr.style=ar;const cr=".border-theme.sc-ir-select{border:1px solid #cacfe7}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}.bounce-3.sc-ir-select{animation:bounce 1s 1}";const hr=cr;const dr=class{constructor(e){t(this,e);this.selectChange=s(this,"selectChange",7);this.count=0;this.name=undefined;this.data=undefined;this.label="<label>";this.selectStyles=undefined;this.selectContainerStyle=undefined;this.selectedValue=null;this.required=undefined;this.LabelAvailable=true;this.firstOption="Select";this.selectStyle=true;this.showFirstOption=true;this.submited=false;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.select_id=L();this.initial=true;this.valid=false}watchHandler(t){if(t!==null&&this.required){this.valid=true}}watchHandler2(t){if(t&&this.required){this.initial=false}}handleButtonAnimation(t){console.log(t.detail,this.select_id,t.detail===this.select_id);if(!this.selectEl||t.detail!==this.select_id){return}console.log("first1");t.stopImmediatePropagation();t.stopPropagation();this.selectEl.classList.add("border-danger")}componentwillload(){}disconnectedCallback(){}handleSelectChange(t){this.selectEl.classList.remove("border-danger");if(this.required){this.initial=false;this.valid=t.target.checkValidity();this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}else{this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}}render(){let t="form-control";let i=e("div",{key:"3119d282eebf170c202904867d98fc9a3706c909",class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},e("label",{key:"938aa8ced0fa2c6883e365f919c7823a682aaf48",htmlFor:this.select_id,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(this.selectStyle===false){t=""}if(this.required&&!this.valid&&!this.initial){t=`${t} border-danger`}if(!this.LabelAvailable){i=""}return e("div",{key:"6eb2fdee76453a55f49f52d920211785ba5ed668",class:`form-group m-0 ${this.selectContainerStyle}`},e("div",{key:"692d13a2abe9fb8501e455980cb4101b76524bda",class:"input-group row m-0"},i,e("select",{key:"4dab8ee61255a3c0bc68b49ac1cf4a4127994423",ref:t=>this.selectEl=t,id:this.select_id,class:`${this.selectStyles} ${t} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12}`,onInput:this.handleSelectChange.bind(this),required:this.required},this.showFirstOption&&e("option",{key:"4fcc18d96c19b25ebae73759ebe0b1ac0b198b5e",value:""},this.firstOption),this.data.map((t=>{if(this.selectedValue===t.value){return e("option",{selected:true,value:t.value},t.text)}else{return e("option",{value:t.value},t.text)}})))))}static get watchers(){return{selectedValue:["watchHandler"],submited:["watchHandler2"]}}};dr.style=hr;const ur=".backdrop{position:fixed;top:0;left:0;width:100%;height:100vh;cursor:pointer;background:rgba(0, 0, 0, 0.5);z-index:99;transition:all 0.5s;opacity:0;pointer-events:none;transition:all 0.5s}.backdrop.active{opacity:1;pointer-events:all}.sidebar-right{position:fixed;top:0;right:-120%;bottom:0;width:var(--sidebar-width, 40rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:100;overflow-y:hidden;color:var(--sidebar-color, #000);background-color:var(--sidebar-backgound, #fff);padding:var(--ir-sidebar-padding, 0.5rem 0)}.sidebar-right.active{right:0;overflow-y:auto}.sidebar-left{position:fixed;top:0;left:-100%;bottom:0;width:var(--sidebar-width, 30rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:200;overflow-y:hidden;color:var(--sidebar-color, #000);background:var(--sidebar-backgound, #fff);padding:var(--ir-sidebar-padding, 0.5rem 0)}.sidebar-title{display:flex;align-items:center;justify-content:space-between;padding:0 1rem;border-bottom:1px solid #e4e5ec}.sidebar-title p{font-weight:500;font-size:1.2rem}.sidebar-left.active{left:0;overflow-y:scroll}.close{position:absolute;top:0.5rem;right:1rem;width:1rem;height:1rem;cursor:pointer}";const fr=ur;const pr=class{constructor(e){t(this,e);this.irSidebarToggle=s(this,"irSidebarToggle",7);this.name=undefined;this.side="right";this.showCloseButton=true;this.open=false;this.sidebarStyles=undefined;this.label=undefined}applyStyles(){for(const t in this.sidebarStyles){if(this.sidebarStyles.hasOwnProperty(t)){this.sidebarRef.style[t]=this.sidebarStyles[t]}}}handleSidebarStylesChange(){this.applyStyles()}componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidLoad(){this.applyStyles();document.addEventListener("keydown",this.handleKeyDown)}handleKeyDown(t){if(t.key==="Escape"){return this.toggleSidebar()}else{return}}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}async toggleSidebar(){this.irSidebarToggle.emit(this.open)}render(){let t="";if(this.open){t="active"}else{t=""}return[e("div",{key:"dfe033bba742a6cb299d7d6367d9a40e1f2e770a",class:`backdrop ${t}`,onClick:()=>{this.toggleSidebar()}}),e("div",{key:"dd26bd24ef27569a2e65dd334980b01e7711c69e",ref:t=>this.sidebarRef=t,class:`sidebar-${this.side} ${t}`},this.showCloseButton&&e("div",{key:"215f67638cdfdccba99461014165e22fa442bfe6",class:"sidebar-title"},e("p",{key:"69474143d3eecb713e00d79b87eaa6ee663e317c",class:"p-0 m-0"},this.label),e("div",{key:"c0a46f4b70b9d09e93d159e40282d8f3dcb1ceb9",class:"p-0 m-0 sidebar-icon-container"},e("ir-icon",{key:"959597cc8056a2342d30e97fdb57b386fa0cea00",class:"",onIconClickHandler:()=>{this.toggleSidebar()}},e("svg",{key:"a4e1293a985491b531452ff0886856bb71fc832c",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{key:"f698a421ff62d2a98d3c27f7ac784d0dfeec177b",fill:"#6b6f82",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("slot",{key:"edaef24a321fee4602ab6001b311aadca68edd47",name:"sidebar-body"}))]}static get watchers(){return{sidebarStyles:["handleSidebarStylesChange"]}}};pr.style=fr;const br=":host{width:var(--ir-spinner-size, 1.25rem);height:var(--ir-spinner-size, 1.25rem);border:var(--ir-spinner-border-width, 2.5px) solid var(--ir-spinner-color, #3f3f3f);border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const gr=br;const mr=class{constructor(e){t(this,e);this.size=undefined;this.borderWidth=undefined;this.unit="rem";this.color=undefined}componentWillLoad(){this.initStyles()}handleSpinnerSizeChange(){this.initStyles()}handleSpinnerBorderWidthChange(){this.initStyles()}handleSpinnerUnitChange(){this.initStyles()}handleSpinnerColorChange(){this.initStyles()}initStyles(){if(this.size){this.applyCssElement(`${this.size}${this.unit}`,"--ir-spinner-size")}if(this.borderWidth){this.applyCssElement(`${this.borderWidth}${this.unit}`,"--ir-spinner-size")}if(this.color){this.applyCssElement(`${this.color}`,"--ir-spinner-color")}}applyCssElement(t,e){this.el.style.setProperty(e,t)}render(){return e(i,{key:"e7b792b51e77334bc1d958826748eb61f599f2f4"})}get el(){return o(this)}static get watchers(){return{size:["handleSpinnerSizeChange"],borderWidth:["handleSpinnerBorderWidthChange"],unit:["handleSpinnerUnitChange"],color:["handleSpinnerColorChange"]}}};mr.style=gr;const vr=".prepend-textarea.sc-ir-textarea{padding:0 !important}.ta-prepend-text.sc-ir-textarea{width:100%}";const yr=vr;const kr=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.rows=3;this.cols=5;this.text="";this.label="<label>";this.placeholder="<placeholder>";this.value="";this.maxLength=250;this.textareaClassname=undefined;this.variant="default";this.labelWidth=3;this.error=false}handleAriaInvalidChange(t){this.error=t==="true"}connectedCallback(){}disconnectedCallback(){}render(){if(this.variant==="prepend"){return e("fieldset",{class:"input-group"},e("div",{class:`input-group-prepend col-${this.labelWidth} prepend-textarea`},e("span",{class:"input-group-text ta-prepend-text"},this.label)),e("textarea",{value:this.value,class:`form-control`,style:{height:"7rem"},maxLength:this.maxLength,onChange:t=>this.textChange.emit(t.target.value),"aria-label":this.label}))}return e("div",{class:"form-group"},e("label",null,this.label),e("textarea",{maxLength:this.maxLength,rows:this.rows,value:this.value,class:`form-control ${this.textareaClassname} ${this.error?"border-danger":""}`,placeholder:this.placeholder,onInput:t=>this.textChange.emit(t.target.value)}))}static get watchers(){return{"aria-invalid":["handleAriaInvalidChange"]}}};kr.style=yr;const wr=".sc-ir-title-h{padding:0px 0;margin-bottom:20px;display:flex;align-items:center;width:100%}[border-shown].sc-ir-title-h{border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important;padding-bottom:15px}[display-context='sidebar'].sc-ir-title-h{padding:15px 0;justify-content:space-between !important;width:100% !important;border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important}.title-body.sc-ir-title{margin:0;padding:0}@media only screen and (max-width: 641px){.sc-ir-title-h{flex-direction:column;gap:8px;align-items:flex-start}[display-context='sidebar'].sc-ir-title-h{flex-direction:row}}";const xr=wr;const _r=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.label=undefined;this.borderShown=undefined;this.displayContext="default";this.justifyContent="start"}componentDidLoad(){this.el.style.justifyContent=this.justifyContent}handleJustifyContentChange(t,e){if(t!==e){this.el.style.justifyContent=t}}render(){return e(i,{key:"2b25c1d99c1c55e77512b903867685fad597c06a"},e("h4",{key:"525b8d78e020c1138afe8b33956580eff0f1d4f4",class:"text-left font-medium-2 py-0 my-0"},this.label),this.displayContext==="sidebar"&&e("ir-icon",{key:"d1654f94a358b45ce6078a615c9f64a4cd3b2d95",class:"close",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},e("svg",{key:"d2410079adebe7a51604ba4f58c0251a003aff66",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{key:"bf234c8e259bd815b80367aa4666f9e3277605cf",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),this.displayContext!=="sidebar"&&e("div",{key:"e46657ea16f09453467c94808573ede9c4d44f92",class:"title-body"},e("slot",{key:"542216119b38e292f44ebd0b8b11ccef0fc95b29",name:"title-body"})))}get el(){return o(this)}static get watchers(){return{justifyContent:["handleJustifyContentChange"]}}};_r.style=xr;const Dr="button.sc-ir-toast,p.sc-ir-toast,h3.sc-ir-toast,div.sc-ir-toast{all:unset}.sc-ir-toast-h{--rd-viewport-padding:25px;--rd-success:#2b9a66;position:fixed;bottom:0;right:0;display:flex;flex-direction:column;padding:var(--rd-viewport-padding);gap:10px;max-width:100vw;margin:0;list-style:none;z-index:2147483647;outline:none;pointer-events:none;-webkit-user-select:none;user-select:none}@media (prefers-color-scheme: dark){.sc-ir-toast-h{--rd-success:#33b074}}p.sc-ir-toast{color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3}h1.sc-ir-toast,h2.sc-ir-toast,h3.sc-ir-toast,h4.sc-ir-toast,h5.sc-ir-toast,h6.sc-ir-toast{font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}[position='top-left'].sc-ir-toast-h{top:0;left:0}[position='top-right'].sc-ir-toast-h{top:0;right:0}[position='bottom-left'].sc-ir-toast-h{bottom:0;left:0}[position='bottom-right'].sc-ir-toast-h{bottom:0;right:0}.icon-container.sc-ir-toast{height:25px;width:25px;border-radius:25px;display:flex;align-items:center;justify-content:center;padding:0;margin:0}.icon-container.sc-ir-toast>svg.sc-ir-toast{margin:0;color:white;stroke-width:5px}.success.sc-ir-toast{background-color:var(--rd-success)}.error.sc-ir-toast{background-color:red}.ToastRoot.sc-ir-toast{background-color:hsl(0, 0%, 100%);border-radius:0.5rem;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;padding:15px;display:grid;grid-template-areas:'title action' 'description action';grid-template-columns:auto max-content;column-gap:15px;align-items:center;pointer-events:none;opacity:0;border:1px solid hsl(214.3, 31.8%, 91.4%);position:relative}.ToastRoot[data-state='open'].sc-ir-toast{pointer-events:all;animation:slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1)}.ToastRoot[data-state='closed'].sc-ir-toast{pointer-events:none;animation:hide 100ms ease-in}@-webkit-keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}@keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}.ToastTitle.sc-ir-toast{grid-area:title;font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}.ToastDescription.sc-ir-toast{grid-area:description;margin:0;margin-top:5px;color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3;overflow:hidden;text-overflow:ellipsis}.ToastAction.sc-ir-toast{grid-area:action}";const Cr=Dr;const Or=class{constructor(e){t(this,e);this.position="bottom-left";this.toasts=[]}onToast(t){const e=t.detail;this.showToast(e)}showToast(t){const e={positionClass:"toast-top-right",closeButton:true,timeOut:t.duration||5e3};switch(t.type){case"success":toastr.success(t.title,"",e);break;case"error":toastr.error(t.title,"",e);break}}render(){return e(i,{key:"556cbce34fc73d0e46e468cbfa5c88a103572558"})}get element(){return o(this)}};Or.style=Cr;const Er=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}.tooltip-inner-custom.sc-ir-tooltip{min-width:max-content !important}";const Ar=Er;const Br=class{constructor(e){t(this,e);this.message=undefined;this.withHtml=true;this.customSlot=false;this.open=undefined}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){return e(i,{key:"a5c14bbf6618d37c1139e50fb931d5d29eaa850d",class:"m-0 p-0"},e("span",{key:"98606594e272f6e8c859868681157eee5b39c5d7",class:"m-0 p-0 d-flex align-items-center justify-content-center",onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},!this.customSlot?e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"16",width:"16",viewBox:"0 0 512 512"},e("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})):e("slot",{name:"tooltip-trigger"})),this.open&&e("div",{key:"802c30384b392e9d47ec493e02564f3d333fcdb7",class:"tooltip bottom show position-absolute",role:"tooltip"},e("div",{key:"21efba6f9ac9391f73e6066d09358312c90d6b84",class:"tooltip-arrow"}),e("div",{key:"1b82a866a243b8bec1cf12bdfe68346966020935",class:`tooltip-inner fit ${this.customSlot&&"tooltip-inner-custom"}`},e("span",{key:"bdc7cd2a808e00e425764cea4bd287e9125b3f7b",innerHTML:this.message}))))}};Br.style=Ar;const Mr="*.sc-ota-label{margin:0;padding:0}.sc-ota-label-h{display:flex;margin-bottom:5px;gap:5px;width:100%}.label_title.sc-ota-label{min-width:max-content;padding:0;margin:0;font-weight:600}ul.sc-ota-label{margin:0 3px;padding:0;list-style:none;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important}li.sc-ota-label{width:100%;line-height:1.5;margin:0;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important}button.sc-ota-label{background:white;color:var(--blue);padding:0;margin:0;margin-left:3px;font-size:12px;border:0}button.sc-ota-label:hover{color:#355270}";const Tr=Mr;const Ir=class{constructor(e){t(this,e);this.toggleShowAll=()=>{this.showAll=!this.showAll};this.label=undefined;this.remarks=undefined;this.maxVisibleItems=3;this.showAll=false}render(){if(!this.remarks){return null}const t=this.showAll?this.remarks:this.remarks.slice(0,this.maxVisibleItems);return e(i,null,e("p",{class:"label_title"},this.label),e("ul",null,t.map(((i,s)=>e("li",{key:L()},"- ",i.statement," ",this.remarks.length>this.maxVisibleItems&&s===t.length-1&&e("button",{onClick:this.toggleShowAll},this.showAll?p.entries.Lcz_ShowLess:p.entries.Lcz_ShowMore))))))}};Ir.style=Tr;export{rt as igl_application_info,ct as igl_block_dates_view,pt as igl_book_property,mt as igl_book_property_footer,kt as igl_book_property_header,Ct as igl_booking_event,At as igl_booking_event_hover,Tt as igl_booking_form,Yt as igl_booking_overview_page,jt as igl_cal_body,$t as igl_cal_footer,Qt as igl_cal_header,ie as igl_date_range,oe as igl_legends,le as igl_property_booked_by,de as igl_rate_plan,pe as igl_room_type,me as igl_tba_booking_view,ke as igl_tba_category_view,_e as igl_to_be_assigned,gs as igloo_calendar,ys as ir_autocomplete,xs as ir_booking_details,Cs as ir_booking_extra_note,As as ir_booking_header,Ts as ir_button,Ys as ir_combobox,Ls as ir_common,zs as ir_country_picker,Ps as ir_date_picker,Us as ir_date_view,Ws as ir_dialog,Js as ir_events_log,tn as ir_extra_service,ln as ir_extra_service_config,dn as ir_extra_services,pn as ir_guest_info,mn as ir_icon,kn as ir_icons,ho as ir_input_text,po as ir_interactive_title,mo as ir_interceptor,ko as ir_label,_o as ir_loading_screen,Oo as ir_modal,Bo as ir_payment_actions,Io as ir_payment_details,No as ir_phone_input,zo as ir_pickup,Po as ir_pickup_view,Uo as ir_pms_logs,Wo as ir_price_input,Jo as ir_reservation_information,tr as ir_room,or as ir_room_guests,lr as ir_room_nights,dr as ir_select,pr as ir_sidebar,mr as ir_spinner,kr as ir_textarea,_r as ir_title,Or as ir_toast,Br as ir_tooltip,Ir as ota_label};
//# sourceMappingURL=p-ca3f8c63.entry.js.map