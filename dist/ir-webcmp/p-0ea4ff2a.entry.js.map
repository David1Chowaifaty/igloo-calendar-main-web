{"version":3,"names":["irArrivalsTableCss","IrArrivalsTableStyle0","tableCss","IrArrivalsTableStyle1","IrArrivalsTable","selectedBooking","requestPageChange","requestPageSizeChange","checkInRoom","renderSection","bookings","showAction","length","rows","flatMap","booking","this","renderBookingRows","rooms","map","room","index","renderRow","compareGuests","roomGuest","guest","bookingGuest","normalize","value","trim","toLowerCase","first_name","last_name","handleActionsClicked","e","stopImmediatePropagation","stopPropagation","detail","action","adult_nbr","children_nbr","infant_nbr","occupancy","emit","identifier","sharing_persons","booking_nbr","checkin","roomName","unit","name","totalGuests","console","warn","rowKey","isOverdueCheckIn","moment","from_date","startOf","isBefore","h","class","key","source","origin","channelBookingNumber","channel_booking_nbr","bookingNumber","overdueCheckin","checkIn","checkOut","to_date","isDirect","is_direct","statusCode","status","code","currencySymbol","currency","symbol","financial","removeBalance","buttons","onIrAction","in_out","handlePageChange","event","handlePageSizeChange","render","needsCheckInBookings","inHouseBookings","futureBookings","pagination","arrivalsStore","Host","style","width","marginLeft","marginRight","id","size","variant","appearance","colSpan","showing","total","pages","totalPages","pageSize","currentPage","allowPageSizeChange","pageSizes","recordLabel","locales","entries","Lcz_Bookings","onPageChange","onPageSizeChange"],"sources":["src/components/ir-arrivals/ir-arrivals-table/ir-arrivals-table.css?tag=ir-arrivals-table&encapsulation=scoped","src/common/table.css?tag=ir-arrivals-table&encapsulation=scoped","src/components/ir-arrivals/ir-arrivals-table/ir-arrivals-table.tsx"],"sourcesContent":[":host {\n  display: flex;\n  flex-direction: column;\n  border-radius: 0.5rem;\n  overflow-x: auto;\n  min-height: 60vh;\n  max-width: 1920px;\n  border: 1px solid var(--wa-color-neutral-border-quiet, #abaeb9);\n  background-color: white;\n  /* border-bottom: 0; */\n}\n:host {\n  box-sizing: border-box !important;\n}\n\n:host *,\n:host *::before,\n:host *::after {\n  box-sizing: inherit !important;\n  padding: 0;\n  margin: 0;\n}\n\n[hidden] {\n  display: none !important;\n}\n\n.arrivals-table__actions-cell {\n  display: flex;\n  min-width: 100px;\n  justify-content: flex-end;\n}\n\n@media (min-width: 1024px) {\n  .arrivals-table__actions-cell {\n    min-width: 150px;\n  }\n}\n","/* Base styles */\n.ir-table-row td {\n  padding: 0.5rem 1rem !important;\n  text-align: left;\n  z-index: 2;\n  background-color: var(--wa-color-surface-default);\n  white-space: nowrap;\n  color: var(--wa-color-text-normal);\n  box-sizing: border-box;\n  /* width: max-content;\n  max-width: max-content; */\n}\n/* .ir-table-row td:last-child {\n  width: 100%; \n}*/\n/* .ir-table-row td:first-child,\n.table thead th:first-child {\n  position: sticky;\n  left: var(--ir-table-sticky-padding,-1rem);\n} */\n.table--container {\n  flex: 1 1 0%;\n}\n.table--container {\n  overflow-x: auto;\n}\n.table td {\n  border-top: 0;\n  border-bottom: 1px solid var(--wa-color-neutral-border-quiet, #abaeb9);\n  /* border-bottom: 1px solid var(--wa-color-gray-80); */\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.table tbody tr:last-child > td {\n  border-bottom: 0 !important;\n}\n.table thead th {\n  border: none !important;\n  background: #ececec;\n  background: color-mix(in oklab, var(--wa-color-neutral-fill-quiet, #f1f2f3) 60%, transparent);\n  color: #374151;\n  padding: 0.5rem 1rem !important;\n  text-align: left;\n}\n.data-table thead th {\n  box-sizing: border-box;\n  background: var(--wa-color-surface-default) !important;\n  padding-top: 0.5rem !important;\n  padding-bottom: 0.5rem !important;\n  border-bottom: 1px solid var(--wa-color-neutral-90) !important;\n  color: var(--wa-color-text-normal);\n}\n.data-table .empty-row {\n  height: 50vh !important;\n  text-align: center;\n  color: var(--wa-color-gray-60);\n}\n\n.data-table--pagination {\n  padding: 0.5rem 1rem;\n  position: sticky;\n  bottom: 0;\n  background: var(--wa-color-surface-default);\n  border-top: 1px solid var(--wa-color-neutral-90);\n}\n\n/* Selected Rows Styles */\n\n.selected td {\n  background: #e3f3fa !important;\n}\n.selected td {\n  color: var(--gray-dark) !important;\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n\n/* Sorting styles */\n.sortable,\n.ir-table-row {\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.sortable {\n  text-transform: capitalize;\n}\n.sortable:hover {\n  color: #212529;\n  background-color: #e2e8f0 !important;\n  border-color: #dae0e5;\n  cursor: pointer;\n}\n.ir-table-row:hover td {\n  background: #e2e6ea3f !important;\n  background: var(--wa-color-neutral-fill-quiet, #f1f2f3) !important;\n}\n.sortable:active {\n  color: #212529;\n  background-color: #e2e8f0;\n  border-color: #d3d9df;\n}\n.sortable svg {\n  color: var(--blue);\n}\n/* .action-row {\n  position: sticky;\n  right:var(--ir-table-sticky-padding,-1rem);\n} */\n.sticky-column {\n  position: sticky !important;\n  right: 0;\n  background-color: white;\n}\n","import { IrActionButton } from '@/components/table-cells/booking/ir-actions-cell/ir-actions-cell';\nimport type { PaginationChangeEvent } from '@/components/ir-pagination/ir-pagination';\nimport { Booking, IUnit } from '@/models/booking.dto';\nimport { arrivalsStore } from '@/stores/arrivals.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Host, State, h } from '@stencil/core';\nimport moment from 'moment';\nimport { RoomGuestsPayload } from '@/components/ir-booking-details/types';\n\n@Component({\n  tag: 'ir-arrivals-table',\n  styleUrls: ['ir-arrivals-table.css', '../../../common/table.css'],\n  scoped: true,\n})\nexport class IrArrivalsTable {\n  @State() selectedBooking: Booking;\n\n  @Event() requestPageChange: EventEmitter<PaginationChangeEvent>;\n  @Event() requestPageSizeChange: EventEmitter<PaginationChangeEvent>;\n  @Event() checkInRoom: EventEmitter<RoomGuestsPayload>;\n\n  private renderSection(bookings: Booking[], showAction = false) {\n    if (!bookings?.length) {\n      return null;\n    }\n\n    const rows = bookings.flatMap(booking => this.renderBookingRows(booking, showAction));\n    return [...rows];\n  }\n\n  private renderBookingRows(booking: Booking, showAction: boolean) {\n    return (booking.rooms ?? []).map((room, index) => this.renderRow(booking, room, index, showAction));\n  }\n  private compareGuests(booking: Booking, room: Booking['rooms'][number]): boolean {\n    const roomGuest = room?.guest;\n    const bookingGuest = booking?.guest;\n\n    if (!roomGuest || !bookingGuest) {\n      return false;\n    }\n\n    const normalize = (value?: string) => value?.trim().toLowerCase() ?? '';\n\n    return normalize(roomGuest.first_name) === normalize(bookingGuest.first_name) && normalize(roomGuest.last_name) === normalize(bookingGuest.last_name);\n  }\n  private async handleActionsClicked(e: CustomEvent<{ action: IrActionButton }>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    switch (e.detail.action) {\n      case 'check_in':\n      case 'overdue_check_in':\n        const room = this.selectedBooking.rooms[0];\n        const { adult_nbr, children_nbr, infant_nbr } = room.occupancy;\n        this.checkInRoom.emit({\n          identifier: room.identifier,\n          sharing_persons: room.sharing_persons,\n          booking_nbr: this.selectedBooking.booking_nbr,\n          checkin: true,\n          roomName: (room.unit as IUnit)?.name,\n          totalGuests: adult_nbr + children_nbr + infant_nbr,\n        });\n        return;\n      default:\n        console.warn(e.detail.action + ' not handled');\n    }\n  }\n  private renderRow(booking: Booking, room: Booking['rooms'][number], index: number, showAction: boolean) {\n    const rowKey = `${booking.booking_nbr}-${room?.identifier ?? index}`;\n    const isOverdueCheckIn = moment(room.from_date, 'YYYY-MM-DD').startOf('day').isBefore(moment().startOf('day'), 'dates');\n    return (\n      <tr class=\"ir-table-row\" key={rowKey}>\n        <td class=\"sticky-column\">\n          <ir-booking-number-cell\n            source={booking.source}\n            origin={booking.origin}\n            channelBookingNumber={booking.channel_booking_nbr}\n            bookingNumber={booking.booking_nbr}\n          ></ir-booking-number-cell>\n        </td>\n        <td>\n          <ir-booked-by-cell guest={booking.guest}></ir-booked-by-cell>\n\n          {!this.compareGuests(booking, room) && <ir-guest-name-cell name={room.guest}></ir-guest-name-cell>}\n        </td>\n        {/* <td>\n        </td> */}\n        <td>\n          <ir-unit-cell room={room}></ir-unit-cell>\n        </td>\n        <td>\n          <ir-dates-cell overdueCheckin={isOverdueCheckIn} checkIn={room.from_date} checkOut={room.to_date}></ir-dates-cell>\n        </td>\n        <td class=\"text-center\">\n          <ir-balance-cell\n            bookingNumber={booking.booking_nbr}\n            isDirect={booking.is_direct}\n            statusCode={booking.status.code}\n            currencySymbol={booking.currency.symbol}\n            financial={booking.financial}\n            removeBalance\n          ></ir-balance-cell>\n        </td>\n        <td>\n          <div class=\"arrivals-table__actions-cell\">\n            {showAction ? (\n              <ir-actions-cell\n                buttons={isOverdueCheckIn ? ['overdue_check_in'] : ['check_in']}\n                onIrAction={e => {\n                  this.selectedBooking = booking;\n                  this.handleActionsClicked(e);\n                }}\n              ></ir-actions-cell>\n            ) : room.in_out.code === '001' ? (\n              'In-house'\n            ) : (\n              ''\n            )}\n          </div>\n        </td>\n      </tr>\n    );\n  }\n\n  private handlePageChange(event: CustomEvent<PaginationChangeEvent>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    this.requestPageChange.emit(event.detail);\n  }\n\n  private handlePageSizeChange(event: CustomEvent<PaginationChangeEvent>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    this.requestPageSizeChange.emit(event.detail);\n  }\n\n  render() {\n    const { needsCheckInBookings, inHouseBookings, futureBookings, pagination } = arrivalsStore;\n    return (\n      <Host>\n        <div class=\"table--container\">\n          <table class=\"table data-table\">\n            <thead>\n              <tr>\n                <th>\n                  <span class={'arrivals-table__departure__cell'}>Booking#</span>\n                </th>\n                <th>\n                  <div>\n                    <p>Booked by /</p>\n                    <p>Guest name</p>\n                  </div>\n                </th>\n                {/* <th></th> */}\n                <th>Unit</th>\n                <th>Dates</th>\n                <th class=\"text-center\">\n                  Balance\n                  <div style={{ width: 'fit-content', marginLeft: 'auto', marginRight: 'auto' }}>\n                    <ir-custom-button\n                      id=\"balance-info\"\n                      style={{ '--ir-c-btn-height': 'fit-content', '--ir-c-btn-padding': '0.25rem', '--ir-c-btn-font-size': '0.725rem' }}\n                      size=\"small\"\n                      variant=\"danger\"\n                      appearance=\"outlined\"\n                    >\n                      Click to collect\n                    </ir-custom-button>\n                  </div>\n                </th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.renderSection(futureBookings)}\n              {this.renderSection(needsCheckInBookings, true)}\n              {this.renderSection(inHouseBookings)}\n              {!needsCheckInBookings.length && !inHouseBookings.length && (\n                <tr>\n                  <td colSpan={6} class=\"empty-row\">\n                    No arrivals found.\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n        <ir-pagination\n          class=\"data-table--pagination\"\n          showing={pagination.showing}\n          total={pagination.total}\n          pages={pagination.totalPages}\n          pageSize={pagination.pageSize}\n          currentPage={pagination.currentPage}\n          allowPageSizeChange={false}\n          pageSizes={[pagination.pageSize]}\n          recordLabel={locales.entries?.Lcz_Bookings ?? 'Bookings'}\n          onPageChange={event => this.handlePageChange(event as CustomEvent<PaginationChangeEvent>)}\n          onPageSizeChange={event => this.handlePageSizeChange(event as CustomEvent<PaginationChangeEvent>)}\n        ></ir-pagination>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}