import{a as t}from"./p-bf44a732.js";import{z as e,u as n,n as o,s as r,o as a,b as i,a as s,e as c,c as l,d as u,f as _}from"./p-748cfd41.js";import{e as d,c as m,a as y,d as p}from"./p-ae2f332f.js";import{c as f,g as b}from"./p-8af1cf5e.js";import{c as E}from"./p-99cb260a.js";import{c as h}from"./p-c5894a47.js";import{h as w}from"./p-6c4ba7c0.js";import{l as g}from"./p-4e493fea.js";const k=e.object({CODE_NAME:e.string(),CODE_VALUE_AR:e.string().nullable(),CODE_VALUE_DE:e.string().nullable(),CODE_VALUE_EL:e.string().nullable(),CODE_VALUE_EN:e.string().nullable(),CODE_VALUE_FR:e.string().nullable(),CODE_VALUE_HE:e.string().nullable(),CODE_VALUE_PL:e.string().nullable(),CODE_VALUE_RU:e.string().nullable(),CODE_VALUE_UA:e.string().nullable(),DISPLAY_ORDER:e.number().nullable(),ENTRY_DATE:e.string().nullable(),ENTRY_USER_ID:e.number().nullable(),INVARIANT_VALUE:e.string().nullable(),ISDELETEABLE:e.boolean(),ISDELETED:e.boolean(),ISSYSTEM:e.boolean(),ISUPDATEABLE:e.boolean(),ISVISIBLE:e.boolean(),NOTES:e.string().nullable(),OWNER_ID:e.number().nullable(),TBL_NAME:e.string()});var v;(function(t){t["Room"]="room"})(v||(v={}));var I;(function(t){t["Penthouse"]="Penthouse";t["PremiumSuites"]="Premium Suites";t["StandardRooms"]="Standard Rooms"})(I||(I={}));var B;(function(t){t["Empty"]="";t["The001"]="001";t["The002"]="002"})(B||(B={}));class S{formatVariationBasedOnInfants(t){const e=this.getVariationBasedOnInfants(t);return this.formatVariation(e,t.infants)}calculateVariationAmount(t){return this.getVariationBasedOnInfants(t)?.discounted_amount||0}getVariationBasedOnInfants({variations:t,baseVariation:e,infants:n}){const{adult_nbr:o,child_nbr:r}=e;return t.find((t=>t.adult_nbr===o&&t.child_nbr===Math.max(0,r-Math.max(0,n))))||e}formatVariation({child_nbr:t,adult_nbr:e},n){const o=Number(e)||0;const r=Math.max(Number(n)||0,0);const a=o>1?g.entries.Lcz_Adults.toLowerCase():g.entries.Lcz_Adult.toLowerCase();const i=t>1?g.entries.Lcz_Children.toLowerCase():g.entries.Lcz_Child.toLowerCase();const s=r>1?(g.entries["Lcz_Infants"]??"infants")?.toLowerCase():(g?.entries["Lcz_Infant"]??"infant")?.toLowerCase();const c=[`${o} ${a}`,t?`${t} ${i}`:"",r?`${r} ${s}`:""];return c.filter(Boolean).join("&nbsp&nbsp&nbsp&nbsp")}}const x={id:-1,email:"",company:"",firstName:"",lastName:"",countryId:"",phone_prefix:"",mobile:"",selectedArrivalTime:"",emailGuest:true,note:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""};const T={bookedByGuest:x,bookedByGuestManuallyEdited:false,bookingDraft:{dates:{checkIn:w().startOf("day"),checkOut:w().add(1,"day")},occupancy:{adults:null,children:null},source:null},selects:{sources:[],ratePricingMode:[],arrivalTime:[],bedPreferences:[],countries:[]},checkout_guest:null,guest:null,tax_statement:null,roomTypes:[],enableBooking:false,resetBooking:false,ratePlanSelections:{},selectedPaymentMethod:null,isInFreeCancelationZone:false,bookingAvailabilityParams:{from_date:null,to_date:null,adult_nbr:0,child_nbr:0,infant_nbr:0},booking:null,fictus_booking_nbr:null,event_type:{type:"PLUS_BOOKING"}};let{state:D,onChange:N,reset:P}=h(T);function R(t){const{bookingDraft:e,selects:n,bookedByGuest:o}=D;P();if(!t){O(e);L(o);C(n)}}function A(){R(false)}function O(t){D.bookingDraft={...D.bookingDraft,...t,dates:{...D.bookingDraft.dates,...t.dates},occupancy:{...D.bookingDraft.occupancy,...t.occupancy}}}function C(t){D.selects={...D.selects,...t}}function G(t,e){if(!t){return null}if(!e||D.resetBooking){return t[0]}return t?.find((t=>t.adult_nbr===e.adult_nbr&&t.child_nbr===e.child_nbr))??null}N("roomTypes",(t=>{const e=D.ratePlanSelections;const n={};t.forEach((t=>{if(!t.is_active)return;n[t.id]=n[t.id]||{};t.rateplans.forEach((o=>{if(!o.is_active||!o?.variations?.length)return;const r=e[t.id]?.[o.id];n[t.id][o.id]=r&&Object.keys(r).length>0?{...r,ratePlan:o,selected_variation:G(o.variations,r.selected_variation)??null,visibleInventory:t.inventory,reserved:t.inventory===0?0:D.resetBooking?0:r.reserved,checkoutVariations:t.inventory===0?[]:r.checkoutVariations,checkoutBedSelection:t.inventory===0?[]:r.checkoutBedSelection,checkoutSmokingSelection:t.inventory===0?[]:r.checkoutSmokingSelection,guestName:t.inventory===0?[]:r.guestName,roomtype:{...r.roomtype}}:{reserved:0,rp_amount:0,view_mode:"001",guest:null,visibleInventory:t.inventory,selected_variation:o?.variations[0]??null,ratePlan:o,guestName:[],is_bed_configuration_enabled:t.is_bed_configuration_enabled,roomtype:{...t,physicalrooms:null,rateplans:null,availabilities:null},checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[]}}))}));D.ratePlanSelections=n;D.resetBooking=false}));function L(t){D.bookedByGuest={...D.bookedByGuest,...t}}function M({guest:t,ratePlanId:e,roomTypeId:n,ratePlanSelection:o}){D.ratePlanSelections={...D.ratePlanSelections,[n]:{...D.ratePlanSelections[n],[e]:{...o,guest:[...t]}}}}function V(t){const e=D.ratePlanSelections[t];if(!e){return}const n=D.roomTypes.find((e=>e.id===t));if(!n){return}const o=Object.values(e).reduce(((t,e)=>t+e.reserved),0);let r=false;const a=Object.entries(e).reduce(((t,[e,a])=>{const i=o-a.reserved;const s=Math.max(n.inventory-i,0);if(a.visibleInventory!==s){r=true;t[e]={...a,visibleInventory:s}}else{t[e]=a}return t}),{});if(r){D.ratePlanSelections={...D.ratePlanSelections,[t]:a}}}function U(){return Object.values(D.ratePlanSelections).some((t=>Object.values(t).some((t=>t.reserved>0))))}function j({ratePlanId:t,roomTypeId:e,params:n}){D.ratePlanSelections={...D.ratePlanSelections,[Number(e)]:{...D.ratePlanSelections[Number(e)],[t]:{...D.ratePlanSelections[e][t],...n}}}}function Y({ratePlanId:t,roomTypeId:e,rooms:n,guest:o}){if(!D.ratePlanSelections[e]){D.ratePlanSelections[e]={}}const r=D.roomTypes?.find((t=>t.id===e));if(!r){throw new Error("Invalid room type id")}const a=r.rateplans.find((e=>e.id===t));if(!a){throw new Error("Invalid rate plan")}let i=Array.from({length:n},(()=>({first_name:"",last_name:"",unit:null,bed_preference:null,infant_nbr:null})));if(o){i=o}if(!D.ratePlanSelections[e][t]){D.ratePlanSelections[e][t]={guestName:[],reserved:0,view_mode:"001",rp_amount:0,guest:i,is_bed_configuration_enabled:r.is_bed_configuration_enabled,visibleInventory:0,selected_variation:null,ratePlan:a,checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],roomtype:{id:r.id,name:r.name,physicalrooms:null,rateplans:null,availabilities:null,inventory:r.inventory,rate:r.rate,bedding_setup:r.bedding_setup,smoking_option:r.smoking_option,is_bed_configuration_enabled:r.is_bed_configuration_enabled}}}D.ratePlanSelections={...D.ratePlanSelections,[Number(e)]:{...D.ratePlanSelections[Number(e)],[t]:{...D.ratePlanSelections[e][t],reserved:n,checkoutVariations:[],guest:i}}};V(e)}function F(t,e){if(!D.ratePlanSelections||!D.ratePlanSelections[t]){return{reserved:0,guest:null,visibleInventory:0,selected_variation:null,ratePlan:null,guestName:[],is_bed_configuration_enabled:false,checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],rp_amount:0,view_mode:"001",roomtype:null}}return D.ratePlanSelections[t][e]}function $(t,e){D[t]=e}async function H({rateplanSelection:t,totalNights:e,index:n,bookingService:o,variationService:r}){if(t.is_amount_modified){const n=t.view_mode==="001"?t.rp_amount:t.rp_amount*e;const r=await o.calculateExclusiveTax({property_id:E.property.id,amount:n});return n+r}const a=t.guest?t.guest[n]:null;let i=t.selected_variation;if(a.infant_nbr){i=r.getVariationBasedOnInfants({variations:t.ratePlan.variations,baseVariation:t.selected_variation,infants:a?.infant_nbr})}return i?.discounted_gross_amount??0}async function K(){const t=f(D.bookingDraft.dates.checkIn.format("YYYY-MM-DD"),D.bookingDraft.dates.checkOut.format("YYYY-MM-DD"));const e=new vt;const n=new S;let o=0;for(const r of Object.values(D.ratePlanSelections)){for(let a=0;a<Object.values(r).length;a++){const i=Object.values(r)[a];if(i.reserved===0)continue;const s=await H({bookingService:e,variationService:n,index:a,rateplanSelection:i,totalNights:t});o+=s*i.reserved}}return Number(o.toFixed(2))}function z(){return Object.values(D.ratePlanSelections).reduce(((t,e)=>t+Object.values(e).reduce(((t,e)=>{if(e.reserved===0){return t}return t+e.reserved}),0)),0)}function Z(){const t=Object.entries(D.ratePlanSelections).reduce(((t,[e,n])=>{const o=D.roomTypes.find((t=>t.id.toString()===e.toString()));t[e]=Object.entries(n).reduce(((t,[e,n])=>{const r=o?.inventory??n.roomtype?.inventory??n.visibleInventory;t[e]={...n,reserved:0,guest:null,guestName:[],checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],visibleInventory:r??0};return t}),{});return t}),{});D.ratePlanSelections={...t}}function W(t){D.bookedByGuestManuallyEdited=t}function X(){const t=[];Object.entries(D.ratePlanSelections).forEach((([e,n])=>{Object.entries(n).forEach((([n,o])=>{if(!o.reserved){return}const r=o.guest??[];for(let a=0;a<o.reserved;a++){t.push({roomTypeId:Number(e),ratePlanId:Number(n),reservationIndex:a,guest:r[a]??null,ratePlanSelection:o})}}))}));return t}const q=n([o(),r().optional()]);const J=a({id:o()});const Q=J.extend({code:r().optional()});const tt=a({amount:o(),type:r().optional(),key:n([o(),r().optional()]),description:r().optional().optional().default("")});const et=a({code:r().optional(),description:r().optional()});a({unit_id:o(),from_date:r().optional(),to_date:r().optional()});a({starter:r().optional()});a({booking_nbr:r().optional(),currency_id:o(),language:r().optional().optional(),rate_plan_id:o(),room_type_id:o(),property_id:o(),is_preserve_history:i().optional(),room_identifier:r().optional().optional()});a({booking_nbr:r().optional(),room_identifier:r().optional(),status:r().optional()});a({booking_nbr:r().optional(),currency_id:o(),language:r().optional()});const nt=a({room_type_id:q,night:r().optional()});a({is_closed:i(),restrictions:s(nt),operation_type:r().optional().optional()});a({book_nbr:r().optional(),status:r().optional()});const ot=a({adult:o(),child:o()});a({from_date:r().optional(),to_date:r().optional(),propertyid:o(),adultChildCount:ot,language:r().optional(),room_type_ids:s(o()),room_type_ids_to_update:s(o()).optional(),rate_plan_ids:s(o()).optional(),currency:Q,is_in_agent_mode:i().optional(),agent_id:q.optional()});const rt=a({from_date:r().optional(),to_date:r().optional()});a({unit_id:o(),block_status_code:c(["003","004","002"]).optional(),description:r().optional().optional(),property_id:o(),brackets:s(rt)});a({property_id:o(),room_identifier:r().optional(),code:r().optional()});a({service:l(),booking_nbr:q,is_remove:i()});const at=a({property_id:r(),check_in_date:r(),page_index:o().default(1),page_size:o().default(10)});const it=a({property_id:r(),check_out_date:r(),page_index:o().default(1),page_size:o().default(10)});const st=a({booking_nbr:r().optional()});const ct=a({invoice_nbr:r().optional(),reason:r().optional(),property_id:o()});const lt=a({booking_nbr:r().optional(),currency:J,target:et,Date:r().optional(),nbr:r().optional(),remark:r().optional(),billed_to_name:r().optional(),billed_to_tax:r().optional(),items:s(tt)});const ut=a({is_proforma:i().optional().default(false),property_id:o(),invoice:lt});const _t=a({invoice_nbr:r().optional(),property_id:o(),mode:c(["invoice","creditnote","proforma"]),invoice:lt.optional()});const dt=a({address:u(),alternative_email:u(),cci:u(),city:u(),country:u(),country_id:o(),country_phone_prefix:r(),dob:u(),email:r(),first_name:r(),id:o(),id_info:u(),is_main:i(),last_name:r(),mobile:r(),mobile_without_prefix:r(),nbr_confirmed_bookings:o(),notes:u(),password:u(),subscribe_to_news_letter:u()});s(dt);const mt=a({property_id:o().min(1),amount:o()});const yt=a({revision_id:o()});const pt=a({code:r(),id:o(),symbol:r()});const ft=a({code:r(),description:_()});const bt=a({amount:o(),booking_nbr:r(),currency:pt,description:_(),invoice_nbr:r(),is_invoiceable:i(),key:o(),status:ft,system_id:o(),type:r()});const Et=a({date:r(),nbr:r(),reason:r(),system_id:r().nullable(),user:r().nullable()});const ht=a({billed_to_name:_(),billed_to_tax:_(),booking_nbr:r(),credit_note:Et.nullable(),currency:pt,date:r(),items:s(bt),nbr:r(),pdf_url:_(),remark:r(),status:ft,system_id:o(),target:_(),user:r().nullable(),total_amount:_()});const wt=a({code:c(["001","002","003"]),description:r().nullable()});const gt=a({amount:o(),booking_nbr:r(),currency:pt,invoice_nbr:r().nullable(),is_invoiceable:i(),key:o(),status:_(),system_id:_(),reason:wt.nullable(),type:c(["BSA","BSP","BSE","PAYMENT"])});const kt=a({invoiceable_items:s(gt),invoices:s(ht).nullable()});class vt{async unBlockUnitByPeriod(e){const{data:n}=await t.post(`/Unblock_Unit_By_Period`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getNextValue(e){const{data:n}=await t.post(`/Get_Next_Value`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getExposedApplicablePolicies(e){const{data:n}=await t.post(`/Get_Exposed_Applicable_Policies`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result??[]}async handleExposedRoomInOut(e){const{data:n}=await t.post(`/Handle_Exposed_Room_InOut`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async GetPenaltyStatement(e){const{data:n}=await t.post("/Get_Penalty_Statement",e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}async setExposedRestrictionPerRoomType(e){const{data:n}=await t.post(`https://gateway.igloorooms.com/IRBE/Set_Exposed_Restriction_Per_Room_Type`,{operation_type:e.operation_type??"close_open",...e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getLov(){const{data:e}=await t.post(`/Get_LOV`,{});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e}async sendBookingConfirmationEmail(e,n){const{data:o}=await t.post(`/Send_Booking_Confirmation_Email`,{booking_nbr:e,language:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o.My_Result}async getCalendarData(e,n,o){try{const{data:r}=await t.post(`/Get_Exposed_Calendar`,{propertyid:e,from_date:n,to_date:o,extras:d,include_sales_rate_plans:true});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}const a=r.My_Result.months;const i=[];const s=await b(a);const c=a.map((t=>{i.push({daysCount:t.days.length,monthName:t.description});return t.days.map((e=>{if(e["value"]==="2025-05-30"){console.log(e)}return{day:m(e.description,t.description),value:e.value,currentDate:y(e.description,t.description),dayDisplayName:e.description,rate:e.room_types,unassigned_units_nbr:e.unassigned_units_nbr,occupancy:e.occupancy}}))})).flat();return Promise.resolve({ExceptionCode:null,ExceptionMsg:"",My_Params_Get_Rooming_Data:{AC_ID:e,FROM:r.My_Params_Get_Exposed_Calendar.from_date,TO:r.My_Params_Get_Exposed_Calendar.to_date},days:c,months:i,myBookings:s,defaultMonths:a})}catch(t){console.error(t)}}async handleExposedRoomGuests(e){const{data:n}=await t.post("/Handle_Exposed_Room_Guests",e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async fetchGuest(e){try{const{data:n}=await t.post(`/Get_Exposed_Guest`,{email:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){console.log(t);throw new Error(t)}}async changeExposedBookingStatus(e){try{const{data:n}=await t.post(`/Change_Exposed_Booking_Status`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){throw new Error(t)}}async fetchPMSLogs(e){try{const{data:n}=await t.post(`/Get_Exposed_PMS_Logs`,{booking_nbr:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){console.log(t);throw new Error(t)}}async ackExposedRevision(e){const n=yt.parse(e);const{data:o}=await t.post("/Ack_Exposed_Revision",n);return o}async getExposedBookingEvents(e){try{const{data:n}=await t.post(`/Get_Exposed_Booking_Events`,{booking_nbr:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){console.log(t);throw new Error(t)}}async editExposedGuest(e,n){try{const{data:o}=await t.post(`/Edit_Exposed_Guest`,{...e,book_nbr:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o.My_Result}catch(t){console.log(t);throw new Error(t)}}async getBookingAvailability(e){try{const{adultChildCount:n,currency:o,...r}=e;const{data:a}=await t.post(`/Check_Availability`,{...r,adult_nbr:n.adult,child_nbr:n.child,currency_ref:o.code,skip_getting_assignable_units:!E.is_frontdesk_enabled,is_backend:true});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}const i=this.modifyRateplans(this.sortRoomTypes(a["My_Result"],{adult_nbr:Number(n.adult),child_nbr:Number(n.child)}));D.roomTypes=[...i];D.tax_statement={message:a.My_Result.tax_statement};return i}catch(t){console.error(t);throw new Error(t)}}async calculateExclusiveTax(e){const n=mt.parse(e);const{data:o}=await t.post("/Calculate_Exclusive_Tax",n);return o.My_Result??0}sortRoomTypes(t,e){return t.sort(((t,n)=>{if(t.is_available_to_book&&!n.is_available_to_book)return-1;if(!t.is_available_to_book&&n.is_available_to_book)return 1;const o=t.rateplans?.some((t=>t.variations?.some((t=>t.discounted_amount===0||t.discounted_amount===null))));const r=n.rateplans?.some((t=>t.variations?.some((t=>t.discounted_amount===0||t.discounted_amount===null))));if(o&&!r)return 1;if(!o&&r)return-1;const a=t.rateplans?.some((t=>t.variations?.some((t=>t.adult_nbr===e.adult_nbr&&t.child_nbr===e.child_nbr))));const i=n.rateplans?.some((t=>t.variations?.some((t=>t.adult_nbr===e.adult_nbr&&t.child_nbr===e.child_nbr))));if(a&&!i)return-1;if(!a&&i)return 1;const s=Math.max(...t.rateplans.flatMap((t=>t.variations?.map((t=>t.discounted_amount??0)))));const c=Math.max(...n.rateplans.flatMap((t=>t.variations?.map((t=>t.discounted_amount??0)))));if(s<c)return-1;if(s>c)return 1;return 0}))}modifyRateplans(t){return t?.map((t=>({...t,rateplans:t.rateplans?.map((t=>({...t,variations:this.sortVariations(t?.variations??[])})))})))}sortVariations(t){return t.sort(((t,e)=>{if(t.adult_nbr!==e.adult_nbr){return e.adult_nbr-t.adult_nbr}return e.child_nbr-t.child_nbr}))}async getCountries(e){try{const{data:n}=await t.post(`/Get_Exposed_Countries`,{language:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){console.error(t);throw new Error(t)}}async getSetupEntriesByTableName(e){const{data:n}=await t.post(`/Get_Setup_Entries_By_TBL_NAME`,{TBL_NAME:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}const o=n.My_Result??[];return o}async fetchSetupEntries(){try{const t=await this.getSetupEntriesByTableNameMulti(["_ARRIVAL_TIME","_RATE_PRICING_MODE","_BED_PREFERENCE_TYPE"]);const{arrival_time:e,rate_pricing_mode:n,bed_preference_type:o}=this.groupEntryTablesResult(t);return{arrivalTime:e,ratePricingMode:n,bedPreferenceType:o}}catch(t){console.error(t);throw new Error(t)}}async doBookingExtraService({booking_nbr:e,service:n,is_remove:o}){const{data:r}=await t.post(`/Do_Booking_Extra_Service`,{...n,booking_nbr:e,is_remove:o});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}return r.My_Result}groupEntryTablesResult(t){let e={};for(const n of t){const t=n.TBL_NAME.substring(1,n.TBL_NAME.length).toLowerCase();if(!e[t]){e[t]=[]}e[t]=[...e[t],n]}return e}async getSetupEntriesByTableNameMulti(e){const{data:n}=await t.post(`/Get_Setup_Entries_By_TBL_NAME_MULTI`,{TBL_NAMES:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}async getBlockedInfo(){return await this.getSetupEntriesByTableNameMulti(["_CALENDAR_BLOCKED_TILL"])}async getUserDefaultCountry(){try{let e={IP:""};if(E?.property?.id){e={...e,id:E.property.id}}const{data:n}=await t.post(`/Get_Country_By_IP`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n["My_Result"]}catch(t){console.error(t);throw new Error(t)}}async blockUnit(e){try{const{data:n}=await t.post(`/Block_Exposed_Unit`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n);return n["My_Params_Block_Exposed_Unit"]}catch(t){console.error(t);throw new Error(t)}}async blockAvailabilityForBrackets(e){try{const{data:n}=await t.post(`/Block_Availability_For_Brackets`,e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}catch(t){console.error(t);throw new Error(t)}}async setDepartureTime(e){const{data:n}=await t.post("/Set_Departure_Time",e);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getUserInfo(e){try{const{data:n}=await t.post(`/GET_EXPOSED_GUEST`,{email:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(t){console.error(t);throw new Error(t)}}async getExposedBooking(e,n,o=true){try{const{data:r}=await t.post(`/Get_Exposed_Booking`,{booking_nbr:e,language:n,extras:o?d:null});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}return r.My_Result}catch(t){console.error(t)}}generateDays(t,e,n){const o=new Date(t);const r=new Date(e);const a=[];while(o<r){a.push({date:o.toISOString().split("T")[0],amount:n,cost:null});o.setDate(o.getDate()+1)}return a}calculateTotalRate(t,e,n,o){if(n&&o===2){return+t}return+t/+e}async fetchExposedGuest(e,n){try{const{data:o}=await t.post(`/Fetch_Exposed_Guests`,{email:e,property_id:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o["My_Result"]}catch(t){console.error(t);throw new Error(t)}}async fetchExposedBookings(e,n,o,r){try{const{data:a}=await t.post(`/Fetch_Exposed_Bookings`,{booking_nbr:e,property_id:n,from_date:o,to_date:r});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}return a["My_Result"]}catch(t){console.error(t);throw new Error(t)}}async getPCICardInfoURL(e){try{const{data:n}=await t.post(`/Get_PCI_Card_Info_URL`,{BOOK_NBR:e});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n["My_Result"]}catch(t){console.error(t);throw new Error(t)}}async doReservation(e){const{data:n}=await t.post(`/DoReservation`,{...e,extras:e.extras?e.extras:d});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n["My_Result"]);return n["My_Result"]}async bookUser({bookedByInfoData:t,check_in:e,currency:n,extras:o=null,fromDate:r,guestData:a,pickup_info:i,propertyid:s,rooms:c,source:l,toDate:u,totalNights:_,arrivalTime:d,bookingNumber:m,defaultGuest:y,identifier:f,pr_id:b}){try{const E=p(r);const h=p(u);let w={email:t.email===""?null:t.email||null,first_name:t.firstName,last_name:t.lastName,country_id:t.countryId===""?null:t.countryId,city:null,mobile:t.contactNumber===null?"":t.contactNumber,phone_prefix:null,address:"",dob:null,subscribe_to_news_letter:t.emailGuest||false,cci:t.cardNumber?{nbr:t.cardNumber,holder_name:t.cardHolderName,expiry_month:t.expiryMonth,expiry_year:t.expiryYear}:null};if(y){w={...y,email:y.email===""?null:y.email}}if(t.id){w={...w,id:t.id}}const g={assign_units:true,check_in:e,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,extras:o,booking:{booking_nbr:m||"",from_date:E,to_date:h,remark:t.message||null,property:{id:s},source:l,currency:n,arrival:{code:d?d:t.selectedArrivalTime},guest:w,rooms:[...a.map((t=>({identifier:f||null,roomtype:{id:t.roomCategoryId,name:t.roomCategoryName,physicalrooms:null,rateplans:null,availabilities:null,inventory:t.inventory,rate:t.rate/_},rateplan:{id:t.ratePlanId,name:t.ratePlanName,rate_restrictions:null,variations:null,cancelation:t.cancelation,guarantee:t.guarantee},unit:typeof b==="undefined"&&t.roomId===""?null:{id:+b||+t.roomId},occupancy:{adult_nbr:t.adultCount,children_nbr:t.childrenCount,infant_nbr:null},bed_preference:t.preference,from_date:E,to_date:h,notes:null,days:this.generateDays(E,h,this.calculateTotalRate(t.rate,_,t.isRateModified,t.rateType)),guest:{email:null,first_name:t.guestName,last_name:null,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null}}))),...c]},pickup_info:i};console.log("book user payload",g)}catch(t){console.error(t);throw new Error(t)}}async getRoomsToCheckIn(e){const n=at.parse(e);const{data:o}=await t.post("https://gateway.igloorooms.com/IRBE/Get_Rooms_To_Check_In",n);return{bookings:o.My_Result,total_count:o.My_Params_Get_Rooms_To_Check_In?.total_count}}async getRoomsToCheckout(e){const n=it.parse(e);const{data:o}=await t.post("https://gateway.igloorooms.com/IRBE/Get_Rooms_To_Check_Out",n);return{bookings:o.My_Result,total_count:o.My_Params_Get_Rooms_To_Check_Out?.total_count}}async getBookingInvoiceInfo(e){const n=st.parse(e);const{data:o}=await t.post("/Get_Booking_Invoice_Info",n);return kt.parse(o.My_Result)}async issueInvoice(e){const n=ut.parse(e);const{data:o}=await t.post("/Issue_Invoice",n);return o}async voidInvoice(e){const n=ct.parse(e);const{data:o}=await t.post("/Void_Invoice",n);return o}async printInvoice(e){const n=_t.parse(e);const{data:o}=await t.post("/Print_Invoice",n);return o}}export{vt as B,S as V,k as Z,Z as a,D as b,z as c,C as d,Y as e,W as f,X as g,U as h,K as i,x as j,A as k,M as l,$ as m,j as n,F as o,R as r,O as s,L as u};
//# sourceMappingURL=p-ae6a57a8.js.map