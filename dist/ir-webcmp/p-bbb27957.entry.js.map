{"version":3,"names":["hostCss","IrDeparturesStyle0","appCss","IrDeparturesStyle1","irDeparturesCss","IrDeparturesStyle2","IrDepartures","ticket","propertyid","language","p","bookingNumber","booking","paymentEntries","isPageLoading","payment","tokenService","Token","roomService","RoomService","bookingService","BookingService","paymentFolioRef","componentWillLoad","this","setToken","init","handleTicketChange","newValue","oldValue","handleOpen","e","detail","handleBookingPayment","stopImmediatePropagation","stopPropagation","booking_nbr","departuresStore","bookings","find","b","openFolio","_","__","setupEntries","Promise","all","getExposedProperty","id","aname","fetchLanguage","getSetupEntriesByTableNameMulti","pay_type","pay_type_group","pay_method","groupEntryTablesResult","types","groups","methods","error","render","h","Host","style","display","class","onDrawerHide","withoutHeader","open","hasPrint","hasReceipt","hasCloseButton","onCloseSidebar","is_from_front_desk","hasRoomEdit","hasRoomDelete","toString","hasRoomAdd","height","mode","ref","el","onCloseModal"],"sources":["src/assets/webawesome/component/host.css?tag=ir-departures&encapsulation=scoped","src/global/app.css?tag=ir-departures&encapsulation=scoped","src/components/ir-departures/ir-departures.css?tag=ir-departures&encapsulation=scoped","src/components/ir-departures/ir-departures.tsx"],"sourcesContent":[":host {\n  box-sizing: border-box !important;\n}\n\n:host *,\n:host *::before,\n:host *::after {\n  box-sizing: inherit !important;\n  padding: 0;\n  margin: 0;\n}\n\n[hidden] {\n  display: none !important;\n}\n","/* Web Awesome core styles */\n/* @import url('../assets/webawesome/themes/webawesome.css'); */\n@import url('../assets/webawesome/themes/default.css');\n/* Place project-wide overrides below. */\n.my-custom-style {\n  background: #000;\n  color: white;\n}\n.ir-price {\n  font-family: inherit;\n  font-size: 1rem;\n  font-weight: 800;\n  color: var(--ir-price-color, #1a1a1a);\n  text-align: right;\n  white-space: nowrap;\n}\n.page-title {\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-xl);\n}\n\n:host {\n  --wa-form-control-required-content-color: var(--wa-color-danger-border-loud, #f3676c);\n  padding: var(--wa-space-l);\n}\n/* td {\n  padding: 0 !important;\n} */\n.label-on-left {\n  display: grid;\n  gap: var(--wa-space-m);\n}\nwa-card::part(base) {\n  box-sizing: border-box;\n}\nwa-input[aria-invalid='true']::part(base),\nwa-select[aria-invalid='true']::part(combobox) {\n  border-color: var(--wa-color-danger-border-loud);\n  outline-color: var(--wa-color-danger-border-loud);\n  border-width: 2px;\n}\n\n/* Shared layout for form controls inside wa-select, wa-input, wa-textarea */\n@media (min-width: 768px) {\n  /* .label-on-left wa-switch::part(label) {\n    margin-inline-start: 0;\n    margin-inline-end: 0.5rem;\n  } */\n  .label-on-left {\n    align-items: center;\n    grid-template-columns: auto 1fr;\n  }\n  .label-on-left wa-switch::part(base),\n  .label-on-left wa-select::part(form-control),\n  .label-on-left wa-select,\n  .label-on-left wa-switch,\n  .label-on-left wa-input,\n  .label-on-left wa-textarea {\n    grid-column: 1 / -1;\n    grid-row-end: span 2;\n    display: grid;\n    grid-template-columns: subgrid;\n    gap: 0 var(--wa-space-l);\n    align-items: center;\n  }\n  .label-on-left wa-switch::part(base) {\n    direction: rtl;\n  }\n  .label-on-left wa-switch::part(base) > * {\n    justify-self: flex-start;\n    justify-content: flex-start;\n    direction: ltr; /* fix text direction */\n  }\n  /* Label alignment */\n  .label-on-left ::part(label) {\n    justify-content: flex-end;\n  }\n\n  /* Hint always in second column */\n  .label-on-left ::part(hint) {\n    grid-column: 2;\n  }\n}\n",":host {\n  /* background-color: white; */\n  display: flex;\n  flex-direction: column;\n  gap: var(--wa-space-l, 1.5rem);\n  min-height: 100vh;\n}\n.page-title {\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-xl);\n  /* margin-bottom: 1rem; */\n}\n","import { Booking } from '@/models/booking.dto';\nimport Token from '@/models/Token';\nimport { departuresStore } from '@/stores/departures.store';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { Payment, PaymentEntries } from '../ir-booking-details/types';\nimport { RoomService } from '@/services/room.service';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-departures',\n  styleUrls: ['../../assets/webawesome/component/host.css', '../../global/app.css', 'ir-departures.css'],\n  scoped: true,\n})\nexport class IrDepartures {\n  @Prop() ticket: string;\n  @Prop() propertyid: number;\n  @Prop() language: string = 'en';\n  @Prop() p: string;\n\n  @State() bookingNumber: number;\n  @State() booking: Booking;\n  @State() paymentEntries: PaymentEntries;\n  @State() isPageLoading: boolean;\n  @State() payment: Payment;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private bookingService = new BookingService();\n\n  private paymentFolioRef: HTMLIrPaymentFolioElement;\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue && newValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Listen('openBookingDetails')\n  handleOpen(e: CustomEvent) {\n    this.bookingNumber = e.detail;\n  }\n\n  @Listen('payBookingBalance')\n  handleBookingPayment(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { booking_nbr, payment } = e.detail;\n    this.booking = departuresStore.bookings.find(b => b.booking_nbr === booking_nbr);\n    this.payment = payment;\n    this.paymentFolioRef.openFolio();\n  }\n\n  private async init() {\n    try {\n      this.isPageLoading = true;\n      const [_, __, setupEntries] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getSetupEntriesByTableNameMulti(['_BED_PREFERENCE_TYPE', '_DEPARTURE_TIME', '_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n      ]);\n\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n\n      this.paymentEntries = { types: pay_type, groups: pay_type_group, methods: pay_method };\n    } catch (error) {\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast style={{ display: 'none' }}></ir-toast>\n        <ir-interceptor style={{ display: 'none' }}></ir-interceptor>\n        <h3 class=\"page-title\">Departures</h3>\n        <ir-departures-filter></ir-departures-filter>\n        <ir-departures-table></ir-departures-table>\n        <ir-drawer\n          onDrawerHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.bookingNumber = null;\n          }}\n          withoutHeader\n          open={!!this.bookingNumber}\n          style={{\n            '--ir-drawer-width': '80rem',\n            '--ir-drawer-background-color': '#F2F3F8',\n            '--ir-drawer-padding-left': '0',\n            '--ir-drawer-padding-right': '0',\n            '--ir-drawer-padding-top': '0',\n            '--ir-drawer-padding-bottom': '0',\n          }}\n        >\n          {this.bookingNumber && (\n            <ir-booking-details\n              hasPrint\n              hasReceipt\n              hasCloseButton\n              onCloseSidebar={() => (this.bookingNumber = null)}\n              is_from_front_desk\n              propertyid={this.propertyid as any}\n              hasRoomEdit\n              hasRoomDelete\n              bookingNumber={this.bookingNumber.toString()}\n              ticket={this.ticket}\n              language={this.language}\n              hasRoomAdd\n            ></ir-booking-details>\n          )}\n        </ir-drawer>\n        <ir-payment-folio\n          style={{ height: 'auto' }}\n          bookingNumber={this.booking?.booking_nbr}\n          paymentEntries={this.paymentEntries}\n          payment={this.payment}\n          mode={'payment-action'}\n          ref={el => (this.paymentFolioRef = el)}\n          onCloseModal={() => {\n            this.booking = null;\n            this.payment = null;\n          }}\n        ></ir-payment-folio>\n      </Host>\n    );\n  }\n}\n"],"mappings":"kYAAA,MAAMA,EAAU,+RAChB,MAAAC,EAAeD,ECDf,MAAME,EAAS,yn2DACf,MAAAC,EAAeD,ECDf,MAAME,EAAkB,yTACxB,MAAAC,EAAeD,E,MCYFE,EAAY,M,yBACfC,OACAC,WACAC,SAAmB,KACnBC,EAECC,cACAC,QACAC,eACAC,cACAC,QAEDC,aAAe,IAAIC,EACnBC,YAAc,IAAIC,EAClBC,eAAiB,IAAIC,EAErBC,gBAER,iBAAAC,GACE,GAAIC,KAAKjB,OAAQ,CACfiB,KAAKR,aAAaS,SAASD,KAAKjB,QAChCiB,KAAKE,M,EAKT,kBAAAC,CAAmBC,EAAkBC,GACnC,GAAID,IAAaC,GAAYD,EAAU,CACrCJ,KAAKR,aAAaS,SAASD,KAAKjB,QAChCiB,KAAKE,M,EAKT,UAAAI,CAAWC,GACTP,KAAKb,cAAgBoB,EAAEC,M,CAIzB,oBAAAC,CAAqBF,GACnBA,EAAEG,2BACFH,EAAEI,kBACF,MAAMC,YAAEA,EAAWrB,QAAEA,GAAYgB,EAAEC,OACnCR,KAAKZ,QAAUyB,EAAgBC,SAASC,MAAKC,GAAKA,EAAEJ,cAAgBA,IACpEZ,KAAKT,QAAUA,EACfS,KAAKF,gBAAgBmB,W,CAGf,UAAMf,GACZ,IACEF,KAAKV,cAAgB,KACrB,MAAO4B,EAAGC,EAAIC,SAAsBC,QAAQC,IAAI,CAC9CtB,KAAKN,YAAY6B,mBAAmB,CAAEC,GAAIxB,KAAKhB,YAAc,EAAGC,SAAUe,KAAKf,SAAUwC,MAAOzB,KAAKd,IACrGc,KAAKN,YAAYgC,cAAc1B,KAAKf,UACpCe,KAAKJ,eAAe+B,gCAAgC,CAAC,uBAAwB,kBAAmB,YAAa,kBAAmB,kBAGlI,MAAMC,SAAEA,EAAQC,eAAEA,EAAcC,WAAEA,GAAe9B,KAAKJ,eAAemC,uBAAuBX,GAE5FpB,KAAKX,eAAiB,CAAE2C,MAAOJ,EAAUK,OAAQJ,EAAgBK,QAASJ,E,CAC1E,MAAOK,G,SAEPnC,KAAKV,cAAgB,K,EAIzB,MAAA8C,GACE,GAAIpC,KAAKV,cAAe,CACtB,OAAO+C,EAAA,yB,CAET,OACEA,EAACC,EAAI,KACHD,EAAA,YAAUE,MAAO,CAAEC,QAAS,UAC5BH,EAAA,kBAAgBE,MAAO,CAAEC,QAAS,UAClCH,EAAA,MAAII,MAAM,cAAY,cACtBJ,EAAA,6BACAA,EAAA,4BACAA,EAAA,aACEK,aAAcnC,IACZA,EAAEG,2BACFH,EAAEI,kBACFX,KAAKb,cAAgB,IAAI,EAE3BwD,cAAa,KACbC,OAAQ5C,KAAKb,cACboD,MAAO,CACL,oBAAqB,QACrB,+BAAgC,UAChC,2BAA4B,IAC5B,4BAA6B,IAC7B,0BAA2B,IAC3B,6BAA8B,MAG/BvC,KAAKb,eACJkD,EAAA,sBACEQ,SAAQ,KACRC,WAAU,KACVC,eAAc,KACdC,eAAgB,IAAOhD,KAAKb,cAAgB,KAC5C8D,mBAAkB,KAClBjE,WAAYgB,KAAKhB,WACjBkE,YAAW,KACXC,cAAa,KACbhE,cAAea,KAAKb,cAAciE,WAClCrE,OAAQiB,KAAKjB,OACbE,SAAUe,KAAKf,SACfoE,WAAU,QAIhBhB,EAAA,oBACEE,MAAO,CAAEe,OAAQ,QACjBnE,cAAea,KAAKZ,SAASwB,YAC7BvB,eAAgBW,KAAKX,eACrBE,QAASS,KAAKT,QACdgE,KAAM,iBACNC,IAAKC,GAAOzD,KAAKF,gBAAkB2D,EACnCC,aAAc,KACZ1D,KAAKZ,QAAU,KACfY,KAAKT,QAAU,IAAI,I","ignoreList":[]}