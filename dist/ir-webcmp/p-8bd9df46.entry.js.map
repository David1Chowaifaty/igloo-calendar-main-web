{"version":3,"names":["irInvoiceCss","IrInvoiceStyle0","IrInvoice","open","booking","mode","for","roomIdentifier","autoPrint","selectedRecipient","invoiceOpen","invoiceClose","invoiceCreated","invoiceFormRef","room","componentWillLoad","this","guest","id","toString","rooms","find","r","identifier","handleBookingChange","openDrawer","emit","closeDrawer","reset","handleConfirmInvoice","isProforma","recipientId","getMinDate","to_date","getMinCheckoutDate","minDate","moment","d","isBefore","clone","format","getMaxDate","computeRoomGroups","indexById","Map","forEach","idx","set","length","groups","hasSplitGroups","groupSortKey","groupRooms","min","Number","MAX_SAFE_INTEGER","ts","Date","parse","from_date","isNaN","Math","splitIndex","buildSplitIndex","sortedRooms","sort","a","b","diff","get","order","isSplit","sortKey","roomsById","map","grouped","visited","Set","head","heads","chain","chainOf","chainRooms","filter","Boolean","chainHasSplitLink","some","parent","parentOf","children","childrenOf","is_split","add","push","has","singleGroup","group","merged","reduce","acc","curr","concat","renderRooms","h","class","key","checked","roomtype","name","rateplan","short_name","formatAmount","gross_total","style","gap","render","Host","label","onDrawerHide","e","stopImmediatePropagation","stopPropagation","ref","el","date","maxDate","onRecipientChange","detail","pickup_info","extra_services","extra_service","system_id","slot","size","appearance","variant","onClickHandler"],"sources":["src/components/ir-invoice/ir-invoice.css?tag=ir-invoice&encapsulation=scoped","src/components/ir-invoice/ir-invoice.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n.ir-invoice__container {\n  display: grid;\n  gap: var(--wa-space-l);\n  box-sizing: border-box;\n}\n.ir-invoice__service:last-child {\n  border-bottom-left-radius: var(--wa-border-radius-m);\n  border-bottom-right-radius: var(--wa-border-radius-m);\n}\n.ir-invoice__service:first-child {\n  border-top-left-radius: var(--wa-border-radius-m);\n  border-top-right-radius: var(--wa-border-radius-m);\n  border-top: var(--wa-form-control-border-width) var(--wa-form-control-border-style) var(--wa-form-control-border-color);\n}\n.ir-invoice__service {\n  border-bottom: var(--wa-form-control-border-width) var(--wa-form-control-border-style) var(--wa-form-control-border-color);\n  border-left: var(--wa-form-control-border-width) var(--wa-form-control-border-style) var(--wa-form-control-border-color);\n  border-right: var(--wa-form-control-border-width) var(--wa-form-control-border-style) var(--wa-form-control-border-color);\n  background-color: var(--wa-color-surface-default);\n  /* border-radius: var(--wa-border-radius-m); */\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  width: 100%;\n}\n.ir-invoice__service:hover {\n  background-color: color-mix(in srgb, var(--wa-color-surface-default) 95%, var(--wa-color-mix-hover));\n}\n.ir-invoice__checkbox,\n.ir-invoice__checkbox::part(base) {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  box-sizing: border-box;\n}\n.ir-invoice__checkbox::part(base) {\n  min-height: var(--wa-form-control-height);\n  padding: 0 var(--wa-form-control-padding-inline);\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  width: 100%;\n}\n.ir-invoice__checkbox.group::part(base) {\n  padding-block: 1rem;\n  align-items: flex-start;\n}\n.ir-invoice__room-checkbox-container {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.ir-invoice__room-checkbox-container.group {\n  flex-direction: column;\n}\n.ir-invoice__checkbox-price {\n  font-weight: 700;\n  color: var(--wa-color-neutral-900);\n  white-space: nowrap;\n  text-align: right;\n  flex: 1 1 0%;\n}\n.ir-invoice__form-control-label {\n  display: inline-flex;\n  color: var(--wa-form-control-label-color);\n  font-weight: var(--wa-form-control-label-font-weight);\n  line-height: var(--wa-form-control-label-line-height);\n  margin-block-end: 0.5em;\n}\n","import { Booking, Room } from '@/models/booking.dto';\nimport { buildSplitIndex } from '@/utils/booking';\nimport { formatAmount } from '@/utils/utils';\nimport { Component, Event, EventEmitter, Host, Method, Prop, State, Watch, h } from '@stencil/core';\nimport moment from 'moment';\n\n@Component({\n  tag: 'ir-invoice',\n  styleUrls: ['ir-invoice.css'],\n  scoped: true,\n})\nexport class IrInvoice {\n  /**\n   * Whether the invoice drawer is open.\n   *\n   * This prop is mutable and reflected to the host element,\n   * allowing parent components to control visibility via markup\n   * or via the public `openDrawer()` / `closeDrawer()` methods.\n   */\n  @Prop({ mutable: true, reflect: true }) open: boolean;\n\n  /**\n   * The booking object for which the invoice is being generated.\n   * Should contain room, guest, and pricing information.\n   */\n  @Prop() booking: Booking;\n\n  /**\n   * Determines what should happen after creating the invoice.\n   * - `\"create\"`: create an invoice normally\n   * - `\"check_in-create\"`: create an invoice as part of the check-in flow\n   */\n  @Prop() mode: 'create' | 'check_in-create' = 'create';\n\n  /**\n   * Specifies what the invoice is for.\n   * - `\"room\"`: invoice for a specific room\n   * - `\"booking\"`: invoice for the entire booking\n   */\n  @Prop() for: 'room' | 'booking' = 'booking';\n\n  /**\n   * The identifier of the room for which the invoice is being generated.\n   * Used when invoicing at room level instead of booking level.\n   */\n  @Prop() roomIdentifier: string;\n\n  /**\n   * When `true`, automatically triggers `window.print()` after an invoice is created.\n   * Useful for setups where the invoice should immediately be sent to a printer.\n   */\n  @Prop() autoPrint: boolean = false;\n\n  @State() selectedRecipient: string;\n\n  /**\n   * Emitted when the invoice drawer is opened.\n   *\n   * Fired when `openDrawer()` is called and the component\n   * transitions into the open state.\n   */\n  @Event() invoiceOpen: EventEmitter<void>;\n\n  /**\n   * Emitted when the invoice drawer is closed.\n   *\n   * Fired when `closeDrawer()` is called, including when the\n   * underlying drawer emits `onDrawerHide`.\n   */\n  @Event() invoiceClose: EventEmitter<void>;\n\n  /**\n   * Emitted when an invoice is created/confirmed.\n   *\n   * The event `detail` contains:\n   * - `booking`: the booking associated with the invoice\n   * - `recipientId`: the selected billing recipient\n   * - `for`: whether the invoice is for `\"room\"` or `\"booking\"`\n   * - `roomIdentifier`: the room identifier when invoicing a specific room\n   * - `mode`: the current invoice mode\n   */\n  @Event() invoiceCreated: EventEmitter<{\n    booking: Booking;\n    recipientId: string;\n    for: 'room' | 'booking';\n    roomIdentifier?: string;\n    mode: 'create' | 'check_in-create';\n  }>;\n\n  private invoiceFormRef: HTMLFormElement;\n  private room: Booking['rooms'][0];\n\n  componentWillLoad() {\n    if (this.booking) {\n      this.selectedRecipient = this.booking.guest.id.toString();\n      if (this.for === 'room' && this.roomIdentifier) {\n        this.room = this.booking.rooms.find(r => r.identifier === this.roomIdentifier);\n      }\n    }\n  }\n\n  @Watch('booking')\n  handleBookingChange() {\n    if (this.booking) {\n      this.selectedRecipient = this.booking.guest.id.toString();\n      if (this.for === 'room' && this.roomIdentifier) {\n        this.room = this.booking.rooms.find(r => r.identifier === this.roomIdentifier);\n      }\n    }\n  }\n\n  /**\n   * Opens the invoice drawer.\n   *\n   * This method sets the `open` property to `true`, making the drawer visible.\n   * It can be called programmatically by parent components.\n   *\n   * Also emits the `invoiceOpen` event.\n   *\n   * @returns {Promise<void>} Resolves once the drawer state is updated.\n   */\n  @Method()\n  async openDrawer(): Promise<void> {\n    this.open = true;\n    this.invoiceOpen.emit();\n  }\n\n  /**\n   * Closes the invoice drawer.\n   *\n   * This method sets the `open` property to `false`, hiding the drawer.\n   * Parent components can call this to close the drawer programmatically,\n   * and it is also used internally when the drawer emits `onDrawerHide`.\n   *\n   * Also emits the `invoiceClose` event.\n   *\n   * @returns {Promise<void>} Resolves once the drawer state is updated.\n   */\n  @Method()\n  async closeDrawer(): Promise<void> {\n    this.open = false;\n    this.invoiceFormRef.reset();\n    this.selectedRecipient = this.booking?.guest?.id?.toString();\n    this.invoiceClose.emit();\n  }\n\n  /**\n   * Handles confirming/creating the invoice.\n   *\n   * Emits the `invoiceCreated` event with invoice context, and if\n   * `autoPrint` is `true`, triggers `window.print()` afterwards.\n   */\n  private handleConfirmInvoice(isProforma: boolean = false) {\n    if (!isProforma)\n      this.invoiceCreated.emit({\n        booking: this.booking,\n        recipientId: this.selectedRecipient,\n        for: this.for,\n        roomIdentifier: this.roomIdentifier,\n        mode: this.mode,\n      });\n\n    if (this.autoPrint) {\n      try {\n        // window.print();\n      } catch (error) {\n        // Fail silently but log for debugging\n        console.error('Auto print failed:', error);\n      }\n    }\n  }\n  private getMinDate() {\n    if (this.for === 'room') {\n      return this.room.to_date;\n    }\n    const getMinCheckoutDate = () => {\n      let minDate = moment();\n      for (const room of this.booking.rooms) {\n        const d = moment(room.to_date, 'YYYY-MM-DD');\n        if (d.isBefore(minDate)) {\n          minDate = d.clone();\n        }\n      }\n      return minDate;\n    };\n\n    return getMinCheckoutDate().format('YYYY-MM-DD');\n  }\n\n  private getMaxDate() {\n    return moment().format('YYYY-MM-DD');\n  }\n  private computeRoomGroups(rooms: Room[]) {\n    const indexById = new Map<string, number>();\n    rooms.forEach((room, idx) => indexById.set(room.identifier, idx));\n\n    if (!rooms.length) {\n      return { groups: [], indexById, hasSplitGroups: false };\n    }\n\n    const groupSortKey = (groupRooms: Room[]) => {\n      let min = Number.MAX_SAFE_INTEGER;\n      for (const r of groupRooms) {\n        const ts = Date.parse(r?.from_date ?? '');\n        if (!Number.isNaN(ts)) {\n          min = Math.min(min, ts);\n        }\n      }\n      return min;\n    };\n\n    const splitIndex = buildSplitIndex(rooms);\n    if (!splitIndex) {\n      const sortedRooms = [...rooms].sort((a, b) => {\n        const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n        if (!Number.isNaN(diff) && diff !== 0) {\n          return diff;\n        }\n        return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n      });\n      return { groups: [{ rooms: sortedRooms, order: 0, isSplit: false, sortKey: groupSortKey(sortedRooms) }], indexById, hasSplitGroups: false };\n    }\n\n    const roomsById = new Map<string, Room>(rooms.map(room => [room.identifier, room]));\n    const grouped: { rooms: Room[]; order: number; sortKey: number; isSplit: boolean }[] = [];\n    const visited = new Set<string>();\n\n    for (const head of splitIndex.heads) {\n      const chain = splitIndex.chainOf.get(head) ?? [head];\n      const chainRooms = chain.map(id => roomsById.get(id)).filter((room): room is Room => Boolean(room));\n      if (!chainRooms.length) continue;\n\n      const chainHasSplitLink =\n        chain.some(id => {\n          const parent = splitIndex.parentOf.get(id);\n          const children = splitIndex.childrenOf.get(id) ?? [];\n          return Boolean(parent) || children.length > 0;\n        }) || chainRooms.some(room => Boolean(room?.is_split));\n\n      if (chainHasSplitLink) {\n        chainRooms.forEach(room => visited.add(room.identifier));\n        const order = Math.min(...chainRooms.map(room => indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER));\n        grouped.push({ rooms: chainRooms, order, sortKey: groupSortKey(chainRooms), isSplit: true });\n      }\n    }\n\n    for (const room of rooms) {\n      if (!visited.has(room.identifier)) {\n        const order = indexById.get(room.identifier) ?? Number.MAX_SAFE_INTEGER;\n        const singleGroup = [room];\n        grouped.push({ rooms: singleGroup, order, sortKey: groupSortKey(singleGroup), isSplit: false });\n      }\n    }\n\n    grouped.sort((a, b) => {\n      if (a.sortKey !== b.sortKey) {\n        return a.sortKey - b.sortKey;\n      }\n      return a.order - b.order;\n    });\n    const hasSplitGroups = grouped.some(group => group.isSplit);\n\n    if (!hasSplitGroups) {\n      const merged = grouped\n        .map(group => group.rooms)\n        .reduce<Room[]>((acc, curr) => acc.concat(curr), [])\n        .sort((a, b) => {\n          const diff = Date.parse(a?.from_date ?? '') - Date.parse(b?.from_date ?? '');\n          if (!Number.isNaN(diff) && diff !== 0) {\n            return diff;\n          }\n          return (indexById.get(a.identifier) ?? 0) - (indexById.get(b.identifier) ?? 0);\n        });\n      return { groups: [{ rooms: merged, order: 0, sortKey: groupSortKey(merged), isSplit: false }], indexById, hasSplitGroups: false };\n    }\n\n    return { groups: grouped, indexById, hasSplitGroups: true };\n  }\n  private renderRooms() {\n    const rooms = this.booking?.rooms ?? [];\n    if (!rooms.length) {\n      return null;\n    }\n\n    const { groups, hasSplitGroups } = this.computeRoomGroups(rooms);\n\n    if (!hasSplitGroups) {\n      const groupRooms = groups[0].rooms;\n      return groupRooms.map(room => (\n        <div class=\"ir-invoice__service\" key={room.identifier}>\n          <wa-checkbox class=\"ir-invoice__checkbox\" checked>\n            <div class={'ir-invoice__room-checkbox-container'}>\n              <b>{room.roomtype.name}</b>\n              <span>{room.rateplan.short_name}</span>\n              <span class=\"ir-invoice__checkbox-price\">{formatAmount('$US', room.gross_total)}</span>\n            </div>\n          </wa-checkbox>\n        </div>\n\n        // {this.renderRoomItem(room, indexById.get(room.identifier) ?? idx)}\n        // {idx < groupRooms.length - 1 ? <wa-divider></wa-divider> : null}\n      ));\n    }\n    return groups.map(group => (\n      <div class=\"ir-invoice__service\" key={group.order}>\n        <wa-checkbox class=\"ir-invoice__checkbox group\" checked>\n          <div class={'ir-invoice__room-checkbox-container group'}>\n            {group.rooms.map(room => {\n              return (\n                <div class=\"d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n                  <b>{room.roomtype.name}</b>\n                  <span>{room.rateplan.short_name}</span>\n                  <span class=\"ir-invoice__checkbox-price\">{formatAmount('$US', room.gross_total)}</span>\n                </div>\n              );\n            })}\n          </div>\n        </wa-checkbox>\n      </div>\n    ));\n  }\n\n  render() {\n    return (\n      <Host>\n        <ir-drawer\n          label=\"Invoice\"\n          open={this.open}\n          onDrawerHide={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.closeDrawer();\n          }}\n        >\n          <form ref={el => (this.invoiceFormRef = el)} class=\"ir-invoice__container\">\n            <ir-custom-date-picker label=\"Date\" date={moment().format('YYYY-MM-DD')} minDate={this.getMinDate()} maxDate={this.getMaxDate()}></ir-custom-date-picker>\n            <ir-booking-billing-recipient onRecipientChange={e => (this.selectedRecipient = e.detail)} booking={this.booking}></ir-booking-billing-recipient>\n            <div class={'ir-invoice__services'}>\n              <p class=\"ir-invoice__form-control-label\">Choose what to invoice</p>\n              <div class=\"ir-invoice__services-container\">\n                {this.renderRooms()}\n                {this.booking.pickup_info && (\n                  <div class=\"ir-invoice__service\">\n                    <wa-checkbox class=\"ir-invoice__checkbox\">\n                      <div>Pickup</div>\n                    </wa-checkbox>\n                  </div>\n                )}\n                {this.booking.extra_services?.map(extra_service => (\n                  <div key={extra_service.system_id} class=\"ir-invoice__service\">\n                    <wa-checkbox class=\"ir-invoice__checkbox\">\n                      <div></div>\n                    </wa-checkbox>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </form>\n          <div slot=\"footer\" class=\"ir__drawer-footer\">\n            <ir-custom-button\n              size=\"medium\"\n              appearance=\"filled\"\n              class=\"w-100 flex-fill\"\n              variant=\"neutral\"\n              onClickHandler={() => {\n                this.closeDrawer();\n              }}\n            >\n              Cancel\n            </ir-custom-button>\n            <ir-custom-button\n              onClickHandler={() => {\n                this.handleConfirmInvoice(true);\n              }}\n              size=\"medium\"\n              class=\"w-100 flex-fill\"\n              appearance=\"outlined\"\n              variant=\"brand\"\n            >\n              Pro-forma invoice\n            </ir-custom-button>\n            <ir-custom-button\n              onClickHandler={() => {\n                this.handleConfirmInvoice();\n              }}\n              class=\"w-100 flex-fill\"\n              size=\"medium\"\n              variant=\"brand\"\n            >\n              Confirm invoice\n            </ir-custom-button>\n          </div>\n        </ir-drawer>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}