{"version":3,"names":["initialState","channels","selectedChannel","mappedChannels","connected_channels","isConnectedToChannel","channel_settings","property_id","channel_id","is_active","state","channels_data","onChange","onChannelChange","dispose","createStore","setChannelIdAndActiveState","id","selectChannel","find","c","toString","name","properties","setMappedChannel","updateChannelSettings","key","value","hotel_id","hotel_title","selectedChannelMap","channel","map","resetStore","addMapping","ir_id","fr_id","isRoomType","push","type","testConnection","hotelConnection","property","length","_a"],"sources":["src/stores/channel.store.ts"],"sourcesContent":["import { IChannel, IExposedChannel, IMap } from '@/models/calendarData';\nimport { createStore } from '@stencil/store';\nexport interface IChannelSettings {\n  hotel_id: string;\n  hotel_title: string;\n}\nexport interface IChannelStore {\n  channels: IExposedChannel[];\n  connected_channels: IChannel[];\n  selectedChannel: IExposedChannel | null;\n  mappedChannels: IMap[];\n  isConnectedToChannel: boolean;\n  channel_settings: IChannelSettings | null;\n  property_id: number | null;\n  channel_id: number;\n  is_active: boolean;\n}\nconst initialState: IChannelStore = {\n  channels: [],\n  selectedChannel: null,\n  mappedChannels: [],\n  connected_channels: [],\n  isConnectedToChannel: false,\n  channel_settings: null,\n  property_id: null,\n  channel_id: -1,\n  is_active: false,\n};\nexport const { state: channels_data, onChange: onChannelChange, dispose } = createStore<IChannelStore>(initialState);\nexport function setChannelIdAndActiveState(id: number, is_active: boolean) {\n  channels_data.channel_id = id;\n  channels_data.is_active = is_active;\n}\nexport function selectChannel(channel_id: string) {\n  if (channel_id === '') {\n    channels_data.selectedChannel = null;\n    return;\n  }\n  const selectedChannel = channels_data.channels.find(c => c.id.toString() === channel_id);\n  if (selectedChannel) {\n    channels_data.selectedChannel = selectedChannel;\n  } else {\n    channels_data.selectedChannel = {\n      id: channel_id,\n      name: '',\n      properties: [],\n    };\n  }\n  setMappedChannel();\n}\nexport function updateChannelSettings(key: keyof IChannelSettings, value: string) {\n  if (!channels_data.channel_settings) {\n    channels_data.channel_settings = {\n      hotel_id: '',\n      hotel_title: '',\n    };\n  }\n  channels_data.channel_settings[key] = value;\n}\nexport function setMappedChannel() {\n  let selectedChannelMap = channels_data.connected_channels.find(c => c.channel.id.toString() === channels_data.selectedChannel.id.toString());\n  if (!selectedChannelMap) {\n    channels_data.mappedChannels = [];\n    return;\n  }\n  channels_data.mappedChannels = [...selectedChannelMap.map];\n}\nexport function resetStore() {\n  channels_data.selectedChannel = null;\n  channels_data.mappedChannels = [];\n  channels_data.isConnectedToChannel = false;\n  channels_data.channel_settings = null;\n}\nexport function addMapping(ir_id: string, fr_id: string, isRoomType: boolean) {\n  channels_data.mappedChannels.push({\n    channel_id: fr_id,\n    ir_id,\n    type: isRoomType ? 'room_type' : 'rate_plan',\n  });\n}\nexport function testConnection() {\n  // const hotelConnection = channels_data.selectedChannel.properties.find(property => property.id === 'd09e6374-1ebf-45e0-a130-64c8c9930987');\n  const hotelConnection = channels_data.selectedChannel.properties.find(property => property.id === channels_data.channel_settings.hotel_id);\n  if (!hotelConnection) {\n    if (channels_data.isConnectedToChannel) {\n      channels_data.isConnectedToChannel = false;\n    }\n    return false;\n  }\n  channels_data.selectedChannel.property = hotelConnection;\n  if (channels_data.mappedChannels.length === 0) {\n    channels_data.mappedChannels.push({ ir_id: (channels_data.property_id ?? -1).toString(), channel_id: channels_data.channel_settings.hotel_id, type: 'property' });\n  }\n  channels_data.isConnectedToChannel = true;\n  return true;\n}\n\nexport function saveChannel() {\n  console.log(channels_data.channel_settings, channels_data.mappedChannels, channels_data.selectedChannel);\n}\nexport default channels_data;\n"],"mappings":"oCAiBA,MAAMA,EAA8B,CAClCC,SAAU,GACVC,gBAAiB,KACjBC,eAAgB,GAChBC,mBAAoB,GACpBC,qBAAsB,MACtBC,iBAAkB,KAClBC,YAAa,KACbC,YAAa,EACbC,UAAW,O,MAEEC,MAAOC,EAAeC,SAAUC,EAAeC,QAAEA,GAAYC,EAA2Bf,G,SACvFgB,EAA2BC,EAAYR,GACrDE,EAAcH,WAAaS,EAC3BN,EAAcF,UAAYA,CAC5B,C,SACgBS,EAAcV,GAC5B,GAAIA,IAAe,GAAI,CACrBG,EAAcT,gBAAkB,KAChC,M,CAEF,MAAMA,EAAkBS,EAAcV,SAASkB,MAAKC,GAAKA,EAAEH,GAAGI,aAAeb,IAC7E,GAAIN,EAAiB,CACnBS,EAAcT,gBAAkBA,C,KAC3B,CACLS,EAAcT,gBAAkB,CAC9Be,GAAIT,EACJc,KAAM,GACNC,WAAY,G,CAGhBC,GACF,C,SACgBC,EAAsBC,EAA6BC,GACjE,IAAKhB,EAAcL,iBAAkB,CACnCK,EAAcL,iBAAmB,CAC/BsB,SAAU,GACVC,YAAa,G,CAGjBlB,EAAcL,iBAAiBoB,GAAOC,CACxC,C,SACgBH,IACd,IAAIM,EAAqBnB,EAAcP,mBAAmBe,MAAKC,GAAKA,EAAEW,QAAQd,GAAGI,aAAeV,EAAcT,gBAAgBe,GAAGI,aACjI,IAAKS,EAAoB,CACvBnB,EAAcR,eAAiB,GAC/B,M,CAEFQ,EAAcR,eAAiB,IAAI2B,EAAmBE,IACxD,C,SACgBC,IACdtB,EAAcT,gBAAkB,KAChCS,EAAcR,eAAiB,GAC/BQ,EAAcN,qBAAuB,MACrCM,EAAcL,iBAAmB,IACnC,C,SACgB4B,EAAWC,EAAeC,EAAeC,GACvD1B,EAAcR,eAAemC,KAAK,CAChC9B,WAAY4B,EACZD,QACAI,KAAMF,EAAa,YAAc,aAErC,C,SACgBG,I,MAEd,MAAMC,EAAkB9B,EAAcT,gBAAgBqB,WAAWJ,MAAKuB,GAAYA,EAASzB,KAAON,EAAcL,iBAAiBsB,WACjI,IAAKa,EAAiB,CACpB,GAAI9B,EAAcN,qBAAsB,CACtCM,EAAcN,qBAAuB,K,CAEvC,OAAO,K,CAETM,EAAcT,gBAAgBwC,SAAWD,EACzC,GAAI9B,EAAcR,eAAewC,SAAW,EAAG,CAC7ChC,EAAcR,eAAemC,KAAK,CAAEH,QAAQS,EAAAjC,EAAcJ,eAAW,MAAAqC,SAAA,EAAAA,GAAK,GAAGvB,WAAYb,WAAYG,EAAcL,iBAAiBsB,SAAUW,KAAM,Y,CAEtJ5B,EAAcN,qBAAuB,KACrC,OAAO,IACT,Q","ignoreList":[]}