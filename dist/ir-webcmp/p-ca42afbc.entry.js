import{r as t,c as i,h as o,H as s,g as e}from"./p-53d64953.js";import{v as h}from"./p-4ed69de7.js";const r=".sc-ir-m-combobox-h{position:relative;display:block}.dropdown.sc-ir-m-combobox{position:absolute;top:100%;left:0;z-index:1000;width:100%}.dropdown-menu.sc-ir-m-combobox{max-height:var(--ir-combobox-height, 200px);overflow-y:auto;min-width:100%;width:var(--ir-combobox-width, 100%) !important;scroll-behavior:smooth}.dropdown-item.loading.sc-ir-m-combobox,.dropdown-item.no-results.sc-ir-m-combobox{color:#6c757d;cursor:default;pointer-events:none}.dropdown-item.sc-ir-m-combobox{padding:0.5rem 1rem !important}.dropdown-item.active.sc-ir-m-combobox,.dropdown-item.focused.sc-ir-m-combobox{background-color:var(--blue, #1e9ff2) !important;color:white !important}[slot='dropdown-content'].sc-ir-m-combobox .dropdown-item.focused.sc-ir-m-combobox,[slot='dropdown-content'].sc-ir-m-combobox .dropdown-item.active.sc-ir-m-combobox{background-color:#1e9ff2 !important;color:white !important}[slot='dropdown-content'].sc-ir-m-combobox [data-option].focused.sc-ir-m-combobox,[slot='dropdown-content'].sc-ir-m-combobox [data-option].active.sc-ir-m-combobox{background-color:#1e9ff2 !important;color:white !important}";const n=r;const a=class{constructor(o){t(this,o);this.optionChange=i(this,"optionChange",7);this.searchQuery=i(this,"searchQuery",7);this.dataMode="static";this.options=[];this.debounceDelay=300;this.loading=false;this.useSlot=false;this.isOpen=false;this.focusedIndex=-1;this.filteredOptions=[];this.slotElements=[];this.id=h();this.dropdownId=`dropdown-${this.id}`;this.handleDocumentClick=t=>{if(!this.el.contains(t.target)){this.closeDropdown()}};this.handleKeyDown=t=>{const i=this.useSlot?this.slotElements.length-1:this.filteredOptions.length-1;switch(t.key){case"ArrowDown":t.preventDefault();if(!this.isOpen){this.openDropdown()}else{this.focusedIndex=Math.min(this.focusedIndex+1,i);if(this.useSlot){this.focusSlotElement(this.focusedIndex)}else{this.scrollToFocusedOption()}}break;case"ArrowUp":t.preventDefault();if(this.isOpen){this.focusedIndex=Math.max(this.focusedIndex-1,0);if(this.useSlot){this.focusSlotElement(this.focusedIndex)}else{this.scrollToFocusedOption()}}break;case"Enter":t.preventDefault();if(this.isOpen&&this.focusedIndex>=0){if(this.useSlot){this.selectSlotElement(this.focusedIndex)}else{this.selectOption(this.filteredOptions[this.focusedIndex])}}else if(!this.isOpen){this.openDropdown()}break;case"Escape":t.preventDefault();this.closeDropdown();break;case"Tab":if(this.isOpen){this.closeDropdown()}break}};this.handleInput=t=>{const i=t.target;const o=i.value;if(this.dataMode==="external"){this.emitSearchQuery(o)}else{const t=this.options.length>0?this.options:[];this.filteredOptions=o?t.filter((t=>t.label.toLowerCase().includes(o.toLowerCase()))):t}this.focusedIndex=-1;if(!this.isOpen){this.openDropdown()}}}async selectOptionFromSlot(t){this.selectOption(t)}watchOptionsChanged(t){this.filteredOptions=t||[];if(this.useSlot){this.updateSlotElements()}}watchUseSlotChanged(){if(this.useSlot){setTimeout((()=>this.updateSlotElements()),0)}}componentWillLoad(){this.initializeOptions()}componentDidLoad(){document.addEventListener("click",this.handleDocumentClick.bind(this));if(this.useSlot){setTimeout((()=>this.updateSlotElements()),0)}}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick.bind(this));if(this.debounceTimeout){clearTimeout(this.debounceTimeout)}}handleDocumentKeyDown(t){var i;if(!this.isOpen)return;if(t.key==="Escape"){this.closeDropdown();(i=this.inputRef)===null||i===void 0?void 0:i.focus()}}initializeOptions(){this.filteredOptions=this.options.length>0?this.options:[]}openDropdown(){this.isOpen=true;if(this.useSlot){this.focusedIndex=-1;setTimeout((()=>this.updateSlotElements()),0)}else{this.focusedIndex=this.selectedOption?this.filteredOptions.findIndex((t=>t.value===this.selectedOption.value)):-1}}emitSearchQuery(t){if(this.debounceTimeout){clearTimeout(this.debounceTimeout)}this.debounceTimeout=setTimeout((()=>{this.searchQuery.emit(t)}),this.debounceDelay)}closeDropdown(){this.isOpen=false;this.focusedIndex=-1;this.removeSlotFocus()}updateSlotElements(){if(!this.useSlot||!this.dropdownRef)return;const t=this.dropdownRef.querySelector('slot[name="dropdown-content"]');if(t){const i=t.assignedElements?t.assignedElements():Array.from(this.el.querySelectorAll('[slot="dropdown-content"] [data-option]'));this.slotElements=i.length>0?i:Array.from(this.dropdownRef.querySelectorAll('[data-option], .dropdown-item[style*="cursor"]'));this.slotElements.forEach(((t,i)=>{t.setAttribute("data-slot-index",i.toString());t.setAttribute("role","option");t.setAttribute("tabindex","-1")}))}}removeSlotFocus(){this.slotElements.forEach((t=>{t.classList.remove("focused","active");t.removeAttribute("aria-selected")}))}focusSlotElement(t){this.removeSlotFocus();if(t>=0&&t<this.slotElements.length){const i=this.slotElements[t];i.classList.add("focused","active");i.setAttribute("aria-selected","true");i.scrollIntoView({block:"nearest"})}}selectSlotElement(t){if(t>=0&&t<this.slotElements.length){const i=this.slotElements[t];i.click()}}selectOption(t){this.selectedOption=t;this.optionChange.emit(t);this.closeDropdown();this.inputRef.focus()}scrollToFocusedOption(){if(this.focusedIndex<0||!this.dropdownRef||this.useSlot)return;const t=this.dropdownRef.querySelector(`#${this.dropdownId}-option-${this.focusedIndex}`);if(t){t.scrollIntoView({block:"nearest"})}}render(){var t;return o(s,{key:"29cb183ba4efcef8aa53ebfca88330601bdb5f0c"},o("input",{key:"e13080674e061abaad24fcee9bee317e54d6f923",ref:t=>this.inputRef=t,type:"text",class:"form-control",role:"combobox",id:this.id,value:((t=this.selectedOption)===null||t===void 0?void 0:t.label)||"",placeholder:this.placeholder,"aria-expanded":String(this.isOpen),"aria-autocomplete":"list","aria-controls":this.dropdownId,"data-reference":"parent","aria-haspopup":"listbox","aria-activedescendant":this.focusedIndex>=0?`${this.dropdownId}-option-${this.focusedIndex}`:null,"aria-label":"Combobox","aria-required":true,onKeyDown:this.handleKeyDown,onInput:this.handleInput}),o("div",{key:"740aea94d33cf99453a0c71f60a05f784fefc850",class:`dropdown ${this.isOpen?"show":""}`},o("div",{key:"ba9b88e92e5921bcc661ea1179c5e501e5f5f43c",ref:t=>this.dropdownRef=t,class:`dropdown-menu ${this.isOpen?"show":""}`,id:this.dropdownId,role:"listbox","aria-expanded":String(this.isOpen)},this.useSlot?o("slot",{name:"dropdown-content"}):[this.loading&&o("div",{class:"dropdown-item loading"},"Loading..."),!this.loading&&this.filteredOptions.length===0&&o("div",{class:"dropdown-item no-results"},"No results found"),!this.loading&&this.filteredOptions.map(((t,i)=>{var s;return o("button",{id:`${this.dropdownId}-option-${i}`,class:`dropdown-item ${this.focusedIndex===i?"active":""}`,role:"option","aria-selected":((s=this.selectedOption)===null||s===void 0?void 0:s.value)===t.value?"true":"false",onClick:()=>this.selectOption(t),onMouseEnter:()=>this.focusedIndex=i},t.label)}))])))}get el(){return e(this)}static get watchers(){return{options:["watchOptionsChanged"],useSlot:["watchUseSlotChanged"]}}};a.style=n;export{a as ir_m_combobox};
//# sourceMappingURL=p-ca42afbc.entry.js.map