import{r as t,c as i,g as e,h as r,H as s}from"./p-d239357b.js";import{I as a}from"./p-518eace5.js";import{v as n}from"./p-4ed69de7.js";const o=".sc-ir-input-text-h{--ir-bg:#fff;--ir-primary:#1e9ff2;--ir-danger:#ff4961;--ir-border:#cacfe7;--ir-disabled-fg:#9aa1ac;--ir-readonly-bg:#f8f9fa;--ir-input-color:#3b4781;--ir-placeholder-color:#bbbfc6;--ir-floating-input-border:var(--ir-border);--ir-floating-input-border-radius:0.21rem;--ir-floating-input-height:2rem;--ir-focus-ring:none;--ir-focus-border-color:var(--ir-primary);--ir-floating-input-font-size:0.975rem;--ir-floating-input-line-height:1.45;--ir-floating-input-padding-y:0.75rem;--ir-floating-input-padding-x:1rem;--ir-floating-input-padding-x-with-affix:2rem;--ir-floating-label-fg:#6c757d;--ir-floating-label-fg-focus:#495057;--ir-floating-label-bg:#fff;--ir-floating-label-scale:0.88;--ir-floating-label-float-translateY:-70%;--ir-floating-label-resting-offset-inline:0.9rem;--ir-floating-label-resting-offset-inline-with-prefix:1.8rem;--ir-floating-input-affix-size:1rem;--ir-floating-input-affix-color:#6c757d;margin:0;padding:0;display:inline}.sc-ir-input-text-h{--blue:var(--ir-primary);--red:var(--ir-danger)}.border-theme.sc-ir-input-text{border:1px solid var(--ir-border)}.icon-container.sc-ir-input-text{color:#3b4781;border:1px solid var(--ir-border);font-size:var(--ir-floating-input-font-size);height:var(--ir-floating-input-height);background:var(--ir-bg);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}input.sc-ir-input-text:focus{border-color:var(--ir-primary) !important}.error-message.sc-ir-input-text{font-size:0.875rem;padding:0;margin:0.5rem 0 0;color:var(--ir-danger)}.ir-input[data-state='empty'].sc-ir-input-text{color:var(--ir-placeholder-color)}.input-container.sc-ir-input-text{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.input-container.sc-ir-input-text input.sc-ir-input-text{padding-left:5px !important;padding-right:5px !important;border-left:0;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.icon-container[data-state='focus'].sc-ir-input-text{border-color:var(--ir-primary)}.icon-container[data-disabled].sc-ir-input-text{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.danger-border.sc-ir-input-text{border-color:var(--ir-danger)}.ir-floating-group.sc-ir-input-text{position:relative;display:block;border:1px solid var(--ir-floating-input-border);border-radius:var(--ir-floating-input-border-radius);background:var(--ir-bg);transition:border-color 120ms ease, box-shadow 120ms ease;padding:0}.ir-floating-group.sc-ir-input-text:focus-within{border-color:var(--ir-focus-border-color);box-shadow:var(--ir-focus-ring)}.ir-floating-group.has-error.sc-ir-input-text,.has-error.sc-ir-input-text .ir-floating-group.sc-ir-input-text{border-color:var(--ir-danger)}.ir-floating-group.is-disabled.sc-ir-input-text{background-color:#f1f3f5}.ir-floating-group.is-readonly.sc-ir-input-text{background-color:var(--ir-readonly-bg)}.ir-floating-input.sc-ir-input-text{width:100%;display:block;border:0;outline:0;background:transparent;color:var(--ir-input-color);font-size:var(--ir-floating-input-font-size);line-height:var(--ir-floating-input-line-height);border-radius:var(--ir-floating-input-border-radius);box-shadow:none;padding:var(--ir-floating-input-padding-y) var(--ir-floating-input-padding-x);height:var(--ir-floating-input-height)}.ir-floating-input.danger-border.sc-ir-input-text{box-shadow:none}.ir-floating-label.sc-ir-input-text{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none;padding:0 0.4rem;color:var(--ir-floating-label-fg);background:transparent;transition:transform 120ms ease, color 120ms ease, top 120ms ease, background-color 120ms ease, opacity 120ms ease;opacity:0.95;line-height:1}.ir-floating-label.sc-ir-input-text:dir(rtl){right:var(--ir-floating-label-resting-offset-inline)}.ir-floating-label.sc-ir-input-text:dir(ltr){left:var(--ir-floating-label-resting-offset-inline)}.ir-floating-group.sc-ir-input-text:focus-within .ir-floating-label.sc-ir-input-text,.ir-floating-input.sc-ir-input-text:not(:placeholder-shown)+.ir-floating-label.sc-ir-input-text,.ir-floating-group[data-has-value='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text{top:0;transform:translateY(var(--ir-floating-label-float-translateY)) scale(var(--ir-floating-label-scale));background:var(--ir-floating-label-bg);color:var(--ir-floating-label-fg-focus);font-size:12px;padding:0}.ir-floating-group.has-error.sc-ir-input-text .ir-floating-label.sc-ir-input-text,.has-error.sc-ir-input-text .ir-floating-group.sc-ir-input-text .ir-floating-label.sc-ir-input-text{color:var(--ir-danger)}.ir-floating-group.is-disabled.sc-ir-input-text .ir-floating-label.sc-ir-input-text{color:var(--ir-disabled-fg)}@supports (-webkit-touch-callout: none){.ir-floating-input.sc-ir-input-text{border-radius:var(--ir-floating-input-border-radius)}}.prefix-container.sc-ir-input-text,.suffix-container.sc-ir-input-text{position:absolute;top:0;bottom:0;display:inline-flex;align-items:center;color:var(--ir-floating-input-affix-color);pointer-events:none}.prefix-container.sc-ir-input-text:dir(ltr){left:0.5rem}.suffix-container.sc-ir-input-text:dir(ltr){right:0.5rem}.prefix-container.sc-ir-input-text:dir(rtl){right:0.5rem}.suffix-container.sc-ir-input-text:dir(rtl){left:0.5rem}.sc-ir-input-text-s>[slot='prefix'],.sc-ir-input-text-s>[slot='suffix']{display:inline-flex;width:var(--ir-floating-input-affix-size);height:var(--ir-floating-input-affix-size)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-input.sc-ir-input-text{padding:var(--ir-floating-input-padding-y) var(--ir-floating-input-padding-x-with-affix)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text:dir(ltr){left:var(--ir-floating-label-resting-offset-inline-with-prefix)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text:dir(rtl){right:var(--ir-floating-label-resting-offset-inline-with-prefix)}.no-slot.sc-ir-input-text{display:none}";const l=o;const h=class{constructor(e){t(this,e);this.textChange=i(this,"textChange",7);this.inputBlur=i(this,"inputBlur",7);this.inputFocus=i(this,"inputFocus",7)}get el(){return e(this)}name;value;label;placeholder;inputStyles="";required;readonly=false;type="text";submitted=false;inputStyle=true;textSize="md";labelPosition="left";labelBackground=null;labelColor="dark";labelBorder="theme";labelWidth=3;variant="default";disabled=false;error=false;mask;autoValidate=true;zod;asyncParse;wrapKey;inputForcedStyle;testId;maxLength;clearBaseStyles;errorMessage;autoComplete;inputContainerStyle;labelContainerClassname;inputFocused=false;textChange;inputBlur;inputFocus;inputRef;maskInstance;id;hasPrefixSlot;hasSuffixSlot;componentWillLoad(){if(this.el.id){this.id=this.el.id}else{this.id=n()}this.hasPrefixSlot=this.haveSlotPresent("prefix");this.hasSuffixSlot=this.haveSlotPresent("suffix")}componentDidLoad(){if(this.mask)this.initMask()}handleMaskChange(){this.initMask()}handleValueChange(t,i){if(t!==i){this.validateInput(this.value)}}initMask(){if(!this.mask||this.maskInstance){return}this.maskInstance=a(this.inputRef,this.mask);this.maskInstance.on("accept",(()=>{const t=this.inputRef.value.trim()===""||this.maskInstance.unmaskedValue==="";if(t){this.inputRef.value="";this.textChange.emit(null)}else{this.inputRef.value=this.maskInstance.value;this.textChange.emit(this.maskInstance.value)}}))}haveSlotPresent(t){const i=this.el.querySelector(`[slot="${t}"]`);return i!==null}async validateInput(t,i=false){if(!this.autoValidate&&!i){if(this.error){this.updateErrorState(false)}return}if(this.zod){try{if(!this.asyncParse){this.zod.parse(this.wrapKey?{[this.wrapKey]:t}:t)}else{await this.zod.parseAsync(this.wrapKey?{[this.wrapKey]:t}:t)}if(this.error){this.updateErrorState(false)}}catch(t){console.log(t);this.updateErrorState(true)}}}handleInputChange(t){const i=t.target.value;const e=i==="";if(this.maskInstance){this.maskInstance.value=i}const r=e?null:this.maskInstance?this.maskInstance.value:i;this.textChange.emit(r)}updateErrorState(t){this.error=t;this.inputRef.setAttribute("aria-invalid",t?"true":"false")}handleBlur(t){this.validateInput(this.value,this.submitted);this.inputFocused=false;this.inputBlur.emit(t)}renderFloatingLabel(){const t=this.label||this.placeholder||"";const i=!!(this.value&&String(this.value).length>0);return r("div",{class:"form-group",style:this.inputContainerStyle},r("div",{class:`ir-floating-group ${this.error?"has-error":""} ${this.disabled?"is-disabled":""} ${this.readonly?"is-readonly":""}`,"data-has-value":String(i),"data-focused":String(this.inputFocused),"data-have-prefix":String(this.hasPrefixSlot),"data-have-suffix":String(this.hasSuffixSlot),part:"form-group"},r("span",{part:"prefix-container",class:{"prefix-container":true,"no-slot":!this.hasPrefixSlot}},r("slot",{name:"prefix"})),r("input",{part:"input","data-state":!!this.value?undefined:this.mask?"empty":undefined,maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,id:this.id,name:this.name,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:`ir-input ir-floating-input ${this.inputStyles||""} ${this.error?"danger-border":""} text-${this.textSize}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:" ",autoComplete:this.autoComplete,autocomplete:this.autoComplete,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled,"aria-invalid":String(this.error),"aria-required":String(this.required)}),r("label",{part:"label",htmlFor:this.id,class:"ir-floating-label"},t,this.required?" *":""),r("span",{part:"suffix-container",class:{"suffix-container":true,"no-slot":!this.hasSuffixSlot}},r("slot",{name:"suffix"}))),this.errorMessage&&this.error&&r("p",{part:"error-message",class:"error-message"},this.errorMessage))}render(){if(this.variant==="floating-label"){return this.renderFloatingLabel()}if(this.variant==="icon"){return r("fieldset",{class:"position-relative has-icon-left input-container"},r("label",{htmlFor:this.id,class:"input-group-prepend bg-white m-0"},r("span",{"data-disabled":this.disabled,"data-state":this.inputFocused?"focus":"",class:`input-group-text icon-container bg-white ${this.error?"danger-border":""}`,id:"basic-addon1"},r("slot",{name:"icon"}))),r("input",{maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,"data-state":!!this.value?undefined:this.mask?"empty":undefined,id:this.id,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:`ir-input form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder ${this.error?"danger-border":""}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:this.placeholder,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled,autoComplete:this.autoComplete}))}return r("div",{class:"form-group",style:this.inputContainerStyle},r("div",{class:"input-group row m-0"},this.label&&r("div",{class:`input-group-prepend col-${this.labelWidth} ${this.labelContainerClassname} p-0 text-${this.labelColor}`},r("label",{htmlFor:this.id,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":"")),r("input",{maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,"data-state":!!this.value?undefined:this.mask?"empty":undefined,id:this.id,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:this.clearBaseStyles?`${this.inputStyles}`:`${this.error?"border-danger":""} form-control text-${this.textSize} col-${this.label?12-this.labelWidth:12} ${this.readonly?"bg-white":""} ${this.inputStyles}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:this.placeholder,autoComplete:this.autoComplete,autocomplete:this.autoComplete,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled})),this.errorMessage&&this.error&&r("p",{class:"error-message"},this.errorMessage))}static get watchers(){return{mask:["handleMaskChange"],value:["handleValueChange"]}}};h.style=l;const c=":host{display:block;width:100%}.menu{display:flex;flex-direction:column;min-width:max-content;margin:0px;padding:0.5rem 0;border:var(--wa-border-style) var(--wa-border-width-s) var(--wa-color-surface-border);border-radius:var(--wa-border-radius-m);background-color:var(--wa-color-surface-raised);box-shadow:var(--wa-shadow-m);color:var(--wa-color-text-normal);text-align:start;user-select:none;overflow:auto;max-width:var(--auto-size-available-width) !important;max-height:var(--auto-size-available-height) !important}wa-input[aria-invalid='true']::part(base){border-color:var(--wa-color-danger-border-loud);outline-color:var(--wa-color-danger-border-loud);border-width:2px}.results{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;max-height:min(60vh, 24rem);overflow-y:auto}.group{display:flex;flex-direction:column;gap:0.35rem}.group__label{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.08em;color:var(--wa-color-text-muted);margin:0 0.25rem}.group__options{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:0.25rem}.option{display:flex;align-items:center;gap:0.75rem;padding:0.75rem;border-radius:var(--wa-border-radius-m);cursor:pointer;transition:background-color 120ms ease, box-shadow 120ms ease}.option__leading{color:var(--wa-color-text-muted);display:flex;align-items:center;justify-content:center;font-size:1rem}.option__leading wa-icon{font-size:1.15rem}.option__content{display:flex;flex-direction:column;gap:0.15rem;flex:1}.option__label{font-weight:600}.option__description{font-size:0.85rem;color:var(--wa-color-text-muted)}.option__suffix{margin-inline-start:auto;display:flex;align-items:center;gap:0.5rem}.option__meta{padding:0.15rem 0.45rem;border-radius:var(--wa-border-radius-pill, 999px);background-color:var(--wa-color-surface, rgba(255, 255, 255, 0.08));font-size:0.75rem;color:var(--wa-color-text-normal)}.option__shortcut{display:flex;gap:0.25rem}.option__shortcut kbd{border-radius:var(--wa-border-radius-s);border:1px solid var(--wa-color-surface-border);padding:0.15rem 0.35rem;font-size:0.75rem;font-family:inherit;background-color:var(--wa-color-surface, rgba(255, 255, 255, 0.04))}.option--active{background-color:var(--wa-color-surface-hover, rgba(255, 255, 255, 0.06));box-shadow:inset 0 0 0 1px var(--wa-color-surface-border)}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:0.35rem;padding:2rem 1rem;text-align:center;color:var(--wa-color-text-muted)}.empty-state wa-icon{font-size:1.25rem}.loading-state{display:flex;align-items:center;gap:0.5rem;padding:0.75rem 1rem;color:var(--wa-color-text-muted)}.loading-state p{margin:0;font-size:0.9rem}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0}";const d=c;const u=300;const f=class{constructor(e){t(this,e);this.comboboxSelect=i(this,"combobox-select",7);this.textChange=i(this,"text-change",7);this.comboboxClear=i(this,"combobox-clear",7);this.inputPickerBlurred=i(this,"input-picker-blurred",7)}value="";loading=false;mode="default";pill=false;placeholder="";label;defaultValue;withClear=false;size="small";appearance;debounce=0;static idCounter=0;componentId=++f.idCounter;listboxId=`ir-combobox-listbox-${this.componentId}`;listboxLabelId=`ir-combobox-label-${this.componentId}`;emptyStateId=`ir-combobox-empty-${this.componentId}`;inputRef;nativeInput;slotRef;debounceTimer;get hostEl(){return e(this)}isOpen=false;query="";activeIndex=-1;filteredItems=[];liveRegionMessage="";slottedPickerItems=[];isValid;comboboxSelect;textChange;comboboxClear;inputPickerBlurred;componentWillLoad(){const t=Array.from(this.hostEl?.querySelectorAll("ir-picker-item")??[]);if(t.length){this.processPickerItems(t)}else{this.updateLiveRegion(0)}}componentDidRender(){if(this.inputRef){this.nativeInput=this.inputRef.input}this.applyAriaAttributes()}disconnectedCallback(){if(this.debounceTimer){window.clearTimeout(this.debounceTimer);this.debounceTimer=undefined}}async focusInput(){this._focusInput()}async open(){if(this.isOpen){this._focusInput();return}this.isOpen=true;requestAnimationFrame((()=>this._focusInput()));if(this.filteredItems.length){const t=this.filteredItems.findIndex((t=>t.value===this.value));if(t>=0){const i=this.findNearestEnabledIndex(t+1,1);if(i>=0){this.activeIndex=i}else{this.focusEdgeItem("start")}}else if(this.activeIndex===-1){this.focusEdgeItem("start")}}this.scrollSelectedIntoView()}async close(){this.isOpen=false}handleKeyDown(t){this.handleInputKeydown(t)}handleDocumentClick(t){if(!this.isOpen)return;const i=t.composedPath?t.composedPath():[];if(i.length&&i.includes(this.hostEl)||this.hostEl.contains(t.target))return;this.closeCombobox()}handleDocumentFocus(t){if(!this.isOpen)return;if(this.hostEl.contains(t.target))return;this.closeCombobox()}handleActiveIndexChange(){this.updateActiveItemIndicators();this.applyAriaAttributes();this.scrollActiveOptionIntoView()}handleAriaInvalid(t){this.isValid=t}handleValueChange(t){this.updateSelectedFromValue(t);this.syncQueryWithValue(t);if(["select-async","select"].includes(this.mode)){this.applyFilter("",{updateQuery:false,emitEvent:false})}}async clearInput(){this.applyFilter("")}closeCombobox(t={}){this.isOpen=false;if(t.restoreFocus){this._focusInput()}}handleInput=t=>{const i=t.target;this.applyFilter(i?.value??"");this.open()};handleInputFocus=()=>{if(!this.isOpen){if(this.mode==="select-async"&&!this.query){return}this.open()}};handleInputKeydown=t=>{switch(t.key){case"ArrowDown":t.preventDefault();this.open();this.moveActiveIndex(1);break;case"ArrowUp":t.preventDefault();this.open();this.moveActiveIndex(-1);break;case"Enter":if(!this.isOpen)return;t.preventDefault();this.selectActiveItem();break;case"Escape":if(!this.isOpen)return;t.preventDefault();this.closeCombobox({restoreFocus:true});break;case"Home":if(!this.isOpen)return;t.preventDefault();this.focusEdgeItem("start");break;case"End":if(!this.isOpen)return;t.preventDefault();this.focusEdgeItem("end");break;case"Tab":this.closeCombobox();break}};applyFilter(t,i={}){const{updateQuery:e=true,emitEvent:r=true}=i;if(e){this.query=t}const s=t.trim().toLowerCase();const a=this.slottedPickerItems;const n=s?a.filter((t=>this.matchesQuery(t,s))):[...a];const o=this.activeIndex>=0?this.filteredItems[this.activeIndex]:undefined;this.filteredItems=n;this.updateItemVisibility(n);let l=o?n.indexOf(o):-1;if(n.length===0){this.activeIndex=-1}else{if(l===-1){l=this.findNearestEnabledIndex(0,1)}this.activeIndex=l}this.updateActiveItemIndicators();const h=s?`"${t.trim()}"`:undefined;this.updateLiveRegion(n.length,h);if(r){this.emitTextChange(t)}}emitTextChange(t){const i=this.getTextChangeDelay();if(this.debounceTimer){window.clearTimeout(this.debounceTimer)}const e=()=>{this.textChange.emit(t)};if(i>0){this.debounceTimer=window.setTimeout(e,i);return}e()}getTextChangeDelay(){if(typeof this.debounce==="number"&&this.debounce>0){return this.debounce}if(this.mode==="select-async"){return u}return 0}syncQueryWithValue(t,i={}){if(!["select","select-async"].includes(this.mode)){return}if(!t){if(i.allowEmptyFallback!==false){this.query=""}return}const e=this.slottedPickerItems.find((i=>i.value===t));if(e){this.query=this.getItemDisplayLabel(e)}}selectActiveItem(){if(this.activeIndex<0)return;const t=this.filteredItems[this.activeIndex];if(!t||t.disabled)return;this.handleSelection(t)}handleSelection(t){const i={value:t.value,label:this.getItemDisplayLabel(t),disabled:t.disabled};this.value=t.value;this.updateSelectedFromValue();this.comboboxSelect.emit({item:i});this.closeCombobox({restoreFocus:true});if(["select","select-async"].includes(this.mode)){this.query=this.getItemDisplayLabel(t);this.applyFilter("",{updateQuery:false,emitEvent:false})}else{this.applyFilter("",{emitEvent:false})}this.activeIndex=-1}_focusInput(){this.inputRef?.focus();this.nativeInput?.focus()}applyAriaAttributes(){if(!this.nativeInput)return;this.nativeInput.setAttribute("role","combobox");this.nativeInput.setAttribute("aria-autocomplete","list");this.nativeInput.setAttribute("aria-expanded",String(this.isOpen));this.nativeInput.setAttribute("aria-controls",this.listboxId);if(this.activeIndex>=0){const t=this.filteredItems[this.activeIndex];if(t?.id){this.nativeInput.setAttribute("aria-activedescendant",t.id)}}else{this.nativeInput.removeAttribute("aria-activedescendant")}}scrollActiveOptionIntoView(){if(this.activeIndex<0)return;const t=this.filteredItems[this.activeIndex];if(!t)return;this.runAfterNextFrame((()=>{t.scrollIntoView({block:"center"})}))}scrollSelectedIntoView(){if(!this.isOpen||!this.value){return}const t=this.filteredItems.find((t=>t.value===this.value))??this.slottedPickerItems.find((t=>t.value===this.value));if(!t){return}this.runAfterNextFrame((()=>{t.scrollIntoView({block:"center"})}))}capturePickerItemsFromSlot(t=this.slotRef){if(!t){return}const i=t.assignedElements({flatten:true});const e=i.filter((t=>t.tagName==="IR-PICKER-ITEM"));this.processPickerItems(e)}processPickerItems(t){this.slottedPickerItems=[...t];this.ensureItemIds();this.applyFilter(this.query,{emitEvent:false});this.updateSelectedFromValue(this.value);this.syncQueryWithValue(this.value,{allowEmptyFallback:false});if(["select","select-async"].includes(this.mode)&&this.value){this.applyFilter("",{updateQuery:false,emitEvent:false})}}ensureItemIds(){this.slottedPickerItems.forEach(((t,i)=>{if(!t.id){t.id=`${this.listboxId}-option-${i}`}}))}getItemDisplayLabel(t){return t.label||t.textContent?.trim()||""}matchesQuery(t,i){const e=`${t.label??""} ${t.value??""}`.toLowerCase();return e.includes(i)}updateItemVisibility(t){const i=new Set(t);this.slottedPickerItems.forEach((t=>{const e=i.has(t);t.hidden=!e;if(e){t.removeAttribute("aria-hidden")}else{t.setAttribute("aria-hidden","true")}t.active=false}))}updateSelectedFromValue(t=this.value){if(!this.slottedPickerItems.length){return}this.slottedPickerItems.forEach((i=>{i.selected=Boolean(t)&&i.value===t}))}updateActiveItemIndicators(){this.slottedPickerItems.forEach((t=>t.active=false));if(this.activeIndex<0){return}const t=this.filteredItems[this.activeIndex];if(t){t.active=true}}findNearestEnabledIndex(t,i){const e=this.filteredItems;const r=e.length;if(!r){return-1}let s=(t%r+r)%r;let a=0;while(a<r){const t=e[s];if(t&&!t.disabled){return s}s=((s+i)%r+r)%r;a+=1}return-1}focusEdgeItem(t){if(!this.filteredItems.length){this.activeIndex=-1;return}const i=t==="start"?1:-1;const e=t==="start"?0:this.filteredItems.length-1;this.activeIndex=this.findNearestEnabledIndex(e,i)}moveActiveIndex(t){const i=this.filteredItems.length>0;if(!i){this.activeIndex=-1;return}if(this.activeIndex===-1){this.focusEdgeItem(t===1?"start":"end");return}this.activeIndex=this.findNearestEnabledIndex(this.activeIndex+t,t)}findPickerItemFromEvent(t){const i=typeof t.composedPath==="function"?t.composedPath():[];for(const t of i){if(t&&t.tagName==="IR-PICKER-ITEM"){return t}}return undefined}handleResultsClick=t=>{const i=this.findPickerItemFromEvent(t);if(!i||i.disabled){return}t.preventDefault();this.handleSelection(i)};handleResultsPointerDown=t=>{const i=this.findPickerItemFromEvent(t);if(!i){return}t.preventDefault()};handleSlotChange=t=>{const i=t.target;this.slotRef=i;this.capturePickerItemsFromSlot(i)};render(){const t=this.filteredItems.length>0;const i=this.mode==="select-async";const e=this.slottedPickerItems.length>0;const a=!this.loading&&!t&&(!i||!e);const n=a?this.emptyStateId:undefined;return r(s,{key:"66acc03df9baf5798a263c54e18b3f133528024f"},r("wa-popup",{key:"a93f64c0098418b8410ee649bdd28305caf8e883",flip:true,shift:true,placement:"bottom",sync:"width","auto-size":"vertical","auto-size-padding":10,active:this.isOpen},r("wa-input",{key:"8bb7687232ef0dc82facbe73411731e604cd8dde",slot:"anchor",class:"search-bar","aria-invalid":this.isValid,withClear:this.withClear,size:this.size,value:this.query,defaultValue:this.defaultValue,ref:t=>this.inputRef=t,appearance:this.appearance,label:this.label,pill:this.pill,onblur:()=>this.inputPickerBlurred.emit(),autocomplete:"off",placeholder:this.placeholder||"Search",oninput:this.handleInput,onfocus:this.handleInputFocus,"onwa-clear":()=>{this.applyFilter("");this.open();this.comboboxClear.emit()}},this.loading&&r("wa-spinner",{key:"810f0d0a712e925fd917db440a8c3e62287dbadd",slot:"end"}),r("wa-icon",{key:"9c2ed6bc2d11bd68a9daa2f47e7f1dbceef98b22",slot:"start",name:"magnifying-glass","aria-hidden":"true"}),r("slot",{key:"f6bdc32bb5d4e2eaa2a2c1062a5aef77a9fbfbf8",name:"end",slot:"end"})),r("div",{key:"785b45d752d056936e65f23a101aebc22aa4f018",class:"menu",role:"presentation"},r("p",{key:"beef92b44ca6004effb6f47608b1415d442d6d7f",class:"sr-only",id:this.listboxLabelId},"Available search shortcuts"),r("ul",{key:"1d01ddfc268c60fed6da57e7588277b97de61f7b",class:"results",id:this.listboxId,role:"listbox","aria-labelledby":this.listboxLabelId,"aria-describedby":n,"aria-busy":this.loading?"true":undefined,onClick:this.handleResultsClick,onPointerDown:this.handleResultsPointerDown},this.loading&&r("li",{key:"f318b3f99f672335374a95528e00a647be7cc52b",class:"loading-state",role:"presentation"},r("wa-spinner",{key:"414f03b92adf2998ef64961c8a44ea32c9a4d15a"}),r("p",{key:"fca7d8c0f2311ac6b5028c08bf309918e3e94a8e"},"Loading suggestionsâ€¦")),r("slot",{key:"78086ba39db811f3db616c8844a34ccbe16936f9",onSlotchange:this.handleSlotChange}),a&&r("li",{key:"12e9e7c288800a45599d0f5bb79344ac9c8a0099",class:"empty-state",role:"presentation",id:this.emptyStateId},r("wa-icon",{key:"7226a2191efdcfc309bfe2d6725c0487e3471a34",name:"circle-info","aria-hidden":"true"}),r("p",{key:"f41840388e134a858c5f86b637aec4e2264d30f4"},"No results found"))))),r("span",{key:"4a04f033f3686ec287dd20dc531077060cd1ed46",class:"sr-only","aria-live":"polite"},this.liveRegionMessage))}updateLiveRegion(t,i){if(!t){this.liveRegionMessage=i?`No results for ${i}`:"No results available";return}const e=t===1?"result":"results";this.liveRegionMessage=i?`${t} ${e} for ${i}`:`${t} ${e} available`}runAfterNextFrame(t){if(typeof requestAnimationFrame==="function"){requestAnimationFrame((()=>t()));return}setTimeout(t,0)}static get watchers(){return{activeIndex:["handleActiveIndexChange"],"aria-invalid":["handleAriaInvalid"],value:["handleValueChange"]}}};f.style=d;const p=":host{box-sizing:border-box !important}:host *,:host *::before,:host *::after{box-sizing:inherit !important;padding:0;margin:0}[hidden]{display:none !important}:host{box-sizing:border-box;display:block}:host([hidden]){display:none !important}.picker-item__container{all:unset;box-sizing:border-box;width:100%;color:var(--wa-color-text-normal);user-select:none;position:relative;display:flex;align-items:center;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;font-size:inherit;font-family:inherit;font-optical-sizing:inherit;font-size-adjust:inherit;font-kerning:inherit;font-feature-settings:inherit;font-variation-settings:inherit;padding:0;padding:0.5em 1em 0.5em 0.25em !important;line-height:var(--wa-line-height-condensed);transition:fill var(--wa-transition-normal) var(--wa-transition-easing);cursor:pointer;gap:0.5rem;scroll-margin:0.25rem}.picker-item__content{display:flex;align-items:center;gap:0.5rem}.picker-item__container:hover{background-color:var(--wa-color-neutral-fill-normal);color:var(--wa-color-neutral-on-normal)}.picker-item__check{opacity:0}:host([active]) .picker-item__container{background-color:var(--wa-color-brand-fill-loud);color:var(--wa-color-brand-on-loud);opacity:1}:host([selected]) .picker-item__container{font-weight:600}:host([selected]) .picker-item__check{opacity:1}:host([aria-disabled='true']) .picker-item__container,.picker-item__container:disabled{cursor:not-allowed;opacity:0.5}";const g=p;const b=class{constructor(i){t(this,i)}value;label;disabled=false;active=false;selected=false;render(){return r(s,{key:"e8a0c2b0b39d11cc2e47296a429f4a263d696f2c",role:"option","aria-selected":this.selected?"true":"false","aria-disabled":this.disabled?"true":"false"},r("button",{key:"839462f49bf04ded8f47654a09ed69cb70c29605",class:`picker-item__container`,type:"button",tabindex:"-1",disabled:this.disabled,part:"base"},r("wa-icon",{key:"d38d015f58b08bc1218dfbce0379caf53957f76a",class:"picker-item__check",name:"check"}),r("div",{key:"8f4626adce7db303f32d89eb61e8307d187c61d6",class:"picker-item__content",part:"content"},r("slot",{key:"04300865bf5e488da759f75b100d1756a353a930"}))))}};b.style=g;const m=":host{display:block;position:relative}.error-message{font-weight:var(--wa-form-control-hint-font-weight);margin-block-start:0.5em;font-size:var(--wa-font-size-smaller);line-height:var(--wa-form-control-label-line-height);color:var(--wa-color-danger-fill-loud);}";const x=m;const v=class{constructor(e){t(this,e);this.validationChange=i(this,"irValidationChange",7);this.valueChange=i(this,"irValueChange",7)}get el(){return e(this)}schema;value;asyncValidation;showErrorMessage;autovalidate;form;valueEvent="input input-change value-change select-change";blurEvent="blur input-blur select-blur";validationDebounce=200;validationChange;valueChange;isValid=true;autoValidateActive=false;errorMessage="";childEl;formEl;slotEl;currentValue;hasInteracted=false;validationTimer;valueEventsBound=[];blurEventsBound=[];componentWillLoad(){if(!this.schema){throw new Error("<ir-validator> requires a `schema` prop.")}this.syncAutovalidateFlag(this.autovalidate)}componentDidLoad(){this.slotEl=this.el.shadowRoot?.querySelector("slot");this.slotEl?.addEventListener("slotchange",this.handleSlotChange);this.initializeChildReference();this.attachFormListener()}disconnectedCallback(){this.teardownChildListeners();this.detachFormListener();this.slotEl?.removeEventListener("slotchange",this.handleSlotChange);this.clearValidationTimer()}async handleSchemaChange(){if(this.autoValidateActive&&this.hasInteracted){await this.flushValidation()}}async handleAutoValidatePropChange(t){this.syncAutovalidateFlag(t);if(this.autoValidateActive){await this.flushValidation()}}handleFormPropChange(){this.detachFormListener();this.attachFormListener()}handleValueEventChange(t,i){if(t===i)return;this.rebindChildListeners()}handleBlurEventChange(t,i){if(t===i)return;this.rebindChildListeners()}syncAutovalidateFlag(t){this.autoValidateActive=JSON.parse(String(t??false))}parseEvents(t){if(!t)return[];return t.split(/[\s,]+/).map((t=>t.trim())).filter(Boolean)}async handleValuePropChange(t,i){if(Object.is(t,i))return;this.updateValue(t,{suppressValidation:true,emitChange:false});if(this.autoValidateActive&&this.hasInteracted){await this.flushValidation()}}handleSlotChange=()=>{this.initializeChildReference()};initializeChildReference(){const t=this.pickSingleChild();if(t===this.childEl)return;this.teardownChildListeners();if(!t)return;this.childEl=t;this.hasInteracted=false;this.registerChildListeners();const i=this.readValueFromChild();this.updateValue(i,{suppressValidation:!this.autoValidateActive,emitChange:true});if(!this.autoValidateActive){this.updateAriaValidity(this.isValid)}}pickSingleChild(){const t=this.slotEl?.assignedElements({flatten:true})??Array.from(this.el.children);const i=t.filter((t=>t.nodeType===Node.ELEMENT_NODE));if(i.length===0){console.warn("<ir-validator> requires exactly one child element but found none.");return undefined}if(i.length>1){console.warn(`<ir-validator> requires exactly one child element but found ${i.length}. Using the first.`)}return i[0]}registerChildListeners(){if(!this.childEl)return;this.unbindChildListeners();this.valueEventsBound=this.parseEvents(this.valueEvent);this.blurEventsBound=this.parseEvents(this.blurEvent);this.valueEventsBound.forEach((t=>this.childEl.addEventListener(t,this.handleValueEvent)));this.blurEventsBound.forEach((t=>this.childEl.addEventListener(t,this.handleBlurEvent)))}unbindChildListeners(){if(!this.childEl)return;this.valueEventsBound.forEach((t=>this.childEl.removeEventListener(t,this.handleValueEvent)));this.blurEventsBound.forEach((t=>this.childEl.removeEventListener(t,this.handleBlurEvent)));this.valueEventsBound=[];this.blurEventsBound=[]}teardownChildListeners(){if(this.childEl){this.unbindChildListeners();this.childEl=undefined}this.clearValidationTimer()}rebindChildListeners(){if(!this.childEl)return;this.registerChildListeners()}handleValueEvent=t=>{if(!this.childEl)return;const i=this.extractEventValue(t);this.hasInteracted=true;this.updateValue(i)};handleBlurEvent=async()=>{if(!this.childEl)return;this.hasInteracted=true;if(this.autoValidateActive){await this.flushValidation()}};extractEventValue(t){if("detail"in t&&t["detail"]&&typeof t["detail"]==="object"&&"value"in t.detail){return t.detail.value}const i=t.target;if(i&&"value"in i){return i.value}return this.readValueFromChild()}readValueFromChild(){if(this.value!==undefined){return this.value}if(!this.childEl)return undefined;if("value"in this.childEl){return this.childEl.value}return this.childEl.getAttribute?.("value")}updateValue(t,i={}){const e=this.currentValue;this.currentValue=t;if(i.emitChange!==false&&!Object.is(e,t)){this.valueChange.emit({value:this.currentValue})}if(!i.suppressValidation&&this.autoValidateActive&&this.hasInteracted){this.scheduleValidation()}}async validateCurrentValue(t=false){if(!this.schema)return true;const i=this.currentValue??this.readValueFromChild();this.currentValue=i;let e;if(this.asyncValidation){e=await this.schema.safeParseAsync(i)}else{e=this.schema.safeParse(i)}const r=e.success;const s=this.isValid;this.isValid=r;if(!e.success){this.errorMessage=e.error.issues[0]?.message??""}else{this.errorMessage=""}const a=t||this.autoValidateActive&&this.hasInteracted;if(a){this.updateAriaValidity(r);if(s!==r){this.emitValidationChange()}}return r}updateAriaValidity(t){if(!this.childEl)return;if(t){this.childEl.removeAttribute("aria-invalid")}else{this.childEl.setAttribute("aria-invalid","true")}}emitValidationChange(){this.validationChange.emit({valid:this.isValid,value:this.currentValue})}attachFormListener(){this.formEl=this.resolveFormRef();this.formEl?.addEventListener("submit",this.handleFormSubmit,true)}detachFormListener(){this.formEl?.removeEventListener("submit",this.handleFormSubmit,true);this.formEl=undefined}resolveFormRef(){if(typeof document!=="undefined"&&this.form){const t=document.getElementById(this.form);if(t&&t instanceof HTMLFormElement){return t}}return this.el.closest("form")}handleFormSubmit=async()=>{this.hasInteracted=true;const t=await this.flushValidation();if(!t&&!this.autoValidateActive){this.autoValidateActive=true}};async scheduleValidation(t=false){this.clearValidationTimer();const i=Number(this.validationDebounce);if(t||!isFinite(i)||i<=0){return await this.validateCurrentValue(true)}this.validationTimer=setTimeout((async()=>{this.validationTimer=undefined;await this.validateCurrentValue(true)}),i);return this.isValid}async flushValidation(){return await this.scheduleValidation(true)}clearValidationTimer(){if(this.validationTimer!==undefined){clearTimeout(this.validationTimer);this.validationTimer=undefined}}render(){return r(s,{key:"7a06c9e35c5406b1f9efee6b5487488dd225975f"},r("slot",{key:"f807e82ac059a03f64790c13a84855a6ef52b322"}),!this.isValid&&this.showErrorMessage&&r("span",{key:"80379a18b151f9e4fd88f665dc59d31fa2f7682b",part:"error-message",class:"error-message"},this.errorMessage))}static get watchers(){return{schema:["handleSchemaChange"],autovalidate:["handleAutoValidatePropChange"],form:["handleFormPropChange"],valueEvent:["handleValueEventChange"],blurEvent:["handleBlurEventChange"],value:["handleValuePropChange"]}}};v.style=x;export{h as ir_input_text,f as ir_picker,b as ir_picker_item,v as ir_validator};
//# sourceMappingURL=p-a1b552d4.entry.js.map