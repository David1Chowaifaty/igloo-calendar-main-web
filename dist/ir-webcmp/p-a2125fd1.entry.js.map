{"version":3,"names":["irBookingEmailLogsCss","IrBookingEmailLogsStyle0","IrBookingEmailLogs","constructor","hostRef","this","token","Token","componentWillLoad","ticket","setToken","handleTicketChange","render","h","Host","key","class","handledEndpoints","style","gap","inputContainerStyle","margin","value","bookingNumber","onTextChange","e","detail","placeholder","size","text","onClickHandler","async","data","axios","post","BOOK_NBR","ExceptionMsg","My_Result","JSON","stringify","getAllParams","params","URLSearchParams","window","location","search","out","entries","irBookingListingCss","IrBookingListingStyle0","IrBookingListing","language","rowCount","isLoading","currentPage","totalPages","oldStartValue","editBookingItem","showCost","bookingListingService","BookingListingService","bookingService","BookingService","roomService","RoomService","statusColors","baseUrl","setBaseUrl","updateUserSelection","booking_listing","initializeApp","onBookingListingChange","newValue","newTotal","total_count","Math","ceil","some","booking","financial","gross_cost","ticketChanged","oldValue","propertyid","p","Error","propertyId","propertyData","getExposedProperty","id","aname","is_backend","requests","getSetupEntriesByTableNameMulti","getExposedBookingsCriteria","fetchLanguage","push","setupEntries","Promise","all","pay_type","pay_type_group","pay_method","groupEntryTablesResult","paymentEntries","groups","methods","types","getExposedBookings","Object","assign","userSelection","is_to_export","error","console","handleSideBarToggle","geSearchFiltersFromParams","log","obj","Number","s","status","filter","from","to","updateUserSelections","getPaginationBounds","totalCount","startItem","endItem","openModal","listingModalTimeout","setTimeout","listingModal","el","querySelector","editBooking","disconnectedCallback","clearTimeout","handleResetData","stopImmediatePropagation","stopPropagation","handleResetStoreData","handleBookingChanged","bookings","map","b","booking_nbr","renderItemRange","locales","Lcz_View","Lcz_Of","updateData","start_row","end_row","calculateTotalPersons","sumOfOccupancy","adult_nbr","children_nbr","infant_nbr","rooms","reduce","prev","cur","occupancy","scope","_a","Lcz_Booking","_b","Lcz_BookedOn","_c","Lcz_GuestSource","_d","Lcz_Services","_e","Lcz_Dates","_f","Lcz_Amount","customSlot","message","_g","Lcz_BookingBalance","_h","Lcz_ClickToSettle","slot","_j","Lcz_Balance","_k","Lcz_Cost","_l","Lcz_Status","length","colSpan","_m","Lcz_NoDataAvailable","_o","confirmationBG","is_requested_to_cancel","code","lastManipulation","ota_manipulations","totalPersons","btn_color","btnStyle","padding","cause","channel_booking_nbr","moment","booked_on","date","format","_formatTime","hour","toString","minute","width","src","origin","Icon","alt","Label","guest","first_name","last_name","labelStyle","nbr_confirmed_bookings","agent","Lcz_BookingsNbr","replace","color","name","Lcz_P","getPrivateNote","extras","is_in_loyalty_mode","promo_key","xmlns","viewBox","height","Lcz_LoyaltyDiscountApplied","fill","d","stroke","Lcz_Coupon","room","roomtype","unit","isSingleUnit","substring","extra_services","Lcz_ExtraServices","from_date","to_date","whiteSpace","formatAmount","currency","symbol","gross_total","due_amount","onClick","Lcz_CancellationRequested","description","events","type","toLowerCase","marginTop","marginBottom","trigger","content","user","title","variant","icon_name","btn_disabled","selectedValue","showFirstOption","onSelectChange","Array","_","i","onModalClosed","onIrSidebarToggle","bind","open","includes","showCloseButton","sidebarStyles","_p","background","_q","hasPrint","hasReceipt","is_from_front_desk","hasRoomEdit","hasRoomDelete","hasCloseButton","onCloseSidebar","hasRoomAdd","_r","isInSideBar","headerShown","_t","_s","email","_v","_u","onCloseSideBar","PropertyService","results","calendar_data","adultChildConstraints","adult_child_constraints","allowedBookingSources","allowed_booking_sources","allowed_payment_methods","is_vacation_rental","pickup_service","max_nights","roomsInfo","roomtypes","taxes","country","is_automatic_check_in_out","tax_statement","is_frontdesk_enabled","is_pms_enabled","spitTime","time_constraints","check_out_till","split","checkin_checkout_hours","offset","city","gmt_offset","getCountrySales","is_export_to_excel","downloadFile","My_Params_Get_Country_Sales","Link_excel","getDailyRevenueReport","My_Params_Get_Daily_Revenue_Report","setExposedCleaningFrequency","getMonthlyStats","My_Params_Get_Monthly_Stats","irDailyRevenueCss","IrDailyRevenueStyle0","IrDailyRevenue","filters","users","tokenService","propertyService","handleSidebarClose","sideBarEvent","handleOpenSidebar","handleFetchNewReports","getPaymentReports","handleResetBooking","renderSidebarBody","property_id","payload","isPageLoading","include_units_hk_status","groupPaymentsByName","payments","groupedPayment","Map","payment","payTypeCode","payMethodCode","get","set","sort","a","aNum","bNum","isNaN","localeCompare","isExportToExcel","excludeYesterday","getReportObj","report","method","METHOD","PAY_TYPE_CODE","PAY_METHOD_CODE","amount","AMOUNT","DATE","HOUR","MINUTE","USER","CURRENCY","bookingNbr","BOOKING_NBR","v4","add","previousDateGroupedPayments","Lcz_Export","iconPosition","icon_style","groupedPayments","Boolean","irHkTasksCss","IrHkTasksStyle0","IrHkTasks","isCleaningLoading","selectedDuration","selectedHouseKeeper","selectedRoom","archiveOpened","hkNameCache","houseKeepingService","HouseKeepingService","table_sorting","init","handleCloseSidebar","isSidebarOpen","handleSortingChanged","field","direction","handleSkipSelectedTask","modalCauses","task","modal","setLoading","getExposedHKSetup","tasksResult","getHkTasks","housekeepers","cleaning_frequency","housekeeping_store","hk_criteria","cleaning_frequencies","dusty_window","dusty_periods","highlight_window","highlight_checkin_options","tasks","updateTasks","buildHousekeeperNameCache","forEach","hk","updateTasksStore","t","housekeeper","hkm_id","hkName","find","handleHeaderButtonPress","sortingArray","url","fetchTasksWithFilters","handleSelectedTaskCleaningEvent","handleModalConfirmation","hkTasksStore","selectedTasks","editHkSkip","COMMENT","HK_SKIP_ID","HK_SKIP_REASON_CODE","PR_ID","executeHKAction","actions","unit_id","clearSelectedTasks","closeModal","applyFilters","isApplyFiltersLoading","export_to_excel","cleaning_periods","dusty_units","highlight_check_ins","onApplyFilters","onRowSelectChange","updateSelectedTasks","autoClose","ref","onConfirmModal","onCancelModal","iconAvailable","icon","leftBtnText","Lcz_Cancel","rightBtnText","Lcz_Confirm","leftBtnColor","rightBtnColor","modalTitle","Lcz_Confirmation","modalBody","getToken","irHousekeepingCss","IrHousekeepingStyle0","IrHousekeeping","include_sales_rate_plans","updateHKStore","housekeeping_enabled","selectedCleaningFrequency","saveAutomaticCheckInCheckout","SetAutomaticCheckInOut","default_properties","flag","toast","emit","position","saveCleaningFrequency","Lcz_HouseKeepingAndCheckInSetup","borderShown","label","Lcz_CheckInOutGuestsAutomatically","Lcz_YesAsPerPropertyPolicy","Lcz_NoIWillDoItManually","Lcz_CleaningFrequency","v","isRequestPending","irMonthlyBookingsReportCss","IrMonthlyBookingsReportStyle0","IrMonthlyBookingsReport","reports","baseFilters","firstOfMonth","startOf","lastOfMonth","endOf","include_previous_year","handleApplyFiltersChange","getReports","day","Date","units_booked","Units_booked","occupancy_percent","Occupancy","adr","ADR","rooms_revenue","Rooms_Revenue","total_guests","Total_Guests","currentReports","enrichedReports","DailyStats","rest","__rest$1","stats","previousYearReports","formattedReports","current","previous","last_year","alignItems","Occupancy_Difference_From_Previous_Month","cardTitle","AverageOccupancy","toFixed","subtitle","TotalUnitsBooked","PeakDays","pd","concat","join","max","OccupancyPercent","irSalesByCountryCss","IrSalesByCountryStyle0","IrSalesByCountry","countries","FROM_DATE","TO_DATE","BOOK_CASE","WINDOW","salesFilters","getCountries","mappedCountries","formatSalesData","COUNTRY","country_id","COUNTRY_ID","nights","NIGHTS","percentage","PCT","revenue","REVENUE","number_of_guests","filterParams","__rest","currentSales","AC_ID","shouldFetchPreviousYear","enrichedSales","previousYearSales","subtract","record","salesData","salesReports","records","irUserManagementCss","IrUserManagementStyle0","IrUserManagement","isSuperAdmin","allowedUsersTypes","userService","UserService","userTypes","superAdminId","fetchUsers","fetchUserTypes","socket","io","on","msg","handleSocketMessage","msgAsObject","parse","REASON","KEY","PAYLOAD","result","reasonHandlers","EMAIL_VERIFIED","updateUserVerificationStatus","handler","call","warn","idx","findIndex","u","is_email_verified","getExposedPropertyUsers","u1","u2","priority","p1","p2","username","res","getSetupEntriesByTableName","getLov","allowedUsers","allowed_user_types","toUpperCase","f","CODE_NAME","disconnect","suppressToastEndpoints","Lcz_ExtranetUsers","baseUserTypeCode","userTypeCode","haveAdminPrivileges"],"sources":["src/components/ir-booking-email-logs/ir-booking-email-logs.css?tag=ir-booking-email-logs&encapsulation=scoped","src/components/ir-booking-email-logs/ir-booking-email-logs.tsx","src/utils/browserHistory.ts","src/components/ir-booking-listing/ir-booking-listing.css?tag=ir-booking-listing&encapsulation=scoped","src/components/ir-booking-listing/ir-booking-listing.tsx","src/services/property.service.ts","src/components/ir-daily-revenue/ir-daily-revenue.css?tag=ir-daily-revenue&encapsulation=scoped","src/components/ir-daily-revenue/ir-daily-revenue.tsx","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.css?tag=ir-hk-tasks&encapsulation=scoped","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.tsx","src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.css?tag=ir-monthly-bookings-report&encapsulation=scoped","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.tsx","src/components/ir-sales-by-country/ir-sales-by-country.css?tag=ir-sales-by-country&encapsulation=scoped","src/components/ir-sales-by-country/ir-sales-by-country.tsx","src/components/ir-user-management/ir-user-management.css?tag=ir-user-management&encapsulation=scoped","src/components/ir-user-management/ir-user-management.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport axios from 'axios';\n\n@Component({\n  tag: 'ir-booking-email-logs',\n  styleUrl: 'ir-booking-email-logs.css',\n  scoped: true,\n})\nexport class IrBookingEmailLogs {\n  @Prop() ticket: string;\n\n  @State() data: any[];\n  @State() bookingNumber: string;\n\n  private token = new Token();\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n  }\n\n  @Watch('ticket')\n  handleTicketChange() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n  }\n\n  render() {\n    return (\n      <Host class=\"p-1\">\n        <ir-interceptor handledEndpoints={['/Get_Email_log_By_BOOK_NBR']}></ir-interceptor>\n        <ir-toast></ir-toast>\n        <div class=\"d-flex align-items-center mb-1\" style={{ gap: '0.5rem' }}>\n          <ir-input-text\n            class=\"m-0\"\n            inputContainerStyle={{ margin: '0' }}\n            value={this.bookingNumber}\n            onTextChange={e => (this.bookingNumber = e.detail)}\n            placeholder=\"booking number\"\n          ></ir-input-text>\n          <ir-button\n            size=\"sm\"\n            text=\"search\"\n            onClickHandler={async () => {\n              const { data } = await axios.post('/Get_Email_log_By_BOOK_NBR', {\n                BOOK_NBR: this.bookingNumber,\n              });\n              if (data.ExceptionMsg) {\n                return;\n              }\n              this.data = data.My_Result;\n            }}\n          ></ir-button>\n        </div>\n        <p>{JSON.stringify(this.data, null, 2)}</p>\n      </Host>\n    );\n  }\n}\n","// src/utils/browserHistory.ts\n\n/**\n * A small utility for reading and writing browser history\n * and manipulating URL search params in a type-safe way.\n */\n\ntype Parser<T> = (value: string | null) => T;\n\n// Common parsers/serializers\nexport const ParamTypes = {\n  string: {\n    parse: (v: string | null): string => v ?? '',\n    serialize: (v: string): string => v,\n  },\n  number: {\n    parse: (v: string | null): number => {\n      if (v == null || v === '') return NaN;\n      const n = Number(v);\n      return isNaN(n) ? NaN : n;\n    },\n    serialize: (v: number): string => String(v),\n  },\n  boolean: {\n    parse: (v: string | null): boolean => v === 'true',\n    serialize: (v: boolean): string => (v ? 'true' : 'false'),\n  },\n} as const;\n\n/**\n * Read a single search‑param, parse it, and return a typed value.\n * Falls back to defaultValue if missing or parse fails.\n */\nexport function getParam<T>(key: string, { parse }: { parse: Parser<T> }, defaultValue: T): T {\n  const params = new URLSearchParams(window.location.search);\n  const raw = params.get(key);\n  try {\n    if (raw == null) return defaultValue;\n    return parse(raw);\n  } catch {\n    return defaultValue;\n  }\n}\n\n/** Helpers for the three built‑in types */\nexport function getStringParam(key: string, defaultValue = ''): string {\n  return getParam(key, ParamTypes.string, defaultValue);\n}\n\nexport function getNumberParam(key: string, defaultValue = NaN): number {\n  return getParam(key, ParamTypes.number, defaultValue);\n}\n\nexport function getBooleanParam(key: string, defaultValue = false): boolean {\n  return getParam(key, ParamTypes.boolean, defaultValue);\n}\n\n/**\n * Read all current search params into a Record<string, string>\n */\nexport function getAllParams(): Record<string, string> {\n  const params = new URLSearchParams(window.location.search);\n  const out: Record<string, string> = {};\n  for (const [key, value] of params.entries()) {\n    out[key] = value;\n  }\n  return out;\n}\n\ninterface SetParamsOptions {\n  /** if true, uses replaceState instead of pushState */\n  replace?: boolean;\n}\n\n/**\n * Update one or more search params.\n * Pass null to delete a param.\n * By default uses history.pushState; set replace: true to call replaceState.\n */\nexport function setParams(updates: Record<string, string | number | boolean | null>, options: SetParamsOptions = {}): void {\n  const params = new URLSearchParams(window.location.search);\n\n  for (const [key, value] of Object.entries(updates)) {\n    if (!value) {\n      params.delete(key);\n    } else {\n      params.set(key, String(value));\n    }\n  }\n\n  const newSearch = params.toString();\n  const newUrl = window.location.pathname + (newSearch ? `?${newSearch}` : '') + window.location.hash;\n\n  if (options.replace) {\n    window.history.replaceState(window.history.state, '', newUrl);\n  } else {\n    window.history.pushState(window.history.state, '', newUrl);\n  }\n}\n\n/**\n * Push a new history entry.\n * `path` may include search or hash.\n * `state` is the history state object.\n */\nexport function pushHistory(path: string, state: any = {}): void {\n  window.history.pushState(state, '', path);\n}\n\n/**\n * Replace the current history entry.\n * `path` may include search or hash.\n * `state` is the history state object.\n */\nexport function replaceHistory(path: string, state: any = {}): void {\n  window.history.replaceState(state, '', path);\n}\n",":host {\n  display: block;\n  height: 100%;\n}\n.logo {\n  height: 2rem;\n  width: 2rem;\n}\n.card {\n  overflow-x: auto;\n}\n.secondary-p {\n  font-size: 12px !important;\n}\n.room-service {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n  width: 100%;\n  padding: 0.25rem 0;\n}\n.room-name-container {\n  background: #acecff;\n  padding: 0.1rem 0.3rem;\n  border-radius: 5px;\n  /* cursor: pointer; */\n\n  /* max-width: max-content; */\n}\n.h-screen {\n  height: 100%;\n}\n.price-span {\n  margin: 0;\n  margin-right: 5px;\n}\n.main-container {\n  height: 100%;\n  overflow-y: auto;\n}\n.badge.ct_ir_badge {\n  padding: 0.2rem 0.3rem;\n}\n.yellow_dot {\n  height: 0.5rem;\n  width: 0.5rem;\n  height: 0.5rem;\n  width: 0.8rem;\n  border-radius: 50%;\n  background: rgb(244, 213, 82);\n  margin-left: 0.5rem;\n  display: inline-flex;\n  padding: 0;\n  margin: 0;\n}\n.booking_name {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n}\n.bg-ir-red {\n  background: #ff4961;\n  padding: 0.2rem 0.3rem;\n}\n.due-btn {\n  border: 1px solid #ff4961;\n  color: #ff4961;\n  cursor: pointer;\n  padding: 1px 0.25rem !important;\n  font-size: 12px !important;\n}\n.due-btn:hover {\n  background: #ff4961;\n  color: white;\n}\n.booking_number {\n  all: unset;\n  cursor: pointer;\n}\n.booking_number:hover {\n  color: #1e9ff2;\n}\n.in-out {\n  width: 150px !important;\n}\n.booking_guest_name {\n  width: fit-content;\n  padding: 0 !important;\n  margin: 0;\n}\n.booking_guest_name .button-text {\n  padding: 0 !important;\n}\n.buttons-container {\n  gap: 10px;\n}\ntd ul {\n  width: max-content !important;\n}\ntd {\n  width: max-content !important ;\n}\n.date-p {\n  width: max-content !important;\n  min-width: 100%;\n  text-align: center !important;\n}\n.booking-label-gap {\n  gap: 5px;\n}\n@media (min-width: 1024px) {\n  .yellow_dot {\n    height: 0.5rem;\n    width: 0.5rem;\n  }\n}\n","import { Booking, IUnit, Occupancy } from '@/models/booking.dto';\nimport { BookingListingService } from '@/services/booking_listing.service';\nimport { RoomService } from '@/services/room.service';\nimport booking_listing, { updateUserSelection, onBookingListingChange, IUserListingSelection, updateUserSelections } from '@/stores/booking_listing.store';\nimport locales from '@/stores/locales.store';\nimport { formatAmount } from '@/utils/utils';\nimport { Component, Host, Prop, State, Watch, h, Element, Listen } from '@stencil/core';\nimport moment from 'moment';\nimport { _formatTime } from '../ir-booking-details/functions';\nimport { getPrivateNote } from '@/utils/booking';\nimport Token from '@/models/Token';\nimport { isSingleUnit } from '@/stores/calendar-data';\nimport { getAllParams } from '@/utils/browserHistory';\nimport { BookingService } from '@/services/booking.service';\nimport { PaymentEntries } from '../ir-booking-details/types';\n\n@Component({\n  tag: 'ir-booking-listing',\n  styleUrl: 'ir-booking-listing.css',\n  scoped: true,\n})\nexport class IrBookingListing {\n  @Element() el: HTMLElement;\n\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() rowCount: number = 10;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n  @State() currentPage = 1;\n  @State() totalPages = 1;\n  @State() oldStartValue = 0;\n  @State() editBookingItem: { booking: Booking; cause: 'edit' | 'payment' | 'delete' | 'guest' } | null = null;\n  @State() showCost = false;\n  @State() paymentEntries: PaymentEntries;\n\n  private bookingListingService = new BookingListingService();\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private token = new Token();\n\n  private listingModal: HTMLIrListingModalElement;\n  private listingModalTimeout: NodeJS.Timeout;\n  private statusColors = {\n    '001': 'badge-warning',\n    '002': 'badge-success',\n    '003': 'badge-danger',\n    '004': 'badge-danger',\n  };\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    updateUserSelection('end_row', this.rowCount);\n    booking_listing.rowCount = this.rowCount;\n    if (this.ticket !== '') {\n      booking_listing.token = this.ticket;\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n    onBookingListingChange('userSelection', async newValue => {\n      const newTotal = newValue.total_count;\n      this.totalPages = Math.ceil(newTotal / this.rowCount);\n    });\n    onBookingListingChange('bookings', async newValue => {\n      this.showCost = newValue.some(booking => booking.financial.gross_cost !== null && booking.financial.gross_cost > 0);\n    });\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    booking_listing.token = this.ticket;\n    this.initializeApp();\n  }\n\n  async initializeApp() {\n    try {\n      this.isLoading = true;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      let propertyId = this.propertyid;\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n\n      const requests = [\n        this.bookingService.getSetupEntriesByTableNameMulti(['_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n        this.bookingListingService.getExposedBookingsCriteria(propertyId),\n        this.roomService.fetchLanguage(this.language, ['_BOOKING_LIST_FRONT']),\n      ];\n\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n          }),\n        );\n      }\n\n      const [setupEntries] = await Promise.all(requests);\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries as any);\n      this.paymentEntries = {\n        groups: pay_type_group,\n        methods: pay_method,\n        types: pay_type,\n      };\n      updateUserSelection('property_id', propertyId);\n      // this.geSearchFiltersFromParams();\n      await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  handleSideBarToggle(e: CustomEvent<boolean>) {\n    if (e.detail) {\n      this.editBookingItem = null;\n    }\n  }\n  geSearchFiltersFromParams() {\n    //e=10&status=002&from=2025-04-15&to=2025-04-22&filter=2&c=Alitalia+Cabin+Crew\n    const params = getAllParams();\n    if (params) {\n      console.log('update params');\n      let obj: Partial<IUserListingSelection> = {};\n      if (params.e) {\n        obj['end_row'] = Number(params.e);\n      }\n      if (params.s) {\n        obj['start_row'] = Number(params.s);\n      }\n      if (params.status) {\n        obj['booking_status'] = params.status;\n      }\n      if (params.filter) {\n        obj['filter_type'] = params.filter;\n      }\n      if (params.from) {\n        obj['from'] = params.from;\n      }\n      if (params.to) {\n        obj['to'] = params.to;\n      }\n      updateUserSelections(obj);\n    }\n    console.log('params=>', params);\n  }\n  getPaginationBounds() {\n    const totalCount = booking_listing.userSelection.total_count;\n    const startItem = (this.currentPage - 1) * this.rowCount;\n    let endItem = this.currentPage * this.rowCount;\n    endItem = endItem > totalCount ? totalCount : endItem;\n    return { startItem, endItem, totalCount };\n  }\n\n  openModal() {\n    this.listingModalTimeout = setTimeout(() => {\n      this.listingModal = this.el.querySelector('ir-listing-modal');\n      this.listingModal.editBooking = this.editBookingItem;\n      this.listingModal.openModal();\n    }, 100);\n  }\n  disconnectedCallback() {\n    clearTimeout(this.listingModalTimeout);\n  }\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\n  }\n\n  @Listen('resetBookingData')\n  async handleResetStoreData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\n  }\n  @Listen('bookingChanged')\n  handleBookingChanged(e: CustomEvent<Booking>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    booking_listing.bookings = [\n      ...booking_listing.bookings.map(b => {\n        if (b.booking_nbr === e.detail.booking_nbr) {\n          return e.detail;\n        }\n        return b;\n      }),\n    ];\n  }\n\n  renderItemRange() {\n    const { endItem, startItem, totalCount } = this.getPaginationBounds();\n    return `${locales.entries.Lcz_View} ${startItem + 1} - ${endItem} ${locales.entries.Lcz_Of} ${totalCount}`;\n  }\n\n  async updateData() {\n    const { endItem, startItem } = this.getPaginationBounds();\n    // setParams({\n    //   s: startItem,\n    //   e: endItem,\n    // });\n    await this.bookingListingService.getExposedBookings({\n      ...booking_listing.userSelection,\n      is_to_export: false,\n      start_row: startItem,\n      end_row: endItem,\n    });\n  }\n  private calculateTotalPersons(booking: Booking) {\n    const sumOfOccupancy = ({ adult_nbr, children_nbr, infant_nbr }: Occupancy) => {\n      return (adult_nbr ?? 0) + (children_nbr ?? 0) + (infant_nbr ?? 0);\n    };\n    return booking.rooms.reduce((prev, cur) => {\n      return sumOfOccupancy(cur.occupancy) + prev;\n    }, 0);\n  }\n  render() {\n    if (this.isLoading || this.ticket === '') {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-interceptor></ir-interceptor>\n        <ir-toast></ir-toast>\n        <div class=\"p-1 main-container\">\n          <ir-listing-header propertyId={this.propertyid} p={this.p} language={this.language}></ir-listing-header>\n          <section>\n            <div class=\"card p-1 flex-fill m-0 mt-2\">\n              <table class=\"table table-striped table-bordered no-footer dataTable\">\n                <thead>\n                  <tr>\n                    <th scope=\"col\" class=\"text-left\">\n                      {locales.entries?.Lcz_Booking}#\n                    </th>\n                    <th scope=\"col\">{locales.entries?.Lcz_BookedOn}</th>\n                    <th scope=\"col\">{locales.entries?.Lcz_GuestSource}</th>\n                    <th scope=\"col\" class=\"text-left services-cell\">\n                      {locales.entries?.Lcz_Services}\n                    </th>\n                    <th scope=\"col\" class=\"in-out\">\n                      {locales.entries?.Lcz_Dates}\n                    </th>\n                    <th scope=\"col\">\n                      <span class=\"price-span\">{locales.entries?.Lcz_Amount}</span>\n\n                      <ir-tooltip\n                        customSlot\n                        message={`<span style=\"width:100%;display:block;\">${locales.entries?.Lcz_BookingBalance}</span><span>${locales.entries?.Lcz_ClickToSettle}</span>`}\n                      >\n                        <span slot=\"tooltip-trigger\" class={'m-0 btn due-btn'}>\n                          {locales.entries?.Lcz_Balance}\n                        </span>\n                      </ir-tooltip>\n                    </th>\n                    {this.showCost && (\n                      <th scope=\"col\" class=\"services-cell\">\n                        {locales.entries?.Lcz_Cost}\n                      </th>\n                    )}\n                    <th scope=\"col\">{locales.entries?.Lcz_Status}</th>\n                    <th scope=\"col\">\n                      <p class=\"sr-only\">actions</p>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody class=\"\">\n                  {booking_listing.bookings.length === 0 && (\n                    <tr>\n                      <td colSpan={8}>{locales.entries?.Lcz_NoDataAvailable}</td>\n                    </tr>\n                  )}\n                  {booking_listing.bookings?.map(booking => {\n                    let confirmationBG: string = this.statusColors[booking.is_requested_to_cancel ? '003' : booking.status.code];\n                    const lastManipulation = booking.ota_manipulations ? booking.ota_manipulations[booking.ota_manipulations.length - 1] : null;\n                    const totalPersons = this.calculateTotalPersons(booking);\n                    return (\n                      <tr key={booking.booking_nbr}>\n                        <td class=\"text-left\">\n                          <ir-button\n                            btn_color=\"link\"\n                            btnStyle={{ padding: '0', margin: '0' }}\n                            onClickHandler={() => (this.editBookingItem = { booking, cause: 'edit' })}\n                            text={booking.booking_nbr}\n                          ></ir-button>\n                          {booking.channel_booking_nbr && <p class=\"p-0 m-0 text-center secondary-p\">{booking.channel_booking_nbr}</p>}\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.booked_on.date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                          <p class=\"p-0 m-0 secondary-p\">{_formatTime(booking.booked_on.hour.toString(), booking.booked_on.minute.toString())}</p>\n                        </td>\n                        <td>\n                          <div class=\"h-100 d-flex align-items-center \" style={{ width: 'max-content' }}>\n                            <img class=\"mr-2 logo\" src={booking.origin.Icon} alt={booking.origin.Label} />\n                            <div class=\"text-left\">\n                              <div class=\"d-flex align-items-center\">\n                                <div class=\"booking_name m-0 p-0\">\n                                  <ir-button\n                                    btn_color=\"link\"\n                                    onClickHandler={() => (this.editBookingItem = { booking, cause: 'guest' })}\n                                    text={`${booking.guest.first_name} ${booking.guest.last_name ?? ''}`}\n                                    btnStyle={{\n                                      width: 'fit-content',\n                                      padding: '0',\n                                      margin: '0',\n                                    }}\n                                    labelStyle={{\n                                      padding: '0',\n                                    }}\n                                  ></ir-button>\n                                  {booking.guest.nbr_confirmed_bookings > 1 && !booking.agent && (\n                                    <div class=\"m-0 p-0\">\n                                      <ir-tooltip message={`${locales.entries.Lcz_BookingsNbr}`.replace('%1', booking.guest.nbr_confirmed_bookings.toString())} customSlot>\n                                        <div class=\"d-flex align-items-center my-0 p-0\" slot=\"tooltip-trigger\">\n                                          <ir-icons style={{ '--icon-size': '0.875rem' }} color=\"#FB0AAD\" name=\"heart-fill\"></ir-icons>\n                                        </div>\n                                      </ir-tooltip>\n                                    </div>\n                                  )}\n                                  {/* <button\n                                    class=\"booking_number p-0 m-0 \"\n                                    onClick={() => {\n                                      this.editBookingItem = { booking, cause: 'guest' };\n                                    }}\n                                  ></button> */}\n                                  <span class={'p-0 m-0'}>\n                                    {/* {booking.occupancy.adult_nbr} */}\n                                    {totalPersons}\n                                    {locales.entries.Lcz_P}\n                                  </span>\n                                  {getPrivateNote(booking.extras) && <span class=\"yellow_dot\"></span>}\n                                </div>\n                              </div>\n                              <div class={'d-flex align-items-center booking-label-gap'}>\n                                <p class=\"p-0 m-0 secondary-p\">{booking.origin.Label}</p>\n                                {booking.is_in_loyalty_mode && !booking.promo_key && (\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\n                                    <title>{locales.entries.Lcz_LoyaltyDiscountApplied}</title>\n                                    <path\n                                      fill=\"#fc6c85\"\n                                      d=\"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z\"\n                                    />\n                                  </svg>\n                                )}\n                                {booking.promo_key && (\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" height={18} width={18}>\n                                    <title>{locales.entries.Lcz_Coupon + ':' + booking.promo_key}</title>\n                                    <path\n                                      stroke-linecap=\"round\"\n                                      stroke-linejoin=\"round\"\n                                      d=\"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z\"\n                                    />\n                                  </svg>\n                                )}\n                              </div>\n                              {/* {booking.agent && <p class=\"m-0 secondary-p\">{locales.entries.Lcz_AgentCode.replace('%1', booking.agent.name)}</p>} */}\n                            </div>\n                          </div>\n                        </td>\n\n                        <td>\n                          <ul>\n                            {booking.rooms.map(room => (\n                              <li>\n                                <div class={'room-service'}>\n                                  <p class={'m-0 p-0'}>{room.roomtype.name}</p>\n                                  {room.unit &&\n                                    !isSingleUnit(room.roomtype.id) &&\n                                    ((room.unit as IUnit)?.name?.length > 4 ? (\n                                      <ir-tooltip customSlot message={(room.unit as IUnit)?.name}>\n                                        <p class={'room-name-container cursor-pointer m-0'} slot=\"tooltip-trigger\">\n                                          {(room.unit as IUnit)?.name?.substring(0, 4)}\n                                        </p>\n                                      </ir-tooltip>\n                                    ) : (\n                                      <p class={'room-name-container  m-0'}>{(room.unit as IUnit)?.name?.substring(0, 4)}</p>\n                                    ))}\n                                </div>\n                              </li>\n                            ))}\n                            {booking.extra_services && <li>{locales.entries.Lcz_ExtraServices}</li>}\n                          </ul>\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.from_date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.to_date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0\" style={{ whiteSpace: 'nowrap' }}>\n                            {formatAmount(booking.currency.symbol, booking.financial?.gross_total ?? 0)}\n                          </p>\n                          {booking.financial.due_amount > 0 && (\n                            <buuton\n                              onClick={() => {\n                                this.editBookingItem = { booking, cause: 'payment' };\n                                this.openModal();\n                              }}\n                              style={{ whiteSpace: 'nowrap' }}\n                              class=\"btn p-0 m-0 due-btn\"\n                            >\n                              {formatAmount(booking.currency.symbol, booking.financial.due_amount)}\n                            </buuton>\n                          )}\n                        </td>\n                        {this.showCost && (\n                          <td>\n                            {booking.financial.gross_cost !== null && booking.financial.gross_cost === 0\n                              ? '_'\n                              : formatAmount(booking.currency.symbol, booking.financial.gross_cost)}\n                          </td>\n                        )}\n\n                        <td>\n                          <p class={`m-0 badge ${confirmationBG} ct_ir_badge`}>\n                            {booking.is_requested_to_cancel ? locales?.entries?.Lcz_CancellationRequested : booking.status.description}\n                          </p>\n                          {!lastManipulation && booking.events?.length > 0 && booking.events[0].type.toLowerCase() === 'modified' && (\n                            <p class=\"mx-0 p-0 small\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                              Modified\n                            </p>\n                          )}\n                          {lastManipulation && (\n                            <ir-popover\n                              trigger=\"hover\"\n                              content={`Modified by ${lastManipulation.user} at ${lastManipulation.date} ${lastManipulation.hour}:${lastManipulation.minute}`}\n                            >\n                              <p class=\"mx-0 p-0 small text-danger\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                                <b>Modified</b>\n                              </p>\n                            </ir-popover>\n                          )}\n                        </td>\n                        <td>\n                          <div class=\"d-flex justify-content-center align-items-center\" style={{ gap: '8px' }}>\n                            <ir-button title=\"Edit booking\" variant=\"icon\" icon_name=\"edit\" onClickHandler={() => (this.editBookingItem = { booking, cause: 'edit' })}></ir-button>\n                            <ir-button\n                              title=\"Delete booking\"\n                              style={{ '--icon-button-color': '#ff4961', '--icon-button-hover-color': '#FF1635' }}\n                              variant=\"icon\"\n                              icon_name=\"trash\"\n                              onClickHandler={() => {\n                                this.editBookingItem = { booking, cause: 'delete' };\n                                this.openModal();\n                              }}\n                            ></ir-button>\n                          </div>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n              {this.totalPages > 1 && (\n                <section class={'d-flex flex-column flex-md-row align-items-center justify-content-between pagination-container'}>\n                  <p class=\"m-0 mb-1 mb-md-0\">{this.renderItemRange()}</p>\n                  <div class={'d-flex align-items-center buttons-container'}>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === 1}\n                      onClickHandler={async () => {\n                        this.currentPage = 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angles_left\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === 1}\n                      onClickHandler={async () => {\n                        this.currentPage = this.currentPage - 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angle_left\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-select\n                      selectedValue={this.currentPage.toString()}\n                      showFirstOption={false}\n                      onSelectChange={async e => {\n                        this.currentPage = +e.detail;\n                        await this.updateData();\n                      }}\n                      data={Array.from(Array(this.totalPages), (_, i) => i + 1).map(i => ({\n                        text: i.toString(),\n                        value: i.toString(),\n                      }))}\n                    ></ir-select>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === this.totalPages}\n                      onClickHandler={async () => {\n                        this.currentPage = this.currentPage + 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angle_right\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === this.totalPages}\n                      onClickHandler={async () => {\n                        this.currentPage = this.totalPages;\n                        console.log(this.currentPage);\n                        await this.updateData();\n                      }}\n                      icon_name=\"angles_right\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                  </div>\n                </section>\n              )}\n            </div>\n          </section>\n        </div>\n        {this.editBookingItem && <ir-listing-modal paymentEntries={this.paymentEntries} onModalClosed={() => (this.editBookingItem = null)}></ir-listing-modal>}\n        <ir-sidebar\n          onIrSidebarToggle={this.handleSideBarToggle.bind(this)}\n          open={this.editBookingItem !== null && ['edit', 'guest'].includes(this.editBookingItem.cause)}\n          showCloseButton={false}\n          sidebarStyles={\n            this.editBookingItem?.cause === 'guest' ? { background: 'white' } : { width: this.editBookingItem ? '80rem' : 'var(--sidebar-width,40rem)', background: '#F2F3F8' }\n          }\n        >\n          {this.editBookingItem?.cause === 'edit' && (\n            <ir-booking-details\n              slot=\"sidebar-body\"\n              p={this.p}\n              hasPrint\n              hasReceipt\n              is_from_front_desk\n              propertyid={this.propertyid}\n              hasRoomEdit\n              hasRoomDelete\n              hasCloseButton\n              onCloseSidebar={() => (this.editBookingItem = null)}\n              bookingNumber={this.editBookingItem.booking.booking_nbr}\n              ticket={this.ticket}\n              language={this.language}\n              hasRoomAdd\n            ></ir-booking-details>\n          )}\n          {this.editBookingItem?.cause === 'guest' && (\n            <ir-guest-info\n              slot=\"sidebar-body\"\n              isInSideBar={true}\n              headerShown\n              booking_nbr={this.editBookingItem?.booking?.booking_nbr}\n              email={this.editBookingItem?.booking?.guest.email}\n              language={this.language}\n              onCloseSideBar={() => (this.editBookingItem = null)}\n            ></ir-guest-info>\n          )}\n        </ir-sidebar>\n      </Host>\n    );\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport { downloadFile } from '@/utils/utils';\nimport axios from 'axios';\nexport type CountrySalesParams = {\n  AC_ID: number;\n  WINDOW: number;\n  FROM_DATE: string;\n  TO_DATE: string;\n  BOOK_CASE: string;\n  is_export_to_excel: boolean;\n};\nexport type DailyRevenueReportParams = {\n  date: string;\n  property_id: string;\n  is_export_to_excel: boolean;\n};\nexport type MonthlyStatsParams = {\n  property_id: number;\n  from_date: string;\n  to_date: string;\n  is_export_to_excel?: boolean;\n};\nexport interface MonthlyStatsResults {\n  AverageOccupancy: number;\n  DailyStats: DailyStat[];\n  ExcelLink: null;\n  PeakDays: PeakDay[];\n  Occupancy_Difference_From_Previous_Month: number;\n  TotalUnitsBooked: number;\n  Total_Guests: number;\n}\n\nexport interface PeakDay {\n  Date: string;\n  OccupancyPercent: number;\n}\n\nexport interface DailyStat {\n  Date: string;\n  Occupancy: number;\n  Units_booked: number;\n  Rooms_Revenue: number;\n  ADR: number;\n  Total_Guests: number | undefined;\n}\nexport class PropertyService {\n  public async getExposedProperty(params: {\n    id: number | null;\n    language: string;\n    is_backend?: boolean;\n    aname?: string;\n    include_units_hk_status?: boolean;\n    include_sales_rate_plans?: boolean;\n  }) {\n    try {\n      const { data } = await axios.post(`/Get_Exposed_Property`, params);\n      if (data.ExceptionMsg !== '') {\n        throw new Error(data.ExceptionMsg);\n      }\n      const results = data.My_Result;\n      calendar_data.adultChildConstraints = results.adult_child_constraints;\n      calendar_data.allowedBookingSources = results.allowed_booking_sources;\n      calendar_data.allowed_payment_methods = results.allowed_payment_methods;\n      calendar_data.currency = results.currency;\n      calendar_data.is_vacation_rental = results.is_vacation_rental;\n      calendar_data.pickup_service = results.pickup_service;\n      calendar_data.max_nights = results.max_nights;\n      calendar_data.roomsInfo = results.roomtypes;\n      calendar_data.taxes = results.taxes;\n      calendar_data.id = results.id;\n      calendar_data.country = results.country;\n      calendar_data.name = results.name;\n      calendar_data.is_automatic_check_in_out = results.is_automatic_check_in_out;\n      calendar_data.tax_statement = results.tax_statement;\n      calendar_data.is_frontdesk_enabled = results.is_frontdesk_enabled;\n      calendar_data.is_pms_enabled = results.is_pms_enabled;\n      const spitTime = results?.time_constraints?.check_out_till?.split(':');\n      calendar_data.checkin_checkout_hours = {\n        offset: results.city.gmt_offset,\n        hour: Number(spitTime[0] || 0),\n        minute: Number(spitTime[1] || 0),\n      };\n      return data;\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n  public async getCountrySales(params: CountrySalesParams) {\n    const { data } = await axios.post('/Get_Country_Sales', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    if (params.is_export_to_excel) {\n      downloadFile(data.My_Params_Get_Country_Sales.Link_excel);\n    }\n    return data.My_Result;\n  }\n  public async getDailyRevenueReport(params: DailyRevenueReportParams) {\n    const { data } = await axios.post('/Get_Daily_Revenue_Report', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    if (params.is_export_to_excel) {\n      downloadFile(data.My_Params_Get_Daily_Revenue_Report.Link_excel);\n    }\n    return data.My_Result;\n  }\n  public async setExposedCleaningFrequency(params: { property_id: number; code: string }) {\n    const { data } = await axios.post('/Set_Exposed_Cleaning_Frequency', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    return data.My_Result;\n  }\n  public async getMonthlyStats(params: MonthlyStatsParams): Promise<MonthlyStatsResults> {\n    const { data } = await axios.post('/Get_Monthly_Stats', params);\n    if (data.ExceptionMsg !== '') {\n      throw new Error(data.ExceptionMsg);\n    }\n    if (params.is_export_to_excel) {\n      downloadFile(data.My_Params_Get_Monthly_Stats.Link_excel);\n    }\n    return data.My_Result;\n  }\n}\n",":host {\n  display: block;\n}\n.daily-revenue__meta {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.daily-revenue__table {\n  flex: 1 1 0%;\n}\n\n/*sm*/\n@media (min-width: 768px) {\n  .daily-revenue__meta {\n    flex-direction: row;\n  }\n}\n","import Token from '@/models/Token';\nimport { BookingService } from '@/services/booking.service';\nimport { PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { DailyPaymentFilter, FolioPayment, GroupedFolioPayment, SidebarOpenEvent } from './types';\nimport { v4 } from 'uuid';\nimport moment from 'moment';\nimport { PaymentEntries } from '../ir-booking-details/types';\n\n@Component({\n  tag: 'ir-daily-revenue',\n  styleUrl: 'ir-daily-revenue.css',\n  scoped: true,\n})\nexport class IrDailyRevenue {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isPageLoading: boolean;\n  @State() property_id: number;\n  @State() groupedPayment: GroupedFolioPayment;\n  @State() previousDateGroupedPayments: GroupedFolioPayment;\n  @State() isLoading: string;\n  @State() filters: DailyPaymentFilter = { date: moment().format('YYYY-MM-DD'), users: null };\n  @State() sideBarEvent: SidebarOpenEvent | null;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private bookingService = new BookingService();\n  private paymentEntries: PaymentEntries;\n\n  @Event() preventPageLoad: EventEmitter<null>;\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.tokenService.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('revenueOpenSidebar')\n  handleOpenSidebar(e: CustomEvent<SidebarOpenEvent>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.sideBarEvent = e.detail;\n  }\n  @Listen('fetchNewReports')\n  handleFetchNewReports(e: CustomEvent<DailyPaymentFilter>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.filters = { ...e.detail };\n    this.getPaymentReports();\n  }\n  @Listen('resetBookingEvt')\n  async handleResetBooking(e: CustomEvent) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    this.getPaymentReports(false, true);\n  }\n\n  private handleSidebarClose = (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.sideBarEvent = null;\n  };\n\n  private renderSidebarBody() {\n    if (!this.sideBarEvent) {\n      return;\n    }\n    switch (this.sideBarEvent.type) {\n      case 'booking':\n        return (\n          <ir-booking-details\n            slot=\"sidebar-body\"\n            hasPrint\n            hasReceipt\n            hasCloseButton\n            onCloseSidebar={this.handleSidebarClose}\n            is_from_front_desk\n            propertyid={this.property_id}\n            hasRoomEdit\n            hasRoomDelete\n            bookingNumber={this.sideBarEvent.payload.bookingNumber.toString()}\n            ticket={this.ticket}\n            language={this.language}\n            hasRoomAdd\n          ></ir-booking-details>\n        );\n      default:\n        return null;\n    }\n  }\n\n  private async initializeApp() {\n    this.isPageLoading = true;\n\n    try {\n      let propertyId = this.propertyid;\n      if (!propertyId && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n\n      this.property_id = propertyId;\n\n      const requests: Promise<any>[] = [\n        this.bookingService.getSetupEntriesByTableNameMulti(['_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n        this.getPaymentReports(),\n        this.roomService.fetchLanguage(this.language),\n      ];\n      if (propertyId) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: propertyId,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const [setupEntries] = await Promise.all(requests);\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n      this.paymentEntries = {\n        groups: pay_type_group,\n        methods: pay_method,\n        types: pay_type,\n      };\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n  private groupPaymentsByName(payments: FolioPayment[]): GroupedFolioPayment {\n    const groupedPayment: GroupedFolioPayment = new Map();\n\n    for (const payment of payments) {\n      const key = `${payment.payTypeCode}_${payment.payMethodCode}`;\n      const p = groupedPayment.get(key) ?? [];\n      groupedPayment.set(key, [...p, payment]);\n    }\n    return new Map(\n      [...groupedPayment.entries()].sort(([a], [b]) => {\n        const aNum = Number(a);\n        const bNum = Number(b);\n        if (!isNaN(aNum) && !isNaN(bNum)) {\n          return aNum - bNum;\n        }\n        return a.localeCompare(b);\n      }),\n    );\n  }\n\n  private async getPaymentReports(isExportToExcel = false, excludeYesterday = false) {\n    try {\n      const getReportObj = (report): FolioPayment => {\n        return {\n          method: report.METHOD,\n          payTypeCode: report.PAY_TYPE_CODE,\n          payMethodCode: report.PAY_METHOD_CODE,\n          amount: report.AMOUNT,\n          date: report.DATE,\n          hour: report.HOUR,\n          minute: report.MINUTE,\n          user: report.USER,\n          currency: report.CURRENCY,\n          bookingNbr: report.BOOKING_NBR,\n          id: v4(),\n        };\n      };\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n\n      const requests = [\n        this.propertyService.getDailyRevenueReport({\n          date: this.filters.date,\n          property_id: this.property_id?.toString(),\n          is_export_to_excel: isExportToExcel,\n        }),\n      ];\n      if (!isExportToExcel && !excludeYesterday) {\n        requests.push(\n          this.propertyService.getDailyRevenueReport({\n            date: moment(this.filters.date, 'YYYY-MM-DD').add(-1, 'days').format('YYYY-MM-DD'),\n            property_id: this.property_id?.toString(),\n            is_export_to_excel: isExportToExcel,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      if (!isExportToExcel) {\n        if (results[0]) {\n          this.groupedPayment = this.groupPaymentsByName(results[0]?.map(getReportObj));\n        } else {\n          this.groupedPayment = new Map();\n        }\n        if (results[1]) this.previousDateGroupedPayments = this.groupPaymentsByName(results[1]?.map(getReportObj));\n      }\n    } catch (e) {\n      console.log(e);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Daily Revenue</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries?.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getPaymentReports(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <ir-revenue-summary\n            previousDateGroupedPayments={this.previousDateGroupedPayments}\n            groupedPayments={this.groupedPayment}\n            paymentEntries={this.paymentEntries}\n          ></ir-revenue-summary>\n          <div class=\"daily-revenue__meta\">\n            <ir-daily-revenue-filters isLoading={this.isLoading === 'filter'} payments={this.groupedPayment}></ir-daily-revenue-filters>\n            <ir-revenue-table filters={this.filters} class={'daily-revenue__table'} paymentEntries={this.paymentEntries} payments={this.groupedPayment}></ir-revenue-table>\n          </div>\n        </section>\n        <ir-sidebar\n          sidebarStyles={{\n            width: this.sideBarEvent?.type === 'booking' ? '80rem' : 'var(--sidebar-width,40rem)',\n            background: this.sideBarEvent?.type === 'booking' ? '#F2F3F8' : 'white',\n          }}\n          open={Boolean(this.sideBarEvent)}\n          showCloseButton={false}\n          onIrSidebarToggle={this.handleSidebarClose}\n        >\n          {this.renderSidebarBody()}\n        </ir-sidebar>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  box-sizing: border-box;\n}\n:host * {\n  box-sizing: border-box;\n}\n\n@media only screen and (min-width: 900px) {\n  /* td {\n    min-width: 140px !important;\n    width: max-content !important;\n  } */\n}\n@media only screen and (max-width: 900px) {\n  /* td {\n    min-width: 100px !important;\n  } */\n  /* .table-container {\n    width: max-content !important;\n  } */\n}\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n}\n\n.tasks-view {\n  display: flex;\n  flex-direction: column;\n}\n/*lg*/\n@media (min-width: 1024px) {\n  .tasks-view {\n    flex-direction: row;\n  }\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { CleanTaskEvent, IPendingActions } from '@/models/housekeeping';\nimport Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport housekeeping_store from '@/stores/housekeeping.store';\n// import { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, h, Element, Watch, Event, EventEmitter, Listen } from '@stencil/core';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { TaskFilters } from './types';\nimport { downloadFile } from '@/utils/utils';\nimport { updateTasks as updateTasksStore, updateSelectedTasks, clearSelectedTasks, hkTasksStore, setLoading } from '@/stores/hk-tasks.store';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  tag: 'ir-hk-tasks',\n  styleUrl: 'ir-hk-tasks.css',\n  scoped: true,\n})\nexport class IrHkTasks {\n  @Element() el: HTMLElement;\n\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n  @State() isCleaningLoading = false;\n  @State() selectedDuration = '';\n  @State() selectedHouseKeeper = '0';\n  @State() selectedRoom: IPendingActions | null = null;\n  @State() archiveOpened = false;\n  @State() property_id: number;\n  @State() isSidebarOpen: boolean;\n  @State() isApplyFiltersLoading: boolean;\n  @State() filters: TaskFilters;\n  @State() modalCauses: CleanTaskEvent & { cause: 'skip' | 'clean' };\n\n  @Event({ bubbles: true, composed: true }) clearSelectedHkTasks: EventEmitter<void>;\n\n  private hkNameCache: Record<number, string> = {};\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private token = new Token();\n  private table_sorting: Map<string, 'ASC' | 'DESC'> = new Map();\n  private modal: HTMLIrModalElement;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.init();\n  }\n\n  @Listen('closeSideBar')\n  handleCloseSidebar(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.isSidebarOpen = false;\n  }\n  @Listen('sortingChanged')\n  handleSortingChanged(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { field, direction } = e.detail;\n    console.log(e.detail);\n    if (field === 'date') {\n      return;\n    }\n    this.table_sorting.set(field, direction);\n  }\n  @Listen('skipSelectedTask')\n  handleSkipSelectedTask(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { task: e.detail, cause: 'skip' };\n    this.modal?.openModal();\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      setLoading(true);\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.houseKeepingService.getExposedHKSetup(this.property_id), this.roomService.fetchLanguage(this.language)];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      const tasksResult = await this.houseKeepingService.getHkTasks({\n        property_id: this.property_id,\n        from_date: moment().format('YYYY-MM-DD'),\n        to_date: moment().format('YYYY-MM-DD'),\n        housekeepers: [],\n        cleaning_frequency: (calendar_data.cleaning_frequency ?? housekeeping_store?.hk_criteria?.cleaning_frequencies[0])?.code,\n        dusty_window: housekeeping_store?.hk_criteria?.dusty_periods[0]?.code,\n        highlight_window: housekeeping_store?.hk_criteria?.highlight_checkin_options[0]?.code,\n      });\n\n      // updateTaskList();\n      if (tasksResult?.tasks) {\n        this.updateTasks(tasksResult.tasks);\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n      setLoading(false);\n    }\n  }\n\n  private buildHousekeeperNameCache() {\n    this.hkNameCache = {};\n    housekeeping_store.hk_criteria?.housekeepers?.forEach(hk => {\n      if (hk.id != null && hk.name != null) {\n        this.hkNameCache[hk.id] = hk.name;\n      }\n    });\n  }\n\n  private updateTasks(tasks: any[]) {\n    this.buildHousekeeperNameCache();\n    updateTasksStore(\n      tasks.map(t => ({\n        ...t,\n        id: v4(),\n        housekeeper: (() => {\n          const name = this.hkNameCache[t.hkm_id];\n          if (name) {\n            return name;\n          }\n          const hkName = housekeeping_store.hk_criteria?.housekeepers?.find(hk => hk.id === t.hkm_id)?.name;\n          this.hkNameCache[t.hkm_id] = hkName;\n          return hkName;\n        })(),\n      })),\n    );\n  }\n  @Listen('headerButtonPress')\n  async handleHeaderButtonPress(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { name } = e.detail;\n    switch (name) {\n      case 'cleaned':\n      case 'clean-inspect':\n        this.modal?.openModal();\n        this.modalCauses = {\n          task: null,\n          cause: 'clean',\n          status: name === 'clean-inspect' ? '004' : '001',\n        };\n        break;\n      case 'export':\n        const sortingArray: { key: string; value: string }[] = Array.from(this.table_sorting.entries()).map(([key, value]) => ({\n          key,\n          value,\n        }));\n        console.log(sortingArray);\n        const { url } = await this.fetchTasksWithFilters(true);\n        downloadFile(url);\n        break;\n      case 'archive':\n        this.isSidebarOpen = true;\n        break;\n    }\n  }\n  @Listen('cleanSelectedTask')\n  handleSelectedTaskCleaningEvent(e: CustomEvent<CleanTaskEvent>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { ...e.detail, cause: 'clean' };\n    this.modal?.openModal();\n  }\n\n  private async handleModalConfirmation(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      if (hkTasksStore.selectedTasks.length === 0) {\n        return;\n      }\n      this.isCleaningLoading = true;\n      if (this.modalCauses?.cause === 'skip') {\n        const { booking_nbr, date, unit } = this.modalCauses.task;\n        await this.houseKeepingService.editHkSkip({\n          BOOK_NBR: booking_nbr,\n          DATE: date,\n          COMMENT: '',\n          HK_SKIP_ID: -1,\n          HK_SKIP_REASON_CODE: '001',\n          PR_ID: unit.id,\n        });\n      } else {\n        await this.houseKeepingService.executeHKAction({\n          actions: hkTasksStore.selectedTasks.map(t => ({\n            description: 'Cleaned',\n            hkm_id: t.hkm_id === 0 ? null : t.hkm_id,\n            unit_id: t.unit.id,\n            booking_nbr: t.booking_nbr,\n            status: this.modalCauses?.status ?? '001',\n          })),\n        });\n      }\n      await this.fetchTasksWithFilters();\n    } finally {\n      clearSelectedTasks();\n      if (this.modalCauses) {\n        this.modalCauses = null;\n      }\n      this.isCleaningLoading = false;\n      // this.clearSelectedTasks.emit();\n      this.modal.closeModal();\n    }\n  }\n\n  private async applyFilters(e: CustomEvent) {\n    try {\n      this.isApplyFiltersLoading = true;\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.filters = { ...e.detail };\n      await this.fetchTasksWithFilters();\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isApplyFiltersLoading = false;\n    }\n  }\n\n  private async fetchTasksWithFilters(export_to_excel: boolean = false) {\n    const { cleaning_periods, housekeepers, cleaning_frequencies, dusty_units, highlight_check_ins } = this.filters ?? {};\n\n    const { tasks, url } = await this.houseKeepingService.getHkTasks({\n      housekeepers,\n      cleaning_frequency: cleaning_frequencies?.code,\n      dusty_window: dusty_units?.code,\n      highlight_window: highlight_check_ins?.code,\n      property_id: this.property_id,\n      from_date: moment().format('YYYY-MM-DD'),\n      to_date: cleaning_periods?.code || moment().format('YYYY-MM-DD'),\n      is_export_to_excel: export_to_excel,\n    });\n    console.log(tasks);\n    if (tasks) {\n      this.updateTasks(tasks);\n    }\n    return { tasks, url };\n  }\n\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host data-testid=\"hk_tasks_base\">\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-1 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <h3>Housekeeping Tasks</h3>\n          <div class=\"tasks-view \" style={{ gap: '1rem' }}>\n            <ir-tasks-filters\n              isLoading={this.isApplyFiltersLoading}\n              onApplyFilters={e => {\n                this.applyFilters(e);\n              }}\n            ></ir-tasks-filters>\n            <div class=\"d-flex w-100 flex-column\" style={{ gap: '1rem' }}>\n              <ir-tasks-table\n                onRowSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  updateSelectedTasks(e.detail);\n                }}\n                class=\"flex-grow-1 w-100\"\n              ></ir-tasks-table>\n              {/* <ir-tasks-table-pagination></ir-tasks-table-pagination> */}\n            </div>\n          </div>\n        </section>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.modal = el)}\n          isLoading={this.isCleaningLoading}\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\n          onCancelModal={() => {\n            if (this.modalCauses) {\n              clearSelectedTasks();\n              this.modalCauses = null;\n            }\n          }}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={locales.entries.Lcz_Confirm}\n          leftBtnColor=\"secondary\"\n          rightBtnColor={'primary'}\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={\n            this.modalCauses\n              ? this.modalCauses?.cause === 'clean'\n                ? this.modalCauses.task\n                  ? `Update ${this.modalCauses?.task?.unit?.name} to Clean`\n                  : 'Update selected unit(s) to Clean'\n                : 'Skip cleaning and reschedule for tomorrow.'\n              : 'Update selected unit(s) to Clean'\n          }\n        ></ir-modal>\n        <ir-sidebar\n          open={this.isSidebarOpen}\n          id=\"editGuestInfo\"\n          onIrSidebarToggle={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.isSidebarOpen = false;\n          }}\n          // sidebarStyles={{\n          //   width: '80vw',\n          // }}\n          showCloseButton={false}\n        >\n          {this.isSidebarOpen && <ir-hk-archive ticket={this.token.getToken()} propertyId={this.property_id} slot=\"sidebar-body\"></ir-hk-archive>}\n        </ir-sidebar>\n        {/* <ir-title class=\"d-none d-md-flex\" label={locales.entries.Lcz_HousekeepingTasks} justifyContent=\"space-between\">\n            <ir-button slot=\"title-body\" text={locales.entries.Lcz_Archive} size=\"sm\"></ir-button>\n          </ir-title> */}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport calendar_data from '@/stores/calendar-data';\nimport housekeeping_store, { updateHKStore } from '@/stores/housekeeping.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport locales from '@/stores/locales.store';\nimport { PropertyService } from '@/services/property.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n@Component({\n  tag: 'ir-housekeeping',\n  styleUrl: 'ir-housekeeping.css',\n  scoped: true,\n})\nexport class IrHousekeeping {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n\n  @Event() toast: EventEmitter<IToast>;\n\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private propertyService = new PropertyService();\n  private token = new Token();\n  modal: HTMLIrModalElement;\n  selectedCleaningFrequency: any;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  async initializeApp() {\n    try {\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_sales_rate_plans: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\n      const requests: Array<Promise<any>> = [];\n      if (calendar_data.housekeeping_enabled) {\n        requests.push(this.houseKeepingService.getExposedHKSetup(propertyId));\n      }\n      requests.push(this.roomService.fetchLanguage(this.language, ['_HK_FRONT', '_PMS_FRONT']));\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: propertyId,\n            language: this.language,\n            is_backend: true,\n            include_sales_rate_plans: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private async saveAutomaticCheckInCheckout(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.roomService.SetAutomaticCheckInOut({\n        property_id: housekeeping_store.default_properties.property_id,\n        flag: e.detail === 'auto',\n      });\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async saveCleaningFrequency(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.propertyService.setExposedCleaningFrequency({\n        property_id: housekeeping_store.default_properties.property_id,\n        code: this.selectedCleaningFrequency,\n      });\n      calendar_data.cleaning_frequency = { code: this.selectedCleaningFrequency, description: '' };\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n      this.modal.closeModal();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    console.log(calendar_data.cleaning_frequency);\n    return (\n      <Host>\n        <ir-interceptor></ir-interceptor>\n        <ir-toast></ir-toast>\n        <section class=\"p-1\">\n          <h3 class=\"mb-2\">{locales.entries.Lcz_HouseKeepingAndCheckInSetup}</h3>\n          <div class=\"card p-1\">\n            <ir-title borderShown label=\"Operations Settings\"></ir-title>\n            <div class={'d-flex align-items-center mb-1'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CheckInOutGuestsAutomatically}</p>\n              <ir-select\n                showFirstOption={false}\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\n                data={[\n                  { text: locales.entries.Lcz_YesAsPerPropertyPolicy, value: 'auto' },\n                  { text: locales.entries.Lcz_NoIWillDoItManually, value: 'manual' },\n                ]}\n              ></ir-select>\n            </div>\n            <div class={'d-flex align-items-center'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CleaningFrequency}:</p>\n              <ir-select\n                showFirstOption={false}\n                selectedValue={this.selectedCleaningFrequency}\n                onSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.selectedCleaningFrequency = e.detail;\n                  this.modal.openModal();\n                }}\n                data={housekeeping_store?.hk_criteria?.cleaning_frequencies.map(v => ({\n                  text: v.description,\n                  value: v.code,\n                }))}\n              ></ir-select>\n            </div>\n          </div>\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\n          {calendar_data.housekeeping_enabled && <ir-hk-team class=\"mb-1\"></ir-hk-team>}\n          <ir-modal\n            autoClose={false}\n            ref={el => (this.modal = el)}\n            isLoading={isRequestPending('/Set_Exposed_Cleaning_Frequency')}\n            onConfirmModal={this.saveCleaningFrequency.bind(this)}\n            iconAvailable={true}\n            onCancelModal={() => {\n              this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n            }}\n            icon=\"ft-alert-triangle danger h1\"\n            leftBtnText={locales.entries.Lcz_Cancel}\n            rightBtnText={locales.entries.Lcz_Confirm}\n            leftBtnColor=\"secondary\"\n            rightBtnColor={'primary'}\n            modalTitle={locales.entries.Lcz_Confirmation}\n            modalBody={'This action will reschedule all cleaning tasks. Do you want to continue?'}\n          ></ir-modal>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { DailyReport, DailyReportFilter } from './types';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { RoomService } from '@/services/room.service';\nimport { DailyStat, MonthlyStatsResults, PropertyService } from '@/services/property.service';\n\n@Component({\n  tag: 'ir-monthly-bookings-report',\n  styleUrl: 'ir-monthly-bookings-report.css',\n  scoped: true,\n})\nexport class IrMonthlyBookingsReport {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isPageLoading = true;\n  @State() isLoading: 'export' | 'filter' | null = null;\n\n  @State() reports: DailyReport[] = [];\n  @State() filters: DailyReportFilter;\n  @State() property_id: number;\n  @State() stats: Omit<MonthlyStatsResults, 'DailyStats'>;\n\n  private baseFilters: DailyReportFilter;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n\n  componentWillLoad() {\n    this.baseFilters = {\n      date: {\n        description: moment().format('MMMM YYYY'),\n        firstOfMonth: moment().startOf('month').format('YYYY-MM-DD'),\n        lastOfMonth: moment().endOf('month').format('YYYY-MM-DD'),\n      },\n      include_previous_year: false,\n    };\n    this.filters = this.baseFilters;\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Listen('applyFilters')\n  handleApplyFiltersChange(e: CustomEvent<DailyReportFilter>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.filters = e.detail;\n    this.getReports();\n  }\n\n  private async init() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.roomService.fetchLanguage(this.language), this.getReports()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getReports(isExportToExcel = false) {\n    try {\n      const getReportObj = (report: DailyStat): DailyReport => {\n        return {\n          day: report.Date,\n          units_booked: report.Units_booked,\n          occupancy_percent: report.Occupancy,\n          adr: report.ADR,\n          rooms_revenue: report.Rooms_Revenue,\n          total_guests: report?.Total_Guests,\n        };\n      };\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n      const { date, include_previous_year } = this.filters;\n\n      const requests = [\n        this.propertyService.getMonthlyStats({\n          from_date: date.firstOfMonth,\n          to_date: date.lastOfMonth,\n          property_id: this.property_id,\n          is_export_to_excel: isExportToExcel,\n        }),\n      ];\n\n      if (include_previous_year) {\n        requests.push(\n          this.propertyService.getMonthlyStats({\n            from_date: moment(date.firstOfMonth, 'YYYY-MM-DD').add(-1, 'year').format('YYYY-MM-DD'),\n            to_date: moment(date.lastOfMonth, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'),\n            property_id: this.property_id,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      const currentReports = results[0];\n      let enrichedReports: DailyReport[] = [];\n      const { DailyStats, ...rest } = currentReports;\n\n      this.stats = { ...rest };\n\n      if (include_previous_year && results[isExportToExcel ? 0 : 1]) {\n        const previousYearReports = results[isExportToExcel ? 0 : 1];\n        let formattedReports = previousYearReports.DailyStats.map(getReportObj);\n        enrichedReports = DailyStats.map(getReportObj).map(current => {\n          const previous = formattedReports.find(prev => prev.day === moment(current.day, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'));\n          return {\n            ...current,\n            last_year: previous ?? null,\n          };\n        });\n      } else {\n        enrichedReports = DailyStats.map(getReportObj);\n      }\n      this.reports = [...enrichedReports];\n    } catch (e) {\n      console.log(e);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Daily Occupancy</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries?.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getReports(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <section>\n            <div class=\"d-flex flex-column flex-md-row w-100\" style={{ gap: '1rem', alignItems: 'stretch' }}>\n              <ir-stats-card\n                icon={this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? 'arrow-trend-down' : 'arrow-trend-up'}\n                cardTitle=\"Average Occupancy\"\n                value={this.stats.AverageOccupancy ? this.stats?.AverageOccupancy.toFixed(2) + '%' : null}\n                subtitle={`${this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? '' : '+'}${this.stats?.Occupancy_Difference_From_Previous_Month.toFixed(\n                  2,\n                )}% from last month`}\n              ></ir-stats-card>\n\n              <ir-stats-card\n                icon=\"hotel\"\n                cardTitle=\"Total Units\"\n                value={this.stats?.TotalUnitsBooked ? this.stats?.TotalUnitsBooked.toString() : null}\n                subtitle=\"Booked\"\n              ></ir-stats-card>\n\n              <ir-stats-card icon=\"user_group\" cardTitle=\"Total Guests\" value={this.stats?.Total_Guests?.toString()} subtitle=\"Stayed\"></ir-stats-card>\n\n              <ir-stats-card\n                icon=\"calendar\"\n                cardTitle=\"Peak Days\"\n                value={this.stats?.PeakDays.length === 0 ? null : this.stats?.PeakDays?.map(pd => moment(pd.Date, 'YYYY-MM-DD').format('D').concat('th')).join(' - ')}\n                subtitle={`${Math.max(...(this.stats.PeakDays?.map(pd => pd.OccupancyPercent) || []))}% occupancy`}\n              ></ir-stats-card>\n            </div>\n            <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n              <ir-monthly-bookings-report-filter isLoading={this.isLoading === 'filter'} class=\"filters-card\" baseFilters={this.baseFilters}></ir-monthly-bookings-report-filter>\n              <ir-monthly-bookings-report-table reports={this.reports}></ir-monthly-bookings-report-table>\n            </div>\n          </section>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { BaseSalesRecord, CountrySalesFilter, MappedCountries, SalesRecord } from './types';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry } from '@/models/IBooking';\n\n@Component({\n  tag: 'ir-sales-by-country',\n  styleUrl: 'ir-sales-by-country.css',\n  scoped: true,\n})\nexport class IrSalesByCountry {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isLoading: 'filter' | 'export' | null = null;\n  @State() isPageLoading = true;\n  @State() property_id: number;\n  @State() salesData: SalesRecord[];\n  @State() salesFilters: CountrySalesFilter;\n  @State() countries: MappedCountries = new Map();\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private bookingService = new BookingService();\n\n  private baseFilters = {\n    FROM_DATE: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    TO_DATE: moment().format('YYYY-MM-DD'),\n    BOOK_CASE: '001',\n    WINDOW: 7,\n    include_previous_year: false,\n  };\n\n  componentWillLoad() {\n    this.salesFilters = this.baseFilters;\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n  private async initializeApp() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.bookingService.getCountries(this.language), this.roomService.fetchLanguage(this.language), this.getCountrySales()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const [countries] = await Promise.all(requests);\n      const mappedCountries = new Map();\n      (countries as ICountry[]).map(country => {\n        mappedCountries.set(country.id, {\n          flag: country.flag,\n          name: country.name,\n        });\n      });\n      this.countries = mappedCountries;\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getCountrySales(isExportToExcel = false) {\n    const formatSalesData = (data): Omit<BaseSalesRecord, 'id'> => {\n      return {\n        country: data.COUNTRY,\n        country_id: data.COUNTRY_ID,\n        nights: data.NIGHTS,\n        percentage: data.PCT,\n        revenue: data.REVENUE,\n        number_of_guests: data.Total_Guests,\n      };\n    };\n    try {\n      const { include_previous_year, ...filterParams } = this.salesFilters;\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n\n      const currentSales = await this.propertyService.getCountrySales({\n        AC_ID: this.property_id,\n        is_export_to_excel: isExportToExcel,\n        ...filterParams,\n      });\n\n      const shouldFetchPreviousYear = !isExportToExcel && include_previous_year;\n\n      let enrichedSales: SalesRecord[] = [];\n\n      if (shouldFetchPreviousYear) {\n        const previousYearSales = await this.propertyService.getCountrySales({\n          AC_ID: this.property_id,\n          is_export_to_excel: false,\n          ...filterParams,\n          FROM_DATE: moment(filterParams.FROM_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n          TO_DATE: moment(filterParams.TO_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n        });\n\n        enrichedSales = currentSales.map(current => {\n          const previous = previousYearSales.find(prev => prev.COUNTRY.toLowerCase() === current.COUNTRY.toLowerCase());\n          return {\n            id: v4(),\n            ...formatSalesData(current),\n            last_year: previous ? formatSalesData(previous) : null,\n          };\n        });\n      } else {\n        enrichedSales = currentSales.map(record => ({\n          id: v4(),\n          ...formatSalesData(record),\n          last_year: null,\n        }));\n      }\n\n      // this.salesData = enrichedSales.sort((a, b) => {\n      //   if (a.country_id === 0) return -1;\n      //   if (b.country_id === 0) return 1;\n      //   return 0;\n      // });\n      this.salesData = [...enrichedSales];\n    } catch (error) {\n      console.error('Failed to fetch sales data:', error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Sales by Country</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getCountrySales(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <ir-sales-by-country-summary salesReports={this.salesData}></ir-sales-by-country-summary>\n          <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n            <ir-sales-filters\n              isLoading={this.isLoading === 'filter'}\n              onApplyFilters={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.salesFilters = e.detail;\n                this.getCountrySales();\n              }}\n              class=\"filters-card\"\n              baseFilters={this.baseFilters}\n            ></ir-sales-filters>\n            <ir-sales-table mappedCountries={this.countries} class=\"card mb-0\" records={this.salesData}></ir-sales-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  height: 100%;\n}\n","import Token from '@/models/Token';\nimport { User } from '@/models/Users';\nimport { BookingService } from '@/services/booking.service';\nimport { RoomService } from '@/services/room.service';\nimport { UserService } from '@/services/user.service';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { AllowedUser } from './types';\nimport { bookingReasons } from '@/models/IBooking';\nimport { io, Socket } from 'socket.io-client';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'ir-user-management',\n  styleUrl: 'ir-user-management.css',\n  scoped: true,\n})\nexport class IrUserManagement {\n  @Prop() language: string = '';\n  @Prop() baseUrl: string;\n  @Prop() ticket: string;\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() isSuperAdmin: boolean = true;\n  @Prop() userTypeCode: string | number;\n  @Prop() baseUserTypeCode: string | number;\n  @Prop() userId: string | number;\n\n  @State() isLoading = true;\n  @State() users: User[] = [];\n  @State() property_id: number;\n  @State() allowedUsersTypes: AllowedUser[] = [];\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private userService = new UserService();\n  private bookingService = new BookingService();\n\n  private userTypes: Map<number | string, string> = new Map();\n  private socket: Socket;\n\n  private superAdminId = '5';\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.fetchUsers();\n  }\n\n  private async initializeApp() {\n    try {\n      if (this.baseUrl) {\n        this.token.setBaseUrl(this.baseUrl);\n      }\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.fetchUserTypes(), this.fetchUsers(), this.roomService.fetchLanguage(this.language, ['_USER_MGT'])];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.socket = io('https://realtime.igloorooms.com/');\n      this.socket.on('MSG', async msg => {\n        await this.handleSocketMessage(msg);\n      });\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private async handleSocketMessage(msg: string) {\n    const msgAsObject = JSON.parse(msg);\n    if (!msgAsObject) {\n      return;\n    }\n\n    const { REASON, KEY, PAYLOAD }: { REASON: bookingReasons; KEY: any; PAYLOAD: any } = msgAsObject;\n\n    if (KEY.toString() !== this.property_id.toString()) {\n      return;\n    }\n\n    let result = JSON.parse(PAYLOAD);\n    console.log(KEY, result);\n    // const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n    //   DORESERVATION: this.updateUserVerificationStatus,\n    // };\n    const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n      EMAIL_VERIFIED: this.updateUserVerificationStatus,\n    };\n    const handler = reasonHandlers[REASON];\n    if (handler) {\n      await handler.call(this, result);\n    } else {\n      console.warn(`Unhandled REASON: ${REASON}`);\n    }\n  }\n\n  public updateUserVerificationStatus(result: { id: string | number }) {\n    const users = [...this.users];\n    const idx = users.findIndex(u => u.id === result.id);\n    if (idx === -1) {\n      console.warn(`User ${result.id} not found`);\n      return;\n    }\n    users[idx] = {\n      ...users[idx],\n      is_email_verified: true,\n    };\n    this.users = users;\n  }\n\n  private async fetchUsers() {\n    const users = await this.userService.getExposedPropertyUsers({ property_id: this.propertyid });\n    this.users = [...users].sort((u1: User, u2: User) => {\n      const priority = (u: User) => {\n        const t = u.type.toString();\n        if (t === this.superAdminId) return 0;\n        if (t === '17') return 1;\n        return 2;\n      };\n      //sort by priority\n      const p1 = priority(u1),\n        p2 = priority(u2);\n      if (p1 !== p2) {\n        return p1 - p2;\n      }\n      // //sort by user id\n      // if (p1 === 1) {\n      //   const id1 = u1.id.toString(),\n      //     id2 = u2.id.toString(),\n      //     me = this.userId.toString();\n      //   if (id1 === me) return -1; // u1 is me → goes before u2\n      //   if (id2 === me) return 1; // u2 is me → u1 goes after\n      // }\n\n      // 3) sort by username\n      return u1.username.localeCompare(u2.username);\n    });\n  }\n  private async fetchUserTypes() {\n    const res = await Promise.all([this.bookingService.getSetupEntriesByTableName('_USER_TYPE'), this.bookingService.getLov()]);\n    const allowedUsers = res[1]?.My_Result?.allowed_user_types;\n    for (const e of res[0]) {\n      const value = e[`CODE_VALUE_${this.language?.toUpperCase() ?? 'EN'}`];\n      if (allowedUsers.find(f => f.code === e.CODE_NAME)) {\n        this.allowedUsersTypes.push({ code: e.CODE_NAME, value });\n      }\n      this.userTypes.set(e.CODE_NAME.toString(), value);\n    }\n  }\n  disconnectedCallback() {\n    this.socket.disconnect();\n  }\n  render() {\n    if (this.isLoading) {\n      return (\n        <Host>\n          <ir-toast></ir-toast>\n          <ir-interceptor></ir-interceptor>\n          <ir-loading-screen></ir-loading-screen>\n        </Host>\n      );\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor suppressToastEndpoints={['/Change_User_Pwd', '/Handle_Exposed_User']}></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex  pb-2 align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">{locales.entries.Lcz_ExtranetUsers}</h3>\n          </div>\n\n          <div class=\"\" style={{ gap: '1rem' }}>\n            <ir-user-management-table\n              property_id={this.property_id}\n              baseUserTypeCode={this.baseUserTypeCode}\n              allowedUsersTypes={this.allowedUsersTypes}\n              userTypeCode={this.userTypeCode}\n              haveAdminPrivileges={[this.superAdminId, '17'].includes(this.userTypeCode?.toString())}\n              userTypes={this.userTypes}\n              class=\"card\"\n              isSuperAdmin={this.userTypeCode?.toString() === this.superAdminId}\n              users={this.users}\n            ></ir-user-management-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}