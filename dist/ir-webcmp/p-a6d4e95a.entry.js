import{r as e,c as a,h as t,F as r,H as s}from"./p-d239357b.js";import{l as i}from"./p-4e493fea.js";import{i as o}from"./p-6fec77c0.js";import{h as n}from"./p-6c4ba7c0.js";import{U as l}from"./p-e27cda29.js";import{_ as c}from"./p-b2679b77.js";import{S as d}from"./p-0e0f732a.js";import"./p-c5894a47.js";import"./p-367551b0.js";import"./p-03c2769e.js";import"./p-748cfd41.js";import"./p-99cb260a.js";import"./p-bf44a732.js";const b=".sc-ir-user-form-panel-drawer-h{display:block}";const m=b;const u=class{constructor(t){e(this,t);this.closeSideBar=a(this,"closeSideBar",7)}open;user;userTypes=Map;isEdit=false;language="en";property_id;haveAdminPrivileges;superAdminId="5";userTypeCode;allowedUsersTypes=[];baseUserTypeCode;closeSideBar;render(){const e=`user-form-${this.user?.id}`;return t("ir-drawer",{key:"080c81c3eb24d2c4dd75081e6b768325e2f1684d",onDrawerHide:e=>{e.stopImmediatePropagation();e.stopPropagation();if(!e.detail){return}this.closeSideBar.emit(null)},label:this.isEdit?this.user.username:"Create New User",open:this.open},this.open&&t("ir-user-form-panel",{key:"d99a0c064507e911071366bf7c235f809c3c1c3c",user:this.user,userTypes:this.userTypes,isEdit:this.isEdit,language:this.language,property_id:this.property_id,haveAdminPrivileges:this.haveAdminPrivileges,superAdminId:this.superAdminId,userTypeCode:this.userTypeCode,allowedUsersTypes:this.allowedUsersTypes,baseUserTypeCode:this.baseUserTypeCode,formId:e}),t("div",{key:"90edaeb64176caa942feaec2a73fd801fb3f7e9c",slot:"footer",class:"ir__drawer-footer"},t("ir-custom-button",{key:"af9b19242353e0f83d45d3aa16afb2fb2ce62d71","data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill",appearance:"filled",variant:"neutral",size:"medium"},i?.entries?.Lcz_Cancel),t("ir-custom-button",{key:"4dfa0eecda2f5b6ba67e7edfe3fbfd7df5a734ba",form:e,loading:o("/Handle_Exposed_User"),"data-testid":"save",size:"medium",class:"flex-fill",type:"submit",variant:"brand"},i?.entries?.Lcz_Save)))}};u.style=m;const f=".sc-ir-user-management-table-h{display:flex;flex-direction:column;border-radius:0.5rem;overflow-x:auto;min-height:60vh;max-width:1920px;border:1px solid var(--wa-color-neutral-border-quiet, #abaeb9);background-color:white}.sc-ir-user-management-table-h{box-sizing:border-box !important}.sc-ir-user-management-table-h *.sc-ir-user-management-table,.sc-ir-user-management-table-h *.sc-ir-user-management-table::before,.sc-ir-user-management-table-h *.sc-ir-user-management-table::after{box-sizing:inherit !important;padding:0;margin:0}[hidden].sc-ir-user-management-table{display:none !important}.badge.sc-ir-user-management-table{border:none;padding:0.2rem 0.3rem}.badge.sc-ir-user-management-table:disabled{cursor:default}";const h=f;const p=".ir-table-row.sc-ir-user-management-table td.sc-ir-user-management-table{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:var(--wa-color-surface-default);white-space:nowrap;color:var(--wa-color-text-normal);box-sizing:border-box}.table--container.sc-ir-user-management-table{overflow-x:auto}.table.sc-ir-user-management-table td.sc-ir-user-management-table{border-top:0;border-bottom:1px solid var(--wa-color-neutral-border-quiet, #abaeb9);transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-user-management-table tbody.sc-ir-user-management-table tr.sc-ir-user-management-table:last-child>td.sc-ir-user-management-table{border-bottom:0 !important}.table.sc-ir-user-management-table thead.sc-ir-user-management-table th.sc-ir-user-management-table{border:none !important;background:#ececec;background:color-mix(in oklab, var(--wa-color-neutral-fill-quiet, #f1f2f3) 60%, transparent);color:#374151;padding:0.5rem 1rem !important;text-align:left}.data-table.sc-ir-user-management-table thead.sc-ir-user-management-table th.sc-ir-user-management-table{box-sizing:border-box;background:var(--wa-color-surface-default) !important;padding-top:0.5rem !important;padding-bottom:0.5rem !important;border-bottom:1px solid var(--wa-color-neutral-90) !important;color:var(--wa-color-text-normal)}.data-table.sc-ir-user-management-table .empty-row.sc-ir-user-management-table{height:50vh !important;text-align:center;color:var(--wa-color-gray-60)}.data-table--pagination.sc-ir-user-management-table{padding:0.5rem 1rem;position:sticky;bottom:0;background:var(--wa-color-surface-default);border-top:1px solid var(--wa-color-neutral-90)}.selected.sc-ir-user-management-table td.sc-ir-user-management-table{background:#e3f3fa !important}.selected.sc-ir-user-management-table td.sc-ir-user-management-table{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-user-management-table,.ir-table-row.sc-ir-user-management-table{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-user-management-table{text-transform:capitalize}.sortable.sc-ir-user-management-table:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-user-management-table:hover td.sc-ir-user-management-table{background:#e2e6ea3f !important;background:var(--wa-color-neutral-fill-quiet, #f1f2f3) !important}.sortable.sc-ir-user-management-table:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-user-management-table svg.sc-ir-user-management-table{color:var(--blue)}.sticky-column.sc-ir-user-management-table{position:sticky !important;right:0;background-color:white}.table--container.sc-ir-user-management-table,.data-table.sc-ir-user-management-table{height:100%}";const g=p;const y=class{constructor(t){e(this,t);this.toast=a(this,"toast",7);this.resetData=a(this,"resetData",7)}users=[];isSuperAdmin;userTypes=new Map;userTypeCode;haveAdminPrivileges;superAdminId="5";allowedUsersTypes=[];baseUserTypeCode;property_id;currentTrigger=null;user=null;modalType;canDelete;canEdit;canCreate;toast;resetData;dialogRef;userService=new l;systemService=new d;componentWillLoad(){this.assignPermissions()}handleChange(e,a){if(e!==a){this.assignPermissions()}}assignPermissions(){this.canCreate=this.haveAdminPrivileges;this.canDelete=this.haveAdminPrivileges;this.canEdit=true}async handleUserActiveChange(e,a){e.stopImmediatePropagation();e.stopPropagation();const t=await this.verifyAdminAction({type:"user",mode:"update",user:a});if(t==="cancelled"){return}await this.userService.handleExposedUser({email:a.email,id:a.id,is_active:e.target.checked,mobile:a.mobile,password:a.password,type:a.type,username:a.username,base_user_type_code:this.baseUserTypeCode,property_id:this.property_id});this.toast.emit({position:"top-right",title:"Saved Successfully",description:"",type:"success"})}async executeUserAction(e){try{e.stopImmediatePropagation();e.stopPropagation();await this.userService.handleExposedUser({email:this.user.email,id:this.user.id,is_active:this.user.is_active,is_email_verified:this.modalType==="verify"?false:this.user.is_email_verified,mobile:this.user.mobile,password:this.user.password,type:this.user.type,username:this.user.username,is_to_remove:this.modalType==="delete"});this.resetData.emit(null)}finally{this.dialogRef.closeModal()}}openModal(e,a){if(!this.dialogRef||!e){return}this.user=e;this.modalType=a;this.dialogRef.openModal()}maskEmail(e){if(!e||!e.includes("@"))return"";const[a,t]=e.split("@");const r=a.slice(0,1);const s="*".repeat(Math.max(a.length-1,1));return`${r}${s}@${t}`}async verifyAdminAction(e){const a=await this.systemService.checkOTPNecessity({METHOD_NAME:"Handle_Exposed_User"});if(a?.cancelled){return"cancelled"}const{mode:t,...r}=e;if(t==="edit"||t==="create"){this.currentTrigger={...r,isEdit:t==="edit"}}return"ok"}render(){return t(s,{key:"9c6a60b26c265ffcae67c840ca3b8cc4b78a3324"},t("section",{key:"bfef9b823d188f3762446f649541c39270e8c4f2",class:"table-container h-100  w-100 m-0 table-responsive"},t("table",{key:"09023c9d12244223584d3da0050a5adb42f2bda7",class:"table"},t("thead",{key:"893db27c3f9ca2a1b0372fe018550119ecb80307"},t("tr",{key:"60b04d5bc1da5d87a95f4281f82201c41a8d042d"},t("th",{key:"992caac18d2f6ca5e7e3373ec43a1b6db3402d90",class:"text-left"},i.entries.Lcz_Username??"Username"),t("th",{key:"bc777533fb27b533b95940fa7ac032b5f7d840aa",class:"text-left"},i.entries.Lcz_Email),t("th",{key:"5f992201bfe5f336b8cdfd3b714a21f84fb9ddd3",class:"text-left"},i.entries.Lcz_Mobile??"Mobile"),t("th",{key:"645b23574c590b52c108765837e6ba5141c4efb4",class:"text-left"},i.entries.Lcz_Role),t("th",{key:"325943f354a5f5d442f7fe1cd1f5afa68d0d93ca",class:"text-left small",style:{fontWeight:"bold"}},t("p",{key:"a96d5e52999b534cfad03121bef0ff847d80880d",class:"m-0 p-0 "},i.entries.Lcz_CreatedAt),t("p",{key:"eb95b09487636606db49ac728d32e0e80c6bb269",class:"m-0 p-0"},i.entries.Lcz_LastSignedIn)),this.haveAdminPrivileges&&t("th",{key:"f367037753066eb9e9fb04ed51057394dde111df"},i.entries.Lcz_Active),t("th",{key:"b24261c33d7b0aae4b013de2780217ac79e4f755",class:"action-row"},this.canCreate&&t("ir-icon",{key:"e32da474cf41f47dd39bf4849fd7a22514c4c2bc",style:{paddingLeft:"0.875rem"},"data-testid":"new_user",title:i.entries.Lcz_CreateUser,onIconClickHandler:()=>{this.verifyAdminAction({type:"user",mode:"create",user:null})}},t("svg",{key:"5450b0a73729902ca15e06e096253f6d8fdd8b0f",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},t("path",{key:"613068028e59f1b350af310b47edc5ca483627cb",fill:"currentColor",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),t("tbody",{key:"09785f63fa84d7b771a2c5d08c6ae18fe7cc2e95"},this.users.map((e=>{const a=e.type.toString()===this.superAdminId;const s=e.sign_ins?e.sign_ins[0]:null;const o=s?n(s.date,"YYYY-MM-DD"):null;const l=o?n().diff(o,"days")>30:false;return t("tr",{key:e.id,class:"ir-table-row"},t("td",null,e.username),t("td",null,e.email,this.haveAdminPrivileges&&t("span",{style:{marginLeft:"0.5rem",color:`var(--wa-color-${e.is_email_verified?"success":"danger"}-fill-loud)`},class:`small`},e.is_email_verified?i.entries.Lcz_Verified:i.entries.Lcz_NotVerified)),t("td",null,e.mobile??"N/A"),t("td",null,e.type.toString()===this.superAdminId?i.entries.Lcz_SuperAdmin:this.userTypes.get(e.type.toString())),t("td",{class:"small"},t("p",{class:"m-0 p-0"},new Date(e.created_on).getFullYear()===1900||!e.created_on?"N/A":n(e.created_on,"YYYY-MM-DD").format("DD-MMM-YYYY")),t("p",{class:`m-0 p-0`,style:{color:l?"var(--wa-color-danger-fill-loud)":""}},s&&new Date(s.date).getFullYear()>1900?n(s.date,"YYYY-MM-DD").format("DD-MMM-YYYY")+" "+c(s.hour.toString(),s.minute.toString()):"N/A")),this.haveAdminPrivileges&&t("td",null,this.haveAdminPrivileges&&!this.isSuperAdmin&&e.type.toString()==="17"?null:!a&&t("wa-switch",{onchange:a=>this.handleUserActiveChange(a,e),defaultChecked:e.is_active,checked:e.is_active})),t("td",{class:"action-row"},(this.canEdit||this.canDelete)&&(!this.isSuperAdmin&&!a||this.isSuperAdmin)&&t("div",{class:"icons-container  d-flex align-items-center"},this.canEdit&&t(r,null,t("ir-custom-button",{"data-testid":"edit",onClickHandler:()=>{this.verifyAdminAction({type:"user",mode:"edit",user:e})},appearance:"plain",variant:"neutral",id:`edit-user-${e.id}`},t("wa-icon",{name:"edit",style:{fontSize:"1.2rem"}})),t("wa-tooltip",{for:`edit-user-${e.id}`},i.entries.Lcz_EditUser)),this.canDelete&&!a&&(this.isSuperAdmin||e.type.toString()!=="17")&&t(r,null,t("ir-custom-button",{onClickHandler:async()=>{const a=await this.verifyAdminAction({type:"user",mode:"delete",user:e});if(a==="cancelled"){return}this.openModal(e,"delete")},"data-testid":"delete",variant:"danger",appearance:"plain",id:`delete-user-${e.id}`},t("wa-icon",{name:"trash-can",style:{fontSize:"1.2rem"}})),t("wa-tooltip",{for:`delete-user-${e.id}`},i.entries.Lcz_DeleteUser)))))}))))),t("ir-user-form-panel-drawer",{key:"5f25d712e37413db1ed842679bbcd403fe52a06b",open:this.currentTrigger!==null&&this.currentTrigger?.type!=="delete",property_id:this.property_id,baseUserTypeCode:this.baseUserTypeCode,superAdminId:this.superAdminId,allowedUsersTypes:this.allowedUsersTypes,userTypeCode:this.userTypeCode,haveAdminPrivileges:this.haveAdminPrivileges,onCloseSideBar:()=>this.currentTrigger=null,slot:"sidebar-body",user:this.currentTrigger?.user,isEdit:this.currentTrigger?.isEdit}),t("ir-dialog",{key:"30f39aa653428a08fb23782ab41d9cb506d6c60a",label:"Alert",onIrDialogAfterHide:e=>{e.stopImmediatePropagation();e.stopPropagation();this.user=null;this.modalType=null},ref:e=>this.dialogRef=e},t("span",{key:"2f7b185f41770cfe9df43987fcbfd95a39154e97"},this.modalType==="delete"?`${i.entries.Lcz_AreYouSureToDelete} ${this.user?.username}?`:`${i.entries.Lcz_AreYouSureToUnverify} ${this.maskEmail(this.user?.email)}`),t("div",{key:"a852c86e7b784fee77a4efb31c60777761897ce0",slot:"footer",class:"ir-dialog__footer"},t("ir-custom-button",{key:"7a0a3ad7784f08d95d457874087d6b04b0492a21","data-dialog":"close",size:"medium",appearance:"filled"},"Cancel"),t("ir-custom-button",{key:"bac18546c17cf8400e818bb75388ca0d744d5eb8",size:"medium",loading:o("/Handle_Exposed_User"),appearance:"accent",variant:this.modalType==="verify"?"brand":"danger",onClickHandler:this.executeUserAction.bind(this)},this.modalType==="verify"?i.entries.Lcz_Confirm:i.entries.Lcz_Delete))))}static get watchers(){return{haveAdminPrivileges:["handleChange"]}}};y.style=h+g;export{u as ir_user_form_panel_drawer,y as ir_user_management_table};
//# sourceMappingURL=p-a6d4e95a.entry.js.map