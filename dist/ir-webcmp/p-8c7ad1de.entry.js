import{r as t,h as e,H as i,c as s,F as a,g as n}from"./p-53d64953.js";import{b as o,m as r,B as l,c,r as d,a as h,d as u,u as f,g as p,_ as b,e as g,f as m,h as v}from"./p-9091b5e5.js";import{l as y,c as k}from"./p-b446bbaa.js";import{i as w,c as x}from"./p-ed6a6b9d.js";import{f as _,h as D,e as C,a as O,g as M,d as E,t as Y,i as A,c as T,b as S,j as B,k as I,l as j,m as z,z as N,Z as R,n as F,v as L,o as P,p as H,q as U,r as V,s as G,u as K,w as W,x as q,y as X,A as J,B as Q,C as Z,D as tt,E as et,F as it,G as st,H as at,I as nt,J as ot,K as rt,L as lt,M as ct,N as dt}from"./p-f68ae450.js";import{v as ht}from"./p-4ed69de7.js";import{i as ut,a as ft}from"./p-0490b089.js";import{T as pt}from"./p-a93581f3.js";import{R as bt}from"./p-17418a91.js";import{a as gt}from"./p-bf44a732.js";import{H as mt,h as vt,g as yt,u as kt}from"./p-6b56af21.js";import{c as wt,i as xt}from"./p-6b5b5b8a.js";import{c as _t}from"./p-0462f723.js";class Dt{formatVariationBasedOnInfants(t){const e=this.getVariationBasedOnInfants(t);return this.formatVariation(e,t.infants)}calculateVariationAmount(t){var e;return((e=this.getVariationBasedOnInfants(t))===null||e===void 0?void 0:e.discounted_amount)||0}getVariationBasedOnInfants({variations:t,baseVariation:e,infants:i}){const{adult_nbr:s,child_nbr:a}=e;return t.find((t=>t.adult_nbr===s&&t.child_nbr===Math.max(0,a-Math.max(0,i))))||e}formatVariation({child_nbr:t,adult_nbr:e},i){var s,a,n,o;const r=Number(e)||0;const l=Math.max(Number(i)||0,0);const c=r>1?y.entries.Lcz_Adults.toLowerCase():y.entries.Lcz_Adult.toLowerCase();const d=t>1?y.entries.Lcz_Children.toLowerCase():y.entries.Lcz_Child.toLowerCase();const h=l>1?(a=(s=y.entries["Lcz_Infants"])!==null&&s!==void 0?s:"infants")===null||a===void 0?void 0:a.toLowerCase():(o=(n=y===null||y===void 0?void 0:y.entries["Lcz_Infant"])!==null&&n!==void 0?n:"infant")===null||o===void 0?void 0:o.toLowerCase();const u=[`${r} ${c}`,t?`${t} ${d}`:"",l?`${l} ${h}`:""];return u.filter(Boolean).join("&nbsp&nbsp&nbsp&nbsp")}}const Ct=".sc-igl-application-info-h{display:block}.rate_amount.sc-igl-application-info{display:none;padding:0;margin:0}.booking-header.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;margin-bottom:0.5rem;gap:0.5rem}.non-ref-span.sc-igl-application-info{font-size:12px;color:var(--green)}.booking-roomtype-title.sc-igl-application-info{font-size:1.25rem;margin-right:0.5rem;margin:0;padding:0}.booking-details-container.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin:0}.booking-rateplan.sc-igl-application-info{display:flex;align-items:center;gap:0.5rem;margin:0;padding:0}.booking-rateplan-name.sc-igl-application-info{font-weight:bold;margin:0;padding:0}.booking-tooltip.sc-igl-application-info{margin-right:0.5rem;margin:0;padding:0}.booking-variation.sc-igl-application-info{margin:0;padding:0}.booking-price.sc-igl-application-info{margin:0;padding:0}.booking-footer.sc-igl-application-info{display:flex;align-items:center;justify-content:space-between;padding:0;margin-bottom:0.5rem}.booking-details-container.sc-igl-application-info{display:none}@media (min-width: 768px){.booking-header.sc-igl-application-info{justify-content:flex-start}.booking-footer.sc-igl-application-info,.booking-price.sc-igl-application-info{display:none}.booking-details-container.sc-igl-application-info,.rate_amount.sc-igl-application-info{display:inline-flex;gap:0.5rem}}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:100%}.guest-info-container.sc-igl-application-info,.bed-preference-container.sc-igl-application-info,.unit-select-container.sc-igl-application-info{max-width:250px}}";const Ot=Ct;const Mt=class{constructor(e){t(this,e);this.bedPreferenceType=[];this.bookingType="PLUS_BOOKING";this.totalNights=1;this.isButtonPressed=false;this.variationService=new Dt}componentWillLoad(){var t,e;if(w(this.rateplanSelection.roomtype.id)){const i=this.filterRooms();if(i.length>0)this.updateGuest({unit:(e=(t=i[0])===null||t===void 0?void 0:t.id)===null||e===void 0?void 0:e.toString()})}}updateGuest(t){const e=this.rateplanSelection.roomtype.id;const i=this.rateplanSelection.ratePlan.id;let s=[...this.rateplanSelection.guest];s[this.roomIndex]=Object.assign(Object.assign({},s[this.roomIndex]),t);o.ratePlanSelections=Object.assign(Object.assign({},o.ratePlanSelections),{[e]:Object.assign(Object.assign({},o.ratePlanSelections[e]),{[i]:Object.assign(Object.assign({},this.rateplanSelection),{guest:[...s]})})})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}getTooltipMessages(){var t,e,i,s,a,n,o;const{ratePlan:r,selected_variation:l}=this.rateplanSelection;let c=l;if((t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr){c=this.variationService.getVariationBasedOnInfants({variations:r.variations,baseVariation:l,infants:(e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr})}if(!c)return;const d=(i=r.variations)===null||i===void 0?void 0:i.find((t=>t.adult_nbr===c.adult_nbr&&t.child_nbr===c.child_nbr));if(!d)return;const h=(a=(s=d.applicable_policies)===null||s===void 0?void 0:s.find((t=>t.type==="cancelation")))===null||a===void 0?void 0:a.combined_statement;const u=(o=(n=d.applicable_policies)===null||n===void 0?void 0:n.find((t=>t.type==="guarantee")))===null||o===void 0?void 0:o.combined_statement;let f="";if(h){f+=`<b><u>Cancellation:</u></b> ${h}<br/>`}if(u){f+=`<b><u>Guarantee:</u></b> ${u}`}return f||undefined}getAmount(){var t,e;if(this.rateplanSelection.is_amount_modified){return this.rateplanSelection.view_mode==="001"?this.rateplanSelection.rp_amount:this.rateplanSelection.rp_amount*this.totalNights}let i=this.rateplanSelection.selected_variation;if((t=this.guestInfo)===null||t===void 0?void 0:t.infant_nbr){i=this.variationService.getVariationBasedOnInfants({variations:this.rateplanSelection.ratePlan.variations,baseVariation:this.rateplanSelection.selected_variation,infants:(e=this.guestInfo)===null||e===void 0?void 0:e.infant_nbr})}return i.discounted_gross_amount}filterRooms(){var t,e,i,s;const a=[];if(!x.is_frontdesk_enabled){return a}(e=(t=this.rateplanSelection.ratePlan)===null||t===void 0?void 0:t.assignable_units)===null||e===void 0?void 0:e.forEach((t=>{if(t.Is_Fully_Available){a.push({name:t.name,id:t.pr_id})}}));const n=this.rateplanSelection.guest.filter(((t,e)=>e!==this.roomIndex)).map((t=>t.unit));const o=a.filter((t=>!n.includes(t.id.toString())));return this.bookingType==="EDIT_BOOKING"?[...o,this.rateplanSelection.roomtype.id===((i=this.baseData)===null||i===void 0?void 0:i.roomtypeId)?(s=this.baseData)===null||s===void 0?void 0:s.unit:null].filter((t=>!!t)).sort(((t,e)=>t.name.localeCompare(e.name))):o}render(){var t,s,a,n,l,c,d,h,u,f,p,b,g;const m=this.filterRooms();const v=this.variationService.formatVariationBasedOnInfants({baseVariation:this.rateplanSelection.selected_variation,infants:this.guestInfo.infant_nbr,variations:this.rateplanSelection.ratePlan.variations});return e(i,{key:"270e3dc0949b4139e00170e997aa66d31177b8cd",class:"my-2","data-testid":`room_info_${this.rateplanSelection.ratePlan.id}`},e("div",{key:"bfca340a2e33ea209bb780fc1d7a577ad38fdbd1",class:"booking-header"},(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&e("span",{key:"aa19eb861f285cf72cbf8e8a56ca573f1498f945",class:"booking-roomtype-title"},this.rateplanSelection.roomtype.name),e("div",{key:"3087b8da03cd2cf3b53304d3079350520f11d821",class:"booking-details-container"},e("div",{key:"b6babfe4fe365bdaf0b2e6e5b472d96ccfc1c7e9",class:"booking-rateplan"},e("p",{key:"7211e672a094a94c07bfa9c7da6dfd9f90e18e07",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name," ",this.rateplanSelection.ratePlan.is_non_refundable&&e("span",{key:"48f7cd820ec1b01c6241e0c4585dfb8498017bc6",class:"non-ref-span"},"Non Refundable")),e("ir-tooltip",{key:"a68de9a3b9bd03c3f9fd4984b7868c9989be265f",class:"booking-tooltip",message:this.getTooltipMessages()})),e("p",{key:"5fe49ff41a3972d24041f1aabc59e3555bc255a5",class:"booking-variation",innerHTML:v})),e("p",{key:"62a54cb87856de6a10436bc6c2a26954d407dda5",class:"booking-price"},_((t=this.currency)===null||t===void 0?void 0:t.symbol,this.getAmount()),"/",y.entries.Lcz_Stay)),e("div",{key:"f746accf240b6bc7f0e6aa3b54286268d6699405",class:"booking-footer"},e("div",{key:"ed2b5e8379eaa3d3f9debffc64e63c6b3a3da90a",class:"booking-rateplan"},e("p",{key:"dd93b4e7753a9fff02d11b5e924148796ccc4da5",class:"booking-rateplan-name"},this.rateplanSelection.ratePlan.short_name),e("ir-tooltip",{key:"27ccd413a9b2b89315fb291827c900a06097c7ec",class:"booking-tooltip",message:this.getTooltipMessages()})),e("p",{key:"8fed6aedf45fdd43f60e5be6243d26c43b9da328",class:"booking-variation",innerHTML:v})),e("div",{key:"cc6cb8d49f456c07af4484931031d5439c2648f7",class:"d-flex flex-column flex-md-row  p-0 align-items-md-center aplicationInfoContainer"},e("div",{key:"4b30adda679ccdf9cdf30d97c5dc9aeeb7d2bd56",class:"mr-md-1 mb-1 mb-md-0 flex-fill guest-info-container"},e("input",{key:"ab764e2d79bff44061644ccb8354d2e3c11423b4",id:ht(),type:"text","data-testid":"guest_first_name",class:`form-control ${this.isButtonPressed&&((s=this.guestInfo)===null||s===void 0?void 0:s.first_name)===""&&"border-danger"}`,placeholder:(a=y.entries["Lcz_GuestFirstname"])!==null&&a!==void 0?a:"Guest first name",name:"guestFirstName",onInput:t=>{const e=t.target.value;this.updateGuest({first_name:e});if(o.event_type.type==="EDIT_BOOKING"){r("guest",Object.assign(Object.assign({},o.guest),{name:e}))}},required:true,value:(n=this.guestInfo)===null||n===void 0?void 0:n.first_name})),e("div",{key:"7504c9306bf9e7264952a334eba9748e67052472",class:"mr-md-1 flex-fill guest-info-container"},e("input",{key:"0b0e165c2c91b5db8132702a612eb928e47fd0f2",id:ht(),type:"text",class:`form-control ${this.isButtonPressed&&((l=this.guestInfo)===null||l===void 0?void 0:l.last_name)===""&&"border-danger"}`,placeholder:(c=y.entries["Lcz_GuestLastname"])!==null&&c!==void 0?c:"Guest last name",name:"guestLastName","data-testid":"guest_last_name",onInput:t=>{const e=t.target.value;this.updateGuest({last_name:e});if(o.event_type.type==="EDIT_BOOKING"){r("guest",Object.assign(Object.assign({},o.guest),{name:e}))}},required:true,value:(d=this.guestInfo)===null||d===void 0?void 0:d.last_name})),x.is_frontdesk_enabled&&!w(this.rateplanSelection.roomtype.id)&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")&&e("div",{key:"957af199cf8c402a2de35173742f800fdf31cb20",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},e("div",{key:"d1e3e370a2ed9e2b3d69884c77cea18b42b8b959",class:"mr-md-1 p-0 flex-fill preference-select-container"},e("select",{key:"371a3b8673b7be48e1921e0fc434c144d52aa10d","data-testid":"unit",class:"form-control input-sm pr-0",id:ht(),onChange:t=>this.updateGuest({unit:t.target.value})},e("option",{key:"04e8109ba52eb1191cdbcdcaaa77b3b83b8baba1",value:"",selected:((h=this.guestInfo)===null||h===void 0?void 0:h.unit)===""},y.entries.Lcz_Assignunits),m===null||m===void 0?void 0:m.map((t=>{var i;return e("option",{value:t.id,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.unit)===t.id.toString()},t.name)}))))),this.rateplanSelection.roomtype.is_bed_configuration_enabled&&e("div",{key:"0e6de40478ee85bc99b9bd94df5ef639191cafa0",class:"mt-1 mt-md-0 mr-md-1 flex-fill"},e("select",{key:"76bd075744f1021e63a9f445b0f41af1036fd309","data-testid":"bed_configuration",class:`form-control input-sm ${this.isButtonPressed&&((u=this.guestInfo)===null||u===void 0?void 0:u.bed_preference)===""&&"border-danger"}`,id:ht(),onChange:t=>this.updateGuest({bed_preference:t.target.value})},e("option",{key:"e14a3e622f12b8012151275c4e346064f9469970",value:"",selected:((f=this.guestInfo)===null||f===void 0?void 0:f.bed_preference)===""},y.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((t=>{var i;return e("option",{value:t.CODE_NAME,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.bed_preference)===t.CODE_NAME},t.CODE_VALUE_EN)})))),e("p",{key:"ad77cc7de624bbb0ec4d981323c3fe8e7ed66b9c",class:"rate_amount"},_((p=this.currency)===null||p===void 0?void 0:p.symbol,this.getAmount()),"/",y.entries.Lcz_Stay)),this.rateplanSelection.selected_variation.child_nbr>0&&e("div",{key:"06d302f33d90c4439e2d626ac5522c48eab0ec88",style:{gap:"0.5rem",marginTop:"0.5rem"},class:"d-flex  flex-row  p-0 align-items-center aplicationInfoContainer"},e("p",{key:"36338e61b71d69389a5ad2d43563a9309fbbbeed",class:"m-0 p-0 text-danger"},"Any of the children below 3 years?"),e("div",{key:"cd3a92cd2f3473eaecf2f3412bfecacd49d7bb5e",class:"mr-1 flex-fill"},e("select",{key:"43c120521784dcf8539a71fc8ecee074deebc3d2",class:`form-control input-sm ${this.isButtonPressed&&((b=this.guestInfo)===null||b===void 0?void 0:b.bed_preference)===""&&"border-danger"}`,id:ht(),style:{width:"max-content"},onChange:t=>this.updateGuest({infant_nbr:Number(t.target.value)})},e("option",{key:"47484dc2d40f4d78d53b58fcf246b6c964970d2e",value:"",selected:Number((g=this.guestInfo)===null||g===void 0?void 0:g.infant_nbr)===0},y.entries["No"]||"No"),Array.from({length:this.rateplanSelection.selected_variation.child_nbr},((t,e)=>e+1)).map((t=>{var i;return e("option",{value:t,selected:((i=this.guestInfo)===null||i===void 0?void 0:i.infant_nbr)===t},t)}))))))}};Mt.style=Ot;const Et=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const Yt=Et;const At=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.isEventHover=false;this.renderAgain=false;this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new l}async componentWillLoad(){try{this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(t){}}handleOptionalReason(t){this.blockDatesData.OPTIONAL_REASON=t.target.value;this.emitData()}handleReleaseAfterChange(t){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(t.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let t=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){t.setHours(this.entryHour,this.entryMinute,0,0)}else{t.setHours(t.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,t.getMinutes(),0,0)}return t.toLocaleString("default",{month:"short"})+" "+t.getDate()+", "+this.formatNumber(t.getHours())+":"+this.formatNumber(t.getMinutes())}formatNumber(t){return t<10?`0${t}`:t}handleOutOfService(t){this.blockDatesData.OUT_OF_SERVICE=t.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){console.log({fromDate:this.fromDate,toDate:this.toDate});return e(i,{key:"9bc6beece8e2f6dadd6d929413c0b654ad8c8a70"},e("div",{key:"f80c8dbf73d06cc95a56473a3925cd20de565751",class:`m-0 p-0 mb-1`},e("div",{key:"56684bb7f118deee95b23b78fc0a44558a5b950d",class:"text-left p-0"},e("ir-date-view",{key:"677a3ce35f708976d7931a2115f125d84c10f6ab",from_date:this.fromDate,dateOption:"YYYY-MM-DD",showDateDifference:false,to_date:this.toDate}))),e("div",{key:"396249b077eaace9fc339b0cfe0a9f4011aed50c",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},e("div",{key:"a518baf4c0bcfafe7911a759d05dbb8c127f5991",class:"mb-1 "},e("label",{key:"b895a7a8924d9bb4cd0d7e46232453f5839c166b",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},y.entries.Lcz_Reason,":"),e("div",{key:"f6d0a6dbdd97e67ea3b8683bfbff8c79d2b1119e",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},e("input",{key:"9877d3a930218f243f5adb668bc00ca4a89397ee",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:t=>this.handleOutOfService(t)})),e("span",{key:"31d688ea76901bb89b696f5c42aabcf2fec110c4",class:"align-middle out-of-service-label"},y.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?e("div",null,e("div",{class:"mb-1 d-flex  align-items-center"},e("span",{class:"align-middle"},y.entries.Lcz_Or," "),e("div",{class:"d-inline-flex col pr-0 align-middle"},e("input",{class:"form-control",type:"text",placeholder:y.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:t=>this.handleOptionalReason(t)}))),e("div",{class:"mb-1 w-100 pr-0 "},e("span",{class:"text-bold-700 font-medium-1"},y.entries.Lcz_AutomaticReleaseIn,": "),e("div",{class:"d-inline-block"},e("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:t=>this.handleReleaseAfterChange(t)},this.releaseList.map((t=>e("option",{value:+t.CODE_NAME,selected:Number(this.blockDatesData.RELEASE_AFTER_HOURS)==Number(t.CODE_NAME)},t.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?e("div",{class:"d-inline-block releaseTime"},e("em",null,y.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};At.style=Yt;var Tt=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};class St{setBookingInfoFromAutoComplete(t,e){var i,s,a;t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:(s=(i=e.guest)===null||i===void 0?void 0:i.country_phone_prefix)!==null&&s!==void 0?s:(a=e.guest)===null||a===void 0?void 0:a.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,a){let n=e;const{data:o,key:r,changedKey:l}=t.detail;const c=`c_${o.roomCategoryId}`;const d=`p_${o.ratePlanId}`;if(this.shouldClearData(r)){n=new Map}this.initializeRoomCategoryIfNeeded(c,n);if(s){if(l==="rate"){if(n.has(c)&&n.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,o,n,a,i)}}else{if(l!=="rateType"){if(l==="adult_child_offering"){if(n.has(c)&&e.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,o,n,a,i)}}else{this.applyBookingEditToSelectedRoom(c,d,o,n,a,i)}}}}else{this.setSelectedRoomData(c,d,o,n)}this.cleanupEmptyData(c,n);return n}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let a=s.get(t);if(i.totalRooms===0||i.inventory===0){a.delete(e)}else{s.set(t,a.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,a,n){s.clear();let o={};if(n){o=Object.assign(Object.assign({},i),{guestName:a||"",roomId:""})}else{o=Object.assign({},i)}s.set(t,(new Map).set(e,o))}calculateAmount({is_amount_modified:t,selected_variation:e,view_mode:i,rp_amount:s}){const a=e.nights.length;if(t){return i==="002"?s:s/a}}generateDailyRates(t,e){let i=t.selected_variation;const s=t.is_amount_modified?this.calculateAmount(t):null;if(t.guest[e].infant_nbr>0&&!t.is_amount_modified){if(!this.variationService){this.variationService=new Dt}i=this.variationService.getVariationBasedOnInfants({variations:t.ratePlan.variations,baseVariation:t.selected_variation,infants:t.guest[e].infant_nbr})}return i.nights.map((t=>({date:t.night,amount:s!==null&&s!==void 0?s:t.discounted_amount,cost:null})))}getBookedRooms({check_in:t,check_out:e,notes:i,identifier:s,override_unit:a,unit:n,auto_check_in:r}){var l,c;const d=[];for(const h in o.ratePlanSelections){const u=o.ratePlanSelections[h];for(const o in u){const h=u[o];if(h.reserved>0){for(let o=0;o<h.reserved;o++){const{first_name:u,last_name:f}=h.guest[o];d.push({identifier:s,roomtype:h.roomtype,rateplan:h.ratePlan,prepayment_amount_gross:0,unit:a?{id:n}:h.guest[o].unit?{id:h.guest[o].unit}:null,occupancy:{adult_nbr:h.selected_variation.adult_nbr,children_nbr:Number((l=h.selected_variation.child_nbr)!==null&&l!==void 0?l:0)-Math.max(Number((c=h.guest[o].infant_nbr)!==null&&c!==void 0?c:0),0),infant_nbr:h.guest[o].infant_nbr},bed_preference:h.guest[o].bed_preference,from_date:D(t).format("YYYY-MM-DD"),to_date:D(e).format("YYYY-MM-DD"),notes:i,check_in:r,days:this.generateDailyRates(h,o),guest:{email:null,first_name:u,last_name:f,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null,cci:null}})}}}}return d}async prepareBookUserServiceParams({context:t,sourceOption:e,check_in:i}){var s,a;try{if(!t||!t.dateRangeData){throw new Error("Invalid context: Missing date range data.")}const n=new Date(t.dateRangeData.fromDate);const o=new Date(t.dateRangeData.toDate);const r=(e=null,i=false)=>this.getBookedRooms({check_in:n,check_out:o,identifier:e,notes:"",override_unit:t.isEventType("BAR_BOOKING")?true:false,unit:t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:null,auto_check_in:i});const l=(t,e)=>{var{pickup_info:i,extra_services:s,is_direct:a,is_in_loyalty_mode:n,promo_key:o,extras:r}=t,l=Tt(t,["pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras"]);return{assign_units:true,is_pms:true,is_direct:a,is_backend:true,is_in_loyalty_mode:n,promo_key:o,extras:r,booking:Object.assign(Object.assign({},l),{rooms:e}),extra_services:s,pickup_info:i}};let c=null;switch(t.defaultData.event_type){case"EDIT_BOOKING":{const{booking:e,currentRoomType:i}=t.defaultData;const a=e.rooms.filter((t=>t.identifier!==i.identifier));console.log("currentRoomType",i);const n=r(i.identifier,((s=i.in_out)===null||s===void 0?void 0:s.code)==="001");c=l(e,[...a,...n]);break}case"ADD_ROOM":case"SPLIT_BOOKING":{const{booking:e,ROOMS:i}=t.defaultData;if(!e){throw new Error("Missing booking")}const s=r();const a=t.defaultData.event_type==="ADD_ROOM"?i!==null&&i!==void 0?i:[]:e===null||e===void 0?void 0:e.rooms;c=l(e,[...a,...s]);break}default:{const s=r(null,i);const{bookedByInfoData:l}=t;const d=e.type==="TRAVEL_AGENCY";c={assign_units:true,is_pms:true,is_direct:true,is_backend:true,is_in_loyalty_mode:false,promo_key:null,extras:C,agent:d?{id:e.tag}:null,booking:{from_date:D(n).format("YYYY-MM-DD"),to_date:D(o).format("YYYY-MM-DD"),remark:l.message||null,booking_nbr:"",property:{id:t.propertyid},booked_on:{date:D().format("YYYY-MM-DD"),hour:(new Date).getHours(),minute:(new Date).getMinutes()},source:d?"":e,rooms:s,currency:t.currency,arrival:{code:l.selectedArrivalTime},guest:{email:l.email===""?null:l.email||null,first_name:l.firstName,last_name:l.lastName,country_id:l.countryId===""?null:l.countryId,city:null,mobile:l.contactNumber===null?"":l.contactNumber,country_phone_prefix:(a=l===null||l===void 0?void 0:l.isdCode)!==null&&a!==void 0?a:null,address:"",dob:null,subscribe_to_news_letter:l.emailGuest||false,cci:l.cardNumber?{nbr:l.cardNumber,holder_name:l.cardHolderName,expiry_month:l.expiryMonth,expiry_year:l.expiryYear}:null}},pickup_info:null};break}}return c}catch(t){console.error(t)}}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const a=`p_${t.RATE_PLAN_ID}`;const n={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(a,n))}}const Bt=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;min-height:100vh;z-index:99;overflow:hidden}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.card-header-container.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%;display:flex;align-items:center;box-sizing:border-box;padding:1rem 0;justify-content:space-between}.loading-container.sc-igl-book-property{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.card-header-container.sc-igl-book-property h3.sc-igl-book-property{padding:0;margin:0}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;inset:0;left:unset;background-color:#ffffff;width:100%;overflow:auto;animation:slideInFromRight 0.5s}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.sheet-footer.sc-igl-book-property{width:100%}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px;padding-bottom:0 !important}}@keyframes slideInFromRight{from{transform:translateX(120%)}to{transform:translateX(0)}}@keyframes slideOutToRight{from{transform:translateX(0)}to{transform:translateX(120%)}}.sideWindow--exit.sc-igl-book-property{animation:slideOutToRight 0.5s forwards}";const It=Bt;const jt=".sc-igl-book-property-h{height:100%}.sheet-container.sc-igl-book-property{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-igl-book-property{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-igl-book-property{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-igl-book-property{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-igl-book-property{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-igl-book-property{flex-direction:row;align-items:center}}";const zt=jt;const Nt=class{constructor(e){t(this,e);this.closeBookingWindow=s(this,"closeBookingWindow",7);this.blockedCreated=s(this,"blockedCreated",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.toast=s(this,"toast",7);this.showPaymentDetails=false;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.bookingHistory=[];this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new l;this.bookPropertyService=new St;this.updatedBooking=false;this.MAX_HISTORY_LENGTH=2}async componentWillLoad(){console.log("<==>roomtypes<==>",o===null||o===void 0?void 0:o.roomTypes);if(o.roomTypes){r("roomTypes",[]);r("ratePlanSelections",{})}this.handleKeyDown=this.handleKeyDown.bind(this);this.initializeDefaultDateRange();if(!this.bookingData.defaultDateRange){return}this.initializeDefaultData();this.wasBlockedUnit=this.defaultData.hasOwnProperty("block_exposed_unit_props");r("event_type",{type:this.defaultData.event_type});this.fetchSetupEntriesAndInitialize()}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown);O(true)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();t.stopPropagation();const{key:e,data:i}=t.detail;if(e==="select"||e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i.booking_nbr||i,this.language);this.defaultData=Object.assign(Object.assign({},this.defaultData),{booking:t});this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}const{adult:e,child:i}=t.detail;this.adultChildCount=Object.assign({},t.detail);this.updateBookingHistory({adults:Number(e),children:Number(i)})}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.updateBookingHistory({dates:{checkIn:new Date(this.dateRangeData.fromDate),checkOut:new Date(new Date(e.data.toDate))}});console.log("date changed",e);if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.checkBookingAvailability()}}}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag,id:i.id,type:i.type}}gotoSplitPageTwo(){this.gotoPage("page_two")}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();if(this.isEventType("BAR_BOOKING")){d()}this.gotoPage("page_one");break;case"book":this.bookUser(false);break;case"bookAndCheckIn":this.bookUser(true);break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(c()>0){this.gotoPage("page_two");break}else if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}this.toast.emit({type:"error",description:y.entries.Lcz_SelectRatePlan,title:y.entries.Lcz_SelectRatePlan});break;case"check":this.checkBookingAvailability();break}}updateBookingHistory(t){var e,i,s,a,n,o,r,l;const c=this.bookingHistory[this.bookingHistory.length-1];const d={dates:{checkIn:((e=t.dates)===null||e===void 0?void 0:e.checkIn)||((i=c===null||c===void 0?void 0:c.dates)===null||i===void 0?void 0:i.checkIn)||new Date(this.dateRangeData.fromDate),checkOut:((s=t.dates)===null||s===void 0?void 0:s.checkOut)||((a=c===null||c===void 0?void 0:c.dates)===null||a===void 0?void 0:a.checkOut)||new Date(this.dateRangeData.toDate)},adults:(o=(n=t.adults)!==null&&n!==void 0?n:c===null||c===void 0?void 0:c.adults)!==null&&o!==void 0?o:this.adultChildCount.adult,children:(l=(r=t.children)!==null&&r!==void 0?r:c===null||c===void 0?void 0:c.children)!==null&&l!==void 0?l:this.adultChildCount.child};this.bookingHistory.push(d);if(this.bookingHistory.length>this.MAX_HISTORY_LENGTH){this.bookingHistory.shift()}}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}}initializeDefaultDateRange(){this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE}}initializeDefaultData(){this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange)}async fetchSetupEntriesAndInitialize(){try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);this.initializeEventData()}catch(t){console.error("Error fetching setup entries:",t)}}initializeEventData(){if(this.isEventType("EDIT_BOOKING")){this.initializeEditBookingData()}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.initializePage()}initializeEditBookingData(){var t,e,i,s,a;this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};const{currentRoomType:n,GUEST:o}=this.defaultData;console.log(o);r("guest",{bed_preference:(t=n.bed_preference)===null||t===void 0?void 0:t.toString(),infant_nbr:n.occupancy.infant_nbr,first_name:(e=o.first_name)!==null&&e!==void 0?e:"",last_name:(i=o.last_name)!==null&&i!==void 0?i:"",unit:(a=(s=n.unit)===null||s===void 0?void 0:s.id)===null||a===void 0?void 0:a.toString()});this.checkBookingAvailability();this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}initializePage(){switch(this.defaultData.event_type){case"SPLIT_BOOKING":this.showSplitBookingOption=true;this.page="page_one";break;case"BLOCK_DATES":this.page="page_block_date";break;default:this.page="page_one";break}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){for(const t in o.ratePlanSelections){const e=o.ratePlanSelections[t];for(const t in e){const i=e[t];if(i.reserved>0){for(const t of i.guest){if(t.first_name===""||t.last_name===""){return true}}}}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.id,value:t.description,tag:t.tag,type:t.type})));this._sourceOptions=this.isEventType("BAR_BOOKING")?this.getFilteredSourceOptions():this.sourceOptions;if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{let t=this._sourceOptions.find((t=>t.type!=="LABEL"));console.log({option:t});this.sourceOption={code:t.code,description:t.description,tag:t.tag,type:t.type,id:t.id}}}getFilteredSourceOptions(){var t,e,i,s;const a=new Set;const n=(i=(e=(t=this.bookingData)===null||t===void 0?void 0:t.roomsInfo)===null||e===void 0?void 0:e.some((t=>{var e;const i=(e=t===null||t===void 0?void 0:t.rateplans)!==null&&e!==void 0?e:[];if(i.length===0)return false;const s=i.every((t=>{var e,i;return((i=(e=t===null||t===void 0?void 0:t.agents)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0)>0}));if(s){i.forEach((t=>{var e;((e=t===null||t===void 0?void 0:t.agents)!==null&&e!==void 0?e:[]).forEach((t=>{var e;return a.add((e=t===null||t===void 0?void 0:t.id)===null||e===void 0?void 0:e.toString())}))}))}return s})))!==null&&i!==void 0?i:false;if(!n){return this.sourceOptions}return((s=this.sourceOptions)!==null&&s!==void 0?s:[]).filter((t=>{if((t===null||t===void 0?void 0:t.type)==="LABEL")return true;const e=t===null||t===void 0?void 0:t.tag;const i=e!=null&&a.has(e);return i}))}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}async checkBookingAvailability(){h();const t=D(this.dateRangeData.fromDate).format("YYYY-MM-DD");const e=D(this.dateRangeData.toDate).format("YYYY-MM-DD");console.log({sourceOption:this.sourceOption});const i=this.sourceOption["type"]==="TRAVEL_AGENCY";try{const s=this.isEventType("EDIT_BOOKING")?[this.defaultData.RATE_TYPE]:[];const a=this.isEventType("BAR_BOOKING")?this.defaultData.roomsInfo.map((t=>t.id)):[];const n=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyid,adultChildCount:this.adultChildCount,language:this.language,room_type_ids:a,currency:this.currency,agent_id:i?this.sourceOption["tag"]:null,is_in_agent_mode:i,room_type_ids_to_update:s});if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:n});if(this.isEventType("EDIT_BOOKING")&&!this.updatedBooking){this.updateBooking()}}catch(t){console.error("Error initializing booking availability:",t)}}updateBooking(){var t,e,i;try{const{currentRoomType:s,GUEST:a}=this.defaultData;const n=s.roomtype.id;const o=s.rateplan.id;const l={bed_preference:(t=s.bed_preference)===null||t===void 0?void 0:t.toString(),infant_nbr:s.occupancy.infant_nbr,last_name:a.last_name,first_name:a.first_name,unit:(i=(e=s.unit)===null||e===void 0?void 0:e.id)===null||i===void 0?void 0:i.toString(),roomtype_id:s.roomtype.id};r("guest",l);u({roomTypeId:n,ratePlanId:o,rooms:1,guest:[l]})}catch(t){console.error(t)}}async checkAndBlockDate(){try{const{block_exposed_unit_props:t}=this.defaultData;await this.bookingService.getBookingAvailability({from_date:t.from_date,to_date:t.to_date,propertyid:this.propertyid,adultChildCount:{adult:2,child:0},language:this.language,room_type_ids:this.defaultData.roomsInfo.map((t=>t.id)),currency:this.currency});const e=o.roomTypes.every((t=>{if(t.is_available_to_book){return true}return t.inventory>0&&t["not_available_reason"]==="ALL-RATES-PLAN-NOT-BOOKABLE"}));if(e){await this.handleBlockDate(false)}else{console.log("Blocked date is unavailable. Continuing...")}}catch(t){console.error("Error checking and blocking date:",t)}}async closeWindow(){h();O(false);if(this.wasBlockedUnit&&!this.didReservation){await this.checkAndBlockDate()}const t=document.querySelector(".sideWindow");if(!t)return;t.classList.add("sideWindow--exit");setTimeout((()=>{this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}),300)}isEventType(t){return this.defaultData.event_type===t}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.wasBlockedUnit||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}renderPage(){this.renderAgain=!this.renderAgain}gotoPage(t){this.page=t;this.renderPage()}getPageBlockDatesView(){return e(a,null,e("igl-block-dates-view",{fromDate:this.defaultData.FROM_DATE,toDate:this.defaultData.TO_DATE,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}))}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(t=true){const e=this.wasBlockedUnit?this.defaultData.block_exposed_unit_props:(()=>{const t=M(+this.blockDatesData.RELEASE_AFTER_HOURS);return Object.assign({from_date:E(this.defaultData.defaultDateRange.fromDate),to_date:E(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t)})();await this.bookingService.blockUnit(e);if(t)this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else if(this.isButtonDisabled()){this.isLoading="";return}try{if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}this.didReservation=true;const e=await this.bookPropertyService.prepareBookUserServiceParams({context:this,sourceOption:this.sourceOption,check_in:t});await this.bookingService.doReservation(e);await this.adjustBlockedDatesAfterReservation(e);this.resetBookingEvt.emit(null)}catch(t){console.error("Error booking user:",t)}finally{this.resetLoadingState()}}async adjustBlockedDatesAfterReservation(t){if(!this.wasBlockedUnit){return}const e=D(this.defaultData.block_exposed_unit_props.from_date,"YYYY-MM-DD");const i=D(t.booking.from_date,"YYYY-MM-DD");const s=D(this.defaultData.block_exposed_unit_props.to_date,"YYYY-MM-DD");const a=D(t.booking.to_date,"YYYY-MM-DD");if(a.isBefore(s,"days")){const t=Object.assign(Object.assign({},this.defaultData.block_exposed_unit_props),{from_date:a.format("YYYY-MM-DD")});await this.bookingService.blockUnit(t)}if(i.isAfter(e,"days")){const t=Object.assign(Object.assign({},this.defaultData.block_exposed_unit_props),{to_date:i.format("YYYY-MM-DD")});await this.bookingService.blockUnit(t)}return}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}getCurrentPage(t){return this.page===t}render(){return e(i,{key:"369ed3e0f4202ec04b69bea53effd363e10d85a2","data-testid":"book_property_sheet h-100"},e("div",{key:"be32cb1439d810e50c22d74a5fba1832216caa8e",class:"background-overlay",onClick:()=>this.closeWindow()}),e("div",{key:"601e36e67a2c75d2b0d05747dea0850626e0906a",class:"sideWindow sheet-container "+(this.getCurrentPage("page_block_date")?"block-date":"")},ut("/Get_Setup_Entries_By_TBL_NAME_MULTI")?e("div",{class:"loading-container"},e("ir-spinner",null)):e(a,null,e("div",{class:"sheet-header"},e("div",{class:"card-header-container mb-2"},e("h3",{class:"text-left font-medium-2 px-2"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),e("ir-icon",{class:"px-2",onIconClickHandler:()=>{this.closeWindow()}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("div",{class:"px-2 sheet-body"},this.getCurrentPage("page_one")&&e("igl-booking-overview-page",{wasBlockedUnit:this.wasBlockedUnit,initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,sourceOptions:this._sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&e("igl-booking-form",{currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countries:this.countries,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null),this.getCurrentPage("page_block_date")?e("div",{class:"sheet-footer"},e("ir-button",{text:y.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClick:()=>this.closeWindow()}),e("ir-button",{text:y.entries.Lcz_Blockdates,isLoading:ut("/Block_Exposed_Unit"),class:"flex-fill",onClick:()=>this.handleBlockDate()})):e("igl-book-property-footer",{page:this.page,dateRangeData:this.dateRangeData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),isLoading:this.isLoading,class:"sheet-footer",eventType:this.bookingData.event_type}))))}};Nt.style=It+zt;const Rt=".sc-igl-book-property-container-h{display:block;margin:0;padding:0;letter-spacing:0px !important;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;font-size:1rem !important;font-weight:400 !important;line-height:1.45 !important;color:#6b6f82 !important;text-align:left !important}.book-container.sc-igl-book-property-container{width:min-content;margin:0;padding:0}h3.sc-igl-book-property-container{font-size:1rem}";const $t=Rt;const Ft=class{constructor(e){t(this,e);this.resetBookingData=s(this,"resetBookingData",7);this.language="";this.ticket="";this.withIrToastAndInterceptor=true;this.calendarData={};this.bookingService=new l;this.roomService=new bt;this.token=new pt}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){try{if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}const[t,e,i]=await Promise.all([this.roomService.getExposedProperty({id:this.propertyid,language:this.language,aname:this.p}),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language)]);if(!y.entries){y.entries=e.entries;y.direction=e.direction}this.countries=i;const{allowed_payment_methods:s,currency:a,allowed_booking_sources:n,adult_child_constraints:o,calendar_legends:r}=t["My_Result"];this.calendarData={currency:a,allowed_booking_sources:n,adult_child_constraints:o,legendData:r};this.setRoomsData(t);const l=["001","004"];this.showPaymentDetails=s.some((t=>l.includes(t.code)))}catch(t){console.error("Error initializing app:",t)}}componentWillLoad(){if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}handleCloseBookingWindow(){this.bookingItem=null}handleTriggerClicked(){const t=new Date;t.setDate(t.getDate()+1);this.bookingItem={FROM_DATE:this.from_date,defaultDateRange:{fromDate:new Date,fromDateStr:"",toDate:t,toDateStr:"",dateDifference:0,message:""},TO_DATE:this.to_date,EMAIL:"",event_type:"PLUS_BOOKING",ID:"",NAME:"",PHONE:"",REFERENCE_TYPE:"",TITLE:y.entries.Lcz_NewBooking}}render(){return e(i,{key:"6d0a76bf60c842ed89efbb66d8689ea9bda909a9"},this.withIrToastAndInterceptor&&e(a,{key:"de1d3d5bbd846f17359c772e062e3471e57839f7"},e("ir-toast",{key:"dd6a9a59b67aa8933980c8c02dc29d932ba89f33"}),e("ir-interceptor",{key:"897bbd20c8e45d79af60b67a344bb502f546510a"})),e("div",{key:"e705d60fd18cd1b4c11a688864cea23655acd5e4",class:"book-container",onClick:this.handleTriggerClicked.bind(this)},e("slot",{key:"d7152d2acfcf47954d8afb557b411ece203eee41",name:"trigger"})),this.bookingItem&&e("igl-book-property",{key:"13edbad4d6fe9ab6b81635891e694501af919949",allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countries:this.countries,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onResetBookingEvt:t=>{t.stopImmediatePropagation();t.stopPropagation();this.resetBookingData.emit(null)},onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))}static get watchers(){return{ticket:["ticketChanged"]}}};Ft.style=$t;const Lt=".sc-igl-book-property-footer-h{width:100% !important;background:#000}";const Pt=Lt;const Ht=class{constructor(e){t(this,e);this.buttonClicked=s(this,"buttonClicked",7);this.disabled=true}isEventType(t){return t===this.eventType}editNext(t){if(this.isEventType("EDIT_BOOKING")){if(t==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton({label:t,type:i,disabled:s,icon_name:a,isLoading:n,icon_position:o="right"}){return e("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(t)}`:"flex-fill"},e("ir-button",{isLoading:n,btn_color:i==="cancel"||i==="back"?"secondary":"primary",text:t,btn_disabled:s,onClickHandler:()=>{this.buttonClicked.emit({key:i})},class:"full-width",btn_styles:"justify-content-center",icon_name:a,iconPosition:o,style:{"--icon-size":"1rem"},icon_style:{paddingBottom:"1.9px"}}))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){var t;if(this.page==="page_one"){return e(i,null,this.isEventType("EDIT_BOOKING")?e(a,null,this.renderButton({type:"cancel",label:y.entries.Lcz_Cancel}),this.shouldRenderTwoButtons()&&this.renderButton({type:"next",label:`${y.entries.Lcz_Next}`,disabled:ut("/Get_Exposed_Booking_Availability"),icon_name:"angles_right"})):e(a,null,this.renderButton({type:"cancel",label:y.entries.Lcz_Cancel}),this.shouldRenderTwoButtons()&&this.renderButton({type:"next",label:`${y.entries.Lcz_Next}`,icon_name:"angles_right"})))}const s=x.checkin_enabled&&D(new Date((t=this.dateRangeData)===null||t===void 0?void 0:t.fromDate)).isSame(new Date,"day");return e(a,null,this.isEditOrAddRoomEvent?e(a,null,this.renderButton({type:"back",icon_position:"left",label:y.entries.Lcz_Back,icon_name:"angles_left"}),this.renderButton({type:"save",label:y.entries.Lcz_Save,isLoading:this.isLoading==="save"})):e(a,null,this.renderButton({type:"back",icon_position:"left",label:y.entries.Lcz_Back,icon_name:"angles_left"}),this.renderButton({type:"book",label:y.entries.Lcz_Book,isLoading:this.isLoading==="book"}),s&&this.renderButton({type:"bookAndCheckIn",label:y.entries.Lcz_BookAndChekcIn,isLoading:this.isLoading==="bookAndCheckIn"})))}};Ht.style=Pt;const Ut=".sc-igl-book-property-header-h{display:block}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const Vt=Ut;const Gt=class{constructor(e){t(this,e);this.splitBookingDropDownChange=s(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=s(this,"sourceDropDownChange",7);this.adultChild=s(this,"adultChild",7);this.checkClicked=s(this,"checkClicked",7);this.buttonClicked=s(this,"buttonClicked",7);this.toast=s(this,"toast",7);this.spiltBookingSelected=s(this,"spiltBookingSelected",7);this.animateIrButton=s(this,"animateIrButton",7);this.animateIrSelect=s(this,"animateIrSelect",7);this.splitBookingId="";this.bookingData="";this.sourceOptions=[];this.showSplitBookingOption=false;this.sourceOption={code:"",description:"",tag:"",id:"",type:""}}getSplitBookingList(){return e("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},e("label",{class:"mr-lg-1"},y.entries.Lcz_Tobooking,"# "),e("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},e("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:D(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:D(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:y.entries.Lcz_BookingNumber,onComboboxValue:t=>{t.stopImmediatePropagation();this.spiltBookingSelected.emit(t.detail)},isSplitBooking:true})))}getSourceNode(){return e("fieldset",{class:"d-flex text-left  align-items-center"},e("label",{class:"mr-1"},y.entries.Lcz_Source," "),e("div",{class:"btn-group mt-0 flex-fill sourceContainer"},e("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:t=>this.sourceDropDownChange.emit(t.target.value)},this.sourceOptions.map((t=>{if(t.type==="LABEL"){return e("optgroup",{label:t.value})}return e("option",{value:t.id,selected:this.sourceOption.code===t.id},t.value)})))))}handleAdultChildChange(t,e){var i,s;let a={};if(e===""){a=Object.assign(Object.assign({},this.adultChildCount),{[t]:0})}else{a=Object.assign(Object.assign({},this.adultChildCount),{[t]:e})}r("bookingAvailabilityParams",{from_date:this.bookingDataDefaultDateRange.fromDate,to_date:this.bookingDataDefaultDateRange.toDate,adult_nbr:(i=a===null||a===void 0?void 0:a["adult"])!==null&&i!==void 0?i:0,child_nbr:(s=a===null||a===void 0?void 0:a["child"])!==null&&s!==void 0?s:0});this.adultChild.emit(a)}getAdultChildConstraints(){var t,i,s,a;return e("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},e("div",{class:"form-group  my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},e("fieldset",null,e("div",{class:"btn-group ml-0"},e("ir-select",{testId:"adult_number",class:"m-0",selectedValue:(i=(t=this.adultChildCount)===null||t===void 0?void 0:t.adult)===null||i===void 0?void 0:i.toString(),onSelectChange:t=>this.handleAdultChildChange("adult",t.detail),selectId:"adult_select",firstOption:y.entries.Lcz_AdultsCaption,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&e("fieldset",null,e("div",{class:"btn-group ml-1 p-0"},e("ir-select",{selectedValue:(a=(s=this.adultChildCount)===null||s===void 0?void 0:s.child)===null||a===void 0?void 0:a.toString(),testId:"child_number",onSelectChange:t=>this.handleAdultChildChange("child",t.detail),selectId:"child_select",firstOption:this.renderChildCaption(),data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),e("ir-button",{btn_id:"check_availability",isLoading:ut("/Check_Availability"),size:"sm",class:"ml-2",text:y.entries.Lcz_Check,onClickHandler:()=>this.handleButtonClicked()})))}renderChildCaption(){const t=this.adultChildConstraints.child_max_age;let e=y.entries.Lcz_Years;if(t===1){e=y.entries.Lcz_Year}return`${y.entries.Lcz_ChildCaption} 0 - ${this.adultChildConstraints.child_max_age} ${e}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:y.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const e=D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=D(new Date(this.dateRangeData.fromDate));const s=D(new Date(this.dateRangeData.toDate));if(s.isBefore(e)||i.isAfter(t)){this.toast.emit({type:"error",title:`${y.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:y.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${y.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:y.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(t){return this.bookingData.event_type===t}getMinDate(){var t;if(this.isEventType("PLUS_BOOKING")){return D().add(-1,"months").startOf("month").format("YYYY-MM-DD")}if(this.wasBlockedUnit){return(t=this.bookingData)===null||t===void 0?void 0:t.block_exposed_unit_props.from_date}return this.minDate}getMaxDate(){var t,e;if(!((t=this.bookingData)===null||t===void 0?void 0:t.block_exposed_unit_props)){return undefined}return(e=this.bookingData)===null||e===void 0?void 0:e.block_exposed_unit_props.to_date}render(){const t=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return e(i,{key:"64aec62e31e4b302a6f8758f5d73e5f64c11fd8e"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),t&&this.getSourceNode(),e("div",{key:"1836a74c2a7e6fc96d47c77eac74bab630ed3214",class:`d-flex flex-column flex-lg-row align-items-lg-center ${t?"mt-1":""}`},e("fieldset",{key:"2216950da07e1ef324cc439b134f529638529029",class:"mt-lg-0 mr-1 "},e("igl-date-range",{key:"d2329c21758e8f28839ad8e822fba6b8eafc2693","data-testid":"date_picker",variant:"booking",dateLabel:y.entries.Lcz_Dates,maxDate:this.getMaxDate(),minDate:this.getMinDate(),disabled:this.isEventType("BAR_BOOKING")&&!this.wasBlockedUnit||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),e("p",{key:"8427bca07bdf81b9e060684bd54f59659a1eb91f",class:"text-right mt-1 message-label"},x.tax_statement))}};Gt.style=Vt;class Kt{constructor(){this.bookingService=new l}async reallocateEvent(t,e,i,s){try{console.log(t,e,i,s);const{data:a}=await gt.post(`/ReAllocate_Exposed_Room`,{pool:t,destination_pr_id:e,from_date:i,to_date:s,extras:C});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}console.log(a);return a}catch(t){console.error(t);throw new Error(t)}}async deleteEvent(t){try{const{data:e}=await gt.post(`/UnBlock_Exposed_Unit`,{POOL:t});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}catch(t){console.log(t);throw new Error(t)}}async updateBlockedEvent(t){try{const e=M(+t.RELEASE_AFTER_HOURS);await this.deleteEvent(t.POOL);const i=await this.bookingService.blockUnit(Object.assign({from_date:this.formatDate(t.FROM_DATE),to_date:this.formatDate(t.TO_DATE),pr_id:t.PR_ID,STAY_STATUS_CODE:t.OUT_OF_SERVICE?"004":t.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:t.RELEASE_AFTER_HOURS||"",NOTES:t.OPTIONAL_REASON||""},e));return i}catch(t){console.error(t);throw new Error(t)}}formatDate(t){return t.split("/").join("-")}}const Wt=".sc-igl-booking-event-h{display:block;position:absolute;--ota-bar-width:2px}.bookingEventBase.sc-igl-booking-event{position:absolute;background-color:rgb(49, 190, 241);width:100%;height:100%;border-radius:4px;transform:skewX(-22deg)}.bookingEventBase.skewedLeft.sc-igl-booking-event::before{content:'';position:absolute;top:0px;bottom:0;left:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:right;transform:skewX(22deg);border-radius:4px;border-top-left-radius:0;border-bottom-left-radius:0}.bookingEventBase.skewedRight.sc-igl-booking-event::before{content:'';position:absolute;top:0;bottom:0;right:-4px;width:50%;height:100%;background-color:var(--ir-event-bg);transform-origin:left;transform:skewX(22deg);border-radius:4px;border-top-right-radius:0;border-bottom-right-radius:0}.bookingEventBase.border.skewedLeft.sc-igl-booking-event::before{border:var(--ota-bar-width) solid #424242;border-right:0;border-left:0;border-top-right-radius:0;border-bottom-right-radius:0;top:calc(var(--ota-bar-width) * -1);height:20px;left:-4px}.ota-booking-event.sc-igl-booking-event{border-width:var(--ota-bar-width) !important}.bookingEventBase.border.skewedRight.sc-igl-booking-event::before{border:var(--ota-bar-width) solid #424242;border-left:0;border-right:0;border-top-left-radius:0;border-bottom-left-radius:0;top:calc(var(--ota-bar-width) * -1);height:20px;right:-4px}.bookingEvent.sc-igl-booking-event{cursor:pointer}.bookingEventBase.sc-igl-booking-event{cursor:pointer}.bookingEventHiddenBase.sc-igl-booking-event{position:absolute;top:0;left:-4px;width:calc(100% + 8)}.bookingEventDragHandle.sc-igl-booking-event{position:absolute;top:0;width:15px;height:100%;opacity:0.1;background-color:rgba(0, 0, 0, 0.15);transform:skewX(-22deg);border-radius:4px;cursor:pointer}.splitBooking.sc-igl-booking-event{border-right:2px solid #000000}.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:block;opacity:1}.newEvent.sc-igl-booking-event-h:hover .bookingEventDragHandle.sc-igl-booking-event{display:none;opacity:1}.leftSide.sc-igl-booking-event{left:0}.leftSide.skewedLeft.sc-igl-booking-event{transform:skewX(0)}.rightSide.skewedRight.sc-igl-booking-event{transform:skewX(0)}.rightSide.sc-igl-booking-event{right:0}.bookingEventTitle.sc-igl-booking-event{color:#fff;font-size:0.8em;position:relative;max-width:calc(100% - 10px);overflow:hidden;text-overflow:ellipsis;top:2px;left:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none;cursor:pointer}.legend_circle.sc-igl-booking-event{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px;border:1px solid #fff}.noteIcon.sc-igl-booking-event{position:absolute;bottom:-8px;left:2px}.balanceIcon.sc-igl-booking-event{position:absolute;top:-8px;right:2px}";const qt=Wt;var Xt=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const Jt=class{constructor(e){t(this,e);this.hideBubbleInfo=s(this,"hideBubbleInfo",7);this.updateEventData=s(this,"updateEventData",7);this.dragOverEventData=s(this,"dragOverEventData",7);this.showRoomNightsDialog=s(this,"showRoomNightsDialog",7);this.showDialog=s(this,"showDialog",7);this.resetStretchedBooking=s(this,"resetStretchedBooking",7);this.toast=s(this,"toast",7);this.updateBookingEvent=s(this,"updateBookingEvent",7);this.is_vacation_rental=false;this.allBookingEvents=[];this.renderElement=false;this.isShrinking=null;this.dayWidth=0;this.eventSpace=8;this.vertSpace=10;this.showInfoPopup=false;this.bubbleInfoTopSide=false;this.isStretch=false;this.eventsService=new Kt;this.bookingService=new l;this.resizeSide="";this.isDragging=false;this.animationFrameId=null;this.handleMouseMoveBind=this.handleMouseMove.bind(this);this.handleMouseUpBind=this.handleMouseUp.bind(this);this.handleClickOutsideBind=this.handleClickOutside.bind(this);this.findRoomType=t=>{let e=this.bookingEvent.roomsInfo.filter((e=>e.physicalrooms.some((e=>e.id===+t))));if(e.length){return e[0].id}return null}}componentWillLoad(){window.addEventListener("click",this.handleClickOutsideBind)}async fetchAndAssignBookingData(){try{console.log("clicked on book#",this.bookingEvent.BOOKING_NUMBER);const t=["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"];if(!t.includes(this.bookingEvent.STATUS)){return}const e=await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER,"en");const i=e.rooms.filter((t=>t["assigned_units_pool"]===this.bookingEvent.ID));if(i.length===0){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty array`)}if(i.some((t=>t["assigned_units_pool"]===null))){throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty pool`)}e.rooms=i;const s=Y(e)[0];const{ID:a,TO_DATE:n,FROM_DATE:o,NO_OF_DAYS:r,STATUS:l,NAME:c,IDENTIFIER:d,origin:h,TOTAL_PRICE:u,PR_ID:f,POOL:p,BOOKING_NUMBER:b,NOTES:g,is_direct:m,BALANCE:v,channel_booking_nbr:y}=s,k=Xt(s,["ID","TO_DATE","FROM_DATE","NO_OF_DAYS","STATUS","NAME","IDENTIFIER","origin","TOTAL_PRICE","PR_ID","POOL","BOOKING_NUMBER","NOTES","is_direct","BALANCE","channel_booking_nbr"]);this.bookingEvent=Object.assign(Object.assign(Object.assign({},k),this.bookingEvent),{channel_booking_nbr:y,booking:e,DEPARTURE_TIME:k.DEPARTURE_TIME,PHONE:k.PHONE,PHONE_PREFIX:k.PHONE_PREFIX,PRIVATE_NOTE:k.PRIVATE_NOTE,origin:h,TOTAL_PRICE:u});this.updateBookingEvent.emit(this.bookingEvent);this.showEventInfo(true)}catch(t){console.error(t.message)}}componentDidLoad(){if(this.isNewEvent()){if(!this.bookingEvent.hideBubble){setTimeout((async()=>{if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}else{this.showEventInfo(true)}this.renderAgain()}),1)}}}disconnectedCallback(){window.removeEventListener("click",this.handleClickOutsideBind);if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}}handleClickOutside(t){const e=t.target;if(!this.element.contains(e)){this.showEventInfo(false)}}hideBubbleInfoPopup(t){if(t.detail.currentInfoBubbleId!=this.getBookingId()||t.detail.key==="hidebubble"&&t.detail.currentInfoBubbleId===this.getBookingId()){this.showInfoPopup=false;this.renderAgain()}}async moveBookingToHandler(t){var e,i,s;try{if(t.detail.bookingId!==this.getBookingId()){this.showEventInfo(false);return}if(t.detail.moveToDay==="revert"||t.detail.toRoomId==="revert"){t.detail.moveToDay=this.bookingEvent.FROM_DATE;t.detail.toRoomId=t.detail.fromRoomId;if(this.isTouchStart&&this.moveDifferenceX<=5&&this.moveDifferenceY<=5&&!this.isStretch){if(A(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));return}}else{if(this.isTouchStart&&this.moveDifferenceX<=5&&this.moveDifferenceY<=5&&!this.isStretch){if(A(this.bookingEvent.STATUS_CODE)){this.showEventInfo(true)}else if(["IN-HOUSE","CONFIRMED","PENDING-CONFIRMATION","CHECKED-OUT"].includes(this.bookingEvent.STATUS)){await this.fetchAndAssignBookingData()}}else{const{pool:a,to_date:n,from_date:o,toRoomId:r}=t.detail;const l=D(n,"YYYY-MM-DD").add(-1,"days").format("YYYY-MM-DD");console.log(this.findRoomType(Number(this.bookingEvent.PR_ID)),this.findRoomType(Number(r)));if((!D(this.bookingEvent.TO_DATE,"YYYY-MM-DD").isSame(D(n,"YYYY-MM-DD"),"dates")||this.findRoomType(Number(this.bookingEvent.PR_ID))!==this.findRoomType(Number(r)))&&(((e=T.disabled_cells.get(`${r}_${o}`))===null||e===void 0?void 0:e.disabled)||((i=T.disabled_cells.get(`${r}_${n}`))===null||i===void 0?void 0:i.disabled)&&((s=T.disabled_cells.get(`${r}_${l}`))===null||s===void 0?void 0:s.disabled))&&!this.isStretch){this.reset("This room isnt available for the entire selected period. Please choose different dates or a different room.")}if(this.checkIfSlotOccupied(r,o,n)){this.reset("Overlapping Dates")}if(a){if(A(this.bookingEvent.STATUS_CODE)){await this.eventsService.reallocateEvent(a,r,o,n).catch((()=>{this.resetBookingToInitialPosition()}))}else{if(this.isShrinking||!this.isStretch){const{description:e,status:i}=this.getModalDescription(r,o,n);let s=false;if(i==="400"){s=true}const a=this.bookingEvent.defaultDates.from_date;const l=this.bookingEvent.defaultDates.to_date;const c=S(a,l);let d=null;let h=a;let u=l;if(this.isShrinking){if(D(o,"YYYY-MM-DD").isAfter(D(a,"YYYY-MM-DD"))&&D(n,"YYYY-MM-DD").isBefore(D(l,"YYYY-MM-DD"))){h=a;u=n}else{d=D(o,"YYYY-MM-DD").isAfter(D(a,"YYYY-MM-DD"))?"left":D(n,"YYYY-MM-DD").isBefore(D(l,"YYYY-MM-DD"))?"right":null;if(d==="left"){h=o}if(d==="right"){u=n}}}else{console.log("stretching");if(D(o,"YYYY-MM-DD").isBefore(D(a,"YYYY-MM-DD"))){h=o;const t=D(o,"YYYY-MM-DD").add(c,"days");u=t.isBefore(D(n,"YYYY-MM-DD"),"days")?n:t.format("YYYY-MM-DD")}else if(D(n,"YYYY-MM-DD").isAfter(D(l,"YYYY-MM-DD"))){u=n;h=D(n,"YYYY-MM-DD").subtract(c,"days").format("YYYY-MM-DD")}}console.warn({fromDate:h,toDate:u});this.showDialog.emit(Object.assign(Object.assign({reason:"reallocate"},t.detail),{description:e,title:"",hideConfirmButton:s,from_date:h,to_date:u}))}else{const t=this.bookingEvent.defaultDates.from_date;const e=this.bookingEvent.defaultDates.to_date;const i=(t,e)=>{var i;let s=t;let a=0;while(s!==e){if((i=T.disabled_cells.get(`${r}_${s}`))===null||i===void 0?void 0:i.disabled){a++}s=D(s,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD")}if(a>=1){this.reset(y.entries.Lcz_ThisUnitIsNotAvailable)}};if(D(e,"YYYY-MM-DD").isBefore(D(n),"dates")){i(e,n)}else if(D(t,"YYYY-MM-DD").isAfter(D(o,"YYYY-MM-DD"),"dates")){i(o,t)}const s={booking:this.bookingEvent,bookingNumber:this.bookingEvent.BOOKING_NUMBER,identifier:this.bookingEvent.IDENTIFIER,to_date:n,pool:a,from_date:o,defaultDates:this.bookingEvent.defaultDates};if(!this.bookingEvent.is_direct){this.showDialog.emit(Object.assign({reason:"stretch"},s))}else{this.showRoomNightsDialog.emit(s)}}}this.isShrinking=null}}}}catch(t){this.toast.emit({position:"top-right",title:t.message,description:"",type:"error"});console.log("something went wrong")}}reset(t){this.animationFrameId=requestAnimationFrame((()=>{this.resetBookingToInitialPosition()}));throw new Error(t)}getModalDescription(t,e,i){if(!this.bookingEvent.is_direct){if(this.isShrinking){return{description:y.entries.Lcz_OTA_Modification_Alter,status:"200"}}else{if(D(e,"YYYY-MM-DD").isSame(D(this.bookingEvent.FROM_DATE,"YYYY-MM-DD"))&&D(i,"YYYY-MM-DD").isSame(D(this.bookingEvent.TO_DATE,"YYYY-MM-DD"))){const e=this.findRoomType(this.bookingEvent.PR_ID);const i=this.findRoomType(t);if(e===i){return{description:`${y.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:y.entries.Lcz_OTA_Modification_Alter,status:"200"}}}return{description:y.entries.Lcz_CannotChangeCHBookings+".",status:"400"}}}else{if(!this.isShrinking){const e=this.findRoomType(Number(this.bookingEvent.PR_ID));const i=this.findRoomType(Number(t));if(e===i){console.log("same rt");if(this.bookingEvent.PR_ID.toString()===t.toString()){return{description:y.entries.Lcz_ConfrmModiication+".",status:"200"}}return{description:`${y.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`,status:"200"}}else{return{description:y.entries.Lcz_SameRatesWillBeKept+".",status:"200"}}}return{description:y.entries.Lcz_ConfrmModiication+".",status:"200"}}}resetBookingToInitialPosition(){if(this.isStretch){this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${this.initialWidth}px`;this.isStretch=false;this.finalWidth=this.initialWidth;this.isShrinking=null}else{this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`}}handleRevertBooking(t){if(this.bookingEvent.POOL===t.detail){this.resetBookingToInitialPosition()}}checkIfSlotOccupied(t,e,i){const s=D(e,"YYYY-MM-DD");const a=D(i,"YYYY-MM-DD");const n=this.allBookingEvents.some((e=>{if(e.POOL===this.bookingEvent.POOL){return false}const i=D(e.FROM_DATE,"YYYY-MM-DD").add(1,"days");const n=D(e.TO_DATE,"YYYY-MM-DD");return e.PR_ID===+t&&a.isSameOrAfter(i)&&s.isBefore(n)}));return n}renderAgain(){this.renderElement=!this.renderElement}getUniqueId(){return(new Date).getTime()}isSplitBooking(){return!!this.bookingEvent.SPLIT_BOOKING}isNewEvent(){return this.getBookingId()==="NEW_TEMP_EVENT"}isHighlightEventType(){return this.getEventType()==="HIGH_LIGHT"}getBookingId(){return this.bookingEvent.ID}getBookingStatus(){return this.bookingEvent.STATUS}getBookedBy(){return this.bookingEvent.NAME}getBookedRoomId(){return this.bookingEvent.PR_ID}getEventStartingDate(){return new Date(this.bookingEvent.FROM_DATE)}getEventEndingDate(){return new Date(this.bookingEvent.TO_DATE)}getEventType(){return this.bookingEvent.event_type}getEventLegend(){var t,e;let i=(t=this.bookingEvent)===null||t===void 0?void 0:t.legendData.statusId[this.getBookingStatus()];let s=this.isNewEvent()?{color:"#f9f9c9"}:{};return Object.assign(Object.assign(Object.assign({},(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData[i.id]),i),s)}getLegendOfStatus(t){var e;let i=(e=this.bookingEvent)===null||e===void 0?void 0:e.legendData.statusId[t];return Object.assign(Object.assign({},this.bookingEvent.legendData[i.id]),i)}getNoteNode(){if(this.bookingEvent.NOTES||this.bookingEvent.INTERNAL_NOTE||this.bookingEvent.PRIVATE_NOTE){return this.getLegendOfStatus("NOTES")}return null}getBalanceNode(){if(this.bookingEvent.BALANCE!==null&&this.bookingEvent.BALANCE>=1){return this.getLegendOfStatus("OUTSTANDING-BALANCE")}return null}setStayDays(t){this.bookingEvent.NO_OF_DAYS=t;this.renderAgain()}getStayDays(){return this.bookingEvent.NO_OF_DAYS}getPosition(){let t=this.getEventStartingDate();let e=".room_"+this.getBookedRoomId()+"_"+t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear();let i=document.querySelector(".bodyContainer");let s=document.querySelector(e);let a={top:"0",left:"0",width:"0",height:"20px"};if(s&&i&&s.getBoundingClientRect()&&i.getBoundingClientRect()){let t=i.getBoundingClientRect();let e=s.getBoundingClientRect();this.dayWidth=this.dayWidth||e.width;a.top=e.top+e.height/2-this.vertSpace-t.top+"px";a.left=e.left+(!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?0:this.dayWidth/2)+this.eventSpace/2-t.left+"px";a.width=(this.getStayDays()+(!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?.5:0))*this.dayWidth-this.eventSpace+"px"}else{console.log(this.bookingEvent);console.log("Locating event cell failed ",e)}return a}getNumber(t){return t?parseFloat(t):0}startDragging(t,e){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();if(this.isNewEvent()||this.isHighlightEventType()){return null}this.resizeSide=e;this.isDragging=true;this.showEventInfo(false);this.isStretch=e!=="move";if(e==="move"){this.initialX=t.clientX||t.touches[0].clientX;this.initialY=t.clientY||t.touches[0].clientY;this.elementRect=this.element.getBoundingClientRect();const e=0;const i=0;this.dragInitPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top)+i,left:this.getNumber(this.element.style.left)+e};this.dragInitPos.x=this.dragInitPos.left;this.dragInitPos.y=this.dragInitPos.top;this.dragEndPos=Object.assign({},this.dragInitPos);this.element.style.top=`${this.dragInitPos.top}px`;this.element.style.left=`${this.dragInitPos.left}px`;this.isTouchStart=true;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:this.dragInitPos})}else{this.initialWidth=this.element.offsetWidth;this.initialLeft=this.element.offsetLeft;this.initialX=t.clientX||t.touches[0].clientX;this.dragOverEventData.emit({id:"CALCULATE_DRAG_OVER_BOUNDS",data:{id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.getNumber(this.element.style.top),left:this.initialLeft,x:this.initialX,y:t.clientY||t.touches[0].clientY}})}document.addEventListener("mousemove",this.handleMouseMoveBind);document.addEventListener("touchmove",this.handleMouseMoveBind);document.addEventListener("pointermove",this.handleMouseMoveBind);document.addEventListener("mouseup",this.handleMouseUpBind);document.addEventListener("touchup",this.handleMouseUpBind);document.addEventListener("pointerup",this.handleMouseUpBind)}handleMouseMove(t){if(this.isDragging){this.currentX=t.clientX||t.touches[0].clientX;let e=this.currentX-this.initialX;if(this.resizeSide==="move"){this.currentY=t.clientY||t.touches[0].clientY;let i=this.currentY-this.initialY;this.element.style.top=`${this.dragInitPos.top+i}px`;this.element.style.left=`${this.dragInitPos.left+e}px`;this.dragEndPos={id:this.getBookingId(),fromRoomId:this.getBookedRoomId(),top:this.dragInitPos.top+i,left:this.dragInitPos.left+e};this.dragEndPos.x=this.dragEndPos.left;this.dragEndPos.y=this.dragEndPos.top;this.dragOverEventData.emit({id:"DRAG_OVER",data:this.dragEndPos})}else{const t=!this.bookingEvent.is_direct&&!A(this.bookingEvent.STATUS_CODE);let i=this.initialWidth;if(this.resizeSide=="rightSide"){i=this.initialWidth+e;i=Math.min(i,this.initialX+this.element.offsetWidth);i=Math.max(this.dayWidth-this.eventSpace,i);this.isShrinking=e<0;if(!this.isShrinking&&t){return}this.element.style.width=`${i}px`}else if(this.resizeSide=="leftSide"){this.isShrinking=e>0;if(!this.isShrinking&&t){return}i=Math.max(this.dayWidth-this.eventSpace,this.initialWidth-e);let s=this.initialLeft+(this.initialWidth-i);this.element.style.left=`${s}px`;this.element.style.width=`${i}px`}this.finalWidth=i}}else{console.log("still mouse move listening...")}}handleMouseUp(){if(this.isDragging){if(this.resizeSide==="move"){if(this.isTouchStart){this.moveDifferenceX=Math.abs(this.dragEndPos.x-this.dragInitPos.x);this.moveDifferenceY=Math.abs(this.dragEndPos.y-this.dragInitPos.y)}this.dragOverEventData.emit({id:"DRAG_OVER_END",data:Object.assign(Object.assign({},this.dragEndPos),{pool:this.bookingEvent.POOL,nbOfDays:this.bookingEvent.NO_OF_DAYS})})}else{const t=this.finalWidth-(!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?this.dayWidth/2:0);const e=Math.round(t/this.dayWidth);console.log(t,this.dayWidth,e);let i=this.getStayDays();if(i!=e&&!isNaN(e)){if(this.resizeSide=="leftSide"){this.element.style.left=`${this.initialLeft+(i-e)*this.dayWidth}px`}else{if(e<i){this.isShrinking=true}}this.dragOverEventData.emit({id:"STRETCH_OVER_END",data:{id:this.getBookingId(),fromRoomId:+this.getBookedRoomId(),x:+this.element.style.left.replace("px",""),y:+this.element.style.top.replace("px",""),pool:this.bookingEvent.POOL,nbOfDays:e}});const t=!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?+this.dayWidth/2:0;this.element.style.width=`${e*this.dayWidth-this.eventSpace+t}px`}else{this.element.style.left=`${this.initialLeft}px`;this.element.style.width=`${e*this.dayWidth-this.eventSpace}px`}}}else{console.log("still mouse up listening...")}this.isDragging=false;document.removeEventListener("mousemove",this.handleMouseMoveBind);document.removeEventListener("touchmove",this.handleMouseMoveBind);document.removeEventListener("pointermove",this.handleMouseMoveBind);document.removeEventListener("mouseup",this.handleMouseUpBind);document.removeEventListener("touchup",this.handleMouseUpBind);document.removeEventListener("pointerup",this.handleMouseUpBind)}updateData(t){this.updateEventData.emit(t)}calculateHoverPosition(){const t=this.element.getBoundingClientRect();const e=t.width;const i=t.left;const s=window.innerWidth;let a;if(e<=s){a=e/2}else{a=s/2-i}return{position:"absolute",left:`${a}px`,transform:"translateX(-50%)"}}renderEventBookingNumber(){if(this.bookingEvent.STATUS==="TEMP-EVENT"||this.bookingEvent.ID==="NEW_TEMP_EVENT"){return""}if(A(this.bookingEvent.STATUS_CODE)){return""}if(!this.bookingEvent.is_direct){return` - ${this.bookingEvent.channel_booking_nbr}`}return` - ${this.bookingEvent.BOOKING_NUMBER}`}showEventInfo(t){if(this.isHighlightEventType()||this.bookingEvent.hideBubble){return null}if(t){let t=document.querySelector(".calendarScrollContainer");let e=t.getBoundingClientRect();let i=this.element.getBoundingClientRect();let s=e.height/2+e.top+50;if(i.top<s){this.bubbleInfoTopSide=false}else{this.bubbleInfoTopSide=true}}if(t){this.hideBubbleInfo.emit({key:"hidePopup",currentInfoBubbleId:this.getBookingId()})}this.showInfoPopup=t;this.renderAgain()}render(){let t=this.getEventLegend();let s=this.getNoteNode();let n=this.getBalanceNode();return e(i,{key:"1917b9f430088f87b02780deb9a06e3673272544",class:`bookingEvent  ${this.isNewEvent()||this.isHighlightEventType()?"newEvent":""} ${t.clsName} `,style:this.getPosition(),id:"event_"+this.getBookingId()},e("div",{key:"b7f352d7c356d294f0d8ed4b4d92e0497a4bb1de",class:`bookingEventBase  ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n          ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}\n          ${!this.bookingEvent.is_direct&&!A(this.bookingEvent.STATUS_CODE)&&this.bookingEvent.STATUS!=="TEMP-EVENT"&&this.bookingEvent.ID!=="NEW_TEMP_EVENT"&&"border border-dark ota-booking-event"}  ${this.isSplitBooking()?"splitBooking":""}`,style:{backgroundColor:t.color,"--ir-event-bg":t.color},onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")}),s?e("div",{class:"legend_circle noteIcon",style:{backgroundColor:s.color}}):null,n?e("div",{class:"legend_circle balanceIcon",style:{backgroundColor:n.color}}):null,e("div",{key:"dc090887c4e4b7a21230b78692bdbe990087ce64",class:"bookingEventTitle",onTouchStart:t=>this.startDragging(t,"move"),onMouseDown:t=>this.startDragging(t,"move")},this.getBookedBy(),this.renderEventBookingNumber()),e(a,{key:"a85f7fb23cf32599e45620d8b1683b51ca4862a3"},e("div",{key:"84633b6b5a85a222afa44897253d4cfa96878b33",class:`bookingEventDragHandle leftSide ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n            ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"leftSide"),onMouseDown:t=>this.startDragging(t,"leftSide")}),e("div",{key:"83bc8d39152296880b26dc5e9533da0b24a43e48",class:`bookingEventDragHandle rightSide ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE))?"skewedLeft":""}\n              ${!this.isNewEvent()&&D(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE))?"skewedRight":""}`,onTouchStart:t=>this.startDragging(t,"rightSide"),onMouseDown:t=>this.startDragging(t,"rightSide")})),this.showInfoPopup?e("igl-booking-event-hover",{is_vacation_rental:this.is_vacation_rental,countries:this.countries,currency:this.currency,class:"top",bookingEvent:this.bookingEvent,bubbleInfoTop:this.bubbleInfoTopSide,style:this.calculateHoverPosition()}):null)}get element(){return n(this)}};Jt.style=qt;const Qt=".sc-igl-booking-event-hover-h{display:block;position:relative;z-index:100}.btn.sc-igl-booking-event-hover{padding-left:4px !important;padding-right:4px !important}.balance_amount.sc-igl-booking-event-hover{color:#ff4961;font-size:0.75rem}.user-notes.sc-igl-booking-event-hover{margin-left:4px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:5;line-clamp:5;overflow:hidden;max-width:100%;height:auto}.events_btns.sc-igl-booking-event-hover{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem}.mx-01.sc-igl-booking-event-hover{--m:5px;margin-left:var(--m) !important;margin-right:var(--m) !important}.pointerContainerTop.sc-igl-booking-event-hover{top:-26px}.pointerContainer.sc-igl-booking-event-hover{position:absolute;height:10px;width:350px;left:var(--el-left, 50%);transform:translateX(-50%)}.ota-notes.sc-igl-booking-event-hover{width:450px}.iglPopOver.sc-igl-booking-event-hover{position:absolute;background-color:#fff;padding:10px;border:1px solid #656ee7;border-radius:6px;left:var(--el-left, 50%);transform:translateX(-50%) translateY(10px);box-shadow:1px 0px 20px rgba(0, 0, 0, 0.2)}.iglPopOver.infoBubble.sc-igl-booking-event-hover{min-width:350px}.iglPopOver.blockedView.sc-igl-booking-event-hover{max-width:400px;width:400px}.iglPopOver.newBookingOptions.sc-igl-booking-event-hover{overflow-wrap:break-word !important;min-width:230px;width:fit-content}.bubblePointer.sc-igl-booking-event-hover{position:absolute;width:0;height:0;left:50%;border-left:10px solid transparent;border-right:10px solid transparent;transform:translate(-50%, 0px)}.bubblePointTop.sc-igl-booking-event-hover{border-top:10px solid #656ee7}.bubblePointBottom.sc-igl-booking-event-hover{border-bottom:10px solid #656ee7}.bubbleInfoAbove.sc-igl-booking-event-hover{bottom:35px}.updateBtnIcon.sc-igl-booking-event-hover{margin-right:4px}.icon-image.sc-igl-booking-event-hover{height:1.5rem;width:1.5rem;margin-right:5px}";const Zt=Qt;const te=class{constructor(e){t(this,e);this.showBookingPopup=s(this,"showBookingPopup",7);this.hideBubbleInfo=s(this,"hideBubbleInfo",7);this.deleteButton=s(this,"deleteButton",7);this.bookingCreated=s(this,"bookingCreated",7);this.showDialog=s(this,"showDialog",7);this.bubbleInfoTop=false;this.is_vacation_rental=false;this.shouldHideUnassignUnit=false;this.eventService=new Kt;this.hideButtons=false}componentWillLoad(){let t=this.bookingEvent.roomsInfo.find((t=>t.id===this.bookingEvent.RATE_TYPE));if(t){this.shouldHideUnassignUnit=t.physicalrooms.length===1}if(D(this.bookingEvent.TO_DATE,"YYYY-MM-DD").isBefore(D())){this.hideButtons=true}this.canCheckInOrCheckout=D().isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&D().isBefore(new Date(this.bookingEvent.TO_DATE),"days")}handleBookingEventChange(t,e){if(t!==e)this.canCheckInOrCheckout=D(new Date).isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&D(new Date).isBefore(new Date(this.bookingEvent.TO_DATE),"days")}getBookingId(){return this.bookingEvent.ID}hideBubble(){this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}handleListenKeyDown(t){if(t.key==="Escape"){t.stopPropagation();this.hideBubble()}else return}getTotalOccupants(){var t,e,i;const{CHILDREN_COUNT:s,ADULTS_COUNT:a}=this.bookingEvent;if(s===0){return`${a} ${a>1?y.entries.Lcz_AdultsCaption.toLowerCase():(t=y.entries.Lcz_Single_Adult)===null||t===void 0?void 0:t.toLowerCase()}`}return`${a} ${a>1?y.entries.Lcz_AdultsCaption.toLowerCase():(e=y.entries.Lcz_Single_Adult)===null||e===void 0?void 0:e.toLowerCase()}, ${s} ${s>1?y.entries.Lcz_ChildCaption.toLowerCase():(i=y.entries.Lcz_Single_Child)===null||i===void 0?void 0:i.toLowerCase()}`}getPhoneNumber(){return this.bookingEvent.PHONE}getCountry(){return B(this.bookingEvent.COUNTRY,this.countries).name}getPhoneCode(){if(this.bookingEvent.PHONE_PREFIX){return this.bookingEvent.PHONE_PREFIX}return B(this.bookingEvent.COUNTRY,this.countries).phone_prefix}renderPhone(){return this.bookingEvent.COUNTRY?`${this.bookingEvent.is_direct?this.getPhoneCode()+"-":""}${this.getPhoneNumber()} - ${this.getCountry()}`:this.getPhoneNumber()}getInternalNote(){return this.bookingEvent.INTERNAL_NOTE}getTotalPrice(){return this.bookingEvent.TOTAL_PRICE}getArrivalTime(){return this.bookingEvent.ARRIVAL_TIME}getRatePlan(){var t,e,i;if(!this.bookingEvent){return}const s=(i=(e=(t=this.bookingEvent)===null||t===void 0?void 0:t.booking)===null||e===void 0?void 0:e.rooms)===null||i===void 0?void 0:i.find((t=>t.assigned_units_pool===this.bookingEvent.ID));if(!s){console.warn(`Couldn't find room with pool ${this.bookingEvent.ID}`);return null}let a="";a+=s.rateplan["short_name"];if(s.rateplan["is_non_refundable"]){a+=` - ${y.entries.Lcz_NonRefundable}`}return a}getEntryDate(){return this.bookingEvent.ENTRY_DATE}isNewBooking(){return this.getBookingId()==="NEW_TEMP_EVENT"}isCheckedIn(){return this.bookingEvent.STATUS==="IN-HOUSE"}isBlockedDateEvent(){return this.bookingEvent.STATUS==="BLOCKED"||this.bookingEvent.STATUS==="BLOCKED-WITH-DATES"}hasSplitBooking(){return this.bookingEvent.hasOwnProperty("splitBookingEvents")&&this.bookingEvent.splitBookingEvents}canCheckIn(){return I({from_date:this.bookingEvent.FROM_DATE,to_date:this.bookingEvent.TO_DATE,isCheckedIn:this.isCheckedIn()})}canCheckOut(){var t,e,i,s;if(!x.checkin_enabled||x.is_automatic_check_in_out){return false}if(this.isCheckedIn()){return true}const a=D();if(((e=(t=this.bookingEvent.ROOM_INFO)===null||t===void 0?void 0:t.in_out)===null||e===void 0?void 0:e.code)==="000"&&D().isSameOrAfter(new Date(this.bookingEvent.TO_DATE),"days")&&j(a.toDate(),z((i=x.checkin_checkout_hours)===null||i===void 0?void 0:i.offset,(s=x.checkin_checkout_hours)===null||s===void 0?void 0:s.hour))){return true}return false}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookingEvent=Object.assign(Object.assign({},this.bookingEvent),e.data)}handleEditBooking(){this.bookingEvent.TITLE=y.entries.Lcz_EditBookingFor;this.handleBookingOption("EDIT_BOOKING")}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}handleAddRoom(){var t;let e=new Date(this.bookingEvent.FROM_DATE);e.setHours(0,0,0,0);let i=this.getStringDateFormat(e);let s=new Date(this.bookingEvent.TO_DATE);s.setHours(0,0,0,0);let a=this.getStringDateFormat(s);let n={ID:"",NAME:"",BOOKING_NUMBER:this.bookingEvent.BOOKING_NUMBER,FROM_DATE:i,TO_DATE:a,roomsInfo:this.bookingEvent.roomsInfo,ARRIVAL:this.bookingEvent.ARRIVAL,ADD_ROOM_TO_BOOKING:this.bookingEvent.ID,TITLE:"Add Room to #"+this.bookingEvent.BOOKING_NUMBER,event_type:"ADD_ROOM",ROOMS:this.bookingEvent.ROOMS,GUEST:this.bookingEvent.GUEST,message:this.bookingEvent.NOTES,SOURCE:this.bookingEvent.SOURCE,booking:(t=this.bookingEvent)===null||t===void 0?void 0:t.booking,defaultDateRange:{fromDate:e,fromDateStr:"",toDate:s,toDateStr:"",dateDifference:0,editabled:true,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};this.handleBookingOption("ADD_ROOM",n)}handleCustomerCheckIn(){var t,e;const{adult_nbr:i,children_nbr:s,infant_nbr:a}=this.bookingEvent.ROOM_INFO.occupancy;this.showDialog.emit({reason:"checkin",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:"",sidebarPayload:{identifier:this.bookingEvent.IDENTIFIER,bookingNumber:this.bookingEvent.BOOKING_NUMBER,checkin:false,roomName:(e=(t=this.bookingEvent.ROOM_INFO.unit)===null||t===void 0?void 0:t.name)!==null&&e!==void 0?e:"",sharing_persons:this.bookingEvent.ROOM_INFO.sharing_persons,totalGuests:i+s+a}})}handleCustomerCheckOut(){this.showDialog.emit({reason:"checkout",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:""})}handleDeleteEvent(){this.hideBubble();this.deleteButton.emit(this.bookingEvent.POOL);console.log("Delete Event")}async handleUpdateBlockedDates(){try{this.isLoading="update";setTimeout((()=>{this.hideBubble()}),50);await this.eventService.updateBlockedEvent(this.bookingEvent);this.isLoading=""}catch(t){}}handleConvertBlockedDateToBooking(){this.handleBookingOption("BAR_BOOKING")}getRoomInfo(){const t=+this.bookingEvent.PR_ID;let e={};for(const i of this.bookingEvent.roomsInfo){for(const s of i.physicalrooms){if(t===s.id){e.CATEGORY=i.name;e.ROOM_NAME=s.name;e.ROOMS_INFO=i;return e}}}return e}renderTitle(t,e){switch(t){case"EDIT_BOOKING":return`${y.entries.Lcz_EditBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`;case"ADD_ROOM":return`${y.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;case"SPLIT_BOOKING":return y.entries.Lcz_Adding+` ${e.CATEGORY} ${e.ROOM_NAME}`;default:return`${y.entries.Lcz_NewBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`}}handleBookingOption(t,e=null){const i=this.getRoomInfo();let s=e?e:this.bookingEvent;s.event_type=t;s.TITLE=this.renderTitle(t,i);if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){s.roomsInfo=[i.ROOMS_INFO]}if(t==="BAR_BOOKING"&&this.bookingEvent.STATUS!=="TEMP-EVENT"){const{FROM_DATE:t,TO_DATE:e,PR_ID:i,RELEASE_AFTER_HOURS:a,ENTRY_DATE:n,OPTIONAL_REASON:o,ENTRY_MINUTE:r,ENTRY_HOUR:l,STATUS_CODE:c}=this.bookingEvent;s.block_exposed_unit_props={from_date:t,to_date:e,NOTES:o,pr_id:i,STAY_STATUS_CODE:c,DESCRIPTION:a,BLOCKED_TILL_DATE:n,BLOCKED_TILL_HOUR:l,BLOCKED_TILL_MINUTE:r};this.handleDeleteEvent()}this.showBookingPopup.emit({key:"add",data:Object.assign({},s)});this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}getOTANotes(t=3){var e;if(!this.bookingEvent.ota_notes||((e=this.bookingEvent.ota_notes)===null||e===void 0?void 0:e.length)===0){return null}const i=[...this.bookingEvent.ota_notes];const s="<br>- ";if(i.length>t){i[t-1]={statement:`${i[t-1].statement} <span style="color: #1e9ff2;">more...</span>`}}return i.slice(0,t).map((t=>`${s}${t.statement}`)).join("")}getInfoElement(){var t,i,s,a,n,o;return e("div",{class:`iglPopOver infoBubble ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},e("div",{class:`row p-0 m-0  ${this.bookingEvent.BALANCE>1?"pb-0":"pb-1"}`},e("div",{class:"px-0  col-8 font-weight-bold font-medium-1 d-flex align-items-center"},e("img",{src:(i=(t=this.bookingEvent)===null||t===void 0?void 0:t.origin)===null||i===void 0?void 0:i.Icon,alt:(a=(s=this.bookingEvent)===null||s===void 0?void 0:s.origin)===null||a===void 0?void 0:a.Label,class:"icon-image"}),e("p",{class:"p-0 m-0"},!this.bookingEvent.is_direct?this.bookingEvent.channel_booking_nbr:this.bookingEvent.BOOKING_NUMBER)),e("div",{class:"pr-0 col-4 text-right"},_(this.currency.symbol,this.getTotalPrice()))),this.bookingEvent.BALANCE>1&&e("p",{class:"pr-0 m-0 p-0 text-right balance_amount"},y.entries.Lcz_Balance,": ",_(this.currency.symbol,this.bookingEvent.BALANCE)),e("div",{class:"row p-0 m-0"},e("div",{class:"px-0 pr-0 col-12"},e("ir-date-view",{from_date:this.bookingEvent.defaultDates.from_date,to_date:this.bookingEvent.defaultDates.to_date,showDateDifference:false}))),this.getArrivalTime()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${y.entries.Lcz_ArrivalTime}:`,content:this.getArrivalTime()}),this.getTotalOccupants()&&e("ir-label",{class:"m-0 p-0",containerStyle:{padding:"0",margin:"0"},labelText:`${y.entries.Lcz_Occupancy}:`,content:this.getTotalOccupants()}),this.getPhoneNumber()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${y.entries.Lcz_Phone}:`,content:this.renderPhone()}),this.getRatePlan()&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${y.entries.Lcz_RatePlan}:`,content:this.getRatePlan()}),((n=this.bookingEvent.DEPARTURE_TIME)===null||n===void 0?void 0:n.code)!=="000"&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`Departure time:`,content:(o=this.bookingEvent.DEPARTURE_TIME)===null||o===void 0?void 0:o.description}),this.bookingEvent.PRIVATE_NOTE&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${y.entries.Lcz_BookingPrivateNote}:`,display:"inline",content:this.bookingEvent.PRIVATE_NOTE}),this.bookingEvent.is_direct&&e("ir-label",{containerStyle:{padding:"0",margin:"0"},labelText:`${y.entries.Lcz_GuestRemark}:`,display:"inline",content:this.bookingEvent.NOTES}),e("ir-label",{containerStyle:{padding:"0",margin:"0"},labelText:`${y.entries.Lcz_ChannelNotes}:`,display:"inline",content:this.getOTANotes(),renderContentAsHtml:true}),this.getInternalNote()&&e("ir-label",{labelText:`${y.entries.Lcz_InternalRemark}:`,content:this.getInternalNote()}),e("div",{class:"row p-0 m-0 mt-2"},e("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},e("ir-button",{style:{"--icon-size":"0.875rem"},onClickHandler:()=>this.handleEditBooking(),class:"w-100",btn_block:true,text:y.entries.Lcz_Edit,icon_name:"edit",btn_styles:"h-100",size:"sm"}),this.bookingEvent.is_direct&&this.bookingEvent.IS_EDITABLE&&!this.hideButtons&&e("ir-button",{style:{"--icon-size":"0.875rem"},text:y.entries.Lcz_AddRoom,icon_name:"square_plus",size:"sm",class:"w-100",btn_styles:"h-100",onClickHandler:()=>this.handleAddRoom()}),this.canCheckIn()&&e("ir-button",{class:"w-100",style:{"--icon-size":"0.875rem"},text:y.entries.Lcz_CheckIn,onClickHandler:()=>this.handleCustomerCheckIn(),icon_name:"edit",btn_styles:"h-100",size:"sm"}),this.canCheckOut()&&e("ir-button",{class:"w-100",btn_styles:"h-100",style:{"--icon-size":"0.875rem"},text:y.entries.Lcz_CheckOut,icon_name:"edit",onClickHandler:()=>this.handleCustomerCheckOut(),size:"sm"}),this.hideButtons?null:!this.shouldHideUnassignUnit&&e("ir-button",{class:"w-100",btn_styles:"h-100",style:{"--icon-size":"0.875rem"},size:"sm",text:y.entries.Lcz_Unassign,icon_name:"xmark",onClickHandler:t=>{this.handleDeleteEvent()}}))))}getNewBookingOptions(){const t=this.bookingEvent.roomsInfo[0].rateplans.some((t=>t.is_active));return e("div",{class:`iglPopOver d-flex flex-column newBookingOptions ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`,style:{gap:"0.5rem"}},t?e(a,null,e("ir-button",{size:"sm",btn_block:true,"data-testid":"bar_booking_btn",text:y.entries.Lcz_CreateNewBooking,onClickHandler:t=>{this.handleBookingOption("BAR_BOOKING")}}),this.hasSplitBooking()&&e("ir-button",{size:"sm",btn_block:true,text:y.entries.Lcz_AssignUnitToExistingBooking,onClickHandler:t=>{this.handleBookingOption("SPLIT_BOOKING")}})):e("p",{class:"text-danger"},y.entries.Lcz_NoRatePlanDefined),e("ir-button",{size:"sm",text:y.entries.Lcz_Blockdates,btn_block:true,onClickHandler:t=>{this.handleBookingOption("BLOCK_DATES")}}))}getBlockedView(){console.log("booking event",this.bookingEvent);return e("div",{class:`iglPopOver blockedView ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},e("igl-block-dates-view",{isEventHover:true,entryHour:this.bookingEvent.ENTRY_HOUR,entryMinute:this.bookingEvent.ENTRY_MINUTE,defaultData:this.bookingEvent,fromDate:this.bookingEvent.defaultDates.from_date,toDate:this.bookingEvent.defaultDates.to_date,entryDate:this.getEntryDate(),onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),e("div",{class:"row p-0 m-0 mt-2"},e("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},e("ir-button",{btn_disabled:this.isLoading==="update",text:y.entries.Lcz_Update,onClickHandler:t=>{this.handleUpdateBlockedDates()},icon_name:"edit",size:"sm",btn_styles:"h-100",isLoading:this.isLoading==="update",style:{"--icon-size":"0.875rem"},btn_block:true,class:"w-100"}),e("ir-button",{class:"w-100 h-100 my-0",btn_block:true,btn_styles:"h-100",size:"sm",text:y.entries.Lcz_ConvertSplitBooking,onClickHandler:()=>{this.handleConvertBlockedDateToBooking()}}),e("ir-button",{class:"w-100",btn_styles:"h-100",btn_block:true,size:"sm",style:{"--icon-size":"0.875rem"},icon_name:"trash",btn_color:"danger",onClickHandler:t=>{this.handleDeleteEvent()},text:y.entries.Lcz_Delete}))))}render(){return e(i,{key:"71a3d2f8acaeca1e72096858f8993fce8fe594df"},e("div",{key:"ee2926fcf097b29de15739565af99cc7e355123d",class:`pointerContainer ${this.bubbleInfoTop?"pointerContainerTop":""}`},e("div",{key:"0cfe5ab88e99881959815276ba9afa23e5b5df6c",class:`bubblePointer ${this.bubbleInfoTop?"bubblePointTop":"bubblePointBottom"}`})),this.isBlockedDateEvent()?this.getBlockedView():null,this.isNewBooking()?this.getNewBookingOptions():null,!this.isBlockedDateEvent()&&!this.isNewBooking()?this.getInfoElement():null)}get element(){return n(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};te.style=Zt;const ee=".sc-igl-booking-form-h{display:flex;flex-direction:column}";const ie=ee;const se=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.buttonClicked=s(this,"buttonClicked",7);this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const e=Object.assign({},this.selectedUnits);const i=(t,e,i,s)=>{if(i&&s===2){return t*e}return t};this.selectedUnits=e;this.guestData=[];this.selectedRooms.forEach(((s,a)=>{s.forEach((s=>{e[a]=s.selectedUnits;t+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,e){const i=t.detail;const s=`c_${i.data.roomCategoryId}`;const a=[...this.selectedUnits[s]||[]];a[e]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:a});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,e,i){if(e==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,i)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const e=(t,e,i)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return this.isLoading===t||e(this.selectedGuestData,"guestName","")||e(this.selectedBookedByData,"isdCode","")||e(this.selectedBookedByData,"contactNumber","")||e(this.selectedBookedByData,"firstName","")||e(this.selectedBookedByData,"lastName","")||e(this.selectedBookedByData,"countryId",-1)||e(this.selectedBookedByData,"selectedArrivalTime","")||e(this.selectedBookedByData,"email","")}render(){return e("div",{key:"e326420f127c97d2032604c58aa6ff1c4777ff8f",class:"d-flex flex-column h-100"},e("div",{key:"feef108a586c2f94a67cbb26c41b9a563c325fed",class:"d-flex flex-wrap"},e("ir-date-view",{key:"74d2ea0068da7b04c35896a4d69438287ebe0fbb",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:new Date(this.dateRangeData.fromDate),to_date:new Date(this.dateRangeData.toDate),dateOption:"DD MMM YYYY"}),this.guestData.length>1&&e("div",{key:"1d57c3f8e4e3dc3e8341af35dca172622989022d",class:"mt-1 mt-md-0 text-right"},y.entries.Lcz_TotalPrice," ",e("span",{key:"df4cbcc51fefec735c0f9bee50b69793aeb88952",class:"font-weight-bold font-medium-1"},_(this.currency.symbol,this.bookingData.TOTAL_PRICE||"0")))),Object.values(o.ratePlanSelections).map((t=>Object.values(t).map((t=>{const i=t;if(i.reserved===0){return null}return[...new Array(i.reserved)].map(((t,s)=>e("igl-application-info",{totalNights:Number(this.dateRangeData.dateDifference),bedPreferenceType:this.bedPreferenceType,currency:this.currency,guestInfo:i.guest?i.guest[s]:null,bookingType:this.bookingData.event_type,rateplanSelection:i,key:`${i.ratePlan.id}_${s}`,roomIndex:s,baseData:this.bookingData.event_type==="EDIT_BOOKING"?{roomtypeId:this.bookingData.currentRoomType.roomtype.id,unit:this.bookingData.currentRoomType.unit}:undefined})))})))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:e("igl-property-booked-by",{propertyId:this.propertyId,countries:this.countries,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>{this.handleEventData(t,"propertyBookedBy",0)}}))}};se.style=ie;const ae=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const ne=ae;const oe=class{constructor(e){t(this,e);this.roomsDataUpdate=s(this,"roomsDataUpdate",7)}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const t=D(this.bookingData.FROM_DATE,"YYYY-MM-DD");const e=D();if(t.isAfter(e)){return e.add(-2,"weeks").format("YYYY-MM-DD")}return t.add(-2,"weeks").format("YYYY-MM-DD")}render(){var t;return e(i,{key:"faf7b0fc05351cf3d063857d8fcb5ca7a8bc4af7"},e("igl-book-property-header",{key:"d54c5b1502b528eb63b9dc6c61a6e35ac3e76924",wasBlockedUnit:this.wasBlockedUnit,bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),e("div",{key:"610d2268e8b252dfab4b18a9c660dfe945fcc00e",class:" text-left"},ut("/Check_Availability")&&this.isEventType("EDIT_BOOKING")?e("div",{class:"loading-container"},e("div",{class:"loader"})):e(a,null,(t=o.roomTypes)===null||t===void 0?void 0:t.map((t=>e("igl-room-type",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-type-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomType:t,class:"mt-2 mb-1 p-0","data-testid":`room_type_${t.id}`,id:t.id.toString(),roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)}))))))}};oe.style=ne;class re{constructor(t){var e;this.isActive=false;this.handleBeforeUnload=t=>{this.onIntercept();t.preventDefault();t.returnValue=""};this.onIntercept=(e=t.onIntercept)!==null&&e!==void 0?e:()=>{};if(t.autoActivate){this.activate()}}activate(){if(this.isActive)return;window.addEventListener("beforeunload",this.handleBeforeUnload,{capture:true});this.isActive=true}deactivate(){if(!this.isActive)return;window.removeEventListener("beforeunload",this.handleBeforeUnload,{capture:true});this.isActive=false}}const le=".sc-igl-bulk-block-h{display:flex;flex-direction:column;flex:1 1 0%;height:100%}.bulk-sheet-container.sc-igl-bulk-block{display:flex;flex-direction:column;flex:1;min-height:0;gap:1rem}.animated-container.sc-igl-bulk-block{transition:all 0.5s ease}.physical-room.sc-igl-bulk-block{margin-left:1rem !important;padding-top:0.5rem}.physical-room.sc-igl-bulk-block>td.sc-igl-bulk-block:last-child{padding-left:1rem}.room-type-list.sc-igl-bulk-block{padding:0;margin:0}.room-type-list.sc-igl-bulk-block>li.sc-igl-bulk-block,.physical-room.sc-igl-bulk-block,.room-type-row.sc-igl-bulk-block{list-style:none}";const ce=le;const de=".sc-igl-bulk-block-h{height:100%}.sheet-container.sc-igl-bulk-block{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-igl-bulk-block{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-igl-bulk-block{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-igl-bulk-block{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-igl-bulk-block{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-igl-bulk-block{flex-direction:row;align-items:center}}";const he=de;const ue=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.toast=s(this,"toast",7);this.maxDatesLength=8;this.selectedRoomTypes=new Map;this.selectedUnit=null;this.blockState="block";this.dates=[{from:null,to:null}];this.dateRefs=[];this.minDate=D().format("YYYY-MM-DD");this.bookingService=new l;this.datesSchema=N.array(N.object({from:N.any().refine((t=>D.isMoment(t)),{message:"Invalid 'from' date; expected a Moment object."}).transform((t=>t.format("YYYY-MM-DD"))),to:N.any().refine((t=>D.isMoment(t)),{message:"Invalid 'to' date; expected a Moment object."}).transform((t=>t.format("YYYY-MM-DD")))}))}componentDidLoad(){this.reloadInterceptor=new re({autoActivate:false});this.sidebar=document.querySelector("ir-sidebar")}disconnectedCallback(){this.reloadInterceptor.deactivate()}async addBlockDates(){var t,e;try{this.errors=null;this.isLoading=true;const i=this.datesSchema.parse(this.dates);if(!this.selectedUnit){this.unitSections.scrollIntoView({behavior:"smooth",block:"center"});this.errors="rooms";return}if(this.blockState==="block"){await this.bookingService.blockAvailabilityForBrackets({unit_id:(t=this.selectedUnit)===null||t===void 0?void 0:t.unit_id,description:"",block_status_code:"002",brackets:i.map((t=>({from_date:t.from,to_date:t.to})))})}else{await this.bookingService.unBlockUnitByPeriod({unit_id:(e=this.selectedUnit)===null||e===void 0?void 0:e.unit_id,from_date:i[0].from,to_date:i[0].to})}this.activate();this.deactivate();this.toast.emit({type:"success",title:y.entries.Lcz_RequestSubmittedSuccessfully,description:""});this.isLoading=false;this.closeModal.emit()}catch(t){console.log(t);if(t instanceof R){this.datesSections.scrollIntoView({behavior:"smooth",block:"center"});this.errors="dates"}}finally{this.isLoading=false}}activate(){this.reloadInterceptor.activate();if(this.sidebar)this.sidebar.preventClose=true}deactivate(){this.reloadInterceptor.deactivate();if(this.sidebar)this.sidebar.preventClose=false}handleDateChange({index:t,date:e,key:i}){var s,a;const n=[...this.dates];n[t]=Object.assign(Object.assign({},n[t]),{[i]:e});if(i==="from"&&((s=n[t].to)===null||s===void 0?void 0:s.isBefore(e,"dates"))){n[t].to=null}for(let i=t+1;i<n.length;i++){const t=(a=n[i])===null||a===void 0?void 0:a.from;if(t&&t.isSameOrBefore(e,"day")){n[i]={from:null,to:null}}}this.dates=n;setTimeout((()=>{var e,s;if(i==="from"){(e=this.dateRefs[t])===null||e===void 0?void 0:e.to.openDatePicker()}else{const t=n.findIndex((t=>t.from===null));if(t>-1){(s=this.dateRefs[t])===null||s===void 0?void 0:s.from.openDatePicker()}}}),100)}addDateRow(){const t=this.dates[this.dates.length-1];if(!t.from||!t.to){this.errors="dates";return}this.errors=null;this.dates=[...this.dates,{from:null,to:null}];setTimeout((()=>{var t;(t=this.dateRefs[this.dates.length-1].to)===null||t===void 0?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})}),100)}render(){return e("form",{key:"f2d23bfe0a2b0cf49bd80ae4143bc8879522bf4a",class:"bulk-sheet-container",onSubmit:t=>{t.preventDefault();this.addBlockDates()}},e("div",{key:"2c2b14f486250ff94228538257622d7a9e18a33b",class:"sheet-body px-1"},e("div",{key:"445357464d24da8a610711ab4e11bbffaf7780e4",class:"text-muted text-left pt-0 my-0 d-flex align-items-center pb-1",style:{gap:"0.5rem"}},e("p",{key:"c10cdf9710d246fdaea8998f8bef79894d4370e0",class:"m-0 p-0"},"Select the unit to"),e("ir-select",{key:"7c162abb4603dfe8bd41f99fbf7a476f89ced32f",showFirstOption:false,selectedValue:this.blockState,data:[{text:"Block",value:"block"},{text:"Unblock",value:"unblock"}],onSelectChange:t=>{this.blockState=t.detail}})),e("div",{key:"7fde6df46a95437f7998450e980063d0797428d3"},this.errors==="rooms"&&e("p",{key:"8017d0f40d0c8bec4b4b77ebafa8e0dc82e6b8a3",class:"text-danger text-left smaller p-0 ",style:{"margin-bottom":"0.5rem"}},x.is_vacation_rental?y.entries.Lcz_PlzSelectOneListing:y.entries.Lcz_PlzSelectOneUnit),e("ul",{key:"32289fe302594bf665772d8354c4362cbb9fcaca",class:"room-type-list",ref:t=>this.unitSections=t},x.roomsInfo.map((t=>e(a,null,e("li",{key:`roomTypeRow-${t.id}`,class:`room-type-row`},e("div",{class:"d-flex choice-row"},e("span",{class:"pl-1 text-left room-type-name"},t.name))),t.physicalrooms.map(((i,s)=>{var a;const n=s===t.physicalrooms.length-1?"pb-1":"";return e("li",{key:`physicalRoom-${i.id}-${s}`,class:`physical-room ${n}`},e("div",{class:"d-flex choice-row"},e("ir-radio",{class:"pl-1 ",name:"unit",checked:((a=this.selectedUnit)===null||a===void 0?void 0:a.unit_id)===i.id,onCheckChange:()=>this.selectedUnit={roomtype_id:t.id,unit_id:i.id},label:i.name})))}))))))),e("table",{key:"1acbaf5dd8b6fec9b4f047549df0268eaccfd8af",class:"mt-1",ref:t=>this.datesSections=t},e("thead",{key:"9edd11010d7e22fc55129ef5afa4155a70f754c0"},e("tr",{key:"b4c12b130d32fb5a982e876afa7a1f09e85f6e85"},e("th",{key:"bd2e6f46476df568d3dfb9b32db871c01b71948c",class:"text-left"},y.entries.Lcz_From),e("th",{key:"e479fa0aee56667c73d205bd49ed98ed21b10cb5",class:"text-left"},y.entries.Lcz_ToExclusive),e("td",{key:"f0efcc9fa94ab7fd433125412cd1bed526cf4c2f"},this.dates.length!==this.maxDatesLength&&this.blockState==="block"&&e("ir-button",{key:"c733dca5e68d60c567181573929311b713be3884",variant:"icon",icon_name:"plus",onClickHandler:()=>{this.addDateRow()}})))),e("tbody",{key:"b3e4a3f75eba35fefaa70c140ccb5625c57df1b4"},this.dates.map(((t,i)=>{var s,a,n,o,r,l,c;if(!this.dateRefs[i]){this.dateRefs[i]={}}const d=i>0?(n=(a=(s=this.dates[i-1])===null||s===void 0?void 0:s.to.clone().add(1,"days"))===null||a===void 0?void 0:a.format("YYYY-MM-DD"))!==null&&n!==void 0?n:this.minDate:this.minDate;const h=this.dates[i].from?(r=(o=this.dates[i])===null||o===void 0?void 0:o.from.clone().add(1,"days"))===null||r===void 0?void 0:r.format("YYYY-MM-DD"):this.minDate;return e("tr",{key:`date_${i}`},e("td",{class:"pr-1 pb-1"},e("ir-date-picker",{ref:t=>{this.dateRefs[i].from=t},forceDestroyOnUpdate:true,minDate:d,"data-testid":"pickup_arrival_date",date:(l=t.from)===null||l===void 0?void 0:l.format("YYYY-MM-DD"),emitEmptyDate:true,"aria-invalid":String(this.errors==="dates"&&!t.from),onDateChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleDateChange({index:i,date:t.detail.start,key:"from"})},onDatePickerFocus:t=>{var e,s,a;t.stopImmediatePropagation();t.stopPropagation();if(i===0){return}const n=this.dates.findIndex((t=>!t.from||!t.to));if(!((e=this.dates[n])===null||e===void 0?void 0:e.from)){(s=this.dateRefs[n])===null||s===void 0?void 0:s.from.openDatePicker();return}if(!((a=this.dates[n])===null||a===void 0?void 0:a.to)){this.dateRefs[n].to.openDatePicker()}}},e("input",{type:"text",slot:"trigger",value:t.from?t.from.format("MMM DD, YYYY"):null,class:`form-control input-sm ${this.errors==="dates"&&!t.to?"border-danger":""} text-center`,style:{width:"100%"}}))),e("td",{class:"pr-1 pb-1"},e("ir-date-picker",{forceDestroyOnUpdate:true,ref:t=>{this.dateRefs[i].to=t},"data-testid":"pickup_arrival_date",date:(c=t.to)===null||c===void 0?void 0:c.format("YYYY-MM-DD"),emitEmptyDate:true,minDate:h,"aria-invalid":String(this.errors==="dates"&&!t.to),onDateChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleDateChange({index:i,date:t.detail.start,key:"to"})},maxDate:t.from?D(t.from).add(3,"months").format("YYYY-MM-DD"):undefined,onDatePickerFocus:t=>{var e,i,s,a;t.stopImmediatePropagation();t.stopPropagation();const n=this.dates.findIndex((t=>!t.from||!t.to));if(!((e=this.dates[n])===null||e===void 0?void 0:e.from)){(s=(i=this.dateRefs[n])===null||i===void 0?void 0:i.from)===null||s===void 0?void 0:s.openDatePicker();return}if(!((a=this.dates[n])===null||a===void 0?void 0:a.to)){this.dateRefs[n].to.openDatePicker()}}},e("input",{type:"text",slot:"trigger",value:t.to?t.to.format("MMM DD, YYYY"):null,class:`form-control input-sm \n                          ${this.errors==="dates"&&!t.to?"border-danger":""}\n                          text-center`,style:{width:"100%"}}))),i>0&&e("td",{class:"pb-1"},e("ir-button",{variant:"icon",icon_name:"minus",onClickHandler:()=>{this.dates=this.dates.filter(((t,e)=>e!==i))}})))}))))),e("div",{key:"4e31cc0d2958f2a23ab072722b073ab0ce8de033",class:"sheet-footer"},e("ir-button",{key:"c60754145ad42d8f79f942894c019b676e229d98",text:y.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClickHandler:()=>this.closeModal.emit(null)}),e("ir-button",{key:"fab533d7d025cec9cc263bae0518c6f8d2ddc65e",isLoading:this.isLoading,text:y.entries.Lcz_Confirm,btn_type:"submit",class:"flex-fill"})))}};ue.style=ce+he;const fe=".bulk-operations-sheet-container.sc-igl-bulk-operations{display:flex;flex-direction:column;height:auto !important;min-height:100vh;background:white !important}.animated-container.sc-igl-bulk-operations{transition:all 0.5s ease}.tabs.sc-igl-bulk-operations{position:sticky;top:var(--ir-tabs-top, 54px);background-color:white;z-index:9999999;padding-top:1rem;margin-bottom:1rem}";const pe=fe;const be=".sc-igl-bulk-operations-h{height:100%}.sheet-container.sc-igl-bulk-operations{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-igl-bulk-operations{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-igl-bulk-operations{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-igl-bulk-operations{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-igl-bulk-operations{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-igl-bulk-operations{flex-direction:row;align-items:center}}";const ge=be;const me=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.toast=s(this,"toast",7);this.maxDatesLength=8;this.tabs=[{id:"stop-sale",label:"Stop/Open Sale"},{id:"block",label:"Block Unit"}]}componentDidLoad(){var t,e,i;this.tabsEl.style.setProperty("--ir-tabs-top",((i=(e=(t=this.titleEl)===null||t===void 0?void 0:t.getBoundingClientRect())===null||e===void 0?void 0:e.height)===null||i===void 0?void 0:i.toString())+"px")}render(){var t;return e("div",{key:"20e5ecc7206be02d5950b9536da9b94a0f6b4428",class:"bulk-operations-sheet-container"},e("div",{key:"dd1525a19f77f0ab7b98e402e4bfb143ca9c5bc5",class:"sheet-header d-flex align-items-center"},e("ir-title",{key:"301924de1774d939861d575b961c32a41c869ee7",ref:t=>this.titleEl=t,onCloseSideBar:t=>{t.stopImmediatePropagation();t.stopPropagation();this.closeModal.emit(null)},class:"px-1 mb-0",label:"Bulk Operations",displayContext:"sidebar"})),e("ir-tabs",{key:"62e27c80e8f0e7e9a19542d4672162036bd580e0",ref:t=>this.tabsEl=t,class:"tabs",tabs:this.tabs,onTabChanged:t=>this.selectedTab=t.detail}),((t=this.selectedTab)===null||t===void 0?void 0:t.id)==="stop-sale"?e("igl-bulk-stop-sale",{maxDatesLength:this.maxDatesLength,property_id:this.property_id}):e("igl-bulk-block",{maxDatesLength:this.maxDatesLength,property_id:this.property_id}))}};me.style=pe+ge;const ve=".sc-igl-bulk-stop-sale-h{display:flex;flex-direction:column;flex:1 1 0%;height:100%}.bulk-sheet-container.sc-igl-bulk-stop-sale{display:flex;flex-direction:column;flex:1;min-height:0;gap:1rem}.animated-container.sc-igl-bulk-stop-sale{transition:all 0.5s ease}.days-checkbox.sc-igl-bulk-stop-sale{gap:0.5rem}";const ye=ve;const ke=".sc-igl-bulk-stop-sale-h{height:100%}.sheet-container.sc-igl-bulk-stop-sale{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-igl-bulk-stop-sale{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-igl-bulk-stop-sale{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-igl-bulk-stop-sale{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-igl-bulk-stop-sale{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-igl-bulk-stop-sale{flex-direction:row;align-items:center}}";const we=ke;const xe=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.toast=s(this,"toast",7);this.maxDatesLength=8;this.selectedRoomTypes=[];this.dates=[{from:null,to:null}];this.selectedWeekdays=new Set(Array(7).fill(null).map(((t,e)=>e)));this.dateRefs=[];this.minDate=D().format("YYYY-MM-DD");this.bookingService=new l;this.datesSchema=N.array(N.object({from:N.any().refine((t=>D.isMoment(t)),{message:"Invalid 'from' date; expected a Moment object."}).transform((t=>t.format("YYYY-MM-DD"))),to:N.any().refine((t=>D.isMoment(t)),{message:"Invalid 'to' date; expected a Moment object."}).transform((t=>t.format("YYYY-MM-DD")))}))}getDayIndex(t){return D(t,"YYYY-MM-DD").day()}componentDidLoad(){this.reloadInterceptor=new re({autoActivate:false});this.sidebar=document.querySelector("ir-sidebar")}disconnectedCallback(){this.reloadInterceptor.deactivate()}async addBlockDates(){const t=t=>{const e=[];for(const i of t){let t=i.from;const s=D(i.to,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");while(t!==s){const i=D(t,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");if(!this.selectedWeekdays.has(this.getDayIndex(t))){t=i;continue}for(const i of this.selectedRoomTypes){e.push({room_type_id:i.id,night:t})}t=i}}return e};const e=t=>{const e=new Map(T.disabled_cells);const i=new Map(x.roomsInfo.map(((t,e)=>[t.id,{roomType:t,index:e}])));const s=new Map(T.days.map(((t,e)=>[t.value,e])));const a=new Map;for(const n of t){for(const t of n.restrictions){const{night:o,room_type_id:r}=t;const{roomType:l}=i.get(r);if(!l)continue;const c=s.get(o);if(c===undefined){console.warn(`Couldn't find date ${o}`);continue}const d=T.days[c];const h=`${r}_${o}`;let u=a.get(h);if(!u){u=d.rate.find((t=>t.id===r));if(!u){console.warn(`Couldn't find room type ${r}`);continue}a.set(h,u)}const f=u.exposed_inventory.rts===0;for(const t of l.physicalrooms){const i=`${t.id}_${o}`;e.set(i,{disabled:n.is_closed?true:f,reason:n.is_closed?"stop_sale":f?"inventory":"stop_sale"})}}}T["disabled_cells"]=new Map(e)};try{this.errors=null;this.isLoading=true;const i=this.datesSchema.parse(this.dates);if(this.selectedRoomTypes.length===0){this.unitSections.scrollIntoView({behavior:"smooth",block:"center"});this.errors="rooms";return}if(this.selectedWeekdays.size===0){this.weekdaysSections.scrollIntoView({behavior:"smooth",block:"center"});this.errors="weekdays";return}this.activate();const s=t(i);const a=this.selectedRoomTypes.every((t=>t.result==="open"));const n=this.selectedRoomTypes.every((t=>t.result==="closed"));if(n||a){const t={is_closed:n,restrictions:s,property_id:this.property_id};await this.bookingService.setExposedRestrictionPerRoomType(t);e([t])}else{const t=[];for(const e of this.selectedRoomTypes){const i=s.filter((t=>t.room_type_id===e.id));t.push({is_closed:e.result==="closed",restrictions:i,property_id:this.property_id})}await Promise.all(t.map((t=>this.bookingService.setExposedRestrictionPerRoomType(t))));e(t)}this.deactivate();this.toast.emit({type:"success",title:y.entries.Lcz_RequestSubmittedSuccessfully,description:""});this.isLoading=false;this.closeModal.emit()}catch(t){console.log(t);if(t instanceof R){this.datesSections.scrollIntoView({behavior:"smooth",block:"end"});this.errors="dates"}}finally{this.isLoading=false}}activate(){this.reloadInterceptor.activate();if(this.sidebar)this.sidebar.preventClose=true}deactivate(){this.reloadInterceptor.deactivate();if(this.sidebar)this.sidebar.preventClose=false}handleDateChange({index:t,date:e,key:i}){var s,a;const n=[...this.dates];n[t]=Object.assign(Object.assign({},n[t]),{[i]:e});if(i==="from"&&((s=n[t].to)===null||s===void 0?void 0:s.isBefore(e,"dates"))){n[t].to=null}for(let i=t+1;i<n.length;i++){const t=(a=n[i])===null||a===void 0?void 0:a.from;if(t&&t.isSameOrBefore(e,"day")){n[i]={from:null,to:null}}}this.dates=n;setTimeout((()=>{var e,s;if(i==="from"){(e=this.dateRefs[t])===null||e===void 0?void 0:e.to.openDatePicker()}else{const t=n.findIndex((t=>t.from===null));if(t>-1){(s=this.dateRefs[t])===null||s===void 0?void 0:s.from.openDatePicker()}}}),100)}addDateRow(){const t=this.dates[this.dates.length-1];if(!t.from||!t.to){this.errors="dates";return}this.errors=null;this.dates=[...this.dates,{from:null,to:null}];setTimeout((()=>{var t;(t=this.dateRefs[this.dates.length-1].to)===null||t===void 0?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})}),100)}render(){return e("form",{key:"36a565286dbc732e6ba77fed42fc91a08e4d01bb",class:"bulk-sheet-container",onSubmit:t=>{t.preventDefault();this.addBlockDates()}},e("div",{key:"7d1a50ae1f03443a8636bf00d1366a349be88b2d",class:"sheet-body px-1"},e("div",{key:"32e0752ba312030d4d574f1c07fc9e6f0d329258",class:"text-muted text-left py-0 my-0"},e("p",{key:"f341465a9c5d0fdaf425c8dfef62c033b72562e0"},"Select the types to stop or open sales for all related rate plans")),e("div",{key:"304965871988fcdd6c00e9554d1e96fcfcdac3b3"},this.errors==="rooms"&&e("p",{key:"9979ca9bace172ae494bd6bd8da0db0f955f2674",class:"text-danger text-left smaller p-0 ",style:{"margin-bottom":"0.5rem"}},x.is_vacation_rental?y.entries.Lcz_PlzSelectOneListing:y.entries.Lcz_PlzSelectOneUnit),e("table",{key:"11e6d36da5eb5be6a3a1e8366ccafdf62e58808a",ref:t=>this.unitSections=t},e("thead",{key:"d65b0d24027c3f7c961a50747a908f12a939f804"},e("tr",{key:"d503881dc67f9fb49c05e7cd21a6801c581b0394"},e("th",{key:"8051e22d02a3015618e17ce086b2c88547fbb2d2",class:"sr-only"},"choice"),e("th",{key:"afd9255556436a065a6f4b104526e4b09b5b381c",class:"sr-only"},"room type"))),e("tbody",{key:"444f4cec673031aedb188bfc8a9c7b35ce2dbda8"},x.roomsInfo.map(((t,i)=>{const s=i===x.roomsInfo.length-1?"":"pb-1";return e("tr",{key:t.id},e("td",{class:`choice-row ${s}`},e("div",{class:"d-flex justify-content-end"},e("ir-select",{firstOption:`${y.entries.Lcz_Select}...`,data:[{value:"open",text:y.entries.Lcz_Open},{value:"closed",text:y.entries.Lcz_StopSale}],onSelectChange:e=>{const i=e.detail;const s=this.selectedRoomTypes.filter((e=>e.id!==t.id));if(i){s.push({id:t.id,result:i})}this.selectedRoomTypes=s}}))),e("td",{class:`pl-1 text-left ${s}`},t.name))}))))),e("p",{key:"766e146867c89ed51e245c3687560ba36910967a",class:"text-left mt-2 text-muted"},"Included days"),this.errors==="weekdays"&&e("p",{key:"2d771ecf886316f0a2ff052d000e098c9193e43d",class:"text-danger text-left smaller m-0 p-0"},"Please select at least one day"),e("ir-weekday-selector",{key:"17021693e4b1c854f43b3957f0dcb2b0f259b153",ref:t=>this.weekdaysSections=t,weekdays:Array.from(this.selectedWeekdays),onWeekdayChange:t=>{t.stopPropagation();t.stopImmediatePropagation();this.selectedWeekdays=new Set(t.detail)}}),e("table",{key:"44f06bf9dcc1b97c9845aa7a6ebe1e48c8cb85f9",class:"mt-1",ref:t=>this.datesSections=t},e("thead",{key:"66fbac054427e937cdbd904b2162d5c8e7877937"},e("tr",{key:"07cd5cbd24d4f87dc1446ffaec56d90ca7d6510f"},e("th",{key:"8096ceef8ace0ab068e5840c734ad6b15332e81a",class:"text-left"},y.entries.Lcz_From),e("th",{key:"b1c1accae900711dad434b64ab38d1b450ae5aec",class:"text-left"},y.entries.Lcz_ToExclusive),e("td",{key:"1f100450199addbba57cf940c5e4040102dd817c"},this.dates.length!==this.maxDatesLength&&e("ir-button",{key:"e8b97b051ae6e2db88be7199f791f691bedd504b",variant:"icon",icon_name:"plus",onClickHandler:()=>{this.addDateRow()}})))),e("tbody",{key:"70638710bca908f8d3fa41e28b2eb20b01682e88"},this.dates.map(((t,i)=>{var s,a,n,o,r,l,c;if(!this.dateRefs[i]){this.dateRefs[i]={}}const d=i>0?(n=(a=(s=this.dates[i-1])===null||s===void 0?void 0:s.to.clone().add(1,"days"))===null||a===void 0?void 0:a.format("YYYY-MM-DD"))!==null&&n!==void 0?n:this.minDate:this.minDate;const h=this.dates[i].from?(r=(o=this.dates[i])===null||o===void 0?void 0:o.from.clone())===null||r===void 0?void 0:r.format("YYYY-MM-DD"):this.minDate;return e("tr",{key:`date_${i}`},e("td",{class:"pr-1 pb-1"},e("ir-date-picker",{ref:t=>{this.dateRefs[i].from=t},forceDestroyOnUpdate:true,minDate:d,"data-testid":"pickup_arrival_date",date:(l=t.from)===null||l===void 0?void 0:l.format("YYYY-MM-DD"),emitEmptyDate:true,"aria-invalid":String(this.errors==="dates"&&!t.from),onDateChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleDateChange({index:i,date:t.detail.start,key:"from"})},onDatePickerFocus:t=>{var e,s,a;t.stopImmediatePropagation();t.stopPropagation();if(i===0){return}const n=this.dates.findIndex((t=>!t.from||!t.to));if(!((e=this.dates[n])===null||e===void 0?void 0:e.from)){(s=this.dateRefs[n])===null||s===void 0?void 0:s.from.openDatePicker();return}if(!((a=this.dates[n])===null||a===void 0?void 0:a.to)){this.dateRefs[n].to.openDatePicker()}}},e("input",{type:"text",slot:"trigger",value:t.from?t.from.format("MMM DD, YYYY"):null,class:`form-control input-sm ${this.errors==="dates"&&!t.to?"border-danger":""} text-center`,style:{width:"100%"}}))),e("td",{class:"pr-1 pb-1"},e("ir-date-picker",{forceDestroyOnUpdate:true,ref:t=>{this.dateRefs[i].to=t},"data-testid":"pickup_arrival_date",date:(c=t.to)===null||c===void 0?void 0:c.format("YYYY-MM-DD"),emitEmptyDate:true,minDate:h,"aria-invalid":String(this.errors==="dates"&&!t.to),onDateChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleDateChange({index:i,date:t.detail.start,key:"to"})},onDatePickerFocus:t=>{var e,i,s,a;t.stopImmediatePropagation();t.stopPropagation();const n=this.dates.findIndex((t=>!t.from||!t.to));if(!((e=this.dates[n])===null||e===void 0?void 0:e.from)){(s=(i=this.dateRefs[n])===null||i===void 0?void 0:i.from)===null||s===void 0?void 0:s.openDatePicker();return}if(!((a=this.dates[n])===null||a===void 0?void 0:a.to)){this.dateRefs[n].to.openDatePicker()}}},e("input",{type:"text",slot:"trigger",value:t.to?t.to.format("MMM DD, YYYY"):null,class:`form-control input-sm \n                          ${this.errors==="dates"&&!t.to?"border-danger":""}\n                          text-center`,style:{width:"100%"}}))),i>0&&e("td",{class:"pb-1"},e("ir-button",{variant:"icon",icon_name:"minus",onClickHandler:()=>{this.dates=this.dates.filter(((t,e)=>e!==i))}})))}))))),e("div",{key:"8e49b2788d62b88b48aeb1a86855d111f234c7bd",class:"sheet-footer"},e("ir-button",{key:"c84959f9dbde520d66430e59e7dc2e6fa765c59d",text:y.entries.Lcz_Cancel,btn_color:"secondary",class:"flex-fill",onClickHandler:()=>this.closeModal.emit(null)}),e("ir-button",{key:"b6fa3d99a00424e6ba922691777fa03086de913b",isLoading:this.isLoading,text:y.entries.Lcz_Save,btn_type:"submit",class:"flex-fill"})))}};xe.style=ye+we;const _e=".sc-igl-cal-body-h{display:block}.bodyContainer.sc-igl-cal-body{position:relative}.roomRow.sc-igl-cal-body{width:max-content}.roomRow.sc-igl-cal-body:first-child{margin-top:80px}.categoryName.sc-igl-cal-body{font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.cellData[data-dirty-room='true'].sc-igl-cal-body::after{content:'';position:absolute;bottom:0;height:100%;left:30%;right:30%;background-color:#d4d0be !important}.cellData.disabled.sc-igl-cal-body{background:rgba(153, 153, 153, 15%);cursor:var(--cell-cursor, not-allowed);transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.roomRow.sc-igl-cal-body .room.sc-igl-cal-body{cursor:pointer;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.roomRow.sc-igl-cal-body .room.sc-igl-cal-body:hover{background:#e0e0e0}.roomRow.sc-igl-cal-body .room.sc-igl-cal-body:hover[data-hk-enabled='false']{background:white;cursor:default}.cellData.sc-igl-cal-body{width:58px;height:30px;display:inline-grid;border-top:1px solid #e0e0e0;border-left:1px solid #e0e0e0;vertical-align:top}.triangle-button.sc-igl-cal-body{--size:10px;position:absolute;right:-6px;top:-1px;width:0;height:0;padding:0;border:none;background:transparent;cursor:pointer;width:0;height:0;border-left:var(--size) solid transparent;border-right:var(--size) solid transparent;border-bottom:var(--size) solid var(--in-toggle-color);transform:rotate(45deg)}.cellData.sc-igl-cal-body:nth-child(2){border-left:0px}.cellData.sc-igl-cal-body:last-child{border-right:1px solid rgba(186, 191, 199, 0.5)}.roomHeaderCell.sc-igl-cal-body{position:-webkit-sticky;position:sticky;left:0;background:#fff;border-right:1px solid #ccc;width:170px;z-index:1}.currentDay.sc-igl-cal-body{background-color:#e3f3fa}.dragOverHighlight.sc-igl-cal-body{background-color:#f5f5dc !important}.selectedDay.sc-igl-cal-body{background-color:#f9f9c9 !important}.categoryTitle.sc-igl-cal-body{grid-template-columns:1fr 20px;padding-left:10px;cursor:pointer;height:40px;font-size:0.9em}.categoryTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.sc-igl-cal-body{padding-left:20px;font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.roomTitle.sc-igl-cal-body>.sc-igl-cal-body:nth-child(1){white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.roomTitle.pl10.sc-igl-cal-body{padding-left:10px}.categoryPriceColumn.sc-igl-cal-body{align-items:center;height:40px;-webkit-user-select:none;user-select:none;position:relative}.bookingEventsContainer.sc-igl-cal-body{position:absolute;top:0;left:0}";const De=_e;const Ce=class{constructor(e){t(this,e);this.addBookingDatasEvent=s(this,"addBookingDatasEvent",7);this.showBookingPopup=s(this,"showBookingPopup",7);this.scrollPageToRoom=s(this,"scrollPageToRoom",7);this.dragOverElement="";this.renderAgain=false;this.isLoading=null;this.selectedRooms={};this.fromRoomId=-1;this.currentDate=new Date;this.housekeepingService=new mt;this.bookingMap=new Map;this.interactiveTitle=[];this.dayRateMap=new Map}componentWillLoad(){this.currentDate.setHours(0,0,0,0);this.bookingMap=this.getBookingMap(this.getBookingData());T.days.forEach((t=>{this.dayRateMap.set(t.day,t.rate)}));this.updateDisabledCellsCache()}handleCalendarDataChange(){this.bookingMap=this.getBookingMap(this.getBookingData());this.updateDisabledCellsCache()}dragOverHighlightElementHandler(t){this.dragOverElement=t.detail.dragOverElement}gotoRoom(t){let e=t.detail.roomId;let i=this.getRoomCategoryByRoomId(e);if(!i.expanded){this.toggleCategory(i);setTimeout((()=>{this.scrollToRoom(e)}),10)}else{this.scrollToRoom(e)}}addToBeAssignedEvents(t){this.addBookingDatas(t.detail.data);this.renderElement()}closeWindow(){let t=this.getBookingData().findIndex((t=>t.ID==="NEW_TEMP_EVENT"));if(t!==-1){this.getBookingData().splice(t,1);console.log("removed item..");this.renderElement()}}scrollToRoom(t){this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:t,refClass:"room_"+t})}getRoomCategoryByRoomId(t){return this.calendarData.roomsInfo.find((e=>this.getCategoryRooms(e).find((e=>this.getRoomId(e)===t))))}getCategoryName(t){return t.name}getCategoryId(t){return t.id}getTotalPhysicalRooms(t){return this.getCategoryRooms(t).length}getCategoryRooms(t){return t&&t.physicalrooms||[]}getRoomName(t){return t.name}getRoomId(t){return t.id}getRoomById(t,e){return t.find((t=>this.getRoomId(t)===e))}getBookingData(){return this.calendarData.bookingEvents}addBookingDatas(t){this.addBookingDatasEvent.emit(t)}getSelectedCellRefName(t,e){return"room_"+t+"_"+e.currentDate}getSplitBookingEvents(t){console.log(t.FROM_DATE);return this.getBookingData().some((e=>{if(!["003","002","004"].includes(e.STATUS_CODE)){if(new Date(t.FROM_DATE).getTime()>=new Date(e.FROM_DATE).getTime()&&new Date(t.FROM_DATE).getTime()<=new Date(e.TO_DATE).getTime()){return e}}}))}addNewEvent(t){let i=Object.keys(this.selectedRooms);let s,a;if(this.selectedRooms[i[0]].currentDate<this.selectedRooms[i[1]].currentDate){s=new Date(this.selectedRooms[i[0]].currentDate);a=new Date(this.selectedRooms[i[1]].currentDate)}else{s=new Date(this.selectedRooms[i[1]].currentDate);a=new Date(this.selectedRooms[i[0]].currentDate)}const n=Math.round(Math.abs((a.getTime()-s.getTime())/864e5));this.newEvent={ID:"NEW_TEMP_EVENT",NAME:e("span",null,""),EMAIL:"",PHONE:"",convertBooking:false,REFERENCE_TYPE:"PHONE",FROM_DATE:s.getFullYear()+"-"+this.getTwoDigitNumStr(s.getMonth()+1)+"-"+this.getTwoDigitNumStr(s.getDate()),TO_DATE:a.getFullYear()+"-"+this.getTwoDigitNumStr(a.getMonth()+1)+"-"+this.getTwoDigitNumStr(a.getDate()),BALANCE:"",NOTES:"",RELEASE_AFTER_HOURS:0,PR_ID:this.selectedRooms[i[0]].roomId,ENTRY_DATE:"",NO_OF_DAYS:n,ADULTS_COUNT:1,COUNTRY:"",INTERNAL_NOTE:"",RATE:"",TOTAL_PRICE:"",RATE_PLAN:"",ARRIVAL_TIME:"",TITLE:y.entries.Lcz_NewBookingFor,roomsInfo:[t],CATEGORY:t.name,event_type:"BAR_BOOKING",STATUS:"TEMP-EVENT",defaultDateRange:{fromDate:null,fromDateStr:"",toDate:null,toDateStr:"",dateDifference:n,editable:false,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};let o=t.name+" "+this.getRoomName(this.getRoomById(this.getCategoryRooms(t),this.selectedRooms[i[0]].roomId));this.newEvent.BLOCK_DATES_TITLE=`${y.entries.Lcz_BlockDatesFor} ${o}`;this.newEvent.TITLE+=o;this.newEvent.defaultDateRange.toDate=new Date(this.newEvent.TO_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDate=new Date(this.newEvent.FROM_DATE+"T00:00:00");this.newEvent.defaultDateRange.fromDateStr=this.getDateStr(this.newEvent.defaultDateRange.fromDate);this.newEvent.defaultDateRange.toDateStr=this.getDateStr(this.newEvent.defaultDateRange.toDate);this.newEvent.ENTRY_DATE=(new Date).toISOString();this.newEvent.legendData=this.calendarData.formattedLegendData;let r=this.getSplitBookingEvents(this.newEvent);if(r){this.newEvent.splitBookingEvents=r}this.getBookingData().push(this.newEvent);return this.newEvent}getTwoDigitNumStr(t){return t<=9?"0"+t:t}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}removeNewEvent(){this.calendarData.bookingEvents=this.calendarData.bookingEvents.filter((t=>t.ID!=="NEW_TEMP_EVENT"));this.newEvent=null}clickCell(t,e,i){if(!this.isScrollViewDragging&&e.currentDate>=this.currentDate.getTime()){let s=this.getSelectedCellRefName(t,e);if(this.selectedRooms.hasOwnProperty(s)){this.removeNewEvent();delete this.selectedRooms[s];this.renderElement();return}else if(Object.keys(this.selectedRooms).length!=1||this.fromRoomId!=t){this.removeNewEvent();this.selectedRooms={};this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.fromRoomId=t;this.renderElement()}else{const a=Object.keys(this.selectedRooms);const n=D(this.selectedRooms[a[0]].value,"YYYY-MM-DD");const o=D(e.value,"YYYY-MM-DD");let r=n.clone().add(1,"days");let l=0;while(r.isBefore(o,"day")){const e=r.format("YYYY-MM-DD");if(this.isCellDisabled(t,e)){l++}r.add(1,"days")}if(l>=1){this.selectedRooms={};this.fromRoomId=t;this.renderElement();return}this.selectedRooms[s]=Object.assign(Object.assign({},e),{roomId:t});this.addNewEvent(i);this.selectedRooms={};this.renderElement();this.showNewBookingPopup(this.newEvent)}}}showNewBookingPopup(t){console.log(t)}renderElement(){this.renderAgain=!this.renderAgain}getBookingMap(t){var e,i;const s=new Map;const a=D().startOf("day");for(const n of t){const t=D(n.FROM_DATE,"YYYY-MM-DD").startOf("day");const o=D(n.TO_DATE,"YYYY-MM-DD").startOf("day");if(a.isSameOrAfter(t)&&a.isSameOrBefore(o)){if(!s.has(n.PR_ID)){s.set(n.PR_ID,n.BOOKING_NUMBER)}else{if(j(D().toDate(),z((e=x.checkin_checkout_hours)===null||e===void 0?void 0:e.offset,(i=x.checkin_checkout_hours)===null||i===void 0?void 0:i.hour))){s.set(n.PR_ID,n.BOOKING_NUMBER)}}}}return s}getGeneralCategoryDayColumns(t,i=false,s){return T.days.map((n=>e("div",{class:`cellData  font-weight-bold categoryPriceColumn ${t+"_"+n.day} ${n.day===this.today||n.day===this.highlightedDate?"currentDay":""}`},i?e(a,null,e("span",{class:"categoryName"},n.rate[s].exposed_inventory.rts)):"")))}getGeneralRoomDayColumns(t,i,s){return this.calendarData.days.map((a=>{var n;const o=this.isCellDisabled(Number(t),a.value);const r=D(a.value,"YYYY-MM-DD").add(-1,"days").format("YYYY-MM-DD");const l=o&&Object.keys(this.selectedRooms).length===0||o&&this.isCellDisabled(Number(t),r);const c=this.selectedRooms.hasOwnProperty(this.getSelectedCellRefName(t,a));const d=a.day===this.today||a.day===this.highlightedDate;const h=T.cleaningTasks.has(+t)?T.cleaningTasks.get(+t):null;const u=["001","003"].includes((n=x.cleaning_frequency)===null||n===void 0?void 0:n.code)?false:h===null||h===void 0?void 0:h.has(a.value);return e("div",{class:`cellData position-relative roomCell ${o?"disabled":""} ${"room_"+t+"_"+a.day} ${d?"currentDay":""} ${this.dragOverElement===t+"_"+a.day?"dragOverHighlight":""} ${c?"selectedDay":""}`,style:!l&&{"--cell-cursor":"default"},onClick:()=>{if(l){return}this.clickCell(Number(t),a,i)},"aria-label":s,role:"gridcell","data-room-id":t,"data-date":a.value,"aria-current":d?"date":undefined,"data-room-name":s,"data-dirty-room":String(u),"aria-disabled":String(l),"aria-selected":Boolean(c)})}))}toggleCategory(t){t.expanded=!t.expanded;this.renderElement()}getRoomCategoryRow(t,i){if(this.getTotalPhysicalRooms(t)<=1||!t.is_active){return null}return e("div",{class:"roomRow"},e("div",{class:`cellData text-left align-items-center roomHeaderCell categoryTitle ${"category_"+this.getCategoryId(t)}`,onClick:()=>this.toggleCategory(t)},e("div",{class:"categoryName"},e("ir-interactive-title",{popoverTitle:this.getCategoryName(t)})),t.expanded?e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"})):e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"}))),this.getGeneralCategoryDayColumns("category_"+this.getCategoryId(t),true,i))}getRoomsByCategory(t){var i;if(!t.expanded){return null}return(i=this.getCategoryRooms(t))===null||i===void 0?void 0:i.map((i=>{if(!i.is_active){return null}const s=this.getTotalPhysicalRooms(t)<=1;const a=s?this.getCategoryName(t):this.getRoomName(i);return e("div",{class:"roomRow"},e("div",{class:`cellData room text-left align-items-center roomHeaderCell  roomTitle ${this.getTotalPhysicalRooms(t)<=1?"pl10":""} ${"room_"+this.getRoomId(i)}`,"data-room-name":a,"data-hk-enabled":String(x.housekeeping_enabled),"data-room":this.getRoomId(i),onClick:()=>{if(!x.housekeeping_enabled){return}this.selectedRoom=i;this.hkModal.openModal()},onMouseEnter:()=>{var t,e;(e=(t=this.interactiveTitle[i.id])===null||t===void 0?void 0:t.style)===null||e===void 0?void 0:e.setProperty("--ir-interactive-hk-bg","#e0e0e0")},onMouseLeave:()=>{var t,e;(e=(t=this.interactiveTitle[i.id])===null||t===void 0?void 0:t.style)===null||e===void 0?void 0:e.removeProperty("--ir-interactive-hk-bg")}},e("ir-interactive-title",{ref:t=>{if(t)this.interactiveTitle[i.id]=t},style:i.hk_status==="003"&&{"--dot-color":"#ededed"},hkStatus:x.housekeeping_enabled&&i.hk_status!=="001",popoverTitle:a},i.hk_status!=="001"&&e("div",{slot:"end",class:"d-flex align-items-center",style:{gap:"0.5rem"}},i.hk_status==="004"?e("svg",{height:14,width:14,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640"},e("title",null,"Inspected"),e("path",{fill:"green",d:"M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z"})):e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"12",width:"13.5",viewBox:"0 0 576 512",style:{display:"block"}},i.hk_status==="002"&&e("title",null,"This unit is dirty"),e("path",{fill:"currentColor",d:"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z"}))))),this.getGeneralRoomDayColumns(this.getRoomId(i),t,a))}))}getRoomRows(){var t;return(t=this.calendarData.roomsInfo)===null||t===void 0?void 0:t.map(((t,i)=>{if(t.is_active){return e(a,null,this.getRoomCategoryRow(t,i),t.expanded&&this.getRoomsByCategory(t))}else{return null}}))}async confirmHousekeepingUpdate(t,e){var i,s,a,n,o,r;t.stopImmediatePropagation();t.stopPropagation();try{this.isLoading=e==="004"?"right":"middle";await this.housekeepingService.setExposedUnitHKStatus({property_id:this.propertyId,status:{code:e},unit:{id:(i=this.selectedRoom)===null||i===void 0?void 0:i.id}});if(["001","004"].includes(e)){await this.housekeepingService.executeHKAction({actions:[{description:"Cleaned",hkm_id:((a=(s=this.selectedRoom)===null||s===void 0?void 0:s.housekeeper)===null||a===void 0?void 0:a.id)||null,unit_id:(n=this.selectedRoom)===null||n===void 0?void 0:n.id,booking_nbr:(r=this.bookingMap.get((o=this.selectedRoom)===null||o===void 0?void 0:o.id))!==null&&r!==void 0?r:null,status:e}]})}}finally{this.isLoading=null;this.selectedRoom=null;this.hkModal.closeModal()}}render(){var t,s;return e(i,{key:"2b4b9938e2c02e385a82f9ae6f852da5a52b51ba"},e("div",{key:"8aef92cd74745bcac839593f403067816888dfb7",class:"bodyContainer"},this.getRoomRows(),e("div",{key:"1c235ad8b1a4c2c53a2c6333e400f7be9b13ee35",class:"bookingEventsContainer preventPageScroll"},(t=this.getBookingData())===null||t===void 0?void 0:t.map((t=>{var i,s,a;return e("igl-booking-event",{"data-testid":`booking_${t.BOOKING_NUMBER}`,"data-room-name":(a=(s=(i=t.roomsInfo)===null||i===void 0?void 0:i.find((e=>e.id===t.RATE_TYPE)))===null||s===void 0?void 0:s.physicalrooms.find((e=>e.id===t.PR_ID)))===null||a===void 0?void 0:a.name,language:this.language,is_vacation_rental:this.calendarData.is_vacation_rental,countries:this.countries,currency:this.currency,"data-component-id":t.ID,bookingEvent:t,allBookingEvents:this.getBookingData()})})))),e("ir-modal",{key:"9d4f9a8fe82ecdaea09d035cebf8952340a25998",ref:t=>this.hkModal=t,leftBtnText:(s=y===null||y===void 0?void 0:y.entries)===null||s===void 0?void 0:s.Lcz_Cancel,middleBtnText:this.renderModalMiddleButtonText(),middleBtnActive:true,rightBtnText:this.renderModalRightButtonText(),modalBody:this.renderModalBody(),onConfirmModal:t=>this.confirmHousekeepingUpdate(t,"004"),onMiddleModal:t=>{var e;return this.confirmHousekeepingUpdate(t,((e=this.selectedRoom)===null||e===void 0?void 0:e.hk_status)==="002"?"001":"002")},autoClose:false,isMiddleButtonLoading:this.isLoading==="middle",isLoading:this.isLoading==="right",onCancelModal:t=>{t.stopImmediatePropagation();t.stopPropagation();this.selectedRoom=null;this.hkModal.closeModal()}}))}renderModalBody(){var t;if(!this.selectedRoom){return null}return e("p",null,"Update unit ",(t=this.selectedRoom)===null||t===void 0?void 0:t.name," to ...")}renderModalMiddleButtonText(){if(!this.selectedRoom){return null}return this.selectedRoom.hk_status==="002"?"Clean":"Dirty"}renderModalRightButtonText(){if(!this.selectedRoom){return null}return this.selectedRoom.hk_status!=="004"?"Clean & Inspected":"Clean"}updateDisabledCellsCache(){var t;T.disabled_cells.clear();(t=this.calendarData.roomsInfo)===null||t===void 0?void 0:t.forEach(((t,e)=>{var i;if(t.is_active){(i=this.getCategoryRooms(t))===null||i===void 0?void 0:i.forEach((t=>{if(t.is_active){this.calendarData.days.forEach((i=>{const s=this.getCellKey(t.id,i.value);T.disabled_cells.set(s,{disabled:!i.rate[e].is_available_to_book,reason:"stop_sale"})}))}}))}}))}getCellKey(t,e){return`${t}_${e}`}isCellDisabled(t,e){const i=this.getCellKey(t,e);if(!T.disabled_cells.has(i)){return false}const{disabled:s}=T.disabled_cells.get(i);return s}static get watchers(){return{calendarData:["handleCalendarDataChange"]}}};Ce.style=De;const Oe=".sc-igl-cal-footer-h{display:block;position:sticky;bottom:0;width:max-content;z-index:3}.footerCell.sc-igl-cal-footer{display:-moz-inline-grid;display:-ms-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;bottom:0;width:58px;height:40px;background:#fff;vertical-align:top;border-top:1px solid #e0e0e0}.bottomLeftCell.sc-igl-cal-footer{left:-1px;z-index:2;width:170px;text-align:left;padding-left:15px;color:#000000}.footerCell.sc-igl-cal-footer i.sc-igl-cal-footer{margin-right:5px}.legendBtn.sc-igl-cal-footer{color:#41bff3;cursor:pointer}.isOnline.sc-igl-cal-footer i.sc-igl-cal-footer{color:#2f9c3f;font-weight:bold}.isOffline.sc-igl-cal-footer i.sc-igl-cal-footer{font-weight:bold}.isOffline.sc-igl-cal-footer{color:#a40000}.dayTitle.sc-igl-cal-footer{font-size:0.8em;font-weight:600;display:grid;user-select:none}.currentDay.sc-igl-cal-footer .dayTitle.sc-igl-cal-footer{font-weight:bold}.currentDay.sc-igl-cal-footer{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-footer{font-size:0.75em}.badge-pill.sc-igl-cal-footer{padding-left:1em;padding-right:1em;font-size:0.7em;margin-bottom:2px}";const Me=Oe;const Ee=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7)}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return e(i,{key:"325cb7586f9d5173a5550870f6b22741c4548a7e",class:"footerContainer"},e("div",{key:"e16bc9533c384a3c74182dd16c7c7aa4a3de8ef4",class:"footerCell bottomLeftCell align-items-center preventPageScroll"},e("div",{key:"1ed9d27285b3522fde617e962b316c7b7dde78ea",class:"legendBtn",onClick:()=>this.handleOptionEvent("showLegend")},e("i",{key:"17f05c75405ed9c273f9b871872a96dae5eba8cd",class:"la la-square"}),e("u",{key:"311a32a3500436f4c49358cfbd6843f2c1ccfcf0"},y.entries.Lcz_Legend),e("span",{key:"484ce3c2dfac116a3d94d5cc410631ad219b2f0f"}," - v1.0131"))),this.calendarData.days.map((t=>e("div",{class:"footerCell align-items-center"},e("div",{class:`dayTitle full-height align-items-center ${t.day===this.today||this.highlightedDate===t.day?"currentDay":""}`},t.dayDisplayName)))))}};Ee.style=Me;class Ye{async getUnassignedDates(t,e,i){try{const{data:s}=await gt.post(`/Get_UnAssigned_Dates`,{propertyid:t,from_date:e,to_date:i});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return this.convertUnassignedDates(s.My_Result)}catch(t){console.error(t);throw new Error(t)}}async getUnassignedRooms(t,e,i,s,a){try{const{data:n}=await gt.post(`/Get_Aggregated_UnAssigned_Rooms`,{propertyid:e,specific_date:i});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return this.transformToAssignable(t,n,s,a)}catch(t){console.error(t);throw new Error(t)}}async assignUnit(t){try{const{data:e}=await gt.post(`/Assign_Exposed_Room`,Object.assign(Object.assign({},t),{extras:C}));if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}console.log(e);return e["My_Result"]}catch(t){console.error(t);throw new Error(t)}}cleanSpacesAndSpecialChars(t){const e=/[^a-zA-Z0-9]+/g;return t.replace(e,"")}transformToAssignable(t,e,i,s){const a=[];e.My_Result.forEach((e=>{e.unassigned_rooms.forEach((e=>{let n={roomTypeName:e.room_type_name,ID:e.identifier,NAME:e.guest_name,identifier:e.identifier,FROM_DATE:e.unassigned_date,TO_DATE:e.unassigned_date,BOOKING_NUMBER:e.book_nbr,STATUS:"IN-HOUSE",defaultDateRange:{fromDate:undefined,toDate:undefined,fromDateTimeStamp:0,toDateTimeStamp:0,fromDateStr:"",toDateStr:"",dateDifference:0},NO_OF_DAYS:1,roomsInfo:i,legendData:s,availableRooms:[],RT_ID:this.getRoomTypeId(e.room_type_name,i)};this.updateAvailableRooms(t,e,n,s,i);this.addDefaultDateRange(n);a.push(n)}))}));return a}addDefaultDateRange(t){t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=E(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=E(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS}getRoomTypeId(t,e){var i;return((i=e.find((e=>this.cleanSpacesAndSpecialChars(e.name)===this.cleanSpacesAndSpecialChars(t))))===null||i===void 0?void 0:i.id)||null}updateAvailableRooms(t,e,i,s,a){const n=[];e.assignable_units.forEach((e=>{if(e.Is_Fully_Available&&!e.Is_Not_Available){const o=F(e.from_date,e.to_date);const r=D(new Date(t.from_date)).isAfter(D(new Date(e.from_date)))?t.from_date:e.from_date;const l=D(new Date(t.to_date)).isBefore(D(new Date(e.to_date)))&&D(new Date(t.to_date)).isAfter(D(new Date(e.from_date)))?t.to_date:e.to_date;n.push({RT_ID:i.RT_ID,STATUS:"PENDING-CONFIRMATION",FROM_DATE:r,roomName:e.name,PR_ID:e.pr_id,TO_DATE:l,NO_OF_DAYS:o,ID:"NEW_TEMP_EVENT",NAME:"",NOTES:"",BALANCE:"",INTERNAL_NOTE:"",hideBubble:true,legendData:s,roomsInfo:a});i.TO_DATE=e.to_date;i.NO_OF_DAYS=o}}));i.availableRooms=n}convertUnassignedDates(t){let e={};t.forEach((t=>{let i=new Date(t.date);i.setHours(0,0,0,0);e[i.getTime()]={categories:{},dateStr:t.description}}));return e}}const Ae={unassigned_dates:{}};let{state:Te,onChange:Se}=k(Ae);function Be(t){Te.unassigned_dates=Object.assign(Object.assign({},Te.unassigned_dates),t)}function Ie(){return Te.unassigned_dates}function je(t,e){const i=ze(t);const s=ze(e);Object.keys(Te.unassigned_dates).forEach((t=>{const e=parseInt(t);if(i<=e&&e<=s){delete Te.unassigned_dates[t]}}))}function ze(t){const e=new Date(t);e.setHours(0,0,0,0);return e.getTime()}const Ne=".sc-igl-cal-header-h{display:block;position:absolute;top:0;height:100%}.svg-icon.sc-igl-cal-header{height:20px;width:20px}.darkGrey.sc-igl-cal-header{background:#ececec}.btn.sc-igl-cal-header{pointer-events:auto}.stickyCell.sc-igl-cal-header{display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid;position:-webkit-sticky;position:sticky;top:0px;height:82px;display:inline-block;vertical-align:top;z-index:2}.headersContainer.sc-igl-cal-header{background-color:#ffffff}.headerCell.sc-igl-cal-header{display:inline-grid;width:58px;height:58px;vertical-align:top;background-color:#ffffff;border-bottom:1px solid #e0e0e0}.monthsContainer.sc-igl-cal-header{height:20px;background-color:#ffffff;margin-bottom:0.2em}.monthCell.sc-igl-cal-header{display:inline-grid;height:20px;background-color:#ececec;border-right:1px solid #c7c7c7;vertical-align:top}.monthCell.sc-igl-cal-header:nth-child(odd){background-color:#dddddd}.monthTitle.sc-igl-cal-header{overflow:hidden;text-overflow:ellipsis;font-size:0.9em;text-transform:uppercase;font-weight:bold;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.topLeftCell.sc-igl-cal-header{left:0px;z-index:3;width:170px;background-color:#ffffff;display:-ms-inline-grid;display:-moz-inline-grid;display:inline-grid}.datePickerHidden.sc-igl-cal-header{position:absolute;height:100%;width:100%;opacity:0;cursor:pointer;z-index:1}.date_btn.sc-igl-cal-header{cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative}.date_btn.sc-igl-cal-header:hover{background:#f6f6f6;border-radius:0.3rem}.caledarBtns.sc-igl-cal-header{position:relative;cursor:pointer;padding:0.4rem}.caledarBtns.sc-igl-cal-header:hover{background-color:#f6f6f6}.dayTitle.sc-igl-cal-header{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.currentDay.sc-igl-cal-header .dayTitle.sc-igl-cal-header{font-weight:bold}.currentDay.sc-igl-cal-header{background-color:#e3f3fa}.dayCapacityPercent.sc-igl-cal-header{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-cal-header{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.pointer.sc-igl-cal-header{cursor:pointer}.searchContiner.sc-igl-cal-header{padding-left:10px;padding-right:10px}.searchListContainer.sc-igl-cal-header{background:#fff;border:1px solid #ccc;border-bottom:none}.searchListItem.sc-igl-cal-header{background:white;border-bottom:1px solid #ccc;padding-left:8px}.badge-light.sc-igl-cal-header{background-color:#999999;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.min-width-full.sc-igl-cal-header{min-width:100%}";const Re=Ne;const $e=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.gotoRoomEvent=s(this,"gotoRoomEvent",7);this.gotoToBeAssignedDate=s(this,"gotoToBeAssignedDate",7);this.renderAgain=false;this.unassignedRoomsNumber={};this.roomsList=[];this.toBeAssignedService=new Ye}componentWillLoad(){try{this.initializeRoomsList();if(!this.calendarData.is_vacation_rental){Se("unassigned_dates",(t=>{if(Object.keys(t).length>0){this.fetchAndAssignUnassignedRooms()}}))}}catch(t){console.error("Error in componentWillLoad:",t)}}handleCalendarDataChanged(){this.fetchAndAssignUnassignedRooms()}initializeRoomsList(){this.roomsList=[];this.calendarData.roomsInfo.forEach((t=>{this.roomsList=this.roomsList.concat(...t.physicalrooms)}))}async fetchAndAssignUnassignedRooms(){await this.assignRoomsToDate()}async assignRoomsToDate(){try{const{fromDate:t,toDate:e,data:i}=this.unassignedDates;let s=new Date(t);s.setHours(0,0,0,0);let a=s.getTime();while(a<=new Date(e).getTime()){const t=D(a).format("D_M_YYYY");if(i[a]){const e=await this.toBeAssignedService.getUnassignedRooms({from_date:this.calendarData.from_date,to_date:this.calendarData.to_date},this.propertyid,E(new Date(a)),this.calendarData.roomsInfo,this.calendarData.formattedLegendData);this.unassignedRoomsNumber[t]=e.length}else if(this.unassignedRoomsNumber[t]){const e=this.unassignedRoomsNumber[t]-1;this.unassignedRoomsNumber[t]=e<0?0:e}const e=D(a).add(1,"days").toDate();e.setHours(0,0,0,0);a=e.getTime();this.renderView()}}catch(t){console.error(t)}}handleReduceAvailableUnitEvent(t){t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i}=t.detail;let s=new Date(e).getTime();while(s<new Date(i).getTime()){const t=D(s).format("D_M_YYYY");this.unassignedRoomsNumber[t]=this.unassignedRoomsNumber[t]-1;s=D(s).add(1,"days").toDate().getTime()}this.renderView()}showToBeAssigned(t){if(this.unassignedRoomsNumber[t.day]||0){this.handleOptionEvent("showAssigned");setTimeout((()=>{this.gotoToBeAssignedDate.emit({key:"gotoToBeAssignedDate",data:t.currentDate})}),100)}}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}handleDateSelect(t){if(Object.keys(t.detail).length>0){this.handleOptionEvent("calendar",t.detail)}}handleClearSearch(){this.renderView()}handleFilterRooms(t){const e=t.target;let i=e.value.trim();i=i.toLowerCase();if(i===""){this.handleClearSearch()}this.renderView()}handleScrollToRoom(t){this.handleClearSearch();this.gotoRoomEvent.emit({key:"gotoRoom",roomId:t})}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}getNewBookingModel(){let t=new Date;t.setHours(0,0,0,0);let e=this.getStringDateFormat(t);t.setDate(t.getDate()+1);t.setHours(0,0,0,0);let i=this.getStringDateFormat(t);return{ID:"",NAME:"",EMAIL:"",PHONE:"",REFERENCE_TYPE:"PHONE",FROM_DATE:e,TO_DATE:i,roomsInfo:this.calendarData.roomsInfo,TITLE:y.entries.Lcz_NewBooking,event_type:"PLUS_BOOKING",legendData:this.calendarData.formattedLegendData,defaultDateRange:{fromDate:new Date(e),fromDateStr:"",toDate:new Date(i),toDateStr:"",dateDifference:0,editabled:true,message:""}}}renderView(){this.renderAgain=!this.renderAgain}render(){return e(i,{key:"b9ecdf7ffb246abd4fa44d18783a9ed998f8c010"},e("div",{key:"3d4ee8c6f764eca682d949a96f1846d0d532e04a",class:"stickyCell align-items-center topLeftCell preventPageScroll"},e("div",{key:"6eb29e0db8037acba88c67819b4ca7da0509cf2c",class:"row justify-content-around no-gutters"},!this.calendarData.is_vacation_rental&&e("ir-button",{key:"124f7677ff604432e34732e8ced141755ff5757d",variant:"icon",icon_name:"server",style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:y.entries.Lcz_UnassignedUnitsTooltip,onClickHandler:()=>this.handleOptionEvent("showAssigned"),btn_styles:"caledarBtns",visibleBackgroundOnHover:true}),e("ir-date-picker",{key:"949be502e387a2c26b8db0626fbf4f0fc6bf6f8f",minDate:D().add(-2,"months").startOf("month").format("YYYY-MM-DD"),onDateChanged:t=>{console.log("evt",t);this.handleDateSelect(t)},class:"date_btn",title:y.entries.Lcz_Navigate,"data-toggle":"tooltip","data-placement":"bottom"},e("ir-button",{key:"111dfa594389ef0d5bfb4b61276796625657eebf",slot:"trigger",btn_styles:"caledarBtns",variant:"icon",icon_name:"calendar",style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"}),onClickHandler:()=>this.handleOptionEvent("calendar"),visibleBackgroundOnHover:true,ref:t=>this.dateRef=t})),e("ir-button",{key:"07a25c974634f338fc4666dfbcbf64ade667dfbc",variant:"icon",btn_styles:"caledarBtns",class:"pointer",icon_name:"clock",visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"}),"data-toggle":"tooltip","data-placement":"bottom",title:y.entries.Lcz_Today,onClickHandler:()=>this.handleOptionEvent("gotoToday")}),e("ir-button",{key:"4da27369993652f9a1994f04cd384bd93a6f3de2",variant:"icon",btn_styles:"caledarBtns",icon_name:"plus","data-toggle":"tooltip","data-placement":"bottom","data-testid":"new_booking_btn",title:y.entries.Lcz_CreateNewBooking,visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"}),onClickHandler:()=>this.handleOptionEvent("add",this.getNewBookingModel())}),e("ir-button",{key:"273a510341aeb19e7e174ecf2e47a5ee043ec299",variant:"icon",btn_styles:"caledarBtns",icon_name:"calendar-xmark","data-toggle":"tooltip","data-placement":"bottom","data-testid":"new_bulk_btn",title:y.entries.Lcz_StopOpenSale,visibleBackgroundOnHover:true,style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"}),onClickHandler:()=>this.handleOptionEvent("bulk",this.getNewBookingModel())})),e("div",{key:"0f39a9404ef967ae9b10018be087e451aabae7db",class:"row justify-content-around no-gutters searchContiner"},e("ir-m-combobox",{key:"a9a9e7bc0df8936d33bf312b9cf6a1f05e9cd61c",placeholder:y.entries.Lcz_FindUnit,options:this.roomsList.map((t=>({label:t.name,value:t.id}))),onOptionChange:t=>{this.handleScrollToRoom(t.detail.value)}}))),e("div",{key:"ee2f769cacec1ecf3811ae044af14fcfa6ed6848",class:"stickyCell headersContainer"},e("div",{key:"ae0f626063427637fc802838da72c843a6038757",class:"monthsContainer"},this.calendarData.monthsInfo.map((t=>e("div",{class:"monthCell",style:{width:t.daysCount*58+"px"}},e("div",{class:"monthTitle"},t.monthName))))),this.calendarData.days.map((t=>e("div",{class:`headerCell align-items-center ${"day-"+t.day} ${t.day===this.today||t.day===this.highlightedDate?"currentDay":""}`,"data-day":t.day},!this.calendarData.is_vacation_rental&&e("div",{class:"preventPageScroll"},e("span",{class:`badge badge-${this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr!==0?"info pointer":"light"} badge-pill`,onClick:()=>this.showToBeAssigned(t)},this.unassignedRoomsNumber[t.day]||t.unassigned_units_nbr)),e("div",{class:"dayTitle"},t.dayDisplayName),e("div",{class:"dayCapacityPercent"},t.occupancy,"%"))))))}static get watchers(){return{unassignedDates:["handleCalendarDataChanged"]}}};$e.style=Re;const Fe=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:100%;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center;inset:0}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}.date-range-container-cn.sc-igl-date-range{position:relative;width:fit-content}.date-range-container-cn.sc-igl-date-range:focus-within .date-range-container.sc-igl-date-range{border:1px solid #379ff2}.date-range-container.sc-igl-date-range{position:relative;gap:1rem;font-size:0.975rem;line-height:1.45;border-radius:0.21rem;border:1px solid #cacfe7;color:#3b4781;padding:0.75rem 1rem;box-sizing:border-box !important;font-weight:400;background-color:#fff;background-clip:padding-box;height:2rem;pointer-events:none;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.date-range-container-cn.sc-igl-date-range .date-range-input.sc-igl-date-range{position:absolute;width:100% !important;inset:0;cursor:pointer}.date-range-container.disabled.sc-igl-date-range{border:none;padding-left:0;padding-right:0}.date-range-input[data-state='disabled'].sc-igl-date-range{cursor:default}";const Le=Fe;const Pe=class{constructor(e){t(this,e);this.dateSelectEvent=s(this,"dateSelectEvent",7);this.toast=s(this,"toast",7);this.disabled=false;this.withDateDifference=true;this.variant="default";this.renderAgain=false;this.totalNights=0;this.fromDateStr="from";this.toDateStr="to"}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights()}return[this.fromDateStr,this.toDateStr]}calculateTotalNights(){this.totalNights=S(D(this.fromDate).format("YYYY-MM-DD"),D(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){if(this.variant==="booking"){return e("div",{class:`p-0 m-0 date-range-container-cn`},e("ir-date-range",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),e("div",{class:`d-flex align-items-center m-0  date-range-container ${this.disabled?"disabled":""}`},e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),e("span",null,D(this.fromDate).format("MMM DD, YYYY")),e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),e("span",null,D(this.toDate).format("MMM DD, YYYY")),this.totalNights&&e("span",{class:"m-0 p-0"},this.totalNights+(this.totalNights>1?` ${y.entries.Lcz_Nights}`:` ${y.entries.Lcz_Night}`))))}return e(i,null,e("div",{class:`p-0 m-0 date-range-container-cn`},e("ir-date-range",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),e("div",{class:`d-flex align-items-center m-0  date-range-container ${this.disabled?"disabled":""}`},e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),e("span",null,D(this.fromDate).format("MMM DD, YYYY")),e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),e("span",null,D(this.toDate).format("MMM DD, YYYY")))))}static get watchers(){return{defaultData:["handleDataChange"]}}};Pe.style=Le;const He=".sc-igl-legends-h{display:block}.legendHeader.sc-igl-legends{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding-top:5px;margin-bottom:1rem}.legendCloseBtn.sc-igl-legends{position:absolute;top:50%;right:0;cursor:pointer;font-size:1.75em;line-height:1em;padding:0.4rem;display:flex;align-items:center;justify-content:center;border-radius:3px;transform:translateY(-50%)}.legendCloseBtn.sc-igl-legends:hover{background-color:#f6f6f6}.stickyHeader.sc-igl-legends{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.legendRow.sc-igl-legends{position:relative;vertical-align:middle;margin-bottom:0.3rem}.legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle}.legend_skew.sc-igl-legends,.legend_skew-bordered.sc-igl-legends,.legend_skewsplit.sc-igl-legends{transform:skew(-30deg);width:15px;height:16px}.legend_skew-bordered.sc-igl-legends{border:1px solid black}.legend_dirty-unit.sc-igl-legends{background-color:white !important;border:1px solid #e0e0e0;height:12px;width:20px;margin-right:1rem;position:relative}.legend_dirty-unit.sc-igl-legends::after{content:'';position:absolute;bottom:0;height:100%;left:30%;right:30%;background-color:#d4d0be !important}.legend_circle.sc-igl-legends{border-radius:100%;width:10px;height:10px;margin:3px 3px 3px 2px}.legend_skewsplit.sc-igl-legends{border-right:2px solid #000000}.headerCell.sc-igl-legends .blueColor.sc-igl-legends{background-color:#31bef1}.greenColor.sc-igl-legends{background-color:#45b16d}.yellowColor.sc-igl-legends{background-color:#f4d552}.greyColor.sc-igl-legends{background-color:#a0a0a0}.redColor.sc-igl-legends{background-color:#f34752}.pinkColor.sc-igl-legends{background-color:#f9b4b7}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends{margin-bottom:0}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends:first-child .legendCal.sc-igl-legends{background-color:#ececec}.legendCalendar.sc-igl-legends .legendRow.sc-igl-legends div.sc-igl-legends{display:inline-block;vertical-align:middle;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.total-availability.sc-igl-legends{font-size:1em !important}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends{width:80px;height:25px;text-align:center;display:inline-grid !important;align-content:center;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.sc-igl-legends .badge.sc-igl-legends{margin-top:0.2rem;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legendCalendar.sc-igl-legends .legendCal.legendCal-h2.sc-igl-legends{height:40px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.br-t.sc-igl-legends{border-top:1px solid #a0a0a0}.br-s.sc-igl-legends{border-left:1px solid #a0a0a0;border-right:1px solid #a0a0a0}.br-bt.sc-igl-legends{border-bottom:1px solid #a0a0a0}.highphenLegend.sc-igl-legends{font-size:0.9em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.highphenLegend.sc-igl-legends::before{width:12px;height:0.5px;content:' ';background-color:#000000;vertical-align:middle;display:inline-block;margin-left:5px;margin-right:5px;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.badge-pill.sc-igl-legends{padding:3px 1em;font-size:0.8em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.headerCell.sc-igl-legends{width:70px;display:flex;align-items:center;justify-content:center}.dayTitle.sc-igl-legends{font-size:0.8em;font-weight:600;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.dayCapacityPercent.sc-igl-legends{font-size:0.75em;-webkit-user-select:none;user-select:none;-webkit-user-drag:none}.legend_rectangle.sc-igl-legends{height:12px;width:20px;margin-right:1rem}";const Ue=He;const Ve=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7)}handleOptionEvent(t,e=""){this.optionEvent.emit({key:t,data:e})}render(){return e(i,{key:"73c01488a22db5b6d7907b39bd29fd889f789ff3",class:"legendContainer pr-1 text-left"},e("div",{key:"a7f2e17edb7ca0012e8a74fa984282565ec82f8c",class:"w-full"},e("div",{key:"1bb439049095e064dbee8f4167d46ec930b32791",class:"w-full"},e("div",{key:"c8bf0c072aaeb3072ee0f51386b2e7438ee1fc45",class:"stickyHeader pt-1 "},e("p",{key:"c9886f892843b271213a000b951640dc6dddee6f",class:"legendHeader"},y.entries.Lcz_Legend),e("div",{key:"1a50ec68851ab06e63cf6c0ef3484c215492f9b6",class:"legendCloseBtn",onClick:()=>this.handleOptionEvent("closeSideMenu")},e("svg",{key:"84815a1fc5b7f7aa203312327172ec0e0c2e0245",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"5c83f08905650a81e95d1bc7e4e22d0d141b2b19",fill:"#6b6f82",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"}))),e("hr",{key:"9a5ff289a9e7faa3d1354ca8522833415fcdb517"})),e("div",{key:"134a7e2bb7cdbb811290c144a2de9b6c8fc57e4e",class:"mt-2 pl-1"},e("table",{key:"0a9a56a1bc9a1176e892245aa79eb441ebb3c006"},this.legendData.map((t=>{console.log(t);return e("tr",{key:`legend_${t.id}`,class:"legendRow "},e("td",null,t.design==="broom"?e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"12",width:"13.5",viewBox:"0 0 576 512",style:{display:"block"}},e("path",{fill:"black",d:"M566.6 54.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192-34.7-34.7c-4.2-4.2-10-6.6-16-6.6c-12.5 0-22.6 10.1-22.6 22.6l0 29.1L364.3 320l29.1 0c12.5 0 22.6-10.1 22.6-22.6c0-6-2.4-11.8-6.6-16l-34.7-34.7 192-192zM341.1 353.4L222.6 234.9c-42.7-3.7-85.2 11.7-115.8 42.3l-8 8C76.5 307.5 64 337.7 64 369.2c0 6.8 7.1 11.2 13.2 8.2l51.1-25.5c5-2.5 9.5 4.1 5.4 7.9L7.3 473.4C2.7 477.6 0 483.6 0 489.9C0 502.1 9.9 512 22.1 512l173.3 0c38.8 0 75.9-15.4 103.4-42.8c30.6-30.6 45.9-73.1 42.3-115.8z"})):t.design==="check"?e("svg",{height:14,width:14,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640"},e("path",{fill:"green",d:"M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z"})):e("div",{class:`legend_${t.design}`,style:{backgroundColor:t.color}})),e("td",null,e("span",{class:"font-small-3"},t.name)))})))),e("hr",{key:"d4c001bd96b743f5a45f66779da0e3b903690a7c"}),e("div",{key:"94c10fb8c1cbbce024ddd48a87ae8d139cbd9bb1",class:"mt-2"},e("div",{key:"b134a2d2cd45a8dab406d5cb44bf76af2460d497",class:"legendCalendar"},e("div",{key:"6277c2a2d800e4404b566c445b7bb05aa35a6a97",class:"legendRow align-items-center"},e("div",{key:"214b9aeb28fda1e66837ab7b03f75e5efd19c83c",class:"legendCal br-t br-s br-bt"},e("strong",{key:"3899421cd306031afd2152438c2eb5fa4f499cee"},"MAR 2022")),e("div",{key:"ead4fdb1eec7cf82911e3ba6375819781417d65f",class:"highphenLegend"},y.entries.Lcz_MonthAndYear)),e("div",{key:"9b303e4a6f22098988e645216a9144bcc11391f4",class:"legendRow"},e("div",{key:"de40e3982012f7c1a853000a1b903e28e0742ec6",class:"legendCal headerCell align-items-center br-s"},e("span",{key:"e0fb0c5a1f48c9774d41c0e594856f8f43a1c283",class:"badge badge-info  badge-pill"},"3")),e("div",{key:"11976c2b26a78a331989426fcff99904ee1e7c77",class:"highphenLegend"},e("div",{key:"173eb31b56eb2364ce231b75b38422323dad9c9a"},y.entries.Lcz_UnassignedUnits))),e("div",{key:"ec63efaf62c4befd0b6ec4b9a3f834c8d80519be",class:"legendRow"},e("div",{key:"e49fe9bec86a5309a956dc776c08d2dd2bfa7b8f",class:"legendCal dayTitle br-s"},"Fri 18"),e("div",{key:"a90622e8c40e7fa88f606763f90389f6fd7e88a6",class:"highphenLegend"},y.entries.Lcz_Date)),e("div",{key:"aba6d30ca3dada5965cb09af80aef7fdbe90c7d7",class:"legendRow"},e("div",{key:"5cbb39cf7d572acf636bc8b5a42c2608550aabab",class:"legendCal br-s br-bt dayCapacityPercent"},"15%"),e("div",{key:"1f79a9e71b6786dfa516c638992108ba0885c961",class:"highphenLegend"},y.entries.Lcz_Occupancy)),e("div",{key:"236bc58e136137fd3f75aaf24978400a82b8ec31",class:"legendRow"},e("div",{key:"12734c20bce8d86624f5516fee1678b36b4e0e62",class:"legendCal br-s br-bt  font-weight-bold total-availability"},"20"),e("div",{key:"b85b15e55ca2068138f75c1950e79f9956934549",class:"highphenLegend"},y.entries.Lcz_TotalAvailability)))))))}};Ve.style=Ue;const Ge=".sc-igl-property-booked-by-h{display:block}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.row.sc-igl-booking-form.sc-igl-property-booked-by{padding:0 !important}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const Ke=Ge;const We=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.showPaymentDetails=false;this.countries=[];this.isButtonPressed=false;this.bookingService=new l;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:false,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const t=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((e,i)=>(t+i).toString()))}async assignCountryCode(){const t=await this.bookingService.getUserDefaultCountry();const e=t["COUNTRY_ID"];this.country=e;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.toString(),countryId:e})}initializeDateData(){const t=new Date;const e=t.getMonth()+1;this.currentMonth=e<10?`0${e}`:e.toString()}populateBookedByData(){var t;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((t=this.defaultData)===null||t===void 0?void 0:t.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(t,e){this.bookedByData[t]=t==="emailGuest"?e.target.checked:e.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(t==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.target.value})}}handleCountryChange(t){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:t,countryId:t});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleNumberInput(t,e){const i=e.target;const s=i.value;const a=/^[0-9]+$/;if(!a.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(t,e)}}async checkUser(){var t;try{const e=this.bookedByData.email;if(N.string().email().safeParse(e).success){const i=await this.bookingService.getUserInfo(e);if(i!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile_without_prefix,countryId:i.country_id,isdCode:(t=i===null||i===void 0?void 0:i.country_phone_prefix)!==null&&t!==void 0?t:i.isdCode.toString()});console.log(this.bookedByData)}else{let t=Object.assign({},this.bookedByData);t=Object.assign(Object.assign({},t),{email:e});this.bookedByData=Object.assign({},t)}}else{let t=Object.assign({},this.bookedByData);t=Object.assign(Object.assign({},t),{email:""});this.bookedByData=Object.assign({},t)}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}catch(t){}}updateGuest(t){var e;r("checkout_guest",Object.assign(Object.assign({},(e=o.checkout_guest)!==null&&e!==void 0?e:{}),t))}handleComboboxChange(t){var e;t.stopImmediatePropagation();t.stopPropagation();const{key:i,data:s}=t.detail;console.log(i,s);if(i==="blur"){if(N.string().email().safeParse(s).success){this.bookedByData.email=s;this.checkUser()}else if(this.bookedByData.email!==""&&s==""){this.bookedByData.email=""}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}if(i==="select"){this.bookedByData.email=s.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:s.id,firstName:s.first_name,lastName:s.last_name,contactNumber:s.mobile_without_prefix,countryId:s.country_id,isdCode:(e=s["country_phone_prefix"])!==null&&e!==void 0?e:s===null||s===void 0?void 0:s.country_id});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData})}}clearEvent(){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return e(i,{key:"b5b7736fc94f860ae5c2f5185f31cfc568b0b92a"},e("div",{key:"0fc400f16357db3051e9471575e4f9a36da3ad6e",class:"text-left mt-3"},e("div",{key:"5561db1a461cea1048dd0cbbdbc7b382a02a1ade",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},e("label",{key:"b7511da3d7b405e2cffea96274030f22f651354c",class:"p-0 m-0 label-control mr-1 font-weight-bold"},y.entries.Lcz_BookedBy),e("div",{key:"9f06326dd8e57a3a9cd8fe02f8711ac7cf3a7a34",class:"bookedByEmailContainer mt-1 mt-md-0 d-flex align-items-center"},e("ir-autocomplete",{key:"7683cfbbc67f80d990d4f53fcf7ef3f367a18099",testId:"main_guest_email",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"text",value:this.bookedByData.email,required:true,class:"flex-fill",placeholder:y.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent(),danger_border:this.isButtonPressed&&this.bookedByData.email!==""&&L(this.bookedByData.email)}),e("ir-tooltip",{key:"5964b722534fa189ed0df7cf1ac07ad12f428c0f",class:"ml-1",message:"Leave empty if email is unavailable"})))),e("div",{key:"df40aad9f1842832a96ee04d3cec324c7b884a60",class:"bookedDetailsForm text-left mt-2 font-small-3 "},e("div",{key:"c3946cfff144255888f7ecf796a2d7ef04db117a",class:"d-flex flex-column flex-md-row  justify-content-md-between "},e("div",{key:"220bb5daf47d70610aab6b759c43d1131c8065d5",class:"p-0 flex-fill "},e("div",{key:"afd53ff35a9942a29a4e6579829059a096b684b3",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},e("label",{key:"9636c58cec0fa8de1869432ca509229ed86231e4",class:"p-0 m-0 margin3"},y.entries.Lcz_FirstName),e("div",{key:"8082d9978257ce472449e8e356092aa55b3b62b3",class:"p-0 m-0  controlContainer flex-fill  "},e("input",{key:"3fd17bffa74d0aae72ea3fe3a7cf641b941c7c6a","data-testid":"main_guest_first_name",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:y.entries.Lcz_FirstName,id:ht(),value:this.bookedByData.firstName,onInput:t=>{this.updateGuest({first_name:t.target.value});this.handleDataChange("firstName",t)},required:true}))),e("div",{key:"23f2df5ad103ed620a8fc046aeddb6bff2d2ed9e",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"8d1ee8b097452ce7c34087375f79c6a2420c6c05",class:"p-0 m-0 margin3"},y.entries.Lcz_LastName),e("div",{key:"cda67e023e874c94f225f28fbbfa839b032055ff",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"4446f6c5e7d35d795ee7f4f293a769135b0b0129","data-testid":"main_guest_last_name",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:y.entries.Lcz_LastName,id:ht(),value:this.bookedByData.lastName,onInput:t=>this.handleDataChange("lastName",t)}))),e("div",{key:"74ed5278aed14e42d658680c3abcabd0539c5dd8",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"95ef5c0076523287b5562d3779978ab478511f1f",class:"p-0 m-0 margin3"},y.entries.Lcz_Country),e("ir-country-picker",{key:"0b9c9701abcf8e6dbe7a15718b05ea4df96329f8",testId:"main_guest_country",class:"flex-grow-1 m-0",onCountryChange:t=>this.handleCountryChange(t.detail.id),countries:this.countries,country:this.countries.find((t=>t.id===this.bookedByData.countryId))})),e("div",{key:"b83d1adcb255d8e5b5bccc1504f6b7eabe64d859",class:"form-group p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"cbb2f726d10fb8cd40dc3475adc1ffa49d620063",class:"p-0 m-0 margin3"},y.entries.Lcz_MobilePhone),e("div",{key:"a93624d6ae5a470370cd10afa0989cd2c1fa91ea",class:"p-0 m-0 controlContainer flex-fill"},e("ir-phone-input",{key:"2585d551a7076407b3cd1934994e79c877dab33a",testId:"main_guest_phone",language:this.language,value:this.bookedByData.contactNumber,phone_prefix:this.bookedByData.isdCode,default_country:this.bookedByData.countryId,onTextChange:t=>{this.handleDataChange("isdCode",{target:{value:t.detail.phone_prefix}});this.handleDataChange("contactNumber",{target:{value:t.detail.mobile}})}}))),e("div",{key:"084399e36f27c540febfdff0149cbe3e25237c70",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"04ee23f20424d84229205b35bc83c83c7bf74c6a",class:"p-0 m-0 margin3"},y.entries.Lcz_YourArrivalTime),e("div",{key:"9c5dc5e4d8d283e423fd8ac1380d32ea12b44e4b",class:"p-0 m-0  controlContainer flex-fill"},e("select",{key:"3b60ab3cf50e95123a1b4b9370fcbc6cacde9898","data-testid":"arrival_time",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:ht(),onChange:t=>this.handleDataChange("selectedArrivalTime",t)},this.arrivalTimeList.map((t=>e("option",{value:t.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===t.CODE_NAME},t.CODE_VALUE_EN))))))),e("div",{key:"a6b01f153007d450b6ea40f62025220bf5a605cc",class:"p-0 flex-fill  ml-md-3"},e("div",{key:"e296d4d79cd8afc6048284fb6196390e9d66c066",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},e("label",{key:"e21a7725d6d964c12e5a00214869e20b4a64ac63",class:"p-0 m-0 margin3"},y.entries.Lcz_AnyMessageForUs),e("div",{key:"e8cac19a60e94134871a35ff41e388f6f63ecf59",class:"p-0 m-0  controlContainer flex-fill "},e("textarea",{key:"762929eb2cb4d5890b6c9090f360c3c74b6d20d3","data-testid":"note",id:ht(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:t=>this.handleDataChange("message",t)}))),this.showPaymentDetails&&e(a,{key:"57fb762b926cdddd96eb21cf173e801c71ceb029"},e("div",{key:"e82141f23ecdfe7485afa9638f2b1ecb22da9b10",class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"f9fd29dc1e2bc627446333ea4a1ae2fe30c05e0d",class:"p-0 m-0 margin3"},y.entries.Lcz_CardNumber),e("div",{key:"439ba9bafb7b6c9b3600c08ffa6d45e1a9e5a415",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"50bc6502987b4ca51babd71640b3f569b12c200e",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:ht(),value:this.bookedByData.cardNumber,onInput:t=>this.handleNumberInput("cardNumber",t)}))),e("div",{key:"9943d43564b351d7d9ef126bdbfc626f8a45fc46",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"654993c6987fb19e1629917a3e6016f64729254b",class:"p-0 m-0 margin3"},y.entries.Lcz_CardHolderName),e("div",{key:"3de097d189ee608aa0946a4b399fffd8ccacd54c",class:"p-0 m-0  controlContainer flex-fill"},e("input",{key:"0ed59249cc1cb076ebdd026a88f0a4afe05d12da",class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:ht(),value:this.bookedByData.cardHolderName,onInput:t=>this.handleDataChange("cardHolderName",t)}))),e("div",{key:"d881e4d73591506165e746de4f53ab9ab5f1af3a",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},e("label",{key:"c298cfffb9278ae5e10c25e69917fc45aa055905",class:"p-0 m-0 margin3"},y.entries.Lcz_ExpiryDate),e("div",{key:"306283ac5cd9be1b238ba983b4204e28c4e5650c",class:"p-0 m-0 row  controlContainer flex-fill"},e("div",{key:"4dfa7ea88b52a332f4ed674cf67b1607dfcee4be",class:"p-0 m-0"},e("select",{key:"4d7376291a530c6edc65b2e1a06e1559eaf510a2",class:"form-control input-sm pr-0",id:ht(),onChange:t=>this.handleDataChange("expiryMonth",t)},this.expiryMonths.map((t=>e("option",{value:t,selected:t===this.bookedByData.expiryMonth},t))))),e("div",{key:"a6dee12bfe2348b249ae3ffc619904e3bedd8e92",class:"p-0 m-0 ml-1"},e("select",{key:"5e30f5f899e7c7c1dcb45dc17384a8aadb4978c9",class:"form-control input-sm pr-0",id:ht(),onChange:t=>this.handleDataChange("expiryYear",t)},this.expiryYears.map(((t,i)=>e("option",{value:t,selected:i===this.bookedByData.expiryYear},t)))))))),e("div",{key:"326f3e988b846803e200eea707f17acf553db5f7",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},e("label",{key:"ff9cbc1117a57a28ba20f77d552c378cde4679af",class:"p-0 m-0",htmlFor:"emailTheGuestId"},y.entries.Lcz_EmailTheGuest),e("div",{key:"22e80a2c087ce8ab814aeb805ddbe5daf633e3b9",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},e("input",{key:"6a8668409fb58e0f6571b5998854a28229652588",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:t=>this.handleDataChange("emailGuest",t)})))))))}};We.style=Ke;const qe=".sc-igl-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-rate-plan span[data-state='focus'].sc-igl-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-rate-plan span[data-disabled].sc-igl-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.non-ref-span.sc-igl-rate-plan{font-size:12px;color:var(--green)}.rateplan-name-container.sc-igl-rate-plan{margin-bottom:0.5rem !important}.rateplan-container.sc-igl-rate-plan{margin-top:0.5rem}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-rate-plan{width:40%;margin-top:0}.rateplan-container.sc-igl-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-rate-plan{max-width:200px}.rate-input-container.sc-igl-rate-plan{max-width:50px}.rateplan-name-container.sc-igl-rate-plan{margin-bottom:0 !important}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-rate-plan{width:40%}.price-amount.sc-igl-rate-plan{max-width:150px !important}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-rate-plan{width:100%}}.total-nights-container.sc-igl-rate-plan{width:max-content}.nightBorder.sc-igl-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const Xe=qe;const Je=class{constructor(e){t(this,e);this.buttonClicked=s(this,"buttonClicked",7);this.ratePricingMode=[];this.bookingType="PLUS_BOOKING";this.isBookDisabled=false}disableForm(){const{bookingType:t,shouldBeDisabled:e,ratePlan:i,visibleInventory:s}=this;if(t==="EDIT_BOOKING"&&e){return false}return!i.is_available_to_book||(s===null||s===void 0?void 0:s.visibleInventory)===0}updateRateplanSelection(t){const{roomTypeId:e,ratePlan:i}=this;const s=o.ratePlanSelections;o.ratePlanSelections=Object.assign(Object.assign({},s),{[e]:Object.assign(Object.assign({},s[e]),{[i.id]:Object.assign(Object.assign({},s[e][i.id]),t)})})}handleDataChange(t,e){const i=e.target.value;if(t==="adult_child_offering"){this.handleVariationChange(i)}else if(t==="rate"){this.updateRateplanSelection({view_mode:i})}else if(t==="totalRooms"){u({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:Number(i)})}}bookProperty(){if(this.bookingType==="BAR_BOOKING"){d()}this.reserveRoom();this.buttonClicked.emit({key:"next"})}reserveRoom(){var t,e,i,s,a,n,r;u({roomTypeId:this.roomTypeId,ratePlanId:this.ratePlan.id,rooms:1,guest:[{last_name:(t=o.guest)===null||t===void 0?void 0:t.last_name,first_name:(e=o.guest)===null||e===void 0?void 0:e.first_name,unit:this.roomTypeId===((i=o.guest)===null||i===void 0?void 0:i.roomtype_id)?(s=o.guest)===null||s===void 0?void 0:s.unit:null,bed_preference:this.visibleInventory.roomtype.is_bed_configuration_enabled?(a=o.guest)===null||a===void 0?void 0:a.bed_preference:null,infant_nbr:((n=this.visibleInventory.selected_variation)===null||n===void 0?void 0:n.child_nbr)>0?(r=o.guest)===null||r===void 0?void 0:r.infant_nbr:null}]})}renderRate(){const{visibleInventory:t}=this;if(!t)return"";if(t.is_amount_modified){return t.rp_amount.toString()}const{selected_variation:e,view_mode:i}=t;const s=i==="001"?e===null||e===void 0?void 0:e.discounted_amount:e===null||e===void 0?void 0:e.amount_per_night_gross;return(s===null||s===void 0?void 0:s.toString())||""}formatVariation(t){var e,i,s,a;if(!t)return"";const n=`${t.adult_nbr} ${t.adult_nbr===1?(e=y.entries["Lcz_Adult"])===null||e===void 0?void 0:e.toLowerCase():(i=y.entries["Lcz_Adults"])===null||i===void 0?void 0:i.toLowerCase()}`;const o=t.child_nbr>0?`${t.child_nbr} ${t.child_nbr>1?(s=y.entries["Lcz_Children"])===null||s===void 0?void 0:s.toLowerCase():(a=y.entries["Lcz_Child"])===null||a===void 0?void 0:a.toLowerCase()}`:"";return o?`${n} ${o}`:n}getTooltipMessages(){var t,e,i,s,a;const{ratePlan:n,visibleInventory:o}=this;const r=o===null||o===void 0?void 0:o.selected_variation;if(!r)return;const l=(t=n.variations)===null||t===void 0?void 0:t.find((t=>this.formatVariation(t)===this.formatVariation(r)));if(!l)return;const c=(i=(e=l.applicable_policies)===null||e===void 0?void 0:e.find((t=>t.type==="cancelation")))===null||i===void 0?void 0:i.combined_statement;const d=(a=(s=l.applicable_policies)===null||s===void 0?void 0:s.find((t=>t.type==="guarantee")))===null||a===void 0?void 0:a.combined_statement;let h="";if(c){h+=`<b><u>Cancellation:</u></b> ${c}<br/>`}if(d){h+=`<b><u>Guarantee:</u></b> ${d}`}return h||undefined}async handleVariationChange(t){const{ratePlan:e,roomTypeId:i}=this;const s=e.variations||[];const a=s.find((e=>this.formatVariation(e)===t));if(!a)return;f({params:{selected_variation:a},ratePlanId:e.id,roomTypeId:i})}render(){var t,s,n;const{ratePlan:o,bookingType:r,currency:l,ratePricingMode:c,visibleInventory:h}=this;const u=o.is_available_to_book;const f=this.disableForm();const p=h===null||h===void 0?void 0:h.selected_variation;const b=(t=o.variations)===null||t===void 0?void 0:t.map((t=>this.formatVariation(t)));return e(i,{key:"06a1d30eef1b33a27e338eefac3884a75669483e","data-testid":`rp-${this.ratePlan.id}`},e("div",{key:"0e4dfecafc095d47ffac857a162aa63769555c9b",class:`d-flex mt-1  p-0 ${u?"flex-column flex-lg-row align-items-lg-center justify-content-lg-between":"align-items-center justify-content-between"}`},e("div",{key:"289b94f81f5ccfda09bd8cb94013c1a40dbfcaee","data-testid":"rp_name",class:"rateplan-name-container m-0 p-0  d-flex align-items-center",style:{gap:"0.5rem"}},r==="BAR_BOOKING"?e("p",{class:"m-0 p-0"},e("span",null,o.name.split("/")[1]," ",o.is_non_refundable&&e("span",{class:"non-ref-span"},"Non Refundable"))):e("span",null,o.short_name," ",o.is_non_refundable&&e("span",{class:"non-ref-span"},"Non Refundable")),u&&e("ir-tooltip",{key:"1aa40e019187b0e999679b041c6f8cd8818bdb7e",message:this.getTooltipMessages()})),u?e("div",{class:"d-md-flex m-md-0  justify-content-md-end align-items-md-center flex-fill rateplan-container"},e("div",{class:"flex-fill max-w-300 flex-grow-1"},e("fieldset",{class:"position-relative flex-grow-1 w-100"},e("select",{disabled:f,"data-testid":"adult-child-offering",class:"form-control input-sm flex-grow-1 w-100",id:ht(),onChange:t=>this.handleDataChange("adult_child_offering",t)},b===null||b===void 0?void 0:b.map((t=>e("option",{value:t,selected:this.formatVariation(p)===t},t)))))),e("div",{class:"m-0 p-0 mt-1 mt-md-0 d-flex justify-content-between align-items-md-center ml-md-1"},e("div",{class:"d-flex m-0 p-0 rate-total-night-view mt-0 flex-grow-1"},e("ir-price-input",{testId:"amount_input",disabled:f,onTextChange:t=>this.updateRateplanSelection({is_amount_modified:true,rp_amount:Number(t.detail)}),"aria-label":`${(n=(s=this.visibleInventory)===null||s===void 0?void 0:s.roomtype)===null||n===void 0?void 0:n.name} ${this.ratePlan.short_name}'s rate`,"aria-describedby":`${this.ratePlan.short_name}'s rate`,class:"ir-br-input-none price-amount w-100 flex-grow-1",currency:l.symbol,value:this.renderRate(),placeholder:y.entries.Lcz_Rate||"Rate"}),e("fieldset",{class:"position-relative m-0 total-nights-container p-0"},e("select",{"data-testid":"nigh_stay_select",disabled:f,class:"form-control input-sm m-0 nightBorder rounded-0 py-0",id:ht(),onChange:t=>this.updateRateplanSelection({view_mode:t.target.value})},c.map((t=>e("option",{value:t.CODE_NAME,selected:(h===null||h===void 0?void 0:h.view_mode)===t.CODE_NAME},t.CODE_VALUE_EN)))))),(r==="PLUS_BOOKING"||r==="ADD_ROOM")&&e("div",{class:"flex-fill mt-0 ml-1 m-0 mt-md-0 p-0"},e("fieldset",{class:"position-relative"},e("select",{"data-testid":"inventory_select",disabled:h.visibleInventory===0,class:"form-control input-sm",id:ht(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:(h.visibleInventory||0)+1},((t,e)=>e)).map((t=>e("option",{value:t,selected:h.reserved===t},t))))))),r==="EDIT_BOOKING"&&e(a,null,e("div",{class:"m-0 p-0 ml-md-1 mt-md-0 d-none d-md-block"},e("fieldset",{class:"position-relative"},e("input",{"data-testid":"inventory_radio",disabled:f,type:"radio",name:"ratePlanGroup",value:"1",onChange:()=>{d();this.reserveRoom()},checked:h.reserved===1}))),e("button",{"data-testid":"book_property",disabled:f,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1 mt-1 d-md-none",onClick:()=>{d();this.reserveRoom();this.bookProperty()}},h.reserved===1?y.entries.Lcz_Current:y.entries.Lcz_Select)),(r==="BAR_BOOKING"||r==="SPLIT_BOOKING")&&e("button",{"data-testid":"book",disabled:f||r==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-md-0 btn-sm ml-md-1 mt-1",onClick:()=>this.bookProperty()},y.entries.Lcz_Book)):e("p",{class:"text-danger m-0 p-0"},y.entries["Lcz_NotAvailable"]||"Not available")))}};Je.style=Xe;const Qe=".sc-igl-room-type-h{display:block}.margin-bottom-8.sc-igl-room-type{margin-bottom:8px !important}";const Ze=Qe;const ti=class{constructor(e){t(this,e);this.dataUpdateEvent=s(this,"dataUpdateEvent",7);this.bookingType="PLUS_BOOKING";this.ratePricingMode=[];this.roomInfoId=null;this.selectedRooms=[];this.roomsDistributions=[];this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"]}render(){var t,s;const a=this.validBookingTypes.includes(this.bookingType);return e(i,{key:"049461fe1d079f056f3ac1aaf76e0b415f45386e"},a&&((t=this.roomType.rateplans)===null||t===void 0?void 0:t.length)>0&&e("div",{key:"c45bc2cf0078464274876af9904340e7a507bb78",class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomType.name),(s=this.roomType.rateplans)===null||s===void 0?void 0:s.map((t=>{if(!!t.variations){let i=this.roomInfoId&&this.roomInfoId===this.roomType.id;const s=p(this.roomType.id,t.id);return e("igl-rate-plan",{isBookDisabled:this.isBookDisabled,visibleInventory:s,key:`rate-plan-${t.id}`,ratePricingMode:this.ratePricingMode,class:a?"":"",currency:this.currency,ratePlan:t,roomTypeId:this.roomType.id,bookingType:this.bookingType,shouldBeDisabled:i})}return null})))}};ti.style=Ze;const ei=".sc-igl-tba-booking-view-h{display:block}.guestTitle.sc-igl-tba-booking-view{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:2px;margin-bottom:5px;margin-top:5px;padding-left:5px;padding-right:5px}.guestTitle.selectedOrder.sc-igl-tba-booking-view{background-color:#f9f9c9}.pointer.sc-igl-tba-booking-view{cursor:pointer}hr.sc-igl-tba-booking-view{margin-top:8px;margin-bottom:0px}.bookingContainer.sc-igl-tba-booking-view{background-color:#ececec}.actionsContainer.sc-igl-tba-booking-view{display:flex;align-items:center;padding:5px !important;width:100%;gap:16px}.room-select.sc-igl-tba-booking-view{flex:1}.selectContainer.sc-igl-tba-booking-view{width:195px;margin-right:8px}.buttonsContainer.sc-igl-tba-booking-view{box-sizing:border-box;display:flex;align-items:center;justify-content:flex-end;padding:0;margin:0;gap:0.5rem}";const ii=ei;const si=class{constructor(e){t(this,e);this.highlightToBeAssignedBookingEvent=s(this,"highlightToBeAssignedBookingEvent",7);this.openCalendarSidebar=s(this,"openCalendarSidebar",7);this.addToBeAssignedEvent=s(this,"addToBeAssignedEvent",7);this.scrollPageToRoom=s(this,"scrollPageToRoom",7);this.assignRoomEvent=s(this,"assignRoomEvent",7);this.eventData={};this.categoriesData={};this.renderAgain=false;this.selectedRoom=-1;this.isLoading=null;this.highlightSection=false;this.allRoomsList=[];this.toBeAssignedService=new Ye}componentShouldUpdate(t,e,i){if(i==="selectedDate"&&t!==e){this.highlightSection=false;this.selectedRoom=-1;return true}else if(i==="eventData"&&t!==e){this.selectedRoom=-1;return true}return true}componentWillLoad(){if(this.categoryIndex===0&&this.eventIndex===0){setTimeout((()=>{this.handleHighlightAvailability()}),100)}}highlightBookingEvent(t){let e=t.detail.data;if(e.bookingId!=this.eventData.ID){this.highlightSection=false;this.selectedRoom=-1;this.renderView()}else{this.highlightSection=true;this.renderView()}}onSelectRoom(t){if(t.stopImmediatePropagation){t.stopImmediatePropagation();t.stopPropagation()}this.selectedRoom=parseInt(t.target.value)}async handleAssignUnit(t,e=false){var i,s;try{t.stopImmediatePropagation();t.stopPropagation();if(this.selectedRoom){this.isLoading=e?"checkin":"default";const t=await this.toBeAssignedService.assignUnit({booking_nbr:this.eventData.BOOKING_NUMBER,identifier:this.eventData.ID,pr_id:this.selectedRoom,check_in:e});const a=t.rooms.find((t=>t.identifier===this.eventData.identifier));console.log("room=>",a);if(a){const{adult_nbr:t,children_nbr:e,infant_nbr:n}=a.occupancy;window.dispatchEvent(new CustomEvent("openCalendarSidebar",{detail:{type:"room-guests",payload:{identifier:this.eventData.ID,bookingNumber:this.eventData.BOOKING_NUMBER,checkin:false,roomName:(s=(i=a.unit)===null||i===void 0?void 0:i.name)!==null&&s!==void 0?s:"",sharing_persons:a.sharing_persons,totalGuests:t+e+n}},bubbles:true,composed:true}));console.log("event emitted directly to window ")}let n=Object.assign(Object.assign({},this.eventData),{PR_ID:this.selectedRoom});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[n]});this.assignRoomEvent.emit({key:"assignRoom",data:n})}}catch(t){console.log(t)}finally{this.isLoading=null}}handleHighlightAvailability(){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:this.eventData.ID,fromDate:this.eventData.FROM_DATE}});if(!this.selectedDate){return}let t=[];let e=[];t=this.eventData.availableRooms.map((t=>{e.push({calendar_cell:null,id:t.PR_ID,name:t.roomName});return Object.assign(Object.assign({},t),{defaultDateRange:this.eventData.defaultDateRange,identifier:this.eventData.identifier})}));this.allRoomsList=e;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:t});this.scrollPageToRoom.emit({key:"scrollPageToRoom",id:this.categoryId,refClass:"category_"+this.categoryId});this.renderView()}handleCloseAssignment(t){t.stopImmediatePropagation();t.stopPropagation();this.highlightSection=false;this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.onSelectRoom({target:{value:""}});this.selectedRoom=-1;this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.renderView()}renderView(){this.renderAgain=!this.renderAgain}canCheckIn(){return I({from_date:this.eventData.FROM_DATE,to_date:this.eventData.TO_DATE})}render(){return e(i,{key:"047379d897c4355bd25077a582bba846993c9c93"},e("div",{key:"2af544830f1ec85929c0ed9f01e5a7d32169cf89",class:"bookingContainer",onClick:()=>this.handleHighlightAvailability()},e("div",{key:"62572a2ea06da013689ecac8b105c6de1c56b08a",class:`guestTitle ${this.highlightSection?"selectedOrder":""} pointer font-small-3`,"data-toggle":"tooltip","data-placement":"top","data-original-title":"Click to assign unit"},`Book# ${this.eventData.BOOKING_NUMBER} - ${this.eventData.NAME}`),e("div",{key:"ae0f4fa6ac8684da787da7e7e92788805970f48a",class:"row m-0 p-0 actionsContainer"},e("select",{key:"fd37e8e8a20bce91647beb2d6be9858a7af7076f",class:"form-control input-sm room-select flex-grow-1",id:ht(),onChange:t=>this.onSelectRoom(t)},e("option",{key:"51a5c0a81b466cb99dc02399a4fdc3dcabe8eb31",value:"",selected:this.selectedRoom==-1},y.entries.Lcz_AssignUnit),this.allRoomsList.map((t=>e("option",{value:t.id,selected:this.selectedRoom==t.id},t.name)))),this.highlightSection?e("div",{class:"buttonsContainer bg-red"},e("button",{type:"button",class:"btn btn-secondary btn-sm mx-0",onClick:t=>this.handleCloseAssignment(t)},e("svg",{class:"m-0 p-0",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"9",viewBox:"0 0 384 512"},e("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})))):null),e("div",{key:"df3aaba739d310a923e836022f4e5505e9ac24a4",class:"d-flex align-items-center ",style:{gap:"0.5rem",paddingInline:"5px"}},e("ir-button",{key:"291057451e6dc0e2e727d549aa5a775fd49b9d23",isLoading:this.isLoading==="default",size:"sm",class:"flex-grow-1",text:y.entries.Lcz_Assign,onClickHandler:t=>this.handleAssignUnit(t),btn_disabled:this.selectedRoom===-1}),this.canCheckIn()&&e("ir-button",{key:"0cdae31ac3b7a2d26b70f3bb8c45f28e40ae07d2",isLoading:this.isLoading==="checkin",size:"sm",class:"flex-grow-1",text:y.entries.Lcz_AssignedAndChecIn,onClickHandler:t=>this.handleAssignUnit(t,true),btn_disabled:this.selectedRoom===-1})),e("hr",{key:"90b834774f93f77628f0962a2e2ce748e776b196"})))}};si.style=ii;const ai=".sc-igl-tba-category-view-h{display:block}";const ni=ai;const oi=class{constructor(e){t(this,e);this.assignUnitEvent=s(this,"assignUnitEvent",7);this.categoriesData={};this.renderAgain=false}handleAssignRoomEvent(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.eventDatas=this.eventDatas.filter((t=>t.ID!=e.data.ID));this.calendarData.bookingEvents.push(e.data);this.assignUnitEvent.emit({key:"assignUnit",data:{RT_ID:this.categoryId,selectedDate:this.selectedDate,assignEvent:e.data,calendarData:this.calendarData}});this.renderView()}getEventView(t,i){return i.map(((i,s)=>e("igl-tba-booking-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,eventData:i,categoriesData:this.categoriesData,categoryId:t,categoryIndex:this.categoryIndex,eventIndex:s,onAssignRoomEvent:t=>this.handleAssignRoomEvent(t)})))}renderView(){this.renderAgain=!this.renderAgain}render(){var t;return e(i,{key:"0e0cfef2bd6f867b9a9a1f63215cde5562b75be5"},e("div",{key:"f0eaaae3a6396dc7b53b97f0487d4c95f5f9c0e8",class:"sectionContainer"},e("div",{key:"bbe392a7be1fd9741298ce1f5b99d4f83d62addc",class:"font-weight-bold mt-1 font-small-3"},(t=this.categoriesData[this.categoryId])===null||t===void 0?void 0:t.name),this.getEventView(this.categoryId,this.eventDatas)))}};oi.style=ni;const ri=".sc-igl-to-be-assigned-h{display:block}.custom-dropdown.sc-igl-to-be-assigned{cursor:pointer;padding:5px 10px;width:min-content;margin-left:auto;margin-right:auto}.dropdown-toggle.sc-igl-to-be-assigned{all:unset;display:flex;width:max-content;align-items:center;gap:10px}.close_btn_style.sc-igl-to-be-assigned{padding:0.4rem}.close_btn_style.sc-igl-to-be-assigned:hover{background-color:#f6f6f6}.dropdown-menu.sc-igl-to-be-assigned{max-height:250px;overflow-y:auto}.tobeAssignedHeader.sc-igl-to-be-assigned{font-weight:500;letter-spacing:0.05rem;font-size:1.12rem;padding:0;margin:0}.assignment_header.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:space-between;padding-top:5px;margin-bottom:1rem}.dropdown-toggle.sc-igl-to-be-assigned::after{content:none;display:none}.dropdown-toggle.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transition:transform 0.2s ease}.show.sc-igl-to-be-assigned .caret-icon.sc-igl-to-be-assigned{transform:rotate(-180deg)}.stickyHeader.sc-igl-to-be-assigned{position:-webkit-sticky;position:sticky;top:0;background-color:#ffffff;z-index:1}.pointer.sc-igl-to-be-assigned{cursor:pointer}.dots.sc-igl-to-be-assigned{display:flex;align-items:center;justify-content:center;margin:0 3px;padding:0}.dot.sc-igl-to-be-assigned{width:5px;height:5px;margin:5px 4px 0;background-color:#6b6f82;border-radius:50%;animation:dotFlashing 1s infinite linear alternate}.dot.sc-igl-to-be-assigned:nth-child(2){animation-delay:0.2s}.dot.sc-igl-to-be-assigned:nth-child(3){animation-delay:0.4s}@keyframes dotFlashing{0%{opacity:0}50%,100%{opacity:1}}";const li=ri;const ci=class{constructor(e){t(this,e);this.optionEvent=s(this,"optionEvent",7);this.reduceAvailableUnitEvent=s(this,"reduceAvailableUnitEvent",7);this.showBookingPopup=s(this,"showBookingPopup",7);this.addToBeAssignedEvent=s(this,"addToBeAssignedEvent",7);this.highlightToBeAssignedBookingEvent=s(this,"highlightToBeAssignedBookingEvent",7);this.showDatesList=false;this.renderAgain=false;this.orderedDatesList=[];this.noScroll=false;this.isGotoToBeAssignedDate=false;this.isLoading=true;this.selectedDate=null;this.data={};this.today=new Date;this.categoriesData={};this.toBeAssignedService=new Ye}componentWillLoad(){this.reArrangeData();this.loadingMessage=y.entries.Lcz_FetchingUnAssignedUnits}handleUnassignedDatesToBeAssignedChange(t){const{fromDate:e,toDate:i,data:s}=t;let a=new Date(e);a.setHours(0);a.setMinutes(0);a.setSeconds(0);let n=a.getTime();while(n<=new Date(i).getTime()){if(s&&!s[n]&&this.unassignedDates.hasOwnProperty(n)){delete this.unassignedDates[n]}else if(s&&s[n]){this.unassignedDates[n]=s[n]}n=D(n).add(1,"days").toDate().getTime()}this.data=Object.assign({},this.unassignedDates);this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(this.orderedDatesList.length){if(!this.data.hasOwnProperty(this.selectedDate)){this.selectedDate=this.orderedDatesList.length?this.orderedDatesList[0]:null}this.showForDate(this.selectedDate,false);this.renderView()}else{this.selectedDate=null}}handleAssignUnit(t){var e,i,s,a,n;const o=t.detail;const r=o.data;t.stopImmediatePropagation();t.stopPropagation();if((o===null||o===void 0?void 0:o.key)==="assignUnit"&&this.data){if((r===null||r===void 0?void 0:r.selectedDate)&&this.data[r.selectedDate]){if(((e=this.data[r.selectedDate])===null||e===void 0?void 0:e.categories)&&((s=Object.keys(((i=this.data[r.selectedDate])===null||i===void 0?void 0:i.categories)||{}))===null||s===void 0?void 0:s.length)===1){this.isLoading=true;this.noScroll=true}if((r===null||r===void 0?void 0:r.RT_ID)&&((a=this.data[r.selectedDate])===null||a===void 0?void 0:a.categories)&&this.data[r.selectedDate].categories[r.RT_ID]&&Array.isArray(this.data[r.selectedDate].categories[r.RT_ID])&&((n=r===null||r===void 0?void 0:r.assignEvent)===null||n===void 0?void 0:n.ID)){this.data[r.selectedDate].categories[r.RT_ID]=this.data[r.selectedDate].categories[r.RT_ID].filter((t=>t&&t.ID!==r.assignEvent.ID))}if(r===null||r===void 0?void 0:r.calendarData){this.calendarData=r.calendarData}this.renderView()}}}async updateCategories(t,e){try{let i={};const s=await this.toBeAssignedService.getUnassignedRooms({from_date:e.from_date,to_date:e.to_date},this.propertyid,E(new Date(+t)),e.roomsInfo,e.formattedLegendData);s.forEach((t=>{if(!i.hasOwnProperty(t.RT_ID)){i[t.RT_ID]=[t]}else{i[t.RT_ID].push(t)}}));this.unassignedDates[t].categories=i}catch(t){}}async reArrangeData(){try{this.today.setHours(0,0,0,0);this.calendarData.roomsInfo.forEach((t=>{this.categoriesData[t.id]={name:t.name,roomsList:t.physicalrooms,roomIds:t.physicalrooms.map((t=>t.id))}}));this.selectedDate=null;this.unassignedDates=Ie();console.log(this.unassignedDates);this.data=this.unassignedDates;this.orderedDatesList=Object.keys(this.data).sort(((t,e)=>parseInt(t)-parseInt(e)));if(!this.selectedDate&&this.orderedDatesList.length){this.selectedDate=this.orderedDatesList[0]}}catch(t){console.error("Error fetching unassigned dates:",t)}}async componentDidLoad(){setTimeout((()=>{if(!this.isGotoToBeAssignedDate&&Object.keys(this.unassignedDates).length>0){const t=Object.keys(this.unassignedDates)[0];this.showForDate(t)}}),100)}async gotoDate(t){this.isGotoToBeAssignedDate=true;this.showForDate(t.detail.data);this.showDatesList=false;this.renderView()}handleToBeAssignedDate(t){this.showBookingPopup.emit({key:"calendar",data:new Date(t.detail.data.fromDate).getTime()-864e5,noScroll:false})}async showForDate(t,e=true){try{if(e){this.isLoading=true}if(this.showDatesList){this.showUnassignedDate()}await this.updateCategories(t,this.calendarData);this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.showBookingPopup.emit({key:"calendar",data:parseInt(t)-864e5,noScroll:this.noScroll});if(this.isGotoToBeAssignedDate){this.isGotoToBeAssignedDate=false}this.isLoading=false;this.selectedDate=t;this.renderView()}catch(t){}}getDay(t){const e=new Date(t);const i="default";const s=this.getLocalizedDayOfWeek(e,i);return s+" "+e.getDate()+", "+e.getFullYear()}getLocalizedDayOfWeek(t,e){const i={weekday:"short"};return t.toLocaleDateString(e,i)}handleOptionEvent(t,e=""){this.highlightToBeAssignedBookingEvent.emit({key:"highlightBookingId",data:{bookingId:"----"}});this.addToBeAssignedEvent.emit({key:"tobeAssignedEvents",data:[]});this.optionEvent.emit({key:t,data:e})}showUnassignedDate(){this.showDatesList=!this.showDatesList}getToBeAssignedEntities(){}getCategoryView(){if(this.orderedDatesList.length&&this.selectedDate&&this.data[this.selectedDate]){return Object.entries(this.data[this.selectedDate].categories).map((([t,i],s)=>e("igl-tba-category-view",{calendarData:this.calendarData,selectedDate:this.selectedDate,categoryId:t,categoryIndex:s,categoriesData:this.categoriesData,eventDatas:i,onAssignUnitEvent:t=>this.handleAssignUnit(t)})))}else{return null}}renderView(){this.renderAgain=!this.renderAgain}render(){var t;return e(i,{key:"3c51bb30e4bca1731eef0bac1edf94bf28045fdc",class:"tobeAssignedContainer pr-1 text-left"},e("div",{key:"a606cfeeab38f39d70be8339f79da06c67152834"},e("div",{key:"dc7e173a92a5c89eef6a3ef38cae4f5b3555b039"},e("div",{key:"35b3a81d1f6cae1114df2ffd1e0749c7749d70ef",class:"stickyHeader pt-1"},e("div",{key:"57e38b23e873bca338ebb60ff19610480a1743d8",class:"assignment_header"},e("p",{key:"3660b445986757322d92e1ae68a1efc1cb508c78",class:"tobeAssignedHeader "},y.entries.Lcz_Assignments),e("ir-button",{key:"eaa86da7fc8f8239282a3fd38a6fa0f4cea5d0d0",class:"close_btn",variant:"icon",btn_styles:"close_btn_style",icon_name:"double_caret_left",style:wt.secondary,onClickHandler:()=>this.handleOptionEvent("closeSideMenu"),visibleBackgroundOnHover:true})),e("hr",{key:"4bad2f6658e2a0e2562ee798708ba2e312581f65"}),Object.keys(this.data).length===0?e("p",null,y.entries.Lcz_AllBookingsAreAssigned):this.isLoading?e("p",{class:"d-flex align-items-center"},e("span",{class:"p-0"},this.loadingMessage),e("div",{class:"dots"},e("div",{class:"dot"}),e("div",{class:"dot"}),e("div",{class:"dot"}))):e(a,null,this.orderedDatesList.length?e("div",{class:`custom-dropdown border border-light rounded text-center `+(this.showDatesList?"show":""),id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},e("div",{class:"dropdown-toggle"},e("span",{class:"font-weight-bold"},this.data[this.selectedDate].dateStr),e("svg",{class:"caret-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},e("path",{fill:"#6b6f82",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),e("div",{class:"dropdown-menu dropdown-menu-right full-width","aria-labelledby":"dropdownMenuButton"},(t=this.orderedDatesList)===null||t===void 0?void 0:t.map((t=>e("div",{class:"dropdown-item pointer",onClick:()=>this.showForDate(t)},this.data[t].dateStr))))):y.entries.Lcz_AllBookingsAreAssigned)),!this.isLoading&&e("div",{key:"ebcb7ad89ea78ad40a4d02eb97df9ab0e9c35a31",class:"scrollabledArea"},this.orderedDatesList.length?Object.keys(this.data[this.selectedDate].categories).length?this.getCategoryView():e("div",{class:"mt-1"},y.entries.Lcz_AllAssignForThisDay):null))))}static get watchers(){return{unassignedDatesProp:["handleUnassignedDatesToBeAssignedChange"]}}};ci.style=li;const di=Object.create(null);di["open"]="0";di["close"]="1";di["ping"]="2";di["pong"]="3";di["message"]="4";di["upgrade"]="5";di["noop"]="6";const hi=Object.create(null);Object.keys(di).forEach((t=>{hi[di[t]]=t}));const ui={type:"error",data:"parser error"};const fi=typeof Blob==="function"||typeof Blob!=="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]";const pi=typeof ArrayBuffer==="function";const bi=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer;const gi=({type:t,data:e},i,s)=>{if(fi&&e instanceof Blob){if(i){return s(e)}else{return mi(e,s)}}else if(pi&&(e instanceof ArrayBuffer||bi(e))){if(i){return s(e)}else{return mi(new Blob([e]),s)}}return s(di[t]+(e||""))};const mi=(t,e)=>{const i=new FileReader;i.onload=function(){const t=i.result.split(",")[1];e("b"+(t||""))};return i.readAsDataURL(t)};function vi(t){if(t instanceof Uint8Array){return t}else if(t instanceof ArrayBuffer){return new Uint8Array(t)}else{return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}}let yi;function ki(t,e){if(fi&&t.data instanceof Blob){return t.data.arrayBuffer().then(vi).then(e)}else if(pi&&(t.data instanceof ArrayBuffer||bi(t.data))){return e(vi(t.data))}gi(t,false,(t=>{if(!yi){yi=new TextEncoder}e(yi.encode(t))}))}const wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const xi=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(let t=0;t<wi.length;t++){xi[wi.charCodeAt(t)]=t}const _i=t=>{let e=t.length*.75,i=t.length,s,a=0,n,o,r,l;if(t[t.length-1]==="="){e--;if(t[t.length-2]==="="){e--}}const c=new ArrayBuffer(e),d=new Uint8Array(c);for(s=0;s<i;s+=4){n=xi[t.charCodeAt(s)];o=xi[t.charCodeAt(s+1)];r=xi[t.charCodeAt(s+2)];l=xi[t.charCodeAt(s+3)];d[a++]=n<<2|o>>4;d[a++]=(o&15)<<4|r>>2;d[a++]=(r&3)<<6|l&63}return c};const Di=typeof ArrayBuffer==="function";const Ci=(t,e)=>{if(typeof t!=="string"){return{type:"message",data:Mi(t,e)}}const i=t.charAt(0);if(i==="b"){return{type:"message",data:Oi(t.substring(1),e)}}const s=hi[i];if(!s){return ui}return t.length>1?{type:hi[i],data:t.substring(1)}:{type:hi[i]}};const Oi=(t,e)=>{if(Di){const i=_i(t);return Mi(i,e)}else{return{base64:true,data:t}}};const Mi=(t,e)=>{switch(e){case"blob":if(t instanceof Blob){return t}else{return new Blob([t])}case"arraybuffer":default:if(t instanceof ArrayBuffer){return t}else{return t.buffer}}};const Ei=String.fromCharCode(30);const Yi=(t,e)=>{const i=t.length;const s=new Array(i);let a=0;t.forEach(((t,n)=>{gi(t,false,(t=>{s[n]=t;if(++a===i){e(s.join(Ei))}}))}))};const Ai=(t,e)=>{const i=t.split(Ei);const s=[];for(let t=0;t<i.length;t++){const a=Ci(i[t],e);s.push(a);if(a.type==="error"){break}}return s};function Ti(){return new TransformStream({transform(t,e){ki(t,(i=>{const s=i.length;let a;if(s<126){a=new Uint8Array(1);new DataView(a.buffer).setUint8(0,s)}else if(s<65536){a=new Uint8Array(3);const t=new DataView(a.buffer);t.setUint8(0,126);t.setUint16(1,s)}else{a=new Uint8Array(9);const t=new DataView(a.buffer);t.setUint8(0,127);t.setBigUint64(1,BigInt(s))}if(t.data&&typeof t.data!=="string"){a[0]|=128}e.enqueue(a);e.enqueue(i)}))}})}let Si;function Bi(t){return t.reduce(((t,e)=>t+e.length),0)}function Ii(t,e){if(t[0].length===e){return t.shift()}const i=new Uint8Array(e);let s=0;for(let a=0;a<e;a++){i[a]=t[0][s++];if(s===t[0].length){t.shift();s=0}}if(t.length&&s<t[0].length){t[0]=t[0].slice(s)}return i}function ji(t,e){if(!Si){Si=new TextDecoder}const i=[];let s=0;let a=-1;let n=false;return new TransformStream({transform(o,r){i.push(o);while(true){if(s===0){if(Bi(i)<1){break}const t=Ii(i,1);n=(t[0]&128)===128;a=t[0]&127;if(a<126){s=3}else if(a===126){s=1}else{s=2}}else if(s===1){if(Bi(i)<2){break}const t=Ii(i,2);a=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0);s=3}else if(s===2){if(Bi(i)<8){break}const t=Ii(i,8);const e=new DataView(t.buffer,t.byteOffset,t.length);const n=e.getUint32(0);if(n>Math.pow(2,53-32)-1){r.enqueue(ui);break}a=n*Math.pow(2,32)+e.getUint32(4);s=3}else{if(Bi(i)<a){break}const t=Ii(i,a);r.enqueue(Ci(n?t:Si.decode(t),e));s=0}if(a===0||a>t){r.enqueue(ui);break}}}})}const zi=4;function Ni(t){if(t)return Ri(t)}function Ri(t){for(var e in Ni.prototype){t[e]=Ni.prototype[e]}return t}Ni.prototype.on=Ni.prototype.addEventListener=function(t,e){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e);return this};Ni.prototype.once=function(t,e){function i(){this.off(t,i);e.apply(this,arguments)}i.fn=e;this.on(t,i);return this};Ni.prototype.off=Ni.prototype.removeListener=Ni.prototype.removeAllListeners=Ni.prototype.removeEventListener=function(t,e){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var s;for(var a=0;a<i.length;a++){s=i[a];if(s===e||s.fn===e){i.splice(a,1);break}}if(i.length===0){delete this._callbacks["$"+t]}return this};Ni.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=new Array(arguments.length-1),i=this._callbacks["$"+t];for(var s=1;s<arguments.length;s++){e[s-1]=arguments[s]}if(i){i=i.slice(0);for(var s=0,a=i.length;s<a;++s){i[s].apply(this,e)}}return this};Ni.prototype.emitReserved=Ni.prototype.emit;Ni.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};Ni.prototype.hasListeners=function(t){return!!this.listeners(t).length};const $i=(()=>{const t=typeof Promise==="function"&&typeof Promise.resolve==="function";if(t){return t=>Promise.resolve().then(t)}else{return(t,e)=>e(t,0)}})();const Fi=(()=>{if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else{return Function("return this")()}})();const Li="arraybuffer";function Pi(){}function Hi(t,...e){return e.reduce(((e,i)=>{if(t.hasOwnProperty(i)){e[i]=t[i]}return e}),{})}const Ui=Fi.setTimeout;const Vi=Fi.clearTimeout;function Gi(t,e){if(e.useNativeTimers){t.setTimeoutFn=Ui.bind(Fi);t.clearTimeoutFn=Vi.bind(Fi)}else{t.setTimeoutFn=Fi.setTimeout.bind(Fi);t.clearTimeoutFn=Fi.clearTimeout.bind(Fi)}}const Ki=1.33;function Wi(t){if(typeof t==="string"){return qi(t)}return Math.ceil((t.byteLength||t.size)*Ki)}function qi(t){let e=0,i=0;for(let s=0,a=t.length;s<a;s++){e=t.charCodeAt(s);if(e<128){i+=1}else if(e<2048){i+=2}else if(e<55296||e>=57344){i+=3}else{s++;i+=4}}return i}function Xi(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ji(t){let e="";for(let i in t){if(t.hasOwnProperty(i)){if(e.length)e+="&";e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i])}}return e}function Qi(t){let e={};let i=t.split("&");for(let t=0,s=i.length;t<s;t++){let s=i[t].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class Zi extends Error{constructor(t,e,i){super(t);this.description=e;this.context=i;this.type="TransportError"}}class ts extends Ni{constructor(t){super();this.writable=false;Gi(this,t);this.opts=t;this.query=t.query;this.socket=t.socket;this.supportsBinary=!t.forceBase64}onError(t,e,i){super.emitReserved("error",new Zi(t,e,i));return this}open(){this.readyState="opening";this.doOpen();return this}close(){if(this.readyState==="opening"||this.readyState==="open"){this.doClose();this.onClose()}return this}send(t){if(this.readyState==="open"){this.write(t)}}onOpen(){this.readyState="open";this.writable=true;super.emitReserved("open")}onData(t){const e=Ci(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed";super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){if(this.opts.port&&(this.opts.secure&&Number(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)){return":"+this.opts.port}else{return""}}_query(t){const e=Ji(t);return e.length?"?"+e:""}}class es extends ts{constructor(){super(...arguments);this._polling=false}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused";t()};if(this._polling||!this.writable){let t=0;if(this._polling){t++;this.once("pollComplete",(function(){--t||e()}))}if(!this.writable){t++;this.once("drain",(function(){--t||e()}))}}else{e()}}_poll(){this._polling=true;this.doPoll();this.emitReserved("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&t.type==="open"){this.onOpen()}if("close"===t.type){this.onClose({description:"transport closed by the server"});return false}this.onPacket(t)};Ai(t,this.socket.binaryType).forEach(e);if("closed"!==this.readyState){this._polling=false;this.emitReserved("pollComplete");if("open"===this.readyState){this._poll()}}}doClose(){const t=()=>{this.write([{type:"close"}])};if("open"===this.readyState){t()}else{this.once("open",t)}}write(t){this.writable=false;Yi(t,(t=>{this.doWrite(t,(()=>{this.writable=true;this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http";const e=this.query||{};if(false!==this.opts.timestampRequests){e[this.opts.timestampParam]=Xi()}if(!this.supportsBinary&&!e.sid){e.b64=1}return this.createUri(t,e)}}let is=false;try{is=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const ss=is;function as(){}class ns extends es{constructor(t){super(t);if(typeof location!=="undefined"){const e="https:"===location.protocol;let i=location.port;if(!i){i=e?"443":"80"}this.xd=typeof location!=="undefined"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e);i.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this));t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)}));this.pollXhr=t}}class os extends Ni{constructor(t,e,i){super();this.createRequest=t;Gi(this,i);this._opts=i;this._method=i.method||"GET";this._uri=e;this._data=undefined!==i.data?i.data:null;this._create()}_create(){var t;const e=Hi(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(e);try{i.open(this._method,this._uri,true);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(true);for(let t in this._opts.extraHeaders){if(this._opts.extraHeaders.hasOwnProperty(t)){i.setRequestHeader(t,this._opts.extraHeaders[t])}}}}catch(t){}if("POST"===this._method){try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}}try{i.setRequestHeader("Accept","*/*")}catch(t){}(t=this._opts.cookieJar)===null||t===void 0?void 0:t.addCookies(i);if("withCredentials"in i){i.withCredentials=this._opts.withCredentials}if(this._opts.requestTimeout){i.timeout=this._opts.requestTimeout}i.onreadystatechange=()=>{var t;if(i.readyState===3){(t=this._opts.cookieJar)===null||t===void 0?void 0:t.parseCookies(i.getResponseHeader("set-cookie"))}if(4!==i.readyState)return;if(200===i.status||1223===i.status){this._onLoad()}else{this.setTimeoutFn((()=>{this._onError(typeof i.status==="number"?i.status:0)}),0)}};i.send(this._data)}catch(t){this.setTimeoutFn((()=>{this._onError(t)}),0);return}if(typeof document!=="undefined"){this._index=os.requestsCount++;os.requests[this._index]=this}}_onError(t){this.emitReserved("error",t,this._xhr);this._cleanup(true)}_cleanup(t){if("undefined"===typeof this._xhr||null===this._xhr){return}this._xhr.onreadystatechange=as;if(t){try{this._xhr.abort()}catch(t){}}if(typeof document!=="undefined"){delete os.requests[this._index]}this._xhr=null}_onLoad(){const t=this._xhr.responseText;if(t!==null){this.emitReserved("data",t);this.emitReserved("success");this._cleanup()}}abort(){this._cleanup()}}os.requestsCount=0;os.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",rs)}else if(typeof addEventListener==="function"){const t="onpagehide"in Fi?"pagehide":"unload";addEventListener(t,rs,false)}}function rs(){for(let t in os.requests){if(os.requests.hasOwnProperty(t)){os.requests[t].abort()}}}const ls=function(){const t=ds({xdomain:false});return t&&t.responseType!==null}();class cs extends ns{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=ls&&!e}request(t={}){Object.assign(t,{xd:this.xd},this.opts);return new os(ds,this.uri(),t)}}function ds(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||ss)){return new XMLHttpRequest}}catch(t){}if(!e){try{return new(Fi[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}const hs=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class us extends ts{get name(){return"websocket"}doOpen(){const t=this.uri();const e=this.opts.protocols;const i=hs?{}:Hi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders){i.headers=this.opts.extraHeaders}try{this.ws=this.createSocket(t,e,i)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType;this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref){this.ws._socket.unref()}this.onOpen()};this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t});this.ws.onmessage=t=>this.onData(t.data);this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;gi(i,this.supportsBinary,(t=>{try{this.doWrite(i,t)}catch(t){}if(s){$i((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){if(typeof this.ws!=="undefined"){this.ws.onerror=()=>{};this.ws.close();this.ws=null}}uri(){const t=this.opts.secure?"wss":"ws";const e=this.query||{};if(this.opts.timestampRequests){e[this.opts.timestampParam]=Xi()}if(!this.supportsBinary){e.b64=1}return this.createUri(t,e)}}const fs=Fi.WebSocket||Fi.MozWebSocket;class ps extends us{createSocket(t,e,i){return!hs?e?new fs(t,e):new fs(t):new fs(t,e,i)}doWrite(t,e){this.ws.send(e)}}class bs extends ts{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)}));this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((t=>{const e=ji(Number.MAX_SAFE_INTEGER,this.socket.binaryType);const i=t.readable.pipeThrough(e).getReader();const s=Ti();s.readable.pipeTo(t.writable);this._writer=s.writable.getWriter();const a=()=>{i.read().then((({done:t,value:e})=>{if(t){return}this.onPacket(e);a()})).catch((t=>{}))};a();const n={type:"open"};if(this.query.sid){n.data=`{"sid":"${this.query.sid}"}`}this._writer.write(n).then((()=>this.onOpen()))}))}))}write(t){this.writable=false;for(let e=0;e<t.length;e++){const i=t[e];const s=e===t.length-1;this._writer.write(i).then((()=>{if(s){$i((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){var t;(t=this._transport)===null||t===void 0?void 0:t.close()}}const gs={websocket:ps,webtransport:bs,polling:cs};const ms=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;const vs=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ys(t){if(t.length>8e3){throw"URI too long"}const e=t,i=t.indexOf("["),s=t.indexOf("]");if(i!=-1&&s!=-1){t=t.substring(0,i)+t.substring(i,s).replace(/:/g,";")+t.substring(s,t.length)}let a=ms.exec(t||""),n={},o=14;while(o--){n[vs[o]]=a[o]||""}if(i!=-1&&s!=-1){n.source=e;n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":");n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":");n.ipv6uri=true}n.pathNames=ks(n,n["path"]);n.queryKey=ws(n,n["query"]);return n}function ks(t,e){const i=/\/{2,9}/g,s=e.replace(i,"/").split("/");if(e.slice(0,1)=="/"||e.length===0){s.splice(0,1)}if(e.slice(-1)=="/"){s.splice(s.length-1,1)}return s}function ws(t,e){const i={};e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,s){if(e){i[e]=s}}));return i}const xs=typeof addEventListener==="function"&&typeof removeEventListener==="function";const _s=[];if(xs){addEventListener("offline",(()=>{_s.forEach((t=>t()))}),false)}class Ds extends Ni{constructor(t,e){super();this.binaryType=Li;this.writeBuffer=[];this._prevBufferLen=0;this._pingInterval=-1;this._pingTimeout=-1;this._maxPayload=-1;this._pingTimeoutTime=Infinity;if(t&&"object"===typeof t){e=t;t=null}if(t){const i=ys(t);e.hostname=i.host;e.secure=i.protocol==="https"||i.protocol==="wss";e.port=i.port;if(i.query)e.query=i.query}else if(e.host){e.hostname=ys(e.host).host}Gi(this,e);this.secure=null!=e.secure?e.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(e.hostname&&!e.port){e.port=this.secure?"443":"80"}this.hostname=e.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=e.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?"443":"80");this.transports=[];this._transportsByName={};e.transports.forEach((t=>{const e=t.prototype.name;this.transports.push(e);this._transportsByName[e]=t}));this.opts=Object.assign({path:"/engine.io",agent:false,withCredentials:false,upgrade:true,timestampParam:"t",rememberUpgrade:false,addTrailingSlash:true,rejectUnauthorized:true,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:false},e);this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":"");if(typeof this.opts.query==="string"){this.opts.query=Qi(this.opts.query)}if(xs){if(this.opts.closeOnBeforeunload){this._beforeunloadEventListener=()=>{if(this.transport){this.transport.removeAllListeners();this.transport.close()}};addEventListener("beforeunload",this._beforeunloadEventListener,false)}if(this.hostname!=="localhost"){this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})};_s.push(this._offlineEventListener)}}if(this.opts.withCredentials){this._cookieJar=Pi()}this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=zi;e.transport=t;if(this.id)e.sid=this.id;const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);return}const t=this.opts.rememberUpgrade&&Ds.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open();this.setTransport(e)}setTransport(t){if(this.transport){this.transport.removeAllListeners()}this.transport=t;t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(t=>this._onClose("transport close",t)))}onOpen(){this.readyState="open";Ds.priorWebsocketSuccess="websocket"===this.transport.name;this.emitReserved("open");this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.emitReserved("packet",t);this.emitReserved("heartbeat");switch(t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data;this._onError(e);break;case"message":this.emitReserved("data",t.data);this.emitReserved("message",t.data);break}}}onHandshake(t){this.emitReserved("handshake",t);this.id=t.sid;this.transport.query.sid=t.sid;this._pingInterval=t.pingInterval;this._pingTimeout=t.pingTimeout;this._maxPayload=t.maxPayload;this.onOpen();if("closed"===this.readyState)return;this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t;this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),t);if(this.opts.autoUnref){this._pingTimeoutTimer.unref()}}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen);this._prevBufferLen=0;if(0===this.writeBuffer.length){this.emitReserved("drain")}else{this.flush()}}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t);this._prevBufferLen=t.length;this.emitReserved("flush")}}_getWritablePackets(){const t=this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1;if(!t){return this.writeBuffer}let e=1;for(let t=0;t<this.writeBuffer.length;t++){const i=this.writeBuffer[t].data;if(i){e+=Wi(i)}if(t>0&&e>this._maxPayload){return this.writeBuffer.slice(0,t)}e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return true;const t=Date.now()>this._pingTimeoutTime;if(t){this._pingTimeoutTime=0;$i((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)}return t}write(t,e,i){this._sendPacket("message",t,e,i);return this}send(t,e,i){this._sendPacket("message",t,e,i);return this}_sendPacket(t,e,i,s){if("function"===typeof e){s=e;e=undefined}if("function"===typeof i){s=i;i=null}if("closing"===this.readyState||"closed"===this.readyState){return}i=i||{};i.compress=false!==i.compress;const a={type:t,data:e,options:i};this.emitReserved("packetCreate",a);this.writeBuffer.push(a);if(s)this.once("flush",s);this.flush()}close(){const t=()=>{this._onClose("forced close");this.transport.close()};const e=()=>{this.off("upgrade",e);this.off("upgradeError",e);t()};const i=()=>{this.once("upgrade",e);this.once("upgradeError",e)};if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";if(this.writeBuffer.length){this.once("drain",(()=>{if(this.upgrading){i()}else{t()}}))}else if(this.upgrading){i()}else{t()}}return this}_onError(t){Ds.priorWebsocketSuccess=false;if(this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening"){this.transports.shift();return this._open()}this.emitReserved("error",t);this._onClose("transport error",t)}_onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.clearTimeoutFn(this._pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();if(xs){if(this._beforeunloadEventListener){removeEventListener("beforeunload",this._beforeunloadEventListener,false)}if(this._offlineEventListener){const t=_s.indexOf(this._offlineEventListener);if(t!==-1){_s.splice(t,1)}}}this.readyState="closed";this.id=null;this.emitReserved("close",t,e);this.writeBuffer=[];this._prevBufferLen=0}}}Ds.protocol=zi;class Cs extends Ds{constructor(){super(...arguments);this._upgrades=[]}onOpen(){super.onOpen();if("open"===this.readyState&&this.opts.upgrade){for(let t=0;t<this._upgrades.length;t++){this._probe(this._upgrades[t])}}}_probe(t){let e=this.createTransport(t);let i=false;Ds.priorWebsocketSuccess=false;const s=()=>{if(i)return;e.send([{type:"ping",data:"probe"}]);e.once("packet",(t=>{if(i)return;if("pong"===t.type&&"probe"===t.data){this.upgrading=true;this.emitReserved("upgrading",e);if(!e)return;Ds.priorWebsocketSuccess="websocket"===e.name;this.transport.pause((()=>{if(i)return;if("closed"===this.readyState)return;c();this.setTransport(e);e.send([{type:"upgrade"}]);this.emitReserved("upgrade",e);e=null;this.upgrading=false;this.flush()}))}else{const t=new Error("probe error");t.transport=e.name;this.emitReserved("upgradeError",t)}}))};function a(){if(i)return;i=true;c();e.close();e=null}const n=t=>{const i=new Error("probe error: "+t);i.transport=e.name;a();this.emitReserved("upgradeError",i)};function o(){n("transport closed")}function r(){n("socket closed")}function l(t){if(e&&t.name!==e.name){a()}}const c=()=>{e.removeListener("open",s);e.removeListener("error",n);e.removeListener("close",o);this.off("close",r);this.off("upgrading",l)};e.once("open",s);e.once("error",n);e.once("close",o);this.once("close",r);this.once("upgrading",l);if(this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"){this.setTimeoutFn((()=>{if(!i){e.open()}}),200)}else{e.open()}}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades);super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let i=0;i<t.length;i++){if(~this.transports.indexOf(t[i]))e.push(t[i])}return e}}class Os extends Cs{constructor(t,e={}){const i=typeof t==="object"?t:e;if(!i.transports||i.transports&&typeof i.transports[0]==="string"){i.transports=(i.transports||["polling","websocket","webtransport"]).map((t=>gs[t])).filter((t=>!!t))}super(t,i)}}function Ms(t,e="",i){let s=t;i=i||typeof location!=="undefined"&&location;if(null==t)t=i.protocol+"//"+i.host;if(typeof t==="string"){if("/"===t.charAt(0)){if("/"===t.charAt(1)){t=i.protocol+t}else{t=i.host+t}}if(!/^(https?|wss?):\/\//.test(t)){if("undefined"!==typeof i){t=i.protocol+"//"+t}else{t="https://"+t}}s=ys(t)}if(!s.port){if(/^(http|ws)$/.test(s.protocol)){s.port="80"}else if(/^(http|ws)s$/.test(s.protocol)){s.port="443"}}s.path=s.path||"/";const a=s.host.indexOf(":")!==-1;const n=a?"["+s.host+"]":s.host;s.id=s.protocol+"://"+n+":"+s.port+e;s.href=s.protocol+"://"+n+(i&&i.port===s.port?"":":"+s.port);return s}const Es=typeof ArrayBuffer==="function";const Ys=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;const As=Object.prototype.toString;const Ts=typeof Blob==="function"||typeof Blob!=="undefined"&&As.call(Blob)==="[object BlobConstructor]";const Ss=typeof File==="function"||typeof File!=="undefined"&&As.call(File)==="[object FileConstructor]";function Bs(t){return Es&&(t instanceof ArrayBuffer||Ys(t))||Ts&&t instanceof Blob||Ss&&t instanceof File}function Is(t,e){if(!t||typeof t!=="object"){return false}if(Array.isArray(t)){for(let e=0,i=t.length;e<i;e++){if(Is(t[e])){return true}}return false}if(Bs(t)){return true}if(t.toJSON&&typeof t.toJSON==="function"&&arguments.length===1){return Is(t.toJSON(),true)}for(const e in t){if(Object.prototype.hasOwnProperty.call(t,e)&&Is(t[e])){return true}}return false}function js(t){const e=[];const i=t.data;const s=t;s.data=zs(i,e);s.attachments=e.length;return{packet:s,buffers:e}}function zs(t,e){if(!t)return t;if(Bs(t)){const i={_placeholder:true,num:e.length};e.push(t);return i}else if(Array.isArray(t)){const i=new Array(t.length);for(let s=0;s<t.length;s++){i[s]=zs(t[s],e)}return i}else if(typeof t==="object"&&!(t instanceof Date)){const i={};for(const s in t){if(Object.prototype.hasOwnProperty.call(t,s)){i[s]=zs(t[s],e)}}return i}return t}function Ns(t,e){t.data=Rs(t.data,e);delete t.attachments;return t}function Rs(t,e){if(!t)return t;if(t&&t._placeholder===true){const i=typeof t.num==="number"&&t.num>=0&&t.num<e.length;if(i){return e[t.num]}else{throw new Error("illegal attachments")}}else if(Array.isArray(t)){for(let i=0;i<t.length;i++){t[i]=Rs(t[i],e)}}else if(typeof t==="object"){for(const i in t){if(Object.prototype.hasOwnProperty.call(t,i)){t[i]=Rs(t[i],e)}}}return t}const $s=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];const Fs=5;var Ls;(function(t){t[t["CONNECT"]=0]="CONNECT";t[t["DISCONNECT"]=1]="DISCONNECT";t[t["EVENT"]=2]="EVENT";t[t["ACK"]=3]="ACK";t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR";t[t["BINARY_EVENT"]=5]="BINARY_EVENT";t[t["BINARY_ACK"]=6]="BINARY_ACK"})(Ls||(Ls={}));class Ps{constructor(t){this.replacer=t}encode(t){if(t.type===Ls.EVENT||t.type===Ls.ACK){if(Is(t)){return this.encodeAsBinary({type:t.type===Ls.EVENT?Ls.BINARY_EVENT:Ls.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}}return[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;if(t.type===Ls.BINARY_EVENT||t.type===Ls.BINARY_ACK){e+=t.attachments+"-"}if(t.nsp&&"/"!==t.nsp){e+=t.nsp+","}if(null!=t.id){e+=t.id}if(null!=t.data){e+=JSON.stringify(t.data,this.replacer)}return e}encodeAsBinary(t){const e=js(t);const i=this.encodeAsString(e.packet);const s=e.buffers;s.unshift(i);return s}}function Hs(t){return Object.prototype.toString.call(t)==="[object Object]"}class Us extends Ni{constructor(t){super();this.reviver=t}add(t){let e;if(typeof t==="string"){if(this.reconstructor){throw new Error("got plaintext data when reconstructing a packet")}e=this.decodeString(t);const i=e.type===Ls.BINARY_EVENT;if(i||e.type===Ls.BINARY_ACK){e.type=i?Ls.EVENT:Ls.ACK;this.reconstructor=new Vs(e);if(e.attachments===0){super.emitReserved("decoded",e)}}else{super.emitReserved("decoded",e)}}else if(Bs(t)||t.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{e=this.reconstructor.takeBinaryData(t);if(e){this.reconstructor=null;super.emitReserved("decoded",e)}}}else{throw new Error("Unknown type: "+t)}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(Ls[i.type]===undefined){throw new Error("unknown packet type "+i.type)}if(i.type===Ls.BINARY_EVENT||i.type===Ls.BINARY_ACK){const s=e+1;while(t.charAt(++e)!=="-"&&e!=t.length){}const a=t.substring(s,e);if(a!=Number(a)||t.charAt(e)!=="-"){throw new Error("Illegal attachments")}i.attachments=Number(a)}if("/"===t.charAt(e+1)){const s=e+1;while(++e){const i=t.charAt(e);if(","===i)break;if(e===t.length)break}i.nsp=t.substring(s,e)}else{i.nsp="/"}const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const s=e+1;while(++e){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=this.tryParse(t.substr(e));if(Us.isPayloadValid(i.type,s)){i.data=s}else{throw new Error("invalid payload")}}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return false}}static isPayloadValid(t,e){switch(t){case Ls.CONNECT:return Hs(e);case Ls.DISCONNECT:return e===undefined;case Ls.CONNECT_ERROR:return typeof e==="string"||Hs(e);case Ls.EVENT:case Ls.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]==="number"||typeof e[0]==="string"&&$s.indexOf(e[0])===-1);case Ls.ACK:case Ls.BINARY_ACK:return Array.isArray(e)}}destroy(){if(this.reconstructor){this.reconstructor.finishedReconstruction();this.reconstructor=null}}}class Vs{constructor(t){this.packet=t;this.buffers=[];this.reconPack=t}takeBinaryData(t){this.buffers.push(t);if(this.buffers.length===this.reconPack.attachments){const t=Ns(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null}finishedReconstruction(){this.reconPack=null;this.buffers=[]}}const Gs=Object.freeze({__proto__:null,protocol:Fs,get PacketType(){return Ls},Encoder:Ps,Decoder:Us});function Ks(t,e,i){t.on(e,i);return function s(){t.off(e,i)}}const Ws=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class qs extends Ni{constructor(t,e,i){super();this.connected=false;this.recovered=false;this.receiveBuffer=[];this.sendBuffer=[];this._queue=[];this._queueSeq=0;this.ids=0;this.acks={};this.flags={};this.io=t;this.nsp=e;if(i&&i.auth){this.auth=i.auth}this._opts=Object.assign({},i);if(this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ks(t,"open",this.onopen.bind(this)),Ks(t,"packet",this.onpacket.bind(this)),Ks(t,"error",this.onerror.bind(this)),Ks(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;this.subEvents();if(!this.io["_reconnecting"])this.io.open();if("open"===this.io._readyState)this.onopen();return this}open(){return this.connect()}send(...t){t.unshift("message");this.emit.apply(this,t);return this}emit(t,...e){var i,s,a;if(Ws.hasOwnProperty(t)){throw new Error('"'+t.toString()+'" is a reserved event name')}e.unshift(t);if(this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile){this._addToQueue(e);return this}const n={type:Ls.EVENT,data:e};n.options={};n.options.compress=this.flags.compress!==false;if("function"===typeof e[e.length-1]){const t=this.ids++;const i=e.pop();this._registerAckCallback(t,i);n.id=t}const o=(s=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||s===void 0?void 0:s.writable;const r=this.connected&&!((a=this.io.engine)===null||a===void 0?void 0:a._hasPingExpired());const l=this.flags.volatile&&!o;if(l);else if(r){this.notifyOutgoingListeners(n);this.packet(n)}else{this.sendBuffer.push(n)}this.flags={};return this}_registerAckCallback(t,e){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===undefined){this.acks[t]=e;return}const a=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++){if(this.sendBuffer[e].id===t){this.sendBuffer.splice(e,1)}}e.call(this,new Error("operation has timed out"))}),s);const n=(...t)=>{this.io.clearTimeoutFn(a);e.apply(this,t)};n.withError=true;this.acks[t]=n}emitWithAck(t,...e){return new Promise(((i,s)=>{const a=(t,e)=>t?s(t):i(e);a.withError=true;e.push(a);this.emit(t,...e)}))}_addToQueue(t){let e;if(typeof t[t.length-1]==="function"){e=t.pop()}const i={id:this._queueSeq++,tryCount:0,pending:false,args:t,flags:Object.assign({fromQueue:true},this.flags)};t.push(((t,...s)=>{if(i!==this._queue[0]){return}const a=t!==null;if(a){if(i.tryCount>this._opts.retries){this._queue.shift();if(e){e(t)}}}else{this._queue.shift();if(e){e(null,...s)}}i.pending=false;return this._drainQueue()}));this._queue.push(i);this._drainQueue()}_drainQueue(t=false){if(!this.connected||this._queue.length===0){return}const e=this._queue[0];if(e.pending&&!t){return}e.pending=true;e.tryCount++;this.flags=e.flags;this.emit.apply(this,e.args)}packet(t){t.nsp=this.nsp;this.io._packet(t)}onopen(){if(typeof this.auth=="function"){this.auth((t=>{this._sendConnectPacket(t)}))}else{this._sendConnectPacket(this.auth)}}_sendConnectPacket(t){this.packet({type:Ls.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){if(!this.connected){this.emitReserved("connect_error",t)}}onclose(t,e){this.connected=false;delete this.id;this.emitReserved("disconnect",t,e);this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{const e=this.sendBuffer.some((e=>String(e.id)===t));if(!e){const e=this.acks[t];delete this.acks[t];if(e.withError){e.call(this,new Error("socket has been disconnected"))}}}))}onpacket(t){const e=t.nsp===this.nsp;if(!e)return;switch(t.type){case Ls.CONNECT:if(t.data&&t.data.sid){this.onconnect(t.data.sid,t.data.pid)}else{this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"))}break;case Ls.EVENT:case Ls.BINARY_EVENT:this.onevent(t);break;case Ls.ACK:case Ls.BINARY_ACK:this.onack(t);break;case Ls.DISCONNECT:this.ondisconnect();break;case Ls.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data;this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];if(null!=t.id){e.push(this.ack(t.id))}if(this.connected){this.emitEvent(e)}else{this.receiveBuffer.push(Object.freeze(e))}}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e){i.apply(this,t)}}super.emit.apply(this,t);if(this._pid&&t.length&&typeof t[t.length-1]==="string"){this._lastOffset=t[t.length-1]}}ack(t){const e=this;let i=false;return function(...s){if(i)return;i=true;e.packet({type:Ls.ACK,id:t,data:s})}}onack(t){const e=this.acks[t.id];if(typeof e!=="function"){return}delete this.acks[t.id];if(e.withError){t.data.unshift(null)}e.apply(this,t.data)}onconnect(t,e){this.id=t;this.recovered=e&&this._pid===e;this._pid=e;this.connected=true;this.emitBuffered();this.emitReserved("connect");this._drainQueue(true)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t)));this.receiveBuffer=[];this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t);this.packet(t)}));this.sendBuffer=[]}ondisconnect(){this.destroy();this.onclose("io server disconnect")}destroy(){if(this.subs){this.subs.forEach((t=>t()));this.subs=undefined}this.io["_destroy"](this)}disconnect(){if(this.connected){this.packet({type:Ls.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this}close(){return this.disconnect()}compress(t){this.flags.compress=t;return this}get volatile(){this.flags.volatile=true;return this}timeout(t){this.flags.timeout=t;return this}onAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.push(t);return this}prependAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.unshift(t);return this}offAny(t){if(!this._anyListeners){return this}if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyListeners=[]}return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.push(t);return this}prependAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.unshift(t);return this}offAnyOutgoing(t){if(!this._anyOutgoingListeners){return this}if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++){if(t===e[i]){e.splice(i,1);return this}}}else{this._anyOutgoingListeners=[]}return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e){i.apply(this,t.data)}}}}function Xs(t){t=t||{};this.ms=t.min||100;this.max=t.max||1e4;this.factor=t.factor||2;this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0;this.attempts=0}Xs.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random();var i=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-i:t+i}return Math.min(t,this.max)|0};Xs.prototype.reset=function(){this.attempts=0};Xs.prototype.setMin=function(t){this.ms=t};Xs.prototype.setMax=function(t){this.max=t};Xs.prototype.setJitter=function(t){this.jitter=t};class Js extends Ni{constructor(t,e){var i;super();this.nsps={};this.subs=[];if(t&&"object"===typeof t){e=t;t=undefined}e=e||{};e.path=e.path||"/socket.io";this.opts=e;Gi(this,e);this.reconnection(e.reconnection!==false);this.reconnectionAttempts(e.reconnectionAttempts||Infinity);this.reconnectionDelay(e.reconnectionDelay||1e3);this.reconnectionDelayMax(e.reconnectionDelayMax||5e3);this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5);this.backoff=new Xs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==e.timeout?2e4:e.timeout);this._readyState="closed";this.uri=t;const s=e.parser||Gs;this.encoder=new s.Encoder;this.decoder=new s.Decoder;this._autoConnect=e.autoConnect!==false;if(this._autoConnect)this.open()}reconnection(t){if(!arguments.length)return this._reconnection;this._reconnection=!!t;if(!t){this.skipReconnect=true}return this}reconnectionAttempts(t){if(t===undefined)return this._reconnectionAttempts;this._reconnectionAttempts=t;return this}reconnectionDelay(t){var e;if(t===undefined)return this._reconnectionDelay;this._reconnectionDelay=t;(e=this.backoff)===null||e===void 0?void 0:e.setMin(t);return this}randomizationFactor(t){var e;if(t===undefined)return this._randomizationFactor;this._randomizationFactor=t;(e=this.backoff)===null||e===void 0?void 0:e.setJitter(t);return this}reconnectionDelayMax(t){var e;if(t===undefined)return this._reconnectionDelayMax;this._reconnectionDelayMax=t;(e=this.backoff)===null||e===void 0?void 0:e.setMax(t);return this}timeout(t){if(!arguments.length)return this._timeout;this._timeout=t;return this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Os(this.uri,this.opts);const e=this.engine;const i=this;this._readyState="opening";this.skipReconnect=false;const s=Ks(e,"open",(function(){i.onopen();t&&t()}));const a=e=>{this.cleanup();this._readyState="closed";this.emitReserved("error",e);if(t){t(e)}else{this.maybeReconnectOnOpen()}};const n=Ks(e,"error",a);if(false!==this._timeout){const t=this._timeout;const i=this.setTimeoutFn((()=>{s();a(new Error("timeout"));e.close()}),t);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}this.subs.push(s);this.subs.push(n);return this}connect(t){return this.open(t)}onopen(){this.cleanup();this._readyState="open";this.emitReserved("open");const t=this.engine;this.subs.push(Ks(t,"ping",this.onping.bind(this)),Ks(t,"data",this.ondata.bind(this)),Ks(t,"error",this.onerror.bind(this)),Ks(t,"close",this.onclose.bind(this)),Ks(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){$i((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];if(!i){i=new qs(this,t,e);this.nsps[t]=i}else if(this._autoConnect&&!i.active){i.connect()}return i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){const e=this.nsps[t];if(e.active){return}}this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++){this.engine.write(e[i],t.options)}}cleanup(){this.subs.forEach((t=>t()));this.subs.length=0;this.decoder.destroy()}_close(){this.skipReconnect=true;this._reconnecting=false;this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;this.cleanup();(i=this.engine)===null||i===void 0?void 0:i.close();this.backoff.reset();this._readyState="closed";this.emitReserved("close",t,e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts){this.backoff.reset();this.emitReserved("reconnect_failed");this._reconnecting=false}else{const e=this.backoff.duration();this._reconnecting=true;const i=this.setTimeoutFn((()=>{if(t.skipReconnect)return;this.emitReserved("reconnect_attempt",t.backoff.attempts);if(t.skipReconnect)return;t.open((e=>{if(e){t._reconnecting=false;t.reconnect();this.emitReserved("reconnect_error",e)}else{t.onreconnect()}}))}),e);if(this.opts.autoUnref){i.unref()}this.subs.push((()=>{this.clearTimeoutFn(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=false;this.backoff.reset();this.emitReserved("reconnect",t)}}const Qs={};function Zs(t,e){if(typeof t==="object"){e=t;t=undefined}e=e||{};const i=Ms(t,e.path||"/socket.io");const s=i.source;const a=i.id;const n=i.path;const o=Qs[a]&&n in Qs[a]["nsps"];const r=e.forceNew||e["force new connection"]||false===e.multiplex||o;let l;if(r){l=new Js(s,e)}else{if(!Qs[a]){Qs[a]=new Js(s,e)}l=Qs[a]}if(i.query&&!e.query){e.query=i.queryKey}return l.socket(i.path,e)}Object.assign(Zs,{Manager:Js,Socket:qs,io:Zs,connect:Zs});class ta{constructor(t,e){this.queue=[];this.isProcessing=false;this.flushTimer=null;this.processor=t;this.options=Object.assign({maxQueueSize:1e4,onError:t=>console.error("Queue processing error:",t),onBatchProcessed:()=>{}},e)}offer(t){if(this.queue.length>=this.options.maxQueueSize){return false}const e={data:t,timestamp:Date.now(),id:this.generateId()};this.queue.push(e);this.scheduleFlush();return true}offerAll(t){let e=0;for(const i of t){if(this.offer(i)){e++}else{break}}return e}size(){return this.queue.length}isEmpty(){return this.queue.length===0}async flush(){if(this.flushTimer){clearTimeout(this.flushTimer);this.flushTimer=null}await this.processBatch()}clear(){this.queue=[];if(this.flushTimer){clearTimeout(this.flushTimer);this.flushTimer=null}}async shutdown(){await this.flush()}scheduleFlush(){if(this.queue.length>=this.options.batchSize){this.processBatch();return}if(!this.flushTimer){this.flushTimer=setTimeout((()=>{this.processBatch()}),this.options.flushInterval)}}async processBatch(){if(this.isProcessing||this.queue.length===0){return}this.isProcessing=true;try{const t=Math.min(this.options.batchSize,this.queue.length);const e=this.queue.splice(0,t);const i=e.map((t=>t.data));const s=Date.now();await this.processor(i);const a=Date.now()-s;this.options.onBatchProcessed(t,a);if(this.flushTimer){clearTimeout(this.flushTimer);this.flushTimer=null}if(this.queue.length>0){this.scheduleFlush()}}catch(t){this.options.onError(t)}finally{this.isProcessing=false}}generateId(){return ht()}}const ea=".sc-igloo-calendar-h{display:block;position:relative;background-color:#ffffff;height:100%;text-align:center}.igl-calendar.sc-igloo-calendar{display:grid;grid-template-columns:1fr;height:100%}.calendarScrollContainer.sc-igloo-calendar{width:100%;height:100%;overflow:auto;position:relative;white-space:nowrap;border-left:2px solid grey}.showToBeAssigned.sc-igloo-calendar,.showLegend.sc-igloo-calendar{grid-template-columns:330px 1fr}#calendarContainer.sc-igloo-calendar{position:absolute}.legendContainer.sc-igloo-calendar,.tobeAssignedContainer.sc-igloo-calendar{display:none;height:100%;overflow-y:auto;padding-left:0.5em !important;padding-right:0.5em !important}.showToBeAssigned.sc-igloo-calendar .tobeAssignedContainer.sc-igloo-calendar{display:block}.showLegend.sc-igloo-calendar .legendContainer.sc-igloo-calendar{display:block}.tobeBooked.sc-igloo-calendar{padding-top:8px;padding-bottom:8px;text-align:left}";const ia=ea;var sa=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const aa=class{constructor(e){t(this,e);this.dragOverHighlightElement=s(this,"dragOverHighlightElement",7);this.moveBookingTo=s(this,"moveBookingTo",7);this.calculateUnassignedDates=s(this,"calculateUnassignedDates",7);this.reduceAvailableUnitEvent=s(this,"reduceAvailableUnitEvent",7);this.revertBooking=s(this,"revertBooking",7);this.openCalendarSidebar=s(this,"openCalendarSidebar",7);this.showRoomNightsDialog=s(this,"showRoomNightsDialog",7);this.ticket="";this.calendarData=new Object;this.days=new Array;this.scrollViewDragging=false;this.dialogData=null;this.bookingItem=null;this.editBookingItem=null;this.showLegend=false;this.showPaymentDetails=false;this.showToBeAssigned=false;this.unassignedDates={};this.roomNightsData=null;this.renderAgain=false;this.showBookProperty=false;this.isAuthenticated=false;this.bookingService=new l;this.roomService=new bt;this.eventsService=new Kt;this.toBeAssignedService=new Ye;this.housekeepingService=new mt;this.countries=[];this.visibleCalendarCells={x:[],y:[]};this.today="";this.reachedEndOfCalendar=false;this.token=new pt;this.salesQueue=new ta(this.processSalesBatch.bind(this),{batchSize:50,flushInterval:1e3,maxQueueSize:5e3,onError:t=>console.error("Batch Sales Update Error:",t)});this.availabilityQueue=new ta(this.processAvailabilityBatch.bind(this),{batchSize:50,flushInterval:1e3,maxQueueSize:5e3,onError:t=>console.error("Batch Availability Update Error:",t)});this.roomTypeIdsCache=new Map;this.scrollViewDragPos={top:0,left:0,x:0,y:0};this.onScrollContentMoveHandler=t=>{if(t.buttons!==1){return}const e=t.clientX-this.scrollViewDragPos.x;const i=t.clientY-this.scrollViewDragPos.y;this.scrollContainer.scrollTop=this.scrollViewDragPos.top-i;this.scrollContainer.scrollLeft=this.scrollViewDragPos.left-e;if(Math.abs(e)>5||Math.abs(i)>5){this.scrollViewDragging=true}};this.onScrollContentMoveEndHandler=()=>{document.removeEventListener("mousemove",this.onScrollContentMoveHandler);document.removeEventListener("mouseup",this.onScrollContentMoveEndHandler)}}componentWillLoad(){if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}this.init()}componentDidLoad(){this.scrollToElement(this.today)}async handleDeleteEvent(t){try{t.stopImmediatePropagation();t.preventDefault();await this.eventsService.deleteEvent(t.detail)}catch(t){}}async handleCalendarSidebarEvents(t){console.log("hit ");t.stopImmediatePropagation();t.stopPropagation();this.calendarSidebarState=t.detail}scrollPageToRoom(t){let e=t.detail.refClass;this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const i=this.element.querySelector(".topLeftCell");const s=this.element.querySelector("."+e);if(s){this.scrollContainer.scrollTo({top:0});const t=s.getBoundingClientRect();const e=this.scrollContainer.getBoundingClientRect();const a=i.getBoundingClientRect();this.scrollContainer.scrollTo({top:t.top-e.top-a.height-t.height})}}handleShowDialog(t){var e;t.stopImmediatePropagation();t.stopPropagation();this.dialogData=t.detail;(e=this.calendarModalEl)===null||e===void 0?void 0:e.openModal()}handleShowRoomNightsDialog(t){this.roomNightsData=t.detail}handleBookingDatasChange(t){t.stopPropagation();t.stopImmediatePropagation();let e=[...this.calendarData.bookingEvents];e=e.filter((t=>t.ID!=="NEW_TEMP_EVENT"));e.push(...t.detail.filter((t=>t.STATUS==="PENDING-CONFIRMATION")));this.updateBookingEventsDateRange(t.detail);this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:e})}handleUpdateBookingEvent(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.detail;this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((t=>{if(e.ID===t.ID){return e}return t}))})}showBookingPopupEventDataHandler(t){t.preventDefault();t.stopImmediatePropagation();this.onOptionSelect(t)}updateEventDataHandler(t){let e=this.calendarData.bookingEvents.find((e=>e.id===t.detail.id));if(e&&t.detail&&t.detail.data){Object.entries(t.detail.data).forEach((([t,i])=>{e[t]=i}))}}dragOverEventDataHandler(t){if(t.detail.id==="CALCULATE_DRAG_OVER_BOUNDS"){let e=document.querySelector("igl-cal-header .topLeftCell");let i=document.querySelectorAll(".headersContainer .headerCell");let s=document.querySelectorAll(".bodyContainer .roomRow .roomTitle");this.visibleCalendarCells={x:[],y:[]};i.forEach((t=>{const i=t;this.visibleCalendarCells.x.push({left:i.offsetLeft+e.offsetWidth,width:i.offsetWidth,id:i.getAttribute("data-day")})}));s.forEach((t=>{const e=t;this.visibleCalendarCells.y.push({top:e.offsetTop,height:e.offsetHeight,id:e.getAttribute("data-room")})}));this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER"){this.highlightDragOver(true,t.detail.data)}else if(t.detail.id==="DRAG_OVER_END"){this.highlightDragOver(false,t.detail.data)}else if(t.detail.id==="STRETCH_OVER_END"){this.highlightDragOver(false,t.detail.data)}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}init(){this.calDates={from:this.from_date,to:this.to_date};if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}this.calDates={from:this.from_date,to:this.to_date};Se("unassigned_dates",(t=>{if(Object.keys(t).length===0&&this.highlightedDate!==""){this.highlightedDate=""}}))}renderModalBody(){var t,e;switch((t=this.dialogData)===null||t===void 0?void 0:t.reason){case"checkin":{return`Are you sure you want to Check In this unit?`}case"checkout":{return"Are you sure you want to Check Out this unit?"}case"reallocate":return((e=this.dialogData)===null||e===void 0?void 0:e.description)||"";case"stretch":return"Warning ";default:return"Unknown modal content"}}setUpCalendarData(t,e){this.calendarData.currency=t["My_Result"].currency;this.calendarData.allowedBookingSources=t["My_Result"].allowed_booking_sources;this.calendarData.adultChildConstraints=t["My_Result"].adult_child_constraints;this.calendarData.legendData=this.getLegendData(t);this.calendarData.is_vacation_rental=t["My_Result"].is_vacation_rental;this.calendarData.from_date=e.My_Params_Get_Rooming_Data.FROM;this.calendarData.to_date=e.My_Params_Get_Rooming_Data.TO;this.calendarData.startingDate=new Date(e.My_Params_Get_Rooming_Data.FROM).getTime();this.calendarData.endingDate=new Date(e.My_Params_Get_Rooming_Data.TO).getTime();this.calendarData.formattedLegendData=P(this.calendarData.legendData);let i=e.myBookings||[];i=i.filter((t=>{const e=D(t.TO_DATE,"YYYY-MM-DD");const i=D(t.FROM_DATE,"YYYY-MM-DD");return!e.isSame(i)}));this.calendarData.bookingEvents=i;this.calendarData.toBeAssignedEvents=[]}async initializeApp(){try{let t=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}let e=null;if(!t){console.log(t);const i=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true,include_sales_rate_plans:true});e=i;t=i.My_Result.id}this.property_id=t;const i=[this.bookingService.getCalendarData(t,this.from_date,this.to_date),this.bookingService.getCountries(this.language),this.roomService.fetchLanguage(this.language),this.housekeepingService.getExposedHKSetup(this.property_id)];if(this.propertyid){i.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true,include_sales_rate_plans:true}))}const s=await Promise.all(i);this.tasksEndDate=D().add(30,"days").format("YYYY-MM-DD");this.getHousekeepingTasks({from_date:D().format("YYYY-MM-DD"),to_date:this.tasksEndDate});if(!e){e=s[s.length-1]}const[a,n]=s;T.days=a.days;T.months=a.months;this.setRoomsData(e);this.countries=n;this.setUpCalendarData(e,a);let o=e["My_Result"]["allowed_payment_methods"];this.showPaymentDetails=o.some((t=>t.code==="001"||t.code==="004"));this.updateBookingEventsDateRange(this.calendarData.bookingEvents);this.updateBookingEventsDateRange(this.calendarData.toBeAssignedEvents);this.today=this.transformDateForScroll(new Date);let r=new Date(this.calendarData.startingDate);r.setHours(0,0,0,0);this.days=a.days;this.calendarData.days=this.days;this.calendarData.monthsInfo=a.months;T.fromDate=this.calendarData.from_date;T.toDate=this.calendarData.to_date;setTimeout((()=>{this.scrollToElement(this.today)}),200);if(!this.calendarData.is_vacation_rental){const t=await this.toBeAssignedService.getUnassignedDates(this.property_id,this.from_date,this.to_date);this.unassignedDates={fromDate:this.from_date,toDate:this.to_date,data:Object.assign(Object.assign({},this.unassignedDates),t)};this.calendarData=Object.assign(Object.assign({},this.calendarData),{unassignedDates:t});Be(t)}this.socket=Zs("https://realtime.igloorooms.com/");this.socket.on("MSG",(async t=>{await this.handleSocketMessage(t)}))}catch(t){console.error("Initializing Calendar Error",t)}}async getHousekeepingTasks({from_date:t,to_date:e}){var i,s,a,n,o,r,l;const{tasks:c}=await this.housekeepingService.getHkTasks({property_id:this.property_id,from_date:t,to_date:e,housekeepers:[],cleaning_frequency:(a=(i=x.cleaning_frequency)!==null&&i!==void 0?i:(s=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||s===void 0?void 0:s.cleaning_frequencies[0])===null||a===void 0?void 0:a.code,dusty_window:(o=(n=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||n===void 0?void 0:n.dusty_periods[0])===null||o===void 0?void 0:o.code,highlight_window:(l=(r=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||r===void 0?void 0:r.highlight_checkin_options[0])===null||l===void 0?void 0:l.code});H(c)}async handleSocketMessage(t){const e=JSON.parse(t);if(!e){return}const{REASON:i,KEY:s,PAYLOAD:a}=e;if(s.toString()!==this.property_id.toString()){return}let n;if(["DELETE_CALENDAR_POOL","GET_UNASSIGNED_DATES"].includes(i)){n=a}else{n=JSON.parse(a)}console.log({[i]:n});const o={DORESERVATION:this.handleDoReservation,BLOCK_EXPOSED_UNIT:this.handleBlockExposedUnit,ASSIGN_EXPOSED_ROOM:this.handleAssignExposedRoom,REALLOCATE_EXPOSED_ROOM_BLOCK:this.handleReallocateExposedRoomBlock,DELETE_CALENDAR_POOL:this.handleDeleteCalendarPool,GET_UNASSIGNED_DATES:this.handleGetUnassignedDates,UPDATE_CALENDAR_AVAILABILITY:t=>this.availabilityQueue.offer(t),CHANGE_IN_DUE_AMOUNT:this.handleChangeInDueAmount,CHANGE_IN_BOOK_STATUS:this.handleChangeInBookStatus,NON_TECHNICAL_CHANGE_IN_BOOKING:this.handleNonTechnicalChangeInBooking,ROOM_STATUS_CHANGED:this.handleRoomStatusChanged,UNIT_HK_STATUS_CHANGED:this.handleUnitHKStatusChanged,SHARING_PERSONS_UPDATED:this.handleSharingPersonsUpdated,ROOM_TYPE_CLOSE:t=>this.salesQueue.offer(Object.assign(Object.assign({},t),{is_available_to_book:false})),ROOM_TYPE_OPEN:t=>this.salesQueue.offer(Object.assign(Object.assign({},t),{is_available_to_book:true})),HK_SKIP:this.handleHkSkip};const r=o[i];if(r){await r.call(this,n)}else{console.warn(`Unhandled REASON: ${i}`)}}handleSharingPersonsUpdated(t){console.log("sharing persons updated",t);this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((e=>{var i;if(e.IDENTIFIER===t.identifier){const s=(i=t.guests)===null||i===void 0?void 0:i.find((t=>t.is_main));return Object.assign(Object.assign({},e),{NAME:U(s.first_name,s.last_name),ROOM_INFO:Object.assign(Object.assign({},e.ROOM_INFO),{sharing_persons:t.guests})})}return e}))]})}handleRoomStatusChanged(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:[...this.calendarData.bookingEvents.map((e=>{if(e.IDENTIFIER===t.room_identifier){const i=V({from_date:e.FROM_DATE,to_date:e.TO_DATE,in_out:Object.assign(Object.assign({},e.ROOM_INFO.in_out),{code:t.status}),status_code:e.BASE_STATUS_CODE});return Object.assign(Object.assign({},e),{CHECKIN:t.status==="001",CHECKOUT:t.status==="002",STATUS:i})}return e}))]})}handleHkSkip(t){G({date:t.DATE,unitId:t.PR_ID})}handleUnitHKStatusChanged(t){console.log("hk unit change",t);const e=[...this.calendarData.roomsInfo];const i=e.findIndex((e=>e.id===t.ROOM_CATEGORY_ID));if(i!==-1){const s=Object.assign({},e[i]);const a=s.physicalrooms.findIndex((e=>e.id===t.PR_ID));if(a!==-1){const n=[...s.physicalrooms];const o=Object.assign({},n[a]);o.hk_status=t.HKS_CODE;n[a]=o;s.physicalrooms=n;e[i]=s;this.calendarData=Object.assign(Object.assign({},this.calendarData),{roomsInfo:e})}}const s={date:D().format("YYYY-MM-DD"),unitId:t.PR_ID};if(t.HKS_CODE==="002"){K(s)}else{G(s)}}async handleDoReservation(t){const e=Y(t);this.AddOrUpdateRoomBookings(e)}async handleBlockExposedUnit(t){const e=[await W(t)];this.AddOrUpdateRoomBookings(e)}async handleAssignExposedRoom(t){console.log(t);const e=Y(t);this.AddOrUpdateRoomBookings(e)}async handleReallocateExposedRoomBlock(t){await this.handleBlockExposedUnit(t)}async handleDeleteCalendarPool(t){console.log("delete calendar pool");this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.filter((e=>e.POOL!==t))})}async handleGetUnassignedDates(t){const e=this.parseDateRange(t);if(!this.calendarData.is_vacation_rental&&new Date(e.FROM_DATE).getTime()>=this.calendarData.startingDate&&new Date(e.TO_DATE).getTime()<=this.calendarData.endingDate){const t=await this.toBeAssignedService.getUnassignedDates(this.property_id,E(new Date(e.FROM_DATE)),E(new Date(e.TO_DATE)));Be(t);this.unassignedDates={fromDate:E(new Date(e.FROM_DATE)),toDate:E(new Date(e.TO_DATE)),data:t};if(Object.keys(t).length===0){je(E(new Date(e.FROM_DATE)),E(new Date(e.TO_DATE)));this.reduceAvailableUnitEvent.emit({fromDate:E(new Date(e.FROM_DATE)),toDate:E(new Date(e.TO_DATE))})}}}parseDateRange(t){const e={};const i=t.split("|");i.forEach((t=>{const i=t.split(":");e[i[0]]=i[1]}));return e}handleChangeInDueAmount(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(t.pools.includes(e.ID)){return Object.assign(Object.assign({},e),{BALANCE:t.due_amount})}return e}))})}handleChangeInBookStatus(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(t.pools.includes(e.ID)){return Object.assign(Object.assign({},e),{STATUS:e.STATUS!=="IN-HOUSE"?q[t.status_code]:t.status_code==="001"?q[t.status_code]:"IN-HOUSE"})}return e}))})}handleNonTechnicalChangeInBooking(t){this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:this.calendarData.bookingEvents.map((e=>{if(e.BOOKING_NUMBER===t.booking_nbr){return Object.assign(Object.assign({},e),{PRIVATE_NOTE:X(t.extras)})}return e}))})}checkBookingAvailability(t){return this.calendarData.bookingEvents.some((e=>e.ID===t.ID||e.FROM_DATE===t.FROM_DATE&&e.TO_DATE===t.TO_DATE&&e.PR_ID===t.PR_ID))}updateBookingEventsDateRange(t){t.forEach((t=>{var e;t.legendData=this.calendarData.formattedLegendData;t.defaultDateRange={};t.defaultDateRange.fromDate=new Date(t.FROM_DATE+"T00:00:00");t.defaultDateRange.fromDateStr=this.getDateStr(t.defaultDateRange.fromDate);t.defaultDateRange.fromDateTimeStamp=t.defaultDateRange.fromDate.getTime();t.defaultDateRange.toDate=new Date(t.TO_DATE+"T00:00:00");t.defaultDateRange.toDateStr=this.getDateStr(t.defaultDateRange.toDate);t.defaultDateRange.toDateTimeStamp=t.defaultDateRange.toDate.getTime();t.defaultDateRange.dateDifference=t.NO_OF_DAYS;t.roomsInfo=[...this.calendarData.roomsInfo];if(!A(t.STATUS_CODE)){t.STATUS=V({in_out:(e=t.ROOM_INFO)===null||e===void 0?void 0:e.in_out,from_date:t.FROM_DATE,to_date:t.TO_DATE,status_code:t.BASE_STATUS_CODE})}}))}processSalesBatch(t){const e=[...T.days];const i=new Map(T.disabled_cells);for(const s of t){const t=e.findIndex((t=>t.value===s.night));if(t===-1){console.warn(`Couldn't find day ${s.night}`);continue}let a=this.roomTypeIdsCache.get(s.rate_plan_id);if(a==="skip"){continue}if(!a){const i=e[t].rate.findIndex((t=>t.rateplans.some((t=>t.id===s.rate_plan_id))));if(i===-1){this.roomTypeIdsCache.set(s.rate_plan_id,"skip");console.warn(`Couldn't find room type for rate plan ${s.rate_plan_id}`);continue}const n=e[t].rate[i];const o=n.rateplans.findIndex((t=>t.id===s.rate_plan_id));a={id:i,index:o};this.roomTypeIdsCache.set(s.rate_plan_id,a)}const{id:n,index:o}=a;const r=e[t].rate[n];const l=r.rateplans.map(((t,e)=>e===o?Object.assign(Object.assign({},t),{is_available_to_book:s.is_available_to_book}):t));const c=l.some((t=>t.is_available_to_book));e[t].rate[n]=Object.assign(Object.assign({},r),{rateplans:l,is_available_to_book:c});for(const s of r.physicalrooms){const a=`${s.id}_${e[t].value}`;i.set(a,{disabled:!c,reason:"stop_sale"})}}T["disabled_cells"]=new Map(i);T.days=e}processAvailabilityBatch(t){let e=[...T.days];const i=new Map(T.disabled_cells);for(const s of t){const t=e.findIndex((t=>t.value===s.date));if(t===-1){console.warn(`Couldn't find day ${s.date}`);return}const a=e[t].rate.findIndex((t=>t.id===s.room_type_id));if(a===-1){console.warn(`Couldn't find room type ${s.room_type_id}`);return}const n=e[t].rate[a];n.exposed_inventory.rts=s.availability;const o=n.rateplans.every((t=>!t.is_available_to_book));for(const t of n.physicalrooms){const e=`${t.id}_${s.date}`;i.set(e,{disabled:s.availability===0,reason:o?"stop_sale":"inventory"})}}T["disabled_cells"]=new Map(i);T.days=[...e]}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}x.roomsInfo=s;this.calendarData.roomsInfo=s}getLegendData(t){return t["My_Result"].calendar_legends}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}scrollToElement(t){this.scrollContainer=this.scrollContainer||this.element.querySelector(".calendarScrollContainer");const e=this.element.querySelector(".topLeftCell");const i=this.element.querySelector(".day-"+t);if(i){this.scrollContainer.scrollTo({left:0});const t=i.getBoundingClientRect();const s=this.scrollContainer.getBoundingClientRect();const a=e.getBoundingClientRect();this.scrollContainer.scrollTo({left:t.left-s.left-a.width-t.width})}}AddOrUpdateRoomBookings(t,e=undefined){let i=[...this.calendarData.bookingEvents];t.forEach((t=>{if(!this.checkBookingAvailability(t)){i=i.filter((e=>e.ID!==t.ID))}}));this.updateBookingEventsDateRange(t);if(e){i=i.filter((t=>t.POOL===e))}t.forEach((t=>{if(!i.some((e=>e.ID===t.ID))){i.push(t)}}));this.calendarData=Object.assign(Object.assign({},this.calendarData),{bookingEvents:i});const s=t=>{const e=D(this.tasksEndDate,"YYYY-MM-DD");return D(t.FROM_DATE,"YYYY-MM-DD").isSameOrBefore(e,"date")||D(t.TO_DATE,"YYYY-MM-DD").isSameOrBefore(e,"date")};if(t.some(s)){this.getHousekeepingTasks({from_date:D().format("YYYY-MM-DD"),to_date:this.tasksEndDate})}}transformDateForScroll(t){return D(t).format("D_M_YYYY")}shouldRenderCalendarView(){return this.calendarData&&this.calendarData.days&&this.calendarData.days.length}onOptionSelect(t){const e=t.detail;const i=this.element.querySelector("#iglooCalendar");switch(e.key){case"showAssigned":i.classList.remove("showLegend");i.classList.remove("showToBeAssigned");i.classList.toggle("showToBeAssigned");this.showLegend=false;this.showToBeAssigned=true;break;case"showLegend":i.classList.remove("showToBeAssigned");i.classList.remove("showLegend");i.classList.toggle("showLegend");this.showLegend=true;this.showToBeAssigned=false;break;case"calendar":let t=new Date;if(e.data.start!==undefined&&e.data.end!==undefined){t=e.data.start.toDate();this.handleDateSearch(e.data)}else{t=new Date(e.data);t.setDate(t.getDate()+1);if(!(e===null||e===void 0?void 0:e.noScroll)){this.scrollToElement(t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear())}}this.highlightedDate=this.transformDateForScroll(t);break;case"search":break;case"bulk":this.calendarSidebarState={type:"bulk-blocks",payload:null};break;case"add":if(e.data.event_type!=="EDIT_BOOKING"){this.bookingItem=e.data}else{this.editBookingItem=e.data}break;case"gotoToday":this.scrollToElement(this.today);break;case"closeSideMenu":this.closeSideMenu();this.highlightedDate="";this.showBookProperty=false;break}}async addDatesToCalendar(t,e){const[i]=await Promise.all([this.bookingService.getCalendarData(this.property_id,t,e)]);const s=i.myBookings||[];this.updateBookingEventsDateRange(s);if(new Date(t).getTime()<new Date(this.calendarData.startingDate).getTime()){this.calendarData.startingDate=new Date(t).getTime();this.calendarData.from_date=t;T.fromDate=this.calendarData.from_date;this.days=[...i.days,...this.days];let a=[...i.months];if(this.calendarData.monthsInfo[0].monthName===i.months[i.months.length-1].monthName){this.calendarData.monthsInfo[0].daysCount=this.calendarData.monthsInfo[0].daysCount+i.months[i.months.length-1].daysCount;a.pop()}let n=JSON.parse(JSON.stringify(s));n=n.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].FROM_DATE=t.FROM_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=S(t.FROM_DATE,this.calendarData.bookingEvents[e].TO_DATE);return false}return true}));T.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...a,...this.calendarData.monthsInfo],bookingEvents:[...this.calendarData.bookingEvents,...n]});if(Math.abs(D().diff(D(t,"YYYY-MM-DD"),"days"))<=10){const i=await this.toBeAssignedService.getUnassignedDates(this.property_id,t,e);this.calendarData.unassignedDates=Object.assign(Object.assign({},this.calendarData.unassignedDates),i);this.unassignedDates={fromDate:t,toDate:e,data:i};Be(i)}}else{this.calendarData.endingDate=new Date(e).getTime();this.calendarData.to_date=e;T.toDate=this.calendarData.to_date;let a=[...i.months];this.days=[...this.days,...i.days];if(this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].monthName===i.months[0].monthName){this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount=this.calendarData.monthsInfo[this.calendarData.monthsInfo.length-1].daysCount+i.months[0].daysCount;a.shift()}let n=JSON.parse(JSON.stringify(s));n=n.filter((t=>{const e=this.calendarData.bookingEvents.findIndex((e=>e.ID===t.ID));if(e!==-1){this.calendarData.bookingEvents[e].TO_DATE=t.TO_DATE;this.calendarData.bookingEvents[e].NO_OF_DAYS=S(this.calendarData.bookingEvents[e].FROM_DATE,t.TO_DATE);return false}return true}));T.days=this.days;this.calendarData=Object.assign(Object.assign({},this.calendarData),{days:this.days,monthsInfo:[...this.calendarData.monthsInfo,...a],bookingEvents:[...this.calendarData.bookingEvents,...n]});const o=await this.toBeAssignedService.getUnassignedDates(this.property_id,t,e);this.calendarData.unassignedDates=Object.assign(Object.assign({},this.calendarData.unassignedDates),o);this.unassignedDates={fromDate:t,toDate:e,data:o};Be(o)}}async handleDateSearch(t){const e=D(t.start).toDate();const i=D(this.calDates.from).toDate();const s=t.end.toDate();const a=this.calendarData.endingDate;if(e.getTime()<new Date(this.calDates.from).getTime()){await this.addDatesToCalendar(D(e).add(-1,"days").format("YYYY-MM-DD"),D(i).add(-1,"days").format("YYYY-MM-DD"));this.calDates=Object.assign(Object.assign({},this.calDates),{from:t.start.add(-1,"days").format("YYYY-MM-DD")});this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>i.getTime()&&e.getTime()<a&&s.getTime()<a){this.scrollToElement(this.transformDateForScroll(e))}else if(e.getTime()>a){const t=J(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(t,D(s).add(2,"months").format("YYYY-MM-DD"));this.scrollToElement(this.transformDateForScroll(e))}}closeSideMenu(){this.showLegend=false;this.showToBeAssigned=false}dragScrollContent(t){this.scrollViewDragging=false;let e=t&&t.target?this.hasAncestorWithClass(t.target,"preventPageScroll"):false;if(!e&&t.buttons===1){this.scrollViewDragPos={left:this.scrollContainer.scrollLeft,top:this.scrollContainer.scrollTop,x:t.clientX,y:t.clientY};document.addEventListener("mousemove",this.onScrollContentMoveHandler);document.addEventListener("mouseup",this.onScrollContentMoveEndHandler)}}calendarScrolling(){if(this.scrollContainer){if(this.highlightedDate){const t=document.querySelector(`.day-${this.highlightedDate}`);if(t){const{left:e,right:i}=t.getBoundingClientRect();const s=e>=0&&i<=window.innerWidth;if(!s){this.highlightedDate=""}}}const t=this.scrollContainer.getBoundingClientRect();let e=170;let i=t.width-e;let s=t.x+e;let a=t.x+t.width;let n=Array.from(this.element.querySelectorAll(".monthCell"));if(n.length){n.map((async t=>{let e=t.getBoundingClientRect();if(n.indexOf(t)===n.length-1){if(e.x+e.width<=a&&!this.reachedEndOfCalendar){this.reachedEndOfCalendar=true;const t=Q(new Date(this.calendarData.endingDate));const e=J(new Date(this.calendarData.endingDate));await this.addDatesToCalendar(e,t);this.reachedEndOfCalendar=false}}if(e.x+e.width<s);else if(e.x>a);else{let n=t.querySelector(".monthTitle");let o=0;let r=e.width;if(e.x<s){o=Math.abs(e.x)-s;o=e.x<0?Math.abs(e.x)+s:Math.abs(o);r=e.x+e.width>a?i:e.x+e.width-s}else{r=i-r>r?r:i-e.x+s}n.style.marginLeft=o+"px";n.style.width=r+"px"}}))}}}hasAncestorWithClass(t,e){let i=t;while(i!==null){if(i.matches(`.${e}`)){return true}i=i.parentElement}return false}async highlightDragOver(t,e){let i,s;if(e){i=this.visibleCalendarCells.x.find((t=>t.left<e.x&&e.x<=t.left+t.width));s=this.visibleCalendarCells.y.find((t=>t.top<e.y&&e.y<=t.top+t.height))}if(t&&i&&s){this.dragOverHighlightElement.emit({dragOverElement:s.id+"_"+i.id})}else{this.dragOverHighlightElement.emit({dragOverElement:""})}if(!t){this.moveBookingTo.emit({bookingId:e.id,fromRoomId:e.fromRoomId,toRoomId:s&&s.id||"revert",moveToDay:i&&i.id||"revert",pool:e.pool,from_date:Z(i&&i.id),to_date:tt(i&&i.id,e.nbOfDays)})}}handleModalConfirm(){var t;const e=()=>{this.dialogData=null};try{switch((t=this.dialogData)===null||t===void 0?void 0:t.reason){case"checkin":case"checkout":{const{bookingNumber:t,roomIdentifier:i}=this.dialogData;const s=this.dialogData.reason==="checkin"?"001":"002";this.bookingService.handleExposedRoomInOut({booking_nbr:t,room_identifier:i,status:s}).finally(e);if(this.dialogData.reason==="checkin"){this.openCalendarSidebar.emit({type:"room-guests",payload:this.dialogData.sidebarPayload})}break}case"stretch":const t=this.dialogData,i=sa(t,["reason"]);this.showRoomNightsDialog.emit(i);break;case"reallocate":{if(!this.dialogData){console.warn("No dialog data available for reallocation.");return}const{pool:t,toRoomId:i,from_date:s,to_date:a}=this.dialogData;this.eventsService.reallocateEvent(t,i,s,a).then(e).catch((()=>{console.error("Reallocation failed. Reverting booking.");this.revertBooking.emit(t)})).finally(e);break}default:e();break}}catch(t){console.error("Error handling modal confirm:",t);e()}}handleModalCancel(){var t;if(((t=this.dialogData)===null||t===void 0?void 0:t.reason)==="reallocate"||this.dialogData.reason==="stretch"){this.revertBooking.emit(this.dialogData.pool)}this.dialogData=null}handleRoomNightsDialogClose(t){if(t.detail.type==="cancel"){this.revertBooking.emit(this.roomNightsData.pool)}this.roomNightsData=null}handleSideBarToggle(t){var e;if(t.detail){this.calendarSidebarState=null;if(this.editBookingItem){this.editBookingItem=null}if(this.roomNightsData){this.revertBooking.emit(this.roomNightsData.pool);this.roomNightsData=null}if(((e=this.dialogData)===null||e===void 0?void 0:e.reason)==="reallocate"){this.revertBooking.emit(this.dialogData.pool);this.dialogData=null}}}handleCloseBookingWindow(){this.bookingItem=null}render(){var t,s,n,o,r,l,c,d,h,u,f,p,b,g,m,v,k;return e(i,{key:"95d5df566e22bd5d1de71ce7a06cec969edc629c"},e("ir-toast",{key:"eeed200fa854f1c648d1302578cc9b18234e5264"}),e("ir-interceptor",{key:"179e2239daa46338c6660e7d5a8368ba2fb4835e"}),e("div",{key:"9d7d84ff18b406e150d71ce6754187cc851be8f4",id:"iglooCalendar",class:{"igl-calendar":true,showToBeAssigned:this.showToBeAssigned,showLegend:this.showLegend}},this.shouldRenderCalendarView()?e(a,{"data-testid":"ir-calendar"},this.showToBeAssigned&&e("igl-to-be-assigned",{unassignedDatesProp:this.unassignedDates,to_date:this.to_date,from_date:this.from_date,propertyid:this.property_id,class:"tobeAssignedContainer",calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)}),this.showLegend&&e("igl-legends",{class:"legendContainer",legendData:this.calendarData.legendData,onOptionEvent:t=>this.onOptionSelect(t)}),e("div",{class:"calendarScrollContainer",onMouseDown:t=>this.dragScrollContent(t),onScroll:()=>this.calendarScrolling()},e("div",{id:"calendarContainer"},e("igl-cal-header",{unassignedDates:this.unassignedDates,to_date:this.to_date,propertyid:this.property_id,today:this.today,calendarData:this.calendarData,highlightedDate:this.highlightedDate,onOptionEvent:t=>this.onOptionSelect(t)}),e("igl-cal-body",{propertyId:this.property_id,language:this.language,countries:this.countries,currency:this.calendarData.currency,today:this.today,highlightedDate:this.highlightedDate,isScrollViewDragging:this.scrollViewDragging,calendarData:this.calendarData}),e("igl-cal-footer",{highlightedDate:this.highlightedDate,today:this.today,calendarData:this.calendarData,onOptionEvent:t=>this.onOptionSelect(t)})))):e("ir-loading-screen",{message:"Preparing Calendar Data"})),this.bookingItem&&e("igl-book-property",{key:"350222faed1bce682b377f8efafb5331914e16e5",allowedBookingSources:this.calendarData.allowedBookingSources,adultChildConstraints:this.calendarData.adultChildConstraints,showPaymentDetails:this.showPaymentDetails,countries:this.countries,currency:this.calendarData.currency,language:this.language,propertyid:this.property_id,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}),e("ir-sidebar",{key:"1ce38758686ab1417a297058fa7ab78ccfbad1d2",onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:!!this.calendarSidebarState||this.roomNightsData!==null||this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING",showCloseButton:false,sidebarStyles:{width:((t=this.calendarSidebarState)===null||t===void 0?void 0:t.type)==="room-guests"?"60rem":this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:this.editBookingItem?"#F2F3F8":"white"}},this.roomNightsData&&e("ir-room-nights",{key:"cfd13228415e414ef72b70b725570f57a551bd7d",slot:"sidebar-body",pool:this.roomNightsData.pool,onCloseRoomNightsDialog:this.handleRoomNightsDialogClose.bind(this),language:this.language,bookingNumber:this.roomNightsData.bookingNumber,identifier:this.roomNightsData.identifier,toDate:this.roomNightsData.to_date,fromDate:this.roomNightsData.from_date,defaultDates:this.roomNightsData.defaultDates,ticket:this.ticket,propertyId:this.property_id}),this.editBookingItem&&this.editBookingItem.event_type==="EDIT_BOOKING"&&e("ir-booking-details",{key:"cf11d9d2d8cbe796d6288e0eef422f846f0b577b",slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:()=>this.editBookingItem=null,is_from_front_desk:true,propertyid:this.property_id,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.editBookingItem.BOOKING_NUMBER,ticket:this.ticket,language:this.language,hasRoomAdd:true}),((s=this.calendarSidebarState)===null||s===void 0?void 0:s.type)==="room-guests"&&e("ir-room-guests",{key:"510e69860bbf788287f898325e5ee227fc032f1f",countries:this.countries,language:this.language,identifier:(o=(n=this.calendarSidebarState)===null||n===void 0?void 0:n.payload)===null||o===void 0?void 0:o.identifier,bookingNumber:(r=this.calendarSidebarState)===null||r===void 0?void 0:r.payload.bookingNumber,roomName:(c=(l=this.calendarSidebarState)===null||l===void 0?void 0:l.payload)===null||c===void 0?void 0:c.roomName,totalGuests:(h=(d=this.calendarSidebarState)===null||d===void 0?void 0:d.payload)===null||h===void 0?void 0:h.totalGuests,sharedPersons:(f=(u=this.calendarSidebarState)===null||u===void 0?void 0:u.payload)===null||f===void 0?void 0:f.sharing_persons,slot:"sidebar-body",checkIn:(b=(p=this.calendarSidebarState)===null||p===void 0?void 0:p.payload)===null||b===void 0?void 0:b.checkin,onCloseModal:()=>this.calendarSidebarState=null}),((g=this.calendarSidebarState)===null||g===void 0?void 0:g.type)==="bulk-blocks"&&e("igl-bulk-operations",{key:"f19e0fc0cce58228c33e9d8bc1fa0ee4fa4a9964",slot:"sidebar-body",property_id:this.property_id,onCloseModal:()=>this.calendarSidebarState=null})),e("ir-modal",{key:"ff4a565277db26130d08546b65a3afafed8286dc",ref:t=>this.calendarModalEl=t,modalTitle:"",rightBtnActive:((m=this.dialogData)===null||m===void 0?void 0:m.reason)==="reallocate"?!this.dialogData.hideConfirmButton:true,leftBtnText:(v=y===null||y===void 0?void 0:y.entries)===null||v===void 0?void 0:v.Lcz_Cancel,rightBtnText:(k=y===null||y===void 0?void 0:y.entries)===null||k===void 0?void 0:k.Lcz_Confirm,modalBody:this.renderModalBody(),onConfirmModal:this.handleModalConfirm.bind(this),onCancelModal:this.handleModalCancel.bind(this)}))}get element(){return n(this)}static get watchers(){return{ticket:["ticketChanged"]}}};aa.style=ia;const na=":host{--ir-acc-duration:220ms;--ir-acc-ease:cubic-bezier(0.2, 0.8, 0.2, 1);--ir-acc-border:#e5e7eb;--ir-acc-radius:6px;--ir-acc-bg:#fff;--ir-acc-focus:#3b82f6;--ir-acc-space-2:0.5rem;--ir-acc-space-3:0.75rem;--ir-acc-space-4:1rem;display:block}.ir-accordion{border:1px solid var(--ir-acc-border);border-radius:var(--ir-acc-radius);background:var(--ir-acc-bg);overflow:hidden}.ir-accordion__trigger{display:flex;align-items:center;justify-content:flex-start;gap:var(--ir-acc-space-2);width:100%;padding:var(--ir-acc-space-4);background:transparent;border:none;cursor:pointer;text-align:left;font:inherit;color:inherit;transition:background-color 0.15s ease}.ir-accordion__trigger:hover:not(:disabled){background:rgba(0, 0, 0, 0.02)}.ir-accordion__trigger:disabled{opacity:0.6;cursor:not-allowed}.ir-accordion__trigger:focus,.ir-accordion__trigger:focus-visible{outline:2px solid var(--ir-acc-focus);outline-offset:-2px}.ir-accordion__trigger:focus:not(:focus-visible){outline:none}.ir-accordion__caret{flex-shrink:0;transition:transform var(--ir-acc-duration) var(--ir-acc-ease);transform:rotate(-90deg)}.ir-accordion[data-open='true'] .ir-accordion__caret,.ir-accordion__caret.is-open{transform:rotate(0deg)}.ir-accordion__trigger-content{flex:1;min-width:0;}.ir-accordion__content{transition:height var(--ir-acc-duration) var(--ir-acc-ease);will-change:height}.ir-accordion__content:not([data-expanded='true']){height:0 !important;overflow:hidden !important;visibility:hidden}.ir-accordion__content[data-expanded='true']{visibility:visible}.ir-accordion__content-inner{padding:var(--ir-acc-space-3) var(--ir-acc-space-4)}@media (prefers-reduced-motion: reduce){.ir-accordion__caret{transition:none}.ir-accordion__content{transition:none}}";const oa=na;let ra=0;const la=class{constructor(e){t(this,e);this.irToggle=s(this,"ir-toggle",7);this.defaultExpanded=false;this.caret=true;this.caretIcon="angle-down";this._expanded=false;this.contentId=`ir-accordion-content-${++ra}`;this.isAnimating=false;this.onTriggerClick=()=>{if(this.isAnimating){return}const t=!this._expanded;this.irToggle.emit({expanded:t});this.updateExpansion(t,true)};this.onTriggerKeyDown=t=>{if((t.key==="Enter"||t.key===" ")&&!this.isAnimating){t.preventDefault();this.onTriggerClick()}}}componentWillLoad(){var t;this._expanded=(t=this.expanded)!==null&&t!==void 0?t:this.defaultExpanded}disconnectedCallback(){if(this.cleanupAnimation){this.cleanupAnimation()}}watchExpanded(t){if(t!==undefined&&t!==this._expanded){this.updateExpansion(t,false)}}updateExpansion(t,e=true){if(this.isAnimating){return}const i=this._expanded;this._expanded=t;if(i!==t){if(t){this.show()}else{this.hide()}if(e){this.irToggle.emit({expanded:t})}}}async show(){if(!this.detailsEl||!this.contentEl||this.isAnimating)return;this.isAnimating=true;this.cleanupPreviousAnimation();const t=this.detailsEl.offsetHeight;this.detailsEl.style.height=`${t}px`;this.detailsEl.style.overflow="hidden";this.detailsEl.setAttribute("data-expanded","true");const e=this.contentEl.scrollHeight;requestAnimationFrame((()=>{if(!this.detailsEl)return;this.detailsEl.style.height=`${e}px`;const t=t=>{if(t.target===this.detailsEl&&t.propertyName==="height"){this.finishOpenAnimation()}};this.cleanupAnimation=()=>{if(this.detailsEl){this.detailsEl.removeEventListener("transitionend",t)}this.isAnimating=false};this.detailsEl.addEventListener("transitionend",t);setTimeout((()=>{if(this.isAnimating){this.finishOpenAnimation()}}),300)}))}async hide(){if(!this.detailsEl||!this.contentEl||this.isAnimating)return;this.isAnimating=true;this.cleanupPreviousAnimation();const t=this.detailsEl.scrollHeight;this.detailsEl.style.height=`${t}px`;this.detailsEl.style.overflow="hidden";requestAnimationFrame((()=>{if(!this.detailsEl)return;this.detailsEl.style.height="0px";const t=t=>{if(t.target===this.detailsEl&&t.propertyName==="height"){this.finishCloseAnimation()}};this.cleanupAnimation=()=>{if(this.detailsEl){this.detailsEl.removeEventListener("transitionend",t)}this.isAnimating=false};this.detailsEl.addEventListener("transitionend",t);setTimeout((()=>{if(this.isAnimating){this.finishCloseAnimation()}}),300)}))}finishOpenAnimation(){if(this.cleanupAnimation){this.cleanupAnimation();this.cleanupAnimation=undefined}if(this.detailsEl){this.detailsEl.style.height="";this.detailsEl.style.overflow=""}this.expanded=true;this.isAnimating=false}finishCloseAnimation(){if(this.cleanupAnimation){this.cleanupAnimation();this.cleanupAnimation=undefined}if(this.detailsEl){this.detailsEl.style.height="";this.detailsEl.style.overflow="";this.detailsEl.removeAttribute("data-expanded")}this.expanded=false;this.isAnimating=false}cleanupPreviousAnimation(){if(this.cleanupAnimation){this.cleanupAnimation();this.cleanupAnimation=undefined}this.isAnimating=false}render(){const t=this._expanded;return e(i,{key:"b8d42694edb2f5f027148a8e28bd85a211cfee75"},e("div",{key:"e24663f5f31d85db9074d877adf23b0db0eed76e",part:"base",class:"ir-accordion","data-open":t?"true":"false"},e("button",{key:"3a7d4c9bf889f2d1a262c4eb3ea1b61dec7538fb",type:"button",class:"ir-accordion__trigger","aria-expanded":t?"true":"false","aria-controls":this.contentId,"aria-busy":this.isAnimating?"true":"false",onClick:this.onTriggerClick,onKeyDown:this.onTriggerKeyDown,disabled:this.isAnimating,part:"trigger"},this.caret&&e("ir-icons",{key:"14b8b3fd0098df49f9c09b968f0b819331f38f49",name:"angle-down",class:`ir-accordion__caret ${t?"is-open":""}`,"aria-hidden":"true"}),e("div",{key:"ce2ed720c50e63075795688d8616e26d4e5dbf01",class:"ir-accordion__trigger-content"},e("slot",{key:"edcf85eab135c37abfbf223cffbb20187688fca5",name:"trigger"}))),e("div",{key:"6c8633cf4c8cb2420184015d617c72b2ddfbd5bd",class:"ir-accordion__content",id:this.contentId,ref:t=>this.detailsEl=t,"data-expanded":t?"true":null,role:"region","aria-hidden":t?"false":"true"},e("div",{key:"b85e42c954f5e20403a2caf7686616bf8597310b",class:"ir-accordion__content-inner",part:"content",ref:t=>this.contentEl=t},e("slot",{key:"9823376551aa6361af7f9b2e8c00d8a77267a65e"})))))}get host(){return n(this)}static get watchers(){return{expanded:["watchExpanded"]}}};la.style=oa;const ca=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const da=ca;const ha=class{constructor(e){t(this,e);this.comboboxValue=s(this,"comboboxValue",7);this.inputCleared=s(this,"inputCleared",7);this.toast=s(this,"toast",7);this.duration=300;this.placeholder="";this.isSplitBooking=false;this.type="text";this.name="";this.inputId=ht();this.required=false;this.disabled=false;this.from_date="";this.to_date="";this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.inputFocused=false;this.bookingService=new l;this.no_result_found=""}componentWillLoad(){this.no_result_found=y.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const a=t+s;const n=a*this.selectedIndex;let o=n-e/2+t/2;o=Math.max(0,Math.min(o,i.scrollHeight-e));i.scrollTo({top:o,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return e("div",{class:`position-absolute dropdown-menu  rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,i)=>e("p",{role:"button",class:"dropdown-item",onKeyDown:t=>this.handleItemKeyDown(t,i),"data-selected":this.selectedIndex===i,tabIndex:0,onClick:()=>this.selectItem(i)},this.isSplitBooking?e(a,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):e("div",{class:"d-flex align-items-center flex-fill"},e("p",{class:"p-0 m-0"},`${t.email}`," ",e("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&e("div",{class:"loader-container d-flex align-items-center justify-content-center"},e("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&e("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return e(i,{key:"8773791624a021375cc38ac0312620d4232810bf"},e("div",{key:"200a85e5f1b4d856101635c2adf0b68e01fc887a",class:"d-flex align-items-center "},e("label",{key:"78910ba49fcf4750b1b226a06b2c8a69148ee5ff","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},e("svg",{key:"d03c7e7e8e613df9291665a2356657556fdeaf7c",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},e("path",{key:"28feedf8e68853b2544c5000fb5039e3a58380f8",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),e("input",{key:"52f111642847a2e210632094b2bb95d7f5acc98b","data-testid":this.testId,required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),autoComplete:"none",onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&e("button",{key:"0d275c618cfd0f97d5bb7c3a6f84a511c000d362",type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},e("p",{key:"85c7ae14cc5e5448ff7b51c1c7e9bc6933ecbc8c",class:"sr-only"},"clear input"),e("svg",{key:"54e86b1bbe32cd21f7122dd3ed6b472d5cafe124",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e("path",{key:"8ce526e95c8348b5a65ed6e1c142d6d357ad3f0d",d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return n(this)}};ha.style=da;class ua{async AddPayment(t,e){try{const{data:i}=await gt.post(`/Do_Payment`,{payment:Object.assign(Object.assign({},t),{book_nbr:e})});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}catch(t){console.log(t);throw new Error(t)}}async CancelPayment(t){try{const{data:e}=await gt.post(`/Cancel_Payment`,{id:t});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}catch(t){console.log(t);throw new Error(t)}}async GetExposedCancellationDueAmount(t){try{const{data:e}=await gt.post(`/Get_Exposed_Cancelation_Due_Amount`,t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}catch(t){console.log(t);throw new Error(t)}}}const fa=".sc-ir-booking-details-h{overflow-x:hidden;--ir-dialog-max-width:20rem;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-booking-details-h *.sc-ir-booking-details{font-family:inherit !important;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.font-medium.sc-ir-booking-details{font-weight:600}.sc-ir-booking-details-h th.sc-ir-booking-details{font-weight:600}.h-28.sc-ir-booking-details{height:2rem}.mx-01.sc-ir-booking-details{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}.date-margin.sc-ir-booking-details{margin-right:5px}.pickup-margin.sc-ir-booking-details{margin-bottom:7px !important}.header-date.sc-ir-booking-details{padding-left:5px !important}.pointer.sc-ir-booking-details{cursor:pointer}.sc-ir-booking-details:root{--sidebar-width:50rem}.loading-container.sc-ir-booking-details{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.sm-padding-right.sc-ir-booking-details{padding-right:0.2rem}.sm-padding-left.sc-ir-booking-details{padding-left:0.2rem}.sm-padding-top.sc-ir-booking-details{padding-top:0.2rem}.sm-padding-bottom.sc-ir-booking-details{padding-bottom:0.2rem}.info-notes.sc-ir-booking-details{list-style:none;padding-left:0}.light-blue-bg.sc-ir-booking-details{background-color:#acecff;padding:0.2rem 0.3rem}.iframeHeight.sc-ir-booking-details{height:17.5rem}.dialog-title.sc-ir-booking-details{width:fit-content}";const pa=fa;const ba=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.bookingChanged=s(this,"bookingChanged",7);this.closeSidebar=s(this,"closeSidebar",7);this.language="en";this.ticket="";this.bookingNumber="";this.is_from_front_desk=false;this.hasPrint=false;this.hasReceipt=false;this.hasDelete=false;this.hasMenu=false;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.hasCloseButton=false;this.bookingItem=null;this.statusData=[];this.calendarData={};this.guestData=null;this.rerenderFlag=false;this.sidebarState=null;this.isUpdateClicked=false;this.isPMSLogLoading=false;this.modalState=null;this.bookingService=new l;this.roomService=new bt;this.paymentService=new ua;this.token=new pt;this.printingBaseUrl="https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2"}componentWillLoad(){if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}handleSideBarEvents(t){this.sidebarState=t.detail.type;this.sidebarPayload=t.detail.payload}handleIconClick(t){const e=t.target;switch(e.id){case"pickup":this.sidebarState="pickup";return;case"close":this.closeSidebar.emit(null);return;case"email":this.modalState={type:"email",message:y.entries.Lcz_EmailBookingto.replace("%1",this.booking.guest.email),loading:ut("/Send_Booking_Confirmation_Email")};this.modalRef.openModal();return;case"print":this.openPrintingScreen();return;case"receipt":this.openPrintingScreen("invoice");return;case"book-delete":return;case"menu":window.location.href="https://x.igloorooms.com/manage/acbookinglist.aspx";return;case"room-add":this.bookingItem={ID:"",NAME:this.booking.guest.last_name,EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,ARRIVAL:this.booking.arrival,TO_DATE:this.booking.to_date,TITLE:`${y.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,defaultDateRange:{fromDate:new Date(this.booking.from_date),fromDateStr:"",toDate:new Date(this.booking.to_date),toDateStr:"",dateDifference:0,message:""},event_type:"ADD_ROOM",booking:this.booking,BOOKING_NUMBER:this.booking.booking_nbr,ADD_ROOM_TO_BOOKING:this.booking.booking_nbr,GUEST:this.booking.guest,message:this.booking.remark,SOURCE:this.booking.source,ROOMS:this.booking.rooms};return;case"extra_service_btn":this.sidebarState="extra_service";return;case"add-payment":return}}async handleResetExposedCancellationDueAmount(t){t.stopImmediatePropagation();t.stopPropagation();const e=await this.paymentService.GetExposedCancellationDueAmount({booking_nbr:this.booking.booking_nbr,currency_id:this.booking.currency.id});this.paymentActions=[...e]}handleEditInitiated(t){this.bookingItem=t.detail}handleRoomGuestsUpdate(t){const{identifier:e,guests:i}=t.detail;const s=[...this.booking.rooms];let a=s.findIndex((t=>t.identifier===e));if(a===-1){return}const n=s[a];const o=Object.assign(Object.assign({},n),{sharing_persons:i});s[a]=o;this.booking=Object.assign(Object.assign({},this.booking),{rooms:[...s]})}async handleResetBooking(t){if(t.detail){return this.booking=t.detail}await this.resetBooking()}handleEditExtraService(t){this.selectedService=t.detail;this.sidebarState="extra_service"}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){var t,e;try{const[i,s,a,n,o]=await Promise.all([this.roomService.getExposedProperty({id:this.propertyid||0,language:this.language,aname:this.p}),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language),this.bookingService.getExposedBooking(this.bookingNumber,this.language),this.bookingService.getSetupEntriesByTableNameMulti(["_BED_PREFERENCE_TYPE","_DEPARTURE_TIME","_PAY_TYPE","_PAY_TYPE_GROUP","_PAY_METHOD"])]);this.property_id=(t=i===null||i===void 0?void 0:i.My_Result)===null||t===void 0?void 0:t.id;const{bed_preference_type:r,departure_time:l,pay_type:c,pay_type_group:d,pay_method:h}=this.bookingService.groupEntryTablesResult(o);this.bedPreference=r;this.departureTime=l;this.paymentEntries={types:c,groups:d,methods:h};if((n===null||n===void 0?void 0:n.booking_nbr)&&((e=n===null||n===void 0?void 0:n.currency)===null||e===void 0?void 0:e.id)&&n.is_direct){this.paymentService.GetExposedCancellationDueAmount({booking_nbr:n.booking_nbr,currency_id:n.currency.id}).then((t=>{this.paymentActions=t}))}if(!(y===null||y===void 0?void 0:y.entries)){y.entries=s.entries;y.direction=s.direction}this.countries=a;const u=i===null||i===void 0?void 0:i.My_Result;if(u){const{allowed_payment_methods:t,currency:e,allowed_booking_sources:s,adult_child_constraints:a,calendar_legends:n,aname:o}=u;this.printingBaseUrl=this.printingBaseUrl.replace("%1",o).replace("%2",this.bookingNumber);this.calendarData={currency:e,allowed_booking_sources:s,adult_child_constraints:a,legendData:n};this.setRoomsData(i);const r=["001","004"];this.showPaymentDetails=t===null||t===void 0?void 0:t.some((t=>r.includes(t.code)))}else{console.warn("Room response is missing 'My_Result'.")}this.guestData=n.guest;this.booking=n}catch(t){console.error("Error initializing app:",t)}}async openPrintingScreen(t="print",e="new"){if(e==="old"){if(t==="invoice"){return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`)}return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`)}let i=this.printingBaseUrl;if(t==="invoice"){i=i+"&mode=invoice"}const{data:s}=await gt.post(`Get_ShortLiving_Token`);if(!s.ExceptionMsg){i=i+`&token=${s.My_Result}`}window.open(i)}handleCloseBookingWindow(){this.bookingItem=null}handleDeleteFinish(t){this.booking=Object.assign(Object.assign({},this.booking),{rooms:this.booking.rooms.filter((e=>e.identifier!==t.detail))})}async resetBooking(){try{const t=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);this.booking=Object.assign({},t);this.bookingChanged.emit(this.booking)}catch(t){console.log(t)}}async handleModalConfirm(t){t.stopImmediatePropagation();t.stopPropagation();switch(this.modalState.type){case"email":await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr,this.language);break}this.modalState=null;this.modalRef.closeModal()}renderSidebarContent(){var t,i,s,a,n,o;const r=()=>{this.sidebarState=null};switch(this.sidebarState){case"guest":return e("ir-guest-info",{isInSideBar:true,headerShown:true,slot:"sidebar-body",booking_nbr:this.bookingNumber,email:(t=this.booking)===null||t===void 0?void 0:t.guest.email,language:this.language,onCloseSideBar:r});case"pickup":return e("ir-pickup",{bookingDates:{from:this.booking.from_date,to:this.booking.to_date},slot:"sidebar-body",defaultPickupData:this.booking.pickup_info,bookingNumber:this.booking.booking_nbr,numberOfPersons:this.booking.occupancy.adult_nbr+this.booking.occupancy.children_nbr,onCloseModal:r});case"extra_note":return e("ir-booking-extra-note",{slot:"sidebar-body",booking:this.booking,onCloseModal:()=>this.sidebarState=null});case"extra_service":return e("ir-extra-service-config",{service:this.selectedService,booking:{from_date:this.booking.from_date,to_date:this.booking.to_date,booking_nbr:this.booking.booking_nbr,currency:this.booking.currency},slot:"sidebar-body",onCloseModal:()=>{r();if(this.selectedService){this.selectedService=null}}});case"room-guest":return e("ir-room-guests",{countries:this.countries,language:this.language,identifier:(i=this.sidebarPayload)===null||i===void 0?void 0:i.identifier,bookingNumber:this.booking.booking_nbr,roomName:(s=this.sidebarPayload)===null||s===void 0?void 0:s.roomName,totalGuests:(a=this.sidebarPayload)===null||a===void 0?void 0:a.totalGuests,sharedPersons:(n=this.sidebarPayload)===null||n===void 0?void 0:n.sharing_persons,slot:"sidebar-body",checkIn:(o=this.sidebarPayload)===null||o===void 0?void 0:o.checkin,onCloseModal:r});case"payment-folio":return e("ir-payment-folio",{bookingNumber:this.booking.booking_nbr,paymentEntries:this.paymentEntries,slot:"sidebar-body",payment:this.sidebarPayload.payment,mode:this.sidebarPayload.mode,onCloseModal:r});default:return null}}render(){var t,i,s;if(!this.booking){return e("div",{class:"loading-container"},e("ir-spinner",null))}return[e(a,null,!this.is_from_front_desk&&e(a,null,e("ir-toast",null),e("ir-interceptor",null))),e("ir-booking-header",{booking:this.booking,hasCloseButton:this.hasCloseButton,hasDelete:this.hasDelete,hasMenu:this.hasMenu,hasPrint:this.hasPrint,hasReceipt:this.hasReceipt,hasEmail:["001","002"].includes((i=(t=this.booking)===null||t===void 0?void 0:t.status)===null||i===void 0?void 0:i.code)}),e("div",{class:"fluid-container p-1 text-left mx-0"},e("div",{class:"row m-0"},e("div",{class:"col-12 p-0 mx-0 pr-lg-1 col-lg-6"},e("ir-reservation-information",{countries:this.countries,booking:this.booking}),e("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},e("ir-date-view",{from_date:this.booking.from_date,to_date:this.booking.to_date}),this.hasRoomAdd&&this.booking.is_editable&&e("ir-button",{id:"room-add",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),e("div",{class:"card p-0 mx-0"},this.booking.rooms.map(((t,i)=>{const s=this.handleRoomCheckin(t);const a=this.handleRoomCheckout(t);return[e("ir-room",{room:t,property_id:this.property_id,language:this.language,departureTime:this.departureTime,bedPreferences:this.bedPreference,isEditable:this.booking.is_editable,legendData:this.calendarData.legendData,roomsInfo:this.calendarData.roomsInfo,myRoomTypeFoodCat:t.roomtype.name,mealCodeName:t.rateplan.short_name,currency:this.booking.currency.symbol,hasRoomEdit:this.hasRoomEdit&&this.booking.status.code!=="003"&&this.booking.is_direct,hasRoomDelete:this.hasRoomDelete&&this.booking.status.code!=="003"&&this.booking.is_direct,hasCheckIn:s,hasCheckOut:a,booking:this.booking,bookingIndex:i,onDeleteFinished:this.handleDeleteFinish.bind(this)}),i!==this.booking.rooms.length-1&&e("hr",{class:"mr-2 ml-2 my-0 p-0"})]}))),e("ir-pickup-view",{booking:this.booking}),e("section",null,e("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},e("p",{class:"font-size-large p-0 m-0 "},y.entries.Lcz_ExtraServices),e("ir-button",{id:"extra_service_btn",icon_name:"square_plus",variant:"icon",style:{"--icon-size":"1.5rem"}})),e("ir-extra-services",{booking:{booking_nbr:this.booking.booking_nbr,currency:this.booking.currency,extra_services:this.booking.extra_services}}))),e("div",{class:"col-12 p-0 m-0 pl-lg-1 col-lg-6"},e("ir-payment-details",{paymentEntries:this.paymentEntries,paymentActions:this.paymentActions,booking:this.booking})))),e("ir-modal",{modalBody:(s=this.modalState)===null||s===void 0?void 0:s.message,leftBtnText:y.entries.Lcz_Cancel,rightBtnText:y.entries.Lcz_Confirm,autoClose:false,isLoading:ut("/Send_Booking_Confirmation_Email"),ref:t=>this.modalRef=t,onConfirmModal:t=>{this.handleModalConfirm(t)},onCancelModal:()=>{this.modalRef.closeModal()}}),e("ir-sidebar",{open:this.sidebarState!==null,side:"right",id:"editGuestInfo",style:{"--sidebar-width":this.sidebarState==="room-guest"?"60rem":undefined},onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.sidebarState=null},showCloseButton:false},this.renderSidebarContent()),e(a,null,this.bookingItem&&e("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countries:this.countries,currency:this.calendarData.currency,language:this.language,propertyid:this.property_id,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))]}handleRoomCheckout(t){if(!x.checkin_enabled||x.is_automatic_check_in_out){return false}return t.in_out.code==="001"}handleRoomCheckin(t){if(!x.checkin_enabled||x.is_automatic_check_in_out){return false}if(!t.unit){return false}if(t.in_out&&t.in_out.code!=="000"){return false}if(D().isSameOrAfter(D(t.from_date,"YYYY-MM-DD"),"days")&&D().isBefore(D(t.to_date,"YYYY-MM-DD"),"days")){return true}return false}get element(){return n(this)}static get watchers(){return{ticket:["ticketChanged"]}}};ba.style=pa;const ga=".sc-ir-booking-email-logs-h{display:block}";const ma=ga;const va=class{constructor(e){t(this,e);this.token=new pt}componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}}handleTicketChange(){if(this.ticket){this.token.setToken(this.ticket)}}render(){return e(i,{key:"71d14432720339eb300b3e855cb9b83f1dbd56d7",class:"p-1"},e("ir-interceptor",{key:"4a441418de2e2875c34925ba4d10dde4a7b163da",handledEndpoints:["/Get_Email_log_By_BOOK_NBR"]}),e("ir-toast",{key:"eafb08d7ce3b143a9814a0311389c20019750ffa"}),e("div",{key:"c91dbd5580dcd48cbbe538a89f20684e6b4220ad",class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},e("ir-input-text",{key:"5096d9a5be4ad20976b8a94bfe15ceced7741184",class:"m-0",inputContainerStyle:{margin:"0"},value:this.bookingNumber,onTextChange:t=>this.bookingNumber=t.detail,placeholder:"booking number"}),e("ir-button",{key:"ebfd030345afa474a1cd3c1cdd8a0a3e0aad5247",size:"sm",text:"search",onClickHandler:async()=>{const{data:t}=await gt.post("/Get_Email_log_By_BOOK_NBR",{BOOK_NBR:this.bookingNumber});if(t.ExceptionMsg){return}this.data=t.My_Result}})),e("p",{key:"c7c46b827c106dc9b22bee933ae563ec83aa638f"},JSON.stringify(this.data,null,2)))}static get watchers(){return{ticket:["handleTicketChange"]}}};va.style=ma;const ya=".sc-ir-booking-extra-note-h{display:block}";const ka=ya;const wa=".sc-ir-booking-extra-note-h{height:100%}.sheet-container.sc-ir-booking-extra-note{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-booking-extra-note{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-booking-extra-note{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-booking-extra-note{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-booking-extra-note{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-booking-extra-note{flex-direction:row;align-items:center}}";const xa=wa;const _a=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.isLoading=false;this.note="";this.bookingService=new l}componentWillLoad(){if(this.booking.extras){this.setNote(X(this.booking.extras))}}setNote(t){this.note=t}async savePrivateNote(){try{this.isLoading=true;let t=this.booking.extras||[];const e={key:"private_note",value:this.note};if(t.length===0){t.push(e)}else{const i=t.findIndex((t=>t.key==="private_note"));if(i===-1){t.push(e)}else{t[i]=e}}const i=await this.bookingService.doReservation({assign_units:true,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,booking:this.booking,Is_Non_Technical_Change:true,extras:t});this.resetBookingEvt.emit(i);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return e("form",{key:"102c307fa4cde38c7f4ba91dc9a5fa8735097b09",class:"sheet-container h-100",onSubmit:t=>{t.preventDefault();this.savePrivateNote()}},e("ir-title",{key:"3f782610a879434699c9ebb3b23cb3d6cd1b2e53",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:y.entries.Lcz_PrivateNote,displayContext:"sidebar"}),e("div",{key:"6949926b1deb312ed33c825f529038dfd7bc9b27",class:"sheet-body px-1"},e("ir-textarea",{key:"e64dd33ac84eb6d71ab0c363cdc524c9d336314f",placeholder:y.entries.Lcz_PrivateNote_MaxChar,label:"",value:this.note,maxLength:150,onTextChange:t=>this.setNote(t.detail)})),e("div",{key:"b8c2233c042dff0e6749257abb4f7c642206efd7",class:"sheet-footer"},e("ir-button",{key:"3cd692a29b35917dc21d5e2ca2a354b64d5d770f",onClickHandler:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`,text:y.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{key:"4428660d719e92ae8dbf2714ccba94f73fd64e0f",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center ml-sm-1",isLoading:this.isLoading,text:y.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"})))}};_a.style=ka+xa;const Da=".sc-ir-booking-guarantee-h{display:block}.sc-ir-booking-guarantee-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-booking-guarantee-h *.sc-ir-booking-guarantee{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.iframeHeight.sc-ir-booking-guarantee{height:max-content;height:22.5rem}";const Ca=Da;const Oa=class{constructor(e){t(this,e);this.collapsed=false;this.paymentDetailsUrl="";this.paymentExceptionMessage=""}async componentWillLoad(){}formatCurrency(t,e,i="en-US"){if(!e||t<0){return""}return new Intl.NumberFormat(i,{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}checkPaymentCode(t){var e,i,s;return(s=(i=(e=x.allowed_payment_methods)===null||e===void 0?void 0:e.find((e=>e.code===t)))===null||i===void 0?void 0:i.description)!==null&&s!==void 0?s:null}getPaymentMethod(){var t,e,i,s;let a=null;const n=(e=(t=this.booking)===null||t===void 0?void 0:t.extras)===null||e===void 0?void 0:e.find((t=>t.key==="payment_code"));if(this.booking.agent){const t=(s=(i=this.booking)===null||i===void 0?void 0:i.extras)===null||s===void 0?void 0:s.find((t=>t.key==="agent_payment_mode"));if(t){a=t.value==="001"?y.entries.Lcz_OnCredit:n?this.checkPaymentCode(n.value):null}}else if(n){a=this.checkPaymentCode(n.value)}return a}async handleToggleCollapse(){if(!this.booking.is_direct&&this.booking.channel_booking_nbr&&!this.booking.guest.cci&&!this.collapsed){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.booking.booking_nbr)}this.collapsed=!this.collapsed}shouldShowGuarantee(){const t=this.booking.is_direct?this.getPaymentMethod():null;return this.booking.is_direct?Boolean(t||this.booking.guest.cci):true}shouldShowToggleButton(){return!this.booking.is_direct||this.booking.is_direct&&this.booking.guest.cci}renderCreditCardInfo(){const{cci:t}=this.booking.guest;if(!t)return null;return[e("div",null,t&&"Card:"," ",e("span",null,t.nbr||""),t.expiry_month&&" Expiry: ",e("span",null,t.expiry_month||"",t.expiry_year&&"/"+t.expiry_year)),e("div",null,t.holder_name&&"Name:"," ",e("span",null,t.holder_name||""),t.cvc&&" - CVC:"," ",e("span",null,t.cvc||""))]}renderCollapsedContent(){if(this.booking.guest.cci){return this.renderCreditCardInfo()}if(this.paymentDetailsUrl){return e("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"})}return e("div",{class:"text-center"},this.paymentExceptionMessage)}renderOtaGuarantee(){var t,i,s;const{ota_guarante:a}=this.booking;if(!a||this.booking.is_direct)return null;return e("div",null,e("ir-label",{content:a.card_type+`${a.is_virtual?" (virtual)":""}`,labelText:`${y.entries.Lcz_CardType}:`}),e("ir-label",{content:a.cardholder_name,labelText:`${y.entries.Lcz_CardHolderName}:`}),e("ir-label",{content:a.card_number,labelText:`${y.entries.Lcz_CardNumber}:`}),e("ir-label",{content:this.formatCurrency(et(Number((t=a.meta)===null||t===void 0?void 0:t.virtual_card_current_balance),Number((i=a.meta)===null||i===void 0?void 0:i.virtual_card_decimal_places)),(s=a.meta)===null||s===void 0?void 0:s.virtual_card_currency_code),labelText:`${y.entries.Lcz_CardBalance}:`}))}render(){if(!this.shouldShowGuarantee()){return null}const t=this.booking.is_direct?this.getPaymentMethod():null;return e("div",{class:"mb-1"},e("div",{class:"d-flex align-items-center"},e("span",{class:"mr-1 font-medium"},y.entries.Lcz_BookingGuarantee,t&&e("span",null,": ",t)),this.shouldShowToggleButton()&&e("ir-button",{id:"drawer-icon","data-toggle":"collapse","data-target":".guarrantee","aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",variant:"icon",icon_name:"credit_card",onClickHandler:this.handleToggleCollapse.bind(this)})),e("div",{class:"collapse guarrantee"},this.renderCollapsedContent()),this.renderOtaGuarantee())}};Oa.style=Ca;const Ma=".sc-ir-booking-header-h{display:block}.confirmed.sc-ir-booking-header{color:#fff;display:flex;align-items:center}.bg-ir-green.sc-ir-booking-header{background:#629a4c;padding:0.2rem 0.3rem}.bg-ir-red.sc-ir-booking-header{background:#ff4961;padding:0.2rem 0.3rem}.bg-ir-orange.sc-ir-booking-header{background:#ff9149;padding:0.2rem 0.3rem}";const Ea=Ma;const Ya=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.closeSidebar=s(this,"closeSidebar",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.openSidebar=s(this,"openSidebar",7);this.hasEmail=true;this.bookingStatus=null;this.confirmationBG={"001":"bg-ir-orange","002":"bg-ir-green","003":"bg-ir-red","004":"bg-ir-red"};this.bookingService=new l;this.alertMessage=`ALERT! Modifying an OTA booking will create a discrepancy between igloorooms and the source. Future guest modifications on the OTA may require manual adjustmentsofthebooking.`}handleSelectChange(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.target;this.bookingStatus=e.selectedValue}async updateStatus(){if(!this.bookingStatus||this.bookingStatus==="-1"){this.toast.emit({type:"error",description:"",title:y.entries.Lcz_SelectStatus,position:"top-right"});return}try{await this.bookingService.changeExposedBookingStatus({book_nbr:this.booking.booking_nbr,status:this.bookingStatus});this.toast.emit({type:"success",description:"",title:y.entries.Lcz_StatusUpdatedSuccessfully,position:"top-right"});this.bookingStatus=null;this.resetBookingEvt.emit(null)}catch(t){console.log(t)}}openDialog(t){const{type:e}=t;this.currentDialogStatus=e;this.dialogRef.openModal()}renderDialogBody(){switch(this.currentDialogStatus){case"pms":return e("ir-pms-logs",{slot:"modal-body",bookingNumber:this.booking.booking_nbr});case"events-log":return e("ir-events-log",{booking:this.booking,slot:"modal-body",bookingNumber:this.booking.booking_nbr})}}render(){var t,i;const s=this.booking.ota_manipulations?this.booking.ota_manipulations[this.booking.ota_manipulations.length-1]:null;return e("div",{key:"30ddd492ce59575592f5d80d997679acde455740",class:"fluid-container px-1"},e("div",{key:"5a7a4812b37736ae388f559827423a3ea29acf0a",class:"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1"},e("div",{key:"53b1f01da142328fd4082af388ce7d88e057f5e2",class:"m-0 p-0 mb-1 mb-lg-0 mt-md-0"},e("p",{key:"6873463ecb14a3e222aeb0a6f8e4bea4462900cc",class:"font-size-large m-0 p-0"},`${y.entries.Lcz_Booking}#${this.booking.booking_nbr}`),e("p",{key:"768be3c66846fd5565687a5bda398e6f48fccb58",class:"m-0 p-0"},!this.booking.is_direct&&e("span",{key:"c60255b5394ccf51a9603d2dc92693eeec9f3c4f",class:"mr-1 m-0"},this.booking.channel_booking_nbr))),e("div",{key:"8814531a2bb9e4bec62a3f01a7a14942b2bf8a06",class:"d-flex justify-content-end align-items-center",style:{gap:"1rem",flexWrap:"wrap"}},e("div",{key:"fa66f51ca5ae1c4c81b975e14ba74aaf7b16dce7",class:"d-flex flex-column align-items-center"},e("span",{key:"6ecac89fb523d42123a2d6b92462335fa0380dd4",class:`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.is_requested_to_cancel?"003":this.booking.status.code]}`},this.booking.is_requested_to_cancel?y.entries.Lcz_CancellationRequested:this.booking.status.description),s&&e("ir-popover",{key:"19fb0cba89b0b5c0eec81db45cf35e9e8940520b",trigger:"hover",renderContentAsHtml:true,content:`<div><p>Modified by ${s.user} at ${s.date} ${s.hour}:${s.minute}.</p>\n                <p>${this.alertMessage}</p></div>`},e("p",{key:"ee5811df2c03cdcf38a01488a6e8f6be883849bb",class:"mx-0 p-0 small text-danger",style:{marginTop:"0.25rem",marginBottom:"0"}},e("b",{key:"ca4fdf0e7f33573eedc856f946a4279dfc13367c"},"Modified")))),this.booking.allowed_actions.length>0&&this.booking.is_editable&&e("div",{key:"9020e7a7ef42b83f6323d00d91526456880fb2ab",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.25rem"}},e("ir-select",{key:"30b857194f2a2885060fa990de9d4b0ea793473a",selectContainerStyle:"h-28",selectStyles:"d-flex status-select align-items-center h-28",firstOption:y.entries.Lcz_Select,id:"update-status",size:"sm","label-available":"false",data:this.booking.allowed_actions.map((t=>({text:t.description,value:t.code}))),textSize:"sm",class:"sm-padding-right m-0 ",selectedValue:this.bookingStatus}),e("ir-button",{key:"8ccb7d2ff690c6a05e1f629994c0bc6109836295",onClickHandler:()=>{if(!this.booking.is_direct){this.modalEl.openModal();return}this.updateStatus()},btn_styles:"h-28",isLoading:ut("/Change_Exposed_Booking_Status"),btn_disabled:ut("/Change_Exposed_Booking_Status"),id:"update-status-btn",size:"sm",text:"Update"})),e("ir-button",{key:"9505dbdf5da862241afa8eff254c6e4f31c2a3a0",size:"sm",btn_color:"outline",text:y.entries.Lcz_EventsLog,onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openDialog({type:"events-log"})}}),x.is_pms_enabled&&e("ir-button",{key:"59072d6b196a98625a1f824e42fa192f88dcff25",size:"sm",btn_color:"outline",text:y.entries.Lcz_pms,onClick:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openDialog({type:"pms"})}}),this.hasReceipt&&e("ir-button",{key:"bd433e96319b59153bdc7934e0b6b67d2813a247",variant:"icon",id:"receipt",icon_name:"reciept",class:"",style:{"--icon-size":"1.65rem"}}),this.hasPrint&&e("ir-button",{key:"0b529fc81cd818d0c75d9fe069e323c3a95078e8",variant:"icon",id:"print",icon_name:"print",class:"",style:{"--icon-size":"1.65rem"}}),this.hasEmail&&e("ir-button",{key:"a9c3853c979b295cf0c000ffae1bea8da368fd18",variant:"icon",id:"email",title:"Email this booking",icon_name:"email",class:"",style:{"--icon-size":"1.65rem"}}),this.hasDelete&&e("ir-button",{key:"4f8976307db16e480ba6d78897a4d811f818efb2",variant:"icon",id:"book-delete",icon_name:"trash",class:"",style:Object.assign(Object.assign({},wt.danger),{"--icon-size":"1.65rem"})}),this.hasMenu&&e("ir-button",{key:"48a67eedd8ac9c0491bb1cbb04fb3fdc515bb1b6",variant:"icon",class:"mr-1",id:"menu",icon_name:"menu_list",style:{"--icon-size":"1.65rem"}}),this.hasCloseButton&&e("ir-button",{key:"be1a63dcdcc3d1f9dc7e57e1c0075be46dabf933",id:"close",variant:"icon",style:{"--icon-size":"1.65rem"},icon_name:"xmark",class:"ml-2",onClickHandler:t=>{t.stopPropagation();t.stopImmediatePropagation();this.closeSidebar.emit(null)}}))),e("ir-dialog",{key:"51e552d046ff5d0675b066b0432b18efc3968522",onOpenChange:t=>{if(!t.detail){this.currentDialogStatus=null}},style:this.currentDialogStatus==="events-log"&&{"--ir-dialog-max-width":"max-content"},ref:t=>this.dialogRef=t},this.renderDialogBody()),e("ir-modal",{key:"7c9681b34b38c0cf261c5c2e20f00728f54219ff",ref:t=>this.modalEl=t,modalTitle:"",leftBtnText:(t=y===null||y===void 0?void 0:y.entries)===null||t===void 0?void 0:t.Lcz_Cancel,rightBtnText:(i=y===null||y===void 0?void 0:y.entries)===null||i===void 0?void 0:i.Lcz_Confirm,modalBody:y.entries.Lcz_OTA_Modification_Alter,isLoading:ut("/Change_Exposed_Booking_Status"),onConfirmModal:this.updateStatus.bind(this)}))}};Ya.style=Ea;const Aa={channels:[],settlement_methods:[],statuses:[],types:[],token:"",rowCount:10,bookings:[],balance_filter:[],userSelection:{from:D().add(-7,"days").format("YYYY-MM-DD"),to:D().format("YYYY-MM-DD"),channel:"",balance_filter:null,property_id:null,start_row:0,end_row:20,total_count:0,filter_type:null,name:"",book_nbr:"",booking_status:"",affiliate_id:0,is_mpo_managed:false,is_mpo_used:false,is_for_mobile:false,is_combined_view:false,is_to_export:false},download_url:null};const{state:Ta,onChange:Sa}=k(Aa);function Ba(){Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),{channel:"",booking_status:Ta.statuses[0].code,filter_type:Ta.types[0].id,book_nbr:"",name:"",from:D().add(-7,"days").format("YYYY-MM-DD"),to:D().format("YYYY-MM-DD"),start_row:0,end_row:Ta.rowCount,balance_filter:Ta.balance_filter[0].value})}function Ia(t){Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),t)}function ja(t,e){Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),{[t]:e})}class za{async getExposedBookingsCriteria(t){const{data:e}=await gt.post(`/Get_Exposed_Bookings_Criteria`,{property_id:t});const i=e.My_Result;Ta.channels=i.channels;Ta.settlement_methods=i.settlement_methods;Ta.statuses=i.statuses;Ta.types=i.types;Ta.balance_filter=i.balance_filter;Ba()}async getExposedBookings(t){const{data:e}=await gt.post(`/Get_Exposed_Bookings`,Object.assign(Object.assign({},t),{extras:C}));const i=e.My_Result;const s=e.My_Params_Get_Exposed_Bookings;Ta.bookings=[...i];Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),{total_count:s.total_count});Ta.download_url=s.exported_data_url}async removeExposedBooking(t,e){await gt.post(`/Remove_Exposed_Booking`,{booking_nbr:t,is_to_revover:e})}}function Na(){const t=new URLSearchParams(window.location.search);const e={};for(const[i,s]of t.entries()){e[i]=s}return e}const Ra=".sc-ir-booking-listing-h{display:block;height:100%}.logo.sc-ir-booking-listing{height:2rem;width:2rem}.card.sc-ir-booking-listing{overflow-x:auto}.secondary-p.sc-ir-booking-listing{font-size:12px !important}.room-service.sc-ir-booking-listing{display:flex;align-items:center;justify-content:space-between;gap:0.5rem;width:100%;padding:0.25rem 0}.room-name-container.sc-ir-booking-listing{background:#acecff;padding:0.1rem 0.3rem;border-radius:5px}.h-screen.sc-ir-booking-listing{height:100%}.price-span.sc-ir-booking-listing{margin:0;margin-right:5px}.main-container.sc-ir-booking-listing{height:100%;overflow-y:auto}.badge.ct_ir_badge.sc-ir-booking-listing{padding:0.2rem 0.3rem}.yellow_dot.sc-ir-booking-listing{height:0.5rem;width:0.5rem;height:0.5rem;width:0.8rem;border-radius:50%;background:rgb(244, 213, 82);margin-left:0.5rem;display:inline-flex;padding:0;margin:0}.booking_name.sc-ir-booking-listing{display:flex;align-items:center;gap:0.4rem}.bg-ir-red.sc-ir-booking-listing{background:#ff4961;padding:0.2rem 0.3rem}.due-btn.sc-ir-booking-listing{border:1px solid #ff4961;color:#ff4961;cursor:pointer;padding:1px 0.25rem !important;font-size:12px !important}.due-btn.sc-ir-booking-listing:hover{background:#ff4961;color:white}.booking_number.sc-ir-booking-listing{all:unset;cursor:pointer}.booking_number.sc-ir-booking-listing:hover{color:#1e9ff2}.in-out.sc-ir-booking-listing{width:150px !important}.booking_guest_name.sc-ir-booking-listing{width:fit-content;padding:0 !important;margin:0}.booking_guest_name.sc-ir-booking-listing .button-text.sc-ir-booking-listing{padding:0 !important}.buttons-container.sc-ir-booking-listing{gap:10px}td.sc-ir-booking-listing ul.sc-ir-booking-listing{width:max-content !important}td.sc-ir-booking-listing{width:max-content !important}.date-p.sc-ir-booking-listing{width:max-content !important;min-width:100%;text-align:center !important}.booking-label-gap.sc-ir-booking-listing{gap:5px}@media (min-width: 1024px){.yellow_dot.sc-ir-booking-listing{height:0.5rem;width:0.5rem}}";const $a=Ra;const Fa=class{constructor(e){t(this,e);this.language="";this.ticket="";this.rowCount=10;this.isLoading=false;this.currentPage=1;this.totalPages=1;this.oldStartValue=0;this.editBookingItem=null;this.showCost=false;this.bookingListingService=new za;this.bookingService=new l;this.roomService=new bt;this.token=new pt;this.statusColors={"001":"badge-warning","002":"badge-success","003":"badge-danger","004":"badge-danger"}}componentWillLoad(){if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}ja("end_row",this.rowCount);Ta.rowCount=this.rowCount;if(this.ticket!==""){Ta.token=this.ticket;this.token.setToken(this.ticket);this.initializeApp()}Sa("userSelection",(async t=>{const e=t.total_count;this.totalPages=Math.ceil(e/this.rowCount)}));Sa("bookings",(async t=>{this.showCost=t.some((t=>t.financial.gross_cost!==null&&t.financial.gross_cost>0))}))}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);Ta.token=this.ticket;this.initializeApp()}async initializeApp(){try{this.isLoading=true;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}let t=this.propertyid;if(!t){const e=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true});t=e.My_Result.id}const e=[this.bookingService.getSetupEntriesByTableNameMulti(["_PAY_TYPE","_PAY_TYPE_GROUP","_PAY_METHOD"]),this.bookingListingService.getExposedBookingsCriteria(t),this.roomService.fetchLanguage(this.language,["_BOOKING_LIST_FRONT"])];if(this.propertyid){e.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true}))}const[i]=await Promise.all(e);const{pay_type:s,pay_type_group:a,pay_method:n}=this.bookingService.groupEntryTablesResult(i);this.paymentEntries={groups:a,methods:n,types:s};ja("property_id",t);await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{is_to_export:false}))}catch(t){console.error(t)}finally{this.isLoading=false}}handleSideBarToggle(t){if(t.detail){this.editBookingItem=null}}geSearchFiltersFromParams(){const t=Na();if(t){console.log("update params");let e={};if(t.e){e["end_row"]=Number(t.e)}if(t.s){e["start_row"]=Number(t.s)}if(t.status){e["booking_status"]=t.status}if(t.filter){e["filter_type"]=t.filter}if(t.from){e["from"]=t.from}if(t.to){e["to"]=t.to}Ia(e)}console.log("params=>",t)}getPaginationBounds(){const t=Ta.userSelection.total_count;const e=(this.currentPage-1)*this.rowCount;let i=this.currentPage*this.rowCount;i=i>t?t:i;return{startItem:e,endItem:i,totalCount:t}}openModal(){this.listingModalTimeout=setTimeout((()=>{this.listingModal=this.el.querySelector("ir-listing-modal");this.listingModal.editBooking=this.editBookingItem;this.listingModal.openModal()}),100)}disconnectedCallback(){clearTimeout(this.listingModalTimeout)}async handleResetData(t){t.stopImmediatePropagation();t.stopPropagation();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{is_to_export:false}))}async handleResetStoreData(t){t.stopImmediatePropagation();t.stopPropagation();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{is_to_export:false}))}handleBookingChanged(t){t.stopImmediatePropagation();t.stopPropagation();Ta.bookings=[...Ta.bookings.map((e=>{if(e.booking_nbr===t.detail.booking_nbr){return t.detail}return e}))]}renderItemRange(){const{endItem:t,startItem:e,totalCount:i}=this.getPaginationBounds();return`${y.entries.Lcz_View} ${e+1} - ${t} ${y.entries.Lcz_Of} ${i}`}async updateData(){const{endItem:t,startItem:e}=this.getPaginationBounds();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{is_to_export:false,start_row:e,end_row:t}))}calculateTotalPersons(t){const e=({adult_nbr:t,children_nbr:e,infant_nbr:i})=>(t!==null&&t!==void 0?t:0)+(e!==null&&e!==void 0?e:0)+(i!==null&&i!==void 0?i:0);return t.rooms.reduce(((t,i)=>e(i.occupancy)+t),0)}render(){var t,s,a,n,o,r,l,c,d,h,u,f,p,g,m,v,k,x,C,O;if(this.isLoading||this.ticket===""){return e("ir-loading-screen",null)}return e(i,null,e("ir-interceptor",null),e("ir-toast",null),e("div",{class:"p-1 main-container"},e("ir-listing-header",{propertyId:this.propertyid,p:this.p,language:this.language}),e("section",null,e("div",{class:"card p-1 flex-fill m-0 mt-2"},e("table",{class:"table table-striped table-bordered no-footer dataTable"},e("thead",null,e("tr",null,e("th",{scope:"col",class:"text-left"},(t=y.entries)===null||t===void 0?void 0:t.Lcz_Booking,"#"),e("th",{scope:"col"},(s=y.entries)===null||s===void 0?void 0:s.Lcz_BookedOn),e("th",{scope:"col"},(a=y.entries)===null||a===void 0?void 0:a.Lcz_GuestSource),e("th",{scope:"col",class:"text-left services-cell"},(n=y.entries)===null||n===void 0?void 0:n.Lcz_Services),e("th",{scope:"col",class:"in-out"},(o=y.entries)===null||o===void 0?void 0:o.Lcz_Dates),e("th",{scope:"col"},e("span",{class:"price-span"},(r=y.entries)===null||r===void 0?void 0:r.Lcz_Amount),e("ir-tooltip",{customSlot:true,message:`<span style="width:100%;display:block;">${(l=y.entries)===null||l===void 0?void 0:l.Lcz_BookingBalance}</span><span>${(c=y.entries)===null||c===void 0?void 0:c.Lcz_ClickToSettle}</span>`},e("span",{slot:"tooltip-trigger",class:"m-0 btn due-btn"},(d=y.entries)===null||d===void 0?void 0:d.Lcz_Balance))),this.showCost&&e("th",{scope:"col",class:"services-cell"},(h=y.entries)===null||h===void 0?void 0:h.Lcz_Cost),e("th",{scope:"col"},(u=y.entries)===null||u===void 0?void 0:u.Lcz_Status),e("th",{scope:"col"},e("p",{class:"sr-only"},"actions")))),e("tbody",{class:""},Ta.bookings.length===0&&e("tr",null,e("td",{colSpan:8},(f=y.entries)===null||f===void 0?void 0:f.Lcz_NoDataAvailable)),(p=Ta.bookings)===null||p===void 0?void 0:p.map((t=>{var i,s,a,n,o;let r=this.statusColors[t.is_requested_to_cancel?"003":t.status.code];const l=t.ota_manipulations?t.ota_manipulations[t.ota_manipulations.length-1]:null;const c=this.calculateTotalPersons(t);return e("tr",{key:t.booking_nbr},e("td",{class:"text-left"},e("ir-button",{btn_color:"link",btnStyle:{padding:"0",margin:"0"},onClickHandler:()=>this.editBookingItem={booking:t,cause:"edit"},text:t.booking_nbr}),t.channel_booking_nbr&&e("p",{class:"p-0 m-0 text-center secondary-p"},t.channel_booking_nbr)),e("td",null,e("p",{class:"p-0 m-0 date-p"},D(t.booked_on.date,"YYYY-MM-DD").format("DD-MMM-YYYY")),e("p",{class:"p-0 m-0 secondary-p"},b(t.booked_on.hour.toString(),t.booked_on.minute.toString()))),e("td",null,e("div",{class:"h-100 d-flex align-items-center ",style:{width:"max-content"}},e("img",{class:"mr-2 logo",src:t.origin.Icon,alt:t.origin.Label}),e("div",{class:"text-left"},e("div",{class:"d-flex align-items-center"},e("div",{class:"booking_name m-0 p-0"},e("ir-button",{btn_color:"link",onClickHandler:()=>this.editBookingItem={booking:t,cause:"guest"},text:`${t.guest.first_name} ${(i=t.guest.last_name)!==null&&i!==void 0?i:""}`,btnStyle:{width:"fit-content",padding:"0",margin:"0"},labelStyle:{padding:"0"}}),t.guest.nbr_confirmed_bookings>1&&!t.agent&&e("div",{class:"m-0 p-0"},e("ir-tooltip",{message:`${y.entries.Lcz_BookingsNbr}`.replace("%1",t.guest.nbr_confirmed_bookings.toString()),customSlot:true},e("div",{class:"d-flex align-items-center my-0 p-0",slot:"tooltip-trigger"},e("ir-icons",{style:{"--icon-size":"0.875rem"},color:"#FB0AAD",name:"heart-fill"})))),e("span",{class:"p-0 m-0"},c,y.entries.Lcz_P),X(t.extras)&&e("span",{class:"yellow_dot"}))),e("div",{class:"d-flex align-items-center booking-label-gap"},e("p",{class:"p-0 m-0 secondary-p"},t.origin.Label),t.is_in_loyalty_mode&&!t.promo_key&&e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("title",null,y.entries.Lcz_LoyaltyDiscountApplied),e("path",{fill:"#fc6c85",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"})),t.promo_key&&e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",height:18,width:18},e("title",null,y.entries.Lcz_Coupon+":"+t.promo_key),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})))))),e("td",null,e("ul",null,t.rooms.map((t=>{var i,s,a,n,o,r,l;return e("li",null,e("div",{class:"room-service"},e("p",{class:"m-0 p-0"},t.roomtype.name),t.unit&&!w(t.roomtype.id)&&(((s=(i=t.unit)===null||i===void 0?void 0:i.name)===null||s===void 0?void 0:s.length)>4?e("ir-tooltip",{customSlot:true,message:(a=t.unit)===null||a===void 0?void 0:a.name},e("p",{class:"room-name-container cursor-pointer m-0",slot:"tooltip-trigger"},(o=(n=t.unit)===null||n===void 0?void 0:n.name)===null||o===void 0?void 0:o.substring(0,4))):e("p",{class:"room-name-container  m-0"},(l=(r=t.unit)===null||r===void 0?void 0:r.name)===null||l===void 0?void 0:l.substring(0,4)))))})),t.extra_services&&e("li",null,y.entries.Lcz_ExtraServices))),e("td",null,e("p",{class:"p-0 m-0 date-p"},D(t.from_date,"YYYY-MM-DD").format("DD-MMM-YYYY")),e("p",{class:"p-0 m-0 date-p"},D(t.to_date,"YYYY-MM-DD").format("DD-MMM-YYYY"))),e("td",null,e("p",{class:"p-0 m-0",style:{whiteSpace:"nowrap"}},_(t.currency.symbol,(a=(s=t.financial)===null||s===void 0?void 0:s.gross_total)!==null&&a!==void 0?a:0)),t.financial.due_amount>0&&e("buuton",{onClick:()=>{this.editBookingItem={booking:t,cause:"payment"};this.openModal()},style:{whiteSpace:"nowrap"},class:"btn p-0 m-0 due-btn"},_(t.currency.symbol,t.financial.due_amount))),this.showCost&&e("td",null,t.financial.gross_cost!==null&&t.financial.gross_cost===0?"_":_(t.currency.symbol,t.financial.gross_cost)),e("td",null,e("p",{class:`m-0 badge ${r} ct_ir_badge`},t.is_requested_to_cancel?(n=y===null||y===void 0?void 0:y.entries)===null||n===void 0?void 0:n.Lcz_CancellationRequested:t.status.description),!l&&((o=t.events)===null||o===void 0?void 0:o.length)>0&&t.events[0].type.toLowerCase()==="modified"&&e("p",{class:"mx-0 p-0 small",style:{marginTop:"0.25rem",marginBottom:"0"}},"Modified"),l&&e("ir-popover",{trigger:"hover",content:`Modified by ${l.user} at ${l.date} ${l.hour}:${l.minute}`},e("p",{class:"mx-0 p-0 small text-danger",style:{marginTop:"0.25rem",marginBottom:"0"}},e("b",null,"Modified")))),e("td",null,e("div",{class:"d-flex justify-content-center align-items-center",style:{gap:"8px"}},e("ir-button",{title:"Edit booking",variant:"icon",icon_name:"edit",onClickHandler:()=>this.editBookingItem={booking:t,cause:"edit"}}),e("ir-button",{title:"Delete booking",style:{"--icon-button-color":"#ff4961","--icon-button-hover-color":"#FF1635"},variant:"icon",icon_name:"trash",onClickHandler:()=>{this.editBookingItem={booking:t,cause:"delete"};this.openModal()}}))))})))),this.totalPages>1&&e("section",{class:"d-flex flex-column flex-md-row align-items-center justify-content-between pagination-container"},e("p",{class:"m-0 mb-1 mb-md-0"},this.renderItemRange()),e("div",{class:"d-flex align-items-center buttons-container"},e("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHandler:async()=>{this.currentPage=1;await this.updateData()},icon_name:"angles_left",style:{"--icon-size":"0.875rem"}}),e("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHandler:async()=>{this.currentPage=this.currentPage-1;await this.updateData()},icon_name:"angle_left",style:{"--icon-size":"0.875rem"}}),e("ir-select",{selectedValue:this.currentPage.toString(),showFirstOption:false,onSelectChange:async t=>{this.currentPage=+t.detail;await this.updateData()},data:Array.from(Array(this.totalPages),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}),e("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHandler:async()=>{this.currentPage=this.currentPage+1;await this.updateData()},icon_name:"angle_right",style:{"--icon-size":"0.875rem"}}),e("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHandler:async()=>{this.currentPage=this.totalPages;console.log(this.currentPage);await this.updateData()},icon_name:"angles_right",style:{"--icon-size":"0.875rem"}})))))),this.editBookingItem&&e("ir-listing-modal",{paymentEntries:this.paymentEntries,onModalClosed:()=>this.editBookingItem=null}),e("ir-sidebar",{onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:this.editBookingItem!==null&&["edit","guest"].includes(this.editBookingItem.cause),showCloseButton:false,sidebarStyles:((g=this.editBookingItem)===null||g===void 0?void 0:g.cause)==="guest"?{background:"white"}:{width:this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:"#F2F3F8"}},((m=this.editBookingItem)===null||m===void 0?void 0:m.cause)==="edit"&&e("ir-booking-details",{slot:"sidebar-body",p:this.p,hasPrint:true,hasReceipt:true,is_from_front_desk:true,propertyid:this.propertyid,hasRoomEdit:true,hasRoomDelete:true,hasCloseButton:true,onCloseSidebar:()=>this.editBookingItem=null,bookingNumber:this.editBookingItem.booking.booking_nbr,ticket:this.ticket,language:this.language,hasRoomAdd:true}),((v=this.editBookingItem)===null||v===void 0?void 0:v.cause)==="guest"&&e("ir-guest-info",{slot:"sidebar-body",isInSideBar:true,headerShown:true,booking_nbr:(x=(k=this.editBookingItem)===null||k===void 0?void 0:k.booking)===null||x===void 0?void 0:x.booking_nbr,email:(O=(C=this.editBookingItem)===null||C===void 0?void 0:C.booking)===null||O===void 0?void 0:O.guest.email,language:this.language,onCloseSideBar:()=>this.editBookingItem=null})))}get el(){return n(this)}static get watchers(){return{ticket:["ticketChanged"]}}};Fa.style=$a;const La=".sc-ir-button-h{--icon-button-color:#6b6f82;--icon-button-hover-color:#104064}.button-icon.sc-ir-button{padding:0;margin-top:0}.button-icon[data-state='loading'].sc-ir-button{display:none}.button-text.sc-ir-button{padding:0 5px}.bounce-3.sc-ir-button{animation:bounce 1s 1}.btn-link.sc-ir-button{color:var(--blue, #1e9ff2)}.ir-button-class.sc-ir-button{display:inline-flex !important;justify-content:center;align-items:center;box-sizing:border-box}.btn-outline.sc-ir-button{background:transparent;border:1px solid #104064;color:#104064}.btn-outline.sc-ir-button:hover,.btn-outline.sc-ir-button:active{background:#104064;color:white}.icon-button.sc-ir-button{all:unset;box-sizing:border-box;border-radius:0.25rem;display:inline-flex;align-items:center;justify-content:center;color:var(--icon-button-color);padding:0.2rem;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.icon-button.sc-ir-button:hover{color:var(--icon-button-hover-color)}.icon-button.sc-ir-button:hover.hovered_bg{background:var('--ir-icon-bg-hover', #f6f6f6)}.icon-button.sc-ir-button:disabled{pointer-events:none}.icon-loader.sc-ir-button{margin:0;padding:0;width:var(--icon-size, 1.25rem);height:var(--icon-size, 1.25rem);border-radius:50%;background:radial-gradient(farthest-side, var(--icon-button-color) 94%, #0000) top/2px 2px no-repeat, conic-gradient(#0000 30%, var(--icon-button-color));-webkit-mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);mask:radial-gradient(farthest-side, #0000 calc(100% - 2px), var(--icon-button-color) 0);animation:l13 1s infinite linear}.btn_loader.sc-ir-button{width:15px;height:10px;--c:no-repeat linear-gradient(#ffffff 0 0);background:var(--c) 0% 50%, var(--c) 50% 50%, var(--c) 100% 50%;background-size:20% 100%;animation:l1 1s infinite linear}@keyframes l13{100%{transform:rotate(1turn)}}@keyframes l1{0%{background-size:20% 100%, 20% 100%, 20% 100%}33%{background-size:20% 10%, 20% 100%, 20% 100%}50%{background-size:20% 100%, 20% 10%, 20% 100%}66%{background-size:20% 100%, 20% 100%, 20% 10%}100%{background-size:20% 100%, 20% 100%, 20% 100%}}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}@keyframes ping{75%,100%{transform:scale(1.2)}}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Pa=La;const Ha=class{constructor(e){t(this,e);this.clickHandler=s(this,"clickHandler",7);this.btn_color="primary";this.size="md";this.textSize="md";this.btn_block=true;this.btn_disabled=false;this.btn_type="button";this.isLoading=false;this.btn_id=ht();this.variant="default";this.visibleBackgroundOnHover=false;this.iconPosition="left";this.renderContentAsHtml=false}handleButtonAnimation(t){if(!this.buttonEl||t.detail!==this.btn_id){return}t.stopImmediatePropagation();t.stopPropagation();this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}async bounce(){this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}render(){const t=this.btn_disabled||this.isLoading;if(this.variant==="icon"){return e("button",{id:this.btn_id,class:`icon-button ${this.btn_styles} ${this.visibleBackgroundOnHover?"hovered_bg":""}`,ref:t=>this.buttonEl=t,onClick:()=>this.clickHandler.emit(),type:this.btn_type,disabled:t},this.isLoading?e("span",{class:"icon-loader"}):e("ir-icons",{class:"m-0 p-0",name:this.icon_name}))}let i=this.btn_block?"btn-block":"";return e("button",{id:this.btn_id,ref:t=>this.buttonEl=t,onClick:()=>this.clickHandler.emit(),class:`btn btn-${this.btn_color} ${this.btn_styles} ir-button-class  btn-${this.size} text-${this.textSize} ${i}`,type:this.btn_type,style:this.btnStyle,disabled:t},this.icon_name&&this.iconPosition==="left"&&e("ir-icons",{name:this.icon_name,style:this.icon_style}),this.text&&(this.renderContentAsHtml?e("span",{class:"button-text m-0",innerHTML:this.text,style:this.labelStyle}):e("span",{style:this.labelStyle,class:"button-text m-0"},this.text)),this.isLoading?e("div",{class:"btn_loader m-0 p-0"}):this.iconPosition==="right"&&e("ir-icons",{style:this.icon_style,name:this.icon_name}))}};Ha.style=Pa;const Ua=".sc-ir-checkbox-h{display:flex;align-items:center;width:fit-content}button.sc-ir-checkbox{all:unset}.CheckboxRoot.sc-ir-checkbox{background-color:white;width:20px;height:20px;border-radius:4px;display:flex;align-items:center;justify-content:center;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.CheckboxRoot.sc-ir-checkbox:disabled{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3);pointer-events:none}.CheckboxRoot[data-state='checked'].sc-ir-checkbox{background-color:#1e9ff2;color:white;border-color:#1e9ff2}input[type='checkbox'].sc-ir-checkbox{background-color:initial;cursor:default;appearance:auto;box-sizing:border-box;margin:3px 3px 3px 4px;padding:initial;border:initial}.checkbox.sc-ir-checkbox{transform:translateX(-100%);position:absolute;pointer-events:none;opacity:0;margin:0px;width:20px;height:20px}";const Va=Ua;const Ga=class{constructor(e){t(this,e);this.checkChange=s(this,"checkChange",7);this.checked=false;this.checkboxId=ht();this.currentChecked=false}componentWillLoad(){this.currentChecked=this.checked}componentDidLoad(){if(this.checkboxRef){this.checkboxRef.setAttribute("aria-checked",JSON.stringify(this.checked))}}handleCheckedChange(t){if(t===this.currentChecked){return}this.currentChecked=this.checked}handleCheckChange(){this.currentChecked=!this.currentChecked;if(this.checkboxRef){this.checkboxRef.setAttribute("aria-checked",JSON.stringify(this.currentChecked))}this.checkChange.emit(this.currentChecked)}render(){return e(i,{key:"9daaea06b77dd20cd98aae0f61f0bfc5c77199c9"},e("button",{key:"212c1f3ab08c9b9262509ae1ddddd2f91831f699",disabled:this.disabled,name:this.name,onClick:this.handleCheckChange.bind(this),id:this.checkboxId,"data-state":this.currentChecked||this.indeterminate?"checked":"unchecked",value:"on",ref:t=>this.checkboxRef=t,type:"button",role:"checkbox",class:"CheckboxRoot"},this.currentChecked&&e("svg",{key:"1fc590ad4d2ac00a0e67a7a8ec4aefcfdd3a346f",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{key:"f94f8b3eb665c0e7971412a602c03a113f4b9c51",fill:"currentColor",d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"})),this.indeterminate&&e("svg",{key:"3abdaf118bdbaae6376f26e3896363a35ea88875",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{key:"65e6f03bcbd1b29c982c859af226f9ed427095ca",fill:"currentColor",d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"}))),e("input",{key:"dee4fcd037985d6590a1e193606951a5fe1bd873",type:"checkbox",indeterminate:this.indeterminate,"aria-hidden":"true",tabindex:"-1",value:"on",checked:this.currentChecked,class:"checkbox"}),this.label&&e("label",{key:"51ef5601894a8b3405cfd89a0d84f02844229a08",htmlFor:this.checkboxId,class:this.labelClass},this.label))}static get watchers(){return{checked:["handleCheckedChange"]}}};Ga.style=Va;const Ka=".sc-ir-combobox-h{display:block;position:relative;padding:0;margin:0;box-sizing:border-box}ul.sc-ir-combobox{position:absolute;box-sizing:border-box;margin:0;margin-top:2px;width:max-content;max-height:80px;border-radius:0.21rem;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto;min-width:100%}ul[data-position='bottom-right'].sc-ir-combobox{right:0}.list-item-image.sc-ir-combobox{height:1rem;aspect-ratio:4/3;border-radius:4px;margin-right:10px}.dropdown-item.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox,span.sc-ir-combobox,loader-container.sc-ir-combobox{padding:0px 16px;margin:0px;margin-top:2px;width:100%;border-radius:2px}ul.sc-ir-combobox li.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox{display:flex;align-items:center;flex-wrap:wrap;gap:3px}ul.sc-ir-combobox li.sc-ir-combobox p.sc-ir-combobox{margin:0;padding:0}ul.sc-ir-combobox li.sc-ir-combobox:hover{background:#f4f5fa}ul.sc-ir-combobox li[data-selected].sc-ir-combobox,ul.sc-ir-combobox li[data-selected].sc-ir-combobox:hover{color:#fff;text-decoration:none;background-color:#666ee8}";const Wa=Ka;const qa=class{constructor(e){t(this,e);this.comboboxValueChange=s(this,"comboboxValueChange",7);this.inputCleared=s(this,"inputCleared",7);this.toast=s(this,"toast",7);this.data=[];this.duration=300;this.disabled=false;this.autoFocus=false;this.input_id=ht();this.selectedIndex=-1;this.actualIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.inputValue="";this.filteredData=[];this.componentShouldAutoFocus=false}componentWillLoad(){this.filteredData=this.data}componentDidLoad(){if(this.autoFocus){this.focusInput()}}watchHandler(t,e){if(t!==e&&t===true){this.focusInput()}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);clearTimeout(this.blurTimeout);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleKeyDown(t){var e;const i=this.filteredData.length;if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition();break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition();break;case"Escape":t.stopImmediatePropagation();t.stopPropagation();(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}focusInput(){requestAnimationFrame((()=>{var t;(t=this.inputRef)===null||t===void 0?void 0:t.focus()}))}adjustScrollPosition(){var t;const e=(t=this.el)===null||t===void 0?void 0:t.querySelector(`[data-selected]`);if(!e)return;e.scrollIntoView({block:"center"})}selectItem(t){if(this.filteredData[t]){this.isItemSelected=true;this.comboboxValueChange.emit({key:"select",data:this.filteredData[t].id});this.inputValue="";this.resetCombobox();if(this.autoFocus){this.focusInput()}}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}handleFocus(){this.isComboBoxVisible=true}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.selectedIndex=-1;this.isComboBoxVisible=false}async fetchData(){try{this.isLoading=true;this.filteredData=this.data.filter((t=>t.name.toLowerCase().startsWith(this.inputValue)));this.selectedIndex=-1}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{this.filteredData=this.data}}handleBlur(){this.blurTimeout=setTimeout((()=>{if(!this.isItemSelected){this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}),300)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}}renderDropdown(){var t;if(!this.isComboBoxVisible){return null}return e("ul",{"data-position":this.filteredData.length>0&&this.filteredData[0].occupancy?"bottom-right":"bottom-left"},(t=this.filteredData)===null||t===void 0?void 0:t.map(((t,i)=>e("li",{onMouseEnter:()=>this.selectedIndex=i,role:"button",key:t.id,onKeyDown:t=>this.handleItemKeyDown(t,i),"data-selected":this.selectedIndex===i,tabIndex:0,onClick:()=>this.selectItem(i)},t.image&&e("img",{src:t.image,class:"list-item-image"}),e("p",null,t.name),t.occupancy&&e(a,null,e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),e("p",null,t.occupancy))))),this.filteredData.length===0&&!this.isLoading&&e("span",{class:"text-center"},y.entries.Lcz_NoResultsFound))}handleSubmit(t){t.preventDefault();t.stopPropagation();console.log("object");if(!this.filteredData.length){return}this.selectItem(this.selectedIndex===-1?0:this.selectedIndex)}render(){return e("form",{key:"393ae8303e0f0427aabca029a5b891b8233af183",onSubmit:this.handleSubmit.bind(this),class:"m-0 p-0"},e("input",{key:"d2e9f369f03e8abebec6e26ce0154af553988938",type:"text",class:"form-control bg-white",id:this.input_id,ref:t=>this.inputRef=t,disabled:this.disabled,value:this.value,placeholder:this.placeholder,onKeyDown:this.handleKeyDown.bind(this),onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),autoFocus:this.autoFocus}),this.renderDropdown())}get el(){return n(this)}static get watchers(){return{isComboBoxVisible:["watchHandler"]}}};qa.style=Wa;const Xa=[{isCSS:true,link:"https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap-extended.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/colors.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/menu/menu-types/horizontal-menu.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/colors/palette-gradient.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/components.css"},{isCSS:true,link:"https://x.igloorooms.com/assets/css/style.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/icheck.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/custom.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/pages/login-register.css"}];const Ja=class{constructor(e){t(this,e);this.extraResources="";this.resources=Xa}componentWillLoad(){this.parseRefs()}componentDidLoad(){this.initializeStyles()}hrefsChanged(){this.parseRefs();this.initializeStyles()}parseRefs(){if(this.extraResources!=="")this.resources.push(JSON.parse(this.extraResources))}appendTag(t,e){const i=document.createElement(t);const s=[];Object.keys(e).forEach((t=>{i.setAttribute(t,e[t]);s.push(`[${t}="${e[t]}"]`)}));const a=`${t}${s.join("")}`;const n=document.querySelector(a);if(!n){document.head.appendChild(i)}}initializeStyles(){this.resources.forEach((t=>{if(t.isCSS){this.appendTag("link",{href:t.link,rel:"stylesheet",type:"text/css"})}if(t.isJS){this.appendTag("script",{src:t.link})}}))}render(){return e(i,{key:"762cc60e66362293b5b9a6366095351ca9e9e668"},e("slot",{key:"397d995cde59e7a38911896ba3d88f3f731aabf1"}))}static get watchers(){return{extraResources:["hrefsChanged"]}}};const Qa=".sc-ir-country-picker-h{display:block;margin:0;padding:0;box-sizing:border-box}.combobox-menu.sc-ir-country-picker{max-height:200px;overflow:auto}";const Za=Qa;const tn=class{constructor(e){t(this,e);this.countryChange=s(this,"countryChange",7);this.countries=[];this.autoValidate=false;this.filteredCountries=[];this.searching=false}componentWillLoad(){this.filteredCountries=[...this.countries];if(this.country){this.inputValue=this.country.name;this.selectedCountry=this.country}}handleCountryChange(t,e){var i;if((t===null||t===void 0?void 0:t.id)!==(e===null||e===void 0?void 0:e.id)){this.inputValue=(i=this.country)===null||i===void 0?void 0:i.name;this.selectedCountry=t}}filterCountries(){if(this.inputValue===""&&this.country){this.selectCountry(null)}clearTimeout(this.debounceTimeout);this.debounceTimeout=setTimeout((()=>{if(!this.inputValue){this.filteredCountries=[...this.countries]}else{this.filteredCountries=this.countries.filter((t=>t.name.toLowerCase().includes(this.inputValue.toLowerCase())))}}),300)}selectCountry(t){this.selectedCountry=t;this.inputValue=t===null||t===void 0?void 0:t.name;this.filteredCountries=[...this.countries];this.countryChange.emit(t)}scrollToSelected(){setTimeout((()=>{const t=document.querySelector(`.dropdown-item.active`);if(t){t.scrollIntoView({behavior:"instant",block:"center"})}}),100)}render(){var t,i,s;const n=this.filteredCountries.length>0&&this.propertyCountry&&(!this.searching||this.searching&&this.inputValue==="");return e("form",{key:"a27f41594102d78f7ecad33ab0b3593cecda1733",class:"dropdown m-0 p-0"},e("ir-input-text",{key:"65f04843df4d785b56007bfa2e48444d2d1437f5",onTextChange:t=>{if(!this.searching){this.searching=true}this.inputValue=t.detail;this.filterCountries()},testId:this.testId,autoValidate:this.autoValidate,label:this.label,error:this.error,placeholder:"",class:"m-0 p-0",value:this.inputValue,id:"dropdownMenuCombobox","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onInputFocus:()=>this.scrollToSelected(),onInputBlur:()=>{this.searching=false;if(this.filteredCountries.length>0&&this.inputValue&&this.inputValue.trim()!==""){this.selectCountry(this.filteredCountries[0])}}}),e("div",{key:"63a013fb43c72c7fac42f53823878ab913060b0c",class:"dropdown-menu combobox-menu","aria-labelledby":"dropdownMenuCombobox"},n&&e(a,{key:"c88e76ad99ec1d8db706ed8d9cdbb548e6334ba5"},e("button",{key:"5d15424ff196377530f200e581d35d73e258b44b",type:"button",class:`dropdown-item d-flex align-items-center ${((t=this.selectedCountry)===null||t===void 0?void 0:t.id)===this.propertyCountry.id?"active":""}`,onClick:()=>{this.selectCountry(this.propertyCountry)}},e("img",{key:"556716ff64615b2fc4d8cd9eb508e01a99d46f4a",src:this.propertyCountry.flag,alt:this.propertyCountry.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),e("p",{key:"6ab83e8f1bb101d2cc3949daa1aefbe28b39d24f",class:"pl-1 m-0"},this.propertyCountry.name)),e("div",{key:"7228f7830443f897512cbce21e9b635423fb177f",class:"dropdown-divider"})),(i=this.filteredCountries)===null||i===void 0?void 0:i.map((t=>{var i;return e("button",{key:t.id,type:"button",class:`dropdown-item d-flex align-items-center ${((i=this.selectedCountry)===null||i===void 0?void 0:i.id)===t.id?"active":""}`,onClick:()=>{this.selectCountry(t)}},e("img",{src:t.flag,alt:t.name,style:{aspectRatio:"1",height:"15px",borderRadius:"4px"}}),e("p",{class:"pl-1 m-0"},t.name))})),((s=this.filteredCountries)===null||s===void 0?void 0:s.length)===0&&e("p",{key:"b45c008d16f1b6bb30f23c5f00efafa6fe1480eb",class:"dropdown-item-text"},"Invalid Country")))}static get watchers(){return{country:["handleCountryChange"]}}};tn.style=Za;class en{async getExposedProperty(t){var e,i;try{const{data:s}=await gt.post(`/Get_Exposed_Property`,t);if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}const a=s.My_Result;x.adultChildConstraints=a.adult_child_constraints;x.allowedBookingSources=a.allowed_booking_sources;x.allowed_payment_methods=a.allowed_payment_methods;x.currency=a.currency;x.is_vacation_rental=a.is_vacation_rental;x.pickup_service=a.pickup_service;x.max_nights=a.max_nights;x.roomsInfo=a.roomtypes;x.taxes=a.taxes;x.id=a.id;x.country=a.country;x.name=a.name;x.is_automatic_check_in_out=a.is_automatic_check_in_out;x.tax_statement=a.tax_statement;x.is_frontdesk_enabled=a.is_frontdesk_enabled;x.is_pms_enabled=a.is_pms_enabled;const n=(i=(e=a===null||a===void 0?void 0:a.time_constraints)===null||e===void 0?void 0:e.check_out_till)===null||i===void 0?void 0:i.split(":");x.checkin_checkout_hours={offset:a.city.gmt_offset,hour:Number(n[0]||0),minute:Number(n[1]||0)};return s}catch(t){console.log(t);throw new Error(t)}}async getCountrySales(t){const{data:e}=await gt.post("/Get_Country_Sales",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}if(t.is_export_to_excel){it(e.My_Params_Get_Country_Sales.Link_excel)}return e.My_Result}async getDailyRevenueReport(t){const{data:e}=await gt.post("/Get_Daily_Revenue_Report",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}if(t.is_export_to_excel){it(e.My_Params_Get_Daily_Revenue_Report.Link_excel)}return e.My_Result}async setExposedCleaningFrequency(t){const{data:e}=await gt.post("/Set_Exposed_Cleaning_Frequency",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}async getMonthlyStats(t){const{data:e}=await gt.post("/Get_Monthly_Stats",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}if(t.is_export_to_excel){it(e.My_Params_Get_Monthly_Stats.Link_excel)}return e.My_Result}}const sn=".sc-ir-daily-revenue-h{display:block}.daily-revenue__meta.sc-ir-daily-revenue{display:flex;flex-direction:column;gap:1rem}.daily-revenue__table.sc-ir-daily-revenue{flex:1 1 0%}@media (min-width: 768px){.daily-revenue__meta.sc-ir-daily-revenue{flex-direction:row}}";const an=sn;const nn=class{constructor(e){t(this,e);this.preventPageLoad=s(this,"preventPageLoad",7);this.language="";this.ticket="";this.filters={date:D().format("YYYY-MM-DD"),users:null};this.tokenService=new pt;this.roomService=new bt;this.propertyService=new en;this.bookingService=new l;this.handleSidebarClose=t=>{t.stopImmediatePropagation();t.stopPropagation();this.sideBarEvent=null}}componentWillLoad(){if(this.ticket){this.tokenService.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.tokenService.setToken(this.ticket);this.initializeApp()}handleOpenSidebar(t){t.stopImmediatePropagation();t.stopPropagation();this.sideBarEvent=t.detail}handleFetchNewReports(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=Object.assign({},t.detail);this.getPaymentReports()}renderSidebarBody(){if(!this.sideBarEvent){return}switch(this.sideBarEvent.type){case"booking":return e("ir-booking-details",{slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:this.handleSidebarClose,is_from_front_desk:true,propertyid:this.property_id,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.sideBarEvent.payload.bookingNumber.toString(),ticket:this.ticket,language:this.language,hasRoomAdd:true});default:return null}}async initializeApp(){this.isPageLoading=true;try{let t=this.propertyid;if(!t&&!this.p){throw new Error("Property ID or username is required")}if(!t){const e=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});t=e.My_Result.id}this.property_id=t;const e=[this.bookingService.getSetupEntriesByTableNameMulti(["_PAY_TYPE","_PAY_TYPE_GROUP","_PAY_METHOD"]),this.getPaymentReports(),this.roomService.fetchLanguage(this.language)];if(t){e.push(this.roomService.getExposedProperty({id:t,language:this.language,is_backend:true,include_units_hk_status:true}))}const[i]=await Promise.all(e);const{pay_type:s,pay_type_group:a,pay_method:n}=this.bookingService.groupEntryTablesResult(i);this.paymentEntries={groups:a,methods:n,types:s}}catch(t){console.log(t)}finally{this.isPageLoading=false}}groupPaymentsByName(t){var e;const i=new Map;for(const s of t){const t=`${s.payTypeCode}_${s.payMethodCode}`;const a=(e=i.get(t))!==null&&e!==void 0?e:[];i.set(t,[...a,s])}return new Map([...i.entries()].sort((([t],[e])=>{const i=Number(t);const s=Number(e);if(!isNaN(i)&&!isNaN(s)){return i-s}return t.localeCompare(e)})))}async getPaymentReports(t=false){var e,i,s,a;try{const n=t=>({method:t.METHOD,payTypeCode:t.PAY_TYPE_CODE,payMethodCode:t.PAY_METHOD_CODE,amount:t.AMOUNT,date:t.DATE,hour:t.HOUR,minute:t.MINUTE,user:t.USER,currency:t.CURRENCY,bookingNbr:t.BOOKING_NBR,id:ht()});this.isLoading=t?"export":"filter";const o=[this.propertyService.getDailyRevenueReport({date:this.filters.date,property_id:(e=this.property_id)===null||e===void 0?void 0:e.toString(),is_export_to_excel:t})];if(!t){o.push(this.propertyService.getDailyRevenueReport({date:D(this.filters.date,"YYYY-MM-DD").add(-1,"days").format("YYYY-MM-DD"),property_id:(i=this.property_id)===null||i===void 0?void 0:i.toString(),is_export_to_excel:t}))}const r=await Promise.all(o);if(!t){if(r[0]){this.groupedPayment=this.groupPaymentsByName((s=r[0])===null||s===void 0?void 0:s.map(n))}else{this.groupedPayment=new Map}if(r[1])this.previousDateGroupedPayments=this.groupPaymentsByName((a=r[1])===null||a===void 0?void 0:a.map(n))}}catch(t){console.log(t)}finally{this.isLoading=null}}render(){var t,s,a;if(this.isPageLoading){return e("ir-loading-screen",null)}return e(i,null,e("ir-toast",null),e("ir-interceptor",null),e("section",{class:"p-2 d-flex flex-column",style:{gap:"1rem"}},e("div",{class:"d-flex align-items-center justify-content-between"},e("h3",{class:"mb-1 mb-md-0"},"Daily Revenue"),e("ir-button",{size:"sm",btn_color:"outline",isLoading:this.isLoading==="export",text:(t=y.entries)===null||t===void 0?void 0:t.Lcz_Export,onClickHandler:async t=>{t.stopImmediatePropagation();t.stopPropagation();await this.getPaymentReports(true)},btnStyle:{height:"100%"},iconPosition:"right",icon_name:"file",icon_style:{"--icon-size":"14px"}})),e("ir-revenue-summary",{previousDateGroupedPayments:this.previousDateGroupedPayments,groupedPayments:this.groupedPayment,paymentEntries:this.paymentEntries}),e("div",{class:"daily-revenue__meta"},e("ir-daily-revenue-filters",{isLoading:this.isLoading==="filter",payments:this.groupedPayment}),e("ir-revenue-table",{filters:this.filters,class:"daily-revenue__table",paymentEntries:this.paymentEntries,payments:this.groupedPayment}))),e("ir-sidebar",{sidebarStyles:{width:((s=this.sideBarEvent)===null||s===void 0?void 0:s.type)==="booking"?"80rem":"var(--sidebar-width,40rem)",background:((a=this.sideBarEvent)===null||a===void 0?void 0:a.type)==="booking"?"#F2F3F8":"white"},open:Boolean(this.sideBarEvent),showCloseButton:false,onIrSidebarToggle:this.handleSidebarClose},this.renderSidebarBody()))}static get watchers(){return{ticket:["ticketChanged"]}}};nn.style=an;const on=".sc-ir-daily-revenue-filters-h{display:block}.revenue-filter__date-picker-icon.sc-ir-daily-revenue-filters{position:absolute;inset:0;left:0.75rem;display:flex;align-items:center;width:fit-content;transform:translateY(-0.15rem)}.sc-ir-daily-revenue-filters-h{display:block;height:100%}@media (min-width: 768px){.sc-ir-daily-revenue-filters-h{width:300px}.collapse-btn.sc-ir-daily-revenue-filters{display:none}#dailyRevenueFiltersCollapse.collapse.sc-ir-daily-revenue-filters:not(.show){display:block}}";const rn=on;const ln=class{constructor(e){t(this,e);this.fetchNewReports=s(this,"fetchNewReports",7);this.collapsed=false;this.users=new Set;this.baseFilters={date:D().format("YYYY-MM-DD"),users:null}}componentWillLoad(){this.filters=Object.assign({},this.baseFilters);this.updateGuests()}handlePaymentChange(){this.updateGuests()}updateGuests(){const t=new Set;this.payments.forEach((e=>{e.forEach((e=>{t.add(e.user)}))}));this.users=new Set(t)}applyFiltersEvt(t){t.stopImmediatePropagation();t.stopPropagation();this.fetchNewReports.emit(this.filters)}resetFilters(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=Object.assign({},this.baseFilters);this.fetchNewReports.emit(this.filters)}updateFilter(t){this.filters=Object.assign(Object.assign({},this.filters),t)}render(){var t,i;return e("div",{key:"eb3bfb1a38fe388c108b221114b05a2459f1c754",class:"card mb-0 p-1 d-flex flex-column sales-filters-card"},e("div",{key:"3495e688e5eddcd9e4b430e727db19f201dc22dc",class:"d-flex align-items-center justify-content-between sales-filters-header"},e("div",{key:"60246a623536e54b3bc0e25d80503d00af4a3290",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"8a2eea6b750ab277ecf9c643a48946a55135eaac",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"9cce85ad1e39a31473ee8c6a63ca79b20b35bd62",fill:"currentColor",d:"M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"})),e("h4",{key:"85af9dbd4e687aeaf9d57010a694aed345a3519e",class:"m-0 p-0 flex-grow-1"},y.entries.Lcz_Filters)),e("ir-button",{key:"8fbf9109475d96afb18a6800f01386dc27905cbd",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":"#dailyRevenueFiltersCollapse","aria-expanded":this.collapsed?"true":"false","aria-controls":"dailyRevenueFiltersCollapse",class:"mr-1 collapse-btn toggle-collapse-btn",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}})),e("div",{key:"1439f4dcfe5106fc9c548ff56e9c46b76888e2bd",class:"m-0 p-0 collapse filters-section",id:"dailyRevenueFiltersCollapse"},e("div",{key:"3b8616af012e75342fcea075d7cf4dc01174c299",class:"d-flex flex-column",style:{gap:"0.5rem"}},e("fieldset",{key:"7fba102777e04acfc37a623beaaadaf3e839633b",class:"pt-1 filter-group"},e("label",{key:"6cc483db56e502a0bd47e8b743dc855639f2414e",htmlFor:"rooms",class:"m-0 px-0",style:{paddingBottom:"0.25rem"}},"Select a date"),e("div",{key:"604f493b7d23d3e9445eb3b24ded216a3e90fb11",class:"w-100 d-flex"},e("style",{key:"bdb0fb50fdaa4d51a15928ef7628682ba615548e"},`\n                  .ir-date-picker-trigger{\n                    width:100%;\n                  }\n                  `),e("ir-date-picker",{key:"198ec785252da3da9c69cc6a902d3fe62101b3eb","data-testid":"pickup_date",date:(t=this.filters)===null||t===void 0?void 0:t.date,class:"w-100",emitEmptyDate:true,maxDate:D().format("YYYY-MM-DD"),onDateChanged:t=>{var e;t.stopImmediatePropagation();t.stopPropagation();this.updateFilter({date:(e=t.detail.start)===null||e===void 0?void 0:e.format("YYYY-MM-DD")})}},e("input",{key:"47c369738bd1c88e5967261349f1b631ec4d69dd",slot:"trigger",type:"text",value:(i=this===null||this===void 0?void 0:this.filters)===null||i===void 0?void 0:i.date,class:`revenue-table__date-picker-input form-control w-100 input-sm  text-left`,style:{width:"100%"}})))),e("div",{key:"997a5a25dd7207b2ccbc187fc78d521a81e5c1b2",class:"d-flex mt-1 align-items-center justify-content-end filter-actions",style:{gap:"1rem"}},e("ir-button",{key:"a8560d176b70e1ae7099b9aedb140152687a55f5",btn_type:"button","data-testid":"reset",text:y.entries.Lcz_Reset,size:"sm",btn_color:"secondary",onClickHandler:t=>this.resetFilters(t)}),e("ir-button",{key:"d70751cd2cb634e2919f6d3fc6be129ce2306265",btn_type:"button","data-testid":"apply",isLoading:this.isLoading,text:y.entries.Lcz_Apply,size:"sm",onClickHandler:t=>this.applyFiltersEvt(t)})))))}static get watchers(){return{payments:["handlePaymentChange"]}}};ln.style=rn;var cn="top";var dn="bottom";var hn="right";var un="left";var fn="auto";var pn=[cn,dn,hn,un];var bn="start";var gn="end";var mn="clippingParents";var vn="viewport";var yn="popper";var kn="reference";var wn=pn.reduce((function(t,e){return t.concat([e+"-"+bn,e+"-"+gn])}),[]);var xn=[].concat(pn,[fn]).reduce((function(t,e){return t.concat([e,e+"-"+bn,e+"-"+gn])}),[]);var _n="beforeRead";var Dn="read";var Cn="afterRead";var On="beforeMain";var Mn="main";var En="afterMain";var Yn="beforeWrite";var An="write";var Tn="afterWrite";var Sn=[_n,Dn,Cn,On,Mn,En,Yn,An,Tn];function Bn(t){return t?(t.nodeName||"").toLowerCase():null}function In(t){if(t==null){return window}if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e?e.defaultView||window:window}return t}function jn(t){var e=In(t).Element;return t instanceof e||t instanceof Element}function zn(t){var e=In(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Nn(t){if(typeof ShadowRoot==="undefined"){return false}var e=In(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Rn(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{};var s=e.attributes[t]||{};var a=e.elements[t];if(!zn(a)||!Bn(a)){return}Object.assign(a.style,i);Object.keys(s).forEach((function(t){var e=s[t];if(e===false){a.removeAttribute(t)}else{a.setAttribute(t,e===true?"":e)}}))}))}function $n(t){var e=t.state;var i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,i.popper);e.styles=i;if(e.elements.arrow){Object.assign(e.elements.arrow.style,i.arrow)}return function(){Object.keys(e.elements).forEach((function(t){var s=e.elements[t];var a=e.attributes[t]||{};var n=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]);var o=n.reduce((function(t,e){t[e]="";return t}),{});if(!zn(s)||!Bn(s)){return}Object.assign(s.style,o);Object.keys(a).forEach((function(t){s.removeAttribute(t)}))}))}}const Fn={name:"applyStyles",enabled:true,phase:"write",fn:Rn,effect:$n,requires:["computeStyles"]};function Ln(t){return t.split("-")[0]}var Pn=Math.max;var Hn=Math.min;var Un=Math.round;function Vn(){var t=navigator.userAgentData;if(t!=null&&t.brands&&Array.isArray(t.brands)){return t.brands.map((function(t){return t.brand+"/"+t.version})).join(" ")}return navigator.userAgent}function Gn(){return!/^((?!chrome|android).)*safari/i.test(Vn())}function Kn(t,e,i){if(e===void 0){e=false}if(i===void 0){i=false}var s=t.getBoundingClientRect();var a=1;var n=1;if(e&&zn(t)){a=t.offsetWidth>0?Un(s.width)/t.offsetWidth||1:1;n=t.offsetHeight>0?Un(s.height)/t.offsetHeight||1:1}var o=jn(t)?In(t):window,r=o.visualViewport;var l=!Gn()&&i;var c=(s.left+(l&&r?r.offsetLeft:0))/a;var d=(s.top+(l&&r?r.offsetTop:0))/n;var h=s.width/a;var u=s.height/n;return{width:h,height:u,top:d,right:c+h,bottom:d+u,left:c,x:c,y:d}}function Wn(t){var e=Kn(t);var i=t.offsetWidth;var s=t.offsetHeight;if(Math.abs(e.width-i)<=1){i=e.width}if(Math.abs(e.height-s)<=1){s=e.height}return{x:t.offsetLeft,y:t.offsetTop,width:i,height:s}}function qn(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e)){return true}else if(i&&Nn(i)){var s=e;do{if(s&&t.isSameNode(s)){return true}s=s.parentNode||s.host}while(s)}return false}function Xn(t){return In(t).getComputedStyle(t)}function Jn(t){return["table","td","th"].indexOf(Bn(t))>=0}function Qn(t){return((jn(t)?t.ownerDocument:t.document)||window.document).documentElement}function Zn(t){if(Bn(t)==="html"){return t}return t.assignedSlot||t.parentNode||(Nn(t)?t.host:null)||Qn(t)}function to(t){if(!zn(t)||Xn(t).position==="fixed"){return null}return t.offsetParent}function eo(t){var e=/firefox/i.test(Vn());var i=/Trident/i.test(Vn());if(i&&zn(t)){var s=Xn(t);if(s.position==="fixed"){return null}}var a=Zn(t);if(Nn(a)){a=a.host}while(zn(a)&&["html","body"].indexOf(Bn(a))<0){var n=Xn(a);if(n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].indexOf(n.willChange)!==-1||e&&n.willChange==="filter"||e&&n.filter&&n.filter!=="none"){return a}else{a=a.parentNode}}return null}function io(t){var e=In(t);var i=to(t);while(i&&Jn(i)&&Xn(i).position==="static"){i=to(i)}if(i&&(Bn(i)==="html"||Bn(i)==="body"&&Xn(i).position==="static")){return e}return i||eo(t)||e}function so(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ao(t,e,i){return Pn(t,Hn(e,i))}function no(t,e,i){var s=ao(t,e,i);return s>i?i:s}function oo(){return{top:0,right:0,bottom:0,left:0}}function ro(t){return Object.assign({},oo(),t)}function lo(t,e){return e.reduce((function(e,i){e[i]=t;return e}),{})}var co=function t(e,i){e=typeof e==="function"?e(Object.assign({},i.rects,{placement:i.placement})):e;return ro(typeof e!=="number"?e:lo(e,pn))};function ho(t){var e;var i=t.state,s=t.name,a=t.options;var n=i.elements.arrow;var o=i.modifiersData.popperOffsets;var r=Ln(i.placement);var l=so(r);var c=[un,hn].indexOf(r)>=0;var d=c?"height":"width";if(!n||!o){return}var h=co(a.padding,i);var u=Wn(n);var f=l==="y"?cn:un;var p=l==="y"?dn:hn;var b=i.rects.reference[d]+i.rects.reference[l]-o[l]-i.rects.popper[d];var g=o[l]-i.rects.reference[l];var m=io(n);var v=m?l==="y"?m.clientHeight||0:m.clientWidth||0:0;var y=b/2-g/2;var k=h[f];var w=v-u[d]-h[p];var x=v/2-u[d]/2+y;var _=ao(k,x,w);var D=l;i.modifiersData[s]=(e={},e[D]=_,e.centerOffset=_-x,e)}function uo(t){var e=t.state,i=t.options;var s=i.element,a=s===void 0?"[data-popper-arrow]":s;if(a==null){return}if(typeof a==="string"){a=e.elements.popper.querySelector(a);if(!a){return}}if(!qn(e.elements.popper,a)){return}e.elements.arrow=a}const fo={name:"arrow",enabled:true,phase:"main",fn:ho,effect:uo,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function po(t){return t.split("-")[1]}var bo={top:"auto",right:"auto",bottom:"auto",left:"auto"};function go(t,e){var i=t.x,s=t.y;var a=e.devicePixelRatio||1;return{x:Un(i*a)/a||0,y:Un(s*a)/a||0}}function mo(t){var e;var i=t.popper,s=t.popperRect,a=t.placement,n=t.variation,o=t.offsets,r=t.position,l=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,h=t.isFixed;var u=o.x,f=u===void 0?0:u,p=o.y,b=p===void 0?0:p;var g=typeof d==="function"?d({x:f,y:b}):{x:f,y:b};f=g.x;b=g.y;var m=o.hasOwnProperty("x");var v=o.hasOwnProperty("y");var y=un;var k=cn;var w=window;if(c){var x=io(i);var _="clientHeight";var D="clientWidth";if(x===In(i)){x=Qn(i);if(Xn(x).position!=="static"&&r==="absolute"){_="scrollHeight";D="scrollWidth"}}x=x;if(a===cn||(a===un||a===hn)&&n===gn){k=dn;var C=h&&x===w&&w.visualViewport?w.visualViewport.height:x[_];b-=C-s.height;b*=l?1:-1}if(a===un||(a===cn||a===dn)&&n===gn){y=hn;var O=h&&x===w&&w.visualViewport?w.visualViewport.width:x[D];f-=O-s.width;f*=l?1:-1}}var M=Object.assign({position:r},c&&bo);var E=d===true?go({x:f,y:b},In(i)):{x:f,y:b};f=E.x;b=E.y;if(l){var Y;return Object.assign({},M,(Y={},Y[k]=v?"0":"",Y[y]=m?"0":"",Y.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+b+"px)":"translate3d("+f+"px, "+b+"px, 0)",Y))}return Object.assign({},M,(e={},e[k]=v?b+"px":"",e[y]=m?f+"px":"",e.transform="",e))}function vo(t){var e=t.state,i=t.options;var s=i.gpuAcceleration,a=s===void 0?true:s,n=i.adaptive,o=n===void 0?true:n,r=i.roundOffsets,l=r===void 0?true:r;var c={placement:Ln(e.placement),variation:po(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};if(e.modifiersData.popperOffsets!=null){e.styles.popper=Object.assign({},e.styles.popper,mo(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))}if(e.modifiersData.arrow!=null){e.styles.arrow=Object.assign({},e.styles.arrow,mo(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:false,roundOffsets:l})))}e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const yo={name:"computeStyles",enabled:true,phase:"beforeWrite",fn:vo,data:{}};var ko={passive:true};function wo(t){var e=t.state,i=t.instance,s=t.options;var a=s.scroll,n=a===void 0?true:a,o=s.resize,r=o===void 0?true:o;var l=In(e.elements.popper);var c=[].concat(e.scrollParents.reference,e.scrollParents.popper);if(n){c.forEach((function(t){t.addEventListener("scroll",i.update,ko)}))}if(r){l.addEventListener("resize",i.update,ko)}return function(){if(n){c.forEach((function(t){t.removeEventListener("scroll",i.update,ko)}))}if(r){l.removeEventListener("resize",i.update,ko)}}}const xo={name:"eventListeners",enabled:true,phase:"write",fn:function t(){},effect:wo,data:{}};var _o={left:"right",right:"left",bottom:"top",top:"bottom"};function Do(t){return t.replace(/left|right|bottom|top/g,(function(t){return _o[t]}))}var Co={start:"end",end:"start"};function Oo(t){return t.replace(/start|end/g,(function(t){return Co[t]}))}function Mo(t){var e=In(t);var i=e.pageXOffset;var s=e.pageYOffset;return{scrollLeft:i,scrollTop:s}}function Eo(t){return Kn(Qn(t)).left+Mo(t).scrollLeft}function Yo(t,e){var i=In(t);var s=Qn(t);var a=i.visualViewport;var n=s.clientWidth;var o=s.clientHeight;var r=0;var l=0;if(a){n=a.width;o=a.height;var c=Gn();if(c||!c&&e==="fixed"){r=a.offsetLeft;l=a.offsetTop}}return{width:n,height:o,x:r+Eo(t),y:l}}function Ao(t){var e;var i=Qn(t);var s=Mo(t);var a=(e=t.ownerDocument)==null?void 0:e.body;var n=Pn(i.scrollWidth,i.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0);var o=Pn(i.scrollHeight,i.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);var r=-s.scrollLeft+Eo(t);var l=-s.scrollTop;if(Xn(a||i).direction==="rtl"){r+=Pn(i.clientWidth,a?a.clientWidth:0)-n}return{width:n,height:o,x:r,y:l}}function To(t){var e=Xn(t),i=e.overflow,s=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+a+s)}function So(t){if(["html","body","#document"].indexOf(Bn(t))>=0){return t.ownerDocument.body}if(zn(t)&&To(t)){return t}return So(Zn(t))}function Bo(t,e){var i;if(e===void 0){e=[]}var s=So(t);var a=s===((i=t.ownerDocument)==null?void 0:i.body);var n=In(s);var o=a?[n].concat(n.visualViewport||[],To(s)?s:[]):s;var r=e.concat(o);return a?r:r.concat(Bo(Zn(o)))}function Io(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function jo(t,e){var i=Kn(t,false,e==="fixed");i.top=i.top+t.clientTop;i.left=i.left+t.clientLeft;i.bottom=i.top+t.clientHeight;i.right=i.left+t.clientWidth;i.width=t.clientWidth;i.height=t.clientHeight;i.x=i.left;i.y=i.top;return i}function zo(t,e,i){return e===vn?Io(Yo(t,i)):jn(e)?jo(e,i):Io(Ao(Qn(t)))}function No(t){var e=Bo(Zn(t));var i=["absolute","fixed"].indexOf(Xn(t).position)>=0;var s=i&&zn(t)?io(t):t;if(!jn(s)){return[]}return e.filter((function(t){return jn(t)&&qn(t,s)&&Bn(t)!=="body"}))}function Ro(t,e,i,s){var a=e==="clippingParents"?No(t):[].concat(e);var n=[].concat(a,[i]);var o=n[0];var r=n.reduce((function(e,i){var a=zo(t,i,s);e.top=Pn(a.top,e.top);e.right=Hn(a.right,e.right);e.bottom=Hn(a.bottom,e.bottom);e.left=Pn(a.left,e.left);return e}),zo(t,o,s));r.width=r.right-r.left;r.height=r.bottom-r.top;r.x=r.left;r.y=r.top;return r}function $o(t){var e=t.reference,i=t.element,s=t.placement;var a=s?Ln(s):null;var n=s?po(s):null;var o=e.x+e.width/2-i.width/2;var r=e.y+e.height/2-i.height/2;var l;switch(a){case cn:l={x:o,y:e.y-i.height};break;case dn:l={x:o,y:e.y+e.height};break;case hn:l={x:e.x+e.width,y:r};break;case un:l={x:e.x-i.width,y:r};break;default:l={x:e.x,y:e.y}}var c=a?so(a):null;if(c!=null){var d=c==="y"?"height":"width";switch(n){case bn:l[c]=l[c]-(e[d]/2-i[d]/2);break;case gn:l[c]=l[c]+(e[d]/2-i[d]/2);break}}return l}function Fo(t,e){if(e===void 0){e={}}var i=e,s=i.placement,a=s===void 0?t.placement:s,n=i.strategy,o=n===void 0?t.strategy:n,r=i.boundary,l=r===void 0?mn:r,c=i.rootBoundary,d=c===void 0?vn:c,h=i.elementContext,u=h===void 0?yn:h,f=i.altBoundary,p=f===void 0?false:f,b=i.padding,g=b===void 0?0:b;var m=ro(typeof g!=="number"?g:lo(g,pn));var v=u===yn?kn:yn;var y=t.rects.popper;var k=t.elements[p?v:u];var w=Ro(jn(k)?k:k.contextElement||Qn(t.elements.popper),l,d,o);var x=Kn(t.elements.reference);var _=$o({reference:x,element:y,strategy:"absolute",placement:a});var D=Io(Object.assign({},y,_));var C=u===yn?D:x;var O={top:w.top-C.top+m.top,bottom:C.bottom-w.bottom+m.bottom,left:w.left-C.left+m.left,right:C.right-w.right+m.right};var M=t.modifiersData.offset;if(u===yn&&M){var E=M[a];Object.keys(O).forEach((function(t){var e=[hn,dn].indexOf(t)>=0?1:-1;var i=[cn,dn].indexOf(t)>=0?"y":"x";O[t]+=E[i]*e}))}return O}function Lo(t,e){if(e===void 0){e={}}var i=e,s=i.placement,a=i.boundary,n=i.rootBoundary,o=i.padding,r=i.flipVariations,l=i.allowedAutoPlacements,c=l===void 0?xn:l;var d=po(s);var h=d?r?wn:wn.filter((function(t){return po(t)===d})):pn;var u=h.filter((function(t){return c.indexOf(t)>=0}));if(u.length===0){u=h}var f=u.reduce((function(e,i){e[i]=Fo(t,{placement:i,boundary:a,rootBoundary:n,padding:o})[Ln(i)];return e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}function Po(t){if(Ln(t)===fn){return[]}var e=Do(t);return[Oo(t),e,Oo(e)]}function Ho(t){var e=t.state,i=t.options,s=t.name;if(e.modifiersData[s]._skip){return}var a=i.mainAxis,n=a===void 0?true:a,o=i.altAxis,r=o===void 0?true:o,l=i.fallbackPlacements,c=i.padding,d=i.boundary,h=i.rootBoundary,u=i.altBoundary,f=i.flipVariations,p=f===void 0?true:f,b=i.allowedAutoPlacements;var g=e.options.placement;var m=Ln(g);var v=m===g;var y=l||(v||!p?[Do(g)]:Po(g));var k=[g].concat(y).reduce((function(t,i){return t.concat(Ln(i)===fn?Lo(e,{placement:i,boundary:d,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:b}):i)}),[]);var w=e.rects.reference;var x=e.rects.popper;var _=new Map;var D=true;var C=k[0];for(var O=0;O<k.length;O++){var M=k[O];var E=Ln(M);var Y=po(M)===bn;var A=[cn,dn].indexOf(E)>=0;var T=A?"width":"height";var S=Fo(e,{placement:M,boundary:d,rootBoundary:h,altBoundary:u,padding:c});var B=A?Y?hn:un:Y?dn:cn;if(w[T]>x[T]){B=Do(B)}var I=Do(B);var j=[];if(n){j.push(S[E]<=0)}if(r){j.push(S[B]<=0,S[I]<=0)}if(j.every((function(t){return t}))){C=M;D=false;break}_.set(M,j)}if(D){var z=p?3:1;var N=function t(e){var i=k.find((function(t){var i=_.get(t);if(i){return i.slice(0,e).every((function(t){return t}))}}));if(i){C=i;return"break"}};for(var R=z;R>0;R--){var $=N(R);if($==="break")break}}if(e.placement!==C){e.modifiersData[s]._skip=true;e.placement=C;e.reset=true}}const Uo={name:"flip",enabled:true,phase:"main",fn:Ho,requiresIfExists:["offset"],data:{_skip:false}};function Vo(t,e,i){if(i===void 0){i={x:0,y:0}}return{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function Go(t){return[cn,hn,dn,un].some((function(e){return t[e]>=0}))}function Ko(t){var e=t.state,i=t.name;var s=e.rects.reference;var a=e.rects.popper;var n=e.modifiersData.preventOverflow;var o=Fo(e,{elementContext:"reference"});var r=Fo(e,{altBoundary:true});var l=Vo(o,s);var c=Vo(r,a,n);var d=Go(l);var h=Go(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:h};e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const Wo={name:"hide",enabled:true,phase:"main",requiresIfExists:["preventOverflow"],fn:Ko};function qo(t,e,i){var s=Ln(t);var a=[un,cn].indexOf(s)>=0?-1:1;var n=typeof i==="function"?i(Object.assign({},e,{placement:t})):i,o=n[0],r=n[1];o=o||0;r=(r||0)*a;return[un,hn].indexOf(s)>=0?{x:r,y:o}:{x:o,y:r}}function Xo(t){var e=t.state,i=t.options,s=t.name;var a=i.offset,n=a===void 0?[0,0]:a;var o=xn.reduce((function(t,i){t[i]=qo(i,e.rects,n);return t}),{});var r=o[e.placement],l=r.x,c=r.y;if(e.modifiersData.popperOffsets!=null){e.modifiersData.popperOffsets.x+=l;e.modifiersData.popperOffsets.y+=c}e.modifiersData[s]=o}const Jo={name:"offset",enabled:true,phase:"main",requires:["popperOffsets"],fn:Xo};function Qo(t){var e=t.state,i=t.name;e.modifiersData[i]=$o({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Zo={name:"popperOffsets",enabled:true,phase:"read",fn:Qo,data:{}};function tr(t){return t==="x"?"y":"x"}function er(t){var e=t.state,i=t.options,s=t.name;var a=i.mainAxis,n=a===void 0?true:a,o=i.altAxis,r=o===void 0?false:o,l=i.boundary,c=i.rootBoundary,d=i.altBoundary,h=i.padding,u=i.tether,f=u===void 0?true:u,p=i.tetherOffset,b=p===void 0?0:p;var g=Fo(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:d});var m=Ln(e.placement);var v=po(e.placement);var y=!v;var k=so(m);var w=tr(k);var x=e.modifiersData.popperOffsets;var _=e.rects.reference;var D=e.rects.popper;var C=typeof b==="function"?b(Object.assign({},e.rects,{placement:e.placement})):b;var O=typeof C==="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C);var M=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null;var E={x:0,y:0};if(!x){return}if(n){var Y;var A=k==="y"?cn:un;var T=k==="y"?dn:hn;var S=k==="y"?"height":"width";var B=x[k];var I=B+g[A];var j=B-g[T];var z=f?-D[S]/2:0;var N=v===bn?_[S]:D[S];var R=v===bn?-D[S]:-_[S];var $=e.elements.arrow;var F=f&&$?Wn($):{width:0,height:0};var L=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:oo();var P=L[A];var H=L[T];var U=ao(0,_[S],F[S]);var V=y?_[S]/2-z-U-P-O.mainAxis:N-U-P-O.mainAxis;var G=y?-_[S]/2+z+U+H+O.mainAxis:R+U+H+O.mainAxis;var K=e.elements.arrow&&io(e.elements.arrow);var W=K?k==="y"?K.clientTop||0:K.clientLeft||0:0;var q=(Y=M==null?void 0:M[k])!=null?Y:0;var X=B+V-q-W;var J=B+G-q;var Q=ao(f?Hn(I,X):I,B,f?Pn(j,J):j);x[k]=Q;E[k]=Q-B}if(r){var Z;var tt=k==="x"?cn:un;var et=k==="x"?dn:hn;var it=x[w];var st=w==="y"?"height":"width";var at=it+g[tt];var nt=it-g[et];var ot=[cn,un].indexOf(m)!==-1;var rt=(Z=M==null?void 0:M[w])!=null?Z:0;var lt=ot?at:it-_[st]-D[st]-rt+O.altAxis;var ct=ot?it+_[st]+D[st]-rt-O.altAxis:nt;var dt=f&&ot?no(lt,it,ct):ao(f?lt:at,it,f?ct:nt);x[w]=dt;E[w]=dt-it}e.modifiersData[s]=E}const ir={name:"preventOverflow",enabled:true,phase:"main",fn:er,requiresIfExists:["offset"]};function sr(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ar(t){if(t===In(t)||!zn(t)){return Mo(t)}else{return sr(t)}}function nr(t){var e=t.getBoundingClientRect();var i=Un(e.width)/t.offsetWidth||1;var s=Un(e.height)/t.offsetHeight||1;return i!==1||s!==1}function or(t,e,i){if(i===void 0){i=false}var s=zn(e);var a=zn(e)&&nr(e);var n=Qn(e);var o=Kn(t,a,i);var r={scrollLeft:0,scrollTop:0};var l={x:0,y:0};if(s||!s&&!i){if(Bn(e)!=="body"||To(n)){r=ar(e)}if(zn(e)){l=Kn(e,true);l.x+=e.clientLeft;l.y+=e.clientTop}else if(n){l.x=Eo(n)}}return{x:o.left+r.scrollLeft-l.x,y:o.top+r.scrollTop-l.y,width:o.width,height:o.height}}function rr(t){var e=new Map;var i=new Set;var s=[];t.forEach((function(t){e.set(t.name,t)}));function a(t){i.add(t.name);var n=[].concat(t.requires||[],t.requiresIfExists||[]);n.forEach((function(t){if(!i.has(t)){var s=e.get(t);if(s){a(s)}}}));s.push(t)}t.forEach((function(t){if(!i.has(t.name)){a(t)}}));return s}function lr(t){var e=rr(t);return Sn.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}function cr(t){var e;return function(){if(!e){e=new Promise((function(i){Promise.resolve().then((function(){e=undefined;i(t())}))}))}return e}}function dr(t){var e=t.reduce((function(t,e){var i=t[e.name];t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e;return t}),{});return Object.keys(e).map((function(t){return e[t]}))}var hr={placement:"bottom",modifiers:[],strategy:"absolute"};function ur(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}return!e.some((function(t){return!(t&&typeof t.getBoundingClientRect==="function")}))}function fr(t){if(t===void 0){t={}}var e=t,i=e.defaultModifiers,s=i===void 0?[]:i,a=e.defaultOptions,n=a===void 0?hr:a;return function t(e,i,a){if(a===void 0){a=n}var o={placement:"bottom",orderedModifiers:[],options:Object.assign({},hr,n),modifiersData:{},elements:{reference:e,popper:i},attributes:{},styles:{}};var r=[];var l=false;var c={state:o,setOptions:function t(a){var r=typeof a==="function"?a(o.options):a;h();o.options=Object.assign({},n,o.options,r);o.scrollParents={reference:jn(e)?Bo(e):e.contextElement?Bo(e.contextElement):[],popper:Bo(i)};var l=lr(dr([].concat(s,o.options.modifiers)));o.orderedModifiers=l.filter((function(t){return t.enabled}));d();return c.update()},forceUpdate:function t(){if(l){return}var e=o.elements,i=e.reference,s=e.popper;if(!ur(i,s)){return}o.rects={reference:or(i,io(s),o.options.strategy==="fixed"),popper:Wn(s)};o.reset=false;o.placement=o.options.placement;o.orderedModifiers.forEach((function(t){return o.modifiersData[t.name]=Object.assign({},t.data)}));for(var a=0;a<o.orderedModifiers.length;a++){if(o.reset===true){o.reset=false;a=-1;continue}var n=o.orderedModifiers[a],r=n.fn,d=n.options,h=d===void 0?{}:d,u=n.name;if(typeof r==="function"){o=r({state:o,options:h,name:u,instance:c})||o}}},update:cr((function(){return new Promise((function(t){c.forceUpdate();t(o)}))})),destroy:function t(){h();l=true}};if(!ur(e,i)){return c}c.setOptions(a).then((function(t){if(!l&&a.onFirstUpdate){a.onFirstUpdate(t)}}));function d(){o.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,s=i===void 0?{}:i,a=t.effect;if(typeof a==="function"){var n=a({state:o,name:e,instance:c,options:s});var l=function t(){};r.push(n||l)}}))}function h(){r.forEach((function(t){return t()}));r=[]}return c}}var pr=[xo,Zo,yo,Fn,Jo,Uo,ir,fo,Wo];var br=fr({defaultModifiers:pr});var gr={exports:{}};(function(t,e){!function(e,i){t.exports=i()}(_t,(function(){return function(){var t={d:function(e,i){for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return P}});var i={days:"days",months:"months",years:"years",day:"day",month:"month",year:"year",eventChangeViewDate:"changeViewDate",eventChangeCurrentView:"changeCurrentView",eventChangeFocusDate:"changeFocusDate",eventChangeSelectedDate:"changeSelectedDate",eventChangeTime:"changeTime",eventChangeLastSelectedDate:"changeLastSelectedDate",actionSelectDate:"selectDate",actionUnselectDate:"unselectDate",cssClassWeekend:"-weekend-"},s={classes:"",inline:!1,locale:{days:["","","","","","",""],daysShort:["","","","","","",""],daysMin:["","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",clear:"",dateFormat:"dd.MM.yyyy",timeFormat:"HH:mm",firstDay:1},startDate:new Date,firstDay:"",weekends:[6,0],dateFormat:"",altField:"",altFieldDateFormat:"T",toggleSelected:!0,keyboardNav:!0,selectedDates:!1,container:"",isMobile:!1,visible:!1,position:"bottom left",offset:12,view:i.days,minView:i.days,showOtherMonths:!0,selectOtherMonths:!0,moveToOtherMonthsOnSelect:!0,showOtherYears:!0,selectOtherYears:!0,moveToOtherYearsOnSelect:!0,minDate:"",maxDate:"",disableNavWhenOutOfRange:!0,multipleDates:!1,multipleDatesSeparator:", ",range:!1,dynamicRange:!0,buttons:!1,monthsField:"monthsShort",showEvent:"focus",autoClose:!1,fixedHeight:!1,prevHtml:'<svg><path d="M 17,12 l -5,5 l 5,5"></path></svg>',nextHtml:'<svg><path d="M 14,12 l 5,5 l -5,5"></path></svg>',navTitles:{days:"MMMM, <i>yyyy</i>",months:"yyyy",years:"yyyy1 - yyyy2"},timepicker:!1,onlyTimepicker:!1,dateTimeSeparator:" ",timeFormat:"",minHours:0,maxHours:24,minMinutes:0,maxMinutes:59,hoursStep:1,minutesStep:1,onSelect:!1,onChangeViewDate:!1,onChangeView:!1,onRenderCell:!1,onShow:!1,onHide:!1,onClickDayName:!1};function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return"string"==typeof t?e.querySelector(t):t}function n(){let{tagName:t="div",className:e="",innerHtml:i="",id:s="",attrs:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.createElement(t);return e&&n.classList.add(...e.split(" ")),s&&(n.id=s),i&&(n.innerHTML=i),a&&o(n,a),n}function o(t,e){for(let[i,s]of Object.entries(e))void 0!==s&&t.setAttribute(i,s);return t}function r(t){return new Date(t.getFullYear(),t.getMonth()+1,0).getDate()}function l(t){let e=t.getHours(),{hours:i,dayPeriod:s}=c(e);return{year:t.getFullYear(),month:t.getMonth(),fullMonth:t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,date:t.getDate(),fullDate:t.getDate()<10?"0"+t.getDate():t.getDate(),day:t.getDay(),hours:e,fullHours:d(e),hours12:i,dayPeriod:s,fullHours12:d(i),minutes:t.getMinutes(),fullMinutes:t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}}function c(t){return{dayPeriod:t>11?"pm":"am",hours:t%12==0?12:t%12}}function d(t){return t<10?"0"+t:t}function h(t){let e=10*Math.floor(t.getFullYear()/10);return[e,e+9]}function u(){let t=[];for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return i.forEach((e=>{if("object"==typeof e)for(let i in e)e[i]&&t.push(i);else e&&t.push(e)})),t.join(" ")}function f(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.days;if(!t||!e)return!1;let a=l(t),n=l(e);return{[i.days]:a.date===n.date&&a.month===n.month&&a.year===n.year,[i.months]:a.month===n.month&&a.year===n.year,[i.years]:a.year===n.year}[s]}function p(t,e,i){let s=g(t,!1).getTime(),a=g(e,!1).getTime();return i?s>=a:s>a}function b(t,e){return!p(t,e,!0)}function g(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new Date(t.getTime());return"boolean"!=typeof e||e||function(t){t.setHours(0,0,0,0)}(i),i}function m(t,e,i){t.length?t.forEach((t=>{t.addEventListener(e,i)})):t.addEventListener(e,i)}function v(t,e){return!(!t||t===document||t instanceof DocumentFragment)&&(t.matches(e)?t:v(t.parentNode,e))}function y(t,e,i){return t>i?i:t<e?e:t}function k(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return i.filter((t=>t)).forEach((e=>{for(let[i,s]of Object.entries(e))if(void 0!==s&&"[object Object]"===s.toString()){let e=void 0!==t[i]?t[i].toString():void 0,a=s.toString(),n=Array.isArray(s)?[]:{};t[i]=t[i]?e!==a?n:t[i]:n,k(t[i],s)}else t[i]=s})),t}function w(t){let e=t;return t instanceof Date||("string"==typeof t&&/^\d{4}-\d{2}-\d{2}$/.test(t)&&(t+="T00:00:00"),e=new Date(t)),isNaN(e.getTime())&&(console.log(`Unable to convert value "${t}" to Date object`),e=!1),e}function x(t){let e="\\s|\\.|-|/|\\\\|,|\\$|\\!|\\?|:|;";return new RegExp("(^|>|"+e+")("+t+")($|<|"+e+")","g")}function _(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class D{constructor(){let{type:t,date:e,dp:i,opts:s,body:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_(this,"focus",(()=>{this.$cell.classList.add("-focus-"),this.focused=!0})),_(this,"removeFocus",(()=>{this.$cell.classList.remove("-focus-"),this.focused=!1})),_(this,"select",(()=>{this.$cell.classList.add("-selected-"),this.selected=!0})),_(this,"removeSelect",(()=>{this.$cell.classList.remove("-selected-","-range-from-","-range-to-"),this.selected=!1})),_(this,"onChangeSelectedDate",(()=>{this.isDisabled||(this._handleSelectedStatus(),this.opts.range&&this._handleRangeStatus())})),_(this,"onChangeFocusDate",(t=>{if(!t)return void(this.focused&&this.removeFocus());let e=f(t,this.date,this.type);e?this.focus():!e&&this.focused&&this.removeFocus(),this.opts.range&&this._handleRangeStatus()})),_(this,"render",(()=>(this.$cell.innerHTML=this._getHtml(),this._handleClasses(),this.$cell))),this.type=t,this.singleType=this.type.slice(0,-1),this.date=e,this.dp=i,this.opts=s,this.body=a,this.customData=!1,this.init()}init(){var t;let{onRenderCell:e}=this.opts;e&&(this.customData=e({date:this.date,cellType:this.singleType,datepicker:this.dp})),this._createElement(),this._bindDatepickerEvents(),null!==(t=this.customData)&&void 0!==t&&t.disabled&&this.dp.disableDate(this.date)}_bindDatepickerEvents(){this.dp.on(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.on(i.eventChangeFocusDate,this.onChangeFocusDate)}unbindDatepickerEvents(){this.dp.off(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.off(i.eventChangeFocusDate,this.onChangeFocusDate)}_createElement(){var t;let{year:e,month:i,date:s}=l(this.date),a=(null===(t=this.customData)||void 0===t?void 0:t.attrs)||{};this.$cell=n({attrs:{"data-year":e,"data-month":i,"data-date":s,...a}}),this.$cell.adpCell=this}_getClassName(){var t;let e=new Date,{selectOtherMonths:s,selectOtherYears:a}=this.opts,{minDate:n,maxDate:o,isDateDisabled:r}=this.dp,{day:c}=l(this.date),d=this._isOutOfMinMaxRange(),h=r(this.date),p=u("air-datepicker-cell",`-${this.singleType}-`,{"-current-":f(e,this.date,this.type),"-min-date-":n&&f(n,this.date,this.type),"-max-date-":o&&f(o,this.date,this.type)}),b="";switch(this.type){case i.days:b=u({"-weekend-":this.dp.isWeekend(c),"-other-month-":this.isOtherMonth,"-disabled-":this.isOtherMonth&&!s||d||h});break;case i.months:b=u({"-disabled-":d});break;case i.years:b=u({"-other-decade-":this.isOtherDecade,"-disabled-":d||this.isOtherDecade&&!a})}return u(p,b,null===(t=this.customData)||void 0===t?void 0:t.classes).split(" ")}_getHtml(){var t;let{year:e,month:s,date:a}=l(this.date),{showOtherMonths:n,showOtherYears:o}=this.opts;if(null!==(t=this.customData)&&void 0!==t&&t.html)return this.customData.html;switch(this.type){case i.days:return!n&&this.isOtherMonth?"":a;case i.months:return this.dp.locale[this.opts.monthsField][s];case i.years:return!o&&this.isOtherDecade?"":e}}_isOutOfMinMaxRange(){let{minDate:t,maxDate:e}=this.dp,{type:s,date:a}=this,{month:n,year:o,date:r}=l(a),c=s===i.days,d=s===i.years,h=!!t&&new Date(o,d?t.getMonth():n,c?r:t.getDate()),u=!!e&&new Date(o,d?e.getMonth():n,c?r:e.getDate());return t&&e?b(h,t)||p(u,e):t?b(h,t):e?p(u,e):void 0}destroy(){this.unbindDatepickerEvents()}_handleRangeStatus(){const{selectedDates:t,focusDate:e,rangeDateTo:i,rangeDateFrom:s}=this.dp,a=t.length;if(!a)return;let n=s,o=i;if(1===a&&e){const i=p(e,t[0]);n=i?t[0]:e,o=i?e:t[0]}let r=u({"-in-range-":n&&o&&(l=this.date,c=n,d=o,p(l,c)&&b(l,d)),"-range-from-":n&&f(this.date,n,this.type),"-range-to-":o&&f(this.date,o,this.type)});var l,c,d;this.$cell.classList.remove("-range-from-","-range-to-","-in-range-"),r&&this.$cell.classList.add(...r.split(" "))}_handleSelectedStatus(){let t=this.dp._checkIfDateIsSelected(this.date,this.type);t?this.select():!t&&this.selected&&this.removeSelect()}_handleInitialFocusStatus(){f(this.dp.focusDate,this.date,this.type)&&this.focus()}_handleClasses(){this.$cell.setAttribute("class",""),this._handleInitialFocusStatus(),this.dp.hasSelectedDates&&(this._handleSelectedStatus(),this.dp.opts.range&&this._handleRangeStatus()),this.$cell.classList.add(...this._getClassName())}get isDisabled(){return this.$cell.matches(".-disabled-")}get isOtherMonth(){return this.dp.isOtherMonth(this.date)}get isOtherDecade(){return this.dp.isOtherDecade(this.date)}}function C(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let O={[i.days]:`<div class="air-datepicker-body--day-names"></div><div class="air-datepicker-body--cells -${i.days}-"></div>`,[i.months]:`<div class="air-datepicker-body--cells -${i.months}-"></div>`,[i.years]:`<div class="air-datepicker-body--cells -${i.years}-"></div>`};const M=".air-datepicker-cell";class E{constructor(t){let{dp:e,type:s,opts:a}=t;C(this,"handleClick",(t=>{let e=t.target.closest(M).adpCell;if(e.isDisabled)return;if(!this.dp.isMinViewReached)return void this.dp.down();let i=this.dp._checkIfDateIsSelected(e.date,e.type);i?this.dp._handleAlreadySelectedDates(i,e.date):this.dp.selectDate(e.date)})),C(this,"handleDayNameClick",(t=>{let e=t.target.getAttribute("data-day-index");this.opts.onClickDayName({dayIndex:Number(e),datepicker:this.dp})})),C(this,"onChangeCurrentView",(t=>{t!==this.type?this.hide():(this.show(),this.render())})),C(this,"onMouseOverCell",(t=>{let e=v(t.target,M);this.dp.setFocusDate(!!e&&e.adpCell.date)})),C(this,"onMouseOutCell",(()=>{this.dp.setFocusDate(!1)})),C(this,"onClickBody",(t=>{let{onClickDayName:e}=this.opts,i=t.target;i.closest(M)&&this.handleClick(t),e&&i.closest(".air-datepicker-body--day-name")&&this.handleDayNameClick(t)})),C(this,"onMouseDown",(t=>{this.pressed=!0;let e=v(t.target,M),i=e&&e.adpCell;f(i.date,this.dp.rangeDateFrom)&&(this.rangeFromFocused=!0),f(i.date,this.dp.rangeDateTo)&&(this.rangeToFocused=!0)})),C(this,"onMouseMove",(t=>{if(!this.pressed||!this.dp.isMinViewReached)return;t.preventDefault();let e=v(t.target,M),i=e&&e.adpCell,{selectedDates:s,rangeDateTo:a,rangeDateFrom:n}=this.dp;if(!i||i.isDisabled)return;let{date:o}=i;if(2===s.length){if(this.rangeFromFocused&&!p(o,a)){let{hours:t,minutes:e}=l(n);o.setHours(t),o.setMinutes(e),this.dp.rangeDateFrom=o,this.dp.replaceDate(n,o)}if(this.rangeToFocused&&!b(o,n)){let{hours:t,minutes:e}=l(a);o.setHours(t),o.setMinutes(e),this.dp.rangeDateTo=o,this.dp.replaceDate(a,o)}}})),C(this,"onMouseUp",(()=>{this.pressed=!1,this.rangeFromFocused=!1,this.rangeToFocused=!1})),C(this,"onChangeViewDate",((t,e)=>{if(!this.isVisible)return;let s=h(t),a=h(e);switch(this.dp.currentView){case i.days:if(f(t,e,i.months))return;break;case i.months:if(f(t,e,i.years))return;break;case i.years:if(s[0]===a[0]&&s[1]===a[1])return}this.render()})),C(this,"render",(()=>{this.destroyCells(),this._generateCells(),this.cells.forEach((t=>{this.$cells.appendChild(t.render())}))})),this.dp=e,this.type=s,this.opts=a,this.cells=[],this.$el="",this.pressed=!1,this.isVisible=!0,this.init()}init(){this._buildBaseHtml(),this.type===i.days&&this.renderDayNames(),this.render(),this._bindEvents(),this._bindDatepickerEvents()}_bindEvents(){let{range:t,dynamicRange:e}=this.opts;m(this.$el,"mouseover",this.onMouseOverCell),m(this.$el,"mouseout",this.onMouseOutCell),m(this.$el,"click",this.onClickBody),t&&e&&(m(this.$el,"mousedown",this.onMouseDown),m(this.$el,"mousemove",this.onMouseMove),m(window.document,"mouseup",this.onMouseUp))}_bindDatepickerEvents(){this.dp.on(i.eventChangeViewDate,this.onChangeViewDate),this.dp.on(i.eventChangeCurrentView,this.onChangeCurrentView)}_buildBaseHtml(){this.$el=n({className:`air-datepicker-body -${this.type}-`,innerHtml:O[this.type]}),this.$names=a(".air-datepicker-body--day-names",this.$el),this.$cells=a(".air-datepicker-body--cells",this.$el)}_getDayNamesHtml(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dp.locale.firstDay,e="",s=this.dp.isWeekend,{onClickDayName:a}=this.opts,n=t,o=0;for(;o<7;){let t=n%7;e+=`<div class="${u("air-datepicker-body--day-name",{[i.cssClassWeekend]:s(t),"-clickable-":!!a})}" data-day-index='${t}'>${this.dp.locale.daysMin[t]}</div>`,o++,n++}return e}renderDayNames(){this.$names.innerHTML=this._getDayNamesHtml()}_generateCell(t){let{type:e,dp:i,opts:s}=this;return new D({type:e,dp:i,opts:s,date:t,body:this})}_generateCells(){E.getDatesFunction(this.type)(this.dp,(t=>{this.cells.push(this._generateCell(t))}))}show(){this.isVisible=!0,this.$el.classList.remove("-hidden-")}hide(){this.isVisible=!1,this.$el.classList.add("-hidden-")}destroyCells(){this.cells.forEach((t=>t.destroy())),this.cells=[],this.$cells.innerHTML=""}destroy(){this.destroyCells(),this.dp.off(i.eventChangeViewDate,this.onChangeViewDate),this.dp.off(i.eventChangeCurrentView,this.onChangeCurrentView)}static getDaysDates(t,e){let{viewDate:i,opts:{fixedHeight:s},locale:{firstDay:a}}=t,n=r(i),{year:o,month:c}=l(i),d=new Date(o,c,1),h=new Date(o,c,n),u=d.getDay()-a,f=6-h.getDay()+a;u=u<0?u+7:u,f=f>6?f-7:f;let p=function(t,e){let{year:i,month:s,date:a}=l(t);return new Date(i,s,a-e)}(d,u),b=n+u+f,g=p.getDate(),{year:m,month:v}=l(p),y=0;s&&(b=42);const k=[];for(;y<b;){let t=new Date(m,v,g+y);e&&e(t),k.push(t),y++}return k}static getMonthsDates(t,e){let{year:i}=t.parsedViewDate,s=0,a=[];for(;s<12;){const t=new Date(i,s);a.push(t),e&&e(t),s++}return a}static getYearsDates(t,e){let i=h(t.viewDate),s=i[0]-1,a=i[1]+1,n=s,o=[];for(;n<=a;){const t=new Date(n,0);o.push(t),e&&e(t),n++}return o}static getDatesFunction(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.days;return{[i.days]:E.getDaysDates,[i.months]:E.getMonthsDates,[i.years]:E.getYearsDates}[t]}}function Y(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class A{constructor(t){let{dp:e,opts:i}=t;Y(this,"onClickNav",(t=>{let e=v(t.target,".air-datepicker-nav--action");if(!e)return;let i=e.dataset.action;this.dp[i]()})),Y(this,"onChangeViewDate",(()=>{this.render(),this._resetNavStatus(),this.handleNavStatus()})),Y(this,"onChangeCurrentView",(()=>{this.render(),this._resetNavStatus(),this.handleNavStatus()})),Y(this,"onClickNavTitle",(()=>{this.dp.isFinalView||this.dp.up()})),Y(this,"update",(()=>{let{prevHtml:t,nextHtml:e}=this.opts;this.$prev.innerHTML=t,this.$next.innerHTML=e,this._resetNavStatus(),this.render(),this.handleNavStatus()})),Y(this,"renderDelay",(()=>{setTimeout(this.render)})),Y(this,"render",(()=>{this.$title.innerHTML=this._getTitle(),function(t,e){for(let i in e)e[i]?t.classList.add(i):t.classList.remove(i)}(this.$title,{"-disabled-":this.dp.isFinalView})})),this.dp=e,this.opts=i,this.init()}init(){this._createElement(),this._buildBaseHtml(),this._defineDOM(),this.render(),this.handleNavStatus(),this._bindEvents(),this._bindDatepickerEvents()}_defineDOM(){this.$title=a(".air-datepicker-nav--title",this.$el),this.$prev=a('[data-action="prev"]',this.$el),this.$next=a('[data-action="next"]',this.$el)}_bindEvents(){this.$el.addEventListener("click",this.onClickNav),this.$title.addEventListener("click",this.onClickNavTitle)}_bindDatepickerEvents(){this.dp.on(i.eventChangeViewDate,this.onChangeViewDate),this.dp.on(i.eventChangeCurrentView,this.onChangeCurrentView),this.isNavIsFunction&&(this.dp.on(i.eventChangeSelectedDate,this.renderDelay),this.dp.opts.timepicker&&this.dp.on(i.eventChangeTime,this.render))}destroy(){this.dp.off(i.eventChangeViewDate,this.onChangeViewDate),this.dp.off(i.eventChangeCurrentView,this.onChangeCurrentView),this.isNavIsFunction&&(this.dp.off(i.eventChangeSelectedDate,this.renderDelay),this.dp.opts.timepicker&&this.dp.off(i.eventChangeTime,this.render))}_createElement(){this.$el=n({tagName:"nav",className:"air-datepicker-nav"})}_getTitle(){let{dp:t,opts:e}=this,i=e.navTitles[t.currentView];return"function"==typeof i?i(t):t.formatDate(t.viewDate,i)}handleNavStatus(){let{disableNavWhenOutOfRange:t}=this.opts,{minDate:e,maxDate:s}=this.dp;if(!e&&!s||!t)return;let{year:a,month:n}=this.dp.parsedViewDate,o=!!e&&l(e),r=!!s&&l(s);switch(this.dp.currentView){case i.days:e&&o.month>=n&&o.year>=a&&this._disableNav("prev"),s&&r.month<=n&&r.year<=a&&this._disableNav("next");break;case i.months:e&&o.year>=a&&this._disableNav("prev"),s&&r.year<=a&&this._disableNav("next");break;case i.years:{let t=h(this.dp.viewDate);e&&o.year>=t[0]&&this._disableNav("prev"),s&&r.year<=t[1]&&this._disableNav("next");break}}}_disableNav(t){a('[data-action="'+t+'"]',this.$el).classList.add("-disabled-")}_resetNavStatus(){!function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];t.length?t.forEach((t=>{t.classList.remove(...i)})):t.classList.remove(...i)}(this.$el.querySelectorAll(".air-datepicker-nav--action"),"-disabled-")}_buildBaseHtml(){let{prevHtml:t,nextHtml:e}=this.opts;this.$el.innerHTML=`<div class="air-datepicker-nav--action" data-action="prev">${t}</div><div class="air-datepicker-nav--title"></div><div class="air-datepicker-nav--action" data-action="next">${e}</div>`}get isNavIsFunction(){let{navTitles:t}=this.opts;return Object.keys(t).find((e=>"function"==typeof t[e]))}}var T={today:{content:t=>t.locale.today,onClick:t=>t.setViewDate(new Date)},clear:{content:t=>t.locale.clear,onClick:t=>t.clear()}};class S{constructor(t){let{dp:e,opts:i}=t;this.dp=e,this.opts=i,this.init()}init(){this.createElement(),this.render()}createElement(){this.$el=n({className:"air-datepicker-buttons"})}destroy(){this.$el.parentNode.removeChild(this.$el)}clearHtml(){return this.$el.innerHTML="",this}generateButtons(){let{buttons:t}=this.opts;Array.isArray(t)||(t=[t]),t.forEach((t=>{let e=t;"string"==typeof t&&T[t]&&(e=T[t]);let i=this.createButton(e);e.onClick&&this.attachEventToButton(i,e.onClick),this.$el.appendChild(i)}))}attachEventToButton(t,e){t.addEventListener("click",(()=>{e(this.dp)}))}createButton(t){let{content:e,className:i,tagName:s="button",attrs:a={}}=t;return n({tagName:s,innerHtml:`<span tabindex='-1'>${"function"==typeof e?e(this.dp):e}</span>`,className:u("air-datepicker-button",i),attrs:a})}render(){this.generateButtons()}}function B(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class I{constructor(){let{opts:t,dp:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(this,"toggleTimepickerIsActive",(t=>{this.dp.timepickerIsActive=t})),B(this,"onChangeSelectedDate",(t=>{let{date:e,updateTime:i=!1}=t;e&&(this.setMinMaxTime(e),this.setCurrentTime(!!i&&e),this.addTimeToDate(e))})),B(this,"onChangeLastSelectedDate",(t=>{t&&(this.setTime(t),this.render())})),B(this,"onChangeInputRange",(t=>{let e=t.target;this[e.getAttribute("name")]=e.value,this.updateText(),this.dp.trigger(i.eventChangeTime,{hours:this.hours,minutes:this.minutes})})),B(this,"onMouseEnterLeave",(t=>{let e=t.target.getAttribute("name"),i=this.$minutesText;"hours"===e&&(i=this.$hoursText),i.classList.toggle("-focus-")})),B(this,"onFocus",(()=>{this.toggleTimepickerIsActive(!0)})),B(this,"onBlur",(()=>{this.toggleTimepickerIsActive(!1)})),this.opts=t,this.dp=e;let{timeFormat:s}=this.dp.locale;s&&(s.match(x("h"))||s.match(x("hh")))&&(this.ampm=!0),this.init()}init(){this.setTime(this.dp.lastSelectedDate||this.dp.viewDate),this.createElement(),this.buildHtml(),this.defineDOM(),this.render(),this.bindDatepickerEvents(),this.bindDOMEvents()}bindDatepickerEvents(){this.dp.on(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.on(i.eventChangeLastSelectedDate,this.onChangeLastSelectedDate)}bindDOMEvents(){let t="input";navigator.userAgent.match(/trident/gi)&&(t="change"),m(this.$ranges,t,this.onChangeInputRange),m(this.$ranges,"mouseenter",this.onMouseEnterLeave),m(this.$ranges,"mouseleave",this.onMouseEnterLeave),m(this.$ranges,"focus",this.onFocus),m(this.$ranges,"mousedown",this.onFocus),m(this.$ranges,"blur",this.onBlur)}createElement(){this.$el=n({className:u("air-datepicker-time",{"-am-pm-":this.dp.ampm})})}destroy(){this.dp.off(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.off(i.eventChangeLastSelectedDate,this.onChangeLastSelectedDate),this.$el.parentNode.removeChild(this.$el)}buildHtml(){let{ampm:t,hours:e,displayHours:i,minutes:s,minHours:a,minMinutes:n,maxHours:o,maxMinutes:r,dayPeriod:l,opts:{hoursStep:c,minutesStep:h}}=this;this.$el.innerHTML=`<div class="air-datepicker-time--current">   <span class="air-datepicker-time--current-hours">${d(i)}</span>   <span class="air-datepicker-time--current-colon">:</span>   <span class="air-datepicker-time--current-minutes">${d(s)}</span>   `+(t?`<span class='air-datepicker-time--current-ampm'>${l}</span>`:"")+'</div><div class="air-datepicker-time--sliders">   <div class="air-datepicker-time--row">'+`      <input type="range" name="hours" value="${e}" min="${a}" max="${o}" step="${c}"/>   </div>   <div class="air-datepicker-time--row">`+`      <input type="range" name="minutes" value="${s}" min="${n}" max="${r}" step="${h}"/>   </div></div>`}defineDOM(){let t=t=>a(t,this.$el);this.$ranges=this.$el.querySelectorAll('[type="range"]'),this.$hours=t('[name="hours"]'),this.$minutes=t('[name="minutes"]'),this.$hoursText=t(".air-datepicker-time--current-hours"),this.$minutesText=t(".air-datepicker-time--current-minutes"),this.$ampm=t(".air-datepicker-time--current-ampm")}setTime(t){this.setMinMaxTime(t),this.setCurrentTime(t)}addTimeToDate(t){t&&(t.setHours(this.hours),t.setMinutes(this.minutes))}setMinMaxTime(t){if(this.setMinMaxTimeFromOptions(),t){let{minDate:e,maxDate:i}=this.dp;e&&f(t,e)&&this.setMinTimeFromMinDate(e),i&&f(t,i)&&this.setMaxTimeFromMaxDate(i)}}setCurrentTime(t){let{hours:e,minutes:i}=t?l(t):this;this.hours=y(e,this.minHours,this.maxHours),this.minutes=y(i,this.minMinutes,this.maxMinutes)}setMinMaxTimeFromOptions(){let{minHours:t,minMinutes:e,maxHours:i,maxMinutes:s}=this.opts;this.minHours=y(t,0,23),this.minMinutes=y(e,0,59),this.maxHours=y(i,0,23),this.maxMinutes=y(s,0,59)}setMinTimeFromMinDate(t){let{lastSelectedDate:e}=this.dp;this.minHours=t.getHours(),e&&e.getHours()>t.getHours()?this.minMinutes=this.opts.minMinutes:this.minMinutes=t.getMinutes()}setMaxTimeFromMaxDate(t){let{lastSelectedDate:e}=this.dp;this.maxHours=t.getHours(),e&&e.getHours()<t.getHours()?this.maxMinutes=this.opts.maxMinutes:this.maxMinutes=t.getMinutes()}updateSliders(){o(this.$hours,{min:this.minHours,max:this.maxHours}).value=this.hours,o(this.$minutes,{min:this.minMinutes,max:this.maxMinutes}).value=this.minutes}updateText(){this.$hoursText.innerHTML=d(this.displayHours),this.$minutesText.innerHTML=d(this.minutes),this.ampm&&(this.$ampm.innerHTML=this.dayPeriod)}set hours(t){this._hours=t;let{hours:e,dayPeriod:i}=c(t);this.displayHours=this.ampm?e:t,this.dayPeriod=i}get hours(){return this._hours}render(){this.updateSliders(),this.updateText()}}function j(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class z{constructor(t){let{dp:e,opts:i}=t;j(this,"pressedKeys",new Set),j(this,"hotKeys",new Map([[[["Control","ArrowRight"],["Control","ArrowUp"]],t=>t.month++],[[["Control","ArrowLeft"],["Control","ArrowDown"]],t=>t.month--],[[["Shift","ArrowRight"],["Shift","ArrowUp"]],t=>t.year++],[[["Shift","ArrowLeft"],["Shift","ArrowDown"]],t=>t.year--],[[["Alt","ArrowRight"],["Alt","ArrowUp"]],t=>t.year+=10],[[["Alt","ArrowLeft"],["Alt","ArrowDown"]],t=>t.year-=10],[["Control","Shift","ArrowUp"],(t,e)=>e.up()]])),j(this,"handleHotKey",(t=>{let e=this.hotKeys.get(t),i=l(this.getInitialFocusDate());e(i,this.dp);let{year:s,month:a,date:n}=i,o=r(new Date(s,a));o<n&&(n=o);let c=this.dp.getClampedDate(new Date(s,a,n));this.dp.setFocusDate(c,{viewDateTransition:!0})})),j(this,"isHotKeyPressed",(()=>{let t=!1,e=this.pressedKeys.size,i=t=>this.pressedKeys.has(t);for(let[s]of this.hotKeys){if(t)break;if(Array.isArray(s[0]))s.forEach((a=>{t||e!==a.length||(t=a.every(i)&&s)}));else{if(e!==s.length)continue;t=s.every(i)&&s}}return t})),j(this,"isArrow",(t=>t>=37&&t<=40)),j(this,"onKeyDown",(t=>{let{key:e,which:i}=t,{dp:s,dp:{focusDate:a},opts:n}=this;this.registerKey(e);let o=this.isHotKeyPressed();if(o)return t.preventDefault(),void this.handleHotKey(o);if(this.isArrow(i))return t.preventDefault(),void this.focusNextCell(e);if("Enter"===e){if(s.currentView!==n.minView)return void s.down();if(a){let t=s._checkIfDateIsSelected(a);return void(t?s._handleAlreadySelectedDates(t,a):s.selectDate(a))}}"Escape"===e&&this.dp.hide()})),j(this,"onKeyUp",(t=>{this.removeKey(t.key)})),this.dp=e,this.opts=i,this.init()}init(){this.bindKeyboardEvents()}bindKeyboardEvents(){let{$el:t}=this.dp;t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let{$el:t}=this.dp;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),this.hotKeys=null,this.pressedKeys=null}getInitialFocusDate(){let{focusDate:t,currentView:e,selectedDates:s,parsedViewDate:{year:a,month:n}}=this.dp,o=t||s[s.length-1];if(!o)switch(e){case i.days:o=new Date(a,n,(new Date).getDate());break;case i.months:o=new Date(a,n,1);break;case i.years:o=new Date(a,0,1)}return o}focusNextCell(t){let e=this.getInitialFocusDate(),{currentView:s}=this.dp,{days:a,months:n,years:o}=i,r=l(e),c=r.year,d=r.month,h=r.date;switch(t){case"ArrowLeft":s===a&&(h-=1),s===n&&(d-=1),s===o&&(c-=1);break;case"ArrowUp":s===a&&(h-=7),s===n&&(d-=3),s===o&&(c-=4);break;case"ArrowRight":s===a&&(h+=1),s===n&&(d+=1),s===o&&(c+=1);break;case"ArrowDown":s===a&&(h+=7),s===n&&(d+=3),s===o&&(c+=4)}let u=this.dp.getClampedDate(new Date(c,d,h));this.dp.setFocusDate(u,{viewDateTransition:!0})}registerKey(t){this.pressedKeys.add(t)}removeKey(t){this.pressedKeys.delete(t)}}let N={on(t,e){this.__events||(this.__events={}),this.__events[t]?this.__events[t].push(e):this.__events[t]=[e]},off(t,e){this.__events&&this.__events[t]&&(this.__events[t]=this.__events[t].filter((t=>t!==e)))},removeAllEvents(){this.__events={}},trigger(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];this.__events&&this.__events[t]&&this.__events[t].forEach((t=>{t(...i)}))}};function R(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let $="",F="",L=!1;class P{static buildGlobalContainer(t){L=!0,$=n({className:t,id:t}),a("body").appendChild($)}constructor(t,e){var o=this;if(R(this,"viewIndexes",[i.days,i.months,i.years]),R(this,"next",(()=>{let{year:t,month:e}=this.parsedViewDate;switch(this.currentView){case i.days:this.setViewDate(new Date(t,e+1,1));break;case i.months:this.setViewDate(new Date(t+1,e,1));break;case i.years:this.setViewDate(new Date(t+10,0,1))}})),R(this,"prev",(()=>{let{year:t,month:e}=this.parsedViewDate;switch(this.currentView){case i.days:this.setViewDate(new Date(t,e-1,1));break;case i.months:this.setViewDate(new Date(t-1,e,1));break;case i.years:this.setViewDate(new Date(t-10,0,1))}})),R(this,"_finishHide",(()=>{this.hideAnimation=!1,this._destroyComponents(),this.$container.removeChild(this.$datepicker)})),R(this,"setPosition",(function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"==typeof(t=t||o.opts.position))return void(o.customHide=t({$datepicker:o.$datepicker,$target:o.$el,$pointer:o.$pointer,isViewChange:e,done:o._finishHide}));let i,s,{isMobile:a}=o.opts,n=o.$el.getBoundingClientRect(),r=o.$el.getBoundingClientRect(),l=o.$datepicker.offsetParent,c=o.$el.offsetParent,d=o.$datepicker.getBoundingClientRect(),h=t.split(" "),u=window.scrollY,f=window.scrollX,p=o.opts.offset,b=h[0],g=h[1];if(a)o.$datepicker.style.cssText="left: 50%; top: 50%";else{if(l===c&&l!==document.body&&(r={top:o.$el.offsetTop,left:o.$el.offsetLeft,width:n.width,height:o.$el.offsetHeight},u=0,f=0),l!==c&&l!==document.body){let t=l.getBoundingClientRect();r={top:n.top-t.top,left:n.left-t.left,width:n.width,height:n.height},u=0,f=0}switch(b){case"top":i=r.top-d.height-p;break;case"right":s=r.left+r.width+p;break;case"bottom":i=r.top+r.height+p;break;case"left":s=r.left-d.width-p}switch(g){case"top":i=r.top;break;case"right":s=r.left+r.width-d.width;break;case"bottom":i=r.top+r.height-d.height;break;case"left":s=r.left;break;case"center":/left|right/.test(b)?i=r.top+r.height/2-d.height/2:s=r.left+r.width/2-d.width/2}o.$datepicker.style.cssText=`left: ${s+f}px; top: ${i+u}px`}})),R(this,"_setInputValue",(()=>{let{opts:t,$altField:e,locale:{dateFormat:i}}=this,{altFieldDateFormat:s,altField:a}=t;a&&e&&(e.value=this._getInputValue(s)),this.$el.value=this._getInputValue(i)})),R(this,"_getInputValue",(t=>{let{selectedDates:e,opts:i}=this,{multipleDates:s,multipleDatesSeparator:a}=i;if(!e.length)return"";let n="function"==typeof t,o=n?t(s?e:e[0]):e.map((e=>this.formatDate(e,t)));return o=n?o:o.join(a),o})),R(this,"_checkIfDateIsSelected",(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.days,s=!1;return o.selectedDates.some((i=>{let a=f(t,i,e);return s=a&&i,a})),s})),R(this,"_scheduleCallAfterTransition",(t=>{this._cancelScheduledCall(),t&&t(!1),this._onTransitionEnd=()=>{t&&t(!0)},this.$datepicker.addEventListener("transitionend",this._onTransitionEnd,{once:!0})})),R(this,"_cancelScheduledCall",(()=>{this.$datepicker.removeEventListener("transitionend",this._onTransitionEnd)})),R(this,"setViewDate",(t=>{if(!((t=w(t))instanceof Date))return;if(f(t,this.viewDate))return;let e=this.viewDate;this.viewDate=t;let{onChangeViewDate:s}=this.opts;if(s){let{month:t,year:e}=this.parsedViewDate;s({month:t,year:e,decade:this.curDecade})}this.trigger(i.eventChangeViewDate,t,e)})),R(this,"setFocusDate",(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t||(t=w(t))instanceof Date)&&(o.focusDate=t,o.trigger(i.eventChangeFocusDate,t,e))})),R(this,"setCurrentView",(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o.viewIndexes.includes(t)){if(o.currentView=t,o.elIsInput&&o.visible&&o.setPosition(void 0,!0),o.trigger(i.eventChangeCurrentView,t),!o.views[t]){let e=o.views[t]=new E({dp:o,opts:o.opts,type:t});o.shouldUpdateDOM&&o.$content.appendChild(e.$el)}o.opts.onChangeView&&!e.silent&&o.opts.onChangeView(t)}})),R(this,"_updateLastSelectedDate",(t=>{this.lastSelectedDate=t,this.trigger(i.eventChangeLastSelectedDate,t)})),R(this,"destroy",(()=>{if(this.isDestroyed)return;let{showEvent:t,isMobile:e}=this.opts,i=this.$datepicker.parentNode;i&&i.removeChild(this.$datepicker),this.$el.removeEventListener(t,this._onFocus),this.$el.removeEventListener("blur",this._onBlur),window.removeEventListener("resize",this._onResize),e&&this._removeMobileAttributes(),this.keyboardNav&&this.keyboardNav.destroy(),this.views=null,this.nav=null,this.$datepicker=null,this.opts={},this.$customContainer=null,this.viewDate=null,this.focusDate=null,this.selectedDates=[],this.rangeDateFrom=null,this.rangeDateTo=null,this.isDestroyed=!0})),R(this,"update",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=k({},o.opts),{silent:a}=e;k(o.opts,t);let{timepicker:n,buttons:r,range:l,selectedDates:c,isMobile:d}=o.opts,h=o.visible||o.treatAsInline;o._createMinMaxDates(),o._limitViewDateByMaxMinDates(),o._handleLocale(),c&&(o.selectedDates=[],o.selectDate(c,{silent:a})),t.view&&o.setCurrentView(t.view,{silent:a}),o._setInputValue(),s.range&&!l?(o.rangeDateTo=!1,o.rangeDateFrom=!1):!s.range&&l&&o.selectedDates.length&&(o.rangeDateFrom=o.selectedDates[0],o.rangeDateTo=o.selectedDates[1]),s.timepicker&&!n?(h&&o.timepicker.destroy(),o.timepicker=!1,o.$timepicker.parentNode.removeChild(o.$timepicker)):!s.timepicker&&n&&o._addTimepicker(),!s.buttons&&r?o._addButtons():s.buttons&&!r?(o.buttons.destroy(),o.$buttons.parentNode.removeChild(o.$buttons)):h&&s.buttons&&r&&o.buttons.clearHtml().render(),!s.isMobile&&d?(o.treatAsInline||F||o._createMobileOverlay(),o._addMobileAttributes(),o.visible&&o._showMobileOverlay()):s.isMobile&&!d&&(o._removeMobileAttributes(),o.visible&&(F.classList.remove("-active-"),"function"!=typeof o.opts.position&&o.setPosition())),h&&(o.nav.update(),o.views[o.currentView].render(),o.currentView===i.days&&o.views[o.currentView].renderDayNames())})),R(this,"disableDate",((t,e)=>{(Array.isArray(t)?t:[t]).forEach((t=>{let i=w(t);if(!i)return;let s=e?"delete":"add";this.disabledDates[s](this.formatDate(i,"yyyy-MM-dd"));let a=this.getCell(i,this.currentViewSingular);a&&a.adpCell.render()}),[])})),R(this,"enableDate",(t=>{this.disableDate(t,!0)})),R(this,"isDateDisabled",(t=>{let e=w(t);return this.disabledDates.has(this.formatDate(e,"yyyy-MM-dd"))})),R(this,"isOtherMonth",(t=>{let{month:e}=l(t);return e!==this.parsedViewDate.month})),R(this,"isOtherYear",(t=>{let{year:e}=l(t);return e!==this.parsedViewDate.year})),R(this,"isOtherDecade",(t=>{let{year:e}=l(t),[i,s]=h(this.viewDate);return e<i||e>s})),R(this,"_onChangeSelectedDate",(t=>{let{silent:e}=t;setTimeout((()=>{this._setInputValue(),this.opts.onSelect&&!e&&this._triggerOnSelect()}))})),R(this,"_onChangeFocusedDate",(function(t){let{viewDateTransition:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return;let i=!1;e&&(i=o.isOtherMonth(t)||o.isOtherYear(t)||o.isOtherDecade(t)),i&&o.setViewDate(t),o.opts.onFocus&&o.opts.onFocus({datepicker:o,date:t})})),R(this,"_onChangeTime",(t=>{let{hours:e,minutes:i}=t,s=new Date,{lastSelectedDate:a,opts:{onSelect:n}}=this,o=a;a||(o=s);let r=this.getCell(o,this.currentViewSingular),l=r&&r.adpCell;l&&l.isDisabled||(o.setHours(e),o.setMinutes(i),a?(this._setInputValue(),n&&this._triggerOnSelect()):this.selectDate(o))})),R(this,"_onFocus",(t=>{this.visible||this.show()})),R(this,"_onBlur",(t=>{this.inFocus||!this.visible||this.opts.isMobile||this.hide()})),R(this,"_onMouseDown",(t=>{this.inFocus=!0})),R(this,"_onMouseUp",(t=>{this.inFocus=!1,this.$el.focus()})),R(this,"_onResize",(()=>{this.visible&&"function"!=typeof this.opts.position&&this.setPosition()})),R(this,"_onClickOverlay",(()=>{this.visible&&this.hide()})),R(this,"getViewDates",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.days;return E.getDatesFunction(t)(o)})),R(this,"isWeekend",(t=>this.opts.weekends.includes(t))),R(this,"getClampedDate",(t=>{let{minDate:e,maxDate:i}=this,s=t;return i&&p(t,i)?s=i:e&&b(t,e)&&(s=e),s})),this.$el=a(t),!this.$el)return;this.$datepicker=n({className:"air-datepicker"}),this.opts=k({},s,e),this.$customContainer=!!this.opts.container&&a(this.opts.container),this.$altField=a(this.opts.altField||!1);let{view:r,startDate:c}=this.opts;c||(this.opts.startDate=new Date),"INPUT"===this.$el.nodeName&&(this.elIsInput=!0),this.inited=!1,this.visible=!1,this.viewDate=w(this.opts.startDate),this.focusDate=!1,this.initialReadonly=this.$el.getAttribute("readonly"),this.customHide=!1,this.currentView=r,this.selectedDates=[],this.disabledDates=new Set,this.isDestroyed=!1,this.views={},this.keys=[],this.rangeDateFrom="",this.rangeDateTo="",this.timepickerIsActive=!1,this.treatAsInline=this.opts.inline||!this.elIsInput,this.init()}init(){let{opts:t,treatAsInline:e,opts:{inline:i,isMobile:s,selectedDates:n,keyboardNav:o,onlyTimepicker:r}}=this,l=a("body");(!L||L&&$&&!l.contains($))&&!i&&this.elIsInput&&!this.$customContainer&&P.buildGlobalContainer(P.defaultGlobalContainerId),!s||F||e||this._createMobileOverlay(),this._handleLocale(),this._bindSubEvents(),this._createMinMaxDates(),this._limitViewDateByMaxMinDates(),this.elIsInput&&(i||this._bindEvents(),o&&!r&&(this.keyboardNav=new z({dp:this,opts:t}))),n&&this.selectDate(n,{silent:!0}),this.opts.visible&&!e&&this.show(),s&&!e&&this.$el.setAttribute("readonly",!0),e&&this._createComponents()}_createMobileOverlay(){F=n({className:"air-datepicker-overlay"}),$.appendChild(F)}_createComponents(){let{opts:t,treatAsInline:e,opts:{inline:i,buttons:s,timepicker:a,position:n,classes:o,onlyTimepicker:r,isMobile:l}}=this;this._buildBaseHtml(),this.elIsInput&&(i||this._setPositionClasses(n)),!i&&this.elIsInput||this.$datepicker.classList.add("-inline-"),o&&this.$datepicker.classList.add(...o.split(" ")),r&&this.$datepicker.classList.add("-only-timepicker-"),l&&!e&&this._addMobileAttributes(),this.views[this.currentView]=new E({dp:this,type:this.currentView,opts:t}),this.nav=new A({dp:this,opts:t}),a&&this._addTimepicker(),s&&this._addButtons(),this.$content.appendChild(this.views[this.currentView].$el),this.$nav.appendChild(this.nav.$el)}_destroyComponents(){for(let t in this.views)this.views[t].destroy();this.views={},this.nav.destroy(),this.timepicker&&this.timepicker.destroy()}_addMobileAttributes(){F.addEventListener("click",this._onClickOverlay),this.$datepicker.classList.add("-is-mobile-"),this.$el.setAttribute("readonly",!0)}_removeMobileAttributes(){F.removeEventListener("click",this._onClickOverlay),this.$datepicker.classList.remove("-is-mobile-"),this.initialReadonly||""===this.initialReadonly||this.$el.removeAttribute("readonly")}_createMinMaxDates(){let{minDate:t,maxDate:e}=this.opts;this.minDate=!!t&&w(t),this.maxDate=!!e&&w(e)}_addTimepicker(){this.$timepicker=n({className:"air-datepicker--time"}),this.$datepicker.appendChild(this.$timepicker),this.timepicker=new I({dp:this,opts:this.opts}),this.$timepicker.appendChild(this.timepicker.$el)}_addButtons(){this.$buttons=n({className:"air-datepicker--buttons"}),this.$datepicker.appendChild(this.$buttons),this.buttons=new S({dp:this,opts:this.opts}),this.$buttons.appendChild(this.buttons.$el)}_bindSubEvents(){this.on(i.eventChangeSelectedDate,this._onChangeSelectedDate),this.on(i.eventChangeFocusDate,this._onChangeFocusedDate),this.on(i.eventChangeTime,this._onChangeTime)}_buildBaseHtml(){let{inline:t}=this.opts;var e,i;this.elIsInput?t?(e=this.$datepicker,(i=this.$el).parentNode.insertBefore(e,i.nextSibling)):this.$container.appendChild(this.$datepicker):this.$el.appendChild(this.$datepicker),this.$datepicker.innerHTML='<i class="air-datepicker--pointer"></i><div class="air-datepicker--navigation"></div><div class="air-datepicker--content"></div>',this.$content=a(".air-datepicker--content",this.$datepicker),this.$pointer=a(".air-datepicker--pointer",this.$datepicker),this.$nav=a(".air-datepicker--navigation",this.$datepicker)}_handleLocale(){let{locale:t,dateFormat:e,firstDay:i,timepicker:s,onlyTimepicker:a,timeFormat:n,dateTimeSeparator:o}=this.opts;var r;this.locale=(r=t,JSON.parse(JSON.stringify(r))),e&&(this.locale.dateFormat=e),void 0!==n&&""!==n&&(this.locale.timeFormat=n);let{timeFormat:l}=this.locale;if(""!==i&&(this.locale.firstDay=i),s&&"function"!=typeof e){let t=l?o:"";this.locale.dateFormat=[this.locale.dateFormat,l||""].join(t)}a&&"function"!=typeof e&&(this.locale.dateFormat=this.locale.timeFormat)}_setPositionClasses(t){if("function"==typeof t)return void this.$datepicker.classList.add("-custom-position-");let e=(t=t.split(" "))[0],i=`air-datepicker -${e}-${t[1]}- -from-${e}-`;this.$datepicker.classList.add(...i.split(" "))}_bindEvents(){this.$el.addEventListener(this.opts.showEvent,this._onFocus),this.$el.addEventListener("blur",this._onBlur),this.$datepicker.addEventListener("mousedown",this._onMouseDown),this.$datepicker.addEventListener("mouseup",this._onMouseUp),window.addEventListener("resize",this._onResize)}_limitViewDateByMaxMinDates(){let{viewDate:t,minDate:e,maxDate:i}=this;i&&p(t,i)&&this.setViewDate(i),e&&b(t,e)&&this.setViewDate(e)}formatDate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewDate,e=arguments.length>1?arguments[1]:void 0;if(t=w(t),!(t instanceof Date))return;let i=e,s=this.locale,a=l(t),n=a.dayPeriod,o=h(t),r=P.replacer,c={T:t.getTime(),m:a.minutes,mm:a.fullMinutes,h:a.hours12,hh:a.fullHours12,H:a.hours,HH:a.fullHours,aa:n,AA:n.toUpperCase(),E:s.daysShort[a.day],EEEE:s.days[a.day],d:a.date,dd:a.fullDate,M:a.month+1,MM:a.fullMonth,MMM:s.monthsShort[a.month],MMMM:s.months[a.month],yy:a.year.toString().slice(-2),yyyy:a.year,yyyy1:o[0],yyyy2:o[1]};for(let[t,e]of Object.entries(c))i=r(i,x(t),e);return i}down(t){this._handleUpDownActions(t,"down")}up(t){this._handleUpDownActions(t,"up")}selectDate(t){let e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{currentView:a,parsedViewDate:n,selectedDates:o}=this,{updateTime:r}=s,{moveToOtherMonthsOnSelect:l,moveToOtherYearsOnSelect:c,multipleDates:d,range:h,autoClose:u,onBeforeSelect:f}=this.opts,b=o.length;if(Array.isArray(t))return t.forEach((t=>{this.selectDate(t,s)})),new Promise((t=>{setTimeout(t)}));if((t=w(t))instanceof Date){if(f&&!f({date:t,datepicker:this}))return Promise.resolve();if(a===i.days&&t.getMonth()!==n.month&&l&&(e=new Date(t.getFullYear(),t.getMonth(),1)),a===i.years&&t.getFullYear()!==n.year&&c&&(e=new Date(t.getFullYear(),0,1)),e&&this.setViewDate(e),d&&!h){if(b===d)return;this._checkIfDateIsSelected(t)||o.push(t)}else if(h)switch(b){case 1:o.push(t),this.rangeDateTo||(this.rangeDateTo=t),p(this.rangeDateFrom,this.rangeDateTo)&&(this.rangeDateTo=this.rangeDateFrom,this.rangeDateFrom=t),this.selectedDates=[this.rangeDateFrom,this.rangeDateTo];break;case 2:this.selectedDates=[t],this.rangeDateFrom=t,this.rangeDateTo="";break;default:this.selectedDates=[t],this.rangeDateFrom=t}else this.selectedDates=[t];return this.trigger(i.eventChangeSelectedDate,{action:i.actionSelectDate,silent:null==s?void 0:s.silent,date:t,updateTime:r}),this._updateLastSelectedDate(t),u&&!this.timepickerIsActive&&this.visible&&(d||h?h&&1===b&&this.hide():this.hide()),new Promise((t=>{setTimeout(t)}))}}unselectDate(t){let e=this.selectedDates,s=this;if((t=w(t))instanceof Date)return e.some(((a,n)=>{if(f(a,t))return e.splice(n,1),s.selectedDates.length?(s.rangeDateTo="",s.rangeDateFrom=e[0],s._updateLastSelectedDate(s.selectedDates[s.selectedDates.length-1])):(s.rangeDateFrom="",s.rangeDateTo="",s._updateLastSelectedDate(!1)),this.trigger(i.eventChangeSelectedDate,{action:i.actionUnselectDate,date:t}),!0}))}replaceDate(t,e){let s=this.selectedDates.find((e=>f(e,t,this.currentView))),a=this.selectedDates.indexOf(s);a<0||f(this.selectedDates[a],e,this.currentView)||(this.selectedDates[a]=e,this.trigger(i.eventChangeSelectedDate,{action:i.actionSelectDate,date:e,updateTime:!0}),this._updateLastSelectedDate(e))}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.selectedDates=[],this.rangeDateFrom=!1,this.rangeDateTo=!1,this.lastSelectedDate=!1,this.trigger(i.eventChangeSelectedDate,{action:i.actionUnselectDate,silent:t.silent}),new Promise((t=>{setTimeout(t)}))}show(){let{onShow:t,isMobile:e}=this.opts;this._cancelScheduledCall(),this.visible||this.hideAnimation||this._createComponents(),this.setPosition(this.opts.position),this.$datepicker.classList.add("-active-"),this.visible=!0,t&&this._scheduleCallAfterTransition(t),e&&this._showMobileOverlay()}hide(){let{onHide:t,isMobile:e}=this.opts,i=this._hasTransition();this.visible=!1,this.hideAnimation=!0,this.$datepicker.classList.remove("-active-"),this.customHide&&this.customHide(),this.elIsInput&&this.$el.blur(),this._scheduleCallAfterTransition((e=>{!this.customHide&&(e&&i||!e&&!i)&&this._finishHide(),t&&t(e)})),e&&F.classList.remove("-active-")}_triggerOnSelect(){let t=[],e=[],{selectedDates:i,locale:s,opts:{onSelect:a,multipleDates:n,range:o}}=this,r=n||o,l="function"==typeof s.dateFormat;i.length&&(t=i.map(g),e=l?n?s.dateFormat(t):t.map((t=>s.dateFormat(t))):t.map((t=>this.formatDate(t,s.dateFormat)))),a({date:r?t:t[0],formattedDate:r?e:e[0],datepicker:this})}_handleAlreadySelectedDates(t,e){let{selectedDates:i,rangeDateFrom:s,rangeDateTo:a}=this,{range:n,toggleSelected:o}=this.opts,r=i.length,l="function"==typeof o?o({datepicker:this,date:e}):o,c=Boolean(n&&1===r&&t),d=c?g(e):e;n&&!l&&(2!==r&&this.selectDate(d),2===r&&f(s,a))||(l?this.unselectDate(d):this._updateLastSelectedDate(c?d:t))}_handleUpDownActions(t,e){if(!((t=w(t||this.focusDate||this.viewDate))instanceof Date))return;let i="up"===e?this.viewIndex+1:this.viewIndex-1;i>2&&(i=2),i<0&&(i=0),this.setViewDate(new Date(t.getFullYear(),t.getMonth(),1)),this.setCurrentView(this.viewIndexes[i])}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.day;if(!((t=w(t))instanceof Date))return;let{year:s,month:a,date:n}=l(t),o=`[data-year="${s}"]`,r=`[data-month="${a}"]`,c={[i.day]:`${o}${r}[data-date="${n}"]`,[i.month]:`${o}${r}`,[i.year]:`${o}`};return this.views[this.currentView]?this.views[this.currentView].$el.querySelector(c[e]):void 0}_showMobileOverlay(){F.classList.add("-active-")}_hasTransition(){return window.getComputedStyle(this.$datepicker).getPropertyValue("transition-duration").split(", ").reduce(((t,e)=>parseFloat(e)+t),0)>0}get shouldUpdateDOM(){return this.visible||this.treatAsInline}get parsedViewDate(){return l(this.viewDate)}get currentViewSingular(){return this.currentView.slice(0,-1)}get curDecade(){return h(this.viewDate)}get viewIndex(){return this.viewIndexes.indexOf(this.currentView)}get isFinalView(){return this.currentView===i.years}get hasSelectedDates(){return this.selectedDates.length>0}get isMinViewReached(){return this.currentView===this.opts.minView||this.currentView===i.days}get $container(){return this.$customContainer||$}static replacer(t,e,i){return t.replace(e,(function(t,e,s,a){return e+i+a}))}}var H;return R(P,"defaults",s),R(P,"version","3.5.3"),R(P,"defaultGlobalContainerId","air-datepicker-global-container"),H=P.prototype,Object.assign(H,N),e.default}()}))})(gr);const mr=gr.exports;var vr={};Object.defineProperty(vr,"__esModule",{value:true});var yr=vr.default=void 0;var kr={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",dateFormat:"MM/dd/yyyy",timeFormat:"hh:mm aa",firstDay:0};yr=vr.default=kr;const wr='.air-datepicker-cell.-year-.-other-decade-,.air-datepicker-cell.-day-.-other-month-{color:var(--adp-color-other-month)}.air-datepicker-cell.-year-.-other-decade-:hover,.air-datepicker-cell.-day-.-other-month-:hover{color:var(--adp-color-other-month-hover)}.-disabled-.-focus-.air-datepicker-cell.-year-.-other-decade-,.-disabled-.-focus-.air-datepicker-cell.-day-.-other-month-{color:var(--adp-color-other-month)}.-selected-.air-datepicker-cell.-year-.-other-decade-,.-selected-.air-datepicker-cell.-day-.-other-month-{color:#fff;background:var(--adp-background-color-selected-other-month)}.-selected-.-focus-.air-datepicker-cell.-year-.-other-decade-,.-selected-.-focus-.air-datepicker-cell.-day-.-other-month-{background:var(--adp-background-color-selected-other-month-focused)}.-in-range-.air-datepicker-cell.-year-.-other-decade-,.-in-range-.air-datepicker-cell.-day-.-other-month-{background-color:var(--adp-background-color-in-range);color:var(--adp-color)}.-in-range-.-focus-.air-datepicker-cell.-year-.-other-decade-,.-in-range-.-focus-.air-datepicker-cell.-day-.-other-month-{background-color:var(--adp-background-color-in-range-focused)}.air-datepicker-cell.-year-.-other-decade-:empty,.air-datepicker-cell.-day-.-other-month-:empty{background:none;border:none}.air-datepicker-cell{border-radius:var(--adp-cell-border-radius);box-sizing:border-box;cursor:pointer;display:flex;position:relative;align-items:center;justify-content:center;z-index:1}.air-datepicker-cell.-focus-{background:var(--adp-cell-background-color-hover)}.air-datepicker-cell.-current-{color:var(--adp-color-current-date)}.air-datepicker-cell.-current-.-focus-{color:var(--adp-color)}.air-datepicker-cell.-current-.-in-range-{color:var(--adp-color-current-date)}.air-datepicker-cell.-disabled-{cursor:default;color:var(--adp-color-disabled)}.air-datepicker-cell.-disabled-.-focus-{color:var(--adp-color-disabled)}.air-datepicker-cell.-disabled-.-in-range-{color:var(--adp-color-disabled-in-range)}.air-datepicker-cell.-disabled-.-current-.-focus-{color:var(--adp-color-disabled)}.air-datepicker-cell.-in-range-{background:var(--adp-cell-background-color-in-range);border-radius:0}.air-datepicker-cell.-in-range-:hover,.air-datepicker-cell.-in-range-.-focus-{background:var(--adp-cell-background-color-in-range-hover)}.air-datepicker-cell.-range-from-{border:1px solid var(--adp-cell-border-color-in-range);background-color:var(--adp-cell-background-color-in-range);border-radius:var(--adp-cell-border-radius) 0 0 var(--adp-cell-border-radius)}.air-datepicker-cell.-range-to-{border:1px solid var(--adp-cell-border-color-in-range);background-color:var(--adp-cell-background-color-in-range);border-radius:0 var(--adp-cell-border-radius) var(--adp-cell-border-radius) 0}.air-datepicker-cell.-range-to-.-range-from-{border-radius:var(--adp-cell-border-radius)}.air-datepicker-cell.-selected-{color:#fff;border:none;background:var(--adp-cell-background-color-selected)}.air-datepicker-cell.-selected-.-current-{color:#fff;background:var(--adp-cell-background-color-selected)}.air-datepicker-cell.-selected-.-focus-{background:var(--adp-cell-background-color-selected-hover)}.air-datepicker-body{transition:all var(--adp-transition-duration) var(--adp-transition-ease)}.air-datepicker-body.-hidden-{display:none}.air-datepicker-body--day-names{display:grid;grid-template-columns:repeat(7, var(--adp-day-cell-width));margin:8px 0 3px}.air-datepicker-body--day-name{color:var(--adp-day-name-color);display:flex;align-items:center;justify-content:center;flex:1;text-align:center;text-transform:uppercase;font-size:.8em}.air-datepicker-body--day-name.-clickable-{cursor:pointer}.air-datepicker-body--day-name.-clickable-:hover{color:var(--adp-day-name-color-hover)}.air-datepicker-body--cells{display:grid}.air-datepicker-body--cells.-days-{grid-template-columns:repeat(7, var(--adp-day-cell-width));grid-auto-rows:var(--adp-day-cell-height)}.air-datepicker-body--cells.-months-{grid-template-columns:repeat(3, 1fr);grid-auto-rows:var(--adp-month-cell-height)}.air-datepicker-body--cells.-years-{grid-template-columns:repeat(4, 1fr);grid-auto-rows:var(--adp-year-cell-height)}.air-datepicker-nav{display:flex;justify-content:space-between;border-bottom:1px solid var(--adp-border-color-inner);min-height:var(--adp-nav-height);padding:var(--adp-padding);box-sizing:content-box}.-only-timepicker- .air-datepicker-nav{display:none}.air-datepicker-nav--title,.air-datepicker-nav--action{display:flex;cursor:pointer;align-items:center;justify-content:center}.air-datepicker-nav--action{width:var(--adp-nav-action-size);border-radius:var(--adp-border-radius);-webkit-user-select:none;-moz-user-select:none;user-select:none}.air-datepicker-nav--action:hover{background:var(--adp-background-color-hover)}.air-datepicker-nav--action:active{background:var(--adp-background-color-active)}.air-datepicker-nav--action.-disabled-{visibility:hidden}.air-datepicker-nav--action svg{width:32px;height:32px}.air-datepicker-nav--action path{fill:none;stroke:var(--adp-nav-arrow-color);stroke-width:2px}.air-datepicker-nav--title{border-radius:var(--adp-border-radius);padding:0 8px}.air-datepicker-nav--title i{font-style:normal;color:var(--adp-nav-color-secondary);margin-left:.3em}.air-datepicker-nav--title:hover{background:var(--adp-background-color-hover)}.air-datepicker-nav--title:active{background:var(--adp-background-color-active)}.air-datepicker-nav--title.-disabled-{cursor:default;background:none}.air-datepicker-buttons{display:grid;grid-auto-columns:1fr;grid-auto-flow:column}.air-datepicker-button{display:inline-flex;color:var(--adp-btn-color);border-radius:var(--adp-btn-border-radius);cursor:pointer;height:var(--adp-btn-height);border:none;background:rgba(255,255,255,0)}.air-datepicker-button:hover{color:var(--adp-btn-color-hover);background:var(--adp-btn-background-color-hover)}.air-datepicker-button:focus{color:var(--adp-btn-color-hover);background:var(--adp-btn-background-color-hover);outline:none}.air-datepicker-button:active{background:var(--adp-btn-background-color-active)}.air-datepicker-button span{outline:none;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.air-datepicker-time{display:grid;grid-template-columns:max-content 1fr;grid-column-gap:12px;align-items:center;position:relative;padding:0 var(--adp-time-padding-inner)}.-only-timepicker- .air-datepicker-time{border-top:none}.air-datepicker-time--current{display:flex;align-items:center;flex:1;font-size:14px;text-align:center}.air-datepicker-time--current-colon{margin:0 2px 3px;line-height:1}.air-datepicker-time--current-hours,.air-datepicker-time--current-minutes{line-height:1;font-size:19px;font-family:"Century Gothic",CenturyGothic,AppleGothic,sans-serif;position:relative;z-index:1}.air-datepicker-time--current-hours:after,.air-datepicker-time--current-minutes:after{content:"";background:var(--adp-background-color-hover);border-radius:var(--adp-border-radius);position:absolute;left:-2px;top:-3px;right:-2px;bottom:-2px;z-index:-1;opacity:0}.air-datepicker-time--current-hours.-focus-:after,.air-datepicker-time--current-minutes.-focus-:after{opacity:1}.air-datepicker-time--current-ampm{text-transform:uppercase;align-self:flex-end;color:var(--adp-time-day-period-color);margin-left:6px;font-size:11px;margin-bottom:1px}.air-datepicker-time--row{display:flex;align-items:center;font-size:11px;height:17px;background:linear-gradient(to right, var(--adp-time-track-color), var(--adp-time-track-color)) left 50%/100% var(--adp-time-track-height) no-repeat}.air-datepicker-time--row:first-child{margin-bottom:4px}.air-datepicker-time--row input[type=range]{background:none;cursor:pointer;flex:1;height:100%;width:100%;padding:0;margin:0;-webkit-appearance:none}.air-datepicker-time--row input[type=range]::-webkit-slider-thumb{-webkit-appearance:none}.air-datepicker-time--row input[type=range]::-ms-tooltip{display:none}.air-datepicker-time--row input[type=range]:hover::-webkit-slider-thumb{border-color:var(--adp-time-track-color-hover)}.air-datepicker-time--row input[type=range]:hover::-moz-range-thumb{border-color:var(--adp-time-track-color-hover)}.air-datepicker-time--row input[type=range]:hover::-ms-thumb{border-color:var(--adp-time-track-color-hover)}.air-datepicker-time--row input[type=range]:focus{outline:none}.air-datepicker-time--row input[type=range]:focus::-webkit-slider-thumb{background:var(--adp-cell-background-color-selected);border-color:var(--adp-cell-background-color-selected)}.air-datepicker-time--row input[type=range]:focus::-moz-range-thumb{background:var(--adp-cell-background-color-selected);border-color:var(--adp-cell-background-color-selected)}.air-datepicker-time--row input[type=range]:focus::-ms-thumb{background:var(--adp-cell-background-color-selected);border-color:var(--adp-cell-background-color-selected)}.air-datepicker-time--row input[type=range]::-webkit-slider-thumb{box-sizing:border-box;height:12px;width:12px;border-radius:3px;border:1px solid var(--adp-time-track-color);background:#fff;cursor:pointer;-webkit-transition:background var(--adp-transition-duration);transition:background var(--adp-transition-duration)}.air-datepicker-time--row input[type=range]::-moz-range-thumb{box-sizing:border-box;height:12px;width:12px;border-radius:3px;border:1px solid var(--adp-time-track-color);background:#fff;cursor:pointer;-moz-transition:background var(--adp-transition-duration);transition:background var(--adp-transition-duration)}.air-datepicker-time--row input[type=range]::-ms-thumb{box-sizing:border-box;height:12px;width:12px;border-radius:3px;border:1px solid var(--adp-time-track-color);background:#fff;cursor:pointer;-ms-transition:background var(--adp-transition-duration);transition:background var(--adp-transition-duration)}.air-datepicker-time--row input[type=range]::-webkit-slider-thumb{margin-top:calc(var(--adp-time-thumb-size)/2*-1)}.air-datepicker-time--row input[type=range]::-webkit-slider-runnable-track{border:none;height:var(--adp-time-track-height);cursor:pointer;color:rgba(0,0,0,0);background:rgba(0,0,0,0)}.air-datepicker-time--row input[type=range]::-moz-range-track{border:none;height:var(--adp-time-track-height);cursor:pointer;color:rgba(0,0,0,0);background:rgba(0,0,0,0)}.air-datepicker-time--row input[type=range]::-ms-track{border:none;height:var(--adp-time-track-height);cursor:pointer;color:rgba(0,0,0,0);background:rgba(0,0,0,0)}.air-datepicker-time--row input[type=range]::-ms-fill-lower{background:rgba(0,0,0,0)}.air-datepicker-time--row input[type=range]::-ms-fill-upper{background:rgba(0,0,0,0)}.air-datepicker{--adp-font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--adp-font-size:14px;--adp-width:246px;--adp-z-index:100;--adp-padding:4px;--adp-grid-areas:"nav" "body" "timepicker" "buttons";--adp-transition-duration:.3s;--adp-transition-ease:ease-out;--adp-transition-offset:8px;--adp-background-color:#fff;--adp-background-color-hover:#f0f0f0;--adp-background-color-active:#eaeaea;--adp-background-color-in-range:rgba(92, 196, 239, .1);--adp-background-color-in-range-focused:rgba(92, 196, 239, .2);--adp-background-color-selected-other-month-focused:#8ad5f4;--adp-background-color-selected-other-month:#a2ddf6;--adp-color:#4a4a4a;--adp-color-secondary:#9c9c9c;--adp-accent-color:#4eb5e6;--adp-color-current-date:var(--adp-accent-color);--adp-color-other-month:#dedede;--adp-color-disabled:#aeaeae;--adp-color-disabled-in-range:#939393;--adp-color-other-month-hover:#c5c5c5;--adp-border-color:#dbdbdb;--adp-border-color-inner:#efefef;--adp-border-radius:4px;--adp-border-color-inline:#d7d7d7;--adp-nav-height:32px;--adp-nav-arrow-color:var(--adp-color-secondary);--adp-nav-action-size:32px;--adp-nav-color-secondary:var(--adp-color-secondary);--adp-day-name-color:#ff9a19;--adp-day-name-color-hover:#8ad5f4;--adp-day-cell-width:1fr;--adp-day-cell-height:32px;--adp-month-cell-height:42px;--adp-year-cell-height:56px;--adp-pointer-size:10px;--adp-poiner-border-radius:2px;--adp-pointer-offset:14px;--adp-cell-border-radius:4px;--adp-cell-background-color-hover:var(--adp-background-color-hover);--adp-cell-background-color-selected:#5cc4ef;--adp-cell-background-color-selected-hover:#45bced;--adp-cell-background-color-in-range:rgba(92, 196, 239, 0.1);--adp-cell-background-color-in-range-hover:rgba(92, 196, 239, 0.2);--adp-cell-border-color-in-range:var(--adp-cell-background-color-selected);--adp-btn-height:32px;--adp-btn-color:var(--adp-accent-color);--adp-btn-color-hover:var(--adp-color);--adp-btn-border-radius:var(--adp-border-radius);--adp-btn-background-color-hover:var(--adp-background-color-hover);--adp-btn-background-color-active:var(--adp-background-color-active);--adp-time-track-height:1px;--adp-time-track-color:#dedede;--adp-time-track-color-hover:#b1b1b1;--adp-time-thumb-size:12px;--adp-time-padding-inner:10px;--adp-time-day-period-color:var(--adp-color-secondary);--adp-mobile-font-size:16px;--adp-mobile-nav-height:40px;--adp-mobile-width:320px;--adp-mobile-day-cell-height:38px;--adp-mobile-month-cell-height:48px;--adp-mobile-year-cell-height:64px}.air-datepicker-overlay{--adp-overlay-background-color:rgba(0, 0, 0, .3);--adp-overlay-transition-duration:.3s;--adp-overlay-transition-ease:ease-out;--adp-overlay-z-index:99}.air-datepicker{background:var(--adp-background-color);border:1px solid var(--adp-border-color);box-shadow:0 4px 12px rgba(0,0,0,.15);border-radius:var(--adp-border-radius);box-sizing:content-box;display:grid;grid-template-columns:1fr;grid-template-rows:repeat(4, max-content);grid-template-areas:var(--adp-grid-areas);font-family:var(--adp-font-family),sans-serif;font-size:var(--adp-font-size);color:var(--adp-color);width:var(--adp-width);position:absolute;transition:opacity var(--adp-transition-duration) var(--adp-transition-ease),transform var(--adp-transition-duration) var(--adp-transition-ease);z-index:var(--adp-z-index)}.air-datepicker:not(.-custom-position-){opacity:0}.air-datepicker.-from-top-{transform:translateY(calc(var(--adp-transition-offset) * -1))}.air-datepicker.-from-right-{transform:translateX(var(--adp-transition-offset))}.air-datepicker.-from-bottom-{transform:translateY(var(--adp-transition-offset))}.air-datepicker.-from-left-{transform:translateX(calc(var(--adp-transition-offset) * -1))}.air-datepicker.-active-:not(.-custom-position-){transform:translate(0, 0);opacity:1}.air-datepicker.-active-.-custom-position-{transition:none}.air-datepicker.-inline-{border-color:var(--adp-border-color-inline);box-shadow:none;position:static;left:auto;right:auto;opacity:1;transform:none}.air-datepicker.-inline- .air-datepicker--pointer{display:none}.air-datepicker.-is-mobile-{--adp-font-size:var(--adp-mobile-font-size);--adp-day-cell-height:var(--adp-mobile-day-cell-height);--adp-month-cell-height:var(--adp-mobile-month-cell-height);--adp-year-cell-height:var(--adp-mobile-year-cell-height);--adp-nav-height:var(--adp-mobile-nav-height);--adp-nav-action-size:var(--adp-mobile-nav-height);position:fixed;width:var(--adp-mobile-width);border:none}.air-datepicker.-is-mobile- *{-webkit-tap-highlight-color:rgba(0,0,0,0)}.air-datepicker.-is-mobile- .air-datepicker--pointer{display:none}.air-datepicker.-is-mobile-:not(.-custom-position-){transform:translate(-50%, calc(-50% + var(--adp-transition-offset)))}.air-datepicker.-is-mobile-.-active-:not(.-custom-position-){transform:translate(-50%, -50%)}.air-datepicker.-custom-position-{transition:none}.air-datepicker-global-container{position:absolute;left:0;top:0}.air-datepicker--pointer{--pointer-half-size:calc(var(--adp-pointer-size) / 2);position:absolute;width:var(--adp-pointer-size);height:var(--adp-pointer-size);z-index:-1}.air-datepicker--pointer:after{content:"";position:absolute;background:#fff;border-top:1px solid var(--adp-border-color-inline);border-right:1px solid var(--adp-border-color-inline);border-top-right-radius:var(--adp-poiner-border-radius);width:var(--adp-pointer-size);height:var(--adp-pointer-size);box-sizing:border-box}.-top-left- .air-datepicker--pointer,.-top-center- .air-datepicker--pointer,.-top-right- .air-datepicker--pointer,[data-popper-placement^=top] .air-datepicker--pointer{top:calc(100% - var(--pointer-half-size) + 1px)}.-top-left- .air-datepicker--pointer:after,.-top-center- .air-datepicker--pointer:after,.-top-right- .air-datepicker--pointer:after,[data-popper-placement^=top] .air-datepicker--pointer:after{transform:rotate(135deg)}.-right-top- .air-datepicker--pointer,.-right-center- .air-datepicker--pointer,.-right-bottom- .air-datepicker--pointer,[data-popper-placement^=right] .air-datepicker--pointer{right:calc(100% - var(--pointer-half-size) + 1px)}.-right-top- .air-datepicker--pointer:after,.-right-center- .air-datepicker--pointer:after,.-right-bottom- .air-datepicker--pointer:after,[data-popper-placement^=right] .air-datepicker--pointer:after{transform:rotate(225deg)}.-bottom-left- .air-datepicker--pointer,.-bottom-center- .air-datepicker--pointer,.-bottom-right- .air-datepicker--pointer,[data-popper-placement^=bottom] .air-datepicker--pointer{bottom:calc(100% - var(--pointer-half-size) + 1px)}.-bottom-left- .air-datepicker--pointer:after,.-bottom-center- .air-datepicker--pointer:after,.-bottom-right- .air-datepicker--pointer:after,[data-popper-placement^=bottom] .air-datepicker--pointer:after{transform:rotate(315deg)}.-left-top- .air-datepicker--pointer,.-left-center- .air-datepicker--pointer,.-left-bottom- .air-datepicker--pointer,[data-popper-placement^=left] .air-datepicker--pointer{left:calc(100% - var(--pointer-half-size) + 1px)}.-left-top- .air-datepicker--pointer:after,.-left-center- .air-datepicker--pointer:after,.-left-bottom- .air-datepicker--pointer:after,[data-popper-placement^=left] .air-datepicker--pointer:after{transform:rotate(45deg)}.-top-left- .air-datepicker--pointer,.-bottom-left- .air-datepicker--pointer{left:var(--adp-pointer-offset)}.-top-right- .air-datepicker--pointer,.-bottom-right- .air-datepicker--pointer{right:var(--adp-pointer-offset)}.-top-center- .air-datepicker--pointer,.-bottom-center- .air-datepicker--pointer{left:calc(50% - var(--adp-pointer-size)/2)}.-left-top- .air-datepicker--pointer,.-right-top- .air-datepicker--pointer{top:var(--adp-pointer-offset)}.-left-bottom- .air-datepicker--pointer,.-right-bottom- .air-datepicker--pointer{bottom:var(--adp-pointer-offset)}.-left-center- .air-datepicker--pointer,.-right-center- .air-datepicker--pointer{top:calc(50% - var(--adp-pointer-size)/2)}.air-datepicker--navigation{grid-area:nav}.air-datepicker--content{box-sizing:content-box;padding:var(--adp-padding);grid-area:body}.-only-timepicker- .air-datepicker--content{display:none}.air-datepicker--time{grid-area:timepicker}.air-datepicker--buttons{grid-area:buttons}.air-datepicker--buttons,.air-datepicker--time{padding:var(--adp-padding);border-top:1px solid var(--adp-border-color-inner)}.air-datepicker-overlay{position:fixed;background:var(--adp-overlay-background-color);left:0;top:0;width:0;height:0;opacity:0;transition:opacity var(--adp-overlay-transition-duration) var(--adp-overlay-transition-ease),left 0s,height 0s,width 0s;transition-delay:0s,var(--adp-overlay-transition-duration),var(--adp-overlay-transition-duration),var(--adp-overlay-transition-duration);z-index:var(--adp-overlay-z-index)}.air-datepicker-overlay.-active-{opacity:1;width:100%;height:100%;transition:opacity var(--adp-overlay-transition-duration) var(--adp-overlay-transition-ease),height 0s,width 0s}:host{display:block}.air-datepicker{font-size:auto}.air-datepicker-body--day-name{color:#000;font-weight:700}.air-datepicker-cell.-selected-,.air-datepicker-cell.-selected-.-focus-,.air-datepicker-cell.-selected-.-current-{background:#1e9ff2}.air-datepicker-cell.-disabled-{text-decoration:line-through}.air-datepicker-cell.-current-{color:#1e9ff2}.ir-date-picker-trigger{position:relative;box-sizing:border-box;width:fit-content;height:fit-content}.ir-date-picker-element{position:absolute;inset:0;opacity:0;cursor:pointer}';const xr=wr;const _r=class{constructor(e){t(this,e);this.dateChanged=s(this,"dateChanged",7);this.datePickerFocus=s(this,"datePickerFocus",7);this.datePickerBlur=s(this,"datePickerBlur",7);this.inline=false;this.date=null;this.multipleDates=false;this.range=false;this.dateFormat="yyyy-MM-dd";this.timepicker=false;this.disabled=false;this.autoClose=true;this.showOtherMonths=true;this.selectOtherMonths=true;this.customPicker=true;this.forceDestroyOnUpdate=false;this.emitEmptyDate=false;this.triggerContainerStyle="";this.currentDate=null;this.triggerSlot=null}componentWillLoad(){if(this.date){this.currentDate=this.toValidDate(this.date)}}componentDidLoad(){this.initializeDatepicker();this.setupTriggerFocusHandling()}setupTriggerFocusHandling(){if(!this.customPicker)return;const t=this.el.querySelector('[slot="trigger"]');if(!t)return;this.triggerSlot=t;this.triggerSlot.addEventListener("focus",this.handleTriggerFocus.bind(this));this.triggerSlot.addEventListener("click",this.handleTriggerClick.bind(this))}handleTriggerFocus(){if(this.disabled)return;this.openDatePicker()}handleTriggerClick(t){if(this.disabled)return;t.preventDefault();this.openDatePicker()}datePropChanged(t,e){if(this.isSameDates(t,e)){return}this.updatePickerDate(t)}minDatePropChanged(t,e){var i;if(!this.datePicker){return}if(!this.isSameDates(t,e)){(i=this.datePicker)===null||i===void 0?void 0:i.update({minDate:this.toValidDate(t)})}}maxDatePropChanged(t,e){var i;if(!this.isSameDates(t,e)){(i=this.datePicker)===null||i===void 0?void 0:i.update({maxDate:this.toValidDate(t)})}}async openDatePicker(){this.openDatePickerTimeout=setTimeout((()=>{this.pickerRef.focus()}),20)}async clearDatePicker(){var t;(t=this.datePicker)===null||t===void 0?void 0:t.clear()}isSameDates(t,e){if(!t&&!e)return true;if(!t||!e)return false;return D(t).isSame(D(e),"day")}toValidDate(t){if(!t)return null;const e=new Date(t);return isNaN(e.getTime())?null:e}updatePickerDate(t){var e,i;const s=this.toValidDate(t);if(!s){(e=this.datePicker)===null||e===void 0?void 0:e.clear();this.currentDate=null;return}if(!this.isSameDates(this.currentDate,s)){this.currentDate=s;if(this.forceDestroyOnUpdate){this.datePicker.destroy();this.datePicker=null;this.initializeDatepicker()}else{(i=this.datePicker)===null||i===void 0?void 0:i.selectDate(s)}}}initializeDatepicker(){if(this.datePicker)return;this.datePicker=new mr(this.pickerRef,{container:this.container,inline:this.inline,selectedDates:this.date?[this.date]:[],multipleDates:this.multipleDates,range:this.range,dateFormat:this.dateFormat,timepicker:this.timepicker,minDate:this.minDate,maxDate:this.maxDate,autoClose:this.autoClose,locale:yr,showOtherMonths:this.showOtherMonths,selectOtherMonths:this.selectOtherMonths,onHide:()=>{this.datePickerBlur.emit()},onShow:()=>{this.datePickerFocus.emit()},onSelect:({date:t})=>{if(!t||!(t instanceof Date)){if(this.emitEmptyDate){this.dateChanged.emit({start:null,end:null})}return}this.currentDate=t;this.date=t;this.dateChanged.emit({start:D(t),end:D(t)})},position({$datepicker:t,$target:e,$pointer:i,done:s}){let a=br(e,t,{placement:"top",modifiers:[{name:"flip",options:{padding:{top:0}}},{name:"offset",options:{offset:[0,10]}},{name:"arrow",options:{element:i}}]});return function t(){a.destroy();s()}}})}disconnectedCallback(){var t,e;if(this.openDatePickerTimeout){clearTimeout(this.openDatePickerTimeout)}if(this.triggerSlot){this.triggerSlot.removeEventListener("focus",this.handleTriggerFocus);this.triggerSlot.removeEventListener("click",this.handleTriggerClick)}(e=(t=this.datePicker)===null||t===void 0?void 0:t.destroy)===null||e===void 0?void 0:e.call(t)}render(){return e("div",{key:"edbf018b040fe1916cf16bc283341ab49e5014c1",class:`ir-date-picker-trigger ${this.triggerContainerStyle}`},this.customPicker&&e("slot",{key:"6f25b57f8414a8a5becfe5160ec50a0060110113",name:"trigger"}),e("input",{key:"ae0a87b9b4e08948ce67f7f82c06e3f451f13351",type:"text",disabled:this.disabled,class:this.customPicker?"ir-date-picker-element":"form-control input-sm",ref:t=>this.pickerRef=t}))}get el(){return n(this)}static get watchers(){return{date:["datePropChanged"],minDate:["minDatePropChanged"],maxDate:["maxDatePropChanged"]}}};_r.style=xr;const Dr=".sc-ir-date-range-h{display:block;width:100%}.date-range-input.sc-ir-date-range{width:100%}";const Cr=Dr;const Or=class{constructor(e){t(this,e);this.dateChanged=s(this,"dateChanged",7);this.firstDay=1;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.daysOfWeek=["Su","Mo","Tu","We","Th","Fr","Sa"];this.format="MMM DD, YYYY";this.separator=" - ";this.applyLabel="Apply";this.cancelLabel="Cancel";this.fromLabel="Form";this.toLabel="To";this.customRangeLabel="Custom";this.weekLabel="W";this.disabled=false;this.singleDatePicker=false;this.maxSpan={days:240}}componentWillLoad(){if(!document.getElementById("ir-daterangepicker-style")){const t=document.createElement("style");t.id="ir-daterangepicker-style";t.textContent=`\n        .daterangepicker {\n          margin-top: 14px;\n        }\n      `;document.head.appendChild(t)}}componentDidLoad(){this.dateRangeInput=this.element.querySelector(".date-range-input");this.initializeDateRangePicker();this.updateDateRangePickerDates()}disconnectedCallback(){if(this.openDatePickerTimeout){clearTimeout(this.openDatePickerTimeout)}$(this.dateRangeInput).data("daterangepicker").remove()}handleMinDateChange(){$(this.dateRangeInput).data("daterangepicker").remove();this.initializeDateRangePicker()}datePropChanged(){this.updateDateRangePickerDates()}async openDatePicker(){this.openDatePickerTimeout=setTimeout((()=>{this.dateRangeInput.click()}),20)}updateDateRangePickerDates(){const t=$(this.dateRangeInput).data("daterangepicker");if(!t){console.error("Date range picker not initialized.");return}if(this.singleDatePicker){const e=this.date?D(this.date):D();t.setStartDate(e);t.setEndDate(e)}else{const e=this.fromDate?D(this.fromDate):D();const i=this.toDate?D(this.toDate):e.clone().add(1,"days");t.setStartDate(e);t.setEndDate(i)}}initializeDateRangePicker(){$(this.dateRangeInput).daterangepicker({singleDatePicker:this.singleDatePicker,opens:this.opens,startDate:D(this.fromDate),endDate:D(this.toDate),minDate:D(this.minDate||D(new Date).format("YYYY-MM-DD")),maxDate:this.maxDate?D(this.maxDate):undefined,maxSpan:this.maxSpan,autoApply:this.autoApply,locale:{format:this.format,separator:this.separator,applyLabel:this.applyLabel,cancelLabel:this.cancelLabel,fromLabel:this.fromLabel,toLabel:this.toLabel,customRangeLabel:this.customRangeLabel,weekLabel:this.weekLabel,daysOfWeek:this.daysOfWeek,monthNames:this.monthNames,firstDay:this.firstDay}},((t,e)=>{this.dateChanged.emit({start:t,end:e})}))}render(){return e(i,{key:"ffb1e6c7cce0bce71dc450dcafc4b88dee60d133"},e("input",{key:"3a6e08781a0396cd6e22ee1d9736aa40e5cdb204",class:"date-range-input",type:"button",disabled:this.disabled}))}get element(){return n(this)}static get watchers(){return{minDate:["handleMinDateChange"],date:["datePropChanged"]}}};Or.style=Cr;const Mr=".sc-ir-date-view-h{display:block;font-size:13.65px !important;width:100%}.mx-01.sc-ir-date-view{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Er=Mr;const Yr=class{constructor(e){t(this,e);this.showDateDifference=true;this.dateOption="YYYY-MM-DD"}componentWillLoad(){this.initializeDates()}handleFromDateChange(t,e){if(t!==e){this.initializeDates()}}handleToDateChange(t,e){if(t!==e){this.initializeDates()}}initializeDates(){this.convertDate("from_date",this.from_date);this.convertDate("to_date",this.to_date);const t=D(this.dates.from_date,"MMM DD, YYYY").format("YYYY-MM-DD");const e=D(this.dates.to_date,"MMM DD, YYYY").format("YYYY-MM-DD");this.dates.date_difference=S(t,e)}convertDate(t,e){this.dates=this.dates||{from_date:"",to_date:"",date_difference:0};if(!e){return}if(typeof e==="string"){this.dates[t]=D(e,this.dateOption).format("MMM DD, YYYY")}else if(e instanceof Date){this.dates[t]=D(e).format("MMM DD, YYYY")}else if(D.isMoment(e)){this.dates[t]=e.format("MMM DD, YYYY")}else{console.error("Unsupported date type")}}render(){return e(i,{key:"1403af40bdb3a31f1701db830b4a7dde3744e6f0",class:"d-flex align-items-center"},e("span",{key:"4ed680c5a2548fcddf47e18f794893e5b6e93dd8"},this.dates.from_date)," ",e("svg",{key:"d2b40d5e8f73c06bf80f1fbff00e5f90e7ca732a",xmlns:"http://www.w3.org/2000/svg",class:"mx-01",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{key:"d04fcf9b323545610b706621acfefdf33edc959e",fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),e("span",{key:"51cd1301439dc9795e6cb08db3784a86e006f2ba"},this.dates.to_date," ",this.showDateDifference&&e("span",{key:"af82f07226f677d3852bfa045244d909095f2668",class:"mx-01"},this.dates.date_difference,"   ",this.dates.date_difference>1?` ${y.entries.Lcz_Nights}`:` ${y.entries.Lcz_Night}`)))}static get watchers(){return{from_date:["handleFromDateChange"],to_date:["handleToDateChange"]}}};Yr.style=Er;const Ar=".backdropModal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened']{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content{padding:10px;background:white;border-radius:5px}.modal{z-index:1001 !important}.modal-dialog{height:100vh;display:flex;align-items:center}.ir-alert-footer{gap:10px}.ir-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const Tr=Ar;var Sr=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const Br=class{constructor(e){t(this,e);this.modalClosed=s(this,"modalClosed",7);this.resetData=s(this,"resetData",7);this.isOpen=false;this.selectedId="";this.loadingBtn=null;this.housekeepingService=new mt}async closeModal(){this.isOpen=false;this.modalClosed.emit(null)}async openModal(){this.isOpen=true}async btnClickHandler(t){let e=t.target;let i=e.name;try{if(i==="confirm"){this.loadingBtn="confirm";if(this.selectedId===""){await this.housekeepingService.editExposedHKM(this.user,true)}else{const t=this.user.assigned_units.map((t=>({hkm_id:+this.selectedId,is_to_assign:true,unit_id:t.id})));await this.housekeepingService.manageExposedAssignedUnitToHKM(vt.default_properties.property_id,t);const e=this.user,i=Sr(e,["assigned_units","is_soft_deleted","is_active"]);await this.housekeepingService.editExposedHKM(i,true)}this.resetData.emit(null)}if(i==="cancel"){this.closeModal()}}catch(t){console.error(t)}finally{if(this.loadingBtn){this.loadingBtn=null;this.closeModal()}}}render(){if(!this.user){return}return[e("div",{class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{this.closeModal()}}),e("div",{"data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},e("div",{class:`ir-alert-content p-2`},e("div",{class:`r-alert-header mb-1 d-flex align-items-center justify-content-between border-0 py-0 m-0 `},e("p",{class:"m-0 p-0"},this.user.assigned_units.length>0?y.entries.Lcz_AssignUnitsTo:y.entries.Lcz_ConfirmDeletion),e("ir-button",{class:"exit-icon",variant:"icon",icon_name:"xmark",onClickHandler:()=>this.closeModal()})),e("div",{class:"modal-body text-left p-0 mb-2"},this.user.assigned_units.length>0&&e("div",{class:"modal-body text-left p-0 mb-2"},e("ir-select",{firstOption:y.entries.Lcz_nobody,selectedValue:this.selectedId,onSelectChange:t=>this.selectedId=t.detail,data:vt.hk_criteria.housekeepers.filter((t=>t.id!==this.user.id)).map((t=>({value:t.id.toString(),text:t.name}))).sort(((t,e)=>t.text.toLowerCase().localeCompare(e.text.toLowerCase())))}))),e("div",{class:`ir-alert-footer border-0  d-flex justify-content-end`},e("ir-button",{btn_color:"secondary",btn_block:true,text:y.entries.Lcz_Cancel,name:"cancel"}),e("ir-button",{isLoading:this.loadingBtn==="confirm",btn_color:"primary",btn_block:true,text:y.entries.Lcz_Confirm,name:"confirm"}))))]}};Br.style=Tr;const Ir=":host{display:block;margin:0;padding:0;box-sizing:border-box}.backdrop{opacity:0;background:rgba(0, 0, 0, 0.2);position:fixed;inset:0;z-index:99999998}.backdrop[data-state='opened']{animation:overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards}.backdrop[data-state='closed']{opacity:0;pointer-events:none}.modal-container{box-sizing:border-box;margin:0;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;position:fixed;z-index:99999999;overflow-y:auto;top:50%;left:50%;background:white;transform:translate(-50%, -50%);width:90%;min-height:fit-content;height:fit-content;max-width:var(--ir-dialog-max-width, 40rem);min-width:var(--ir-dialog-min-width);max-height:85vh;border-radius:8px;padding:0;animation:contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1)}.modal-footer ::slotted(*){flex-direction:row;align-items:center;justify-content:end;gap:8px;--ir-btn-width:inherit}.modal-footer{--ir-btn-width:100%}.modal-title ::slotted(*){font-size:18px;font-weight:600;color:#101828;margin-bottom:8px}.modal-body ::slotted(*){font-size:14px;font-weight:400;color:#475467;padding:0;margin:0}@keyframes overlayShow{from{opacity:0}to{opacity:1}}@keyframes contentShow{from{opacity:0;transform:translate(-50%, -48%) scale(0.96)}to{opacity:1;transform:translate(-50%, -50%) scale(1)}}.dialog-close-button{position:absolute;top:15px;right:15px}";const jr=Ir;const zr=class{constructor(e){t(this,e);this.openChange=s(this,"openChange",7);this.open=false;this.isOpen=false}componentWillLoad(){if(this.open){this.openModal()}}componentDidLoad(){this.prepareFocusTrap()}async openModal(){this.isOpen=true;document.body.style.overflow="hidden";setTimeout((()=>{this.prepareFocusTrap()}),10);this.openChange.emit(this.isOpen)}async closeModal(){console.log("close");if(!this.isOpen){return}document.body.style.overflow="visible";this.isOpen=false;this.openChange.emit(this.isOpen)}handleOpenChange(){if(this.open){this.openModal()}else{this.closeModal()}}handleKeyDown(t){if(!this.isOpen){return}let e=t.key==="Tab";if(t.key==="Escape"&&this.isOpen){this.closeModal()}if(!e){return}if(!t.shiftKey&&document.activeElement===this.lastFocusableElement){this.firstFocusableElement.focus();t.preventDefault()}if(t.shiftKey&&document.activeElement===this.firstFocusableElement){this.lastFocusableElement.focus();t.preventDefault()}}disconnectedCallback(){document.body.style.overflow="visible"}prepareFocusTrap(){const t='button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';const e=this.el.shadowRoot.querySelectorAll(t);if(e.length===0)return;this.firstFocusableElement=e[0];this.lastFocusableElement=e[e.length-1];this.firstFocusableElement.focus()}render(){return e(i,{key:"aa926121159ea5c713b82179b4e706f99714c911"},e("div",{key:"3d46099784d1d2805ca18a93b8c609e8eb37a149",class:"backdrop","data-state":this.isOpen?"opened":"closed",onClick:()=>this.closeModal()}),this.isOpen&&e("div",{key:"30b7a81e40781d94e1bc5edacb58541f56c76e91",class:"modal-container",tabIndex:-1,role:"dialog","aria-labelledby":"dialog1Title","aria-describedby":"dialog1Desc"},e("ir-icon",{key:"374c64090e362a9639109f5bfebc22a3353764c5",id:"close",class:"dialog-close-button",onIconClickHandler:()=>this.closeModal()},e("svg",{key:"0a082c5deb0b49748811b0c9dd07e6cd342df901",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:18,width:18},e("path",{key:"8bb23c0c9b9afa211289676e28cb96b6c32331d8",fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),e("div",{key:"7e56c94e76b8f2b98b29e48fce9baa75571ec766",class:"modal-title",id:"dialog1Title"},e("slot",{key:"738052785907e883ea1264e60a83379edf7c7ee9",name:"modal-title"})),e("div",{key:"0996b78361d7b1a63a18bea1229d0750b8f26f80",class:"modal-body",id:"dialog1Desc"},e("slot",{key:"6f9fc6e9866afe95c73c4672ace1225fed483188",name:"modal-body"})),e("div",{key:"fbe5fbee889933621f5001adea586d2041c8f68c",class:"modal-footer"},e("slot",{key:"90eb7247788471bd652ffe622dac790f550c9f1c",name:"modal-footer"}))))}get el(){return n(this)}static get watchers(){return{open:["handleOpenChange"]}}};zr.style=jr;const Nr=".dropdown-menu.sc-ir-dropdown{z-index:1000;width:100%;max-height:300px;overflow-y:auto}.dropdown.nav-item.show.sc-ir-dropdown .dropdown-menu.sc-ir-dropdown{display:block}.caret-icon.sc-ir-dropdown{position:absolute;top:50%;transform:translateY(-55%);right:0.25rem;z-index:99999}.dropdown-trigger.sc-ir-dropdown{position:relative}.caret-icon.disabled.sc-ir-dropdown{opacity:0.5 !important;pointer-events:none !important;cursor:not-allowed !important}";const Rr=Nr;const $r=class{constructor(e){t(this,e);this.optionChange=s(this,"optionChange",7);this.disabled=false;this.isOpen=false;this.focusedIndex=-1;this.itemChildren=[];this.mo=null;this.isComponentConnected=true;this.updateQueued=false;this.handleDocumentClick=t=>{if(!this.isComponentConnected||!this.el.contains(t.target)){this.closeDropdown()}};this.handleKeyDown=t=>{if(!this.isComponentConnected||this.disabled)return;const e=this.itemChildren.length-1;switch(t.key){case"ArrowDown":t.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>=0&&this.focusedIndex<e){this.focusedIndex++;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===e){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}}else if(e>=0){this.focusedIndex=this.focusedIndex<e?this.focusedIndex+1:0;this.focusItemElement(this.focusedIndex)}break;case"ArrowUp":t.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>0){this.focusedIndex--;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=e;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===0){this.focusedIndex=e;this.focusItemElement(this.focusedIndex)}}else if(e>=0){this.focusedIndex=this.focusedIndex>0?this.focusedIndex-1:e;this.focusItemElement(this.focusedIndex)}break;case"Enter":t.preventDefault();if(this.isOpen&&this.focusedIndex>=0){this.selectItemElement(this.focusedIndex)}else if(!this.isOpen){this.openDropdown()}break;case"Escape":t.preventDefault();this.closeDropdown();break;case"Tab":if(this.isOpen){this.closeDropdown()}break}}}componentWillLoad(){this.selectedOption=this.value;this.documentClickHandler=this.handleDocumentClick.bind(this);this.collectItemChildren();this.mo=new MutationObserver((()=>{if(!this.updateQueued){this.updateQueued=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.collectItemChildren();this.updateQueued=false}}))}}));this.mo.observe(this.el,{childList:true,subtree:true})}componentDidLoad(){document.addEventListener("click",this.documentClickHandler,{passive:true});requestAnimationFrame((()=>{if(this.isComponentConnected){this.updateItemElements();if(this.value){this.updateDropdownItemValue(this.value)}}}))}disconnectedCallback(){var t;this.isComponentConnected=false;document.removeEventListener("click",this.documentClickHandler);(t=this.mo)===null||t===void 0?void 0:t.disconnect();this.mo=null}handleDocumentKeyDown(t){if(!this.isOpen||!this.isComponentConnected)return;if(t.key==="Escape"){this.closeDropdown()}}handleDropdownItemSelect(t){if(!this.isComponentConnected)return;t.stopPropagation();this.selectOption(t.detail);t.target.setAttribute("aria-selected","true")}handleDropdownItemRegister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleDropdownItemUnregister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleValueChange(t,e){if(t!==e&&this.isComponentConnected){this.updateDropdownItemValue(t)}}updateDropdownItemValue(t){this.itemChildren.forEach((t=>t.removeAttribute("aria-selected")));const e=this.itemChildren.find((e=>e.value===t));if(e){e.setAttribute("aria-selected","true")}}getSelectedItemIndex(){if(!this.value)return-1;return this.itemChildren.findIndex((t=>t.value===this.value))}openDropdown(){try{this.isOpen=true;this.focusedIndex=this.getSelectedItemIndex();this.updateItemElements();if(this.focusedIndex>=0){requestAnimationFrame((()=>{this.scrollToSelectedItem()}))}}catch(t){console.log(t)}}closeDropdown(){this.isOpen=false;this.focusedIndex=-1;this.removeItemFocus()}collectItemChildren(){if(!this.isComponentConnected)return;const t=Array.from(this.el.querySelectorAll("ir-dropdown-item"));this.itemChildren=t;this.updateItemElements()}updateItemElements(){if(!this.isComponentConnected)return;this.itemChildren.forEach(((t,e)=>{t.setAttribute("data-slot-index",String(e));t.setAttribute("role","option");t.setAttribute("tabindex","-1")}))}removeItemFocus(){this.itemChildren.forEach((t=>{t.classList.remove("focused","active")}))}focusItemElement(t){this.removeItemFocus();if(t>=0&&t<this.itemChildren.length){const e=this.itemChildren[t];e.classList.add("focused");e.scrollIntoView({block:"nearest",behavior:"smooth"})}}selectItemElement(t){if(t>=0&&t<this.itemChildren.length){const e=this.itemChildren[t];e.click()}}scrollToSelectedItem(){if(this.focusedIndex>=0&&this.focusedIndex<this.itemChildren.length){const t=this.itemChildren[this.focusedIndex];if(t){t.scrollIntoView({block:"nearest",behavior:"smooth",inline:"nearest"})}}}selectOption(t){this.selectedOption=t;this.value=t;this.optionChange.emit(t);this.closeDropdown()}render(){return e(i,{key:"2dc85a1a0c3e18e5d7ad95d73b65191ab4d6517f",class:`dropdown ${this.isOpen?"show":""}`},e("div",{key:"27ea00249469c1b2b87549a14335488a388a93e3",onClick:()=>{if(this.disabled)return;if(this.isOpen){this.closeDropdown()}else{this.openDropdown()}},"aria-disabled":String(this.disabled),class:`dropdown-trigger ${this.disabled?"disabled":""}`,onKeyDown:this.handleKeyDown,tabindex:"0"},e("slot",{key:"1da437861821b8d6ce88268074964c7769848992",name:"trigger"}),e("div",{key:"180d0d26598c5892fb6422c4f145e5f03601f8e7",class:`caret-icon ${this.disabled?"disabled":""}`},e("ir-icons",{key:"768ff0d27e0dd698f700b17fb823ebbcf8ae7362",name:!this.isOpen?"angle-down":"angle-up"}))),e("div",{key:"72c5479acbc9a3f6163e30c0634ae52e19816433",class:"dropdown-menu",role:"listbox","aria-expanded":this.isOpen.toString()},e("slot",{key:"87327ce54ba63e3ee7fa304e7a7566bfef14447f"})))}get el(){return n(this)}static get watchers(){return{value:["handleValueChange"]}}};$r.style=Rr;const Fr=".sc-ir-dropdown-item-h{display:block;cursor:pointer}[hidden].sc-ir-dropdown-item-h{display:none !important}.focused.sc-ir-dropdown-item-h{background:#f4f5fa !important}.active.sc-ir-dropdown-item-h,[aria-selected='true'].sc-ir-dropdown-item-h,.sc-ir-dropdown-item-h:active{outline:none;background-color:var(--blue, #1e9ff2) !important;color:white !important}.dropdown-item.sc-ir-dropdown-item-h{padding:0.5rem 1rem !important;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}";const Lr=Fr;const Pr=class{constructor(e){t(this,e);this.dropdownItemSelect=s(this,"dropdownItemSelect",7);this.dropdownItemRegister=s(this,"dropdownItemRegister",7);this.dropdownItemUnregister=s(this,"dropdownItemUnregister",7);this.isComponentConnected=true;this.hasRegistered=false;this.hidden=false;this.handleClick=t=>{t.stopPropagation();if(!this.isComponentConnected)return;this.dropdownItemSelect.emit(this.value)}}componentDidLoad(){if(this.isComponentConnected&&!this.hasRegistered){this.hasRegistered=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.dropdownItemRegister.emit()}}))}}disconnectedCallback(){this.isComponentConnected=false;if(this.hasRegistered&&this.el.parentElement){const t=this.el.closest("ir-dropdown");if(t&&document.contains(t)){this.dropdownItemUnregister.emit()}}this.hasRegistered=false}async matchesQuery(t){var e,i;if(!this.isComponentConnected)return false;const s=t.toLowerCase();const a=((i=(e=this.label)!==null&&e!==void 0?e:this.el.textContent)!==null&&i!==void 0?i:"").toLowerCase();return a.includes(s)}async setHidden(t){if(this.isComponentConnected){this.hidden=t}}render(){return e(i,{key:"5d43f09e5b365d5ff6912079eec428bd3560c47c",role:"option",tabindex:"-1","aria-selected":"false",class:{"dropdown-item":true,hidden:this.hidden},onClick:this.handleClick,"data-value":this.value},this.html_content?e("span",{innerHTML:this.html_content}):e("slot",null))}get el(){return n(this)}};Pr.style=Lr;const Hr=".sc-ir-events-log-h{display:block}.beta.sc-ir-events-log{background:var(--red);color:white;padding:0.2rem 0.3rem;font-size:12px;border-radius:4px;margin:0}.event-row.sc-ir-events-log{padding-bottom:0.5rem}.list-title.sc-ir-events-log{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-events-log{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-events-log{color:#629a4c;font-weight:600}.list-item.red.sc-ir-events-log{color:#ff4961;font-weight:600}.dates-row.sc-ir-events-log{display:flex;align-items:center;gap:0.875rem}";const Ur=Hr;const Vr=class{constructor(e){t(this,e)}componentWillLoad(){this.init()}async init(){try{this.bookingEvents=this.booking.events}catch(t){console.error(t)}}render(){var t;return e("div",{key:"08cbb954abf646045af6d0abe392d916bdb63160",class:"p-1"},e("div",{key:"7a9132b0ca420d4db6677a2ebcbcfa01f62551ce",class:"d-flex  align-items-center",style:{gap:"0.5rem"}},e("h3",{key:"8b7612f1fabe26a9450bdd3810fb011161306c33",class:" text-left p-0 m-0  dialog-title "},y.entries.Lcz_EventsLog)),ut("/Get_Exposed_Booking_Events")?e("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},e("ir-spinner",null)):e(a,null,e("table",{class:" dialog-container-height"},e("thead",{style:{opacity:"0"}},e("tr",null,e("th",null,"date"),e("th",null,"user"),e("th",null,"status"))),e("tbody",null,(t=this.bookingEvents)===null||t===void 0?void 0:t.map((t=>e("tr",{key:t.id,class:"pb-1"},e("td",{class:"event-row dates-row"},e("span",null,t.date),e("span",null,String(t.hour).padStart(2,"0"),":",String(t.minute).padStart(2,"0"),":",String(t.second).padStart(2,"0"))),e("td",{class:"pl-3 event-row "},t.type),e("td",{class:"pl-1 event-row "},t.user))))))))}};Vr.style=Ur;const Gr=".sc-ir-extra-service-h{display:block}.extra-service-container.sc-ir-extra-service{display:flex;align-items:start;justify-content:space-between;gap:0.5rem}.extra-service-container.sc-ir-extra-service *.sc-ir-extra-service{padding:0;margin:0;box-sizing:border-box}.extra-service-actions.sc-ir-extra-service{display:flex;align-items:center;gap:0.5rem}.extra-service-conditional-date.sc-ir-extra-service{margin-top:0.5rem}.extra-service-price.sc-ir-extra-service{white-space:nowrap}.extra-service-description.sc-ir-extra-service{word-break:break-all}";const Kr=Gr;const Wr=class{constructor(e){t(this,e);this.editExtraService=s(this,"editExtraService",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.bookingService=new l}async deleteService(){try{await this.bookingService.doBookingExtraService({service:this.service,is_remove:true,booking_nbr:this.bookingNumber});this.resetBookingEvt.emit(null)}catch(t){console.log(t)}}render(){return e(i,{key:"c27d94a1710cf991ceab294598e76ea9784bab82"},e("div",{key:"61ef29b41f73782c13db9f8a42fbe74820218bbd",class:"p-1"},e("div",{key:"8b0608696bfc853e6945b4ec90e1823a327aa5af",class:"extra-service-container"},e("p",{key:"4447c2d5743610f9994678d4986712856087a86c",class:"extra-service-description"},this.service.description),e("div",{key:"ce95afcbe3c2729d43ad1295379929250126a5a8",class:"extra-service-actions"},!!this.service.price&&this.service.price>0&&e("p",{key:"074934359a8db0b6dbd9f69dc670ae4e04b83f01",class:"extra-service-price p-0 m-0 font-weight-bold"},_(this.currencySymbol,this.service.price)),e("ir-button",{key:"daad82b348c141f60ec4306737080d75d8e0d913",id:`serviceEdit-${this.service.booking_system_id}`,class:"extra-service-edit-btn m-0 p-0",variant:"icon",icon_name:"edit",style:wt.secondary,onClickHandler:()=>this.editExtraService.emit(this.service)}),e("ir-button",{key:"29d9431c1334c3121e27620148bba06683a8bace",class:"extra-service-delete-btn m-0 p-0",variant:"icon",onClickHandler:()=>this.irModalRef.openModal(),id:`roomDelete-${this.service.booking_system_id}`,icon_name:"trash",style:wt.danger}))),e("div",{key:"e2d9db6b2a244fafe9914c58c5cff3d40899e651",class:"extra-service-conditional-date"},this.service.start_date&&this.service.end_date?e("ir-date-view",{class:"extra-service-date-view mr-1",from_date:this.service.start_date,to_date:this.service.end_date,showDateDifference:false}):this.service.start_date&&e("p",{class:"extra-service-date-view"},D(new Date(this.service.start_date)).format("MMM DD, YYYY")))),e("ir-modal",{key:"5511cf100769738fdc9a3e163c0479e6aa493cf3",autoClose:false,ref:t=>this.irModalRef=t,isLoading:ut("/Do_Booking_Extra_Service"),onConfirmModal:this.deleteService.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:y.entries.Lcz_Cancel,rightBtnText:y.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:y.entries.Lcz_Confirmation,modalBody:`${y.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${y.entries.Lcz_ThisService} ${y.entries.Lcz_FromThisBooking}`}))}};Wr.style=Kr;const qr=N.object({type:N.object({code:N.union([N.string().min(3),N.literal("")]).optional(),description:N.union([N.string(),N.literal("")]).optional()}),number:N.union([N.string().min(2),N.literal("")]).optional().nullable()});const Xr=N.object({id:N.number().optional(),first_name:N.union([N.string().min(2),N.literal("")]).optional(),last_name:N.union([N.string().min(2),N.literal("")]).optional(),country_id:N.coerce.number().min(0).optional(),dob:N.string().nullable().optional().refine((t=>t===undefined||D(t,"DD/MM/YYYY",true).isValid()||t===""||t===null),"Invalid date format").transform((t=>{if(t===undefined||t===""||t===null)return null;const e=D(t,"DD/MM/YYYY",true).isValid();return e?null:D(t,"DD/MM/YYYY").format("YYYY-MM-DD")})),id_info:qr.optional(),is_main:N.boolean().default(false)});function Jr(t){var e;Xr.parse(t);const i=t=>t!==null&&t!==undefined&&t.trim()!=="";const s=[];if(t.is_main){if(!i(t.first_name)){s.push({path:["first_name"],code:st.custom,message:"First name is required for main guest"})}if(!i(t.last_name)){s.push({path:["last_name"],code:st.custom,message:"Last name is required for main guest"})}}const a=i(t.first_name)||i(t.last_name)||i(t.dob)||t.country_id!==null&&t.country_id!==undefined&&t.country_id>0||i((e=t.id_info)===null||e===void 0?void 0:e.number);if(a){if(!i(t.first_name)){s.push({path:["first_name"],code:st.custom,message:"First name is required when other guest information is provided"})}if(!i(t.last_name)){s.push({path:["last_name"],code:st.custom,message:"Last name is required when other guest information is provided"})}}if(s.length>=1){throw new R(s)}}const Qr=N.object({booking_system_id:N.number().optional(),cost:N.coerce.number().nullable(),currency_id:N.number().min(1),description:N.string().min(1),end_date:N.string().nullable(),price:N.coerce.number(),start_date:N.string().nullable(),system_id:N.number().optional()});const Zr=".sc-ir-extra-service-config-h{display:block;--ir-input-border-color:#cacfe7}.sc-ir-extra-service-config-h .input-group-text.sc-ir-extra-service-config{border-color:var(--ir-input-border-color)}.currency-ph.sc-ir-extra-service-config{padding:0;margin:0;color:#3b4781;display:flex;align-items:center;justify-content:center;padding:0 0 0 0.25rem;border-top:1px solid var(--ir-input-border-color);border-bottom:1px solid var(--ir-input-border-color);border-left:1px solid transparent;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;transition:border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.service-description-input.sc-ir-extra-service-config{height:70px !important}.service-description.sc-ir-extra-service-config .input-group-prepend.sc-ir-extra-service-config{background-color:#f4f5fa;border:1px solid var(--ir-input-border-color);border-top-left-radius:0.25rem;border-bottom-left-radius:0.25rem}.service-date-container.sc-ir-extra-service-config{padding:0;margin:0;display:flex;align-items:center;position:relative;width:100%;justify-content:center}.service-date-container.sc-ir-extra-service-config .btn-container.sc-ir-extra-service-config{position:absolute;right:5px;margin:0;display:flex;align-items:center;justify-content:center;padding:0}.service-description.sc-ir-extra-service-config .input-group-text.sc-ir-extra-service-config{height:fit-content;border:0;padding-top:0.75rem !important}.price-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config,.cost-input-group.sc-ir-extra-service-config:focus-within .currency-ph.sc-ir-extra-service-config{border-top:1px solid #1e9ff2;border-bottom:1px solid #1e9ff2;border-left:1px solid #1e9ff2}.currency-ph[data-state='error'].sc-ir-extra-service-config{border-color:var(--red, #ff4961)}.price-input.sc-ir-extra-service-config:focus{border-right-width:1px !important}.is-invalid.sc-ir-extra-service-config{background-image:none !important}.price-input.sc-ir-extra-service-config,.cost-input.sc-ir-extra-service-config{border-left:0}.row-group.sc-ir-extra-service-config{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 640px){.row-group.sc-ir-extra-service-config{flex-direction:row;align-items:center;gap:0}.cost-label.sc-ir-extra-service-config{border-top-left-radius:0;border-bottom-left-radius:0;border-left:0}.until-prepend.sc-ir-extra-service-config,.cost-input-placeholder.sc-ir-extra-service-config{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.date-from.sc-ir-extra-service-config,.price-input.sc-ir-extra-service-config{border-right-width:0 !important;border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}}.date-focused.sc-ir-extra-service-config{border-color:#1e9ff2}";const tl=Zr;const el=".sc-ir-extra-service-config-h{height:100%}.sheet-container.sc-ir-extra-service-config{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-extra-service-config{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-extra-service-config{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-extra-service-config{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-extra-service-config{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-extra-service-config{flex-direction:row;align-items:center}}";const il=el;const sl=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.bookingService=new l}componentWillLoad(){if(this.service){this.s_service=Object.assign({},this.service)}}async saveAmenity(){try{Qr.parse(this.s_service);await this.bookingService.doBookingExtraService({service:this.s_service,booking_nbr:this.booking.booking_nbr,is_remove:false});this.resetBookingEvt.emit(null);this.closeModal.emit(null)}catch(t){if(t instanceof R){this.error=true}console.error(t)}}updateService(t){let e=this.s_service;if(!e){e={cost:null,description:null,end_date:null,start_date:null,price:null,currency_id:this.booking.currency.id}}this.s_service=Object.assign(Object.assign({},e),t)}validatePrice(){var t,e,i,s;if(((t=this.s_service)===null||t===void 0?void 0:t.price)===undefined||((i=(e=this.s_service)===null||e===void 0?void 0:e.price)===null||i===void 0?void 0:i.toString())===""){return false}const a=Qr.pick({price:true});const n=a.safeParse({price:(s=this.s_service)===null||s===void 0?void 0:s.price});return n.success}render(){var t,i,s,a,n,o,r,l,c,d,h,u,f,p;return e("form",{key:"f8bd9a5202fd899facfe900128c8d56bf4a8e7ef",class:"sheet-container",onSubmit:async t=>{t.preventDefault();await this.saveAmenity()}},e("ir-title",{key:"c6afac1577b2deff5f61dc24415469638b986174",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:y.entries.Lcz_ExtraServices,displayContext:"sidebar"}),e("section",{key:"8d6aab346073f4039c7b68c0156e86933976c012",class:"px-1 sheet-body"},e("fieldset",{key:"03334d806aaba87a73554ad2d45b70fae7736bfc",class:"input-group mb-1 service-description"},e("div",{key:"530fc4331dd39e457dd7717e4502755b13d4ed39",class:"input-group-prepend"},e("span",{key:"cd755a1955705a9913b49fbd22e755415beaa47e",class:"input-group-text"},y.entries.Lcz_Description)),e("textarea",{key:"2786e785a2cb7da4c1e25a7d637bb9b7c50b8b91",value:(t=this.s_service)===null||t===void 0?void 0:t.description,class:`form-control service-description-input ${this.error&&!((i=this.s_service)===null||i===void 0?void 0:i.description)?"is-invalid":""}`,style:{height:"7rem"},maxLength:250,onChange:t=>this.updateService({description:t.target.value}),"aria-label":"Amenity description"})),e("div",{key:"c735e26a8d877817a9dce04e79e2051d9c9112cb",class:"row-group mb-1"},e("div",{key:"6ebf0053bb2844c1d9ecc9c81a64d82f760248af",class:"input-group"},e("div",{key:"c83ca3bd6b8b5178d2a4f6307f84acb1a433fc78",class:"input-group-prepend"},e("span",{key:"39bef9d2ea5a77de5aea08b0f360b1189ca8f0c1",class:"input-group-text",id:"basic-addon1"},y.entries.Lcz_DatesOn)),e("div",{key:"ead019a28cc9f69cc6c868f2db368b2245117b88",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from"},e("div",{key:"ea266e480a2ce5c64fec3370958dc6107c0b19f7",class:"service-date-container"},e("ir-date-picker",{key:"ba7215b64215012e426f7dd7770c771a2474b5f9",emitEmptyDate:true,date:(s=this.s_service)===null||s===void 0?void 0:s.start_date,minDate:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:t=>{var e;return this.updateService({start_date:(e=t.detail.start)===null||e===void 0?void 0:e.format("YYYY-MM-DD")})}},e("input",{key:"d8e9b44a995f9be5b6414a9a9b0e90aa3d40daaa",type:"text",slot:"trigger",value:((a=this.s_service)===null||a===void 0?void 0:a.start_date)?g(this.s_service.start_date):null,style:{borderLeftWidth:"0",borderRightWidth:"0",width:"100%",borderRadius:"0"},class:"text-center w-100 form-control input-sm"})),((n=this.s_service)===null||n===void 0?void 0:n.start_date)&&e("div",{key:"fd7ed32e7db65d8539e1c0c1a3aa260122a407bf",class:"btn-container"},e("ir-button",{key:"f9bb8d6dd692d44ae8a3ca7f58d69011db214b31",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateService({start_date:null})}}))))),e("div",{key:"92d36dd21ef90cad79510061a9b2e456183a2bf3",class:"input-group"},e("div",{key:"8bc2d8ba8a732a02c0d91f5bdd1b0d2bd41f57f4",class:"input-group-prepend "},e("span",{key:"c8b76aca071ac48e4408561a94c9c2be6570cd88",class:"input-group-text until-prepend",id:"basic-addon1"},y.entries.Lcz_TillAndIncluding)),e("div",{key:"3f45d7c79699ee3e2d0b569c109da35adeafa030",class:"form-control p-0 m-0 d-flex align-items-center justify-content-center"},e("div",{key:"d42640d39101bec44f6ae3cd8e6323c193d5907c",class:"service-date-container"},e("ir-date-picker",{key:"5d1166d56045532d692ab5cace1b03c76fa01bdd",emitEmptyDate:true,date:(o=this.s_service)===null||o===void 0?void 0:o.end_date,minDate:(l=(r=this.s_service)===null||r===void 0?void 0:r.start_date)!==null&&l!==void 0?l:this.booking.from_date,maxDate:this.booking.to_date,onDateChanged:t=>{var e;t.stopImmediatePropagation();t.stopPropagation();this.updateService({end_date:(e=t.detail.start)===null||e===void 0?void 0:e.format("YYYY-MM-DD")})}},e("input",{key:"3eac663f700edf775cd07f7e89f8bcb56879ce5c",slot:"trigger",value:((c=this.s_service)===null||c===void 0?void 0:c.end_date)?g(this.s_service.end_date):null,style:{borderLeftWidth:"0",borderRightWidth:"0",width:"100%"},class:"text-center form-control input-sm"})),((d=this.s_service)===null||d===void 0?void 0:d.end_date)&&e("div",{key:"a3810aeeb7477651502d412e755f01d76e48c3d8",class:"btn-container"},e("ir-button",{key:"957b91a01649813d95dda8d14f3b8dd23b7cd0dd",title:"clear",id:"close",variant:"icon",style:{"--icon-size":"0.875rem"},icon_name:"xmark-fill",class:"ml-2",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateService({end_date:null})}})))))),e("div",{key:"4a09784366b0462d7973d5d3e276ab59b020c55e",class:"row-group"},e("ir-price-input",{key:"89bcecd47b8150e1caa77d2a05565eb1a9bbf4de",label:"Price",currency:this.booking.currency.symbol,class:"ir-br-input-none",value:(u=(h=this.s_service)===null||h===void 0?void 0:h.price)===null||u===void 0?void 0:u.toString(),zod:Qr.pick({price:true}),"aria-label":y.entries.Lcz_Price,wrapKey:"price","aria-describedby":"service price",autoValidate:false,"data-state":this.error&&!this.validatePrice()?"error":"",onTextChange:t=>this.updateService({price:parseFloat(t.detail)})}),e("ir-price-input",{key:"bc3c1feea67c2bf43c22c58cc76ec8f1aae56afd",autoValidate:false,label:y.entries.Lcz_Cost,labelStyle:"rounded-0 border-left-0",currency:this.booking.currency.symbol,value:(p=(f=this.s_service)===null||f===void 0?void 0:f.cost)===null||p===void 0?void 0:p.toString(),zod:Qr.pick({cost:true}),onTextChange:t=>this.updateService({cost:parseFloat(t.detail)}),wrapKey:"cost","aria-label":"Cost","aria-describedby":"service cost"}))),e("div",{key:"f9395cf9b4698fc91d28c130c0cd26386bd2288a",class:"sheet-footer"},e("ir-button",{key:"2c60bacd835cceff319d8d5034e66f22043c1e3c",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:y.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{key:"b60099bd600e6ebca0cb38448c8fda123c389009",btn_styles:"justify-content-center align-items-center",class:"flex-fill",btn_type:"submit",isLoading:ut("/Do_Booking_Extra_Service"),text:y.entries.Lcz_Save,btn_color:"primary"})))}};sl.style=tl+il;const al=".sc-ir-extra-services-h{display:block}";const nl=al;const ol=class{constructor(e){t(this,e)}render(){var t;return e(i,{key:"7dcb2166f8c3df55e0ccda040d84406ac44e34cc",class:"card p-0 "},(t=this.booking.extra_services)===null||t===void 0?void 0:t.map(((t,i)=>e(a,null,e("ir-extra-service",{bookingNumber:this.booking.booking_nbr,currencySymbol:this.booking.currency.symbol,key:t.booking_system_id,service:t}),i!==this.booking.extra_services.length-1&&e("hr",{class:"mr-2 ml-2 my-0 p-0"})))))}};ol.style=nl;const rl=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}.loading-container.sc-ir-guest-info{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}";const ll=rl;const cl=".sc-ir-guest-info-h{height:100%}.sheet-container.sc-ir-guest-info{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-guest-info{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-guest-info{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-guest-info{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-guest-info{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-guest-info{flex-direction:row;align-items:center}}";const dl=cl;const hl=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.toast=s(this,"toast",7);this.guest=null;this.isLoading=true;this.autoValidate=false;this.bookingService=new l;this.roomService=new bt;this.token=new pt}async componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}if(!!this.token.getToken())this.init()}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.init()}async init(){try{console.log("first");this.isLoading=true;const[t,e,i]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language),!y||!y.entries||Object.keys(y.entries).length===0?this.roomService.fetchLanguage(this.language):Promise.resolve(null)]);if(i){y.entries=i.entries;y.direction=i.direction}this.countries=e;this.guest=Object.assign(Object.assign({},t),{mobile:t.mobile_without_prefix})}catch(t){console.log(t)}finally{this.isLoading=false}}handleInputChange(t){this.guest=Object.assign(Object.assign({},this.guest),t)}async editGuest(){var t;try{this.autoValidate=true;await this.bookingService.editExposedGuest(this.guest,(t=this.booking_nbr)!==null&&t!==void 0?t:null);this.toast.emit({type:"success",description:"",title:"Saved Successfully",position:"top-right"});this.closeSideBar.emit(null);this.resetBookingEvt.emit(null)}catch(t){console.log(t)}}render(){var t,i,s,n,o,r,l,c,d,h,u,f;if(this.isLoading&&this.isInSideBar){e("div",{class:"loading-container"},e("ir-spinner",null))}if(this.isLoading){return null}return e("form",{class:"p-0 sheet-container",onSubmit:async t=>{t.preventDefault();await this.editGuest()}},!this.isInSideBar&&[e("ir-toast",null),e("ir-interceptor",null)],this.headerShown&&e("ir-title",{class:"px-1 sheet-header",displayContext:"sidebar",label:y.entries.Lcz_GuestDetails}),e("div",{class:this.isInSideBar?"sheet-body":"card-content collapse show "},e("div",{class:this.headerShown?"card-body px-1 pt-0":"pt-0"},e("ir-input-text",{autoValidate:this.autoValidate,label:(t=y.entries)===null||t===void 0?void 0:t.Lcz_FirstName,name:"firstName",value:(i=this.guest)===null||i===void 0?void 0:i.first_name,required:true,onTextChange:t=>this.handleInputChange({first_name:t.detail})}),e("ir-input-text",{autoValidate:this.autoValidate,label:(s=y.entries)===null||s===void 0?void 0:s.Lcz_LastName,name:"lastName",value:(n=this.guest)===null||n===void 0?void 0:n.last_name,required:true,onTextChange:t=>this.handleInputChange({last_name:t.detail})}),e("ir-input-text",{label:(o=y.entries)===null||o===void 0?void 0:o.Lcz_Email,name:"email",value:(r=this.guest)===null||r===void 0?void 0:r.email,required:true,onTextChange:t=>this.handleInputChange({email:t.detail})}),e("ir-input-text",{label:(l=y.entries)===null||l===void 0?void 0:l.Lcz_AlternativeEmail,name:"altEmail",value:(c=this.guest)===null||c===void 0?void 0:c.alternative_email,onTextChange:t=>this.handleInputChange({alternative_email:t.detail})}),e("ir-country-picker",{country:this.countries.find((t=>t.id===this.guest.country_id)),label:(d=y.entries)===null||d===void 0?void 0:d.Lcz_Country,onCountryChange:t=>this.handleInputChange({country_id:t.detail.id}),countries:this.countries}),e("ir-phone-input",{onTextChange:t=>{t.stopImmediatePropagation();t.stopPropagation();const{mobile:e,phone_prefix:i}=t.detail;if(e!==this.guest.mobile){this.handleInputChange({mobile:e})}if(i!==this.guest.country_phone_prefix)this.handleInputChange({country_phone_prefix:i})},phone_prefix:this.guest.country_phone_prefix,value:this.guest.mobile,language:this.language,label:(h=y.entries)===null||h===void 0?void 0:h.Lcz_MobilePhone,countries:this.countries}),e("div",{class:"mb-2"},e("ir-textarea",{variant:"prepend",onTextChange:t=>this.handleInputChange({notes:t.detail}),value:(u=this.guest)===null||u===void 0?void 0:u.notes,label:(f=y.entries)===null||f===void 0?void 0:f.Lcz_PrivateNote})),e("div",{class:"p-0 m-0"},e("label",{class:`check-container m-0 p-0`},e("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange({subscribe_to_news_letter:t.target.checked})}),e("span",{class:"checkmark m-0 p-0"}),e("span",{class:"m-0 p-0  check-label"},y.entries.Lcz_Newsletter)),!this.isInSideBar&&e(a,null,e("hr",null),e("ir-button",{btn_styles:"d-flex align-items-center justify-content-center",text:y.entries.Lcz_Save,onClickHandler:this.editGuest.bind(this),isLoading:ut("/Edit_Exposed_Guest"),color:"btn-primary"}))))),this.isInSideBar&&e("div",{class:"sheet-footer"},e("ir-button",{"data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill m-0 p-0",btn_styles:"w-100 m-0  justify-content-center align-items-center",btn_color:"secondary",text:y.entries.Lcz_Cancel}),e("ir-button",{"data-testid":"save",isLoading:ut("/Edit_Exposed_Guest"),btn_disabled:this.isLoading,class:"flex-fill m-0",btn_type:"submit",btn_styles:"w-100 m-0  justify-content-center align-items-center",text:y.entries.Lcz_Save})))}static get watchers(){return{ticket:["ticketChanged"]}}};hl.style=ll+dl;const ul=".sc-ir-hk-archive-h{display:block}.unit-name.sc-ir-hk-archive{max-width:100px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 !important;margin:0 !important;text-align:start}.table.sc-ir-hk-archive th.sc-ir-hk-archive,.table.sc-ir-hk-archive td.sc-ir-hk-archive{white-space:nowrap;width:fit-content;max-width:max-content !important;border:0;text-align:start;background-color:white;padding:0.25rem !important}.table.sc-ir-hk-archive th.sc-ir-hk-archive:first-child,.table.sc-ir-hk-archive td.sc-ir-hk-archive:first-child{padding-left:0 !important}";const fl=ul;const pl=class{constructor(e){t(this,e);this.language="en";this.filters={from_date:null,to_date:null,filtered_by_hkm:[],filtered_by_unit:[]};this.data=[];this.isLoading=null;this.fetchedData=false;this.minSelectableDate=D().subtract(90,"days").toDate();this.houseKeepingService=new mt;this.units=[]}handleSideBarToggle(t){t.stopImmediatePropagation();t.stopPropagation();this.selectedBooking=null}componentWillLoad(){this.setUpUnits()}setUpUnits(){const t=[];x.roomsInfo.forEach((e=>{e.physicalrooms.forEach((e=>{t.push({id:e.id,name:e.name})}))}));this.units=t}async getArchivedTasks(t=false){var e;const i=await this.houseKeepingService.getArchivedHKTasks(Object.assign(Object.assign({property_id:Number(this.propertyId)},this.filters),{is_export_to_excel:t}));this.data=(e=[...(i===null||i===void 0?void 0:i.tasks)||[]])===null||e===void 0?void 0:e.map((t=>Object.assign(Object.assign({},t),{id:ht()})));this.fetchedData=true;return{tasks:i===null||i===void 0?void 0:i.tasks,url:i===null||i===void 0?void 0:i.url}}handleDateRangeChange(t){t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i}=t.detail;this.updateFilters({from_date:e?e.format("YYYY-MM-DD"):null,to_date:i?i.format("YYYY-MM-DD"):null})}updateFilters(t){this.filters=Object.assign(Object.assign({},this.filters),t)}async searchArchive(t){try{t.stopImmediatePropagation();t.stopPropagation();this.isLoading="search";await this.getArchivedTasks()}catch(t){console.log(t)}finally{this.isLoading=null}}async exportArchive(t){try{t.stopImmediatePropagation();t.stopPropagation();this.isLoading="excel";const{url:e}=await this.getArchivedTasks(true);it(e)}catch(t){console.log(t)}finally{this.isLoading=null}}render(){var t,s,n,o,r,l,c,d,h,u,f,p;return e(i,{key:"53e71d362fdb963fa573fe5e48215b52d214ed9c"},e("ir-title",{key:"571f15b9006751be5b9e3a56e5ad5edd73136d54",class:"px-1",label:"Cleaning Archives (90 days)",displayContext:"sidebar"}),e("section",{key:"6ac6fae5809e00900d1f17f9e60cac9cd4fe5a7b",class:"px-1"},e("div",{key:"dbe107868d78b5ef65d61c0919b974cfb59b59e3",class:"d-flex"},e("ir-select",{key:"edf06bfba31c38ff6edb64f374ee068d4752c6d3",class:"w-100",showFirstOption:false,data:[{text:"All units",value:"000"},,...(t=this.units)===null||t===void 0?void 0:t.map((t=>({text:t.name,value:t.id.toString()}))).sort(((t,e)=>t.text.toLowerCase().localeCompare(e.text.toLowerCase())))],onSelectChange:t=>{t.stopImmediatePropagation();t.stopPropagation();if(t.detail==="000"){this.updateFilters({filtered_by_unit:[]})}else{this.updateFilters({filtered_by_unit:[t.detail]})}}}),((s=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||s===void 0?void 0:s.housekeepers.length)>1&&e("ir-select",{key:"8bcadd4862bded5a49317c25769fdb6bb09c15ca",class:"ml-1 w-100",selectedValue:((o=(n=this.filters)===null||n===void 0?void 0:n.filtered_by_hkm)===null||o===void 0?void 0:o.length)===vt.hk_criteria.housekeepers.length?"000":(l=(r=this.filters)===null||r===void 0?void 0:r.filtered_by_hkm[0])===null||l===void 0?void 0:l.toString(),showFirstOption:false,data:[{text:"All housekeepers",value:"000"},...(c=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||c===void 0?void 0:c.housekeepers.map((t=>({text:t.name,value:t.id.toString()}))).sort(((t,e)=>t.text.toLowerCase().localeCompare(e.text.toLowerCase())))],onSelectChange:t=>{if(t.detail==="000"){this.updateFilters({filtered_by_hkm:[]})}else{this.updateFilters({filtered_by_hkm:[t.detail]})}}})),e("div",{key:"6d150d2b01ddc91f8de1f05d24cb1a5debbf9377",class:"d-flex mt-1 align-items-center"},e("ir-range-picker",{key:"e09be50320076535c015a7ceeab9e5d90e6d67f3",maxDate:D().format("YYYY-MM-DD"),minDate:this.minSelectableDate,class:"mr-1",fromDate:this.filters.from_date?D(this.filters.from_date,"YYYY-MM-DD"):null,toDate:this.filters.to_date?D(this.filters.to_date,"YYYY-MM-DD"):null}),e("ir-button",{key:"dfd887cc8797ca6d04f946f83ce4a05d2217a32a",title:(d=y.entries)===null||d===void 0?void 0:d.Lcz_Search,variant:"icon",icon_name:"search",class:"mr-1",isLoading:this.isLoading==="search",onClickHandler:t=>this.searchArchive(t)}),e("ir-button",{key:"a194deb250605f3f403095a7318c5ff065d7c271",title:(h=y.entries)===null||h===void 0?void 0:h.Lcz_ExportToExcel,variant:"icon",icon_name:"file",isLoading:this.isLoading==="excel",onClickHandler:t=>this.exportArchive(t)})),this.fetchedData&&e(a,{key:"22ca4f93b22564d8d8c8dffeaf38aeea03f739ea"},((u=this.data)===null||u===void 0?void 0:u.length)===0&&!ut("/Get_Archived_HK_Tasks")?e("p",{class:"text-center mt-2"},y.entries.Lcz_NoResultsFound):e("table",{class:"mt-2 table"},e("thead",null,e("th",{class:"pl-0"},y.entries.Lcz_Period),e("th",null,y.entries.Lcz_Housekeeper),e("th",null,y.entries.Lcz_Unit),e("th",null,y.entries.Lcz_BookingNumber)),e("tbody",null,(f=this.data)===null||f===void 0?void 0:f.map((t=>e("tr",{key:t.id},e("td",{class:"pl-0"},t.date),e("td",null,t.house_keeper),e("td",null,e("ir-tooltip",{message:t.unit,customSlot:true,containerStyle:{width:"fit-content"}},e("span",{slot:"tooltip-trigger",class:`unit-name`},t.unit))),e("td",null,t.booking_nbr?e("ir-button",{btn_color:"link",btnStyle:{width:"fit-content",padding:"0",margin:"0"},labelStyle:{padding:"0"},text:t.booking_nbr.toString(),onClick:()=>{this.selectedBooking=t.booking_nbr}}):y.entries.Lcz_WasVacant)))))))),e("ir-sidebar",{key:"a9a03f153fd100326adf0f2f263204717e4aba7d",onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:!!this.selectedBooking,showCloseButton:false,sidebarStyles:{width:"80rem",background:"#F2F3F8"}},this.selectedBooking&&e("ir-booking-details",{key:"87f52bb1175ab669d6805f3b85c895c552d9867a",slot:"sidebar-body",hasPrint:true,hasReceipt:true,hasCloseButton:true,onCloseSidebar:()=>this.selectedBooking=null,is_from_front_desk:true,propertyid:Number(this.propertyId),hasRoomEdit:true,hasRoomDelete:true,bookingNumber:(p=this.selectedBooking)===null||p===void 0?void 0:p.toString(),language:this.language,hasRoomAdd:true,ticket:this.ticket})))}};pl.style=fl;const bl=[10,20,50,100];function gl(){const t=Cl();return{tasksList:t,currentPage:1,mobileCurrentPage:1,pageSize:20,mobilePageSize:20,totalPages:0,totalItems:0}}const ml={searchField:"",tasks:[],filteredTasks:[],selectedTasks:[],pagination:gl(),filters:null,isLoading:false,isFiltersLoading:false,isExportLoading:false,archiveOpen:false,archiveData:[],archiveFilters:{from_date:null,to_date:null,filtered_by_hkm:[],filtered_by_unit:[]},archiveLoading:null,sorting:{field:"date",direction:"ASC"},modalOpen:false,sidebarOpen:false};const{state:vl,onChange:yl}=k(ml);function kl(t){vl.searchField=t;vl.pagination.currentPage=1;Ol()}function wl(t){vl.tasks=t;Ol()}function xl(t){vl.pagination=Object.assign(Object.assign({},vl.pagination),t)}function _l(t){xl({pageSize:t,currentPage:1});Ml()}function Dl(t){if(t>=1&&t<=vl.pagination.totalPages){xl({currentPage:t})}}function Cl(){if(!x.roomsInfo){return bl}const t=x.roomsInfo.length;if(t<=10){return bl}const e=[...Array(4)].map(((e,i)=>{const s=t*(i+1);return i===3?s<100?100:s:s}));return e}function Ol(){var t,e;const i=(e=(t=vl===null||vl===void 0?void 0:vl.searchField)===null||t===void 0?void 0:t.toLowerCase())!==null&&e!==void 0?e:"";if(!i){vl.filteredTasks=[...vl.tasks]}else{vl.filteredTasks=vl.tasks.filter((t=>{var e,s,a,n,o;return((s=(e=t.unit)===null||e===void 0?void 0:e.name)===null||s===void 0?void 0:s.toLowerCase().includes(i))||((n=(a=t.status)===null||a===void 0?void 0:a.description)===null||n===void 0?void 0:n.toLowerCase().includes(i))||((o=t.housekeeper)===null||o===void 0?void 0:o.toLowerCase().includes(i))}))}Ml()}function Ml(){const t=vl.filteredTasks.length;const e=Math.max(1,Math.ceil(t/vl.pagination.pageSize));xl({totalItems:t,totalPages:e,currentPage:Math.min(vl.pagination.currentPage,e)})}function El(){const t=(vl.pagination.currentPage-1)*vl.pagination.pageSize;const e=t+vl.pagination.pageSize;return vl.filteredTasks.slice(t,e)}function Yl(){const{mobileCurrentPage:t,mobilePageSize:e}=vl.pagination;const i=(t-1)*e;const s=i+e;return vl.filteredTasks.slice(0,s)}function Al(){const{mobileCurrentPage:t,mobilePageSize:e}=vl.pagination;return!(e*(t-1)+e>=vl.filteredTasks.length)}function Tl(t){if(!Al()){return}xl({mobileCurrentPage:t})}function Sl(t){vl.selectedTasks=t}function Bl(){vl.selectedTasks=[]}function Il(t){const e=vl.selectedTasks.findIndex((e=>e.id===t.id));if(e>-1){vl.selectedTasks=vl.selectedTasks.filter((e=>e.id!==t.id))}else{vl.selectedTasks=[...vl.selectedTasks,t]}}function jl(t){vl.selectedTasks=[...t]}function zl(t){vl.isLoading=t}function Nl(t,e){vl.sorting={field:t,direction:e};vl.tasks=Rl(vl.tasks);Ol()}function Rl(t=vl.filteredTasks){const{field:e,direction:i}=vl.sorting;return[...t].sort(((t,s)=>{var a,n,o,r,l,c,d,h;let u=t[e];let f=s[e];if(e==="status"){u=(a=t.status)===null||a===void 0?void 0:a.description;f=(n=s.status)===null||n===void 0?void 0:n.description}else if(e==="unit"){u=(o=t.unit)===null||o===void 0?void 0:o.name;f=(r=s.unit)===null||r===void 0?void 0:r.name}if(u<f)return i==="ASC"?-1:1;if(u>f)return i==="ASC"?1:-1;if(t.date<s.date)return-1;if(t.date>s.date)return 1;if(((l=t.unit)===null||l===void 0?void 0:l.name)<((c=s.unit)===null||c===void 0?void 0:c.name))return-1;if(((d=t.unit)===null||d===void 0?void 0:d.name)>((h=s.unit)===null||h===void 0?void 0:h.name))return 1;return 0}))}function $l(){return vl.tasks.filter((t=>{const e=new Date(t.date);const i=new Date;i.setHours(23,59,59,999);return e<=i}))}function Fl(){const t=$l();return t.length>0&&vl.selectedTasks.length===t.length}const Ll=".sc-ir-hk-tasks-h{display:block;box-sizing:border-box}.sc-ir-hk-tasks-h *.sc-ir-hk-tasks{box-sizing:border-box}.tasks-view.sc-ir-hk-tasks{display:flex;flex-direction:column}@media (min-width: 1024px){.tasks-view.sc-ir-hk-tasks{flex-direction:row}}";const Pl=Ll;const Hl=class{constructor(e){t(this,e);this.clearSelectedHkTasks=s(this,"clearSelectedHkTasks",7);this.language="";this.ticket="";this.isLoading=false;this.isCleaningLoading=false;this.selectedDuration="";this.selectedHouseKeeper="0";this.selectedRoom=null;this.archiveOpened=false;this.hkNameCache={};this.roomService=new bt;this.houseKeepingService=new mt;this.token=new pt;this.table_sorting=new Map}componentWillLoad(){if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}if(this.ticket!==""){this.token.setToken(this.ticket);this.init()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.init()}handleCloseSidebar(t){t.stopImmediatePropagation();t.stopPropagation();this.isSidebarOpen=false}handleSortingChanged(t){t.stopImmediatePropagation();t.stopPropagation();const{field:e,direction:i}=t.detail;console.log(t.detail);if(e==="date"){return}this.table_sorting.set(e,i)}handleSkipSelectedTask(t){var e;t.stopImmediatePropagation();t.stopPropagation();this.modalCauses={task:t.detail,cause:"skip"};(e=this.modal)===null||e===void 0?void 0:e.openModal()}async init(){var t,e,i,s,a,n,o;try{this.isLoading=true;zl(true);let r=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}if(!r){console.log(r);const t=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});r=t.My_Result.id}this.property_id=r;const l=[this.houseKeepingService.getExposedHKSetup(this.property_id),this.roomService.fetchLanguage(this.language)];if(this.propertyid){l.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true}))}await Promise.all(l);const c=await this.houseKeepingService.getHkTasks({property_id:this.property_id,from_date:D().format("YYYY-MM-DD"),to_date:D().format("YYYY-MM-DD"),housekeepers:[],cleaning_frequency:(i=(t=x.cleaning_frequency)!==null&&t!==void 0?t:(e=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||e===void 0?void 0:e.cleaning_frequencies[0])===null||i===void 0?void 0:i.code,dusty_window:(a=(s=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||s===void 0?void 0:s.dusty_periods[0])===null||a===void 0?void 0:a.code,highlight_window:(o=(n=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||n===void 0?void 0:n.highlight_checkin_options[0])===null||o===void 0?void 0:o.code});if(c===null||c===void 0?void 0:c.tasks){this.updateTasks(c.tasks)}}catch(t){console.log(t)}finally{this.isLoading=false;zl(false)}}buildHousekeeperNameCache(){var t,e;this.hkNameCache={};(e=(t=vt.hk_criteria)===null||t===void 0?void 0:t.housekeepers)===null||e===void 0?void 0:e.forEach((t=>{if(t.id!=null&&t.name!=null){this.hkNameCache[t.id]=t.name}}))}updateTasks(t){this.buildHousekeeperNameCache();wl(t.map((t=>Object.assign(Object.assign({},t),{id:ht(),housekeeper:(()=>{var e,i,s;const a=this.hkNameCache[t.hkm_id];if(a){return a}const n=(s=(i=(e=vt.hk_criteria)===null||e===void 0?void 0:e.housekeepers)===null||i===void 0?void 0:i.find((e=>e.id===t.hkm_id)))===null||s===void 0?void 0:s.name;this.hkNameCache[t.hkm_id]=n;return n})()}))))}async handleHeaderButtonPress(t){var e;t.stopImmediatePropagation();t.stopPropagation();const{name:i}=t.detail;switch(i){case"cleaned":case"clean-inspect":(e=this.modal)===null||e===void 0?void 0:e.openModal();this.modalCauses={task:null,cause:"clean",status:i==="clean-inspect"?"004":"001"};break;case"export":const t=Array.from(this.table_sorting.entries()).map((([t,e])=>({key:t,value:e})));console.log(t);const{url:s}=await this.fetchTasksWithFilters(true);it(s);break;case"archive":this.isSidebarOpen=true;break}}handleSelectedTaskCleaningEvent(t){var e;t.stopImmediatePropagation();t.stopPropagation();this.modalCauses=Object.assign(Object.assign({},t.detail),{cause:"clean"});(e=this.modal)===null||e===void 0?void 0:e.openModal()}async handleModalConfirmation(t){var e;try{t.stopImmediatePropagation();t.stopPropagation();if(vl.selectedTasks.length===0){return}this.isCleaningLoading=true;if(((e=this.modalCauses)===null||e===void 0?void 0:e.cause)==="skip"){const{booking_nbr:t,date:e,unit:i}=this.modalCauses.task;await this.houseKeepingService.editHkSkip({BOOK_NBR:t,DATE:e,COMMENT:"",HK_SKIP_ID:-1,HK_SKIP_REASON_CODE:"001",PR_ID:i.id})}else{await this.houseKeepingService.executeHKAction({actions:vl.selectedTasks.map((t=>{var e,i;return{description:"Cleaned",hkm_id:t.hkm_id===0?null:t.hkm_id,unit_id:t.unit.id,booking_nbr:t.booking_nbr,status:(i=(e=this.modalCauses)===null||e===void 0?void 0:e.status)!==null&&i!==void 0?i:"001"}}))})}await this.fetchTasksWithFilters()}finally{Bl();if(this.modalCauses){this.modalCauses=null}this.isCleaningLoading=false;this.modal.closeModal()}}async applyFilters(t){try{this.isApplyFiltersLoading=true;t.stopImmediatePropagation();t.stopPropagation();this.filters=Object.assign({},t.detail);await this.fetchTasksWithFilters()}catch(t){console.log(t)}finally{this.isApplyFiltersLoading=false}}async fetchTasksWithFilters(t=false){var e;const{cleaning_periods:i,housekeepers:s,cleaning_frequencies:a,dusty_units:n,highlight_check_ins:o}=(e=this.filters)!==null&&e!==void 0?e:{};const{tasks:r,url:l}=await this.houseKeepingService.getHkTasks({housekeepers:s,cleaning_frequency:a===null||a===void 0?void 0:a.code,dusty_window:n===null||n===void 0?void 0:n.code,highlight_window:o===null||o===void 0?void 0:o.code,property_id:this.property_id,from_date:D().format("YYYY-MM-DD"),to_date:(i===null||i===void 0?void 0:i.code)||D().format("YYYY-MM-DD"),is_export_to_excel:t});console.log(r);if(r){this.updateTasks(r)}return{tasks:r,url:l}}render(){var t,s,a,n;if(this.isLoading){return e("ir-loading-screen",null)}return e(i,{"data-testid":"hk_tasks_base"},e("ir-toast",null),e("ir-interceptor",null),e("section",{class:"p-1 d-flex flex-column",style:{gap:"1rem"}},e("h3",null,"Housekeeping Tasks"),e("div",{class:"tasks-view ",style:{gap:"1rem"}},e("ir-tasks-filters",{isLoading:this.isApplyFiltersLoading,onApplyFilters:t=>{this.applyFilters(t)}}),e("div",{class:"d-flex w-100 flex-column",style:{gap:"1rem"}},e("ir-tasks-table",{onRowSelectChange:t=>{t.stopImmediatePropagation();t.stopPropagation();Sl(t.detail)},class:"flex-grow-1 w-100"})))),e("ir-modal",{autoClose:false,ref:t=>this.modal=t,isLoading:this.isCleaningLoading,onConfirmModal:this.handleModalConfirmation.bind(this),onCancelModal:()=>{if(this.modalCauses){Bl();this.modalCauses=null}},iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:y.entries.Lcz_Cancel,rightBtnText:y.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:"primary",modalTitle:y.entries.Lcz_Confirmation,modalBody:this.modalCauses?((t=this.modalCauses)===null||t===void 0?void 0:t.cause)==="clean"?this.modalCauses.task?`Update ${(n=(a=(s=this.modalCauses)===null||s===void 0?void 0:s.task)===null||a===void 0?void 0:a.unit)===null||n===void 0?void 0:n.name} to Clean`:"Update selected unit(s) to Clean":"Skip cleaning and reschedule for tomorrow.":"Update selected unit(s) to Clean"}),e("ir-sidebar",{open:this.isSidebarOpen,id:"editGuestInfo",onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.isSidebarOpen=false},showCloseButton:false},this.isSidebarOpen&&e("ir-hk-archive",{ticket:this.token.getToken(),propertyId:this.property_id,slot:"sidebar-body"})))}get el(){return n(this)}static get watchers(){return{ticket:["ticketChanged"]}}};Hl.style=Pl;const Ul=".icons-container.sc-ir-hk-team{display:flex;align-items:center;justify-content:end;gap:4px}.text-center.sc-ir-hk-team{text-align:center !important}.assignments-container.sc-ir-hk-team,.unassigned-container.sc-ir-hk-team{display:flex;align-items:center}.gap-16.sc-ir-hk-team{gap:16px}.unassigned-container.sc-ir-hk-team{gap:4px}.justify-between.sc-ir-hk-team{justify-content:space-between;margin-bottom:10px}.assignments-container.sc-ir-hk-team p.sc-ir-hk-team,h4.sc-ir-hk-team{margin:0}.outline-btn.sc-ir-hk-team{background:white;border:1px solid var(--blue);color:var(--blue);border-radius:5px;font-size:12px;padding:1px 0.25rem !important;margin:0}.outline-btn.sc-ir-hk-team:hover{color:white;background:var(--blue)}";const Vl=Ul;const Gl=".ir-table-row.sc-ir-hk-team td.sc-ir-hk-team{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:white;white-space:nowrap}.table.sc-ir-hk-team td.sc-ir-hk-team{border-top:0;border-bottom:1px solid #e3ebf3;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-hk-team thead.sc-ir-hk-team th.sc-ir-hk-team{border:none !important;background:#ececec;color:#374151;padding:0.5rem 1rem !important;text-align:left}.selected.sc-ir-hk-team td.sc-ir-hk-team{background:#e3f3fa !important}.selected.sc-ir-hk-team td.sc-ir-hk-team{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-hk-team,.ir-table-row.sc-ir-hk-team{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-hk-team{text-transform:capitalize}.sortable.sc-ir-hk-team:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-hk-team:hover td.sc-ir-hk-team{background:#e2e6ea3f !important}.sortable.sc-ir-hk-team:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-hk-team svg.sc-ir-hk-team{color:var(--blue)}";const Kl=Gl;var Wl=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const ql=class{constructor(e){t(this,e);this.currentTrigger=null}renderAssignedUnits(t){if(t.assigned_units.length===0){return e("span",null,"0 -"," ",e("button",{class:"outline-btn",onClick:()=>this.currentTrigger={type:"unassigned_units",user:t}},y.entries.Lcz_Assign))}return e("span",null,t.assigned_units.length," -"," ",e("button",{onClick:()=>this.currentTrigger={type:"unassigned_units",user:t},class:"outline-btn"},"Edit"))}renderCurrentTrigger(){var t;switch((t=this.currentTrigger)===null||t===void 0?void 0:t.type){case"unassigned_units":return e("ir-hk-unassigned-units",{slot:"sidebar-body",user:this.currentTrigger.user});case"user":return e("ir-hk-user",{slot:"sidebar-body",user:this.currentTrigger.user,isEdit:this.currentTrigger.isEdit});default:return null}}handleCloseSideBar(t){t.stopImmediatePropagation();t.stopPropagation();this.currentTrigger=null}handleDeletion(t){this.currentTrigger={type:"delete",user:t};this.deletionTimout=setTimeout((()=>{const t=this.el.querySelector("ir-delete-modal");if(!t)return;t.openModal()}),100)}disconnectedCallback(){clearTimeout(this.deletionTimout)}render(){var t;if(!vt.hk_criteria){return null}const{assigned:s,total:a,un_assigned:n}=vt.hk_criteria.units_assignments;return e(i,{class:"card p-1"},e("section",null,e("ir-title",{label:y.entries.Lcz_HousekeepingTeam,justifyContent:"space-between"},e("div",{slot:"title-body",class:"assignments-container gap-16 m-0"},e("p",{class:"font-weight-bold m-0 p-0"},a," ",y.entries.Lcz_TotalUnits),e("p",{class:"m-0 p-0"},s," ",e("span",null,y.entries.Lcz_Assigned)),n>0&&e("button",{class:"outline-btn",onClick:()=>this.currentTrigger={type:"unassigned_units",user:null}},n," ",y.entries.Lcz_Unassigned))),e("p",{class:"m-0 p-0"},y.entries.Lcz_AsAnOption)),e("section",{class:"mt-1 table-responsive"},e("table",{class:"table"},e("thead",null,e("tr",null,e("th",{class:"text-left"},y.entries.Lcz_Name),e("th",null,y.entries.Lcz_Mobile),e("th",null,y.entries.Lcz_Username),e("th",null,y.entries.Lcz_UnitsAssigned),e("th",null,e("ir-icon",{class:"pl-1","data-testid":"new_user",title:y.entries.Lcz_CreateHousekeeper,onIconClickHandler:()=>{this.currentTrigger={type:"user",isEdit:false,user:null}}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},e("path",{fill:"currentColor",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),e("tbody",null,vt.hk_criteria.housekeepers.map((t=>{var i;return e("tr",{key:t.id,class:"ir-table-row"},e("td",{class:"text-left"},e("div",{class:"d-flex align-items-center",style:{gap:"0.5rem"}},((i=t.name)===null||i===void 0?void 0:i.length)>25?e("ir-popover",{trigger:"hover",content:t.name},e("span",null,t.name.slice(0,25),"...")):t.name,t.note&&e("ir-popover",{content:t.note},e("ir-button",{variant:"icon",icon_name:"note","data-toggle":"tooltip","data-placement":"bottom",title:"Click to view note"})))),e("td",{class:""},t.phone_prefix," ",t.mobile),e("td",null,t.username),e("td",null,this.renderAssignedUnits(t)),e("td",{class:""},e("div",{class:"icons-container"},e("ir-icon",{"data-testid":"edit",title:y.entries.Lcz_EditHousekeeper,onIconClickHandler:()=>{const e=Wl(t,["assigned_units","is_soft_deleted","is_active"]);this.currentTrigger={type:"user",isEdit:true,user:e}},icon:"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right"},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},e("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),e("span",null," "),e("ir-icon",{"data-testid":"delete",title:y.entries.Lcz_DeleteHousekeeper,icon:"ft-trash-2 danger h5 pointer",onIconClickHandler:()=>this.handleDeletion(t)},e("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},e("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))))}))))),e("ir-sidebar",{showCloseButton:false,open:this.currentTrigger!==null&&this.currentTrigger.type!=="delete",onIrSidebarToggle:()=>this.currentTrigger=null,style:{"--sidebar-width":this.currentTrigger?this.currentTrigger.type==="unassigned_units"?"max-content":"40rem":"max-content"}},this.renderCurrentTrigger()),((t=this.currentTrigger)===null||t===void 0?void 0:t.type)==="delete"&&e("ir-delete-modal",{user:this.currentTrigger.user}))}get el(){return n(this)}};ql.style=Vl+Kl;const Xl=".sc-ir-hk-unassigned-units-h{display:block;--ir-root-active-color:#1e9ff2;--ir-root-inactive-color:#d2d2d2}table.sc-ir-hk-unassigned-units{width:100%}td.sc-ir-hk-unassigned-units{padding-top:3px;padding-bottom:3px}td.sc-ir-hk-unassigned-units:last-child{text-align:end}.title.sc-ir-hk-unassigned-units{min-width:230px !important}";const Jl=Xl;const Ql=".sc-ir-hk-unassigned-units-h{height:100%}.sheet-container.sc-ir-hk-unassigned-units{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-hk-unassigned-units{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-hk-unassigned-units{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-hk-unassigned-units{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-hk-unassigned-units{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-hk-unassigned-units{flex-direction:row;align-items:center}}";const Zl=Ql;const tc=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.resetData=s(this,"resetData",7);this.user=null;this.renderAgain=false;this.assignedUnits=new Map;this.housekeepingService=new mt}assignUnit(t,e,i){if(this.user){const s=this.user.assigned_units.find((e=>e.id===t));if(i&&s||!i&&!s){this.assignedUnits.delete(t)}else if(!i&&s){this.assignedUnits.set(t,{hkm_id:e,is_to_assign:false,unit_id:t})}else if(i){const i={hkm_id:e,is_to_assign:true,unit_id:t};this.assignedUnits.set(t,i)}}else{if(this.assignedUnits.has(t)&&!e){this.assignedUnits.delete(t);return}else{this.assignedUnits.set(t,{hkm_id:e,is_to_assign:true,unit_id:t})}}this.renderAgain=!this.renderAgain}async assignUnits(){try{await this.housekeepingService.manageExposedAssignedUnitToHKM(vt.default_properties.property_id,[...this.assignedUnits.values()]);this.resetData.emit(null)}catch(t){console.error(t)}finally{this.closeSideBar.emit(null)}}renderRooms(){var t;if(!this.user){return(t=vt.hk_criteria.units_assignments.unassigned_units)===null||t===void 0?void 0:t.map((t=>e("tr",{key:t.id},e("td",{class:""},t.name),e("td",{class:"sr-only"}),e("td",{class:"pl-1"},e("ir-select",{onSelectChange:e=>{let i=e.detail;if(i===""){i=null}else{i=+i}this.assignUnit(t.id,i,false)},data:vt.hk_criteria.housekeepers.map((t=>({text:t.name,value:t.id.toString()})))})))))}return x.roomsInfo.map((t=>{var i;console.log(t);if(!t.is_active){return null}return(i=t.physicalrooms)===null||i===void 0?void 0:i.map((t=>{var i,s,a;if(!t["is_active"]){return null}let n=!((i=vt.hk_criteria.units_assignments.unassigned_units)===null||i===void 0?void 0:i.find((e=>e.id.toString()===t.id.toString())));let o=[];const r=this.assignedUnits.get(t.id);if(r&&r.is_to_assign){o=[this.user];n=true}else{if(n){o=vt.hk_criteria.housekeepers.filter((e=>e.assigned_units.find((e=>e.id===t.id))))}}return e("tr",{key:t.id},e("td",null,t.name),e("td",null,n?(s=o[0])===null||s===void 0?void 0:s.name:""),e("td",null,e("ir-switch",{onCheckChange:e=>{const i=e.detail;this.assignUnit(t.id,this.user.id,i)},checked:n&&((a=o[0])===null||a===void 0?void 0:a.id)===this.user.id})))}))}))}render(){return e("div",{key:"c23c843cbfe48d154eed644f26934e436f5f3ed7",class:"sheet-container"},e("ir-title",{key:"4ab1942a947b59af85d7d8f10d4023dc8f6ce8e1",class:"title sheet-header px-1",displayContext:"sidebar",label:!this.user?"Assingn Units":`Assignment for ${this.user.name}`}),e("section",{key:"fbac8a9f5badf29cd7cb139e0120f44e7adb9d8c",class:"px-1 sheet-body"},e("table",{key:"220a6230d2c6e7d58d9645c6dc3c3891b70c72b7"},e("thead",{key:"eabb913d7ac9446615657aef6a75d3f1c9f7951a"},e("th",{key:"d6b02b39d98c13f2fb709540924a937391d5fdd0",class:"sr-only"},y.entries.Lcz_RoomName),e("th",{key:"c6ffd8f9ada266809a01337a489fc8fe4cb08f80",class:"sr-only"},y.entries.Lcz_HousekeeperName),e("th",{key:"b0c81ececa92fabbcba133dc83a30e7900157db2",class:"sr-only"},y.entries.Lcz_Actions)),e("tbody",{key:"f043aa72dea236a19aab0ebcc3a7ce79de8eee65"},this.renderRooms()))),e("div",{key:"6e6b54d0f71477c3269cf8cef39eddd9ec4a172b",class:"sheet-footer"},e("ir-button",{key:"aa8547627c8bbe62a645fa5ccae6b943397ffda7",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill",btn_styles:"w-100 justify-content-center align-items-center",btn_color:"secondary",text:y.entries.Lcz_Cancel}),e("ir-button",{key:"0e9f28b68172915cfbc7110c316b66503e87ebfa",isLoading:ut("/Manage_Exposed_Assigned_Unit_To_HKM"),onClickHandler:this.assignUnits.bind(this),class:"flex-fill",btn_styles:"w-100  justify-content-center align-items-center",text:y.entries.Lcz_Confirm})))}};tc.style=Jl+Zl;var ec=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};class ic{async sendVerificationEmail(){await at(400)}async checkUserExistence(t){const{data:e}=await gt.post("/CheckUserExistence",t);return e.My_Result}async handleExposedUser(t){const{base_user_type_code:e,property_id:i}=t,s=ec(t,["base_user_type_code","property_id"]);let a=Object.assign({},s);if([1,4].includes(Number(e))){a=Object.assign(Object.assign({},a),{property_id:i})}const{data:n}=await gt.post("/Handle_Exposed_User",a);console.warn("data<==>",n);return n.My_Result}async getExposedPropertyUsers({property_id:t}){const{data:e}=await gt.post("/Get_Exposed_Property_Users",{property_id:t});return e.My_Result}}const sc={PASSWORD:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()\-_=+]).{8,16}$/};const ac=".sc-ir-hk-user-h{display:block}";const nc=ac;const oc=".sc-ir-hk-user-h{height:100%}.sheet-container.sc-ir-hk-user{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-hk-user{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-hk-user{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-hk-user{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-hk-user{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-hk-user{flex-direction:row;align-items:center}}";const rc=oc;const lc=class{constructor(e){t(this,e);this.resetData=s(this,"resetData",7);this.closeSideBar=s(this,"closeSideBar",7);this.user=null;this.isEdit=false;this.isLoading=false;this.autoValidate=false;this.userInfo={id:-1,mobile:"",name:"",note:"",password:"",property_id:null,username:null,phone_prefix:null};this.errors=null;this.showPasswordValidation=false;this.housekeepingService=new mt;this.default_properties={token:"",language:""};this.housekeeperSchema=N.object({name:N.string().min(2),mobile:N.string().min(1).max(14),password:N.string().nullable().refine((t=>{var e;if(this.user&&!((e=this.userInfo)===null||e===void 0?void 0:e.password)){return true}return sc.PASSWORD.test(t)}),{message:"Password must be at least 8 characters long."}),username:N.string().min(3).refine((async t=>{if(this.user&&this.user.username===t){return true}if(t.length>=3){return!await(new ic).checkUserExistence({UserName:t})}return true}),{message:"Username already exists."})})}async componentWillLoad(){const{token:t,language:e,property_id:i}=yt();this.default_properties={token:t,language:e};if(!this.user){this.userInfo["property_id"]=i}if(this.user){this.autoValidate=true;this.userInfo=Object.assign(Object.assign({},this.user),{password:""})}}updateUserField(t,e){this.userInfo=Object.assign(Object.assign({},this.userInfo),{[t]:e})}async addUser(){try{this.isLoading=true;if(!this.autoValidate){this.autoValidate=true}const t=Object.assign(Object.assign({},this.userInfo),{password:this.user&&this.userInfo.password===""?this.user.password:this.userInfo.password});console.log("toValidateUserInfo",t);await this.housekeeperSchema.parseAsync(t);if(this.errors){this.errors=null}await this.housekeepingService.editExposedHKM(t);this.resetData.emit(null);this.closeSideBar.emit(null)}catch(t){const e={};if(t instanceof R){t.issues.map((t=>{e[t.path[0]]=true}));this.errors=e}console.error(t)}finally{this.isLoading=false}}async handleBlur(t){t.stopImmediatePropagation();t.stopPropagation();if(this.user||!this.userInfo.name){return}const e=await this.housekeepingService.generateUserName(this.userInfo.name);this.updateUserField("username",e)}render(){var t,i,s,a,n,o,r,l,c,d,h;return e("div",{key:"471e5ffe4fe98d1dd6681b8937d65e03401b4d33",class:"sheet-container"},e("ir-title",{key:"a2d78327f4423e767762d86742f2d2f99f306364",class:"px-1 sheet-header",displayContext:"sidebar",label:this.isEdit?y.entries.Lcz_EditHousekeeperProfile:y.entries.Lcz_CreateHousekeeperProfile}),e("section",{key:"2d1b5262ba7dfc0e97846cba54126618daa320f5",class:"px-1 sheet-body"},e("ir-input-text",{key:"a3e1333411faed28439e88ee9e5f6fd1cfa29ba3",testId:"name",zod:this.housekeeperSchema.pick({name:true}),wrapKey:"name",autoValidate:this.autoValidate,error:(t=this.errors)===null||t===void 0?void 0:t.name,label:y.entries.Lcz_Name,placeholder:y.entries.Lcz_Name,onTextChange:t=>this.updateUserField("name",t.detail),value:this.userInfo.name,onInputBlur:this.handleBlur.bind(this),maxLength:40}),e("ir-phone-input",{key:"87064ee001e2bc0c30785f6980eb84a867122cae",testId:"phone",placeholder:y.entries.Lcz_Mobile,error:((i=this.errors)===null||i===void 0?void 0:i.mobile)&&!((s=this.userInfo)===null||s===void 0?void 0:s.mobile),language:this.default_properties.language,token:this.default_properties.token,default_country:x.country.id,phone_prefix:(a=this.user)===null||a===void 0?void 0:a.phone_prefix,label:y.entries.Lcz_Mobile,value:this.userInfo.mobile,onTextChange:t=>{this.updateUserField("phone_prefix",t.detail.phone_prefix);this.updateUserField("mobile",t.detail.mobile)}}),e("div",{key:"6f8b69215bcb41cf1334e20f529a42e5725d2d0e",class:"mb-1"},e("ir-textarea",{key:"c8616efd30f64ab3cc7ce0e4b60e54f99a5e4437",testId:"note",variant:"prepend",maxLength:250,label:y.entries.Lcz_Note,placeholder:y.entries.Lcz_Note,value:this.userInfo.note,onTextChange:t=>this.updateUserField("note",t.detail)})),e("ir-input-text",{key:"33ee0918ecba7615ee0cebacb746a17d9379a9a3",testId:"username",zod:this.housekeeperSchema.pick({username:true}),wrapKey:"username",error:(n=this.errors)===null||n===void 0?void 0:n.username,asyncParse:true,autoValidate:this.user?((o=this.userInfo)===null||o===void 0?void 0:o.username)!==this.user.username?true:false:this.autoValidate,errorMessage:((r=this.errors)===null||r===void 0?void 0:r.username)&&((c=(l=this.userInfo)===null||l===void 0?void 0:l.username)===null||c===void 0?void 0:c.length)>=3?y.entries.Lcz_UsernameAlreadyExists:undefined,label:y.entries.Lcz_Username,placeholder:y.entries.Lcz_Username,value:this.userInfo.username,onTextChange:t=>this.updateUserField("username",t.detail)}),e("ir-input-text",{key:"bfbe2071ce4f233187fd4fd31954b78452f6843e",testId:"password",autoValidate:this.user?!((d=this.userInfo)===null||d===void 0?void 0:d.password)?false:true:this.autoValidate,label:y.entries.Lcz_Password,value:this.userInfo.password,type:"password",maxLength:16,zod:this.housekeeperSchema.pick({password:true}),wrapKey:"password",error:(h=this.errors)===null||h===void 0?void 0:h.password,onInputFocus:()=>this.showPasswordValidation=true,onInputBlur:()=>{},onTextChange:t=>this.updateUserField("password",t.detail)}),this.showPasswordValidation&&e("ir-password-validator",{key:"d166bf1524271435adc26eb9b16fd1130de8d2fa",password:this.userInfo.password})),e("div",{key:"c6b3993590f75790f16f089cd276fdf20277237a",class:"sheet-footer"},e("ir-button",{key:"5e3fd4f370e143ab2684d25ab948b49899a48137","data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill",btn_styles:"w-100  justify-content-center align-items-center",btn_color:"secondary",text:y.entries.Lcz_Cancel}),e("ir-button",{key:"3a7daa0d3b3f8d88e14f4609588c5306673153a5","data-testid":"save",isLoading:this.isLoading,onClickHandler:this.addUser.bind(this),class:"flex-fill",btn_styles:"w-100 justify-content-center align-items-center",text:y.entries.Lcz_Save})))}};lc.style=nc+rc;const cc=".sc-ir-housekeeping-h{display:block}";const dc=cc;const hc=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.language="";this.ticket="";this.isLoading=false;this.roomService=new bt;this.houseKeepingService=new mt;this.propertyService=new en;this.token=new pt}componentWillLoad(){if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}if(this.ticket!==""){this.token.setToken(this.ticket);this.initializeApp()}}async handleResetData(t){t.stopImmediatePropagation();t.stopPropagation();await this.houseKeepingService.getExposedHKSetup(this.propertyid)}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}async initializeApp(){var t;try{this.isLoading=true;let e=this.propertyid;if(!e){const t=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_sales_rate_plans:true});e=t.My_Result.id}kt("default_properties",{token:this.ticket,property_id:e,language:this.language});const i=[];if(x.housekeeping_enabled){i.push(this.houseKeepingService.getExposedHKSetup(e))}i.push(this.roomService.fetchLanguage(this.language,["_HK_FRONT","_PMS_FRONT"]));if(this.propertyid){i.push(this.roomService.getExposedProperty({id:e,language:this.language,is_backend:true,include_sales_rate_plans:true}))}await Promise.all(i);this.selectedCleaningFrequency=(t=x.cleaning_frequency)===null||t===void 0?void 0:t.code}catch(t){console.error(t)}finally{this.isLoading=false}}async saveAutomaticCheckInCheckout(t){t.stopImmediatePropagation();t.stopPropagation();try{await this.roomService.SetAutomaticCheckInOut({property_id:vt.default_properties.property_id,flag:t.detail==="auto"});this.toast.emit({position:"top-right",title:"Saved Successfully",description:"",type:"success"})}catch(t){console.log(t)}}async saveCleaningFrequency(t){t.stopImmediatePropagation();t.stopPropagation();try{await this.propertyService.setExposedCleaningFrequency({property_id:vt.default_properties.property_id,code:this.selectedCleaningFrequency});x.cleaning_frequency={code:this.selectedCleaningFrequency,description:""};this.toast.emit({position:"top-right",title:"Saved Successfully",description:"",type:"success"});this.modal.closeModal()}catch(t){console.log(t)}}render(){var t;if(this.isLoading){return e("ir-loading-screen",null)}console.log(x.cleaning_frequency);return e(i,null,e("ir-interceptor",null),e("ir-toast",null),e("section",{class:"p-1"},e("h3",{class:"mb-2"},y.entries.Lcz_HouseKeepingAndCheckInSetup),e("div",{class:"card p-1"},e("ir-title",{borderShown:true,label:"Operations Settings"}),e("div",{class:"d-flex align-items-center mb-1"},e("p",{class:"my-0 py-0 mr-1"},y.entries.Lcz_CheckInOutGuestsAutomatically),e("ir-select",{showFirstOption:false,selectedValue:x.is_automatic_check_in_out?"auto":"manual",onSelectChange:t=>this.saveAutomaticCheckInCheckout(t),data:[{text:y.entries.Lcz_YesAsPerPropertyPolicy,value:"auto"},{text:y.entries.Lcz_NoIWillDoItManually,value:"manual"}]})),e("div",{class:"d-flex align-items-center"},e("p",{class:"my-0 py-0 mr-1"},y.entries.Lcz_CleaningFrequency,":"),e("ir-select",{showFirstOption:false,selectedValue:this.selectedCleaningFrequency,onSelectChange:t=>{t.stopImmediatePropagation();t.stopPropagation();this.selectedCleaningFrequency=t.detail;this.modal.openModal()},data:(t=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||t===void 0?void 0:t.cleaning_frequencies.map((t=>({text:t.description,value:t.code})))}))),x.housekeeping_enabled&&e("ir-hk-team",{class:"mb-1"}),e("ir-modal",{autoClose:false,ref:t=>this.modal=t,isLoading:ut("/Set_Exposed_Cleaning_Frequency"),onConfirmModal:this.saveCleaningFrequency.bind(this),iconAvailable:true,onCancelModal:()=>{var t;this.selectedCleaningFrequency=(t=x.cleaning_frequency)===null||t===void 0?void 0:t.code},icon:"ft-alert-triangle danger h1",leftBtnText:y.entries.Lcz_Cancel,rightBtnText:y.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:"primary",modalTitle:y.entries.Lcz_Confirmation,modalBody:"This action will reschedule all cleaning tasks. Do you want to continue?"})))}static get watchers(){return{ticket:["ticketChanged"]}}};hc.style=dc;const uc=".sc-ir-icon-h{margin:0;padding:0}.icon-button.sc-ir-icon{all:unset;margin:0;padding:0;color:#6b6f82}.icon-button.sc-ir-icon:hover{cursor:pointer;color:#104064}";const fc=uc;const pc=class{constructor(e){t(this,e);this.iconClickHandler=s(this,"iconClickHandler",7);this.icon="ft-check";this.type="button"}render(){return e("button",{key:"2a19d813eb1fe592f68632a98fc8f51ec8d4cded",type:this.type,class:"icon-button",onClick:()=>this.iconClickHandler.emit()},e("slot",{key:"0801e1f86dc68dacc58b53dea5460ef77c65b1ce",name:"icon"}))}};pc.style=fc;const bc=".sc-ir-icons-h{display:block;box-sizing:border-box;margin:0;padding:0}.icon.sc-ir-icons{height:var(--icon-size, 1.25rem);width:var(--icon-size, 1.25rem);margin:0;padding:0}";const gc=bc;const mc=class{constructor(e){t(this,e)}render(){const t=xt[this.name]||null;if(!t){return null}return e("svg",{xmlns:"http://www.w3.org/2000/svg",color:this.color,viewBox:t.viewBox,class:`icon ${this.svgClassName}`},e("path",{fill:"currentColor",d:t.d}))}};mc.style=gc;function vc(t){return typeof t==="string"||t instanceof String}function yc(t){var e;return typeof t==="object"&&t!=null&&(t==null||(e=t.constructor)==null?void 0:e.name)==="Object"}function kc(t,e){if(Array.isArray(e))return kc(t,((t,i)=>e.includes(i)));return Object.entries(t).reduce(((t,i)=>{let[s,a]=i;if(e(a,s))t[s]=a;return t}),{})}const wc={NONE:"NONE",LEFT:"LEFT",FORCE_LEFT:"FORCE_LEFT",RIGHT:"RIGHT",FORCE_RIGHT:"FORCE_RIGHT"};function xc(t){switch(t){case wc.LEFT:return wc.FORCE_LEFT;case wc.RIGHT:return wc.FORCE_RIGHT;default:return t}}function _c(t){return t.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function Dc(t,e){if(e===t)return true;const i=Array.isArray(e),s=Array.isArray(t);let a;if(i&&s){if(e.length!=t.length)return false;for(a=0;a<e.length;a++)if(!Dc(e[a],t[a]))return false;return true}if(i!=s)return false;if(e&&t&&typeof e==="object"&&typeof t==="object"){const i=e instanceof Date,s=t instanceof Date;if(i&&s)return e.getTime()==t.getTime();if(i!=s)return false;const n=e instanceof RegExp,o=t instanceof RegExp;if(n&&o)return e.toString()==t.toString();if(n!=o)return false;const r=Object.keys(e);for(a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return false;for(a=0;a<r.length;a++)if(!Dc(t[r[a]],e[r[a]]))return false;return true}else if(e&&t&&typeof e==="function"&&typeof t==="function"){return e.toString()===t.toString()}return false}class Cc{constructor(t){Object.assign(this,t);while(this.value.slice(0,this.startChangePos)!==this.oldValue.slice(0,this.startChangePos)){--this.oldSelection.start}if(this.insertedCount){while(this.value.slice(this.cursorPos)!==this.oldValue.slice(this.oldSelection.end)){if(this.value.length-this.cursorPos<this.oldValue.length-this.oldSelection.end)++this.oldSelection.end;else++this.cursorPos}}}get startChangePos(){return Math.min(this.cursorPos,this.oldSelection.start)}get insertedCount(){return this.cursorPos-this.startChangePos}get inserted(){return this.value.substr(this.startChangePos,this.insertedCount)}get removedCount(){return Math.max(this.oldSelection.end-this.startChangePos||this.oldValue.length-this.value.length,0)}get removed(){return this.oldValue.substr(this.startChangePos,this.removedCount)}get head(){return this.value.substring(0,this.startChangePos)}get tail(){return this.value.substring(this.startChangePos+this.insertedCount)}get removeDirection(){if(!this.removedCount||this.insertedCount)return wc.NONE;return(this.oldSelection.end===this.cursorPos||this.oldSelection.start===this.cursorPos)&&this.oldSelection.end===this.oldSelection.start?wc.RIGHT:wc.LEFT}}function Oc(t,e){return new Oc.InputMask(t,e)}function Mc(t){if(t==null)throw new Error("mask property should be defined");if(t instanceof RegExp)return Oc.MaskedRegExp;if(vc(t))return Oc.MaskedPattern;if(t===Date)return Oc.MaskedDate;if(t===Number)return Oc.MaskedNumber;if(Array.isArray(t)||t===Array)return Oc.MaskedDynamic;if(Oc.Masked&&t.prototype instanceof Oc.Masked)return t;if(Oc.Masked&&t instanceof Oc.Masked)return t.constructor;if(t instanceof Function)return Oc.MaskedFunction;console.warn("Mask not found for mask",t);return Oc.Masked}function Ec(t){if(!t)throw new Error("Options in not defined");if(Oc.Masked){if(t.prototype instanceof Oc.Masked)return{mask:t};const{mask:e=undefined,...i}=t instanceof Oc.Masked?{mask:t}:yc(t)&&t.mask instanceof Oc.Masked?t:{};if(e){const t=e.mask;return{...kc(e,((t,e)=>!e.startsWith("_"))),mask:e.constructor,_mask:t,...i}}}if(!yc(t))return{mask:t};return{...t}}function Yc(t){if(Oc.Masked&&t instanceof Oc.Masked)return t;const e=Ec(t);const i=Mc(e.mask);if(!i)throw new Error("Masked class is not found for provided mask "+e.mask+", appropriate module needs to be imported manually before creating mask.");if(e.mask===i)delete e.mask;if(e._mask){e.mask=e._mask;delete e._mask}return new i(e)}Oc.createMask=Yc;class Ac{get selectionStart(){let t;try{t=this._unsafeSelectionStart}catch{}return t!=null?t:this.value.length}get selectionEnd(){let t;try{t=this._unsafeSelectionEnd}catch{}return t!=null?t:this.value.length}select(t,e){if(t==null||e==null||t===this.selectionStart&&e===this.selectionEnd)return;try{this._unsafeSelect(t,e)}catch{}}get isActive(){return false}}Oc.MaskElement=Ac;const Tc=90;const Sc=89;class Bc extends Ac{constructor(t){super();this.input=t;this._onKeydown=this._onKeydown.bind(this);this._onInput=this._onInput.bind(this);this._onBeforeinput=this._onBeforeinput.bind(this);this._onCompositionEnd=this._onCompositionEnd.bind(this)}get rootElement(){var t,e,i;return(t=(e=(i=this.input).getRootNode)==null?void 0:e.call(i))!=null?t:document}get isActive(){return this.input===this.rootElement.activeElement}bindEvents(t){this.input.addEventListener("keydown",this._onKeydown);this.input.addEventListener("input",this._onInput);this.input.addEventListener("beforeinput",this._onBeforeinput);this.input.addEventListener("compositionend",this._onCompositionEnd);this.input.addEventListener("drop",t.drop);this.input.addEventListener("click",t.click);this.input.addEventListener("focus",t.focus);this.input.addEventListener("blur",t.commit);this._handlers=t}_onKeydown(t){if(this._handlers.redo&&(t.keyCode===Tc&&t.shiftKey&&(t.metaKey||t.ctrlKey)||t.keyCode===Sc&&t.ctrlKey)){t.preventDefault();return this._handlers.redo(t)}if(this._handlers.undo&&t.keyCode===Tc&&(t.metaKey||t.ctrlKey)){t.preventDefault();return this._handlers.undo(t)}if(!t.isComposing)this._handlers.selectionChange(t)}_onBeforeinput(t){if(t.inputType==="historyUndo"&&this._handlers.undo){t.preventDefault();return this._handlers.undo(t)}if(t.inputType==="historyRedo"&&this._handlers.redo){t.preventDefault();return this._handlers.redo(t)}}_onCompositionEnd(t){this._handlers.input(t)}_onInput(t){if(!t.isComposing)this._handlers.input(t)}unbindEvents(){this.input.removeEventListener("keydown",this._onKeydown);this.input.removeEventListener("input",this._onInput);this.input.removeEventListener("beforeinput",this._onBeforeinput);this.input.removeEventListener("compositionend",this._onCompositionEnd);this.input.removeEventListener("drop",this._handlers.drop);this.input.removeEventListener("click",this._handlers.click);this.input.removeEventListener("focus",this._handlers.focus);this.input.removeEventListener("blur",this._handlers.commit);this._handlers={}}}Oc.HTMLMaskElement=Bc;class Ic extends Bc{constructor(t){super(t);this.input=t}get _unsafeSelectionStart(){return this.input.selectionStart!=null?this.input.selectionStart:this.value.length}get _unsafeSelectionEnd(){return this.input.selectionEnd}_unsafeSelect(t,e){this.input.setSelectionRange(t,e)}get value(){return this.input.value}set value(t){this.input.value=t}}Oc.HTMLMaskElement=Bc;class jc extends Bc{get _unsafeSelectionStart(){const t=this.rootElement;const e=t.getSelection&&t.getSelection();const i=e&&e.anchorOffset;const s=e&&e.focusOffset;if(s==null||i==null||i<s){return i}return s}get _unsafeSelectionEnd(){const t=this.rootElement;const e=t.getSelection&&t.getSelection();const i=e&&e.anchorOffset;const s=e&&e.focusOffset;if(s==null||i==null||i>s){return i}return s}_unsafeSelect(t,e){if(!this.rootElement.createRange)return;const i=this.rootElement.createRange();i.setStart(this.input.firstChild||this.input,t);i.setEnd(this.input.lastChild||this.input,e);const s=this.rootElement;const a=s.getSelection&&s.getSelection();if(a){a.removeAllRanges();a.addRange(i)}}get value(){return this.input.textContent||""}set value(t){this.input.textContent=t}}Oc.HTMLContenteditableMaskElement=jc;class zc{constructor(){this.states=[];this.currentIndex=0}get currentState(){return this.states[this.currentIndex]}get isEmpty(){return this.states.length===0}push(t){if(this.currentIndex<this.states.length-1)this.states.length=this.currentIndex+1;this.states.push(t);if(this.states.length>zc.MAX_LENGTH)this.states.shift();this.currentIndex=this.states.length-1}go(t){this.currentIndex=Math.min(Math.max(this.currentIndex+t,0),this.states.length-1);return this.currentState}undo(){return this.go(-1)}redo(){return this.go(+1)}clear(){this.states.length=0;this.currentIndex=0}}zc.MAX_LENGTH=100;class Nc{constructor(t,e){this.el=t instanceof Ac?t:t.isContentEditable&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"?new jc(t):new Ic(t);this.masked=Yc(e);this._listeners={};this._value="";this._unmaskedValue="";this._rawInputValue="";this.history=new zc;this._saveSelection=this._saveSelection.bind(this);this._onInput=this._onInput.bind(this);this._onChange=this._onChange.bind(this);this._onDrop=this._onDrop.bind(this);this._onFocus=this._onFocus.bind(this);this._onClick=this._onClick.bind(this);this._onUndo=this._onUndo.bind(this);this._onRedo=this._onRedo.bind(this);this.alignCursor=this.alignCursor.bind(this);this.alignCursorFriendly=this.alignCursorFriendly.bind(this);this._bindEvents();this.updateValue();this._onChange()}maskEquals(t){var e;return t==null||((e=this.masked)==null?void 0:e.maskEquals(t))}get mask(){return this.masked.mask}set mask(t){if(this.maskEquals(t))return;if(!(t instanceof Oc.Masked)&&this.masked.constructor===Mc(t)){this.masked.updateOptions({mask:t});return}const e=t instanceof Oc.Masked?t:Yc({mask:t});e.unmaskedValue=this.masked.unmaskedValue;this.masked=e}get value(){return this._value}set value(t){if(this.value===t)return;this.masked.value=t;this.updateControl("auto")}get unmaskedValue(){return this._unmaskedValue}set unmaskedValue(t){if(this.unmaskedValue===t)return;this.masked.unmaskedValue=t;this.updateControl("auto")}get rawInputValue(){return this._rawInputValue}set rawInputValue(t){if(this.rawInputValue===t)return;this.masked.rawInputValue=t;this.updateControl();this.alignCursor()}get typedValue(){return this.masked.typedValue}set typedValue(t){if(this.masked.typedValueEquals(t))return;this.masked.typedValue=t;this.updateControl("auto")}get displayValue(){return this.masked.displayValue}_bindEvents(){this.el.bindEvents({selectionChange:this._saveSelection,input:this._onInput,drop:this._onDrop,click:this._onClick,focus:this._onFocus,commit:this._onChange,undo:this._onUndo,redo:this._onRedo})}_unbindEvents(){if(this.el)this.el.unbindEvents()}_fireEvent(t,e){const i=this._listeners[t];if(!i)return;i.forEach((t=>t(e)))}get selectionStart(){return this._cursorChanging?this._changingCursorPos:this.el.selectionStart}get cursorPos(){return this._cursorChanging?this._changingCursorPos:this.el.selectionEnd}set cursorPos(t){if(!this.el||!this.el.isActive)return;this.el.select(t,t);this._saveSelection()}_saveSelection(){if(this.displayValue!==this.el.value){console.warn("Element value was changed outside of mask. Syncronize mask using `mask.updateValue()` to work properly.")}this._selection={start:this.selectionStart,end:this.cursorPos}}updateValue(){this.masked.value=this.el.value;this._value=this.masked.value;this._unmaskedValue=this.masked.unmaskedValue;this._rawInputValue=this.masked.rawInputValue}updateControl(t){const e=this.masked.unmaskedValue;const i=this.masked.value;const s=this.masked.rawInputValue;const a=this.displayValue;const n=this.unmaskedValue!==e||this.value!==i||this._rawInputValue!==s;this._unmaskedValue=e;this._value=i;this._rawInputValue=s;if(this.el.value!==a)this.el.value=a;if(t==="auto")this.alignCursor();else if(t!=null)this.cursorPos=t;if(n)this._fireChangeEvents();if(!this._historyChanging&&(n||this.history.isEmpty))this.history.push({unmaskedValue:e,selection:{start:this.selectionStart,end:this.cursorPos}})}updateOptions(t){const{mask:e,...i}=t;const s=!this.maskEquals(e);const a=this.masked.optionsIsChanged(i);if(s)this.mask=e;if(a)this.masked.updateOptions(i);if(s||a)this.updateControl()}updateCursor(t){if(t==null)return;this.cursorPos=t;this._delayUpdateCursor(t)}_delayUpdateCursor(t){this._abortUpdateCursor();this._changingCursorPos=t;this._cursorChanging=setTimeout((()=>{if(!this.el)return;this.cursorPos=this._changingCursorPos;this._abortUpdateCursor()}),10)}_fireChangeEvents(){this._fireEvent("accept",this._inputEvent);if(this.masked.isComplete)this._fireEvent("complete",this._inputEvent)}_abortUpdateCursor(){if(this._cursorChanging){clearTimeout(this._cursorChanging);delete this._cursorChanging}}alignCursor(){this.cursorPos=this.masked.nearestInputPos(this.masked.nearestInputPos(this.cursorPos,wc.LEFT))}alignCursorFriendly(){if(this.selectionStart!==this.cursorPos)return;this.alignCursor()}on(t,e){if(!this._listeners[t])this._listeners[t]=[];this._listeners[t].push(e);return this}off(t,e){if(!this._listeners[t])return this;if(!e){delete this._listeners[t];return this}const i=this._listeners[t].indexOf(e);if(i>=0)this._listeners[t].splice(i,1);return this}_onInput(t){this._inputEvent=t;this._abortUpdateCursor();const e=new Cc({value:this.el.value,cursorPos:this.cursorPos,oldValue:this.displayValue,oldSelection:this._selection});const i=this.masked.rawInputValue;const s=this.masked.splice(e.startChangePos,e.removed.length,e.inserted,e.removeDirection,{input:true,raw:true}).offset;const a=i===this.masked.rawInputValue?e.removeDirection:wc.NONE;let n=this.masked.nearestInputPos(e.startChangePos+s,a);if(a!==wc.NONE)n=this.masked.nearestInputPos(n,wc.NONE);this.updateControl(n);delete this._inputEvent}_onChange(){if(this.displayValue!==this.el.value)this.updateValue();this.masked.doCommit();this.updateControl();this._saveSelection()}_onDrop(t){t.preventDefault();t.stopPropagation()}_onFocus(t){this.alignCursorFriendly()}_onClick(t){this.alignCursorFriendly()}_onUndo(){this._applyHistoryState(this.history.undo())}_onRedo(){this._applyHistoryState(this.history.redo())}_applyHistoryState(t){if(!t)return;this._historyChanging=true;this.unmaskedValue=t.unmaskedValue;this.el.select(t.selection.start,t.selection.end);this._saveSelection();this._historyChanging=false}destroy(){this._unbindEvents();this._listeners.length=0;delete this.el}}Oc.InputMask=Nc;class Rc{static normalize(t){return Array.isArray(t)?t:[t,new Rc]}constructor(t){Object.assign(this,{inserted:"",rawInserted:"",tailShift:0,skip:false},t)}aggregate(t){this.inserted+=t.inserted;this.rawInserted+=t.rawInserted;this.tailShift+=t.tailShift;this.skip=this.skip||t.skip;return this}get offset(){return this.tailShift+this.inserted.length}get consumed(){return Boolean(this.rawInserted)||this.skip}equals(t){return this.inserted===t.inserted&&this.tailShift===t.tailShift&&this.rawInserted===t.rawInserted&&this.skip===t.skip}}Oc.ChangeDetails=Rc;class $c{constructor(t,e,i){if(t===void 0){t=""}if(e===void 0){e=0}this.value=t;this.from=e;this.stop=i}toString(){return this.value}extend(t){this.value+=String(t)}appendTo(t){return t.append(this.toString(),{tail:true}).aggregate(t._appendPlaceholder())}get state(){return{value:this.value,from:this.from,stop:this.stop}}set state(t){Object.assign(this,t)}unshift(t){if(!this.value.length||t!=null&&this.from>=t)return"";const e=this.value[0];this.value=this.value.slice(1);return e}shift(){if(!this.value.length)return"";const t=this.value[this.value.length-1];this.value=this.value.slice(0,-1);return t}}class Fc{constructor(t){this._value="";this._update({...Fc.DEFAULTS,...t});this._initialized=true}updateOptions(t){if(!this.optionsIsChanged(t))return;this.withValueRefresh(this._update.bind(this,t))}_update(t){Object.assign(this,t)}get state(){return{_value:this.value,_rawInputValue:this.rawInputValue}}set state(t){this._value=t._value}reset(){this._value=""}get value(){return this._value}set value(t){this.resolve(t,{input:true})}resolve(t,e){if(e===void 0){e={input:true}}this.reset();this.append(t,e,"");this.doCommit()}get unmaskedValue(){return this.value}set unmaskedValue(t){this.resolve(t,{})}get typedValue(){return this.parse?this.parse(this.value,this):this.unmaskedValue}set typedValue(t){if(this.format){this.value=this.format(t,this)}else{this.unmaskedValue=String(t)}}get rawInputValue(){return this.extractInput(0,this.displayValue.length,{raw:true})}set rawInputValue(t){this.resolve(t,{raw:true})}get displayValue(){return this.value}get isComplete(){return true}get isFilled(){return this.isComplete}nearestInputPos(t,e){return t}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return Math.min(this.displayValue.length,e-t)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return this.displayValue.slice(t,e)}extractTail(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}return new $c(this.extractInput(t,e),t)}appendTail(t){if(vc(t))t=new $c(String(t));return t.appendTo(this)}_appendCharRaw(t,e){if(!t)return new Rc;this._value+=t;return new Rc({inserted:t,rawInserted:t})}_appendChar(t,e,i){if(e===void 0){e={}}const s=this.state;let a;[t,a]=this.doPrepareChar(t,e);if(t){a=a.aggregate(this._appendCharRaw(t,e));if(!a.rawInserted&&this.autofix==="pad"){const i=this.state;this.state=s;let n=this.pad(e);const o=this._appendCharRaw(t,e);n=n.aggregate(o);if(o.rawInserted||n.equals(a)){a=n}else{this.state=i}}}if(a.inserted){let t;let n=this.doValidate(e)!==false;if(n&&i!=null){const e=this.state;if(this.overwrite===true){t=i.state;for(let t=0;t<a.rawInserted.length;++t){i.unshift(this.displayValue.length-a.tailShift)}}let s=this.appendTail(i);n=s.rawInserted.length===i.toString().length;if(!(n&&s.inserted)&&this.overwrite==="shift"){this.state=e;t=i.state;for(let t=0;t<a.rawInserted.length;++t){i.shift()}s=this.appendTail(i);n=s.rawInserted.length===i.toString().length}if(n&&s.inserted)this.state=e}if(!n){a=new Rc;this.state=s;if(i&&t)i.state=t}}return a}_appendPlaceholder(){return new Rc}_appendEager(){return new Rc}append(t,e,i){if(!vc(t))throw new Error("value should be string");const s=vc(i)?new $c(String(i)):i;if(e!=null&&e.tail)e._beforeTailState=this.state;let a;[t,a]=this.doPrepare(t,e);for(let i=0;i<t.length;++i){const n=this._appendChar(t[i],e,s);if(!n.rawInserted&&!this.doSkipInvalid(t[i],e,s))break;a.aggregate(n)}if((this.eager===true||this.eager==="append")&&e!=null&&e.input&&t){a.aggregate(this._appendEager())}if(s!=null){a.tailShift+=this.appendTail(s).tailShift}return a}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}this._value=this.displayValue.slice(0,t)+this.displayValue.slice(e);return new Rc}withValueRefresh(t){if(this._refreshing||!this._initialized)return t();this._refreshing=true;const e=this.rawInputValue;const i=this.value;const s=t();this.rawInputValue=e;if(this.value&&this.value!==i&&i.indexOf(this.value)===0){this.append(i.slice(this.displayValue.length),{},"");this.doCommit()}delete this._refreshing;return s}runIsolated(t){if(this._isolated||!this._initialized)return t(this);this._isolated=true;const e=this.state;const i=t(this);this.state=e;delete this._isolated;return i}doSkipInvalid(t,e,i){return Boolean(this.skipInvalid)}doPrepare(t,e){if(e===void 0){e={}}return Rc.normalize(this.prepare?this.prepare(t,this,e):t)}doPrepareChar(t,e){if(e===void 0){e={}}return Rc.normalize(this.prepareChar?this.prepareChar(t,this,e):t)}doValidate(t){return(!this.validate||this.validate(this.value,this,t))&&(!this.parent||this.parent.doValidate(t))}doCommit(){if(this.commit)this.commit(this.value,this)}splice(t,e,i,s,a){if(i===void 0){i=""}if(s===void 0){s=wc.NONE}if(a===void 0){a={input:true}}const n=t+e;const o=this.extractTail(n);const r=this.eager===true||this.eager==="remove";let l;if(r){s=xc(s);l=this.extractInput(0,n,{raw:true})}let c=t;const d=new Rc;if(s!==wc.NONE){c=this.nearestInputPos(t,e>1&&t!==0&&!r?wc.NONE:s);d.tailShift=c-t}d.aggregate(this.remove(c));if(r&&s!==wc.NONE&&l===this.rawInputValue){if(s===wc.FORCE_LEFT){let t;while(l===this.rawInputValue&&(t=this.displayValue.length)){d.aggregate(new Rc({tailShift:-1})).aggregate(this.remove(t-1))}}else if(s===wc.FORCE_RIGHT){o.unshift()}}return d.aggregate(this.append(i,a,o))}maskEquals(t){return this.mask===t}optionsIsChanged(t){return!Dc(this,t)}typedValueEquals(t){const e=this.typedValue;return t===e||Fc.EMPTY_VALUES.includes(t)&&Fc.EMPTY_VALUES.includes(e)||(this.format?this.format(t,this)===this.format(this.typedValue,this):false)}pad(t){return new Rc}}Fc.DEFAULTS={skipInvalid:true};Fc.EMPTY_VALUES=[undefined,null,""];Oc.Masked=Fc;class Lc{constructor(t,e){if(t===void 0){t=[]}if(e===void 0){e=0}this.chunks=t;this.from=e}toString(){return this.chunks.map(String).join("")}extend(t){if(!String(t))return;t=vc(t)?new $c(String(t)):t;const e=this.chunks[this.chunks.length-1];const i=e&&(e.stop===t.stop||t.stop==null)&&t.from===e.from+e.toString().length;if(t instanceof $c){if(i){e.extend(t.toString())}else{this.chunks.push(t)}}else if(t instanceof Lc){if(t.stop==null){let e;while(t.chunks.length&&t.chunks[0].stop==null){e=t.chunks.shift();e.from+=t.from;this.extend(e)}}if(t.toString()){t.stop=t.blockIndex;this.chunks.push(t)}}}appendTo(t){if(!(t instanceof Oc.MaskedPattern)){const e=new $c(this.toString());return e.appendTo(t)}const e=new Rc;for(let i=0;i<this.chunks.length;++i){const s=this.chunks[i];const a=t._mapPosToBlock(t.displayValue.length);const n=s.stop;let o;if(n!=null&&(!a||a.index<=n)){if(s instanceof Lc||t._stops.indexOf(n)>=0){e.aggregate(t._appendPlaceholder(n))}o=s instanceof Lc&&t._blocks[n]}if(o){const i=o.appendTail(s);e.aggregate(i);const a=s.toString().slice(i.rawInserted.length);if(a)e.aggregate(t.append(a,{tail:true}))}else{e.aggregate(t.append(s.toString(),{tail:true}))}}return e}get state(){return{chunks:this.chunks.map((t=>t.state)),from:this.from,stop:this.stop,blockIndex:this.blockIndex}}set state(t){const{chunks:e,...i}=t;Object.assign(this,i);this.chunks=e.map((t=>{const e="chunks"in t?new Lc:new $c;e.state=t;return e}))}unshift(t){if(!this.chunks.length||t!=null&&this.from>=t)return"";const e=t!=null?t-this.from:t;let i=0;while(i<this.chunks.length){const t=this.chunks[i];const s=t.unshift(e);if(t.toString()){if(!s)break;++i}else{this.chunks.splice(i,1)}if(s)return s}return""}shift(){if(!this.chunks.length)return"";let t=this.chunks.length-1;while(0<=t){const e=this.chunks[t];const i=e.shift();if(e.toString()){if(!i)break;--t}else{this.chunks.splice(t,1)}if(i)return i}return""}}class Pc{constructor(t,e){this.masked=t;this._log=[];const{offset:i,index:s}=t._mapPosToBlock(e)||(e<0?{index:0,offset:0}:{index:this.masked._blocks.length,offset:0});this.offset=i;this.index=s;this.ok=false}get block(){return this.masked._blocks[this.index]}get pos(){return this.masked._blockStartPos(this.index)+this.offset}get state(){return{index:this.index,offset:this.offset,ok:this.ok}}set state(t){Object.assign(this,t)}pushState(){this._log.push(this.state)}popState(){const t=this._log.pop();if(t)this.state=t;return t}bindBlock(){if(this.block)return;if(this.index<0){this.index=0;this.offset=0}if(this.index>=this.masked._blocks.length){this.index=this.masked._blocks.length-1;this.offset=this.block.displayValue.length}}_pushLeft(t){this.pushState();for(this.bindBlock();0<=this.index;--this.index,this.offset=((e=this.block)==null?void 0:e.displayValue.length)||0){var e;if(t())return this.ok=true}return this.ok=false}_pushRight(t){this.pushState();for(this.bindBlock();this.index<this.masked._blocks.length;++this.index,this.offset=0){if(t())return this.ok=true}return this.ok=false}pushLeftBeforeFilled(){return this._pushLeft((()=>{if(this.block.isFixed||!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,wc.FORCE_LEFT);if(this.offset!==0)return true}))}pushLeftBeforeInput(){return this._pushLeft((()=>{if(this.block.isFixed)return;this.offset=this.block.nearestInputPos(this.offset,wc.LEFT);return true}))}pushLeftBeforeRequired(){return this._pushLeft((()=>{if(this.block.isFixed||this.block.isOptional&&!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,wc.LEFT);return true}))}pushRightBeforeFilled(){return this._pushRight((()=>{if(this.block.isFixed||!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,wc.FORCE_RIGHT);if(this.offset!==this.block.value.length)return true}))}pushRightBeforeInput(){return this._pushRight((()=>{if(this.block.isFixed)return;this.offset=this.block.nearestInputPos(this.offset,wc.NONE);return true}))}pushRightBeforeRequired(){return this._pushRight((()=>{if(this.block.isFixed||this.block.isOptional&&!this.block.value)return;this.offset=this.block.nearestInputPos(this.offset,wc.NONE);return true}))}}class Hc{constructor(t){Object.assign(this,t);this._value="";this.isFixed=true}get value(){return this._value}get unmaskedValue(){return this.isUnmasking?this.value:""}get rawInputValue(){return this._isRawInput?this.value:""}get displayValue(){return this.value}reset(){this._isRawInput=false;this._value=""}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this._value.length}this._value=this._value.slice(0,t)+this._value.slice(e);if(!this._value)this._isRawInput=false;return new Rc}nearestInputPos(t,e){if(e===void 0){e=wc.NONE}const i=0;const s=this._value.length;switch(e){case wc.LEFT:case wc.FORCE_LEFT:return i;case wc.NONE:case wc.RIGHT:case wc.FORCE_RIGHT:default:return s}}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this._value.length}return this._isRawInput?e-t:0}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this._value.length}if(i===void 0){i={}}return i.raw&&this._isRawInput&&this._value.slice(t,e)||""}get isComplete(){return true}get isFilled(){return Boolean(this._value)}_appendChar(t,e){if(e===void 0){e={}}if(this.isFilled)return new Rc;const i=this.eager===true||this.eager==="append";const s=this.char===t;const a=s&&(this.isUnmasking||e.input||e.raw)&&(!e.raw||!i)&&!e.tail;const n=new Rc({inserted:this.char,rawInserted:a?this.char:""});this._value=this.char;this._isRawInput=a&&(e.raw||e.input);return n}_appendEager(){return this._appendChar(this.char,{tail:true})}_appendPlaceholder(){const t=new Rc;if(this.isFilled)return t;this._value=t.inserted=this.char;return t}extractTail(){return new $c("")}appendTail(t){if(vc(t))t=new $c(String(t));return t.appendTo(this)}append(t,e,i){const s=this._appendChar(t[0],e);if(i!=null){s.tailShift+=this.appendTail(i).tailShift}return s}doCommit(){}get state(){return{_value:this._value,_rawInputValue:this.rawInputValue}}set state(t){this._value=t._value;this._isRawInput=Boolean(t._rawInputValue)}pad(t){return this._appendPlaceholder()}}class Uc{constructor(t){const{parent:e,isOptional:i,placeholderChar:s,displayChar:a,lazy:n,eager:o,...r}=t;this.masked=Yc(r);Object.assign(this,{parent:e,isOptional:i,placeholderChar:s,displayChar:a,lazy:n,eager:o})}reset(){this.isFilled=false;this.masked.reset()}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.value.length}if(t===0&&e>=1){this.isFilled=false;return this.masked.remove(t,e)}return new Rc}get value(){return this.masked.value||(this.isFilled&&!this.isOptional?this.placeholderChar:"")}get unmaskedValue(){return this.masked.unmaskedValue}get rawInputValue(){return this.masked.rawInputValue}get displayValue(){return this.masked.value&&this.displayChar||this.value}get isComplete(){return Boolean(this.masked.value)||this.isOptional}_appendChar(t,e){if(e===void 0){e={}}if(this.isFilled)return new Rc;const i=this.masked.state;let s=this.masked._appendChar(t,this.currentMaskFlags(e));if(s.inserted&&this.doValidate(e)===false){s=new Rc;this.masked.state=i}if(!s.inserted&&!this.isOptional&&!this.lazy&&!e.input){s.inserted=this.placeholderChar}s.skip=!s.inserted&&!this.isOptional;this.isFilled=Boolean(s.inserted);return s}append(t,e,i){return this.masked.append(t,this.currentMaskFlags(e),i)}_appendPlaceholder(){if(this.isFilled||this.isOptional)return new Rc;this.isFilled=true;return new Rc({inserted:this.placeholderChar})}_appendEager(){return new Rc}extractTail(t,e){return this.masked.extractTail(t,e)}appendTail(t){return this.masked.appendTail(t)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.value.length}return this.masked.extractInput(t,e,i)}nearestInputPos(t,e){if(e===void 0){e=wc.NONE}const i=0;const s=this.value.length;const a=Math.min(Math.max(t,i),s);switch(e){case wc.LEFT:case wc.FORCE_LEFT:return this.isComplete?a:i;case wc.RIGHT:case wc.FORCE_RIGHT:return this.isComplete?a:s;case wc.NONE:default:return a}}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.value.length}return this.value.slice(t,e).length}doValidate(t){return this.masked.doValidate(this.currentMaskFlags(t))&&(!this.parent||this.parent.doValidate(this.currentMaskFlags(t)))}doCommit(){this.masked.doCommit()}get state(){return{_value:this.value,_rawInputValue:this.rawInputValue,masked:this.masked.state,isFilled:this.isFilled}}set state(t){this.masked.state=t.masked;this.isFilled=t.isFilled}currentMaskFlags(t){var e;return{...t,_beforeTailState:(t==null||(e=t._beforeTailState)==null?void 0:e.masked)||(t==null?void 0:t._beforeTailState)}}pad(t){return new Rc}}Uc.DEFAULT_DEFINITIONS={0:/\d/,a:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./};class Vc extends Fc{updateOptions(t){super.updateOptions(t)}_update(t){const e=t.mask;if(e)t.validate=t=>t.search(e)>=0;super._update(t)}}Oc.MaskedRegExp=Vc;class Gc extends Fc{constructor(t){super({...Gc.DEFAULTS,...t,definitions:Object.assign({},Uc.DEFAULT_DEFINITIONS,t==null?void 0:t.definitions)})}updateOptions(t){super.updateOptions(t)}_update(t){t.definitions=Object.assign({},this.definitions,t.definitions);super._update(t);this._rebuildMask()}_rebuildMask(){const t=this.definitions;this._blocks=[];this.exposeBlock=undefined;this._stops=[];this._maskedBlocks={};const e=this.mask;if(!e||!t)return;let i=false;let s=false;for(let a=0;a<e.length;++a){if(this.blocks){const t=e.slice(a);const i=Object.keys(this.blocks).filter((e=>t.indexOf(e)===0));i.sort(((t,e)=>e.length-t.length));const s=i[0];if(s){const{expose:t,repeat:e,...i}=Ec(this.blocks[s]);const n={lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar,overwrite:this.overwrite,autofix:this.autofix,...i,repeat:e,parent:this};const o=e!=null?new Oc.RepeatBlock(n):Yc(n);if(o){this._blocks.push(o);if(t)this.exposeBlock=o;if(!this._maskedBlocks[s])this._maskedBlocks[s]=[];this._maskedBlocks[s].push(this._blocks.length-1)}a+=s.length-1;continue}}let n=e[a];let o=n in t;if(n===Gc.STOP_CHAR){this._stops.push(this._blocks.length);continue}if(n==="{"||n==="}"){i=!i;continue}if(n==="["||n==="]"){s=!s;continue}if(n===Gc.ESCAPE_CHAR){++a;n=e[a];if(!n)break;o=false}const r=o?new Uc({isOptional:s,lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar,...Ec(t[n]),parent:this}):new Hc({char:n,eager:this.eager,isUnmasking:i});this._blocks.push(r)}}get state(){return{...super.state,_blocks:this._blocks.map((t=>t.state))}}set state(t){if(!t){this.reset();return}const{_blocks:e,...i}=t;this._blocks.forEach(((t,i)=>t.state=e[i]));super.state=i}reset(){super.reset();this._blocks.forEach((t=>t.reset()))}get isComplete(){return this.exposeBlock?this.exposeBlock.isComplete:this._blocks.every((t=>t.isComplete))}get isFilled(){return this._blocks.every((t=>t.isFilled))}get isFixed(){return this._blocks.every((t=>t.isFixed))}get isOptional(){return this._blocks.every((t=>t.isOptional))}doCommit(){this._blocks.forEach((t=>t.doCommit()));super.doCommit()}get unmaskedValue(){return this.exposeBlock?this.exposeBlock.unmaskedValue:this._blocks.reduce(((t,e)=>t+=e.unmaskedValue),"")}set unmaskedValue(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.unmaskedValue=t;this.appendTail(e);this.doCommit()}else super.unmaskedValue=t}get value(){return this.exposeBlock?this.exposeBlock.value:this._blocks.reduce(((t,e)=>t+=e.value),"")}set value(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.value=t;this.appendTail(e);this.doCommit()}else super.value=t}get typedValue(){return this.exposeBlock?this.exposeBlock.typedValue:super.typedValue}set typedValue(t){if(this.exposeBlock){const e=this.extractTail(this._blockStartPos(this._blocks.indexOf(this.exposeBlock))+this.exposeBlock.displayValue.length);this.exposeBlock.typedValue=t;this.appendTail(e);this.doCommit()}else super.typedValue=t}get displayValue(){return this._blocks.reduce(((t,e)=>t+=e.displayValue),"")}appendTail(t){return super.appendTail(t).aggregate(this._appendPlaceholder())}_appendEager(){var t;const e=new Rc;let i=(t=this._mapPosToBlock(this.displayValue.length))==null?void 0:t.index;if(i==null)return e;if(this._blocks[i].isFilled)++i;for(let t=i;t<this._blocks.length;++t){const i=this._blocks[t]._appendEager();if(!i.inserted)break;e.aggregate(i)}return e}_appendCharRaw(t,e){if(e===void 0){e={}}const i=this._mapPosToBlock(this.displayValue.length);const s=new Rc;if(!i)return s;for(let n=i.index,o;o=this._blocks[n];++n){var a;const i=o._appendChar(t,{...e,_beforeTailState:(a=e._beforeTailState)==null||(a=a._blocks)==null?void 0:a[n]});s.aggregate(i);if(i.consumed)break}return s}extractTail(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=new Lc;if(t===e)return i;this._forEachBlocksInRange(t,e,((t,e,s,a)=>{const n=t.extractTail(s,a);n.stop=this._findStopBefore(e);n.from=this._blockStartPos(e);if(n instanceof Lc)n.blockIndex=e;i.extend(n)}));return i}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}if(i===void 0){i={}}if(t===e)return"";let s="";this._forEachBlocksInRange(t,e,((t,e,a,n)=>{s+=t.extractInput(a,n,i)}));return s}_findStopBefore(t){let e;for(let i=0;i<this._stops.length;++i){const s=this._stops[i];if(s<=t)e=s;else break}return e}_appendPlaceholder(t){const e=new Rc;if(this.lazy&&t==null)return e;const i=this._mapPosToBlock(this.displayValue.length);if(!i)return e;const s=i.index;const a=t!=null?t:this._blocks.length;this._blocks.slice(s,a).forEach((i=>{if(!i.lazy||t!=null){var s;e.aggregate(i._appendPlaceholder((s=i._blocks)==null?void 0:s.length))}}));return e}_mapPosToBlock(t){let e="";for(let i=0;i<this._blocks.length;++i){const s=this._blocks[i];const a=e.length;e+=s.displayValue;if(t<=e.length){return{index:i,offset:t-a}}}}_blockStartPos(t){return this._blocks.slice(0,t).reduce(((t,e)=>t+=e.displayValue.length),0)}_forEachBlocksInRange(t,e,i){if(e===void 0){e=this.displayValue.length}const s=this._mapPosToBlock(t);if(s){const t=this._mapPosToBlock(e);const a=t&&s.index===t.index;const n=s.offset;const o=t&&a?t.offset:this._blocks[s.index].displayValue.length;i(this._blocks[s.index],s.index,n,o);if(t&&!a){for(let e=s.index+1;e<t.index;++e){i(this._blocks[e],e,0,this._blocks[e].displayValue.length)}i(this._blocks[t.index],t.index,0,t.offset)}}}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=super.remove(t,e);this._forEachBlocksInRange(t,e,((t,e,s,a)=>{i.aggregate(t.remove(s,a))}));return i}nearestInputPos(t,e){if(e===void 0){e=wc.NONE}if(!this._blocks.length)return 0;const i=new Pc(this,t);if(e===wc.NONE){if(i.pushRightBeforeInput())return i.pos;i.popState();if(i.pushLeftBeforeInput())return i.pos;return this.displayValue.length}if(e===wc.LEFT||e===wc.FORCE_LEFT){if(e===wc.LEFT){i.pushRightBeforeFilled();if(i.ok&&i.pos===t)return t;i.popState()}i.pushLeftBeforeInput();i.pushLeftBeforeRequired();i.pushLeftBeforeFilled();if(e===wc.LEFT){i.pushRightBeforeInput();i.pushRightBeforeRequired();if(i.ok&&i.pos<=t)return i.pos;i.popState();if(i.ok&&i.pos<=t)return i.pos;i.popState()}if(i.ok)return i.pos;if(e===wc.FORCE_LEFT)return 0;i.popState();if(i.ok)return i.pos;i.popState();if(i.ok)return i.pos;return 0}if(e===wc.RIGHT||e===wc.FORCE_RIGHT){i.pushRightBeforeInput();i.pushRightBeforeRequired();if(i.pushRightBeforeFilled())return i.pos;if(e===wc.FORCE_RIGHT)return this.displayValue.length;i.popState();if(i.ok)return i.pos;i.popState();if(i.ok)return i.pos;return this.nearestInputPos(t,wc.LEFT)}return t}totalInputPositions(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}let i=0;this._forEachBlocksInRange(t,e,((t,e,s,a)=>{i+=t.totalInputPositions(s,a)}));return i}maskedBlock(t){return this.maskedBlocks(t)[0]}maskedBlocks(t){const e=this._maskedBlocks[t];if(!e)return[];return e.map((t=>this._blocks[t]))}pad(t){const e=new Rc;this._forEachBlocksInRange(0,this.displayValue.length,(i=>e.aggregate(i.pad(t))));return e}}Gc.DEFAULTS={...Fc.DEFAULTS,lazy:true,placeholderChar:"_"};Gc.STOP_CHAR="`";Gc.ESCAPE_CHAR="\\";Gc.InputDefinition=Uc;Gc.FixedDefinition=Hc;Oc.MaskedPattern=Gc;class Kc extends Gc{get _matchFrom(){return this.maxLength-String(this.from).length}constructor(t){super(t)}updateOptions(t){super.updateOptions(t)}_update(t){const{to:e=this.to||0,from:i=this.from||0,maxLength:s=this.maxLength||0,autofix:a=this.autofix,...n}=t;this.to=e;this.from=i;this.maxLength=Math.max(String(e).length,s);this.autofix=a;const o=String(this.from).padStart(this.maxLength,"0");const r=String(this.to).padStart(this.maxLength,"0");let l=0;while(l<r.length&&r[l]===o[l])++l;n.mask=r.slice(0,l).replace(/0/g,"\\0")+"0".repeat(this.maxLength-l);super._update(n)}get isComplete(){return super.isComplete&&Boolean(this.value)}boundaries(t){let e="";let i="";const[,s,a]=t.match(/^(\D*)(\d*)(\D*)/)||[];if(a){e="0".repeat(s.length)+a;i="9".repeat(s.length)+a}e=e.padEnd(this.maxLength,"0");i=i.padEnd(this.maxLength,"9");return[e,i]}doPrepareChar(t,e){if(e===void 0){e={}}let i;[t,i]=super.doPrepareChar(t.replace(/\D/g,""),e);if(!t)i.skip=!this.isComplete;return[t,i]}_appendCharRaw(t,e){if(e===void 0){e={}}if(!this.autofix||this.value.length+1>this.maxLength)return super._appendCharRaw(t,e);const i=String(this.from).padStart(this.maxLength,"0");const s=String(this.to).padStart(this.maxLength,"0");const[a,n]=this.boundaries(this.value+t);if(Number(n)<this.from)return super._appendCharRaw(i[this.value.length],e);if(Number(a)>this.to){if(!e.tail&&this.autofix==="pad"&&this.value.length+1<this.maxLength){return super._appendCharRaw(i[this.value.length],e).aggregate(this._appendCharRaw(t,e))}return super._appendCharRaw(s[this.value.length],e)}return super._appendCharRaw(t,e)}doValidate(t){const e=this.value;const i=e.search(/[^0]/);if(i===-1&&e.length<=this._matchFrom)return true;const[s,a]=this.boundaries(e);return this.from<=Number(a)&&Number(s)<=this.to&&super.doValidate(t)}pad(t){const e=new Rc;if(this.value.length===this.maxLength)return e;const i=this.value;const s=this.maxLength-this.value.length;if(s){this.reset();for(let i=0;i<s;++i){e.aggregate(super._appendCharRaw("0",t))}i.split("").forEach((t=>this._appendCharRaw(t)))}return e}}Oc.MaskedRange=Kc;const Wc="d{.}`m{.}`Y";class qc extends Gc{static extractPatternOptions(t){const{mask:e,pattern:i,...s}=t;return{...s,mask:vc(e)?e:i}}constructor(t){super(qc.extractPatternOptions({...qc.DEFAULTS,...t}))}updateOptions(t){super.updateOptions(t)}_update(t){const{mask:e,pattern:i,blocks:s,...a}={...qc.DEFAULTS,...t};const n=Object.assign({},qc.GET_DEFAULT_BLOCKS());if(t.min)n.Y.from=t.min.getFullYear();if(t.max)n.Y.to=t.max.getFullYear();if(t.min&&t.max&&n.Y.from===n.Y.to){n.m.from=t.min.getMonth()+1;n.m.to=t.max.getMonth()+1;if(n.m.from===n.m.to){n.d.from=t.min.getDate();n.d.to=t.max.getDate()}}Object.assign(n,this.blocks,s);super._update({...a,mask:vc(e)?e:i,blocks:n})}doValidate(t){const e=this.date;return super.doValidate(t)&&(!this.isComplete||this.isDateExist(this.value)&&e!=null&&(this.min==null||this.min<=e)&&(this.max==null||e<=this.max))}isDateExist(t){return this.format(this.parse(t,this),this).indexOf(t)>=0}get date(){return this.typedValue}set date(t){this.typedValue=t}get typedValue(){return this.isComplete?super.typedValue:null}set typedValue(t){super.typedValue=t}maskEquals(t){return t===Date||super.maskEquals(t)}optionsIsChanged(t){return super.optionsIsChanged(qc.extractPatternOptions(t))}}qc.GET_DEFAULT_BLOCKS=()=>({d:{mask:Kc,from:1,to:31,maxLength:2},m:{mask:Kc,from:1,to:12,maxLength:2},Y:{mask:Kc,from:1900,to:9999}});qc.DEFAULTS={...Gc.DEFAULTS,mask:Date,pattern:Wc,format:(t,e)=>{if(!t)return"";const i=String(t.getDate()).padStart(2,"0");const s=String(t.getMonth()+1).padStart(2,"0");const a=t.getFullYear();return[i,s,a].join(".")},parse:(t,e)=>{const[i,s,a]=t.split(".").map(Number);return new Date(a,s-1,i)}};Oc.MaskedDate=qc;class Xc extends Fc{constructor(t){super({...Xc.DEFAULTS,...t});this.currentMask=undefined}updateOptions(t){super.updateOptions(t)}_update(t){super._update(t);if("mask"in t){this.exposeMask=undefined;this.compiledMasks=Array.isArray(t.mask)?t.mask.map((t=>{const{expose:e,...i}=Ec(t);const s=Yc({overwrite:this._overwrite,eager:this._eager,skipInvalid:this._skipInvalid,...i});if(e)this.exposeMask=s;return s})):[]}}_appendCharRaw(t,e){if(e===void 0){e={}}const i=this._applyDispatch(t,e);if(this.currentMask){i.aggregate(this.currentMask._appendChar(t,this.currentMaskFlags(e)))}return i}_applyDispatch(t,e,i){if(t===void 0){t=""}if(e===void 0){e={}}if(i===void 0){i=""}const s=e.tail&&e._beforeTailState!=null?e._beforeTailState._value:this.value;const a=this.rawInputValue;const n=e.tail&&e._beforeTailState!=null?e._beforeTailState._rawInputValue:a;const o=a.slice(n.length);const r=this.currentMask;const l=new Rc;const c=r==null?void 0:r.state;this.currentMask=this.doDispatch(t,{...e},i);if(this.currentMask){if(this.currentMask!==r){this.currentMask.reset();if(n){this.currentMask.append(n,{raw:true});l.tailShift=this.currentMask.value.length-s.length}if(o){l.tailShift+=this.currentMask.append(o,{raw:true,tail:true}).tailShift}}else if(c){this.currentMask.state=c}}return l}_appendPlaceholder(){const t=this._applyDispatch();if(this.currentMask){t.aggregate(this.currentMask._appendPlaceholder())}return t}_appendEager(){const t=this._applyDispatch();if(this.currentMask){t.aggregate(this.currentMask._appendEager())}return t}appendTail(t){const e=new Rc;if(t)e.aggregate(this._applyDispatch("",{},t));return e.aggregate(this.currentMask?this.currentMask.appendTail(t):super.appendTail(t))}currentMaskFlags(t){var e,i;return{...t,_beforeTailState:((e=t._beforeTailState)==null?void 0:e.currentMaskRef)===this.currentMask&&((i=t._beforeTailState)==null?void 0:i.currentMask)||t._beforeTailState}}doDispatch(t,e,i){if(e===void 0){e={}}if(i===void 0){i=""}return this.dispatch(t,this,e,i)}doValidate(t){return super.doValidate(t)&&(!this.currentMask||this.currentMask.doValidate(this.currentMaskFlags(t)))}doPrepare(t,e){if(e===void 0){e={}}let[i,s]=super.doPrepare(t,e);if(this.currentMask){let t;[i,t]=super.doPrepare(i,this.currentMaskFlags(e));s=s.aggregate(t)}return[i,s]}doPrepareChar(t,e){if(e===void 0){e={}}let[i,s]=super.doPrepareChar(t,e);if(this.currentMask){let t;[i,t]=super.doPrepareChar(i,this.currentMaskFlags(e));s=s.aggregate(t)}return[i,s]}reset(){var t;(t=this.currentMask)==null||t.reset();this.compiledMasks.forEach((t=>t.reset()))}get value(){return this.exposeMask?this.exposeMask.value:this.currentMask?this.currentMask.value:""}set value(t){if(this.exposeMask){this.exposeMask.value=t;this.currentMask=this.exposeMask;this._applyDispatch()}else super.value=t}get unmaskedValue(){return this.exposeMask?this.exposeMask.unmaskedValue:this.currentMask?this.currentMask.unmaskedValue:""}set unmaskedValue(t){if(this.exposeMask){this.exposeMask.unmaskedValue=t;this.currentMask=this.exposeMask;this._applyDispatch()}else super.unmaskedValue=t}get typedValue(){return this.exposeMask?this.exposeMask.typedValue:this.currentMask?this.currentMask.typedValue:""}set typedValue(t){if(this.exposeMask){this.exposeMask.typedValue=t;this.currentMask=this.exposeMask;this._applyDispatch();return}let e=String(t);if(this.currentMask){this.currentMask.typedValue=t;e=this.currentMask.unmaskedValue}this.unmaskedValue=e}get displayValue(){return this.currentMask?this.currentMask.displayValue:""}get isComplete(){var t;return Boolean((t=this.currentMask)==null?void 0:t.isComplete)}get isFilled(){var t;return Boolean((t=this.currentMask)==null?void 0:t.isFilled)}remove(t,e){const i=new Rc;if(this.currentMask){i.aggregate(this.currentMask.remove(t,e)).aggregate(this._applyDispatch())}return i}get state(){var t;return{...super.state,_rawInputValue:this.rawInputValue,compiledMasks:this.compiledMasks.map((t=>t.state)),currentMaskRef:this.currentMask,currentMask:(t=this.currentMask)==null?void 0:t.state}}set state(t){const{compiledMasks:e,currentMaskRef:i,currentMask:s,...a}=t;if(e)this.compiledMasks.forEach(((t,i)=>t.state=e[i]));if(i!=null){this.currentMask=i;this.currentMask.state=s}super.state=a}extractInput(t,e,i){return this.currentMask?this.currentMask.extractInput(t,e,i):""}extractTail(t,e){return this.currentMask?this.currentMask.extractTail(t,e):super.extractTail(t,e)}doCommit(){if(this.currentMask)this.currentMask.doCommit();super.doCommit()}nearestInputPos(t,e){return this.currentMask?this.currentMask.nearestInputPos(t,e):super.nearestInputPos(t,e)}get overwrite(){return this.currentMask?this.currentMask.overwrite:this._overwrite}set overwrite(t){this._overwrite=t}get eager(){return this.currentMask?this.currentMask.eager:this._eager}set eager(t){this._eager=t}get skipInvalid(){return this.currentMask?this.currentMask.skipInvalid:this._skipInvalid}set skipInvalid(t){this._skipInvalid=t}get autofix(){return this.currentMask?this.currentMask.autofix:this._autofix}set autofix(t){this._autofix=t}maskEquals(t){return Array.isArray(t)?this.compiledMasks.every(((e,i)=>{if(!t[i])return;const{mask:s,...a}=t[i];return Dc(e,a)&&e.maskEquals(s)})):super.maskEquals(t)}typedValueEquals(t){var e;return Boolean((e=this.currentMask)==null?void 0:e.typedValueEquals(t))}}Xc.DEFAULTS={...Fc.DEFAULTS,dispatch:(t,e,i,s)=>{if(!e.compiledMasks.length)return;const a=e.rawInputValue;const n=e.compiledMasks.map(((n,o)=>{const r=e.currentMask===n;const l=r?n.displayValue.length:n.nearestInputPos(n.displayValue.length,wc.FORCE_LEFT);if(n.rawInputValue!==a){n.reset();n.append(a,{raw:true})}else if(!r){n.remove(l)}n.append(t,e.currentMaskFlags(i));n.appendTail(s);return{index:o,weight:n.rawInputValue.length,totalInputPositions:n.totalInputPositions(0,Math.max(l,n.nearestInputPos(n.displayValue.length,wc.FORCE_LEFT)))}}));n.sort(((t,e)=>e.weight-t.weight||e.totalInputPositions-t.totalInputPositions));return e.compiledMasks[n[0].index]}};Oc.MaskedDynamic=Xc;class Jc extends Gc{constructor(t){super({...Jc.DEFAULTS,...t})}updateOptions(t){super.updateOptions(t)}_update(t){const{enum:e,...i}=t;if(e){const t=e.map((t=>t.length));const s=Math.min(...t);const a=Math.max(...t)-s;i.mask="*".repeat(s);if(a)i.mask+="["+"*".repeat(a)+"]";this.enum=e}super._update(i)}_appendCharRaw(t,e){if(e===void 0){e={}}const i=Math.min(this.nearestInputPos(0,wc.FORCE_RIGHT),this.value.length);const s=this.enum.filter((e=>this.matchValue(e,this.unmaskedValue+t,i)));if(s.length){if(s.length===1){this._forEachBlocksInRange(0,this.value.length,((t,i)=>{const a=s[0][i];if(i>=this.value.length||a===t.value)return;t.reset();t._appendChar(a,e)}))}const t=super._appendCharRaw(s[0][this.value.length],e);if(s.length===1){s[0].slice(this.unmaskedValue.length).split("").forEach((e=>t.aggregate(super._appendCharRaw(e))))}return t}return new Rc({skip:!this.isComplete})}extractTail(t,e){if(t===void 0){t=0}return new $c("",t)}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}if(t===e)return new Rc;const i=Math.min(super.nearestInputPos(0,wc.FORCE_RIGHT),this.value.length);let s;for(s=t;s>=0;--s){const t=this.enum.filter((t=>this.matchValue(t,this.value.slice(i,s),i)));if(t.length>1)break}const a=super.remove(s,e);a.tailShift+=s-t;return a}get isComplete(){return this.enum.indexOf(this.value)>=0}}Jc.DEFAULTS={...Gc.DEFAULTS,matchValue:(t,e,i)=>t.indexOf(e,i)===i};Oc.MaskedEnum=Jc;class Qc extends Fc{updateOptions(t){super.updateOptions(t)}_update(t){super._update({...t,validate:t.mask})}}Oc.MaskedFunction=Qc;var Zc;class td extends Fc{constructor(t){super({...td.DEFAULTS,...t})}updateOptions(t){super.updateOptions(t)}_update(t){super._update(t);this._updateRegExps()}_updateRegExps(){const t="^"+(this.allowNegative?"[+|\\-]?":"");const e="\\d*";const i=(this.scale?"("+_c(this.radix)+"\\d{0,"+this.scale+"})?":"")+"$";this._numberRegExp=new RegExp(t+e+i);this._mapToRadixRegExp=new RegExp("["+this.mapToRadix.map(_c).join("")+"]","g");this._thousandsSeparatorRegExp=new RegExp(_c(this.thousandsSeparator),"g")}_removeThousandsSeparators(t){return t.replace(this._thousandsSeparatorRegExp,"")}_insertThousandsSeparators(t){const e=t.split(this.radix);e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,this.thousandsSeparator);return e.join(this.radix)}doPrepareChar(t,e){if(e===void 0){e={}}const[i,s]=super.doPrepareChar(this._removeThousandsSeparators(this.scale&&this.mapToRadix.length&&(e.input&&e.raw||!e.input&&!e.raw)?t.replace(this._mapToRadixRegExp,this.radix):t),e);if(t&&!i)s.skip=true;if(i&&!this.allowPositive&&!this.value&&i!=="-")s.aggregate(this._appendChar("-"));return[i,s]}_separatorsCount(t,e){if(e===void 0){e=false}let i=0;for(let s=0;s<t;++s){if(this._value.indexOf(this.thousandsSeparator,s)===s){++i;if(e)t+=this.thousandsSeparator.length}}return i}_separatorsCountFromSlice(t){if(t===void 0){t=this._value}return this._separatorsCount(this._removeThousandsSeparators(t).length,true)}extractInput(t,e,i){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}[t,e]=this._adjustRangeWithSeparators(t,e);return this._removeThousandsSeparators(super.extractInput(t,e,i))}_appendCharRaw(t,e){if(e===void 0){e={}}const i=e.tail&&e._beforeTailState?e._beforeTailState._value:this._value;const s=this._separatorsCountFromSlice(i);this._value=this._removeThousandsSeparators(this.value);const a=this._value;this._value+=t;const n=this.number;let o=!isNaN(n);let r=false;if(o){let t;if(this.min!=null&&this.min<0&&this.number<this.min)t=this.min;if(this.max!=null&&this.max>0&&this.number>this.max)t=this.max;if(t!=null){if(this.autofix){this._value=this.format(t,this).replace(td.UNMASKED_RADIX,this.radix);r||(r=a===this._value&&!e.tail)}else{o=false}}o&&(o=Boolean(this._value.match(this._numberRegExp)))}let l;if(!o){this._value=a;l=new Rc}else{l=new Rc({inserted:this._value.slice(a.length),rawInserted:r?"":t,skip:r})}this._value=this._insertThousandsSeparators(this._value);const c=e.tail&&e._beforeTailState?e._beforeTailState._value:this._value;const d=this._separatorsCountFromSlice(c);l.tailShift+=(d-s)*this.thousandsSeparator.length;return l}_findSeparatorAround(t){if(this.thousandsSeparator){const e=t-this.thousandsSeparator.length+1;const i=this.value.indexOf(this.thousandsSeparator,e);if(i<=t)return i}return-1}_adjustRangeWithSeparators(t,e){const i=this._findSeparatorAround(t);if(i>=0)t=i;const s=this._findSeparatorAround(e);if(s>=0)e=s+this.thousandsSeparator.length;return[t,e]}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}[t,e]=this._adjustRangeWithSeparators(t,e);const i=this.value.slice(0,t);const s=this.value.slice(e);const a=this._separatorsCount(i.length);this._value=this._insertThousandsSeparators(this._removeThousandsSeparators(i+s));const n=this._separatorsCountFromSlice(i);return new Rc({tailShift:(n-a)*this.thousandsSeparator.length})}nearestInputPos(t,e){if(!this.thousandsSeparator)return t;switch(e){case wc.NONE:case wc.LEFT:case wc.FORCE_LEFT:{const i=this._findSeparatorAround(t-1);if(i>=0){const s=i+this.thousandsSeparator.length;if(t<s||this.value.length<=s||e===wc.FORCE_LEFT){return i}}break}case wc.RIGHT:case wc.FORCE_RIGHT:{const e=this._findSeparatorAround(t);if(e>=0){return e+this.thousandsSeparator.length}}}return t}doCommit(){if(this.value){const t=this.number;let e=t;if(this.min!=null)e=Math.max(e,this.min);if(this.max!=null)e=Math.min(e,this.max);if(e!==t)this.unmaskedValue=this.format(e,this);let i=this.value;if(this.normalizeZeros)i=this._normalizeZeros(i);if(this.padFractionalZeros&&this.scale>0)i=this._padFractionalZeros(i);this._value=i}super.doCommit()}_normalizeZeros(t){const e=this._removeThousandsSeparators(t).split(this.radix);e[0]=e[0].replace(/^(\D*)(0*)(\d*)/,((t,e,i,s)=>e+s));if(t.length&&!/\d$/.test(e[0]))e[0]=e[0]+"0";if(e.length>1){e[1]=e[1].replace(/0*$/,"");if(!e[1].length)e.length=1}return this._insertThousandsSeparators(e.join(this.radix))}_padFractionalZeros(t){if(!t)return t;const e=t.split(this.radix);if(e.length<2)e.push("");e[1]=e[1].padEnd(this.scale,"0");return e.join(this.radix)}doSkipInvalid(t,e,i){if(e===void 0){e={}}const s=this.scale===0&&t!==this.thousandsSeparator&&(t===this.radix||t===td.UNMASKED_RADIX||this.mapToRadix.includes(t));return super.doSkipInvalid(t,e,i)&&!s}get unmaskedValue(){return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix,td.UNMASKED_RADIX)}set unmaskedValue(t){super.unmaskedValue=t}get typedValue(){return this.parse(this.unmaskedValue,this)}set typedValue(t){this.rawInputValue=this.format(t,this).replace(td.UNMASKED_RADIX,this.radix)}get number(){return this.typedValue}set number(t){this.typedValue=t}get allowNegative(){return this.min!=null&&this.min<0||this.max!=null&&this.max<0}get allowPositive(){return this.min!=null&&this.min>0||this.max!=null&&this.max>0}typedValueEquals(t){return(super.typedValueEquals(t)||td.EMPTY_VALUES.includes(t)&&td.EMPTY_VALUES.includes(this.typedValue))&&!(t===0&&this.value==="")}}Zc=td;td.UNMASKED_RADIX=".";td.EMPTY_VALUES=[...Fc.EMPTY_VALUES,0];td.DEFAULTS={...Fc.DEFAULTS,mask:Number,radix:",",thousandsSeparator:"",mapToRadix:[Zc.UNMASKED_RADIX],min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,scale:2,normalizeZeros:true,padFractionalZeros:false,parse:Number,format:t=>t.toLocaleString("en-US",{useGrouping:false,maximumFractionDigits:20})};Oc.MaskedNumber=td;const ed={MASKED:"value",UNMASKED:"unmaskedValue",TYPED:"typedValue"};function id(t,e,i){if(e===void 0){e=ed.MASKED}if(i===void 0){i=ed.MASKED}const s=Yc(t);return t=>s.runIsolated((s=>{s[e]=t;return s[i]}))}function sd(t,e,i,s){return id(e,i,s)(t)}Oc.PIPE_TYPE=ed;Oc.createPipe=id;Oc.pipe=sd;class ad extends Gc{get repeatFrom(){var t;return(t=Array.isArray(this.repeat)?this.repeat[0]:this.repeat===Infinity?0:this.repeat)!=null?t:0}get repeatTo(){var t;return(t=Array.isArray(this.repeat)?this.repeat[1]:this.repeat)!=null?t:Infinity}constructor(t){super(t)}updateOptions(t){super.updateOptions(t)}_update(t){var e,i,s;const{repeat:a,...n}=Ec(t);this._blockOpts=Object.assign({},this._blockOpts,n);const o=Yc(this._blockOpts);this.repeat=(e=(i=a!=null?a:o.repeat)!=null?i:this.repeat)!=null?e:Infinity;super._update({mask:"m".repeat(Math.max(this.repeatTo===Infinity&&((s=this._blocks)==null?void 0:s.length)||0,this.repeatFrom)),blocks:{m:o},eager:o.eager,overwrite:o.overwrite,skipInvalid:o.skipInvalid,lazy:o.lazy,placeholderChar:o.placeholderChar,displayChar:o.displayChar})}_allocateBlock(t){if(t<this._blocks.length)return this._blocks[t];if(this.repeatTo===Infinity||this._blocks.length<this.repeatTo){this._blocks.push(Yc(this._blockOpts));this.mask+="m";return this._blocks[this._blocks.length-1]}}_appendCharRaw(t,e){if(e===void 0){e={}}const i=new Rc;for(let r=(s=(a=this._mapPosToBlock(this.displayValue.length))==null?void 0:a.index)!=null?s:Math.max(this._blocks.length-1,0),l,c;l=(n=this._blocks[r])!=null?n:c=!c&&this._allocateBlock(r);++r){var s,a,n,o;const d=l._appendChar(t,{...e,_beforeTailState:(o=e._beforeTailState)==null||(o=o._blocks)==null?void 0:o[r]});if(d.skip&&c){this._blocks.pop();this.mask=this.mask.slice(1);break}i.aggregate(d);if(d.consumed)break}return i}_trimEmptyTail(t,e){var i,s;if(t===void 0){t=0}const a=Math.max(((i=this._mapPosToBlock(t))==null?void 0:i.index)||0,this.repeatFrom,0);let n;if(e!=null)n=(s=this._mapPosToBlock(e))==null?void 0:s.index;if(n==null)n=this._blocks.length-1;let o=0;for(let t=n;a<=t;--t,++o){if(this._blocks[t].unmaskedValue)break}if(o){this._blocks.splice(n-o+1,o);this.mask=this.mask.slice(o)}}reset(){super.reset();this._trimEmptyTail()}remove(t,e){if(t===void 0){t=0}if(e===void 0){e=this.displayValue.length}const i=super.remove(t,e);this._trimEmptyTail(t,e);return i}totalInputPositions(t,e){if(t===void 0){t=0}if(e==null&&this.repeatTo===Infinity)return Infinity;return super.totalInputPositions(t,e)}get state(){return super.state}set state(t){this._blocks.length=t._blocks.length;this.mask=this.mask.slice(0,this._blocks.length);super.state=t}}Oc.RepeatBlock=ad;try{globalThis.IMask=Oc}catch{}const nd=".sc-ir-input-text-h{--ir-bg:#fff;--ir-primary:#1e9ff2;--ir-danger:#ff4961;--ir-border:#cacfe7;--ir-disabled-fg:#9aa1ac;--ir-readonly-bg:#f8f9fa;--ir-input-color:#3b4781;--ir-placeholder-color:#bbbfc6;--ir-floating-input-border:var(--ir-border);--ir-floating-input-border-radius:0.21rem;--ir-floating-input-height:2rem;--ir-focus-ring:none;--ir-focus-border-color:var(--ir-primary);--ir-floating-input-font-size:0.975rem;--ir-floating-input-line-height:1.45;--ir-floating-input-padding-y:0.75rem;--ir-floating-input-padding-x:1rem;--ir-floating-input-padding-x-with-affix:2rem;--ir-floating-label-fg:#6c757d;--ir-floating-label-fg-focus:#495057;--ir-floating-label-bg:#fff;--ir-floating-label-scale:0.88;--ir-floating-label-float-translateY:-70%;--ir-floating-label-resting-offset-inline:0.9rem;--ir-floating-label-resting-offset-inline-with-prefix:1.8rem;--ir-floating-input-affix-size:1rem;--ir-floating-input-affix-color:#6c757d;margin:0;padding:0;display:inline}.sc-ir-input-text-h{--blue:var(--ir-primary);--red:var(--ir-danger)}.border-theme.sc-ir-input-text{border:1px solid var(--ir-border)}.icon-container.sc-ir-input-text{color:#3b4781;border:1px solid var(--ir-border);font-size:var(--ir-floating-input-font-size);height:var(--ir-floating-input-height);background:var(--ir-bg);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}input.sc-ir-input-text:focus{border-color:var(--ir-primary) !important}.error-message.sc-ir-input-text{font-size:0.875rem;padding:0;margin:0.5rem 0 0;color:var(--ir-danger)}.ir-input[data-state='empty'].sc-ir-input-text{color:var(--ir-placeholder-color)}.input-container.sc-ir-input-text{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.input-container.sc-ir-input-text input.sc-ir-input-text{padding-left:5px !important;padding-right:5px !important;border-left:0;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.icon-container[data-state='focus'].sc-ir-input-text{border-color:var(--ir-primary)}.icon-container[data-disabled].sc-ir-input-text{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.danger-border.sc-ir-input-text{border-color:var(--ir-danger)}.ir-floating-group.sc-ir-input-text{position:relative;display:block;border:1px solid var(--ir-floating-input-border);border-radius:var(--ir-floating-input-border-radius);background:var(--ir-bg);transition:border-color 120ms ease, box-shadow 120ms ease;padding:0}.ir-floating-group.sc-ir-input-text:focus-within{border-color:var(--ir-focus-border-color);box-shadow:var(--ir-focus-ring)}.ir-floating-group.has-error.sc-ir-input-text,.has-error.sc-ir-input-text .ir-floating-group.sc-ir-input-text{border-color:var(--ir-danger)}.ir-floating-group.is-disabled.sc-ir-input-text{background-color:#f1f3f5}.ir-floating-group.is-readonly.sc-ir-input-text{background-color:var(--ir-readonly-bg)}.ir-floating-input.sc-ir-input-text{width:100%;display:block;border:0;outline:0;background:transparent;color:var(--ir-input-color);font-size:var(--ir-floating-input-font-size);line-height:var(--ir-floating-input-line-height);border-radius:var(--ir-floating-input-border-radius);box-shadow:none;padding:var(--ir-floating-input-padding-y) var(--ir-floating-input-padding-x);height:var(--ir-floating-input-height)}.ir-floating-input.danger-border.sc-ir-input-text{box-shadow:none}.ir-floating-label.sc-ir-input-text{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none;padding:0 0.4rem;color:var(--ir-floating-label-fg);background:transparent;transition:transform 120ms ease, color 120ms ease, top 120ms ease, background-color 120ms ease, opacity 120ms ease;opacity:0.95;line-height:1}.ir-floating-label.sc-ir-input-text:dir(rtl){right:var(--ir-floating-label-resting-offset-inline)}.ir-floating-label.sc-ir-input-text:dir(ltr){left:var(--ir-floating-label-resting-offset-inline)}.ir-floating-group.sc-ir-input-text:focus-within .ir-floating-label.sc-ir-input-text,.ir-floating-input.sc-ir-input-text:not(:placeholder-shown)+.ir-floating-label.sc-ir-input-text,.ir-floating-group[data-has-value='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text{top:0;transform:translateY(var(--ir-floating-label-float-translateY)) scale(var(--ir-floating-label-scale));background:var(--ir-floating-label-bg);color:var(--ir-floating-label-fg-focus);font-size:12px;padding:0}.ir-floating-group.has-error.sc-ir-input-text .ir-floating-label.sc-ir-input-text,.has-error.sc-ir-input-text .ir-floating-group.sc-ir-input-text .ir-floating-label.sc-ir-input-text{color:var(--ir-danger)}.ir-floating-group.is-disabled.sc-ir-input-text .ir-floating-label.sc-ir-input-text{color:var(--ir-disabled-fg)}@supports (-webkit-touch-callout: none){.ir-floating-input.sc-ir-input-text{border-radius:var(--ir-floating-input-border-radius)}}.prefix-container.sc-ir-input-text,.suffix-container.sc-ir-input-text{position:absolute;top:0;bottom:0;display:inline-flex;align-items:center;color:var(--ir-floating-input-affix-color);pointer-events:none}.prefix-container.sc-ir-input-text:dir(ltr){left:0.5rem}.suffix-container.sc-ir-input-text:dir(ltr){right:0.5rem}.prefix-container.sc-ir-input-text:dir(rtl){right:0.5rem}.suffix-container.sc-ir-input-text:dir(rtl){left:0.5rem}.sc-ir-input-text-s>[slot='prefix'],.sc-ir-input-text-s>[slot='suffix']{display:inline-flex;width:var(--ir-floating-input-affix-size);height:var(--ir-floating-input-affix-size)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-input.sc-ir-input-text{padding:var(--ir-floating-input-padding-y) var(--ir-floating-input-padding-x-with-affix)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text:dir(ltr){left:var(--ir-floating-label-resting-offset-inline-with-prefix)}.ir-floating-group[data-have-prefix='true'].sc-ir-input-text .ir-floating-label.sc-ir-input-text:dir(rtl){right:var(--ir-floating-label-resting-offset-inline-with-prefix)}.no-slot.sc-ir-input-text{display:none}";const od=nd;const rd=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.inputBlur=s(this,"inputBlur",7);this.inputFocus=s(this,"inputFocus",7);this.inputStyles="";this.readonly=false;this.type="text";this.submitted=false;this.inputStyle=true;this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.variant="default";this.disabled=false;this.error=false;this.autoValidate=true;this.inputFocused=false}componentWillLoad(){if(this.el.id){this.id=this.el.id}else{this.id=ht()}this.hasPrefixSlot=this.haveSlotPresent("prefix");this.hasSuffixSlot=this.haveSlotPresent("suffix")}componentDidLoad(){if(this.mask)this.initMask()}handleMaskChange(){this.initMask()}handleValueChange(t,e){if(t!==e){this.validateInput(this.value)}}initMask(){if(!this.mask||this.maskInstance){return}this.maskInstance=Oc(this.inputRef,this.mask);this.maskInstance.on("accept",(()=>{const t=this.inputRef.value.trim()===""||this.maskInstance.unmaskedValue==="";if(t){this.inputRef.value="";this.textChange.emit(null)}else{this.inputRef.value=this.maskInstance.value;this.textChange.emit(this.maskInstance.value)}}))}haveSlotPresent(t){const e=this.el.querySelector(`[slot="${t}"]`);return e!==null}async validateInput(t,e=false){if(!this.autoValidate&&!e){if(this.error){this.updateErrorState(false)}return}if(this.zod){try{if(!this.asyncParse){this.zod.parse(this.wrapKey?{[this.wrapKey]:t}:t)}else{await this.zod.parseAsync(this.wrapKey?{[this.wrapKey]:t}:t)}if(this.error){this.updateErrorState(false)}}catch(t){console.log(t);this.updateErrorState(true)}}}handleInputChange(t){const e=t.target.value;const i=e==="";if(this.maskInstance){this.maskInstance.value=e}const s=i?null:this.maskInstance?this.maskInstance.value:e;this.textChange.emit(s)}updateErrorState(t){this.error=t;this.inputRef.setAttribute("aria-invalid",t?"true":"false")}handleBlur(t){this.validateInput(this.value,this.submitted);this.inputFocused=false;this.inputBlur.emit(t)}renderFloatingLabel(){const t=this.label||this.placeholder||"";const i=!!(this.value&&String(this.value).length>0);return e("div",{class:"form-group",style:this.inputContainerStyle},e("div",{class:`ir-floating-group ${this.error?"has-error":""} ${this.disabled?"is-disabled":""} ${this.readonly?"is-readonly":""}`,"data-has-value":String(i),"data-focused":String(this.inputFocused),"data-have-prefix":String(this.hasPrefixSlot),"data-have-suffix":String(this.hasSuffixSlot),part:"form-group"},e("span",{part:"prefix-container",class:{"prefix-container":true,"no-slot":!this.hasPrefixSlot}},e("slot",{name:"prefix"})),e("input",{part:"input","data-state":!!this.value?undefined:this.mask?"empty":undefined,maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,id:this.id,name:this.name,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:`ir-input ir-floating-input ${this.inputStyles||""} ${this.error?"danger-border":""} text-${this.textSize}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:" ",autoComplete:this.autoComplete,autocomplete:this.autoComplete,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled,"aria-invalid":String(this.error),"aria-required":String(this.required)}),e("label",{part:"label",htmlFor:this.id,class:"ir-floating-label"},t,this.required?" *":""),e("span",{part:"suffix-container",class:{"suffix-container":true,"no-slot":!this.hasSuffixSlot}},e("slot",{name:"suffix"}))),this.errorMessage&&this.error&&e("p",{part:"error-message",class:"error-message"},this.errorMessage))}render(){if(this.variant==="floating-label"){return this.renderFloatingLabel()}if(this.variant==="icon"){return e("fieldset",{class:"position-relative has-icon-left input-container"},e("label",{htmlFor:this.id,class:"input-group-prepend bg-white m-0"},e("span",{"data-disabled":this.disabled,"data-state":this.inputFocused?"focus":"",class:`input-group-text icon-container bg-white ${this.error?"danger-border":""}`,id:"basic-addon1"},e("slot",{name:"icon"}))),e("input",{maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,"data-state":!!this.value?undefined:this.mask?"empty":undefined,id:this.id,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:`ir-input form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder ${this.error?"danger-border":""}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:this.placeholder,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled,autoComplete:this.autoComplete}))}return e("div",{class:"form-group",style:this.inputContainerStyle},e("div",{class:"input-group row m-0"},this.label&&e("div",{class:`input-group-prepend col-${this.labelWidth} ${this.labelContainerClassname} p-0 text-${this.labelColor}`},e("label",{htmlFor:this.id,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":"")),e("input",{maxLength:this.maxLength,"data-testid":this.testId,style:this.inputForcedStyle,"data-state":!!this.value?undefined:this.mask?"empty":undefined,id:this.id,ref:t=>this.inputRef=t,readOnly:this.readonly,type:this.type,class:this.clearBaseStyles?`${this.inputStyles}`:`${this.error?"border-danger":""} form-control text-${this.textSize} col-${this.label?12-this.labelWidth:12} ${this.readonly?"bg-white":""} ${this.inputStyles}`,onBlur:this.handleBlur.bind(this),onFocus:t=>{this.inputFocused=true;this.inputFocus.emit(t)},placeholder:this.placeholder,autoComplete:this.autoComplete,autocomplete:this.autoComplete,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled})),this.errorMessage&&this.error&&e("p",{class:"error-message"},this.errorMessage))}get el(){return n(this)}static get watchers(){return{mask:["handleMaskChange"],value:["handleValueChange"]}}};rd.style=od;const ld=".sc-ir-interactive-title-h{display:block;width:100%;--hk-green:green}*.sc-ir-interactive-title{box-sizing:border-box}.popover-title.sc-ir-interactive-title{position:relative;width:100%;height:100%;margin:0;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;z-index:10;left:0;display:flex;align-items:center}.popover-container.sc-ir-interactive-title{position:absolute;bottom:0px;left:var(--ir-popover-left, 10px);background:rgb(0, 0, 0);color:white;min-width:100%;box-shadow:rgba(0, 0, 0, 0.2) 0px 2px 10px;z-index:9999;padding:3.5px 7px;border-radius:5px;pointer-events:none;opacity:0;transition:all 100ms ease;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;font-style:normal;font-weight:400;line-height:1.45;text-decoration:none;text-shadow:none;font-size:0.875rem}.popover-container[data-state='show'].sc-ir-interactive-title{opacity:1}.hk-dot.sc-ir-interactive-title{inset:0;position:absolute;display:flex;align-items:center;justify-content:center;width:fit-content;padding:4px;left:auto;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding-inline:var(--ir-popover-left);background:var(--ir-interactive-hk-bg, white);color:var(--dot-color, black)}.hk-dot.sc-ir-interactive-title-s>*[name='end']{height:12px}";const cd=ld;const dd=class{constructor(e){t(this,e);this.popoverTitle="";this.irPopoverLeft="10px";this.hkStatus=false;this.cropSize=20;this.lastRenderedTitle=""}initializePopoverIfNeeded(t,e){if(this.lastRenderedTitle===e&&this.popoverInstance){return}this.disposePopover();const i=document.createElement("span");i.style.visibility="hidden";i.style.position="absolute";i.style.whiteSpace="nowrap";i.textContent=e;document.body.appendChild(i);const s=i.offsetWidth;document.body.removeChild(i);const a=t.clientWidth;const n=this.hkStatus?20:0;const o=s+n>a;if(o&&typeof $!=="undefined"){try{this.popoverInstance=$(t).popover({trigger:"hover",content:e,placement:"top",html:false,sanitize:true,delay:{show:300,hide:100}})}catch(t){console.error("Failed to initialize popover:",t)}}this.lastRenderedTitle=e}disposePopover(){if(this.popoverInstance&&typeof $!=="undefined"){try{$(this.titleContainerRef).popover("dispose");this.popoverInstance=null}catch(t){console.error("Failed to dispose popover:",t)}}}disconnectedCallback(){this.disposePopover()}render(){const t=this.popoverTitle||"";const s=t.length>this.cropSize;const a=s?t.slice(0,this.cropSize)+"...":t;return e(i,{key:"6155bab2211b603652929a360b55d1c776c5c6ae",style:{"--ir-popover-left":this.irPopoverLeft}},e("p",{key:"9c3a9fb32738d315e2e21dc719637d9438879b97",ref:e=>{this.titleContainerRef=e;if(e&&t){setTimeout((()=>this.initializePopoverIfNeeded(e,t)),0)}},class:"popover-title",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flex",alignItems:"center",gap:"4px"}},e("span",{key:"99f7b4b110034ef83af3e0231661084cebb2dbe6",class:"cropped-title",style:{flexShrink:"1",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis"}},a),this.hkStatus&&e("div",{key:"2116f77bd3e45f0f999eb78b45c8897aea3ad8c4",title:this.broomTooltip,class:"hk-dot",style:{flexShrink:"0"}},e("slot",{key:"6b2404ddb39fecad0c9ef31d8707869f59e634cf",name:"end"}))))}get el(){return n(this)}};dd.style=cd;class hd extends Error{constructor(t,e){super(t);this.name="InterceptorError";this.code=e;Object.setPrototypeOf(this,hd.prototype)}}const ud=".page-loader.sc-ir-interceptor{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-interceptor{padding:20px;display:flex;align-items:center;justify-content:center;border-radius:5px;background:white}.loadingScreenContainer.sc-ir-interceptor{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:100000;background:rgba(0, 0, 0, 0.2);pointer-events:all;display:flex;align-items:center;justify-content:center}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const fd=ud;const pd=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.handledEndpoints=["/Get_Exposed_Calendar","/ReAllocate_Exposed_Room","/Get_Exposed_Bookings","/UnBlock_Exposed_Unit"];this.suppressToastEndpoints=[];this.isShown=false;this.isLoading=false;this.isUnassignedUnit=false;this.endpointsCount=0;this.isPageLoadingStopped=null}handleStopPageLoading(t){this.isLoading=false;this.isPageLoadingStopped=t.detail}componentWillLoad(){this.setupAxiosInterceptors()}setupAxiosInterceptors(){gt.interceptors.request.use(this.handleRequest.bind(this),this.handleError.bind(this));gt.interceptors.response.use(this.handleResponse.bind(this),this.handleError.bind(this))}extractEndpoint(t){return t.split("?")[0]}isHandledEndpoint(t){return this.handledEndpoints.includes(t)}handleRequest(t){const e=this.extractEndpoint(t.url);ft[e]="pending";t.params=t.params||{};if(this.isHandledEndpoint(e)&&this.isPageLoadingStopped!==e){if(e!=="/Get_Exposed_Calendar"){this.isLoading=true}else{if(this.endpointsCount>0){this.isLoading=true}}}if(e==="/Get_Exposed_Calendar"){this.endpointsCount=this.endpointsCount+1}return t}async handleResponse(t){var e;const i=this.extractEndpoint(t.config.url);if(this.isHandledEndpoint(i)){this.isLoading=false;this.isPageLoadingStopped=null}ft[i]="done";if(i==="/Validate_Exposed_OTP"){return t}if(t.data.ExceptionCode==="OTP"){return this.handleOtpResponse({response:t,extractedUrl:i})}if((e=t.data.ExceptionMsg)===null||e===void 0?void 0:e.trim()){this.handleResponseExceptions({response:t,extractedUrl:i})}return t}handleResponseExceptions({response:t,extractedUrl:e}){this.handleError(t.data.ExceptionMsg,e,t.data.ExceptionCode);throw new hd(t.data.ExceptionMsg,t.data.ExceptionCode)}handleOtpResponse({extractedUrl:t,response:e}){this.showModal=true;this.email=e.data.ExceptionMsg;const i=t.slice(1);this.baseOTPUrl=i;if(i==="Check_OTP_Necessity"){let t;try{const i=typeof e.config.data==="string"?JSON.parse(e.config.data):e.config.data;t=i.METHOD_NAME}catch(e){console.error("Failed to parse request body for METHOD_NAME",e);t=i}this.requestUrl=t}else{this.requestUrl=i}this.pendingConfig=e.config;this.response=e;return new Promise(((t,e)=>{this.pendingResolve=t;this.pendingReject=e;setTimeout((()=>{var t;(t=this.otpModal)===null||t===void 0?void 0:t.openModal()}),10)}))}handleError(t,e,i){const s=this.suppressToastEndpoints.includes(e);if(!s||s&&!i){this.toast.emit({type:"error",title:t,description:"",position:"top-right"})}return Promise.reject(t)}async handleOtpFinished(t){if(!this.pendingConfig||!this.pendingResolve||!this.pendingReject){return}const{otp:e,type:i}=t.detail;if(i==="cancel"){const t={config:this.pendingConfig,data:{cancelled:true,baseOTPUrl:this.baseOTPUrl},status:0,statusText:"OTP Cancelled",headers:{},request:{}};this.pendingResolve(t)}else if(i==="success"){if(!e){this.pendingReject(new Error("OTP cancelled by user"))}else if(this.baseOTPUrl==="Check_OTP_Necessity"){this.pendingResolve(this.response)}else{try{const t=Object.assign(Object.assign({},this.pendingConfig),{data:typeof this.pendingConfig.data==="string"?JSON.parse(this.pendingConfig.data):this.pendingConfig.data||{}});const e=await gt.request(t);this.pendingResolve(e)}catch(t){this.pendingReject(t)}}}this.pendingConfig=undefined;this.pendingResolve=undefined;this.pendingReject=undefined;this.showModal=false;this.baseOTPUrl=null}render(){return e(i,{key:"11a9e31339d6e5ac258684dc9f01901ec7d62e9a"},this.isLoading&&!this.isPageLoadingStopped&&e("div",{key:"5e522e19dd04a63d113ff39f6c67d62e79a0cd66",class:"loadingScreenContainer"},e("div",{key:"d297f9157a11fef21eb7419108f46bab2f9f84ce",class:"loaderContainer"},e("span",{key:"4cb59a82683e267bc8f2f98a57f4abbe8a3db62e",class:"page-loader"}))),this.showModal&&e("ir-otp-modal",{key:"6036a71f81776919777b9d2c373091c21ae239b8",email:this.email,baseOTPUrl:this.baseOTPUrl,requestUrl:this.requestUrl,ref:t=>this.otpModal=t,onOtpFinished:this.handleOtpFinished.bind(this)}))}};pd.style=fd;const bd=".logo.sc-ir-label{height:1.5rem;width:1.5rem}.sc-ir-label-h{display:flex;gap:5px;align-items:center}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}.label_message.sc-ir-label{margin:0 3px;padding:0}.label_title.sc-ir-label{min-width:max-content;padding:0;margin:0;font-weight:600}.label_placeholder.sc-ir-label{color:#cacfe7;padding:0 !important;margin:0 !important}.icon-container.sc-ir-label{margin:0;padding:0}.country.sc-ir-label{height:16px;width:23px;border-radius:3px}svg.sc-ir-label{margin:0;padding:0}.label_wrapper_inline.sc-ir-label{display:inline;max-width:100%;gap:5px;margin-bottom:5px}.label_wrapper_flex.sc-ir-label{display:flex;align-items:center;gap:5px;max-width:100%;margin-bottom:5px}.label_title.sc-ir-label{font-weight:600;white-space:nowrap;display:inline}.label_message.sc-ir-label{display:inline;white-space:normal;word-break:break-word}";const gd=bd;const md=class{constructor(e){t(this,e);this.display="flex";this.renderContentAsHtml=false;this.image=null;this.isCountryImage=false;this.imageStyle="";this.ignoreEmptyContent=false}render(){var t,s,a;if(!this.placeholder&&!this.content&&!this.ignoreEmptyContent){return null}return e(i,{class:this.image?"align-items-center":""},e("div",{class:`${this.display==="inline"?"label_wrapper_inline":"label_wrapper_flex"} `,style:this.containerStyle},this.labelText&&e("p",{class:"label_title"},this.labelText),e("slot",{name:"prefix"}),this.image&&e("img",{src:this.image.src,alt:(t=this.image.alt)!==null&&t!==void 0?t:this.image.src,class:`p-0 m-0 ${this.isCountryImage?"country":"logo"} ${(s=this.image.style)!==null&&s!==void 0?s:""} ${(a=this.imageStyle)!==null&&a!==void 0?a:""}`}),this.content?this.renderContentAsHtml?e("p",{class:"label_message",innerHTML:this.content}):e("p",{class:"label_message"},this.content):e("p",{class:"label_placeholder"},this.placeholder),e("slot",null),e("slot",{name:"suffix"})))}};md.style=gd;const vd=".sc-ir-listing-header-h{display:block;margin:0;padding:0;--ir-date-range-border:#cacfe7;--ir-date-range-width:242px;position:relative}h3.sc-ir-listing-header{margin:0}ir-input-text.sc-ir-listing-header{width:300px}.booking-search-field.sc-ir-listing-header{margin-left:0px;display:flex;align-items:center;gap:14px}.booking-container.sc-ir-listing-header{gap:14px}.filters-container.sc-ir-listing-header{gap:10px;justify-content:space-between}.buttons-container.sc-ir-listing-header{gap:14px;color:#104064}.booking-dates-container.sc-ir-listing-header{position:relative;box-sizing:border-box;background:white;padding:0.75rem 1rem;height:2rem;border-radius:0.21rem;border:1px solid #cacfe7;display:flex;align-items:center;gap:0.5rem;margin:0}.booking-dates-container.sc-ir-listing-header span.sc-ir-listing-header{padding:0;margin:0;display:flex;align-items:center;justify-content:center;height:2rem}.date-picker-wrapper.sc-ir-listing-header{position:relative;cursor:default;box-sizing:border-box;padding:0 0.5rem;height:2rem;display:flex;align-items:center;gap:5px;flex-shrink:0;cursor:pointer}.date-picker-wrapper.sc-ir-listing-header:hover .date-display.sc-ir-listing-header{color:var(--blue)}.date-picker-wrapper[data-option='from-date'].sc-ir-listing-header{padding-right:0;cursor:pointer}.date-display.sc-ir-listing-header{background:inherit;margin:0;padding:0;display:flex;align-items:center;font-size:0.975rem;line-height:1.45;height:2rem;color:#3b4781;white-space:nowrap;padding-right:5px;cursor:pointer}.hidden-date-picker.sc-ir-listing-header{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}.new-booking-container.sc-ir-listing-header{position:absolute;right:10px;top:5px}.new-booking-btn.sc-ir-listing-header{all:unset;cursor:pointer;color:#104064}.new-booking-btn.sc-ir-listing-header:hover{color:#0b2538}.seperator-container.sc-ir-listing-header{margin-top:10px;justify-content:center !important;gap:14px}.seperator-container.sc-ir-listing-header span.sc-ir-listing-header{display:block;height:1px;background:var(--gray);width:45%;max-width:200px;margin:0}@media (max-width: 575.98px){.sc-ir-listing-header-h{--ir-date-range-width:100%}.flex-fill-sm-none.sc-ir-listing-header{flex:1 1 auto}.flex-fill-sm-none.sc-ir-listing-header label.sc-ir-listing-header{width:100px}.buttons-container.sc-ir-listing-header{justify-content:center !important;align-items:center !important;gap:40px}}@media (min-width: 1200px){.booking-search-field.sc-ir-listing-header{margin-left:40px}}@media (min-width: 1600px){.flex-fill-sm-none.sc-ir-listing-header{flex:0 0 auto}.booking-search-field.sc-ir-listing-header{margin-left:40px}}";const yd=vd;const kd=class{constructor(e){t(this,e);this.preventPageLoad=s(this,"preventPageLoad",7);this.inputValue="";this.isLoading=null;this.bookingListingService=new za}async handleSearchClicked(t){if(this.inputValue!==""){if(/^-?\d+$/.test(this.inputValue.trim())){ja("book_nbr",this.inputValue.trim())}else if(this.inputValue[3]==="-"){ja("book_nbr",this.inputValue.trim())}else{ja("name",this.inputValue.trim())}}if(this.inputValue===""&&(Ta.userSelection.book_nbr!==""||Ta.userSelection.name!=="")){Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),{name:"",book_nbr:""})}this.isLoading=t?"excel":"search";this.preventPageLoad.emit("/Get_Exposed_Bookings");await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{start_row:0,end_row:20,is_to_export:t}));this.isLoading=null;if(Ta.download_url){it(Ta.download_url)}}async handleClearUserField(){Ba();if(this.inputValue){this.inputValue=""}await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},Ta.userSelection),{start_row:0,end_row:20,is_to_export:false}))}render(){var t,s,a,n,o,r,l,c,d,h;console.log(Ta.balance_filter);return e(i,{key:"d76446d5087cc6b13ca10979d86b373ecb8f8d11"},e("section",{key:"e4fcb0ee2a31e555fa6c5529152191b409cfe264",class:"d-flex align-items-center "},e("div",{key:"e57f3d00dceaed78b9e029a2698c62f786c71c73",class:"d-flex flex-fill flex-column flex-md-row align-items-md-center booking-container"},e("div",{key:"178cff315a15c653f85c700ebcc84706a723f6a1",class:"d-flex mb-1 d-md-none align-items-center justify-content-bettween width-fill"},e("h3",{key:"3a05098c1d70c7c12d05686ffa2c8e395db21553",class:"flex-fill"},(t=y.entries)===null||t===void 0?void 0:t.Lcz_Bookings),e("div",{key:"b3ccb3229b0f731726cd60224d364eb54bdc5e9e"},e("igl-book-property-container",{key:"a639e3b0b5e1b525bbc02d7635dccf9205acfaa4",p:this.p,withIrToastAndInterceptor:false,propertyid:this.propertyId,language:this.language,title:y.entries.Lcz_CreateNewBooking,ticket:Ta.token},e("ir-button",{key:"b0c1f2d4956c543549b770680dc108948f0d1ad7",slot:"trigger",class:"new-booking-btn",variant:"icon",icon_name:"square_plus"})))),e("h3",{key:"7f62e669d07066ab790dabd415931ac6bcdc0623",class:"d-none d-md-block"},(s=y.entries)===null||s===void 0?void 0:s.Lcz_Bookings),e("form",{key:"2c54e689b5bee8b31815bac6b856daecf9459494",onSubmit:t=>{t.preventDefault();console.log(this.inputValue);this.handleSearchClicked(false)},class:"booking-search-field width-fill"},e("ir-input-text",{key:"9b2b32e8dc460613f764a84e6b9e269a1d3369e2",class:"flex-fill",value:this.inputValue,onTextChange:t=>this.inputValue=t.detail,variant:"icon",placeholder:(a=y.entries)===null||a===void 0?void 0:a.Lcz_FindBookNbrorName},e("svg",{key:"0468eb46c20e8c418be831d06ecface58d83f7f9",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{key:"3321aa8978fdbcf86ece0cc468d452520f9ed708",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),e("h5",{key:"86aaef7802e3bf82175fa1666a407e8eaacccfe3",class:"m-0 font-weight-bold d-none d-sm-block"},(n=y.entries)===null||n===void 0?void 0:n.Lcz_Or))),e("div",{key:"39293db4a41cbdb85af10f0582d3ce4b824de7c0",class:"d-none d-md-block"},e("igl-book-property-container",{key:"e6019002692c7281e37c413738d016044517cd19",p:this.p,withIrToastAndInterceptor:false,propertyid:this.propertyId,language:this.language,title:y.entries.Lcz_CreateNewBooking,ticket:Ta.token},e("ir-button",{key:"e06e7c204b943b63638dbbbf3aefd1ef3e8b908b",slot:"trigger",class:"new-booking-btn",variant:"icon",icon_name:"square_plus"})))),e("section",{key:"cc473900c4a58e3b11778d1f6f80cef870e02c41",class:"d-flex align-items-center justify-evenly seperator-container d-sm-none"},e("span",{key:"28a96a5a2ed42869ae4bf990d083bff761c434d3"}),e("h5",{key:"c163b872f1f99faec6a0668a88af22f520c94bc2",class:"m-0 font-weight-bold"},(o=y.entries)===null||o===void 0?void 0:o.Lcz_Or),e("span",{key:"33ff034385b971985a4c4ebf0c89e89f85ea3ba8"})),e("section",{key:"2731bf7e19e43f25fd43e816c77137edf333c69b",class:"d-flex flex-column align-items-sm-center flex-sm-row flex-sm-wrap filters-container justify-content-lg-start mt-1"},e("ir-select",{key:"8f4d9b23b09fdb56cb7c441f8873d970ffadb30a",onSelectChange:t=>ja("filter_type",t.detail),showFirstOption:false,data:Ta===null||Ta===void 0?void 0:Ta.types.map((t=>({value:t.id.toString(),text:t.name}))),class:"flex-sm-wrap",selectedValue:Ta.userSelection.filter_type,selectId:"dateTo"}),e("ir-range-picker",{key:"761ffe370e3b1e67cf11a043baa5293df83976a8",onDateRangeChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i}=t.detail;let s=i.format("YYYY-MM-DD");if(i.isSame(D(Ta.userSelection.to,"YYYY-MM-DD"),"days")||i.isBefore(D(Ta.userSelection.from,"YYYY-MM-DD"),"days")){s=Ta.userSelection.to}Ta.userSelection=Object.assign(Object.assign({},Ta.userSelection),{to:s,from:e.format("YYYY-MM-DD")})},allowNullDates:false,fromDate:D(Ta.userSelection.from,"YYYY-MM-DD"),toDate:D(Ta.userSelection.to,"YYYY-MM-DD")}),e("ir-select",{key:"78fe4183da5b15b3667520d33d3319d6a29d26ac",class:"flex-sm-wrap",selectedValue:Ta.userSelection.booking_status,onSelectChange:t=>ja("booking_status",t.detail),showFirstOption:false,data:Ta===null||Ta===void 0?void 0:Ta.statuses.map((t=>({value:t.code,text:t.name}))),selectId:"booking_status"}),e("ir-select",{key:"c2d69117f4637da92d0050cfbea5a3abb16ccb23",class:"flex-sm-wrap",selectedValue:Ta.userSelection.channel,onSelectChange:t=>ja("channel",t.detail),data:Ta===null||Ta===void 0?void 0:Ta.channels.map((t=>({value:t.value,text:t.name}))),selectId:"channels",firstOption:((r=y.entries)===null||r===void 0?void 0:r.Lcz_All)+" "+((l=y.entries)===null||l===void 0?void 0:l.Lcz_Channels)}),e("ir-select",{key:"1fa60e17eff5d8e8215691b4af16028b3e5779e9",class:"flex-sm-wrap",selectedValue:Ta.userSelection.balance_filter,onSelectChange:t=>ja("balance_filter",t.detail),data:Ta===null||Ta===void 0?void 0:Ta.balance_filter.map((t=>({value:t.value,text:t.name}))),showFirstOption:false,selectId:"balance_filter"}),e("div",{key:"3fb18bbbffdf82d2391cd50fd2808d6f656cf1dc",class:"d-flex flex-fill align-items-end m-0  buttons-container"},e("ir-button",{key:"e35083ad9f6efcc1b15d30bb1a919c7b762aca0d",title:(c=y.entries)===null||c===void 0?void 0:c.Lcz_Search,variant:"icon",icon_name:"search",isLoading:this.isLoading==="search",onClickHandler:()=>this.handleSearchClicked(false)}),e("ir-button",{key:"195b77d9aba9f42975c1025b693772c9534ee90c",title:(d=y.entries)===null||d===void 0?void 0:d.Lcz_Erase,variant:"icon",icon_name:"eraser",onClickHandler:()=>this.handleClearUserField()}),e("ir-button",{key:"f570eb29cf31ebf06fe2f5d284836831624560c7",title:(h=y.entries)===null||h===void 0?void 0:h.Lcz_ExportToExcel,variant:"icon",icon_name:"file",isLoading:this.isLoading==="excel",onClickHandler:()=>this.handleSearchClicked(true)}))))}};kd.style=yd;const wd=".backdropModal.sc-ir-listing-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-listing-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-listing-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-listing-modal{padding:10px;background:white;border-radius:5px}.modal.sc-ir-listing-modal{z-index:1001 !important}.modal-dialog.sc-ir-listing-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-listing-modal{gap:10px}.exit-icon.sc-ir-listing-modal{position:absolute;right:10px;top:5px;margin:0}.ir-modal.sc-ir-listing-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-listing-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const xd=wd;const _d=class{constructor(e){t(this,e);this.modalClosed=s(this,"modalClosed",7);this.resetData=s(this,"resetData",7);this.modalTitle="Modal Title";this.isOpen=false;this.deletionStage=2;this.loadingBtn=null;this.bookingListingsService=new za;this.paymentService=new ua}componentWillLoad(){this.selectedDesignation=this.paymentEntries.methods[0]}async closeModal(){this.isOpen=false;this.selectedDesignation=this.paymentEntries.methods[0];this.modalClosed.emit(null)}async openModal(){this.isOpen=true}filterBookings(){Ta.bookings=Ta.bookings.filter((t=>t.booking_nbr!==this.editBooking.booking.booking_nbr))}async btnClickHandler(t){let e=t.target;let i=e.name;try{if(i==="confirm"){this.loadingBtn="confirm";if(this.editBooking.cause==="payment"){const t=this.paymentEntries.types.find((t=>t.CODE_NAME==="001"));await this.paymentService.AddPayment({amount:this.editBooking.booking.financial.due_amount,currency:this.editBooking.booking.currency,date:D().format("YYYY-MM-DD"),designation:this.selectedDesignation.CODE_VALUE_EN,payment_method:{code:this.selectedDesignation.CODE_NAME,description:this.selectedDesignation.CODE_VALUE_EN,operation:this.selectedDesignation.NOTES},payment_type:{code:t.CODE_NAME,description:t.CODE_VALUE_EN,operation:t.NOTES},id:-1,reference:""},this.editBooking.booking.booking_nbr);this.resetData.emit(this.editBooking.booking.booking_nbr)}else{if(this.deletionStage===2){await this.bookingListingsService.removeExposedBooking(this.editBooking.booking.booking_nbr,true);this.filterBookings()}}}if(i==="cancel"){this.closeModal()}}catch(t){console.error(t)}finally{if(this.loadingBtn){this.loadingBtn=null;this.closeModal()}}}renderTitle(){var t,e;if(this.editBooking.cause==="payment"){return(t=y.entries)===null||t===void 0?void 0:t.Lcz_MarkBookingAsPaid.replace("%1",this.editBooking.booking.booking_nbr)}else{return y.entries.Lcz_SureYouWantToDeleteBookingNbr+((e=this.editBooking)===null||e===void 0?void 0:e.booking.booking_nbr)}}renderConfirmationTitle(){return y.entries.Lcz_Confirm}renderCancellationTitle(){return y.entries.Lcz_Cancel}handleDropdownChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail.toString();console.log(e);const i=this.paymentEntries.methods.find((t=>t.CODE_NAME===e));if(!i){console.warn(`Invalid payment method ${t.detail}`);return}this.selectedDesignation=i}render(){var t,i;if(!this.editBooking){return null}return[e("div",{class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{if(this.editBooking.cause==="delete"){return}this.closeModal()}}),e("div",{"data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},this.isOpen&&e("div",{class:`ir-alert-content p-2`},e("div",{class:`ir-alert-header align-items-center border-0 py-0 m-0 `},e("p",{class:"p-0 my-0 mb-1"},this.renderTitle()),e("ir-icon",{class:"exit-icon",style:{cursor:"pointer"},onClick:()=>{this.closeModal()}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"10.5",viewBox:"0 0 384 512"},e("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})))),e("div",{class:"modal-body text-left p-0 mb-2"},this.editBooking.cause==="payment"?e("ir-select",{selectedValue:(t=this.selectedDesignation)===null||t===void 0?void 0:t.CODE_NAME,onSelectChange:this.handleDropdownChange.bind(this),showFirstOption:false,data:(i=this.paymentEntries.methods)===null||i===void 0?void 0:i.map((t=>({value:t.CODE_NAME,text:t.CODE_VALUE_EN})))}):null),e("div",{class:`ir-alert-footer border-0 d-flex justify-content-end`},e("ir-button",{isLoading:this.loadingBtn==="just_delete",btn_color:"secondary",btn_block:true,text:this.renderCancellationTitle(),name:"cancel"}),e("ir-button",{isLoading:this.loadingBtn==="confirm",btn_color:"primary",btn_block:true,text:this.renderConfirmationTitle(),name:"confirm"}))))]}};_d.style=xd;const Dd=".sc-ir-loading-screen-h{display:fixed;height:100vh;width:100vw;z-index:1000;top:0;left:0;display:flex;align-items:center;justify-content:center;background:white}.loader.sc-ir-loading-screen{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-loading-screen{position:absolute;z-index:100001;padding:20px;top:50%;left:50%;transform:translate(-50%, -50%);background:white;display:flex;align-items:center;justify-content:center;gap:20px;border-radius:5px}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Cd=Dd;const Od=class{constructor(e){t(this,e);this.message=""}render(){return e(i,{key:"ed4a037086232421257227c6657b317211de4f6b"},e("span",{key:"de0608a19794b075a38351305bbb518e3f5dbf8d",class:"loader"}))}};Od.style=Cd;class Md{async authenticate(t){const{data:e}=await gt.post("/Authenticate",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e["My_Result"]}async changeUserPwd(t){var e,i;const{data:s}=await gt.post("/Change_User_Pwd",t);if((e=s.ExceptionMsg)===null||e===void 0?void 0:e.trim()){throw new Error((i=s.ExceptionMsg)===null||i===void 0?void 0:i.trim())}return s.My_Result}}const Ed=".sc-ir-login-h{height:100vh;display:grid;align-content:center;padding:2rem;box-sizing:border-box;background:url(https://x.igloorooms.com/bg.jpg);background-position:center;background-repeat:no-repeat;background-size:cover}p.sc-ir-login,input.sc-ir-login,button.sc-ir-login{margin:0}p.sc-ir-login,input.sc-ir-login,button.sc-ir-login,div.sc-ir-login,section.sc-ir-login,form.sc-ir-login{box-sizing:border-box}.form-container.sc-ir-login{padding:1rem;display:flex;flex-direction:column;height:100%;background:white;border-radius:0.25rem;gap:1rem;width:100%;max-width:38rem;margin-left:auto;margin-right:auto}.separator-container.sc-ir-login{display:flex;align-items:center;gap:0.5rem;padding-top:1.5rem;padding-bottom:1rem}.separator-container.sc-ir-login p.sc-ir-login{color:#6b6f82;font-size:1rem}.separator.sc-ir-login{flex:1 1 0%;height:1px;background:#dadada}.login-btn.sc-ir-login{margin-top:1rem}.logo.sc-ir-login{align-self:center}.app_links.sc-ir-login{display:flex;align-items:center;justify-content:center;gap:1rem;padding-block:0.5rem}.app_links.sc-ir-login a.sc-ir-login img.sc-ir-login{width:70%}.password_toggle.sc-ir-login{all:unset;position:absolute;top:2px;right:1rem}";const Yd=Ed;const Ad=class{constructor(e){t(this,e);this.authFinish=s(this,"authFinish",7);this.showPassword=false;this.authService=new Md;this.token=new pt}async handleSignIn(t){t.preventDefault();try{const t=await this.authService.authenticate({password:this.password,username:this.username});this.token.setToken(t);this.authFinish.emit({token:t,code:"succsess"})}catch(t){console.log(t.message)}}render(){return e(i,{key:"ea4a158ed1e558503cd3cd600f16c245790c9aa8"},e("ir-interceptor",{key:"d04b2bf9e98d491c741a9ebdda40771be3a2f87e"}),e("ir-toast",{key:"a9f15f4f467c9c4a77fd99cd563a176e5e329513"}),e("form",{key:"a340e68edcbe826700569dbb879fc6550d6ef8ae",onSubmit:this.handleSignIn.bind(this),class:"card form-container px-2"},e("img",{key:"59463d384291748cdce2b5893e409cdce8d85bf2",class:"logo",src:"https://x.igloorooms.com/app-assets/images/logo/logo-dark.png",alt:"Login to igloorooms extranet"}),e("div",{key:"6eb0f367d498192bff3367927cddee55322fbb4a",class:"separator-container"},e("div",{key:"2bb91d9b591f083ed1d198d0f63865cae3b6a190",class:"separator"}),e("p",{key:"38c4bd3ea6c278ac060207824d45100d53065f9b"},"Sign in to manage your property"),e("div",{key:"25e4aadb04706f500e5a6d7586e75274193577fa",class:"separator"})),e("ir-input-text",{key:"4a042d9a1508b8f0a1b37e5719164b68508b08e9",value:this.username,onTextChange:t=>this.username=t.detail,variant:"icon",label:"",placeholder:"Username"},e("ir-icons",{key:"2627c5860b165d965f65989516e3b2b222a7c7e2",name:"user",slot:"icon"})),e("div",{key:"6c6fc3c56001ea645bf3c5dd9a16736e1b289a72",class:"position-relative"},e("ir-input-text",{key:"cffeaa7d2bb89c17f37838fd1a03aab7b4679858",value:this.password,onTextChange:t=>this.password=t.detail,variant:"icon",label:"",placeholder:"Password",type:this.showPassword?"text":"password"},e("ir-icons",{key:"dd096bf62fec3a0d622a30ea526139b1ee29dbbe",name:"key",slot:"icon"})),e("button",{key:"7a81b15806cabd262bbe592eb58adb8911deec26",type:"button",class:"password_toggle",onClick:()=>this.showPassword=!this.showPassword},e("ir-icons",{key:"866d99adc85c232a7efc83e6d8a6af0fb304656d",name:!this.showPassword?"open_eye":"closed_eye"}))),e("ir-button",{key:"a86f70a39942631b2827bd4e7cc760bdfcc2d79f",isLoading:ut("/Authenticate"),btn_type:"submit",iconPosition:"left",icon_name:"unlock",text:"Login",size:"md",class:"login-btn"}),e("div",{key:"b163adf21a089fd03cfd45d77443841b4b709101",class:"card-body text-center p-0 app_links"},e("a",{key:"2604fa0edd2ef3c811b477f2ac622fd679deb6e4",href:"https://apps.apple.com/lb/app/igloorooms/id1607846173",target:"_new"},e("img",{key:"5ec1372b903de7a38a4c3a752a582197ea1df2ca",src:"https://x.igloorooms.com/assets/images/svg/AppStore_ios.svg",alt:"Install igloorooms iOS App"})),e("a",{key:"44cd685956001fa4922a3a22ccf55fdd87c8bfe3",href:"https://play.google.com/store/apps/details?id=com.iglooroomsapp",target:"_new"},e("img",{key:"db7811eed347a07c03db2aada129ecfb410f3c59",src:"https://x.igloorooms.com/assets/images/svg/AppStore_android.svg",alt:"Install igloorooms Android App"}))),e("a",{key:"7f160ebbfd17d3806c50bf5f7e4083e7299ce73c",href:"https://info.igloorooms.com/signup",class:"btn btn-outline-danger btn-block btn-md mt-2",target:"_new"},"New to igloorooms?"),e("p",{key:"b1e61a40929d9898ffe83490a656181dd8f35445",class:"font-small-3  my-1"},"By logging in, you accept our"," ",e("span",{key:"1cb1753cbf1f027c3bd748ecb262d3cd20712435"},e("a",{key:"c2442bdd175b13f29df481f9291eadb01b45e41b",href:"https://info.igloorooms.com/privacy/",target:"_new"},"Privacy and Cookies Policies"))," ","Need help? support@igloorooms.com")))}};Ad.style=Yd;const Td=".sc-ir-m-combobox-h{position:relative;display:block}.input-wrapper.sc-ir-m-combobox{position:relative;width:100%}.prefix-container.sc-ir-m-combobox,.suffix-container.sc-ir-m-combobox{position:absolute;top:0;bottom:0;display:inline-flex;align-items:center;color:var(--ir-combobox-affix-color, #6c757d);pointer-events:none}.dropdown-item.sc-ir-m-combobox{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.prefix-container.sc-ir-m-combobox{left:0.5rem}.suffix-container.sc-ir-m-combobox{right:0.5rem}.sc-ir-m-combobox-s>[slot='prefix'],.sc-ir-m-combobox-s>[slot='suffix']{display:inline-flex;width:var(--ir-combobox-affix-size, 1rem);height:var(--ir-combobox-affix-size, 1rem)}.has-prefix.sc-ir-m-combobox-h input.form-control.sc-ir-m-combobox{padding-left:calc(0.75rem + var(--ir-combobox-affix-size, 1rem))}.has-suffix.sc-ir-m-combobox-h input.form-control.sc-ir-m-combobox{padding-right:calc(0.75rem + var(--ir-combobox-affix-size, 1rem))}.dropdown.sc-ir-m-combobox{position:absolute;top:100%;left:0;z-index:1000;width:100%}.dropdown-menu.sc-ir-m-combobox{max-height:var(--ir-combobox-height, 200px);overflow-y:auto;min-width:100%;width:var(--ir-combobox-width, 100%) !important;scroll-behavior:smooth}.dropdown-item.loading.sc-ir-m-combobox,.dropdown-item.no-results.sc-ir-m-combobox{color:#6c757d;cursor:default;pointer-events:none}.dropdown-item.sc-ir-m-combobox{padding:0.5rem 1rem !important}.dropdown-item.active.sc-ir-m-combobox,.dropdown-item.sc-ir-m-combobox:active,.dropdown-item.focused.sc-ir-m-combobox{background-color:var(--blue, #1e9ff2) !important;color:white !important}[slot='dropdown-content'].sc-ir-m-combobox .dropdown-item.focused.sc-ir-m-combobox,[slot='dropdown-content'].sc-ir-m-combobox .dropdown-item.active.sc-ir-m-combobox{background-color:#1e9ff2 !important;color:white !important}[slot='dropdown-content'].sc-ir-m-combobox [data-option].focused.sc-ir-m-combobox,[slot='dropdown-content'].sc-ir-m-combobox [data-option].active.sc-ir-m-combobox{background-color:#1e9ff2 !important;color:white !important}";const Sd=Td;const Bd=class{constructor(e){t(this,e);this.optionChange=s(this,"optionChange",7);this.searchQuery=s(this,"searchQuery",7);this.dataMode="static";this.options=[];this.debounceDelay=300;this.loading=false;this.useSlot=false;this.isOpen=false;this.focusedIndex=-1;this.filteredOptions=[];this.slotElements=[];this.hasPrefix=false;this.hasSuffix=false;this.itemChildren=[];this.id=ht();this.dropdownId=`dropdown-${this.id}`;this.mo=null;this.handleDocumentClick=t=>{if(!this.el.contains(t.target)){this.closeDropdown()}};this.updateAffixPresence=()=>{try{const t=this.prefixSlotRef&&this.prefixSlotRef.assignedElements?this.prefixSlotRef.assignedElements():Array.from(this.el.querySelectorAll('[slot="prefix"]'));const e=this.suffixSlotRef&&this.suffixSlotRef.assignedElements?this.suffixSlotRef.assignedElements():Array.from(this.el.querySelectorAll('[slot="suffix"]'));this.hasPrefix=Array.isArray(t)?t.length>0:false;this.hasSuffix=Array.isArray(e)?e.length>0:false}catch(t){const e=this.el.querySelector('[slot="prefix"]');const i=this.el.querySelector('[slot="suffix"]');this.hasPrefix=!!e;this.hasSuffix=!!i}};this.handleKeyDown=t=>{const e=this.useSlot?this.slotElements.length-1:this.filteredOptions.length-1;switch(t.key){case"ArrowDown":t.preventDefault();if(!this.isOpen){this.openDropdown()}else{this.focusedIndex=Math.min(this.focusedIndex+1,e);if(this.useSlot){this.focusSlotElement(this.focusedIndex)}else{this.scrollToFocusedOption()}}break;case"ArrowUp":t.preventDefault();if(this.isOpen){this.focusedIndex=Math.max(this.focusedIndex-1,0);if(this.useSlot){this.focusSlotElement(this.focusedIndex)}else{this.scrollToFocusedOption()}}break;case"Enter":t.preventDefault();if(this.isOpen&&this.focusedIndex>=0){if(this.useSlot){this.selectSlotElement(this.focusedIndex)}else{this.selectOption(this.filteredOptions[this.focusedIndex])}}else if(!this.isOpen){this.openDropdown()}break;case"Escape":t.preventDefault();this.closeDropdown();break;case"Tab":if(this.isOpen){this.closeDropdown()}break}};this.handleInput=t=>{const e=t.target;const i=e.value;if(this.dataMode==="external"&&!this.isCompositionMode){this.emitSearchQuery(i)}else if(this.isCompositionMode){this.filterComposition(i)}else{const t=this.options.length>0?this.options:[];this.filteredOptions=i?t.filter((t=>t.label.toLowerCase().includes(i.toLowerCase()))):t}this.focusedIndex=-1;if(!this.isOpen){this.openDropdown()}}}async selectOptionFromSlot(t){this.selectOption(t)}get isCompositionMode(){return this.itemChildren.length>0}watchOptionsChanged(t){this.filteredOptions=t||[];if(this.useSlot){this.updateSlotElements()}}watchUseSlotChanged(){if(this.useSlot){setTimeout((()=>this.updateSlotElements()),0)}}componentWillLoad(){this.initializeOptions();this.collectItemChildren();this.mo=new MutationObserver((()=>this.collectItemChildren()));this.mo.observe(this.el,{childList:true,subtree:true})}componentDidLoad(){var t,e;document.addEventListener("click",this.handleDocumentClick.bind(this));if(this.useSlot){setTimeout((()=>this.updateSlotElements()),0)}setTimeout((()=>this.updateAffixPresence()),0);(t=this.prefixSlotRef)===null||t===void 0?void 0:t.addEventListener("slotchange",this.updateAffixPresence);(e=this.suffixSlotRef)===null||e===void 0?void 0:e.addEventListener("slotchange",this.updateAffixPresence)}disconnectedCallback(){var t,e,i;document.removeEventListener("click",this.handleDocumentClick.bind(this));if(this.debounceTimeout)clearTimeout(this.debounceTimeout);(t=this.prefixSlotRef)===null||t===void 0?void 0:t.removeEventListener("slotchange",this.updateAffixPresence);(e=this.suffixSlotRef)===null||e===void 0?void 0:e.removeEventListener("slotchange",this.updateAffixPresence);(i=this.mo)===null||i===void 0?void 0:i.disconnect()}handleDocumentKeyDown(t){var e;if(!this.isOpen)return;if(t.key==="Escape"){this.closeDropdown();(e=this.inputRef)===null||e===void 0?void 0:e.focus()}}handleComboboxItemSelect(t){t.stopPropagation();console.log(t.detail);this.selectOption(t.detail)}handleComboboxItemRegister(){this.collectItemChildren()}handleComboboxItemUnregister(){this.collectItemChildren()}initializeOptions(){this.filteredOptions=this.options.length>0?this.options:[]}openDropdown(){this.isOpen=true;if(this.isCompositionMode||this.useSlot){this.focusedIndex=-1;setTimeout((()=>this.isCompositionMode?this.updateSlotElementsForItems():this.updateSlotElements()),0)}else{this.focusedIndex=this.selectedOption?this.filteredOptions.findIndex((t=>t.value===this.selectedOption.value)):-1}}emitSearchQuery(t){if(this.debounceTimeout){clearTimeout(this.debounceTimeout)}this.debounceTimeout=setTimeout((()=>{this.searchQuery.emit(t)}),this.debounceDelay)}closeDropdown(){this.isOpen=false;this.focusedIndex=-1;this.removeSlotFocus()}updateSlotElements(){if(!this.useSlot||!this.dropdownRef)return;const t=this.dropdownRef.querySelector('slot[name="dropdown-content"]');if(t){const e=t.assignedElements?t.assignedElements():Array.from(this.el.querySelectorAll('[slot="dropdown-content"] [data-option]'));this.slotElements=e.length>0?e:Array.from(this.dropdownRef.querySelectorAll('[data-option], .dropdown-item[style*="cursor"]'));this.slotElements.forEach(((t,e)=>{t.setAttribute("data-slot-index",e.toString());t.setAttribute("role","option");t.setAttribute("tabindex","-1")}))}}removeSlotFocus(){this.slotElements.forEach((t=>{t.classList.remove("focused","active");t.removeAttribute("aria-selected")}))}focusSlotElement(t){this.removeSlotFocus();if(t>=0&&t<this.slotElements.length){const e=this.slotElements[t];e.classList.add("focused","active");e.setAttribute("aria-selected","true");e.scrollIntoView({block:"nearest"})}}selectSlotElement(t){if(t>=0&&t<this.slotElements.length){const e=this.slotElements[t];e.click()}}selectOption(t){this.selectedOption=t;this.optionChange.emit(t);this.closeDropdown();this.inputRef.focus()}scrollToFocusedOption(){if(this.focusedIndex<0||!this.dropdownRef||this.useSlot)return;const t=this.dropdownRef.querySelector(`#${this.dropdownId}-option-${this.focusedIndex}`);if(t){t.scrollIntoView({block:"nearest"})}}collectItemChildren(){const t=Array.from(this.el.querySelectorAll("ir-m-combobox-item"));this.itemChildren=t;console.log(t);if(this.isCompositionMode){this.useSlot=true;setTimeout((()=>this.updateSlotElementsForItems()),0)}}updateSlotElementsForItems(){this.slotElements=this.itemChildren;this.slotElements.forEach(((t,e)=>{t.setAttribute("data-slot-index",String(e));t.setAttribute("role","option");t.setAttribute("tabindex","-1")}))}async filterComposition(t){const e=await Promise.all(this.itemChildren.map((e=>e.matchesQuery(t))));await Promise.all(this.itemChildren.map(((i,s)=>i.setHidden(t?!e[s]:false))));this.updateSlotElementsForItems()}render(){var t;return e(i,{key:"2cf857354080a92dd54240e8573060c7f1e29165",class:{"has-prefix":this.hasPrefix,"has-suffix":this.hasSuffix}},e("div",{key:"4219348fa0301c6d3f6776d883c5c0dde2d64d7f",class:"input-wrapper"},e("span",{key:"757dd8e5a74bc4d67c1a7729c2281464f4a14114",class:"prefix-container","aria-hidden":!this.hasPrefix},e("slot",{key:"22550fe813163399e129ef453fd6278bb2bda31a",name:"prefix",ref:t=>this.prefixSlotRef=t})),e("input",{key:"02e2abc4861d48ada88d996341199fa7facf5fc2",ref:t=>this.inputRef=t,type:"text",class:"form-control",role:"combobox",id:this.id,value:((t=this.selectedOption)===null||t===void 0?void 0:t.label)||"",placeholder:this.placeholder,"aria-expanded":String(this.isOpen),"aria-autocomplete":"list","aria-controls":this.dropdownId,"data-reference":"parent","aria-haspopup":"listbox","aria-activedescendant":this.focusedIndex>=0?`${this.dropdownId}-option-${this.focusedIndex}`:null,"aria-label":"Combobox","aria-required":true,onKeyDown:this.handleKeyDown,onInput:this.handleInput}),e("span",{key:"d87a12287cf5d927a73295ef48172a03893880bb",class:"suffix-container","aria-hidden":!this.hasSuffix},e("slot",{key:"ac19715c0917766b21af45be0d86af1041247802",name:"suffix",ref:t=>this.suffixSlotRef=t}))),e("div",{key:"a12031e96beadcd8a299cf551ea6c93a30cb742e",class:`dropdown ${this.isOpen?"show":""}`},e("div",{key:"bdf3889237a3c0fc6eeb6c7008036431a4194150",ref:t=>this.dropdownRef=t,class:`dropdown-menu ${this.isOpen?"show":""}`,id:this.dropdownId,role:"listbox","aria-expanded":String(this.isOpen)},this.isCompositionMode?e("slot",null):this.useSlot?e("slot",{name:"dropdown-content"}):[this.loading&&e("div",{class:"dropdown-item loading"},"Loading..."),!this.loading&&this.filteredOptions.length===0&&e("div",{class:"dropdown-item no-results"},"No results found"),!this.loading&&this.filteredOptions.map(((t,i)=>{var s;return e("button",{id:`${this.dropdownId}-option-${i}`,class:`dropdown-item ${this.focusedIndex===i?"active":""}`,role:"option","aria-selected":((s=this.selectedOption)===null||s===void 0?void 0:s.value)===t.value?"true":"false",onClick:()=>this.selectOption(t),onMouseEnter:()=>this.focusedIndex=i,innerHTML:t.html_content},t.html_content?null:t.label)}))])))}get el(){return n(this)}static get watchers(){return{options:["watchOptionsChanged"],useSlot:["watchUseSlotChanged"]}}};Bd.style=Sd;const Id=".backdropModal.sc-ir-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-modal{padding:1rem;background:white;border-radius:5px}.ir-alert-header.sc-ir-modal{display:flex;font-size:1rem;font-weight:700}.modal.sc-ir-modal{z-index:1001 !important}.modal-dialog.sc-ir-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-modal{gap:10px}.ir-modal.sc-ir-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const jd=Id;const zd=class{constructor(e){t(this,e);this.confirmModal=s(this,"confirmModal",7);this.cancelModal=s(this,"cancelModal",7);this.middleModal=s(this,"middleModal",7);this.modalTitle="Modal Title";this.modalBody="Modal Body";this.rightBtnActive=true;this.leftBtnActive=true;this.middleBtnActive=false;this.rightBtnText="Confirm";this.leftBtnText="Close";this.middleBtnText="More";this.isLoading=false;this.isMiddleButtonLoading=false;this.autoClose=true;this.rightBtnColor="primary";this.leftBtnColor="secondary";this.middleBtnColor="info";this.btnPosition="right";this.iconAvailable=false;this.icon="";this.isOpen=false;this.item={}}async openModal(){this.isOpen=true}async closeModal(){this.isOpen=false}btnClickHandler(t){let e=t.target;let i=e.name;if(i===this.leftBtnText){this.cancelModal.emit();this.item={};this.closeModal()}else if(i===this.middleBtnText){this.middleModal.emit(this.item);this.item={};if(this.autoClose)this.closeModal()}else if(i===this.rightBtnText){this.confirmModal.emit(this.item);this.item={};if(this.autoClose){this.closeModal()}}}render(){return[e("div",{key:"69e58b1fc40d01fc743598447f947edc1cf1c337",class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{this.cancelModal.emit();if(this.autoClose&&!this.isLoading){this.closeModal()}}}),e("div",{key:"e2187276ab9683e03588cc8591d418374c2f11ee","data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},e("div",{key:"15285fea92dd2f4f4007883aabb39f1e60abf2e7",class:`ir-alert-content p-2`},this.showTitle&&e("div",{key:"a3a1a5d646a43687f35259af59a04b563b920e1c",class:`ir-alert-header`},e("p",{key:"715b06d25c4ecdc9497ec37f30434752b092549a"},this.modalTitle)),e("div",{key:"721a6b8a8f69fb088c67814f3ba31dcd0c3f2281",class:"modal-body text-left p-0 mb-2"},e("div",{key:"f9bc497c7576b791f9df9cd273754be62e3f0767"},this.modalBody)),e("div",{key:"0ffc57e450d94ff2f8ab4d160cd148376f95140f",class:`ir-alert-footer border-0  d-flex justify-content-${this.btnPosition==="center"?"center":this.btnPosition==="left"?"start":"end"}`},this.leftBtnActive&&e("ir-button",{key:"1f19e5579b3d8565e72bf88cc870fd81823bb9a7",btn_disabled:this.isLoading,btn_color:this.leftBtnColor,btn_block:true,text:this.leftBtnText,name:this.leftBtnText}),this.middleBtnActive&&e("ir-button",{key:"ba46d555eb0becab55bf53e015a3e2e716f20140",btn_disabled:this.isMiddleButtonLoading,btn_color:this.middleBtnColor,btn_block:true,text:this.middleBtnText,isLoading:this.isMiddleButtonLoading,name:this.middleBtnText}),this.rightBtnActive&&e("ir-button",{key:"3d9ca1733d76110adc3527df96183a0c0f68adc0",btn_color:this.rightBtnColor,btn_disabled:this.isLoading,isLoading:this.isLoading,btn_block:true,text:this.rightBtnText,name:this.rightBtnText}))))]}};zd.style=jd;const Nd=".sc-ir-monthly-bookings-report-h{display:block}";const Rd=Nd;var $d=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const Fd=class{constructor(e){t(this,e);this.language="";this.ticket="";this.isPageLoading=true;this.isLoading=null;this.reports=[];this.tokenService=new pt;this.roomService=new bt;this.propertyService=new en}componentWillLoad(){this.baseFilters={date:{description:D().format("MMMM YYYY"),firstOfMonth:D().startOf("month").format("YYYY-MM-DD"),lastOfMonth:D().endOf("month").format("YYYY-MM-DD")},include_previous_year:false};this.filters=this.baseFilters;if(this.ticket){this.tokenService.setToken(this.ticket);this.init()}}handleTicketChange(t,e){if(t!==e){this.tokenService.setToken(this.ticket);this.init()}}handleApplyFiltersChange(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=t.detail;this.getReports()}async init(){try{let t=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}if(!t){console.log(t);const e=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});t=e.My_Result.id}this.property_id=t;const e=[this.roomService.fetchLanguage(this.language),this.getReports()];if(this.propertyid){e.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true}))}await Promise.all(e)}catch(t){console.log(t)}finally{this.isPageLoading=false}}async getReports(t=false){try{const e=t=>({day:t.Date,units_booked:t.Units_booked,occupancy_percent:t.Occupancy,adr:t.ADR,rooms_revenue:t.Rooms_Revenue,total_guests:t===null||t===void 0?void 0:t.Total_Guests});this.isLoading=t?"export":"filter";const{date:i,include_previous_year:s}=this.filters;const a=[this.propertyService.getMonthlyStats({from_date:i.firstOfMonth,to_date:i.lastOfMonth,property_id:this.property_id,is_export_to_excel:t})];if(s){a.push(this.propertyService.getMonthlyStats({from_date:D(i.firstOfMonth,"YYYY-MM-DD").add(-1,"year").format("YYYY-MM-DD"),to_date:D(i.lastOfMonth,"YYYY-MM-DD").add(-1,"years").format("YYYY-MM-DD"),property_id:this.property_id}))}const n=await Promise.all(a);const o=n[0];let r=[];const{DailyStats:l}=o,c=$d(o,["DailyStats"]);this.stats=Object.assign({},c);if(s&&n[t?0:1]){const i=n[t?0:1];let s=i.DailyStats.map(e);r=l.map(e).map((t=>{const e=s.find((e=>e.day===D(t.day,"YYYY-MM-DD").add(-1,"years").format("YYYY-MM-DD")));return Object.assign(Object.assign({},t),{last_year:e!==null&&e!==void 0?e:null})}))}else{r=l.map(e)}this.reports=[...r]}catch(t){console.log(t)}finally{this.isLoading=null}}render(){var t,s,a,n,o,r,l,c,d,h,u,f,p;if(this.isPageLoading){return e("ir-loading-screen",null)}return e(i,null,e("ir-toast",null),e("ir-interceptor",null),e("section",{class:"p-2 d-flex flex-column",style:{gap:"1rem"}},e("div",{class:"d-flex align-items-center justify-content-between"},e("h3",{class:"mb-1 mb-md-0"},"Daily Occupancy"),e("ir-button",{size:"sm",btn_color:"outline",isLoading:this.isLoading==="export",text:(t=y.entries)===null||t===void 0?void 0:t.Lcz_Export,onClickHandler:async t=>{t.stopImmediatePropagation();t.stopPropagation();await this.getReports(true)},btnStyle:{height:"100%"},iconPosition:"right",icon_name:"file",icon_style:{"--icon-size":"14px"}})),e("section",null,e("div",{class:"d-flex flex-column flex-md-row w-100",style:{gap:"1rem",alignItems:"stretch"}},e("ir-stats-card",{icon:((s=this.stats)===null||s===void 0?void 0:s.Occupancy_Difference_From_Previous_Month)<0?"arrow-trend-down":"arrow-trend-up",cardTitle:"Average Occupancy",value:this.stats.AverageOccupancy?((a=this.stats)===null||a===void 0?void 0:a.AverageOccupancy.toFixed(2))+"%":null,subtitle:`${((n=this.stats)===null||n===void 0?void 0:n.Occupancy_Difference_From_Previous_Month)<0?"":"+"}${(o=this.stats)===null||o===void 0?void 0:o.Occupancy_Difference_From_Previous_Month.toFixed(2)}% from last month`}),e("ir-stats-card",{icon:"hotel",cardTitle:"Total Units",value:((r=this.stats)===null||r===void 0?void 0:r.TotalUnitsBooked)?(l=this.stats)===null||l===void 0?void 0:l.TotalUnitsBooked.toString():null,subtitle:"Booked"}),e("ir-stats-card",{icon:"user_group",cardTitle:"Total Guests",value:(d=(c=this.stats)===null||c===void 0?void 0:c.Total_Guests)===null||d===void 0?void 0:d.toString(),subtitle:"Stayed"}),e("ir-stats-card",{icon:"calendar",cardTitle:"Peak Days",value:((h=this.stats)===null||h===void 0?void 0:h.PeakDays.length)===0?null:(f=(u=this.stats)===null||u===void 0?void 0:u.PeakDays)===null||f===void 0?void 0:f.map((t=>D(t.Date,"YYYY-MM-DD").format("D").concat("th"))).join(" - "),subtitle:`${Math.max(...((p=this.stats.PeakDays)===null||p===void 0?void 0:p.map((t=>t.OccupancyPercent)))||[])}% occupancy`})),e("div",{class:"d-flex flex-column flex-lg-row mt-1 ",style:{gap:"1rem"}},e("ir-monthly-bookings-report-filter",{isLoading:this.isLoading==="filter",class:"filters-card",baseFilters:this.baseFilters}),e("ir-monthly-bookings-report-table",{reports:this.reports})))))}static get watchers(){return{ticket:["handleTicketChange"]}}};Fd.style=Rd;const Ld=".sc-ir-monthly-bookings-report-filter-h{display:flex;height:100%;flex:1 1 0%}.sales-filters-card.sc-ir-monthly-bookings-report-filter{min-width:max-content;flex:1 1 0%}#salesFiltersCollapse.collapse.sc-ir-monthly-bookings-report-filter:not(.show){display:block}";const Pd=Ld;const Hd=class{constructor(e){t(this,e);this.applyFilters=s(this,"applyFilters",7);this.collapsed=false;this.dates=[]}componentWillLoad(){this.dates=this.generateMonths();this.filters=this.baseFilters}updateFilter(t){this.filters=Object.assign(Object.assign({},this.filters),t)}applyFiltersEvt(t){t.stopImmediatePropagation();t.stopPropagation();this.applyFilters.emit(this.filters)}resetFilters(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=this.baseFilters;this.applyFilters.emit(this.filters)}generateMonths(){const t=D().startOf("month");const e=D().subtract(1,"year").startOf("month");const i=[];const s="YYYY-MM-DD";let a=e.clone();while(a.format(s)!==t.format(s)){i.push({description:a.format("MMMM YYYY"),firstOfMonth:a.format("YYYY-MM-DD"),lastOfMonth:a.clone().endOf("month").format("YYYY-MM-DD")});a.add(1,"month")}i.push({description:t.format("MMMM YYYY"),firstOfMonth:t.format("YYYY-MM-DD"),lastOfMonth:t.clone().endOf("month").format("YYYY-MM-DD")});return i.reverse()}render(){var t,i,s,a,n,o,r,l;return e("div",{key:"59c4f7c6946484e3dc14a1cc9293fd7ad73c0f02",class:"card mb-0 p-1 d-flex flex-column sales-filters-card"},e("div",{key:"5cc9dffcd37170e8a98c7b22f5332a7a39a50dc6",class:"d-flex align-items-center justify-content-between sales-filters-header"},e("div",{key:"d11eccdc11e0eab6e613ba05815c71d26a371179",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"bb7551b5bf608db82cd878045a6cc8461349b683",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"f14768cb6070f48c47f698cb0b0d049dc7f4d692",fill:"currentColor",d:"M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"})),e("h4",{key:"2348d0895183567a72d4ead0fd67818962b1d00c",class:"m-0 p-0 flex-grow-1"},((t=y.entries)===null||t===void 0?void 0:t.Lcz_Filters)||"Filters"))),e("div",{key:"ef7dc009b1453baa7b03c77659f6a11b2396d56f",class:"m-0 p-0 collapse filters-section",id:"salesFiltersCollapse"},e("fieldset",{key:"4d3f5d117e6c82ef62def9005cec8090b42d6272",class:"pt-1 filter-group"},e("label",{key:"019ce90d99af1eb14537dedcd51217801c0a368d",htmlFor:"rooms",class:"m-0 px-0",style:{paddingBottom:"0.25rem"}},"For"),e("ir-select",{key:"9c65550a73e9a044ab791fd746e0b6a4d958c283",showFirstOption:false,selectedValue:(s=(i=this.filters)===null||i===void 0?void 0:i.date)===null||s===void 0?void 0:s.description,onSelectChange:t=>{this.updateFilter({date:this.dates.find((e=>e.description===t.detail))})},data:this.dates.map((t=>({text:t.description,value:t.description})))})),e("div",{key:"ce3189675c18cd9f6b40f53399e73939ba69fffd",class:"d-flex align-items-center mt-1 mb-2 compare-year-toggle",style:{gap:"0.5rem"}},e("label",{key:"7eb4d6a810418113238c0e75f5f175e177b1bda9",htmlFor:"compare-prev-year",style:{paddingBottom:"0.25rem"}},"Compare with previous year"),e("ir-checkbox",{key:"18214371e83515ebf9b73ae6b6cd11ec38e9172e",checked:(a=this.filters)===null||a===void 0?void 0:a.include_previous_year,checkboxId:"compare-prev-year",onCheckChange:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateFilter({include_previous_year:t.detail})}})),e("div",{key:"41c740096374b5e9cf0209ace6bf2830d3650b84",class:"d-flex align-items-center justify-content-end filter-actions",style:{gap:"1rem"}},e("ir-button",{key:"52e5d7d51847af3e2be56aa488003ee1021a2554",btn_type:"button","data-testid":"reset",text:(o=(n=y.entries)===null||n===void 0?void 0:n.Lcz_Reset)!==null&&o!==void 0?o:"Reset",size:"sm",btn_color:"secondary",onClickHandler:t=>this.resetFilters(t)}),e("ir-button",{key:"18b8ed9af5985f26c2b4d161b6a977164a8af5b4",btn_type:"button","data-testid":"apply",isLoading:this.isLoading,text:(l=(r=y.entries)===null||r===void 0?void 0:r.Lcz_Apply)!==null&&l!==void 0?l:"Apply",size:"sm",onClickHandler:t=>this.applyFiltersEvt(t)}))))}};Hd.style=Pd;const Ud=".sc-ir-monthly-bookings-report-table-h{display:block}.future-report.sc-ir-monthly-bookings-report-table td.sc-ir-monthly-bookings-report-table{background-color:hsla(210, 16%, 85.2%, 0.25) !important}.legend.sc-ir-monthly-bookings-report-table{height:12px;aspect-ratio:1;background:#000;border-radius:4px}.secondary.sc-ir-monthly-bookings-report-table{background:#6692b3}.progress-main.sc-ir-monthly-bookings-report-table{width:450px !important}";const Vd=Ud;const Gd=".ir-table-row.sc-ir-monthly-bookings-report-table td.sc-ir-monthly-bookings-report-table{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:white;white-space:nowrap}.table.sc-ir-monthly-bookings-report-table td.sc-ir-monthly-bookings-report-table{border-top:0;border-bottom:1px solid #e3ebf3;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-monthly-bookings-report-table thead.sc-ir-monthly-bookings-report-table th.sc-ir-monthly-bookings-report-table{border:none !important;background:#ececec;color:#374151;padding:0.5rem 1rem !important;text-align:left}.selected.sc-ir-monthly-bookings-report-table td.sc-ir-monthly-bookings-report-table{background:#e3f3fa !important}.selected.sc-ir-monthly-bookings-report-table td.sc-ir-monthly-bookings-report-table{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-monthly-bookings-report-table,.ir-table-row.sc-ir-monthly-bookings-report-table{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-monthly-bookings-report-table{text-transform:capitalize}.sortable.sc-ir-monthly-bookings-report-table:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-monthly-bookings-report-table:hover td.sc-ir-monthly-bookings-report-table{background:#e2e6ea3f !important}.sortable.sc-ir-monthly-bookings-report-table:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-monthly-bookings-report-table svg.sc-ir-monthly-bookings-report-table{color:var(--blue)}";const Kd=Gd;const Wd=class{constructor(e){t(this,e);this.reports=[]}render(){return e(i,{key:"6164d20455b9b49db9f4f045baab864606b57b45",class:"card p-1  table-container table-responsive"},e("table",{key:"ce28b962bbbacb2b5977154fbe52690da10ccdf2",class:"table"},e("thead",{key:"f77286353d4ac50497046616ab04be4f9958b0a5",class:"table-header"},e("tr",{key:"98a471f85c410a15480edc791dda95221555b148"},e("th",{key:"379e04effaf76e1c9025b70f25ef96afdb8494fc",class:"text-center"},"Date"),e("th",{key:"a72d6445625d0d71a51595e0e8324222e85e7164",class:"text-center"},"Units booked"),e("th",{key:"22a711b76738d9230c33fcf462f6fd619b4ba237",class:"text-center"},"Total guests"),e("th",{key:"1c3b3b8125c3c259fa163692b751137908e77349",class:"text-right"},e("ir-tooltip",{key:"7f7453c830d618b4dcafda2e1dce7cfa249aaeab",customSlot:true,message:"Average Daily Rate",alignment:"end"},e("span",{key:"de13498447891480094cad63baae0efbdad2095d",slot:"tooltip-trigger"},"ADR"))),e("th",{key:"bb590d13a74bcc6b5d66aac2695b9de8827e637a",class:"text-right"},"Rooms revenue"),e("th",{key:"6c9ac8d85cf3107416f83e64a6a9a613dac7cfab",class:""},"Occupancy"))),e("tbody",{key:"393b84d1b0e61b0d1cc0d5e9f2469b864c7e9497"},this.reports.length===0&&e("tr",{key:"d94c3d6b275a528f73ab95d5b22aa43c82fbebc9"},e("td",{key:"7adb8d628365f4e80d36aa80fed0f2a812e3025e",colSpan:3,class:"text-center",style:{height:"30vh"}},"No data found")),this.reports.map((t=>{var i,s,a,n,o,r,l,c,d,h,u;const f=`${parseFloat(t.occupancy_percent.toString()).toFixed(2)}%`;const p=t.last_year?`${parseFloat(t.last_year.occupancy_percent.toString()).toFixed(2)}%`:null;const b=D(t.day,"YYYY-MM-DD");const g=D().isBefore(b,"dates");return e("tr",{key:t.day,class:`ir-table-row ${g?"future-report":""}`},e("td",{class:"text-center"},b.format("D")),e("td",{class:"text-center"},e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("p",{class:`p-0 m-0 ${((i=t.last_year)===null||i===void 0?void 0:i.units_booked)?"font-weight-bold":""}`},t.units_booked),((s=t.last_year)===null||s===void 0?void 0:s.units_booked)>0&&e("p",{class:"p-0 m-0"},(a=t.last_year)===null||a===void 0?void 0:a.units_booked))),e("td",{class:"text-center"},e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("p",{class:`p-0 m-0 ${((n=t.last_year)===null||n===void 0?void 0:n.total_guests)?"font-weight-bold":""}`},t.total_guests),((o=t.last_year)===null||o===void 0?void 0:o.total_guests)>0&&e("p",{class:"p-0 m-0"},(r=t.last_year)===null||r===void 0?void 0:r.total_guests))),e("td",{class:"text-right"},e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("p",{class:`p-0 m-0 ${((l=t.last_year)===null||l===void 0?void 0:l.adr)?"font-weight-bold":""}`},_(x.currency.symbol,t.adr)),((c=t.last_year)===null||c===void 0?void 0:c.adr)>0&&e("p",{class:"p-0 m-0"},_(x.currency.symbol,t.last_year.adr)))),e("td",{class:"text-right"},e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("p",{class:`p-0 m-0 ${((d=t.last_year)===null||d===void 0?void 0:d.rooms_revenue)?"font-weight-bold":""}`},_(x.currency.symbol,t.rooms_revenue)),((h=t.last_year)===null||h===void 0?void 0:h.rooms_revenue)>0&&e("p",{class:"p-0 m-0"},_(x.currency.symbol,t.last_year.rooms_revenue)))),e("td",null,e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("ir-progress-indicator",{percentage:f}),((u=t.last_year)===null||u===void 0?void 0:u.occupancy_percent)>0&&e("ir-progress-indicator",{percentage:p,color:"secondary"}))))}))),e("tfoot",{key:"24068e3df967c08b37e063c2efc385aeb437c334"},e("tr",{key:"21b98423dc6f178ca078232943ec83c5d77927be"},e("td",{key:"f500ba7206dd4c60c529572d6cfdf1527428b8e1",colSpan:5}),e("td",{key:"a0196063d5ecd563541a1bd5245ea9044aa1c4f0",colSpan:1,class:"text-right",style:{whiteSpace:"nowrap"}},e("div",{key:"d64bdaee6a8754b66b180bdbc706f736ae2fcc8f",class:"d-flex align-items-center justify-content-end",style:{gap:"1rem",paddingTop:"0.5rem"}},e("div",{key:"fbb1c666fd2caab6ab3ae0d3aa5a2a97b2813a5e",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("div",{key:"0aa3d2ab726a778ec35a2f2fc3528bd0a13b138a",class:"legend bg-primary"}),e("p",{key:"d04a4ade7821a6d31575c40b9281593fdbbb56ba",class:"p-0 m-0"},"Selected period ")),e("div",{key:"0643b387df7c332454515cfc1f65bba88480b054",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("div",{key:"52a0499c68dbdbb9501236dc25b1071366f994ae",class:"legend secondary"}),e("p",{key:"31c0b1e20dcf563a78740239c751e809e279cc03",class:"p-0 m-0"},"Previous year"))))))))}};Wd.style=Vd+Kd;const qd=".otp-input-wrapper.sc-ir-otp{display:flex;gap:0.5rem;justify-content:space-evenly}.otp-digit.sc-ir-otp{--otp-size:3rem;width:var(--otp-size) !important;height:var(--otp-size) !important;padding:0;font-size:24px;font-weight:500;text-align:center;background-color:#fff;padding:0 !important}.otp-digit.sc-ir-otp:disabled{background-color:#e9ecef;cursor:not-allowed}input[type='number'].sc-ir-otp::-webkit-inner-spin-button,input[type='number'].sc-ir-otp::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type='number'].sc-ir-otp{-moz-appearance:textfield}@media (max-width: 480px){.otp-digit.sc-ir-otp{width:35px;height:45px;font-size:20px}.otp-input-wrapper.sc-ir-otp{gap:6px}}@media (max-width: 360px){.otp-digit.sc-ir-otp{width:30px;height:40px;font-size:18px}.otp-input-wrapper.sc-ir-otp{gap:4px}}";const Xd=qd;const Jd=class{constructor(e){t(this,e);this.otpChange=s(this,"otpChange",7);this.otpComplete=s(this,"otpComplete",7);this.length=6;this.disabled=false;this.placeholder="";this.type="number";this.autoFocus=true;this.secure=false;this.numbersOnly=false;this.otpValues=[];this.inputRefs=[];this.handleInput=(t,e)=>{const i=t.target;let s=i.value;if(this.numbersOnly){s=s.replace(/[^0-9]/g,"")}if(s.length>1){s=s.slice(-1);i.value=s}this.otpValues[e]=s;this.emitChanges();if(s&&e<this.length-1){this.inputRefs[e+1].focus()}};this.handleKeyDown=(t,e)=>{switch(t.key){case"Backspace":if(!this.otpValues[e]&&e>0){this.inputRefs[e-1].focus();t.preventDefault()}break;case"Delete":this.otpValues[e]="";this.emitChanges();break;case"ArrowLeft":if(e>0){this.inputRefs[e-1].focus();t.preventDefault()}break;case"ArrowRight":if(e<this.length-1){this.inputRefs[e+1].focus();t.preventDefault()}break;case"Home":this.inputRefs[0].focus();t.preventDefault();break;case"End":this.inputRefs[this.length-1].focus();t.preventDefault();break}};this.handlePaste=(t,e)=>{var i;t.preventDefault();const s=((i=t.clipboardData)===null||i===void 0?void 0:i.getData("text"))||"";const a=this.numbersOnly?s.replace(/[^0-9]/g,""):s;for(let t=0;t<Math.min(a.length,this.length-e);t++){this.otpValues[e+t]=a[t]}this.inputRefs.forEach(((t,e)=>{t.value=this.otpValues[e]||""}));const n=this.otpValues.findIndex((t=>!t));if(n!==-1&&n<this.length){this.inputRefs[n].focus()}else{this.inputRefs[this.length-1].focus()}this.emitChanges()};this.handleFocus=t=>{const e=t.target;if(e.value){setTimeout((()=>e.select()),0)}}}componentWillLoad(){this.otpValues=Array(this.length).fill("");if(this.defaultValue){this.setValue(this.defaultValue)}}componentDidLoad(){if(this.autoFocus&&this.inputRefs[0]){setTimeout((()=>{this.inputRefs[0].focus()}),0)}}handleLengthChange(t){if(t<1)return;const e=this.otpValues.length;if(t>e){this.otpValues=[...this.otpValues,...Array(t-e).fill("")]}else if(t<e){this.otpValues=this.otpValues.slice(0,t)}this.emitChanges()}emitChanges(){const t=this.otpValues.join("");this.otpChange.emit(t);if(this.otpValues.every((t=>t!==""))&&this.otpValues.length===this.length){this.otpComplete.emit(t)}}clear(){this.otpValues=Array(this.length).fill("");this.inputRefs.forEach((t=>{t.value=""}));this.emitChanges();if(this.inputRefs[0]){this.inputRefs[0].focus()}}setValue(t){const e=t.split("");for(let t=0;t<this.length;t++){this.otpValues[t]=t<e.length?e[t]:""}this.inputRefs.forEach(((t,e)=>{t.value=this.otpValues[e]||""}));this.emitChanges()}render(){return e(i,{key:"58782183618704c272f975054a15a40cd103c233",class:"otp-input-container"},e("div",{key:"03dc2d4a33305eecde92fe881e8efd48267482cc",class:"otp-input-wrapper"},Array(this.length).fill(null).map(((t,i)=>e("input",{ref:t=>this.inputRefs[i]=t,type:this.type,inputmode:this.numbersOnly?"numeric":"text",class:"otp-digit form-control input-sm",maxlength:"1",placeholder:this.placeholder,disabled:this.disabled,autocomplete:"one-time-code",value:this.otpValues[i],onInput:t=>this.handleInput(t,i),onKeyDown:t=>this.handleKeyDown(t,i),onPaste:t=>this.handlePaste(t,i),onFocus:this.handleFocus,"aria-label":`Digit ${i+1} of ${this.length}`})))))}static get watchers(){return{length:["handleLengthChange"]}}};Jd.style=Xd;class Qd{async validateOTP(t){const{data:e}=await gt.post("/Validate_Exposed_OTP",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e}async resendOTP(t){const{data:e}=await gt.post("/Resend_Exposed_OTP",t);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e}async checkOTPNecessity(t){const{data:e}=await gt.post("/Check_OTP_Necessity",t);return e}}const Zd=":host{display:block}:root{--otp-modal-padding:1.5rem}.modal-backdrop{background-color:rgba(0, 0, 0, 0.5) !important}.otp-modal-header{border-bottom:0px !important}.otp-modal{z-index:9999999 !important;border:none;padding:0 !important;box-sizing:border-box;border:1px solid rgba(0, 0, 0, 0.2);border-radius:0.35rem;outline:0}.otp-modal-content{background-color:white;border:none;border-radius:0.35rem;outline:0}.otp-modal-title{margin-bottom:0;line-height:1.45}.otp-modal-body{max-height:100% !important;padding:0 var(--otp-modal-padding)}.otp-modal-header{display:flex;justify-content:space-between;padding:var(--otp-modal-padding);padding-bottom:1rem;border-top-left-radius:0.35rem;border-top-right-radius:0.35rem}.otp-modal-dialog{z-index:9999999 !important}.otp-modal-footer{border-top:0 !important;display:flex;gap:0.5rem;flex-direction:column;padding:var(--otp-modal-padding);padding-top:0.5rem !important}.verification-message{max-width:90%}.modal-loading-container{height:250px;width:80vw}@media (min-width: 768px){.otp-modal-dialog,.otp-modal-content{width:fit-content !important}.otp-modal-footer{flex-direction:row;align-items:center}.modal-loading-container{width:380px !important}.verification-message{max-width:350px !important}}";const th=Zd;const eh=class{constructor(e){t(this,e);this.otpFinished=s(this,"otpFinished",7);this.language="en";this.resendTimer=60;this.showResend=true;this.otpLength=6;this.otp="";this.error="";this.isLoading=false;this.timer=60;this.systemService=new Qd;this.roomService=new bt;this.tokenService=new pt;this.otpVerificationSchema=N.object({email:N.string().nonempty(),requestUrl:N.string().nonempty(),otp:N.string().length(this.otpLength)});this.handleOtpComplete=t=>{this.error="";this.otp=t.detail}}componentWillLoad(){if(this.ticket){this.tokenService.setToken(this.ticket)}this.fetchLocale()}handleTicketChange(t,e){if(t!==e){this.tokenService.setToken(t);this.fetchLocale()}}handleKeyDownChange(t){var e;if(t.key==="Escape"&&((e=this.dialogRef)===null||e===void 0?void 0:e.open)){t.preventDefault()}}async openModal(){this.resetState();if(typeof this.dialogRef.showModal==="function"){this.dialogRef.showModal()}else{this.dialogRef.setAttribute("open","")}if(this.showResend)this.startTimer();await this.focusFirstInput()}async closeModal(){if(typeof this.dialogRef.close==="function"){this.dialogRef.close()}else{this.dialogRef.removeAttribute("open")}this.otp=null;this.clearTimer()}async fetchLocale(){if(!this.tokenService.getToken()){return}this.isInitializing=true;await this.roomService.fetchLanguage(this.language,["_USER_MGT"]);this.isInitializing=false}resetState(){this.otp="";this.error="";this.isLoading=false;this.timer=60;this.clearTimer()}startTimer(){this.clearTimer();this.timerInterval=window.setInterval((()=>{if(this.timer>0){this.timer--}else{this.clearTimer()}}),1e3)}clearTimer(){if(this.timerInterval){clearInterval(this.timerInterval);this.timerInterval=null}}async focusFirstInput(){await new Promise((t=>setTimeout(t,50)));const t=this.dialogRef.querySelector("input");t&&t.focus()}async verifyOtp(){if(this.otp.length<this.otpLength)return;this.isLoading=true;this.otpVerificationSchema.parse({otp:this.otp,requestUrl:this.requestUrl,email:this.email});try{await this.systemService.validateOTP({METHOD_NAME:this.requestUrl,OTP:this.otp});this.otpFinished.emit({otp:this.otp,type:"success"});this.closeModal()}catch(t){this.error="Verification failed. Please try again."}finally{this.isLoading=false}}async resendOtp(){if(this.timer>0)return;try{await this.systemService.resendOTP({METHOD_NAME:this.requestUrl});this.timer=60;this.startTimer()}catch(t){console.log(t)}}handleCancelClicked(){if(this.baseOTPUrl==="Check_OTP_Necessity"){this.closeModal();this.otpFinished.emit({otp:null,type:"cancelled"});return}window.location.reload()}disconnectedCallback(){this.clearTimer()}render(){var t;return e(i,{key:"997c73cdc54ef30ad2eb0957ef6b76edbc0e3ce7"},e("dialog",{key:"5352299b1ce8dc4b9309bbddb8fb87b832be5a90",ref:t=>this.dialogRef=t,class:"otp-modal","aria-modal":"true"},e("form",{key:"ed4600d53b55187b47ea4b473821f6fba80258d9",method:"dialog",class:"otp-modal-content"},this.isInitializing||!y.entries?e("div",{class:"d-flex align-items-center justify-content-center modal-loading-container"},e("ir-spinner",null)):e(a,null,e("header",{class:"otp-modal-header"},e("h5",{class:"otp-modal-title"},y.entries.Lcz_VerifyYourIdentity)),e("section",{class:"otp-modal-body d-flex align-items-center flex-column"},e("p",{class:"verification-message text-truncate"},y.entries.Lcz_WeSentYuoVerificationCode," ",this.email),e("ir-otp",{autoFocus:true,length:this.otpLength,defaultValue:this.otp,onOtpComplete:this.handleOtpComplete}),this.error&&e("p",{class:"text-danger small mt-1 p-0 mb-0"},this.error),this.showResend&&e(a,null,this.timer>0?e("p",{class:"small mt-1"},y.entries.Lcz_ResendCode," 00:",String(this.timer).padStart(2,"0")):e("ir-button",{class:"mt-1",btn_color:"link",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.resendOtp()},size:"sm",text:"Didnt receive code? Resend"}))),e("footer",{class:"otp-modal-footer justify-content-auto"},e("ir-button",{class:"w-100",btn_styles:"flex-fill",text:y.entries.Lcz_Cancel,btn_color:"secondary",onClick:this.handleCancelClicked.bind(this)}),e("ir-button",{class:"w-100",btn_styles:"flex-fill",text:y.entries.Lcz_VerifyNow,isLoading:this.isLoading,btn_disabled:((t=this.otp)===null||t===void 0?void 0:t.length)<this.otpLength||this.isLoading,onClick:()=>this.verifyOtp()}))))))}static get watchers(){return{ticket:["handleTicketChange"]}}};eh.style=th;const ih=".sc-ir-pagination-h{display:block;font-family:var(--font-family, inherit);font-size:var(--font-size, 0.875rem);color:var(--text-color, #333)}.pagination-container.sc-ir-pagination{gap:1rem;padding:0.5rem 0;min-height:2.5rem}.pagination-container.disabled.sc-ir-pagination{opacity:0.6;pointer-events:none}.pagination-info.sc-ir-pagination{color:var(--text-muted, #6c757d);font-size:var(--font-size-sm, 0.875rem);white-space:nowrap}.buttons-container.sc-ir-pagination{gap:0.25rem;flex-wrap:wrap}.buttons-container.sc-ir-pagination ir-button.sc-ir-pagination{flex-shrink:0}@media (max-width: 768px){.pagination-container.sc-ir-pagination{gap:0.75rem}.pagination-info.sc-ir-pagination{text-align:center;order:2;margin-top:0.5rem !important;margin-bottom:0 !important}.buttons-container.sc-ir-pagination{order:1;justify-content:center}}@media (max-width: 480px){.pagination-container.sc-ir-pagination{gap:0.5rem}.buttons-container.sc-ir-pagination{gap:0.125rem}}@media (prefers-contrast: high){.pagination-info.sc-ir-pagination{color:var(--text-color, #000)}.pagination-container.disabled.sc-ir-pagination{opacity:0.8}}@media (prefers-reduced-motion: reduce){*.sc-ir-pagination{transition:none !important}}";const sh=ih;const ah=class{constructor(e){t(this,e);this.pageChange=s(this,"pageChange",7);this.pageSizeChange=s(this,"pageSizeChange",7);this.firstPage=s(this,"firstPage",7);this.lastPage=s(this,"lastPage",7);this.previousPage=s(this,"previousPage",7);this.nextPage=s(this,"nextPage",7);this.pages=0;this.total=0;this.currentPage=1;this.showing={from:0,to:0};this.showTotalRecords=true;this.recordLabel="";this.disabled=false;this.pageSize=10}validateCurrentPage(t){if(t<1){console.warn("currentPage must be greater than 0")}if(t>this.pages){console.warn("currentPage cannot be greater than total pages")}}validatePages(t){if(t<0){console.warn("pages must be greater than or equal to 0")}}renderItemRange(){if(!this.showTotalRecords){return""}const t=Math.max(this.showing.from,1);const e=Math.min(this.showing.to,this.total);return`${"View"} ${t} - ${e} ${"of"} ${this.total} ${this.recordLabel}`}handlePageChange(t,e="direct"){if(this.disabled||t<1||t>this.pages||t===this.currentPage){return}const i={currentPage:t,totalPages:this.pages,pageSize:this.pageSize};switch(e){case"first":this.firstPage.emit(i);break;case"previous":this.previousPage.emit(i);break;case"next":this.nextPage.emit(i);break;case"last":this.lastPage.emit(i);break}this.pageChange.emit(i)}handlePageSizeChange(t){const e={currentPage:this.currentPage,totalPages:this.pages,pageSize:t};this.pageSizeChange.emit(e)}shouldRender(){return this.pages>0&&this.total>0}render(){if(!this.shouldRender()){return null}const t=this.currentPage===1;const s=this.currentPage===this.pages;return e(i,{class:{"d-flex flex-column flex-md-row align-items-center justify-content-between pagination-container":true,disabled:this.disabled},role:"navigation","aria-label":"Pagination Navigation"},this.showTotalRecords&&e("p",{class:"m-0 mb-1 mb-md-0 pagination-info","aria-live":"polite"},this.renderItemRange()),e("div",{class:"d-flex align-items-center buttons-container"},this.allowPageSizeChange&&this.pageSizes&&e("ir-select",{selectedValue:String(this.pageSize),data:this.pageSizes.map((t=>({text:`${t} ${this.recordLabel}`,value:String(t)}))),showFirstOption:false,style:{margin:"0 0.5rem"},onSelectChange:t=>this.handlePageSizeChange(Number(t.detail))}),this.pages>1&&e(a,null,e("ir-button",{size:"sm",btn_disabled:t||this.disabled,onClickHandler:()=>this.handlePageChange(1,"first"),icon_name:"angles_left",style:{"--icon-size":"0.875rem"},"aria-label":"Go to first page"}),e("ir-button",{size:"sm",btn_disabled:t||this.disabled,onClickHandler:()=>this.handlePageChange(this.currentPage-1,"previous"),icon_name:"angle_left",style:{"--icon-size":"0.875rem"},"aria-label":"Go to previous page"}),e("ir-select",{selectedValue:this.currentPage.toString(),showFirstOption:false,onSelectChange:t=>this.handlePageChange(+t.detail,"direct"),data:Array.from(Array(this.pages),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()}))),"aria-label":`Current page ${this.currentPage} of ${this.pages}`,disabled:this.disabled}),e("ir-button",{size:"sm",btn_disabled:s||this.disabled,onClickHandler:()=>this.handlePageChange(this.currentPage+1,"next"),icon_name:"angle_right",style:{"--icon-size":"0.875rem"},"aria-label":"Go to next page"}),e("ir-button",{size:"sm",btn_disabled:s||this.disabled,onClickHandler:()=>this.handlePageChange(this.pages,"last"),icon_name:"angles_right",style:{"--icon-size":"0.875rem"},"aria-label":"Go to last page"}))))}static get watchers(){return{currentPage:["validateCurrentPage"],pages:["validatePages"]}}};ah.style=sh;const nh=".sc-ir-password-validator-h{display:block}";const oh=nh;const rh=class{constructor(e){t(this,e);this.passwordValidationChange=s(this,"passwordValidationChange",7);this.password=""}handlePasswordChange(t,e){if(t!==e){this.passwordValidationChange.emit(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()\-_=+]).{8,16}$/.test(t))}}get validLength(){if(!this.password){return false}return this.password.length>=8&&this.password.length<=16}get hasUppercase(){if(!this.password){return false}return/[A-Z]/.test(this.password)}get hasLowercase(){if(!this.password){return false}return/[a-z]/.test(this.password)}get hasDigit(){if(!this.password){return false}return/[0-9]/.test(this.password)}get hasSpecialChar(){if(!this.password){return false}return/[!@#$%^&*()\-_=+]/.test(this.password)}render(){return e("div",{key:"29fe82e7dc23a5bb2164614d611cb6ef0375b46b",class:"m-0 p-0"},e("requirement-check",{key:"d563a380e71c819d93c8903e02c5f40569087d6c",isValid:this.validLength,text:"Minimum 8 characters"}),e("requirement-check",{key:"2017a8bdbc48185131728e1ad397b779d8c25550",isValid:this.hasUppercase,text:"At least one uppercase letter"}),e("requirement-check",{key:"5f2ef1c2768ca5669b5abe9636af1e17ce6fd5a4",isValid:this.hasLowercase,text:"At least one lowercase letter"}),e("requirement-check",{key:"1ccb3e26b2a8f6d99d07552fc981b0f8e4b27fb9",isValid:this.hasDigit,text:"At least one digit"}),e("requirement-check",{key:"9d1fb0379715f0c5df60a1d5a13c61a9c7e3eb96",isValid:this.hasSpecialChar,text:"At least one special character"}))}static get watchers(){return{password:["handlePasswordChange"]}}};rh.style=oh;const lh=".sc-ir-payment-action-h{display:block;--label-col:6rem;--amount-col:1ch;--payment-action-bg:rgba(255, 73, 97, 10%);--payment-action-border:rgba(255, 73, 97, 40%)}.action-container.overdue.sc-ir-payment-action{--payment-action-bg:rgba(255, 73, 97, 5%);--payment-action-border:rgba(255, 73, 97, 40%)}.action-container.future.sc-ir-payment-action{--payment-action-bg:rgb(30, 159, 242, 5%);--payment-action-border:rgba(30, 159, 242, 40%)}.action-container.overdue.sc-ir-payment-action:hover{--payment-action-bg:rgba(255, 73, 97, 10%);--payment-action-border:rgba(255, 73, 97, 50%)}.action-container.future.sc-ir-payment-action:hover{--payment-action-bg:rgb(30, 159, 242, 10%);--payment-action-border:rgba(30, 159, 242, 50%)}.action-container.sc-ir-payment-action{display:flex;align-items:center;gap:1rem;background:var(--payment-action-bg);padding:0.5rem 1rem;box-sizing:border-box;border:1px solid var(--payment-action-border);border-radius:0.25rem;transition:all 0.3s ease-in-out}.overdue_action.sc-ir-payment-action,.future_action.sc-ir-payment-action{display:inline-flex;align-items:center;gap:0.5rem;border-radius:0.25rem;min-width:0}.action-container.overdue.sc-ir-payment-action .overdue_action.sc-ir-payment-action{color:#ff4961}.future_action.sc-ir-payment-action{color:#1e9ff2}.payment-meta.sc-ir-payment-action{display:flex;align-items:center;gap:1rem}.alert-message.sc-ir-payment-action{display:none}.action-container.overdue.sc-ir-payment-action .alert-message.sc-ir-payment-action{text-transform:capitalize}.amount_action.sc-ir-payment-action{font-weight:600;font-variant-numeric:tabular-nums;text-align:right;justify-self:end;white-space:nowrap}.meta-grid.sc-ir-payment-action{display:flex;flex-direction:column;flex:1 1 0%}.payment-reason.sc-ir-payment-action{font-size:12px;color:hsl(230, 10%, 46%, 80%)}.date_action.sc-ir-payment-action{font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.action-container.sc-ir-payment-action p.sc-ir-payment-action{margin:0;padding:0}.action-row.sc-ir-payment-action{display:contents}@media (min-width: 640px){.sc-ir-payment-action-h{--amount-col:8ch}.alert-message.sc-ir-payment-action{display:inline-flex}.amount_action.sc-ir-payment-action{justify-self:auto}.action-container.sc-ir-payment-action{display:grid;grid-template-columns:var(--label-col) 1fr auto;align-items:center}.payment-meta.sc-ir-payment-action{display:grid;grid-template-columns:var(--amount-col) 1fr;align-items:center;column-gap:1rem;min-width:0}}";const ch=lh;const dh=class{constructor(e){t(this,e);this.generatePayment=s(this,"generatePayment",7)}render(){const t=this.paymentAction.type.toLowerCase();const i=t==="future";return e("div",{key:"a0c1de8da0c96b0ba1d03e19901366a26245baf8",class:`action-container ${i?"future":"overdue"}`},e("div",{key:"596590dcef716f23b191f8f13e71cdc8f8144ed4",class:"action-row"},!i&&e("div",{key:"4fa7b061fc8444d2ec94d3d17c6f049755ac8d2c",class:"overdue_action"},e("svg",{key:"06156c7f0a9ef6cc890bff665caf742803184caf",height:16,width:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e("path",{key:"41f1fe45c1ffb9bce8c8bcbfa5a0c20ccf600342",fill:"currentColor",d:"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})),e("span",{key:"82126fb4e4a5d33a2da8d1d60de23d9521b6343f",class:"alert-message"},t)),t==="future"&&this.paymentAction.amount>0&&e("div",{key:"b3c43d1245c39a302601ca1bd906b9d2c9cdba3b",class:"future_action "},e("svg",{key:"478944ba35ad9df65ab1760948ed03ac45384136",xmlns:"http://www.w3.org/2000/svg",height:16,width:16,viewBox:"0 0 512 512"},e("path",{key:"49600735567142c3eca4cd5a1122364a32d392b0",fill:"currentColor",d:"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"})),e("span",{key:"d181b5c72fe65e48e1fd866a9e1a032ed59ec1ec",class:"alert-message"},D(new Date(this.paymentAction.due_on)).isSame(new Date)?"Today":"Future")),e("div",{key:"710698a3d329b2676406f8cc525e62b3626aa8fc",class:"meta-grid"},e("div",{key:"c1a7f4ce2bd44d5c9090e18c968393bcbb818db4",class:"payment-meta"},e("p",{key:"59aa2698dce216918690c25a8767df7e54cefea0",class:"amount_action"},_(this.paymentAction.currency.symbol,this.paymentAction.amount)),e("p",{key:"6e815eafef093d3e5ff7603ecb1a8604f94fc419",class:"date_action"},D(new Date(this.paymentAction.due_on)).format("ddd, MMM DD YYYY"))))),e("div",{key:"12c261a6ad92f6df2f6f354506b7632649cd58ff",style:{width:"fit-content"}},e("ir-button",{key:"479215e1b9695892f500fae6d0bcdaaa54600ca7",btn_color:"dark",text:"Pay",size:"sm",onClickHandler:()=>this.generatePayment.emit(this.paymentAction)})))}};dh.style=ch;const hh=".sc-ir-payment-actions-h{display:block}.sc-ir-payment-actions-h p.sc-ir-payment-actions,.sc-ir-payment-actions-h div.sc-ir-payment-actions,.sc-ir-payment-actions-h span.sc-ir-payment-actions,.sc-ir-payment-actions-h ir-icons.sc-ir-payment-actions{box-sizing:border-box;padding:0;margin:0}.beta.sc-ir-payment-actions{background:var(--red);color:white;padding:0.2rem 0.3rem !important;font-size:12px;border-radius:4px;margin:0}.payment-actions-container.sc-ir-payment-actions{display:flex;flex-direction:column;gap:0.5rem}";const uh=hh;const fh=class{constructor(e){t(this,e)}render(){var t,s;if(((t=this.paymentAction)===null||t===void 0?void 0:t.filter((t=>t.amount!==0)).length)==0){return null}return e(i,null,e("div",{class:"my-1 d-flex align-items-center",style:{gap:"0.5rem"}},e("p",{class:"font-size-large p-0 m-0 "},"Payment Actions"),e("span",{class:"beta"},"Beta")),e("div",{class:"payment-actions-container"},(s=this.paymentAction)===null||s===void 0?void 0:s.map(((t,i)=>e("ir-payment-action",{key:t.due_on+i,paymentAction:t})))))}};fh.style=uh;const ph=".sc-ir-payment-details-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-payment-details-h *.sc-ir-payment-details{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}.total-cost-container.sc-ir-payment-details{background:#7cbebe;color:white;padding:0.5rem;border-radius:5px}";const bh=ph;const gh=class{constructor(e){t(this,e);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.resetExposedCancellationDueAmount=s(this,"resetExposedCancellationDueAmount",7);this.toast=s(this,"toast",7);this.openSidebar=s(this,"openSidebar",7);this.confirmModal=false;this.toBeDeletedItem=null;this.modalMode=null;this.paymentService=new ua;this.bookingService=new l;this.handleAddPayment=()=>{this.openSidebar.emit({type:"payment-folio",payload:{payment:{id:-1,date:D().format("YYYY-MM-DD"),amount:null,currency:undefined,designation:null,reference:null},mode:"new"}})};this.handleEditPayment=t=>{this.openSidebar.emit({type:"payment-folio",payload:{payment:t,mode:"edit"}})};this.handleDeletePayment=t=>{this.modalMode="delete";this.toBeDeletedItem=t;this.openModal()};this.handleConfirmModal=async t=>{t.stopImmediatePropagation();t.stopPropagation();if(this.modalMode==="delete"){await this.cancelPayment()}};this.handleCancelModal=t=>{t.stopImmediatePropagation();t.stopPropagation();this.modalMode=null;this.toBeDeletedItem=null}}handlePaymentGeneration(t){var e,i,s;const a=t.detail;const n=(i=(e=this.paymentEntries)===null||e===void 0?void 0:e.types)===null||i===void 0?void 0:i.find((t=>t.CODE_NAME===(this.booking.status.code==="003"?a.pay_type_code:"001")));this.openSidebar.emit({type:"payment-folio",payload:{payment:Object.assign(Object.assign({},a),{date:D().format("YYYY-MM-DD"),id:-1,amount:a.amount,payment_type:n?{code:n.CODE_NAME,description:n.CODE_VALUE_EN,operation:n.NOTES}:null,designation:(s=n===null||n===void 0?void 0:n.CODE_VALUE_EN)!==null&&s!==void 0?s:null}),mode:"payment-action"}})}async cancelPayment(){try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.booking.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.booking=Object.assign(Object.assign({},this.booking),{financial:Object.assign(Object.assign({},this.booking.financial),{payments:t})});this.confirmModal=false;this.resetBookingEvt.emit(null);this.resetExposedCancellationDueAmount.emit(null);this.toBeDeletedItem=null;this.modalMode=null}catch(t){console.error("Error canceling payment:",t);this.toast.emit({type:"error",title:"Error",description:"Failed to cancel payment. Please try again.",position:"top-right"})}}openModal(){const t=document.querySelector(".delete-record-modal");t===null||t===void 0?void 0:t.openModal()}hasValidFinancialData(){var t;return Boolean((t=this.booking)===null||t===void 0?void 0:t.financial)}shouldShowPaymentActions(){var t;return Boolean(((t=this.paymentActions)===null||t===void 0?void 0:t.filter((t=>t.amount!==0)).length)>0&&this.booking.is_direct)}render(){if(!this.hasValidFinancialData()){return null}const{financial:t,currency:i}=this.booking;return[e("div",{class:"card p-1"},e("ir-payment-summary",{totalCost:t.gross_cost,balance:t.due_amount,collected:this.booking.financial.collected,currency:i}),e("ir-booking-guarantee",{booking:this.booking,bookingService:this.bookingService}),this.shouldShowPaymentActions()&&e("ir-payment-actions",{paymentAction:this.paymentActions,booking:this.booking})),e("ir-payments-folio",{payments:t.payments||[],onAddPayment:this.handleAddPayment,onEditPayment:t=>this.handleEditPayment(t.detail),onDeletePayment:t=>this.handleDeletePayment(t.detail)}),e("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:y.entries.Lcz_Confirmation,modalBody:this.modalMode==="delete"?y.entries.Lcz_IfDeletedPermantlyLost:y.entries.Lcz_EnteringAmountGreaterThanDue,iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:y.entries.Lcz_Cancel,rightBtnText:this.modalMode==="delete"?y.entries.Lcz_Delete:y.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modalMode==="delete"?"danger":"primary",onConfirmModal:this.handleConfirmModal,onCancelModal:this.handleCancelModal})]}};gh.style=bh;const mh=["001","010"];const vh=".sc-ir-payment-folio-h{display:block;--payment-type-badge-bg:#ff4961}.payment-type-badge.sc-ir-payment-folio{background:var(--payment-type-badge-bg);color:white;padding:0.2rem 0.3rem !important;font-size:12px;border-radius:4px;margin:0;text-transform:capitalize}.credit-badge.sc-ir-payment-folio{--payment-type-badge-bg:#629a4c}.debit-badge.sc-ir-payment-folio{--payment-type-badge-bg:#ff4961}.dropdown-item-payment.sc-ir-payment-folio{display:flex;align-items:center;gap:1rem;box-sizing:border-box;justify-content:space-between}.input-group-text.sc-ir-payment-folio{border-color:#cacfe7 !important}";const yh=vh;const kh=".sc-ir-payment-folio-h{height:100%}.sheet-container.sc-ir-payment-folio{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-payment-folio{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-payment-folio{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-payment-folio{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-payment-folio{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-payment-folio{flex-direction:row;align-items:center}}";const wh=kh;const xh=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.resetExposedCancellationDueAmount=s(this,"resetExposedCancellationDueAmount",7);this.payment={date:D().format("YYYY-MM-DD"),amount:0,designation:undefined,currency:null,reference:null,id:-1};this.autoValidate=false;this._paymentTypes={};this.paymentService=new ua}componentWillLoad(){this.folioSchema=N.object({date:N.string().regex(/^\d{4}-\d{2}-\d{2}$/).refine((t=>{const e=D(t,"YYYY-MM-DD",true);return e.isValid()}),{message:`Invalid date`}),amount:N.coerce.number().refine((t=>t!==0)),reference:N.string().optional().nullable(),designation:N.string().min(1),payment_type:N.object({code:N.string().min(3).max(4),description:N.string().min(1),operation:N.union([N.literal("CR"),N.literal("DB")])}),payment_method:N.object({code:N.string().min(3).max(4),description:N.string().min(1)})});if(this.payment){this.folioData=Object.assign({},this.payment)}this.getPaymentTypes()}handlePaymentChange(t,e){if(t!==e&&t){this.folioData=Object.assign({},t);this.getPaymentTypes()}}handlePaymentTypesChange(t,e){if(t!==e&&t){this.getPaymentTypes()}}updateFolioData(t){this.folioData=Object.assign(Object.assign({},this.folioData),t)}async savePayment(){var t,e,i;try{this.isLoading=true;this.autoValidate=true;if(this.errors){this.errors=null}this.folioSchema.parse((t=this.folioData)!==null&&t!==void 0?t:{});await this.paymentService.AddPayment(Object.assign(Object.assign({},this.folioData),{currency:x.currency,reference:(e=this.folioData.reference)!==null&&e!==void 0?e:"",designation:(i=this.folioData.payment_type)===null||i===void 0?void 0:i.description}),this.bookingNumber);this.resetBookingEvt.emit(null);this.resetExposedCancellationDueAmount.emit(null);this.closeModal.emit(null)}catch(t){const e={};if(t instanceof R){t.issues.forEach((t=>{e[t.path[0]]=true}))}console.error(t);this.errors=e}finally{this.isLoading=false}}handleDropdownChange(t){var e;t.stopImmediatePropagation();t.stopPropagation();const i=t.detail.toString();console.log(i);this.updateFolioData({designation:i});if(!t.detail){this.updateFolioData({payment_type:null})}else{const s=(e=this.paymentEntries)===null||e===void 0?void 0:e.types.find((t=>t.CODE_NAME===i));if(!s){console.warn(`Invalid payment type ${t.detail}`);this.updateFolioData({payment_type:null});return}this.updateFolioData({payment_type:{code:s.CODE_NAME,description:s.CODE_VALUE_EN,operation:s.NOTES},payment_method:mh.includes(s.CODE_NAME)?undefined:{code:this.paymentEntries.methods[0].CODE_NAME,description:this.paymentEntries.methods[0].CODE_VALUE_EN,operation:this.paymentEntries.methods[0].NOTES}})}}handlePaymentMethodDropdownChange(t){var e;t.stopImmediatePropagation();t.stopPropagation();const i=t.detail.toString();const s=(e=this.paymentEntries)===null||e===void 0?void 0:e.methods.find((t=>t.CODE_NAME===i));if(!s){console.warn(`Invalid payment method ${t.detail}`);this.updateFolioData({payment_type:null});return}this.updateFolioData({payment_method:{code:s.CODE_NAME,description:s.CODE_VALUE_EN,operation:s.NOTES}})}async getPaymentTypes(){var t;const e=m(this.paymentEntries);if(this.mode==="payment-action"&&((t=this.payment.payment_type)===null||t===void 0?void 0:t.code)==="001"){const{PAYMENTS:t,CANCELLATION:i}=e;return this._paymentTypes={PAYMENTS:t,CANCELLATION:i}}this._paymentTypes=e}renderDropdownItems(){return Object.values(this._paymentTypes).map(((t,i)=>e(a,null,t.map((t=>e("ir-dropdown-item",{value:t.CODE_NAME,class:"dropdown-item-payment"},e("span",null,t.CODE_VALUE_EN),e("span",{class:`payment-type-badge ${t.NOTES==="CR"?"credit-badge":"debit-badge"}`},t.NOTES==="CR"?"credit":"debit")))),i!==Object.values(this._paymentTypes).length-1&&e("div",{class:"dropdown-divider"}))))}render(){var t,i,s,a,n,o,r,l,c,d,h,u,f,p,b,g,m,v,y,k,w,_,C,O,M,E,Y,A,T,S,B,I,j,z,N,R,$;return e("form",{key:"29db5447060e62206e7447ee152c6a31a2987c3e",class:"sheet-container",onSubmit:async t=>{t.preventDefault();this.savePayment()}},e("ir-title",{key:"512d9e692ab1ac9c4007e8b3dec50728bc59a427",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:this.mode==="edit"?"Edit Folio Entry":"New Folio Entry",displayContext:"sidebar"}),e("section",{key:"810b2a344b1863691ff950b62a939d54bee0f340",class:"px-1 sheet-body d-flex flex-column",style:{gap:"1rem"}},e("div",{key:"1aa317ecdf36e56b8cbf78440e8d077ae1f790be",class:"d-flex w-fill",style:{gap:"0.5rem"}},e("div",{key:"f34c68edd64d9578feb1142e85a8572e35ce778e",class:"form-group  mb-0 flex-grow-1"},e("div",{key:"b23ca3adabc966f62ee04408fca2ddf8a052620e",class:"input-group row m-0 flex-grow-1"},e("div",{key:"6a5f072eb9647fc939a95c3ff190fe13b75cb3a7",class:`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`},e("label",{key:"c43a1746acbe15213bb0c4f40ab23459e187ce88",class:`input-group-text flex-grow-1 text-dark border-theme `},"Date")),e("div",{key:"c7ea7e10467b80578e409d91a9dbf72c34f29194",class:"form-control  form-control-md col-10 flex-grow-1 d-flex align-items-center px-0 mx-0",style:{border:"0"}},e("style",{key:"7a961d83bb2d092aeb7e0dd0deb17ac16c7df9e1"},`.ir-date-picker-trigger{\n                    width:100%;}`),e("ir-date-picker",{key:"752a5ac9f4d79a9a7ab62cf9cf6573bf937fc348","data-testid":"pickup_date",date:(t=this.folioData)===null||t===void 0?void 0:t.date,class:"w-100",emitEmptyDate:true,maxDate:D().format("YYYY-MM-DD"),"aria-invalid":((i=this.errors)===null||i===void 0?void 0:i.date)&&!((s=this.folioData)===null||s===void 0?void 0:s.date)?"true":"false",onDateChanged:t=>{var e;this.updateFolioData({date:(e=t.detail.start)===null||e===void 0?void 0:e.format("YYYY-MM-DD")})}},e("input",{key:"0c0c362ce8c9d4d9284adf4cdb9996c3d92cdc56",type:"text",slot:"trigger",value:((a=this.folioData)===null||a===void 0?void 0:a.date)?D((n=this.folioData)===null||n===void 0?void 0:n.date).format("MMM DD, YYYY"):null,class:`form-control w-100 input-sm ${((o=this.errors)===null||o===void 0?void 0:o.date)&&!((r=this.folioData)===null||r===void 0?void 0:r.date)?"border-danger":""} text-left`,style:{borderTopLeftRadius:"0",borderBottomLeftRadius:"0",width:"100%"}})))))),e("div",{key:"3d58d14782935aacc085bdd6d1bf8116a3680f76"},e("ir-price-input",{key:"8737a8f273d43bf3a399466b57ac2b88d5e8f4e7",containerClassname:"row",labelContainerClassname:"col-4 col-md-3 p-0 text-dark border-0",minValue:0,autoValidate:this.autoValidate,zod:this.folioSchema.pick({amount:true}),wrapKey:"amount",label:"Amount",labelStyle:"flex-grow-1 text-dark  border-theme",error:((l=this.errors)===null||l===void 0?void 0:l.amount)&&!((c=this.folioData)===null||c===void 0?void 0:c.amount),value:(h=(d=this.folioData)===null||d===void 0?void 0:d.amount)===null||h===void 0?void 0:h.toString(),currency:x.currency.symbol,onTextChange:t=>this.updateFolioData({amount:Number(t.detail)})})),e("div",{key:"595ad16ea55ad04b9c982d95d70235ba15124803"},e("ir-dropdown",{key:"940b4adf76259f5842c9a432ef366ec76c5bcb1a",value:(f=(u=this.folioData)===null||u===void 0?void 0:u.payment_type)===null||f===void 0?void 0:f.code,disabled:((p=this.payment.payment_type)===null||p===void 0?void 0:p.code)!=="001"&&this.mode==="payment-action",onOptionChange:this.handleDropdownChange.bind(this)},e("div",{key:"03b656cf905050fe16e58b8b430475ab4617fcd7",slot:"trigger",class:"input-group row m-0 "},e("div",{key:"78808927b6660d1bb1551f03623b8673653a620b",class:`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`},e("label",{key:"54f13016897abfe15168299aac671f35c186b31c",class:`input-group-text flex-grow-1 text-dark  border-theme`},"Transaction type")),e("button",{key:"5be78b684a84f21399017660d0f4f952c3d0d6c5",type:"button",disabled:((b=this.payment.payment_type)===null||b===void 0?void 0:b.code)!=="001"&&this.mode==="payment-action",class:`form-control  d-flex align-items-center cursor-pointer ${((g=this.errors)===null||g===void 0?void 0:g.designation)&&!((m=this.folioData)===null||m===void 0?void 0:m.designation)?"border-danger":""}`},((v=this.folioData)===null||v===void 0?void 0:v.payment_type)?e("span",null,(y=this.folioData.payment_type)===null||y===void 0?void 0:y.description):e("span",null,"Select..."))),e("ir-dropdown-item",{key:"c4f52a491a71c86e1d28024bba73b78bb837a8e1",value:""},"Select..."),this.renderDropdownItems())),mh.includes((w=(k=this.folioData)===null||k===void 0?void 0:k.payment_type)===null||w===void 0?void 0:w.code)&&e("div",{key:"b0bf06e52a72587bc0f09c010c894985979b6cfc"},e("ir-dropdown",{key:"707ec699dfab9e22c52ae04eb02f3fe639ad9bb4",value:(C=(_=this.folioData)===null||_===void 0?void 0:_.payment_type)===null||C===void 0?void 0:C.code,disabled:((O=this.payment.payment_type)===null||O===void 0?void 0:O.code)!=="001"&&this.mode==="payment-action",onOptionChange:this.handlePaymentMethodDropdownChange.bind(this)},e("button",{key:"b538162b53989bd5a2a130f01e50d74fe3d5c1db",slot:"trigger",type:"button",disabled:((M=this.payment.payment_type)===null||M===void 0?void 0:M.code)!=="001"&&this.mode==="payment-action",class:`form-control d-flex align-items-center cursor-pointer ${((E=this.errors)===null||E===void 0?void 0:E.payment_method)&&!((A=(Y=this.folioData)===null||Y===void 0?void 0:Y.payment_method)===null||A===void 0?void 0:A.code)?"border-danger":""}`},((T=this.folioData)===null||T===void 0?void 0:T.payment_method)?e("span",null,(S=this.folioData.payment_method)===null||S===void 0?void 0:S.description):e("span",null,"Select ",((I=(B=this.folioData)===null||B===void 0?void 0:B.payment_type)===null||I===void 0?void 0:I.code)==="001"?"payment":"refund"," method...")),e("ir-dropdown-item",{key:"b5658c580891fce77fb961399e554ad2d05ee27f",value:""},"Select ",((j=this.folioData.payment_type)===null||j===void 0?void 0:j.code)==="001"?"payment":"refund"," method..."),(N=(z=this.paymentEntries)===null||z===void 0?void 0:z.methods)===null||N===void 0?void 0:N.map((t=>e("ir-dropdown-item",{value:t.CODE_NAME,class:"dropdown-item-payment"},e("span",null,t.CODE_VALUE_EN)))))),e("div",{key:"ffcec366d134cc71e9cb276a4b3d36b53ff825a1"},e("ir-input-text",{key:"10dd2ce615f884d1f434caa0947960f4df9c88b2",value:(R=this.folioData)===null||R===void 0?void 0:R.reference,error:($=this.errors)===null||$===void 0?void 0:$.reference_number,autoValidate:this.autoValidate,zod:this.folioSchema.pick({reference:true}),label:"Reference",maxLength:50,inputContainerStyle:{margin:"0"},onTextChange:t=>this.updateFolioData({reference:t.detail}),labelWidth:3,labelContainerClassname:"col-4 col-md-3"}))),e("div",{key:"6635b0807712e8e9c3f3b17a5f8af08f3f3c9821",class:"sheet-footer"},e("ir-button",{key:"dca24fb7e1ba4a8b55aed99eb129bf7c6faeca8b",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:"Cancel",btn_color:"secondary"}),e("ir-button",{key:"7a4a218d53efa80828f0fcd19f25f282b69bf15f",btn_styles:"justify-content-center align-items-center",class:"flex-fill",isLoading:this.isLoading,text:"Save",btn_color:"primary",btn_type:"submit"})))}static get watchers(){return{payment:["handlePaymentChange"],paymentTypes:["handlePaymentTypesChange"]}}};xh.style=yh+wh;const _h=".payment-item__payment-item{display:flex;flex-direction:column;padding:0.5rem;min-height:3rem}.payment-item__payment-item p{padding:0;margin:0;box-sizing:border-box}.payment-item__payment-body{display:flex;flex-direction:column}.payment-item__payment-fields{display:flex;align-items:center;justify-content:space-between}.payment-item__payment-body .payment-item__payment-reference,.payment-item__payment-body .payment-item__payment-description{display:none}.payment-item__payment-toolbar{display:flex;align-items:center;justify-content:space-between}.payment-item__payment-toolbar .payment-item__payment-amount{display:none}.payment-item__action-button{cursor:pointer}.payment-item__payment-amount{font-weight:700;white-space:nowrap}.payment-item__payment-amount.is-credit{color:#629a4c}.payment-item__payment-amount.is-debit{color:#ff4961}.payment-item__payment-reference{font-size:12px}@media (min-width: 640px){.payment-item__payment-item{flex-direction:row;align-items:center;gap:1rem}.payment-item__payment-item:hover{background:#f4f5fa}.payment-item__payment-item:hover .payment-item__payment-actions{display:inline-flex}.payment-item__payment-body .payment-item__payment-reference,.payment-item__payment-body .payment-item__payment-description,.payment-item__payment-item .payment-item__payment-amount{display:inline-flex}.payment-item__payment-fields .payment-item__payment-amount,.payment-item__payment-toolbar .payment-item__payment-description,.payment-item__payment-item .payment-item__payment-reference,.payment-item__payment-actions{display:none}.payment-item__payment-body .payment-item__payment-reference{display:inline-flex;align-items:center}.payment-item__payment-body{flex:1 1 0%;justify-content:flex-start;gap:0.5rem}.payment-item__payment-fields{justify-content:flex-start;gap:0.5rem}.payment-item__payment-toolbar{gap:0.5rem;align-items:center}}";const Dh=_h;const Ch=class{constructor(e){t(this,e);this.editPayment=s(this,"editPayment",7);this.deletePayment=s(this,"deletePayment",7)}render(){var t,i,s,a,n;const o=this.payment.payment_type.operation==="CR";const r=(s=mh.includes((t=this.payment.payment_type)===null||t===void 0?void 0:t.code)?`${(i=this.payment.payment_type)===null||i===void 0?void 0:i.description}: ${this.payment.payment_method.description}`:this.payment.payment_type.description)!==null&&s!==void 0?s:this.payment.designation;return e("div",{key:"ebd62636645ee1b6f767e920c3c92fe58827b256",class:"payment-item__payment-item"},e("div",{key:"e4fe640e5d4a597a70f64b108e3991cfa0caa3a0",class:"payment-item__payment-body",part:"payment-body"},e("div",{key:"c179ef1d3dd2390a149736dfb09137064b2eb9c3",class:"payment-item__payment-fields",part:"payment-fields"},e("p",{key:"7549620e582097311155f545459ab2c7ca3af1db",class:"payment-item__payment-date"},this.payment.date),e("p",{key:"d58b019df78913eacd295294cf6d4b204af781f0",class:`payment-item__payment-amount ${o?"is-credit":"is-debit"}`},_(this.payment.currency.symbol,this.payment.amount)),e("p",{key:"7d1ad9d05327bad728b605ac1ad68bca6e01531d",class:"payment-item__payment-description"},e("b",{key:"a03074bf64a8ad071edd8c16ecad62dc56e3b244"},r))),this.payment.reference&&e("p",{key:"6c140fa78ba95fb9b90c71f61b37a6e88d5052f2",class:"payment-item__payment-reference"},(a=this.payment)===null||a===void 0?void 0:a.reference)),e("div",{key:"101dd0d9eb9361501dd59988ac330d02640216c8",class:"payment-item__payment-toolbar"},e("p",{key:"45f58a74834814fe1dd0483fc508b15e79720180",class:`payment-item__payment-amount ${o?"is-credit":"is-debit"}`},_(this.payment.currency.symbol,this.payment.amount)),e("p",{key:"5408237648f41bac56a5f8c2b2d882e672794e02",class:"payment-item__payment-description"},e("b",{key:"55384a37ead98e43b44e08884dea81bf1a05a266"},r)),e("div",{key:"5b51cb0069600941ff9c6c8725aa569650a93eaf",class:"payment-item__payment-actions"},e("ir-button",{key:"e0d7e0c3e57a27ee612cdb643db4f059627c61e2",class:"payment-item__action-button",variant:"icon",onClickHandler:()=>{this.editPayment.emit(this.payment)},icon_name:"edit",style:wt.secondary}),e("ir-button",{key:"eacb99c482053e359732fe6d486c661f56ce5e6b",class:"payment-item__action-button",onClickHandler:()=>{this.deletePayment.emit(this.payment)},variant:"icon",style:wt.danger,icon_name:"trash"}))),this.payment.reference&&e("p",{key:"a66ddf4f7958bd6b755d6cb205c62b875f526952",class:"payment-item__payment-reference"},(n=this.payment)===null||n===void 0?void 0:n.reference))}};Ch.style=Dh;const Oh=".sc-ir-payment-summary-h{display:block}.sc-ir-payment-summary-h{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-payment-summary-h *.sc-ir-payment-summary{font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}";const Mh=Oh;const Eh=class{constructor(e){t(this,e)}shouldShowTotalCost(){return this.totalCost>0&&this.totalCost!==null}render(){return e("div",{key:"7640039967a02f3b349e638a88708081034ae00f",class:" m-0"},this.shouldShowTotalCost()&&e("div",{key:"0329ca59fb458095f8f697b51a112f1d8e0d4541",class:"mb-2 h4 total-cost-container"},y.entries.Lcz_TotalCost,":",e("span",{key:"48887d8bf087a8b3957d2bd47e5da017eda18c8c"},_(this.currency.symbol,this.totalCost))),e("div",{key:"6b2e8b0d022f06ba335c45aa1cd8def3f130f3d8",class:"h4 d-flex align-items-center justify-content-between"},e("span",{key:"b999fd0c6911c342087f2b25e1d20650c35af53c"},y.entries.Lcz_Balance,": "),e("span",{key:"5d01d1a7e6fcc6a9e3a9dd1e496fe37ebd02ea33",class:"danger font-weight-bold"},_(this.currency.symbol,this.balance))),e("div",{key:"1e9ac1ad531d3115e73af1178293892d3124ea3b",class:"mb-2 h4 d-flex align-items-center justify-content-between"},e("span",{key:"a7fec786977cc493f57690d0a67172dae787b787"},y.entries.Lcz_Collected,": "),e("span",{key:"f81ca38ec3e0a7e9f9c60d1d74c1f0cc8e7cdeb1"},_(this.currency.symbol,this.collected))))}};Eh.style=Mh;const Yh=".sc-ir-payments-folio-h{display:block}";const Ah=Yh;const Th=class{constructor(e){t(this,e);this.addPayment=s(this,"addPayment",7);this.editPayment=s(this,"editPayment",7);this.deletePayment=s(this,"deletePayment",7);this.payments=[];this.handleAddPayment=()=>{this.addPayment.emit()};this.handleEditPayment=t=>{this.editPayment.emit(t)};this.handleDeletePayment=t=>{this.deletePayment.emit(t)}}hasPayments(){return this.payments&&this.payments.length>0}renderPaymentItem(t,i){return[e("ir-payment-item",{key:t.id,payment:t,onDeletePayment:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleDeletePayment(t.detail)},onEditPayment:t=>{t.stopImmediatePropagation();t.stopPropagation();this.handleEditPayment(t.detail)}}),i<this.payments.length-1&&e("hr",{class:"p-0 m-0"})]}renderEmptyState(){return e("div",{class:"text-center p-3"},e("p",{class:"text-muted"},"No payments recorded yet"))}render(){return e("div",{key:"4a3f5682943b46e6bfcea1c8960d428057f91c7c",class:"mt-1"},e("div",{key:"c3d1b40d1faff294083d5fe8b383242c1c97c60f",class:"d-flex flex-column rounded payment-container"},e("div",{key:"b37776e93537628c7e2f9a664cdd39d0767d17f6",class:"d-flex align-items-center justify-content-between"},e("p",{key:"00c8a0ff769864dc9665e0ef50f81e0bdefbc943",class:"font-size-large p-0 m-0"},"Guest Folio"),e("ir-button",{key:"7d8ff18d170035365d31ad3538959736754ebd89",id:"add-payment",variant:"icon",icon_name:"square_plus",style:{"--icon-size":"1.5rem"},onClickHandler:this.handleAddPayment})),e("div",{key:"cd46ecbfa1945649859008331e576e347d431d9c",class:"mt-1 card p-1 payments-container"},this.hasPayments()?this.payments.map(((t,e)=>this.renderPaymentItem(t,e))):this.renderEmptyState())))}};Th.style=Ah;const Sh=".sc-ir-phone-input-h{display:block}.input-container.sc-ir-phone-input{display:flex;align-items:center;padding:0 !important}.input-container.sc-ir-phone-input:focus-within{border-color:#1e9ff2}.border-theme.sc-ir-phone-input{border-color:#cacfe7}.input-container.sc-ir-phone-input input.sc-ir-phone-input{flex:1;border:0}.input-container.sc-ir-phone-input input.sc-ir-phone-input:focus{outline:none}.dropdown-trigger.sc-ir-phone-input{display:flex;align-items:center;gap:8px;background:white;border:0;border-right:1px solid #cacfe7}.ir-dropdown-container.sc-ir-phone-input{position:absolute;z-index:1000;bottom:-30px;width:100%;left:0;background:white}.input-container.sc-ir-phone-input label.sc-ir-phone-input{display:flex;align-items:center;justify-content:center;margin:0;padding:0 5px}.flag.sc-ir-phone-input{height:1rem;aspect-ratio:4/3;border-radius:3px}.is-invalid.sc-ir-phone-input{border-color:#ff4961}.phone_prefix_label.sc-ir-phone-input{padding:0 0.5rem;margin:0}.sc-ir-phone-input-h{--ir-floating-label-fg:#6c757d;--ir-floating-label-fg-focus:#495057;--ir-floating-label-bg:#fff;--ir-floating-label-scale:0.88;--ir-floating-label-float-translateY:-70%;--ir-floating-label-resting-offset-inline:0.9rem;--ir-floating-phone-input-radius:0.21rem;--ir-floating-phone-input-height:2rem;--ir-danger:#dc3545;--ir-disabled-fg:#9aa0a6}.sc-ir-phone-input-h .input-container.has-floating.sc-ir-phone-input{position:relative;padding-top:0.9rem}.sc-ir-phone-input-h .floating-label.sc-ir-phone-input{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none;position:absolute;padding:0 0.4rem;z-index:10;color:var(--ir-floating-label-fg);background:white;transition:transform 120ms ease, color 120ms ease, top 120ms ease, background-color 120ms ease, opacity 120ms ease;opacity:0.95;line-height:1;white-space:nowrap}.sc-ir-phone-input-h .floating-label.sc-ir-phone-input:dir(rtl){right:95px}.sc-ir-phone-input-h .floating-label.sc-ir-phone-input:dir(ltr){left:95px}.sc-ir-phone-input-h .floating-label.active.sc-ir-phone-input{top:0;transform:translateY(var(--ir-floating-label-float-translateY)) scale(var(--ir-floating-label-scale));background:var(--ir-floating-label-bg);color:var(--ir-floating-label-fg-focus);font-size:12px;padding:0;opacity:0.95}";const Bh=Sh;const Ih=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.value="";this.disabled=false;this.error=false;this.default_country=null;this.phone_prefix=null;this.countries=[];this.inputValue="";this.isDropdownVisible=false;this.hasFocus=false;this.bookingService=new l;this.inputId=`ir-phone-input-${Math.random().toString(36).slice(2)}`;this.labelId=`ir-phone-input-label-${Math.random().toString(36).slice(2)}`}async componentWillLoad(){if(this.countries.length===0){const t=await this.bookingService.getCountries(this.language);this.countries=t}if(this.phone_prefix){this.setCountryFromPhonePrefix()}else{if(this.default_country){this.setCurrentCountry(this.default_country)}}this.inputValue=this.value}handleValueChange(t,e){if(t!==e){this.inputValue=t}}handlePhoneChange(t,e){if(t!==e){this.setCountryFromPhonePrefix()}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isDropdownVisible=false}}handleInputChange(t){var e;let i=t.target;let s=i.value;s=s.replace(/[^+\d]+/g,"");i.value=s;this.inputValue=s;this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.inputValue})}setCountryFromPhonePrefix(){var t;let e=this.countries.find((t=>t.phone_prefix===this.phone_prefix));if(!e){e=this.countries.find((t=>t.id.toString()===this.phone_prefix));if(!e){return}}this.currentCountry=Object.assign({},e);this.textChange.emit({phone_prefix:(t=this.currentCountry)===null||t===void 0?void 0:t.phone_prefix,mobile:this.value})}setCurrentCountry(t){var e;const i=this.countries.find((e=>e.id===t));if(!i){throw new Error("Invalid country id")}this.currentCountry=Object.assign({},i);this.textChange.emit({phone_prefix:(e=this.currentCountry)===null||e===void 0?void 0:e.phone_prefix,mobile:this.value})}render(){var t,s;const a=this.floatingLabel&&this.label;const n=!!this.label&&!a;const o=this.hasFocus||!!this.inputValue;return e(i,{key:"b58b091dfc571700ffb55b12c13cef492662b468"},e("div",{key:"0581fb4ca026794871758a0c15918b47844db187",class:"form-group mr-0"},e("div",{key:"f3c05d25a50f91c5868e4dfc2a7252856032c58b",class:"input-group row m-0 p-0 position-relative"},n&&e("div",{key:"e6c17877712da43a585aca7b68a4120702cd83fc",class:`input-group-prepend col-3 p-0 text-dark border-none`},e("label",{key:"ddab8086895e33474ab2a8713f809f1855b00f85",class:`input-group-text border-theme flex-grow-1 text-dark`},this.label)),e("div",{key:"72799f18ab62ecc9712be421c5990b419c2cf816",class:"form-control  input-container  flex-fill"+(this.error?" is-invalid":"")},e("button",{key:"68f92918335449c3a4abc117dabe032338189deb",type:"button",onClick:()=>this.isDropdownVisible=!this.isDropdownVisible,class:"dropdown-trigger"},this.currentCountry?e("img",{src:(t=this.currentCountry)===null||t===void 0?void 0:t.flag,class:"flag"}):e("p",{class:"p-0 m-0 "},y.entries.Lcz_Select),e("svg",{key:"c86870ef03a97385a4b198f3e5cd05b8dbb0d823",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},e("path",{key:"0c50638640cbd49482973cb90661f6158f60dae6",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),e("p",{key:"06a7a5b7e3f0e263fc1656c066802e63a4c04b0d",class:"phone_prefix_label"},(s=this.currentCountry)===null||s===void 0?void 0:s.phone_prefix),a&&e("label",{key:"d09014e06a1c2bebaefe3a3e33e8621b149ad499",id:this.labelId,class:`floating-label ${o?"active":""}`,htmlFor:this.inputId},this.label),e("input",{key:"2b5808cbd9c28ec04bffd598a03dc1efcba77dfa","data-testid":this.testId,maxLength:14,type:"text",placeholder:this.placeholder,required:true,value:this.inputValue,disabled:this.disabled,onInput:t=>this.handleInputChange(t),onFocus:()=>{this.hasFocus=true},onBlur:()=>{this.hasFocus=false}})),this.isDropdownVisible&&e("div",{key:"c8f69d77d7c891a5cf9e53ee49b90f6fee345875",class:"ir-dropdown-container"},e("ir-combobox",{key:"2a23c8303b671cd2d6d5131a4fcf06b69e76317f",onComboboxValueChange:t=>{this.setCurrentCountry(+t.detail.data);this.isDropdownVisible=false},class:"bg-white",autoFocus:true,placeholder:"Search country",data:this.countries.map((t=>({id:t.id.toString(),name:`${t.name} (${t.phone_prefix})`,image:t.flag})))})))))}get el(){return n(this)}static get watchers(){return{value:["handleValueChange"],phone_prefix:["handlePhoneChange"]}}};Ih.style=Bh;class jh{async savePickup(t,e,i){try{const s=t.arrival_time.split(":");await gt.post(`/Do_Pickup`,{booking_nbr:e,is_remove:i,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){const e=t.hour&&t.minute?nt(t.hour)+":"+nt(t.minute):"";return{arrival_date:t.date,arrival_time:e,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let e=[];x.pickup_service.allowed_options.forEach((i=>{if(e.filter((t=>t.value===i.location.id)).length===0){e.push({text:t+" "+i.location.description,value:i.location.id})}}));return e}createPickupSchema(t,e){return N.object({arrival_date:N.string().regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Invalid date format, expected YYYY-MM-DD"}).refine((i=>{const s=D(i,"YYYY-MM-DD",true);const a=D(t,"YYYY-MM-DD",true);const n=D(e,"YYYY-MM-DD",true);return s.isValid()&&a.isValid()&&n.isValid()&&s.isBetween(a,n,undefined,"[]")}),{message:`arrival_date must be between ${t} and ${e}`}),arrival_time:N.string().regex(/^\d{2}:\d{2}$/,{message:"Invalid time format. Expected HH:MM"}).refine((t=>{const[e,i]=t.split(":").map(Number);return e>=0&&e<=23&&i>=0&&i<=59}),{message:"Time values are out of range"}),flight_details:N.string().nonempty({message:"Flight details cannot be empty"}),vehicle_type_code:N.string().nonempty({message:"Vehicle type code cannot be empty"}),number_of_vehicles:N.coerce.number().min(1,{message:"At least one vehicle is required"})})}validateForm(t,e){try{e.parse(t);return null}catch(t){console.log(t);const e={};if(t instanceof R){t.issues.forEach((t=>{e[t.path[0]]=true}));return e}}}getNumberOfVehicles(t,e){let i=Math.ceil(e/t);let s=i>1?i:1;let a=i>1?2:3;return Array.from({length:i+a},((t,e)=>s+e))}getPickUpPersonStatus(t){const e=x.pickup_service.allowed_pricing_models.find((e=>e.code===t));if(!e){return null}return e.description}updateDue(t){const e=this.getPickUpPersonStatus(t.code);if(!e){return}if(e==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const zh=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}@media (min-width: 768px){.price-input-container.sc-ir-pickup{max-width:290px}}";const Nh=zh;const Rh=".sc-ir-pickup-h{height:100%}.sheet-container.sc-ir-pickup{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-pickup{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-pickup{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-pickup{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-pickup{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-pickup{flex-direction:row;align-items:center}}";const $h=Rh;const Fh=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.numberOfPersons=0;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:null,selected_option:undefined};this.vehicleCapacity=[];this.cause=null;this.autoValidate=false;this.pickupService=new jh;this.arrival_time_mask={mask:"HH:mm",blocks:{HH:{mask:Kc,from:0,to:23,placeholderChar:"H"},mm:{mask:Kc,from:0,to:59,placeholderChar:"m"}},lazy:false,placeholderChar:"_"}}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=x.pickup_service.allowed_options.filter((e=>e.location.id===t.location));this.pickupData=Object.assign({},t)}this.pickupSchema=this.pickupService.createPickupSchema(this.bookingDates.from,this.bookingDates.to)}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e===""){this.updatePickupData("location",-1)}if(e!==""){this.allowedOptionsByLocation=x.pickup_service.allowed_options.filter((t=>t.location.id.toString()===e));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:e,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency})}}handleVehicleQuantityChange(t){if(t.detail===""){return}const e=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:e,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:e}).toFixed(2)})}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let e=x.pickup_service.allowed_options.find((e=>e.location.id===+this.pickupData.location&&e.vehicle.code===t.detail));if(!e){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code})}updatePickupData(t,e){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:e})}async savePickup(){try{this.isLoading=true;this.autoValidate=true;if(this.errors){this.errors=null}this.errors=this.pickupService.validateForm(this.pickupData,this.pickupSchema);if(this.errors){return}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingEvt.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){var t,i,s,a,n;return e("form",{key:"d32dab60389d73746772205faed1c74482945cfa",class:"sheet-container",onSubmit:async t=>{t.preventDefault();await this.savePickup()}},e("ir-title",{key:"52926b9e21b98de3245c79ee43b6f3c29acc49f2",class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:y.entries.Lcz_Pickup,displayContext:"sidebar"}),e("section",{key:"05ad61c10637a71810889f77737f01c973dc32c8",class:"px-1 sheet-body"},e("ir-select",{key:"375edebd6ac82e55e9fedc06b1d8049dff96640e",testId:"pickup_location",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:y.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",data:this.pickupService.getAvailableLocations(y.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&e("div",{key:"262be3d31efc3715bb3be07a577e23ffe29db8b8",class:"m-0 p-0","data-testid":"pickup_body"},e("div",{key:"a70a81c9b49bf4a77557122cbc8c0c7de65aabf2",class:"d-flex"},e("div",{key:"25a83285eee38d433682ba8f3e552935226a93d4",class:"form-group  mr-1"},e("div",{key:"e7403d66a2117a959c106e7ed5d2d916cc5bb670",class:"input-group row m-0"},e("div",{key:"97eeb6dfa991f61771f5762b85e5f97868619fe9",class:`input-group-prepend col-5 p-0 text-dark border-0`},e("label",{key:"385d93f64db7bb7c940cd1cdc98dac310ad8ecd2",class:`input-group-text  flex-grow-1 text-dark border-theme `},y.entries.Lcz_ArrivalDate)),e("div",{key:"2996020d5f4caba76f2f8b26b04e113c6e55236a",class:"form-control  form-control-md col-7 d-flex align-items-center px-0 mx-0",style:{border:"0"}},e("ir-date-picker",{key:"ec15518d71b410bceacc1e2d34c58201066e2b14","data-testid":"pickup_arrival_date",date:this.pickupData.arrival_date,minDate:this.bookingDates.from,maxDate:(t=this.bookingDates)===null||t===void 0?void 0:t.to,emitEmptyDate:true,"aria-invalid":((i=this.errors)===null||i===void 0?void 0:i.arrival_date)&&!this.pickupData.arrival_date?"true":"false",onDateChanged:t=>{var e;this.updatePickupData("arrival_date",(e=t.detail.start)===null||e===void 0?void 0:e.format("YYYY-MM-DD"))}},e("input",{key:"e6d763cbbbaaa286bd84487c6bbbf510d11d95c7",type:"text",slot:"trigger",value:this.pickupData.arrival_date?D(this.pickupData.arrival_date).format("MMM DD, YYYY"):null,class:`form-control input-sm ${((s=this.errors)===null||s===void 0?void 0:s.arrival_date)&&!this.pickupData.arrival_date?"border-danger":""} text-center`,style:{borderTopLeftRadius:"0",borderBottomLeftRadius:"0",width:"100%"}}))))),e("ir-input-text",{key:"1c7babc0540edcd040d3274d145ebefc7723e579",autoValidate:this.autoValidate,wrapKey:"arrival_time",testId:"pickup_arrival_time",error:(a=this.errors)===null||a===void 0?void 0:a.arrival_time,value:this.pickupData.arrival_time,zod:this.pickupSchema.pick({arrival_time:true}),label:y.entries.Lcz_Time,inputStyles:"col-sm-4","data-state":this.cause==="arrival_time"?"error":"",mask:this.arrival_time_mask,onTextChange:t=>this.updatePickupData("arrival_time",t.detail)})),e("ir-input-text",{key:"cc9f0c01c7f60315fb9a11d2abe9b23c5cace976",wrapKey:"flight_details",zod:this.pickupSchema.pick({flight_details:true}),autoValidate:this.autoValidate,testId:"pickup_flight_details",value:this.pickupData.flight_details,label:y.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",error:(n=this.errors)===null||n===void 0?void 0:n.flight_details}),e("ir-select",{key:"aced910f3cec24168d9a966f16fc52411b403bfb",testId:"pickup_vehicle_type_code",selectContainerStyle:"mb-1",error:this.cause==="vehicle_type_code",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:y.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),e("div",{key:"7b1e5050aaa62298b8e73724541ebed79c8dc413",class:"d-flex flex-column flex-md-row"},e("ir-select",{key:"edff06c7ce0e048fcdf9159e8ee8fdf59591e5f7",showFirstOption:false,testId:"pickup_number_of_vehicles",labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectedValue:this.pickupData.number_of_vehicles,error:this.cause==="number_of_vehicles",labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:y.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),e("div",{key:"3394073e990329162847df7027f47d17930097b0",class:"price-input-container"},e("ir-price-input",{key:"e22bb1bc423f1f9701b5d458aaf245e8017a1717",readOnly:true,label:`${y.entries.Lcz_DueUponBooking}`,value:this.pickupData.due_upon_booking,currency:this.pickupData.currency.symbol}))))),e("div",{key:"fcbc632358c99d1454bd8a4f94920c7e3171aebb",class:"sheet-footer"},e("ir-button",{key:"bf6fb6baa5ac07e2301e36f8d0f9e2087f6cab44",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`flex-fill`,text:y.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&e("ir-button",{key:"a460aa6a5bd987e48ead19d56eca66b135f5ce2e",btn_styles:"justify-content-center align-items-center",class:"flex-fill",isLoading:this.isLoading,text:y.entries.Lcz_Save,btn_color:"primary",btn_type:"submit"})))}get el(){return n(this)}};Fh.style=Nh+$h;const Lh=".sc-ir-pickup-view-h{display:block}";const Ph=Lh;const Hh=class{constructor(e){t(this,e)}render(){if(!x.pickup_service.is_enabled||!this.booking.is_editable){return null}return e(i,null,e("div",{class:"mb-1"},e("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},e("p",{class:"font-size-large p-0 m-0 "},y.entries.Lcz_Pickup),e("ir-button",{id:"pickup","data-testid":"new_pickup_btn",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.5rem"})})),this.booking.pickup_info&&e("div",{class:"card"},e("div",{class:"p-1"},e("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},e("p",{class:"font-weight-bold mr-1 py-0 my-0"},y.entries.Lcz_Date,": ",e("span",{class:"font-weight-normal"},D(this.booking.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),this.booking.pickup_info.hour&&this.booking.pickup_info.minute&&e("p",{class:"font-weight-bold flex-fill py-0 my-0"},y.entries.Lcz_Time,":",e("span",{class:"font-weight-normal"}," ",b(this.booking.pickup_info.hour.toString(),this.booking.pickup_info.minute.toString()))),e("p",{class:"font-weight-bold py-0 my-0"},y.entries.Lcz_DueUponBooking,":"," ",e("span",{class:"font-weight-normal"},this.booking.pickup_info.currency.symbol,this.booking.pickup_info.total))),e("p",{class:"font-weight-bold py-0 my-0"},y.entries.Lcz_FlightDetails,":",e("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.details}`)),e("p",{class:"py-0 my-0 pickup-margin"},`${this.booking.pickup_info.selected_option.vehicle.description}`),e("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},y.entries.Lcz_NbrOfVehicles,":",e("span",{class:"font-weight-normal"}," ",`${this.booking.pickup_info.nbr_of_units}`)),e("p",{class:"small py-0 my-0 pickup-margin"},x.pickup_service.pickup_instruction.description,x.pickup_service.pickup_cancelation_prepayment.description)))))}};Hh.style=Ph;const Uh=".sc-ir-pms-logs-h{display:block}.dialog-container-height.sc-ir-pms-logs{height:4rem}.list-title.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;font-weight:bold;width:fit-content}.list-item.sc-ir-pms-logs{margin:0;padding:0;font-size:14px;margin-left:5px;width:fit-content}.list-item.green.sc-ir-pms-logs{color:#629a4c;font-weight:600}.list-item.red.sc-ir-pms-logs{color:#ff4961;font-weight:600}";const Vh=Uh;const Gh=class{constructor(e){t(this,e);this.bookingService=new l}componentWillLoad(){this.init()}async init(){try{this.pmsLogs=await this.bookingService.fetchPMSLogs(this.bookingNumber)}catch(t){console.error(t)}}render(){var t,i,s,a,n,o,r,l;return e("div",{key:"9ad8d543a7bccf49a45736615a1ce566de4792d3",class:"p-1"},e("h3",{key:"079bdc4645a0a4a25518cf3b552583b3f71783e4",class:" text-left mb-1 dialog-title "},y.entries.Lcz_PMS_Logs),ut("/Get_Exposed_PMS_Logs")?e("div",{class:"d-flex align-items-center justify-content-center dialog-container-height"},e("ir-spinner",null)):e("div",{class:"dialog-container-height"},e("div",{class:"d-flex align-items-center ",style:{paddingBottom:"0.5rem"}},e("p",{class:"list-title p-0 m-0"},y.entries.Lcz_SentAt),((t=this.pmsLogs)===null||t===void 0?void 0:t.sent_date)?e("p",{class:"list-item"},(i=this.pmsLogs)===null||i===void 0?void 0:i.sent_date," ",b((s=this.pmsLogs)===null||s===void 0?void 0:s.sent_hour.toString(),(a=this.pmsLogs)===null||a===void 0?void 0:a.sent_minute.toString())):e("p",{class:`list-item ${((n=this.pmsLogs)===null||n===void 0?void 0:n.sent_date)?"green":"red"}`},((o=this.pmsLogs)===null||o===void 0?void 0:o.is_acknowledged)?y.entries.Lcz_YES:y.entries.Lcz_NO)),e("div",{class:"d-flex align-items-center p-0 m-0"},e("h4",{class:"list-title p-0 m-0"},y.entries.Lcz_Acknowledged),e("p",{class:`list-item  ${((r=this.pmsLogs)===null||r===void 0?void 0:r.is_acknowledged)?"green":"red"}`},((l=this.pmsLogs)===null||l===void 0?void 0:l.is_acknowledged)?y.entries.Lcz_YES:y.entries.Lcz_NO))))}};Gh.style=Vh;const Kh=":host{display:block;width:100%}*{box-sizing:border-box}.popover-trigger{all:unset;cursor:pointer}.popover-trigger:hover,.popover-trigger:focus{color:#000}";const Wh=Kh;const qh=class{constructor(e){t(this,e);this.irPopoverLeft="10px";this.placement="auto";this.trigger="focus";this.renderContentAsHtml=false;this.initialized=false}componentDidLoad(){if(this.initialized){return}this.initializePopover()}initializePopover(){$(this.popoverTrigger).popover({trigger:this.trigger,content:this.content,placement:this.placement,html:this.renderContentAsHtml});this.initialized=true}disconnectedCallback(){$(this.popoverTrigger).popover("dispose")}render(){return e(i,{key:"d94ebea080636d1de344c608b365cd6819ad5d21",style:{"--ir-popover-left":this.irPopoverLeft}},this.trigger!=="focus"?e("p",{ref:t=>this.popoverTrigger=t,class:"popover-title m-0 p-0",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"}},e("slot",null)):e("button",{tabindex:"0",class:"popover-trigger",ref:t=>this.popoverTrigger=t},e("slot",null)))}get el(){return n(this)}};qh.style=Wh;const Xh=".sc-ir-price-input-h{display:block;--ir-input-border-color:#cacfe7;flex:1 1 0%}.sc-ir-price-input-h .input-group-text.sc-ir-price-input{border-color:var(--ir-input-border-color)}.sc-ir-price-input-h .form-control.sc-ir-price-input,.currency-label.sc-ir-price-input{font-size:14px !important}.ir-bl-lbl-none.sc-ir-price-input,.ir-bl-input-none.sc-ir-price-input{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.rate-input.sc-ir-price-input:read-only{background:white !important}.ir-br-lbl-none.sc-ir-price-input,.ir-br-input-none.sc-ir-price-input{border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}.ir-br-none.sc-ir-price-input{border-right:none}.ir-bl-none.sc-ir-price-input{border-left:none}.rate-input-container.sc-ir-price-input{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1;padding:0 !important}[class='special-style'].sc-ir-price-input-h .rate-input.sc-ir-price-input{background:black !important}.rate-input.sc-ir-price-input{font-size:0.875rem;line-height:0;padding:0;height:0;box-sizing:border-box;border-left:0;padding-left:0px !important;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.currency-label.with-label.sc-ir-price-input{border-radius:0}.currency-label.sc-ir-price-input{box-sizing:border-box;color:#3b4781;border:1px solid #cacfe7;font-size:0.875rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;pointer-events:none;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.currency-label.disabled.sc-ir-price-input,.rate-input.sc-ir-price-input:disabled{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.price-input-group.sc-ir-price-input:focus-within .currency-label.sc-ir-price-input{border-top:1px solid #1e9ff2;border-bottom:1px solid #1e9ff2;border-left:1px solid #1e9ff2}[data-state='error'].sc-ir-price-input-h .currency-label.sc-ir-price-input,[data-state='error'].sc-ir-price-input-h .rate-input.sc-ir-price-input,.error.sc-ir-price-input{border-color:var(--red, #ff4961) !important}.price-input.sc-ir-price-input:focus{border-right-width:1px !important}.is-invalid.sc-ir-price-input{background-image:none !important}";const Jh=Xh;const Qh=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.inputBlur=s(this,"inputBlur",7);this.inputFocus=s(this,"inputFocus",7);this.autoValidate=true;this.placeholder="";this.value="";this.required=false;this.opts={mask:Number,scale:2,radix:".",mapToRadix:[","],normalizeZeros:true,padFractionalZeros:true,thousandsSeparator:","};this.handleInputChange=()=>{this.validateInput(this.value)};this.handleBlur=()=>{this.validateInput(this.value);if(this.value){const t=parseFloat(this.value);this.value=t.toFixed(2);if(this.mask){this.mask.value=this.value}}this.inputBlur.emit(this.value)};this.handleFocus=()=>{this.inputFocus.emit()}}componentWillLoad(){if(this.el.id){this.id=this.el.id}else{this.id=ht()}}componentDidLoad(){if(!this.mask){this.initializeMask()}}initializeMask(){const t=Object.assign({},this.opts);if(this.minValue!==undefined){t["min"]=this.minValue}if(this.maxValue!==undefined){t["max"]=this.maxValue}this.mask=Oc(this.inputRef,t);if(this.value){this.mask.value=this.value}this.mask.on("accept",(()=>{const t=this.inputRef.value.trim()===""||this.mask.unmaskedValue==="";if(t){this.value="";this.textChange.emit(null)}else{this.value=this.mask.unmaskedValue;this.textChange.emit(this.value)}}))}hasSpecialClass(t){return this.el.classList.contains(t)}validateInput(t){if(!this.autoValidate){return}if(this.zod){try{this.zod.parse(this.wrapKey?{[this.wrapKey]:t}:t);this.error=false}catch(t){console.log(t);this.error=true}}}render(){var t,i;return e("fieldset",{key:"ffaeb21050bf6403b7bcd3b42fcb1a557e6c1439",class:`${this.containerClassname} input-group price-input-group m-0 p-0 `},this.label&&e("div",{key:"f2dbf73d1b88653555f3714ba93dc610f6308c54",class:`input-group-prepend ${this.labelContainerClassname}`},e("span",{key:"8fdbf0adf1172896bfb8b5308548a2a1fc6c809f",class:`input-group-text \n                ${this.labelStyle}\n              ${this.hasSpecialClass("ir-bl-lbl-none")?"ir-bl-lbl-none":""}\n              ${this.hasSpecialClass("ir-br-lbl-none")?"ir-br-lbl-none":""}\n              ${this.hasSpecialClass("ir-br-none")?"ir-br-none":""} \n              ${this.hasSpecialClass("ir-bl-none")?"ir-bl-none":""} \n              `},e("label",{key:"b8ea57dfb17a855c7d040a4a0cfdf662d06858da",class:"p-0 m-0 ",htmlFor:this.id},this.label))),e("div",{key:"2d07de81b90c229efca89359e6ba0d7c686bc97d",class:"position-relative has-icon-left rate-input-container"},this.currency&&e("div",{key:"0367ffa9360b7b7802ba525ddc1856ff4205a4e7"},e("span",{key:"f6e41c6b67651e66591c4c581cb1291faf5e8251",class:`input-group-text ${this.disabled?"disabled":""} currency-label ${this.error?"error":""} ${this.label?"with-label":""}`},this.currency)),e("input",{key:"872c1fa4ab37e38bf65b7ca81b089400d9b39e3d",ref:t=>this.inputRef=t,"data-testid":this.testId,disabled:this.disabled,id:this.id,class:`form-control input-sm rate-input \n              ${this.inputStyle}\n              ${this.hasSpecialClass("ir-br-input-none")?"ir-br-input-none":""} \n              ${this.hasSpecialClass("ir-bl-input-none")?"ir-bl-input-none":""} \n              ${this.error?"error":""} py-0 m-0 ${this.currency?"ir-bl-none":""}`,onInput:this.handleInputChange,onBlur:this.handleBlur,onFocus:this.handleFocus,type:"text",placeholder:this.placeholder,readOnly:this.readOnly,"aria-label":(t=this.el.ariaLabel)!==null&&t!==void 0?t:"price-input","aria-describedby":(i=this.el.ariaDescription)!==null&&i!==void 0?i:"price-input"})))}get el(){return n(this)}};Qh.style=Jh;const Zh=".sc-ir-progress-indicator-h{display:block}.secondary-progress.sc-ir-progress-indicator{background:#6692b3}";const tu=Zh;const eu=class{constructor(e){t(this,e);this.color="primary"}render(){return e(i,{key:"9ed3418e7637d5737bf877b13f7970c24a105824",class:"progress-main"},e("span",{key:"aeada65e9ea85f219d2b63a0ca81fc771a1abb9e",class:"progress-totle"},this.percentage),e("div",{key:"c31211afa7615bb4dd1eda57f6f19d3ffea5fd0f",class:"progress-line"},e("div",{key:"79aff8719ef537abfaea2f280d7e5d13d006ff5c",class:`progress ${this.color==="primary"?"bg-primary":"secondary-progress"} mb-0`,style:{width:this.percentage}})))}};eu.style=tu;const iu=".sc-ir-radio-h{display:block}.checkmark.sc-ir-radio{top:50% !important;transform:translateY(-50%) !important}";const su=iu;const au=class{constructor(e){t(this,e);this.checkChange=s(this,"checkChange",7);this.checked=false;this.radioBoxId=ht();this.currentChecked=false}componentWillLoad(){this.currentChecked=this.checked}componentDidLoad(){if(this.radioRef){this.radioRef.setAttribute("aria-checked",JSON.stringify(this.checked))}}handleCheckedChange(t){if(t===this.currentChecked){return}this.currentChecked=this.checked}handleCheckChange(){this.currentChecked=!this.currentChecked;if(this.radioRef){this.radioRef.setAttribute("aria-checked",JSON.stringify(this.currentChecked))}this.checkChange.emit(this.currentChecked)}render(){return e("div",{key:"5223be68fb4a37a1b9df9c317aee6f06eebb7d50",class:"input-group"},e("label",{key:"46a0ffa74eaa8e2685889e493fa37128d73a986d",class:"check-container radio-container align-items-center m-0 py-0"},e("span",{key:"d7bcf9e2a9f970fad391f8418252d8164703e35d"},this.label),e("input",{key:"95dccd8d2495ae35263dde37cddec18c5e9e488d",class:"p-0 m-0",type:"radio",value:"000",name:this.el.name,title:"",onChange:()=>{this.handleCheckChange()},checked:this.currentChecked,ref:t=>this.radioRef=t}),e("span",{key:"679c6dc22cd4859806751892fa7becda69fd81c5",class:"checkmark"})))}get el(){return n(this)}static get watchers(){return{checked:["handleCheckedChange"]}}};au.style=su;const nu=".sc-ir-range-picker-h{display:block;--ir-range-gap:0.5rem}.range-picker__container.sc-ir-range-picker{position:relative;display:flex;align-items:center;gap:var(--ir-range-gap);box-sizing:border-box}.range-picker__container.focused.sc-ir-range-picker{border-bottom-color:rgb(198, 206, 231);border-left-color:rgb(198, 206, 231);border-right-color:rgb(198, 206, 231);border-top-color:rgb(198, 206, 231);color:#4e5154;background-color:#fff;border-color:var(--blue, #1e9ff2);outline:0;-webkit-box-shadow:none;box-shadow:none}.range-picker__icon--hidden.sc-ir-range-picker,.range-picker__date-picker--hidden.sc-ir-range-picker{opacity:0}.range-picker__overlay.sc-ir-range-picker{position:absolute;inset:0;background-color:white;z-index:1;display:none;pointer-events:none;padding:0;margin:0;cursor:pointer;gap:var(--ir-range-gap)}.range-picker__overlay--active.sc-ir-range-picker{display:flex;align-items:center;justify-content:flex-start;pointer-events:auto;border-radius:inherit;padding-inline:0.5rem}.range-picker__date-picker.sc-ir-range-picker:hover .range-picker__date-picker-button.sc-ir-range-picker,.range-picker__date-picker.focused.sc-ir-range-picker .range-picker__date-picker-button.sc-ir-range-picker{color:var(--blue, #1e9ff2)}.range-picker__date-picker-button.sc-ir-range-picker{background:inherit;margin:0;padding:0;display:flex;align-items:center;font-size:0.975rem;line-height:1.45;height:2rem;color:#3b4781;white-space:nowrap;cursor:pointer;padding-inline:0.5rem}.range-picker__calendar-icon.sc-ir-range-picker,.range-picker__arrow-icon.sc-ir-range-picker{height:14px;width:14px}";const ou=nu;const ru=class{constructor(e){t(this,e);this.dateRangeChanged=s(this,"dateRangeChanged",7);this.withOverlay=true;this.allowNullDates=true;this.minSelectableDate=D().subtract(90,"days").toDate()}async handleDateChanged(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail.start?D(t.detail.start):null;if(!this.lastFocusedPicker){return}if(t.target.id==="fromDate"){let t=this.toDate;if(!e){this.dateRangeChanged.emit({fromDate:null,toDate:null,wasFocused:!!this.lastFocusedPicker});return}if(!t||t.isBefore(e,"day")){t=e}this.dateRangeChanged.emit({fromDate:e,toDate:t,wasFocused:!!this.lastFocusedPicker});await this.toDatePicker.openDatePicker()}else{if(!e){this.dateRangeChanged.emit({fromDate:this.fromDate,toDate:this.fromDate,wasFocused:!!this.lastFocusedPicker});return}this.dateRangeChanged.emit({fromDate:this.fromDate,toDate:e,wasFocused:!!this.lastFocusedPicker})}this.lastFocusedPicker=null}handleDatePickerFocus(t){t.stopPropagation();clearTimeout(this.focusTimeout);this.date_container.classList.add("focused");t.target.classList.add("focused")}handleDatePickerBlur(t){t.stopPropagation();t.target.classList.remove("focused");this.focusTimeout=setTimeout((()=>{this.date_container.classList.remove("focused")}),10)}disconnectedCallback(){clearTimeout(this.focusTimeout)}renderDatePicker(t,i,s,a,n={}){var o;return e("ir-date-picker",Object.assign({class:{"range-picker__date-picker":true,"range-picker__date-picker--hidden":this.withOverlay&&!this.fromDate},customPicker:true,ref:t=>a(t),minDate:s,maxDate:this.maxDate,date:i===null||i===void 0?void 0:i.toDate(),id:t,onDatePickerFocus:()=>{this.lastFocusedPicker=t},emitEmptyDate:this.allowNullDates},n),e("p",{class:"range-picker__date-picker-button",slot:"trigger"},(o=i===null||i===void 0?void 0:i.format("YYYY-MM-DD"))!==null&&o!==void 0?o:"2025-03-02"))}render(){var t;return e(i,{key:"3410baf8134dcf0b0722b6958bbe9234bbb83bb8"},e("div",{key:"4bd47d38646fb89103855bd827c88d5caf9944c4",class:"form-control range-picker__container",ref:t=>this.date_container=t},this.withOverlay&&e("div",{key:"b4704db703efcd02d01b88055a27915a32479c44",class:{"range-picker__overlay":true,"range-picker__overlay--active":!this.fromDate},onClick:()=>this.fromDatePicker.openDatePicker()},e("svg",{key:"de18555a2380a66ba655f557b6877f6aea030e29",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"14px",width:"14px"}},e("path",{key:"6d29df291966f4ea46cfa75bb6e20aa84a285e39",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),e("p",{key:"0e58961a5eb98223fc3ee31625b6864191e246d9",class:"m-0"},e("slot",{key:"85a67db424bb4982d1aee80f707e63a21def3ea2",name:"message"},"Cleaned on"))),e("svg",{key:"5e9cc2927c84bb26779d22551e0a41280018292a",class:{"range-picker__calendar-icon":true,"range-picker__icon--hidden":this.withOverlay&&!this.fromDate},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"14px",width:"14px"}},e("path",{key:"e644efbfc2d776dd94920457c910d08d815ff390",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),this.renderDatePicker("fromDate",this.fromDate,this.minDate,(t=>this.fromDatePicker=t)),e("svg",{key:"f73ac0d9c23e9cc40b27e6fc549dda19c61720c2",class:{"range-picker__arrow-icon":true,"range-picker__icon--hidden":this.withOverlay&&!this.fromDate},xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},e("path",{key:"9a03534d339123e0b08b53fe665133b457c681e2",fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),this.renderDatePicker("toDate",this.toDate,((t=this.fromDate)===null||t===void 0?void 0:t.toDate())||this.minSelectableDate,(t=>this.toDatePicker=t),{forceDestroyOnUpdate:true})))}};ru.style=ou;const lu=".sc-ir-reservation-information-h{display:block}";const cu=lu;const du=class{constructor(e){t(this,e);this.openSidebar=s(this,"openSidebar",7);this.userCountry=null}componentWillLoad(){var t,e,i;const s=(e=(t=this.booking)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.country_id;this.userCountry=s?((i=this.countries)===null||i===void 0?void 0:i.find((t=>t.id===s)))||null:null}handleEditClick(t,e){t.stopImmediatePropagation();t.stopPropagation();this.openSidebar.emit({type:e})}renderPhoneNumber(){const{mobile_without_prefix:t,country_phone_prefix:e,country_id:i}=this.booking.guest;if(!t){return null}if(e){return e+" "+t}if(i){const e=this.countries.find((t=>t.id===i));if(!e){throw new Error("Invalid country id")}return e.phone_prefix+" "+t}return t}render(){var t,i,s,a,n,o;const r=X(this.booking.extras);return e("div",{key:"6e39270272e54cf84ea8a6b1adbc5baf444c944b",class:"card"},e("div",{key:"b1630fa4761f37789ba446abc7a2069eec7eef1e",class:"p-1"},e("p",{key:"3da7d69e4201f43ea66f72a13a02d38d1d8ee059"},this.booking.property.name||""),e("ir-label",{key:"4e1c16b48b7f81bfe51c3ed840c5e541b0062b6c",labelText:`${y.entries.Lcz_Source}:`,content:this.booking.origin.Label,image:{src:this.booking.origin.Icon,alt:this.booking.origin.Label}}),e("ir-label",{key:"e8cef79cca96f87671f3047fb6acb2ededa86129",renderContentAsHtml:true,labelText:`${y.entries.Lcz_BookedOn}:`,content:`${g(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${b(this.booking.booked_on.hour.toString(),this.booking.booked_on.minute.toString())}`}),e("ir-label",{key:"78041ade71abdac6b5d9ebe7110e14232f5c47ad",labelText:`${y.entries.Lcz_BookedBy}:`,content:`${this.booking.guest.first_name} ${this.booking.guest.last_name}`},((t=this.booking.guest)===null||t===void 0?void 0:t.nbr_confirmed_bookings)>1&&!this.booking.agent&&e("div",{key:"2007a93cc8b663635d6e7e702f8ad2cd0daeba86",class:"m-0 p-0",slot:"prefix"},e("ir-tooltip",{key:"9e9305c73ddee31a703b569b573cb6fc0d2092cb",message:`${y.entries.Lcz_BookingsNbr}`.replace("%1",this.booking.guest.nbr_confirmed_bookings.toString()),customSlot:true},e("div",{key:"d997bac897a8b511bd46eebe76553dba26bdf8bd",class:"d-flex align-items-center m-0 p-0",slot:"tooltip-trigger",style:{gap:"0.25rem"}},e("p",{key:"c899b5e10c470250c97fc6e7644ce57061d17ce4",class:"p-0 m-0",style:{color:"#FB0AAD"}},this.booking.guest.nbr_confirmed_bookings),e("ir-icons",{key:"e36e4b32b8eb0bb32283c5e95bc603216967379f",style:{"--icon-size":"1rem"},color:"#FB0AAD",name:"heart-fill"})))),e("ir-button",{key:"045b8cfe96926b1ae484ae590be33b32bf1baf5f",slot:"suffix",variant:"icon",icon_name:"edit",style:Object.assign(Object.assign({},wt.secondary),{"--icon-size":"1.1rem"}),onClickHandler:t=>this.handleEditClick(t,"guest")})),this.booking.guest.mobile&&e("ir-label",{key:"e416b6024781e0599f72bef37391585ac94abd8d",labelText:`${y.entries.Lcz_Phone}:`,content:this.renderPhoneNumber()}),!this.booking.agent&&e("ir-label",{key:"cd07ec1d7906be89fd8be1b4839185dd369ab8f3",labelText:`${y.entries.Lcz_Email}:`,content:this.booking.guest.email}),this.booking.guest.alternative_email&&e("ir-label",{key:"eaf3d5475d8389374d817562f6abed08ceaf78f2",labelText:`${y.entries.Lcz_AlternativeEmail}:`,content:this.booking.guest.alternative_email}),((s=(i=this.booking)===null||i===void 0?void 0:i.guest)===null||s===void 0?void 0:s.address)&&e("ir-label",{key:"af02f4774b74089d61cb26349f46a97af97116d9",labelText:`${y.entries.Lcz_Address}:`,content:this.booking.guest.address}),this.userCountry&&e("ir-label",{key:"8e30cf90902d13518c1c8c358bc3d33e856caa51",labelText:`${y.entries.Lcz_Country}:`,isCountryImage:true,content:this.userCountry.name,image:{src:this.userCountry.flag,alt:this.userCountry.name}}),((a=this.booking.guest)===null||a===void 0?void 0:a.notes)&&e("ir-label",{key:"fd083faf287c7db5e9be27c778b1de6e7b35ac78",display:"inline",labelText:`${y.entries.Lcz_GuestPrivateNote}:`,content:(n=this.booking.guest)===null||n===void 0?void 0:n.notes}),this.booking.is_direct&&e("ir-label",{key:"bb8c0fcc91a41daef81fa90d86726de9e395c750",labelText:`${y.entries.Lcz_ArrivalTime}:`,content:this.booking.arrival.description}),this.booking.promo_key&&e("ir-label",{key:"eee49734a60949ee501711f6b96c15fc94b77a1a",labelText:`${y.entries.Lcz_Coupon}:`,content:this.booking.promo_key}),this.booking.is_in_loyalty_mode&&!this.booking.promo_key&&e("div",{key:"ccae8957124eb50581f55c46de95562fc2426af4",class:"d-flex align-items-center"},e("svg",{key:"bb3ceca81849421ec1b4c5cac79e71dd861d24fe",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"af469982cb9fa8f136d45f164be236eb17ab318b",fill:"#fc6c85",d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"})),e("p",{key:"1409164ed9208567cdd16fc8718ac3c51d3ab5a6",class:"m-0 p-0 ml-1"},y.entries.Lcz_LoyaltyDiscountApplied)),this.booking.is_direct?e("ir-label",{labelText:`${y.entries.Lcz_GuestRemark}:`,display:"inline",content:this.booking.remark}):e("ota-label",{class:"m-0 p-0",label:`${y.entries.Lcz_ChannelNotes||"Channel notes"}:`,remarks:this.booking.ota_notes,maxVisibleItems:(o=this.booking.ota_notes)===null||o===void 0?void 0:o.length}),e("div",{key:"ba14775844d248867199de3d451fc51af5634ccc",class:"d-flex align-items-center justify-content-between"},e("ir-label",{key:"22ec5587ec44cdb82b452db86e6773877b8ad20b",labelText:`${y.entries.Lcz_BookingPrivateNote}:`,placeholder:y.entries.Lcz_VisibleToHotelOnly,content:r,display:r?"inline":"flex"}),e("ir-button",{key:"faf63960ec3dc418f25a60937600847a6253dd30",variant:"icon",icon_name:"edit",style:wt.secondary,onClickHandler:t=>this.handleEditClick(t,"extra_note")}))))}};du.style=cu;const hu=".base-host.sc-ir-reset-password{height:100vh;display:grid;align-content:center;padding:2rem;box-sizing:border-box;background-position:center;background-repeat:no-repeat;background-size:cover;background:white}p.sc-ir-reset-password,input.sc-ir-reset-password,button.sc-ir-reset-password{margin:0}p.sc-ir-reset-password,input.sc-ir-reset-password,button.sc-ir-reset-password,div.sc-ir-reset-password,section.sc-ir-reset-password,form.sc-ir-reset-password{box-sizing:border-box}.lock-icon.sc-ir-reset-password{align-self:center}.form-container.sc-ir-reset-password{padding:1rem;display:flex;flex-direction:column;height:100%;background:white;border-radius:0.25rem;gap:1rem;width:100%;max-width:38rem;margin-left:auto;margin-right:auto}.separator-container.sc-ir-reset-password{display:flex;align-items:center;gap:0.5rem;padding-top:1.5rem;padding-bottom:1rem}.separator-container.sc-ir-reset-password p.sc-ir-reset-password{color:#6b6f82;font-size:1rem}.separator.sc-ir-reset-password{flex:1 1 0%;height:1px;background:#dadada}.login-btn.sc-ir-reset-password{margin-top:1rem}.logo.sc-ir-reset-password{align-self:center}.app_links.sc-ir-reset-password{display:flex;align-items:center;justify-content:center;gap:1rem;padding-block:0.5rem}.app_links.sc-ir-reset-password a.sc-ir-reset-password img.sc-ir-reset-password{width:70%}.password_toggle.sc-ir-reset-password{all:unset;position:absolute;top:2px;right:1rem}";const uu=hu;const fu=".sc-ir-reset-password-h{height:100%}.sheet-container.sc-ir-reset-password{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-reset-password{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-reset-password{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-reset-password{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-reset-password{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-reset-password{flex-direction:row;align-items:center}}";const pu=fu;const bu=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.language="en";this.showValidator=false;this.autoValidate=false;this.error={};this.submitted=false;this.isLoading=false;this.isFetching=false;this.token=new pt;this.authService=new Md;this.systemService=new Qd;this.roomService=new bt;this.initialized=false;this.ResetPasswordSchema=N.object({password:N.string().regex(sc.PASSWORD),confirm_password:N.string().nullable().refine((t=>{if(!sc.PASSWORD.test(t)){return false}return t===this.password}),{message:"Password must be at least 8 characters long."})})}componentWillLoad(){if(this.ticket){this.token.setToken(this.ticket)}}componentDidLoad(){this.init()}handleTicketChange(t,e){if(t!==e){this.token.setToken(this.ticket);this.init()}}async init(){if(!this.ticket||this.initialized){return}const[t]=await Promise.all([this.roomService.fetchLanguage(this.language,["_USER_MGT"]),this.systemService.checkOTPNecessity({METHOD_NAME:"Change_User_Pwd"})]);y.entries=t.entries;y.direction=t.direction;this.initialized=false}async handleChangePassword(t){t.preventDefault();try{this.error={};this.isLoading=true;this.autoValidate=true;this.ResetPasswordSchema.parse({password:this.password,confirm_password:this.confirmPassword});await this.authService.changeUserPwd({username:this.username,new_pwd:this.password,old_pwd:this.old_pwd});if(!this.skip2Fa){window.history.back()}if(this.el.slot==="sidebar-body"){this.closeSideBar.emit()}}catch(t){if(t instanceof R){let e={};t.issues.map((t=>{const i=t.path[0];console.log(i,t);if(i==="password"){this.showValidator=true}e[i]=true}));this.error=e}}finally{this.isLoading=false}}handleOtpFinished(t){if(t.detail.type==="success"){return}if(this.el.slot!=="sidebar-body"){window.history.back()}else{this.closeSideBar.emit()}}render(){var t,i,s,n,o,r,l;const c=this.el.slot==="sidebar-body";return e("div",{key:"7935a5b0fcadd5e1bff577773b286a36248cfdea",class:{"base-host":!c,"h-100":c}},e(a,{key:"f0d245ed538d09fe901d78db3061af60210430e7"},!c&&e(a,{key:"5f37866e2579bbff3bb3e5a2513be891dcf17048"},e("ir-interceptor",{key:"569fbcd0cecdfa4b04f33cafd178d72a506f4c72",suppressToastEndpoints:["/Change_User_Pwd"]}),e("ir-toast",{key:"7af5edf54617ad015d9708f6f739c63b2b9bb0c8"})),e("form",{key:"ee9375d20623ff55bdafc31bd6debcbfd83fe609",onSubmit:this.handleChangePassword.bind(this),class:{"sheet-container":c}},c&&e("ir-title",{key:"86e65bc00aad7bd832803705cafa5b003700f85d",class:"px-1 sheet-header",displayContext:"sidebar",label:"Change Password"}),e("div",{key:"d366eae2471d4f8b3684cb4d35b1bca2eb3eecb2",class:{"form-container":true,"sheet-body px-1":c,"px-2":!c}},e("svg",{key:"059e71c36d0f293605c6f2715449c8eeb26a2890",class:"lock-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:24,width:24},e("path",{key:"4b23c71d423cf1c0399ef8bd73036e753999274e",fill:"currentColor",d:"M144 144l0 48 160 0 0-48c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192l0-48C80 64.5 144.5 0 224 0s144 64.5 144 144l0 48 16 0c35.3 0 64 28.7 64 64l0 192c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 256c0-35.3 28.7-64 64-64l16 0z"})),e("div",{key:"57bb751d31fddabeb9b9bf31d84a8d73d45a4883",class:"text-center mb-2"},e("h4",{key:"8ef7d471e023cc5d8e8f83a9918a3f3e4ad4899a",class:"mb-1"},(t=y===null||y===void 0?void 0:y.entries)===null||t===void 0?void 0:t.Lcz_SetNewPassword),this.submitted?e("p",null,"An email has been sent to your address. Please check your inbox to confirm the password change."):e("p",null,"Your new password must be different to previously used password")),!this.submitted&&e("section",{key:"ee0af24598e9dc10e6cd36d878d9570ef582c524"},e("div",{key:"cf23c401d50d7c5bdb039795102bbb3afed267d2",class:"mb-2"},e("div",{key:"ba966ca020b9c8d78f11ec531671bb7f4bea9536",class:"m-0 p-0"},e("div",{key:"579c8fb73b84a1c39f5252a36d987a575b1a49bd",class:"position-relative"},e("ir-input-text",{key:"ced3a448f796efc4fe121adaea40c13ccd396a1a",error:(i=this.error)===null||i===void 0?void 0:i.password,autoValidate:this.autoValidate,value:this.password,onTextChange:t=>this.password=t.detail,label:"",class:"m-0 p-0",inputStyles:"m-0",zod:this.ResetPasswordSchema.pick({password:true}),wrapKey:"password",placeholder:(s=y.entries)===null||s===void 0?void 0:s.Lcz_NewPassword,onInputFocus:()=>this.showValidator=true,type:"password"})),this.showValidator&&e("ir-password-validator",{key:"9b1d7f4b61bf62c64ac189146b3b5c974bb529f6",class:"mb-1",password:this.password})),e("div",{key:"e336f02a5e5c99bd8df966857427edded06f318b",class:"position-relative"},e("ir-input-text",{key:"74e9f08698e9d29ba42b8f8c8a9363e7cc6fdcc5",error:(n=this.error)===null||n===void 0?void 0:n.confirm_password,autoValidate:this.autoValidate,zod:this.ResetPasswordSchema.pick({confirm_password:true}),wrapKey:"confirm_password",value:this.confirmPassword,onTextChange:t=>this.confirmPassword=t.detail,label:"",placeholder:(o=y.entries)===null||o===void 0?void 0:o.Lcz_ConfirmPassword,type:"password"}))),!c&&e("div",{key:"1e81799d28a29913c0be6a63c21d7abb0bcf4645",class:"d-flex flex-column mt-2 flex-sm-row align-items-sm-center",style:{gap:"0.5rem"}},e("ir-button",{key:"0d041448fa125d586433ee04ff7fbfcbe20a3cda",btn_styles:"flex-fill",onClickHandler:()=>window.history.back(),class:"flex-fill",text:(r=y.entries)===null||r===void 0?void 0:r.Lcz_Cancel,size:"md",btn_color:"secondary"}),e("ir-button",{key:"deaca84ef81a224197488ea2d11f15564f5c7c24",btn_styles:"flex-fill",class:"flex-fill",isLoading:this.isLoading,btn_type:"submit",text:(l=y.entries)===null||l===void 0?void 0:l.Lcz_ChangePassword,size:"md"})))),c&&e("div",{key:"a6c2247984630935690b4aec5760740583331d69",class:"sheet-footer w-full"},e("ir-button",{key:"28044ebfa6082e7c27a6e16bd23a2c52d4d8e913",text:y.entries.Lcz_Cancel,onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill",btn_color:"secondary",btn_styles:"w-100 justify-content-center align-items-center",size:"md"}),e("ir-button",{key:"25b08b0b8c9e48b3c98575c1669647ce5f3040d8",isLoading:this.isLoading,class:"flex-fill",btn_type:"submit",btn_styles:"w-100 justify-content-center align-items-center",text:y.entries.Lcz_ChangePassword,size:"md"})))))}get el(){return n(this)}static get watchers(){return{ticket:["handleTicketChange"]}}};bu.style=uu+pu;const gu=".sc-ir-revenue-row-h{--ir-border:#e5e7eb}.ir-revenue-row__accordion.sc-ir-revenue-row::part(base),.ir-revenue-row.sc-ir-revenue-row{border:0;border-radius:0;border-bottom:1px solid var(--ir-border, #e5e7eb);background:#fff;padding:0}.ir-revenue-row__header.sc-ir-revenue-row{display:flex;align-items:center;justify-content:space-between;padding:var(--ir-space-4, 1rem);border-bottom:1px solid var(--ir-border, #e5e7eb)}.ir-revenue-row__accordion.sc-ir-revenue-row::part(trigger),.ir-revenue-row__title.sc-ir-revenue-row{display:inline-flex;align-items:center;gap:0.5rem;background:transparent;border:0;padding:0;cursor:pointer;text-align:left;width:100%;justify-content:space-between;padding:0.5rem;color:black}.ir-revenue-row__title.sc-ir-revenue-row{padding:0}.ir-revenue-row__header-left.sc-ir-revenue-row{display:flex;align-items:center;gap:0.5rem}.ir-revenue-row__accordion.sc-ir-revenue-row::part(trigger):hover{background:#f4f5fa}.ir-revenue-row__group.sc-ir-revenue-row{margin:0;font-weight:600}.ir-revenue-row__badge.sc-ir-revenue-row{background:lightgray;border-radius:0.25rem;font-size:0.75rem;padding:0 0.5rem;margin-left:0.375rem}.ir-revenue-row__total.sc-ir-revenue-row{font-weight:700;margin:0}.ir-revenue-row__accordion.sc-ir-revenue-row::part(content){padding:0.25rem 1rem}.ir-revenue-row__detail.sc-ir-revenue-row{display:block;border-bottom:1px solid var(--ir-border, #e5e7eb)}.ir-revenue-row__detail.sc-ir-revenue-row:last-child{border-bottom:none}";const mu=gu;let vu=0;const yu=class{constructor(e){t(this,e);this.payments=[];this.contentId=`ir-rr-content-${++vu}`}render(){const t=this.payments.reduce(((t,e)=>t+e.amount),0);return e(i,{key:"d771851ae1a4dc3f7aa1a70079f47bc1e157d339"},e("ir-accordion",{key:"f5580bde741bd61237de4f5b18d43b73f09e8a13",class:"ir-revenue-row__accordion"},e("div",{key:"84ce626764aa6adcc53028c91257d52af5aed711",slot:"trigger",class:"ir-revenue-row__title"},e("div",{key:"a9f519b5b54aa9809d17810cfd7c9c998bcc3629",class:"ir-revenue-row__header-left"},e("p",{key:"5ff1802fc5e9daac0e16dbfa6874f2ce8408ddbd",class:"ir-revenue-row__group"},this.groupName," ",e("span",{key:"b5addb7c3e20cedd63da7e22212fb4c59bc3ff59",class:"ir-revenue-row__badge","aria-label":`${this.payments.length} transactions`},this.payments.length))),e("p",{key:"0a5c78fb2499e0fc9bef36e355952df9cc5a1ba0",class:"ir-revenue-row__total"},_(x.currency.symbol,t))),e("div",{key:"fa5d1d481e06931a59b03f9b94adb138319b8e2e",class:"ir-revenue-row__details",id:this.contentId},e("div",{key:"e383af7d04633b6f5e37ccec08619c20b6adf193",class:"ir-revenue-row__details-inner"},this.payments.map((t=>e("ir-revenue-row-details",{class:"ir-revenue-row__detail",id:t.id,payment:t,key:t.id})))))))}get host(){return n(this)}};yu.style=mu;const ku=".sc-ir-revenue-row-details-h{border-bottom:1px solid var(--ir-border, #e5e7eb);font-size:0.875rem}.ir-revenue-row-detail.sc-ir-revenue-row-details{display:flex;gap:0.5rem;padding:0.5rem 0;flex-direction:column}.ir-revenue-row-detail.sc-ir-revenue-row-details:hover{background:#f4f5fa}.ir-revenue-row-detail__booking.sc-ir-revenue-row-details{display:inline-flex}.ir-revenue-row-detail__booking-btn.sc-ir-revenue-row-details{display:inline-flex}.ir-revenue-row-detail.sc-ir-revenue-row-details:last-child{border-bottom:none}.ir-revenue-row-detail__label.sc-ir-revenue-row-details{font-weight:500;color:var(--ir-muted, #6b7280);margin-right:0.25rem}.ir-revenue-row-detail__amount.sc-ir-revenue-row-details{font-weight:600;text-align:right;white-space:nowrap;flex:1 1 0%}.ir-revenue-row-detail__amount.negative.sc-ir-revenue-row-details{color:var(--ir-danger, #dc2626)}.ir-revenue-row-detail__meta.sc-ir-revenue-row-details{display:flex;align-items:center}.ir-revenue-row-detail__amount.sc-ir-revenue-row-details{display:none}.ir-revenue-row-detail__time.sc-ir-revenue-row-details{display:flex;gap:0.5rem}.ir-revenue-row-detail__time.sc-ir-revenue-row-details .ir-revenue-row-detail__amount.sc-ir-revenue-row-details{display:flex;flex:1 1 0%;justify-content:end}@media (min-width: 640px){.ir-revenue-row-detail.sc-ir-revenue-row-details{flex-direction:row;align-items:center;gap:1rem}.ir-revenue-row-detail__amount.sc-ir-revenue-row-details{display:inline-flex;justify-content:flex-end}.ir-revenue-row-detail__time.sc-ir-revenue-row-details .ir-revenue-row-detail__amount.sc-ir-revenue-row-details{display:none}}";const wu=ku;const xu=class{constructor(e){t(this,e);this.revenueOpenSidebar=s(this,"revenueOpenSidebar",7)}render(){return e(i,{key:"1b6b88246c1b2b35d82647c7139dc91ec1e15dd4"},e("div",{key:"29c3043765824b8123654bd0fb3d51fd8094d365",class:"ir-revenue-row-detail"},e("div",{key:"3aeeb4bcc77485ed48fe0b0caeb318fca3400932",class:"ir-revenue-row-detail__time"},e("span",{key:"69e598ec3f8f8c324c1b8c4ab881a98d14f10057",class:"ir-revenue-row-detail__label"},this.payment.date),e("span",{key:"7b1fb2b2cd64646b244f829a8c971226d6a7d197",class:"ir-revenue-row-detail__value"},b(this.payment.hour.toString(),this.payment.minute.toString())),e("div",{key:"3a580c0cfb6256db01a8aeb2536f87ed28f5c522",class:"ir-revenue-row-detail__amount"},_(x.currency.symbol,this.payment.amount))),e("div",{key:"054e64327400fd03c52f1511f27a8135e5180a8e",class:"ir-revenue-row-detail__meta"},e("div",{key:"e64b8a09698022cc6728c739b880289c09500bda",class:"ir-revenue-row-detail__user"},e("span",{key:"53bebb0b8edc2640e6f81e7db334eee4c9ae41f2",class:"ir-revenue-row-detail__label"},"User:"),e("span",{key:"5d75184a4bb14f5fa6099a574f89754d909740aa",class:"ir-revenue-row-detail__value"},this.payment.user)),e("div",{key:"9aa35e829b36afe41378e0158eb7d959a3abd412",class:"ir-revenue-row-detail__booking"},e("ir-button",{key:"1d31861ae72f3148f7293ef38ec6abc6d24fc676",variant:"default",btn_color:"link",text:this.payment.bookingNbr,class:"ir-revenue-row-detail__booking-btn",size:"sm",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.revenueOpenSidebar.emit({payload:{bookingNumber:Number(this.payment.bookingNbr)},type:"booking"})},btnStyle:{width:"fit-content",margin:"0",padding:"0",fontSize:"inherit",textAlign:"center",lineHeight:"1.2"}}))),e("div",{key:"5df78183172e75d48f1499f76a2f440b6150f4e6",class:"ir-revenue-row-detail__amount"},_(x.currency.symbol,this.payment.amount))))}};xu.style=wu;const _u=".ir-revenue-summary__mobile.sc-ir-revenue-summary{display:flex;align-items:center;gap:1rem}.ir-revenue-summary__tablet.sc-ir-revenue-summary{display:none;grid-template-columns:repeat(3, 1fr);gap:1rem}.stats-card__payments-value.sc-ir-revenue-summary{color:#629a4c}.stats-card__refund-value.sc-ir-revenue-summary{color:#ff4961}@media (min-width: 768px){.ir-revenue-summary__tablet.sc-ir-revenue-summary{display:grid}.ir-revenue-summary__mobile.sc-ir-revenue-summary{display:none}}";const Du=_u;const Cu=class{constructor(e){t(this,e);this.groupedPayments=new Map;this.previousDateGroupedPayments=new Map}calculateTotalPayments(t){let e=0;t.forEach(((t,i)=>{if(i.split("_")[0]==="001"){e+=this.calculateTotalValue(t)}}));return e}calculateTotalRefunds(t){const e="010";const i=[];t.forEach(((t,s)=>{if(s.split("_")[0]===e){i.push(...t)}}));return this.calculateTotalValue(i)}calculateTotalValue(t){return t.reduce(((t,e)=>t+e.amount),0)}getTrendIcon(t,e){if(t===e){return undefined}return t>e?"arrow-trend-up":"arrow-trend-down"}render(){const t=this.calculateTotalPayments(this.groupedPayments);const s=this.calculateTotalRefunds(this.groupedPayments);const a=t-s;const n=this.calculateTotalPayments(this.previousDateGroupedPayments);const o=this.calculateTotalRefunds(this.previousDateGroupedPayments);const r=n-o;return e(i,{key:"206be2ddc008555e9ef25623d9a9d09280c86a94"},e("div",{key:"498c459ced457e9e1ad5883c088d7d85619ae0a0",class:"ir-revenue-summary__mobile"},e("ir-stats-card",{key:"d55e95b3bbf6eb13e3ef24d928d0b86b54ea576e",icon:"arrow-trend-up",value:_(x.currency.symbol,t),cardTitle:"Payments"},e("p",{key:"1ad2460bb6bf8e50c1c0c1a12ac50b1840c25702",class:"stats-card__payments-value",slot:"value"},_(x.currency.symbol,t))),e("ir-stats-card",{key:"8442750d1d9cb250e08091fe11b383413c14057b",value:"123$",class:"refunds-card",icon:"arrow-trend-down",cardTitle:"Refunds"},e("p",{key:"a01be0029b5e9455928277ed8c92d3c3f3d29e34",class:"stats-card__refund-value",slot:"value"},_(x.currency.symbol,s)))),e("div",{key:"3dd3352e24f7a43277cf152df80411bfd56f9130",class:"ir-revenue-summary__tablet"},e("ir-stats-card",{key:"87ce0589b3aa966ea42940d6749525d95d4f7ced",icon:"arrow-trend-up",value:_(x.currency.symbol,t),cardTitle:"Payments",subtitle:`Previous day  ${_(x.currency.symbol,n)}`},e("p",{key:"625bb9ea6f2f7d544112d45f49c33b9f46dbeca5",class:"stats-card__payments-value",slot:"value"},_(x.currency.symbol,t))),e("ir-stats-card",{key:"fc0b66dccd849f78812e5560c84306735ea386f0",value:"123$",class:"refunds-card",icon:"arrow-trend-down",cardTitle:"Refunds",subtitle:`Previous day  ${_(x.currency.symbol,o)}`},e("p",{key:"3367e94c3c47bc6a0610251029487448a8577dec",class:"stats-card__refund-value",slot:"value"},_(x.currency.symbol,s))),e("ir-stats-card",{key:"294b70ff022cce8d3368170365a2209a32c01971",icon:this.getTrendIcon(a,r),value:_(x.currency.symbol,a),cardTitle:"Difference",subtitle:`Previous day  ${_(x.currency.symbol,r)}`})))}};Cu.style=Du;const Ou=".sc-ir-revenue-table-h{overflow-x:hidden;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.sc-ir-revenue-table-h *.sc-ir-revenue-table{font-family:inherit !important;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important}.revenue-table__header.sc-ir-revenue-table{box-sizing:border-box;background:#ececec;color:#374151;display:flex;align-items:center;justify-content:space-between;padding:0.5rem 1rem}.revenue-table__header.sc-ir-revenue-table p.sc-ir-revenue-table{padding:0;margin:0;font-size:1rem;font-weight:700}.revenue-table__title-section.sc-ir-revenue-table{display:flex;align-items:center;justify-content:center;padding-bottom:0.875rem}.revenue-table__table.sc-ir-revenue-table{min-height:50vh}";const Mu=Ou;const Eu=class{constructor(e){t(this,e);this.payments=new Map}componentWillLoad(){const t=t=>{let e={};this.paymentEntries[t].forEach((t=>{e=Object.assign(Object.assign({},e),{[t.CODE_NAME]:t.CODE_VALUE_EN})}));return e};this.payTypesObj=t("types");this.payMethodObj=t("methods")}render(){return e("div",{key:"6e7e0ae34be1418d4b330987300f4dce908f2d8a",class:"card p-1 revenue-table__table"},this.payments.size>0?e(a,null,e("div",{class:"revenue-table__header"},e("p",null,"Method"),e("p",null,"Amount")),Array.from(this.payments.entries()).map((([t,i])=>{const[s,a]=t.split("_");const n=mh.includes(s)?`${this.payTypesObj[s]}: ${this.payMethodObj[a]}`:this.payTypesObj[s];return e("ir-revenue-row",{key:t,payments:i,groupName:n})}))):e("p",{class:"text-center my-auto mx-auto"},"There are no payment transactions recorded for the selected date."))}};Eu.style=Mu;const Yu=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.1rem 0.3rem;border-radius:5px;display:block;max-width:100px;box-sizing:border-box;display:inline-block;overflow:hidden;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default}.room_statements.sc-ir-room{display:block;width:100%}.room_statements.sc-ir-room{display:block;width:100%}.room_statements.sc-ir-room span.sc-ir-room{display:inline;white-space:normal;line-height:1.5;word-break:break-word}.room_statements.sc-ir-room b.sc-ir-room{display:inline;margin-right:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.subtotal_row.sc-ir-room{padding-top:8px;font-weight:600}.room_actions_btns.sc-ir-room{gap:0.5rem}.night-cost.sc-ir-room{color:#7cbebe}.room_actions_btns.sc-ir-room{white-space:nowrap;width:max-content}.room_actions_btns.sc-ir-room{flex:1 1 0%;display:flex;justify-content:flex-end}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Au=Yu;const Tu=class{constructor(e){t(this,e);this.deleteFinished=s(this,"deleteFinished",7);this.toast=s(this,"toast",7);this.pressCheckIn=s(this,"pressCheckIn",7);this.pressCheckOut=s(this,"pressCheckOut",7);this.editInitiated=s(this,"editInitiated",7);this.resetbooking=s(this,"resetbooking",7);this.openSidebar=s(this,"openSidebar",7);this.currency="USD";this.language="en";this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.collapsed=false;this.isLoading=false;this.modalReason=null;this.isModelOpen=false;this.bookingService=new l}componentWillLoad(){this.mainGuest=this.getMainGuest()}handleClick(t){let e=t.target;if(e.id=="checkin"){this.pressCheckIn.emit(this.room)}else if(e.id=="checkout"){this.pressCheckOut.emit(this.room)}}handleRoomDataChange(){this.mainGuest=this.getMainGuest()}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}handleEditClick(){var t,e,i,s,a,n,o,r;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.room["assigned_units_pool"],NAME:U((t=this.mainGuest)===null||t===void 0?void 0:t.first_name,(e=this.mainGuest)===null||e===void 0?void 0:e.last_name),EMAIL:this.booking.guest.email,PHONE:this.booking.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.booking.from_date,TO_DATE:this.booking.to_date,TITLE:`${y.entries.Lcz_EditBookingFor} ${(s=(i=this.room)===null||i===void 0?void 0:i.roomtype)===null||s===void 0?void 0:s.name} ${((n=(a=this.room)===null||a===void 0?void 0:a.unit)===null||n===void 0?void 0:n.name)||""}`,defaultDateRange:{dateDifference:this.room.days.length,fromDate:new Date(this.room.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.room.from_date+"T00:00:00")),toDate:new Date(this.room.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.room.to_date+"T00:00:00")),message:""},bed_preference:this.room.bed_preference,adult_child_offering:this.room.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.room.rateplan.selected_variation.adult_nbr,ARRIVAL:this.booking.arrival,ARRIVAL_TIME:this.booking.arrival.description,BOOKING_NUMBER:this.booking.booking_nbr,cancelation:this.room.rateplan.cancelation,channel_booking_nbr:this.booking.channel_booking_nbr,CHILDREN_COUNT:this.room.rateplan.selected_variation.child_nbr,COUNTRY:this.booking.guest.country_id,ENTRY_DATE:this.booking.from_date,FROM_DATE_STR:this.booking.format.from_date,guarantee:this.room.rateplan.guarantee,GUEST:this.mainGuest,IDENTIFIER:this.room.identifier,is_direct:this.booking.is_direct,IS_EDITABLE:this.booking.is_editable,NO_OF_DAYS:this.room.days.length,NOTES:this.booking.remark,origin:this.booking.origin,POOL:this.room["assigned_units_pool"],PR_ID:(o=this.room.unit)===null||o===void 0?void 0:o.id,RATE:this.room.total,RATE_PLAN:this.room.rateplan.name,RATE_PLAN_ID:this.room.rateplan.id,RATE_TYPE:this.room.roomtype.id,ROOMS:this.booking.rooms,SOURCE:this.booking.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.booking.format.to_date,TOTAL_PRICE:this.booking.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((r=this.room.unit)===null||r===void 0?void 0:r.name)||"",PICKUP_INFO:this.booking.pickup_info,booking:this.booking,currentRoomType:this.room})}openModal(t){if(!t){return}this.modalReason=t;this.modal.openModal()}async handleModalConfirmation(t){try{t.stopImmediatePropagation();t.stopPropagation();if(!this.modalReason){return}this.isLoading=true;switch(this.modalReason){case"delete":await this.deleteRoom();break;case"checkin":case"checkout":await this.bookingService.handleExposedRoomInOut({booking_nbr:this.booking.booking_nbr,room_identifier:this.room.identifier,status:this.modalReason==="checkin"?"001":"002"});this.resetbooking.emit(null);break}}catch(t){console.log(t)}finally{this.isLoading=false;this.modalReason=null;this.modal.closeModal()}}async deleteRoom(){let t=[...this.booking.rooms];t=t.filter((t=>t.identifier!==this.room.identifier));const e={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.booking.booking_nbr,from_date:this.booking.from_date,to_date:this.booking.to_date,remark:this.booking.remark,property:this.booking.property,source:this.booking.source,currency:this.booking.currency,arrival:this.booking.arrival,guest:this.booking.guest,rooms:t},extras:this.booking.extras,pickup_info:this.booking.pickup_info};await this.bookingService.doReservation(e);this.deleteFinished.emit(this.room.identifier)}async updateDepartureTime(t){try{await this.bookingService.setDepartureTime({property_id:this.property_id,code:t,room_identifier:this.room.identifier});this.toast.emit({type:"success",description:"",title:"Saved Successfully",position:"top-right"})}catch(t){console.log(t)}}formatVariation({infant_nbr:t,adult_nbr:e,children_nbr:i}){const s=e>0?e:0;const a=i>0?i:0;const n=t>0?t:0;const o=s>1?y.entries.Lcz_Adults.toLowerCase():y.entries.Lcz_Adult.toLowerCase();const r=a>1?y.entries.Lcz_Children.toLowerCase():y.entries.Lcz_Child.toLowerCase();const l=n>1?y.entries.Lcz_Infants.toLowerCase():y.entries.Lcz_Infant.toLowerCase();const c=[];if(s>0){c.push(`${s} ${o}`)}if(a>0){c.push(`${a} ${r}`)}if(n>0){c.push(`${n} ${l}`)}return c.join("&nbsp&nbsp&nbsp&nbsp")}getSmokingLabel(){var t,e,i;if(this.booking.is_direct){if(!this.room.smoking_option){return null}const i=x.roomsInfo.find((t=>t.id===this.room.roomtype.id));if(i){const s=(t=i["smoking_option"])===null||t===void 0?void 0:t.allowed_smoking_options;if(s){return(e=s.find((t=>t.code===this.room.smoking_option)))===null||e===void 0?void 0:e.description}return null}return null}return(i=this.room.ota_meta)===null||i===void 0?void 0:i.smoking_preferences}getBedName(){var t,e;if(this.booking.is_direct){const e=this.bedPreferences.find((t=>{var e,i;return t.CODE_NAME===((i=(e=this.room)===null||e===void 0?void 0:e.bed_preference)===null||i===void 0?void 0:i.toString())}));if(!e){return}return(t=e[`CODE_VALUE_${this.language}`])!==null&&t!==void 0?t:e.CODE_VALUE_EN}return(e=this.room.ota_meta)===null||e===void 0?void 0:e.bed_preferences}renderModalMessage(){switch(this.modalReason){case"delete":return`${y.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.room.roomtype.name} ${this.room.unit?this.room.unit.name:""} ${y.entries.Lcz_FromThisBooking}`;case"checkin":return`Are you sure you want to Check In this unit?\n`;case"checkout":return`Are you sure you want to Check Out this unit?`;default:return""}}handleCheckIn(){const{adult_nbr:t,children_nbr:e,infant_nbr:i}=this.room.occupancy;if(this.room.sharing_persons.length<t+e+i){return this.showGuestModal()}return this.renderModalMessage()}getMainGuest(){var t;return(t=this.room.sharing_persons)===null||t===void 0?void 0:t.find((t=>t.is_main))}render(){var t,s,n,o;const r=this.getBedName();return e(i,{key:"43cce4feaf2511652c9939c68728e9bdf51ff567",class:"p-1 d-flex m-0"},e("ir-button",{key:"c2f0ffaeb8cd417d3ac5b07d225a0b40c232f53d",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${(t=this.room.identifier)===null||t===void 0?void 0:t.split(" ").join("")}`,"aria-expanded":this.collapsed?"true":"false","aria-controls":"myCollapse",class:"mr-1",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}}),e("div",{key:"467822baf40390bead46a5a0ab0eb3a2136ef61e",class:"flex-fill m-0 "},e("div",{key:"40ec179409b3ebeae5450caa91bcd3e630f5418c",class:"d-flex align-items-start justify-content-between sm-mb-1"},e("p",{key:"0d8fa6317a5848ae90f7731551078636f920ac6f",class:"m-0 p-0"},e("span",{key:"5e1cf094e66648ddc4f5efdc50b52528276bd75e",class:"m-0 p-0",style:{fontWeight:"600"}},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.room.rateplan.is_non_refundable&&` - ${y.entries.Lcz_NonRefundable}`," "),e("div",{key:"f080754a584b48761a17600665614896c64f430c",class:"d-flex m-0 p-0 align-items-center room_actions_btns"},e("span",{key:"c1146cf890dbd61137545de46b85d9e3ee16a55a",class:"p-0 m-0 font-weight-bold"},_(this.currency,this.room["gross_total"])),this.hasRoomEdit&&this.isEditable&&e("ir-button",{key:"a684fef7bab5c6b4eb590080fc433a5f2b531bf5",id:`roomEdit-${this.room.identifier}`,variant:"icon",icon_name:"edit",style:wt.secondary,onClickHandler:this.handleEditClick.bind(this)}),this.hasRoomDelete&&this.isEditable&&e("ir-button",{key:"60329981b2be06e3a54ab036bb3e1fe7edf7ae6f",variant:"icon",onClickHandler:this.openModal.bind(this,"delete"),id:`roomDelete-${this.room.identifier}`,icon_name:"trash",style:wt.danger}))),e("div",{key:"76bbf2bb95373ce728cb37f4d499dc52dc803a2c",class:"d-flex align-items-center sm-mb-1"},e("ir-date-view",{key:"f4dd3308148b1827f95c3634b32eecfa42123863",class:"mr-1  flex-grow-1",style:{width:"fit-content"},from_date:this.room.from_date,to_date:this.room.to_date,showDateDifference:false}),!w(this.room.roomtype.id)&&x.is_frontdesk_enabled&&this.room.unit&&e("div",{key:"226f2d135f594f581ad926bae710b51018a01530",class:"d-flex justify-content-center align-items-center"},e("ir-tooltip",{key:"c73df6c929f0f517a0ac92e2e1e3a3623aac4d64",message:this.room.unit.name,customSlot:true},e("span",{key:"b22947738864aa153e7c97408d9a10dd59eed797",slot:"tooltip-trigger",class:`light-blue-bg  ${this.hasCheckIn||this.hasCheckOut?"mr-2":""} `},this.room.unit.name))),this.hasCheckIn&&e("ir-button",{key:"da1a94d356152f2a624e9ae063bbd40b2f9c37bd",onClickHandler:this.handleCheckIn.bind(this),id:"checkin",btn_color:"outline",size:"sm",text:y.entries.Lcz_CheckIn}),this.hasCheckOut&&e("ir-button",{key:"f97a1b4dbb9e965c607b4eef2e221fcaa14cacd1",onClickHandler:this.openModal.bind(this,"checkout"),id:"checkout",btn_color:"outline",size:"sm",text:y.entries.Lcz_CheckOut})),e("div",{key:"e28d54b0eda5de6f123f5548763b0a451bb70fc1",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("p",{key:"26a70ae00b6de79d441f59d4d40ca0580f24c3d4",class:"m-0 p-0"},`${this.mainGuest.first_name||""} ${this.mainGuest.last_name||""}`),this.room.rateplan.selected_variation.adult_nbr>0&&(this.room.unit?e("ir-tooltip",{message:"View guests",class:"m-0 p-0",customSlot:true},e("ir-button",{class:"m-0 p-0",slot:"tooltip-trigger",btn_color:"link",renderContentAsHtml:true,onClickHandler:()=>this.showGuestModal(),size:"sm",btnStyle:{width:"fit-content",margin:"0",padding:"0",fontSize:"inherit",textAlign:"center",lineHeight:"1.2"},text:this.formatVariation(this.room.occupancy)})):e("span",{innerHTML:this.formatVariation(this.room.occupancy)})),r&&e("p",{key:"b0e359a12642fd7f5853143f65f23bb3faf14a8f",class:"m-0 p-0"},"(",r,")")),e("div",{key:"5ceb2a462c8f94871bf405d39c2b64ad7447fb95",class:"d-flex align-items-center",style:{marginTop:"0.5rem",marginBottom:"0.875rem",gap:"0.5rem"}},e("p",{key:"b22dd97fae33e4a0a114c6a38f416259fd8e552e",class:"m-0 p-0"},"Expected departure time:"),e("ir-select",{key:"e3b8a9efb074e4bfc00ee8b871aa442cc222926f",selectedValue:(s=this.room.departure_time)===null||s===void 0?void 0:s.code,showFirstOption:false,onSelectChange:t=>{this.updateDepartureTime(t.detail)},data:(n=this.departureTime)===null||n===void 0?void 0:n.map((t=>{var e,i;return{text:(i=t[`CODE_VALUE_${(e=this.language)===null||e===void 0?void 0:e.toUpperCase()}`])!==null&&i!==void 0?i:t[`CODE_VALUE_EN`],value:t.CODE_NAME}}))})),e("div",{key:"67f3e104e11f6aa5802dac66a8c5df3a625b3f31",class:"collapse",id:`roomCollapse-${(o=this.room.identifier)===null||o===void 0?void 0:o.split(" ").join("")}`},e("div",{key:"5eee505002ed850722e90c2b987a2e0d8eac23c3",class:"d-flex sm-mb-1 sm-mt-1"},e("div",{key:"df8b550431e3860d7cf1c0871d7596e36f2da3ac",class:" sm-padding-top"},e("p",{key:"f928e9a1ebe10f6800f07fe8801d9d2e00291604",class:"sm-padding-right",style:{fontWeight:"600"}},`${y.entries.Lcz_Breakdown}:`)),e("div",{key:"038eb7110996fe6ead1d0f8e92ce7315f06b2859",class:"flex-fill"},e("table",{key:"3ca56a16540ad12260317fb290f3a9fa1e1d77e1"},this.room.days.length>0&&this.room.days.map((t=>e("tr",null,e("td",{class:"pr-2 text-right"},v(t.date)),e("td",{class:"text-right"},_(this.currency,t.amount)),t.cost>0&&t.cost!==null&&e("td",{class:"pl-2 text-left night-cost"},_(this.currency,t.cost))))),e("tr",{key:"ad0e7c11bd4626df32921c7f16f4615640c0f4a6",class:""},e("th",{key:"41d64266e277944d569f2a3d1a7fe7b99ee38b6d",class:"text-right pr-2 subtotal_row"},y.entries.Lcz_SubTotal),e("th",{key:"41becc9b2b37df0bac1e46d34cbb704be0880702",class:"text-right subtotal_row"},_(this.currency,this.room.total)),this.room.gross_cost>0&&this.room.gross_cost!==null&&e("th",{key:"ec8dd59bc958e267c45020b5fc8097e65830d347",class:"pl-2 text-right night-cost"},_(this.currency,this.room.cost))),this.booking.is_direct?e(a,null,(()=>{const t=x.taxes.filter((t=>t.pct>0));return t.map((t=>e("tr",null,e("td",{class:"text-right pr-2"},t.is_exlusive?y.entries.Lcz_Excluding:y.entries.Lcz_Including," ",t.name," (",t.pct,"%)"),e("td",{class:"text-right"},_(this.currency,this.room.total*t.pct/100)),this.room.gross_cost>0&&this.room.gross_cost!==null&&e("td",{class:"pl-2 text-right night-cost"},_(this.currency,this.room.cost*t.pct/100)))))})()):e(a,null,(()=>{const t=this.room.ota_taxes.filter((t=>t.amount>0));return t.map((t=>e("tr",null,e("td",{class:"text-right pr-2"},t.is_exlusive?y.entries.Lcz_Excluding:y.entries.Lcz_Including," ",t.name),e("td",{class:"text-right"},t.currency.symbol,t.amount))))})())))),e("ir-label",{key:"68a195f20ddfa67ecfe194a571488cacf080c1d0",labelText:`${y.entries.Lcz_SmokingOptions}:`,display:"inline",content:this.getSmokingLabel()}),this.booking.is_direct&&e(a,{key:"9f1b6e9ecb659743115a40e00b350fd71b19abd1"},this.room.rateplan.cancelation&&e("ir-label",{key:"426a9254fe8dc59d3606108fd0db7a16b804e339",labelText:`${y.entries.Lcz_Cancellation}:`,display:"inline",content:this.room.rateplan.cancelation||"",renderContentAsHtml:true}),this.room.rateplan.guarantee&&e("ir-label",{key:"3d37e3328c9c92c2bcb659dfc9cc4e02120ccd05",labelText:`${y.entries.Lcz_Guarantee}:`,display:"inline",content:this.room.rateplan.guarantee||"",renderContentAsHtml:true})),this.room.ota_meta&&e("div",{key:"14e0bdb2c76ac1099964a61b9a88973a279b330c"},e("ir-label",{key:"0392d6cba6672fff44fd025041667b1fa0a3b911",labelText:`${y.entries.Lcz_MealPlan}:`,display:"inline",content:this.room.ota_meta.meal_plan}),e("ir-label",{key:"c46bc1487fde07ec9a6614402b2f6b4197a2bd0b",labelText:`${y.entries.Lcz_Policies}:`,display:"inline",content:this.room.ota_meta.policies})))),e("ir-modal",{key:"3549891e6db8bf570606d856a661095b31e4a401",autoClose:false,ref:t=>this.modal=t,isLoading:this.isLoading,onConfirmModal:this.handleModalConfirmation.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:y.entries.Lcz_Cancel,rightBtnText:this.modalReason==="delete"?y.entries.Lcz_Delete:y.entries.Lcz_Confirm,leftBtnColor:"secondary",rightBtnColor:this.modalReason==="delete"?"danger":"primary",modalTitle:y.entries.Lcz_Confirmation,modalBody:this.renderModalMessage()}))}showGuestModal(){var t;const{adult_nbr:e,children_nbr:i,infant_nbr:s}=this.room.occupancy;this.openSidebar.emit({type:"room-guest",payload:{roomName:(t=this.room.unit)===null||t===void 0?void 0:t.name,sharing_persons:this.room.sharing_persons,totalGuests:e+i+s,checkin:this.hasCheckIn,identifier:this.room.identifier}})}get element(){return n(this)}static get watchers(){return{room:["handleRoomDataChange"]}}};Tu.style=Au;const Su={id:-1,full_name:"",country_id:null,dob:"",id_info:{type:{code:null,description:null},number:""},address:null,alternative_email:null,cci:null,city:null,country:undefined,country_phone_prefix:null,email:null,first_name:"",last_name:"",mobile:null,nbr_confirmed_bookings:0,notes:null,password:null,subscribe_to_news_letter:null};const Bu={mask:Date,pattern:"DD/MM/YYYY",lazy:false,min:new Date(1900,0,1),max:new Date,format:t=>D(t).format("DD/MM/YYYY"),parse:t=>D(t,"DD/MM/YYYY").toDate(),autofix:true,placeholderChar:"_",blocks:{YYYY:{mask:Kc,from:1970,to:(new Date).getFullYear(),placeholderChar:"Y"},MM:{mask:Kc,from:1,to:12,placeholderChar:"M"},DD:{mask:Kc,from:1,to:31,placeholderChar:"D"}}};const Iu=".sc-ir-room-guests-h{display:block;height:100%;position:relative;text-align:start !important}.id-select.sc-ir-room-guests{border-top-right-radius:0;border-bottom-right-radius:0;border-right-width:0}.sc-ir-room-guests-h{display:block;width:100%}.guest-grid.sc-ir-room-guests>*.sc-ir-room-guests{height:100%}.guests-labels.sc-ir-room-guests{display:none}.guest_label.sc-ir-room-guests{width:100px;color:#6b6f82}.sharing_persons_label.sc-ir-room-guests{display:none}.loading-container.sc-ir-room-guests{height:100%;width:100%;display:flex;justify-content:center;align-items:center;margin:0;padding:0}.guest_document.sc-ir-room-guests input.sc-ir-room-guests{border-top-left-radius:0;border-bottom-left-radius:0}.guests-labels.sc-ir-room-guests *.sc-ir-room-guests,.sharing_persons_label.sc-ir-room-guests{margin-bottom:0.5rem;padding-bottom:0}@media (min-width: 768px){.sharing_persons_label.sc-ir-room-guests{display:block}.guest_country_picker.sc-ir-room-guests{margin-bottom:3px}.guest-grid.sc-ir-room-guests{display:grid;grid-template-columns:2fr 2fr 2fr 2fr 5fr;gap:0.5rem;align-items:flex-start}.guest_label.sc-ir-room-guests,.sharing_persons_heading.sc-ir-room-guests,.main_guest_heading.sc-ir-room-guests{display:none}}";const ju=Iu;const zu=".sc-ir-room-guests-h{height:100%}.sheet-container.sc-ir-room-guests{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-room-guests{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-room-guests{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-room-guests{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-room-guests{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-room-guests{flex-direction:row;align-items:center}}";const Nu=zu;const Ru=class{constructor(e){t(this,e);this.closeModal=s(this,"closeModal",7);this.resetBookingEvt=s(this,"resetBookingEvt",7);this.updateRoomGuests=s(this,"updateRoomGuests",7);this.sharedPersons=[];this.totalGuests=0;this.language="en";this.guests=[];this.idTypes=[];this.error={};this.autoValidate=false;this.bookingService=new l}componentWillLoad(){this.init();this.initializeGuests()}async init(){try{this.isLoading=true;const[t,e]=await Promise.all([this.bookingService.getUserDefaultCountry(),this.bookingService.getSetupEntriesByTableName("_ID_TYPE")]);this.idTypes=e;if(t){this.propertyCountry=this.countries.find((e=>e.id===t.COUNTRY_ID))}}catch(t){console.error(t)}finally{this.isLoading=false}}initializeGuests(){var t,e;let i=[];if(this.totalGuests>this.sharedPersons.length){const s=this.totalGuests-this.sharedPersons.length;i=[...this.sharedPersons,...Array(s).fill(Object.assign(Object.assign({},Su),{id_info:Object.assign(Object.assign({},Su.id_info),{type:{code:((t=this.idTypes[0])===null||t===void 0?void 0:t.CODE_NAME)||"001",description:((e=this.idTypes[0])===null||e===void 0?void 0:e.CODE_VALUE_EN)||""},number:""})}))]}else{i=[...this.sharedPersons]}i=i.map((t=>Object.assign(Object.assign({},t),{dob:new Date(t.dob).getFullYear()===1900?null:t.dob})));this.guests=i.map((t=>Object.assign(Object.assign({},t),{dob:t.dob?D(new Date(t.dob)).format("DD/MM/YYYY"):"",country_id:t.country?t.country.id:null})))}updateGuestInfo(t,e){const i=[...this.guests];let s=i[t];s=Object.assign(Object.assign({},s),e);i[t]=s;this.guests=[...i]}async saveGuests(){try{this.error={};this.autoValidate=true;for(const t of this.guests){Jr(t)}await this.bookingService.handleExposedRoomGuests({booking_nbr:this.bookingNumber,identifier:this.identifier,guests:this.guests.map((t=>{if(!t.first_name&&t.id===-1){return null}return Object.assign(Object.assign({},t),{dob:t.dob?D(t.dob,"DD/MM/YYYY").format("YYYY-MM-DD"):null})})).filter(Boolean)});if(this.checkIn){await this.bookingService.handleExposedRoomInOut({booking_nbr:this.bookingNumber,room_identifier:this.identifier,status:"001"})}this.closeModal.emit(null);this.updateRoomGuests.emit({identifier:this.identifier,guests:this.guests});this.resetBookingEvt.emit()}catch(t){console.log(t);if(t instanceof R){let e={};t.issues.forEach((t=>{e[t.path[t.path.length-1]]=true}));this.error=Object.assign({},e)}}}render(){if(this.isLoading){return e("div",{class:"loading-container"},e("ir-spinner",null))}return e("form",{class:"sheet-container",style:{minWidth:"300px"},onSubmit:t=>{t.preventDefault();this.saveGuests()}},e("ir-title",{class:"px-1 sheet-header",onCloseSideBar:()=>this.closeModal.emit(null),label:`Room ${this.roomName}`,displayContext:"sidebar"}),e("section",{class:"sheet-body px-1"},e("div",{class:""},e("div",{class:"guest-grid guests-labels"},e("p",{class:""},y.entries.Lcz_MainGuest),e("p",{class:""}),e("p",{class:" "},y.entries.Lcz_DOB),e("p",{class:""},y.entries.Lcz_Nationality),e("p",{class:" "},y.entries.Lcz_Documents)),e("h5",{class:"main_guest_heading"},y.entries.Lcz_MainGuest),this.guests.map(((t,i)=>{var s,n;let o=true;try{Jr(t)}catch(t){o=false}console.log(`row ${i}=>${o}`);return e(a,null,i===1&&e("div",{class:"d-flex mx-0 px-0"},e("h5",{class:"mx-0 px-0 sharing_persons_heading"},y.entries.Lcz_PersonsSharingRoom),e("p",{class:"mx-0 px-0 sharing_persons_label"},y.entries.Lcz_PersonsSharingRoom)),e("div",{key:i,class:"guest-grid"},e("div",{class:"m-0 p-0 d-flex align-items-center h-100"},e("p",{class:"guest_label"},"First name"),e("ir-input-text",{class:"flex-grow-1 h-100",id:`first_name_${i}`,zod:Xr.pick({first_name:true}),error:!!this.error["first_name"]&&!o,autoValidate:this.autoValidate,wrapKey:"first_name",placeholder:"First name",onTextChange:t=>this.updateGuestInfo(i,{first_name:t.detail}),value:t.first_name,maxLength:40})),e("div",{class:"m-0 p-0 d-flex align-items-center h-100"},e("p",{class:"guest_label"},"Last name"),e("ir-input-text",{maxLength:40,class:"flex-grow-1 h-100",id:`last_name_${i}`,zod:Xr.pick({last_name:true}),error:!!this.error["last_name"]&&!o,autoValidate:this.autoValidate,wrapKey:"last_name",placeholder:"Last name",onTextChange:t=>this.updateGuestInfo(i,{last_name:t.detail}),value:t.last_name})),e("div",{class:"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center"},e("p",{class:"guest_label"},y.entries.Lcz_DOB),e("ir-input-text",{class:"flex-grow-1 h-100",id:`dob_${i}`,zod:Xr.pick({dob:true}),error:!!this.error["dob"]&&!o,autoValidate:this.autoValidate,wrapKey:"dob",mask:Bu,placeholder:"",onTextChange:t=>{this.updateGuestInfo(i,{dob:t.detail})},value:t.dob})),e("div",{class:" m-0 p-0 d-flex align-items-center"},e("p",{class:"guest_label"},y.entries.Lcz_Nationality),e("div",{class:"mx-0 flex-grow-1  h-100"},e("ir-country-picker",{class:"h-100",propertyCountry:this.propertyCountry,id:`{locales.entries.Lcz_Nationality}_${i}`,error:!!this.error["country_id"]&&!t.country_id,country:(s=this.countries)===null||s===void 0?void 0:s.find((e=>{var i,s,a;return((i=e.id)===null||i===void 0?void 0:i.toString())===((a=(s=t.country)===null||s===void 0?void 0:s.id)===null||a===void 0?void 0:a.toString())})),onCountryChange:t=>{var e,s,a;return this.updateGuestInfo(i,{country_id:(a=(s=(e=t.detail)===null||e===void 0?void 0:e.id)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:null,country:t.detail})},countries:this.countries}))),e("div",{class:"flex-grow-1 m-0 p-0 d-flex align-items-center"},e("p",{class:"guest_label"},y.entries.Lcz_Documents),e("div",{class:" d-flex m-0 flex-grow-1 h-100"},e("ir-select",{selectForcedStyles:{borderTopRightRadius:"0px",borderBottomRightRadius:"0px",borderRight:"0"},selectStyles:"rounded-top-0 rounded-bottom-0",onSelectChange:t=>{this.updateGuestInfo(i,{id_info:Object.assign(Object.assign({},this.guests[i].id_info),{type:{code:t.detail,description:""}})})},selectedValue:t.id_info.type.code,showFirstOption:false,data:(n=this.idTypes)===null||n===void 0?void 0:n.map((t=>{var e;return{text:(e=t[`CODE_VALUE_${this.language.toUpperCase()}`])!==null&&e!==void 0?e:t[`CODE_VALUE_EN`],value:t.CODE_NAME}}))}),e("ir-input-text",{autoValidate:this.autoValidate,maxLength:18,placeholder:"12345",class:"flex-grow-1 guest_document",type:"text",inputForcedStyle:{borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px"},value:t.id_info.number,zod:qr.pick({number:true}),error:!!this.error["number"]&&!o,wrapKey:"number",inputStyles:"form-control",onTextChange:t=>this.updateGuestInfo(i,{id_info:Object.assign(Object.assign({},this.guests[i].id_info),{number:t.detail})})})))))})))),e("div",{class:"sheet-footer"},e("ir-button",{onClick:()=>this.closeModal.emit(null),class:`flex-fill`,text:y.entries.Lcz_Cancel,btn_color:"secondary"}),e("ir-button",{btn_type:"submit",class:"flex-fill",isLoading:ut("/Handle_Exposed_Room_Guests"),text:this.checkIn?y.entries.Lcz_CheckIn:y.entries.Lcz_Save,btn_color:"primary"})))}};Ru.style=ju+Nu;const $u=".sc-ir-room-nights-h{display:block;box-sizing:border-box;margin:0;position:relative}.loading-container.sc-ir-room-nights{position:relative;height:100%;width:100%;display:flex;align-items:center;justify-content:center}.close-icon.sc-ir-room-nights{position:absolute;top:18px;right:33px;outline:none}.close.sc-ir-room-nights{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.card.sc-ir-room-nights{top:0;z-index:1000}.card-title.sc-ir-room-nights{border-bottom:1px solid #e4e5ec;width:100%}.irfontgreen.sc-ir-room-nights{color:#0e930e}.currency.sc-ir-room-nights{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-ir-room-nights{font-size:14px;line-height:0;padding:0;height:0;border-left:0;border-radius:0.25rem !important}.rate-input-container.sc-ir-room-nights{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-ir-room-nights{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-ir-room-nights span[data-state='focus'].sc-ir-room-nights{border-color:var(--blue)}.input-group-prepend.sc-ir-room-nights span[data-disabled].sc-ir-room-nights{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.rateInputBorder.sc-ir-room-nights{padding-left:5px !important;padding-right:5px !important;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}";const Fu=$u;const Lu=".sc-ir-room-nights-h{height:100%}.sheet-container.sc-ir-room-nights{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-room-nights{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-room-nights{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-room-nights{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-room-nights{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-room-nights{flex-direction:row;align-items:center}}";const Pu=Lu;const Hu=class{constructor(e){t(this,e);this.closeRoomNightsDialog=s(this,"closeRoomNightsDialog",7);this.rates=[];this.isLoading=false;this.initialLoading=false;this.inventory=null;this.isEndDateBeforeFromDate=false;this.defaultTotalNights=0;this.isInputFocused=-1;this.dates={from_date:new Date,to_date:new Date};this.bookingService=new l}componentWillLoad(){this.dates={from_date:new Date(this.fromDate),to_date:new Date(this.toDate)};this.init()}isButtonDisabled(){return this.isLoading||this.rates.some((t=>t.amount===-1))||this.inventory===0||this.inventory===null}async init(){var t;try{const{from_date:e}=this.defaultDates;if(D(e,"YYYY-MM-DD").isBefore(D(this.fromDate,"YYYY-MM-DD"))){this.dates.from_date=new Date(e)}else{this.dates.from_date=new Date(this.fromDate)}this.dates.to_date=new Date(this.toDate);this.bookingEvent=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);if(this.bookingEvent){const e=this.bookingEvent.rooms.filter((t=>t.identifier===this.identifier));this.selectedRoom=e[0];const i=(t=this.selectedRoom)===null||t===void 0?void 0:t.days[this.selectedRoom.days.length-1];if(D(this.toDate).add(-1,"days").isSame(D(i.date))){console.log("here1");const t=await this.fetchBookingAvailability(this.fromDate,this.selectedRoom.days[0].date,this.selectedRoom.rateplan.id);const e=ot(this.selectedRoom.days[0].date,this.fromDate);this.isEndDateBeforeFromDate=true;this.rates=[...e.map((i=>({amount:t/e.length,date:i,cost:null}))),...this.selectedRoom.days];this.defaultTotalNights=this.rates.length-this.selectedRoom.days.length}else{console.log("here2");console.log(i);const t=await this.fetchBookingAvailability(this.bookingEvent.to_date,D(this.toDate,"YYYY-MM-DD").format("YYYY-MM-DD"),this.selectedRoom.rateplan.id);const e=ot(i.date,this.toDate);this.rates=[...this.selectedRoom.days,...e.map((i=>({amount:t/e.length,date:i,cost:null})))]}}}catch(t){console.log(t)}}handleInput(t,e){let i=t;let s=[...this.rates];i=i.replace(/[^0-9.]/g,"");if(i===""){s[e].amount=-1}else{if(!isNaN(Number(i))){s[e].amount=Number(i)}}this.rates=s}async fetchBookingAvailability(t,e,i){var s;try{this.initialLoading=true;const a=await this.bookingService.getBookingAvailability({from_date:t,to_date:e,propertyid:this.propertyId,adultChildCount:{adult:this.selectedRoom.rateplan.selected_variation.adult_nbr,child:this.selectedRoom.rateplan.selected_variation.child_nbr},language:this.language,currency:this.bookingEvent.currency,room_type_ids:[this.selectedRoom.roomtype.id],rate_plan_ids:[i]});console.log(a[0],i);this.inventory=a[0].inventory;const n=a[0].rateplans.find((t=>t.id===i));if(!n||!n.variations){this.inventory=null;return null}const o=(s=n.variations)===null||s===void 0?void 0:s.find((t=>t.adult_nbr===this.selectedRoom.rateplan.selected_variation.adult_nbr&&t.child_nbr===this.selectedRoom.rateplan.selected_variation.child_nbr));if(!o){return null}return o.discounted_gross_amount}catch(t){console.error(t)}finally{this.initialLoading=false}}renderInputField(t,i,s){return e("div",{class:"col-3 ml-1 position-relative  m-0 p-0 rate-input-container"},e("ir-price-input",{value:s.amount>0?s.amount.toString():"",disabled:this.inventory===0||this.inventory===null,currency:i,"aria-label":"rate","aria-describedby":"rate cost",onTextChange:e=>this.handleInput(e.detail,t)}))}renderReadOnlyField(t,i){return e("p",{class:"col-9 ml-1 m-0 p-0"},`${t}${Number(i.amount).toFixed(2)}`)}renderRateFields(t,e,i){if(this.isEndDateBeforeFromDate){if(t<this.defaultTotalNights){return this.renderInputField(t,e,i)}else{return this.renderReadOnlyField(e,i)}}else{return t<this.selectedRoom.days.length?this.renderReadOnlyField(e,i):this.renderInputField(t,e,i)}}renderDates(){var t;const i=this.bookingEvent.currency.symbol;return e("div",{class:"mt-2 m-0"},(t=this.rates)===null||t===void 0?void 0:t.map(((t,s)=>e("div",{class:"row m-0 mt-1 align-items-center"},e("p",{class:"col-2 m-0 p-0"},rt(t.date)),this.renderRateFields(s,i,t)))))}async handleRoomConfirmation(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];let e=t.findIndex((t=>t.identifier===this.identifier));if(e===-1){throw new Error("Invalid Pool")}t[e]=Object.assign(Object.assign({},t[e]),{days:this.rates,to_date:D(this.dates.to_date).format("YYYY-MM-DD"),from_date:D(this.dates.from_date).format("YYYY-MM-DD")});const i={assign_units:true,check_in:true,is_pms:true,is_direct:true,pickup_info:this.bookingEvent.pickup_info,extra_services:this.bookingEvent.extra_services,booking:{booking_nbr:this.bookingNumber,from_date:D(this.dates.from_date).format("YYYY-MM-DD"),to_date:D(this.dates.to_date).format("YYYY-MM-DD"),remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};await this.bookingService.doReservation(i);this.closeRoomNightsDialog.emit({type:"confirm",pool:this.pool})}catch(t){}finally{this.isLoading=false}}render(){var t,i,s;if(!this.bookingEvent){return e("div",{class:"loading-container"},e("ir-loading-screen",null))}return e("div",{class:"sheet-container"},e("ir-title",{class:"p-1 sheet-header",onCloseSideBar:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool}),label:`${y.entries.Lcz_AddingRoomNightsTo} ${(i=(t=this.selectedRoom)===null||t===void 0?void 0:t.roomtype)===null||i===void 0?void 0:i.name} ${((s=this.selectedRoom)===null||s===void 0?void 0:s.unit).name}`,displayContext:"sidebar"}),e("section",{class:"text-left px-1 pt-0 sheet-body"},e("p",{class:"font-medium-1"},`${y.entries.Lcz_Booking}#`," ",this.bookingNumber),this.initialLoading?e("p",{class:"mt-2 text-secondary"},y.entries["Lcz_CheckingRoomAvailability "]):e(a,null,e("p",{class:"font-weight-bold font-medium-1"},`${lt(D(this.dates.from_date).format("YYYY-MM-DD"),"YYYY-MM-DD")} - ${lt(D(this.dates.to_date).format("YYYY-MM-DD"),"YYYY-MM-DD")}`),e("p",{class:"font-medium-1 mb-0"},`${this.selectedRoom.rateplan.name}`," ",this.selectedRoom.rateplan.is_non_refundable&&e("span",{class:"irfontgreen"},y.entries.Lcz_NonRefundable)),(this.inventory===0||this.inventory===null)&&e("p",{class:"font-medium-1 text danger"},y.entries.Lcz_NoAvailabilityForAdditionalNights),this.selectedRoom.rateplan.custom_text&&e("p",{class:"text-secondary mt-0"},this.selectedRoom.rateplan.custom_text),this.renderDates())),e("section",{class:"sheet-footer"},e("ir-button",{btn_color:"secondary",btn_disabled:this.isLoading,text:y===null||y===void 0?void 0:y.entries.Lcz_Cancel,class:"full-width",btn_styles:"justify-content-center",onClickHandler:()=>this.closeRoomNightsDialog.emit({type:"cancel",pool:this.pool})}),this.inventory>0&&this.inventory!==null&&e("ir-button",{isLoading:this.isLoading,text:y===null||y===void 0?void 0:y.entries.Lcz_Confirm,btn_disabled:this.isButtonDisabled(),class:"full-width",btn_styles:"justify-content-center",onClickHandler:this.handleRoomConfirmation.bind(this)})))}};Hu.style=Fu+Pu;const Uu=".sc-ir-sales-by-country-h{display:block}";const Vu=Uu;var Gu=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const Ku=class{constructor(e){t(this,e);this.language="";this.ticket="";this.isLoading=null;this.isPageLoading=true;this.countries=new Map;this.token=new pt;this.roomService=new bt;this.propertyService=new en;this.bookingService=new l;this.baseFilters={FROM_DATE:D().add(-7,"days").format("YYYY-MM-DD"),TO_DATE:D().format("YYYY-MM-DD"),BOOK_CASE:"001",WINDOW:7,include_previous_year:false}}componentWillLoad(){this.salesFilters=this.baseFilters;if(this.ticket){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}async initializeApp(){try{let t=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}if(!t){console.log(t);const e=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});t=e.My_Result.id}this.property_id=t;const e=[this.bookingService.getCountries(this.language),this.roomService.fetchLanguage(this.language),this.getCountrySales()];if(this.propertyid){e.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true}))}const[i]=await Promise.all(e);const s=new Map;i.map((t=>{s.set(t.id,{flag:t.flag,name:t.name})}));this.countries=s}catch(t){console.log(t)}finally{this.isPageLoading=false}}async getCountrySales(t=false){const e=t=>({country:t.COUNTRY,country_id:t.COUNTRY_ID,nights:t.NIGHTS,percentage:t.PCT,revenue:t.REVENUE,number_of_guests:t.Total_Guests});try{const i=this.salesFilters,{include_previous_year:s}=i,a=Gu(i,["include_previous_year"]);this.isLoading=t?"export":"filter";const n=await this.propertyService.getCountrySales(Object.assign({AC_ID:this.property_id,is_export_to_excel:t},a));const o=!t&&s;let r=[];if(o){const t=await this.propertyService.getCountrySales(Object.assign(Object.assign({AC_ID:this.property_id,is_export_to_excel:false},a),{FROM_DATE:D(a.FROM_DATE).subtract(1,"year").format("YYYY-MM-DD"),TO_DATE:D(a.TO_DATE).subtract(1,"year").format("YYYY-MM-DD")}));r=n.map((i=>{const s=t.find((t=>t.COUNTRY.toLowerCase()===i.COUNTRY.toLowerCase()));return Object.assign(Object.assign({id:ht()},e(i)),{last_year:s?e(s):null})}))}else{r=n.map((t=>Object.assign(Object.assign({id:ht()},e(t)),{last_year:null})))}this.salesData=[...r]}catch(t){console.error("Failed to fetch sales data:",t)}finally{this.isLoading=null}}render(){if(this.isPageLoading){return e("ir-loading-screen",null)}return e(i,null,e("ir-toast",null),e("ir-interceptor",null),e("section",{class:"p-2 d-flex flex-column",style:{gap:"1rem"}},e("div",{class:"d-flex align-items-center justify-content-between"},e("h3",{class:"mb-1 mb-md-0"},"Sales by Country"),e("ir-button",{size:"sm",btn_color:"outline",isLoading:this.isLoading==="export",text:y.entries.Lcz_Export,onClickHandler:async t=>{t.stopImmediatePropagation();t.stopPropagation();await this.getCountrySales(true)},btnStyle:{height:"100%"},iconPosition:"right",icon_name:"file",icon_style:{"--icon-size":"14px"}})),e("ir-sales-by-country-summary",{salesReports:this.salesData}),e("div",{class:"d-flex flex-column flex-lg-row mt-1 ",style:{gap:"1rem"}},e("ir-sales-filters",{isLoading:this.isLoading==="filter",onApplyFilters:t=>{t.stopImmediatePropagation();t.stopPropagation();this.salesFilters=t.detail;this.getCountrySales()},class:"filters-card",baseFilters:this.baseFilters}),e("ir-sales-table",{mappedCountries:this.countries,class:"card mb-0",records:this.salesData}))))}static get watchers(){return{ticket:["ticketChanged"]}}};Ku.style=Vu;const Wu=".sc-ir-sales-by-country-summary-h{display:block}.sales-by-country-summary__container.sc-ir-sales-by-country-summary{display:grid;grid-template-columns:repeat(1, 1fr);gap:0.5rem}@media (min-width: 640px){.sales-by-country-summary__container.sc-ir-sales-by-country-summary{grid-template-columns:repeat(3, 1fr);gap:1rem}}";const qu=Wu;const Xu=class{constructor(e){t(this,e)}calculateTotalValues(t,e=false){var i;return(i=this.salesReports)===null||i===void 0?void 0:i.reduce(((i,s)=>{const a=e?s.last_year?s.last_year[t]:0:s[t];return i+a}),0)}getIcon(t,e){var i;if(((i=this.salesReports)===null||i===void 0?void 0:i.length)&&this.salesReports[0].last_year){return t>e?"arrow-trend-up":"arrow-trend-down"}return}render(){const t=this.calculateTotalValues("nights");const i=this.calculateTotalValues("number_of_guests");const s=this.calculateTotalValues("revenue");const a=this.calculateTotalValues("nights",true);const n=this.calculateTotalValues("number_of_guests",true);const o=this.calculateTotalValues("revenue",true);return e("div",{key:"bf68425162e7db4253ab7ab4a2ed54476b70024d",class:"sales-by-country-summary__container"},e("ir-stats-card",{key:"7ef11cfb5d30e3da4afddb16e5140e41464cb96b",cardTitle:"Total Room Nights",icon:this.getIcon(t,a),value:t.toString(),subtitle:a?`Last year ${a}`:undefined}),e("ir-stats-card",{key:"dc2890a99a154cc56dbe47bb24c967698e6fc33b",icon:this.getIcon(i,n),cardTitle:"Total Guests",value:i.toString(),subtitle:n?`Last year ${n}`:undefined}),e("ir-stats-card",{key:"cb45b37def8f7f2c5657d173f581b14ff03155b0",icon:this.getIcon(s,o),cardTitle:"Total Revenue",value:_(x.currency.symbol,s),subtitle:o?`Last year ${_(x.currency.symbol,o)}`:undefined}))}};Xu.style=qu;const Ju=".sc-ir-sales-filters-h{display:block;height:100%;flex:1 1 0%}@media (min-width: 768px){.collapse-btn.sc-ir-sales-filters{display:none}#salesFiltersCollapse.collapse.sc-ir-sales-filters:not(.show){display:block}}";const Qu=Ju;const Zu=class{constructor(e){t(this,e);this.applyFilters=s(this,"applyFilters",7);this.collapsed=false}componentWillLoad(){this.filters=this.baseFilters;this.window=this.baseFilters.WINDOW.toString()}updateFilter(t){this.filters=Object.assign(Object.assign({},this.filters),t)}applyFiltersEvt(t){t.stopImmediatePropagation();t.stopPropagation();this.applyFilters.emit(this.filters)}resetFilters(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=this.baseFilters;this.applyFilters.emit(this.filters)}render(){var t,i;return e("div",{key:"1a59a81f8c3971277e0e476cc03a4014b9a080dd",class:"card mb-0 p-1 d-flex flex-column sales-filters-card"},e("div",{key:"f0ae8212b89b3f7d35257933130a8027fe271636",class:"d-flex align-items-center justify-content-between sales-filters-header"},e("div",{key:"f28a5f3078ee5cf0b77643f1f9d99bd64e809ba7",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"30a38a568f4ba987b6130c94b677dce2549d7e8e",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"bdde2d34880f44a3cda7c7701d63d05fe2fbb55a",fill:"currentColor",d:"M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"})),e("h4",{key:"98e09e54aacb7c6ee744f1631ede3a6dd572ac47",class:"m-0 p-0 flex-grow-1"},y.entries.Lcz_Filters)),e("ir-button",{key:"cc6ef207b695739a6122e57b018cd38c534cc374",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":"#salesFiltersCollapse","aria-expanded":this.collapsed?"true":"false","aria-controls":"salesFiltersCollapse",class:"mr-1 collapse-btn toggle-collapse-btn",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}})),e("div",{key:"ef01583bdc200f439026b5a2ae778987ad5f6f2a",class:"m-0 p-0 collapse filters-section",id:"salesFiltersCollapse"},e("div",{key:"e0cb4c1d8f2a02afc517914f4837800b0470f179",class:"d-flex flex-column",style:{gap:"0.5rem"}},e("fieldset",{key:"9e73e7f46ab3dedbeaa1b620defc06cd54d2ee1b",class:"pt-1 filter-group"},e("label",{key:"3ae18404c397020cd2ae1b2877f7d5341efd854a",htmlFor:"rooms",class:"m-0 px-0",style:{paddingBottom:"0.25rem"}},"Rooms"),e("ir-select",{key:"3320f6a0b7b4a26f7abca7b086cd5e6f6c413f29",selectedValue:(t=this.filters)===null||t===void 0?void 0:t.BOOK_CASE,selectId:"rooms",showFirstOption:false,onSelectChange:t=>this.updateFilter({BOOK_CASE:t.detail}),data:[{text:"Booked",value:"001"},{text:"Stayed",value:"002"}]})),e("fieldset",{key:"4a65e8b9b12926299666f998164d53ac49eb8279",class:"pt-1 filter-group"},e("label",{key:"a79734229534973dc59c54f331518403569f4ddc",htmlFor:"period",class:"px-0 m-0",style:{paddingBottom:"0.25rem"}},"Selected period"),e("div",{key:"25ffc2cb594aed5207fc12cf4c01804e420c557d",class:"d-flex flex-column date-filter-group",style:{gap:"0.5rem"}},e("ir-select",{key:"e51e85575d28723657c3c357e60779fbb2ce24f2",selectedValue:this.window,onSelectChange:t=>{const e=Number(t.detail);const i=D();this.updateFilter({WINDOW:e,TO_DATE:i.format("YYYY-MM-DD"),FROM_DATE:i.add(-e,"days").format("YYYY-MM-DD")});this.window=t.detail},selectId:"period",firstOption:"...",data:[{text:"For the past 7 days",value:"7"},{text:"For the past 14 days",value:"14"},{text:"For the past 30 days",value:"30"},{text:"For the past 60 days",value:"60"},{text:"For the past 90 days",value:"90"},{text:"For the past 365 days",value:"365"}]}),e("p",{key:"73a8be0b5cec111f7eee5f7ca4e3ae22d5216c6e",class:"m-0 p-0 text-center"},"Or"),e("ir-range-picker",{key:"a143ee3c8d7d6299ab7527fc2207a3027b1a6d65",onDateRangeChanged:t=>{t.stopImmediatePropagation();t.stopPropagation();const{fromDate:e,toDate:i,wasFocused:s}=t.detail;this.updateFilter({FROM_DATE:e.format("YYYY-MM-DD"),TO_DATE:i.format("YYYY-MM-DD")});if(s)this.window=""},fromDate:D(this.filters.FROM_DATE,"YYYY-MM-DD"),toDate:D(this.filters.TO_DATE,"YYYY-MM-DD"),maxDate:D().format("YYYY-MM-DD"),withOverlay:false}))),e("div",{key:"ddc7a435720de164c44490946a6e26c5dd9b40e7",class:"d-flex align-items-center mt-1 mb-2 compare-year-toggle",style:{gap:"0.5rem"}},e("label",{key:"3577d93ec26d60c24ff370b7f6d602491617f54d",htmlFor:"compare-prev-year",style:{paddingBottom:"0.25rem"}},"Compare with previous year"),e("ir-checkbox",{key:"cf8411442feefc67d30f65fb5278db7ea0593e8f",checked:(i=this.filters)===null||i===void 0?void 0:i.include_previous_year,checkboxId:"compare-prev-year",onCheckChange:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateFilter({include_previous_year:t.detail})}})),e("div",{key:"f533010c1b21e93003bd204254d4daae47d2ff74",class:"d-flex align-items-center justify-content-end filter-actions",style:{gap:"1rem"}},e("ir-button",{key:"ee7131052333426b760e45d3097deca46bc840eb",btn_type:"button","data-testid":"reset",text:y.entries.Lcz_Reset,size:"sm",btn_color:"secondary",onClickHandler:t=>this.resetFilters(t)}),e("ir-button",{key:"9abccd90a2d33c8b33440305540f0ca151ddfeef",btn_type:"button","data-testid":"apply",isLoading:this.isLoading,text:y.entries.Lcz_Apply,size:"sm",onClickHandler:t=>this.applyFiltersEvt(t)})))))}};Zu.style=Qu;const tf=".sc-ir-sales-table-h{display:block;width:100%}.legend.sc-ir-sales-table{height:12px;aspect-ratio:1;background:#000;border-radius:4px}.secondary.sc-ir-sales-table{background:#6692b3}.channel-cell.sc-ir-sales-table{width:100%}.task-row.sc-ir-sales-table,.table.sc-ir-sales-table th.sc-ir-sales-table,.table.sc-ir-sales-table td.sc-ir-sales-table{white-space:nowrap;max-width:max-content !important;padding:0.25rem 1rem !important}.outer-container.sc-ir-sales-table{padding:1rem;box-sizing:border-box}.table.sc-ir-sales-table tfoot.sc-ir-sales-table td.sc-ir-sales-table{border-bottom:0}.flag.sc-ir-sales-table{height:16px;width:23px;border-radius:3px}";const ef=tf;const sf=".ir-table-row.sc-ir-sales-table td.sc-ir-sales-table{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:white;white-space:nowrap}.table.sc-ir-sales-table td.sc-ir-sales-table{border-top:0;border-bottom:1px solid #e3ebf3;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-sales-table thead.sc-ir-sales-table th.sc-ir-sales-table{border:none !important;background:#ececec;color:#374151;padding:0.5rem 1rem !important;text-align:left}.selected.sc-ir-sales-table td.sc-ir-sales-table{background:#e3f3fa !important}.selected.sc-ir-sales-table td.sc-ir-sales-table{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-sales-table,.ir-table-row.sc-ir-sales-table{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-sales-table{text-transform:capitalize}.sortable.sc-ir-sales-table:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-sales-table:hover td.sc-ir-sales-table{background:#e2e6ea3f !important}.sortable.sc-ir-sales-table:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-sales-table svg.sc-ir-sales-table{color:var(--blue)}";const af=sf;const nf=class{constructor(e){t(this,e);this.records=[];this.visibleCount=10;this.handleLoadMore=()=>{this.visibleCount=Math.min(this.visibleCount+10,this.records.length)}}render(){const t=this.records.slice(0,this.visibleCount);return e("div",{key:"f47c5527fe81c24a9db94823944d82234826f246",class:"table-container h-100 p-1 m-0 mb-2 table-responsive"},e("table",{key:"6e27bc0b77d54230740dbe0315270a9ca5db83b2",class:"table","data-testid":"hk_tasks_table"},e("thead",{key:"572aa32dcbfeefea5882fc8be5818cdba9a353ae",class:"table-header"},e("tr",{key:"05ffc24819f3be54c35a4bad368dc72af2f2894c"},e("th",{key:"dd739092f1951092829b003e22fd01c89753b062",class:"text-left"},"Country"),e("th",{key:"b5120f6ee0cd2d02621736676cfffd6339712670",class:"text-center"},"Room nights"),e("th",{key:"e4b3edb29f5b69f68b17797b1cca8d9a7bef9d7f",class:"text-center"},"No of guests"),e("th",{key:"1918051b304ffe30f947237b91da1d1f90f3294b",class:"text-right"},"Revenue"),e("th",{key:"0f26e24a88abeffee04cbb2c73c42f8f01c5715c",class:""}))),e("tbody",{key:"c1bcaad9d5b53d60cf57e609c5e3d127f8facc05"},this.records.length===0&&e("tr",{key:"b57c567b9ee33d63ba619c8935ccbacb33feec74"},e("td",{key:"5ca639a879b52a841e2d9730302afc3802cfc59e",colSpan:5,style:{height:"300px"}},"No data found.")),t.map((t=>{var i,s,a,n,o,r,l,c;const d=`${parseFloat(t.percentage.toString()).toFixed(2)}%`;const h=t.last_year?`${parseFloat(t.last_year.percentage.toString()).toFixed(2)}%`:null;const u=this.mappedCountries.get(t.country_id);return e("tr",{"data-testid":`record_row`,class:{"task-table-row ir-table-row":true},key:t.id},e("td",{class:"text-left"},e("div",{class:"d-flex align-items-center",style:{gap:"0.5rem"}},(u===null||u===void 0?void 0:u.flag)&&e("img",{class:"flag",alt:u.name,src:u.flag}),e("span",null,(i=u===null||u===void 0?void 0:u.name)!==null&&i!==void 0?i:t.country))),e("td",{class:"text-center"},e("div",{class:"d-flex flex-column",style:{gap:"0.25rem"}},e("p",{class:`p-0 m-0 ${((s=t.last_year)===null||s===void 0?void 0:s.nights)?"font-weight-bold":""}`},t.nights),((a=t.last_year)===null||a===void 0?void 0:a.nights)&&e("p",{class:"p-0 mx-0",style:{marginTop:"0.25rem",marginBottom:"0"}},t.last_year.nights))),e("td",{class:"text-center"},e("div",{class:"d-flex flex-column",style:{gap:"0.25rem"}},e("p",{class:`p-0 m-0 ${((n=t.last_year)===null||n===void 0?void 0:n.number_of_guests)?"font-weight-bold":""}`},t.number_of_guests),((o=t.last_year)===null||o===void 0?void 0:o.number_of_guests)&&e("p",{class:"p-0 mx-0",style:{marginTop:"0.25rem",marginBottom:"0"}},t.last_year.number_of_guests))),e("td",{class:"text-right"},e("div",{class:"d-flex flex-column",style:{gap:"0.25rem"}},e("p",{class:`p-0 m-0 ${((r=t.last_year)===null||r===void 0?void 0:r.revenue)?"font-weight-bold":""}`},_(x.currency.symbol,t.revenue)),((l=t.last_year)===null||l===void 0?void 0:l.revenue)&&e("p",{class:"p-0 mx-0",style:{marginTop:"0.25rem",marginBottom:"0"}},_(x.currency.symbol,t.last_year.revenue)))),e("td",null,e("div",{class:"d-flex flex-column",style:{gap:"0.5rem"}},e("ir-progress-indicator",{percentage:d}),((c=t.last_year)===null||c===void 0?void 0:c.percentage)&&e("ir-progress-indicator",{percentage:h,color:"secondary"}))))}))),e("tfoot",{key:"b19faeed83e070063c99938981049a7d4c79d744"},e("tr",{key:"dfcca631bce468f36abe522f5b9b7b8f9d25d070",style:{fontSize:"12px"}},e("td",{key:"b72ec0b5f49d4304afb542ca47db8ed3c2c7f86d",colSpan:4}),e("td",{key:"686a0ce185e9073d5f3e14191128fa6639c77891",style:{width:"250px"}},e("div",{key:"21951c59adf50f49b40bda01620756e49b351451",class:"d-flex align-items-center justify-content-end",style:{gap:"1rem",paddingTop:"0.5rem"}},e("div",{key:"907468f402ca54c7adefac3167ba8ebf60a6ba12",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("div",{key:"b25e1b49eafa140eea7d433211401cd2815a87e5",class:"legend bg-primary"}),e("p",{key:"74961ac6e51ec35e77dd3ce31e9c857910ead4cd",class:"p-0 m-0"},"Selected period ")),e("div",{key:"4f3d8586039d92c8c3b003a7d8b79aeefc7c94c3",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("div",{key:"6812d6f7319dccb090efd215b27acd9acc8b2caf",class:"legend secondary"}),e("p",{key:"e5ab4aac4f350686d4d24359095c2a5985c9f31f",class:"p-0 m-0"},"Previous year"))))))),this.visibleCount<this.records.length&&e("div",{key:"09678353d70119fe3a73a42896e58d50e64d47f7",class:"d-flex mx-auto"},e("ir-button",{key:"3d7b5c41ed5b2bf8f8e9958321764eed8331150b",class:"mx-auto",size:"sm",text:"Load More",onClickHandler:this.handleLoadMore})))}};nf.style=ef+af;const of=":host{display:block;height:100%}.nav{background:white;padding:0.25rem 0}.nav-tabs{border-bottom:0}.nav-link{color:inherit}.active{color:var(--blue)}";const rf=of;const lf=class{constructor(e){t(this,e);this.isAuthenticated=false;this.token=new pt;this.dates={};this.routes=[{name:"Housekeepers",value:"hk"},{name:"Tasks",value:"tasks"},{name:"Front",value:"front"},{name:"Users",value:"users"},{name:"Sales By Country",value:"country-sales"},{name:"Daily Occupancy",value:"daily-occupancy"},{name:"Daily Revenue",value:"daily-revenue"},{name:"Email logs",value:"email-logs"},{name:"Booking Listing",value:"booking-listing"}]}componentWillLoad(){const t=ct();this.generateDates();if(this.ticket){this.isAuthenticated=true;this.token.setToken(this.ticket);this.propertyid=this.propertyid}if(t){this.isAuthenticated=true;this.token.setToken(t.token)}this.inputValue=this.p}handlePChange(){this.inputValue=this.p}handleTicketChange(t,e){if(t!==e){this.isAuthenticated=true;this.token.setToken(this.ticket);this.propertyid=this.propertyid}}generateDates(){var t=new Date;t.setDate(t.getDate()-1);var e=t.toISOString().substring(0,10);t.setDate(t.getDate()+60);var i=t.toISOString().substring(0,10);this.dates={from_date:e,to_date:i}}handleAuthFinish(t){const e=t.detail.token;this.token.setToken(e);this.isAuthenticated=true;dt({login:{method:"direct",isLoggedIn:true,token:e}})}render(){if(!this.isAuthenticated)return e(i,null,e("ir-login",{onAuthFinish:this.handleAuthFinish.bind(this)}));return e(i,null,e("div",{class:"px-1 nav flex-column flex-sm-row d-flex align-items-center justify-content-between"},e("div",{class:"d-flex  align-items-center"},e("div",{class:"d-flex align-items-center p-0 m-0",style:{gap:"0.5rem"}},e("h4",{class:"m-0 p-0"},"AName: "),e("form",{class:"input-group",onSubmit:t=>{t.preventDefault();if(this.inputValue){const t=new URL(window.location.href);t.searchParams.set("aname",this.inputValue);window.history.pushState({},"",t)}this.logout()}},e("input",{type:"text",value:this.inputValue,onInput:t=>this.inputValue=t.target.value,style:{maxWidth:"60px"},class:"form-control",placeholder:"AName","aria-label":"AName","aria-describedby":"button-save"}),e("div",{class:"input-group-append"},e("button",{class:"btn btn-sm btn-outline-secondary",type:"submit",id:"button-save"},"save")))),e("ul",{class:"nav  m-0 p-0"},this.routes.map((t=>e("li",{key:t.name,class:" nav-item"},e("a",{class:{"nav-link":true,active:this.currentPage===t.value},href:"#",onClick:()=>{this.currentPage=t.value}},t.name)))))),e("button",{class:"btn btn-sm btn-primary",onClick:()=>{this.logout()}},"Logout")),this.renderPage())}logout(){sessionStorage.removeItem("backend_anchor");window.location.reload()}renderPage(){switch(this.currentPage){case"tasks":return e("ir-hk-tasks",{p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"front":return e("igloo-calendar",{currencyName:"USD",propertyid:this.propertyid,p:this.p,ticket:this.token.getToken(),from_date:this.dates.from_date,to_date:this.dates.to_date,language:"en"});case"hk":return e("ir-housekeeping",{p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"users":return e("ir-user-management",{userTypeCode:5,p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"country-sales":return e("ir-sales-by-country",{p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"daily-occupancy":return e("ir-monthly-bookings-report",{p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"daily-revenue":return e("ir-daily-revenue",{p:this.p,propertyid:this.propertyid,language:"en",ticket:this.token.getToken()});case"email-logs":return e("ir-booking-email-logs",{ticket:this.token.getToken()});case"booking-listing":return e("ir-booking-listing",{p:this.p,language:"en",propertyid:this.propertyid,ticket:this.token.getToken()});default:return null}}static get watchers(){return{p:["handlePChange"],ticket:["handleTicketChange"]}}};lf.style=rf;const cf=".border-theme.sc-ir-select{border:1px solid #cacfe7}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}.bounce-3.sc-ir-select{animation:bounce 1s 1}.sc-ir-select-h{--ir-floating-label-fg:#6c757d;--ir-floating-label-fg-focus:#495057;--ir-floating-label-bg:#fff;--ir-floating-label-scale:0.88;--ir-floating-label-float-translateY:-70%;--ir-floating-label-resting-offset-inline:0.9rem;--ir-floating-select-radius:0.21rem;--ir-floating-select-height:2rem;--ir-danger:#dc3545;--ir-disabled-fg:#9aa0a6}.floating-select.sc-ir-select{height:var(--ir-floating-select-height);border-radius:var(--ir-floating-select-radius) !important}.sc-ir-select-h .ir-floating-group.sc-ir-select,.sc-ir-select-h .ir-select-wrapper.sc-ir-select{position:relative}.sc-ir-select-h .ir-floating-group.has-floating.sc-ir-select,.sc-ir-select-h .ir-select-wrapper.has-floating.sc-ir-select{padding-top:0.9rem}.sc-ir-select-h .ir-floating-label.sc-ir-select,.sc-ir-select-h .floating-label.sc-ir-select{position:absolute;top:0;transform:translateY(-50%);pointer-events:none;padding:0 0.4rem;z-index:10;color:var(--ir-floating-label-fg);background:white;transition:transform 120ms ease, color 120ms ease, top 120ms ease, background-color 120ms ease, opacity 120ms ease;opacity:0.95;line-height:1;white-space:nowrap}.sc-ir-select-h .ir-floating-label.sc-ir-select:dir(rtl),.sc-ir-select-h .floating-label.sc-ir-select:dir(rtl){right:var(--ir-floating-label-resting-offset-inline)}.sc-ir-select-h .ir-floating-label.sc-ir-select:dir(ltr),.sc-ir-select-h .floating-label.sc-ir-select:dir(ltr){left:var(--ir-floating-label-resting-offset-inline)}.sc-ir-select-h .ir-floating-group.sc-ir-select:focus-within .ir-floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-input.sc-ir-select:not(:placeholder-shown)+.ir-floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-group[data-has-value='true'].sc-ir-select .ir-floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-group.sc-ir-select:focus-within .floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-input.sc-ir-select:not(:placeholder-shown)+.floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-group[data-has-value='true'].sc-ir-select .floating-label.sc-ir-select,.sc-ir-select-h .floating-label.active.sc-ir-select{top:0;transform:translateY(var(--ir-floating-label-float-translateY)) scale(var(--ir-floating-label-scale));background:var(--ir-floating-label-bg);color:var(--ir-floating-label-fg-focus);font-size:12px;padding:0;opacity:0.95}.sc-ir-select-h .ir-floating-group.has-floating.sc-ir-select select.sc-ir-select,.sc-ir-select-h .ir-select-wrapper.has-floating.sc-ir-select select.sc-ir-select,.sc-ir-select-h .ir-floating-group.has-floating.sc-ir-select .ir-floating-input.sc-ir-select{padding-top:0.9rem}.sc-ir-select-h .ir-floating-group.has-error.sc-ir-select .ir-floating-label.sc-ir-select,.sc-ir-select-h .has-error.sc-ir-select .ir-floating-group.sc-ir-select .ir-floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-group.has-error.sc-ir-select .floating-label.sc-ir-select,.sc-ir-select-h .has-error.sc-ir-select .ir-floating-group.sc-ir-select .floating-label.sc-ir-select{color:var(--ir-danger)}.sc-ir-select-h .ir-floating-group.is-disabled.sc-ir-select .ir-floating-label.sc-ir-select,.sc-ir-select-h .ir-floating-group.is-disabled.sc-ir-select .floating-label.sc-ir-select{color:var(--ir-disabled-fg)}@supports (-webkit-touch-callout: none){.sc-ir-select-h .ir-floating-input.sc-ir-select{border-radius:var(--ir-floating-input-border-radius)}}";const df=cf;const hf=class{constructor(e){t(this,e);this.selectChange=s(this,"selectChange",7);this.selectedValue=null;this.firstOption="Select";this.showFirstOption=true;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.selectId=ht();this.error=false;this.initial=true;this.valid=false;this.labelId=`ir-select-label-${ht()}`;this.count=0}watchHandler(t){if(t!==null&&this.required){this.valid=true}}handleButtonAnimation(t){if(!this.selectEl||t.detail!==this.selectId){return}t.stopImmediatePropagation();t.stopPropagation();this.selectEl.classList.add("border-danger")}handleSelectChange(t){this.selectEl.classList.remove("border-danger");if(this.required){this.initial=false;this.valid=t.target.checkValidity();this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}else{this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}}render(){let t=["form-control"];if(this.floatingLabel){t.push("floating-select")}else{t.push(`col-${this.label?12-this.labelWidth:12}`)}if(this.required&&!this.valid&&!this.initial){t.push("border-danger")}let i=this.label?this.floatingLabel?e("label",{id:this.labelId,class:`floating-label active`,htmlFor:this.selectId},this.label,this.required?"*":""):e("div",{class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},e("label",{htmlFor:this.selectId,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":"")):null;return e("div",{key:"8fa172530b6cef6c04344239dd04e93d8dca65f9",class:`form-group m-0 ${this.selectContainerStyle}`},e("div",{key:"8bbf30bbef946e6ce6dc26407ab375810b82357a",class:"input-group row m-0"},i,e("select",{key:"00159c43ef2f9f8b490618dc9d0ee2960e47dd71",disabled:this.disabled,"aria-invalid":this.error?"true":"false","data-testid":this.testId,style:this.selectForcedStyles,ref:t=>this.selectEl=t,id:this.selectId,class:`${this.selectStyles} ${this.error?"border-danger":""} ${t.join(" ")} form-control-${this.size} text-${this.textSize} `,onInput:this.handleSelectChange.bind(this),required:this.required},this.showFirstOption&&e("option",{key:"5ebaddba183b6ca83f75b101963ce98b06becec4",value:""},this.firstOption),this.data.map((t=>e("option",{selected:this.selectedValue===t.value,value:t.value},t.text))))))}static get watchers(){return{selectedValue:["watchHandler"]}}};hf.style=df;const uf=".backdrop{position:fixed;top:0;left:0;width:100%;height:100vh;cursor:pointer;background:rgba(0, 0, 0, 0.5);z-index:99;transition:all 0.5s;opacity:0;pointer-events:none;transition:all 0.5s}.backdrop.active{opacity:1;pointer-events:all}.sidebar-right{position:fixed;top:0;right:-120%;bottom:0;width:var(--sidebar-width, 40rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:100;overflow-y:hidden;color:var(--sidebar-color, #000);background-color:var(--sidebar-backgound, #fff);padding-block:var(--ir-sidebar-padding-block, 0);padding-inline:var(--ir-sidebar-padding-inline, 0.5rem);padding-top:var(--ir-sidebar-padding-top, unset);padding-bottom:var(--ir-sidebar-padding-bottom, unset);padding-left:var(--ir-sidebar-padding-left, unset);padding-right:var(--ir-sidebar-padding-right, unset)}.sidebar-right.active{right:0;overflow-y:auto}.sidebar-left{position:fixed;top:0;left:-100%;bottom:0;width:var(--sidebar-width, 30rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:200;overflow-y:hidden;color:var(--sidebar-color, #000);background:var(--sidebar-backgound, #fff);padding-block:var(--ir-sidebar-padding-block, 0);padding-inline:var(--ir-sidebar-padding-inline, 0.5rem);padding-top:var(--ir-sidebar-padding-top, unset);padding-bottom:var(--ir-sidebar-padding-bottom, unset);padding-left:var(--ir-sidebar-padding-left, unset);padding-right:var(--ir-sidebar-padding-right, unset)}.sidebar-title{display:flex;align-items:center;justify-content:space-between;padding:0 1rem;border-bottom:1px solid #e4e5ec}.sidebar-title p{font-weight:500;font-size:1.2rem}.sidebar-left.active{left:0;overflow-y:scroll}.close{position:absolute;top:0.5rem;right:1rem;width:1rem;height:1rem;cursor:pointer}";const ff=uf;const pf=class{constructor(e){t(this,e);this.irSidebarToggle=s(this,"irSidebarToggle",7);this.beforeSidebarClose=s(this,"beforeSidebarClose",7);this.side="right";this.showCloseButton=true;this.open=false}componentDidLoad(){this.applyStyles()}handleSidebarStylesChange(){this.applyStyles()}handleOpenChange(t,e){if(t!==e){O(t)}}handleKeyDown(t){if(t.key==="Escape"&&this.open){t.stopImmediatePropagation();t.stopPropagation();return this.toggleSidebar()}else{return}}async toggleSidebar(){if(this.preventClose){this.beforeSidebarClose.emit();return}this.irSidebarToggle.emit(this.open)}applyStyles(){for(const t in this.sidebarStyles){if(this.sidebarStyles.hasOwnProperty(t)){this.sidebarRef.style[t]=this.sidebarStyles[t]}}}render(){let t="";if(this.open){t="active"}else{t=""}return[e("div",{key:"4a0ef12837eb34559f80d49dea0a058f971478a2",class:`backdrop ${t}`,onClick:()=>{this.toggleSidebar()}}),e("div",{key:"4d706f9226d9a4f68d8ddd3d42a1a1ec673b69da",ref:t=>this.sidebarRef=t,class:`sidebar-${this.side} ${t}`},this.showCloseButton&&e("div",{key:"3779c0d15db22c44d60f97eb97b9523d353ed8cb",class:"sidebar-title"},e("p",{key:"4a573d05753b6cf79319ddd17bc3203dfe8aa37d",class:"p-0 m-0"},this.label),e("div",{key:"8cbd20121d0dabae83703531d3ffef614d40cd2e",class:"p-0 m-0 sidebar-icon-container"},e("ir-icon",{key:"0974d32757600c6f72b073d676bddc71a2efb66e",class:"",onIconClickHandler:()=>{this.toggleSidebar()}},e("svg",{key:"e4fa47586ac76633cda046cd81f76fdec51b4ce7",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{key:"b9a6359d9f3745722c3337954e176b54fb635136",fill:"#6b6f82",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("slot",{key:"1e2f9010bb7d5c1b81b9b069896031ddd0809346",name:"sidebar-body"}))]}get el(){return n(this)}static get watchers(){return{sidebarStyles:["handleSidebarStylesChange"],open:["handleOpenChange"]}}};pf.style=ff;const bf=":host{width:var(--ir-spinner-size, 1.25rem);height:var(--ir-spinner-size, 1.25rem);border:var(--ir-spinner-border-width, 2.5px) solid var(--ir-spinner-color, #3f3f3f);border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const gf=bf;const mf=class{constructor(e){t(this,e);this.unit="rem"}componentWillLoad(){this.initStyles()}handleSpinnerSizeChange(){this.initStyles()}handleSpinnerBorderWidthChange(){this.initStyles()}handleSpinnerUnitChange(){this.initStyles()}handleSpinnerColorChange(){this.initStyles()}initStyles(){if(this.size){this.applyCssElement(`${this.size}${this.unit}`,"--ir-spinner-size")}if(this.borderWidth){this.applyCssElement(`${this.borderWidth}${this.unit}`,"--ir-spinner-size")}if(this.color){this.applyCssElement(`${this.color}`,"--ir-spinner-color")}}applyCssElement(t,e){this.el.style.setProperty(e,t)}render(){return e(i,{key:"23de9a530942d93b322d0b73ec80d96461dd46fc"})}get el(){return n(this)}static get watchers(){return{size:["handleSpinnerSizeChange"],borderWidth:["handleSpinnerBorderWidthChange"],unit:["handleSpinnerUnitChange"],color:["handleSpinnerColorChange"]}}};mf.style=gf;const vf=".sc-ir-stats-card-h{display:block}";const yf=vf;const kf=class{constructor(e){t(this,e)}render(){if(!this.value){return null}return e(i,{class:"card p-1 d-flex flex-column flex-fill m-0",style:{gap:"0.5rem"}},e("div",{class:"d-flex align-items-center justify-content-between"},e("slot",{slot:"card-header"},e("p",{class:"m-0 p-0"},e("slot",{name:"title"},this.cardTitle)),e("ir-icons",{name:this.icon}))),e("slot",{name:"card-body"},e("h4",{class:"m-0 p-0"},e("b",{class:"m-0 p-0"},e("slot",{name:"value"},this.value)))),e("slot",{name:"card-footer"},this.subtitle&&e("p",{class:"m-0 p-0 small text-muted"},e("slot",{name:"subtitle"},this.subtitle))))}};kf.style=yf;const wf=".sc-ir-switch-h{display:block;position:relative;box-sizing:border-box;--ir-root-width:36px;--ir-root-height:20px}.hidden-input.sc-ir-switch{transform:translateX(-100%);position:absolute;pointer-events:none;opacity:0;margin:0;width:var(--ir-root-width);height:var(--ir-root-height)}.SwitchRoot.sc-ir-switch{all:unset;padding:0;margin:0;width:var(--ir-root-width);height:var(--ir-root-height);background-color:var(--ir-root-inactive-color, #ff4961);position:relative;box-shadow:rgba(0, 0, 0, 0.2) 0px 2px 10px;--webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-radius:9999px;box-sizing:border-box}.SwitchRoot.sc-ir-switch:disabled{opacity:80%}.SwitchRoot.sc-ir-switch:focus-visible{outline:1px solid var(--ir-root-active-color, rgb(55, 188, 155));outline-offset:1px}.SwitchRoot[data-state='checked'].sc-ir-switch{background-color:var(--ir-root-active-color, rgb(55, 188, 155))}.SwitchThumb.sc-ir-switch{padding:0;margin:0;display:block;width:calc(var(--ir-root-height) - 3px);height:calc(var(--ir-root-height) - 3px);border-radius:9999px;background:white;box-shadow:rgba(0, 0, 0, 0.2) 0px;transition:transform 100ms ease 0s;transform:translateX(2px);will-change:transform}.SwitchThumb[data-state='checked'].sc-ir-switch{transform:translateX(calc(var(--ir-root-height) - 3px))}";const xf=wf;const _f=class{constructor(e){t(this,e);this.checkChange=s(this,"checkChange",7);this.checked=false;this.disabled=false;this._id=""}componentWillLoad(){this._id=this.generateRandomId(10)}componentDidLoad(){if(!this.switchRoot){return}this.switchRoot.setAttribute("aria-checked",this.checked?"true":"false")}generateRandomId(t){let e="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";const s=i.length;for(let a=0;a<t;a++){e+=i.charAt(Math.floor(Math.random()*s))}return e}handleCheckChange(){this.checked=!this.checked;this.switchRoot.setAttribute("aria-checked",this.checked?"true":"false");this.checkChange.emit(this.checked)}render(){return e(i,{key:"f3b1e118e7756bdcdf1143a40ab00350dc8ae31c"},e("button",{key:"64a712810dad18aa278f91b8f75006f9f4eb9a09",disabled:this.disabled,ref:t=>this.switchRoot=t,type:"button",id:this.switchId||this._id,onClick:this.handleCheckChange.bind(this),role:"switch","data-state":this.checked?"checked":"unchecked",value:"on",class:"SwitchRoot"},e("span",{key:"4bd105aca04c58ca99f81ae05675a805ce22785c",class:"SwitchThumb","data-state":this.checked?"checked":"unchecked"})),e("input",{key:"c016912e5412def86c69a8a5875e9dc9584567bc",type:"checkbox",checked:this.checked,"aria-hidden":"true",tabIndex:-1,value:"on",class:"hidden-input"}))}};_f.style=xf;const Df=".sc-ir-tabs-h{display:flex;align-items:center;position:relative;overflow-x:auto;gap:1rem;padding:0 1rem}.tab.sc-ir-tabs{font-size:0.95rem;font-weight:400;cursor:pointer;position:relative;margin:0;padding:0rem;padding-bottom:1rem;transition:color 0.3s ease;user-select:none;background-color:transparent;border:none;outline:none;flex:1 1 0%;text-align:center;white-space:nowrap}.tab[data-disabled].sc-ir-tabs{cursor:auto}.tab.sc-ir-tabs:hover{opacity:80%}.tab[data-state='selected'].sc-ir-tabs,.tab[data-state='selected'].sc-ir-tabs:hover{color:var(--blue, #1e9ff2);opacity:100%}.active-indicator.sc-ir-tabs{padding:0;bottom:0px;position:absolute;height:3px;border-radius:4px;transition:transform 0.3s ease, width 0.3s ease;background:var(--blue, #1e9ff2)}";const Cf=Df;const Of=class{constructor(e){t(this,e);this.tabChanged=s(this,"tabChanged",7);this.tabs=[];this.disabled=false;this.ariaLabel="Tabs";this.remSize=(()=>{const t=getComputedStyle(document.documentElement).fontSize;return parseFloat(t)})()}componentWillLoad(){var t,e;const i=(t=this.tabs)===null||t===void 0?void 0:t.find((t=>t.id===this.initialTab));if(i){this.selectTab(i)}else if(((e=this.tabs)===null||e===void 0?void 0:e.length)>0){this.selectTab(this.tabs[0])}}disconnectedCallback(){if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}}updateActiveIndicator(){if(this.animationFrameId){cancelAnimationFrame(this.animationFrameId)}requestAnimationFrame((()=>{const t=this.el.querySelector(`.tab[data-state="selected"]`);if(t){const{left:e,width:i}=t.getBoundingClientRect();const s=this.el.getBoundingClientRect().left;const a=e-s-this.remSize;this.activeIndicator.style.width=`${i-this.remSize}px`;this.activeIndicator.style.transform=`translateX(${a}px)`}}))}selectTab(t){if(this.disabled)return;this._selectedTab=t;this.updateActiveIndicator();this.tabChanged.emit(t)}handleKeyDown(t,e){if(this.disabled)return;const i=this.tabs.findIndex((t=>t.id===e.id));let s=i;switch(t.key){case"ArrowRight":t.preventDefault();s=(i+1)%this.tabs.length;break;case"ArrowLeft":t.preventDefault();s=i===0?this.tabs.length-1:i-1;break;case"Home":t.preventDefault();s=0;break;case"End":t.preventDefault();s=this.tabs.length-1;break;case"Enter":case" ":t.preventDefault();this.selectTab(e);return;default:return}const a=this.tabs[s];if(a){this.selectTab(a);requestAnimationFrame((()=>{const t=this.el.querySelector(`button.tab[data-tab-id="${a.id}"]`);if(t){t.focus()}}))}}render(){return e(i,{key:"d7b3df6ee6fa37b4929b853f8eb2f72595ac592f",role:"tablist","aria-label":this.ariaLabel,"aria-orientation":"horizontal"},this.tabs.map((t=>{var i,s,a;return e("button",{class:"tab",key:t.id,type:"button","data-tab-id":t.id,role:"tab",tabindex:((i=this._selectedTab)===null||i===void 0?void 0:i.id)===t.id?0:-1,"aria-selected":((s=this._selectedTab)===null||s===void 0?void 0:s.id)===t.id?"true":"false","aria-controls":`tabpanel-${t.id}`,id:`tab-${t.id}`,disabled:this.disabled,"data-state":((a=this._selectedTab)===null||a===void 0?void 0:a.id)===t.id?"selected":undefined,onClick:()=>this.selectTab(t),onKeyDown:e=>this.handleKeyDown(e,t)},t.label)})),e("span",{key:"c2e532e4c0905f409006be402d5082ed450412fb",class:"active-indicator",ref:t=>this.activeIndicator=t}))}get el(){return n(this)}};Of.style=Cf;const Mf="";const Ef=Mf;const Yf=class{constructor(e){t(this,e);this.cleanSelectedTask=s(this,"cleanSelectedTask",7);this.skipSelectedTask=s(this,"skipSelectedTask",7)}render(){const t="Mark as clean";const s=this.task.housekeeper?`${t} for ${this.task.housekeeper.slice(0,20)}`:t;const n=this.task.housekeeper?`Clean & Inspect for ${this.task.housekeeper.slice(0,20)}`:t;return e(i,{key:"65046d646332d7dc50c268d7abaa8e33af441db0",class:"card p-1 flex-fill m-0",style:{gap:"0.5rem"}},e("div",{key:"49efc9ff73706e6c377eeb864cd2368f8208d6e8",class:"d-flex align items-center p-0 m-0 justify-content-between",style:{gap:"0.5rem"}},e("div",{key:"f74fd1ee923a0cd9ec08bf56c39ef8c73d16c530",class:"d-flex align items-center p-0 m-0",style:{gap:"0.5rem"}},e("p",{key:"568a0205cd007671a305f195490346d3e4e65e26",class:"m-0 p-0"},this.task.formatted_date),e("span",{key:"1251a47e421f53f14a8d2062f46a6eac4f0299be"},"-"),e("p",{key:"78b7320f7674cddb576b8ccafd1464d3eb38b2ff",class:"m-0 p-0"},"Unit ",e("b",{key:"9347f63ca9ac373284f87f5d8a63814361517981"},this.task.unit.name)))),e("p",{key:"6830aebbf489c24e7e76e30cf80fd4f84fbf4a19",class:"m-0 p-0"},this.task.status.description," ",e("span",{key:"32f101c029c4f26991919d1c96a6847f63f107e3",style:{marginLeft:"0.5rem"}},this.task.hint)),e("p",{key:"ce97c3f7b0bc5ad0ffc885e411a91d34f898aabf",class:"m-0 p-0 d-flex align-items-center mb-1",style:{gap:"1rem"}},e("span",{key:"f2d08498fb83b5576c04e339fe61007a3ce409e8",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"81a6c7e0f11fba83c333b114806e70226dc1e18a",width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},e("path",{key:"ec68bb9c31b9b12f3fb70a21c29ec7edecf4e196",fill:"currentColor",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"})),e("span",{key:"01473c483d61e68561a61be0f550b7b133f2974b"},e("b",{key:"4b006af9e4c4e1af3db984b693ea6df670780547"},this.task.adult)," Adults")),e("span",{key:"2b7db9035c3f686f7365f11f52ad23088cdaddc7",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"6982f55b1743c84956abb7d9c25c58a7471ddbd9",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 320 512"},e("path",{key:"c26b741d1304921cf674a714cb08bbcd8d64111f",fill:"currentColor",d:"M96 64a64 64 0 1 1 128 0A64 64 0 1 1 96 64zm48 320l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-192.2L59.1 321c-9.4 15-29.2 19.4-44.1 10S-4.5 301.9 4.9 287l39.9-63.3C69.7 184 113.2 160 160 160s90.3 24 115.2 63.6L315.1 287c9.4 15 4.9 34.7-10 44.1s-34.7 4.9-44.1-10L240 287.8 240 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96-32 0z"})),e("span",{key:"c34eab29761fd1e2558dcd58faba9d6f8b775430"},e("b",{key:"5ccb33d296b4f165a233ddf843d553b50903b3d8"},this.task.child)," Children")),e("span",{key:"269e35671195d6e09612f0ababd46af4f4c4c681",class:"m-0 p-0 d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"6682f3366eedae59b5f535ef4669d549d6842103",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-baby-icon lucide-baby"},e("path",{key:"415a1a7839cb3d303c81b120bc7f2a087fe24d02",d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5"}),e("path",{key:"5852298caad90bfc16000892940d1f1207f4c747",d:"M15 12h.01"}),e("path",{key:"c1eb024e04bf2ced860110e630c407ae224f809d",d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1"}),e("path",{key:"ed63840d6b6b779c4fb764723db390a5cbe807da",d:"M9 12h.01"})),e("span",{key:"3de7d722a885eb94335114e4192ad64e0f2ccb82"},e("b",{key:"305259a94e2e30b9493a41ad32f45d3094f79055"},this.task.infant)," Infants"))),this.isCheckable&&e(a,{key:"dada9db7d0ab1bf2cfd0b2db1efc76b09f3f970a"},e("div",{key:"8310c0476a8b8aa81034cba65f143c8c9186ef5b"},e("ir-button",{key:"0af0b38583b1b7adbe30a44e06952ca7611580e2",onClickHandler:()=>{Il(this.task);this.cleanSelectedTask.emit({task:this.task,status:"001"})},size:"sm",text:s,labelStyle:{textAlign:"left !important"},btn_styles:"text-left"})),e("div",{key:"b05038d76b274abf1fb24c13f75fd8b575511824"},e("ir-button",{key:"1b90881e0619cd2cf5fc9f5ff691c30e8c6d3d27",onClickHandler:()=>{Il(this.task);this.cleanSelectedTask.emit({task:this.task,status:"004"})},size:"sm",text:n,labelStyle:{textAlign:"left !important"},btn_styles:"text-left"}))),this.isSkippable&&e("div",{key:"2e3a10d7b95f525144dba6e416fcff8998d9b3e0"},e("ir-button",{key:"23261e5f064f19374b6a1d4921dfbd1717ec8232",onClickHandler:()=>{this.skipSelectedTask.emit(this.task)},size:"sm",text:"Skip",labelStyle:{textAlign:"left !important"},btn_styles:"text-left"})))}};Yf.style=Ef;const Af=".sc-ir-tasks-filters-h{display:block;min-width:20vw;height:100%;flex:1}@media (min-width: 1024px){.collapse-btn.sc-ir-tasks-filters{display:none}#hkTasksFiltersCollapse.collapse.sc-ir-tasks-filters:not(.show){display:block}}";const Tf=Af;const Sf=class{constructor(e){t(this,e);this.applyFilters=s(this,"applyFilters",7);this.filters={cleaning_periods:{code:""},housekeepers:"000",cleaning_frequencies:{code:""},dusty_units:{code:""},highlight_check_ins:{code:""}};this.collapsed=false}componentWillLoad(){var t,e,i,s,a;this.baseFilters={cleaning_periods:(t=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||t===void 0?void 0:t.cleaning_periods[0],housekeepers:[],cleaning_frequencies:(e=x.cleaning_frequency)!==null&&e!==void 0?e:(i=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||i===void 0?void 0:i.cleaning_frequencies[0],dusty_units:(s=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||s===void 0?void 0:s.dusty_periods[0],highlight_check_ins:(a=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||a===void 0?void 0:a.highlight_checkin_options[0]};this.filters=Object.assign(Object.assign({},this.baseFilters),{housekeepers:"000"})}updateFilter(t){this.filters=Object.assign(Object.assign({},this.filters),t)}applyFiltersEvt(t){t.stopImmediatePropagation();t.stopPropagation();this.applyFilters.emit(Object.assign(Object.assign({},this.filters),{housekeepers:this.filters.housekeepers==="000"?this.baseFilters.housekeepers:[{id:Number(this.filters.housekeepers)}]}))}resetFilters(t){t.stopImmediatePropagation();t.stopPropagation();this.filters=Object.assign(Object.assign({},this.baseFilters),{housekeepers:"000"});this.applyFilters.emit(Object.assign(Object.assign({},this.filters),{housekeepers:this.filters.housekeepers==="000"?this.baseFilters.housekeepers:[{id:Number(this.filters.housekeepers)}]}))}render(){var t,i,s,a,n,o,r,l,c,d,h,u,f,p;return e("div",{key:"ff93a0eafd03078d0f2cabe06e0f31412e3cadf7",class:"card mb-0 p-1 d-flex flex-column"},e("div",{key:"353c67c729ca7ce6fce588f6c37d060aa7c76280",class:"d-flex align-items-center justify-content-between"},e("div",{key:"b11bedfb06b88e9f9bed55e93e16c47620d17646",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("svg",{key:"c930cedf099984007a2dedb9feaf63b513af0d93",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:18,width:18},e("path",{key:"7f97d92d93be6cacd434500ef17642bf54c61ec2",fill:"currentColor",d:"M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"})),e("h4",{key:"128a08182f0a2e653c7d42101b9dc2ec26c7c782",class:"m-0 p-0 flex-grow-1"},y.entries.Lcz_Filters)),e("ir-button",{key:"66a147e079914d1ab3a265ca0313fe7d28a8b205",variant:"icon",id:"drawer-icon","data-toggle":"collapse","data-target":"#hkTasksFiltersCollapse","aria-expanded":this.collapsed?"true":"false","aria-controls":"hkTasksFiltersCollapse",class:"mr-1 collapse-btn",icon_name:this.collapsed?"closed_eye":"open_eye",onClickHandler:()=>{this.collapsed=!this.collapsed},style:{"--icon-size":"1.6rem"}})),e("div",{key:"c3c047acc9603fe9aafc84b93cf684688140a41d",class:"m-0 p-0 collapse",id:"hkTasksFiltersCollapse"},e("div",{key:"455f56baa8b5757d59d292a77a58f178fa910cb1",class:"d-flex flex-column",style:{gap:"0.5rem"}},e("fieldset",{key:"2c15e67bc188503f01f3ce0cbd0a17fec21ca9b1",class:"pt-1"},e("p",{key:"2dc1cd736579494573eca3587185587c4010aadb",class:"m-0 pt-0 px-0",style:{paddingBottom:"0.25rem"}},y.entries.Lcz_Period),e("ir-select",{key:"ebb611f9c1c9b3410b89cb0c30d14dc780d336ab",testId:"period",selectedValue:(i=(t=this.filters)===null||t===void 0?void 0:t.cleaning_periods)===null||i===void 0?void 0:i.code,showFirstOption:false,data:(s=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||s===void 0?void 0:s.cleaning_periods.map((t=>({text:t.description,value:t.code}))),onSelectChange:t=>{this.updateFilter({cleaning_periods:{code:t.detail}})}})),((a=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||a===void 0?void 0:a.housekeepers.length)>1&&e("fieldset",{key:"95e667cfb90944eac5cbdbe374b1fb5730d3ce3d"},e("p",{key:"c5cbabb4210e01dd613470b54eafb4c3a22505aa",class:"m-0 pt-0 px-0",style:{paddingBottom:"0.25rem"}},y.entries.Lcz_Housekeepers),e("ir-select",{key:"3fe36811c2bda47cad4399e9d7d2f0648d843455",testId:"housekeepers",selectedValue:(n=this.filters)===null||n===void 0?void 0:n.housekeepers,showFirstOption:false,data:[{text:y.entries.Lcz_Allhousekeepers,value:"000"},...(o=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||o===void 0?void 0:o.housekeepers.map((t=>({text:t.name,value:t.id.toString()}))).sort(((t,e)=>t.text.toLowerCase().localeCompare(e.text.toLowerCase())))],onSelectChange:t=>{this.updateFilter({housekeepers:t.detail})}})),e("fieldset",{key:"473e8c536a024040cb65574d3eff8640aac60242"},e("p",{key:"f00df783a6382ab5cc8f2523b764423b6d5d7bf5",class:"m-0 pt-0 px-0",style:{paddingBottom:"0.25rem"}},"Include dusty units"),e("ir-select",{key:"df57d3edd868739521c3bad57daff652943eabd0",testId:"dusty_units",showFirstOption:false,selectedValue:(l=(r=this.filters)===null||r===void 0?void 0:r.dusty_units)===null||l===void 0?void 0:l.code,data:(d=(c=vt.hk_criteria)===null||c===void 0?void 0:c.dusty_periods)===null||d===void 0?void 0:d.map((t=>({text:t.description,value:t.code}))),onSelectChange:t=>{t.stopImmediatePropagation();t.stopPropagation();this.updateFilter({dusty_units:{code:t.detail}})}})),e("fieldset",{key:"24fb6abbc9cbb529ca519f77d61983047cf50961",class:"mb-1"},e("p",{key:"0b1283b4a9583b93221712938717c5f800710844",class:"m-0 pt-0 px-0",style:{paddingBottom:"0.25rem"}},y.entries["Lcz_HighlightCheck-insFrom"]),e("ir-select",{key:"9587e35c8dcff3b5179cf92092c953cc6cf533e3",testId:"highlight_check_ins",selectedValue:(u=(h=this.filters)===null||h===void 0?void 0:h.highlight_check_ins)===null||u===void 0?void 0:u.code,showFirstOption:false,onSelectChange:t=>{this.updateFilter({highlight_check_ins:{code:t.detail}})},data:(p=(f=vt.hk_criteria)===null||f===void 0?void 0:f.highlight_checkin_options)===null||p===void 0?void 0:p.map((t=>({text:t.description,value:t.code})))})),e("div",{key:"f10c7935a7c9e9b6f94b6f1e678f188333645a43",class:"d-flex align-items-center justify-content-end",style:{gap:"1rem"}},e("ir-button",{key:"aae8de4339fe0b348db926fad02bc7071606bcaa",btn_type:"button","data-testid":"reset",text:y.entries.Lcz_Reset,size:"sm",btn_color:"secondary",onClickHandler:t=>this.resetFilters(t)}),e("ir-button",{key:"37a22eaf0828d1e8cf955eeb0d0d7f6fda40a4a4",btn_type:"button","data-testid":"apply",isLoading:this.isLoading,text:y.entries.Lcz_Apply,size:"sm",onClickHandler:t=>this.applyFiltersEvt(t)})))))}};Sf.style=Tf;const Bf=".sc-ir-tasks-header-h{display:flex;gap:1rem;flex-wrap:wrap}.action-buttons.sc-ir-tasks-header{display:flex;align-items:center}.search-filter-container.sc-ir-tasks-header{flex:1 1 0%}.clean-button.sc-ir-tasks-header{display:none}@media (min-width: 640px){.sc-ir-tasks-header-h{flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:1rem}.search-filter-container.sc-ir-tasks-header{display:flex}.action-buttons.sc-ir-tasks-header{justify-content:stretch}.clean-button.sc-ir-tasks-header{display:flex}}";const If=Bf;const jf=class{constructor(e){t(this,e);this.headerButtonPress=s(this,"headerButtonPress",7)}handleCleanedButtonAnimation(t){t.stopImmediatePropagation();t.stopPropagation();this.btnRef.bounce()}render(){return e(i,{key:"90e7a5722062ac04f268e50c101f0bf98be604b7"},e("div",{key:"12f2e57f2cb54d858c833c66221b0ccb214a2479",class:"search-filter-container",style:{gap:"1rem"}},e("ir-input-text",{key:"5943b07eb2b2bffdadb38b13db09b485b546da98",class:"search-filter-input",placeholder:"Search unit",variant:"icon",value:vl.searchField,onTextChange:t=>kl(t.detail)},e("ir-icons",{key:"f3d7d97c1b0d3b0c1cce3771ff3b73cb6041fe4d",name:"search",slot:"icon"}))),e("div",{key:"5ae75599fe8e63ee86ebb2037ab4edcce8fce439",class:"action-buttons",style:{gap:"1rem"}},e("ir-button",{key:"c4b56c4b54f8f0ea2bdae64d4eca62ff8ed929e1",size:"sm",btn_color:"outline",text:y.entries.Lcz_Export,onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.headerButtonPress.emit({name:"export"})},btnStyle:{height:"100%"},iconPosition:"right",icon_name:"file",icon_style:{"--icon-size":"14px"}}),e("ir-button",{key:"7e3e849e96b6f474c05bc03fcfe239767937172d",size:"sm",btn_color:"outline",text:y.entries.Lcz_Archives,btnStyle:{height:"100%"},onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.headerButtonPress.emit({name:"archive"})}}),e("ir-button",{key:"4ebc0fde81ea8424bc43b57368da06126f4b1b54",class:"clean-button",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.headerButtonPress.emit({name:"cleaned"})},btnStyle:{height:"100%"},size:"sm",btn_disabled:!(vl.selectedTasks.length>0),text:"Cleaned",ref:t=>this.btnRef=t}),e("ir-button",{key:"74444966ef49e0b6697ae753bac4647b39fa9d22",class:"clean-button",onClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.headerButtonPress.emit({name:"clean-inspect"})},btnStyle:{height:"100%"},size:"sm",btn_disabled:!(vl.selectedTasks.length>0),text:"Clean & Inspect",ref:t=>this.btnRef=t})))}};jf.style=If;const zf=".sc-ir-tasks-table-h{display:flex;align-items:center}.selected-row.sc-ir-tasks-table{background-color:rgba(0, 0, 255, 0.1)}.selected-row.sc-ir-tasks-table:hover{background-color:rgba(0, 0, 255, 0.15)}.header-content.sc-ir-tasks-table{height:100%}.highlighted-unit.sc-ir-tasks-table{background:#000;color:white;padding:0.2rem 0.3rem;border-radius:4px}.table-container.sc-ir-tasks-table{height:100%}.task-table-row.sc-ir-tasks-table td.sc-ir-tasks-table{background:white !important}.task-table-row.sc-ir-tasks-table:hover td.sc-ir-tasks-table{background:#e2e6ea3f !important}.table-container.sc-ir-tasks-table{display:none}.mobile-tasks-container.sc-ir-tasks-table{display:flex;flex-direction:column;gap:1rem}@media (min-width: 640px){.mobile-tasks-container.sc-ir-tasks-table{display:none}.table-container.sc-ir-tasks-table{display:flex}}";const Nf=zf;const Rf=".ir-table-row.sc-ir-tasks-table td.sc-ir-tasks-table{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:white;white-space:nowrap}.table.sc-ir-tasks-table td.sc-ir-tasks-table{border-top:0;border-bottom:1px solid #e3ebf3;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-tasks-table thead.sc-ir-tasks-table th.sc-ir-tasks-table{border:none !important;background:#ececec;color:#374151;padding:0.5rem 1rem !important;text-align:left}.selected.sc-ir-tasks-table td.sc-ir-tasks-table{background:#e3f3fa !important}.selected.sc-ir-tasks-table td.sc-ir-tasks-table{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-tasks-table,.ir-table-row.sc-ir-tasks-table{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-tasks-table{text-transform:capitalize}.sortable.sc-ir-tasks-table:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-tasks-table:hover td.sc-ir-tasks-table{background:#e2e6ea3f !important}.sortable.sc-ir-tasks-table:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-tasks-table svg.sc-ir-tasks-table{color:var(--blue)}";const $f=Rf;const Ff=class{constructor(e){t(this,e);this.animateCleanedButton=s(this,"animateCleanedButton",7);this.rowSelectChange=s(this,"rowSelectChange",7);this.sortingChanged=s(this,"sortingChanged",7);this.skipSelectedTask=s(this,"skipSelectedTask",7);this.tasks=[]}componentWillLoad(){if(this.tasks&&this.tasks.length>0){Nl("date","ASC")}}handleSort(t){let e=vl.sorting.direction;if(vl.sorting.field===t){e=vl.sorting.direction==="ASC"?"DESC":"ASC"}else{e="ASC"}Nl(t,e);this.sortingChanged.emit({field:t,direction:e})}handleClearSelectedHkTasks(t){t.stopImmediatePropagation();t.stopPropagation();Bl()}handleTasksChange(t){if(t===null||t===void 0?void 0:t.length){Bl()}}toggleSelection(t){Il(t);this.animateCleanedButton.emit(null);this.emitSelectedTasks()}emitSelectedTasks(){this.rowSelectChange.emit(vl.selectedTasks)}get allSelected(){return Fl()}toggleSelectAll(){if(this.allSelected){Bl()}else{jl($l());this.animateCleanedButton.emit(null)}this.emitSelectedTasks()}isCheckable(t){return D(t.date,"YYYY-MM-DD").isSameOrBefore(D(),"days")}isSkippable(t){const e=D().isSame(D(t.date,"YYYY-MM-DD"),"date");return e&&t.status.code==="IH"}render(){var t,s;const a=((s=(t=vt===null||vt===void 0?void 0:vt.hk_criteria)===null||t===void 0?void 0:t.housekeepers)===null||s===void 0?void 0:s.length)>1;const n=El();const o=Yl();return e(i,{key:"1c49d212407a364f7998b0337aafae40af03251a",class:"flex-fill"},e("section",{key:"dfcdaf54db888db1b530ded74e2dfa0170ab98a5",class:"mobile-tasks-container flex-fill"},e("div",{key:"f163f1f3eb4d8358c6a984befc3f08ec1534d9cb",class:"card p-1 m-0"},e("ir-tasks-header",{key:"f536e460687a3c80cf9f7159d1d991a9a13eba53"})),(o===null||o===void 0?void 0:o.length)===0&&e("p",{key:"d84b5899596e7162e37d9fa6299ae7d7157ea0ab",class:"mx-auto"},y.entries.Lcz_NoTasksFound),o.map((t=>{const i=this.isCheckable(t);const s=this.isSkippable(t);return e("ir-tasks-card",{task:t,isSkippable:s,key:t.id,isCheckable:i})})),e("ir-tasks-table-pagination",{key:"482dbc39c2672a1c951735d629671c01c2fb8118"})),e("div",{key:"2ccf8b010dde3dd51532cf94adc4a8c8fe949430",class:"card table-container flex-fill p-1 m-0"},e("ir-tasks-header",{key:"2f0026bf96dba62bd3633f446f6875f09b1d95e8"}),e("div",{key:"041347c4308e7a6ed48b0bf6cce632470ee1357e",class:"table-responsive mb-auto"},e("table",{key:"acdf85141ddc6bd55760bc60d50494ef39bdaa38",class:"table","data-testid":"hk_tasks_table"},e("thead",{key:"20a96ae686eecfe9d7ff09a49141600d60c4c3af",class:"table-header"},e("tr",{key:"9260282666b90932a7c87ff7b09488ef0a0d0891"},e("th",{key:"0f534ad408a4e8d66d3ac7252a7c1783a29bf355",class:"task-row"},e("ir-checkbox",{key:"3202ae623265806f78e90c0114627f3e3bd9a3d8",indeterminate:vl.selectedTasks.length>0&&vl.selectedTasks.length<$l().length,checked:this.allSelected,onCheckChange:()=>this.toggleSelectAll()})),e("th",{key:"522a6abb5e3d9129c2e699588a2c75f33088a3c2",class:"extra-padding"},y.entries.Lcz_Period),e("th",{key:"eb49d6520a7130e94c1453f451c8616dc68a27ab",class:"extra-padding"},this.tasks.length>1&&this.tasks.length+" ",y.entries.Lcz_Unit),e("th",{key:"5a03a36d8b38f0a8db8d527a41c1ce878840daa9",class:"sortable extra-padding",onClick:()=>this.handleSort("status")},e("div",{key:"b3527e28e32e734cd1c2203bf0517ea81a4cd412",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("span",{key:"66bf39e4919c68db4d8b004e146ba66910538706"},y.entries.Lcz_Status),e("svg",{key:"7cadf695a72b5caaa02a53b346acc0f927ca7edb",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-arrow-up-down"},e("path",{key:"6766f14a28d9860262afecb6a9feb95877ef2588",d:"m21 16-4 4-4-4"}),e("path",{key:"a81cc33238a64a38b148f5ef25a48c287d2d1367",d:"M17 20V4"}),e("path",{key:"b7fa650f19833201450008914aa44e1e52e84db2",d:"m3 8 4-4 4 4"}),e("path",{key:"958ebd00559edb66f9bdba06f8dd1be5bb02d084",d:"M7 4v16"})))),e("th",{key:"54bdf6dd1364522fd2561b6b4f27a6b05e40f175",class:"extra-padding text-left"},y.entries.Lcz_Hint),e("th",{key:"9d9d9f3aba17a09e67ad74e7765b179fa5e80c05",class:"text-left"},y.entries.Lcz_A,"d"),e("th",{key:"8b3fffe456499a1c0794f442206e4c93fa75b40c",class:"text-left"},y.entries.Lcz_C,"h"),e("th",{key:"8ee61197b68a705d0a9c0a8263cb8a8554ae827c",class:"text-left text-left"},y.entries.Lcz_I,"n"),a&&e("th",{key:"fd037f9579b31d0473519be3711b7ff747c218dc",style:{textAlign:"start"},class:"sortable extra-padding",onClick:()=>this.handleSort("housekeeper")},e("div",{key:"c353cc6d0b723ee25ada70c10965a224aaec2bc3",class:"d-flex align-items-center",style:{gap:"0.5rem"}},e("span",{key:"99257141a07e224ac11fdc9c88924a84a1846d6e"},y.entries.Lcz_Housekeeper),e("svg",{key:"8ed83634e6119b8c42f88c3f332393e508af4fb2",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-arrow-up-down"},e("path",{key:"d32803aae3d0013aff416f7d204feabf7c1444b3",d:"m21 16-4 4-4-4"}),e("path",{key:"52d8295f0e49a793383d68452f7479b9b8a81950",d:"M17 20V4"}),e("path",{key:"d2eebf752e32962fdb6c31672d033566f33e2742",d:"m3 8 4-4 4 4"}),e("path",{key:"06e107ef20b5bb83f103c9f48bda7b0f90ee973b",d:"M7 4v16"})))),e("th",{key:"ba178288d11453e239f75bcca4aab6fa6a1b1562"}))),e("tbody",{key:"9bcbc1d3f58e608a83c86eaf2d9308ab51ef7a38"},n.length===0&&e("tr",{key:"d404913464dca4e8772b84f17a7299fffaf50994",class:"ir-table-row"},e("td",{key:"e490655234f693a460bb08a5975d8a4850e5f970",colSpan:9,class:"text-left"},e("div",{key:"ba18baa44788acf9cc6048120fe4bd01e3b254ba",style:{height:"300px"},class:"d-flex align-items-center justify-content-center"},e("span",{key:"0e55ef476831006d46ba699005674a2df6bfd9d5"}," ",y.entries.Lcz_NoTasksFound)))),n===null||n===void 0?void 0:n.map((t=>{var i;const s=vl.selectedTasks.some((e=>e.id===t.id));const n=this.isCheckable(t);return e("tr",{"data-date":t.date,"data-testid":`hk_task_row`,"data-assigned":t.housekeeper?"true":"false",style:n&&{cursor:"pointer"},onClick:()=>{if(!n){return}this.toggleSelection(t)},class:{selected:s,"task-table-row ir-table-row":true},key:t.id},e("td",{class:"task-row "},n&&e("ir-checkbox",{checked:s})),e("td",{class:"task-row extra-padding"},t.formatted_date),e("td",{class:"task-row extra-padding"},e("span",{class:{"highlighted-unit":t.is_highlight}},t.unit.name)),e("td",{class:"task-row extra-padding text-left"},t.status.description),e("td",{class:"task-row extra-padding text-left"},t.hint),e("td",{class:"task-row text-left"},t.adult),e("td",{class:"task-row text-left"},t.child),e("td",{class:"task-row text-left"},t.infant),a&&e("td",{class:" task-row extra-padding",style:{textAlign:"start"}},(i=t.housekeeper)!==null&&i!==void 0?i:y.entries.Lcz_Unassigned),e("td",null,this.isSkippable(t)&&e("ir-button",{text:"Skip",size:"sm",onClickHandler:()=>{this.skipSelectedTask.emit(t)}})))}))))),e("div",{key:"e29b58f87d29d512d04510459a1597a010d45291",class:"mt-auto"},e("ir-tasks-table-pagination",{key:"0a000774d97b98da0f3a0613a55e634b0ff4948e"}))))}static get watchers(){return{tasks:["handleTasksChange"]}}};Ff.style=Nf+$f;const Lf=".sc-ir-tasks-table-pagination-h{display:block;margin-top:auto}.page-item.active.sc-ir-tasks-table-pagination .page-link.sc-ir-tasks-table-pagination{background-color:var(--blue)}.tasks-pagination.sc-ir-tasks-table-pagination{display:none !important}@media (min-width: 640px){.tasks-load-more.sc-ir-tasks-table-pagination{display:none}.tasks-pagination.sc-ir-tasks-table-pagination{display:flex !important}}";const Pf=Lf;const Hf=class{constructor(e){t(this,e)}render(){var t,s;const{currentPage:a,pageSize:n,totalPages:o,mobileCurrentPage:r}=vl.pagination;const l=(s=(t=vl.tasks)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0;const c=l===0?0:(a-1)*n+1;const d=Math.min(a*n,l);const h=vl.pagination.tasksList[0]>l?vl.pagination.tasksList.slice(0,1):vl.pagination.tasksList;return e(i,{key:"466c80adb88f7ec0e9b1f289182e149479a9597c"},Al()&&e("ir-button",{key:"6477a474fd14d8e4914a65427f230569b00176f7",size:"sm",class:"tasks-load-more",text:"Load more",onClickHandler:()=>Tl(r+1)}),e("ir-pagination",{key:"b9713cbb60497f8edb25ab9a6eeafab613c9cc82",showing:{from:c,to:d},class:"tasks-pagination",total:l,pages:o,pageSize:n,currentPage:a,pageSizes:h,onPageChange:t=>Dl(t.detail.currentPage),onPageSizeChange:t=>_l(t.detail.pageSize),showTotalRecords:true,recordLabel:"tasks"}))}};Hf.style=Pf;const Uf=".prepend-textarea.sc-ir-textarea{padding:0 !important}.ta-prepend-text.sc-ir-textarea{width:100%}";const Vf=Uf;const Gf=class{constructor(e){t(this,e);this.textChange=s(this,"textChange",7);this.rows=3;this.cols=5;this.text="";this.label="<label>";this.placeholder="<placeholder>";this.value="";this.maxLength=250;this.variant="default";this.labelWidth=3;this.error=false}handleAriaInvalidChange(t){this.error=t==="true"}render(){if(this.variant==="prepend"){return e("fieldset",{class:"input-group"},e("div",{class:`input-group-prepend col-${this.labelWidth} prepend-textarea`},e("span",{class:"input-group-text ta-prepend-text"},this.label)),e("textarea",{"data-testid":this.testId,value:this.value,class:`form-control`,style:Object.assign({height:"7rem"},this.styles),maxLength:this.maxLength,onChange:t=>this.textChange.emit(t.target.value),"aria-label":this.label}))}return e("div",{class:"form-group"},e("label",null,this.label),e("textarea",{"data-testid":this.testId,style:this.styles,maxLength:this.maxLength,rows:this.rows,value:this.value,class:`form-control ${this.textareaClassname} ${this.error?"border-danger":""}`,placeholder:this.placeholder,onInput:t=>this.textChange.emit(t.target.value)}))}static get watchers(){return{"aria-invalid":["handleAriaInvalidChange"]}}};Gf.style=Vf;const Kf=".sc-ir-title-h{padding:0px 0;margin-bottom:20px;display:flex;align-items:center;width:100%}[border-shown].sc-ir-title-h{border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important;padding-bottom:15px}[display-context='sidebar'].sc-ir-title-h{padding:15px 0;justify-content:space-between !important;width:100% !important;border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important}.title-body.sc-ir-title{margin:0;padding:0}.label.sc-ir-title{font-family:inherit !important}@media only screen and (max-width: 641px){.sc-ir-title-h{flex-direction:column;gap:8px;align-items:flex-start}[display-context='sidebar'].sc-ir-title-h{flex-direction:row}}";const Wf=Kf;const qf=class{constructor(e){t(this,e);this.closeSideBar=s(this,"closeSideBar",7);this.displayContext="default";this.justifyContent="start"}componentDidLoad(){this.el.style.justifyContent=this.justifyContent}handleJustifyContentChange(t,e){if(t!==e){this.el.style.justifyContent=t}}render(){return e(i,{key:"de304621447b7f0dc40b5ea249900e871737f232"},e("h4",{key:"160dac967390b8003e02c78132e9f6cf6f799530",class:"text-left label font-medium-2 py-0 my-0"},this.label),this.displayContext==="sidebar"&&e("ir-icon",{key:"23994d101097e1a4c2dec072e868edc9fe18a4ec",class:"close",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},e("svg",{key:"5c95b8e97e49141d45acc4f6ec9c19d70b93af93",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{key:"1b692970784fea1fca689c7a4e6ba7d3769b3284",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),this.displayContext!=="sidebar"&&e("div",{key:"8117ff4f258da9f56e7665eb32885ced7b253590",class:"title-body"},e("slot",{key:"ce8c9214e46ad5a884a8a74863602e67e46a5414",name:"title-body"})))}get el(){return n(this)}static get watchers(){return{justifyContent:["handleJustifyContentChange"]}}};qf.style=Wf;const Xf="button.sc-ir-toast,p.sc-ir-toast,h3.sc-ir-toast,div.sc-ir-toast{all:unset}.sc-ir-toast-h{--rd-viewport-padding:25px;--rd-success:#2b9a66;position:fixed;bottom:0;right:0;display:flex;flex-direction:column;padding:var(--rd-viewport-padding);gap:10px;max-width:100vw;margin:0;list-style:none;z-index:2147483647;outline:none;pointer-events:none;-webkit-user-select:none;user-select:none}@media (prefers-color-scheme: dark){.sc-ir-toast-h{--rd-success:#33b074}}p.sc-ir-toast{color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3}h1.sc-ir-toast,h2.sc-ir-toast,h3.sc-ir-toast,h4.sc-ir-toast,h5.sc-ir-toast,h6.sc-ir-toast{font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}[position='top-left'].sc-ir-toast-h{top:0;left:0}[position='top-right'].sc-ir-toast-h{top:0;right:0}[position='bottom-left'].sc-ir-toast-h{bottom:0;left:0}[position='bottom-right'].sc-ir-toast-h{bottom:0;right:0}.icon-container.sc-ir-toast{height:25px;width:25px;border-radius:25px;display:flex;align-items:center;justify-content:center;padding:0;margin:0}.icon-container.sc-ir-toast>svg.sc-ir-toast{margin:0;color:white;stroke-width:5px}.success.sc-ir-toast{background-color:var(--rd-success)}.error.sc-ir-toast{background-color:red}.ToastRoot.sc-ir-toast{background-color:hsl(0, 0%, 100%);border-radius:0.5rem;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;padding:15px;display:grid;grid-template-areas:'title action' 'description action';grid-template-columns:auto max-content;column-gap:15px;align-items:center;pointer-events:none;opacity:0;border:1px solid hsl(214.3, 31.8%, 91.4%);position:relative}.ToastRoot[data-state='open'].sc-ir-toast{pointer-events:all;animation:slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1)}.ToastRoot[data-state='closed'].sc-ir-toast{pointer-events:none;animation:hide 100ms ease-in}@-webkit-keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}@keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}.ToastTitle.sc-ir-toast{grid-area:title;font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}.ToastDescription.sc-ir-toast{grid-area:description;margin:0;margin-top:5px;color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3;overflow:hidden;text-overflow:ellipsis}.ToastAction.sc-ir-toast{grid-area:action}";const Jf=Xf;const Qf=class{constructor(e){t(this,e);this.position="bottom-left";this.toasts=[]}onToast(t){const e=t.detail;this.showToast(e)}showToast(t){const e={positionClass:"toast-top-right",closeButton:true,timeOut:t.duration||5e3};switch(t.type){case"success":toastr.success(t.title,"",e);break;case"error":toastr.error(t.title,"",e);break}}render(){return e(i,{key:"f765abdf628c80ff44f394f16f625cb9159f8aaa"})}get element(){return n(this)}};Qf.style=Jf;const Zf=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}.tooltip-inner-custom.sc-ir-tooltip{min-width:max-content !important}";const tp=Zf;const ep=class{constructor(e){t(this,e);this.withHtml=true;this.customSlot=false;this.alignment="center"}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){const t=(()=>{switch(this.alignment){case"start":return"justify-content-start";case"end":return"justify-content-end";case"center":return"justify-content-center";default:return"justify-content-center"}})();return e(i,{class:"m-0 p-0"},e("span",{style:this.containerStyle,class:`m-0 p-0 d-flex align-items-center ${t} ${this.containerClass}`,onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},!this.customSlot?e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"m-0 p-0",height:"16",width:"16",viewBox:"0 0 512 512"},e("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})):e("slot",{name:"tooltip-trigger"})),this.open&&e("div",{class:"tooltip bottom show position-absolute",role:"tooltip"},e("div",{class:"tooltip-arrow"}),e("div",{class:`tooltip-inner fit ${this.customSlot&&"tooltip-inner-custom"}`},e("span",{innerHTML:this.message}))))}};ep.style=tp;var ip={exports:{}};(function(t,e){((i,s)=>{function a(t){for(var e={},i=0;i<t.length;i++)e[t[i].toUpperCase()]=t[i];return e}var n=500,o="user-agent",r="",l="?",c="function",d="undefined",h="object",u="string",f="browser",p="cpu",b="device",g="engine",m="os",v="result",y="name",k="type",w="vendor",x="version",_="architecture",D="major",C="model",O="console",M="mobile",E="tablet",Y="smarttv",A="wearable",T="xr",S="embedded",B="inapp",I="brands",j="formFactors",z="fullVersionList",N="platform",R="platformVersion",$="bitness",F="sec-ch-ua",L=F+"-full-version-list",P=F+"-arch",H=F+"-"+$,U=F+"-form-factors",V=F+"-"+M,G=F+"-"+C,K=F+"-"+N,W=K+"-version",q=[I,z,M,C,N,R,_,j,$],X="Amazon",J="Apple",Q="ASUS",Z="BlackBerry",tt="Google",et="Huawei",it="Microsoft",st="Motorola",at="Nvidia",nt="OnePlus",ot="OPPO",rt="Samsung",lt="Sony",ct="Xiaomi",dt="Zebra",ht="Chromium",ut="Chromecast",ft="Firefox",pt="Opera",bt="Facebook",gt="Mobile ",mt=" Browser",vt="Windows",yt=typeof i!==d,kt=yt&&i.navigator?i.navigator:s,wt=kt&&kt.userAgentData?kt.userAgentData:s,xt=function(t,e){if(typeof t===h&&0<t.length){for(var i in t)if(Ot(t[i])==Ot(e))return!0;return!1}return!!Dt(t)&&-1!==Ot(e).indexOf(Ot(t))},_t=function(t,e){for(var i in t)return/^(browser|cpu|device|engine|os)$/.test(i)||!!e&&_t(t[i])},Dt=function(t){return typeof t===u},Ct=function(t){if(!t)return s;for(var e,i=[],a=Yt(/\\?\"/g,t).split(","),n=0;n<a.length;n++)-1<a[n].indexOf(";")?(e=Tt(a[n]).split(";v="),i[n]={brand:e[0],version:e[1]}):i[n]=Tt(a[n]);return i},Ot=function(t){return Dt(t)?t.toLowerCase():t},Mt=function(t){return Dt(t)?Yt(/[^\d\.]/g,t).split(".")[0]:s},Et=function(t){for(var e in t){e=t[e];typeof e==h&&2==e.length?this[e[0]]=e[1]:this[e]=s}return this},Yt=function(t,e){return Dt(e)?e.replace(t,r):e},At=function(t){return Yt(/\\?\"/g,t)},Tt=function(t,e){if(Dt(t))return t=Yt(/^\s\s*/,t),typeof e===d?t:t.substring(0,n)},St=function(t,e){if(t&&e)for(var i,a,n,o,r,l=0;l<e.length&&!o;){for(var d=e[l],u=e[l+1],f=i=0;f<d.length&&!o&&d[f];)if(o=d[f++].exec(t))for(a=0;a<u.length;a++)r=o[++i],typeof(n=u[a])===h&&0<n.length?2===n.length?typeof n[1]==c?this[n[0]]=n[1].call(this,r):this[n[0]]=n[1]:3===n.length?typeof n[1]!==c||n[1].exec&&n[1].test?this[n[0]]=r?r.replace(n[1],n[2]):s:this[n[0]]=r?n[1].call(this,r,n[2]):s:4===n.length&&(this[n[0]]=r?n[3].call(this,r.replace(n[1],n[2])):s):this[n]=r||s;l+=2}},Bt=function(t,e){for(var i in e)if(typeof e[i]===h&&0<e[i].length){for(var a=0;a<e[i].length;a++)if(xt(e[i][a],t))return i===l?s:i}else if(xt(e[i],t))return i===l?s:i;return e.hasOwnProperty("*")?e["*"]:t},It={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},jt={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":s},zt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[x,[y,gt+"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[x,[y,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[y,x],[/opios[\/ ]+([\w\.]+)/i],[x,[y,pt+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[x,[y,pt+" GX"]],[/\bopr\/([\w\.]+)/i],[x,[y,pt]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[x,[y,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[x,[y,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:lg |qute)browser)\/([-\w\.]+)/i,/(heytap|ovi|115|surf)browser\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[y,x],[/quark(?:pc)?\/([-\w\.]+)/i],[x,[y,"Quark"]],[/\bddg\/([\w\.]+)/i],[x,[y,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[x,[y,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[x,[y,"WeChat"]],[/konqueror\/([\w\.]+)/i],[x,[y,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[x,[y,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[x,[y,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[x,[y,"Smart Lenovo"+mt]],[/(avast|avg)\/([\w\.]+)/i],[[y,/(.+)/,"$1 Secure"+mt],x],[/\bfocus\/([\w\.]+)/i],[x,[y,ft+" Focus"]],[/\bopt\/([\w\.]+)/i],[x,[y,pt+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[x,[y,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[x,[y,"Dolphin"]],[/coast\/([\w\.]+)/i],[x,[y,pt+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[x,[y,"MIUI"+mt]],[/fxios\/([\w\.-]+)/i],[x,[y,gt+ft]],[/\bqihoobrowser\/?([\w\.]*)/i],[x,[y,"360"]],[/\b(qq)\/([\w\.]+)/i],[[y,/(.+)/,"$1Browser"],x],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[y,/(.+)/,"$1"+mt],x],[/samsungbrowser\/([\w\.]+)/i],[x,[y,rt+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[x,[y,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[y,"Sogou Mobile"],x],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[y,x],[/(lbbrowser|rekonq)/i],[y],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[x,y],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[y,bt],x,[k,B]],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(instagram|snapchat)[\/ ]([-\w\.]+)/i],[y,x,[k,B]],[/\bgsa\/([\w\.]+) .*safari\//i],[x,[y,"GSA"],[k,B]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[x,[y,"TikTok"],[k,B]],[/\[(linkedin)app\]/i],[y,[k,B]],[/(chromium)[\/ ]([-\w\.]+)/i],[y,x],[/headlesschrome(?:\/([\w\.]+)| )/i],[x,[y,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[y,"Chrome WebView"],x],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[x,[y,"Android"+mt]],[/chrome\/([\w\.]+) mobile/i],[x,[y,gt+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[y,x],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[x,[y,gt+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[y,gt+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[x,y],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[y,[x,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[y,x],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[y,gt+ft],x],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[y,"Netscape"],x],[/(wolvic|librewolf)\/([\w\.]+)/i],[y,x],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[x,[y,ft+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[y,[x,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[y,[x,/[^\d\.]+./,r]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[_,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[_,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[_,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[_,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[_,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[_,/ower/,r,Ot]],[/ sun4\w[;\)]/i],[[_,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[_,Ot]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[C,[w,rt],[k,E]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[C,[w,rt],[k,M]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[C,[w,J],[k,M]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[C,[w,J],[k,E]],[/(macintosh);/i],[C,[w,J]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[C,[w,"Sharp"],[k,M]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[C,[w,"Honor"],[k,E]],[/honor([-\w ]+)[;\)]/i],[C,[w,"Honor"],[k,M]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[C,[w,et],[k,E]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[C,[w,et],[k,M]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[C,/_/g," "],[w,ct],[k,E]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[C,/_/g," "],[w,ct],[k,M]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[C,[w,ot],[k,M]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[C,[w,Bt,{OnePlus:["304","403","203"],"*":ot}],[k,E]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[C,[w,"BLU"],[k,M]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[C,[w,"Vivo"],[k,M]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[C,[w,"Realme"],[k,M]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[C,[w,st],[k,M]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[C,[w,st],[k,E]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[C,[w,"LG"],[k,E]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch))(\w+)/i,/\blg-?([\d\w]+) bui/i],[C,[w,"LG"],[k,M]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[C,[w,"Lenovo"],[k,E]],[/(nokia) (t[12][01])/i],[w,C,[k,E]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[C,/_/g," "],[k,M],[w,"Nokia"]],[/(pixel (c|tablet))\b/i],[C,[w,tt],[k,E]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[C,[w,tt],[k,M]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[C,[w,lt],[k,M]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[C,"Xperia Tablet"],[w,lt],[k,E]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[C,[w,nt],[k,M]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[C,[w,X],[k,E]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[C,/(.+)/g,"Fire Phone $1"],[w,X],[k,M]],[/(playbook);[-\w\),; ]+(rim)/i],[C,w,[k,E]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[C,[w,Z],[k,M]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[C,[w,Q],[k,E]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[C,[w,Q],[k,M]],[/(nexus 9)/i],[C,[w,"HTC"],[k,E]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[w,[C,/_/g," "],[k,M]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[C,[w,"TCL"],[k,E]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[C,[w,"TCL"],[k,M]],[/(itel) ((\w+))/i],[[w,Ot],C,[k,Bt,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[C,[w,"Acer"],[k,E]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[C,[w,"Meizu"],[k,M]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[C,[w,"Ulefone"],[k,M]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[C,[w,"Energizer"],[k,M]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[C,[w,"Cat"],[k,M]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[C,[w,"Smartfren"],[k,M]],[/droid.+; (a(?:015|06[35]|142p?))/i],[C,[w,"Nothing"],[k,M]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[C,[w,"Archos"],[k,E]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[C,[w,"Archos"],[k,M]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[w,C,[k,E]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|tcl)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[w,C,[k,M]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[w,C,[k,E]],[/(surface duo)/i],[C,[w,it],[k,E]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[C,[w,"Fairphone"],[k,M]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[C,[w,at],[k,E]],[/(sprint) (\w+)/i],[w,C,[k,M]],[/(kin\.[onetw]{3})/i],[[C,/\./g," "],[w,it],[k,M]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[C,[w,dt],[k,E]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[C,[w,dt],[k,M]],[/smart-tv.+(samsung)/i],[w,[k,Y]],[/hbbtv.+maple;(\d+)/i],[[C,/^/,"SmartTV"],[w,rt],[k,Y]],[/tcast.+(lg)e?. ([-\w]+)/i],[w,C,[k,Y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[w,"LG"],[k,Y]],[/(apple) ?tv/i],[w,[C,J+" TV"],[k,Y]],[/crkey.*devicetype\/chromecast/i],[[C,ut+" Third Generation"],[w,tt],[k,Y]],[/crkey.*devicetype\/([^/]*)/i],[[C,/^/,"Chromecast "],[w,tt],[k,Y]],[/fuchsia.*crkey/i],[[C,ut+" Nest Hub"],[w,tt],[k,Y]],[/crkey/i],[[C,ut],[w,tt],[k,Y]],[/(portaltv)/i],[C,[w,bt],[k,Y]],[/droid.+aft(\w+)( bui|\))/i],[C,[w,X],[k,Y]],[/(shield \w+ tv)/i],[C,[w,at],[k,Y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[C,[w,"Sharp"],[k,Y]],[/(bravia[\w ]+)( bui|\))/i],[C,[w,lt],[k,Y]],[/(mi(tv|box)-?\w+) bui/i],[C,[w,ct],[k,Y]],[/Hbbtv.*(technisat) (.*);/i],[w,C,[k,Y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[w,Tt],[C,Tt],[k,Y]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[C,[k,Y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[k,Y]],[/(ouya)/i,/(nintendo) (\w+)/i],[w,C,[k,O]],[/droid.+; (shield)( bui|\))/i],[C,[w,at],[k,O]],[/(playstation \w+)/i],[C,[w,lt],[k,O]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[C,[w,it],[k,O]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[C,[w,rt],[k,A]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[w,C,[k,A]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[C,[w,ot],[k,A]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[C,[w,J],[k,A]],[/(opwwe\d{3})/i],[C,[w,nt],[k,A]],[/(moto 360)/i],[C,[w,st],[k,A]],[/(smartwatch 3)/i],[C,[w,lt],[k,A]],[/(g watch r)/i],[C,[w,"LG"],[k,A]],[/droid.+; (wt63?0{2,3})\)/i],[C,[w,dt],[k,A]],[/droid.+; (glass) \d/i],[C,[w,tt],[k,T]],[/(pico) (4|neo3(?: link|pro)?)/i],[w,C,[k,T]],[/(quest( \d| pro)?s?).+vr/i],[C,[w,bt],[k,T]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[w,[k,S]],[/(aeobc)\b/i],[C,[w,X],[k,S]],[/(homepod).+mac os/i],[C,[w,J],[k,S]],[/windows iot/i],[[k,S]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+?(mobile|vr|\d) safari/i],[C,[k,Bt,{mobile:"Mobile",xr:"VR","*":E}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[k,E]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[k,M]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[C,[w,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[x,[y,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[y,x],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[x,[y,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[y,x],[/ladybird\//i],[[y,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[x,y]],os:[[/microsoft (windows) (vista|xp)/i],[y,x],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[y,[x,Bt,It]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[x,Bt,It],[y,vt]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[x,/_/g,"."],[y,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[y,"macOS"],[x,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[x,[y,ut+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[x,[y,ut+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[x,[y,ut+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[x,[y,ut+" Linux"]],[/crkey\/([\d\.]+)/i],[x,[y,ut]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[x,y],[/(ubuntu) ([\w\.]+) like android/i],[[y,/(.+)/,"$1 Touch"],x],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/\.; ]?([\d\.]*)/i],[y,x],[/\(bb(10);/i],[x,[y,Z]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[x,[y,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[x,[y,ft+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[x,[y,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[x,[y,"watchOS"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[y,"Chrome OS"],x],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[y,x],[/(sunos) ?([\w\.\d]*)/i],[[y,"Solaris"],x],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[y,x]]},Nt=(pt={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}},Et.call(pt.init,[[f,[y,x,D,k]],[p,[_]],[b,[k,C,w]],[g,[y,x]],[m,[y,x]]]),Et.call(pt.isIgnore,[[f,[x,D]],[g,[x]],[m,[x]]]),Et.call(pt.isIgnoreRgx,[[f,/ ?browser$/i],[m,/ ?os$/i]]),Et.call(pt.toString,[[f,[y,x]],[p,[_]],[b,[w,C]],[g,[y,x]],[m,[y,x]]]),pt),Rt=function(t,e){var i=Nt.init[e],s=Nt.isIgnore[e]||0,a=Nt.isIgnoreRgx[e]||0,n=Nt.toString[e]||0;function o(){Et.call(this,i)}return o.prototype.getItem=function(){return t},o.prototype.withClientHints=function(){return wt?wt.getHighEntropyValues(q).then((function(e){return t.setCH(new $t(e,!1)).parseCH().get()})):t.parseCH().get()},o.prototype.withFeatureCheck=function(){return t.detectFeature().get()},e!=v&&(o.prototype.is=function(t){var e,i=!1;for(e in this)if(this.hasOwnProperty(e)&&!xt(s,e)&&Ot(a?Yt(a,this[e]):this[e])==Ot(a?Yt(a,t):t)){if(i=!0,t!=d)break}else if(t==d&&i){i=!i;break}return i},o.prototype.toString=function(){var t,e=r;for(t in n)typeof this[n[t]]!==d&&(e+=(e?" ":r)+this[n[t]]);return e||d}),wt||(o.prototype.then=function(t){function e(){for(var t in i)i.hasOwnProperty(t)&&(this[t]=i[t])}var i=this,s=(e.prototype={is:o.prototype.is,toString:o.prototype.toString},new e);return t(s),s}),new o};function $t(t,e){if(t=t||{},Et.call(this,q),e)Et.call(this,[[I,Ct(t[F])],[z,Ct(t[L])],[M,/\?1/.test(t[V])],[C,At(t[G])],[N,At(t[K])],[R,At(t[W])],[_,At(t[P])],[j,Ct(t[U])],[$,At(t[H])]]);else for(var i in t)this.hasOwnProperty(i)&&typeof t[i]!==d&&(this[i]=t[i])}function Ft(t,e,i,a){return this.get=function(t){return t?this.data.hasOwnProperty(t)?this.data[t]:s:this.data},this.set=function(t,e){return this.data[t]=e,this},this.setCH=function(t){return this.uaCH=t,this},this.detectFeature=function(){if(kt&&kt.userAgent==this.ua)switch(this.itemType){case f:kt.brave&&typeof kt.brave.isBrave==c&&this.set(y,"Brave");break;case b:!this.get(k)&&wt&&wt[M]&&this.set(k,M),"Macintosh"==this.get(C)&&kt&&typeof kt.standalone!==d&&kt.maxTouchPoints&&2<kt.maxTouchPoints&&this.set(C,"iPad").set(k,E);break;case m:!this.get(y)&&wt&&wt[N]&&this.set(y,wt[N]);break;case v:var t=this.data,e=function(e){return t[e].getItem().detectFeature().get()};this.set(f,e(f)).set(p,e(p)).set(b,e(b)).set(g,e(g)).set(m,e(m))}return this},this.parseUA=function(){return this.itemType!=v&&St.call(this.data,this.ua,this.rgxMap),this.itemType==f&&this.set(D,Mt(this.get(x))),this},this.parseCH=function(){var t,e=this.uaCH,i=this.rgxMap;switch(this.itemType){case f:case g:var a,n=e[z]||e[I];if(n)for(var o in n){var r=n[o].brand||n[o],o=n[o].version;this.itemType!=f||/not.a.brand/i.test(r)||a&&(!/chrom/i.test(a)||r==ht)||(r=Bt(r,{Chrome:"Google Chrome",Edge:"Microsoft Edge","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"}),this.set(y,r).set(x,o).set(D,Mt(o)),a=r),this.itemType==g&&r==ht&&this.set(x,o)}break;case p:var l=e[_];l&&("64"==e[$]&&(l+="64"),St.call(this.data,l+";",i));break;case b:if(e[M]&&this.set(k,M),e[C]&&(this.set(C,e[C]),this.get(k)&&this.get(w)||(St.call(l={},"droid 9; "+e[C]+")",i),!this.get(k)&&l.type&&this.set(k,l.type),!this.get(w)&&l.vendor&&this.set(w,l.vendor))),e[j]){if("string"!=typeof e[j])for(var c=0;!t&&c<e[j].length;)t=Bt(e[j][c++],jt);else t=Bt(e[j],jt);this.set(k,t)}break;case m:var d,l=e[N];l&&(d=e[R],l==vt&&(d=13<=parseInt(Mt(d),10)?"11":"10"),this.set(y,l).set(x,d)),this.get(y)==vt&&"Xbox"==e[C]&&this.set(y,"Xbox").set(x,s);break;case v:var h=this.data,l=function(t){return h[t].getItem().setCH(e).parseCH().get()};this.set(f,l(f)).set(p,l(p)).set(b,l(b)).set(g,l(g)).set(m,l(m))}return this},Et.call(this,[["itemType",t],["ua",e],["uaCH",a],["rgxMap",i],["data",Rt(this,t)]]),this}function Lt(t,e,i){var a,l,d,y,k;return typeof t===h?(e=_t(t,!0)?(typeof e===h&&(i=e),t):(i=t,s),t=s):typeof t!==u||_t(e,!0)||(i=e,e=s),i&&typeof i.append===c&&(a={},i.forEach((function(t,e){a[e]=t})),i=a),this instanceof Lt?(l=typeof t===u?t:i&&i[o]?i[o]:kt&&kt.userAgent?kt.userAgent:r,d=new $t(i,!0),y=e?((t,e)=>{var i,s={},a=e;if(!_t(e))for(var n in a={},e)for(var o in e[n])a[o]=e[n][o].concat(a[o]||[]);for(i in t)s[i]=a[i]&&a[i].length%2==0?a[i].concat(t[i]):t[i];return s})(zt,e):zt,Et.call(this,[["getBrowser",(k=function(t){return t==v?function(){return new Ft(t,l,y,d).set("ua",l).set(f,this.getBrowser()).set(p,this.getCPU()).set(b,this.getDevice()).set(g,this.getEngine()).set(m,this.getOS()).get()}:function(){return new Ft(t,l,y[t],d).parseUA().get()}})(f)],["getCPU",k(p)],["getDevice",k(b)],["getEngine",k(g)],["getOS",k(m)],["getResult",k(v)],["getUA",function(){return l}],["setUA",function(t){return Dt(t)&&(l=t.length>n?Tt(t,n):t),this}]]).setUA(l),this):new Lt(t,e,i).getResult()}Lt.VERSION="2.0.3",Lt.BROWSER=a([y,x,D,k]),Lt.CPU=a([_]),Lt.DEVICE=a([C,w,k,O,M,Y,E,A,S]),Lt.ENGINE=Lt.OS=a([y,x]),(e=t.exports?t.exports=Lt:e).UAParser=Lt;var Pt,Ht=yt&&(i.jQuery||i.Zepto);Ht&&!Ht.ua&&(Pt=new Lt,Ht.ua=Pt.getResult(),Ht.ua.get=function(){return Pt.getUA()},Ht.ua.set=function(t){Pt.setUA(t);var e,i=Pt.getResult();for(e in i)Ht.ua[e]=i[e]})})("object"==typeof window?window:_t)})(ip,ip.exports);const sp=".sc-ir-user-form-panel-h{--font-family-sans-serif:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;--font-family-monospace:'Quicksand', Georgia, 'Times New Roman', Times, serif !important}.logins-history-section.sc-ir-user-form-panel{margin-top:1.5rem}.sc-ir-user-form-panel-h h4.sc-ir-user-form-panel{font-family:inherit !important}.logins-history-list.sc-ir-user-form-panel{border-radius:8px;list-style-type:none;padding:0;margin:0;margin-top:1rem}.login-entry.sc-ir-user-form-panel{padding:0.25rem 0rem;border-bottom:1px solid #e4e5ec}.login-entry.sc-ir-user-form-panel:last-child{border:none}.login-meta.sc-ir-user-form-panel{display:flex;gap:0.5rem}.login-datetime.sc-ir-user-form-panel,.login-location.sc-ir-user-form-panel{margin:0;font-size:0.75rem;color:#374151;font-weight:500}.login-user-agent.sc-ir-user-form-panel{font-size:0.75rem;color:#6b7280;margin:0;word-break:break-word}.login-user-agent.sc-ir-user-form-panel{font-size:0.75rem;color:#4b5563;margin-top:0.5rem;line-height:1.4}.login-user-agent.sc-ir-user-form-panel p.sc-ir-user-form-panel{margin:0}.ua-browser.sc-ir-user-form-panel{font-weight:600;color:#1f2937}.ua-os.sc-ir-user-form-panel{color:#374151}.ua-device.sc-ir-user-form-panel{font-style:italic;color:#6b7280}.login-location.sc-ir-user-form-panel{font-size:0.75rem;color:#4b5563;display:flex;flex-wrap:wrap;gap:0.25rem;align-items:center}.login-location.sc-ir-user-form-panel span.sc-ir-user-form-panel{display:flex;align-items:center;gap:0.25rem}.login-location.sc-ir-user-form-panel i.sc-ir-user-form-panel{font-size:0.75rem;color:#9ca3af}";const ap=sp;const np=".sc-ir-user-form-panel-h{height:100%}.sheet-container.sc-ir-user-form-panel{display:flex !important;flex-direction:column !important;background:white;height:100vh;gap:1rem;z-index:1000}.sheet-container.sc-ir-user-form-panel{height:-webkit-fill-available;height:100vh;height:100dvh}.sheet-footer.sc-ir-user-form-panel{position:sticky;bottom:0;z-index:20;background:white;border-top:1px solid #e4e5ec;display:flex;flex-direction:column;padding:1rem;gap:0.5rem}.sheet-header.sc-ir-user-form-panel{position:sticky;top:0;z-index:10;background:white}.sheet-body.sc-ir-user-form-panel{flex:1 1 0%}@media (min-width: 768px){.sheet-footer.sc-ir-user-form-panel{flex-direction:row;align-items:center}}";const op=np;const rp=class{constructor(e){t(this,e);this.resetData=s(this,"resetData",7);this.closeSideBar=s(this,"closeSideBar",7);var i,a;this.userTypes=Map;this.isEdit=false;this.language="en";this.superAdminId="5";this.allowedUsersTypes=[];this.isLoading=false;this.autoValidate=false;this.showFullHistory=false;this.userInfo={type:"",id:-1,is_active:true,sign_ins:null,created_on:null,mobile:"",name:"",note:"",password:"",email:"",property_id:null,username:null,phone_prefix:null};this.errors=null;this.showPasswordValidation=false;this.housekeepingService=new mt;this.userService=new ic;this.disableFields=false;this.isPropertyAdmin=false;this.token=new pt;this.mobileMask={};this.userSchema=N.object({mobile:N.string().min(4).max(20),email:N.string().email(),password:N.string().nullable().refine((t=>{var e;if(this.user&&!((e=this.userInfo)===null||e===void 0?void 0:e.password)){return true}return sc.PASSWORD.test(t)}),{message:"Password must be at least 8 characters long."}),type:N.union([N.literal(1),N.literal(Number((a=(i=this.superAdminId)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:"5")),N.coerce.string().nonempty().min(2)]),username:N.string().min(3).refine((async t=>{if(this.user&&this.user.username){return true}if(t.length>=3){return!await(new ic).checkUserExistence({UserName:t})}return true}),{message:"Username already exists."})})}async componentWillLoad(){if(!this.user){this.userInfo["property_id"]=this.property_id}if(this.user){this.autoValidate=true;this.userInfo=Object.assign(Object.assign({},this.user),{password:""})}this.isPropertyAdmin=this.userTypeCode.toString()==="17";if(this.isPropertyAdmin){this.updateUserField("type","17")}this.mobileMask={mask:`{${x.country.phone_prefix}} 000000000000`,lazy:false,autofix:true,placeholderChar:""}}updateUserField(t,e){this.userInfo=Object.assign(Object.assign({},this.userInfo),{[t]:e})}async createOrUpdateUser(){try{this.isLoading=true;this.emailErrorMessage=undefined;if(!this.autoValidate){this.autoValidate=true}const t=Object.assign(Object.assign({},this.userInfo),{base_user_type_code:this.baseUserTypeCode,property_id:this.property_id,password:this.user&&this.userInfo.password===""?this.user.password:this.userInfo.password,type:Number(this.userInfo.type)});console.log("toValidateUserInfo",Object.assign(Object.assign({},t),{mobile:t.mobile.split(" ").join("").replace(x.country.phone_prefix,"")}));await this.userSchema.parseAsync(Object.assign(Object.assign({},t),{mobile:t.mobile.split(" ").join("").replace(x.country.phone_prefix,"")}));if(this.errors){this.errors=null}await this.userService.handleExposedUser(t);this.resetData.emit(null);this.closeSideBar.emit(null)}catch(t){const e={};if(t instanceof R){console.error(t);t.issues.map((t=>{e[t.path[0]]=true}))}else if(t instanceof hd&&t.code==="EMAIL_EXISTS"){e["email"]=true;this.emailErrorMessage="This email is already in use. Please create another one."}this.errors=e}finally{this.isLoading=false}}async handleBlur(t){t.stopImmediatePropagation();t.stopPropagation();if(this.user||!this.userInfo.name){return}const e=await this.housekeepingService.generateUserName(this.userInfo.name);this.updateUserField("username",e)}render(){var t,i,s,n,o,r,l,c,d,h,u,f,p,g,m,v;return e("form",{key:"fc7d9b280c72ae4f41e34121894e90bffb6cc43d",class:"sheet-container",onSubmit:async t=>{t.preventDefault();await this.createOrUpdateUser()}},e("ir-title",{key:"1a7ee7df0d51dad0b84b1cffecb0832900c3d45d",class:"px-1 sheet-header",displayContext:"sidebar",label:this.isEdit?this.user.username:"Create New User"}),e("section",{key:"443ffae8369356df4ab949fdd0adaebbf7399d77",class:"px-1 sheet-body"},e("ir-input-text",{key:"c14556e81389a9c239ad36fbbccff8fbb13ac177",testId:"email",zod:this.userSchema.pick({email:true}),wrapKey:"email",autoValidate:this.autoValidate,error:(t=this.errors)===null||t===void 0?void 0:t.email,label:y.entries.Lcz_Email,placeholder:"",onTextChange:t=>this.updateUserField("email",t.detail),value:this.userInfo.email,onInputBlur:this.handleBlur.bind(this),maxLength:40,errorMessage:this.emailErrorMessage}),e("ir-input-text",{key:"29b0022ca8850bdec67d6732ef82ddb856bf3f5f",testId:"mobile",disabled:this.disableFields,zod:this.userSchema.pick({mobile:true}),wrapKey:"mobile",error:(i=this.errors)===null||i===void 0?void 0:i.mobile,asyncParse:true,autoValidate:this.user?((s=this.userInfo)===null||s===void 0?void 0:s.mobile)!==this.user.mobile?true:false:this.autoValidate,label:y.entries.Lcz_Mobile,mask:this.mobileMask,placeholder:"",value:this.userInfo.mobile,onTextChange:t=>this.updateUserField("mobile",t.detail)}),this.user&&((o=(n=this.user)===null||n===void 0?void 0:n.type)===null||o===void 0?void 0:o.toString())===this.superAdminId||this.isPropertyAdmin?null:e("div",{class:"mb-1"},e("ir-select",{testId:"user_type",error:((r=this.errors)===null||r===void 0?void 0:r.type)&&!this.userInfo.type,disabled:this.disableFields,label:"Role",data:this.allowedUsersTypes.map((t=>({text:t.value,value:t.code}))),firstOption:y.entries.Lcz_Select,selectedValue:(l=this.userInfo.type)===null||l===void 0?void 0:l.toString(),onSelectChange:t=>this.updateUserField("type",t.detail)})),((d=(c=this.user)===null||c===void 0?void 0:c.type)===null||d===void 0?void 0:d.toString())!=="5"&&e(a,{key:"cd6ec7d9eefda3282dac4e1e0cee36d417e46387"},e("input",{key:"61d7f38257e6eed6d66f88c8e22c9796449e5d96",type:"text",name:"dummy",style:{display:"none"}}),e("ir-input-text",{key:"fa0023f3ae676c7584664e7ac17d2d840fb67394",testId:"username",zod:this.userSchema.pick({username:true}),wrapKey:"username",autoValidate:this.autoValidate,error:(h=this.errors)===null||h===void 0?void 0:h.username,label:y.entries.Lcz_Username,disabled:this.disableFields,placeholder:"",onTextChange:t=>this.updateUserField("username",t.detail),value:this.userInfo.username,maxLength:40,autoComplete:"off"})),!this.user?e(a,null,e("input",{type:"text",name:"dummy",style:{display:"none"}}),e("ir-input-text",{testId:"password",autoValidate:this.user?!((u=this.userInfo)===null||u===void 0?void 0:u.password)?false:true:this.autoValidate,label:y.entries.Lcz_Password,value:this.userInfo.password,autoComplete:"off",type:"password",maxLength:16,zod:this.userSchema.pick({password:true}),wrapKey:"password",error:(f=this.errors)===null||f===void 0?void 0:f.password,onInputFocus:()=>this.showPasswordValidation=true,onInputBlur:()=>{},onTextChange:t=>this.updateUserField("password",t.detail)}),this.showPasswordValidation&&e("ir-password-validator",{class:"mb-1",password:this.userInfo.password})):this.haveAdminPrivileges&&this.user.type.toString()!==this.superAdminId&&(((p=this.user)===null||p===void 0?void 0:p.type.toString())==="17"&&((g=this.userTypeCode)===null||g===void 0?void 0:g.toString())==="17"?null:e("div",{class:"d-flex mt-2 align-items-center justify-content-between"},e("h4",{class:"m-0 p-0 logins-history-title"},y.entries.Lcz_Password),e("ir-button",{size:"sm",btn_styles:"pr-0",onClickHandler:()=>this.isOpen=true,text:y.entries.Lcz_ChangePassword,btn_color:"link"}))),((v=(m=this.user)===null||m===void 0?void 0:m.sign_ins)===null||v===void 0?void 0:v.length)>0&&e("section",{key:"d4aaa94aebfa39712b713ac6169cb23384737948",class:"logins-history-section mt-2"},e("div",{key:"c4bc864f17fc84d0982c46faef21cf54d7aab615",class:"d-flex align-items-center logins-history-title-container justify-content-between"},e("h4",{key:"7af1da7c40ea1dbc3ca4b997b7e961ba10165649",class:"logins-history-title m-0 p-0"},"Recent sign-ins"),this.user.sign_ins.length>5&&e("ir-button",{key:"8fa18f01d0bcefe99d2a2a28f254dda3ea2fdbad",btn_styles:"pr-0",text:!this.showFullHistory?y.entries.Lcz_ViewAll:y.entries.Lcz_ViewLess,btn_color:"link",size:"sm",onClickHandler:()=>this.showFullHistory=!this.showFullHistory})),e("ul",{key:"01eac299b50ab2c9408ffce14c9bd0de8e6ec4f9",class:"logins-history-list"},this.user.sign_ins.slice(0,this.showFullHistory?this.user.sign_ins.length:5).map(((t,i)=>{var s,a,n;const o=ip.exports.UAParser(t.user_agent);return e("li",{class:"login-entry",key:t.date+"_"+i},e("div",{class:"login-meta"},e("p",{class:"login-datetime"},D(t.date,"YYYY-MM-DD").format("DD-MMM-YYYY")," ",b((s=t.hour)===null||s===void 0?void 0:s.toString(),(a=t.minute)===null||a===void 0?void 0:a.toString())," |"),e("p",{class:"login-location"},e("span",{class:"login-ip"},y.entries.Lcz_IP,": ",t.ip)," ","|",e("span",{class:"login-country"},y.entries.Lcz_Location,": ",t.country)," ","|",e("span",{class:"login-os"},"OS: ",(n=o.os.name)!==null&&n!==void 0?n:"N/A"," ",o.os.version))))})))),e("ir-sidebar",{key:"db4771ad03acbb9c6529c1481a68f113ee06767f",open:this.isOpen,showCloseButton:false,style:{"--sidebar-block-padding":"0"},onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.isOpen=false}},this.isOpen&&e("ir-reset-password",{key:"d5e84577b7b40b0f04ce24c30ae9ffa8aeff518b",ticket:this.token.getToken(),skip2Fa:true,username:this.user.username,onCloseSideBar:t=>{t.stopImmediatePropagation();t.stopPropagation();this.isOpen=false},slot:"sidebar-body"}))),e("div",{key:"e4bcb7d91d7ea826cd514880ac3a8882db8d0a5e",class:"sheet-footer"},e("ir-button",{key:"febf9629551c58ef44853578c12a515b7236e3ff","data-testid":"cancel",onClickHandler:()=>this.closeSideBar.emit(null),class:"flex-fill",btn_styles:"w-100 justify-content-center align-items-center",btn_color:"secondary",text:y.entries.Lcz_Cancel}),e("ir-button",{key:"eebf59b3c400a4c8e7c55600466bceda0355e265","data-testid":"save",isLoading:this.isLoading,class:"flex-fill",btn_type:"submit",btn_styles:"w-100 justify-content-center align-items-center",text:y.entries.Lcz_Save})))}};rp.style=ap+op;const lp=".sc-ir-user-management-h{display:block;height:100%}";const cp=lp;const dp=class{constructor(e){t(this,e);this.language="";this.isSuperAdmin=true;this.isLoading=true;this.users=[];this.allowedUsersTypes=[];this.token=new pt;this.roomService=new bt;this.userService=new ic;this.bookingService=new l;this.userTypes=new Map;this.superAdminId="5"}componentWillLoad(){if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}if(this.ticket){this.token.setToken(this.ticket);this.initializeApp()}}ticketChanged(t,e){if(t===e){return}this.token.setToken(this.ticket);this.initializeApp()}async handleResetData(t){t.stopImmediatePropagation();t.stopPropagation();await this.fetchUsers()}async initializeApp(){try{if(this.baseUrl){this.token.setBaseUrl(this.baseUrl)}this.isLoading=true;let t=this.propertyid;if(!this.propertyid&&!this.p){throw new Error("Property ID or username is required")}if(!t){console.log(t);const e=await this.roomService.getExposedProperty({id:0,aname:this.p,language:this.language,is_backend:true,include_units_hk_status:true});t=e.My_Result.id}this.property_id=t;const e=[this.fetchUserTypes(),this.fetchUsers(),this.roomService.fetchLanguage(this.language,["_USER_MGT"])];if(this.propertyid){e.push(this.roomService.getExposedProperty({id:this.propertyid,language:this.language,is_backend:true,include_units_hk_status:true}))}await Promise.all(e);this.socket=Zs("https://realtime.igloorooms.com/");this.socket.on("MSG",(async t=>{await this.handleSocketMessage(t)}))}catch(t){console.log(t)}finally{this.isLoading=false}}async handleSocketMessage(t){const e=JSON.parse(t);if(!e){return}const{REASON:i,KEY:s,PAYLOAD:a}=e;if(s.toString()!==this.property_id.toString()){return}let n=JSON.parse(a);console.log(s,n);const o={EMAIL_VERIFIED:this.updateUserVerificationStatus};const r=o[i];if(r){await r.call(this,n)}else{console.warn(`Unhandled REASON: ${i}`)}}updateUserVerificationStatus(t){const e=[...this.users];const i=e.findIndex((e=>e.id===t.id));if(i===-1){console.warn(`User ${t.id} not found`);return}e[i]=Object.assign(Object.assign({},e[i]),{is_email_verified:true});this.users=e}async fetchUsers(){const t=await this.userService.getExposedPropertyUsers({property_id:this.propertyid});this.users=[...t].sort(((t,e)=>{const i=t=>{const e=t.type.toString();if(e===this.superAdminId)return 0;if(e==="17")return 1;return 2};const s=i(t),a=i(e);if(s!==a){return s-a}return t.username.localeCompare(e.username)}))}async fetchUserTypes(){var t,e,i,s;const a=await Promise.all([this.bookingService.getSetupEntriesByTableName("_USER_TYPE"),this.bookingService.getLov()]);const n=(e=(t=a[1])===null||t===void 0?void 0:t.My_Result)===null||e===void 0?void 0:e.allowed_user_types;for(const t of a[0]){const e=t[`CODE_VALUE_${(s=(i=this.language)===null||i===void 0?void 0:i.toUpperCase())!==null&&s!==void 0?s:"EN"}`];if(n.find((e=>e.code===t.CODE_NAME))){this.allowedUsersTypes.push({code:t.CODE_NAME,value:e})}this.userTypes.set(t.CODE_NAME.toString(),e)}}disconnectedCallback(){this.socket.disconnect()}render(){var t,s;if(this.isLoading){return e(i,null,e("ir-toast",null),e("ir-interceptor",null),e("ir-loading-screen",null))}return e(i,null,e("ir-toast",null),e("ir-interceptor",{suppressToastEndpoints:["/Change_User_Pwd","/Handle_Exposed_User"]}),e("section",{class:"p-2 d-flex flex-column",style:{gap:"1rem"}},e("div",{class:"d-flex  pb-2 align-items-center justify-content-between"},e("h3",{class:"mb-1 mb-md-0"},y.entries.Lcz_ExtranetUsers)),e("div",{class:"",style:{gap:"1rem"}},e("ir-user-management-table",{property_id:this.property_id,baseUserTypeCode:this.baseUserTypeCode,allowedUsersTypes:this.allowedUsersTypes,userTypeCode:this.userTypeCode,haveAdminPrivileges:[this.superAdminId,"17"].includes((t=this.userTypeCode)===null||t===void 0?void 0:t.toString()),userTypes:this.userTypes,class:"card",isSuperAdmin:((s=this.userTypeCode)===null||s===void 0?void 0:s.toString())===this.superAdminId,users:this.users}))))}static get watchers(){return{ticket:["ticketChanged"]}}};dp.style=cp;const hp=".sc-ir-user-management-table-h{display:block}.badge.sc-ir-user-management-table{border:none;padding:0.2rem 0.3rem}.badge.sc-ir-user-management-table:disabled{cursor:default}";const up=hp;const fp=".ir-table-row.sc-ir-user-management-table td.sc-ir-user-management-table{padding:0.5rem 1rem !important;text-align:left;z-index:2;background-color:white;white-space:nowrap}.table.sc-ir-user-management-table td.sc-ir-user-management-table{border-top:0;border-bottom:1px solid #e3ebf3;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.table.sc-ir-user-management-table thead.sc-ir-user-management-table th.sc-ir-user-management-table{border:none !important;background:#ececec;color:#374151;padding:0.5rem 1rem !important;text-align:left}.selected.sc-ir-user-management-table td.sc-ir-user-management-table{background:#e3f3fa !important}.selected.sc-ir-user-management-table td.sc-ir-user-management-table{color:var(--gray-dark) !important;transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-user-management-table,.ir-table-row.sc-ir-user-management-table{transition:color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out}.sortable.sc-ir-user-management-table{text-transform:capitalize}.sortable.sc-ir-user-management-table:hover{color:#212529;background-color:#e2e8f0 !important;border-color:#dae0e5;cursor:pointer}.ir-table-row.sc-ir-user-management-table:hover td.sc-ir-user-management-table{background:#e2e6ea3f !important}.sortable.sc-ir-user-management-table:active{color:#212529;background-color:#e2e8f0;border-color:#d3d9df}.sortable.sc-ir-user-management-table svg.sc-ir-user-management-table{color:var(--blue)}";const pp=fp;var bp=undefined&&undefined.__rest||function(t,e){var i={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0)i[s]=t[s];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++){if(e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a]))i[s[a]]=t[s[a]]}return i};const gp=class{constructor(e){t(this,e);this.toast=s(this,"toast",7);this.resetData=s(this,"resetData",7);this.users=[];this.userTypes=new Map;this.superAdminId="5";this.allowedUsersTypes=[];this.currentTrigger=null;this.user=null;this.userService=new ic;this.systemService=new Qd}componentWillLoad(){this.assignPermissions()}handleChange(t,e){if(t!==e){this.assignPermissions()}}assignPermissions(){this.canCreate=this.haveAdminPrivileges;this.canDelete=this.haveAdminPrivileges;this.canEdit=true}async handleUserActiveChange(t,e){t.stopImmediatePropagation();t.stopPropagation();const i=await this.verifyAdminAction({type:"user",mode:"update",user:e});if(i==="cancelled"){return}await this.userService.handleExposedUser({email:e.email,id:e.id,is_active:t.detail,mobile:e.mobile,password:e.password,type:e.type,username:e.username,base_user_type_code:this.baseUserTypeCode,property_id:this.property_id});this.toast.emit({position:"top-right",title:"Saved Successfully",description:"",type:"success"})}async executeUserAction(t){try{t.stopImmediatePropagation();t.stopPropagation();await this.userService.handleExposedUser({email:this.user.email,id:this.user.id,is_active:this.user.is_active,is_email_verified:this.modalType==="verify"?false:this.user.is_email_verified,mobile:this.user.mobile,password:this.user.password,type:this.user.type,username:this.user.username,is_to_remove:this.modalType==="delete"});this.resetData.emit(null)}finally{this.resetModalState();this.modalRef.closeModal()}}renderCurrentTrigger(){var t,i;if(!this.currentTrigger){return null}return e("ir-user-form-panel",{property_id:this.property_id,baseUserTypeCode:this.baseUserTypeCode,superAdminId:this.superAdminId,allowedUsersTypes:this.allowedUsersTypes,userTypeCode:this.userTypeCode,haveAdminPrivileges:this.haveAdminPrivileges,onCloseSideBar:()=>this.currentTrigger=null,slot:"sidebar-body",user:(t=this.currentTrigger)===null||t===void 0?void 0:t.user,isEdit:(i=this.currentTrigger)===null||i===void 0?void 0:i.isEdit})}openModal(t,e){if(!this.modalRef||!t){return}this.user=t;this.modalType=e;this.modalRef.openModal()}maskEmail(t){if(!t||!t.includes("@"))return"";const[e,i]=t.split("@");const s=e.slice(0,1);const a="*".repeat(Math.max(e.length-1,1));return`${s}${a}@${i}`}resetModalState(){this.user=null;this.modalType=null}async verifyAdminAction(t){const e=await this.systemService.checkOTPNecessity({METHOD_NAME:"Handle_Exposed_User"});if(e===null||e===void 0?void 0:e.cancelled){return"cancelled"}const{mode:i}=t,s=bp(t,["mode"]);if(i==="edit"||i==="create"){this.currentTrigger=Object.assign(Object.assign({},s),{isEdit:i==="edit"})}return"ok"}render(){var t,s,a,n,o,r;return e(i,{key:"e42c473bb4d9fa569ca86cbd4ee81c95cbe852f1"},e("section",{key:"87ccd1072f5d936ec722ba071259b6f54ee3e411",class:"table-container h-100 p-1 w-100 m-0 table-responsive"},e("table",{key:"781b2a308640e38c2a68fc8c00a573919f647dfc",class:"table"},e("thead",{key:"84bc2b6e8b6fb8488c449bd9869d755b29cceeaf"},e("tr",{key:"e08c9b28a9b49e68cb7a991393a7825b65aa0352"},e("th",{key:"ab4036af64d650cd798d6613e2fd8a742f6effa5",class:"text-left"},(t=y.entries.Lcz_Username)!==null&&t!==void 0?t:"Username"),e("th",{key:"de00f3e3aed989ead587488891d5b3511e7da5c5",class:"text-left"},y.entries.Lcz_Email),e("th",{key:"2ea6257f333d94103f5fb443ae7808cdc1b68f09",class:"text-left"},(s=y.entries.Lcz_Mobile)!==null&&s!==void 0?s:"Mobile"),e("th",{key:"d85161d890f257d7b99a8b118a4a81d4eae1c6d9",class:"text-left"},y.entries.Lcz_Role),e("th",{key:"d574d75e6a41d779d787df9f4a886d66146f7e07",class:"text-left small",style:{fontWeight:"bold"}},e("p",{key:"c4185d6ec036861b9af742527ac6b47f2dd8eade",class:"m-0 p-0 "},y.entries.Lcz_CreatedAt),e("p",{key:"e098be5b3691c2c85f7e4d176d22a39ee0c95871",class:"m-0 p-0"},y.entries.Lcz_LastSignedIn)),this.haveAdminPrivileges&&e("th",{key:"44cadb859243df112c60ca93ab0ae0f1f219d437"},y.entries.Lcz_Active),e("th",{key:"8460e9dea8535fb7ee55cda883d320ce8148a44f",class:"action-row"},this.canCreate&&e("ir-icon",{key:"70b56b42bccc7128920e3bfcca9324ee1bb705c0",style:{paddingLeft:"0.875rem"},"data-testid":"new_user",title:y.entries.Lcz_CreateUser,onIconClickHandler:()=>{this.verifyAdminAction({type:"user",mode:"create",user:null})}},e("svg",{key:"9200f402b6ad1b77f50ca17e69a8c26bc2b6a1a4",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},e("path",{key:"93c4c3cb065c527b7a3dc5de5eed422c0cf47f04",fill:"currentColor",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),e("tbody",{key:"2d3dc883a6aaa13f60627906bffa043d93703504"},this.users.map((t=>{var i;const s=t.type.toString()===this.superAdminId;const a=t.sign_ins?t.sign_ins[0]:null;const n=a?D(a.date,"YYYY-MM-DD"):null;const o=n?D().diff(n,"days")>30:false;return e("tr",{key:t.id,class:"ir-table-row"},e("td",null,t.username),e("td",null,t.email,this.haveAdminPrivileges&&e("span",{style:{marginLeft:"0.5rem"},class:`small ${t.is_email_verified?"text-success":"text-danger"}`},t.is_email_verified?y.entries.Lcz_Verified:y.entries.Lcz_NotVerified)),e("td",null,(i=t.mobile)!==null&&i!==void 0?i:"N/A"),e("td",null,t.type.toString()===this.superAdminId?y.entries.Lcz_SuperAdmin:this.userTypes.get(t.type.toString())),e("td",{class:"small"},e("p",{class:"m-0 p-0"},new Date(t.created_on).getFullYear()===1900||!t.created_on?"N/A":D(t.created_on,"YYYY-MM-DD").format("DD-MMM-YYYY")),e("p",{class:`m-0 p-0 ${o?"text-danger":""}`},a&&new Date(a.date).getFullYear()>1900?D(a.date,"YYYY-MM-DD").format("DD-MMM-YYYY")+" "+b(a.hour.toString(),a.minute.toString()):"N/A")),this.haveAdminPrivileges&&e("td",null,this.haveAdminPrivileges&&!this.isSuperAdmin&&t.type.toString()==="17"?null:!s&&e("ir-switch",{onCheckChange:e=>this.handleUserActiveChange(e,t),checked:t.is_active})),e("td",{class:"action-row"},(this.canEdit||this.canDelete)&&(!this.isSuperAdmin&&!s||this.isSuperAdmin)&&e("div",{class:"icons-container  d-flex align-items-center",style:{gap:"0.5rem"}},this.canEdit&&e("ir-icon",{"data-testid":"edit",title:y.entries.Lcz_EditUser,onIconClickHandler:()=>{this.verifyAdminAction({type:"user",mode:"edit",user:t})},icon:"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right"},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},e("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),this.canDelete&&!s&&(this.isSuperAdmin||t.type.toString()!=="17")&&e("ir-icon",{"data-testid":"delete",title:y.entries.Lcz_DeleteUser,icon:"ft-trash-2 danger h5 pointer",onIconClickHandler:async()=>{const e=await this.verifyAdminAction({type:"user",mode:"delete",user:t});if(e==="cancelled"){return}this.openModal(t,"delete")}},e("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},e("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))))}))))),e("ir-sidebar",{key:"ca930a5b6b0cc8b165190d84140ca28deba16ef9",open:this.currentTrigger!==null&&((a=this.currentTrigger)===null||a===void 0?void 0:a.type)!=="delete",onIrSidebarToggle:()=>this.currentTrigger=null,showCloseButton:false,style:{"--sidebar-block-padding":"0","--sidebar-width":this.currentTrigger?((n=this.currentTrigger)===null||n===void 0?void 0:n.type)==="unassigned_units"?"max-content":"40rem":"max-content"}},this.renderCurrentTrigger()),e("ir-modal",{key:"2c05ab9df2ccdf34ee096e78249a19712caf31e8",autoClose:false,modalBody:this.modalType==="delete"?`${y.entries.Lcz_AreYouSureToDelete} ${(o=this.user)===null||o===void 0?void 0:o.username}?`:`${y.entries.Lcz_AreYouSureToUnverify} ${this.maskEmail((r=this.user)===null||r===void 0?void 0:r.email)}`,rightBtnColor:"danger",isLoading:ut("/Handle_Exposed_User"),onCancelModal:this.resetModalState.bind(this),rightBtnText:this.modalType==="verify"?y.entries.Lcz_Confirm:y.entries.Lcz_Delete,onConfirmModal:this.executeUserAction.bind(this),ref:t=>this.modalRef=t}))}static get watchers(){return{haveAdminPrivileges:["handleChange"]}}};gp.style=up+pp;const mp=".sc-ir-weekday-selector-h{display:block}.days-checkbox.sc-ir-weekday-selector{gap:0.5rem}";const vp=mp;const yp=class{constructor(e){t(this,e);this.weekdayChange=s(this,"weekdayChange",7);this.weekdays=[];this.selectedWeekdays=new Set(this.weekdays);this._weekdays=[{value:1,label:"M"},{value:2,label:"T"},{value:3,label:"W"},{value:4,label:"Th"},{value:5,label:"Fr"},{value:6,label:"Sa"},{value:0,label:"Su"}]}handleWeekdayChange(t,e){if(t.length!==e.length&&t.length!==this.selectedWeekdays.size){this.selectedWeekdays=new Set(t)}}toggleWeekDays({checked:t,weekDay:e}){const i=new Set(this.selectedWeekdays);if(t){if(!this.selectedWeekdays.has(e)){i.add(e);this.selectedWeekdays=new Set(i)}}else{i.delete(e);this.selectedWeekdays=new Set(i)}this.weekdayChange.emit(Array.from(this.selectedWeekdays))}render(){return e(i,{key:"bb97bb631f11db16fefb3c9c07b6ffecda3237f5",class:"my-1 d-flex align-items-center",style:{gap:"1.1rem"}},this._weekdays.map((t=>e("ir-checkbox",{checked:this.selectedWeekdays.has(t.value),onCheckChange:e=>this.toggleWeekDays({checked:e.detail,weekDay:t.value}),label:t.label,labelClass:"m-0 p-0",class:"days-checkbox"}))))}static get watchers(){return{weekdays:["handleWeekdayChange"]}}};yp.style=vp;const kp="*.sc-ota-label{margin:0;padding:0}.sc-ota-label-h{display:flex;margin-bottom:5px;gap:5px}.label_title.sc-ota-label{min-width:max-content;padding:0;margin:0;font-weight:600}.ota-message-list.sc-ota-label{margin:0 3px;padding:0;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important}.ota-message-item.sc-ota-label{width:100%;line-height:1.5;margin:0;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important}.ota-message-item.sc-ota-label::before{content:'- ';margin-right:0.25rem}.ota-visibility-toggle.sc-ota-label{background:white;color:var(--blue);padding:0;margin:0;margin-left:3px;font-size:12px;border:0}.ota-visibility-toggle.sc-ota-label:hover{color:#355270}.ota-message-list.sc-ota-label{margin:0 3px;padding:0;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important;white-space:normal;list-style:none}.ota-message-item.sc-ota-label{width:100%;line-height:1.5;margin:0 0 0 1.2em;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important;white-space:normal;position:relative}";const wp=kp;const xp=class{constructor(e){t(this,e);this.maxVisibleItems=3;this.showAll=false;this.toggleShowAll=()=>{this.showAll=!this.showAll}}render(){if(!this.remarks){return null}const t=this.showAll?this.remarks:this.remarks.slice(0,this.maxVisibleItems);return e(i,null,e("p",{class:"label_title"},this.label),e("ul",{class:"ota-message-list"},t.map(((i,s)=>e("li",{key:ht(),class:"ota-message-item"},i.statement," ",this.remarks.length>this.maxVisibleItems&&s===t.length-1&&e("button",{class:"ota-visibility-toggle",onClick:this.toggleShowAll},this.showAll?y.entries.Lcz_ShowLess:y.entries.Lcz_ShowMore))))))}};xp.style=wp;const _p=".sc-requirement-check-h{display:block;font-size:0.875rem}.valid.sc-requirement-check{color:var(--green, #28d094)}.requirement.sc-requirement-check{display:flex;align-items:center;gap:0.5rem}";const Dp=_p;const Cp=class{constructor(e){t(this,e);this.isValid=false;this.text=""}render(){return e("div",{key:"48a3fd1f0dc3c4e9b908b365d09b44035cf13acb",class:{requirement:true,valid:this.isValid}},e("ir-icons",{key:"7d1bdf50b712d4d9f14cd34ba661ebeef86b4728",style:{"--icon-size":"0.875rem"},name:this.isValid?"check":"xmark"}),e("span",{key:"4e69b294cbfc721e95c09477dadf4dfa18a26e4d"},this.text))}};Cp.style=Dp;export{Mt as igl_application_info,At as igl_block_dates_view,Nt as igl_book_property,Ft as igl_book_property_container,Ht as igl_book_property_footer,Gt as igl_book_property_header,Jt as igl_booking_event,te as igl_booking_event_hover,se as igl_booking_form,oe as igl_booking_overview_page,ue as igl_bulk_block,me as igl_bulk_operations,xe as igl_bulk_stop_sale,Ce as igl_cal_body,Ee as igl_cal_footer,$e as igl_cal_header,Pe as igl_date_range,Ve as igl_legends,We as igl_property_booked_by,Je as igl_rate_plan,ti as igl_room_type,si as igl_tba_booking_view,oi as igl_tba_category_view,ci as igl_to_be_assigned,aa as igloo_calendar,la as ir_accordion,ha as ir_autocomplete,ba as ir_booking_details,va as ir_booking_email_logs,_a as ir_booking_extra_note,Oa as ir_booking_guarantee,Ya as ir_booking_header,Fa as ir_booking_listing,Ha as ir_button,Ga as ir_checkbox,qa as ir_combobox,Ja as ir_common,tn as ir_country_picker,nn as ir_daily_revenue,ln as ir_daily_revenue_filters,_r as ir_date_picker,Or as ir_date_range,Yr as ir_date_view,Br as ir_delete_modal,zr as ir_dialog,$r as ir_dropdown,Pr as ir_dropdown_item,Vr as ir_events_log,Wr as ir_extra_service,sl as ir_extra_service_config,ol as ir_extra_services,hl as ir_guest_info,pl as ir_hk_archive,Hl as ir_hk_tasks,ql as ir_hk_team,tc as ir_hk_unassigned_units,lc as ir_hk_user,hc as ir_housekeeping,pc as ir_icon,mc as ir_icons,rd as ir_input_text,dd as ir_interactive_title,pd as ir_interceptor,md as ir_label,kd as ir_listing_header,_d as ir_listing_modal,Od as ir_loading_screen,Ad as ir_login,Bd as ir_m_combobox,zd as ir_modal,Fd as ir_monthly_bookings_report,Hd as ir_monthly_bookings_report_filter,Wd as ir_monthly_bookings_report_table,Jd as ir_otp,eh as ir_otp_modal,ah as ir_pagination,rh as ir_password_validator,dh as ir_payment_action,fh as ir_payment_actions,gh as ir_payment_details,xh as ir_payment_folio,Ch as ir_payment_item,Eh as ir_payment_summary,Th as ir_payments_folio,Ih as ir_phone_input,Fh as ir_pickup,Hh as ir_pickup_view,Gh as ir_pms_logs,qh as ir_popover,Qh as ir_price_input,eu as ir_progress_indicator,au as ir_radio,ru as ir_range_picker,du as ir_reservation_information,bu as ir_reset_password,yu as ir_revenue_row,xu as ir_revenue_row_details,Cu as ir_revenue_summary,Eu as ir_revenue_table,Tu as ir_room,Ru as ir_room_guests,Hu as ir_room_nights,Ku as ir_sales_by_country,Xu as ir_sales_by_country_summary,Zu as ir_sales_filters,nf as ir_sales_table,lf as ir_secure_tasks,hf as ir_select,pf as ir_sidebar,mf as ir_spinner,kf as ir_stats_card,_f as ir_switch,Of as ir_tabs,Yf as ir_tasks_card,Sf as ir_tasks_filters,jf as ir_tasks_header,Ff as ir_tasks_table,Hf as ir_tasks_table_pagination,Gf as ir_textarea,qf as ir_title,Qf as ir_toast,ep as ir_tooltip,rp as ir_user_form_panel,dp as ir_user_management,gp as ir_user_management_table,yp as ir_weekday_selector,xp as ota_label,Cp as requirement_check};
//# sourceMappingURL=p-8c7ad1de.entry.js.map