{"version":3,"names":["iglBookingEventHoverCss","IglBookingEventHoverStyle0","IglBookingEventHover","bookingEvent","bubbleInfoTop","currency","countries","is_vacation_rental","isLoading","shouldHideUnassignUnit","canCheckInOrCheckout","bookingColor","showBookingPopup","hideBubbleInfo","deleteButton","bookingCreated","showDialog","openCalendarSidebar","eventService","EventsService","hideButtons","propertyService","PropertyService","baseColor","componentWillLoad","selectedRt","this","roomsInfo","find","r","id","RATE_TYPE","physicalrooms","length","moment","TO_DATE","isBefore","getEventLegend","color","ROOM_INFO","calendar_extra","booking_color","isSameOrAfter","Date","FROM_DATE","handleBookingEventChange","newValue","oldValue","handleListenKeyDown","e","key","stopPropagation","hideBubble","status","legendData","statusId","STATUS","getBookingId","ID","emit","currentInfoBubbleId","getTotalOccupants","CHILDREN_COUNT","ADULTS_COUNT","locales","entries","Lcz_AdultsCaption","toLowerCase","Lcz_Single_Adult","Lcz_ChildCaption","Lcz_Single_Child","getPhoneNumber","PHONE","getCountry","findCountry","COUNTRY","name","getPhoneCode","PHONE_PREFIX","phone_prefix","renderPhone","is_direct","getInternalNote","INTERNAL_NOTE","getTotalPrice","TOTAL_PRICE","getArrivalTime","ARRIVAL_TIME","getRatePlan","currentRoom","booking","rooms","room","assigned_units_pool","console","warn","str","rateplan","Lcz_NonRefundable","getEntryDate","ENTRY_DATE","isNewBooking","isCheckedIn","isBlockedDateEvent","hasSplitBooking","hasOwnProperty","splitBookingEvents","canCheckIn","from_date","to_date","canCheckOut","calendar_data","checkin_enabled","is_automatic_check_in_out","now","in_out","code","compareTime","toDate","createDateWithOffsetAndHour","checkin_checkout_hours","offset","hour","handleBlockDateUpdate","event","stopImmediatePropagation","opt","detail","data","handleEditBooking","TITLE","Lcz_EditBookingFor","handleBookingOption","getStringDateFormat","dt","getFullYear","getMonth","getDate","handleAddRoom","fromDate","setHours","from_date_str","to_date_str","eventData","NAME","BOOKING_NUMBER","ARRIVAL","ADD_ROOM_TO_BOOKING","event_type","ROOMS","GUEST","message","NOTES","SOURCE","base_booking","defaultDateRange","fromDateStr","toDateStr","dateDifference","editabled","handleCustomerCheckIn","adult_nbr","children_nbr","infant_nbr","occupancy","reason","bookingNumber","roomIdentifier","IDENTIFIER","roomName","roomUnit","sidebarPayload","identifier","checkin","unit","sharing_persons","totalGuests","handleCustomerCheckOut","handleDeleteEvent","POOL","log","handleUpdateBlockedDates","setTimeout","updateBlockedEvent","error","handleConvertBlockedDateToBooking","getRoomInfo","roomIdToFind","PR_ID","selectedRoom","physicalRoom","CATEGORY","ROOM_NAME","ROOMS_INFO","renderTitle","eventType","roomInfo","Lcz_AddingUnitToBooking","Lcz_Adding","Lcz_NewBookingFor","roomData","includes","STATUS_CODE","RELEASE_AFTER_HOURS","OPTIONAL_REASON","ENTRY_MINUTE","ENTRY_HOUR","block_exposed_unit_props","pr_id","STAY_STATUS_CODE","DESCRIPTION","BLOCKED_TILL_DATE","BLOCKED_TILL_HOUR","BLOCKED_TILL_MINUTE","getOTANotes","maxVisible","ota_notes","channel_notes","separator","statement","slice","map","o","join","canSplitBooking","fromStr","defaultDates","toStr","MFromDate","startOf","MToDate","isValid","nights","diff","today","getInfoElement","h","class","BALANCE","style","flex","src","origin","Icon","alt","Label","channel_booking_nbr","gap","caret","onOptionChange","async","newBookingColor","property","booking_colors","c","setRoomCalendarExtra","property_id","room_identifier","value","JSON","stringify","width","slot","height","background","borderRadius","padding","s","formatAmount","symbol","Lcz_Balance","showDateDifference","containerStyle","margin","labelText","content","Lcz_ArrivalTime","Lcz_Occupancy","Lcz_Phone","Lcz_RatePlan","DEPARTURE_TIME","description","PRIVATE_NOTE","Lcz_BookingPrivateNote","display","Lcz_GuestRemark","Lcz_ChannelNotes","renderContentAsHtml","Lcz_InternalRemark","role","onClickHandler","btn_block","text","Lcz_Edit","btn_styles","size","IS_EDITABLE","Lcz_AddRoom","handleSplitBooking","Lcz_CheckIn","Lcz_CheckOut","Lcz_Unassign","_","type","payload","getNewBookingOptions","shouldDisplayButtons","rateplans","some","rate","is_active","Fragment","Lcz_CreateNewBooking","Lcz_AssignUnitToExistingBooking","Lcz_NoRatePlanDefined","Lcz_Blockdates","getBlockedView","isEventHover","entryHour","entryMinute","defaultData","entryDate","onDataUpdateEvent","btn_disabled","Lcz_Update","icon_name","Lcz_ConvertSplitBooking","btn_color","Lcz_Delete","render","Host","irDropdownCss","IrDropdownStyle0","IrDropdown","disabled","isOpen","selectedOption","focusedIndex","itemChildren","mo","documentClickHandler","isComponentConnected","updateQueued","optionChange","handleDocumentClick","bind","collectItemChildren","MutationObserver","requestAnimationFrame","observe","el","childList","subtree","componentDidLoad","document","addEventListener","passive","updateItemElements","updateDropdownItemValue","disconnectedCallback","removeEventListener","disconnect","handleDocumentKeyDown","closeDropdown","handleDropdownItemSelect","ev","selectOption","target","setAttribute","handleDropdownItemRegister","handleDropdownItemUnregister","handleValueChange","forEach","removeAttribute","getSelectedItemIndex","findIndex","item","openDropdown","scrollToSelectedItem","removeItemFocus","contains","items","Array","from","querySelectorAll","index","String","element","classList","remove","focusItemElement","add","scrollIntoView","block","behavior","selectItemElement","click","selectedElement","inline","handleKeyDown","maxIndex","preventDefault","option","onClick","onKeyDown","tabindex","toString","irDropdownItemCss","IrDropdownItemStyle0","IrDropdownItem","hasRegistered","label","html_content","hidden","dropdownItemSelect","dropdownItemRegister","dropdownItemUnregister","parentElement","parentDropdown","closest","matchesQuery","query","q","hay","textContent","setHidden","next","handleClick","innerHTML"],"sources":["src/components/igloo-calendar/igl-booking-event-hover/igl-booking-event-hover.css?tag=igl-booking-event-hover&encapsulation=scoped","src/components/igloo-calendar/igl-booking-event-hover/igl-booking-event-hover.tsx","src/components/ui/ir-dropdown/ir-dropdown.css?tag=ir-dropdown&encapsulation=scoped","src/components/ui/ir-dropdown/ir-dropdown.tsx","src/components/ui/ir-dropdown-item/ir-dropdown-item.css?tag=ir-dropdown-item&encapsulation=scoped","src/components/ui/ir-dropdown-item/ir-dropdown-item.tsx"],"sourcesContent":[":host {\n  display: block;\n  position: relative;\n  z-index: 100;\n}\n\n.btn {\n  padding-left: 4px !important;\n  padding-right: 4px !important;\n}\n.balance_amount {\n  color: #ff4961;\n  font-size: 0.75rem;\n}\n.user-notes {\n  margin-left: 4px;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 5;\n  line-clamp: 5;\n  overflow: hidden;\n  max-width: 100%;\n  height: auto;\n}\n.booking-event-hover__color-picker-trigger {\n  all: unset;\n  border: 1px solid #e0e0e0;\n  padding: 0.25rem 0.25rem;\n  border-radius: 0.21rem;\n  cursor: pointer;\n}\n.events_btns {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n}\n.mx-01 {\n  --m: 5px;\n  margin-left: var(--m) !important;\n  margin-right: var(--m) !important;\n}\n\n.pointerContainerTop {\n  top: -26px;\n}\n\n.pointerContainer {\n  position: absolute;\n  height: 10px;\n  width: 350px;\n  left: var(--el-left, 50%);\n  transform: translateX(-50%);\n}\n.ota-notes {\n  width: 450px;\n}\n\n.iglPopOver {\n  /* max-width: 350px; */\n  position: absolute;\n  background-color: var(--wa-color-surface-default);\n  padding: 10px;\n  border: 1px solid var(--wa-color-surface-border);\n  border-radius: 6px;\n  left: var(--el-left, 50%);\n  transform: translateX(-50%) translateY(10px);\n  box-shadow: 1px 0px 20px rgba(0, 0, 0, 0.2);\n  /* font-size: var(--wa-font-size-m);\n  line-height: var(--wa-line-height-normal);\n  text-align: start;\n  white-space: normal;\n  background-color: var(--wa-color-surface-default);\n  border-top: none;\n  border-left: none;\n  border-bottom: solid var(--wa-panel-border-width) var(--wa-color-surface-border);\n  border-right: solid var(--wa-panel-border-width) var(--wa-color-surface-border);\n  box-shadow: none; */\n  /* transform-origin: bottom; */\n  /* display: flex;\n  flex-direction: column; */\n  padding: var(--wa-space-l);\n  background-color: var(--wa-color-surface-default);\n  border: 1px solid var(--wa-color-surface-border);\n  border-radius: var(--wa-panel-border-radius);\n  border-style: var(--wa-panel-border-style);\n  box-shadow: var(--wa-shadow-l);\n  color: var(--wa-color-text-normal);\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.iglPopOver.infoBubble {\n  min-width: 350px;\n}\n\n.iglPopOver.blockedView {\n  max-width: 400px;\n  width: 400px;\n}\n\n.iglPopOver.newBookingOptions {\n  overflow-wrap: break-word !important;\n  min-width: 230px;\n  width: fit-content;\n}\n\n.bubblePointer {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 50%;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  transform: translate(-50%, 0px);\n  box-shadow: var(--wa-shadow-l);\n}\n\n.bubblePointTop {\n  border-top: 10px solid var(--wa-color-surface-default);\n}\n\n.bubblePointBottom {\n  border-bottom: 10px solid var(--wa-color-surface-default);\n}\n\n.bubbleInfoAbove {\n  bottom: 35px;\n}\n\n.updateBtnIcon {\n  margin-right: 4px;\n}\n.icon-image {\n  height: 1.5rem;\n  width: 1.5rem;\n  margin-right: 5px;\n}\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Element, Fragment, Watch, Listen } from '@stencil/core';\nimport { canCheckIn, findCountry, formatAmount } from '@/utils/utils';\nimport { ICountry } from '@/models/IBooking';\nimport { EventsService } from '@/services/events.service';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport calendar_data from '@/stores/calendar-data';\nimport { CalendarModalEvent } from '@/models/property-types';\nimport { compareTime, createDateWithOffsetAndHour } from '@/utils/booking';\nimport { BookingColor, IOtaNotes } from '@/models/booking.dto';\nimport { PropertyService } from '@/services/property.service';\nimport { CalendarSidebarState } from '../igloo-calendar';\n//import { transformNewBLockedRooms } from '../../../utils/booking';\n\n@Component({\n  tag: 'igl-booking-event-hover',\n  styleUrl: 'igl-booking-event-hover.css',\n  scoped: true,\n})\nexport class IglBookingEventHover {\n  @Element() element: HTMLIglBookingEventHoverElement;\n\n  @Prop({ mutable: true }) bookingEvent: { [key: string]: any };\n  @Prop() bubbleInfoTop: boolean = false;\n  @Prop() currency;\n  @Prop() countries: ICountry[];\n  @Prop() is_vacation_rental: boolean = false;\n\n  @State() isLoading: string;\n  @State() shouldHideUnassignUnit = false;\n  @State() canCheckInOrCheckout: boolean;\n  @State() bookingColor: BookingColor | null = null;\n\n  @Event() showBookingPopup: EventEmitter;\n  @Event({ bubbles: true, composed: true }) hideBubbleInfo: EventEmitter;\n  @Event({ bubbles: true, composed: true }) deleteButton: EventEmitter<string>;\n  @Event() bookingCreated: EventEmitter<{ pool?: string; data: any[] }>;\n  @Event() showDialog: EventEmitter<CalendarModalEvent>;\n  @Event() openCalendarSidebar: EventEmitter<CalendarSidebarState>;\n\n  private eventService = new EventsService();\n  private hideButtons = false;\n  private propertyService = new PropertyService();\n  private baseColor: string;\n\n  componentWillLoad() {\n    let selectedRt = this.bookingEvent.roomsInfo.find(r => r.id === this.bookingEvent.RATE_TYPE);\n    if (selectedRt) {\n      this.shouldHideUnassignUnit = selectedRt.physicalrooms.length === 1;\n    }\n    if (moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD').isBefore(moment())) {\n      this.hideButtons = true;\n    }\n    this.baseColor = this.getEventLegend().color;\n    this.bookingColor = this.bookingEvent.ROOM_INFO?.calendar_extra ? this.bookingEvent.ROOM_INFO?.calendar_extra?.booking_color : null;\n    this.canCheckInOrCheckout = moment().isSameOrAfter(new Date(this.bookingEvent.FROM_DATE), 'days') && moment().isBefore(new Date(this.bookingEvent.TO_DATE), 'days');\n  }\n\n  @Watch('bookingEvent')\n  handleBookingEventChange(newValue, oldValue) {\n    if (newValue !== oldValue)\n      this.canCheckInOrCheckout =\n        moment(new Date()).isSameOrAfter(new Date(this.bookingEvent.FROM_DATE), 'days') && moment(new Date()).isBefore(new Date(this.bookingEvent.TO_DATE), 'days');\n  }\n\n  @Listen('keydown', { target: 'body' })\n  handleListenKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      this.hideBubble();\n    } else return;\n  }\n\n  private getEventLegend() {\n    let status = this.bookingEvent?.legendData.statusId[this.bookingEvent.STATUS];\n    return {\n      ...this.bookingEvent?.legendData[status.id],\n      ...status,\n    };\n  }\n\n  private getBookingId() {\n    return this.bookingEvent.ID;\n  }\n\n  private hideBubble() {\n    this.hideBubbleInfo.emit({\n      key: 'hidebubble',\n      currentInfoBubbleId: this.getBookingId(),\n    });\n  }\n\n  private getTotalOccupants() {\n    const { CHILDREN_COUNT, ADULTS_COUNT } = this.bookingEvent;\n    if (CHILDREN_COUNT === 0) {\n      return `${ADULTS_COUNT} ${ADULTS_COUNT > 1 ? locales.entries.Lcz_AdultsCaption.toLowerCase() : locales.entries.Lcz_Single_Adult?.toLowerCase()}`;\n    }\n    return `${ADULTS_COUNT} ${ADULTS_COUNT > 1 ? locales.entries.Lcz_AdultsCaption.toLowerCase() : locales.entries.Lcz_Single_Adult?.toLowerCase()}, ${CHILDREN_COUNT} ${\n      CHILDREN_COUNT > 1 ? locales.entries.Lcz_ChildCaption.toLowerCase() : locales.entries.Lcz_Single_Child?.toLowerCase()\n    }`;\n  }\n\n  private getPhoneNumber() {\n    return this.bookingEvent.PHONE;\n  }\n\n  private getCountry() {\n    return findCountry(this.bookingEvent.COUNTRY, this.countries).name;\n  }\n\n  private getPhoneCode() {\n    if (this.bookingEvent.PHONE_PREFIX) {\n      return this.bookingEvent.PHONE_PREFIX;\n    }\n    return findCountry(this.bookingEvent.COUNTRY, this.countries).phone_prefix;\n  }\n\n  private renderPhone() {\n    return this.bookingEvent.COUNTRY ? `${this.bookingEvent.is_direct ? this.getPhoneCode() + '-' : ''}${this.getPhoneNumber()} - ${this.getCountry()}` : this.getPhoneNumber();\n  }\n\n  private getInternalNote() {\n    return this.bookingEvent.INTERNAL_NOTE;\n  }\n\n  private getTotalPrice() {\n    return this.bookingEvent.TOTAL_PRICE;\n  }\n\n  private getArrivalTime() {\n    return this.bookingEvent.ARRIVAL_TIME;\n  }\n\n  private getRatePlan() {\n    if (!this.bookingEvent) {\n      return;\n    }\n    const currentRoom = this.bookingEvent?.booking?.rooms?.find(room => room.assigned_units_pool === this.bookingEvent.ID);\n    if (!currentRoom) {\n      console.warn(`Couldn't find room with pool ${this.bookingEvent.ID}`);\n      return null;\n    }\n    let str = '';\n    str += currentRoom.rateplan['short_name'];\n    if (currentRoom.rateplan['is_non_refundable']) {\n      str += ` - ${locales.entries.Lcz_NonRefundable}`;\n    }\n    return str;\n  }\n\n  private getEntryDate() {\n    return this.bookingEvent.ENTRY_DATE;\n  }\n\n  private isNewBooking() {\n    return this.getBookingId() === 'NEW_TEMP_EVENT';\n  }\n\n  private isCheckedIn() {\n    return this.bookingEvent.STATUS === 'IN-HOUSE';\n  }\n\n  private isBlockedDateEvent() {\n    return this.bookingEvent.STATUS === 'BLOCKED' || this.bookingEvent.STATUS === 'BLOCKED-WITH-DATES';\n  }\n\n  private hasSplitBooking() {\n    return this.bookingEvent.hasOwnProperty('splitBookingEvents') && this.bookingEvent.splitBookingEvents;\n  }\n\n  private canCheckIn() {\n    return canCheckIn({\n      from_date: this.bookingEvent.FROM_DATE,\n      to_date: this.bookingEvent.TO_DATE,\n      isCheckedIn: this.isCheckedIn(),\n    });\n  }\n\n  private canCheckOut() {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    if (this.isCheckedIn()) {\n      return true;\n    }\n    const now = moment();\n    if (\n      this.bookingEvent.ROOM_INFO?.in_out?.code === '000' &&\n      moment().isSameOrAfter(new Date(this.bookingEvent.TO_DATE), 'days') &&\n      compareTime(now.toDate(), createDateWithOffsetAndHour(calendar_data.checkin_checkout_hours?.offset, calendar_data.checkin_checkout_hours?.hour))\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.bookingEvent = { ...this.bookingEvent, ...opt.data };\n  }\n\n  private handleEditBooking() {\n    this.bookingEvent.TITLE = locales.entries.Lcz_EditBookingFor;\n    this.handleBookingOption('EDIT_BOOKING');\n  }\n\n  private getStringDateFormat(dt) {\n    return dt.getFullYear() + '-' + (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1) + '-' + (dt.getDate() <= 9 ? '0' : '') + dt.getDate();\n  }\n\n  private handleAddRoom() {\n    let fromDate = new Date(this.bookingEvent.FROM_DATE);\n    fromDate.setHours(0, 0, 0, 0);\n    let from_date_str = this.getStringDateFormat(fromDate);\n\n    let toDate = new Date(this.bookingEvent.TO_DATE);\n    //toDate.setDate(toDate.getDate() + 1);\n    toDate.setHours(0, 0, 0, 0);\n    let to_date_str = this.getStringDateFormat(toDate);\n    let eventData = {\n      ID: '',\n      NAME: '',\n      BOOKING_NUMBER: this.bookingEvent.BOOKING_NUMBER,\n      FROM_DATE: from_date_str, // \"2023-07-09\",\n      TO_DATE: to_date_str, // \"2023-07-11\",\n      roomsInfo: this.bookingEvent.roomsInfo,\n      ARRIVAL: this.bookingEvent.ARRIVAL,\n      ADD_ROOM_TO_BOOKING: this.bookingEvent.ID,\n      TITLE: 'Add Room to #' + this.bookingEvent.BOOKING_NUMBER,\n      event_type: 'ADD_ROOM',\n      ROOMS: this.bookingEvent.ROOMS,\n      GUEST: this.bookingEvent.GUEST,\n      message: this.bookingEvent.NOTES,\n      SOURCE: this.bookingEvent.SOURCE,\n      booking: this.bookingEvent?.base_booking,\n      defaultDateRange: {\n        fromDate: fromDate,\n        fromDateStr: '',\n        toDate: toDate,\n        toDateStr: '',\n        dateDifference: 0,\n        editabled: true,\n        message: 'Including 5.00% City Tax - Excluding 11.00% VAT',\n      },\n    };\n\n    this.handleBookingOption('ADD_ROOM', eventData);\n  }\n\n  private handleCustomerCheckIn() {\n    const { adult_nbr, children_nbr, infant_nbr } = this.bookingEvent.ROOM_INFO.occupancy;\n    this.showDialog.emit({\n      reason: 'checkin',\n      bookingNumber: this.bookingEvent.BOOKING_NUMBER,\n      roomIdentifier: this.bookingEvent.IDENTIFIER,\n      roomName: '',\n      roomUnit: '',\n      sidebarPayload: {\n        identifier: this.bookingEvent.IDENTIFIER,\n        bookingNumber: this.bookingEvent.BOOKING_NUMBER,\n        checkin: false,\n        roomName: this.bookingEvent.ROOM_INFO.unit?.name ?? '',\n        sharing_persons: this.bookingEvent.ROOM_INFO.sharing_persons,\n        totalGuests: adult_nbr + children_nbr + infant_nbr,\n      },\n    });\n  }\n\n  private handleCustomerCheckOut() {\n    this.showDialog.emit({ reason: 'checkout', bookingNumber: this.bookingEvent.BOOKING_NUMBER, roomIdentifier: this.bookingEvent.IDENTIFIER, roomName: '', roomUnit: '' });\n  }\n\n  private handleDeleteEvent() {\n    this.hideBubble();\n    this.deleteButton.emit(this.bookingEvent.POOL);\n    console.log('Delete Event');\n  }\n\n  private async handleUpdateBlockedDates() {\n    try {\n      this.isLoading = 'update';\n      setTimeout(() => {\n        this.hideBubble();\n      }, 50);\n      await this.eventService.updateBlockedEvent(this.bookingEvent);\n      this.isLoading = '';\n    } catch (error) {\n      //   toastr.error(error);\n    }\n  }\n\n  private handleConvertBlockedDateToBooking() {\n    this.handleBookingOption('BAR_BOOKING');\n  }\n\n  private getRoomInfo() {\n    const roomIdToFind = +this.bookingEvent.PR_ID;\n    let selectedRoom: any = {};\n\n    for (const room of this.bookingEvent.roomsInfo) {\n      for (const physicalRoom of room.physicalrooms) {\n        if (roomIdToFind === physicalRoom.id) {\n          selectedRoom.CATEGORY = room.name;\n          selectedRoom.ROOM_NAME = physicalRoom.name;\n          selectedRoom.ROOMS_INFO = room;\n          return selectedRoom;\n        }\n      }\n    }\n\n    return selectedRoom;\n  }\n\n  private renderTitle(eventType, roomInfo) {\n    switch (eventType) {\n      case 'EDIT_BOOKING':\n        return `${locales.entries.Lcz_EditBookingFor} ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\n      case 'ADD_ROOM':\n        return `${locales.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;\n      case 'SPLIT_BOOKING':\n        return locales.entries.Lcz_Adding + ` ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\n      default:\n        return `${locales.entries.Lcz_NewBookingFor} ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\n    }\n  }\n\n  private handleBookingOption(eventType, roomData = null) {\n    const roomInfo = this.getRoomInfo();\n    let data = roomData ? roomData : this.bookingEvent;\n    data.event_type = eventType;\n    data.TITLE = this.renderTitle(eventType, roomInfo);\n\n    if (['003', '002', '004'].includes(this.bookingEvent.STATUS_CODE)) {\n      data.roomsInfo = [roomInfo.ROOMS_INFO];\n    }\n    if (eventType === 'BAR_BOOKING' && this.bookingEvent.STATUS !== 'TEMP-EVENT') {\n      const { FROM_DATE, TO_DATE, PR_ID, RELEASE_AFTER_HOURS, ENTRY_DATE, OPTIONAL_REASON, ENTRY_MINUTE, ENTRY_HOUR, STATUS_CODE } = this.bookingEvent;\n      data.block_exposed_unit_props = {\n        from_date: FROM_DATE,\n        to_date: TO_DATE,\n        NOTES: OPTIONAL_REASON,\n        pr_id: PR_ID,\n        STAY_STATUS_CODE: STATUS_CODE,\n        DESCRIPTION: RELEASE_AFTER_HOURS,\n        BLOCKED_TILL_DATE: ENTRY_DATE,\n        BLOCKED_TILL_HOUR: ENTRY_HOUR,\n        BLOCKED_TILL_MINUTE: ENTRY_MINUTE,\n      };\n      this.handleDeleteEvent();\n    }\n    this.showBookingPopup.emit({\n      key: 'add',\n      data: {\n        ...data,\n        //roomsInfo: [roomInfo.ROOMS_INFO],\n      },\n    });\n    this.hideBubbleInfo.emit({\n      key: 'hidebubble',\n      currentInfoBubbleId: this.getBookingId(),\n    });\n  }\n\n  private getOTANotes(maxVisible: number = 3) {\n    if (!this.bookingEvent.ota_notes || this.bookingEvent.ota_notes?.length === 0) {\n      return null;\n    }\n    const channel_notes: IOtaNotes[] = [...this.bookingEvent.ota_notes];\n    const separator = '<br>- ';\n    if (channel_notes.length > maxVisible) {\n      channel_notes[maxVisible - 1] = { statement: `${channel_notes[maxVisible - 1].statement} <span style=\"color: #1e9ff2;\">more...</span>` };\n    }\n    return channel_notes\n      .slice(0, maxVisible)\n      .map(o => `${separator}${o.statement}`)\n      .join('');\n  }\n  /**\n   * Determines whether the current booking is eligible to be split.\n   *\n   * Rules enforced:\n   *  1) Minimum stay — there must be at least 2 nights between `from_date` (check-in) and `to_date` (check-out).\n   *     (Checkout is treated as exclusive; nights = `to_date - from_date` in whole days.)\n   *  2) Proximity to checkout — disallow splitting when checkout is tomorrow or earlier\n   *     (i.e., `to_date - today < 1 day` when all are normalized to start of day).\n   *\n   * @returns {boolean} `true` if the booking can be split under the rules above; otherwise `false`.\n   *\n   * @example\n   * // Given defaultDates: { from_date: '2025-10-10', to_date: '2025-10-13' }\n   * // nights = 3, and if checkout is more than a day away, returns true.\n   * const canSplit = this.canSplitBooking(); // -> true\n   */\n  private canSplitBooking(): boolean {\n    const fromStr = this.bookingEvent?.defaultDates?.from_date;\n    const toStr = this.bookingEvent?.defaultDates?.to_date;\n\n    const MFromDate = moment(fromStr, 'YYYY-MM-DD', true).startOf('day');\n    const MToDate = moment(toStr, 'YYYY-MM-DD', true).startOf('day');\n\n    if (!MFromDate.isValid() || !MToDate.isValid()) return false;\n\n    // Nights between (checkout is exclusive)\n    const nights = MToDate.diff(MFromDate, 'days');\n\n    // Must be at least 2 nights to make a meaningful split\n    if (nights < 2) return false;\n\n    // Don’t allow split if checkout is  tomorrow (< 1 day away)\n    const today = moment().startOf('day');\n    if (MToDate.diff(today, 'days') < 1) return false;\n\n    return true;\n  }\n\n  private getInfoElement() {\n    return (\n      <div class={`iglPopOver infoBubble ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`}>\n        <div class={`d-flex p-0 m-0  ${this.bookingEvent.BALANCE > 1 ? 'pb-0' : 'pb-1'}`}>\n          <div class=\"px-0  font-weight-bold font-medium-1 d-flex align-items-center\" style={{ flex: '1 1 0%' }}>\n            <img src={this.bookingEvent?.origin?.Icon} alt={this.bookingEvent?.origin?.Label} class={'icon-image'} />\n            <p class={'p-0 m-0'}>{!this.bookingEvent.is_direct ? this.bookingEvent.channel_booking_nbr : this.bookingEvent.BOOKING_NUMBER}</p>\n          </div>\n          <div class=\"pr-0  text-right d-flex align-items-center\" style={{ gap: '0.5rem' }}>\n            <ir-dropdown\n              caret={false}\n              onOptionChange={async e => {\n                const newBookingColor = e.detail === 'none' ? null : calendar_data.property.calendar_extra?.booking_colors.find(c => c.color === e.detail);\n                await this.propertyService.setRoomCalendarExtra({\n                  property_id: calendar_data.property.id,\n                  room_identifier: this.bookingEvent.IDENTIFIER,\n                  value: JSON.stringify({\n                    booking_color: newBookingColor,\n                  }),\n                });\n                this.bookingColor = newBookingColor;\n              }}\n              style={{ '--ir-dropdown-menu-min-width': 'fit-content', 'width': '1.5rem' }}\n            >\n              <button class=\"booking-event-hover__color-picker-trigger\" slot=\"trigger\">\n                {this.bookingColor ? (\n                  <div style={{ height: '1rem', width: '1rem', background: this.bookingColor?.color, borderRadius: '0.21rem' }}></div>\n                ) : (\n                  <ir-icons\n                    class=\"p-0 m-0 d-flex align-items-center\"\n                    style={{\n                      '--icon-size': '1rem',\n                      'height': '1rem',\n                      'width': '1rem',\n                      'background': this.baseColor,\n                      'color': 'white',\n                      'borderRadius': '0.21rem',\n                      'padding': '0.25rem',\n                    }}\n                    name=\"ban\"\n                  ></ir-icons>\n                )}\n              </button>\n              <ir-dropdown-item value=\"none\">\n                <ir-icons class=\"p-0 m-0 d-flex align-items-center\" style={{ '--icon-size': '1rem', 'height': '1rem', 'width': '1rem' }} name=\"ban\"></ir-icons>\n              </ir-dropdown-item>\n              {calendar_data.property.calendar_extra?.booking_colors.map(s => (\n                <ir-dropdown-item value={s.color}>\n                  <div style={{ height: '1rem', width: '1rem', borderRadius: '0.21rem', background: s.color }}></div>\n                </ir-dropdown-item>\n              ))}\n            </ir-dropdown>\n            {formatAmount(this.currency.symbol, this.getTotalPrice())}\n          </div>\n        </div>\n\n        {this.bookingEvent.BALANCE > 1 && (\n          <p class=\"pr-0 m-0 p-0 text-right balance_amount\">\n            {locales.entries.Lcz_Balance}: {formatAmount(this.currency.symbol, this.bookingEvent.BALANCE)}\n          </p>\n        )}\n        <div class=\"row p-0 m-0\">\n          <div class=\"px-0 pr-0 col-12\">\n            <ir-date-view from_date={this.bookingEvent.defaultDates.from_date} to_date={this.bookingEvent.defaultDates.to_date} showDateDifference={false}></ir-date-view>\n          </div>\n        </div>\n        {this.bookingEvent.NAME && <ir-label containerStyle={{ padding: '0', margin: '0' }} class=\"m-0 p-0\" labelText={`Guest name:`} content={this.bookingEvent.NAME}></ir-label>}\n        {this.getArrivalTime() && (\n          <ir-label containerStyle={{ padding: '0', margin: '0' }} class=\"m-0 p-0\" labelText={`${locales.entries.Lcz_ArrivalTime}:`} content={this.getArrivalTime()}></ir-label>\n        )}\n        {this.getTotalOccupants() && (\n          <ir-label class=\"m-0 p-0\" containerStyle={{ padding: '0', margin: '0' }} labelText={`${locales.entries.Lcz_Occupancy}:`} content={this.getTotalOccupants()}></ir-label>\n        )}\n        {this.getPhoneNumber() && (\n          <ir-label containerStyle={{ padding: '0', margin: '0' }} class=\"m-0 p-0\" labelText={`${locales.entries.Lcz_Phone}:`} content={this.renderPhone()}></ir-label>\n        )}\n        {this.getRatePlan() && (\n          <ir-label containerStyle={{ padding: '0', margin: '0' }} class=\"m-0 p-0\" labelText={`${locales.entries.Lcz_RatePlan}:`} content={this.getRatePlan()}></ir-label>\n        )}\n        {this.bookingEvent.DEPARTURE_TIME?.code !== '000' && (\n          <ir-label containerStyle={{ padding: '0', margin: '0' }} class=\"m-0 p-0\" labelText={`Departure time:`} content={this.bookingEvent.DEPARTURE_TIME?.description}></ir-label>\n        )}\n        {this.bookingEvent.PRIVATE_NOTE && (\n          <ir-label\n            containerStyle={{ padding: '0', margin: '0' }}\n            class=\"m-0 p-0\"\n            labelText={`${locales.entries.Lcz_BookingPrivateNote}:`}\n            display=\"inline\"\n            content={this.bookingEvent.PRIVATE_NOTE}\n          ></ir-label>\n        )}\n        {this.bookingEvent.is_direct && (\n          <ir-label containerStyle={{ padding: '0', margin: '0' }} labelText={`${locales.entries.Lcz_GuestRemark}:`} display=\"inline\" content={this.bookingEvent.NOTES}></ir-label>\n        )}\n        <ir-label\n          containerStyle={{ padding: '0', margin: '0' }}\n          labelText={`${locales.entries.Lcz_ChannelNotes}:`}\n          display=\"inline\"\n          content={this.getOTANotes()}\n          renderContentAsHtml\n        ></ir-label>\n        {this.getInternalNote() && <ir-label labelText={`${locales.entries.Lcz_InternalRemark}:`} content={this.getInternalNote()}></ir-label>}\n        <div class=\"row p-0 m-0 mt-2\">\n          <div class=\"full-width d-flex align-items-center\" style={{ gap: '0.25rem' }} role=\"group\">\n            <ir-button\n              style={{ '--icon-size': '0.875rem' }}\n              onClickHandler={() => this.handleEditBooking()}\n              class={'w-100'}\n              btn_block\n              text={locales.entries.Lcz_Edit}\n              // icon_name=\"edit\"\n              btn_styles=\"h-100\"\n              size=\"sm\"\n            ></ir-button>\n            {this.bookingEvent.is_direct && this.bookingEvent.IS_EDITABLE && !this.hideButtons && (\n              <ir-button\n                style={{ '--icon-size': '0.875rem' }}\n                text={locales.entries.Lcz_AddRoom}\n                // icon_name=\"square_plus\"\n                size=\"sm\"\n                class={'w-100'}\n                btn_styles=\"h-100\"\n                onClickHandler={() => this.handleAddRoom()}\n              ></ir-button>\n            )}\n            {this.canSplitBooking() && (\n              <ir-button\n                class={'w-100'}\n                style={{ '--icon-size': '0.875rem' }}\n                text={'Split'}\n                onClickHandler={() => this.handleSplitBooking()}\n                btn_styles=\"h-100\"\n                size=\"sm\"\n              ></ir-button>\n            )}\n            {this.canCheckIn() && (\n              <ir-button\n                class={'w-100'}\n                style={{ '--icon-size': '0.875rem' }}\n                text={locales.entries.Lcz_CheckIn}\n                onClickHandler={() => this.handleCustomerCheckIn()}\n                // icon_name=\"edit\"\n                btn_styles=\"h-100\"\n                size=\"sm\"\n              ></ir-button>\n            )}\n            {this.canCheckOut() && (\n              <ir-button\n                class={'w-100'}\n                btn_styles=\"h-100\"\n                style={{ '--icon-size': '0.875rem' }}\n                text={locales.entries.Lcz_CheckOut}\n                // icon_name=\"edit\"\n                onClickHandler={() => this.handleCustomerCheckOut()}\n                size=\"sm\"\n              ></ir-button>\n            )}\n            {this.hideButtons\n              ? null\n              : !this.shouldHideUnassignUnit && (\n                  <ir-button\n                    class={'w-100'}\n                    btn_styles=\"h-100\"\n                    style={{ '--icon-size': '0.875rem' }}\n                    size=\"sm\"\n                    text={locales.entries.Lcz_Unassign}\n                    onClickHandler={_ => {\n                      this.handleDeleteEvent();\n                    }}\n                  ></ir-button>\n                )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n  private handleSplitBooking(): void {\n    this.hideBubble();\n    this.openCalendarSidebar.emit({ type: 'split', payload: { booking: this.bookingEvent.base_booking, identifier: this.bookingEvent.IDENTIFIER } });\n  }\n  private getNewBookingOptions() {\n    const shouldDisplayButtons = this.bookingEvent.roomsInfo[0].rateplans.some(rate => rate.is_active);\n    return (\n      <div class={`iglPopOver d-flex flex-column newBookingOptions ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`} style={{ gap: '0.5rem' }}>\n        {shouldDisplayButtons ? (\n          <Fragment>\n            {/* <div class={'mb-1'}> */}\n            <ir-button\n              size=\"sm\"\n              btn_block\n              data-testid=\"bar_booking_btn\"\n              text={locales.entries.Lcz_CreateNewBooking}\n              onClickHandler={_ => {\n                this.handleBookingOption('BAR_BOOKING');\n              }}\n            ></ir-button>\n            {/* </div> */}\n            {/* <div> */}\n            {this.hasSplitBooking() && (\n              // <div class=\"mb-1\">\n              <ir-button\n                size=\"sm\"\n                btn_block\n                text={locales.entries.Lcz_AssignUnitToExistingBooking}\n                onClickHandler={_ => {\n                  this.handleBookingOption('SPLIT_BOOKING');\n                }}\n              ></ir-button>\n              // </div>\n            )}\n            {/* </div> */}\n          </Fragment>\n        ) : (\n          <p class={'text-danger'}>{locales.entries.Lcz_NoRatePlanDefined}</p>\n        )}\n        {/* <div> */}\n        <ir-button\n          size=\"sm\"\n          text={locales.entries.Lcz_Blockdates}\n          btn_block\n          onClickHandler={_ => {\n            this.handleBookingOption('BLOCK_DATES');\n          }}\n        ></ir-button>\n        {/* </div> */}\n      </div>\n    );\n  }\n\n  private getBlockedView() {\n    console.log('booking event', this.bookingEvent);\n    // let defaultData = {RELEASE_AFTER_HOURS: 0, OPTIONAL_REASON: \"\", OUT_OF_SERVICE: false};\n    return (\n      <div class={`iglPopOver blockedView ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`}>\n        <igl-block-dates-view\n          isEventHover={true}\n          entryHour={this.bookingEvent.ENTRY_HOUR}\n          entryMinute={this.bookingEvent.ENTRY_MINUTE}\n          defaultData={this.bookingEvent}\n          fromDate={this.bookingEvent.defaultDates.from_date}\n          toDate={this.bookingEvent.defaultDates.to_date}\n          entryDate={this.getEntryDate()}\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\n        ></igl-block-dates-view>\n        <div class=\"row p-0 m-0 mt-2\">\n          <div class=\"full-width d-flex align-items-center\" style={{ gap: '0.25rem' }} role=\"group\">\n            <ir-button\n              btn_disabled={this.isLoading === 'update'}\n              text={locales.entries.Lcz_Update}\n              onClickHandler={_ => {\n                this.handleUpdateBlockedDates();\n              }}\n              icon_name=\"edit\"\n              size=\"sm\"\n              btn_styles=\"h-100\"\n              isLoading={this.isLoading === 'update'}\n              style={{ '--icon-size': '0.875rem' }}\n              btn_block\n              class={'w-100'}\n            ></ir-button>\n            <ir-button\n              class={'w-100 h-100 my-0'}\n              btn_block\n              btn_styles=\"h-100\"\n              size=\"sm\"\n              text={locales.entries.Lcz_ConvertSplitBooking}\n              onClickHandler={() => {\n                this.handleConvertBlockedDateToBooking();\n              }}\n            ></ir-button>\n\n            <ir-button\n              class={'w-100'}\n              btn_styles=\"h-100\"\n              btn_block\n              size=\"sm\"\n              style={{ '--icon-size': '0.875rem' }}\n              icon_name=\"trash\"\n              btn_color=\"danger\"\n              onClickHandler={_ => {\n                this.handleDeleteEvent();\n              }}\n              text={locales.entries.Lcz_Delete}\n            ></ir-button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class={`pointerContainer ${this.bubbleInfoTop ? 'pointerContainerTop' : ''}`}>\n          <div class={`bubblePointer ${this.bubbleInfoTop ? 'bubblePointTop' : 'bubblePointBottom'}`}></div>\n        </div>\n        {this.isBlockedDateEvent() ? this.getBlockedView() : null}\n        {this.isNewBooking() ? this.getNewBookingOptions() : null}\n        {!this.isBlockedDateEvent() && !this.isNewBooking() ? this.getInfoElement() : null}\n      </Host>\n    );\n  }\n}\n","/* Existing styles */\n\n/* New styles for the overlay dropdown */\n.dropdown-menu {\n  z-index: 1000;\n  width: 100%;\n  max-height: 300px;\n  min-width: var(--ir-dropdown-menu-min-width, 11rem) !important;\n  overflow-y: auto;\n}\n\n.dropdown.nav-item.show .dropdown-menu {\n  display: block; /* display the dropdown when the parent has the \"show\" class */\n}\n.caret-icon {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-55%);\n  right: 0.25rem;\n  z-index: 99999;\n}\n.dropdown-trigger {\n  position: relative;\n}\n.caret-icon.disabled {\n  opacity: 0.5 !important;\n  pointer-events: none !important;\n  cursor: not-allowed !important;\n}\n","import { Component, Prop, State, h, Event, EventEmitter, Host, Element, Listen, Watch } from '@stencil/core';\n\nexport type DropdownItem = {\n  value: string | number;\n};\n\n@Component({\n  tag: 'ir-dropdown',\n  styleUrl: 'ir-dropdown.css',\n  scoped: true,\n})\nexport class IrDropdown {\n  @Element() el: HTMLIrDropdownElement;\n\n  @Prop({ reflect: true, mutable: true }) value: DropdownItem['value'];\n\n  @Prop({ reflect: true, mutable: true }) disabled: boolean = false;\n\n  @Prop({ reflect: true, mutable: true }) caret: boolean = true;\n\n  @State() isOpen: boolean = false;\n  @State() selectedOption: DropdownItem['value'];\n  @State() focusedIndex: number = -1;\n  @State() itemChildren: HTMLIrDropdownItemElement[] = [];\n\n  private mo: MutationObserver | null = null;\n  private documentClickHandler: (event: Event) => void;\n  private isComponentConnected: boolean = true;\n  private updateQueued: boolean = false;\n\n  /**\n   * Emitted when a user selects an option from the combobox.\n   * The event payload contains the selected `DropdownItem` object.\n   */\n  @Event() optionChange: EventEmitter<DropdownItem['value']>;\n\n  componentWillLoad() {\n    this.selectedOption = this.value;\n    this.documentClickHandler = this.handleDocumentClick.bind(this);\n    this.collectItemChildren();\n\n    // Optimized mutation observer with debouncing\n    this.mo = new MutationObserver(() => {\n      if (!this.updateQueued) {\n        this.updateQueued = true;\n        requestAnimationFrame(() => {\n          if (this.isComponentConnected) {\n            this.collectItemChildren();\n            this.updateQueued = false;\n          }\n        });\n      }\n    });\n    this.mo.observe(this.el, { childList: true, subtree: true });\n  }\n\n  componentDidLoad() {\n    document.addEventListener('click', this.documentClickHandler, { passive: true });\n\n    // Single RAF call instead of multiple setTimeouts\n    requestAnimationFrame(() => {\n      if (this.isComponentConnected) {\n        this.updateItemElements();\n        if (this.value) {\n          this.updateDropdownItemValue(this.value);\n        }\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n    document.removeEventListener('click', this.documentClickHandler);\n    this.mo?.disconnect();\n    this.mo = null;\n  }\n\n  @Listen('keydown', { target: 'document' })\n  handleDocumentKeyDown(event: KeyboardEvent) {\n    if (!this.isOpen || !this.isComponentConnected) return;\n\n    if (event.key === 'Escape') {\n      this.closeDropdown();\n    }\n  }\n\n  @Listen('dropdownItemSelect')\n  handleDropdownItemSelect(ev: CustomEvent<DropdownItem['value']>) {\n    if (!this.isComponentConnected) return;\n\n    ev.stopPropagation();\n    this.selectOption(ev.detail);\n    (ev.target as HTMLIrDropdownItemElement).setAttribute('aria-selected', 'true');\n  }\n\n  @Listen('dropdownItemRegister')\n  handleDropdownItemRegister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Listen('dropdownItemUnregister')\n  handleDropdownItemUnregister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Watch('value')\n  handleValueChange(newValue: DropdownItem['value'], oldValue: DropdownItem['value']) {\n    if (newValue !== oldValue && this.isComponentConnected) {\n      this.updateDropdownItemValue(newValue);\n    }\n  }\n\n  private updateDropdownItemValue(value: DropdownItem['value']) {\n    // Clear previous selections immediately\n    this.itemChildren.forEach(el => el.removeAttribute('aria-selected'));\n\n    // Set new selection\n    const el = this.itemChildren.find(el => el.value === value);\n    if (el) {\n      el.setAttribute('aria-selected', 'true');\n    }\n  }\n\n  private getSelectedItemIndex(): number {\n    if (!this.value) return -1;\n    return this.itemChildren.findIndex(item => item.value === this.value);\n  }\n\n  private openDropdown() {\n    try {\n      this.isOpen = true;\n      // Initialize focus to the currently selected item\n      this.focusedIndex = this.getSelectedItemIndex();\n      // Immediate update instead of setTimeout\n      this.updateItemElements();\n\n      // Auto-scroll to selected item if it exists\n      if (this.focusedIndex >= 0) {\n        requestAnimationFrame(() => {\n          this.scrollToSelectedItem();\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  private closeDropdown() {\n    this.isOpen = false;\n    this.focusedIndex = -1;\n    this.removeItemFocus();\n  }\n\n  private handleDocumentClick = (event: Event) => {\n    if (!this.isComponentConnected || !this.el.contains(event.target as Node)) {\n      this.closeDropdown();\n    }\n  };\n\n  private collectItemChildren() {\n    if (!this.isComponentConnected) return;\n\n    const items = Array.from(this.el.querySelectorAll('ir-dropdown-item')) as HTMLIrDropdownItemElement[];\n    this.itemChildren = items;\n\n    // Immediate update instead of setTimeout\n    this.updateItemElements();\n  }\n\n  private updateItemElements() {\n    if (!this.isComponentConnected) return;\n\n    // Use the collected item children directly\n    this.itemChildren.forEach((el, index) => {\n      el.setAttribute('data-slot-index', String(index));\n      el.setAttribute('role', 'option');\n      el.setAttribute('tabindex', '-1');\n    });\n  }\n\n  private removeItemFocus() {\n    this.itemChildren.forEach(element => {\n      element.classList.remove('focused', 'active');\n      // Don't remove aria-selected as it indicates selection, not focus\n    });\n  }\n\n  private focusItemElement(index: number) {\n    this.removeItemFocus();\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.classList.add('focused');\n      element.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n    }\n  }\n\n  private selectItemElement(index: number) {\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.click();\n    }\n  }\n\n  private scrollToSelectedItem() {\n    if (this.focusedIndex >= 0 && this.focusedIndex < this.itemChildren.length) {\n      const selectedElement = this.itemChildren[this.focusedIndex];\n      if (selectedElement) {\n        selectedElement.scrollIntoView({\n          block: 'nearest',\n          behavior: 'smooth',\n          inline: 'nearest',\n        });\n      }\n    }\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    if (!this.isComponentConnected || this.disabled) return;\n\n    const maxIndex = this.itemChildren.length - 1;\n\n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from next item\n          if (this.focusedIndex >= 0 && this.focusedIndex < maxIndex) {\n            this.focusedIndex++;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from first item\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === maxIndex) {\n            // At last item, wrap to first\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex < maxIndex ? this.focusedIndex + 1 : 0;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'ArrowUp':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from previous item\n          if (this.focusedIndex > 0) {\n            this.focusedIndex--;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from last item\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === 0) {\n            // At first item, wrap to last\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex > 0 ? this.focusedIndex - 1 : maxIndex;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'Enter':\n        event.preventDefault();\n        if (this.isOpen && this.focusedIndex >= 0) {\n          this.selectItemElement(this.focusedIndex);\n        } else if (!this.isOpen) {\n          this.openDropdown();\n        }\n        break;\n\n      case 'Escape':\n        event.preventDefault();\n        this.closeDropdown();\n        break;\n\n      case 'Tab':\n        if (this.isOpen) {\n          this.closeDropdown();\n        }\n        break;\n    }\n  };\n\n  private selectOption(option: DropdownItem['value']) {\n    this.selectedOption = option;\n    this.value = option;\n    this.optionChange.emit(option);\n    this.closeDropdown();\n  }\n\n  render() {\n    return (\n      <Host class={`dropdown ${this.isOpen ? 'show' : ''}`}>\n        <div\n          onClick={() => {\n            if (this.disabled) return;\n            if (this.isOpen) {\n              this.closeDropdown();\n            } else {\n              this.openDropdown();\n            }\n          }}\n          aria-disabled={String(this.disabled)}\n          class={`dropdown-trigger ${this.disabled ? 'disabled' : ''}`}\n          onKeyDown={this.handleKeyDown}\n          tabindex=\"0\"\n        >\n          <slot name=\"trigger\"></slot>\n          {this.caret && (\n            <div class={`caret-icon ${this.disabled ? 'disabled' : ''}`}>\n              <ir-icons name={!this.isOpen ? 'angle-down' : 'angle-up'}></ir-icons>\n            </div>\n          )}\n        </div>\n        <div class=\"dropdown-menu\" role=\"listbox\" aria-expanded={this.isOpen.toString()}>\n          <slot></slot>\n        </div>\n      </Host>\n    );\n  }\n}\n","/* ir-m-combobox-item.css */\n:host {\n  display: block;\n  cursor: pointer;\n}\n:host([hidden]) {\n  display: none !important;\n}\n:host(.focused) {\n  background: #f4f5fa !important;\n}\n:host(.active),\n:host([aria-selected='true']),\n:host:active {\n  /* keep in sync with your combobox .dropdown-item.active styles */\n  outline: none;\n  background-color: var(--blue, #1e9ff2) !important;\n  color: white !important;\n}\n:host(.dropdown-item) {\n  padding: 0.25rem 1rem !important;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n","import { Component, Element, Event, EventEmitter, Host, Method, Prop, h } from '@stencil/core';\nimport { DropdownItem } from '../ir-dropdown/ir-dropdown';\n\n@Component({\n  tag: 'ir-dropdown-item',\n  styleUrl: 'ir-dropdown-item.css',\n  scoped: true,\n})\nexport class IrDropdownItem {\n  @Element() el: HTMLIrDropdownItemElement;\n\n  private isComponentConnected: boolean = true;\n  private hasRegistered: boolean = false;\n\n  /**\n   * Required value for the option\n   */\n  @Prop() value!: string;\n\n  /**\n   * Optional label (falls back to textContent)\n   */\n  @Prop() label?: string;\n\n  /**\n   * Optional html_content (when you want rich content);\n   * If omitted, the component will render its own slot content.\n   */\n  @Prop() html_content?: string;\n\n  /**\n   * When true, visually hide the item (used for filtering).\n   */\n  @Prop({ mutable: true, reflect: true }) hidden: boolean = false;\n\n  /**\n   * Emit when this item is chosen. Parent listens and closes dropdown.\n   */\n  @Event({ eventName: 'dropdownItemSelect' }) dropdownItemSelect: EventEmitter<DropdownItem['value']>;\n\n  /**\n   * Inform the parent this item exists (parent will index and manage focus)\n   */\n  @Event({ eventName: 'dropdownItemRegister' }) dropdownItemRegister: EventEmitter<void>;\n\n  /**\n   * Inform the parent this item is gone\n   */\n  @Event({ eventName: 'dropdownItemUnregister' }) dropdownItemUnregister: EventEmitter<void>;\n\n  componentDidLoad() {\n    if (this.isComponentConnected && !this.hasRegistered) {\n      this.hasRegistered = true;\n      // Use RAF to ensure parent is ready\n      requestAnimationFrame(() => {\n        if (this.isComponentConnected) {\n          this.dropdownItemRegister.emit();\n        }\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n\n    // Only emit unregister if we previously registered and parent might still be connected\n    if (this.hasRegistered && this.el.parentElement) {\n      // Check if parent dropdown still exists in DOM\n      const parentDropdown = this.el.closest('ir-dropdown');\n      if (parentDropdown && document.contains(parentDropdown)) {\n        this.dropdownItemUnregister.emit();\n      }\n    }\n    this.hasRegistered = false;\n  }\n\n  @Method()\n  async matchesQuery(query: string): Promise<boolean> {\n    if (!this.isComponentConnected) return false;\n\n    const q = query.toLowerCase();\n    const hay = (this.label ?? this.el.textContent ?? '').toLowerCase();\n    return hay.includes(q);\n  }\n\n  @Method()\n  async setHidden(next: boolean) {\n    if (this.isComponentConnected) {\n      this.hidden = next;\n    }\n  }\n\n  private handleClick = (event: Event) => {\n    event.stopPropagation();\n\n    if (!this.isComponentConnected) return;\n\n    this.dropdownItemSelect.emit(this.value);\n  };\n\n  render() {\n    return (\n      <Host role=\"option\" tabindex=\"-1\" aria-selected=\"false\" class={{ 'dropdown-item': true, 'hidden': this.hidden }} onClick={this.handleClick} data-value={this.value}>\n        {this.html_content ? <span innerHTML={this.html_content}></span> : <slot></slot>}\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}