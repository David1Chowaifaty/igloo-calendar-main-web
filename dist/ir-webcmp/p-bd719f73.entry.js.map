{"version":3,"names":["iglBookPropertyContainerCss","IglBookPropertyContainerStyle0","IglBookPropertyContainer","language","ticket","p","propertyid","from_date","to_date","withIrToastAndInterceptor","bookingItem","showPaymentDetails","countries","calendarData","resetBookingData","bookingService","BookingService","roomService","RoomService","token","Token","setRoomsData","roomServiceResp","roomsData","Array","My_Result","roomtypes","length","forEach","roomCategory","expanded","this","roomsInfo","initializeApp","Error","roomResponse","languageTexts","countriesList","Promise","all","getExposedProperty","id","aname","fetchLanguage","getCountries","locales","entries","direction","allowed_payment_methods","paymentMethods","currency","allowed_booking_sources","adult_child_constraints","calendar_legends","legendData","paymentCodesToShow","some","method","includes","code","error","console","componentWillLoad","setToken","ticketChanged","newValue","oldValue","handleCloseBookingWindow","handleTriggerClicked","tomorrow","Date","setDate","getDate","FROM_DATE","defaultDateRange","fromDate","fromDateStr","toDate","toDateStr","dateDifference","message","TO_DATE","EMAIL","event_type","ID","NAME","PHONE","REFERENCE_TYPE","TITLE","Lcz_NewBooking","render","h","Host","key","Fragment","class","onClick","bind","name","allowedBookingSources","adultChildConstraints","bookingData","onResetBookingEvt","e","stopImmediatePropagation","stopPropagation","emit","onCloseBookingWindow"],"sources":["src/components/igl-book-property-container/igl-book-property-container.css?tag=igl-book-property-container&encapsulation=scoped","src/components/igl-book-property-container/igl-book-property-container.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  margin: 0;\r\n  padding: 0;\r\n  letter-spacing: 0px !important;\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\r\n  font-size: 1rem !important;\r\n  font-weight: 400 !important;\r\n  line-height: 1.45 !important;\r\n  color: #6b6f82 !important;\r\n  text-align: left !important;\r\n}\r\n.book-container {\r\n  width: min-content;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\nh3 {\r\n  font-size: 1rem;\r\n}\r\n","import { IglBookPropertyPayloadPlusBooking } from '@/models/igl-book-property';\nimport Token from '@/models/Token';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, State, h, Prop, Watch, Event, EventEmitter, Fragment } from '@stencil/core';\nimport { ICountry } from '@/models/IBooking';\n@Component({\n  tag: 'igl-book-property-container',\n  styleUrl: 'igl-book-property-container.css',\n  scoped: true,\n})\nexport class IglBookPropertyContainer {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() p: string;\n  @Prop() propertyid: number;\n  @Prop() from_date: string;\n  @Prop() to_date: string;\n  @Prop() withIrToastAndInterceptor: boolean = true;\n\n  @State() bookingItem: IglBookPropertyPayloadPlusBooking | null;\n  @State() showPaymentDetails: any;\n  @State() countries: ICountry[];\n  @State() calendarData: any = {};\n\n  @Event() resetBookingData: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private token = new Token();\n\n  setRoomsData(roomServiceResp) {\n    let roomsData: { [key: string]: any }[] = new Array();\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\n      roomsData = roomServiceResp.My_Result.roomtypes;\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\n        roomCategory.expanded = true;\n      });\n    }\n    this.calendarData.roomsInfo = roomsData;\n  }\n  async initializeApp() {\n    try {\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      const [roomResponse, languageTexts, countriesList] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getCountries(this.language),\n      ]);\n      if (!locales.entries) {\n        locales.entries = languageTexts.entries;\n        locales.direction = languageTexts.direction;\n      }\n      this.countries = countriesList;\n\n      const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends } = roomResponse['My_Result'];\n      this.calendarData = { currency, allowed_booking_sources, adult_child_constraints, legendData: calendar_legends };\n      this.setRoomsData(roomResponse);\n      const paymentCodesToShow = ['001', '004'];\n      this.showPaymentDetails = paymentMethods.some(method => paymentCodesToShow.includes(method.code));\n    } catch (error) {\n      console.error('Error initializing app:', error);\n    }\n  }\n  componentWillLoad() {\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n  handleCloseBookingWindow() {\n    this.bookingItem = null;\n  }\n  handleTriggerClicked() {\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    (this.bookingItem as IglBookPropertyPayloadPlusBooking) = {\n      FROM_DATE: this.from_date,\n      defaultDateRange: {\n        fromDate: new Date(),\n        fromDateStr: '',\n        toDate: tomorrow,\n        toDateStr: '',\n        dateDifference: 0,\n        message: '',\n      },\n      TO_DATE: this.to_date,\n      EMAIL: '',\n      event_type: 'PLUS_BOOKING',\n      ID: '',\n      NAME: '',\n      PHONE: '',\n      REFERENCE_TYPE: '',\n      TITLE: locales.entries.Lcz_NewBooking,\n    };\n  }\n  render() {\n    return (\n      <Host>\n        {this.withIrToastAndInterceptor && (\n          <Fragment>\n            <ir-toast></ir-toast>\n            <ir-interceptor></ir-interceptor>\n          </Fragment>\n        )}\n\n        <div class=\"book-container\" onClick={this.handleTriggerClicked.bind(this)}>\n          <slot name=\"trigger\"></slot>\n        </div>\n        {this.bookingItem && (\n          <igl-book-property\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\n            adultChildConstraints={this.calendarData.adult_child_constraints}\n            showPaymentDetails={this.showPaymentDetails}\n            countries={this.countries}\n            currency={this.calendarData.currency}\n            language={this.language}\n            propertyid={this.propertyid}\n            bookingData={this.bookingItem}\n            onResetBookingEvt={(e: CustomEvent) => {\n              e.stopImmediatePropagation();\n              e.stopPropagation();\n              this.resetBookingData.emit(null);\n            }}\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\n          ></igl-book-property>\n        )}\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}