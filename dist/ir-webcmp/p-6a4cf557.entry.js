import{r as t,c as i,g as s,h as o,F as e}from"./p-acddcbeb.js";import{l as r}from"./p-e58470d9.js";import{v as a}from"./p-4ed69de7.js";import"./p-2925ded6.js";const h=".sc-ir-combobox-h{display:block;position:relative;padding:0;margin:0;box-sizing:border-box}ul.sc-ir-combobox{position:absolute;box-sizing:border-box;margin:0;margin-top:2px;width:max-content;max-height:80px;border-radius:0.21rem;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto;min-width:100%}ul[data-position='bottom-right'].sc-ir-combobox{right:0}.list-item-image.sc-ir-combobox{height:1rem;aspect-ratio:4/3;border-radius:4px;margin-right:10px}.dropdown-item.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox,span.sc-ir-combobox,loader-container.sc-ir-combobox{padding:0px 16px;margin:0px;margin-top:2px;width:100%;border-radius:2px}ul.sc-ir-combobox li.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox{display:flex;align-items:center;flex-wrap:wrap;gap:3px}ul.sc-ir-combobox li.sc-ir-combobox p.sc-ir-combobox{margin:0;padding:0}ul.sc-ir-combobox li.sc-ir-combobox:hover{background:#f4f5fa}ul.sc-ir-combobox li[data-selected].sc-ir-combobox,ul.sc-ir-combobox li[data-selected].sc-ir-combobox:hover{color:#fff;text-decoration:none;background-color:#666ee8}";const c=h;const n=class{constructor(s){t(this,s);this.comboboxValueChange=i(this,"comboboxValueChange",7);this.inputCleared=i(this,"inputCleared",7);this.toast=i(this,"toast",7)}get el(){return s(this)}data=[];duration=300;placeholder;value;disabled=false;autoFocus=false;input_id=a();selectedIndex=-1;actualIndex=-1;isComboBoxVisible=false;isLoading=true;isItemSelected;inputValue="";filteredData=[];componentShouldAutoFocus=false;comboboxValueChange;inputCleared;toast;inputRef;debounceTimer;blurTimeout;componentWillLoad(){this.filteredData=this.data}componentDidLoad(){if(this.autoFocus){this.focusInput()}}watchHandler(t,i){if(t!==i&&t===true){this.focusInput()}}handleDocumentClick(t){const i=t.target;if(!this.el.contains(i)){this.isComboBoxVisible=false}}disconnectedCallback(){clearTimeout(this.debounceTimer);clearTimeout(this.blurTimeout);this.inputRef?.removeEventListener("blur",this.handleBlur);this.inputRef?.removeEventListener("click",this.selectItem);this.inputRef?.removeEventListener("keydown",this.handleKeyDown);this.inputRef?.removeEventListener("focus",this.handleFocus)}handleKeyDown(t){const i=this.filteredData.length;if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition();break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition();break;case"Escape":t.stopImmediatePropagation();t.stopPropagation();this.inputRef?.blur();this.isComboBoxVisible=false;break}}}focusInput(){requestAnimationFrame((()=>{this.inputRef?.focus()}))}adjustScrollPosition(){const t=this.el?.querySelector(`[data-selected]`);if(!t)return;t.scrollIntoView({block:"center"})}selectItem(t){if(this.filteredData[t]){this.isItemSelected=true;this.comboboxValueChange.emit({key:"select",data:this.filteredData[t].id});this.inputValue="";this.resetCombobox();if(this.autoFocus){this.focusInput()}}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}handleFocus(){this.isComboBoxVisible=true}resetCombobox(t=true){if(t){this.inputRef?.blur()}this.selectedIndex=-1;this.isComboBoxVisible=false}async fetchData(){try{this.isLoading=true;this.filteredData=this.data.filter((t=>t.name.toLowerCase().startsWith(this.inputValue)));this.selectedIndex=-1}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{this.filteredData=this.data}}handleBlur(){this.blurTimeout=setTimeout((()=>{if(!this.isItemSelected){this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}),300)}handleItemKeyDown(t,i){if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(i);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;this.inputRef?.blur();t.preventDefault()}}renderDropdown(){if(!this.isComboBoxVisible){return null}return o("ul",{"data-position":this.filteredData.length>0&&this.filteredData[0].occupancy?"bottom-right":"bottom-left"},this.filteredData?.map(((t,i)=>o("li",{onMouseEnter:()=>this.selectedIndex=i,role:"button",key:t.id,onKeyDown:t=>this.handleItemKeyDown(t,i),"data-selected":this.selectedIndex===i,tabIndex:0,onClick:()=>this.selectItem(i)},t.image&&o("img",{src:t.image,class:"list-item-image"}),o("p",null,t.name),t.occupancy&&o(e,null,o("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},o("path",{fill:"currentColor",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),o("p",null,t.occupancy))))),this.filteredData.length===0&&!this.isLoading&&o("span",{class:"text-center"},r.entries.Lcz_NoResultsFound))}handleSubmit(t){t.preventDefault();t.stopPropagation();console.log("object");if(!this.filteredData.length){return}this.selectItem(this.selectedIndex===-1?0:this.selectedIndex)}render(){return o("form",{key:"e8a2b659555cf9b2c30930e9743e35eb3333077f",onSubmit:this.handleSubmit.bind(this),class:"m-0 p-0"},o("input",{key:"b5ac9d523681e706129764cd387f0349e69db9b3",type:"text",class:"form-control bg-white",id:this.input_id,ref:t=>this.inputRef=t,disabled:this.disabled,value:this.value,placeholder:this.placeholder,onKeyDown:this.handleKeyDown.bind(this),onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),autoFocus:this.autoFocus}),this.renderDropdown())}static get watchers(){return{isComboBoxVisible:["watchHandler"]}}};n.style=c;export{n as ir_combobox};
//# sourceMappingURL=p-6a4cf557.entry.js.map