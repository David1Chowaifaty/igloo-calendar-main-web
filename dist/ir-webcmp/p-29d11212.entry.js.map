{"version":3,"names":["iglBookingEventCss","IglBookingEventStyle0","IglBookingEvent","this","dayWidth","eventSpace","vertSpace","showInfoPopup","bubbleInfoTopSide","isStreatch","eventsService","EventsService","bookingService","BookingService","resizeSide","isDragging","animationFrameId","handleMouseMoveBind","handleMouseMove","bind","handleMouseUpBind","handleMouseUp","handleClickOutsideBind","handleClickOutside","componentWillLoad","setToken","calendar_data","token","window","addEventListener","fetchAndAssignBookingData","console","log","bookingEvent","BOOKING_NUMBER","validStatuses","includes","STATUS","data","getExposedBooking","filteredRooms","rooms","filter","room","ID","length","Error","some","transformedBooking","transformNewBooking","otherBookingData","__rest","Object","assign","PHONE_PREFIX","PRIVATE_NOTE","updateBookingEvent","emit","showEventInfo","error","message","componentDidLoad","isNewEvent","hideBubble","setTimeout","async","STATUS_CODE","renderAgain","disconnectedCallback","removeEventListener","cancelAnimationFrame","event","clickedElement","target","element","contains","hideBubbleInfoPopup","detail","currentInfoBubbleId","getBookingId","key","moveBookingToHandler","bookingId","moveToDay","toRoomId","FROM_DATE","fromRoomId","isTouchStart","moveDiffereneX","moveDiffereneY","isBlockUnit","requestAnimationFrame","resetBookingToInitialPosition","pool","to_date","from_date","checkIfSlotOccupied","reallocateEvent","catch","isShrinking","description","status","getModalDescription","hideConfirmButton","oldFromDate","defaultDates","oldToDate","defaultDiffDays","moment","diff","shrinkingDirection","fromDate","toDate","isAfter","isBefore","add","format","subtract","showDialog","title","showRoomNightsDialog","bookingNumber","identifier","IDENTIFIER","toast","position","type","findRoomType","roomId","roomType","roomsInfo","physicalrooms","r","id","is_direct","locales","entries","Lcz_YouWillLoseFutureUpdates","isSame","TO_DATE","initialRT","PR_ID","targetRT","Lcz_AreYouSureWantToMoveAnotherUnit","origin","Label","Lcz_SameRatesWillBeKept","Lcz_CannotChangeCHBookings","Lcz_ConfrmModiication","style","left","initialLeft","width","initialWidth","finalWidth","top","dragInitPos","handleRevertBooking","POOL","fromTime","toTime","isOccupied","allBookingEvents","eventFromTime","eventToTime","isSameOrAfter","renderElement","getUniqueId","Date","getTime","isSplitBooking","SPLIT_BOOKING","isHighlightEventType","getEventType","getBookingStatus","getBookedBy","NAME","getBookedRoomId","getEventStartingDate","getEventEndingDate","event_type","getEventLegend","_a","legendData","statusId","orderRide","color","_b","getLegendOfStatus","aStatusId","getNoteNode","NOTES","INTERNAL_NOTE","getBalanceNode","BALANCE","setStayDays","aStayDays","NO_OF_DAYS","getStayDays","getPosition","startingDate","startingCellClass","getDate","getMonth","getFullYear","bodyContainer","document","querySelector","startingCell","pos","height","getBoundingClientRect","bodyContainerRect","boundingRect","getNumber","aData","parseFloat","startDragging","side","preventDefault","stopPropagation","stopImmediatePropagation","initialX","clientX","touches","initialY","clientY","elementRect","offsetX","offsetY","x","y","dragEndPos","dragOverEventData","offsetWidth","offsetLeft","currentX","distanceX","currentY","distanceY","newWidth","Math","min","max","newLeft","abs","nbOfDays","numberOfDays","round","initialStayDays","isNaN","replace","offset","updateData","updateEventData","calculateHoverPosition","barRect","barWidth","barLeft","screenWidth","innerWidth","hoverLeft","transform","renderEventBookingNumber","channel_booking_nbr","showInfo","midPoint","hideBubbleInfo","render","legend","noteNode","balanceNode","h","Host","class","clsName","backgroundColor","onTouchStart","onMouseDown","Fragment","is_vacation_rental","countryNodeList","currency","bubbleInfoTop","iglBookingEventHoverCss","IglBookingEventHoverStyle0","IglBookingEventHover","todayTimeStamp","setHours","eventService","hideButtons","selectedRt","find","RATE_TYPE","shouldHideUnassignUnit","handleKeyDown","getTotalOccupants","CHILDREN_COUNT","ADULTS_COUNT","Lcz_AdultsCaption","toLowerCase","Lcz_Single_Adult","Lcz_ChildCaption","_c","Lcz_Single_Child","getPhoneNumber","PHONE","getCountry","findCountry","COUNTRY","name","getPhoneCode","phone_prefix","renderPhone","getGuestNote","getInternalNote","getTotalPrice","TOTAL_PRICE","getCheckInDate","FROM_DATE_STR","getCheckOutDate","TO_DATE_STR","getArrivalTime","ARRIVAL_TIME","getRatePlan","RATE_PLAN","getEntryDate","ENTRY_DATE","getReleaseAfterHours","RELEASE_AFTER_HOURS","isNewBooking","isCheckedIn","isCheckedOut","isBlockedDateEvent","getRoomId","getCategoryByRoomId","roomCategory","hasSplitBooking","hasOwnProperty","splitBookingEvents","canCheckIn","fromTimeStamp","dt","toTimeStamp","canCheckOut","handleBlockDateUpdate","opt","handleEditBooking","TITLE","Lcz_EditBookingFor","handleBookingOption","getStringDateFormat","handleAddRoom","from_date_str","to_date_str","eventData","ARRIVAL","ADD_ROOM_TO_BOOKING","ROOMS","GUEST","SOURCE","defaultDateRange","fromDateStr","toDateStr","dateDifference","editabled","handleCustomerCheckIn","handleCustomerCheckOut","handleDeleteEvent","deleteButton","handleUpdateBlockedDates","isLoading","updateBlockedEvent","handleConvertBlockedDateToBooking","getRoomInfo","roomIdToFind","selectedRoom","physicalRoom","CATEGORY","ROOM_NAME","ROOMS_INFO","renderTitle","eventType","roomInfo","Lcz_AddingUnitToBooking","Lcz_Adding","Lcz_NewBookingFor","roomData","showBookingPopup","renderNote","ota_notes","guestNote","noteLabel","Lcz_Note","label","remarks","getInfoElement","src","Icon","alt","_d","formatAmount","symbol","Lcz_Balance","showDateDifference","Lcz_ArrivalTime","Lcz_Occupancy","Lcz_Phone","Lcz_RatePlan","Lcz_PrivateNote","Lcz_InternalRemark","role","onClick","_","Lcz_Edit","IS_EDITABLE","Lcz_AddRoom","Lcz_Unassign","getNewBookingOptions","shouldDisplayButtons","rateplans","rate","is_active","Lcz_CreateNewBooking","Lcz_AssignUnitToExistingBooking","Lcz_NoRatePlanDefined","Lcz_Blockdates","getBlockedView","isEventHover","entryHour","ENTRY_HOUR","entryMinute","ENTRY_MINUTE","defaultData","entryDate","onDataUpdateEvent","disabled","Lcz_Update","Lcz_ConvertToBooking","Lcz_Delete","irPopoverCss","IrPopoverStyle0","IrPopover","handleMouseEnter","showPopover","isHovered","handleMouseLeave","checkTitleWidth","titleElement","el","scrollWidth","irPopoverLeft","onMouseLeave","onMouseEnter","popoverTitle"],"sources":["src/components/igloo-calendar/igl-booking-event/igl-booking-event.css?tag=igl-booking-event&encapsulation=scoped","src/components/igloo-calendar/igl-booking-event/igl-booking-event.tsx","src/components/igloo-calendar/igl-booking-event-hover/igl-booking-event-hover.css?tag=igl-booking-event-hover&encapsulation=scoped","src/components/igloo-calendar/igl-booking-event-hover/igl-booking-event-hover.tsx","src/components/ir-popover/ir-popover.css?tag=ir-popover&encapsulation=scoped","src/components/ir-popover/ir-popover.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  position: absolute;\r\n}\r\n\r\n.bookingEventBase {\r\n  position: absolute;\r\n  background-color: rgb(49, 190, 241);\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 4px;\r\n  transform: skewX(-22deg);\r\n}\r\n\r\n.bookingEventBase.skewedLeft::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0px;\r\n  bottom: 0;\r\n  left: -4px;\r\n  width: 50%;\r\n  height: 100%;\r\n  background-color: var(--ir-event-bg);\r\n  transform-origin: right;\r\n  transform: skewX(22deg);\r\n  border-radius: 4px;\r\n  border-top-left-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n}\r\n.bookingEventBase.skewedRight::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  right: -4px;\r\n  width: 50%;\r\n  height: 100%;\r\n  background-color: var(--ir-event-bg);\r\n  transform-origin: left;\r\n  transform: skewX(22deg);\r\n  border-radius: 4px;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n}\r\n.bookingEventBase.border.skewedLeft::before {\r\n  border: 1px solid #424242;\r\n  border-right: 0;\r\n  border-left: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  top: -1px;\r\n  height: 20px;\r\n  left: -4px;\r\n}\r\n.bookingEventBase.border.skewedRight::before {\r\n  border: 1px solid #424242;\r\n  border-left: 0;\r\n  border-right: 0;\r\n  border-top-left-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n  top: -1px;\r\n  height: 20px;\r\n  right: -4px;\r\n}\r\n.bookingEvent {\r\n  cursor: pointer;\r\n}\r\n.bookingEventBase {\r\n  cursor: pointer;\r\n}\r\n.bookingEventHiddenBase {\r\n  position: absolute;\r\n  top: 0;\r\n  left: -4px;\r\n  width: calc(100% + 8);\r\n}\r\n\r\n.bookingEventDragHandle {\r\n  position: absolute;\r\n  top: 0;\r\n  width: 15px;\r\n  height: 100%;\r\n  opacity: 0.1;\r\n  background-color: rgba(0, 0, 0, 0.15);\r\n  transform: skewX(-22deg);\r\n  border-radius: 4px;\r\n  /* display: none; */\r\n  cursor: pointer;\r\n}\r\n\r\n.splitBooking {\r\n  border-right: 2px solid #000000;\r\n}\r\n\r\n:host:hover .bookingEventDragHandle {\r\n  display: block;\r\n  opacity: 1;\r\n}\r\n\r\n:host.newEvent:hover .bookingEventDragHandle {\r\n  display: none;\r\n  opacity: 1;\r\n}\r\n\r\n.leftSide {\r\n  left: 0;\r\n}\r\n.leftSide.skewedLeft {\r\n  transform: skewX(0);\r\n}\r\n.rightSide.skewedRight {\r\n  transform: skewX(0);\r\n}\r\n.rightSide {\r\n  right: 0;\r\n}\r\n\r\n.bookingEventTitle {\r\n  color: #fff;\r\n  font-size: 0.8em;\r\n  position: relative;\r\n  max-width: calc(100% - 10px);\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  top: 2px;\r\n  left: 5px;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.legend_circle {\r\n  border-radius: 100%;\r\n  width: 10px;\r\n  height: 10px;\r\n  margin: 3px 3px 3px 2px;\r\n  border: 1px solid #fff;\r\n}\r\n\r\n.noteIcon {\r\n  position: absolute;\r\n  bottom: -8px;\r\n  left: 2px;\r\n}\r\n\r\n.balanceIcon {\r\n  position: absolute;\r\n  top: -8px;\r\n  right: 2px;\r\n}\r\n","import { Component, Element, Event, EventEmitter, Fragment, Host, Listen, Prop, State, h } from '@stencil/core';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { transformNewBooking } from '@/utils/booking';\r\nimport { isBlockUnit } from '@/utils/utils';\r\nimport { IReallocationPayload, IRoomNightsData } from '@/models/property-types';\r\nimport moment from 'moment';\r\nimport { IToast } from '@components/ir-toast/toast';\r\nimport { EventsService } from '@/services/events.service';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\n@Component({\r\n  tag: 'igl-booking-event',\r\n  styleUrl: 'igl-booking-event.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingEvent {\r\n  @Element() private element: HTMLElement;\r\n\r\n  @Prop() currency;\r\n  @Prop() is_vacation_rental: boolean = false;\r\n  @Prop() language: string;\r\n  @Prop({ mutable: true }) bookingEvent: { [key: string]: any };\r\n  @Prop() allBookingEvents: { [key: string]: any } = [];\r\n  @Prop() countryNodeList;\r\n\r\n  @Event({ bubbles: true, composed: true }) hideBubbleInfo: EventEmitter;\r\n  @Event() updateEventData: EventEmitter;\r\n  @Event() dragOverEventData: EventEmitter;\r\n  @Event() showRoomNightsDialog: EventEmitter<IRoomNightsData>;\r\n  @Event() showDialog: EventEmitter<IReallocationPayload>;\r\n  @Event() resetStreachedBooking: EventEmitter<string>;\r\n  @Event() toast: EventEmitter<IToast>;\r\n  @Event() updateBookingEvent: EventEmitter<{ [key: string]: any }>;\r\n\r\n  @State() renderElement: boolean = false;\r\n  @State() position: { [key: string]: any };\r\n  @State() isShrinking: boolean | null = null;\r\n\r\n  dayWidth: number = 0;\r\n  eventSpace: number = 8;\r\n\r\n  vertSpace: number = 10;\r\n\r\n  /* show bubble */\r\n  private showInfoPopup: boolean = false;\r\n  private bubbleInfoTopSide: boolean = false;\r\n  private isStreatch = false;\r\n  /*Services */\r\n  private eventsService = new EventsService();\r\n  private bookingService = new BookingService();\r\n  /* Resize props */\r\n  resizeSide: string = '';\r\n  isDragging: boolean = false;\r\n  initialX: number;\r\n  initialY: number;\r\n  currentX: number;\r\n  currentY: number;\r\n  initialWidth: number;\r\n  initialLeft: number;\r\n  finalWidth: number;\r\n  dragInitPos: { [key: string]: any };\r\n  dragEndPos: { [key: string]: any };\r\n  elementRect: { [key: string]: any };\r\n  isTouchStart: boolean;\r\n  moveDiffereneX: number;\r\n  moveDiffereneY: number;\r\n  private animationFrameId: number | null = null;\r\n\r\n  handleMouseMoveBind = this.handleMouseMove.bind(this);\r\n  handleMouseUpBind = this.handleMouseUp.bind(this);\r\n  handleClickOutsideBind = this.handleClickOutside.bind(this);\r\n\r\n  componentWillLoad() {\r\n    this.bookingService.setToken(calendar_data.token);\r\n    this.eventsService.setToken(calendar_data.token);\r\n\r\n    window.addEventListener('click', this.handleClickOutsideBind);\r\n  }\r\n\r\n  async fetchAndAssignBookingData() {\r\n    try {\r\n      console.log('clicked on book#', this.bookingEvent.BOOKING_NUMBER);\r\n\r\n      const validStatuses = ['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'];\r\n      if (!validStatuses.includes(this.bookingEvent.STATUS)) {\r\n        return;\r\n      }\r\n\r\n      const data = await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER, 'en');\r\n      const filteredRooms = data.rooms.filter(room => room['assigned_units_pool'] === this.bookingEvent.ID);\r\n\r\n      if (filteredRooms.length === 0) {\r\n        throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty array`);\r\n      }\r\n\r\n      if (filteredRooms.some(room => room['assigned_units_pool'] === null)) {\r\n        throw new Error(`booking#${this.bookingEvent.BOOKING_NUMBER} has an empty pool`);\r\n      }\r\n\r\n      data.rooms = filteredRooms;\r\n\r\n      const transformedBooking = transformNewBooking(data)[0];\r\n      const { ID, TO_DATE, FROM_DATE, NO_OF_DAYS, STATUS, NAME, IDENTIFIER, PR_ID, POOL, BOOKING_NUMBER, NOTES, is_direct, BALANCE, ...otherBookingData } = transformedBooking;\r\n      this.bookingEvent = { ...otherBookingData, ...this.bookingEvent, PHONE_PREFIX: otherBookingData.PHONE_PREFIX, PRIVATE_NOTE: otherBookingData.PRIVATE_NOTE };\r\n      this.updateBookingEvent.emit(this.bookingEvent);\r\n      this.showEventInfo(true);\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  }\r\n\r\n  componentDidLoad() {\r\n    if (this.isNewEvent()) {\r\n      if (!this.bookingEvent.hideBubble) {\r\n        /* auto matically open the popup, calling the method shows bubble either top or bottom based on available space. */\r\n        setTimeout(async () => {\r\n          if (['003', '002', '004'].includes(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          } else {\r\n            this.showEventInfo(true);\r\n          }\r\n          this.renderAgain();\r\n        }, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    window.removeEventListener('click', this.handleClickOutsideBind);\r\n    if (this.animationFrameId) {\r\n      cancelAnimationFrame(this.animationFrameId);\r\n    }\r\n  }\r\n\r\n  @Listen('click', { target: 'window' })\r\n  handleClickOutside(event: Event) {\r\n    const clickedElement = event.target as HTMLElement;\r\n    // Check if the clicked element is not within the target div\r\n    if (!this.element.contains(clickedElement)) {\r\n      // The click occurred outside the target div\r\n      this.showEventInfo(false);\r\n    }\r\n  }\r\n\r\n  @Listen('hideBubbleInfo', { target: 'window' })\r\n  hideBubbleInfoPopup(event: CustomEvent) {\r\n    if (event.detail.currentInfoBubbleId != this.getBookingId() || (event.detail.key === 'hidebubble' && event.detail.currentInfoBubbleId === this.getBookingId())) {\r\n      this.showInfoPopup = false;\r\n      this.renderAgain();\r\n    }\r\n  }\r\n\r\n  @Listen('moveBookingTo', { target: 'window' })\r\n  async moveBookingToHandler(event: CustomEvent) {\r\n    try {\r\n      if (event.detail.bookingId !== this.getBookingId()) {\r\n        this.showEventInfo(false);\r\n        return;\r\n      }\r\n\r\n      if (event.detail.moveToDay === 'revert' || event.detail.toRoomId === 'revert') {\r\n        event.detail.moveToDay = this.bookingEvent.FROM_DATE;\r\n        event.detail.toRoomId = event.detail.fromRoomId;\r\n        if (this.isTouchStart && this.moveDiffereneX <= 5 && this.moveDiffereneY <= 5 && !this.isStreatch) {\r\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          }\r\n        } else {\r\n          this.animationFrameId = requestAnimationFrame(() => {\r\n            this.resetBookingToInitialPosition();\r\n          });\r\n          return;\r\n        }\r\n      } else {\r\n        if (this.isTouchStart && this.moveDiffereneX <= 5 && this.moveDiffereneY <= 5 && !this.isStreatch) {\r\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          }\r\n        } else {\r\n          const { pool, to_date, from_date, toRoomId } = event.detail as any;\r\n          if (this.checkIfSlotOccupied(toRoomId, from_date, to_date)) {\r\n            this.animationFrameId = requestAnimationFrame(() => {\r\n              this.resetBookingToInitialPosition();\r\n            });\r\n            throw new Error('Overlapping Dates');\r\n          }\r\n          if (pool) {\r\n            if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n              // let fromDate = moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(moment(new Date(from_date)))\r\n              //   ? this.bookingEvent.defaultDates.from_date\r\n              //   : from_date;\r\n              // console.log('room', fromDate, this.bookingEvent.defaultDates.from_date, from_date);\r\n              await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date).catch(() => {\r\n                this.resetBookingToInitialPosition();\r\n              });\r\n            } else {\r\n              if (this.isShrinking || !this.isStreatch) {\r\n                // try {\r\n                //   if (this.bookingEvent.PR_ID.toString() === toRoomId.toString()) {\r\n                //     await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date);\r\n                //     return;\r\n                //   }\r\n                // } catch (error) {\r\n                //   this.resetBookingToInitialPosition();\r\n                //   return;\r\n                // }\r\n                const { description, status } = this.getModalDescription(toRoomId, from_date, to_date);\r\n                let hideConfirmButton = false;\r\n                if (status === '400') {\r\n                  hideConfirmButton = true;\r\n                }\r\n                const oldFromDate = this.bookingEvent.defaultDates.from_date;\r\n                const oldToDate = this.bookingEvent.defaultDates.to_date;\r\n                const defaultDiffDays = moment(oldToDate, 'YYYY-MM-DD').diff(moment(oldFromDate, 'YYYY-MM-DD'), 'days');\r\n\r\n                let shrinkingDirection = null;\r\n                let fromDate = oldFromDate;\r\n                let toDate = oldToDate;\r\n                if (this.isShrinking) {\r\n                  if (moment(from_date, 'YYYY-MM-DD').isAfter(moment(oldFromDate, 'YYYY-MM-DD')) && moment(to_date, 'YYYY-MM-DD').isBefore(moment(oldToDate, 'YYYY-MM-DD'))) {\r\n                    fromDate = oldFromDate;\r\n                    toDate = to_date;\r\n                  } else {\r\n                    shrinkingDirection = moment(from_date, 'YYYY-MM-DD').isAfter(moment(oldFromDate, 'YYYY-MM-DD'))\r\n                      ? 'left'\r\n                      : moment(to_date, 'YYYY-MM-DD').isBefore(moment(oldToDate, 'YYYY-MM-DD'))\r\n                      ? 'right'\r\n                      : null;\r\n                    if (shrinkingDirection === 'left') {\r\n                      fromDate = from_date;\r\n                    }\r\n\r\n                    if (shrinkingDirection === 'right') {\r\n                      toDate = to_date;\r\n                    }\r\n                  }\r\n                } else {\r\n                  if (moment(from_date, 'YYYY-MM-DD').isBefore(moment(oldFromDate, 'YYYY-MM-DD'))) {\r\n                    fromDate = from_date;\r\n                    toDate = moment(from_date, 'YYYY-MM-DD').add(defaultDiffDays, 'days').format('YYYY-MM-DD');\r\n                  } else if (moment(to_date, 'YYYY-MM-DD').isAfter(moment(oldToDate, 'YYYY-MM-DD'))) {\r\n                    toDate = to_date;\r\n                    fromDate = moment(to_date, 'YYYY-MM-DD').subtract(defaultDiffDays, 'days').format('YYYY-MM-DD');\r\n                  }\r\n                }\r\n                this.showDialog.emit({ ...event.detail, description, title: '', hideConfirmButton, from_date: fromDate, to_date: toDate });\r\n              } else {\r\n                // if (this.checkIfSlotOccupied(toRoomId, from_date, to_date)) {\r\n                //   this.animationFrameId = requestAnimationFrame(() => {\r\n                //     this.resetBookingToInitialPosition();\r\n                //   });\r\n                //   throw new Error('Overlapping Dates');\r\n                // } else {\r\n                this.showRoomNightsDialog.emit({\r\n                  bookingNumber: this.bookingEvent.BOOKING_NUMBER,\r\n                  identifier: this.bookingEvent.IDENTIFIER,\r\n                  to_date,\r\n                  pool,\r\n                  from_date,\r\n                  defaultDates: this.bookingEvent.defaultDates,\r\n                });\r\n                // }\r\n              }\r\n            }\r\n            this.isShrinking = null;\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      this.toast.emit({\r\n        position: 'top-right',\r\n        title: error.message,\r\n        description: '',\r\n        type: 'error',\r\n      });\r\n      console.log('something went wrong');\r\n    }\r\n  }\r\n  private getModalDescription(toRoomId: number, from_date, to_date): { status: '200' | '400'; description: string } {\r\n    const findRoomType = (roomId: number) => {\r\n      let roomType = this.bookingEvent.roomsInfo.filter(room => room.physicalrooms.some(r => r.id === +roomId));\r\n      if (roomType.length) {\r\n        return roomType[0].id;\r\n      }\r\n      return null;\r\n    };\r\n    if (!this.bookingEvent.is_direct) {\r\n      if (this.isShrinking) {\r\n        return {\r\n          description: `${locales.entries.Lcz_YouWillLoseFutureUpdates}.`,\r\n          status: '200',\r\n        };\r\n      } else {\r\n        if (\r\n          moment(from_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.FROM_DATE, 'YYYY-MM-DD')) &&\r\n          moment(to_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD'))\r\n        ) {\r\n          const initialRT = findRoomType(this.bookingEvent.PR_ID);\r\n          const targetRT = findRoomType(toRoomId);\r\n          if (initialRT === targetRT) {\r\n            return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\r\n          } else {\r\n            return {\r\n              description: `${locales.entries.Lcz_YouWillLoseFutureUpdates} ${this.bookingEvent.origin ? this.bookingEvent.origin.Label : ''}. ${\r\n                locales.entries.Lcz_SameRatesWillBeKept\r\n              }`,\r\n              status: '200',\r\n            };\r\n          }\r\n        }\r\n        return { description: locales.entries.Lcz_CannotChangeCHBookings, status: '400' };\r\n      }\r\n    } else {\r\n      if (!this.isShrinking) {\r\n        const initialRT = findRoomType(this.bookingEvent.PR_ID);\r\n        const targetRT = findRoomType(toRoomId);\r\n        if (initialRT === targetRT) {\r\n          console.log('same rt');\r\n          return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\r\n        } else {\r\n          return {\r\n            description: locales.entries.Lcz_SameRatesWillBeKept,\r\n            status: '200',\r\n          };\r\n        }\r\n      }\r\n      return { description: locales.entries.Lcz_ConfrmModiication, status: '200' };\r\n    }\r\n  }\r\n  private resetBookingToInitialPosition() {\r\n    if (this.isStreatch) {\r\n      this.element.style.left = `${this.initialLeft}px`;\r\n      this.element.style.width = `${this.initialWidth}px`;\r\n      this.isStreatch = false;\r\n      this.finalWidth = this.initialWidth;\r\n      this.isShrinking = null;\r\n    } else {\r\n      this.element.style.top = `${this.dragInitPos.top}px`;\r\n      this.element.style.left = `${this.dragInitPos.left}px`;\r\n    }\r\n  }\r\n  @Listen('revertBooking', { target: 'window' })\r\n  handleRevertBooking(event: CustomEvent<string>) {\r\n    if (this.bookingEvent.POOL === event.detail) {\r\n      this.resetBookingToInitialPosition();\r\n    }\r\n  }\r\n  checkIfSlotOccupied(toRoomId, from_date, to_date) {\r\n    const fromTime = moment(from_date, 'YYYY-MM-DD');\r\n    const toTime = moment(to_date, 'YYYY-MM-DD');\r\n    const isOccupied = this.allBookingEvents.some(event => {\r\n      if (event.POOL === this.bookingEvent.POOL) {\r\n        return false;\r\n      }\r\n      const eventFromTime = moment(event.FROM_DATE, 'YYYY-MM-DD').add(1, 'days');\r\n      const eventToTime = moment(event.TO_DATE, 'YYYY-MM-DD');\r\n      return event.PR_ID === +toRoomId && toTime.isSameOrAfter(eventFromTime) && fromTime.isBefore(eventToTime);\r\n    });\r\n    return isOccupied;\r\n  }\r\n\r\n  renderAgain() {\r\n    this.renderElement = !this.renderElement;\r\n  }\r\n\r\n  getUniqueId() {\r\n    return new Date().getTime();\r\n  }\r\n\r\n  isSplitBooking() {\r\n    return !!this.bookingEvent.SPLIT_BOOKING;\r\n  }\r\n\r\n  isNewEvent() {\r\n    return this.getBookingId() === 'NEW_TEMP_EVENT';\r\n  }\r\n\r\n  isHighlightEventType() {\r\n    return this.getEventType() === 'HIGH_LIGHT';\r\n  }\r\n\r\n  getBookingId() {\r\n    return this.bookingEvent.ID;\r\n  }\r\n\r\n  getBookingStatus() {\r\n    return this.bookingEvent.STATUS;\r\n  }\r\n\r\n  getBookedBy() {\r\n    return this.bookingEvent.NAME;\r\n  }\r\n\r\n  getBookedRoomId() {\r\n    return this.bookingEvent.PR_ID;\r\n  }\r\n\r\n  getEventStartingDate() {\r\n    return new Date(this.bookingEvent.FROM_DATE);\r\n  }\r\n\r\n  getEventEndingDate() {\r\n    return new Date(this.bookingEvent.TO_DATE);\r\n  }\r\n\r\n  getEventType() {\r\n    return this.bookingEvent.event_type;\r\n  }\r\n\r\n  getEventLegend() {\r\n    // console.log(this.getBookingStatus());\r\n    let status = this.bookingEvent?.legendData.statusId[this.getBookingStatus()];\r\n    let orderRide = this.isNewEvent() ? { color: '#f9f9c9' } : {};\r\n    return {\r\n      ...this.bookingEvent?.legendData[status.id],\r\n      ...status,\r\n      ...orderRide,\r\n    };\r\n  }\r\n\r\n  getLegendOfStatus(aStatusId) {\r\n    // console.log(aStatusId);\r\n    let status = this.bookingEvent?.legendData.statusId[aStatusId];\r\n    return { ...this.bookingEvent.legendData[status.id], ...status };\r\n  }\r\n\r\n  getNoteNode() {\r\n    if (this.bookingEvent.NOTES || this.bookingEvent.INTERNAL_NOTE || this.bookingEvent.PRIVATE_NOTE) {\r\n      return this.getLegendOfStatus('NOTES');\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getBalanceNode() {\r\n    if (this.bookingEvent.BALANCE !== null && this.bookingEvent.BALANCE >= 1) {\r\n      return this.getLegendOfStatus('OUTSTANDING-BALANCE');\r\n    }\r\n    return null;\r\n  }\r\n\r\n  setStayDays(aStayDays: number) {\r\n    this.bookingEvent.NO_OF_DAYS = aStayDays;\r\n    this.renderAgain();\r\n    // this.updateData({id: this.getBookedRoomId(), data: { NO_OF_DAYS: aStayDays }});\r\n  }\r\n\r\n  getStayDays() {\r\n    return this.bookingEvent.NO_OF_DAYS;\r\n  }\r\n\r\n  getPosition() {\r\n    let startingDate = this.getEventStartingDate();\r\n    let startingCellClass = '.room_' + this.getBookedRoomId() + '_' + startingDate.getDate() + '_' + (startingDate.getMonth() + 1) + '_' + startingDate.getFullYear();\r\n    let bodyContainer = document.querySelector('.bodyContainer');\r\n    let startingCell = document.querySelector(startingCellClass);\r\n    let pos = { top: '0', left: '0', width: '0', height: '20px' };\r\n    if (startingCell && bodyContainer && startingCell.getBoundingClientRect() && bodyContainer.getBoundingClientRect()) {\r\n      let bodyContainerRect = bodyContainer.getBoundingClientRect();\r\n      let boundingRect = startingCell.getBoundingClientRect();\r\n      this.dayWidth = this.dayWidth || boundingRect.width;\r\n      pos.top = boundingRect.top + boundingRect.height / 2 - this.vertSpace - bodyContainerRect.top + 'px';\r\n      // pos.left = boundingRect.left + this.dayWidth / 2 + this.eventSpace / 2 - bodyContainerRect.left + 'px';\r\n      // pos.width = this.getStayDays() * this.dayWidth - this.eventSpace + 'px';\r\n      pos.left =\r\n        boundingRect.left +\r\n        (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 0 : this.dayWidth / 2) +\r\n        this.eventSpace / 2 -\r\n        bodyContainerRect.left +\r\n        'px';\r\n      pos.width =\r\n        (this.getStayDays() + (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 0.5 : 0)) *\r\n          this.dayWidth -\r\n        this.eventSpace +\r\n        'px';\r\n    } else {\r\n      console.log(this.bookingEvent);\r\n      console.log('Locating event cell failed ', startingCellClass);\r\n    }\r\n    //console.log(pos);\r\n    return pos;\r\n  }\r\n\r\n  getNumber(aData) {\r\n    return aData ? parseFloat(aData) : 0;\r\n  }\r\n\r\n  startDragging(event: any, side: string) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    event.stopImmediatePropagation();\r\n\r\n    if (this.isNewEvent() || this.isHighlightEventType()) {\r\n      return null;\r\n    }\r\n\r\n    this.resizeSide = side;\r\n    this.isDragging = true;\r\n\r\n    this.showEventInfo(false);\r\n    this.isStreatch = side !== 'move';\r\n    if (side === 'move') {\r\n      this.initialX = event.clientX || event.touches[0].clientX;\r\n      this.initialY = event.clientY || event.touches[0].clientY;\r\n      this.elementRect = this.element.getBoundingClientRect();\r\n      const offsetX = 0;\r\n      const offsetY = 0;\r\n      this.dragInitPos = {\r\n        id: this.getBookingId(),\r\n        fromRoomId: this.getBookedRoomId(),\r\n        top: this.getNumber(this.element.style.top) + offsetY,\r\n        left: this.getNumber(this.element.style.left) + offsetX,\r\n      };\r\n      this.dragInitPos.x = this.dragInitPos.left;\r\n      this.dragInitPos.y = this.dragInitPos.top;\r\n      this.dragEndPos = { ...this.dragInitPos };\r\n      this.element.style.top = `${this.dragInitPos.top}px`;\r\n      this.element.style.left = `${this.dragInitPos.left}px`;\r\n      this.isTouchStart = true; // !!(event.touches && event.touches.length);\r\n      this.dragOverEventData.emit({\r\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\r\n        data: this.dragInitPos,\r\n      });\r\n    } else {\r\n      this.initialWidth = this.element.offsetWidth;\r\n      this.initialLeft = this.element.offsetLeft;\r\n      this.initialX = event.clientX || event.touches[0].clientX;\r\n      this.dragOverEventData.emit({\r\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\r\n        data: {\r\n          id: this.getBookingId(),\r\n          fromRoomId: this.getBookedRoomId(),\r\n          top: this.getNumber(this.element.style.top),\r\n          left: this.initialLeft,\r\n          x: this.initialX,\r\n          y: event.clientY || event.touches[0].clientY,\r\n        },\r\n      });\r\n    }\r\n\r\n    document.addEventListener('mousemove', this.handleMouseMoveBind);\r\n    document.addEventListener('touchmove', this.handleMouseMoveBind);\r\n    document.addEventListener('pointermove', this.handleMouseMoveBind);\r\n\r\n    document.addEventListener('mouseup', this.handleMouseUpBind);\r\n    document.addEventListener('touchup', this.handleMouseUpBind);\r\n    document.addEventListener('pointerup', this.handleMouseUpBind);\r\n  }\r\n\r\n  handleMouseMove(event: any) {\r\n    if (this.isDragging) {\r\n      this.currentX = event.clientX || event.touches[0].clientX;\r\n      let distanceX = this.currentX - this.initialX;\r\n      if (this.resizeSide === 'move') {\r\n        this.currentY = event.clientY || event.touches[0].clientY;\r\n        let distanceY = this.currentY - this.initialY;\r\n        this.element.style.top = `${this.dragInitPos.top + distanceY}px`;\r\n        this.element.style.left = `${this.dragInitPos.left + distanceX}px`;\r\n        this.dragEndPos = {\r\n          id: this.getBookingId(),\r\n          fromRoomId: this.getBookedRoomId(),\r\n          top: this.dragInitPos.top + distanceY,\r\n          left: this.dragInitPos.left + distanceX,\r\n        };\r\n        this.dragEndPos.x = this.dragEndPos.left; // + 18;\r\n        this.dragEndPos.y = this.dragEndPos.top; // + (this.elementRect.height/2);\r\n        this.dragOverEventData.emit({ id: 'DRAG_OVER', data: this.dragEndPos });\r\n      } else {\r\n        if (!this.bookingEvent.is_direct && !isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n          return;\r\n        }\r\n        let newWidth = this.initialWidth;\r\n        if (this.resizeSide == 'rightSide') {\r\n          newWidth = this.initialWidth + distanceX;\r\n          newWidth = Math.min(newWidth, this.initialX + this.element.offsetWidth);\r\n          newWidth = Math.max(this.dayWidth - this.eventSpace, newWidth);\r\n          this.element.style.width = `${newWidth}px`;\r\n          this.isShrinking = distanceX < 0;\r\n        } else if (this.resizeSide == 'leftSide') {\r\n          this.isShrinking = distanceX > 0;\r\n          newWidth = Math.max(this.dayWidth - this.eventSpace, this.initialWidth - distanceX);\r\n          let newLeft = this.initialLeft + (this.initialWidth - newWidth);\r\n          this.element.style.left = `${newLeft}px`;\r\n          this.element.style.width = `${newWidth}px`;\r\n        }\r\n        this.finalWidth = newWidth;\r\n      }\r\n    } else {\r\n      console.log('still mouse move listening...');\r\n    }\r\n  }\r\n\r\n  handleMouseUp() {\r\n    if (this.isDragging) {\r\n      if (this.resizeSide === 'move') {\r\n        // console.log(\"Initial X::\"+this.dragInitPos.x);\r\n        // console.log(\"Initial Y::\"+this.dragInitPos.y);\r\n        // console.log(\"End X::\"+this.dragEndPos.x);\r\n        // console.log(\"End Y::\"+this.dragEndPos.y);\r\n        if (this.isTouchStart) {\r\n          this.moveDiffereneX = Math.abs(this.dragEndPos.x - this.dragInitPos.x);\r\n          this.moveDiffereneY = Math.abs(this.dragEndPos.y - this.dragInitPos.y);\r\n        }\r\n        this.dragOverEventData.emit({\r\n          id: 'DRAG_OVER_END',\r\n          data: {\r\n            ...this.dragEndPos,\r\n            pool: this.bookingEvent.POOL,\r\n            nbOfDays: this.bookingEvent.NO_OF_DAYS,\r\n          },\r\n        });\r\n      } else {\r\n        const finalWidth =\r\n          this.finalWidth -\r\n          (!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? this.dayWidth / 2 : 0);\r\n        const numberOfDays = Math.round(finalWidth / this.dayWidth);\r\n        console.log(finalWidth, this.dayWidth, numberOfDays);\r\n        let initialStayDays = this.getStayDays();\r\n        if (initialStayDays != numberOfDays && !isNaN(numberOfDays)) {\r\n          //this.setStayDays(numberOfDays);\r\n          if (this.resizeSide == 'leftSide') {\r\n            this.element.style.left = `${this.initialLeft + (initialStayDays - numberOfDays) * this.dayWidth}px`;\r\n            // set FROM_DATE = TO_DATE - numberOfDays\r\n          } else {\r\n            if (numberOfDays < initialStayDays) {\r\n              this.isShrinking = true;\r\n            }\r\n            // set TO_DATE = FROM_DATE + numberOfDays\r\n          }\r\n          // const nbrOfDays =\r\n          // !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? numberOfDays - 1 : numberOfDays;\r\n          this.dragOverEventData.emit({\r\n            id: 'STRETCH_OVER_END',\r\n            data: {\r\n              id: this.getBookingId(),\r\n              fromRoomId: +this.getBookedRoomId(),\r\n              x: +this.element.style.left.replace('px', ''),\r\n              y: +this.element.style.top.replace('px', ''),\r\n              pool: this.bookingEvent.POOL,\r\n              nbOfDays: numberOfDays,\r\n            },\r\n          });\r\n          const offset = !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? +this.dayWidth / 2 : 0;\r\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace + offset}px`;\r\n        } else {\r\n          this.element.style.left = `${this.initialLeft}px`;\r\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace}px`;\r\n        }\r\n      }\r\n    } else {\r\n      console.log('still mouse up listening...');\r\n    }\r\n    this.isDragging = false;\r\n\r\n    document.removeEventListener('mousemove', this.handleMouseMoveBind);\r\n    document.removeEventListener('touchmove', this.handleMouseMoveBind);\r\n    document.removeEventListener('pointermove', this.handleMouseMoveBind);\r\n\r\n    document.removeEventListener('mouseup', this.handleMouseUpBind);\r\n    document.removeEventListener('touchup', this.handleMouseUpBind);\r\n    document.removeEventListener('pointerup', this.handleMouseUpBind);\r\n  }\r\n\r\n  updateData(data: any) {\r\n    this.updateEventData.emit(data);\r\n  }\r\n  private calculateHoverPosition() {\r\n    const barRect = this.element.getBoundingClientRect();\r\n    const barWidth = barRect.width;\r\n    const barLeft = barRect.left;\r\n    const screenWidth = window.innerWidth;\r\n\r\n    let hoverLeft;\r\n\r\n    if (barWidth <= screenWidth) {\r\n      hoverLeft = barWidth / 2;\r\n    } else {\r\n      hoverLeft = screenWidth / 2 - barLeft;\r\n    }\r\n    return {\r\n      position: 'absolute',\r\n      left: `${hoverLeft}px`,\r\n      transform: 'translateX(-50%)',\r\n    };\r\n  }\r\n  renderEventBookingNumber() {\r\n    if (this.bookingEvent.STATUS === 'TEMP-EVENT' || this.bookingEvent.ID === 'NEW_TEMP_EVENT') {\r\n      return '';\r\n    }\r\n    if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n      return '';\r\n    }\r\n    if (!this.bookingEvent.is_direct) {\r\n      return ` - ${this.bookingEvent.channel_booking_nbr}`;\r\n    }\r\n    return ` - ${this.bookingEvent.BOOKING_NUMBER}`;\r\n  }\r\n  showEventInfo(showInfo) {\r\n    // if (this.isHighlightEventType() || this.bookingEvent.hideBubble) {\r\n    //   return null;\r\n    // }\r\n\r\n    // if (showInfo) {\r\n    //   // Calculate which side we need to show the bubble, top side or bottom.\r\n    //   let bodyContainer = document.querySelector('.calendarScrollContainer');\r\n    //   let bodyContainerRect: { [key: string]: any } = bodyContainer.getBoundingClientRect();\r\n    //   let elementRect: { [key: string]: any } = this.element.getBoundingClientRect();\r\n    //   let midPoint = bodyContainerRect.height / 2 + bodyContainerRect.top + 50;\r\n    //   // let topDifference = elementRect.top - bodyContainerRect.top;\r\n    //   // let bottomDifference = bodyContainerRect.bottom - elementRect.bottom;\r\n\r\n    //   if (elementRect.top < midPoint) {\r\n    //     this.bubbleInfoTopSide = false;\r\n    //   } else {\r\n    //     this.bubbleInfoTopSide = true;\r\n    //   }\r\n    // }\r\n\r\n    // // showInfo = true;\r\n    // if (showInfo) {\r\n    //   this.hideBubbleInfo.emit({\r\n    //     key: 'hidePopup',\r\n    //     currentInfoBubbleId: this.getBookingId(),\r\n    //   });\r\n    // }\r\n    // this.showInfoPopup = showInfo;\r\n    // this.renderAgain();\r\n    if (this.isHighlightEventType() || this.bookingEvent.hideBubble) {\r\n      return null;\r\n    }\r\n\r\n    if (showInfo) {\r\n      // Calculate which side we need to show the bubble, top side or bottom.\r\n      let bodyContainer = document.querySelector('.calendarScrollContainer');\r\n      let bodyContainerRect: { [key: string]: any } = bodyContainer.getBoundingClientRect();\r\n      let elementRect: { [key: string]: any } = this.element.getBoundingClientRect();\r\n      let midPoint = bodyContainerRect.height / 2 + bodyContainerRect.top + 50;\r\n\r\n      if (elementRect.top < midPoint) {\r\n        this.bubbleInfoTopSide = false;\r\n      } else {\r\n        this.bubbleInfoTopSide = true;\r\n      }\r\n    }\r\n\r\n    if (showInfo) {\r\n      this.hideBubbleInfo.emit({\r\n        key: 'hidePopup',\r\n        currentInfoBubbleId: this.getBookingId(),\r\n      });\r\n    }\r\n    this.showInfoPopup = showInfo;\r\n    this.renderAgain();\r\n  }\r\n\r\n  render() {\r\n    // onMouseLeave={()=>this.showEventInfo(false)}\r\n    let legend = this.getEventLegend();\r\n    let noteNode = this.getNoteNode();\r\n    let balanceNode = this.getBalanceNode();\r\n    // console.log(this.bookingEvent.BOOKING_NUMBER === '46231881' ? this.bookingEvent : '');\r\n    return (\r\n      <Host\r\n        class={`bookingEvent  ${this.isNewEvent() || this.isHighlightEventType() ? 'newEvent' : ''} ${legend.clsName} `}\r\n        style={this.getPosition()}\r\n        id={'event_' + this.getBookingId()}\r\n      >\r\n        {/* onMouseOver={() =>this.showEventInfo(true)}  */}\r\n        <div\r\n          class={`bookingEventBase ${\r\n            !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 'skewedLeft' : ''\r\n          }\r\n          ${!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)) ? 'skewedRight' : ''}\r\n          ${\r\n            !this.bookingEvent.is_direct &&\r\n            !isBlockUnit(this.bookingEvent.STATUS_CODE) &&\r\n            this.bookingEvent.STATUS !== 'TEMP-EVENT' &&\r\n            this.bookingEvent.ID !== 'NEW_TEMP_EVENT' &&\r\n            'border border-dark'\r\n          }  ${this.isSplitBooking() ? 'splitBooking' : ''}`}\r\n          style={{ 'backgroundColor': legend.color, '--ir-event-bg': legend.color }}\r\n          onTouchStart={event => this.startDragging(event, 'move')}\r\n          onMouseDown={event => this.startDragging(event, 'move')}\r\n        ></div>\r\n        {noteNode ? <div class=\"legend_circle noteIcon\" style={{ backgroundColor: noteNode.color }}></div> : null}\r\n        {balanceNode ? <div class=\"legend_circle balanceIcon\" style={{ backgroundColor: balanceNode.color }}></div> : null}\r\n        {/* onMouseOver={() => this.showEventInfo(true)}  */}\r\n        <div class=\"bookingEventTitle\" onTouchStart={event => this.startDragging(event, 'move')} onMouseDown={event => this.startDragging(event, 'move')}>\r\n          {this.getBookedBy()}\r\n          {this.renderEventBookingNumber()}\r\n        </div>\r\n\r\n        <Fragment>\r\n          <div\r\n            class={`bookingEventDragHandle leftSide ${\r\n              !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 'skewedLeft' : ''\r\n            }\r\n            ${!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)) ? 'skewedRight' : ''}`}\r\n            onTouchStart={event => this.startDragging(event, 'leftSide')}\r\n            onMouseDown={event => this.startDragging(event, 'leftSide')}\r\n          ></div>\r\n          <div\r\n            class={`bookingEventDragHandle rightSide ${\r\n              !this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.from_date)).isBefore(new Date(this.bookingEvent.FROM_DATE)) ? 'skewedLeft' : ''\r\n            }\r\n              ${!this.isNewEvent() && moment(new Date(this.bookingEvent.defaultDates.to_date)).isAfter(new Date(this.bookingEvent.TO_DATE)) ? 'skewedRight' : ''}`}\r\n            onTouchStart={event => this.startDragging(event, 'rightSide')}\r\n            onMouseDown={event => this.startDragging(event, 'rightSide')}\r\n          ></div>\r\n        </Fragment>\r\n\r\n        {this.showInfoPopup ? (\r\n          <igl-booking-event-hover\r\n            is_vacation_rental={this.is_vacation_rental}\r\n            countryNodeList={this.countryNodeList}\r\n            currency={this.currency}\r\n            class=\"top\"\r\n            bookingEvent={this.bookingEvent}\r\n            bubbleInfoTop={this.bubbleInfoTopSide}\r\n            style={this.calculateHoverPosition()}\r\n          ></igl-booking-event-hover>\r\n        ) : null}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  position: relative;\r\n  z-index: 100;\r\n}\r\n\r\n.btn {\r\n  padding-left: 4px !important;\r\n  padding-right: 4px !important;\r\n}\r\n.balance_amount {\r\n  color: #ff4961;\r\n  font-size: 0.75rem;\r\n}\r\n.user-notes {\r\n  margin-left: 4px;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 5;\r\n  line-clamp: 5;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: auto;\r\n}\r\n.events_btns {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5rem;\r\n}\r\n.mx-01 {\r\n  --m: 5px;\r\n  margin-left: var(--m) !important;\r\n  margin-right: var(--m) !important;\r\n}\r\n\r\n.pointerContainerTop {\r\n  top: -26px;\r\n}\r\n\r\n.pointerContainer {\r\n  position: absolute;\r\n  height: 10px;\r\n  width: 350px;\r\n  left: var(--el-left, 50%);\r\n  transform: translateX(-50%);\r\n}\r\n\r\n.iglPopOver {\r\n  /* max-width: 350px; */\r\n  position: absolute;\r\n  background-color: #fff;\r\n  padding: 10px;\r\n  border: 1px solid #656ee7;\r\n  border-radius: 6px;\r\n  left: var(--el-left, 50%);\r\n  transform: translateX(-50%) translateY(10px);\r\n  box-shadow: 1px 0px 20px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.iglPopOver.infoBubble {\r\n  width: 350px;\r\n}\r\n\r\n.iglPopOver.blockedView {\r\n  max-width: 400px;\r\n  width: 400px;\r\n}\r\n\r\n.iglPopOver.newBookingOptions {\r\n  overflow-wrap: break-word !important;\r\n  min-width: 230px;\r\n  width: fit-content;\r\n}\r\n\r\n.bubblePointer {\r\n  position: absolute;\r\n  width: 0;\r\n  height: 0;\r\n  left: 50%;\r\n  border-left: 10px solid transparent;\r\n  border-right: 10px solid transparent;\r\n  transform: translate(-50%, 0px);\r\n}\r\n\r\n.bubblePointTop {\r\n  border-top: 10px solid #656ee7;\r\n}\r\n\r\n.bubblePointBottom {\r\n  border-bottom: 10px solid #656ee7;\r\n}\r\n\r\n.bubbleInfoAbove {\r\n  bottom: 35px;\r\n}\r\n\r\n.updateBtnIcon {\r\n  margin-right: 4px;\r\n}\r\n.icon-image {\r\n  height: 1.5rem;\r\n  width: 1.5rem;\r\n  margin-right: 5px;\r\n}\r\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Element, Fragment } from '@stencil/core';\r\nimport { findCountry, formatAmount } from '@/utils/utils';\r\nimport { ICountry } from '@/models/IBooking';\r\nimport { EventsService } from '@/services/events.service';\r\nimport moment from 'moment';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data from '@/stores/calendar-data';\r\n//import { transformNewBLockedRooms } from '../../../utils/booking';\r\n\r\n@Component({\r\n  tag: 'igl-booking-event-hover',\r\n  styleUrl: 'igl-booking-event-hover.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingEventHover {\r\n  @Prop({ mutable: true }) bookingEvent: { [key: string]: any };\r\n  @Prop() bubbleInfoTop: boolean = false;\r\n  @Prop() currency;\r\n  @Prop() countryNodeList: ICountry[];\r\n  @Prop() is_vacation_rental: boolean = false;\r\n  @State() isLoading: string;\r\n\r\n  @Event() showBookingPopup: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) hideBubbleInfo: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) deleteButton: EventEmitter<string>;\r\n  @Event() bookingCreated: EventEmitter<{ pool?: string; data: any[] }>;\r\n  @Element() element;\r\n  private fromTimeStamp: number;\r\n  private toTimeStamp: number;\r\n  private todayTimeStamp: number = new Date().setHours(0, 0, 0, 0);\r\n  private eventService = new EventsService();\r\n  private hideButtons = false;\r\n  @State() shouldHideUnassignUnit = false;\r\n  componentWillLoad() {\r\n    // console.log('this.bookingEvent', this.bookingEvent);\r\n    this.eventService.setToken(calendar_data.token);\r\n    let selectedRt = this.bookingEvent.roomsInfo.find(r => r.id === this.bookingEvent.RATE_TYPE);\r\n    if (selectedRt) {\r\n      console.log(selectedRt.physicalrooms.length === 1);\r\n      this.shouldHideUnassignUnit = selectedRt.physicalrooms.length === 1;\r\n    }\r\n    if (moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD').isBefore(moment())) {\r\n      this.hideButtons = true;\r\n    }\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n  }\r\n\r\n  handleKeyDown(event: KeyboardEvent) {\r\n    if (event.key === 'Escape') {\r\n      this.hideBubble();\r\n    } else return;\r\n  }\r\n\r\n  hideBubble() {\r\n    this.hideBubbleInfo.emit({\r\n      key: 'hidebubble',\r\n      currentInfoBubbleId: this.getBookingId(),\r\n    });\r\n    document.removeEventListener('keydown', this.handleKeyDown);\r\n  }\r\n  componentDidLoad() {\r\n    document.addEventListener('keydown', this.handleKeyDown);\r\n  }\r\n  disconnectedCallback() {\r\n    document.removeEventListener('keydown', this.handleKeyDown);\r\n  }\r\n  getBookingId() {\r\n    return this.bookingEvent.ID;\r\n  }\r\n\r\n  getTotalOccupants() {\r\n    const { CHILDREN_COUNT, ADULTS_COUNT } = this.bookingEvent;\r\n    if (CHILDREN_COUNT === 0) {\r\n      return `${ADULTS_COUNT} ${ADULTS_COUNT > 1 ? locales.entries.Lcz_AdultsCaption.toLowerCase() : locales.entries.Lcz_Single_Adult?.toLowerCase()}`;\r\n    }\r\n    return `${ADULTS_COUNT} ${ADULTS_COUNT > 1 ? locales.entries.Lcz_AdultsCaption.toLowerCase() : locales.entries.Lcz_Single_Adult?.toLowerCase()}, ${CHILDREN_COUNT} ${\r\n      CHILDREN_COUNT > 1 ? locales.entries.Lcz_ChildCaption.toLowerCase() : locales.entries.Lcz_Single_Child?.toLowerCase()\r\n    }`;\r\n  }\r\n\r\n  getPhoneNumber() {\r\n    return this.bookingEvent.PHONE;\r\n  }\r\n\r\n  getCountry() {\r\n    return findCountry(this.bookingEvent.COUNTRY, this.countryNodeList).name;\r\n  }\r\n  getPhoneCode() {\r\n    if (this.bookingEvent.PHONE_PREFIX) {\r\n      return this.bookingEvent.PHONE_PREFIX;\r\n    }\r\n    return findCountry(this.bookingEvent.COUNTRY, this.countryNodeList).phone_prefix;\r\n  }\r\n  renderPhone() {\r\n    return this.bookingEvent.COUNTRY ? `${this.bookingEvent.is_direct ? this.getPhoneCode() + '-' : ''}${this.getPhoneNumber()} - ${this.getCountry()}` : this.getPhoneNumber();\r\n  }\r\n\r\n  getGuestNote() {\r\n    return this.bookingEvent.NOTES && <p class={'user-notes p-0 my-0'}>{this.bookingEvent.NOTES}</p>;\r\n  }\r\n\r\n  getInternalNote() {\r\n    return this.bookingEvent.INTERNAL_NOTE;\r\n  }\r\n\r\n  getTotalPrice() {\r\n    return this.bookingEvent.TOTAL_PRICE;\r\n  }\r\n\r\n  getCheckInDate() {\r\n    return this.bookingEvent.FROM_DATE_STR;\r\n  }\r\n\r\n  getCheckOutDate() {\r\n    return this.bookingEvent.TO_DATE_STR;\r\n  }\r\n\r\n  getArrivalTime() {\r\n    return this.bookingEvent.ARRIVAL_TIME;\r\n  }\r\n\r\n  getRatePlan() {\r\n    return this.bookingEvent.RATE_PLAN;\r\n  }\r\n\r\n  getEntryDate() {\r\n    return this.bookingEvent.ENTRY_DATE;\r\n  }\r\n\r\n  getReleaseAfterHours() {\r\n    return this.bookingEvent.RELEASE_AFTER_HOURS;\r\n  }\r\n\r\n  isNewBooking() {\r\n    return this.getBookingId() === 'NEW_TEMP_EVENT';\r\n  }\r\n\r\n  isCheckedIn() {\r\n    return this.bookingEvent.STATUS === 'CHECKED-IN';\r\n  }\r\n\r\n  isCheckedOut() {\r\n    return this.bookingEvent.STATUS === 'CHECKED-OUT';\r\n  }\r\n\r\n  isBlockedDateEvent() {\r\n    return this.bookingEvent.STATUS === 'BLOCKED' || this.bookingEvent.STATUS === 'BLOCKED-WITH-DATES';\r\n  }\r\n\r\n  getRoomId() {\r\n    return this.bookingEvent.PR_ID;\r\n  }\r\n\r\n  getCategoryByRoomId(roomId) {\r\n    // console.log(\"room id \",roomId)\r\n    // console.log(\"booking event\",this.bookingEvent)\r\n    return this.bookingEvent.roomsInfo.find(roomCategory => roomCategory.physicalrooms.find(room => room.id === roomId));\r\n  }\r\n\r\n  hasSplitBooking() {\r\n    return this.bookingEvent.hasOwnProperty('splitBookingEvents') && this.bookingEvent.splitBookingEvents;\r\n  }\r\n\r\n  canCheckIn() {\r\n    if (!this.fromTimeStamp) {\r\n      let dt = new Date(this.getCheckInDate());\r\n      dt.setHours(0, 0, 0, 0);\r\n      this.fromTimeStamp = dt.getTime();\r\n    }\r\n    if (!this.toTimeStamp) {\r\n      let dt = new Date(this.getCheckOutDate());\r\n      dt.setHours(0, 0, 0, 0);\r\n      this.toTimeStamp = dt.getTime();\r\n    }\r\n    if (this.isCheckedIn() || this.isCheckedOut()) {\r\n      return false;\r\n    }\r\n    if (this.fromTimeStamp <= this.todayTimeStamp && this.todayTimeStamp <= this.toTimeStamp) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  canCheckOut() {\r\n    if (this.isCheckedIn() && this.todayTimeStamp <= this.toTimeStamp) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const opt: { [key: string]: any } = event.detail;\r\n    this.bookingEvent = { ...this.bookingEvent, ...opt.data };\r\n    //console.log(\"blocked date booking event\", this.bookingEvent);\r\n  }\r\n\r\n  handleEditBooking() {\r\n    // console.log(\"Edit booking\");\r\n    this.bookingEvent.TITLE = locales.entries.Lcz_EditBookingFor;\r\n    this.handleBookingOption('EDIT_BOOKING');\r\n  }\r\n\r\n  getStringDateFormat(dt) {\r\n    return dt.getFullYear() + '-' + (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1) + '-' + (dt.getDate() <= 9 ? '0' : '') + dt.getDate();\r\n  }\r\n\r\n  handleAddRoom() {\r\n    let fromDate = new Date(this.bookingEvent.FROM_DATE);\r\n    fromDate.setHours(0, 0, 0, 0);\r\n    let from_date_str = this.getStringDateFormat(fromDate);\r\n\r\n    let toDate = new Date(this.bookingEvent.TO_DATE);\r\n    //toDate.setDate(toDate.getDate() + 1);\r\n    toDate.setHours(0, 0, 0, 0);\r\n    let to_date_str = this.getStringDateFormat(toDate);\r\n    //console.log(this.bookingEvent);\r\n    let eventData = {\r\n      ID: '',\r\n      NAME: '',\r\n      BOOKING_NUMBER: this.bookingEvent.BOOKING_NUMBER,\r\n      FROM_DATE: from_date_str, // \"2023-07-09\",\r\n      TO_DATE: to_date_str, // \"2023-07-11\",\r\n      roomsInfo: this.bookingEvent.roomsInfo,\r\n      ARRIVAL: this.bookingEvent.ARRIVAL,\r\n      ADD_ROOM_TO_BOOKING: this.bookingEvent.ID,\r\n      TITLE: 'Add Room to #' + this.bookingEvent.BOOKING_NUMBER,\r\n      event_type: 'ADD_ROOM',\r\n      ROOMS: this.bookingEvent.ROOMS,\r\n      GUEST: this.bookingEvent.GUEST,\r\n      message: this.bookingEvent.NOTES,\r\n      SOURCE: this.bookingEvent.SOURCE,\r\n      defaultDateRange: {\r\n        fromDate: fromDate, //new Date(\"2023-09-10\"),\r\n        fromDateStr: '', //\"10 Sep 2023\",\r\n        toDate: toDate, //new Date(\"2023-09-15\"),\r\n        toDateStr: '', // \"15 Sep 2023\",\r\n        dateDifference: 0,\r\n        editabled: true,\r\n        message: 'Including 5.00% City Tax - Excluding 11.00% VAT',\r\n      },\r\n    };\r\n\r\n    this.handleBookingOption('ADD_ROOM', eventData);\r\n  }\r\n\r\n  handleCustomerCheckIn() {\r\n    console.log('Handle Customer Check In');\r\n  }\r\n\r\n  handleCustomerCheckOut() {\r\n    console.log('Handle Customer Check Out');\r\n  }\r\n  handleDeleteEvent() {\r\n    this.hideBubble();\r\n    this.deleteButton.emit(this.bookingEvent.POOL);\r\n    console.log('Delete Event');\r\n  }\r\n\r\n  async handleUpdateBlockedDates() {\r\n    try {\r\n      this.isLoading = 'update';\r\n      setTimeout(() => {\r\n        this.hideBubble();\r\n      }, 50);\r\n      await this.eventService.updateBlockedEvent(this.bookingEvent);\r\n      this.isLoading = '';\r\n    } catch (error) {\r\n      //   toastr.error(error);\r\n    }\r\n  }\r\n\r\n  handleConvertBlockedDateToBooking() {\r\n    this.handleBookingOption('BAR_BOOKING');\r\n  }\r\n\r\n  getRoomInfo() {\r\n    const roomIdToFind = +this.bookingEvent.PR_ID;\r\n    let selectedRoom: any = {};\r\n\r\n    for (const room of this.bookingEvent.roomsInfo) {\r\n      for (const physicalRoom of room.physicalrooms) {\r\n        if (roomIdToFind === physicalRoom.id) {\r\n          selectedRoom.CATEGORY = room.name;\r\n          selectedRoom.ROOM_NAME = physicalRoom.name;\r\n          selectedRoom.ROOMS_INFO = room;\r\n          return selectedRoom;\r\n        }\r\n      }\r\n    }\r\n\r\n    return selectedRoom;\r\n  }\r\n  renderTitle(eventType, roomInfo) {\r\n    switch (eventType) {\r\n      case 'EDIT_BOOKING':\r\n        return `${locales.entries.Lcz_EditBookingFor} ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\r\n      case 'ADD_ROOM':\r\n        return `${locales.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;\r\n      case 'SPLIT_BOOKING':\r\n        return locales.entries.Lcz_Adding + ` ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\r\n      default:\r\n        return `${locales.entries.Lcz_NewBookingFor} ${roomInfo.CATEGORY} ${roomInfo.ROOM_NAME}`;\r\n    }\r\n  }\r\n  private handleBookingOption(eventType, roomData = null) {\r\n    const roomInfo = this.getRoomInfo();\r\n    let data = roomData ? roomData : this.bookingEvent;\r\n    data.event_type = eventType;\r\n    data.TITLE = this.renderTitle(eventType, roomInfo);\r\n\r\n    if (['003', '002', '004'].includes(this.bookingEvent.STATUS_CODE)) {\r\n      data.roomsInfo = [roomInfo.ROOMS_INFO];\r\n    }\r\n    if (eventType === 'BAR_BOOKING') {\r\n      this.handleDeleteEvent();\r\n    }\r\n    this.showBookingPopup.emit({\r\n      key: 'add',\r\n      data: {\r\n        ...data,\r\n        //roomsInfo: [roomInfo.ROOMS_INFO],\r\n      },\r\n    });\r\n    this.hideBubbleInfo.emit({\r\n      key: 'hidebubble',\r\n      currentInfoBubbleId: this.getBookingId(),\r\n    });\r\n  }\r\n  renderNote() {\r\n    const { is_direct, ota_notes } = this.bookingEvent;\r\n    const guestNote = this.getGuestNote();\r\n    const noteLabel = locales.entries.Lcz_Note + ':';\r\n\r\n    if (!is_direct && ota_notes) {\r\n      return (\r\n        <div class=\"row p-0 m-0\">\r\n          <div class=\"col-12 px-0 text-wrap d-flex\">\r\n            <ota-label label={noteLabel} remarks={ota_notes}></ota-label>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (is_direct && guestNote) {\r\n      return (\r\n        <div class=\"row p-0 m-0\">\r\n          <div class=\"col-12 px-0 text-wrap d-flex\">\r\n            <Fragment>\r\n              <span class=\"font-weight-bold\">{noteLabel} </span>\r\n              {guestNote}\r\n            </Fragment>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getInfoElement() {\r\n    return (\r\n      <div class={`iglPopOver infoBubble ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`}>\r\n        <div class={`row p-0 m-0  ${this.bookingEvent.BALANCE > 1 ? 'pb-0' : 'pb-1'}`}>\r\n          <div class=\"px-0  col-8 font-weight-bold font-medium-1 d-flex align-items-center\">\r\n            <img src={this.bookingEvent?.origin?.Icon} alt={this.bookingEvent?.origin?.Label} class={'icon-image'} />\r\n            <p class={'p-0 m-0'}>{!this.bookingEvent.is_direct ? this.bookingEvent.channel_booking_nbr : this.bookingEvent.BOOKING_NUMBER}</p>\r\n          </div>\r\n          <div class=\"pr-0 col-4 text-right\">{formatAmount(this.currency.symbol, this.getTotalPrice())}</div>\r\n        </div>\r\n        {this.bookingEvent.BALANCE > 1 && (\r\n          <p class=\"pr-0 m-0 p-0 text-right balance_amount\">\r\n            {locales.entries.Lcz_Balance}: {formatAmount(this.currency.symbol, this.bookingEvent.BALANCE)}\r\n          </p>\r\n        )}\r\n        <div class=\"row p-0 m-0\">\r\n          <div class=\"px-0 pr-0 col-12\">\r\n            <ir-date-view from_date={this.bookingEvent.defaultDates.from_date} to_date={this.bookingEvent.defaultDates.to_date} showDateDifference={false}></ir-date-view>\r\n            {/* <span class=\"font-weight-bold\">{locales.entries.Lcz_In}: </span> */}\r\n          </div>\r\n        </div>\r\n        {this.getArrivalTime() && (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"px-0 col-12\">\r\n              <span class=\"font-weight-bold\">{locales.entries.Lcz_ArrivalTime}: </span>\r\n              {this.getArrivalTime()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.getTotalOccupants() && (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"px-0  col-12\">\r\n              <span class=\"font-weight-bold\">{locales.entries.Lcz_Occupancy}: </span>\r\n              {this.getTotalOccupants()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.getPhoneNumber() && (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"px-0  col-12 text-wrap\">\r\n              <span class=\"font-weight-bold\">{locales.entries.Lcz_Phone}: </span>\r\n              {this.renderPhone()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.getRatePlan() && (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"px-0  col-12\">\r\n              <span class=\"font-weight-bold\">{locales.entries.Lcz_RatePlan}: </span>\r\n              {this.getRatePlan()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.bookingEvent.PRIVATE_NOTE && (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"px-0  col-12 text-wrap\">\r\n              <span class=\"font-weight-bold\">{locales.entries.Lcz_PrivateNote}: </span>\r\n              {this.bookingEvent.PRIVATE_NOTE}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.renderNote()}\r\n        {this.getInternalNote() ? (\r\n          <div class=\"row p-0 m-0\">\r\n            <div class=\"col-12 px-0 text-wrap\">\r\n              {this.bookingEvent.is_direct ? (\r\n                <Fragment>\r\n                  <span class=\"font-weight-bold\">{locales.entries.Lcz_InternalRemark}: </span>\r\n                  {this.getInternalNote()}\r\n                </Fragment>\r\n              ) : (\r\n                <ota-label label={`${locales.entries.Lcz_InternalRemark}:`} remarks={this.bookingEvent.ota_notes}></ota-label>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n\r\n        <div class=\"row p-0 m-0 mt-2\">\r\n          <div class=\"full-width btn-group  btn-group-sm font-small-3\" role=\"group\">\r\n            <button\r\n              type=\"button\"\r\n              class={`btn btn-primary events_btns ${this.hideButtons ? 'mr-0' : 'mr-1'} ${this.shouldHideUnassignUnit ? 'w-50' : ''}`}\r\n              onClick={_ => {\r\n                this.handleEditBooking();\r\n              }}\r\n              // disabled={!this.bookingEvent.IS_EDITABLE}\r\n            >\r\n              <ir-icons name=\"edit\" style={{ '--icon-size': '0.875rem' }}></ir-icons>\r\n              <span>{locales.entries.Lcz_Edit}</span>\r\n            </button>\r\n            {this.bookingEvent.is_direct && this.bookingEvent.IS_EDITABLE && !this.hideButtons && (\r\n              <button\r\n                type=\"button\"\r\n                class={`btn btn-primary events_btns ${!this.shouldHideUnassignUnit ? 'mr-1' : 'w-50'}`}\r\n                onClick={_ => {\r\n                  this.handleAddRoom();\r\n                }}\r\n              >\r\n                <ir-icons name=\"square_plus\" style={{ '--icon-size': '0.875rem' }}></ir-icons>\r\n                <span>{locales.entries.Lcz_AddRoom}</span>\r\n              </button>\r\n            )}\r\n            {/* {this.canCheckIn() ? (\r\n              <button\r\n                type=\"button\"\r\n                class=\"btn btn-primary p-0 mr-1\"\r\n                onClick={_ => {\r\n                  this.handleCustomerCheckIn();\r\n                }}\r\n                disabled={!this.bookingEvent.IS_EDITABLE}\r\n              >\r\n                <i class=\"ft ft-edit font-small-3\"></i> {locales.entries.Lcz_CheckIn}\r\n              </button>\r\n            ) : null}\r\n            {this.canCheckOut() ? (\r\n              <button\r\n                type=\"button\"\r\n                class=\"btn btn-primary p-0 mr-1\"\r\n                onClick={_ => {\r\n                  this.handleCustomerCheckOut();\r\n                }}\r\n                disabled={!this.bookingEvent.IS_EDITABLE}\r\n              >\r\n                <i class=\"ft ft-log-out font-small-3\"></i> {locales.entries.Lcz_CheckOut}\r\n              </button>\r\n            ) : null} */}\r\n\r\n            {this.hideButtons\r\n              ? null\r\n              : !this.shouldHideUnassignUnit && (\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"btn btn-primary events_btns\"\r\n                    onClick={_ => {\r\n                      this.handleDeleteEvent();\r\n                    }}\r\n                    // disabled={!this.bookingEvent.IS_EDITABLE || this.is_vacation_rental}\r\n                  >\r\n                    <ir-icons name=\"xmark\" style={{ '--icon-size': '0.875rem' }}></ir-icons>\r\n                    <span class=\"m-0 p-0\">{locales.entries.Lcz_Unassign}</span>\r\n                  </button>\r\n                )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getNewBookingOptions() {\r\n    const shouldDisplayButtons = this.bookingEvent.roomsInfo[0].rateplans.some(rate => rate.is_active);\r\n    return (\r\n      <div class={`iglPopOver newBookingOptions ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`}>\r\n        {shouldDisplayButtons ? (\r\n          <Fragment>\r\n            <button\r\n              type=\"button\"\r\n              class=\"d-block full-width btn btn-sm btn-primary mb-1 font-small-3 square\"\r\n              onClick={_ => {\r\n                this.handleBookingOption('BAR_BOOKING');\r\n              }}\r\n            >\r\n              {locales.entries.Lcz_CreateNewBooking}\r\n            </button>\r\n            {this.hasSplitBooking() ? (\r\n              <button\r\n                type=\"button\"\r\n                class=\"d-block full-width btn btn-sm btn-primary mb-1 font-small-3 square\"\r\n                onClick={_ => {\r\n                  this.handleBookingOption('SPLIT_BOOKING');\r\n                }}\r\n              >\r\n                {locales.entries.Lcz_AssignUnitToExistingBooking}\r\n              </button>\r\n            ) : null}\r\n          </Fragment>\r\n        ) : (\r\n          <p class={'text-danger'}>{locales.entries.Lcz_NoRatePlanDefined}</p>\r\n        )}\r\n        <button\r\n          type=\"button\"\r\n          class=\"d-block full-width btn btn-sm btn-primary font-small-3 square\"\r\n          onClick={_ => {\r\n            this.handleBookingOption('BLOCK_DATES');\r\n          }}\r\n        >\r\n          {locales.entries.Lcz_Blockdates}\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getBlockedView() {\r\n    // let defaultData = {RELEASE_AFTER_HOURS: 0, OPTIONAL_REASON: \"\", OUT_OF_SERVICE: false};\r\n    return (\r\n      <div class={`iglPopOver blockedView ${this.bubbleInfoTop ? 'bubbleInfoAbove' : ''} text-left`}>\r\n        <igl-block-dates-view\r\n          isEventHover={true}\r\n          entryHour={this.bookingEvent.ENTRY_HOUR}\r\n          entryMinute={this.bookingEvent.ENTRY_MINUTE}\r\n          defaultData={this.bookingEvent}\r\n          fromDate={moment(this.bookingEvent.defaultDates.from_date, 'YYYY-MM-DD').format('DD MM YYYY')}\r\n          toDate={moment(this.bookingEvent.defaultDates.to_date, 'YYYY-MM-DD').format('DD MM YYYY')}\r\n          entryDate={this.getEntryDate()}\r\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\r\n        ></igl-block-dates-view>\r\n        <div class=\"row p-0 m-0 mt-2\">\r\n          <div class=\"full-width btn-group btn-group-sm font-small-3\" role=\"group\">\r\n            <button\r\n              disabled={this.isLoading === 'update'}\r\n              type=\"button\"\r\n              class=\"btn btn-primary mr-1 events_btns\"\r\n              onClick={_ => {\r\n                this.handleUpdateBlockedDates();\r\n              }}\r\n            >\r\n              {this.isLoading === 'update' ? <i class=\"la la-circle-o-notch spinner mx-1\"></i> : <ir-icons name=\"edit\" style={{ '--icon-size': '0.875rem' }}></ir-icons>}\r\n              <span>{locales.entries.Lcz_Update}</span>\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-primary events_btns\"\r\n              onClick={_ => {\r\n                this.handleConvertBlockedDateToBooking();\r\n              }}\r\n            >\r\n              {locales.entries.Lcz_ConvertToBooking}\r\n            </button>\r\n\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-danger ml-1 events_btns\"\r\n              onClick={_ => {\r\n                this.handleDeleteEvent();\r\n              }}\r\n            >\r\n              <ir-icons name=\"trash\" style={{ '--icon-size': '0.875rem' }}></ir-icons>\r\n              <span>{locales.entries.Lcz_Delete}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class={`pointerContainer ${this.bubbleInfoTop ? 'pointerContainerTop' : ''}`}>\r\n          <div class={`bubblePointer ${this.bubbleInfoTop ? 'bubblePointTop' : 'bubblePointBottom'}`}></div>\r\n        </div>\r\n        {this.isBlockedDateEvent() ? this.getBlockedView() : null}\r\n        {this.isNewBooking() ? this.getNewBookingOptions() : null}\r\n        {!this.isBlockedDateEvent() && !this.isNewBooking() ? this.getInfoElement() : null}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n* {\r\n  box-sizing: border-box;\r\n}\r\n.popover-title {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: 0;\r\n  padding: 0;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  z-index: 10;\r\n  left: 0;\r\n}\r\n.popover-container {\r\n  position: absolute;\r\n  bottom: 0px;\r\n  left: var(--ir-popover-left, 10px);\r\n  background: rgb(0, 0, 0);\r\n  color: white;\r\n  min-width: 100%;\r\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 10px;\r\n  z-index: 9999;\r\n  padding: 3.5px 7px;\r\n  border-radius: 5px;\r\n  pointer-events: none;\r\n  opacity: 0;\r\n  transition: all 100ms ease;\r\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 1.45;\r\n  text-decoration: none;\r\n  text-shadow: none;\r\n  font-size: 0.875rem;\r\n}\r\n.popover-container[data-state='show'] {\r\n  opacity: 1;\r\n}\r\n","import { Component, Host, Prop, State, h, Element } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-popover',\r\n  styleUrl: 'ir-popover.css',\r\n  scoped: true,\r\n})\r\nexport class IrPopover {\r\n  @Element() el: HTMLElement;\r\n  @Prop() popoverTitle: string;\r\n  @State() isHovered: boolean = false;\r\n  @State() showPopover: boolean = false;\r\n  @Prop() irPopoverLeft: string = '10px';\r\n\r\n  componentWillLoad() {\r\n    this.checkTitleWidth();\r\n  }\r\n  handleMouseEnter = () => {\r\n    if (!this.showPopover) {\r\n      return;\r\n    }\r\n    if (this.showPopover) {\r\n      this.isHovered = true;\r\n    }\r\n  };\r\n\r\n  handleMouseLeave = () => {\r\n    if (!this.showPopover) {\r\n      return;\r\n    }\r\n    this.isHovered = false;\r\n  };\r\n\r\n  checkTitleWidth() {\r\n    requestAnimationFrame(() => {\r\n      const titleElement = this.el.querySelector('.popover-title');\r\n      if (titleElement) {\r\n        const width = titleElement.scrollWidth;\r\n        this.showPopover = width > 150; // Show popover if title width exceeds 170px\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host style={{ '--ir-popover-left': this.irPopoverLeft }}>\r\n        <p class=\"popover-title\" onMouseLeave={this.handleMouseLeave} onMouseEnter={this.handleMouseEnter}>\r\n          {this.popoverTitle}\r\n        </p>\r\n        {this.showPopover && this.isHovered && (\r\n          <div data-state=\"show\" class=\"popover-container\">\r\n            {this.popoverTitle}\r\n          </div>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}