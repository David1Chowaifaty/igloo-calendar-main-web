{"version":3,"names":["irBookingBillingRecipientCss","IrBookingBillingRecipientStyle0","appCss","IrBookingBillingRecipientStyle1","IrBookingBillingRecipient","booking","selectedRecipient","rooms","recipientChange","initialValue","bookingCompanyFormRef","componentWillLoad","this","initializeDefaultValue","handleBookingChange","guest","id","toString","filterRoomGuests","handleRecipientChange","value","company_name","openCompanyForm","emit","normalize","str","toLocaleLowerCase","trim","mainGuest","_rooms","guests","Set","main_guest","first_name","last_name","add","room","_g","has","push","render","h","Host","key","defaultValue","onchange","e","target","label","orientation","name","booking_nbr","appearance","map","r","idx","class","onCompanyFormClosed","onResetBookingEvt","detail","ref","el"],"sources":["src/components/ir-booking-billing-recipient/ir-booking-billing-recipient.css?tag=ir-booking-billing-recipient&encapsulation=scoped","src/global/app.css?tag=ir-booking-billing-recipient&encapsulation=scoped","src/components/ir-booking-billing-recipient/ir-booking-billing-recipient.tsx"],"sourcesContent":[":host {\n  display: block;\n  padding: 0 !important;\n  box-sizing: border-box;\n}\n.billing-recipient__room::part(label) {\n  display: flex;\n  align-items: center;\n  gap: var(--wa-space-xl);\n  width: 100%;\n}\n\n.billing-recipient__guest-name {\n  font-weight: 500;\n}\n\n.billing-recipient__room-details {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n  font-size: 0.875rem;\n  color: var(--wa-color-neutral-600);\n}\n\n.billing-recipient__roomtype {\n  font-weight: 600;\n}\n","/* Web Awesome core styles */\n/* @import url('../assets/webawesome/themes/webawesome.css'); */\n@import url('../assets/webawesome/themes/default.css');\n/* Place project-wide overrides below. */\n.my-custom-style {\n  background: #000;\n  color: white;\n}\n.ir-price {\n  font-family: inherit;\n  font-size: 1rem;\n  font-weight: 800;\n  color: var(--ir-price-color, #1a1a1a);\n  text-align: right;\n  white-space: nowrap;\n}\n.page-title {\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-xl);\n}\n\n:host {\n  --wa-form-control-required-content-color: var(--wa-color-danger-border-loud, #f3676c);\n  padding: var(--wa-space-l);\n}\n/* td {\n  padding: 0 !important;\n} */\n.label-on-left {\n  display: grid;\n  gap: var(--wa-space-m);\n}\nwa-card::part(base) {\n  box-sizing: border-box;\n}\nwa-input[aria-invalid='true']::part(base),\nwa-select[aria-invalid='true']::part(combobox) {\n  border-color: var(--wa-color-danger-border-loud);\n  outline-color: var(--wa-color-danger-border-loud);\n  border-width: 2px;\n}\n\n/* Shared layout for form controls inside wa-select, wa-input, wa-textarea */\n@media (min-width: 768px) {\n  /* .label-on-left wa-switch::part(label) {\n    margin-inline-start: 0;\n    margin-inline-end: 0.5rem;\n  } */\n  .label-on-left {\n    align-items: center;\n    grid-template-columns: auto 1fr;\n  }\n  .label-on-left wa-switch::part(base),\n  .label-on-left wa-select::part(form-control),\n  .label-on-left wa-select,\n  .label-on-left wa-switch,\n  .label-on-left wa-input,\n  .label-on-left wa-textarea {\n    grid-column: 1 / -1;\n    grid-row-end: span 2;\n    display: grid;\n    grid-template-columns: subgrid;\n    gap: 0 var(--wa-space-l);\n    align-items: center;\n  }\n  .label-on-left wa-switch::part(base) {\n    direction: rtl;\n  }\n  .label-on-left wa-switch::part(base) > * {\n    justify-self: flex-start;\n    justify-content: flex-start;\n    direction: ltr; /* fix text direction */\n  }\n  /* Label alignment */\n  .label-on-left ::part(label) {\n    justify-content: flex-end;\n  }\n\n  /* Hint always in second column */\n  .label-on-left ::part(hint) {\n    grid-column: 2;\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-booking-billing-recipient',\n  styleUrls: ['ir-booking-billing-recipient.css', '../../global/app.css'],\n  scoped: true,\n})\nexport class IrBookingBillingRecipient {\n  @Prop({ mutable: true }) booking: Booking;\n\n  @State() selectedRecipient: string;\n  @State() rooms: Booking['rooms'] = [];\n\n  @Event() recipientChange: EventEmitter<string>;\n\n  private initialValue: string;\n  private bookingCompanyFormRef: HTMLIrBookingCompanyFormElement;\n\n  componentWillLoad() {\n    this.initializeDefaultValue();\n  }\n\n  @Watch('booking')\n  handleBookingChange() {\n    this.initializeDefaultValue();\n  }\n\n  private initializeDefaultValue() {\n    this.initialValue = this.booking?.guest?.id?.toString();\n    this.selectedRecipient = this.initialValue;\n    this.filterRoomGuests();\n  }\n\n  private handleRecipientChange(value: string) {\n    this.selectedRecipient = value;\n    switch (value) {\n      case 'company':\n        if (!this.booking.company_name) {\n          this.bookingCompanyFormRef.openCompanyForm();\n          return;\n        }\n        break;\n\n      default:\n        break;\n    }\n    this.recipientChange.emit(this.selectedRecipient);\n  }\n\n  private filterRoomGuests() {\n    const normalize = (str: string) => {\n      return str?.toLocaleLowerCase()?.trim();\n    };\n    const { guest: mainGuest } = this.booking;\n    let _rooms = [];\n    const guests = new Set<string>();\n    const main_guest = `${normalize(mainGuest.first_name)}_${normalize(mainGuest.last_name)}`;\n    guests.add(main_guest);\n    for (const room of this.booking.rooms) {\n      const _g = `${normalize(room.guest.first_name)}_${normalize(room.guest.last_name)}`;\n      if (guests.has(_g)) {\n        continue;\n      }\n      guests.add(_g);\n      _rooms.push(room);\n    }\n    this.rooms = [..._rooms];\n  }\n\n  render() {\n    return (\n      <Host>\n        <wa-radio-group\n          defaultValue={this.initialValue}\n          onchange={e => this.handleRecipientChange((e.target as any).value)}\n          label=\"Bill to\"\n          orientation=\"vertical\"\n          name={`${this.booking?.booking_nbr}-bill-to`}\n          value={this.selectedRecipient}\n        >\n          <wa-radio appearance=\"button\" value={this.booking?.guest?.id?.toString()}>\n            {this.booking?.guest.first_name} {this.booking.guest.last_name}\n          </wa-radio>\n          {this.rooms.map((r, idx) => (\n            <wa-radio appearance=\"button\" class=\"billing-recipient__room\" value={r.guest.id?.toString() ?? `guest_${idx}`} key={r.guest?.id ?? `guest_${idx}`}>\n              <span class=\"billing-recipient__guest-name\">\n                {r.guest.first_name} {r.guest.last_name}\n              </span>\n\n              {/* <div class=\"billing-recipient__room-details\">\n                <b class=\"billing-recipient__roomtype\">{r.roomtype.name}</b>\n                <span class=\"billing-recipient__rateplan\">{r.rateplan.short_name}</span>\n\n                {r.unit && (\n                  <wa-tag variant=\"brand\" size=\"small\" appearance=\"accent\">\n                    {(r.unit as IUnit)?.name}\n                  </wa-tag>\n                )}\n              </div> */}\n            </wa-radio>\n          ))}\n          <wa-radio appearance=\"button\" value=\"company\">\n            {this.booking.company_name ? this.booking.company_name : 'Company'}\n          </wa-radio>\n        </wa-radio-group>\n        <ir-booking-company-form\n          onCompanyFormClosed={() => {\n            if (this.selectedRecipient === 'company' && !this.booking.company_name) {\n              this.handleRecipientChange(this.initialValue);\n            }\n          }}\n          onResetBookingEvt={e => {\n            this.booking = { ...e.detail };\n            if (!this.booking.company_name) {\n              this.handleRecipientChange(this.initialValue);\n            }\n          }}\n          booking={this.booking}\n          ref={el => (this.bookingCompanyFormRef = el)}\n        ></ir-booking-company-form>\n      </Host>\n    );\n  }\n}\n"],"mappings":"yDAAA,MAAMA,EAA+B,iiBACrC,MAAAC,EAAeD,ECDf,MAAME,EAAS,yl3DACf,MAAAC,EAAeD,E,MCMFE,EAAyB,M,0EACXC,QAEhBC,kBACAC,MAA0B,GAE1BC,gBAEDC,aACAC,sBAER,iBAAAC,GACEC,KAAKC,wB,CAIP,mBAAAC,GACEF,KAAKC,wB,CAGC,sBAAAA,GACND,KAAKH,aAAeG,KAAKP,SAASU,OAAOC,IAAIC,WAC7CL,KAAKN,kBAAoBM,KAAKH,aAC9BG,KAAKM,kB,CAGC,qBAAAC,CAAsBC,GAC5BR,KAAKN,kBAAoBc,EACzB,OAAQA,GACN,IAAK,UACH,IAAKR,KAAKP,QAAQgB,aAAc,CAC9BT,KAAKF,sBAAsBY,kBAC3B,M,CAEF,MAKJV,KAAKJ,gBAAgBe,KAAKX,KAAKN,kB,CAGzB,gBAAAY,GACN,MAAMM,EAAaC,GACVA,GAAKC,qBAAqBC,OAEnC,MAAQZ,MAAOa,GAAchB,KAAKP,QAClC,IAAIwB,EAAS,GACb,MAAMC,EAAS,IAAIC,IACnB,MAAMC,EAAa,GAAGR,EAAUI,EAAUK,eAAeT,EAAUI,EAAUM,aAC7EJ,EAAOK,IAAIH,GACX,IAAK,MAAMI,KAAQxB,KAAKP,QAAQE,MAAO,CACrC,MAAM8B,EAAK,GAAGb,EAAUY,EAAKrB,MAAMkB,eAAeT,EAAUY,EAAKrB,MAAMmB,aACvE,GAAIJ,EAAOQ,IAAID,GAAK,CAClB,Q,CAEFP,EAAOK,IAAIE,GACXR,EAAOU,KAAKH,E,CAEdxB,KAAKL,MAAQ,IAAIsB,E,CAGnB,MAAAW,GACE,OACEC,EAACC,EAAI,CAAAC,IAAA,4CACHF,EAAA,kBAAAE,IAAA,2CACEC,aAAchC,KAAKH,aACnBoC,SAAUC,GAAKlC,KAAKO,sBAAuB2B,EAAEC,OAAe3B,OAC5D4B,MAAM,UACNC,YAAY,WACZC,KAAM,GAAGtC,KAAKP,SAAS8C,sBACvB/B,MAAOR,KAAKN,mBAEZmC,EAAA,YAAAE,IAAA,2CAAUS,WAAW,SAAShC,MAAOR,KAAKP,SAASU,OAAOC,IAAIC,YAC3DL,KAAKP,SAASU,MAAMkB,WAAU,IAAGrB,KAAKP,QAAQU,MAAMmB,WAEtDtB,KAAKL,MAAM8C,KAAI,CAACC,EAAGC,IAClBd,EAAA,YAAUW,WAAW,SAASI,MAAM,0BAA0BpC,MAAOkC,EAAEvC,MAAMC,IAAIC,YAAc,SAASsC,IAAOZ,IAAKW,EAAEvC,OAAOC,IAAM,SAASuC,KAC1Id,EAAA,QAAMe,MAAM,iCACTF,EAAEvC,MAAMkB,WAAU,IAAGqB,EAAEvC,MAAMmB,cAepCO,EAAA,YAAAE,IAAA,2CAAUS,WAAW,SAAShC,MAAM,WACjCR,KAAKP,QAAQgB,aAAeT,KAAKP,QAAQgB,aAAe,YAG7DoB,EAAA,2BAAAE,IAAA,2CACEc,oBAAqB,KACnB,GAAI7C,KAAKN,oBAAsB,YAAcM,KAAKP,QAAQgB,aAAc,CACtET,KAAKO,sBAAsBP,KAAKH,a,GAGpCiD,kBAAmBZ,IACjBlC,KAAKP,QAAU,IAAKyC,EAAEa,QACtB,IAAK/C,KAAKP,QAAQgB,aAAc,CAC9BT,KAAKO,sBAAsBP,KAAKH,a,GAGpCJ,QAASO,KAAKP,QACduD,IAAKC,GAAOjD,KAAKF,sBAAwBmD,I","ignoreList":[]}