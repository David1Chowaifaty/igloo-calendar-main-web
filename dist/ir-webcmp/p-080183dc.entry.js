import{r as t,c as e,h as i,H as s,F as o,g as a}from"./p-c8e6073c.js";import{g as n,d as l,a as r,f as c,r as d}from"./p-5ef8b20a.js";import{l as h}from"./p-3ad0bf4e.js";import{c as f}from"./p-0f9965e9.js";import{v as p}from"./p-4ed69de7.js";import{B as b,t as u,c as m,f as g}from"./p-f5bcbce9.js";import{E as y}from"./p-67233280.js";import{R as k}from"./p-8ecf3008.js";import{a as v,T as x}from"./p-f5b71ff4.js";import{i as w,a as _}from"./p-99d955fa.js";import{h as D}from"./p-6c4ba7c0.js";import{c as C}from"./p-f2b1cd85.js";const O=".sc-igl-application-info-h{display:block}@media only screen and (min-width: 908px){.aplicationInfoContainer.sc-igl-application-info{max-width:80%}.guest-info-container.sc-igl-application-info{max-width:300px}.preference-select-container.sc-igl-application-info{max-width:250px}}";const I=O;const M=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.userRate=0;this.guestInfo=undefined;this.currency=undefined;this.roomsList=[];this.guestRefKey=undefined;this.bedPreferenceType=[];this.selectedUnits=[];this.bookingType="PLUS_BOOKING";this.defaultGuestPreference=undefined;this.index=undefined;this.defaultGuestRoomId=undefined;this.dateDifference=undefined;this.filterdRoomList=[];this.isButtonPressed=false;this.guestData=undefined}componentWillLoad(){console.log(this.guestInfo);if(this.guestInfo.isRateModified&&this.guestInfo.rateType===2){this.userRate=this.guestInfo.rate*this.dateDifference}else{this.userRate=this.guestInfo.rate}this.guestData=this.guestInfo?Object.assign({},this.guestInfo):{};this.guestData.roomId="";if(this.defaultGuestRoomId&&this.roomsList.filter((t=>t.id.toString()===this.defaultGuestRoomId.toString())).length>0){this.guestData.roomId=this.defaultGuestRoomId}this.guestData.preference=+this.defaultGuestPreference||"";this.updateRoomList()}componentDidLoad(){this.timeout=setTimeout((()=>{this.updateData()}),200)}disconnectedCallback(){clearTimeout(this.timeout)}async handleSelctedUnits(){this.updateRoomList()}updateRoomList(){const t=[...this.selectedUnits];t[this.index]=-1;this.filterdRoomList=this.roomsList.filter((e=>!t.includes(e.id)))}updateData(){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",guestRefKey:this.guestRefKey,data:Object.assign({},this.guestData)})}handleDataChange(t,e){this.guestData[t]=+e;if(e===""){this.guestData["roomName"]=e}if(t==="roomId"&&e!==""){this.guestData["roomName"]=this.filterdRoomList.find((t=>t.id===+e)).name||""}console.log("guest data",this.guestData);this.updateData()}handleGuestNameChange(t){this.guestData.guestName=t.target.value;this.updateData()}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":case"save":this.isButtonPressed=true;break}}render(){return i(s,{key:"2b6c46f7de33d706041878876747101cf34469ee"},i("div",{key:"87453b6694430be38158f55d68bc0148b25a6364",class:"text-left mt-1 "},i("div",{key:"4e15986ec0aa1d5d124e55aed71824729d3e6b73",class:" mb-1 "},this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING"?i("span",{class:"h5 mr-1"},this.guestInfo.roomCategoryName):null,i("span",{key:"14b32f321f2b27b3a26b871e81f6b79e30b92ace",class:" font-weight-bold"},this.guestInfo.ratePlanName.replace(this.guestInfo.roomCategoryName+"/",""),i("ir-tooltip",{key:"9af293a94de0b675be2c4b7df1f57456d3252c4e",class:" mr-1",message:this.guestInfo.cancelation+this.guestInfo.guarantee})),i("span",{key:"f39ccd8de237fa4185b16aa0cd33b30cc389cacc"},this.guestInfo.adult_child_offering)),i("div",{key:"655018a075816f586e2e2519a2458edc19a84694",class:"d-flex flex-column flex-md-row m-0 p-0 align-items-md-center aplicationInfoContainer "},i("div",{key:"5e3e52ef9497c18f6e00dc4d7c09b0719d18efc4",class:"mr-1 flex-fill guest-info-container"},i("input",{key:"7ba5751d9a0f97089328729bae758107b928566c",id:p(),type:"email",class:`form-control ${this.isButtonPressed&&this.guestData.guestName===""&&"border-danger"}`,placeholder:h.entries.Lcz_GuestFirstnameAndLastname,name:"guestName",onInput:t=>this.handleGuestNameChange(t),required:true,value:this.guestData.guestName})),i("div",{key:"6c2bb38540341af9e347c7be5e10586dd7c9c71e",class:"mt-1 mt-md-0 d-flex align-items-center flex-fill"},f.is_frontdesk_enabled&&(this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"||this.bookingType==="EDIT_BOOKING")?i("div",{class:"mr-1 p-0 flex-fill  preference-select-container"},i("select",{class:`form-control  input-sm pr-0`,id:p(),onChange:t=>this.handleDataChange("roomId",t.target.value)},i("option",{value:"",selected:this.guestData.roomId===""},h.entries.Lcz_Assignunits),this.filterdRoomList.map((t=>i("option",{value:t.id,selected:+this.guestData.roomId===t.id},t.name))))):null,this.guestData.is_bed_configuration_enabled&&i("div",{class:"mr-1 flex-fill"},i("select",{class:`form-control input-sm ${this.isButtonPressed&&(this.guestData.preference===""||this.guestData.preference===0)&&"border-danger"}`,id:p(),onChange:t=>this.handleDataChange("preference",t.target.value)},i("option",{value:"",selected:this.guestData.preference===""},h.entries.Lcz_BedConfiguration),this.bedPreferenceType.map((t=>i("option",{value:+t.CODE_NAME,selected:this.guestData.preference===+t.CODE_NAME},t.CODE_VALUE_EN))))),i("div",{key:"e7d373a3d81973f6f96ad3751dbcd2c166e4c52b",class:""},n(this.currency.code)+Number(this.userRate).toFixed(2),"/",h.entries.Lcz_Stay)))))}static get watchers(){return{selectedUnits:["handleSelctedUnits"]}}};M.style=I;const B=".sc-igl-block-dates-view-h{display:block}.sc-igl-block-dates-view-h .controlContainer.sc-igl-block-dates-view{width:24px}.sc-igl-block-dates-view-h .checkBoxContainer.sc-igl-block-dates-view input.sc-igl-block-dates-view{height:1.2rem !important;width:30px}.releaseTime.sc-igl-block-dates-view{padding-left:5px}.out-of-service-label.sc-igl-block-dates-view{margin-left:5px !important}";const T=B;const S=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.blockDatesData={RELEASE_AFTER_HOURS:0,OPTIONAL_REASON:"",OUT_OF_SERVICE:false};this.releaseList=[];this.bookingService=new b;this.defaultData=undefined;this.fromDate=undefined;this.toDate=undefined;this.entryDate=undefined;this.entryHour=undefined;this.isEventHover=false;this.entryMinute=undefined;this.renderAgain=false}async componentWillLoad(){try{this.bookingService.setToken(f.token);this.releaseList=await this.bookingService.getBlockedInfo();if(this.defaultData){this.blockDatesData=Object.assign({},this.defaultData)}else{this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(this.releaseList[0].CODE_NAME);this.emitData()}}catch(t){}}handleOptionalReason(t){this.blockDatesData.OPTIONAL_REASON=t.target.value;this.emitData()}handleReleaseAfterChange(t){if(this.entryDate)this.entryDate=undefined;this.blockDatesData.RELEASE_AFTER_HOURS=parseInt(t.target.value);this.renderPage();this.emitData()}emitData(){this.dataUpdateEvent.emit({key:"blockDatesData",data:Object.assign({},this.blockDatesData)})}getReleaseHoursString(){let t=this.entryDate?new Date(this.entryDate):new Date;if(this.entryDate&&this.entryHour&&this.entryMinute){t.setHours(this.entryHour,this.entryMinute,0,0)}else{t.setHours(t.getHours()+this.blockDatesData.RELEASE_AFTER_HOURS,t.getMinutes(),0,0)}return t.toLocaleString("default",{month:"short"})+" "+t.getDate()+", "+this.formatNumber(t.getHours())+":"+this.formatNumber(t.getMinutes())}formatNumber(t){return t<10?`0${t}`:t}handleOutOfService(t){this.blockDatesData.OUT_OF_SERVICE=t.target.checked;if(this.blockDatesData.OUT_OF_SERVICE){this.blockDatesData.OPTIONAL_REASON="";this.blockDatesData.RELEASE_AFTER_HOURS=0}this.renderPage();this.emitData()}renderPage(){this.renderAgain=!this.renderAgain}render(){console.log(this.fromDate);return i(s,{key:"9c21805b294839890e96edad31fbedacdf63b5b4"},i("div",{key:"547207f047eed5a17b0d4a845125ecd5c32d4613",class:`m-0 p-0 mb-1`},i("div",{key:"f2769e0e8b6a459326c07360f82779fed406612c",class:"text-left p-0"},i("ir-date-view",{key:"ab13359a0dd80e6f02a7f2c4122d9c3e7224375c",from_date:this.fromDate,dateOption:"DD MMM YYYY",showDateDifference:false,to_date:this.toDate}))),i("div",{key:"a11a83b07a8d455988df000365a4243c4565f64a",class:` mb-1 text-left ${this.isEventHover&&"p-0"}`},i("div",{key:"0f4f6492a6e2fa906692698ae3a74dd0307a36ee",class:"mb-1 "},i("label",{key:"183bbc1e536baec85c163a28ae9f49ce34d10d3b",class:"p-0 text-bold-700 font-medium-1 m-0 align-middle"},h.entries.Lcz_Reason,":"),i("div",{key:"070947def5f622aa9e829f022df4dfa77820c786",class:"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle"},i("input",{key:"d59ed226805a8667a078a027a68c2eaefc594f90",class:"form-control",type:"checkbox",checked:this.blockDatesData.OUT_OF_SERVICE,id:"userinput6",onChange:t=>this.handleOutOfService(t)})),i("span",{key:"46634812558b1a5382e87127a9a4649688f5ec1c",class:"align-middle out-of-service-label"},h.entries.Lcz_OutOfservice)),!this.blockDatesData.OUT_OF_SERVICE?i("div",null,i("div",{class:"mb-1 d-flex  align-items-center"},i("span",{class:"align-middle"},h.entries.Lcz_Or," "),i("div",{class:"d-inline-flex col pr-0 align-middle"},i("input",{class:"form-control",type:"text",placeholder:h.entries.Lcz_OptionalReason,id:"optReason",value:this.blockDatesData.OPTIONAL_REASON,onInput:t=>this.handleOptionalReason(t)}))),i("div",{class:"mb-1 w-100 pr-0 "},i("span",{class:"text-bold-700 font-medium-1"},h.entries.Lcz_AutomaticReleaseIn,": "),i("div",{class:"d-inline-block"},i("select",{class:"form-control input-sm",id:"zSmallSelect",onChange:t=>this.handleReleaseAfterChange(t)},this.releaseList.map((t=>i("option",{value:+t.CODE_NAME,selected:this.blockDatesData.RELEASE_AFTER_HOURS==+t.CODE_NAME},t.CODE_VALUE_EN))))),this.blockDatesData.RELEASE_AFTER_HOURS?i("div",{class:"d-inline-block releaseTime"},i("em",null,h.entries.Lcz_On," ",this.getReleaseHoursString())):null)):null))}};S.style=T;class Y{setBookingInfoFromAutoComplete(t,e){t.bookedByInfoData={id:e.guest.id,email:e.guest.email,firstName:e.guest.first_name,lastName:e.guest.last_name,countryId:e.guest.country_id,isdCode:e.guest.country_id.toString(),contactNumber:e.guest.mobile,selectedArrivalTime:e.arrival,emailGuest:e.guest.subscribe_to_news_letter,message:e.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:e.booking_nbr,rooms:e.rooms,from_date:e.from_date,to_date:e.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,e,i,s,o){let a=e;const{data:n,key:l,changedKey:r}=t.detail;const c=`c_${n.roomCategoryId}`;const d=`p_${n.ratePlanId}`;if(this.shouldClearData(l)){a=new Map}this.initializeRoomCategoryIfNeeded(c,a);if(s){if(r==="rate"){if(a.has(c)&&a.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,n,a,o,i)}}else{if(r!=="rateType"){if(r==="adult_child_offering"){if(a.has(c)&&e.get(c).has(d)){this.applyBookingEditToSelectedRoom(c,d,n,a,o,i)}}else{this.applyBookingEditToSelectedRoom(c,d,n,a,o,i)}}}}else{this.setSelectedRoomData(c,d,n,a)}this.cleanupEmptyData(c,a);return a}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,e){if(!e.has(t)){e.set(t,new Map)}}setSelectedRoomData(t,e,i,s){let o=s.get(t);if(i.totalRooms===0||i.inventory===0){o.delete(e)}else{s.set(t,o.set(e,Object.assign(Object.assign({},i),{selectedUnits:Array(i.totalRooms).fill(-1)})))}}cleanupEmptyData(t,e){if(e.has(t)){let i=e.get(t);if(i.size===0){e.delete(t)}}}applyBookingEditToSelectedRoom(t,e,i,s,o,a){s.clear();let n={};if(a){n=Object.assign(Object.assign({},i),{guestName:o||"",roomId:""})}else{n=Object.assign({},i)}s.set(t,(new Map).set(e,n))}async prepareBookUserServiceParams(t,e,i){try{const s=t.isEventType("EDIT_BOOKING")?t.getArrivalTimeForBooking():t.isEventType("ADD_ROOM")?t.bookingData.ARRIVAL.code:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.selectedArrivalTime.code:"";const o=t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:undefined;const a=t.isEventType("EDIT_BOOKING")||t.isEventType("ADD_ROOM")?t.bookingData.BOOKING_NUMBER:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.bookingNumber:undefined;let n=[];if(t.isEventType("ADD_ROOM")){n=t.bookingData.ROOMS}else if(t.isEventType("SPLIT_BOOKING")){n=t.bookedByInfoData.rooms}else if(t.isEventType("EDIT_BOOKING")){n=t.defaultData.ROOMS.filter((e=>e.identifier!==t.bookingData.IDENTIFIER))}console.log("rooms",n);return[t.bookedByInfoData,e,new Date(t.dateRangeData.fromDate),new Date(t.dateRangeData.toDate),t.guestData,t.dateRangeData.dateDifference,i,t.propertyid,n,t.currency,a,t.bookingData.GUEST,s,o,t.bookingData.IDENTIFIER]}catch(t){console.log(t)}}getBookingPreferenceRoomId(t){return t.hasOwnProperty("PR_ID")&&t.PR_ID||null}getRoomCategoryByRoomId(t){var e;return(e=t.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.id===t.RATE_TYPE))}setEditingRoomInfo(t,e){console.log(t,t.roomsInfo);console.log(this.getBookingPreferenceRoomId(t));const i=this.getRoomCategoryByRoomId(t);const s=!i?"":`c_${i===null||i===void 0?void 0:i.id}`;const o=`p_${t.RATE_PLAN_ID}`;const a={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:i?i.id:"",roomCategoryName:i?i.name:"",totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};e.set(s,(new Map).set(o,a))}}const L=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.row.sc-igl-book-property{padding:0 0 0 15px;margin:0}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px}}";const z=L;const E=class{constructor(i){t(this,i);this.closeBookingWindow=e(this,"closeBookingWindow",7);this.bookingCreated=e(this,"bookingCreated",7);this.blockedCreated=e(this,"blockedCreated",7);this.resetBookingData=e(this,"resetBookingData",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.toast=e(this,"toast",7);this.initialRoomIds=null;this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new b;this.bookPropertyService=new Y;this.eventsService=new y;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.buttonName=""}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}else return}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();const{key:e,data:i}=t.detail;if(e==="select"){const t=await this.bookingService.getExposedBooking(i.booking_nbr,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}else if(e==="blur"&&i!==""){const t=await this.bookingService.getExposedBooking(i,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}async componentWillLoad(){this.bookingService.setToken(f.token);this.eventsService.setToken(f.token);this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE};this.handleKeyDown=this.handleKeyDown.bind(this);if(!this.bookingData.defaultDateRange){return}this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange);try{const t=await this.fetchSetupEntries();console.log(t);this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);if(this.isEventType("EDIT_BOOKING")){this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}if(this.defaultData.event_type==="SPLIT_BOOKING"){this.showSplitBookingOption=true;this.page="page_one"}else if(this.defaultData.event_type==="BLOCK_DATES"){this.page="page_block_date"}else{this.page="page_one"}}catch(t){console.error("Error fetching setup entries:",t)}}async fetchSetupEntries(){console.log("fetch setup entries");return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){if(this.guestData.length===0){return true}console.log(this.guestData);for(const t of this.guestData){if(t.guestName===""||(t.preference===""||t.preference===0)&&t.is_bed_configuration_enabled){return true}}return false}isButtonDisabled(){const t=(t,e,i)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"selectedArrivalTime","")||t(this.bookedByInfoData,"email","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.code,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag}}}setOtherProperties(t){this.ratePricingMode=t===null||t===void 0?void 0:t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.adultChildCount=Object.assign({},t.detail)}async initializeBookingAvailability(t,e){try{const i=this.defaultData.roomsInfo.map((t=>t.id));const s=await this.bookingService.getBookingAvailability(t,e,this.propertyid,this.adultChildCount,this.language,i,this.currency);if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:s.roomtypes})}catch(t){}}getRoomCategoryByRoomId(t){var e;return(e=this.defaultData.roomsInfo)===null||e===void 0?void 0:e.find((e=>e.physicalrooms.find((e=>e.id===+t))))}getSplitBookings(){return this.defaultData.hasOwnProperty("splitBookingEvents")&&this.defaultData.splitBookingEvents||[]}closeWindow(){this.dateRangeData={};this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.key==="selectedDateRange"){this.dateRangeData=e.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[]}else if(this.adultChildCount.adult!==0){this.initializeBookingAvailability(l(new Date(this.dateRangeData.fromDate)),l(new Date(this.dateRangeData.toDate)))}}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.blockDatesData=e.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[e.guestRefKey]=Object.assign(Object.assign({},e.data),{roomId:this.defaultData.PR_ID})}else this.guestData[e.guestRefKey]=e.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookedByInfoData=e.value.data}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;const i=this.sourceOptions.find((t=>t.id===e.toString()));this.sourceOption={code:e,description:i.value||"",tag:i.tag}}renderPage(){this.renderAgain=!this.renderAgain}gotoSplitPageTwo(){this.gotoPage("page_two")}gotoPage(t){this.page=t;this.renderPage()}showSplitBooking(){this.showSplitBookingOption=true;this.gotoPage("page_one")}getPageBlockDatesView(){return i(o,null,i("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),i("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},i("button",{class:"btn btn-secondary flex-fill",onClick:()=>this.closeWindow()},h.entries.Lcz_Cancel),i("button",{class:"btn btn-primary flex-fill",onClick:()=>this.handleBlockDate()},h.entries.Lcz_Blockdates)))}handleButtonClicked(t){var e,i;switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);this.buttonName="book";break;case"bookAndCheckIn":this.bookUser(true);this.buttonName="bookAndCheckIn";break;case"next":t.stopImmediatePropagation();t.stopPropagation();if(!((e=this.adultChildCount)===null||e===void 0?void 0:e.adult)){this.animateIrSelect.emit("adult_child_select");break}if(this.selectedUnits.size>0){this.gotoPage("page_two");break}else{if(((i=this.defaultData)===null||i===void 0?void 0:i.roomsInfo.length)===0){this.animateIrButton.emit("check_availability");break}}this.toast.emit({type:"error",description:h.entries.Lcz_SelectRatePlan,title:h.entries.Lcz_SelectRatePlan});break;case"check":this.initializeBookingAvailability(l(new Date(this.dateRangeData.fromDate)),l(new Date(this.dateRangeData.toDate)));break}}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(){const t=r(+this.blockDatesData.RELEASE_AFTER_HOURS);const e=await this.bookingService.blockUnit(Object.assign({from_date:l(this.defaultData.defaultDateRange.fromDate),to_date:l(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t));const i=await u(e);this.blockedCreated.emit(i);this.closeWindow()}async bookUser(t){this.setLoadingState(t);console.log("edit save clicked");if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else{if(this.isButtonDisabled()){this.isLoading="";return}}try{console.log("clicked");if(["003","002","004"].includes(this.defaultData.STATUS_CODE)){this.eventsService.deleteEvent(this.defaultData.POOL)}if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}const e=await this.bookPropertyService.prepareBookUserServiceParams(this,t,this.sourceOption);await this.bookingService.bookUser(...e);this.resetBookingData.emit(null)}catch(t){}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}getArrivalTimeForBooking(){return this.bookedByInfoData.arrivalTime.find((t=>t.CODE_VALUE_EN===this.defaultData.ARRIVAL_TIME)).CODE_NAME}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}onRoomDataUpdate(t){const e=this.bookPropertyService.onDataRoomUpdate(t,this.selectedUnits,this.isEventType("EDIT_BOOKING"),this.isEventType("EDIT_BOOKING")||this.isEventType("SPLIT_BOOKING")||this.isEventType("BAR_BOOKING"),this.defaultData.NAME);this.selectedUnits=new Map(e);this.renderPage()}getCurrentPage(t){return this.page===t}render(){return i(s,{key:"477f3a9f71dd50d37e486858136f0c5633705d46"},i("div",{key:"04a382efa46796e046b0a66c5cc57040c9ee3b93",class:"background-overlay",onClick:()=>this.closeWindow()}),i("div",{key:"559a87d1851800e91ff2ed3c7601e450a485f2bf",class:"sideWindow "+(this.getCurrentPage("page_block_date")?"block-date":"")},i("div",{key:"8f1b573f346b2e3c6f5d1e0f34c62e9bf2190b86",class:"card position-sticky mb-0 shadow-none p-0 "},i("div",{key:"45f85743afbdabead715a06db1e642ddb3ab15ea",class:"d-flex mt-2 align-items-center justify-content-between  "},i("h3",{key:"f5f8f17846b083460258cc197f003b40509e8a51",class:"card-title text-left pb-1 font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),i("ir-icon",{key:"3623d5a8b9c54106c51f580dc64a9786212891d2",class:"close close-icon",onIconClickHandler:()=>{this.closeWindow()}},i("svg",{key:"053e146a822073287591f5be8b79ab7701e8d8e4",slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{key:"5c8472d4cdda5920c16395ad298318b5cd67eeac",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{key:"a494b096975a13a5bd29552b147e13206a055f6e",class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&i("igl-booking-overview-page",{initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,onRoomsDataUpdate:t=>{this.onRoomDataUpdate(t)},sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&i("igl-pagetwo",{currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};E.style=z;const j=".sc-igl-book-property-container-h{display:block;margin:0;padding:0;letter-spacing:0px !important;font-family:'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;font-size:1rem !important;font-weight:400 !important;line-height:1.45 !important;color:#6b6f82 !important;text-align:left !important}.book-container.sc-igl-book-property-container{width:min-content;margin:0;padding:0}h3.sc-igl-book-property-container{font-size:1rem}";const R=j;const N=class{constructor(i){t(this,i);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new b;this.roomService=new k;this.language="";this.ticket="";this.baseurl="";this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.withIrToastAndInterceptor=true;this.bookingItem=undefined;this.showPaymentDetails=undefined;this.countryNodeList=undefined;this.calendarData={}}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){try{const[t,e,i]=await Promise.all([this.roomService.fetchData(this.propertyid,this.language),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language)]);if(!h.entries){h.entries=e.entries;h.direction=e.direction}this.countryNodeList=i;const{allowed_payment_methods:s,currency:o,allowed_booking_sources:a,adult_child_constraints:n,calendar_legends:l}=t["My_Result"];this.calendarData={currency:o,allowed_booking_sources:a,adult_child_constraints:n,legendData:l};this.setRoomsData(t);const r=["001","004"];this.showPaymentDetails=s.some((t=>r.includes(t.code)))}catch(t){console.error("Error initializing app:",t)}}componentWillLoad(){if(this.baseurl){v.defaults.baseURL=this.baseurl}if(this.ticket!==""){f.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}}async ticketChanged(){f.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}handleCloseBookingWindow(){this.bookingItem=null}handleTriggerClicked(){const t=new Date;t.setDate(t.getDate()+1);this.bookingItem={FROM_DATE:this.from_date,defaultDateRange:{fromDate:new Date,fromDateStr:"",toDate:t,toDateStr:"",dateDifference:0,message:""},TO_DATE:this.to_date,EMAIL:"",event_type:"PLUS_BOOKING",ID:"",NAME:"",PHONE:"",REFERENCE_TYPE:"",TITLE:h.entries.Lcz_NewBooking}}render(){return i(s,{key:"31859a191a13184c986d2c70876e300c1baf8c1d"},this.withIrToastAndInterceptor&&i(o,null,i("ir-toast",null),i("ir-interceptor",null)),i("div",{key:"f0f6fe439caea121b825e4b82dcdc6b5a37a7bd9",class:"book-container",onClick:this.handleTriggerClicked.bind(this)},i("slot",{key:"54cd32aca9ca6b802407f2df8e226c01a7251083",name:"trigger"})),this.bookingItem&&i("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onResetBookingData:t=>{t.stopImmediatePropagation();t.stopPropagation();this.resetBookingData.emit(null)},onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))}static get watchers(){return{ticket:["ticketChanged"]}}};N.style=R;const H=".sc-igl-book-property-footer-h{display:block;margin:0;padding:0}.sc-igl-book-property-footer-h>*.sc-igl-book-property-footer{margin:auto;padding:auto}.gap-30.sc-igl-book-property-footer{gap:30px}";const A=H;const P=class{constructor(i){t(this,i);this.buttonClicked=e(this,"buttonClicked",7);this.eventType=undefined;this.disabled=true}isEventType(t){return t===this.eventType}editNext(t){if(this.isEventType("EDIT_BOOKING")){if(t==="Cancel"){return"flex-fill"}else{return"d-none d-md-block  flex-fill"}}return"flex-fill"}renderButton(t,e,s=false){return i("div",{class:this.shouldRenderTwoButtons()?` ${this.editNext(e)}`:"flex-fill"},i("button",{class:`btn btn-${t==="cancel"?"secondary":"primary"} full-width`,onClick:()=>this.buttonClicked.emit({key:t}),disabled:s},e))}shouldRenderTwoButtons(){return this.isEventType("PLUS_BOOKING")||this.isEventType("ADD_ROOM")||this.isEventType("EDIT_BOOKING")}render(){return i(s,{key:"8c0aaf7b8df2b52a8747db9ad7ef56366196904a"},i("div",{key:"26bdae90e2f71b6e09876803312d2bb854422208",class:"d-flex justify-content-between gap-30 align-items-center"},this.isEventType("EDIT_BOOKING")?i(o,null,this.renderButton("cancel",h.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${h.entries.Lcz_Next} >>`,w("/Get_Exposed_Booking_Availability"))):i(o,null,this.renderButton("cancel",h.entries.Lcz_Cancel),this.shouldRenderTwoButtons()&&this.renderButton("next",`${h.entries.Lcz_Next} >>`))))}};P.style=A;const V=".sc-igl-book-property-header-h{display:block}.row.sc-igl-book-property-header{padding:0 0 0 15px;margin:0}.sourceContainer.sc-igl-book-property-header{max-width:350px}.message-label.sc-igl-book-property-header{font-size:80%}";const G=V;const K=class{constructor(i){t(this,i);this.splitBookingDropDownChange=e(this,"splitBookingDropDownChange",7);this.sourceDropDownChange=e(this,"sourceDropDownChange",7);this.adultChild=e(this,"adultChild",7);this.checkClicked=e(this,"checkClicked",7);this.buttonClicked=e(this,"buttonClicked",7);this.toast=e(this,"toast",7);this.spiltBookingSelected=e(this,"spiltBookingSelected",7);this.animateIrButton=e(this,"animateIrButton",7);this.animateIrSelect=e(this,"animateIrSelect",7);this.sourceOption={code:"",description:"",tag:""};this.splitBookingId="";this.bookingData="";this.minDate=undefined;this.sourceOptions=[];this.message=undefined;this.bookingDataDefaultDateRange=undefined;this.showSplitBookingOption=false;this.adultChildConstraints=undefined;this.splitBookings=undefined;this.adultChildCount=undefined;this.dateRangeData=undefined;this.bookedByInfoData=undefined;this.defaultDaterange=undefined;this.propertyId=undefined}getSplitBookingList(){return i("fieldset",{class:"d-flex flex-column text-left mb-1  flex-lg-row align-items-lg-center"},i("label",{class:"mr-lg-1"},h.entries.Lcz_Tobooking,"# "),i("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},i("ir-autocomplete",{value:Object.keys(this.bookedByInfoData).length>1?`${this.bookedByInfoData.bookingNumber} ${this.bookedByInfoData.firstName} ${this.bookedByInfoData.lastName}`:"",from_date:D(this.bookingDataDefaultDateRange.fromDate).format("YYYY-MM-DD"),to_date:D(this.bookingDataDefaultDateRange.toDate).format("YYYY-MM-DD"),propertyId:this.propertyId,placeholder:h.entries.Lcz_BookingNumber,onComboboxValue:t=>{t.stopImmediatePropagation();this.spiltBookingSelected.emit(t.detail)},isSplitBooking:true})))}getSourceNode(){return i("fieldset",{class:"d-flex flex-column text-left flex-lg-row align-items-lg-center"},i("label",{class:"mr-lg-1"},h.entries.Lcz_Source," "),i("div",{class:"btn-group mt-1 mt-lg-0 sourceContainer"},i("select",{class:"form-control input-sm",id:"xSmallSelect",onChange:t=>this.sourceDropDownChange.emit(t.target.value)},this.sourceOptions.map((t=>{if(t.type==="LABEL"){return i("optgroup",{label:t.value})}return i("option",{value:t.id,selected:this.sourceOption.code===t.id},t.value)})))))}handleAdultChildChange(t,e){let i={};if(e===""){i=Object.assign(Object.assign({},this.adultChildCount),{[t]:0})}else{i=Object.assign(Object.assign({},this.adultChildCount),{[t]:e})}this.adultChild.emit(i)}getAdultChildConstraints(){return i("div",{class:"mt-1 mt-lg-0 d-flex flex-column text-left"},i("label",{class:"mb-1 d-lg-none"},h.entries.Lcz_NumberOfGuests," "),i("div",{class:"form-group my-lg-0 text-left d-flex align-items-center justify-content-between justify-content-sm-start"},i("fieldset",null,i("div",{class:"btn-group "},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("adult",t.detail),select_id:"adult_child_select",firstOption:h.entries.Lcz_AdultsCaption,LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.adult_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),this.adultChildConstraints.child_max_nbr>0&&i("fieldset",null,i("div",{class:"btn-group ml-1"},i("ir-select",{onSelectChange:t=>this.handleAdultChildChange("child",t.detail),select_id:"child_select",firstOption:this.renderChildCaption(),LabelAvailable:false,data:Array.from(Array(this.adultChildConstraints.child_max_nbr),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}))),i("ir-button",{btn_id:"check_availability",isLoading:w("/Get_Exposed_Booking_Availability"),icon:"",size:"sm",class:"ml-2",text:h.entries.Lcz_Check,onClickHanlder:()=>this.handleButtonClicked()})))}renderChildCaption(){const t=this.adultChildConstraints.child_max_age;let e=h.entries.Lcz_Years;if(t===1){e=h.entries.Lcz_Year}return`${h.entries.Lcz_ChildCaption} < ${this.adultChildConstraints.child_max_age} ${e}`}handleButtonClicked(){if(this.isEventType("SPLIT_BOOKING")&&Object.keys(this.bookedByInfoData).length<=1){this.toast.emit({type:"error",title:h.entries.Lcz_ChooseBookingNumber,description:"",position:"top-right"})}else if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){const t=D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date));const e=D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date));const i=D(new Date(this.dateRangeData.fromDate));const s=D(new Date(this.dateRangeData.toDate));if(s.isBefore(e)||i.isAfter(t)){this.toast.emit({type:"error",title:`${h.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"});return}else if(this.adultChildCount.adult===0){this.toast.emit({type:"error",title:h.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"});this.animateIrSelect.emit("adult_child_select")}else{this.buttonClicked.emit({key:"check"})}}else if(this.minDate&&new Date(this.dateRangeData.fromDate).getTime()>new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date).getTime()){this.toast.emit({type:"error",title:`${h.entries.Lcz_CheckInDateShouldBeMAx.replace("%1",D(new Date(this.bookedByInfoData.from_date||this.defaultDaterange.from_date)).format("ddd, DD MMM YYYY")).replace("%2",D(new Date(this.bookedByInfoData.to_date||this.defaultDaterange.to_date)).format("ddd, DD MMM YYYY"))}  `,description:"",position:"top-right"})}else if(this.adultChildCount.adult===0){this.animateIrSelect.emit("adult_child_select");this.toast.emit({type:"error",title:h.entries.Lcz_PlzSelectNumberOfGuests,description:"",position:"top-right"})}else{this.buttonClicked.emit({key:"check"})}}isEventType(t){return this.bookingData.event_type===t}render(){const t=this.showSplitBookingOption?this.getSplitBookingList():this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")?false:true;return i(s,{key:"ef70d87205438731676adfeeabdec14f93e16f80"},this.isEventType("SPLIT_BOOKING")&&this.getSplitBookingList(),t&&this.getSourceNode(),i("div",{key:"319def6bb0048641695657a9d7ee0e697be8711d",class:`d-flex flex-column flex-lg-row align-items-lg-center ${t?"mt-1":""}`},i("fieldset",{key:"c3922a5afea60237f067fe696590680b10f3f673",class:"mt-lg-0  "},i("igl-date-range",{key:"317e0fb4044c1412ee0b175fb65528199428e288",dateLabel:h.entries.Lcz_Dates,minDate:this.isEventType("PLUS_BOOKING")?D().add(-1,"months").startOf("month").format("YYYY-MM-DD"):this.minDate,disabled:this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING"),defaultData:this.bookingDataDefaultDateRange})),!this.isEventType("EDIT_BOOKING")&&this.getAdultChildConstraints()),i("p",{key:"b296c2182995c5ae370bb59d5ecefbc99ac15e72",class:"text-right mt-1 message-label"},f.tax_statement))}};K.style=G;const U=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}.loading-container.sc-igl-booking-overview-page{display:flex;align-items:center;justify-content:center;height:100%;background:white;position:absolute;inset:0;z-index:100}.loader.sc-igl-booking-overview-page{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}";const F=U;const W=class{constructor(i){t(this,i);this.roomsDataUpdate=e(this,"roomsDataUpdate",7);this.bookingData=undefined;this.propertyId=undefined;this.message=undefined;this.showSplitBookingOption=undefined;this.eventType=undefined;this.currency=undefined;this.adultChildConstraints=undefined;this.ratePricingMode=undefined;this.dateRangeData=undefined;this.defaultDaterange=undefined;this.selectedRooms=undefined;this.adultChildCount=undefined;this.sourceOptions=undefined;this.bookedByInfoData=undefined;this.initialRoomIds=undefined}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}setMinDate(){if(!this.isEventType("EDIT_BOOKING")){return}const t=D(this.bookingData.FROM_DATE,"YYYY-MM-DD");const e=D();if(t.isAfter(e)){return e.add(-2,"weeks").format("YYYY-MM-DD")}return t.add(-2,"weeks").format("YYYY-MM-DD")}render(){var t,e;return i(s,{key:"0084d8e5888665e7e0b415df79fc6be3ac9f1cce"},i("igl-book-property-header",{key:"e88f8e74190aa662b15b90d82c2cad407458b5f4",bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,minDate:this.setMinDate(),adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),i("div",{key:"fc40218873522cd677a3521b525fdfa981aff75e",class:" text-left"},w("/Get_Exposed_Booking_Availability")&&this.isEventType("EDIT_BOOKING")?i("div",{class:"loading-container"},i("div",{class:"loader"})):i(o,null,(e=(t=this.bookingData)===null||t===void 0?void 0:t.roomsInfo)===null||e===void 0?void 0:e.map((t=>i("igl-booking-rooms",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomTypeData:t,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,defaultData:this.selectedRooms.get(`c_${t.id}`),onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)}))))),i("igl-book-property-footer",{key:"586fe4e4ac2fa61b392ab4c3adef9a7678069d88",class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type,disabled:this.selectedRooms.size===0}))}};W.style=F;const q=".sc-igl-booking-room-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-booking-room-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-booking-room-rate-plan{font-size:14px;line-height:0;padding:0;height:0;border-left:0}.rate-input-container.sc-igl-booking-room-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.new-currency.sc-igl-booking-room-rate-plan{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:white;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-state='focus'].sc-igl-booking-room-rate-plan{border-color:var(--blue)}.input-group-prepend.sc-igl-booking-room-rate-plan span[data-disabled].sc-igl-booking-room-rate-plan{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:40%}.rateplan-container.sc-igl-booking-room-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-booking-room-rate-plan{max-width:200px}.rate-input-container.sc-igl-booking-room-rate-plan{max-width:100px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:35%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-booking-room-rate-plan{width:100%}}.total-nights-container.sc-igl-booking-room-rate-plan{width:max-content}.nightBorder.sc-igl-booking-room-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const J=q;const X=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.gotoSplitPageTwoEvent=e(this,"gotoSplitPageTwoEvent",7);this.initialRateValue=0;this.defaultData=undefined;this.ratePlanData=undefined;this.totalAvailableRooms=undefined;this.index=undefined;this.ratePricingMode=[];this.currency=undefined;this.physicalrooms=undefined;this.shouldBeDisabled=undefined;this.dateDifference=undefined;this.bookingType="PLUS_BOOKING";this.fullyBlocked=undefined;this.isBookDisabled=false;this.defaultRoomId=undefined;this.selectedRoom=undefined;this.is_bed_configuration_enabled=undefined;this.isInputFocused=false;this.selectedData=undefined;this.ratePlanChangedState=false}getAvailableRooms(t){let e=[];t.forEach((t=>{if(t.Is_Fully_Available){e.push({name:t.name,id:t.pr_id})}}));return e}componentWillLoad(){this.updateSelectedRatePlan(this.ratePlanData)}disableForm(){if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){return false}else{return this.selectedData.is_closed||this.totalAvailableRooms===0||f.is_frontdesk_enabled&&this.selectedData.physicalRooms.length===0}}setAvailableRooms(t){let e=this.getAvailableRooms(t);if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){if(this.selectedRoom){e.push({id:this.selectedRoom.roomId,name:this.selectedRoom.roomName});e.sort(((t,e)=>{if(t.name<e.name){return-1}if(t.name>e.name){return 1}return 0}))}}return e}getSelectedOffering(t){return this.ratePlanData.variations.find((e=>e.adult_child_offering===t))}updateSelectedRatePlan(t){var e;this.selectedData={is_bed_configuration_enabled:this.is_bed_configuration_enabled,ratePlanId:t.id,adult_child_offering:t.variations[t.variations.length-1].adult_child_offering,rateType:1,totalRooms:0,rate:(e=t.variations[t.variations.length-1].amount)!==null&&e!==void 0?e:0,ratePlanName:t.name,adultCount:t.variations[t.variations.length-1].adult_nbr,childrenCount:t.variations[t.variations.length-1].child_nbr,cancelation:t.cancelation,guarantee:t.guarantee,isRateModified:false,defaultSelectedRate:0,index:this.index,is_closed:t.is_closed,physicalRooms:this.setAvailableRooms(this.ratePlanData.assignable_units),dateDifference:this.dateDifference};if(this.defaultData){for(const[t,e]of Object.entries(this.defaultData)){this.selectedData[t]=e}this.selectedData["rateType"]=1}if(this.defaultData&&this.defaultData.isRateModified){console.log("object");if(this.selectedData.rateType===1){console.log("object1");this.initialRateValue=this.selectedData.rate}else{console.log("object2");this.initialRateValue=this.selectedData.rate*this.dateDifference}}else{this.initialRateValue=this.selectedData.rate/this.dateDifference}}componentDidLoad(){if(this.defaultData){this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"physicalRooms",data:this.selectedData})}}async ratePlanDataChanged(t){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t.variations[t.variations.length-1].adult_child_offering,adultCount:t.variations[t.variations.length-1].adult_nbr,childrenCount:t.variations[t.variations.length-1].child_nbr,rate:this.handleRateDaysUpdate(),physicalRooms:this.setAvailableRooms(t.assignable_units)});this.initialRateValue=this.selectedData.rateType===2?this.selectedData.rate/this.dateDifference:this.selectedData.rate;this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}handleRateDaysUpdate(){if(this.selectedData.isRateModified){return this.selectedData.defaultSelectedRate}const t=this.getSelectedOffering(this.selectedData.adult_child_offering);return t?t.amount:0}handleInput(t){const e=t.target;let i=e.value.replace(/[^0-9.]/g,"");const s=/^\d*\.?\d*$/;if(!s.test(i)){i=i.substring(0,i.length-1)}e.value=i;if(i){this.selectedData.isRateModified=true;this.handleDataChange("rate",t)}else{this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:-1,totalRooms:0});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}}handleDataChange(t,e){const i=e.target.value;switch(t){case"adult_child_offering":this.updateOffering(i);break;case"rate":this.updateRate(i);break;default:this.updateGenericData(t,i);break}this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:t,data:this.selectedData})}updateOffering(t){const e=this.getSelectedOffering(t);if(e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t,adultCount:e.adult_nbr,childrenCount:e.child_nbr,rate:e.amount,isRateModified:false})}}updateRate(t){const e=t===""?0:Number(t);this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:e,totalRooms:t===""?0:this.selectedData.totalRooms,defaultSelectedRate:this.selectedData.rateType===2?e/this.dateDifference:e})}updateGenericData(t,e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{[t]:e===""?0:parseInt(e)})}bookProperty(){this.dataUpdateEvent.emit({key:"clearData",data:this.selectedData});this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){if(this.selectedData.isRateModified){console.log("selectedData.rate",this.selectedData.rate);return this.selectedData.rate===-1?"":this.selectedData.rate}return this.selectedData.rateType===1?Number(this.selectedData.rate).toFixed(2):Number(this.initialRateValue).toFixed(2)}render(){return i(s,{key:"a53694eacf619e359f4845043975f0fc2a884e95"},i("div",{key:"eb867f5712ffd54f5c6ca84bd1882fd5ab787260",class:"d-flex flex-column m-0 p-0 flex-lg-row align-items-lg-center justify-content-lg-between "},i("div",{key:"2833658bd65b00f81a40c516a1c0af47ff2e2fc1",class:"rateplan-name-container"},this.bookingType==="BAR_BOOKING"?i(o,null,i("span",{class:"font-weight-bold\t"},this.ratePlanData.name.split("/")[0]),i("span",null,"/",this.ratePlanData.name.split("/")[1])):i("span",null,this.ratePlanData.name),i("ir-tooltip",{key:"29365a5ff1a826bb1dc50ad93c29d0eec7de0655",message:this.ratePlanData.cancelation+this.ratePlanData.guarantee})),i("div",{key:"6711c90d59bf3101bb1252e6327330cb0e1da74f",class:"d-md-flex justify-content-md-end  align-items-md-center  flex-fill rateplan-container"},i("div",{key:"d4135ca9a83f2957381361587de1fe59c5d34c63",class:"mt-1 mt-lg-0 flex-fill max-w-300"},i("fieldset",{key:"44db542207713a4ba9fd9bd03c4288600b337200",class:"position-relative"},i("select",{key:"9bf475a8880801c9e8262ccf29c67f384271b464",disabled:this.disableForm(),class:"form-control  input-sm",id:p(),onChange:t=>this.handleDataChange("adult_child_offering",t)},this.ratePlanData.variations.map((t=>i("option",{value:t.adult_child_offering,selected:this.selectedData.adult_child_offering===t.adult_child_offering},t.adult_child_offering)))))),i("div",{key:"b061ae3d410aae56a6d13586216d5f01a011c3fb",class:"m-0 p-0 d-md-flex justify-content-between ml-md-1 "},i("div",{key:"ea5d49850e38f678bc20f4b9d1012a98e0ebdffb",class:" d-flex mt-1  mt-lg-0 m-0 p-0 rate-total-night-view   "},i("fieldset",{key:"4bcf22040e00245137df815a0156c77d1a24f9cb",class:"position-relative has-icon-left m-0 p-0 rate-input-container  "},i("div",{key:"060b33f1cba9513c0fe64f548402eb98fbf82896",class:"input-group-prepend"},i("span",{key:"a9cf19be0852878615e3a48f668e3ad805bc4327","data-disabled":this.disableForm(),"data-state":this.isInputFocused?"focus":"",class:"input-group-text new-currency",id:"basic-addon1"},n(this.currency.code))),i("input",{key:"8e8cb37977cb69d598f9c39e6c0fbbd1980d596b",onFocus:()=>this.isInputFocused=true,onBlur:()=>this.isInputFocused=false,disabled:this.disableForm(),type:"text",class:"form-control pl-0 input-sm rate-input py-0 m-0 rounded-0 rateInputBorder",value:this.renderRate(),id:p(),placeholder:h.entries.Lcz_Rate||"Rate",onInput:t=>this.handleInput(t)})),i("fieldset",{key:"c0be6574066082c4e7b820e059f74673c8e61160",class:"position-relative m-0 total-nights-container p-0 "},i("select",{key:"f38dd7aa3a6f2f56264ffeedc03d04d6c0cd282b",disabled:this.disableForm(),class:"form-control input-sm m-0 nightBorder rounded-0  py-0",id:p(),onChange:t=>this.handleDataChange("rateType",t)},this.ratePricingMode.map((t=>i("option",{value:t.CODE_NAME,selected:this.selectedData.rateType===+t.CODE_NAME},t.CODE_VALUE_EN)))))),this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"?i("div",{class:"flex-lg-fill  mt-lg-0 ml-md-2 m-0 mt-1 p-0"},i("fieldset",{class:"position-relative"},i("select",{disabled:this.selectedData.rate===0||this.disableForm(),class:"form-control input-sm",id:p(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:this.totalAvailableRooms+1},((t,e)=>e)).map((t=>i("option",{value:t,selected:this.selectedData.totalRooms===t},t)))))):null),this.bookingType==="EDIT_BOOKING"?i(o,null,i("div",{class:" m-0 p-0  mt-lg-0  ml-md-1 mt-md-1 d-none d-md-block"},i("fieldset",{class:"position-relative"},i("input",{disabled:this.disableForm(),type:"radio",name:"ratePlanGroup",value:"1",onChange:t=>this.handleDataChange("totalRooms",t),checked:this.selectedData.totalRooms===1}))),i("button",{disabled:this.selectedData.rate===-1||this.disableForm(),type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 d-md-none ",onClick:()=>this.bookProperty()},this.selectedData.totalRooms===1?h.entries.Lcz_Current:h.entries.Lcz_Select)):null,this.bookingType==="BAR_BOOKING"||this.bookingType==="SPLIT_BOOKING"?i("button",{disabled:this.selectedData.rate===-1||this.disableForm()||this.bookingType==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 ",onClick:()=>this.bookProperty()},h.entries.Lcz_Book):null)))}static get watchers(){return{ratePlanData:["ratePlanDataChanged"]}}};X.style=J;const Z=".sc-igl-booking-rooms-h{display:block}.margin-bottom-8.sc-igl-booking-rooms{margin-bottom:8px !important}";const Q=Z;const tt=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.validBookingTypes=["PLUS_BOOKING","ADD_ROOM","EDIT_BOOKING","SPLIT_BOOKING"];this.roomTypeData=undefined;this.defaultData=undefined;this.bookingType="PLUS_BOOKING";this.dateDifference=undefined;this.ratePricingMode=[];this.roomInfoId=null;this.currency=undefined;this.selectedRooms=[];this.totalRooms=undefined;this.isBookDisabled=undefined;this.initialRoomIds=undefined;this.roomsDistributions=[]}componentWillLoad(){this.initializeRoomData()}initializeRoomData(){const{inventory:t,rateplans:e}=this.roomTypeData;this.totalRooms=t||0;this.selectedRooms=new Array(e.length).fill(0);this.roomsDistributions=this.calculateInitialDistributions(e,t)}handleRoomTypeData(){this.initializeRoomData()}calculateInitialDistributions(t,e){let i=new Array(t.length).fill(e);if(this.defaultData&&this.bookingType!=="EDIT_BOOKING"&&e>0){let t=[];let e=0;this.defaultData.forEach((s=>{this.selectedRooms[s.index]=s.totalRooms;i[s.index]=s.totalRooms;e+=s.totalRooms;t.push(s.index)}));if(t.length<i.length){i.forEach(((s,o)=>{if(!t.includes(o)){if(e===this.totalRooms){i[o]=0}else{i[o]=i[o]-e}}else{if(e<this.totalRooms){i[o]=this.totalRooms-e+i[o]}}}))}}else{i.fill(e)}return i}onRoomDataUpdate(t,e){t.stopImmediatePropagation();const{detail:{data:i,changedKey:s}}=t;let o=Object.assign({},i);if(s==="totalRooms"){this.handleTotalRoomsUpdate(e,o.totalRooms)}o=Object.assign(Object.assign({},o),{roomCategoryId:this.roomTypeData.id,roomCategoryName:this.roomTypeData.name,inventory:this.roomTypeData.inventory});this.dataUpdateEvent.emit({key:i.key,data:o,changedKey:s})}handleTotalRoomsUpdate(t,e){if(this.selectedRooms[t]!==e){this.selectedRooms[t]=e;this.updateRatePlanTotalRooms(t)}}updateRatePlanTotalRooms(t){const e=t=>this.selectedRooms.reduce(((e,i,s)=>s!==t?e+i:e),0);const i=this.selectedRooms.map(((i,s)=>{if(s===t){return this.roomsDistributions[s]}const o=e(s);const a=this.totalRooms-o;return a>0?a:0}));if(JSON.stringify(this.roomsDistributions)!==JSON.stringify(i)){this.roomsDistributions=[...i]}}render(){const t=this.validBookingTypes.includes(this.bookingType);return i(s,{key:"1e9103475269676900d929810f166f211e84cfc5"},t&&i("div",{class:"font-weight-bold font-medium-1 margin-bottom-8 "},this.roomTypeData.name),this.roomTypeData.rateplans.map(((e,s)=>{if(e.variations!==null){let o=this.roomInfoId&&this.roomInfoId===this.roomTypeData.id;let a=-1;if(o&&this.initialRoomIds){a=this.initialRoomIds.roomId}return i("igl-booking-room-rate-plan",{is_bed_configuration_enabled:this.roomTypeData.is_bed_configuration_enabled,index:s,isBookDisabled:this.isBookDisabled,key:`rate-plan-${e.id}`,ratePricingMode:this.ratePricingMode,class:t?"":"",currency:this.currency,dateDifference:this.dateDifference,ratePlanData:e,totalAvailableRooms:this.roomsDistributions[s],bookingType:this.bookingType,defaultData:this.defaultData&&this.defaultData.get(`p_${e.id}`)||null,shouldBeDisabled:o,onDataUpdateEvent:t=>this.onRoomDataUpdate(t,s),physicalrooms:this.roomTypeData.physicalrooms,defaultRoomId:a,selectedRoom:this.initialRoomIds})}else{return null}})))}static get watchers(){return{roomTypeData:["handleRoomTypeData"]}}};tt.style=Q;const et=".sc-igl-date-range-h{display:flex;align-items:center !important;font-size:14px !important}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1;cursor:pointer;width:220px !important;opacity:0;user-select:none;font-size:14px !important}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.date-view.sc-igl-date-range{position:absolute;background:white;pointer-events:none;cursor:pointer;display:block;margin-left:14px;margin-right:14px;font-size:13.65px !important;display:flex;align-items:center}.date-view.sc-igl-date-range svg.sc-igl-date-range{padding:0 !important;margin:0;margin-right:10px}.calendarPickerContainer.sc-igl-date-range{display:flex !important;position:relative !important;text-align:left;align-items:center !important;padding:0 !important;margin:0;border:1px solid var(--ir-date-range-border, #379ff2);width:var(--ir-date-range-width, 245px);transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}.calendarPickerContainer.sc-igl-date-range:focus-within{border-color:#379ff2}.calendarPickerContainer[data-state='disabled'].sc-igl-date-range{border:0px;width:280px}.date-view[data-state='disabled'].sc-igl-date-range,.date-range-input[data-state='disabled'].sc-igl-date-range{margin:0;cursor:default}";const it=et;const st=class{constructor(i){t(this,i);this.dateSelectEvent=e(this,"dateSelectEvent",7);this.toast=e(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.withDateDifference=true;this.renderAgain=false}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}initializeDates(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:this.fromDateStr,toDateStr:this.toDateStr,dateDifference:this.totalNights})}}componentWillLoad(){this.initializeDates()}handleDataChange(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){this.initializeDates()}}calculateTotalNights(){this.totalNights=m(D(this.fromDate).format("YYYY-MM-DD"),D(this.toDate).format("YYYY-MM-DD"))}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){return i(s,{key:"5f12bce02bf083ee1f83213b463c8ab6218b31dd"},i("div",{key:"4de337a6dec55b3adf2a7bfdd25f202332cdac39",class:"calendarPickerContainer form-control input-sm","data-state":this.disabled?"disabled":"active"},i("ir-date-picker",{key:"1bf65df8d95865c18630aa7fb9bc5e50028cae81",maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,"data-state":this.disabled?"disabled":"active",onDateChanged:t=>{this.handleDateChange(t)}}),i("div",{key:"5c6cab473acfd220bd656e405d25e762aaa79636","data-state":this.disabled?"disabled":"active",class:"date-view"},i("svg",{key:"c97ee69fe0a9818213733ce3eee7e0ee00aa7258",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"10.5",viewBox:"0 0 448 512"},i("path",{key:"6e1ae3f72291757ce444821e2688424475a88748",fill:"currentColor",d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"})),i("ir-date-view",{key:"a8328e5c8f87a703eecea36ddc5168a7f8ee7356",showDateDifference:this.disabled,from_date:this.fromDate,to_date:this.toDate}))),this.withDateDifference&&i("span",null,this.totalNights&&!this.disabled?i("span",{class:"iglRangeNights mx-1"},this.totalNights+(this.totalNights>1?` ${h.entries.Lcz_Nights}`:` ${h.entries.Lcz_Night}`)):""))}static get watchers(){return{defaultData:["handleDataChange"]}}};st.style=it;const ot=".sc-igl-pagetwo-h{display:block}.card-title.sc-igl-pagetwo{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-pagetwo{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-pagetwo{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-pagetwo{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-pagetwo{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-pagetwo:not(:disabled),[type='button'].sc-igl-pagetwo:not(:disabled){cursor:pointer}.row.sc-igl-pagetwo{padding:0 0 0 15px;margin:0}";const at=ot;const nt=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.buttonClicked=e(this,"buttonClicked",7);this.showPaymentDetails=undefined;this.currency=undefined;this.isEditOrAddRoomEvent=undefined;this.dateRangeData=undefined;this.bookingData=undefined;this.showSplitBookingOption=undefined;this.language=undefined;this.bookedByInfoData=undefined;this.propertyId=undefined;this.bedPreferenceType=undefined;this.selectedRooms=undefined;this.isLoading=undefined;this.countryNodeList=undefined;this.selectedGuestData=undefined;this.defaultGuestData=undefined;this.selectedBookedByData=undefined;this.guestData=undefined;this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const e=Object.assign({},this.selectedUnits);const i=(t,e,i,s)=>{if(i&&s===2){return t*e}return t};this.selectedUnits=e;this.guestData=[];this.selectedRooms.forEach(((s,o)=>{s.forEach((s=>{e[o]=s.selectedUnits;t+=s.totalRooms*i(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,e){const i=t.detail;const s=`c_${i.data.roomCategoryId}`;const o=[...this.selectedUnits[s]||[]];o[e]=i.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:o});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,e,i){if(e==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,i)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const e=(t,e,i)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(e==="selectedArrivalTime"){if(t[e]!==undefined){return t[e].code===""}else{return true}}return t[e]===i||t[e]===undefined};return this.isLoading===t||e(this.selectedGuestData,"guestName","")||e(this.selectedBookedByData,"isdCode","")||e(this.selectedBookedByData,"contactNumber","")||e(this.selectedBookedByData,"firstName","")||e(this.selectedBookedByData,"lastName","")||e(this.selectedBookedByData,"countryId",-1)||e(this.selectedBookedByData,"selectedArrivalTime","")||e(this.selectedBookedByData,"email","")}render(){return i(s,{key:"b516e02fa566130472810b0c1458dbf2e3eb7be4"},i("div",{key:"e8ab891fbb31bcf43a71d78935121a68b1534e38",class:"d-flex flex-wrap"},i("ir-date-view",{key:"2f17bd9995e43ea9f47684b5fd20b977555e9519",class:"mr-1 flex-fill font-weight-bold font-medium-1",from_date:this.dateRangeData.fromDateStr,to_date:this.dateRangeData.toDateStr,dateOption:"DD MMM YYYY"}),this.guestData.length>1&&i("div",{class:"mt-1 mt-md-0 text-right"},h.entries.Lcz_TotalPrice," ",i("span",{class:"font-weight-bold font-medium-1"},n(this.currency.code)+this.bookingData.TOTAL_PRICE||"$0.00"))),this.guestData.map(((t,e)=>i("igl-application-info",{dateDifference:this.dateRangeData.dateDifference,defaultGuestPreference:this.defaultGuestData.bed_preference,defaultGuestRoomId:this.defaultGuestData.PR_ID,currency:this.currency,bedPreferenceType:this.bedPreferenceType,index:e,selectedUnits:this.selectedUnits[`c_${t.roomCategoryId}`],guestInfo:t,guestRefKey:e,bookingType:this.bookingData.event_type,roomsList:t.physicalRooms,onDataUpdateEvent:t=>this.handleEventData(t,"application-info",e)}))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:i("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>this.handleEventData(t,"propertyBookedBy",0)}),this.isEditOrAddRoomEvent?i("div",{class:"d-flex p-0 mb-1 mt-2"},i("div",{class:"flex-fill mr-2"},i("ir-button",{icon:"",text:h.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"})})),i("div",{class:"flex-fill"},i("ir-button",{isLoading:this.isLoading==="save",onClickHanlder:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:h.entries.Lcz_Save}))):i("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},i("div",{class:"flex-fill mr-md-1"},i("button",{type:"button",class:"btn btn-secondary full-width",onClick:()=>this.buttonClicked.emit({key:"back"})},i("span",{class:"d-none d-md-inline-flex"}," <<")," ",h.entries.Lcz_Back)),i("div",{class:"mt-1 mt-md-0 flex-fill"},i("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"book"}),text:h.entries.Lcz_Book}))))}};nt.style=at;const lt=".sc-igl-property-booked-by-h{display:block}.row.sc-igl-property-booked-by{padding:0 0 0 15px;margin:0}.bookedByEmailContainer.sc-igl-property-booked-by{flex:auto;max-width:350px}.bookedDetailsForm.sc-igl-property-booked-by label.sc-igl-property-booked-by{min-width:125px;max-width:125px}.bookedDetailsForm.sc-igl-property-booked-by .form-group.sc-igl-property-booked-by{margin-bottom:10px !important}.bookedDetailsForm.sc-igl-property-booked-by .checkBoxContainer.sc-igl-property-booked-by input.sc-igl-property-booked-by{height:1.2rem !important;width:30px}.controlContainer.sc-igl-property-booked-by textarea.sc-igl-property-booked-by{height:60px !important}.margin3.sc-igl-property-booked-by{margin-bottom:5px !important}@media (min-width: 768px){.bookedByEmailContainer.sc-igl-property-booked-by{margin-left:37px}}";const rt=lt;const ct=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.bookingService=new b;this.arrivalTimeList=[];this.expiryMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];this.expiryYears=[];this.currentMonth="01";this.language=undefined;this.showPaymentDetails=false;this.defaultData=undefined;this.countryNodeList=[];this.propertyId=undefined;this.isButtonPressed=false;this.bookedByData={id:undefined,email:"",firstName:"",lastName:"",countryId:"",isdCode:"",contactNumber:"",selectedArrivalTime:"",emailGuest:true,message:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""}}async componentWillLoad(){this.bookingService.setToken(f.token);this.assignCountryCode();this.initializeExpiryYears();this.initializeDateData();this.populateBookedByData()}initializeExpiryYears(){const t=(new Date).getFullYear();this.expiryYears=Array.from({length:4},((e,i)=>(t+i).toString()))}async assignCountryCode(){const t=await this.bookingService.getUserDefaultCountry();const e=t["COUNTRY_ID"];this.country=e;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.toString(),countryId:e})}initializeDateData(){const t=new Date;const e=t.getMonth()+1;this.currentMonth=e<10?`0${e}`:e.toString()}populateBookedByData(){var t;this.bookedByData=this.defaultData?Object.assign(Object.assign({},this.bookedByData),this.defaultData):{};this.arrivalTimeList=((t=this.defaultData)===null||t===void 0?void 0:t.arrivalTime)||[];this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{selectedArrivalTime:this.arrivalTimeList[0].CODE_NAME});if(!this.bookedByData.expiryMonth){this.bookedByData.expiryMonth=this.currentMonth}if(!this.bookedByData.expiryYear){this.bookedByData.expiryYear=(new Date).getFullYear()}console.log("initial bookedby data",this.bookedByData)}handleDataChange(t,e){this.bookedByData[t]=t==="emailGuest"?e.target.checked:e.target.value;this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)});if(t==="countryId"){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{isdCode:e.target.value})}console.log(this.bookedByData)}handleNumberInput(t,e){const i=e.target;const s=i.value;const o=/^[0-9]+$/;if(!o.test(s)){i.value=s.replace(/[^0-9]/g,"")}if(s===i.value){this.handleDataChange(t,e)}}async handleEmailInput(t,e){const i=e.target;const s=i.value;if(this.isValidEmail(s)){this.handleDataChange(t,e)}}async checkUser(){try{const t=this.bookedByData.email;if(this.isValidEmail(t)){const e=await this.bookingService.getUserInfo(t);if(e!==null){this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:e.id,firstName:e.first_name,lastName:e.last_name,contactNumber:e.mobile,countryId:e.country_id,isdCode:e.country_id.toString()})}else{this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:undefined,firstName:"",lastName:"",contactNumber:"",countryId:"",isdCode:""})}this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}}catch(t){}}isValidEmail(t){const e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;return e.test(t)}handleComboboxChange(t){t.stopImmediatePropagation();t.stopPropagation();const{key:e,data:i}=t.detail;switch(e){case"blur":if(i!==""){this.bookedByData.email=i;this.checkUser()}break;case"select":this.bookedByData.email=i.email;this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:i.id,firstName:i.first_name,lastName:i.last_name,contactNumber:i.mobile,countryId:i.country_id,isdCode:i.country_id.toString()});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:this.bookedByData});break}}clearEvent(){this.bookedByData.email="";this.bookedByData=Object.assign(Object.assign({},this.bookedByData),{id:"",firstName:"",lastName:"",contactNumber:"",isdCode:this.country.toString(),countryId:this.country});this.dataUpdateEvent.emit({key:"bookedByInfoUpdated",data:Object.assign({},this.bookedByData)})}handleButtonClicked(t){switch(t.detail.key){case"book":case"bookAndCheckIn":this.isButtonPressed=true;break}}render(){return i(s,{key:"8085bb09b1fc3ff8a252c851de668a0a8c265c27"},i("div",{key:"5ae75829001ae3a3cb8221bdb7d66ae35299e2ab",class:"text-left mt-3"},i("div",{key:"211d29f71a49622b72ac3672c45ae0594b9cdd31",class:"form-group d-flex flex-column flex-md-row align-items-md-center text-left "},i("label",{key:"ad5d423298ae2ba302035b2c4616c0d5276e67bc",class:"p-0 m-0 label-control mr-1 font-weight-bold"},h.entries.Lcz_BookedBy),i("div",{key:"4953b4ae4797ccfaec8b242fa2684ada226b65dd",class:"bookedByEmailContainer mt-1 mt-md-0"},i("ir-autocomplete",{key:"9f660add26e6886487f8f74f7ba823b33105f0b2",danger_border:this.isButtonPressed&&this.bookedByData.email==="",onComboboxValue:this.handleComboboxChange.bind(this),propertyId:this.propertyId,type:"email",value:this.bookedByData.email,required:true,placeholder:h.entries.Lcz_FindEmailAddress,onInputCleared:()=>this.clearEvent()})))),i("div",{key:"96f981f3ec5aff9d19b4cf9b72731a9a1f373081",class:"bookedDetailsForm text-left mt-2 font-small-3 "},i("div",{key:"36669d31d7c1d0816f00ba18449f736c6f606e11",class:"d-flex flex-column flex-md-row  justify-content-md-between "},i("div",{key:"10614368b9411fb19ebfa4e75d4f2948c9d730d0",class:"p-0 flex-fill "},i("div",{key:"def32dbd94e6382931c12985299b42e91e26678e",class:"form-group d-flex flex-column flex-md-row align-items-md-center p-0 flex-fill "},i("label",{key:"0c6cba219a25c5ca293a21c6af24b931807ac4f0",class:"p-0 m-0 margin3"},h.entries.Lcz_FirstName),i("div",{key:"a702ae5bf8c78980b5736b50073668185a2c31ad",class:"p-0 m-0  controlContainer flex-fill  "},i("input",{key:"6e8b0fb02027e902630cde0ff8e592a947f3dfc8",class:`form-control flex-fill ${this.isButtonPressed&&this.bookedByData.firstName===""&&"border-danger"}`,type:"text",placeholder:h.entries.Lcz_FirstName,id:p(),value:this.bookedByData.firstName,onInput:t=>this.handleDataChange("firstName",t),required:true}))),i("div",{key:"de065e9dd0b4cc9c62f59270b292b8f3bd04fdb7",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"c2f5c450016aa34fbe2ab2b10866f75e14b8a50b",class:"p-0 m-0 margin3"},h.entries.Lcz_LastName),i("div",{key:"74e54a7d6b4c53d7ad0b1ae707c8e2a527026605",class:"p-0 m-0  controlContainer flex-fill"},i("input",{key:"2585817b549f732b968416c1f340802133426821",class:`form-control ${this.isButtonPressed&&this.bookedByData.lastName===""&&"border-danger"}`,type:"text",placeholder:h.entries.Lcz_LastName,id:p(),value:this.bookedByData.lastName,onInput:t=>this.handleDataChange("lastName",t)}))),i("div",{key:"ed11939b4eea912b4f08c1c3ad5b77bb8065783f",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"6343c442f0beee8880324c8225bd54a8c89300bb",class:"p-0 m-0 margin3"},h.entries.Lcz_Country),i("div",{key:"3cb9a473da355de2d0da4cad5b8e213a59f1da7e",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"76937cf03c21a4b48bfdc38d92f0b180c30218cd",class:`form-control input-sm pr-0`,id:p(),onChange:t=>this.handleDataChange("countryId",t)},i("option",{key:"2db0b0ad990e22db472d838b6a0a8d407ec87a18",value:"",selected:this.bookedByData.countryId===""},h.entries.Lcz_Select),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.countryId===t.id},t.name)))))),i("div",{key:"bb39f612710c0fd97d0f1902621c8362cd7bddd7",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"e94f7f4bef407c35a5930404a9bfa2eea66b83a3",class:"p-0 m-0 margin3"},h.entries.Lcz_MobilePhone),i("div",{key:"dd523b0524c21460530f77d750c5ad8711612333",class:"p-0 m-0  d-flex  controlContainer flex-fill"},i("div",{key:"9bd064dba20a6710f29e30d83ab1352abcd6f05b",class:" p-0 m-0"},i("select",{key:"eab088a6dbde4d9e55055628e086452417fb78f9",class:`form-control input-sm pr-0`,id:p(),onChange:t=>this.handleDataChange("isdCode",t)},i("option",{key:"bfead3711bd89bec23b76fd5dbd90e2a7b2813ba",value:"",selected:this.bookedByData.isdCode===""},h.entries.Lcz_Isd),this.countryNodeList.map((t=>i("option",{value:t.id,selected:this.bookedByData.isdCode===t.id.toString()},t.phone_prefix))))),i("div",{key:"92c12e3e3ae775c073694a3bf100d588d58c7881",class:"flex-fill p-0 m-0"},i("input",{key:"26c60dcd6ca8136630df5766f293234867fdf34e",class:`form-control\n                     \n                      `,type:"tel",placeholder:h.entries.Lcz_ContactNumber,id:p(),value:this.bookedByData.contactNumber,onInput:t=>this.handleNumberInput("contactNumber",t)})))),i("div",{key:"d7ea90fab261cf05b819cb2cbce29db575527e44",class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{key:"7626601aeeec639f673e94aa8ddd35002ce8f8f9",class:"p-0 m-0 margin3"},h.entries.Lcz_YourArrivalTime),i("div",{key:"9f27ee3c1edc8bb703146ce1d55cde904cc929d6",class:"p-0 m-0  controlContainer flex-fill"},i("select",{key:"6880f056df9b51bf6bef70781194e7298f9f9ae2",class:`form-control input-sm pr-0 ${this.isButtonPressed&&this.bookedByData.selectedArrivalTime.code===""&&"border-danger"}`,id:p(),onChange:t=>this.handleDataChange("selectedArrivalTime",t)},this.arrivalTimeList.map((t=>i("option",{value:t.CODE_NAME,selected:this.bookedByData.selectedArrivalTime.code===t.CODE_NAME},t.CODE_VALUE_EN))))))),i("div",{key:"1e6a08c00b3580a5369b20458f37b4f22f58eedc",class:"p-0 flex-fill  ml-md-3"},i("div",{key:"a951122c71aad518650922e52362762ab2b3fcf8",class:"  p-0 d-flex flex-column flex-md-row align-items-md-center "},i("label",{key:"ce5af7bf620146e5281cb06d15e049240dfcaf57",class:"p-0 m-0 margin3"},h.entries.Lcz_AnyMessageForUs),i("div",{key:"10a785ad9a665b716cbfc1cfbbf3321232fc0cc4",class:"p-0 m-0  controlContainer flex-fill "},i("textarea",{key:"2cb0b7519c0b8faa4df8fc937de7e1e4595591d6",id:p(),rows:4,class:"form-control ",name:"message",value:this.bookedByData.message,onInput:t=>this.handleDataChange("message",t)}))),this.showPaymentDetails&&i(o,null,i("div",{class:"form-group mt-md-1  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{class:"p-0 m-0 margin3"},h.entries.Lcz_CardNumber),i("div",{class:"p-0 m-0  controlContainer flex-fill"},i("input",{class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:p(),value:this.bookedByData.cardNumber,onInput:t=>this.handleNumberInput("cardNumber",t)}))),i("div",{class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{class:"p-0 m-0 margin3"},h.entries.Lcz_CardHolderName),i("div",{class:"p-0 m-0  controlContainer flex-fill"},i("input",{class:"form-control",type:"text",placeholder:"",pattern:"0-9 ",id:p(),value:this.bookedByData.cardHolderName,onInput:t=>this.handleDataChange("cardHolderName",t)}))),i("div",{class:"form-group  p-0 d-flex flex-column flex-md-row align-items-md-center"},i("label",{class:"p-0 m-0 margin3"},h.entries.Lcz_ExpiryDate),i("div",{class:"p-0 m-0 row  controlContainer flex-fill"},i("div",{class:"p-0 m-0"},i("select",{class:"form-control input-sm pr-0",id:p(),onChange:t=>this.handleDataChange("expiryMonth",t)},this.expiryMonths.map((t=>i("option",{value:t,selected:t===this.bookedByData.expiryMonth},t))))),i("div",{class:"p-0 m-0 ml-1"},i("select",{class:"form-control input-sm pr-0",id:p(),onChange:t=>this.handleDataChange("expiryYear",t)},this.expiryYears.map(((t,e)=>i("option",{value:t,selected:e===this.bookedByData.expiryYear},t)))))))),i("div",{key:"0dacca385aaffd18734bf24ff936dc8cc50ba8bb",class:"form-group mt-1 p-0 d-flex flex-row align-items-center"},i("label",{key:"16a7f51e5403d266d8ea5156a5bd6535acca0fd4",class:"p-0 m-0",htmlFor:"emailTheGuestId"},h.entries.Lcz_EmailTheGuest),i("div",{key:"a103bb926e7917f34c6f57184cc9ce7113f50a48",class:"p-0 m-0  controlContainer flex-fill checkBoxContainer"},i("input",{key:"6501ba9abe408a2759990545ba80ae666be34ab6",class:"form-control",type:"checkbox",checked:this.bookedByData.emailGuest,id:"emailTheGuestId",onChange:t=>this.handleDataChange("emailGuest",t)})))))))}};ct.style=rt;const dt=".sc-ir-autocomplete-h{display:block;position:relative}.selected.sc-ir-autocomplete{color:#fff;text-decoration:none;background-color:#666ee8}input.sc-ir-autocomplete{width:100%;position:relative;border-top-left-radius:0px !important;border-left:0 !important;border-bottom-left-radius:0px !important}label.sc-ir-autocomplete{margin:0;border-top-right-radius:0px !important;border-right:0 !important;border-bottom-right-radius:0px !important;width:fit-content;display:flex;align-items:center;padding-right:3px !important;justify-content:center;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}label[data-state='focused'].sc-ir-autocomplete{border-color:var(--blue)}.combobox.sc-ir-autocomplete{margin:0;top:30px;min-width:100%;width:max-content;display:block;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto}.dropdown-item.sc-ir-autocomplete{cursor:pointer}button.sc-ir-autocomplete{all:unset;right:4px}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete,span.sc-ir-autocomplete,loader-container.sc-ir-autocomplete{padding:5px 16px;margin:0px;margin-top:2px;width:100%}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete{cursor:pointer}.combobox.sc-ir-autocomplete p.sc-ir-autocomplete:hover{background:#f4f5fa}.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete,.combobox.sc-ir-autocomplete p[data-selected].sc-ir-autocomplete:hover{color:#fff;text-decoration:none;background-color:#666ee8}.loader.sc-ir-autocomplete{width:14px;height:14px;border:2px solid #0f0f0f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const ht=dt;const ft=class{constructor(i){t(this,i);this.comboboxValue=e(this,"comboboxValue",7);this.inputCleared=e(this,"inputCleared",7);this.toast=e(this,"toast",7);this.bookingService=new b;this.no_result_found="";this.duration=300;this.placeholder="";this.propertyId=undefined;this.isSplitBooking=false;this.type="text";this.name="";this.inputId=p();this.required=false;this.disabled=false;this.value=undefined;this.from_date="";this.to_date="";this.danger_border=undefined;this.inputValue="";this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputFocused=false}componentWillLoad(){this.bookingService.setToken(f.token);this.no_result_found=h.entries.Lcz_NoResultsFound}handleKeyDown(t){var e;const i=this.data.length;const s=this.getHeightOfPElement();if(i>0){switch(t.key){case"ArrowUp":t.preventDefault();this.selectedIndex=(this.selectedIndex-1+i)%i;this.adjustScrollPosition(s);break;case"ArrowDown":t.preventDefault();this.selectedIndex=(this.selectedIndex+1)%i;this.adjustScrollPosition(s);break;case"Enter":case" ":case"ArrowRight":t.preventDefault();this.selectItem(this.selectedIndex);break;case"Escape":(e=this.inputRef)===null||e===void 0?void 0:e.blur();this.isComboBoxVisible=false;break}}}getHeightOfPElement(){const t=this.el.querySelector(".combobox");if(t){const e=t.querySelector("p");return e?e.offsetHeight:0}return 0}adjustScrollPosition(t,e=250){const i=this.el.querySelector(".combobox");if(i){const s=2;const o=t+s;const a=o*this.selectedIndex;let n=a-e/2+t/2;n=Math.max(0,Math.min(n,i.scrollHeight-e));i.scrollTo({top:n,behavior:"auto"})}}selectItem(t){if(this.data[t]){this.isItemSelected=true;this.comboboxValue.emit({key:"select",data:this.data[t]});this.inputValue="";this.resetCombobox()}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}async fetchData(){try{this.isLoading=true;let t=[];if(!this.isSplitBooking){t=await this.bookingService.fetchExposedGuest(this.inputValue,this.propertyId)}else{if(this.inputValue.split(" ").length===1){t=await this.bookingService.fetchExposedBookings(this.inputValue,this.propertyId,this.from_date,this.to_date)}}this.data=t;if(!this.isComboBoxVisible){this.isComboBoxVisible=true}}catch(t){console.log("error",t)}finally{this.isLoading=false}}handleInputChange(t){this.inputValue=t.target.value;if(this.inputValue){this.debounceFetchData()}else{clearTimeout(this.debounceTimer);this.resetCombobox(false)}}handleDocumentClick(t){const e=t.target;if(!this.el.contains(e)){this.isComboBoxVisible=false}}handleBlur(){this.inputFocused=false;setTimeout((()=>{if(this.isDropdownItem(document.activeElement)){return}if(this.isSplitBooking){if(!this.isItemSelected){if(this.data.length>0){this.comboboxValue.emit({key:"blur",data:this.inputValue})}else{if(this.inputValue!==""){this.toast.emit({type:"error",description:"",title:`The Booking #${this.inputValue} is not Available`,position:"top-right"});this.inputCleared.emit()}}this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}else{if(!this.isItemSelected){this.comboboxValue.emit({key:"blur",data:this.inputValue});this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}}),200)}isDropdownItem(t){return t&&t.closest(".combobox")}disconnectedCallback(){var t,e,i,s;clearTimeout(this.debounceTimer);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("blur",this.handleBlur);(e=this.inputRef)===null||e===void 0?void 0:e.removeEventListener("click",this.selectItem);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("keydown",this.handleKeyDown);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(t,e){var i;if(t.key==="Enter"||t.key===" "||t.key==="ArrowRight"){this.selectItem(e);t.preventDefault()}else if(t.key==="Escape"){this.isComboBoxVisible=false;(i=this.inputRef)===null||i===void 0?void 0:i.blur();t.preventDefault()}else{return}}renderDropdown(){var t;if(this.inputValue!==""){return i("div",{class:`position-absolute border rounded combobox`},(t=this.data)===null||t===void 0?void 0:t.map(((t,e)=>i("p",{role:"button",onKeyDown:t=>this.handleItemKeyDown(t,e),"data-selected":this.selectedIndex===e,tabIndex:0,onClick:()=>this.selectItem(e)},this.isSplitBooking?i(o,null,`${t.booking_nbr} ${t.guest.first_name} ${t.guest.last_name}`):i("div",{class:"d-flex align-items-center flex-fill"},i("p",{class:"p-0 m-0"},`${t.email}`," ",i("span",{class:"p-0 m-0"},` - ${t.first_name} ${t.last_name}`)))))),this.isLoading&&i("div",{class:"loader-container d-flex align-items-center justify-content-center"},i("div",{class:"loader"})),this.data.length===0&&!this.isLoading&&i("span",{class:"text-center"},this.no_result_found))}}handleFocus(){this.isComboBoxVisible=true;this.inputFocused=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(t=true){var e;if(t){(e=this.inputRef)===null||e===void 0?void 0:e.blur()}this.data=[];this.selectedIndex=-1;this.isComboBoxVisible=false}render(){return i(s,{key:"70c198ee608e257d71eeef0392059376ec5cfd35"},i("div",{key:"89683b58407eb91dfa9c118d2569a0179af1c7c4",class:"d-flex align-items-center "},i("label",{key:"e720b9dc4852656d0339139fd688c4ec0a0d30b5","data-state":this.inputFocused?"focused":"blured",htmlFor:this.inputId,class:`form-control input-sm ${this.danger_border&&"border-danger"}`},i("svg",{key:"e3d61418132cb708b7347d68a8ec08cf66f95b82",xmlns:"http://www.w3.org/2000/svg",height:"12",width:"12",viewBox:"0 0 512 512"},i("path",{key:"8d0e991285c96e55d92e7d2de1907c749d258708",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("input",{key:"70b94b3bb7952a92f2ecff611d3081c197f7b4a1",required:this.required,disabled:this.disabled,id:this.inputId,onKeyDown:this.handleKeyDown.bind(this),class:`form-control input-sm flex-full ${this.danger_border&&"border-danger"}`,type:this.type,name:this.name,value:this.value||this.inputValue,placeholder:this.placeholder,onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),ref:t=>this.inputRef=t}),this.inputValue&&i("button",{type:"button",class:"position-absolute d-flex align-items-center justify-content-center ",onClick:this.clearInput.bind(this)},i("p",{class:"sr-only"},"clear input"),i("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),this.isComboBoxVisible&&this.renderDropdown())}get el(){return a(this)}};ft.style=ht;const pt=t=>D(t).format("MMM DD, YYYY");const bt=(t,e="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:e}).format(t);const ut=t=>D(t).format("DD/MM ddd");const mt=(t,e)=>D(`${t}:${e}`,"HH:mm").format("hh:mm A");const gt=".sc-ir-booking-details-h{overflow-x:hidden}.confirmed.sc-ir-booking-details{color:#fff;display:flex;align-items:center}.bg-ir-green.sc-ir-booking-details{background:#629a4c;height:28px;padding-top:0 !important;padding-bottom:0 !important}.h-28.sc-ir-booking-details{height:2rem}.mx-01.sc-ir-booking-details{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}.bg-ir-red.sc-ir-booking-details{background:#ff4961;height:28px;padding-top:0 !important;padding-bottom:0 !important}.bg-ir-orange.sc-ir-booking-details{background:#ff9149;height:28px;padding-top:0 !important;padding-bottom:0 !important}.date-margin.sc-ir-booking-details{margin-right:5px}.pickup-margin.sc-ir-booking-details{margin-bottom:7px !important}.header-date.sc-ir-booking-details{padding-left:5px !important}.pointer.sc-ir-booking-details{cursor:pointer}.sc-ir-booking-details:root{--sidebar-width:50rem}.sm-padding-right.sc-ir-booking-details{padding-right:0.2rem}.sm-padding-left.sc-ir-booking-details{padding-left:0.2rem}.sm-padding-top.sc-ir-booking-details{padding-top:0.2rem}.sm-padding-bottom.sc-ir-booking-details{padding-bottom:0.2rem}.info-notes.sc-ir-booking-details{list-style:none;padding-left:0}.light-blue-bg.sc-ir-booking-details{background-color:#acecff;padding:0rem 0.1rem}.iframeHeight.sc-ir-booking-details{height:17.5rem}";const yt=gt;const kt=class{constructor(i){t(this,i);this.toast=e(this,"toast",7);this.bookingChanged=e(this,"bookingChanged",7);this.closeSidebar=e(this,"closeSidebar",7);this.bookingService=new b;this.roomService=new k;this.language="";this.ticket="";this.bookingNumber="";this.baseurl="";this.propertyid=undefined;this.is_from_front_desk=false;this.hasPrint=false;this.hasReceipt=false;this.hasDelete=false;this.hasMenu=false;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.hasCloseButton=false;this.bookingItem=null;this.statusData=[];this.tempStatus=null;this.showPaymentDetails=undefined;this.bookingData=undefined;this.countryNodeList=undefined;this.calendarData={};this.guestData=null;this.defaultTexts=undefined;this.rerenderFlag=false;this.sidebarState=null;this.isUpdateClicked=false}componentDidLoad(){if(this.baseurl){v.defaults.baseURL=this.baseurl}if(this.ticket!==""){f.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}}async ticketChanged(){f.token=this.ticket;this.bookingService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}setRoomsData(t){var e,i;let s=new Array;if((i=(e=t.My_Result)===null||e===void 0?void 0:e.roomtypes)===null||i===void 0?void 0:i.length){s=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=s}async initializeApp(){try{const[t,e,i,s]=await Promise.all([this.roomService.fetchData(this.propertyid,this.language),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language),this.bookingService.getExposedBooking(this.bookingNumber,this.language)]);if(!h.entries){h.entries=e.entries;h.direction=e.direction}this.defaultTexts=e;this.countryNodeList=i;const{allowed_payment_methods:o,currency:a,allowed_booking_sources:n,adult_child_constraints:l,calendar_legends:r}=t["My_Result"];this.calendarData={currency:a,allowed_booking_sources:n,adult_child_constraints:l,legendData:r};this.setRoomsData(t);const c=["001","004"];this.showPaymentDetails=o.some((t=>c.includes(t.code)));this.guestData=s.guest;this.bookingData=s;this.rerenderFlag=!this.rerenderFlag}catch(t){console.error("Error initializing app:",t)}}handleIconClick(t){const e=t.target;switch(e.id){case"pickup":this.sidebarState="pickup";return;case"close":this.closeSidebar.emit(null);return;case"print":window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=B&TK=${this.ticket}`);return;case"receipt":window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=I&TK=${this.ticket}`);return;case"book-delete":return;case"menu":window.location.href="https://x.igloorooms.com/manage/acbookinglist.aspx";return;case"room-add":this.bookingItem={ID:"",NAME:this.bookingData.guest.last_name,EMAIL:this.bookingData.guest.email,PHONE:this.bookingData.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingData.from_date,ARRIVAL:this.bookingData.arrival,TO_DATE:this.bookingData.to_date,TITLE:`${h.entries.Lcz_AddingUnitToBooking}# ${this.bookingData.booking_nbr}`,defaultDateRange:{fromDate:new Date(this.bookingData.from_date),fromDateStr:"",toDate:new Date(this.bookingData.to_date),toDateStr:"",dateDifference:0,message:""},event_type:"ADD_ROOM",BOOKING_NUMBER:this.bookingData.booking_nbr,ADD_ROOM_TO_BOOKING:this.bookingData.booking_nbr,GUEST:this.bookingData.guest,message:this.bookingData.remark,SOURCE:this.bookingData.source,ROOMS:this.bookingData.rooms};return;case"add-payment":return}}handleEditSidebar(){this.sidebarState="guest"}handleSelectChange(t){t.stopPropagation();t.stopImmediatePropagation();const e=t.target;this.tempStatus=e.selectedValue}openEditSidebar(){const t=document.querySelector("ir-sidebar#editGuestInfo");t.open=true}async updateStatus(){if(this.tempStatus!==""&&this.tempStatus!==null){try{this.isUpdateClicked=true;await v.post(`/Change_Exposed_Booking_Status?Ticket=${this.ticket}`,{book_nbr:this.bookingNumber,status:this.tempStatus});this.toast.emit({type:"success",description:"",title:h.entries.Lcz_StatusUpdatedSuccessfully,position:"top-right"});await this.resetBookingData()}catch(t){console.log(t)}finally{this.isUpdateClicked=false}}else{this.toast.emit({type:"error",description:"",title:h.entries.Lcz_SelectStatus,position:"top-right"})}}handleEditInitiated(t){this.bookingItem=t.detail}handleCloseBookingWindow(){this.bookingItem=null}handleDeleteFinish(t){this.bookingData=Object.assign(Object.assign({},this.bookingData),{rooms:this.bookingData.rooms.filter((e=>e.identifier!==t.detail))})}async resetBookingData(){try{const t=await this.bookingService.getExposedBooking(this.bookingNumber,this.language);this.bookingData=Object.assign({},t);this.bookingChanged.emit(this.bookingData)}catch(t){console.log(t)}}async handleResetBookingData(t){t.stopPropagation();t.stopImmediatePropagation();await this.resetBookingData()}renderPhoneNumber(){const{mobile:t,country_id:e}=this.bookingData.guest;if(!t){return null}if(this.bookingData.is_direct){if(e){const i=this.countryNodeList.find((t=>t.id===e));if(!i){throw new Error("Invalid country id")}return i.phone_prefix+" "+t}}return t}render(){var t;if(!this.bookingData){return null}let e="";switch(this.bookingData.status.code){case"001":e="bg-ir-orange";break;case"002":e="bg-ir-green";break;case"003":e="bg-ir-red";break;case"004":e="bg-ir-red";break}return[i(o,null,!this.is_from_front_desk&&i(o,null,i("ir-toast",null),i("ir-interceptor",null))),i("div",{class:"fluid-container p-1"},i("div",{class:"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1"},i("div",{class:"m-0 p-0 mb-1 mb-lg-0 mt-md-0  d-flex justify-content-start align-items-center"},i("p",{class:"font-size-large m-0 p-0"},`${this.defaultTexts.entries.Lcz_Booking}#${this.bookingNumber}`),i("p",{class:"m-0 p-0 ml-1"},!this.bookingData.is_direct&&i("span",{class:"mr-1 m-0"},this.bookingData.channel_booking_nbr," "),i("span",{class:"date-margin"},pt(this.bookingData.booked_on.date)),mt(this.bookingData.booked_on.hour.toString(),+" "+this.bookingData.booked_on.minute.toString()))),i("div",{class:"d-flex justify-content-end align-items-center"},i("span",{class:`confirmed btn-sm m-0 mr-2 ${e}`},this.bookingData.status.description),this.bookingData.allowed_actions.length>0&&i(o,null,i("ir-select",{selectContainerStyle:"h-28",selectStyles:"d-flex align-items-center h-28",firstOption:h.entries.Lcz_Select,id:"update-status",size:"sm","label-available":"false",data:this.bookingData.allowed_actions.map((t=>({text:t.description,value:t.code}))),textSize:"sm",class:"sm-padding-right m-0"}),i("ir-button",{onClickHanlder:this.updateStatus.bind(this),btn_styles:"h-28",isLoading:this.isUpdateClicked,btn_disabled:this.isUpdateClicked,id:"update-status-btn",size:"sm",text:"Update"})),this.hasReceipt&&i("ir-icon",{id:"receipt",class:"mx-1"},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",stroke:"#104064",height:"24",width:"19",viewBox:"0 0 384 512"},i("path",{fill:"#104064",d:"M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM80 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm16 96H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm0 32v64H288V256H96zM240 416h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H240c-8.8 0-16-7.2-16-16s7.2-16 16-16z"}))),this.hasPrint&&i("ir-icon",{id:"print",icon:"ft-printer h1 color-ir-dark-blue-hover m-0 ml-1  pointer"},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 512 512"},i("path",{fill:"#104064",d:"M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zM432 248a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"}))),this.hasDelete&&i("ir-icon",{id:"book-delete",icon:"ft-trash-2 h1 danger m-0 ml-1 pointer"}),this.hasMenu&&i("ir-icon",{id:"menu",class:"m-0 ml-1 pointer"},i("svg",{slot:"icon",height:24,width:24,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},i("path",{fill:"#104064",d:"M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"}))),this.hasCloseButton&&i("ir-icon",{id:"close",class:"m-0 ml-2 pointer",onIconClickHandler:()=>this.closeSidebar.emit(null)},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:24,width:24},i("path",{fill:"#104064",class:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})))))),i("div",{class:"fluid-container p-1 text-left mx-0"},i("div",{class:"row m-0"},i("div",{class:"col-12 p-0 mx-0 pr-lg-1 col-lg-6"},i("div",{class:"card"},i("div",{class:"p-1"},this.bookingData.property.name||"",i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Source}:`,value:this.bookingData.origin.Label,imageSrc:this.bookingData.origin.Icon}),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_BookedBy}:`,value:`${this.bookingData.guest.first_name} ${this.bookingData.guest.last_name}`,iconShown:true}),this.bookingData.guest.mobile&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Phone}:`,value:this.renderPhoneNumber()}),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Email}:`,value:this.bookingData.guest.email}),this.bookingData.guest.alternative_email&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_AlternativeEmail}:`,value:this.bookingData.guest.alternative_email}),i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Address}:`,value:this.bookingData.guest.address}),this.bookingData.is_direct&&i("ir-label",{label:`${this.defaultTexts.entries.Lcz_ArrivalTime}:`,value:this.bookingData.arrival.description}),this.bookingData.is_direct?i("ir-label",{label:`${this.defaultTexts.entries.Lcz_Note}:`,value:this.bookingData.remark}):i("ota-label",{label:`${this.defaultTexts.entries.Lcz_Note}:`,remarks:this.bookingData.ota_notes,maxVisibleItems:this.bookingData.ota_notes.length}))),i("div",{class:"font-size-large d-flex justify-content-between align-items-center mb-1"},i("ir-date-view",{from_date:this.bookingData.from_date,to_date:this.bookingData.to_date}),this.hasRoomAdd&&this.bookingData.is_direct&&i("ir-icon",{id:"room-add"},i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512",slot:"icon"},i("path",{fill:"#6b6f82",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))),i("div",{class:"card p-0 mx-0"},this.bookingData.rooms.map(((t,e)=>{const s=t.rateplan.name;const o=t.roomtype.name;return[i("ir-room",{defaultTexts:this.defaultTexts,legendData:this.calendarData.legendData,roomsInfo:this.calendarData.roomsInfo,myRoomTypeFoodCat:o,mealCodeName:s,currency:this.bookingData.currency.code,hasRoomEdit:this.hasRoomEdit&&this.bookingData.status.code!=="003"&&this.bookingData.is_direct,hasRoomDelete:this.hasRoomDelete&&this.bookingData.status.code!=="003"&&this.bookingData.is_direct,hasCheckIn:this.hasCheckIn,hasCheckOut:this.hasCheckOut,bookingEvent:this.bookingData,bookingIndex:e,ticket:this.ticket,onDeleteFinished:this.handleDeleteFinish.bind(this)}),e!==this.bookingData.rooms.length-1&&i("hr",{class:"mr-2 ml-2 my-0 p-0"})]}))),f.pickup_service.is_enabled&&this.bookingData.is_direct&&i("div",{class:"mb-1"},i("div",{class:"d-flex w-100 mb-1 align-items-center justify-content-between"},i("p",{class:"font-size-large p-0 m-0 "},h.entries.Lcz_Pickup),i("ir-icon",{class:"pointer ",id:"pickup"},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"})))),this.bookingData.pickup_info&&i("div",{class:"card"},i("div",{class:"p-1"},i("div",{class:"d-flex align-items-center py-0 my-0 pickup-margin"},i("p",{class:"font-weight-bold mr-1 py-0 my-0"},h.entries.Lcz_Date,": ",i("span",{class:"font-weight-normal"},D(this.bookingData.pickup_info.date,"YYYY-MM-DD").format("MMM DD, YYYY"))),i("p",{class:"font-weight-bold flex-fill py-0 my-0"},h.entries.Lcz_Time,":",i("span",{class:"font-weight-normal"}," ",mt(this.bookingData.pickup_info.hour.toString(),+" "+this.bookingData.pickup_info.minute.toString()))),i("p",{class:"font-weight-bold py-0 my-0"},h.entries.Lcz_DueUponBooking,":"," ",i("span",{class:"font-weight-normal"},this.bookingData.pickup_info.currency.symbol,this.bookingData.pickup_info.total))),i("p",{class:"font-weight-bold py-0 my-0"},h.entries.Lcz_FlightDetails,":",i("span",{class:"font-weight-normal"}," ",`${this.bookingData.pickup_info.details}`)),i("p",{class:"py-0 my-0 pickup-margin"},`${this.bookingData.pickup_info.selected_option.vehicle.description}`),i("p",{class:"font-weight-bold py-0 my-0 pickup-margin"},h.entries.Lcz_NbrOfVehicles,":",i("span",{class:"font-weight-normal"}," ",`${this.bookingData.pickup_info.nbr_of_units}`)),i("p",{class:"small py-0 my-0 pickup-margin"},f.pickup_service.pickup_instruction.description,f.pickup_service.pickup_cancelation_prepayment.description))))),i("div",{class:"col-12 p-0 m-0 pl-lg-1 col-lg-6"},i("ir-payment-details",{defaultTexts:this.defaultTexts,bookingDetails:this.bookingData})))),i("ir-sidebar",{open:this.sidebarState!==null,side:"right",id:"editGuestInfo",onIrSidebarToggle:t=>{t.stopImmediatePropagation();t.stopPropagation();this.sidebarState=null},showCloseButton:false},this.sidebarState==="guest"&&i("ir-guest-info",{slot:"sidebar-body",booking_nbr:this.bookingNumber,defaultTexts:this.defaultTexts,email:(t=this.bookingData)===null||t===void 0?void 0:t.guest.email,language:this.language,onCloseSideBar:()=>this.sidebarState=null}),this.sidebarState==="pickup"&&i("ir-pickup",{slot:"sidebar-body",defaultPickupData:this.bookingData.pickup_info,bookingNumber:this.bookingData.booking_nbr,numberOfPersons:this.bookingData.occupancy.adult_nbr+this.bookingData.occupancy.children_nbr,onCloseModal:()=>this.sidebarState=null})),i(o,null,this.bookingItem&&i("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))]}get element(){return a(this)}static get watchers(){return{ticket:["ticketChanged"]}}};kt.style=yt;const vt={channels:[],settlement_methods:[],statuses:[],types:[],token:"",rowCount:10,bookings:[],userSelection:{from:D().add(-7,"days").format("YYYY-MM-DD"),to:D().format("YYYY-MM-DD"),channel:"",property_id:null,start_row:0,end_row:20,total_count:0,filter_type:null,name:"",book_nbr:"",booking_status:"",affiliate_id:0,is_mpo_managed:false,is_mpo_used:false,is_for_mobile:false,is_combined_view:false,is_to_export:false},download_url:null};const{state:xt,onChange:wt}=C(vt);function _t(){xt.userSelection=Object.assign(Object.assign({},xt.userSelection),{channel:"",booking_status:xt.statuses[0].code,filter_type:xt.types[0].id,book_nbr:"",name:"",from:D().add(-7,"days").format("YYYY-MM-DD"),to:D().format("YYYY-MM-DD"),start_row:0,end_row:xt.rowCount})}function Dt(t,e){xt.userSelection=Object.assign(Object.assign({},xt.userSelection),{[t]:e})}class Ct extends x{async getExposedBookingsCriteria(t){const e=this.getToken();if(!e){throw new Error("Invalid token")}const{data:i}=await v.post(`/Get_Exposed_Bookings_Criteria?Ticket=${e}`,{property_id:t});const s=i.My_Result;xt.channels=s.channels;xt.settlement_methods=s.settlement_methods;xt.statuses=s.statuses;xt.types=s.types;_t()}async getExposedBookings(t){const e=this.getToken();if(!e){throw new Error("Invalid token")}const{data:i}=await v.post(`/Get_Exposed_Bookings?Ticket=${e}`,t);const s=i.My_Result;const o=i.My_Params_Get_Exposed_Bookings;xt.bookings=[...s];xt.userSelection=Object.assign(Object.assign({},xt.userSelection),{total_count:o.total_count});xt.download_url=o.exported_data_url}async removeExposedBooking(t,e){const i=this.getToken();if(!i){throw new Error("Invalid token")}await v.post(`/Remove_Exposed_Booking?Ticket=${i}`,{booking_nbr:t,is_to_revover:e})}}const Ot=".sc-ir-booking-listing-h{display:block;height:100%}.card.sc-ir-booking-listing{overflow-x:auto}.secondary-p.sc-ir-booking-listing{font-size:12px !important}.h-screen.sc-ir-booking-listing{height:100%}.price-span.sc-ir-booking-listing{margin:0;margin-right:5px}.main-container.sc-ir-booking-listing{height:100%;overflow-y:auto}.bg-ir-red.sc-ir-booking-listing{background:#ff4961;height:28px;padding-top:0 !important;padding-bottom:0 !important}.due-btn.sc-ir-booking-listing{border:1px solid #ff4961;color:#ff4961;cursor:pointer;padding:1px 0.25rem !important;font-size:12px !important}.due-btn.sc-ir-booking-listing:hover{background:#ff4961;color:white}.booking_number.sc-ir-booking-listing{all:unset;cursor:pointer}.booking_number.sc-ir-booking-listing:hover{color:#1e9ff2}.in-out.sc-ir-booking-listing{width:150px !important}.buttons-container.sc-ir-booking-listing{gap:10px}td.sc-ir-booking-listing ul.sc-ir-booking-listing{width:max-content !important}td.sc-ir-booking-listing{width:max-content !important}.date-p.sc-ir-booking-listing{width:max-content !important;min-width:100%;text-align:center !important}";const It=Ot;const Mt=class{constructor(e){t(this,e);this.bookingListingService=new Ct;this.roomService=new k;this.statusColors={"001":"badge-warning","002":"badge-success","003":"badge-danger","004":"badge-danger"};this.language="";this.ticket="";this.baseurl="";this.propertyid=undefined;this.rowCount=10;this.isLoading=false;this.currentPage=1;this.totalPages=1;this.oldStartValue=0;this.editBookingItem=null;this.showCost=false}componentWillLoad(){Dt("end_row",this.rowCount);xt.rowCount=this.rowCount;if(this.baseurl){v.defaults.baseURL=this.baseurl}if(this.ticket!==""){this.bookingListingService.setToken(this.ticket);this.roomService.setToken(this.ticket);xt.token=this.ticket;this.initializeApp()}wt("userSelection",(async t=>{const e=t.total_count;this.totalPages=Math.ceil(e/this.rowCount)}));wt("bookings",(async t=>{this.showCost=t.some((t=>t.cost!==null&&t.cost>0))}))}async ticketChanged(t,e){if(t!==e){this.bookingListingService.setToken(this.ticket);this.roomService.setToken(this.ticket);xt.token=this.ticket;this.initializeApp()}}async initializeApp(){try{this.isLoading=true;Dt("property_id",this.propertyid);await Promise.all([this.bookingListingService.getExposedBookingsCriteria(this.propertyid),this.roomService.fetchLanguage(this.language,["_BOOKING_LIST_FRONT"])]);await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{is_to_export:false}))}catch(t){console.error(t)}finally{this.isLoading=false}}handleSideBarToggle(t){if(t.detail&&this.editBookingItem){this.editBookingItem=null}}getPaginationBounds(){const t=xt.userSelection.total_count;const e=(this.currentPage-1)*this.rowCount;let i=this.currentPage*this.rowCount;i=i>t?t:i;return{startItem:e,endItem:i,totalCount:t}}openModal(){this.listingModalTimeout=setTimeout((()=>{this.listingModal=this.el.querySelector("ir-listing-modal");this.listingModal.editBooking=this.editBookingItem;this.listingModal.openModal()}),100)}disconnectedCallback(){clearTimeout(this.listingModalTimeout)}async handleResetData(t){t.stopImmediatePropagation();t.stopPropagation();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{is_to_export:false}))}async handleResetStoreData(t){t.stopImmediatePropagation();t.stopPropagation();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{is_to_export:false}))}handleBookingChanged(t){t.stopImmediatePropagation();t.stopPropagation();xt.bookings=[...xt.bookings.map((e=>{if(e.booking_nbr===t.detail.booking_nbr){return t.detail}return e}))]}renderItemRange(){const{endItem:t,startItem:e,totalCount:i}=this.getPaginationBounds();return`${h.entries.Lcz_View} ${e+1} - ${t} ${h.entries.Lcz_Of} ${i}`}async updateData(){const{endItem:t,startItem:e}=this.getPaginationBounds();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{is_to_export:false,start_row:e,end_row:t}))}render(){var t,e,o,a,n,l,r,d,f,p,b,u,m;if(this.isLoading||this.ticket===""){return i("ir-loading-screen",null)}return i(s,null,i("ir-interceptor",null),i("ir-toast",null),i("div",{class:"p-1 main-container"},i("ir-listing-header",{propertyId:this.propertyid,language:this.language,baseurl:this.baseurl}),i("section",null,i("div",{class:"card p-1 flex-fill m-0 mt-2"},i("table",{class:"table table-striped table-bordered no-footer dataTable"},i("thead",null,i("tr",null,i("th",{scope:"col",class:"text-left"},(t=h.entries)===null||t===void 0?void 0:t.Lcz_Booking,"#"),i("th",{scope:"col"},(e=h.entries)===null||e===void 0?void 0:e.Lcz_BookedOn),i("th",{scope:"col"},(o=h.entries)===null||o===void 0?void 0:o.Lcz_GuestSource),i("th",{scope:"col"},i("span",{class:"price-span"},(a=h.entries)===null||a===void 0?void 0:a.Lcz_Price),i("ir-tooltip",{customSlot:true,message:`<span style="width:100%;display:block;">${(n=h.entries)===null||n===void 0?void 0:n.Lcz_BookingBalance}</span><span>${(l=h.entries)===null||l===void 0?void 0:l.Lcz_ClickToSettle}</span>`},i("span",{slot:"tooltip-trigger",class:"m-0 btn due-btn"},(r=h.entries)===null||r===void 0?void 0:r.Lcz_Balance))),this.showCost&&i("th",{scope:"col",class:"services-cell"},"Cost"),i("th",{scope:"col",class:"text-left services-cell"},(d=h.entries)===null||d===void 0?void 0:d.Lcz_Services),i("th",{scope:"col",class:"in-out"},(f=h.entries)===null||f===void 0?void 0:f.Lcz_InOut),i("th",{scope:"col"},(p=h.entries)===null||p===void 0?void 0:p.Lcz_Status),i("th",{scope:"col"},i("p",{class:"sr-only"},"actions")))),i("tbody",{class:""},xt.bookings.length===0&&i("tr",null,i("td",{colSpan:8},(b=h.entries)===null||b===void 0?void 0:b.Lcz_NoDataAvailable)),(u=xt.bookings)===null||u===void 0?void 0:u.map((t=>{var e,s,o;let a=this.statusColors[t.status.code];return i("tr",{key:t.booking_nbr},i("td",{class:"text-left"},i("button",{onClick:()=>this.editBookingItem={booking:t,cause:"edit"},class:"booking_number"},t.booking_nbr)),i("td",null,i("p",{class:"p-0 m-0 date-p"},D(t.booked_on.date,"YYYY-MM-DD").format("DD-MMM-YYYY")),i("p",{class:"p-0 m-0 secondary-p"},mt(t.booked_on.hour.toString(),+" "+t.booked_on.minute.toString()))),i("td",null,i("div",{class:"h-100 d-flex align-items-center "},i("img",{class:"mr-2",src:t.origin.Icon,alt:"logo"}),i("div",{class:"text-left"},i("p",{class:"p-0 m-0"},t.guest.first_name," ",(e=t.guest.last_name)!==null&&e!==void 0?e:""," ",t.occupancy.adult_nbr,h.entries.Lcz_P),i("p",{class:"p-0 m-0 secondary-p"},t.origin.Label)))),i("td",null,i("p",{class:"p-0 m-0"},c(t.currency.code,(o=(s=t.financial)===null||s===void 0?void 0:s.gross_total)!==null&&o!==void 0?o:0)),t.financial.due_amount>0&&i("buuton",{onClick:()=>{this.editBookingItem={booking:t,cause:"payment"};this.openModal()},class:"btn p-0 m-0 due-btn"},c(t.currency.code,t.financial.due_amount))),this.showCost&&i("td",null,t.cost!==null&&t.cost===0?"_":c(t.currency.code,t.cost)),i("td",null,i("ul",null,t.rooms.map((t=>i("li",null,t.roomtype.name))))),i("td",null,i("p",{class:"p-0 m-0 date-p"},D(t.from_date,"YYYY-MM-DD").format("DD-MMM-YYYY")),i("p",{class:"p-0 m-0 date-p"},D(t.to_date,"YYYY-MM-DD").format("DD-MMM-YYYY"))),i("td",null,i("p",{class:`m-0 badge ${a}`},t.status.description)),i("td",null,i("div",{class:"d-flex justify-content-center align-items-center"},i("ir-icon",{onIconClickHandler:()=>this.editBookingItem={booking:t,cause:"edit"}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},i("path",{fill:"#104064",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),i("ir-icon",{onIconClickHandler:()=>{this.editBookingItem={booking:t,cause:"delete"};this.openModal()},class:"ml-1"},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},i("path",{fill:"#ff4961",d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))))})))),this.totalPages>1&&i("section",{class:"d-flex flex-column flex-md-row align-items-center justify-content-between"},i("p",{class:"m-0 mb-1 mb-md-0"},this.renderItemRange()),i("div",{class:"d-flex align-items-center buttons-container"},i("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHanlder:async()=>{this.currentPage=1;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{fill:"white",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"}))),i("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHanlder:async()=>{this.currentPage=this.currentPage-1;console.log(this.currentPage);await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"8.75",viewBox:"0 0 320 512"},i("path",{fill:"white",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"}))),i("ir-select",{selectedValue:this.currentPage.toString(),LabelAvailable:false,showFirstOption:false,onSelectChange:async t=>{this.currentPage=+t.detail;await this.updateData()},data:Array.from(Array(this.totalPages),((t,e)=>e+1)).map((t=>({text:t.toString(),value:t.toString()})))}),i("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHanlder:async()=>{this.currentPage=this.currentPage+1;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"8.75",viewBox:"0 0 320 512"},i("path",{fill:"white",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"}))),i("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHanlder:async()=>{this.currentPage=this.totalPages;console.log(this.currentPage);await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{fill:"white",d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"})))))))),this.editBookingItem&&i("ir-listing-modal",{onModalClosed:()=>this.editBookingItem=null}),i("ir-sidebar",{onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:this.editBookingItem!==null&&this.editBookingItem.cause==="edit",showCloseButton:this.editBookingItem!==null,sidebarStyles:{width:this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:"#F2F3F8"}},((m=this.editBookingItem)===null||m===void 0?void 0:m.cause)==="edit"&&i("ir-booking-details",{slot:"sidebar-body",hasPrint:true,hasReceipt:true,is_from_front_desk:true,propertyid:this.propertyid,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.editBookingItem.booking.booking_nbr,ticket:this.ticket,baseurl:this.baseurl,language:this.language,hasRoomAdd:true})))}get el(){return a(this)}static get watchers(){return{ticket:["ticketChanged"]}}};Mt.style=It;const Bt=".button-icon.sc-ir-button{padding:0;margin-top:0}.button-icon[data-state='loading'].sc-ir-button{display:none}.button-text.sc-ir-button{padding:0 5px}.bounce-3.sc-ir-button{animation:bounce 1s 1}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loader.sc-ir-button{width:15px;height:10px;--c:no-repeat linear-gradient(#ffffff 0 0);background:var(--c) 0% 50%, var(--c) 50% 50%, var(--c) 100% 50%;background-size:20% 100%;animation:l1 1s infinite linear}@keyframes l1{0%{background-size:20% 100%, 20% 100%, 20% 100%}33%{background-size:20% 10%, 20% 100%, 20% 100%}50%{background-size:20% 100%, 20% 10%, 20% 100%}66%{background-size:20% 100%, 20% 100%, 20% 10%}100%{background-size:20% 100%, 20% 100%, 20% 100%}}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}@keyframes ping{75%,100%{transform:scale(1.2)}}";const Tt=Bt;const St=class{constructor(i){t(this,i);this.clickHanlder=e(this,"clickHanlder",7);this.name=undefined;this.text=undefined;this.icon="ft-save";this.btn_color="primary";this.size="md";this.textSize="md";this.btn_block=true;this.btn_disabled=false;this.btn_type="button";this.isLoading=false;this.btn_styles=undefined;this.btn_id=p()}handleButtonAnimation(t){if(!this.buttonEl||t.detail!==this.btn_id){return}t.stopImmediatePropagation();t.stopPropagation();this.buttonEl.classList.remove("bounce-3");this.buttonEl.classList.add("bounce-3")}render(){let t=this.btn_block?"btn-block":"";return i("button",{key:"c6ef3fc5a18150bc4a99da7d92a0d7b7ab6487db",id:this.btn_id,ref:t=>this.buttonEl=t,onClick:()=>this.clickHanlder.emit(),class:`btn btn-${this.btn_color} ${this.btn_styles} d-flex align-items-center btn-${this.size} text-${this.textSize} ${t}`,type:this.btn_type,disabled:this.btn_disabled},i("span",{key:"111d46d6384dfc37293c3f5b4d1b8f0f73728073",class:"button-icon","data-state":this.isLoading?"loading":""},i("slot",{key:"279a656c5fb83bef6e10a1bba34860c749153d9d",name:"icon"})),this.text&&i("span",{class:"button-text m-0"},this.text),this.isLoading&&i("div",{class:"loader m-0 p-0"}))}};St.style=Tt;const Yt=[{isCSS:true,link:"https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/bootstrap-extended.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/colors.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/menu/menu-types/horizontal-menu.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/core/colors/palette-gradient.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/components.css"},{isCSS:true,link:"https://x.igloorooms.com/assets/css/style.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/icheck.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/vendors/css/forms/icheck/custom.css"},{isCSS:true,link:"https://x.igloorooms.com/app-assets/css/pages/login-register.css"}];const Lt=class{constructor(e){t(this,e);this.extraResources="";this.resources=Yt}componentWillLoad(){this.parseRefs()}componentDidLoad(){this.initializeStyles()}hrefsChanged(){this.parseRefs();this.initializeStyles()}parseRefs(){if(this.extraResources!=="")this.resources.push(JSON.parse(this.extraResources))}appendTag(t,e){const i=document.createElement(t);const s=[];Object.keys(e).forEach((t=>{i.setAttribute(t,e[t]);s.push(`[${t}="${e[t]}"]`)}));const o=`${t}${s.join("")}`;const a=document.querySelector(o);if(!a){document.head.appendChild(i)}}initializeStyles(){this.resources.forEach((t=>{if(t.isCSS){this.appendTag("link",{href:t.link,rel:"stylesheet",type:"text/css"})}if(t.isJS){this.appendTag("script",{src:t.link})}}))}render(){return i(s,{key:"e0d0c7672955ce2f7caa3940058d43b0a3a4ef7a"},i("slot",{key:"469221bcfafd2492471d1ebbc5b8e40aa681a5ce"}))}static get watchers(){return{extraResources:["hrefsChanged"]}}};const zt="input.sc-ir-date-picker{all:unset;box-sizing:border-box !important;padding:0;margin:0;width:100%;text-align:center}input.sc-ir-date-picker:disabled{text-align:start;font-size:14px;width:100%}.sc-ir-date-picker-h{position:relative;box-sizing:border-box}.icon.sc-ir-date-picker{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}";const Et=zt;const jt=class{constructor(i){t(this,i);this.dateChanged=e(this,"dateChanged",7);this.fromDate=undefined;this.toDate=undefined;this.opens=undefined;this.autoApply=undefined;this.firstDay=1;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.daysOfWeek=["Su","Mo","Tu","We","Th","Fr","Sa"];this.format="MMM DD, YYYY";this.separator=" - ";this.applyLabel="Apply";this.cancelLabel="Cancel";this.fromLabel="Form";this.toLabel="To";this.customRangeLabel="Custom";this.weekLabel="W";this.disabled=false;this.singleDatePicker=false;this.minDate=undefined;this.maxDate=undefined;this.maxSpan={days:240}}componentDidLoad(){this.dateRangeInput=this.element.querySelector(".date-range-input");$(this.dateRangeInput).daterangepicker({singleDatePicker:this.singleDatePicker,opens:this.opens,startDate:D(this.fromDate),endDate:D(this.toDate),minDate:D(this.minDate||D(new Date).format("YYYY-MM-DD")),maxDate:this.maxDate?D(this.maxDate):undefined,maxSpan:this.maxSpan,autoApply:this.autoApply,locale:{format:this.format,separator:this.separator,applyLabel:this.applyLabel,cancelLabel:this.cancelLabel,fromLabel:this.fromLabel,toLabel:this.toLabel,customRangeLabel:this.customRangeLabel,weekLabel:this.weekLabel,daysOfWeek:this.daysOfWeek,monthNames:this.monthNames,firstDay:this.firstDay}},((t,e)=>{this.dateChanged.emit({start:t,end:e})}))}render(){return i(s,{key:"606a4868dd410be7615653390ebf2f426b066479"},i("input",{key:"e3ed1676d54e157e8e6fde76ac9e209ce2cc3b7f",class:"date-range-input",type:"text",disabled:this.disabled}))}get element(){return a(this)}};jt.style=Et;const Rt=".sc-ir-date-view-h{display:block;font-size:13.65px !important}.mx-01.sc-ir-date-view{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const Nt=Rt;const Ht=class{constructor(e){t(this,e);this.from_date=undefined;this.to_date=undefined;this.showDateDifference=true;this.dateOption="YYYY-MM-DD";this.dates=undefined}componentWillLoad(){this.initializeDates()}handleFromDateChange(t,e){if(t!==e){this.initializeDates()}}handleToDateChange(t,e){if(t!==e){this.initializeDates()}}initializeDates(){this.convertDate("from_date",this.from_date);this.convertDate("to_date",this.to_date);const t=D(this.dates.from_date,"MMM DD, YYYY").format("YYYY-MM-DD");const e=D(this.dates.to_date,"MMM DD, YYYY").format("YYYY-MM-DD");this.dates.date_diffrence=m(t,e)}convertDate(t,e){this.dates=this.dates||{from_date:"",to_date:"",date_diffrence:0};if(typeof e==="string"){this.dates[t]=D(e,this.dateOption).format("MMM DD, YYYY")}else if(e instanceof Date){this.dates[t]=D(e).format("MMM DD, YYYY")}else if(D.isMoment(e)){this.dates[t]=e.format("MMM DD, YYYY")}else{console.error("Unsupported date type")}}render(){return i(s,{key:"73da39a88b8f59d70936a3535ee4589c37951c41",class:"d-flex align-items-center"},i("span",{key:"ddca3b951ab087d0c89600ea4f39134b97c7f3a2"},this.dates.from_date)," ",i("svg",{key:"dbf6c9c2d876f8103a2ced0c8ef5485091ab247e",xmlns:"http://www.w3.org/2000/svg",class:"mx-01",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{key:"36f041d460d196812cb436185f7f2f95ff1648ae",fill:"currentColor",d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"})),i("span",{key:"f18f24c2315938dab740cef733fdf6f832f56117"},this.dates.to_date," ",this.showDateDifference&&i("span",{class:"mx-01"},this.dates.date_diffrence,"   ",this.dates.date_diffrence>1?` ${h.entries.Lcz_Nights}`:` ${h.entries.Lcz_Night}`)))}static get watchers(){return{from_date:["handleFromDateChange"],to_date:["handleToDateChange"]}}};Ht.style=Nt;const $t=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}";const At=$t;const Pt=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.resetBookingData=e(this,"resetBookingData",7);this.bookingService=new b;this.setupDataCountries=null;this.setupDataCountriesCode=null;this.defaultTexts=undefined;this.language=undefined;this.email=undefined;this.booking_nbr=undefined;this.countries=undefined;this.submit=false;this.guest=null;this.isLoading=false}async componentWillLoad(){this.bookingService.setToken(f.token);await this.init()}async init(){try{const[t,e]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language)]);this.countries=e;this.guest=t}catch(t){console.log(t)}}handleInputChange(t,e){this.guest=Object.assign(Object.assign({},this.guest),{[t]:e})}async editGuest(){try{this.isLoading=true;await this.bookingService.editExposedGuest(this.guest,this.booking_nbr);this.closeSideBar.emit(null);this.resetBookingData.emit(null)}catch(t){console.log(t)}finally{this.isLoading=false;console.log("done")}}render(){var t,e,s,o,a,n;if(!this.guest){return null}return[i("div",{class:"p-0"},i("div",{class:"position-sticky mb-1 shadow-none p-0"},i("div",{class:"d-flex align-items-center justify-content-between ir-card-header py-1 p-0"},i("h3",{class:"card-title text-left font-medium-2 px-1 my-0"},this.defaultTexts.entries.Lcz_GuestDetails),i("ir-icon",{class:"close close-icon px-1",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),i("div",{class:"card-content collapse show"},i("div",{class:"card-body pt-0 px-1"},i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_FirstName,name:"firstName",submited:this.submit,value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:t=>this.handleInputChange("first_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_LastName,name:"lastName",submited:this.submit,value:(e=this.guest)===null||e===void 0?void 0:e.last_name,required:true,onTextChange:t=>this.handleInputChange("last_name",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Email,name:"email",submited:this.submit,value:(s=this.guest)===null||s===void 0?void 0:s.email,required:true,onTextChange:t=>this.handleInputChange("email",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_AlternativeEmail,name:"altEmail",value:(o=this.guest)===null||o===void 0?void 0:o.alternative_email,onTextChange:t=>this.handleInputChange("alternative_email",t.detail)}),i("ir-select",{selectContainerStyle:"mb-1",required:true,name:"country",submited:this.submit,label:this.defaultTexts.entries.Lcz_Country,selectedValue:(n=(a=this.guest.country_id)===null||a===void 0?void 0:a.toString())!==null&&n!==void 0?n:"",data:this.countries.map((t=>({value:t.id.toString(),text:t.name}))),firstOption:"...",onSelectChange:t=>this.handleInputChange("country_id",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_City,name:"city",value:this.guest.city,onTextChange:t=>this.handleInputChange("city",t.detail)}),i("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Address,name:"address",value:this.guest.address,onTextChange:t=>this.handleInputChange("address",t.detail)}),i("div",{class:"form-group mr-0"},i("div",{class:"input-group row m-0 p-0"},i("div",{class:`input-group-prepend col-3 p-0 text-dark border-none`},i("label",{class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.defaultTexts.entries.Lcz_MobilePhone,"*")),i("select",{class:` form-control text-md  col-2 py-0 mobilePrefixSelect`,onInput:t=>this.handleInputChange("country_id",t.target.value),required:true},i("option",{value:null},"..."),this.countries.map((t=>{var e;return i("option",{selected:((e=this.guest.country_id)===null||e===void 0?void 0:e.toString())===t.id.toString(),value:t.id},t.phone_prefix)}))),i("input",{type:"text",required:true,value:this.guest.mobile,class:"form-control flex-fill mobilePrefixInput",onInput:t=>this.handleInputChange("mobile",t.target.value)}))),i("div",{class:"p-0 m-0"},i("label",{class:`check-container m-0 p-0`},i("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange("subscribe_to_news_letter",t.target.checked)}),i("span",{class:"checkmark m-0 p-0"}),i("span",{class:"m-0 p-0  check-label"},this.defaultTexts.entries.Lcz_Newsletter))),i("hr",null),i("ir-button",{isLoading:this.isLoading,btn_disabled:this.isLoading,btn_styles:"d-flex align-items-center justify-content-center",text:this.defaultTexts.entries.Lcz_Save,onClickHanlder:this.editGuest.bind(this),color:"btn-primary"}))))]}};Pt.style=At;const Vt=".sc-ir-icon-h{margin:0;padding:0}.icon-button.sc-ir-icon{all:unset;margin:0;padding:0;color:#104064}.icon-button.sc-ir-icon:hover{cursor:pointer;color:#1a6aa7}";const Gt=Vt;const Kt=class{constructor(i){t(this,i);this.iconClickHandler=e(this,"iconClickHandler",7);this.icon="ft-check"}render(){return i("button",{key:"1c4753e7324a605a6cc5aee936e1b594ff08fee1",class:"icon-button",onClick:()=>this.iconClickHandler.emit()},i("slot",{key:"f96dc916be570d007d2501716efa69ecd8a4a621",name:"icon"}))}};Kt.style=Gt;const Ut=".sc-ir-input-text-h{margin:0;padding:0}.border-theme.sc-ir-input-text{border:1px solid #cacfe7}.icon-container.sc-ir-input-text{color:#3b4781;border:1px solid #cacfe7;font-size:0.975rem;height:2rem;background:rgb(255, 255, 255);padding-right:0 !important;border-right:0;border-top-right-radius:0;border-bottom-right-radius:0;transition:border-color 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out}input.sc-ir-input-text:focus{border-color:#1e9ff2 !important}.input-container.sc-ir-input-text{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}.input-container.sc-ir-input-text input.sc-ir-input-text{padding-left:5px !important;padding-right:5px !important;border-left:0;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.icon-container[data-state='focus'].sc-ir-input-text{border-color:var(--blue)}.icon-container[data-disabled].sc-ir-input-text{background-color:#eceff1;border-color:rgba(118, 118, 118, 0.3)}.danger-border.sc-ir-input-text{border-color:var(--red)}";const Ft=Ut;const Wt=class{constructor(i){t(this,i);this.textChange=e(this,"textChange",7);this.inputBlur=e(this,"inputBlur",7);this.name=undefined;this.value=undefined;this.label="<label>";this.placeholder="<placeholder>";this.inputStyles="";this.required=undefined;this.LabelAvailable=true;this.readonly=false;this.type="text";this.submited=false;this.inputStyle=true;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.variant="default";this.disabled=false;this.error=false;this.valid=undefined;this.initial=true;this.inputFocused=false}connectedCallback(){}disconnectedCallback(){}watchHandler(t){if(t!==""&&this.required){this.valid=true}}watchHandler2(t){if(t&&this.required){this.initial=false}}handleInputChange(t){this.initial=false;if(this.required){this.valid=t.target.checkValidity();const e=t.target.value;this.textChange.emit(e)}else{this.textChange.emit(t.target.value)}}render(){const t=p();if(this.variant==="icon"){return i("fieldset",{class:"position-relative has-icon-left input-container"},i("label",{htmlFor:t,class:"input-group-prepend bg-white m-0"},i("span",{"data-disabled":this.disabled,"data-state":this.inputFocused?"focus":"",class:`input-group-text icon-container bg-white ${this.error&&"danger-border"}`,id:"basic-addon1"},i("slot",{name:"icon"}))),i("input",{type:"text",onFocus:()=>this.inputFocused=true,required:this.required,onBlur:t=>{this.inputFocused=false;this.inputBlur.emit(t)},disabled:this.disabled,class:`form-control bg-white pl-0 input-sm rate-input py-0 m-0 rateInputBorder ${this.error&&"danger-border"}`,id:t,value:this.value,placeholder:this.placeholder,onInput:this.handleInputChange.bind(this)}))}let e="form-control";let s=i("div",{class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},i("label",{class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(!this.LabelAvailable){s=""}if(this.inputStyle===false){e=""}if(this.required&&!this.valid&&!this.initial){e=`${e} border-danger`}return i("div",{class:"form-group"},i("div",{class:"input-group row m-0"},s,i("input",{readOnly:this.readonly,type:this.type,class:`${e} ${this.error?"border-danger":""} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12} ${this.readonly&&"bg-white"} ${this.inputStyles}`,onBlur:t=>this.inputBlur.emit(t),placeholder:this.placeholder,value:this.value,onInput:this.handleInputChange.bind(this),required:this.required,disabled:this.disabled})))}static get watchers(){return{value:["watchHandler"],submited:["watchHandler2"]}}};Wt.style=Ft;const qt=".loader.sc-ir-interceptor{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-interceptor{padding:20px;display:flex;align-items:center;justify-content:center;border-radius:5px;background:white}.loadingScreenContainer.sc-ir-interceptor{position:fixed;top:0;left:0;height:100vh;width:100vw;z-index:100000;background:rgba(0, 0, 0, 0.2);pointer-events:all;display:flex;align-items:center;justify-content:center}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const Jt=qt;const Xt=class{constructor(i){t(this,i);this.toast=e(this,"toast",7);this.isShown=false;this.isLoading=false;this.isUnassignedUnit=false;this.handledEndpoints=["/ReAllocate_Exposed_Room","/Do_Payment","/Get_Exposed_Bookings"]}componentWillLoad(){this.setupAxiosInterceptors()}setupAxiosInterceptors(){v.interceptors.request.use(this.handleRequest.bind(this),this.handleError.bind(this));v.interceptors.response.use(this.handleResponse.bind(this),this.handleError.bind(this))}extractEndpoint(t){return t.split("?")[0]}isHandledEndpoint(t){return this.handledEndpoints.includes(t)}handleRequest(t){const e=this.extractEndpoint(t.url);_[e]="pending";if(this.isHandledEndpoint(e)){this.isLoading=true}return t}handleResponse(t){var e;const i=this.extractEndpoint(t.config.url);if(this.isHandledEndpoint(i)){this.isLoading=false}_[i]="done";if((e=t.data.ExceptionMsg)===null||e===void 0?void 0:e.trim()){this.handleError(t.data.ExceptionMsg);throw new Error(t.data.ExceptionMsg)}return t}handleError(t){this.toast.emit({type:"error",title:t,description:"",position:"top-right"});return Promise.reject(t)}render(){return i(s,{key:"1cb856d75f2d15be0237947c07ced19b3ed845ad"},this.isLoading&&i("div",{class:"loadingScreenContainer"},i("div",{class:"loaderContainer"},i("span",{class:"loader"}))))}};Xt.style=Jt;const Zt="*.sc-ir-label{margin:0;padding:0}.sc-ir-label-h{display:flex;margin-bottom:5px;gap:5px}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}p.sc-ir-label{margin:0 3px;padding:0}.icon-container.sc-ir-label{margin:0;padding:0}svg.sc-ir-label{margin:0;padding:0}";const Qt=Zt;const te=class{constructor(i){t(this,i);this.editSidebar=e(this,"editSidebar",7);this.label=undefined;this.value=undefined;this.iconShown=false;this.imageSrc=undefined}openEditSidebar(){this.editSidebar.emit()}render(){if(!this.value){return null}return i(s,{class:this.imageSrc?"align-items-center":""},i("strong",null,this.label),this.imageSrc&&i("img",{src:this.imageSrc,class:"p-0 m-0"}),i("p",null,this.value),this.iconShown&&i("div",{class:"icon-container"},i("ir-icon",{class:"pointer icon",id:"pickup",onIconClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openEditSidebar()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"15",width:"15",viewBox:"0 0 512 550"},i("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"})))))}};te.style=Qt;const ee=".sc-ir-listing-header-h{display:block;margin:0;padding:0;--ir-date-range-border:#cacfe7;--ir-date-range-width:242px;position:relative}h3.sc-ir-listing-header{margin:0}ir-input-text.sc-ir-listing-header{width:300px}.booking-search-field.sc-ir-listing-header{margin-left:0px;display:flex;align-items:center;gap:14px}.booking-container.sc-ir-listing-header{gap:14px}.filters-container.sc-ir-listing-header{gap:10px;justify-content:space-between}.buttons-container.sc-ir-listing-header{gap:14px;color:#104064}.new-booking-container.sc-ir-listing-header{position:absolute;right:10px;top:5px}.new-booking-btn.sc-ir-listing-header{all:unset;cursor:pointer;color:#104064}.new-booking-btn.sc-ir-listing-header:hover{color:#0b2538}.seperator-container.sc-ir-listing-header{margin-top:10px;justify-content:center !important;gap:14px}.seperator-container.sc-ir-listing-header span.sc-ir-listing-header{display:block;height:1px;background:var(--gray);width:45%;max-width:200px;margin:0}@media (max-width: 575.98px){.sc-ir-listing-header-h{--ir-date-range-width:100%}.flex-fill-sm-none.sc-ir-listing-header{flex:1 1 auto}.flex-fill-sm-none.sc-ir-listing-header label.sc-ir-listing-header{width:100px}.buttons-container.sc-ir-listing-header{justify-content:center !important;align-items:center !important;gap:40px}}@media (min-width: 1200px){.booking-search-field.sc-ir-listing-header{margin-left:40px}}@media (min-width: 1600px){.flex-fill-sm-none.sc-ir-listing-header{flex:0 0 auto}.booking-search-field.sc-ir-listing-header{margin-left:40px}}";const ie=ee;const se=class{constructor(e){t(this,e);this.bookingListingService=new Ct;this.propertyId=undefined;this.language=undefined;this.baseurl=undefined;this.inputValue=""}componentWillLoad(){this.bookingListingService.setToken(xt.token)}handleDateRangeChange(t){t.stopImmediatePropagation();t.stopPropagation();const{start:e,end:i}=t.detail;xt.userSelection=Object.assign(Object.assign({},xt.userSelection),{from:e.format("YYYY-MM-DD"),to:i.format("YYYY-MM-DD")})}async handleSearchClicked(t){if(this.inputValue!==""){if(/^-?\d+$/.test(this.inputValue.trim())){Dt("book_nbr",this.inputValue.trim())}else if(this.inputValue[3]==="-"){Dt("book_nbr",this.inputValue.trim())}else{Dt("name",this.inputValue.trim())}}if(this.inputValue===""&&(xt.userSelection.book_nbr!==""||xt.userSelection.name!=="")){xt.userSelection=Object.assign(Object.assign({},xt.userSelection),{name:"",book_nbr:""})}await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{start_row:0,end_row:20,is_to_export:t}));if(xt.download_url){const t=xt.download_url;this.downloadUrlTag.href=t;this.downloadUrlTag.download=t;this.downloadUrlTag.click();xt.download_url=null}}async handleClearUserField(){_t();if(this.inputValue){this.inputValue=""}await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},xt.userSelection),{start_row:0,end_row:20,is_to_export:false}))}render(){var t,e,o,a,n,l,r,c,d,f;return i(s,{key:"6694d5e3c8426db74e76ad459ac531c58b43eb1b"},i("a",{key:"ab31ab78b213f79829ce96d72a9606dd4bf770c5",ref:t=>this.downloadUrlTag=t},i("p",{key:"bcb97016b71aa5d27f1d4e3619506c6ae4aaafa6",class:"sr-only"},"download url")),i("section",{key:"1a405ab409d9c61c1469cda6e9e5e63700e48f58",class:"d-flex align-items-center "},i("div",{key:"84e491089823ed1f787a08bed441aa51bf5da134",class:"d-flex flex-fill flex-column flex-md-row align-items-md-center booking-container"},i("div",{key:"2461226c82b48c2b80a3b37c1b18c576192e4be6",class:"d-flex mb-1 d-md-none align-items-center justify-content-bettween width-fill"},i("h3",{key:"602edc85d0cac182c6eaea897a6fa0bd9a60af25",class:"flex-fill"},(t=h.entries)===null||t===void 0?void 0:t.Lcz_Bookings),i("div",{key:"35f823c49b498e3863060760241560a9a1e3d1b2"},xt.token&&i("igl-book-property-container",{withIrToastAndInterceptor:false,propertyid:this.propertyId,language:this.language,title:h.entries.Lcz_CreateNewBooking,baseurl:this.baseurl,ticket:xt.token},i("button",{slot:"trigger",class:"new-booking-btn"},i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},i("path",{fill:"currentColor",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),i("h3",{key:"89e31e7d8aa1b7bb27c089bc200ea5494b679cb4",class:"d-none d-md-block"},(e=h.entries)===null||e===void 0?void 0:e.Lcz_Bookings),i("form",{key:"ab3986dbcdeb128b4a377cf02f119076e4070a0c",onSubmit:t=>{t.preventDefault();console.log(this.inputValue);this.handleSearchClicked(false)},class:"booking-search-field width-fill"},i("ir-input-text",{key:"ffd4d8d47f4886400a066b9a306519fe28d5010f",class:"flex-fill",value:this.inputValue,onTextChange:t=>this.inputValue=t.detail,variant:"icon",placeholder:(o=h.entries)===null||o===void 0?void 0:o.Lcz_FindBookNbrorName},i("svg",{key:"e2f2c400308939fb5a57a8f4aced79665edf729e",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{key:"97ca1b977c0219d7804e818874bc27ea35d92a7d",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("h5",{key:"3058ef82bcf70693dd8ef668349182027834e41e",class:"m-0 font-weight-bold d-none d-sm-block"},(a=h.entries)===null||a===void 0?void 0:a.Lcz_Or))),i("div",{key:"83724e32ed4b29cc2cfb9171788b97d9636cff40",class:"d-none d-md-block"},xt.token&&i("igl-book-property-container",{withIrToastAndInterceptor:false,propertyid:this.propertyId,language:this.language,title:h.entries.Lcz_CreateNewBooking,baseurl:this.baseurl,ticket:xt.token},i("button",{slot:"trigger",class:"new-booking-btn"},i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},i("path",{fill:"currentColor",d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),i("section",{key:"7253adaa200ac31f1a91d6aa56b886e68d0115cd",class:"d-flex align-items-center justify-evenly seperator-container d-sm-none"},i("span",{key:"3c9369d6181001f6eca9e59125df6dc054d3add7"}),i("h5",{key:"9319e6ce3166c7d975da689f53a22e7f373bf8b3",class:"m-0 font-weight-bold"},(n=h.entries)===null||n===void 0?void 0:n.Lcz_Or),i("span",{key:"40746c1f1d5b0488353e4010431d1758b39ad6b4"})),i("section",{key:"0303335b78f4abe3905732735a71a268ef268d43",class:"d-flex flex-column align-items-sm-center flex-sm-row flex-sm-wrap filters-container justify-content-lg-start mt-1"},i("ir-select",{key:"413dbcaab5ac318ff789b964c75048658e6d28c1",onSelectChange:t=>Dt("filter_type",t.detail),showFirstOption:false,data:xt===null||xt===void 0?void 0:xt.types.map((t=>({value:t.id.toString(),text:t.name}))),class:"flex-sm-wrap",selectedValue:xt.userSelection.filter_type,select_id:"dateTo",LabelAvailable:false}),i("igl-date-range",{key:"9979f1af47897d45b97a0c0e1150d16a83c472d1",class:"flex-sm-wrap",minDate:"2000-01-01",withDateDifference:false,defaultData:{fromDate:xt.userSelection.from,toDate:xt.userSelection.to}}),i("ir-select",{key:"e7be4ac88d6208d393dd4229363c108a0fe711f8",class:"flex-sm-wrap",selectedValue:xt.userSelection.booking_status,onSelectChange:t=>Dt("booking_status",t.detail),showFirstOption:false,data:xt===null||xt===void 0?void 0:xt.statuses.map((t=>({value:t.code,text:t.name}))),select_id:"booking_status",LabelAvailable:false}),i("ir-select",{key:"86bbe9d66e4b7b1df6ccc413932234793816e6b7",class:"flex-sm-wrap",selectedValue:xt.userSelection.channel,onSelectChange:t=>Dt("channel",t.detail),LabelAvailable:false,data:xt===null||xt===void 0?void 0:xt.channels.map((t=>({value:t.name,text:t.name}))),select_id:"channels",firstOption:((l=h.entries)===null||l===void 0?void 0:l.Lcz_All)+" "+((r=h.entries)===null||r===void 0?void 0:r.Lcz_Channels)}),i("div",{key:"89a6a15b634c0509d3601ea12973b6a6db4e69a3",class:"d-flex flex-fill align-items-end m-0  buttons-container"},i("ir-icon",{key:"940b481b904e6bcfb364de94634bed1bd149a4ad",title:(c=h.entries)===null||c===void 0?void 0:c.Lcz_Search,onIconClickHandler:()=>this.handleSearchClicked(false)},i("svg",{key:"9a54e89d6ed4a31f3161ba33a17eba07cb30cfee",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},i("path",{key:"4ecb313df06c031eaa6c2214724d0dd6705a1bcb",fill:"currentColor",d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}))),i("ir-icon",{key:"b00349d8da47407e9c01d948337acae4f9733d67",title:(d=h.entries)===null||d===void 0?void 0:d.Lcz_Erase,onIconClickHandler:()=>this.handleClearUserField()},i("svg",{key:"9476e7cedec0cb5a23e78ed3ac0fa30fd2bef4a8",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},i("path",{key:"02473b4c2104a327858a1f2793f719851bbf5f24",fill:"currentColor",d:"M290.7 57.4L57.4 290.7c-25 25-25 65.5 0 90.5l80 80c12 12 28.3 18.7 45.3 18.7H288h9.4H512c17.7 0 32-14.3 32-32s-14.3-32-32-32H387.9L518.6 285.3c25-25 25-65.5 0-90.5L381.3 57.4c-25-25-65.5-25-90.5 0zM297.4 416H288l-105.4 0-80-80L227.3 211.3 364.7 348.7 297.4 416z"}))),i("ir-icon",{key:"c8b27b5ef26d7abd42eb50da17022de8e1293aaf",onIconClickHandler:()=>this.handleSearchClicked(true),title:(f=h.entries)===null||f===void 0?void 0:f.Lcz_ExportToExcel},i("svg",{key:"07ac9accbd7c88981891fb2a738433eb6d8fe018",slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"15",viewBox:"0 0 384 512"},i("path",{key:"5b44babc76370a4bf3b1ca6acef19a2029b85877",fill:"currentColor",d:"M48 448V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm90.9 233.3c-8.1-10.5-23.2-12.3-33.7-4.2s-12.3 23.2-4.2 33.7L161.6 320l-44.5 57.3c-8.1 10.5-6.3 25.5 4.2 33.7s25.5 6.3 33.7-4.2L192 359.1l37.1 47.6c8.1 10.5 23.2 12.3 33.7 4.2s12.3-23.2 4.2-33.7L222.4 320l44.5-57.3c8.1-10.5 6.3-25.5-4.2-33.7s-25.5-6.3-33.7 4.2L192 280.9l-37.1-47.6z"}))))))}};se.style=ie;class oe extends x{async AddPayment(t,e){try{const i=this.getToken();if(i!==null){const{data:s}=await v.post(`/Do_Payment?Ticket=${i}`,{payment:Object.assign(Object.assign({},t),{book_nbr:e})});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return s.My_Result}}catch(t){console.log(t);throw new Error(t)}}async CancelPayment(t){try{const e=this.getToken();if(e!==null){const{data:i}=await v.post(`/Cancel_Payment?Ticket=${e}`,{id:t});if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}return i.My_Result}}catch(t){console.log(t);throw new Error(t)}}}const ae=".backdropModal.sc-ir-listing-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-listing-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-listing-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-listing-modal{padding:10px;background:white;border-radius:5px}.modal.sc-ir-listing-modal{z-index:1001 !important}.modal-dialog.sc-ir-listing-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-listing-modal{gap:10px}.exit-icon.sc-ir-listing-modal{position:absolute;right:10px;top:5px;margin:0}.ir-modal.sc-ir-listing-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-listing-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const ne=ae;const le=class{constructor(i){t(this,i);this.modalClosed=e(this,"modalClosed",7);this.resetData=e(this,"resetData",7);this.bookingListingsService=new Ct;this.paymentService=new oe;this.modalTitle="Modal Title";this.editBooking=undefined;this.isOpen=false;this.deletionStage=1;this.selectedDesignation=undefined;this.loadingBtn=null}componentWillLoad(){this.bookingListingsService.setToken(xt.token);this.paymentService.setToken(xt.token);this.selectedDesignation=xt.settlement_methods[0].name}async closeModal(){this.isOpen=false;this.deletionStage=1;this.selectedDesignation=xt.settlement_methods[0].name;this.modalClosed.emit(null)}async openModal(){this.isOpen=true}filterBookings(){xt.bookings=xt.bookings.filter((t=>t.booking_nbr!==this.editBooking.booking.booking_nbr))}async btnClickHandler(t){let e=t.target;let i=e.name;try{if(i==="confirm"){if(this.editBooking.cause==="payment"){await this.paymentService.AddPayment({amount:this.editBooking.booking.financial.due_amount,currency:this.editBooking.booking.currency,date:D().format("YYYY-MM-DD"),designation:this.selectedDesignation,id:-1,reference:""},this.editBooking.booking.booking_nbr);this.resetData.emit(this.editBooking.booking.booking_nbr);this.closeModal()}else{if(this.deletionStage===2){this.loadingBtn="recover_and_delete";await this.bookingListingsService.removeExposedBooking(this.editBooking.booking.booking_nbr,true);this.filterBookings()}if(this.deletionStage===1){this.deletionStage=2}}}if(i==="cancel"){if(this.deletionStage===2){this.loadingBtn="just_delete";await this.bookingListingsService.removeExposedBooking(this.editBooking.booking.booking_nbr,false);this.filterBookings()}else{this.closeModal()}}}catch(t){console.error(t)}finally{if(this.loadingBtn){this.loadingBtn=null;this.closeModal()}}}renderTitle(){var t,e;if(this.editBooking.cause==="payment"){return(t=h.entries)===null||t===void 0?void 0:t.Lcz_MarkBookingAsPaid.replace("%1",this.editBooking.booking.booking_nbr)}else{if(this.deletionStage===1){return h.entries.Lcz_SureYouWantToDeleteBookingNbr+((e=this.editBooking)===null||e===void 0?void 0:e.booking.booking_nbr)}return h.entries.Lcz_WantToRecoverAllotment}}renderConfirmationTitle(){if(this.deletionStage===2){return h.entries.Lcz_RecoverAndDelete}return h.entries.Lcz_Confirm}renderCancelationTitle(){if(this.deletionStage===2){return h.entries.Lcz_JustDelete}return h.entries.Lcz_Cancel}render(){if(!this.editBooking){return null}return[i("div",{class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{if(this.editBooking.cause==="delete"){return}this.closeModal()}}),i("div",{"data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},this.isOpen&&i("div",{class:`ir-alert-content p-2`},i("div",{class:`ir-alert-header align-items-center border-0 py-0 m-0 `},i("p",{class:"p-0 my-0 mb-1"},this.renderTitle()),i("ir-icon",{class:"exit-icon",style:{cursor:"pointer"},onClick:()=>{this.closeModal()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"10.5",viewBox:"0 0 384 512"},i("path",{fill:"currentColor",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})))),i("div",{class:"modal-body text-left p-0 mb-2"},this.editBooking.cause==="payment"?i("ir-select",{selectedValue:this.selectedDesignation,onSelectChange:t=>this.selectedDesignation=t.detail,showFirstOption:false,LabelAvailable:false,data:xt.settlement_methods.map((t=>({value:t.name,text:t.name})))}):null),i("div",{class:`ir-alert-footer border-0 d-flex justify-content-end`},i("ir-button",{isLoading:this.loadingBtn==="just_delete",icon:"",btn_color:"secondary",btn_block:true,text:this.renderCancelationTitle(),name:"cancel"}),i("ir-button",{isLoading:this.loadingBtn==="recover_and_delete",icon:"",btn_color:"primary",btn_block:true,text:this.renderConfirmationTitle(),name:"confirm"}))))]}};le.style=ne;const re=".sc-ir-loading-screen-h{display:fixed;height:100vh;width:100vw;z-index:1000;top:0;left:0;display:flex;align-items:center;justify-content:center;background:white}.loader.sc-ir-loading-screen{width:1.25rem;height:1.25rem;border:2.5px solid #3f3f3f;border-bottom-color:transparent;border-radius:50%;display:inline-block;box-sizing:border-box;animation:rotation 1s linear infinite}.loaderContainer.sc-ir-loading-screen{position:absolute;z-index:100001;padding:20px;top:50%;left:50%;transform:translate(-50%, -50%);background:white;display:flex;align-items:center;justify-content:center;gap:20px;border-radius:5px}@keyframes rotation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";const ce=re;const de=class{constructor(e){t(this,e);this.message=""}render(){return i(s,{key:"142b3a322a1eddce8e14654608504f9e27b4c5c9"},i("span",{key:"0ad70854ee2e2f7ef2f08deaf8e69398515b65e5",class:"loader"}))}};de.style=ce;const he=".backdropModal.sc-ir-modal{background-color:rgba(0, 0, 0, 0.5);z-index:1000;position:fixed;top:0;left:0;height:100vh;width:100%;opacity:0;transition:opacity 0.3s ease-in-out;pointer-events:none}.backdropModal.active.sc-ir-modal{cursor:pointer;opacity:1 !important;pointer-events:all}.ir-modal[data-state='opened'].sc-ir-modal{opacity:1;visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}.ir-alert-content.sc-ir-modal{padding:10px;background:white;border-radius:5px}.modal.sc-ir-modal{z-index:1001 !important}.modal-dialog.sc-ir-modal{height:100vh;display:flex;align-items:center}.ir-alert-footer.sc-ir-modal{gap:10px}.ir-modal.sc-ir-modal{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1050;width:90%;max-width:32rem;overflow:hidden;outline:0;opacity:0;transition:transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;visibility:hidden;pointer-events:none}.ir-modal.active.sc-ir-modal{opacity:1;transform:translate(-50%, 0);visibility:visible;pointer-events:all;transition:all 0.3s ease-in-out}";const fe=he;const pe=class{constructor(i){t(this,i);this.confirmModal=e(this,"confirmModal",7);this.cancelModal=e(this,"cancelModal",7);this.modalTitle="Modal Title";this.modalBody="Modal Body";this.rightBtnActive=true;this.leftBtnActive=true;this.rightBtnText="Confirm";this.leftBtnText="Close";this.rightBtnColor="primary";this.leftBtnColor="secondary";this.btnPosition="right";this.iconAvailable=false;this.icon="";this.isOpen=false;this.item={}}async closeModal(){this.isOpen=false}async openModal(){this.isOpen=true}btnClickHandler(t){let e=t.target;let i=e.name;if(i===this.leftBtnText){this.cancelModal.emit();this.item={};this.closeModal()}else if(i===this.rightBtnText){this.confirmModal.emit(this.item);this.item={};this.closeModal()}}render(){return[i("div",{key:"4914bb67a184f183b16052d55d1014514cb0958f",class:`backdropModal ${this.isOpen?"active":""}`,onClick:()=>{this.cancelModal.emit();this.closeModal()}}),i("div",{key:"2bd8dca9f922fdb2c317c8c7c6b39f62ae9d8db5","data-state":this.isOpen?"opened":"closed",class:`ir-modal`,tabindex:"-1"},i("div",{key:"104ce6ce884e57d49122f87978704c16ed32356a",class:`ir-alert-content p-2`},i("div",{key:"1283121b9d958dd3854704399bf7b0c5782f7978",class:`ir-alert-header align-items-center border-0 py-0 m-0 `}),i("div",{key:"acb317326636def16e21b7dc5f1233f605a75c0b",class:"modal-body text-left p-0 mb-2"},i("div",{key:"7e0f43fcc6b0923ef6fa6f83dba9520b2775855e"},this.modalBody)),i("div",{key:"2444d9c5346a81b07e5dbdf465ad80c446a3798e",class:`ir-alert-footer border-0  d-flex justify-content-${this.btnPosition==="center"?"center":this.btnPosition==="left"?"start":"end"}`},this.leftBtnActive&&i("ir-button",{icon:"",btn_color:this.leftBtnColor,btn_block:true,text:this.leftBtnText,name:this.leftBtnText}),this.rightBtnActive&&i("ir-button",{icon:"",btn_color:this.rightBtnColor,btn_block:true,text:this.rightBtnText,name:this.rightBtnText}))))]}};pe.style=fe;const be=".sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}";const ue=be;const me=class{constructor(i){t(this,i);this.resetBookingData=e(this,"resetBookingData",7);this.toast=e(this,"toast",7);this.paymentService=new oe;this.bookingService=new b;this.bookingDetails=undefined;this.defaultTexts=undefined;this.newTableRow=false;this.collapsedPayment=false;this.collapsedGuarantee=false;this.flag=false;this.confirmModal=false;this.toBeDeletedItem=undefined;this.paymentDetailsUrl="";this.paymentExceptionMessage=""}async componentWillLoad(){try{this.paymentService.setToken(f.token);this.bookingService.setToken(f.token);this.initializeItemToBeAdded()}catch(t){if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentExceptionMessage=t}}}initializeItemToBeAdded(){this.itemToBeAdded={id:-1,date:D().format("YYYY-MM-DD"),amount:null,currency:this.bookingDetails.currency,designation:"",reference:""}}async _handleSave(){try{console.log(this.itemToBeAdded);if(this.itemToBeAdded.amount===null){this.toast.emit({type:"error",title:this.defaultTexts.entries.Lcz_EnterAmount,description:"",position:"top-right"});return}await this.paymentService.AddPayment(this.itemToBeAdded,this.bookingDetails.booking_nbr);this.initializeItemToBeAdded();this.resetBookingData.emit(null)}catch(t){console.log(t)}}handlePaymentInputChange(t,e,i){if(t==="amount"){if(!isNaN(e)||e===""){if(e===""){this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:null})}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:parseFloat(e)})}}else if(i&&i.target){let t=i.target;let e=t.value;e=e.replace(/[^\d-]|(?<!^)-/g,"");t.value=e}}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:e})}}async handleConfirmModal(t){t.stopImmediatePropagation();t.stopPropagation();try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.bookingDetails.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.bookingDetails=Object.assign(Object.assign({},this.bookingDetails),{financial:Object.assign(Object.assign({},this.bookingDetails.financial),{payments:t})});this.confirmModal=!this.confirmModal;this.resetBookingData.emit(null);this.toBeDeletedItem=null}catch(t){console.log(t)}}handleBookingDetails(){if(this.newTableRow){this.newTableRow=false}}handleDateChange(t){this.handlePaymentInputChange("date",t.detail.end.format("YYYY-MM-DD"))}_renderTableRow(t,e="normal"){return i(o,null,i("tr",null,i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},pt(t.date)):i("ir-date-picker",{minDate:D().add(-2,"months").startOf("month").format("YYYY-MM-DD"),singleDatePicker:true,autoApply:true,onDateChanged:this.handleDateChange.bind(this)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center "},e==="normal"?i("span",{class:"sm-padding-right"},"$",Number(t.amount).toFixed(2)):i("input",{type:"text",class:"border-0  form-control py-0 m-0 w-100",value:this.itemToBeAdded.amount===null?"":Number(this.itemToBeAdded.amount).toFixed(2),onInput:t=>this.handlePaymentInputChange("amount",+t.target.value,t)})),i("td",{class:"border payments-height border-light border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left"},t.designation):i("input",{class:"border-0 w-100 form-control py-0 m-0",onInput:t=>this.handlePaymentInputChange("designation",t.target.value),type:"text"})),i("td",{rowSpan:2,class:"border payments-height border-light border-bottom-0 text-center"},i("ir-icon",{icon:"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right",onClick:e==="add"?()=>{this._handleSave()}:()=>{}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},i("path",{fill:"#6b6f82",d:"M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"}))),i("span",null,"  "),i("ir-icon",{icon:"ft-trash-2 danger h5 pointer",onClick:e==="add"?()=>{this.newTableRow=false;this.initializeItemToBeAdded()}:()=>{this.toBeDeletedItem=t;const e=document.querySelector(".delete-record-modal");e.openModal()}},i("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},i("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))),i("tr",null,i("td",{colSpan:3,class:"border border-light payments-height border-bottom-0 text-center"},e==="normal"?i("span",{class:"sm-padding-left "},t.reference):i("input",{class:"border-0 w-100  form-control py-0 m-0",onKeyPress:t=>{if(t.key==="Enter"){this.newTableRow=false;this._handleSave()}},onInput:t=>this.handlePaymentInputChange("reference",t.target.value),type:"text"}))))}bookingGuarantee(){var t,e,s,o,a,n,l,r,c,d,h,f,p,b,u,m,g,y,k,v,x,w,_,D,C,O,I,M;if(this.bookingDetails.is_direct&&!this.bookingDetails.guest.cci){return null}return i("div",null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_BookingGuarantee),i("ir-icon",{id:"drawer-icon","data-toggle":"collapse","data-target":`.guarrantee`,"aria-expanded":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",onClick:async()=>{if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentDetailsUrl=await this.bookingService.getPCICardInfoURL(this.bookingDetails.booking_nbr)}this.collapsedGuarantee=!this.collapsedGuarantee}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},i("path",{fill:"#104064",d:"M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"})))),i("div",{class:"collapse guarrantee "},this.bookingDetails.is_direct?[i("div",null,((e=(t=this.bookingDetails)===null||t===void 0?void 0:t.guest)===null||e===void 0?void 0:e.cci)&&"Card:"," ",i("span",null,((a=(o=(s=this.bookingDetails)===null||s===void 0?void 0:s.guest)===null||o===void 0?void 0:o.cci)===null||a===void 0?void 0:a.nbr)||"")," ",((r=(l=(n=this.bookingDetails)===null||n===void 0?void 0:n.guest)===null||l===void 0?void 0:l.cci)===null||r===void 0?void 0:r.expiry_month)&&"Expiry: ",i("span",null," ",((h=(d=(c=this.bookingDetails)===null||c===void 0?void 0:c.guest)===null||d===void 0?void 0:d.cci)===null||h===void 0?void 0:h.expiry_month)||""," ",((b=(p=(f=this.bookingDetails)===null||f===void 0?void 0:f.guest)===null||p===void 0?void 0:p.cci)===null||b===void 0?void 0:b.expiry_year)&&"/"+((g=(m=(u=this.bookingDetails)===null||u===void 0?void 0:u.guest)===null||m===void 0?void 0:m.cci)===null||g===void 0?void 0:g.expiry_year))),i("div",null,((k=(y=this.bookingDetails)===null||y===void 0?void 0:y.guest)===null||k===void 0?void 0:k.cci.holder_name)&&"Name:"," ",i("span",null,((w=(x=(v=this.bookingDetails)===null||v===void 0?void 0:v.guest)===null||x===void 0?void 0:x.cci)===null||w===void 0?void 0:w.holder_name)||"")," ",((C=(D=(_=this.bookingDetails)===null||_===void 0?void 0:_.guest)===null||D===void 0?void 0:D.cci)===null||C===void 0?void 0:C.cvc)&&"- CVC:"," ",i("span",null," ",((M=(I=(O=this.bookingDetails)===null||O===void 0?void 0:O.guest)===null||I===void 0?void 0:I.cci)===null||M===void 0?void 0:M.cvc)||""))]:this.paymentDetailsUrl?i("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"}):i("div",{class:"text-center"},this.paymentExceptionMessage)))}_renderDueDate(t){return i("tr",null,i("td",{class:"pr-1"},pt(t.date)),i("td",{class:"pr-1"},bt(t.amount,this.bookingDetails.currency.code)),i("td",{class:"pr-1"},t.description),i("td",{class:"collapse font-size-small roomName"},t.room))}render(){var t,e,s,a;if(!this.bookingDetails.financial){return null}return[i("div",{class:"card m-0"},i("div",{class:"p-1"},this.bookingDetails.cost>0&&this.bookingDetails.cost!==null&&i("div",{class:"mb-2 h4"},"Total cost: ",i("span",null,bt(this.bookingDetails.cost,this.bookingDetails.currency.code))),i("div",{class:"mb-2 h4"},this.defaultTexts.entries.Lcz_DueBalance,":"," ",i("span",{class:"danger font-weight-bold"},bt(this.bookingDetails.financial.due_amount,this.bookingDetails.currency.code))),this.bookingGuarantee(),i("div",{class:"mt-2"},i("div",null,((e=(t=this.bookingDetails.financial)===null||t===void 0?void 0:t.due_dates)===null||e===void 0?void 0:e.length)>0&&i(o,null,i("div",{class:"d-flex align-items-center"},i("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_PaymentDueDates),i("ir-icon",{id:"drawer-icon","data-toggle":"collapse","data-target":`.roomName`,"aria-expanded":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",onClick:()=>{this.collapsedPayment=!this.collapsedPayment}},!this.collapsedPayment?i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},i("path",{fill:"#104064",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"25",viewBox:"0 0 640 512",slot:"icon"},i("path",{fill:"#104064",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"})))),i("table",null,(s=this.bookingDetails.financial.due_dates)===null||s===void 0?void 0:s.map((t=>this._renderDueDate(t))))))),i("div",{class:"mt-2 d-flex  flex-column rounded payment-container"},i("strong",null,this.defaultTexts.entries.Lcz_Payments),i("table",{class:"mt-1"},i("thead",null,i("tr",null,i("th",{class:"border border-light border-bottom-0 text-center payment_date"},this.defaultTexts.entries.Lcz_Dates),i("th",{class:"border border-light border-bottom-0 text-center w-60"},this.defaultTexts.entries.Lcz_Amount),i("th",{class:"border border-light border-bottom-0 text-center designation"},this.defaultTexts.entries.Lcz_Designation),i("th",{class:"border border-light border-bottom-0 text-center action_icons"},i("span",{class:"sr-only"},"payment actions"),i("ir-icon",{id:"add-payment",icon:"font-weight-bold p-0",onClick:()=>{this.newTableRow=true}},i("svg",{height:14,width:14,slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},i("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),i("tbody",null,(a=this.bookingDetails.financial.payments)===null||a===void 0?void 0:a.map((t=>this._renderTableRow(t))),this.newTableRow?this._renderTableRow(null,"add"):null))))),i("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:"If deleted it will be permnantly lost!",iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",onConfirmModal:this.handleConfirmModal.bind(this)})]}static get watchers(){return{bookingDetails:["handleBookingDetails"]}}};me.style=ue;class ge{async savePickup(t,e,i){try{const s=t.arrival_time.split(":");await v.post(`/Do_Pickup?Ticket=${f.token}`,{booking_nbr:e,is_remove:i,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){const e=d(t.hour)+":"+d(t.minute);return{arrival_date:t.date,arrival_time:e,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let e=[];f.pickup_service.allowed_options.forEach((i=>{if(e.filter((t=>t.value===i.location.id)).length===0){e.push({text:t+" "+i.location.description,value:i.location.id})}}));return e}validateForm(t){if(t.arrival_time.split(":").length!==2){return{error:true,cause:"arrival_time"}}if(t.flight_details===""){return{error:true,cause:"flight_details"}}if(t.vehicle_type_code===""){return{error:true,cause:"vehicle_type_code"}}if(t.number_of_vehicles===0){return{error:true,cause:"number_of_vehicles"}}return{error:false}}getNumberOfVehicles(t,e){let i=Math.ceil(e/t);let s=i>1?i:1;let o=i>1?2:3;return Array.from({length:i+o},((t,e)=>s+e))}getPickUpPersonStatus(t){const e=f.pickup_service.allowed_pricing_models.find((e=>e.code===t));if(!e){return null}return e.description}updateDue(t){const e=this.getPickUpPersonStatus(t.code);if(!e){return}if(e==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const ye=".sc-ir-pickup-h{display:block}.custom-card-container.sc-ir-pickup{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e4e5ec}.card-title.sc-ir-pickup{flex:1}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}";const ke=ye;const ve=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.resetBookingData=e(this,"resetBookingData",7);this.pickupService=new ge;this.defaultPickupData=undefined;this.numberOfPersons=0;this.bookingNumber=undefined;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:D().format("YYYY-MM-DD"),selected_option:undefined};this.vehicleCapacity=[];this.cause=null}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=f.pickup_service.allowed_options.filter((e=>e.location.id===t.location));this.pickupData=Object.assign({},t)}}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;if(e===""){this.updatePickupData("location",-1)}if(e!==""){this.allowedOptionsByLocation=f.pickup_service.allowed_options.filter((t=>t.location.id.toString()===e));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:e,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency});const i=this.el.querySelector("#pickup-time");if(!i){setTimeout((()=>{this.initializeInputMask()}),100)}}}initializeInputMask(){const t=this.el.querySelector("#pickup-time");if(t){Inputmask("Hh:Mm",{placeholder:"HH:mm",definitions:{H:{validator:"[0-2]"},h:{validator:function(t,e,i){var s=e.buffer[i-1];if(s==="2"){return/[0-3]/.test(t)}else{return/[0-9]/.test(t)}}},M:{validator:"[0-5]"},m:{validator:"[0-9]"}},insertMode:true,showMaskOnHover:false,inputmode:"numeric",alias:"datetime",oncomplete:()=>{this.updatePickupData("arrival_time",t.value)},oncleared:()=>{this.updatePickupData("arrival_time","")},onincomplete:()=>{this.updatePickupData("arrival_time",t.value)}}).mask(t)}}handleVehicleQuantityChange(t){if(t.detail===""){return}const e=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:e,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:e}).toFixed(2)})}componentDidLoad(){if(this.defaultPickupData){this.initializeInputMask()}}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let e=f.pickup_service.allowed_options.find((e=>e.location.id===+this.pickupData.location&&e.vehicle.code===t.detail));if(!e){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(e.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:e,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:e.amount,code:e.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:e.vehicle.code})}updatePickupData(t,e){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:e})}async savePickup(){try{this.isLoading=true;const t=this.pickupService.validateForm(this.pickupData);if(t.error){this.cause=t.cause;return}if(this.cause){this.cause=null}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return i(s,{key:"2e92e2678e97d5da0b95b21bf633f802bf0eb208",class:"p-0"},i("ir-title",{key:"d14cadbaf49486c9bdda534ec0cd27a9e60987f1",class:"px-1",onCloseSideBar:()=>this.closeModal.emit(null),label:h.entries.Lcz_Pickup,displayContext:"sidebar"}),i("section",{key:"6cd4bbc4c3236463ba188d63ac5042a074c0f14c",class:"px-1"},i("ir-select",{key:"ed347090519ee6cec02f865472d598a064bbff43",selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:h.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",LabelAvailable:false,data:this.pickupService.getAvailableLocations(h.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&i(o,null,i("div",{class:"d-flex"},i("div",{class:"form-group  mr-1"},i("div",{class:"input-group row m-0"},i("div",{class:`input-group-prepend col-5 p-0 text-dark border-0`},i("label",{class:`input-group-text  flex-grow-1 text-dark border-theme `},h.entries.Lcz_ArrivalDate)),i("div",{class:"form-control form-control-md col-7 d-flex align-items-center pl-0"},i("ir-date-picker",{minDate:D().format("YYYY-MM-DD"),autoApply:true,singleDatePicker:true,onDateChanged:t=>{this.updatePickupData("arrival_date",t.detail.start.format("YYYY-MM-DD"))}})))),i("div",{class:"form-group"},i("div",{class:"input-group  row m-0"},i("div",{class:`input-group-prepend col-4 col-sm-3 p-0 text-dark border-0`},i("label",{htmlFor:"pickup",class:`input-group-text flex-grow-1 text-dark border-theme`},h.entries.Lcz_Time)),i("input",{type:"text",value:this.pickupData.arrival_time,id:"pickup-time",class:`form-control col-8 col-sm-4 ${this.cause==="arrival_time"&&"border-danger"}`})))),i("ir-input-text",{value:this.pickupData.flight_details,label:h.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",inputStyles:this.cause==="flight_details"?"border-danger":""}),i("ir-select",{selectContainerStyle:"mb-1",selectStyles:this.cause==="vehicle_type_code"?"border-danger":"",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:h.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",LabelAvailable:false,data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),i("div",{class:"d-flex flex-column flex-md-row"},i("ir-select",{labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectStyles:this.cause==="number_of_vehicles"?"border-danger":"",selectedValue:this.pickupData.number_of_vehicles,labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:h.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),i("ir-input-text",{labelBorder:"theme",readonly:true,value:this.pickupData.due_upon_booking,labelWidth:7,label:`${h.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`,placeholder:"",class:""}))),i("div",{key:"67a5b3a003721d8f69bb8bf32c7ce4669fd9ff57",class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{key:"b8f43ba57d10f6886fafd8c1ffe4b3ec40c05ac7",onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  ${this.defaultPickupData||this.pickupData.location!==-1?"mr-sm-1":""}`,icon:"",text:h.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&i("ir-button",{btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:this.isLoading,text:h.entries.Lcz_Save,btn_color:"primary",onClick:this.savePickup.bind(this)}))))}get el(){return a(this)}};ve.style=ke;const xe=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.2rem 0.3rem;border-radius:5px}.payment-container.sc-ir-room{position:absolute;right:1rem;height:fit-content}.sc-ir-room-h{position:relative}.sm-mr.sc-ir-room{margin-right:3px}.night-cost.sc-ir-room{color:#1c4262}.mx-0-5.sc-ir-room{margin-left:2px !important;margin-right:2px !important}.tax-width.sc-ir-room{font-size:10px}.sm-mb-1.sc-ir-room{margin-bottom:5px !important}.sm-mt-1.sc-ir-room{margin-top:5px !important}.mx-01.sc-ir-room{--m:5px;margin-right:var(--m) !important;margin-left:var(--m) !important}";const we=xe;const _e=class{constructor(i){t(this,i);this.deleteFinished=e(this,"deleteFinished",7);this.pressCheckIn=e(this,"pressCheckIn",7);this.pressCheckOut=e(this,"pressCheckOut",7);this.editInitiated=e(this,"editInitiated",7);this.bookingEvent=undefined;this.bookingIndex=undefined;this.mealCodeName=undefined;this.myRoomTypeFoodCat=undefined;this.currency="USD";this.legendData=undefined;this.roomsInfo=undefined;this.collapsed=false;this.defaultTexts=undefined;this.ticket=undefined;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.item=undefined;this.isLoading=false;this.isModelOpen=false}componentWillLoad(){if(this.bookingEvent){this.item=this.bookingEvent.rooms[this.bookingIndex]}}handleBookingEventChange(){this.item=this.bookingEvent.rooms[this.bookingIndex]}componentDidLoad(){this.modal=this.element.querySelector("ir-modal")}handleClick(t){let e=t.target;if(e.id=="checkin"){this.pressCheckIn.emit(this.item)}else if(e.id=="checkout"){this.pressCheckOut.emit(this.item)}}getDateStr(t,e="default"){return t.getDate()+" "+t.toLocaleString(e,{month:"short"})+" "+t.getFullYear()}handleEditClick(){var t,e,i,s,o,a;this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.item["assigned_units_pool"],NAME:g(this.item.guest.first_name,this.item.guest.last_name),EMAIL:this.bookingEvent.guest.email,PHONE:this.bookingEvent.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingEvent.from_date,TO_DATE:this.bookingEvent.to_date,TITLE:`${this.defaultTexts.entries.Lcz_EditBookingFor} ${(e=(t=this.item)===null||t===void 0?void 0:t.roomtype)===null||e===void 0?void 0:e.name} ${((s=(i=this.item)===null||i===void 0?void 0:i.unit)===null||s===void 0?void 0:s.name)||""}`,defaultDateRange:{dateDifference:this.item.days.length,fromDate:new Date(this.item.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.item.from_date+"T00:00:00")),toDate:new Date(this.item.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.item.to_date+"T00:00:00")),message:""},bed_preference:this.item.bed_preference,adult_child_offering:this.item.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.item.rateplan.selected_variation.adult_nbr,ARRIVAL:this.bookingEvent.arrival,ARRIVAL_TIME:this.bookingEvent.arrival.description,BOOKING_NUMBER:this.bookingEvent.booking_nbr,cancelation:this.item.rateplan.cancelation,channel_booking_nbr:this.bookingEvent.channel_booking_nbr,CHILDREN_COUNT:this.item.rateplan.selected_variation.child_nbr,COUNTRY:this.bookingEvent.guest.country_id,ENTRY_DATE:this.bookingEvent.from_date,FROM_DATE_STR:this.bookingEvent.format.from_date,guarantee:this.item.rateplan.guarantee,GUEST:this.bookingEvent.guest,IDENTIFIER:this.item.identifier,is_direct:this.bookingEvent.is_direct,IS_EDITABLE:this.bookingEvent.is_editable,NO_OF_DAYS:this.item.days.length,NOTES:this.bookingEvent.remark,origin:this.bookingEvent.origin,POOL:this.item["assigned_units_pool"],PR_ID:(o=this.item.unit)===null||o===void 0?void 0:o.id,RATE:this.item.total,RATE_PLAN:this.item.rateplan.name,RATE_PLAN_ID:this.item.rateplan.id,RATE_TYPE:this.item.roomtype.id,ROOMS:this.bookingEvent.rooms,SOURCE:this.bookingEvent.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.bookingEvent.format.to_date,TOTAL_PRICE:this.bookingEvent.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:((a=this.item.unit)===null||a===void 0?void 0:a.name)||""})}handleDeleteClick(){this.modal.openModal()}async deleteRoom(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];t=t.filter((t=>t.identifier!==this.item.identifier));const e={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.bookingEvent.booking_nbr,from_date:this.bookingEvent.from_date,to_date:this.bookingEvent.to_date,remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};console.log("body:",e);const{data:i}=await v.post(`/DoReservation?Ticket=${this.ticket}`,e);if(i.ExceptionMsg!==""){throw new Error(i.ExceptionMsg)}this.deleteFinished.emit(this.item.identifier)}catch(t){}finally{this.isLoading=false}}render(){console.log(this.item);return i(s,{key:"93d25016a5c21a22262d37ffeb2e0f12d2ab3931",class:"p-1 d-flex m-0"},i("ir-icon",{key:"832811ae22c50c1ce7d8c9fb5e75037cb6a99bd1",id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${this.item.identifier.split(" ").join("")}`,"aria-expanded":"false","aria-controls":"collapseExample",class:"pointer mr-1",onClick:()=>{this.collapsed=!this.collapsed}},!this.collapsed?i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},i("path",{fill:"#104064",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"})):i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"25",viewBox:"0 0 640 512",slot:"icon"},i("path",{fill:"#104064",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"}))),i("div",{key:"046d8940d79aeb5d53aacb5ff1c7a7d304bdf81c",class:"flex-fill m-0 "},i("div",{key:"c0e510ed73f2859ca199b090db2c470b24328b03",class:"d-flex align-items-start justify-content-between sm-mb-1"},i("p",{key:"1a079b1050a68b68b565608cf95bdf87e22baff6",class:"m-0 p-0"},i("strong",{key:"690115a34f114b8c95aadb8b7b7718d6184edf88",class:"m-0 p-0"},this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.item.rateplan.is_non_refundable&&` - ${this.defaultTexts.entries.Lcz_NonRefundable}`," "),i("div",{key:"091b6deff1d78775da21da4c3a8162cbf21a87c7",class:"d-flex m-0 p-0 align-items-center"},i("span",{key:"36f6bc341e5f49e8a3b11e1349fa8937e9d6d0eb",class:"p-0 m-0 ml-1 font-weight-bold"},bt(this.item["gross_total"],this.currency)),this.hasRoomEdit&&i("ir-icon",{id:`roomEdit-${this.item.identifier}`,class:"pointer mx-1",onClick:this.handleEditClick.bind(this)},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),this.hasRoomDelete&&i("ir-icon",{onClick:this.handleDeleteClick.bind(this),id:`roomDelete-${this.item.identifier}`,class:"pointer"},i("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},i("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))),i("div",{key:"1f00e351b81364f469e8c21b38cb007cbf2f2f8e",class:"d-flex align-items-center sm-mb-1"},i("ir-date-view",{key:"fdce0d79619efb38adbede63c7b8b7d595581999",class:"mr-1",from_date:this.item.from_date,to_date:this.item.to_date,showDateDifference:false}),f.is_frontdesk_enabled&&this.item.unit&&i("span",{class:"light-blue-bg mr-2 "},this.item.unit.name),this.hasCheckIn&&i("ir-button",{id:"checkin",icon:"",class:"mr-1",btn_color:"info",size:"sm",text:"Check in"}),this.hasCheckOut&&i("ir-button",{id:"checkout",icon:"",btn_color:"info",size:"sm",text:"Check out"})),i("div",{key:"07134ecea0d4808ee4e502949913b0b43cd3856a"},i("span",{key:"5b58ece347ab9d1ee207f13222b5a929d893f31c",class:"mr-1"},`${this.item.guest.first_name||""} ${this.item.guest.last_name||""}`),this.item.rateplan.selected_variation.adult_nbr>0&&i("span",null," ",this.item.rateplan.selected_variation.adult_child_offering)),i("div",{key:"cf10cde8913813398a2b3a42ce961c5862ee6399",class:"collapse",id:`roomCollapse-${this.item.identifier.split(" ").join("")}`},i("div",{key:"a6672aa6490c79437eb8cde946b9198300aec48e",class:"d-flex sm-mb-1 sm-mt-1"},i("div",{key:"3216008fc19caf567541b39c10a6e1620004baaf",class:" sm-padding-top"},i("strong",{key:"2baf7a61f22ed7555c908cd93538b5af716c4ca5",class:"sm-padding-right"},`${this.defaultTexts.entries.Lcz_Breakdown}:`)),i("div",{key:"7a99a64b5850a2d29afdf0a51d820be654d37f79",class:"flex-fill"},i("table",{key:"ae5243585f95068ea45219ea83d61f891bde9993"},this.item.days.length>0&&this.item.days.map((t=>i("tr",null,i("td",{class:"pr-2 text-right"},ut(t.date)),i("td",{class:"text-right"},bt(t.amount,this.currency)),t.cost>0&&t.cost!==null&&i("td",{class:"pl-2 text-right night-cost"},bt(t.cost,this.currency))))),i("tr",{key:"5dc049ff4130ce70cb0f2391185d9e03d19fb5a6"},i("th",{key:"01b6a78cd9397cf8a1e46219707225b67fcd86a5",class:"text-right pr-2"},this.defaultTexts.entries.Lcz_SubTotal),i("th",{key:"496ec099f63373d414937b07d4d1ea0db10d1b18",class:"text-right"},bt(this.item.total,this.currency))),this.bookingEvent.is_direct?i(o,null,(()=>{const t=f.taxes.filter((t=>t.pct>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name," (",t.pct,"%)"),i("td",{class:"text-right"},bt(this.item.total*t.pct/100,this.currency)))))})()):i(o,null,(()=>{const t=this.item.ota_taxes.filter((t=>t.amount>0));return t.map((t=>i("tr",null,i("td",{class:"text-right pr-2"},t.is_exlusive?this.defaultTexts.entries.Lcz_Excluding:this.defaultTexts.entries.Lcz_Including," ",t.name),i("td",{class:"text-right"},t.currency.symbol,t.amount))))})())))),i("div",{key:"ea728dc3460c5a408d927bdc0790c0270c24b6cb",class:"sm-mb-1",innerHTML:this.item.rateplan.cancelation||""}),i("div",{key:"8370523f0410d3153a559a019abb0b0e33eea9a3",class:"sm-mb-1",innerHTML:this.item.rateplan.guarantee||""}),i("ir-label",{key:"7bac9893eefda8da15de50b51151ffb5c9bd77e8",label:`${this.defaultTexts.entries.Lcz_MealPlan}:`,value:this.mealCodeName}))),i("ir-modal",{key:"042bf8370106322c4c35935a151014c1a885bfe0",onConfirmModal:this.deleteRoom.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:`${this.defaultTexts.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.item.roomtype.name} ${this.item.unit?this.item.unit.name:""} ${this.defaultTexts.entries.Lcz_FromThisBooking}`}))}get element(){return a(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};_e.style=we;const De=".border-theme.sc-ir-select{border:1px solid #cacfe7}@keyframes bounce{0%,100%{transform:scale(1);animation-timing-function:cubic-bezier(0.8, 0, 1, 1)}50%{transform:scale(1.2);animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}}.bounce-3.sc-ir-select{animation:bounce 1s 1}";const Ce=De;const Oe=class{constructor(i){t(this,i);this.selectChange=e(this,"selectChange",7);this.count=0;this.name=undefined;this.data=undefined;this.label="<label>";this.selectStyles=undefined;this.selectContainerStyle=undefined;this.selectedValue=null;this.required=undefined;this.LabelAvailable=true;this.firstOption="Select";this.selectStyle=true;this.showFirstOption=true;this.submited=false;this.size="md";this.textSize="md";this.labelPosition="left";this.labelBackground=null;this.labelColor="dark";this.labelBorder="theme";this.labelWidth=3;this.select_id=p();this.initial=true;this.valid=false}watchHandler(t){if(t!==null&&this.required){this.valid=true}}watchHandler2(t){if(t&&this.required){this.initial=false}}handleButtonAnimation(t){console.log(t.detail,this.select_id,t.detail===this.select_id);if(!this.selectEl||t.detail!==this.select_id){return}console.log("first1");t.stopImmediatePropagation();t.stopPropagation();this.selectEl.classList.add("border-danger")}componentwillload(){}disconnectedCallback(){}handleSelectChange(t){this.selectEl.classList.remove("border-danger");if(this.required){this.initial=false;this.valid=t.target.checkValidity();this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}else{this.selectedValue=t.target.value;this.selectChange.emit(this.selectedValue)}}render(){let t="form-control";let e=i("div",{key:"5a5b080b94c17c5f78aae88487cd4fdd99975437",class:`input-group-prepend col-${this.labelWidth} p-0 text-${this.labelColor}`},i("label",{key:"066810f4ff6a90ec86c27fa9dd2d434ef41f491f",htmlFor:this.select_id,class:`input-group-text ${this.labelPosition==="right"?"justify-content-end":this.labelPosition==="center"?"justify-content-center":""} ${this.labelBackground?"bg-"+this.labelBackground:""} flex-grow-1 text-${this.labelColor} border-${this.labelBorder==="none"?0:this.labelBorder} `},this.label,this.required?"*":""));if(this.selectStyle===false){t=""}if(this.required&&!this.valid&&!this.initial){t=`${t} border-danger`}if(!this.LabelAvailable){e=""}return i("div",{key:"ed7a2dc3a411c441aa9547f2aab46ccec799afdd",class:`form-group m-0 ${this.selectContainerStyle}`},i("div",{key:"91b17e0ff3263d37e3a0adc339584ffe753e9ddf",class:"input-group row m-0"},e,i("select",{key:"9ffe43d290e03c505a1c58612ec0080c848b62b8",ref:t=>this.selectEl=t,id:this.select_id,class:`${this.selectStyles} ${t} form-control-${this.size} text-${this.textSize} col-${this.LabelAvailable?12-this.labelWidth:12}`,onInput:this.handleSelectChange.bind(this),required:this.required},this.showFirstOption&&i("option",{value:""},this.firstOption),this.data.map((t=>{if(this.selectedValue===t.value){return i("option",{selected:true,value:t.value},t.text)}else{return i("option",{value:t.value},t.text)}})))))}static get watchers(){return{selectedValue:["watchHandler"],submited:["watchHandler2"]}}};Oe.style=Ce;const Ie=".backdrop{position:fixed;top:0;left:0;width:100%;height:100vh;cursor:pointer;background:rgba(0, 0, 0, 0.5);z-index:99;transition:all 0.5s;opacity:0;pointer-events:none;transition:all 0.5s}.backdrop.active{opacity:1;pointer-events:all}.sidebar-right{position:fixed;top:0;right:-120%;bottom:0;width:var(--sidebar-width, 40rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:100;overflow-y:hidden;color:var(--sidebar-color, #000);background-color:var(--sidebar-backgound, #fff);padding:0.5rem 0}.sidebar-right.active{right:0;overflow-y:auto}.sidebar-left{position:fixed;top:0;left:-100%;bottom:0;width:var(--sidebar-width, 30rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:200;overflow-y:hidden;color:var(--sidebar-color, #000);background:var(--sidebar-backgound, #fff);padding:0.5rem}.sidebar-left.active{left:0;overflow-y:scroll}.close{position:absolute;top:0.5rem;right:1rem;width:1rem;height:1rem;cursor:pointer}";const Me=Ie;const Be=class{constructor(i){t(this,i);this.irSidebarToggle=e(this,"irSidebarToggle",7);this.name=undefined;this.side="right";this.showCloseButton=true;this.open=false;this.sidebarStyles=undefined}applyStyles(){for(const t in this.sidebarStyles){if(this.sidebarStyles.hasOwnProperty(t)){this.sidebarRef.style[t]=this.sidebarStyles[t]}}}handleSidebarStylesChange(){this.applyStyles()}componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidLoad(){this.applyStyles();document.addEventListener("keydown",this.handleKeyDown)}handleKeyDown(t){if(t.key==="Escape"){return this.toggleSidebar()}else{return}}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}async toggleSidebar(){this.irSidebarToggle.emit(this.open)}render(){let t="";if(this.open){t="active"}else{t=""}return[i("div",{key:"019cd52f797a5e1a65dd7e6a0cf9419295c54c47",class:`backdrop ${t}`,onClick:()=>{this.toggleSidebar()}}),i("div",{key:"299cbd5051a9473736dd352a40e45938f726a3a0",ref:t=>this.sidebarRef=t,class:`sidebar-${this.side} ${t}`},this.showCloseButton&&i("ir-icon",{class:"close",onIconClickHandler:()=>{this.toggleSidebar()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{fill:"#6b6f82",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),i("slot",{key:"8ffd996f6f1123528ae3d6fbebaf149c5cb22786",name:"sidebar-body"}))]}static get watchers(){return{sidebarStyles:["handleSidebarStylesChange"]}}};Be.style=Me;const Te=".sc-ir-title-h{padding:0px 0;margin-bottom:20px;display:flex;align-items:center;width:100%}[display-context='sidebar'].sc-ir-title-h{padding:15px 0;justify-content:space-between !important;width:100% !important;border-bottom:1px solid #e4e5ec !important;border-color:#e4e5ec !important}.title-body.sc-ir-title{margin:0;padding:0}@media only screen and (max-width: 641px){.sc-ir-title-h{flex-direction:column;gap:8px;align-items:flex-start}[display-context='sidebar'].sc-ir-title-h{flex-direction:row}}";const Se=Te;const Ye=class{constructor(i){t(this,i);this.closeSideBar=e(this,"closeSideBar",7);this.label=undefined;this.displayContext="default";this.justifyContent="start"}componentDidLoad(){this.el.style.justifyContent=this.justifyContent}handleJustifyContentChange(t,e){if(t!==e){this.el.style.justifyContent=t}}render(){return i(s,{key:"7a475b5d998fdd5242984369d2f838f3483ab92d"},i("h4",{key:"0e517b3d4bd062abe308ef8a0f43f9c358a3e4b7",class:"text-left font-medium-2 py-0 my-0"},this.label),this.displayContext==="sidebar"&&i("ir-icon",{class:"close",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},i("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),this.displayContext!=="sidebar"&&i("div",{class:"title-body"},i("slot",{name:"title-body"})))}get el(){return a(this)}static get watchers(){return{justifyContent:["handleJustifyContentChange"]}}};Ye.style=Se;const Le="button.sc-ir-toast,p.sc-ir-toast,h3.sc-ir-toast,div.sc-ir-toast{all:unset}.sc-ir-toast-h{--rd-viewport-padding:25px;--rd-success:#2b9a66;position:fixed;bottom:0;right:0;display:flex;flex-direction:column;padding:var(--rd-viewport-padding);gap:10px;max-width:100vw;margin:0;list-style:none;z-index:2147483647;outline:none;pointer-events:none;-webkit-user-select:none;user-select:none}@media (prefers-color-scheme: dark){.sc-ir-toast-h{--rd-success:#33b074}}p.sc-ir-toast{color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3}h1.sc-ir-toast,h2.sc-ir-toast,h3.sc-ir-toast,h4.sc-ir-toast,h5.sc-ir-toast,h6.sc-ir-toast{font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}[position='top-left'].sc-ir-toast-h{top:0;left:0}[position='top-right'].sc-ir-toast-h{top:0;right:0}[position='bottom-left'].sc-ir-toast-h{bottom:0;left:0}[position='bottom-right'].sc-ir-toast-h{bottom:0;right:0}.icon-container.sc-ir-toast{height:25px;width:25px;border-radius:25px;display:flex;align-items:center;justify-content:center;padding:0;margin:0}.icon-container.sc-ir-toast>svg.sc-ir-toast{margin:0;color:white;stroke-width:5px}.success.sc-ir-toast{background-color:var(--rd-success)}.error.sc-ir-toast{background-color:red}.ToastRoot.sc-ir-toast{background-color:hsl(0, 0%, 100%);border-radius:0.5rem;box-shadow:hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;padding:15px;display:grid;grid-template-areas:'title action' 'description action';grid-template-columns:auto max-content;column-gap:15px;align-items:center;pointer-events:none;opacity:0;border:1px solid hsl(214.3, 31.8%, 91.4%);position:relative}.ToastRoot[data-state='open'].sc-ir-toast{pointer-events:all;animation:slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1)}.ToastRoot[data-state='closed'].sc-ir-toast{pointer-events:none;animation:hide 100ms ease-in}@-webkit-keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}@keyframes slideIn{from{transform:translateX(var(--rd-offset-width))}to{transform:translateX(0)}}.ToastTitle.sc-ir-toast{grid-area:title;font-weight:500;color:hsl(222.2, 84%, 4.9%);font-size:15px}.ToastDescription.sc-ir-toast{grid-area:description;margin:0;margin-top:5px;color:hsla(222.2, 84%, 4.9%, 0.8);font-size:13px;line-height:1.3;overflow:hidden;text-overflow:ellipsis}.ToastAction.sc-ir-toast{grid-area:action}";const ze=Le;const Ee=class{constructor(e){t(this,e);this.position="bottom-left";this.toasts=[]}onToast(t){const e=t.detail;this.showToast(e)}showToast(t){const e={positionClass:"toast-top-right",closeButton:true,timeOut:t.duration||5e3};switch(t.type){case"success":toastr.success(t.title,"",e);break;case"error":toastr.error(t.title,"",e);break}}render(){return i(s,{key:"c816c0d95603f03245ecf1e8b28a79191cf4edb7"})}get element(){return a(this)}};Ee.style=ze;const je=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}.tooltip-inner-custom.sc-ir-tooltip{min-width:max-content !important}";const Re=je;const Ne=class{constructor(e){t(this,e);this.message=undefined;this.withHtml=true;this.customSlot=false;this.open=undefined}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){return i(s,{key:"8f9204e4606bbdba69a77fa011a199a19b0d6765",class:"m-0 p-0"},i("span",{key:"7a956896c80191b5b9e5abe05a24de267e663b12",onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},!this.customSlot?i("svg",{"data-toggle":"tooltip","data-placement":"top",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",class:"tooltip-icon",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})):i("slot",{name:"tooltip-trigger"})),this.open&&i("div",{class:"tooltip bottom show position-absolute",role:"tooltip"},i("div",{class:"tooltip-arrow"}),i("div",{class:`tooltip-inner fit ${this.customSlot&&"tooltip-inner-custom"}`},i("span",{innerHTML:this.message}))))}};Ne.style=Re;const He="*.sc-ota-label{margin:0;padding:0}.sc-ota-label-h{display:flex;margin-bottom:5px;gap:5px;width:100%}strong.sc-ota-label{margin:0;padding:0}ul.sc-ota-label{margin:0 3px;padding:0;list-style:none;overflow:hidden;width:100%;word-wrap:break-word !important;overflow-wrap:break-word !important}li.sc-ota-label{width:100%;line-height:1.5;margin:0;padding:0;word-wrap:break-word !important;overflow-wrap:break-word !important}button.sc-ota-label{background:white;color:var(--blue);padding:0;margin:0;margin-left:3px;font-size:12px;border:0}button.sc-ota-label:hover{color:#355270}";const $e=He;const Ae=class{constructor(e){t(this,e);this.toggleShowAll=()=>{this.showAll=!this.showAll};this.label=undefined;this.remarks=undefined;this.maxVisibleItems=3;this.showAll=false}render(){if(!this.remarks){return null}const t=this.showAll?this.remarks:this.remarks.slice(0,this.maxVisibleItems);return i(s,null,i("strong",null,this.label),i("ul",null,t.map(((e,s)=>i("li",{key:p()},"- ",e.statement," ",this.remarks.length>this.maxVisibleItems&&s===t.length-1&&i("button",{onClick:this.toggleShowAll},this.showAll?h.entries.Lcz_ShowLess:h.entries.Lcz_ShowMore))))))}};Ae.style=$e;export{M as igl_application_info,S as igl_block_dates_view,E as igl_book_property,N as igl_book_property_container,P as igl_book_property_footer,K as igl_book_property_header,W as igl_booking_overview_page,X as igl_booking_room_rate_plan,tt as igl_booking_rooms,st as igl_date_range,nt as igl_pagetwo,ct as igl_property_booked_by,ft as ir_autocomplete,kt as ir_booking_details,Mt as ir_booking_listing,St as ir_button,Lt as ir_common,jt as ir_date_picker,Ht as ir_date_view,Pt as ir_guest_info,Kt as ir_icon,Wt as ir_input_text,Xt as ir_interceptor,te as ir_label,se as ir_listing_header,le as ir_listing_modal,de as ir_loading_screen,pe as ir_modal,me as ir_payment_details,ve as ir_pickup,_e as ir_room,Oe as ir_select,Be as ir_sidebar,Ye as ir_title,Ee as ir_toast,Ne as ir_tooltip,Ae as ota_label};
//# sourceMappingURL=p-080183dc.entry.js.map