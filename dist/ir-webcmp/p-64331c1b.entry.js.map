{"version":3,"names":["irSalesByCountryCss","IrSalesByCountryStyle0","IrSalesByCountry","constructor","hostRef","this","language","ticket","isLoading","token","Token","roomService","RoomService","ticketChanged","newValue","oldValue","setToken","initializeApp","propertyId","propertyid","p","Error","console","log","propertyData","getExposedProperty","id","aname","is_backend","include_units_hk_status","My_Result","property_id","requests","fetchLanguage","push","Promise","all","error","render","h","Host","class","style","gap","size","btn_color","text","locales","entries","Lcz_Export","onClickHandler","e","stopImmediatePropagation","stopPropagation","btnStyle","height","iconPosition","icon_name","icon_style"],"sources":["src/components/ir-sales-by-country/ir-sales-by-country.css?tag=ir-sales-by-country&encapsulation=scoped","src/components/ir-sales-by-country/ir-sales-by-country.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n","import Token from '@/models/Token';\r\nimport { RoomService } from '@/services/room.service';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ir-sales-by-country',\r\n  styleUrl: 'ir-sales-by-country.css',\r\n  scoped: true,\r\n})\r\nexport class IrSalesByCountry {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n  @Prop() propertyid: number;\r\n  @Prop() p: string;\r\n\r\n  @State() isLoading = true;\r\n  @State() property_id: number;\r\n\r\n  private token = new Token();\r\n  private roomService = new RoomService();\r\n\r\n  @Watch('ticket')\r\n  ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue === oldValue) {\r\n      return;\r\n    }\r\n    this.token.setToken(this.ticket);\r\n    this.initializeApp();\r\n  }\r\n  private async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      let propertyId = this.propertyid;\r\n      if (!this.propertyid && !this.p) {\r\n        throw new Error('Property ID or username is required');\r\n      }\r\n      // let roomResp = null;\r\n      if (!propertyId) {\r\n        console.log(propertyId);\r\n        const propertyData = await this.roomService.getExposedProperty({\r\n          id: 0,\r\n          aname: this.p,\r\n          language: this.language,\r\n          is_backend: true,\r\n          include_units_hk_status: true,\r\n        });\r\n        // roomResp = propertyData;\r\n        propertyId = propertyData.My_Result.id;\r\n      }\r\n      this.property_id = propertyId;\r\n      const requests = [this.roomService.fetchLanguage(this.language)];\r\n      if (this.propertyid) {\r\n        requests.push(\r\n          this.roomService.getExposedProperty({\r\n            id: this.propertyid,\r\n            language: this.language,\r\n            is_backend: true,\r\n            include_units_hk_status: true,\r\n          }),\r\n        );\r\n      }\r\n\r\n      await Promise.all(requests);\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-toast></ir-toast>\r\n        <ir-interceptor></ir-interceptor>\r\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\r\n          <div class=\"d-flex align-items-center justify-content-between\">\r\n            <h3 class=\"mb-1 mb-md-0\">Sales by Country</h3>\r\n            <ir-button\r\n              size=\"sm\"\r\n              btn_color=\"outline\"\r\n              text={locales.entries.Lcz_Export}\r\n              onClickHandler={e => {\r\n                e.stopImmediatePropagation();\r\n                e.stopPropagation();\r\n              }}\r\n              btnStyle={{ height: '100%' }}\r\n              iconPosition=\"right\"\r\n              icon_name=\"file\"\r\n              icon_style={{ '--icon-size': '14px' }}\r\n            ></ir-button>\r\n          </div>\r\n          <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\r\n            <ir-sales-filters></ir-sales-filters>\r\n\r\n            <ir-sales-table class=\"card\"></ir-sales-table>\r\n          </div>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"sOAAA,MAAMA,EAAsB,2CAC5B,MAAAC,EAAeD,E,MCSFE,EAAgB,MAL7B,WAAAC,CAAAC,G,UAMUC,KAAAC,SAAmB,GACnBD,KAAAE,OAAiB,GAIhBF,KAAAG,UAAY,KAGbH,KAAAI,MAAQ,IAAIC,EACZL,KAAAM,YAAc,IAAIC,C,CAG1B,aAAAC,CAAcC,EAAkBC,GAC9B,GAAID,IAAaC,EAAU,CACzB,M,CAEFV,KAAKI,MAAMO,SAASX,KAAKE,QACzBF,KAAKY,e,CAEC,mBAAMA,GACZ,IACEZ,KAAKG,UAAY,KACjB,IAAIU,EAAab,KAAKc,WACtB,IAAKd,KAAKc,aAAed,KAAKe,EAAG,CAC/B,MAAM,IAAIC,MAAM,sC,CAGlB,IAAKH,EAAY,CACfI,QAAQC,IAAIL,GACZ,MAAMM,QAAqBnB,KAAKM,YAAYc,mBAAmB,CAC7DC,GAAI,EACJC,MAAOtB,KAAKe,EACZd,SAAUD,KAAKC,SACfsB,WAAY,KACZC,wBAAyB,OAG3BX,EAAaM,EAAaM,UAAUJ,E,CAEtCrB,KAAK0B,YAAcb,EACnB,MAAMc,EAAW,CAAC3B,KAAKM,YAAYsB,cAAc5B,KAAKC,WACtD,GAAID,KAAKc,WAAY,CACnBa,EAASE,KACP7B,KAAKM,YAAYc,mBAAmB,CAClCC,GAAIrB,KAAKc,WACTb,SAAUD,KAAKC,SACfsB,WAAY,KACZC,wBAAyB,O,OAKzBM,QAAQC,IAAIJ,E,CAClB,MAAOK,GACPf,QAAQC,IAAIc,E,SAEZhC,KAAKG,UAAY,K,EAGrB,MAAA8B,GACE,GAAIjC,KAAKG,UAAW,CAClB,OAAO+B,EAAA,yB,CAET,OACEA,EAACC,EAAI,KACHD,EAAA,iBACAA,EAAA,uBACAA,EAAA,WAASE,MAAM,yBAAyBC,MAAO,CAAEC,IAAK,SACpDJ,EAAA,OAAKE,MAAM,qDACTF,EAAA,MAAIE,MAAM,gBAAc,oBACxBF,EAAA,aACEK,KAAK,KACLC,UAAU,UACVC,KAAMC,EAAQC,QAAQC,WACtBC,eAAgBC,IACdA,EAAEC,2BACFD,EAAEE,iBAAiB,EAErBC,SAAU,CAAEC,OAAQ,QACpBC,aAAa,QACbC,UAAU,OACVC,WAAY,CAAE,cAAe,WAGjCnB,EAAA,OAAKE,MAAM,uCAAuCC,MAAO,CAAEC,IAAK,SAC9DJ,EAAA,yBAEAA,EAAA,kBAAgBE,MAAM,W","ignoreList":[]}