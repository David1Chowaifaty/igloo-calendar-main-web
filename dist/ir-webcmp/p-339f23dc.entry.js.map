{"version":3,"names":["irBookingEmailLogsCss","IrBookingEmailLogsStyle0","IrBookingEmailLogs","constructor","hostRef","this","token","Token","componentWillLoad","ticket","setToken","handleTicketChange","render","h","Host","key","class","handledEndpoints","style","gap","inputContainerStyle","margin","value","bookingNumber","onTextChange","e","detail","placeholder","size","text","onClickHandler","async","data","axios","post","BOOK_NBR","ExceptionMsg","My_Result","JSON","stringify","getAllParams","params","URLSearchParams","window","location","search","out","entries","irBookingListingCss","IrBookingListingStyle0","IrBookingListing","language","rowCount","isLoading","currentPage","totalPages","oldStartValue","editBookingItem","showCost","bookingListingService","BookingListingService","bookingService","BookingService","roomService","RoomService","propertyService","PropertyService","statusColors","baseUrl","setBaseUrl","updateUserSelection","booking_listing","initializeApp","onBookingListingChange","newValue","newTotal","total_count","Math","ceil","some","booking","financial","gross_cost","ticketChanged","oldValue","havePrivilege","isPrivilegedUser","userType","propertyId","propertyid","p","Error","propertyData","getExposedProperty","id","aname","is_backend","parallelRequests","getSetupEntriesByTableNameMulti","getExposedBookingsCriteria","fetchLanguage","allowedPropertiesIndex","push","length","getExposedAllowedProperties","results","Promise","all","setupEntries","pay_type","pay_type_group","pay_method","groupEntryTablesResult","paymentEntries","groups","methods","types","allowedProperties","_a","map","updateUserSelections","property_ids","userTypeCode","getExposedBookings","Object","assign","userSelection","is_to_export","error","console","handleSideBarToggle","geSearchFiltersFromParams","log","obj","Number","s","status","filter","from","to","getPaginationBounds","totalCount","startItem","endItem","openModal","listingModalTimeout","setTimeout","listingModal","el","querySelector","editBooking","disconnectedCallback","clearTimeout","handleResetData","stopImmediatePropagation","stopPropagation","handleResetStoreData","handleBookingChanged","bookings","b","booking_nbr","renderItemRange","locales","Lcz_View","Lcz_Of","updateData","start_row","end_row","calculateTotalPersons","sumOfOccupancy","adult_nbr","children_nbr","infant_nbr","rooms","reduce","prev","cur","occupancy","scope","Lcz_Booking","_b","Lcz_BookedOn","_c","Lcz_GuestSource","_d","Lcz_Services","_e","Lcz_Dates","_f","Lcz_Amount","customSlot","message","_g","Lcz_BookingBalance","_h","Lcz_ClickToSettle","slot","_j","Lcz_Balance","_k","Lcz_Cost","_l","Lcz_Status","colSpan","_m","Lcz_NoDataAvailable","_o","confirmationBG","is_requested_to_cancel","code","lastManipulation","ota_manipulations","totalPersons","property","name","btn_color","btnStyle","padding","cause","channel_booking_nbr","moment","booked_on","date","format","_formatTime","hour","toString","minute","width","src","origin","Icon","alt","Label","guest","first_name","last_name","labelStyle","nbr_confirmed_bookings","agent","Lcz_BookingsNbr","replace","color","Lcz_P","getPrivateNote","extras","is_in_loyalty_mode","promo_key","xmlns","viewBox","height","Lcz_LoyaltyDiscountApplied","fill","d","stroke","Lcz_Coupon","room","roomtype","unit","isSingleUnit","substring","extra_services","Lcz_ExtraServices","from_date","to_date","whiteSpace","formatAmount","currency","symbol","gross_total","Fragment","includes","cancelation_penality_as_if_today","onClick","abs","due_amount","Lcz_CancellationRequested","description","events","type","toLowerCase","marginTop","marginBottom","trigger","content","user","title","variant","icon_name","btn_disabled","selectedValue","showFirstOption","onSelectChange","Array","_","i","onModalClosed","onIrSidebarToggle","bind","open","showCloseButton","sidebarStyles","_p","background","_q","hasPrint","hasReceipt","is_from_front_desk","_t","_s","_r","hasRoomEdit","hasRoomDelete","hasCloseButton","onCloseSidebar","hasRoomAdd","_u","isInSideBar","headerShown","_w","_v","email","_y","_x","onCloseSideBar","irDailyRevenueCss","IrDailyRevenueStyle0","IrDailyRevenue","filters","users","tokenService","handleSidebarClose","sideBarEvent","handleOpenSidebar","handleFetchNewReports","getPaymentReports","handleResetBooking","renderSidebarBody","property_id","payload","isPageLoading","include_units_hk_status","requests","groupPaymentsByName","payments","groupedPayment","Map","payment","payTypeCode","payMethodCode","get","set","sort","a","aNum","bNum","isNaN","localeCompare","isExportToExcel","excludeYesterday","getReportObj","report","method","METHOD","PAY_TYPE_CODE","PAY_METHOD_CODE","amount","AMOUNT","DATE","HOUR","MINUTE","USER","CURRENCY","bookingNbr","BOOKING_NBR","v4","getDailyRevenueReport","is_export_to_excel","add","previousDateGroupedPayments","Lcz_Export","iconPosition","icon_style","groupedPayments","Boolean","irHkTasksCss","IrHkTasksStyle0","IrHkTasks","isCleaningLoading","selectedDuration","selectedHouseKeeper","selectedRoom","archiveOpened","hkNameCache","houseKeepingService","HouseKeepingService","table_sorting","init","handleCloseSidebar","isSidebarOpen","handleSortingChanged","field","direction","handleSkipSelectedTask","modalCauses","task","modal","setLoading","getExposedHKSetup","tasksResult","getHkTasks","housekeepers","cleaning_frequency","calendar_data","housekeeping_store","hk_criteria","cleaning_frequencies","dusty_window","dusty_periods","highlight_window","highlight_checkin_options","tasks","updateTasks","buildHousekeeperNameCache","forEach","hk","updateTasksStore","t","housekeeper","hkm_id","hkName","find","handleHeaderButtonPress","sortingArray","url","fetchTasksWithFilters","downloadFile","handleSelectedTaskCleaningEvent","handleModalConfirmation","hkTasksStore","selectedTasks","editHkSkip","COMMENT","HK_SKIP_ID","HK_SKIP_REASON_CODE","PR_ID","executeHKAction","actions","unit_id","clearSelectedTasks","closeModal","applyFilters","isApplyFiltersLoading","export_to_excel","cleaning_periods","dusty_units","highlight_check_ins","onApplyFilters","onRowSelectChange","updateSelectedTasks","autoClose","ref","onConfirmModal","onCancelModal","iconAvailable","icon","leftBtnText","Lcz_Cancel","rightBtnText","Lcz_Confirm","leftBtnColor","rightBtnColor","modalTitle","Lcz_Confirmation","modalBody","getToken","irHousekeepingCss","IrHousekeepingStyle0","IrHousekeeping","include_sales_rate_plans","updateHKStore","housekeeping_enabled","selectedCleaningFrequency","saveAutomaticCheckInCheckout","SetAutomaticCheckInOut","default_properties","flag","toast","emit","position","saveCleaningFrequency","setExposedCleaningFrequency","Lcz_HouseKeepingAndCheckInSetup","borderShown","label","Lcz_CheckInOutGuestsAutomatically","is_automatic_check_in_out","Lcz_YesAsPerPropertyPolicy","Lcz_NoIWillDoItManually","Lcz_CleaningFrequency","v","isRequestPending","irMonthlyBookingsReportCss","IrMonthlyBookingsReportStyle0","IrMonthlyBookingsReport","reports","baseFilters","firstOfMonth","startOf","lastOfMonth","endOf","include_previous_year","handleApplyFiltersChange","getReports","day","Date","units_booked","Units_booked","occupancy_percent","Occupancy","adr","ADR","rooms_revenue","Rooms_Revenue","total_guests","Total_Guests","getMonthlyStats","currentReports","enrichedReports","DailyStats","rest","__rest$2","stats","previousYearReports","formattedReports","current","previous","last_year","alignItems","Occupancy_Difference_From_Previous_Month","cardTitle","AverageOccupancy","toFixed","subtitle","TotalUnitsBooked","PeakDays","pd","concat","join","max","OccupancyPercent","irSalesByChannelCss","IrSalesByChannelStyle0","IrSalesByChannel","FROM_DATE","TO_DATE","BOOK_CASE","WINDOW","channelSalesFilters","mode","propertyID","unshift","properties","LIST_AC_ID","getChannelSales","filterParams","__rest$1","currentSales","AC_ID","undefined","shouldFetchPreviousYear","enrichedSales","previousYearSales","subtract","SOURCE","record","groupSalesRecordsBySource","records","getCurrencyId","r","createKey","source","trim","currencyId","sumValues","mergeLastYear","base","incoming","NIGHTS","PCT","REVENUE","PROPERTY_ID","PROPERTY_NAME","grouped","existing","merged","result","values","totalRevenue","sum","lastYearTotal","salesData","irSalesByCountryCss","IrSalesByCountryStyle0","IrSalesByCountry","countries","salesFilters","getCountries","getCountrySales","mappedCountries","country","formatSalesData","COUNTRY","country_id","COUNTRY_ID","nights","percentage","revenue","number_of_guests","__rest","salesReports","irUserManagementCss","IrUserManagementStyle0","IrUserManagement","isSuperAdmin","allowedUsersTypes","userService","UserService","userTypes","superAdminId","fetchUsers","fetchUserTypes","socket","io","on","msg","handleSocketMessage","msgAsObject","parse","REASON","KEY","PAYLOAD","reasonHandlers","EMAIL_VERIFIED","updateUserVerificationStatus","handler","call","warn","idx","findIndex","u","is_email_verified","getExposedPropertyUsers","u1","u2","priority","p1","p2","username","res","getSetupEntriesByTableName","getLov","allowedUsers","allowed_user_types","toUpperCase","f","CODE_NAME","disconnect","suppressToastEndpoints","Lcz_ExtranetUsers","baseUserTypeCode","haveAdminPrivileges"],"sources":["src/components/ir-booking-email-logs/ir-booking-email-logs.css?tag=ir-booking-email-logs&encapsulation=scoped","src/components/ir-booking-email-logs/ir-booking-email-logs.tsx","src/utils/browserHistory.ts","src/components/ir-booking-listing/ir-booking-listing.css?tag=ir-booking-listing&encapsulation=scoped","src/components/ir-booking-listing/ir-booking-listing.tsx","src/components/ir-daily-revenue/ir-daily-revenue.css?tag=ir-daily-revenue&encapsulation=scoped","src/components/ir-daily-revenue/ir-daily-revenue.tsx","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.css?tag=ir-hk-tasks&encapsulation=scoped","src/components/ir-housekeeping/ir-hk-tasks/ir-hk-tasks.tsx","src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.css?tag=ir-monthly-bookings-report&encapsulation=scoped","src/components/ir-monthly-bookings-report/ir-monthly-bookings-report.tsx","src/components/ir-sales-by-channel/ir-sales-by-channel.css?tag=ir-sales-by-channel&encapsulation=scoped","src/components/ir-sales-by-channel/ir-sales-by-channel.tsx","src/components/ir-sales-by-country/ir-sales-by-country.css?tag=ir-sales-by-country&encapsulation=scoped","src/components/ir-sales-by-country/ir-sales-by-country.tsx","src/components/ir-user-management/ir-user-management.css?tag=ir-user-management&encapsulation=scoped","src/components/ir-user-management/ir-user-management.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport axios from 'axios';\n\n@Component({\n  tag: 'ir-booking-email-logs',\n  styleUrl: 'ir-booking-email-logs.css',\n  scoped: true,\n})\nexport class IrBookingEmailLogs {\n  @Prop() ticket: string;\n\n  @State() data: any[];\n  @State() bookingNumber: string;\n\n  private token = new Token();\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n  }\n\n  @Watch('ticket')\n  handleTicketChange() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n  }\n\n  render() {\n    return (\n      <Host class=\"p-1\">\n        <ir-interceptor handledEndpoints={['/Get_Email_log_By_BOOK_NBR']}></ir-interceptor>\n        <ir-toast></ir-toast>\n        <div class=\"d-flex align-items-center mb-1\" style={{ gap: '0.5rem' }}>\n          <ir-input-text\n            class=\"m-0\"\n            inputContainerStyle={{ margin: '0' }}\n            value={this.bookingNumber}\n            onTextChange={e => (this.bookingNumber = e.detail)}\n            placeholder=\"booking number\"\n          ></ir-input-text>\n          <ir-button\n            size=\"sm\"\n            text=\"search\"\n            onClickHandler={async () => {\n              const { data } = await axios.post('/Get_Email_log_By_BOOK_NBR', {\n                BOOK_NBR: this.bookingNumber,\n              });\n              if (data.ExceptionMsg) {\n                return;\n              }\n              this.data = data.My_Result;\n            }}\n          ></ir-button>\n        </div>\n        <p>{JSON.stringify(this.data, null, 2)}</p>\n      </Host>\n    );\n  }\n}\n","// src/utils/browserHistory.ts\n\n/**\n * A small utility for reading and writing browser history\n * and manipulating URL search params in a type-safe way.\n */\n\ntype Parser<T> = (value: string | null) => T;\n\n// Common parsers/serializers\nexport const ParamTypes = {\n  string: {\n    parse: (v: string | null): string => v ?? '',\n    serialize: (v: string): string => v,\n  },\n  number: {\n    parse: (v: string | null): number => {\n      if (v == null || v === '') return NaN;\n      const n = Number(v);\n      return isNaN(n) ? NaN : n;\n    },\n    serialize: (v: number): string => String(v),\n  },\n  boolean: {\n    parse: (v: string | null): boolean => v === 'true',\n    serialize: (v: boolean): string => (v ? 'true' : 'false'),\n  },\n} as const;\n\n/**\n * Read a single search‑param, parse it, and return a typed value.\n * Falls back to defaultValue if missing or parse fails.\n */\nexport function getParam<T>(key: string, { parse }: { parse: Parser<T> }, defaultValue: T): T {\n  const params = new URLSearchParams(window.location.search);\n  const raw = params.get(key);\n  try {\n    if (raw == null) return defaultValue;\n    return parse(raw);\n  } catch {\n    return defaultValue;\n  }\n}\n\n/** Helpers for the three built‑in types */\nexport function getStringParam(key: string, defaultValue = ''): string {\n  return getParam(key, ParamTypes.string, defaultValue);\n}\n\nexport function getNumberParam(key: string, defaultValue = NaN): number {\n  return getParam(key, ParamTypes.number, defaultValue);\n}\n\nexport function getBooleanParam(key: string, defaultValue = false): boolean {\n  return getParam(key, ParamTypes.boolean, defaultValue);\n}\n\n/**\n * Read all current search params into a Record<string, string>\n */\nexport function getAllParams(): Record<string, string> {\n  const params = new URLSearchParams(window.location.search);\n  const out: Record<string, string> = {};\n  for (const [key, value] of params.entries()) {\n    out[key] = value;\n  }\n  return out;\n}\n\ninterface SetParamsOptions {\n  /** if true, uses replaceState instead of pushState */\n  replace?: boolean;\n}\n\n/**\n * Update one or more search params.\n * Pass null to delete a param.\n * By default uses history.pushState; set replace: true to call replaceState.\n */\nexport function setParams(updates: Record<string, string | number | boolean | null>, options: SetParamsOptions = {}): void {\n  const params = new URLSearchParams(window.location.search);\n\n  for (const [key, value] of Object.entries(updates)) {\n    if (!value) {\n      params.delete(key);\n    } else {\n      params.set(key, String(value));\n    }\n  }\n\n  const newSearch = params.toString();\n  const newUrl = window.location.pathname + (newSearch ? `?${newSearch}` : '') + window.location.hash;\n\n  if (options.replace) {\n    window.history.replaceState(window.history.state, '', newUrl);\n  } else {\n    window.history.pushState(window.history.state, '', newUrl);\n  }\n}\n\n/**\n * Push a new history entry.\n * `path` may include search or hash.\n * `state` is the history state object.\n */\nexport function pushHistory(path: string, state: any = {}): void {\n  window.history.pushState(state, '', path);\n}\n\n/**\n * Replace the current history entry.\n * `path` may include search or hash.\n * `state` is the history state object.\n */\nexport function replaceHistory(path: string, state: any = {}): void {\n  window.history.replaceState(state, '', path);\n}\n",":host {\n  display: block;\n  height: 100%;\n}\n.logo {\n  height: 2rem;\n  width: 2rem;\n}\n.card {\n  overflow-x: auto;\n}\n.secondary-p {\n  font-size: 12px !important;\n}\n.room-service {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n  width: 100%;\n  padding: 0.25rem 0;\n}\n.room-name-container {\n  background: #acecff;\n  padding: 0.1rem 0.3rem;\n  border-radius: 5px;\n  /* cursor: pointer; */\n\n  /* max-width: max-content; */\n}\n.h-screen {\n  height: 100%;\n}\n.price-span {\n  margin: 0;\n  margin-right: 5px;\n}\n.main-container {\n  height: 100%;\n  overflow-y: auto;\n}\n.badge.ct_ir_badge {\n  padding: 0.2rem 0.3rem;\n}\n.yellow_dot {\n  height: 0.5rem;\n  width: 0.5rem;\n  height: 0.5rem;\n  width: 0.8rem;\n  border-radius: 50%;\n  background: rgb(244, 213, 82);\n  margin-left: 0.5rem;\n  display: inline-flex;\n  padding: 0;\n  margin: 0;\n}\n.booking_name {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n}\n.bg-ir-red {\n  background: #ff4961;\n  padding: 0.2rem 0.3rem;\n}\n.due-btn {\n  border: 1px solid #ff4961;\n  color: #ff4961;\n  cursor: pointer;\n  padding: 1px 0.25rem !important;\n  font-size: 12px !important;\n}\n.due-btn:hover {\n  background: #ff4961;\n  color: white;\n}\n.booking_number {\n  all: unset;\n  cursor: pointer;\n}\n.booking_number:hover {\n  color: #1e9ff2;\n}\n.in-out {\n  width: 150px !important;\n}\n.booking_guest_name {\n  width: fit-content;\n  padding: 0 !important;\n  margin: 0;\n}\n.booking_guest_name .button-text {\n  padding: 0 !important;\n}\n.buttons-container {\n  gap: 10px;\n}\ntd ul {\n  width: max-content !important;\n}\ntd {\n  width: max-content !important ;\n}\n.date-p {\n  width: max-content !important;\n  min-width: 100%;\n  text-align: center !important;\n}\n.booking-label-gap {\n  gap: 5px;\n}\n@media (min-width: 1024px) {\n  .yellow_dot {\n    height: 0.5rem;\n    width: 0.5rem;\n  }\n}\n","import { Booking, IUnit, Occupancy } from '@/models/booking.dto';\nimport { BookingListingService } from '@/services/booking_listing.service';\nimport { RoomService } from '@/services/room.service';\nimport booking_listing, { updateUserSelection, onBookingListingChange, updateUserSelections, ExposedBookingsParams } from '@/stores/booking_listing.store';\nimport locales from '@/stores/locales.store';\nimport { formatAmount, isPrivilegedUser } from '@/utils/utils';\nimport { Component, Host, Prop, State, Watch, h, Element, Listen, Fragment } from '@stencil/core';\nimport moment from 'moment';\nimport { _formatTime } from '../ir-booking-details/functions';\nimport { getPrivateNote } from '@/utils/booking';\nimport Token from '@/models/Token';\nimport { isSingleUnit } from '@/stores/calendar-data';\nimport { getAllParams } from '@/utils/browserHistory';\nimport { BookingService } from '@/services/booking.service';\nimport { PaymentEntries } from '../ir-booking-details/types';\nimport { AllowedProperties, PropertyService } from '@/services/property.service';\n\n@Component({\n  tag: 'ir-booking-listing',\n  styleUrl: 'ir-booking-listing.css',\n  scoped: true,\n})\nexport class IrBookingListing {\n  @Element() el: HTMLElement;\n\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() rowCount: number = 10;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n  @Prop() userType: number;\n\n  @State() isLoading = false;\n  @State() currentPage = 1;\n  @State() totalPages = 1;\n  @State() oldStartValue = 0;\n  @State() editBookingItem: { booking: Booking; cause: 'edit' | 'payment' | 'delete' | 'guest' } | null = null;\n  @State() showCost = false;\n  @State() paymentEntries: PaymentEntries;\n\n  private bookingListingService = new BookingListingService();\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private token = new Token();\n\n  private listingModal: HTMLIrListingModalElement;\n  private listingModalTimeout: NodeJS.Timeout;\n  private statusColors = {\n    '001': 'badge-warning',\n    '002': 'badge-success',\n    '003': 'badge-danger',\n    '004': 'badge-danger',\n  };\n  private allowedProperties: number[];\n  private havePrivilege: boolean;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    updateUserSelection('end_row', this.rowCount);\n    booking_listing.rowCount = this.rowCount;\n    if (this.ticket !== '') {\n      booking_listing.token = this.ticket;\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n    onBookingListingChange('userSelection', async newValue => {\n      const newTotal = newValue.total_count;\n      this.totalPages = Math.ceil(newTotal / this.rowCount);\n    });\n    onBookingListingChange('bookings', async newValue => {\n      this.showCost = newValue.some(booking => booking.financial.gross_cost !== null && booking.financial.gross_cost > 0);\n    });\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    booking_listing.token = this.ticket;\n    this.initializeApp();\n  }\n\n  private async initializeApp() {\n    try {\n      this.isLoading = true;\n      this.havePrivilege = isPrivilegedUser(this.userType);\n\n      let propertyId = this.propertyid;\n      if (!this.havePrivilege) {\n        if (!this.propertyid && !this.p) {\n          throw new Error('Property ID or username is required');\n        }\n\n        if (!propertyId) {\n          const propertyData = await this.roomService.getExposedProperty({\n            id: 0,\n            aname: this.p,\n            language: this.language,\n            is_backend: true,\n          });\n          propertyId = propertyData.My_Result.id;\n        }\n      }\n\n      const parallelRequests: Promise<unknown>[] = [\n        this.bookingService.getSetupEntriesByTableNameMulti(['_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n        this.bookingListingService.getExposedBookingsCriteria(this.havePrivilege ? null : propertyId),\n        this.roomService.fetchLanguage(this.language, ['_BOOKING_LIST_FRONT']),\n      ];\n\n      // let propertyDataIndex: number | null = null;\n      let allowedPropertiesIndex: number | null = null;\n\n      if (this.propertyid && !this.havePrivilege) {\n        // propertyDataIndex = parallelRequests.length;\n        parallelRequests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n          }),\n        );\n      }\n\n      if (this.havePrivilege) {\n        allowedPropertiesIndex = parallelRequests.length;\n        parallelRequests.push(this.propertyService.getExposedAllowedProperties());\n      }\n\n      const results = await Promise.all(parallelRequests);\n\n      const [setupEntries] = results;\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries as any);\n\n      this.paymentEntries = {\n        groups: pay_type_group,\n        methods: pay_method,\n        types: pay_type,\n      };\n\n      this.allowedProperties = allowedPropertiesIndex !== null ? (results[allowedPropertiesIndex] as AllowedProperties)?.map(p => p.id) : null;\n\n      updateUserSelection('property_id', propertyId);\n\n      updateUserSelections({\n        property_ids: this.allowedProperties,\n        userTypeCode: this.userType,\n      });\n\n      await this.bookingListingService.getExposedBookings({\n        ...booking_listing.userSelection,\n        is_to_export: false,\n      });\n    } catch (error) {\n      console.error('Error initializing app:', error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  handleSideBarToggle(e: CustomEvent<boolean>) {\n    if (e.detail) {\n      this.editBookingItem = null;\n    }\n  }\n  geSearchFiltersFromParams() {\n    //e=10&status=002&from=2025-04-15&to=2025-04-22&filter=2&c=Alitalia+Cabin+Crew\n    const params = getAllParams();\n    if (params) {\n      console.log('update params');\n      let obj: Partial<ExposedBookingsParams> = {};\n      if (params.e) {\n        obj['end_row'] = Number(params.e);\n      }\n      if (params.s) {\n        obj['start_row'] = Number(params.s);\n      }\n      if (params.status) {\n        obj['booking_status'] = params.status;\n      }\n      if (params.filter) {\n        obj['filter_type'] = params.filter;\n      }\n      if (params.from) {\n        obj['from'] = params.from;\n      }\n      if (params.to) {\n        obj['to'] = params.to;\n      }\n      updateUserSelections(obj);\n    }\n    console.log('params=>', params);\n  }\n  getPaginationBounds() {\n    const totalCount = booking_listing.userSelection.total_count;\n    const startItem = (this.currentPage - 1) * this.rowCount;\n    let endItem = this.currentPage * this.rowCount;\n    endItem = endItem > totalCount ? totalCount : endItem;\n    return { startItem, endItem, totalCount };\n  }\n\n  openModal() {\n    this.listingModalTimeout = setTimeout(() => {\n      this.listingModal = this.el.querySelector('ir-listing-modal');\n      this.listingModal.editBooking = this.editBookingItem;\n      this.listingModal.openModal();\n    }, 100);\n  }\n  disconnectedCallback() {\n    clearTimeout(this.listingModalTimeout);\n  }\n\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\n  }\n\n  @Listen('resetBookingData')\n  async handleResetStoreData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.bookingListingService.getExposedBookings({ ...booking_listing.userSelection, is_to_export: false });\n  }\n  @Listen('bookingChanged')\n  handleBookingChanged(e: CustomEvent<Booking>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    booking_listing.bookings = [\n      ...booking_listing.bookings.map(b => {\n        if (b.booking_nbr === e.detail.booking_nbr) {\n          return e.detail;\n        }\n        return b;\n      }),\n    ];\n  }\n\n  renderItemRange() {\n    const { endItem, startItem, totalCount } = this.getPaginationBounds();\n    return `${locales.entries.Lcz_View} ${startItem + 1} - ${endItem} ${locales.entries.Lcz_Of} ${totalCount}`;\n  }\n\n  async updateData() {\n    const { endItem, startItem } = this.getPaginationBounds();\n    // setParams({\n    //   s: startItem,\n    //   e: endItem,\n    // });\n    await this.bookingListingService.getExposedBookings({\n      ...booking_listing.userSelection,\n      is_to_export: false,\n      start_row: startItem,\n      end_row: endItem,\n    });\n  }\n  private calculateTotalPersons(booking: Booking) {\n    const sumOfOccupancy = ({ adult_nbr, children_nbr, infant_nbr }: Occupancy) => {\n      return (adult_nbr ?? 0) + (children_nbr ?? 0) + (infant_nbr ?? 0);\n    };\n    return booking.rooms.reduce((prev, cur) => {\n      return sumOfOccupancy(cur.occupancy) + prev;\n    }, 0);\n  }\n  render() {\n    if (this.isLoading || this.ticket === '') {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-interceptor></ir-interceptor>\n        <ir-toast></ir-toast>\n        <div class=\"p-1 main-container\">\n          <ir-listing-header propertyId={this.propertyid} p={this.p} language={this.language}></ir-listing-header>\n          <section>\n            <div class=\"card p-1 flex-fill m-0 mt-2\">\n              <table class=\"table table-striped table-bordered no-footer dataTable\">\n                <thead>\n                  <tr>\n                    {this.havePrivilege && <th class=\"text-left\">Property</th>}\n                    <th scope=\"col\" class=\"text-center\">\n                      {locales.entries?.Lcz_Booking}#\n                    </th>\n                    <th scope=\"col\">{locales.entries?.Lcz_BookedOn}</th>\n                    <th scope=\"col\">{locales.entries?.Lcz_GuestSource}</th>\n                    <th scope=\"col\" class=\"text-left services-cell\">\n                      {locales.entries?.Lcz_Services}\n                    </th>\n                    <th scope=\"col\" class=\"in-out\">\n                      {locales.entries?.Lcz_Dates}\n                    </th>\n                    <th scope=\"col\">\n                      <span class=\"price-span\">{locales.entries?.Lcz_Amount}</span>\n\n                      <ir-tooltip\n                        customSlot\n                        message={`<span style=\"width:100%;display:block;\">${locales.entries?.Lcz_BookingBalance}</span><span>${locales.entries?.Lcz_ClickToSettle}</span>`}\n                      >\n                        <span slot=\"tooltip-trigger\" class={'m-0 btn due-btn'}>\n                          {locales.entries?.Lcz_Balance}\n                        </span>\n                      </ir-tooltip>\n                    </th>\n                    {this.showCost && (\n                      <th scope=\"col\" class=\"services-cell\">\n                        {locales.entries?.Lcz_Cost}\n                      </th>\n                    )}\n                    <th scope=\"col\">{locales.entries?.Lcz_Status}</th>\n                    <th scope=\"col\">\n                      <p class=\"sr-only\">actions</p>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody class=\"\">\n                  {booking_listing.bookings.length === 0 && (\n                    <tr>\n                      <td colSpan={this.havePrivilege ? 9 : 8}>{locales.entries?.Lcz_NoDataAvailable}</td>\n                    </tr>\n                  )}\n                  {booking_listing.bookings?.map(booking => {\n                    let confirmationBG: string = this.statusColors[booking.is_requested_to_cancel ? '003' : booking.status.code];\n                    const lastManipulation = booking.ota_manipulations ? booking.ota_manipulations[booking.ota_manipulations.length - 1] : null;\n                    const totalPersons = this.calculateTotalPersons(booking);\n                    return (\n                      <tr key={booking.booking_nbr}>\n                        {this.havePrivilege && <td class=\"text-left\">{booking.property.name}</td>}\n                        <td class=\"text-left\">\n                          <ir-button\n                            btn_color=\"link\"\n                            btnStyle={{ padding: '0', margin: '0' }}\n                            onClickHandler={() => (this.editBookingItem = { booking, cause: 'edit' })}\n                            text={booking.booking_nbr}\n                          ></ir-button>\n                          {booking.channel_booking_nbr && <p class=\"p-0 m-0 text-center secondary-p\">{booking.channel_booking_nbr}</p>}\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.booked_on.date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                          <p class=\"p-0 m-0 secondary-p\">{_formatTime(booking.booked_on.hour.toString(), booking.booked_on.minute.toString())}</p>\n                        </td>\n                        <td>\n                          <div class=\"h-100 d-flex align-items-center \" style={{ width: 'max-content' }}>\n                            <img class=\"mr-2 logo\" src={booking.origin.Icon} alt={booking.origin.Label} />\n                            <div class=\"text-left\">\n                              <div class=\"d-flex align-items-center\">\n                                <div class=\"booking_name m-0 p-0\">\n                                  <ir-button\n                                    btn_color=\"link\"\n                                    onClickHandler={() => (this.editBookingItem = { booking, cause: 'guest' })}\n                                    text={`${booking.guest.first_name} ${booking.guest.last_name ?? ''}`}\n                                    btnStyle={{\n                                      width: 'fit-content',\n                                      padding: '0',\n                                      margin: '0',\n                                    }}\n                                    labelStyle={{\n                                      padding: '0',\n                                    }}\n                                  ></ir-button>\n                                  {booking.guest.nbr_confirmed_bookings > 1 && !booking.agent && (\n                                    <div class=\"m-0 p-0\">\n                                      <ir-tooltip message={`${locales.entries.Lcz_BookingsNbr}`.replace('%1', booking.guest.nbr_confirmed_bookings.toString())} customSlot>\n                                        <div class=\"d-flex align-items-center my-0 p-0\" slot=\"tooltip-trigger\">\n                                          <ir-icons style={{ '--icon-size': '0.875rem' }} color=\"#FB0AAD\" name=\"heart-fill\"></ir-icons>\n                                        </div>\n                                      </ir-tooltip>\n                                    </div>\n                                  )}\n                                  {/* <button\n                                    class=\"booking_number p-0 m-0 \"\n                                    onClick={() => {\n                                      this.editBookingItem = { booking, cause: 'guest' };\n                                    }}\n                                  ></button> */}\n                                  <span class={'p-0 m-0'}>\n                                    {/* {booking.occupancy.adult_nbr} */}\n                                    {totalPersons}\n                                    {locales.entries.Lcz_P}\n                                  </span>\n                                  {getPrivateNote(booking.extras) && <span class=\"yellow_dot\"></span>}\n                                </div>\n                              </div>\n                              <div class={'d-flex align-items-center booking-label-gap'}>\n                                <p class=\"p-0 m-0 secondary-p\">{booking.origin.Label}</p>\n                                {booking.is_in_loyalty_mode && !booking.promo_key && (\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\n                                    <title>{locales.entries.Lcz_LoyaltyDiscountApplied}</title>\n                                    <path\n                                      fill=\"#fc6c85\"\n                                      d=\"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z\"\n                                    />\n                                  </svg>\n                                )}\n                                {booking.promo_key && (\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" height={18} width={18}>\n                                    <title>{locales.entries.Lcz_Coupon + ':' + booking.promo_key}</title>\n                                    <path\n                                      stroke-linecap=\"round\"\n                                      stroke-linejoin=\"round\"\n                                      d=\"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z\"\n                                    />\n                                  </svg>\n                                )}\n                              </div>\n                              {/* {booking.agent && <p class=\"m-0 secondary-p\">{locales.entries.Lcz_AgentCode.replace('%1', booking.agent.name)}</p>} */}\n                            </div>\n                          </div>\n                        </td>\n\n                        <td>\n                          <ul>\n                            {booking.rooms.map(room => (\n                              <li>\n                                <div class={'room-service'}>\n                                  <p class={'m-0 p-0'}>{room.roomtype.name}</p>\n                                  {room.unit &&\n                                    !isSingleUnit(room.roomtype.id) &&\n                                    ((room.unit as IUnit)?.name?.length > 4 ? (\n                                      <ir-tooltip customSlot message={(room.unit as IUnit)?.name}>\n                                        <p class={'room-name-container cursor-pointer m-0'} slot=\"tooltip-trigger\">\n                                          {(room.unit as IUnit)?.name?.substring(0, 4)}\n                                        </p>\n                                      </ir-tooltip>\n                                    ) : (\n                                      <p class={'room-name-container  m-0'}>{(room.unit as IUnit)?.name?.substring(0, 4)}</p>\n                                    ))}\n                                </div>\n                              </li>\n                            ))}\n                            {booking.extra_services && <li>{locales.entries.Lcz_ExtraServices}</li>}\n                          </ul>\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.from_date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                          <p class=\"p-0 m-0 date-p\">{moment(booking.to_date, 'YYYY-MM-DD').format('DD-MMM-YYYY')}</p>\n                        </td>\n                        <td>\n                          <p class=\"p-0 m-0\" style={{ whiteSpace: 'nowrap' }}>\n                            {formatAmount(booking.currency.symbol, booking.financial?.gross_total ?? 0)}\n                          </p>\n                          <Fragment>\n                            {['003', '004'].includes(booking.status.code)\n                              ? booking.financial.cancelation_penality_as_if_today !== 0 && (\n                                  <button\n                                    onClick={() => {\n                                      this.editBookingItem = { booking, cause: 'payment' };\n                                      this.openModal();\n                                    }}\n                                    style={{ whiteSpace: 'nowrap' }}\n                                    class=\"btn p-0 m-0 due-btn\"\n                                  >\n                                    <span>{booking.financial.cancelation_penality_as_if_today < 0 ? 'Refund' : 'Charge'} </span>\n                                    {formatAmount(booking.currency.symbol, Math.abs(booking.financial.cancelation_penality_as_if_today))}\n                                  </button>\n                                )\n                              : booking.financial.due_amount !== 0 && (\n                                  <button\n                                    onClick={() => {\n                                      this.editBookingItem = { booking, cause: 'payment' };\n                                      this.openModal();\n                                    }}\n                                    style={{ whiteSpace: 'nowrap' }}\n                                    class=\"btn p-0 m-0 due-btn\"\n                                  >\n                                    {formatAmount(booking.currency.symbol, booking.financial.due_amount)}\n                                  </button>\n                                )}\n                          </Fragment>\n                        </td>\n                        {this.showCost && (\n                          <td>\n                            {booking.financial.gross_cost !== null && booking.financial.gross_cost === 0\n                              ? '_'\n                              : formatAmount(booking.currency.symbol, booking.financial.gross_cost)}\n                          </td>\n                        )}\n\n                        <td>\n                          <p class={`m-0 badge ${confirmationBG} ct_ir_badge`}>\n                            {booking.is_requested_to_cancel ? locales?.entries?.Lcz_CancellationRequested : booking.status.description}\n                          </p>\n                          {!lastManipulation && booking.events?.length > 0 && booking.events[0].type.toLowerCase() === 'modified' && (\n                            <p class=\"mx-0 p-0 small\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                              Modified\n                            </p>\n                          )}\n                          {lastManipulation && (\n                            <ir-popover\n                              trigger=\"hover\"\n                              content={`Modified by ${lastManipulation.user} at ${lastManipulation.date} ${lastManipulation.hour}:${lastManipulation.minute}`}\n                            >\n                              <p class=\"mx-0 p-0 small text-danger\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                                <b>Modified</b>\n                              </p>\n                            </ir-popover>\n                          )}\n                        </td>\n                        <td>\n                          <div class=\"d-flex justify-content-center align-items-center\" style={{ gap: '8px' }}>\n                            <ir-button title=\"Edit booking\" variant=\"icon\" icon_name=\"edit\" onClickHandler={() => (this.editBookingItem = { booking, cause: 'edit' })}></ir-button>\n                            <ir-button\n                              title=\"Delete booking\"\n                              style={{ '--icon-button-color': '#ff4961', '--icon-button-hover-color': '#FF1635' }}\n                              variant=\"icon\"\n                              icon_name=\"trash\"\n                              onClickHandler={() => {\n                                this.editBookingItem = { booking, cause: 'delete' };\n                                this.openModal();\n                              }}\n                            ></ir-button>\n                          </div>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n              {this.totalPages > 1 && (\n                <section class={'d-flex flex-column flex-md-row align-items-center justify-content-between pagination-container'}>\n                  <p class=\"m-0 mb-1 mb-md-0\">{this.renderItemRange()}</p>\n                  <div class={'d-flex align-items-center buttons-container'}>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === 1}\n                      onClickHandler={async () => {\n                        this.currentPage = 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angles_left\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === 1}\n                      onClickHandler={async () => {\n                        this.currentPage = this.currentPage - 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angle_left\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-select\n                      selectedValue={this.currentPage.toString()}\n                      showFirstOption={false}\n                      onSelectChange={async e => {\n                        this.currentPage = +e.detail;\n                        await this.updateData();\n                      }}\n                      data={Array.from(Array(this.totalPages), (_, i) => i + 1).map(i => ({\n                        text: i.toString(),\n                        value: i.toString(),\n                      }))}\n                    ></ir-select>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === this.totalPages}\n                      onClickHandler={async () => {\n                        this.currentPage = this.currentPage + 1;\n                        await this.updateData();\n                      }}\n                      icon_name=\"angle_right\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                    <ir-button\n                      size=\"sm\"\n                      btn_disabled={this.currentPage === this.totalPages}\n                      onClickHandler={async () => {\n                        this.currentPage = this.totalPages;\n                        console.log(this.currentPage);\n                        await this.updateData();\n                      }}\n                      icon_name=\"angles_right\"\n                      style={{ '--icon-size': '0.875rem' }}\n                    ></ir-button>\n                  </div>\n                </section>\n              )}\n            </div>\n          </section>\n        </div>\n        {this.editBookingItem && <ir-listing-modal paymentEntries={this.paymentEntries} onModalClosed={() => (this.editBookingItem = null)}></ir-listing-modal>}\n        <ir-sidebar\n          onIrSidebarToggle={this.handleSideBarToggle.bind(this)}\n          open={this.editBookingItem !== null && ['edit', 'guest'].includes(this.editBookingItem.cause)}\n          showCloseButton={false}\n          sidebarStyles={\n            this.editBookingItem?.cause === 'guest' ? { background: 'white' } : { width: this.editBookingItem ? '80rem' : 'var(--sidebar-width,40rem)', background: '#F2F3F8' }\n          }\n        >\n          {this.editBookingItem?.cause === 'edit' && (\n            <ir-booking-details\n              slot=\"sidebar-body\"\n              p={this.p}\n              hasPrint\n              hasReceipt\n              is_from_front_desk\n              propertyid={this.editBookingItem?.booking?.property?.id}\n              hasRoomEdit\n              hasRoomDelete\n              hasCloseButton\n              onCloseSidebar={() => (this.editBookingItem = null)}\n              bookingNumber={this.editBookingItem.booking.booking_nbr}\n              ticket={this.ticket}\n              language={this.language}\n              hasRoomAdd\n            ></ir-booking-details>\n          )}\n          {this.editBookingItem?.cause === 'guest' && (\n            <ir-guest-info\n              slot=\"sidebar-body\"\n              isInSideBar={true}\n              headerShown\n              booking_nbr={this.editBookingItem?.booking?.booking_nbr}\n              email={this.editBookingItem?.booking?.guest.email}\n              language={this.language}\n              onCloseSideBar={() => (this.editBookingItem = null)}\n            ></ir-guest-info>\n          )}\n        </ir-sidebar>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.daily-revenue__meta {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.daily-revenue__table {\n  flex: 1 1 0%;\n}\n\n/*sm*/\n@media (min-width: 768px) {\n  .daily-revenue__meta {\n    flex-direction: row;\n  }\n}\n","import Token from '@/models/Token';\nimport { BookingService } from '@/services/booking.service';\nimport { PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { DailyPaymentFilter, FolioPayment, GroupedFolioPayment, SidebarOpenEvent } from './types';\nimport { v4 } from 'uuid';\nimport moment from 'moment';\nimport { PaymentEntries } from '../ir-booking-details/types';\n\n@Component({\n  tag: 'ir-daily-revenue',\n  styleUrl: 'ir-daily-revenue.css',\n  scoped: true,\n})\nexport class IrDailyRevenue {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isPageLoading: boolean;\n  @State() property_id: number;\n  @State() groupedPayment: GroupedFolioPayment;\n  @State() previousDateGroupedPayments: GroupedFolioPayment;\n  @State() isLoading: string;\n  @State() filters: DailyPaymentFilter = { date: moment().format('YYYY-MM-DD'), users: null };\n  @State() sideBarEvent: SidebarOpenEvent | null;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private bookingService = new BookingService();\n  private paymentEntries: PaymentEntries;\n\n  @Event() preventPageLoad: EventEmitter<null>;\n\n  componentWillLoad() {\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.tokenService.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('revenueOpenSidebar')\n  handleOpenSidebar(e: CustomEvent<SidebarOpenEvent>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.sideBarEvent = e.detail;\n  }\n  @Listen('fetchNewReports')\n  handleFetchNewReports(e: CustomEvent<DailyPaymentFilter>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.filters = { ...e.detail };\n    this.getPaymentReports();\n  }\n  @Listen('resetBookingEvt')\n  async handleResetBooking(e: CustomEvent) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    this.getPaymentReports(false, true);\n  }\n\n  private handleSidebarClose = (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.sideBarEvent = null;\n  };\n\n  private renderSidebarBody() {\n    if (!this.sideBarEvent) {\n      return;\n    }\n    switch (this.sideBarEvent.type) {\n      case 'booking':\n        return (\n          <ir-booking-details\n            slot=\"sidebar-body\"\n            hasPrint\n            hasReceipt\n            hasCloseButton\n            onCloseSidebar={this.handleSidebarClose}\n            is_from_front_desk\n            propertyid={this.property_id}\n            hasRoomEdit\n            hasRoomDelete\n            bookingNumber={this.sideBarEvent.payload.bookingNumber.toString()}\n            ticket={this.ticket}\n            language={this.language}\n            hasRoomAdd\n          ></ir-booking-details>\n        );\n      default:\n        return null;\n    }\n  }\n\n  private async initializeApp() {\n    this.isPageLoading = true;\n\n    try {\n      let propertyId = this.propertyid;\n      if (!propertyId && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n\n      this.property_id = propertyId;\n\n      const requests: Promise<any>[] = [\n        this.bookingService.getSetupEntriesByTableNameMulti(['_PAY_TYPE', '_PAY_TYPE_GROUP', '_PAY_METHOD']),\n        this.getPaymentReports(),\n        this.roomService.fetchLanguage(this.language),\n      ];\n      if (propertyId) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: propertyId,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const [setupEntries] = await Promise.all(requests);\n      const { pay_type, pay_type_group, pay_method } = this.bookingService.groupEntryTablesResult(setupEntries);\n      this.paymentEntries = {\n        groups: pay_type_group,\n        methods: pay_method,\n        types: pay_type,\n      };\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n  private groupPaymentsByName(payments: FolioPayment[]): GroupedFolioPayment {\n    const groupedPayment: GroupedFolioPayment = new Map();\n\n    for (const payment of payments) {\n      const key = `${payment.payTypeCode}_${payment.payMethodCode}`;\n      const p = groupedPayment.get(key) ?? [];\n      groupedPayment.set(key, [...p, payment]);\n    }\n    return new Map(\n      [...groupedPayment.entries()].sort(([a], [b]) => {\n        const aNum = Number(a);\n        const bNum = Number(b);\n        if (!isNaN(aNum) && !isNaN(bNum)) {\n          return aNum - bNum;\n        }\n        return a.localeCompare(b);\n      }),\n    );\n  }\n\n  private async getPaymentReports(isExportToExcel = false, excludeYesterday = false) {\n    try {\n      const getReportObj = (report): FolioPayment => {\n        return {\n          method: report.METHOD,\n          payTypeCode: report.PAY_TYPE_CODE,\n          payMethodCode: report.PAY_METHOD_CODE,\n          amount: report.AMOUNT,\n          date: report.DATE,\n          hour: report.HOUR,\n          minute: report.MINUTE,\n          user: report.USER,\n          currency: report.CURRENCY,\n          bookingNbr: report.BOOKING_NBR,\n          id: v4(),\n        };\n      };\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n\n      const requests = [\n        this.propertyService.getDailyRevenueReport({\n          date: this.filters.date,\n          property_id: this.property_id?.toString(),\n          is_export_to_excel: isExportToExcel,\n        }),\n      ];\n      if (!isExportToExcel && !excludeYesterday) {\n        requests.push(\n          this.propertyService.getDailyRevenueReport({\n            date: moment(this.filters.date, 'YYYY-MM-DD').add(-1, 'days').format('YYYY-MM-DD'),\n            property_id: this.property_id?.toString(),\n            is_export_to_excel: isExportToExcel,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      if (!isExportToExcel) {\n        if (results[0]) {\n          this.groupedPayment = this.groupPaymentsByName(results[0]?.map(getReportObj));\n        } else {\n          this.groupedPayment = new Map();\n        }\n        if (results[1]) this.previousDateGroupedPayments = this.groupPaymentsByName(results[1]?.map(getReportObj));\n      }\n    } catch (e) {\n      console.log(e);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Daily Revenue</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries?.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getPaymentReports(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <ir-revenue-summary\n            previousDateGroupedPayments={this.previousDateGroupedPayments}\n            groupedPayments={this.groupedPayment}\n            paymentEntries={this.paymentEntries}\n          ></ir-revenue-summary>\n          <div class=\"daily-revenue__meta\">\n            <ir-daily-revenue-filters isLoading={this.isLoading === 'filter'} payments={this.groupedPayment}></ir-daily-revenue-filters>\n            <ir-revenue-table filters={this.filters} class={'daily-revenue__table'} paymentEntries={this.paymentEntries} payments={this.groupedPayment}></ir-revenue-table>\n          </div>\n        </section>\n        <ir-sidebar\n          sidebarStyles={{\n            width: this.sideBarEvent?.type === 'booking' ? '80rem' : 'var(--sidebar-width,40rem)',\n            background: this.sideBarEvent?.type === 'booking' ? '#F2F3F8' : 'white',\n          }}\n          open={Boolean(this.sideBarEvent)}\n          showCloseButton={false}\n          onIrSidebarToggle={this.handleSidebarClose}\n        >\n          {this.renderSidebarBody()}\n        </ir-sidebar>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  box-sizing: border-box;\n}\n:host * {\n  box-sizing: border-box;\n}\n\n@media only screen and (min-width: 900px) {\n  /* td {\n    min-width: 140px !important;\n    width: max-content !important;\n  } */\n}\n@media only screen and (max-width: 900px) {\n  /* td {\n    min-width: 100px !important;\n  } */\n  /* .table-container {\n    width: max-content !important;\n  } */\n}\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n}\n\n.tasks-view {\n  display: flex;\n  flex-direction: column;\n}\n/*lg*/\n@media (min-width: 1024px) {\n  .tasks-view {\n    flex-direction: row;\n  }\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n","import { CleanTaskEvent, IPendingActions } from '@/models/housekeeping';\nimport Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport housekeeping_store from '@/stores/housekeeping.store';\n// import { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, h, Element, Watch, Event, EventEmitter, Listen } from '@stencil/core';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { TaskFilters } from './types';\nimport { downloadFile } from '@/utils/utils';\nimport { updateTasks as updateTasksStore, updateSelectedTasks, clearSelectedTasks, hkTasksStore, setLoading } from '@/stores/hk-tasks.store';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  tag: 'ir-hk-tasks',\n  styleUrl: 'ir-hk-tasks.css',\n  scoped: true,\n})\nexport class IrHkTasks {\n  @Element() el: HTMLElement;\n\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n  @State() isCleaningLoading = false;\n  @State() selectedDuration = '';\n  @State() selectedHouseKeeper = '0';\n  @State() selectedRoom: IPendingActions | null = null;\n  @State() archiveOpened = false;\n  @State() property_id: number;\n  @State() isSidebarOpen: boolean;\n  @State() isApplyFiltersLoading: boolean;\n  @State() filters: TaskFilters;\n  @State() modalCauses: CleanTaskEvent & { cause: 'skip' | 'clean' };\n\n  @Event({ bubbles: true, composed: true }) clearSelectedHkTasks: EventEmitter<void>;\n\n  private hkNameCache: Record<number, string> = {};\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private token = new Token();\n  private table_sorting: Map<string, 'ASC' | 'DESC'> = new Map();\n  private modal: HTMLIrModalElement;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.init();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.init();\n  }\n\n  @Listen('closeSideBar')\n  handleCloseSidebar(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.isSidebarOpen = false;\n  }\n  @Listen('sortingChanged')\n  handleSortingChanged(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { field, direction } = e.detail;\n    console.log(e.detail);\n    if (field === 'date') {\n      return;\n    }\n    this.table_sorting.set(field, direction);\n  }\n  @Listen('skipSelectedTask')\n  handleSkipSelectedTask(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { task: e.detail, cause: 'skip' };\n    this.modal?.openModal();\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      setLoading(true);\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.houseKeepingService.getExposedHKSetup(this.property_id), this.roomService.fetchLanguage(this.language)];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      const tasksResult = await this.houseKeepingService.getHkTasks({\n        property_id: this.property_id,\n        from_date: moment().format('YYYY-MM-DD'),\n        to_date: moment().format('YYYY-MM-DD'),\n        housekeepers: [],\n        cleaning_frequency: (calendar_data.cleaning_frequency ?? housekeeping_store?.hk_criteria?.cleaning_frequencies[0])?.code,\n        dusty_window: housekeeping_store?.hk_criteria?.dusty_periods[0]?.code,\n        highlight_window: housekeeping_store?.hk_criteria?.highlight_checkin_options[0]?.code,\n      });\n\n      // updateTaskList();\n      if (tasksResult?.tasks) {\n        this.updateTasks(tasksResult.tasks);\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n      setLoading(false);\n    }\n  }\n\n  private buildHousekeeperNameCache() {\n    this.hkNameCache = {};\n    housekeeping_store.hk_criteria?.housekeepers?.forEach(hk => {\n      if (hk.id != null && hk.name != null) {\n        this.hkNameCache[hk.id] = hk.name;\n      }\n    });\n  }\n\n  private updateTasks(tasks: any[]) {\n    this.buildHousekeeperNameCache();\n    updateTasksStore(\n      tasks.map(t => ({\n        ...t,\n        id: v4(),\n        housekeeper: (() => {\n          const name = this.hkNameCache[t.hkm_id];\n          if (name) {\n            return name;\n          }\n          const hkName = housekeeping_store.hk_criteria?.housekeepers?.find(hk => hk.id === t.hkm_id)?.name;\n          this.hkNameCache[t.hkm_id] = hkName;\n          return hkName;\n        })(),\n      })),\n    );\n  }\n  @Listen('headerButtonPress')\n  async handleHeaderButtonPress(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { name } = e.detail;\n    switch (name) {\n      case 'cleaned':\n      case 'clean-inspect':\n        this.modal?.openModal();\n        this.modalCauses = {\n          task: null,\n          cause: 'clean',\n          status: name === 'clean-inspect' ? '004' : '001',\n        };\n        break;\n      case 'export':\n        const sortingArray: { key: string; value: string }[] = Array.from(this.table_sorting.entries()).map(([key, value]) => ({\n          key,\n          value,\n        }));\n        console.log(sortingArray);\n        const { url } = await this.fetchTasksWithFilters(true);\n        downloadFile(url);\n        break;\n      case 'archive':\n        this.isSidebarOpen = true;\n        break;\n    }\n  }\n  @Listen('cleanSelectedTask')\n  handleSelectedTaskCleaningEvent(e: CustomEvent<CleanTaskEvent>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalCauses = { ...e.detail, cause: 'clean' };\n    this.modal?.openModal();\n  }\n\n  private async handleModalConfirmation(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      if (hkTasksStore.selectedTasks.length === 0) {\n        return;\n      }\n      this.isCleaningLoading = true;\n      if (this.modalCauses?.cause === 'skip') {\n        const { booking_nbr, date, unit } = this.modalCauses.task;\n        await this.houseKeepingService.editHkSkip({\n          BOOK_NBR: booking_nbr,\n          DATE: date,\n          COMMENT: '',\n          HK_SKIP_ID: -1,\n          HK_SKIP_REASON_CODE: '001',\n          PR_ID: unit.id,\n        });\n      } else {\n        await this.houseKeepingService.executeHKAction({\n          actions: hkTasksStore.selectedTasks.map(t => ({\n            description: 'Cleaned',\n            hkm_id: t.hkm_id === 0 ? null : t.hkm_id,\n            unit_id: t.unit.id,\n            booking_nbr: t.booking_nbr,\n            status: this.modalCauses?.status ?? '001',\n          })),\n        });\n      }\n      await this.fetchTasksWithFilters();\n    } finally {\n      clearSelectedTasks();\n      if (this.modalCauses) {\n        this.modalCauses = null;\n      }\n      this.isCleaningLoading = false;\n      // this.clearSelectedTasks.emit();\n      this.modal.closeModal();\n    }\n  }\n\n  private async applyFilters(e: CustomEvent) {\n    try {\n      this.isApplyFiltersLoading = true;\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.filters = { ...e.detail };\n      await this.fetchTasksWithFilters();\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isApplyFiltersLoading = false;\n    }\n  }\n\n  private async fetchTasksWithFilters(export_to_excel: boolean = false) {\n    const { cleaning_periods, housekeepers, cleaning_frequencies, dusty_units, highlight_check_ins } = this.filters ?? {};\n\n    const { tasks, url } = await this.houseKeepingService.getHkTasks({\n      housekeepers,\n      cleaning_frequency: cleaning_frequencies?.code,\n      dusty_window: dusty_units?.code,\n      highlight_window: highlight_check_ins?.code,\n      property_id: this.property_id,\n      from_date: moment().format('YYYY-MM-DD'),\n      to_date: cleaning_periods?.code || moment().format('YYYY-MM-DD'),\n      is_export_to_excel: export_to_excel,\n    });\n    console.log(tasks);\n    if (tasks) {\n      this.updateTasks(tasks);\n    }\n    return { tasks, url };\n  }\n\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host data-testid=\"hk_tasks_base\">\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-1 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <h3>Housekeeping Tasks</h3>\n          <div class=\"tasks-view \" style={{ gap: '1rem' }}>\n            <ir-tasks-filters\n              isLoading={this.isApplyFiltersLoading}\n              onApplyFilters={e => {\n                this.applyFilters(e);\n              }}\n            ></ir-tasks-filters>\n            <div class=\"d-flex w-100 flex-column\" style={{ gap: '1rem' }}>\n              <ir-tasks-table\n                onRowSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  updateSelectedTasks(e.detail);\n                }}\n                class=\"flex-grow-1 w-100\"\n              ></ir-tasks-table>\n              {/* <ir-tasks-table-pagination></ir-tasks-table-pagination> */}\n            </div>\n          </div>\n        </section>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.modal = el)}\n          isLoading={this.isCleaningLoading}\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\n          onCancelModal={() => {\n            if (this.modalCauses) {\n              clearSelectedTasks();\n              this.modalCauses = null;\n            }\n          }}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={locales.entries.Lcz_Confirm}\n          leftBtnColor=\"secondary\"\n          rightBtnColor={'primary'}\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={\n            this.modalCauses\n              ? this.modalCauses?.cause === 'clean'\n                ? this.modalCauses.task\n                  ? `Update ${this.modalCauses?.task?.unit?.name} to Clean`\n                  : 'Update selected unit(s) to Clean'\n                : 'Skip cleaning and reschedule for tomorrow.'\n              : 'Update selected unit(s) to Clean'\n          }\n        ></ir-modal>\n        <ir-sidebar\n          open={this.isSidebarOpen}\n          id=\"editGuestInfo\"\n          onIrSidebarToggle={e => {\n            e.stopImmediatePropagation();\n            e.stopPropagation();\n            this.isSidebarOpen = false;\n          }}\n          // sidebarStyles={{\n          //   width: '80vw',\n          // }}\n          showCloseButton={false}\n        >\n          {this.isSidebarOpen && <ir-hk-archive ticket={this.token.getToken()} propertyId={this.property_id} slot=\"sidebar-body\"></ir-hk-archive>}\n        </ir-sidebar>\n        {/* <ir-title class=\"d-none d-md-flex\" label={locales.entries.Lcz_HousekeepingTasks} justifyContent=\"space-between\">\n            <ir-button slot=\"title-body\" text={locales.entries.Lcz_Archive} size=\"sm\"></ir-button>\n          </ir-title> */}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { HouseKeepingService } from '@/services/housekeeping.service';\nimport { RoomService } from '@/services/room.service';\nimport calendar_data from '@/stores/calendar-data';\nimport housekeeping_store, { updateHKStore } from '@/stores/housekeeping.store';\nimport { Component, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport locales from '@/stores/locales.store';\nimport { PropertyService } from '@/services/property.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n@Component({\n  tag: 'ir-housekeeping',\n  styleUrl: 'ir-housekeeping.css',\n  scoped: true,\n})\nexport class IrHousekeeping {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() baseUrl: string;\n\n  @State() isLoading = false;\n\n  @Event() toast: EventEmitter<IToast>;\n\n  private roomService = new RoomService();\n  private houseKeepingService = new HouseKeepingService();\n  private propertyService = new PropertyService();\n  private token = new Token();\n  modal: HTMLIrModalElement;\n  selectedCleaningFrequency: any;\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  async initializeApp() {\n    try {\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!propertyId) {\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_sales_rate_plans: true,\n        });\n        propertyId = propertyData.My_Result.id;\n      }\n      updateHKStore('default_properties', { token: this.ticket, property_id: propertyId, language: this.language });\n      const requests: Array<Promise<any>> = [];\n      if (calendar_data.housekeeping_enabled) {\n        requests.push(this.houseKeepingService.getExposedHKSetup(propertyId));\n      }\n      requests.push(this.roomService.fetchLanguage(this.language, ['_HK_FRONT', '_PMS_FRONT']));\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: propertyId,\n            language: this.language,\n            is_backend: true,\n            include_sales_rate_plans: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private async saveAutomaticCheckInCheckout(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.roomService.SetAutomaticCheckInOut({\n        property_id: housekeeping_store.default_properties.property_id,\n        flag: e.detail === 'auto',\n      });\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async saveCleaningFrequency(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    try {\n      await this.propertyService.setExposedCleaningFrequency({\n        property_id: housekeeping_store.default_properties.property_id,\n        code: this.selectedCleaningFrequency,\n      });\n      calendar_data.cleaning_frequency = { code: this.selectedCleaningFrequency, description: '' };\n      this.toast.emit({\n        position: 'top-right',\n        title: 'Saved Successfully',\n        description: '',\n        type: 'success',\n      });\n      this.modal.closeModal();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    if (this.isLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    console.log(calendar_data.cleaning_frequency);\n    return (\n      <Host>\n        <ir-interceptor></ir-interceptor>\n        <ir-toast></ir-toast>\n        <section class=\"p-1\">\n          <h3 class=\"mb-2\">{locales.entries.Lcz_HouseKeepingAndCheckInSetup}</h3>\n          <div class=\"card p-1\">\n            <ir-title borderShown label=\"Operations Settings\"></ir-title>\n            <div class={'d-flex align-items-center mb-1'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CheckInOutGuestsAutomatically}</p>\n              <ir-select\n                showFirstOption={false}\n                selectedValue={calendar_data.is_automatic_check_in_out ? 'auto' : 'manual'}\n                onSelectChange={e => this.saveAutomaticCheckInCheckout(e)}\n                data={[\n                  { text: locales.entries.Lcz_YesAsPerPropertyPolicy, value: 'auto' },\n                  { text: locales.entries.Lcz_NoIWillDoItManually, value: 'manual' },\n                ]}\n              ></ir-select>\n            </div>\n            <div class={'d-flex align-items-center'}>\n              <p class=\"my-0 py-0 mr-1\">{locales.entries.Lcz_CleaningFrequency}:</p>\n              <ir-select\n                showFirstOption={false}\n                selectedValue={this.selectedCleaningFrequency}\n                onSelectChange={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.selectedCleaningFrequency = e.detail;\n                  this.modal.openModal();\n                }}\n                data={housekeeping_store?.hk_criteria?.cleaning_frequencies.map(v => ({\n                  text: v.description,\n                  value: v.code,\n                }))}\n              ></ir-select>\n            </div>\n          </div>\n          {/*<ir-unit-status class=\"mb-1\"></ir-unit-status>*/}\n          {calendar_data.housekeeping_enabled && <ir-hk-team class=\"mb-1\"></ir-hk-team>}\n          <ir-modal\n            autoClose={false}\n            ref={el => (this.modal = el)}\n            isLoading={isRequestPending('/Set_Exposed_Cleaning_Frequency')}\n            onConfirmModal={this.saveCleaningFrequency.bind(this)}\n            iconAvailable={true}\n            onCancelModal={() => {\n              this.selectedCleaningFrequency = calendar_data.cleaning_frequency?.code;\n            }}\n            icon=\"ft-alert-triangle danger h1\"\n            leftBtnText={locales.entries.Lcz_Cancel}\n            rightBtnText={locales.entries.Lcz_Confirm}\n            leftBtnColor=\"secondary\"\n            rightBtnColor={'primary'}\n            modalTitle={locales.entries.Lcz_Confirmation}\n            modalBody={'This action will reschedule all cleaning tasks. Do you want to continue?'}\n          ></ir-modal>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { DailyReport, DailyReportFilter } from './types';\nimport moment from 'moment';\nimport locales from '@/stores/locales.store';\nimport { RoomService } from '@/services/room.service';\nimport { DailyStat, MonthlyStatsResults, PropertyService } from '@/services/property.service';\n\n@Component({\n  tag: 'ir-monthly-bookings-report',\n  styleUrl: 'ir-monthly-bookings-report.css',\n  scoped: true,\n})\nexport class IrMonthlyBookingsReport {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isPageLoading = true;\n  @State() isLoading: 'export' | 'filter' | null = null;\n\n  @State() reports: DailyReport[] = [];\n  @State() filters: DailyReportFilter;\n  @State() property_id: number;\n  @State() stats: Omit<MonthlyStatsResults, 'DailyStats'>;\n\n  private baseFilters: DailyReportFilter;\n\n  private tokenService = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n\n  componentWillLoad() {\n    this.baseFilters = {\n      date: {\n        description: moment().format('MMMM YYYY'),\n        firstOfMonth: moment().startOf('month').format('YYYY-MM-DD'),\n        lastOfMonth: moment().endOf('month').format('YYYY-MM-DD'),\n      },\n      include_previous_year: false,\n    };\n    this.filters = this.baseFilters;\n    if (this.ticket) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Watch('ticket')\n  handleTicketChange(newValue: string, oldValue: string) {\n    if (newValue !== oldValue) {\n      this.tokenService.setToken(this.ticket);\n      this.init();\n    }\n  }\n  @Listen('applyFilters')\n  handleApplyFiltersChange(e: CustomEvent<DailyReportFilter>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.filters = e.detail;\n    this.getReports();\n  }\n\n  private async init() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.roomService.fetchLanguage(this.language), this.getReports()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getReports(isExportToExcel = false) {\n    try {\n      const getReportObj = (report: DailyStat): DailyReport => {\n        return {\n          day: report.Date,\n          units_booked: report.Units_booked,\n          occupancy_percent: report.Occupancy,\n          adr: report.ADR,\n          rooms_revenue: report.Rooms_Revenue,\n          total_guests: report?.Total_Guests,\n        };\n      };\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n      const { date, include_previous_year } = this.filters;\n\n      const requests = [\n        this.propertyService.getMonthlyStats({\n          from_date: date.firstOfMonth,\n          to_date: date.lastOfMonth,\n          property_id: this.property_id,\n          is_export_to_excel: isExportToExcel,\n        }),\n      ];\n\n      if (include_previous_year) {\n        requests.push(\n          this.propertyService.getMonthlyStats({\n            from_date: moment(date.firstOfMonth, 'YYYY-MM-DD').add(-1, 'year').format('YYYY-MM-DD'),\n            to_date: moment(date.lastOfMonth, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'),\n            property_id: this.property_id,\n          }),\n        );\n      }\n\n      const results = await Promise.all(requests);\n      const currentReports = results[0];\n      let enrichedReports: DailyReport[] = [];\n      const { DailyStats, ...rest } = currentReports;\n\n      this.stats = { ...rest };\n\n      if (include_previous_year && results[isExportToExcel ? 0 : 1]) {\n        const previousYearReports = results[isExportToExcel ? 0 : 1];\n        let formattedReports = previousYearReports.DailyStats.map(getReportObj);\n        enrichedReports = DailyStats.map(getReportObj).map(current => {\n          const previous = formattedReports.find(prev => prev.day === moment(current.day, 'YYYY-MM-DD').add(-1, 'years').format('YYYY-MM-DD'));\n          return {\n            ...current,\n            last_year: previous ?? null,\n          };\n        });\n      } else {\n        enrichedReports = DailyStats.map(getReportObj);\n      }\n      this.reports = [...enrichedReports];\n    } catch (e) {\n      console.log(e);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Daily Occupancy</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries?.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getReports(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <section>\n            <div class=\"d-flex flex-column flex-md-row w-100\" style={{ gap: '1rem', alignItems: 'stretch' }}>\n              <ir-stats-card\n                icon={this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? 'arrow-trend-down' : 'arrow-trend-up'}\n                cardTitle=\"Average Occupancy\"\n                value={this.stats.AverageOccupancy ? this.stats?.AverageOccupancy.toFixed(2) + '%' : null}\n                subtitle={`${this.stats?.Occupancy_Difference_From_Previous_Month < 0 ? '' : '+'}${this.stats?.Occupancy_Difference_From_Previous_Month.toFixed(\n                  2,\n                )}% from last month`}\n              ></ir-stats-card>\n\n              <ir-stats-card\n                icon=\"hotel\"\n                cardTitle=\"Total Units\"\n                value={this.stats?.TotalUnitsBooked ? this.stats?.TotalUnitsBooked.toString() : null}\n                subtitle=\"Booked\"\n              ></ir-stats-card>\n\n              <ir-stats-card icon=\"user_group\" cardTitle=\"Total Guests\" value={this.stats?.Total_Guests?.toString()} subtitle=\"Stayed\"></ir-stats-card>\n\n              <ir-stats-card\n                icon=\"calendar\"\n                cardTitle=\"Peak Days\"\n                value={this.stats?.PeakDays.length === 0 ? null : this.stats?.PeakDays?.map(pd => moment(pd.Date, 'YYYY-MM-DD').format('D').concat('th')).join(' - ')}\n                subtitle={`${Math.max(...(this.stats.PeakDays?.map(pd => pd.OccupancyPercent) || []))}% occupancy`}\n              ></ir-stats-card>\n            </div>\n            <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n              <ir-monthly-bookings-report-filter isLoading={this.isLoading === 'filter'} class=\"filters-card\" baseFilters={this.baseFilters}></ir-monthly-bookings-report-filter>\n              <ir-monthly-bookings-report-table reports={this.reports}></ir-monthly-bookings-report-table>\n            </div>\n          </section>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport Token from '@/models/Token';\nimport { AllowedProperties, PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport moment from 'moment';\nimport { ChannelReport, ChannelReportResult, ChannelSaleFilter, SalesByChannelMode } from './types';\n@Component({\n  tag: 'ir-sales-by-channel',\n  styleUrl: 'ir-sales-by-channel.css',\n  scoped: true,\n})\nexport class IrSalesByChannel {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: string;\n  @Prop() p: string;\n  @Prop() mode!: SalesByChannelMode;\n\n  @State() isLoading: 'filter' | 'export' | null = null;\n  @State() isPageLoading = true;\n\n  @State() salesData: ChannelReportResult;\n  @State() channelSalesFilters: ChannelSaleFilter;\n  @State() allowedProperties: AllowedProperties = [];\n  @State() propertyID: number;\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n\n  private baseFilters: ChannelSaleFilter = {\n    FROM_DATE: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    TO_DATE: moment().format('YYYY-MM-DD'),\n    BOOK_CASE: '001',\n    WINDOW: 7,\n    include_previous_year: false,\n    is_export_to_excel: false,\n  };\n\n  componentWillLoad() {\n    this.channelSalesFilters = this.baseFilters;\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  private async initializeApp() {\n    try {\n      if (!this.mode) {\n        throw new Error(\"Missing required 'mode'. Please set it to either 'property' or 'mpo'.\");\n      }\n      if (!this.propertyid && this.mode === 'property' && !this.p) {\n        throw new Error('Missing Property ID or aname');\n      }\n      if (this.mode === 'property') {\n        const property = await this.propertyService.getExposedProperty({\n          id: Number(this.propertyid ?? 0),\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n        });\n        this.propertyID = property.My_Result.id;\n      }\n      const requests: Promise<unknown>[] = [, this.roomService.fetchLanguage(this.language)];\n      if (this.mode === 'mpo') {\n        requests.unshift(this.propertyService.getExposedAllowedProperties());\n        const [properties] = await Promise.all(requests);\n        this.allowedProperties = [...(properties as any)];\n      }\n\n      this.baseFilters = { ...this.baseFilters, LIST_AC_ID: this.allowedProperties?.map(p => p.id) };\n      this.channelSalesFilters = { ...this.baseFilters };\n\n      await this.getChannelSales();\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getChannelSales(isExportToExcel = false) {\n    try {\n      const { include_previous_year, LIST_AC_ID, ...filterParams } = this.channelSalesFilters;\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n      const currentSales = await this.propertyService.getChannelSales({\n        is_export_to_excel: isExportToExcel,\n        ...filterParams,\n        AC_ID: this.propertyID ? this.propertyID.toString() : undefined,\n        ...filterParams,\n        LIST_AC_ID: this.propertyID ? null : LIST_AC_ID,\n      });\n      const shouldFetchPreviousYear = !isExportToExcel && include_previous_year;\n      let enrichedSales: ChannelReportResult = [];\n      if (shouldFetchPreviousYear) {\n        const previousYearSales = await this.propertyService.getChannelSales({\n          AC_ID: this.propertyID ? this.propertyID.toString() : undefined,\n          ...filterParams,\n          LIST_AC_ID: this.propertyID ? null : LIST_AC_ID,\n          FROM_DATE: moment(filterParams.FROM_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n          TO_DATE: moment(filterParams.TO_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n        });\n\n        enrichedSales = currentSales.map(current => {\n          const previous = previousYearSales.find(prev => prev.SOURCE.toLowerCase() === current.SOURCE.toLowerCase());\n          return {\n            ...current,\n            last_year: previous ? previous : null,\n          };\n        });\n      } else {\n        enrichedSales = currentSales.map(record => ({\n          ...record,\n          last_year: null,\n        }));\n      }\n      /**\n       * Groups sales records by SOURCE and currency.id, summing numeric fields\n       * and recalculating PCT based on the total REVENUE.\n       */\n      const groupSalesRecordsBySource = (records: ChannelReportResult): ChannelReportResult => {\n        if (!records || records.length === 0) return records;\n\n        // Helper to extract currency ID from various possible formats\n        const getCurrencyId = (r: ChannelReport): string | null => {\n          return r?.currency ?? null;\n        };\n\n        // Create unique key for grouping\n        const createKey = (r: ChannelReport): string => {\n          const source = r.SOURCE.toString().toLowerCase().trim();\n          const currencyId = getCurrencyId(r);\n          return `${source}__${currencyId ?? 'null'}`;\n        };\n\n        // Sum two values safely\n        const sumValues = (a: number | undefined, b: number | undefined): number => {\n          return (a ?? 0) + (b ?? 0);\n        };\n\n        // Merge numeric fields from last_year objects\n        const mergeLastYear = (base: ChannelReport['last_year'], incoming: ChannelReport['last_year']): ChannelReport['last_year'] => {\n          if (!incoming) return base;\n          if (!base) return { ...incoming };\n\n          return {\n            NIGHTS: sumValues(base.NIGHTS, incoming.NIGHTS),\n            PCT: sumValues(base.PCT, incoming.PCT), // Will recalculate later\n            REVENUE: sumValues(base.REVENUE, incoming.REVENUE),\n            SOURCE: base.SOURCE,\n            PROPERTY_ID: base.PROPERTY_ID,\n            PROPERTY_NAME: base.PROPERTY_NAME,\n            currency: base.currency,\n          };\n        };\n\n        // Group records by key\n        const grouped = new Map<string, ChannelReport>();\n\n        for (const record of records) {\n          const key = createKey(record);\n          const existing = grouped.get(key);\n\n          if (!existing) {\n            // First record for this key - clone it\n            grouped.set(key, { ...record });\n          } else {\n            // Merge with existing record\n            const merged: ChannelReport = {\n              ...existing,\n              NIGHTS: sumValues(existing.NIGHTS, record.NIGHTS),\n              PCT: 0, // Will recalculate after summing all REVENUE\n              REVENUE: sumValues(existing.REVENUE, record.REVENUE),\n              last_year: mergeLastYear(existing.last_year, record.last_year),\n            };\n            grouped.set(key, merged);\n          }\n        }\n\n        // Convert to array\n        const result = Array.from(grouped.values());\n\n        // Recalculate PCT based on total REVENUE\n        const totalRevenue = result.reduce((sum, r) => sum + (r.REVENUE ?? 0), 0);\n\n        if (totalRevenue > 0) {\n          for (const record of result) {\n            record.PCT = (record.REVENUE / totalRevenue) * 100;\n\n            // Also recalculate last_year PCT if it exists\n            if (record.last_year) {\n              const lastYearTotal = result.reduce((sum, r) => sum + (r.last_year?.REVENUE ?? 0), 0);\n              if (lastYearTotal > 0) {\n                record.last_year.PCT = (record.last_year.REVENUE / lastYearTotal) * 100;\n              }\n            }\n          }\n        }\n\n        return result;\n      };\n\n      this.salesData = [...groupSalesRecordsBySource(enrichedSales)];\n    } catch (error) {\n      console.error('Failed to fetch sales data:', error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Sales by Channel</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getChannelSales(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          {/* <ir-sales-by-country-summary salesReports={this.salesData}></ir-sales-by-country-summary> */}\n          <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n            <ir-sales-by-channel-filters\n              isLoading={this.isLoading === 'filter'}\n              onApplyFilters={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.channelSalesFilters = { ...e.detail };\n                this.getChannelSales();\n              }}\n              allowedProperties={this.allowedProperties}\n              baseFilters={this.baseFilters}\n            ></ir-sales-by-channel-filters>\n            <ir-sales-by-channel-table mode={this.mode} allowedProperties={this.allowedProperties} class=\"card mb-0\" records={this.salesData}></ir-sales-by-channel-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import Token from '@/models/Token';\nimport { PropertyService } from '@/services/property.service';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, State, Watch, h } from '@stencil/core';\nimport { BaseSalesRecord, CountrySalesFilter, MappedCountries, SalesRecord } from './types';\nimport moment from 'moment';\nimport { v4 } from 'uuid';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry } from '@/models/IBooking';\n\n@Component({\n  tag: 'ir-sales-by-country',\n  styleUrl: 'ir-sales-by-country.css',\n  scoped: true,\n})\nexport class IrSalesByCountry {\n  @Prop() language: string = '';\n  @Prop() ticket: string = '';\n  @Prop() propertyid: number;\n  @Prop() p: string;\n\n  @State() isLoading: 'filter' | 'export' | null = null;\n  @State() isPageLoading = true;\n  @State() property_id: number;\n  @State() salesData: SalesRecord[];\n  @State() salesFilters: CountrySalesFilter;\n  @State() countries: MappedCountries = new Map();\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private propertyService = new PropertyService();\n  private bookingService = new BookingService();\n\n  private baseFilters = {\n    FROM_DATE: moment().add(-7, 'days').format('YYYY-MM-DD'),\n    TO_DATE: moment().format('YYYY-MM-DD'),\n    BOOK_CASE: '001',\n    WINDOW: 7,\n    include_previous_year: false,\n  };\n\n  componentWillLoad() {\n    this.salesFilters = this.baseFilters;\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n  private async initializeApp() {\n    try {\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.bookingService.getCountries(this.language), this.roomService.fetchLanguage(this.language), this.getCountrySales()];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      const [countries] = await Promise.all(requests);\n      const mappedCountries = new Map();\n      (countries as ICountry[]).map(country => {\n        mappedCountries.set(country.id, {\n          flag: country.flag,\n          name: country.name,\n        });\n      });\n      this.countries = mappedCountries;\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isPageLoading = false;\n    }\n  }\n\n  private async getCountrySales(isExportToExcel = false) {\n    const formatSalesData = (data): Omit<BaseSalesRecord, 'id'> => {\n      return {\n        country: data.COUNTRY,\n        country_id: data.COUNTRY_ID,\n        nights: data.NIGHTS,\n        percentage: data.PCT,\n        revenue: data.REVENUE,\n        number_of_guests: data.Total_Guests,\n      };\n    };\n    try {\n      const { include_previous_year, ...filterParams } = this.salesFilters;\n      this.isLoading = isExportToExcel ? 'export' : 'filter';\n\n      const currentSales = await this.propertyService.getCountrySales({\n        AC_ID: this.property_id,\n        is_export_to_excel: isExportToExcel,\n        ...filterParams,\n      });\n\n      const shouldFetchPreviousYear = !isExportToExcel && include_previous_year;\n\n      let enrichedSales: SalesRecord[] = [];\n\n      if (shouldFetchPreviousYear) {\n        const previousYearSales = await this.propertyService.getCountrySales({\n          AC_ID: this.property_id,\n          is_export_to_excel: false,\n          ...filterParams,\n          FROM_DATE: moment(filterParams.FROM_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n          TO_DATE: moment(filterParams.TO_DATE).subtract(1, 'year').format('YYYY-MM-DD'),\n        });\n\n        enrichedSales = currentSales.map(current => {\n          const previous = previousYearSales.find(prev => prev.COUNTRY.toLowerCase() === current.COUNTRY.toLowerCase());\n          return {\n            id: v4(),\n            ...formatSalesData(current),\n            last_year: previous ? formatSalesData(previous) : null,\n          };\n        });\n      } else {\n        enrichedSales = currentSales.map(record => ({\n          id: v4(),\n          ...formatSalesData(record),\n          last_year: null,\n        }));\n      }\n\n      // this.salesData = enrichedSales.sort((a, b) => {\n      //   if (a.country_id === 0) return -1;\n      //   if (b.country_id === 0) return 1;\n      //   return 0;\n      // });\n      this.salesData = [...enrichedSales];\n    } catch (error) {\n      console.error('Failed to fetch sales data:', error);\n    } finally {\n      this.isLoading = null;\n    }\n  }\n  render() {\n    if (this.isPageLoading) {\n      return <ir-loading-screen></ir-loading-screen>;\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">Sales by Country</h3>\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              isLoading={this.isLoading === 'export'}\n              text={locales.entries.Lcz_Export}\n              onClickHandler={async e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                await this.getCountrySales(true);\n              }}\n              btnStyle={{ height: '100%' }}\n              iconPosition=\"right\"\n              icon_name=\"file\"\n              icon_style={{ '--icon-size': '14px' }}\n            ></ir-button>\n          </div>\n          <ir-sales-by-country-summary salesReports={this.salesData}></ir-sales-by-country-summary>\n          <div class=\"d-flex flex-column flex-lg-row mt-1 \" style={{ gap: '1rem' }}>\n            <ir-sales-filters\n              isLoading={this.isLoading === 'filter'}\n              onApplyFilters={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.salesFilters = e.detail;\n                this.getCountrySales();\n              }}\n              class=\"filters-card\"\n              baseFilters={this.baseFilters}\n            ></ir-sales-filters>\n            <ir-sales-table mappedCountries={this.countries} class=\"card mb-0\" records={this.salesData}></ir-sales-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n  height: 100%;\n}\n","import Token from '@/models/Token';\nimport { User } from '@/models/Users';\nimport { BookingService } from '@/services/booking.service';\nimport { RoomService } from '@/services/room.service';\nimport { UserService } from '@/services/user.service';\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\nimport { AllowedUser } from './types';\nimport { bookingReasons } from '@/models/IBooking';\nimport { io, Socket } from 'socket.io-client';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'ir-user-management',\n  styleUrl: 'ir-user-management.css',\n  scoped: true,\n})\nexport class IrUserManagement {\n  @Prop() language: string = '';\n  @Prop() baseUrl: string;\n  @Prop() ticket: string;\n  @Prop() propertyid: number;\n  @Prop() p: string;\n  @Prop() isSuperAdmin: boolean = true;\n  @Prop() userTypeCode: string | number;\n  @Prop() baseUserTypeCode: string | number;\n  @Prop() userId: string | number;\n\n  @State() isLoading = true;\n  @State() users: User[] = [];\n  @State() property_id: number;\n  @State() allowedUsersTypes: AllowedUser[] = [];\n\n  private token = new Token();\n  private roomService = new RoomService();\n  private userService = new UserService();\n  private bookingService = new BookingService();\n\n  private userTypes: Map<number | string, string> = new Map();\n  private socket: Socket;\n\n  private superAdminId = '5';\n\n  componentWillLoad() {\n    if (this.baseUrl) {\n      this.token.setBaseUrl(this.baseUrl);\n    }\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('resetData')\n  async handleResetData(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    await this.fetchUsers();\n  }\n\n  private async initializeApp() {\n    try {\n      if (this.baseUrl) {\n        this.token.setBaseUrl(this.baseUrl);\n      }\n      this.isLoading = true;\n      let propertyId = this.propertyid;\n      if (!this.propertyid && !this.p) {\n        throw new Error('Property ID or username is required');\n      }\n      // let roomResp = null;\n      if (!propertyId) {\n        console.log(propertyId);\n        const propertyData = await this.roomService.getExposedProperty({\n          id: 0,\n          aname: this.p,\n          language: this.language,\n          is_backend: true,\n          include_units_hk_status: true,\n        });\n        // roomResp = propertyData;\n        propertyId = propertyData.My_Result.id;\n      }\n      this.property_id = propertyId;\n      const requests = [this.fetchUserTypes(), this.fetchUsers(), this.roomService.fetchLanguage(this.language, ['_USER_MGT'])];\n      if (this.propertyid) {\n        requests.push(\n          this.roomService.getExposedProperty({\n            id: this.propertyid,\n            language: this.language,\n            is_backend: true,\n            include_units_hk_status: true,\n          }),\n        );\n      }\n\n      await Promise.all(requests);\n      this.socket = io('https://realtime.igloorooms.com/');\n      this.socket.on('MSG', async msg => {\n        await this.handleSocketMessage(msg);\n      });\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private async handleSocketMessage(msg: string) {\n    const msgAsObject = JSON.parse(msg);\n    if (!msgAsObject) {\n      return;\n    }\n\n    const { REASON, KEY, PAYLOAD }: { REASON: bookingReasons; KEY: any; PAYLOAD: any } = msgAsObject;\n\n    if (KEY.toString() !== this.property_id.toString()) {\n      return;\n    }\n\n    let result = JSON.parse(PAYLOAD);\n    console.log(KEY, result);\n    // const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n    //   DORESERVATION: this.updateUserVerificationStatus,\n    // };\n    const reasonHandlers: Partial<Record<bookingReasons, Function>> = {\n      EMAIL_VERIFIED: this.updateUserVerificationStatus,\n    };\n    const handler = reasonHandlers[REASON];\n    if (handler) {\n      await handler.call(this, result);\n    } else {\n      console.warn(`Unhandled REASON: ${REASON}`);\n    }\n  }\n\n  public updateUserVerificationStatus(result: { id: string | number }) {\n    const users = [...this.users];\n    const idx = users.findIndex(u => u.id === result.id);\n    if (idx === -1) {\n      console.warn(`User ${result.id} not found`);\n      return;\n    }\n    users[idx] = {\n      ...users[idx],\n      is_email_verified: true,\n    };\n    this.users = users;\n  }\n\n  private async fetchUsers() {\n    const users = await this.userService.getExposedPropertyUsers({ property_id: this.propertyid });\n    this.users = [...users].sort((u1: User, u2: User) => {\n      const priority = (u: User) => {\n        const t = u.type.toString();\n        if (t === this.superAdminId) return 0;\n        if (t === '17') return 1;\n        return 2;\n      };\n      //sort by priority\n      const p1 = priority(u1),\n        p2 = priority(u2);\n      if (p1 !== p2) {\n        return p1 - p2;\n      }\n      // //sort by user id\n      // if (p1 === 1) {\n      //   const id1 = u1.id.toString(),\n      //     id2 = u2.id.toString(),\n      //     me = this.userId.toString();\n      //   if (id1 === me) return -1; // u1 is me → goes before u2\n      //   if (id2 === me) return 1; // u2 is me → u1 goes after\n      // }\n\n      // 3) sort by username\n      return u1.username.localeCompare(u2.username);\n    });\n  }\n  private async fetchUserTypes() {\n    const res = await Promise.all([this.bookingService.getSetupEntriesByTableName('_USER_TYPE'), this.bookingService.getLov()]);\n    const allowedUsers = res[1]?.My_Result?.allowed_user_types;\n    for (const e of res[0]) {\n      const value = e[`CODE_VALUE_${this.language?.toUpperCase() ?? 'EN'}`];\n      if (allowedUsers.find(f => f.code === e.CODE_NAME)) {\n        this.allowedUsersTypes.push({ code: e.CODE_NAME, value });\n      }\n      this.userTypes.set(e.CODE_NAME.toString(), value);\n    }\n  }\n  disconnectedCallback() {\n    this.socket.disconnect();\n  }\n  render() {\n    if (this.isLoading) {\n      return (\n        <Host>\n          <ir-toast></ir-toast>\n          <ir-interceptor></ir-interceptor>\n          <ir-loading-screen></ir-loading-screen>\n        </Host>\n      );\n    }\n    return (\n      <Host>\n        <ir-toast></ir-toast>\n        <ir-interceptor suppressToastEndpoints={['/Change_User_Pwd', '/Handle_Exposed_User']}></ir-interceptor>\n        <section class=\"p-2 d-flex flex-column\" style={{ gap: '1rem' }}>\n          <div class=\"d-flex  pb-2 align-items-center justify-content-between\">\n            <h3 class=\"mb-1 mb-md-0\">{locales.entries.Lcz_ExtranetUsers}</h3>\n          </div>\n\n          <div class=\"\" style={{ gap: '1rem' }}>\n            <ir-user-management-table\n              property_id={this.property_id}\n              baseUserTypeCode={this.baseUserTypeCode}\n              allowedUsersTypes={this.allowedUsersTypes}\n              userTypeCode={this.userTypeCode}\n              haveAdminPrivileges={[this.superAdminId, '17'].includes(this.userTypeCode?.toString())}\n              userTypes={this.userTypes}\n              class=\"card\"\n              isSuperAdmin={this.userTypeCode?.toString() === this.superAdminId}\n              users={this.users}\n            ></ir-user-management-table>\n          </div>\n        </section>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}