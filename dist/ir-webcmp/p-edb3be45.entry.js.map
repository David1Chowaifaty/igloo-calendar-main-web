{"version":3,"names":["IglBookPropertyService","setBookingInfoFromAutoComplete","context","res","bookedByInfoData","id","guest","email","firstName","first_name","lastName","last_name","countryId","country_id","isdCode","_b","_a","country_phone_prefix","_c","toString","contactNumber","mobile","selectedArrivalTime","arrival","emailGuest","subscribe_to_news_letter","message","remark","cardNumber","cardHolderName","expiryMonth","expiryYear","bookingNumber","booking_nbr","rooms","from_date","to_date","resetRoomsInfoAndMessage","defaultData","roomsInfo","onDataRoomUpdate","event","selectedUnits","isEdit","isEditBooking","name","units","data","key","changedKey","detail","roomCategoryKey","roomCategoryId","ratePlanKey","ratePlanId","this","shouldClearData","Map","initializeRoomCategoryIfNeeded","has","get","applyBookingEditToSelectedRoom","setSelectedRoomData","cleanupEmptyData","set","selectedRatePlans","totalRooms","inventory","delete","Object","assign","Array","fill","size","clear","guestName","roomId","calculateAmount","is_amount_modified","selected_variation","view_mode","rp_amount","total_days","nights","length","generateDailyRates","rate_plan","i","variation","amount","infant_nbr","variationService","VariationService","getVariationBasedOnInfants","variations","ratePlan","baseVariation","infants","map","n","date","night","discounted_amount","cost","getBookedRooms","check_in","check_out","notes","identifier","override_unit","unit","auto_check_in","roomTypeId","booking_store","ratePlanSelections","roomtype","rateplanId","rateplan","reserved","push","prepayment_amount_gross","occupancy","adult_nbr","children_nbr","Number","child_nbr","Math","max","bed_preference","moment","format","days","city","address","dob","cci","prepareBookUserServiceParams","sourceOption","dateRangeData","Error","fromDate","Date","toDate","generateNewRooms","isEventType","bookingData","PR_ID","modifyBookingDetails","pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras","rest","__rest","assign_units","is_pms","is_backend","booking","newBooking","event_type","currentRoomType","filteredRooms","filter","r","console","log","newRooms","in_out","code","ROOMS","previousRooms","isAgent","type","agent","tag","property","propertyid","booked_on","hour","getHours","minute","getMinutes","source","currency","nbr","holder_name","expiry_month","expiry_year","error","getRoomCategoryByRoomId","find","roomCategory","RATE_TYPE","setEditingRoomInfo","category","room_id","RATE_PLAN_ID","adultCount","ADULTS_COUNT","rate","RATE","rateType","roomCategoryName","ratePlanName","RATE_PLAN","NAME","cancelation","guarantee","adult_child_offering","iglBookPropertyCss","IglBookPropertyStyle0","sheetCss","IglBookPropertyStyle1","IglBookProperty","constructor","hostRef","showPaymentDetails","adultChildCount","adult","child","renderAgain","bookingHistory","initialRoomIds","showSplitBookingOption","sourceOptions","guestData","blockDatesData","ratePricingMode","bedPreferenceType","bookingService","BookingService","bookPropertyService","updatedBooking","MAX_HISTORY_LENGTH","componentWillLoad","roomTypes","modifyBookingStore","handleKeyDown","bind","initializeDefaultDateRange","defaultDateRange","initializeDefaultData","wasBlockedUnit","hasOwnProperty","fetchSetupEntriesAndInitialize","componentDidLoad","document","addEventListener","handleBodyOverflow","disconnectedCallback","removeEventListener","clearBooking","e","stopImmediatePropagation","stopPropagation","renderPage","handleSpiltBookingSelected","getExposedBooking","language","handleAdultChildChange","updateBookingHistory","adults","children","onDateRangeSelect","opt","dates","checkIn","checkOut","checkBookingAvailability","handleSourceDropDown","value","selectedSource","description","gotoSplitPageTwo","gotoPage","handleButtonClicked","bookUser","closeWindow","resetReserved","animateIrSelect","emit","calculateTotalRooms","animateIrButton","toast","locales","entries","Lcz_SelectRatePlan","title","partialData","lastEntry","newEntry","_d","_f","_e","_h","_g","shift","FROM_DATE","TO_DATE","setupEntries","fetchSetupEntries","setSourceOptions","allowedBookingSources","setOtherProperties","initializeEventData","initializeEditBookingData","initializePage","CHILDREN_COUNT","roomName","GUEST","page","isGuestDataIncomplete","roomtypeId","isButtonDisabled","isValidProperty","comparedBy","undefined","bookingSource","_sourceOptions","getFilteredSourceOptions","SOURCE","option","o","agentIds","Set","hasAgentOnlyRoomType","some","rt","rps","rateplans","isForAgentOnly","every","rp","agents","forEach","ag","add","candidate","matchesId","arrivalTime","resetBookingStore","is_in_agent_mode","room_type_ids_to_update","room_type_ids","room","getBookingAvailability","agent_id","updateBooking","roomtype_id","reserveRooms","checkAndBlockDate","block_exposed_unit_props","isAvailable","is_available_to_book","handleBlockDate","didReservation","el","querySelector","classList","setTimeout","closeBookingWindow","handleBlockDateUpdate","handleGuestInfoUpdate","guestRefKey","handleBookedByInfoUpdate","getPageBlockDatesView","h","Fragment","entryDate","ENTRY_DATE","onDataUpdateEvent","handlePageTwoDataUpdateEvent","auto_close","props","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","dateToFormattedString","NOTES","OPTIONAL_REASON","pr_id","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","blockUnit","setLoadingState","isLoading","serviceParams","doReservation","adjustBlockedDatesAfterReservation","resetBookingEvt","resetLoadingState","original_from_date","current_from_date","original_to_date","current_to_date","isBefore","isAfter","getCurrentPage","render","Host","class","onClick","isRequestPending","BLOCK_DATES_TITLE","TITLE","onIconClickHandler","slot","xmlns","viewBox","height","width","d","defaultDaterange","eventType","selectedRooms","adultChildConstraints","propertyId","selectedGuestData","countries","defaultGuestData","isEditOrAddRoomEvent","text","Lcz_Cancel","btn_color","Lcz_Blockdates","iglBookPropertyFooterCss","IglBookPropertyFooterStyle0","IglBookPropertyFooter","disabled","editNext","label","renderButton","icon_name","icon_position","shouldRenderTwoButtons","btn_disabled","onClickHandler","buttonClicked","btn_styles","iconPosition","style","icon_style","paddingBottom","Lcz_Next","showBookAndCheckin","calendar_data","checkin_enabled","isSame","Lcz_Back","Lcz_Save","Lcz_Book","Lcz_BookAndChekcIn","iglBookingFormCss","IglBookingFormStyle0","IglBookingForm","initializeGuestData","selectedBookedByData","total","newSelectedUnits","getRate","totalNights","isRateModified","preference","dateDifference","TOTAL_PRICE","handleOnApplicationInfoDataUpdateEvent","index","categoryIdKey","updatedUnits","dataUpdateEvent","handleEventData","dateOption","Lcz_TotalPrice","formatAmount","symbol","values","val","_","guestInfo","bookingType","rateplanSelection","roomIndex","baseData","iglBookingOverviewPageCss","IglBookingOverviewPageStyle0","IglBookingOverviewPage","getSplitBookings","splitBookingEvents","setMinDate","today","minDate","splitBookingId","bookingDataDefaultDateRange","splitBookings","roomType","isBookDisabled","keys","roomInfoId","evt","roomsDataUpdate","irBookingDetailsCss","IrBookingDetailsStyle0","IrBookingDetails","ticket","is_from_front_desk","hasPrint","hasReceipt","hasDelete","hasMenu","hasRoomEdit","hasRoomDelete","hasRoomAdd","hasCheckIn","hasCheckOut","hasCloseButton","bookingItem","statusData","calendarData","rerenderFlag","sidebarState","isUpdateClicked","isPMSLogLoading","modalState","roomService","RoomService","paymentService","PaymentService","token","Token","printingBaseUrl","setToken","initializeApp","ticketChanged","newValue","oldValue","handleSideBarEvents","sidebarPayload","payload","handleIconClick","target","closeSidebar","Lcz_EmailBookingto","replace","loading","modalRef","openModal","openPrintingScreen","window","location","href","ID","EMAIL","PHONE","REFERENCE_TYPE","ARRIVAL","Lcz_AddingUnitToBooking","fromDateStr","toDateStr","BOOKING_NUMBER","ADD_ROOM_TO_BOOKING","handleResetExposedCancellationDueAmount","paymentActions","GetExposedCancellationDueAmount","currency_id","handleEditInitiated","handleRoomGuestsUpdate","guests","currentRoomIndex","findIndex","currentRoom","updatedRoom","sharing_persons","handleResetBooking","resetBooking","handleEditExtraService","selectedService","setRoomsData","roomServiceResp","roomsData","My_Result","roomtypes","expanded","roomResponse","languageTexts","countriesList","bookingDetails","Promise","all","getExposedProperty","aname","p","fetchLanguage","getCountries","getSetupEntriesByTableNameMulti","property_id","bed_preference_type","departure_time","pay_type","pay_type_group","groupEntryTablesResult","bedPreference","departureTime","paymentTypes","paymentTypesGroups","then","direction","myResult","allowed_payment_methods","paymentMethods","allowed_booking_sources","adult_child_constraints","calendar_legends","legendData","paymentCodesToShow","method","includes","warn","mode","version","open","system_id","url","axios","post","ExceptionMsg","handleCloseBookingWindow","handleDeleteFinish","bookingChanged","handleModalConfirm","sendBookingConfirmationEmail","closeModal","renderSidebarContent","handleClose","isInSideBar","headerShown","onCloseSideBar","bookingDates","from","to","defaultPickupData","numberOfPersons","onCloseModal","service","totalGuests","sharedPersons","checkin","payment","hasEmail","status","is_editable","variant","showCheckin","handleRoomCheckin","showCheckout","handleRoomCheckout","bedPreferences","isEditable","myRoomTypeFoodCat","mealCodeName","short_name","bookingIndex","onDeleteFinished","Lcz_ExtraServices","modalBody","leftBtnText","rightBtnText","Lcz_Confirm","autoClose","ref","onConfirmModal","onCancelModal","side","onIrSidebarToggle","showCloseButton","onCloseBookingWindow","is_automatic_check_in_out","isSameOrAfter","irBookingExtraNoteCss","IrBookingExtraNoteStyle0","IrBookingExtraNoteStyle1","IrBookingExtraNote","note","setNote","getPrivateNote","savePrivateNote","prevExtras","newExtraObj","oldPrivateNoteIndex","Is_Non_Technical_Change","onSubmit","preventDefault","Lcz_PrivateNote","displayContext","placeholder","Lcz_PrivateNote_MaxChar","maxLength","onTextChange","btn_type","irBookingGuaranteeCss","IrBookingGuaranteeStyle0","IrBookingGuarantee","collapsed","paymentDetailsUrl","paymentExceptionMessage","formatCurrency","locale","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","checkPaymentCode","pm","getPaymentMethod","paymentMethod","payment_code","Lcz_OnCredit","handleToggleCollapse","channel_booking_nbr","getPCICardInfoURL","shouldShowGuarantee","Boolean","shouldShowToggleButton","renderCreditCardInfo","cvc","renderCollapsedContent","src","frameborder","renderOtaGuarantee","ota_guarante","content","card_type","is_virtual","labelText","Lcz_CardType","cardholder_name","Lcz_CardHolderName","card_number","Lcz_CardNumber","toFloat","meta","virtual_card_current_balance","virtual_card_decimal_places","virtual_card_currency_code","Lcz_CardBalance","Lcz_BookingGuarantee","irBookingHeaderCss","IrBookingHeaderStyle0","IrBookingHeader","bookingStatus","confirmationBG","alertMessage","handleSelectChange","selectedValue","updateStatus","Lcz_SelectStatus","position","changeExposedBookingStatus","book_nbr","Lcz_StatusUpdatedSuccessfully","openDialog","currentDialogStatus","dialogRef","renderDialogBody","lastManipulation","ota_manipulations","Lcz_Booking","gap","flexWrap","is_requested_to_cancel","Lcz_CancellationRequested","trigger","renderContentAsHtml","user","marginTop","marginBottom","allowed_actions","selectContainerStyle","selectStyles","firstOption","Lcz_Select","b","textSize","modalEl","Lcz_EventsLog","is_pms_enabled","Lcz_pms","colorVariants","danger","onOpenChange","modalTitle","Lcz_OTA_Modification_Alter","irDialogCss","IrDialogStyle0","IrDialog","isOpen","prepareFocusTrap","body","overflow","openChange","handleOpenChange","ev","isTabPressed","shiftKey","activeElement","lastFocusableElement","firstFocusableElement","focus","focusableElements","focusableContent","shadowRoot","querySelectorAll","tabIndex","role","irDropdownCss","IrDropdownStyle0","IrDropdown","focusedIndex","itemChildren","mo","isComponentConnected","updateQueued","handleDocumentClick","contains","closeDropdown","maxIndex","openDropdown","focusItemElement","selectItemElement","selectedOption","documentClickHandler","collectItemChildren","MutationObserver","requestAnimationFrame","observe","childList","subtree","passive","updateItemElements","updateDropdownItemValue","disconnect","handleDocumentKeyDown","handleDropdownItemSelect","selectOption","setAttribute","handleDropdownItemRegister","handleDropdownItemUnregister","handleValueChange","removeAttribute","getSelectedItemIndex","item","scrollToSelectedItem","removeItemFocus","items","String","element","remove","scrollIntoView","block","behavior","click","selectedElement","inline","optionChange","onKeyDown","tabindex","irDropdownItemCss","IrDropdownItemStyle0","IrDropdownItem","hasRegistered","hidden","handleClick","dropdownItemSelect","dropdownItemRegister","parentElement","parentDropdown","closest","dropdownItemUnregister","matchesQuery","query","q","toLowerCase","hay","textContent","setHidden","next","html_content","innerHTML","irEventsLogCss","IrEventsLogStyle0","IrEventsLog","init","bookingEvents","events","opacity","padStart","second","irExtraServiceCss","IrExtraServiceStyle0","IrExtraService","deleteService","doBookingExtraService","is_remove","price","currencySymbol","booking_system_id","secondary","editExtraService","irModalRef","start_date","end_date","showDateDifference","iconAvailable","icon","Lcz_Delete","leftBtnColor","rightBtnColor","Lcz_Confirmation","Lcz_ThisService","Lcz_FromThisBooking","ZIdInfo","z","object","union","string","min","literal","optional","number","nullable","ZSharedPerson","coerce","refine","isValid","transform","isDDMMYYYY","id_info","is_main","boolean","default","validateSharedPerson","parse","hasValue","field","trim","ctx","path","ZodIssueCode","custom","hasAnyFieldData","ZodError","ExtraServiceSchema","irExtraServiceConfigCss","IrExtraServiceConfigStyle0","IrExtraServiceConfigStyle1","IrExtraServiceConfig","s_service","saveAmenity","updateService","params","prevService","validatePrice","priceSchema","pick","result","safeParse","success","async","Lcz_Description","onChange","Lcz_DatesOn","emitEmptyDate","maxDate","onDateChanged","start","_formatDate","borderLeftWidth","borderRightWidth","borderRadius","Lcz_TillAndIncluding","_j","_k","_m","_l","zod","Lcz_Price","wrapKey","autoValidate","parseFloat","Lcz_Cost","labelStyle","_p","_o","irExtraServicesCss","IrExtraServicesStyle0","IrExtraServices","irGuestInfoCss","IrGuestInfoStyle0","IrGuestInfoStyle1","GuestInfo","getToken","fetchedLocales","fetchGuest","resolve","mobile_without_prefix","handleInputChange","editGuest","editExposedGuest","closeSideBar","Lcz_GuestDetails","Lcz_FirstName","required","Lcz_LastName","Lcz_Email","Lcz_AlternativeEmail","alternative_email","country","c","Lcz_Country","onCountryChange","phone_prefix","Lcz_MobilePhone","checked","onInput","Lcz_Newsletter","color","irPaymentActionCss","IrPaymentActionStyle0","IrPaymentAction","paymentActionType","paymentAction","isFutureAction","due_on","generatePayment","irPaymentActionsCss","IrPaymentActionsStyle0","IrPaymentActions","pa","irPaymentDetailsCss","IrPaymentDetailsStyle0","IrPaymentDetails","confirmModal","toBeDeletedItem","modalMode","handleAddPayment","openSidebar","designation","reference","handleEditPayment","handleDeletePayment","handleConfirmModal","cancelPayment","handleCancelModal","handlePaymentGeneration","paymentType","CODE_NAME","pay_type_code","payment_type","CODE_VALUE_EN","operation","CancelPayment","newPaymentArray","financial","payments","resetExposedCancellationDueAmount","modal","hasValidFinancialData","shouldShowPaymentActions","totalCost","gross_cost","balance","due_amount","collected","onAddPayment","onEditPayment","onDeletePayment","Lcz_IfDeletedPermantlyLost","Lcz_EnteringAmountGreaterThanDue","irPaymentFolioCss","IrPaymentFolioStyle0","IrPaymentFolioStyle1","IrPaymentFolio","_paymentTypes","folioSchema","regex","dateStr","a","folioData","getPaymentTypes","handlePaymentChange","handlePaymentTypesChange","updateFolioData","savePayment","errors","AddPayment","err","issues","handleDropdownChange","pt","rec","buildPaymentTypes","PAYMENTS","CANCELLATION","renderDropdownItems","idx","border","borderTopLeftRadius","borderBottomLeftRadius","containerClassname","labelContainerClassname","minValue","onOptionChange","_q","_r","_s","_t","_u","_v","_w","reference_number","inputContainerStyle","margin","labelWidth","irPaymentItemCss","IrPaymentItemStyle0","IrPaymentItem","isCredit","part","editPayment","deletePayment","irPaymentSummaryCss","IrPaymentSummaryStyle0","IrPaymentSummary","shouldShowTotalCost","Lcz_TotalCost","Lcz_Balance","Lcz_Collected","irPaymentsFolioCss","IrPaymentsFolioStyle0","IrPaymentsFolio","addPayment","hasPayments","renderPaymentItem","renderEmptyState","PickupService","savePickup","splitTime","arrival_time","split","arrival_date","details","flight_details","nbr_of_units","number_of_vehicles","selected_option","due_upon_booking","transformDefaultPickupData","renderTime","toFixed","vehicle_type_code","vehicle","getAvailableLocations","locations","pickup_service","allowed_options","createPickupSchema","isBetween","time","hours","minutes","nonempty","validateForm","schema","getNumberOfVehicles","capacity","total_number_of_vehicles","ceil","startNumber","bonus_number","getPickUpPersonStatus","getCodeDescription","allowed_pricing_models","model","updateDue","irPickupCss","IrPickupStyle0","IrPickupStyle1","IrPickup","allowedOptionsByLocation","pickupData","vehicleCapacity","cause","pickupService","arrival_time_mask","mask","blocks","HH","MaskedRange","placeholderChar","mm","lazy","transformedData","pickupSchema","handleLocationChange","updatePickupData","locationChoice","pricing_model","handleVehicleQuantityChange","handleVehicleTypeChange","Lcz_Pickup","testId","onSelectChange","Lcz_Pickup_NoThankYou","Lcz_Pickup_YesFrom","Lcz_ArrivalDate","Lcz_Time","inputStyles","Lcz_FlightDetails","showFirstOption","labelBorder","Lcz_NbrOfVehicles","readOnly","Lcz_DueUponBooking","irPickupViewCss","IrPickupViewStyle0","IrPickupView","is_enabled","Lcz_Date","_formatTime","pickup_instruction","pickup_cancelation_prepayment","irPmsLogsCss","IrPmsLogsStyle0","IrPmsLogs","pmsLogs","fetchPMSLogs","Lcz_PMS_Logs","Lcz_SentAt","sent_date","sent_hour","sent_minute","is_acknowledged","Lcz_YES","Lcz_NO","Lcz_Acknowledged","irPopoverCss","IrPopoverStyle0","IrPopover","irPopoverLeft","placement","initialized","initializePopover","$","popoverTrigger","popover","html","whiteSpace","textOverflow","cursor","irReservationInformationCss","IrReservationInformationStyle0","IrReservationInformation","userCountry","guestCountryId","handleEditClick","renderPhoneNumber","selectedCountry","privateNote","Lcz_Source","origin","Label","image","Icon","alt","Lcz_BookedOn","Lcz_BookedBy","nbr_confirmed_bookings","Lcz_BookingsNbr","customSlot","Lcz_Phone","Lcz_Address","isCountryImage","flag","display","Lcz_GuestPrivateNote","Lcz_ArrivalTime","Lcz_Coupon","Lcz_LoyaltyDiscountApplied","Lcz_GuestRemark","Lcz_ChannelNotes","remarks","ota_notes","maxVisibleItems","Lcz_BookingPrivateNote","Lcz_VisibleToHotelOnly","irRoomCss","IrRoomStyle0","IrRoom","modalReason","isModelOpen","mainGuest","getMainGuest","pressCheckIn","pressCheckOut","handleRoomDataChange","getDateStr","getDate","toLocaleString","month","getFullYear","editInitiated","formatName","Lcz_EditBookingFor","ARRIVAL_TIME","COUNTRY","FROM_DATE_STR","IDENTIFIER","IS_EDITABLE","NO_OF_DAYS","POOL","SPLIT_BOOKING","STATUS","TO_DATE_STR","PICKUP_INFO","reason","handleModalConfirmation","deleteRoom","handleExposedRoomInOut","room_identifier","resetbooking","oldRooms","deleteFinished","updateDepartureTime","setDepartureTime","formatVariation","childCount","infantCount","adultLabel","Lcz_Adults","Lcz_Adult","childLabel","Lcz_Children","Lcz_Child","infantLabel","Lcz_Infants","Lcz_Infant","parts","join","getSmokingLabel","smoking_option","currRT","allowed_smoking_options","s","ota_meta","smoking_preferences","getBedName","bed","bed_preferences","renderModalMessage","handleCheckIn","showGuestModal","fontWeight","is_non_refundable","Lcz_NonRefundable","isSingleUnit","is_frontdesk_enabled","Lcz_CheckIn","Lcz_CheckOut","btnStyle","padding","fontSize","textAlign","lineHeight","toUpperCase","Lcz_Breakdown","_getDay","Lcz_SubTotal","filtered_data","taxes","tx","pct","is_exlusive","Lcz_Excluding","Lcz_Including","ota_taxes","Lcz_SmokingOptions","Lcz_Cancellation","Lcz_Guarantee","Lcz_MealPlan","meal_plan","Lcz_Policies","policies","defaultGuest","full_name","password","dateMask","pattern","str","autofix","YYYY","MM","DD","irRoomGuestsCss","IrRoomGuestsStyle0","IrRoomGuestsStyle1","IrRoomGuests","idTypes","initializeGuests","getUserDefaultCountry","getSetupEntriesByTableName","propertyCountry","COUNTRY_ID","defaultGuestsCount","g","updateGuestInfo","tempGuests","tempGuest","saveGuests","handleExposedRoomGuests","updateRoomGuests","minWidth","Lcz_MainGuest","Lcz_DOB","Lcz_Nationality","Lcz_Documents","isRowValid","Lcz_PersonsSharingRoom","selectForcedStyles","borderTopRightRadius","borderBottomRightRadius","borderRight","t","inputForcedStyle","otaLabelCss","OtaLabelStyle0","OtaLabel","showAll","toggleShowAll","displayedRemarks","slice","v4","statement","Lcz_ShowLess","Lcz_ShowMore"],"sources":["src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts","src/components/igloo-calendar/igl-book-property/igl-book-property.css?tag=igl-book-property&encapsulation=scoped","src/common/sheet.css?tag=igl-book-property&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property.tsx","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.css?tag=igl-book-property-footer&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property-footer/igl-book-property-footer.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.css?tag=igl-booking-form&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-form/igl-booking-form.tsx","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.css?tag=igl-booking-overview-page&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-booking-overview-page/igl-booking-overview-page.tsx","src/components/ir-booking-details/ir-booking-details.css?tag=ir-booking-details&encapsulation=scoped","src/components/ir-booking-details/ir-booking-details.tsx","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.css?tag=ir-booking-extra-note&encapsulation=scoped","src/common/sheet.css?tag=ir-booking-extra-note&encapsulation=scoped","src/components/ir-booking-details/ir-booking-extra-note/ir-booking-extra-note.tsx","src/components/ir-booking-details/ir-payment-details/ir-booking-guarantee/ir-booking-guarantee.css?tag=ir-booking-guarantee&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-booking-guarantee/ir-booking-guarantee.tsx","src/components/ir-booking-details/ir-booking-header/ir-booking-header.css?tag=ir-booking-header&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-booking-header.tsx","src/components/ui/ir-dialog/ir-dialog.css?tag=ir-dialog&encapsulation=shadow","src/components/ui/ir-dialog/ir-dialog.tsx","src/components/ui/ir-dropdown/ir-dropdown.css?tag=ir-dropdown&encapsulation=scoped","src/components/ui/ir-dropdown/ir-dropdown.tsx","src/components/ui/ir-dropdown-item/ir-dropdown-item.css?tag=ir-dropdown-item&encapsulation=scoped","src/components/ui/ir-dropdown-item/ir-dropdown-item.tsx","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.css?tag=ir-events-log&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/events-log/ir-events-log.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.css?tag=ir-extra-service&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service/ir-extra-service.tsx","src/models/booking.dto.ts","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.css?tag=ir-extra-service-config&encapsulation=scoped","src/common/sheet.css?tag=ir-extra-service-config&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-service-config/ir-extra-service-config.tsx","src/components/ir-booking-details/ir-extra-services/ir-extra-services.css?tag=ir-extra-services&encapsulation=scoped","src/components/ir-booking-details/ir-extra-services/ir-extra-services.tsx","src/components/ir-guest-info/ir-guest-info.css?tag=ir-guest-info&encapsulation=scoped","src/common/sheet.css?tag=ir-guest-info&encapsulation=scoped","src/components/ir-guest-info/ir-guest-info.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-action/ir-payment-action.css?tag=ir-payment-action&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-action/ir-payment-action.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-actions.css?tag=ir-payment-actions&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-actions/ir-payment-actions.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-details.css?tag=ir-payment-details&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-details.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-folio/ir-payment-folio.css?tag=ir-payment-folio&encapsulation=scoped","src/common/sheet.css?tag=ir-payment-folio&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-folio/ir-payment-folio.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-item/ir-payment-item.css?tag=ir-payment-item&encapsulation=shadow","src/components/ir-booking-details/ir-payment-details/ir-payment-item/ir-payment-item.tsx","src/components/ir-booking-details/ir-payment-details/ir-payment-summary/ir-payment-summary.css?tag=ir-payment-summary&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payment-summary/ir-payment-summary.tsx","src/components/ir-booking-details/ir-payment-details/ir-payments-folio/ir-payments-folio.css?tag=ir-payments-folio&encapsulation=scoped","src/components/ir-booking-details/ir-payment-details/ir-payments-folio/ir-payments-folio.tsx","src/components/ir-booking-details/ir-pickup/pickup.service.ts","src/components/ir-booking-details/ir-pickup/ir-pickup.css?tag=ir-pickup&encapsulation=scoped","src/common/sheet.css?tag=ir-pickup&encapsulation=scoped","src/components/ir-booking-details/ir-pickup/ir-pickup.tsx","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.css?tag=ir-pickup-view&encapsulation=scoped","src/components/ir-booking-details/ir-pickup-view/ir-pickup-view.tsx","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.css?tag=ir-pms-logs&encapsulation=scoped","src/components/ir-booking-details/ir-booking-header/ir-pms-logs/ir-pms-logs.tsx","src/components/ui/ir-popover/ir-popover.css?tag=ir-popover","src/components/ui/ir-popover/ir-popover.tsx","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.css?tag=ir-reservation-information&encapsulation=scoped","src/components/ir-booking-details/ir-reservation-information/ir-reservation-information.tsx","src/components/ir-booking-details/ir-room/ir-room.css?tag=ir-room&encapsulation=scoped","src/components/ir-booking-details/ir-room/ir-room.tsx","src/components/ir-booking-details/ir-room-guests/data.ts","src/components/ir-booking-details/ir-room-guests/ir-room-guests.css?tag=ir-room-guests&encapsulation=scoped","src/common/sheet.css?tag=ir-room-guests&encapsulation=scoped","src/components/ir-booking-details/ir-room-guests/ir-room-guests.tsx","src/components/ui/ota-label/ota-label.css?tag=ota-label&encapsulation=scoped","src/components/ui/ota-label/ota-label.tsx"],"sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport { TSourceOption } from '@/models/igl-book-property';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class IglBookPropertyService {\n  private variationService: VariationService;\n  public setBookingInfoFromAutoComplete(context, res) {\n    context.bookedByInfoData = {\n      id: res.guest.id,\n      email: res.guest.email,\n      firstName: res.guest.first_name,\n      lastName: res.guest.last_name,\n      countryId: res.guest.country_id,\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\n      contactNumber: res.guest.mobile,\n      selectedArrivalTime: res.arrival,\n      emailGuest: res.guest.subscribe_to_news_letter,\n      message: res.remark,\n      cardNumber: '',\n      cardHolderName: '',\n      expiryMonth: '',\n      expiryYear: '',\n      bookingNumber: res.booking_nbr,\n      rooms: res.rooms,\n      from_date: res.from_date,\n      to_date: res.to_date,\n    };\n  }\n\n  public resetRoomsInfoAndMessage(context) {\n    context.defaultData.roomsInfo = [];\n    context.message = '';\n  }\n\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\n    let units = selectedUnits;\n    const { data, key, changedKey } = event.detail;\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\n    const ratePlanKey = `p_${data.ratePlanId}`;\n\n    if (this.shouldClearData(key)) {\n      units = new Map();\n    }\n\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\n\n    if (isEditBooking) {\n      if (changedKey === 'rate') {\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n        }\n      } else {\n        if (changedKey !== 'rateType') {\n          if (changedKey === 'adult_child_offering') {\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n            }\n          } else {\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n          }\n        }\n      }\n    } else {\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\n    }\n    this.cleanupEmptyData(roomCategoryKey, units);\n    return units;\n  }\n\n  private shouldClearData(key: string | undefined): boolean {\n    return key === 'clearData' || key === 'EDIT_BOOKING';\n  }\n\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (!selectedUnits.has(roomCategoryKey)) {\n      selectedUnits.set(roomCategoryKey, new Map());\n    }\n  }\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n    if (data.totalRooms === 0 || data.inventory === 0) {\n      selectedRatePlans.delete(ratePlanKey);\n    } else {\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\n    }\n  }\n\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (selectedUnits.has(roomCategoryKey)) {\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n      if (selectedRatePlans.size === 0) {\n        selectedUnits.delete(roomCategoryKey);\n      }\n    }\n  }\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\n    selectedUnits.clear();\n    let res = {};\n    if (isEdit) {\n      res = { ...data, guestName: name || '', roomId: '' };\n    } else {\n      res = { ...data };\n    }\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\n  }\n\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  // private extractFirstNameAndLastName(name: string) {\n  //   const names = name.split(' ');\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\n  // }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Date;\n    check_out: Date;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: Number(rateplan.selected_variation.child_nbr ?? 0) - Math.max(Number(rateplan.guest[i].infant_nbr ?? 0), 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n\n  async prepareBookUserServiceParams({ context, sourceOption, check_in }: { context: any; sourceOption: TSourceOption; check_in: boolean }) {\n    try {\n      // Validate context structure\n      if (!context || !context.dateRangeData) {\n        throw new Error('Invalid context: Missing date range data.');\n      }\n\n      const fromDate = new Date(context.dateRangeData.fromDate);\n      const toDate = new Date(context.dateRangeData.toDate);\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n\n      switch (context.defaultData.event_type) {\n        case 'EDIT_BOOKING': {\n          const { booking, currentRoomType } = context.defaultData;\n\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\n          console.log('currentRoomType', currentRoomType);\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const { booking, ROOMS } = context.defaultData;\n          // console.log(booking);\n          if (!booking) {\n            throw new Error('Missing booking');\n          }\n          const newRooms = generateNewRooms();\n          const previousRooms = context.defaultData.event_type === 'ADD_ROOM' ? ROOMS ?? [] : booking?.rooms;\n          newBooking = modifyBookingDetails(booking, [...previousRooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByInfoData } = context;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras,\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            booking: {\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByInfoData.message || null,\n              booking_nbr: '',\n              property: {\n                id: context.propertyid,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: context.currency,\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\n              guest: {\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\n                first_name: bookedByInfoData.firstName,\n                last_name: bookedByInfoData.lastName,\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\n                city: null,\n                mobile: bookedByInfoData.contactNumber === null ? '' : bookedByInfoData.contactNumber,\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\n                address: '',\n                dob: null,\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\n                cci: bookedByInfoData.cardNumber\n                  ? {\n                      nbr: bookedByInfoData.cardNumber,\n                      holder_name: bookedByInfoData.cardHolderName,\n                      expiry_month: bookedByInfoData.expiryMonth,\n                      expiry_year: bookedByInfoData.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private getRoomCategoryByRoomId(bookingData) {\n    return bookingData.roomsInfo?.find(roomCategory => {\n      return roomCategory.id === bookingData.RATE_TYPE;\n    });\n  }\n  public setEditingRoomInfo(bookingData, selectedUnits) {\n    const category = this.getRoomCategoryByRoomId(bookingData);\n    const room_id = !category ? '' : `c_${category?.id}`;\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\n    const data = {\n      adultCount: bookingData.ADULTS_COUNT,\n      rate: bookingData.RATE,\n      rateType: bookingData.RATE_TYPE,\n      ratePlanId: bookingData.RATE_PLAN_ID,\n      roomCategoryId: category ? category.id : '',\n      roomCategoryName: category ? category.name : '',\n      totalRooms: 1,\n      ratePlanName: bookingData.RATE_PLAN,\n      roomId: bookingData.PR_ID,\n      guestName: bookingData.NAME,\n      cancelation: bookingData.cancelation,\n      guarantee: bookingData.guarantee,\n      adult_child_offering: bookingData.adult_child_offering,\n    };\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\n  }\n}\n",":host {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100vw;\n  min-height: 100vh;\n  z-index: 99;\n  overflow: hidden;\n  /* min-width: 450px; */\n}\n\n.card-title {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n}\n.card-header-container {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  padding: 1rem 0;\n  justify-content: space-between;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.card-header-container h3 {\n  padding: 0;\n  margin: 0;\n}\n\n.background-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.25);\n}\n\n.formContainer {\n  height: calc(100% - 79px);\n  overflow: auto;\n}\n.gap-30 {\n  gap: 30px;\n}\n.block-date {\n  width: 100%;\n}\n.sideWindow {\n  position: absolute;\n  inset: 0;\n  left: unset;\n  background-color: #ffffff;\n  width: 100%;\n  overflow: auto;\n  animation: slideInFromRight 0.5s;\n}\n.card {\n  top: 0;\n  z-index: 1000;\n}\n\n.close {\n  float: right;\n  font-size: 1.5rem;\n  font-weight: 700;\n  line-height: 1;\n  color: #000;\n  text-shadow: 0 1px 0 #fff;\n  opacity: 0.5;\n  padding: 0;\n  background-color: transparent;\n  border: 0;\n  appearance: none;\n}\n\n.close-icon {\n  position: absolute;\n  top: 18px;\n  right: 33px;\n  outline: none;\n}\n\nbutton:not(:disabled),\n[type='button']:not(:disabled) {\n  cursor: pointer;\n}\n.sheet-footer {\n  width: 100%;\n}\n\n/* .row {\n  padding: 0 0 0 15px;\n  margin: 0;\n} */\n@media only screen and (min-width: 1200px) {\n  .sideWindow {\n    max-width: 70%;\n  }\n}\n@media only screen and (min-width: 2000px) {\n  .sideWindow {\n    max-width: 40%;\n  }\n}\n@media only screen and (min-width: 768px) and (max-width: 1200px) {\n  .sideWindow {\n    max-width: 90%;\n  }\n}\n@media only screen and (min-width: 600px) and (max-width: 768px) {\n  .sideWindow {\n    max-width: 75%;\n  }\n}\n@media only screen and (min-width: 641px) {\n  .block-date {\n    max-width: 450px;\n    padding-bottom: 0 !important;\n  }\n}\n@keyframes slideInFromRight {\n  from {\n    transform: translateX(120%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n@keyframes slideOutToRight {\n  from {\n    transform: translateX(0);\n  }\n  to {\n    transform: translateX(120%);\n  }\n}\n\n.sideWindow--exit {\n  animation: slideOutToRight 0.5s forwards;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, h, Listen, Fragment } from '@stencil/core';\nimport { BookingService } from '@/services/booking.service';\nimport { dateToFormattedString, getReleaseHoursString, handleBodyOverflow } from '@/utils/utils';\nimport { ICountry, IEntries, RoomBlockDetails } from '@/models/IBooking';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyService } from './igl-book-property.service';\nimport { IglBookPropertyPayloadEditBooking, TAdultChildConstraints, TEventType, TPropertyButtonsTypes, TSourceOption, TSourceOptions } from '@/models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { calculateTotalRooms, modifyBookingStore, reserveRooms, resetBookingStore, resetReserved } from '@/stores/booking.store';\nimport moment from 'moment';\nexport type IHistoryEntry = {\n  dates: { checkIn: Date; checkOut: Date };\n  adults: number;\n  children: number;\n};\n@Component({\n  tag: 'igl-book-property',\n  styleUrls: ['igl-book-property.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBookProperty {\n  @Prop() propertyid: number;\n  @Prop() allowedBookingSources: any;\n  @Prop() language: string;\n  @Prop() countries: ICountry[];\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true, mutable: true }) bookingData: { [key: string]: any };\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n\n  @State() adultChildCount: { adult: number; child: number } = { adult: 0, child: 0 };\n  @State() renderAgain: boolean = false;\n  @State() dateRangeData: { [key: string]: any };\n  @State() defaultData: any;\n  @State() isLoading: string;\n  @State() bookingHistory: Array<{\n    dates: { checkIn: Date; checkOut: Date };\n    adults: number;\n    children: number;\n  }> = [];\n\n  @Event() closeBookingWindow: EventEmitter<{ [key: string]: any }>;\n  @Event() blockedCreated: EventEmitter<RoomBlockDetails>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n\n  private initialRoomIds: { roomName: string; ratePlanId: number; roomId: string; roomTypeId: string } | null = null;\n  private sourceOption: TSourceOption;\n  private page: string;\n  private showSplitBookingOption: boolean = false;\n  private sourceOptions: TSourceOptions[] = [];\n  private guestData: { [key: string]: any }[] = [];\n  private bookedByInfoData: { [key: string]: any } = {};\n  private blockDatesData: { [key: string]: any } = {};\n  private ratePricingMode: IEntries[] = [];\n  private selectedUnits: Map<string, Map<string, any>> = new Map();\n  private bedPreferenceType: IEntries[] = [];\n  private bookingService: BookingService = new BookingService();\n  private bookPropertyService = new IglBookPropertyService();\n  private defaultDateRange: { from_date: string; to_date: string };\n  private updatedBooking: boolean = false;\n  private MAX_HISTORY_LENGTH: number = 2;\n  private didReservation: boolean;\n  private wasBlockedUnit: boolean;\n  private _sourceOptions: TSourceOptions[];\n\n  async componentWillLoad() {\n    console.log('<==>roomtypes<==>', booking_store?.roomTypes);\n    if (booking_store.roomTypes) {\n      modifyBookingStore('roomTypes', []);\n      modifyBookingStore('ratePlanSelections', {});\n    }\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.initializeDefaultDateRange();\n\n    if (!this.bookingData.defaultDateRange) {\n      return;\n    }\n    // console.log(this.bookingData);\n    this.initializeDefaultData();\n    this.wasBlockedUnit = this.defaultData.hasOwnProperty('block_exposed_unit_props');\n    modifyBookingStore('event_type', { type: this.defaultData.event_type });\n    this.fetchSetupEntriesAndInitialize();\n  }\n\n  componentDidLoad() {\n    document.addEventListener('keydown', this.handleKeyDown);\n    handleBodyOverflow(true);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  @Listen('inputCleared')\n  clearBooking(e: CustomEvent) {\n    if (this.isEventType('SPLIT_BOOKING')) {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.bookedByInfoData = {};\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n      this.renderPage();\n    }\n  }\n\n  @Listen('spiltBookingSelected')\n  async handleSpiltBookingSelected(e: CustomEvent<{ key: string; data: unknown }>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { key, data } = e.detail;\n    if (key === 'select' || (key === 'blur' && data !== '')) {\n      const res = await this.bookingService.getExposedBooking((data as any).booking_nbr || (data as string), this.language);\n      this.defaultData = { ...this.defaultData, booking: res };\n      this.bookPropertyService.setBookingInfoFromAutoComplete(this, res);\n      this.sourceOption = res.source;\n      this.renderPage();\n    }\n  }\n\n  // @Listen('adultChild')\n  // handleAdultChildChange(event: CustomEvent) {\n  //   if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n  //     this.bookPropertyService.resetRoomsInfoAndMessage(this);\n  //   }\n  //   const { adult, child } = event.detail;\n  //   this.adultChildCount = { ...event.detail };\n  //   this.updateBookingHistory({ adults: adult, children: child });\n  // }\n  @Listen('adultChild')\n  handleAdultChildChange(event: CustomEvent) {\n    if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n    const { adult, child } = event.detail;\n    this.adultChildCount = { ...event.detail };\n\n    // Update the booking history\n    this.updateBookingHistory({ adults: Number(adult), children: Number(child) });\n  }\n\n  @Listen('dateSelectEvent')\n  onDateRangeSelect(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.updateBookingHistory({\n      dates: {\n        checkIn: new Date(this.dateRangeData.fromDate),\n        checkOut: new Date(new Date(opt.data.toDate)),\n      },\n    });\n    console.log('date changed', opt);\n    if (opt.key === 'selectedDateRange') {\n      this.dateRangeData = opt.data;\n      if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n        this.defaultData.roomsInfo = [];\n      } else if (this.adultChildCount.adult !== 0) {\n        this.checkBookingAvailability();\n        // this.checkBookingAvailability(dateToFormattedString(new Date(this.dateRangeData.fromDate)), dateToFormattedString(new Date(this.dateRangeData.toDate)));\n      }\n    }\n  }\n  @Listen('sourceDropDownChange')\n  handleSourceDropDown(event: CustomEvent) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const value = event.detail;\n    const selectedSource = this.sourceOptions.find(opt => opt.id === value.toString());\n    this.sourceOption = {\n      code: value,\n      description: selectedSource.value || '',\n      tag: selectedSource.tag,\n      id: selectedSource.id,\n      type: selectedSource.type,\n    };\n  }\n\n  @Listen('gotoSplitPageTwoEvent', { target: 'window' })\n  gotoSplitPageTwo() {\n    this.gotoPage('page_two');\n  }\n\n  @Listen('buttonClicked')\n  handleButtonClicked(event: CustomEvent<{ key: TPropertyButtonsTypes; data?: CustomEvent }>) {\n    switch (event.detail.key) {\n      case 'save':\n        this.bookUser(false);\n        break;\n      case 'cancel':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        this.closeWindow();\n        break;\n      case 'back':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (this.isEventType('BAR_BOOKING')) {\n          resetReserved();\n        }\n        this.gotoPage('page_one');\n        break;\n      case 'book':\n        this.bookUser(false);\n        break;\n      case 'bookAndCheckIn':\n        this.bookUser(true);\n        break;\n      case 'next':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (!this.adultChildCount?.adult) {\n          this.animateIrSelect.emit('adult_child_select');\n          break;\n        }\n        if (calculateTotalRooms() > 0) {\n          this.gotoPage('page_two');\n          break;\n        } else if (this.defaultData?.roomsInfo.length === 0) {\n          this.animateIrButton.emit('check_availability');\n          break;\n        }\n        this.toast.emit({\n          type: 'error',\n          description: locales.entries.Lcz_SelectRatePlan,\n          title: locales.entries.Lcz_SelectRatePlan,\n        });\n        break;\n      case 'check':\n        this.checkBookingAvailability();\n        break;\n      default:\n        break;\n    }\n  }\n\n  private updateBookingHistory(partialData: Partial<IHistoryEntry>) {\n    const lastEntry = this.bookingHistory[this.bookingHistory.length - 1];\n\n    const newEntry: IHistoryEntry = {\n      dates: {\n        checkIn: partialData.dates?.checkIn || lastEntry?.dates?.checkIn || new Date(this.dateRangeData.fromDate),\n        checkOut: partialData.dates?.checkOut || lastEntry?.dates?.checkOut || new Date(this.dateRangeData.toDate),\n      },\n      adults: partialData.adults ?? lastEntry?.adults ?? this.adultChildCount.adult,\n      children: partialData.children ?? lastEntry?.children ?? this.adultChildCount.child,\n    };\n\n    // Update the booking history\n    this.bookingHistory.push(newEntry);\n    if (this.bookingHistory.length > this.MAX_HISTORY_LENGTH) {\n      this.bookingHistory.shift();\n    }\n  }\n\n  private handleKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      this.closeWindow();\n    }\n  }\n\n  private initializeDefaultDateRange() {\n    this.defaultDateRange = {\n      from_date: this.bookingData.FROM_DATE,\n      to_date: this.bookingData.TO_DATE,\n    };\n  }\n\n  private initializeDefaultData() {\n    this.defaultData = this.bookingData;\n    this.dateRangeData = { ...this.defaultData.defaultDateRange };\n  }\n\n  private async fetchSetupEntriesAndInitialize() {\n    try {\n      const setupEntries = await this.fetchSetupEntries();\n      this.setSourceOptions(this.allowedBookingSources);\n      this.setOtherProperties(setupEntries);\n      this.initializeEventData();\n    } catch (error) {\n      console.error('Error fetching setup entries:', error);\n    }\n  }\n\n  private initializeEventData() {\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.initializeEditBookingData();\n    }\n\n    if (!this.isEventType('BAR_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n\n    this.initializePage();\n  }\n\n  private initializeEditBookingData() {\n    this.adultChildCount = {\n      adult: this.defaultData.ADULTS_COUNT,\n      child: this.defaultData.CHILDREN_COUNT,\n    };\n\n    this.initialRoomIds = {\n      roomName: this.defaultData.roomName,\n      ratePlanId: this.defaultData.RATE_PLAN_ID,\n      roomId: this.defaultData.PR_ID,\n      roomTypeId: this.defaultData.RATE_TYPE,\n    };\n    const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n    console.log(GUEST);\n    modifyBookingStore('guest', {\n      bed_preference: currentRoomType.bed_preference?.toString(),\n      infant_nbr: currentRoomType.occupancy.infant_nbr,\n      first_name: GUEST.first_name ?? '',\n      last_name: GUEST.last_name ?? '',\n      // name: currentRoomType.guest.last_name ? currentRoomType.guest.first_name + ' ' + currentRoomType.guest.last_name : currentRoomType.guest.first_name,\n      unit: (currentRoomType.unit as any)?.id?.toString(),\n    });\n    this.checkBookingAvailability();\n    this.bookPropertyService.setEditingRoomInfo(this.defaultData, this.selectedUnits);\n  }\n\n  private initializePage() {\n    switch (this.defaultData.event_type) {\n      case 'SPLIT_BOOKING':\n        this.showSplitBookingOption = true;\n        this.page = 'page_one';\n        break;\n      case 'BLOCK_DATES':\n        this.page = 'page_block_date';\n        break;\n      default:\n        this.page = 'page_one';\n        break;\n    }\n  }\n\n  async fetchSetupEntries() {\n    return await this.bookingService.fetchSetupEntries();\n  }\n\n  private isGuestDataIncomplete() {\n    for (const roomtypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomtypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (const guest of rateplan.guest) {\n            if (guest.first_name === '' || guest.last_name === '') {\n              return true;\n            }\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  private isButtonDisabled() {\n    const isValidProperty = (property, key, comparedBy) => {\n      if (!property) {\n        return true;\n      }\n      if (property === this.guestData) {\n        return this.isGuestDataIncomplete();\n      }\n      if (key === 'selectedArrivalTime') {\n        if (property[key] !== undefined) {\n          return property[key].code === '';\n        } else {\n          return true;\n        }\n      }\n      return property[key] === comparedBy || property[key] === undefined;\n    };\n    return (\n      isValidProperty(this.guestData, 'guestName', '') ||\n      isValidProperty(this.bookedByInfoData, 'firstName', '') ||\n      isValidProperty(this.bookedByInfoData, 'lastName', '') ||\n      isValidProperty(this.bookedByInfoData, 'selectedArrivalTime', '')\n    );\n  }\n\n  private setSourceOptions(bookingSource: any[]) {\n    this.sourceOptions = bookingSource.map(source => ({\n      id: source.id,\n      value: source.description,\n      tag: source.tag,\n      type: source.type,\n    }));\n    this._sourceOptions = this.isEventType('BAR_BOOKING') ? this.getFilteredSourceOptions() : this.sourceOptions;\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.sourceOption = { ...this.defaultData.SOURCE };\n    } else {\n      //get first source option not tag\n      let option: TSourceOptions & { code: string; description: string } = this._sourceOptions.find(o => o.type !== 'LABEL') as any;\n      console.log({ option });\n      this.sourceOption = {\n        code: option.code,\n        description: option.description,\n        tag: option.tag,\n        type: option.type,\n        id: option.id,\n      };\n    }\n  }\n  private getFilteredSourceOptions(): TSourceOptions[] {\n    const agentIds = new Set<string>();\n    const hasAgentOnlyRoomType =\n      this.bookingData?.roomsInfo?.some((rt: any) => {\n        const rps = rt?.rateplans ?? [];\n        if (rps.length === 0) return false;\n\n        const isForAgentOnly = rps.every((rp: any) => (rp?.agents?.length ?? 0) > 0);\n        if (isForAgentOnly) {\n          rps.forEach((rp: any) => {\n            (rp?.agents ?? []).forEach((ag: any) => agentIds.add(ag?.id?.toString()));\n          });\n        }\n        return isForAgentOnly;\n      }) ?? false;\n    if (!hasAgentOnlyRoomType) {\n      return this.sourceOptions;\n    }\n    return (this.sourceOptions ?? []).filter((opt: any) => {\n      if (opt?.type === 'LABEL') return true;\n      const candidate = opt?.tag;\n      const matchesId = candidate != null && agentIds.has(candidate);\n      return matchesId;\n    });\n  }\n  private setOtherProperties(res: any) {\n    this.ratePricingMode = res?.ratePricingMode;\n    this.bookedByInfoData.arrivalTime = res.arrivalTime;\n    this.bedPreferenceType = res.bedPreferenceType;\n  }\n\n  private async checkBookingAvailability() {\n    resetBookingStore();\n    const from_date = moment(this.dateRangeData.fromDate).format('YYYY-MM-DD');\n    const to_date = moment(this.dateRangeData.toDate).format('YYYY-MM-DD');\n    console.log({ sourceOption: this.sourceOption });\n    const is_in_agent_mode = this.sourceOption['type'] === 'TRAVEL_AGENCY';\n    try {\n      const room_type_ids_to_update = this.isEventType('EDIT_BOOKING') ? [this.defaultData.RATE_TYPE] : [];\n      const room_type_ids = this.isEventType('BAR_BOOKING') ? this.defaultData.roomsInfo.map(room => room.id) : [];\n      const data = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.propertyid,\n        adultChildCount: this.adultChildCount,\n        language: this.language,\n        room_type_ids,\n        currency: this.currency,\n        agent_id: is_in_agent_mode ? this.sourceOption['tag'] : null,\n        is_in_agent_mode,\n        room_type_ids_to_update,\n      });\n      if (!this.isEventType('EDIT_BOOKING')) {\n        this.defaultData.defaultDateRange.fromDate = new Date(this.dateRangeData.fromDate);\n        this.defaultData.defaultDateRange.toDate = new Date(this.dateRangeData.toDate);\n      }\n      this.defaultData = { ...this.defaultData, roomsInfo: data };\n      if (this.isEventType('EDIT_BOOKING') && !this.updatedBooking) {\n        this.updateBooking();\n      }\n    } catch (error) {\n      console.error('Error initializing booking availability:', error);\n    }\n  }\n\n  private updateBooking() {\n    try {\n      const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n      const roomtypeId = currentRoomType.roomtype.id;\n      const rateplanId = currentRoomType.rateplan.id;\n      const guest = {\n        bed_preference: currentRoomType.bed_preference?.toString(),\n        infant_nbr: currentRoomType.occupancy.infant_nbr,\n        last_name: GUEST.last_name,\n        first_name: GUEST.first_name,\n        unit: (currentRoomType.unit as any)?.id?.toString(),\n        roomtype_id: currentRoomType.roomtype.id,\n      };\n      modifyBookingStore('guest', guest);\n      reserveRooms({\n        roomTypeId: roomtypeId,\n        ratePlanId: rateplanId,\n        rooms: 1,\n        guest: [guest],\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  private async checkAndBlockDate() {\n    try {\n      const { block_exposed_unit_props } = this.defaultData;\n      await this.bookingService.getBookingAvailability({\n        from_date: block_exposed_unit_props.from_date,\n        to_date: block_exposed_unit_props.to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: 2,\n          child: 0,\n        },\n        language: this.language,\n        room_type_ids: this.defaultData.roomsInfo.map(room => room.id),\n        currency: this.currency,\n      });\n      const isAvailable = booking_store.roomTypes.every(rt => {\n        if (rt.is_available_to_book) {\n          return true;\n        }\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\n      });\n      if (isAvailable) {\n        await this.handleBlockDate(false);\n      } else {\n        console.log('Blocked date is unavailable. Continuing...');\n      }\n    } catch (error) {\n      console.error('Error checking and blocking date:', error);\n    }\n  }\n  private async closeWindow() {\n    resetBookingStore();\n    handleBodyOverflow(false);\n\n    if (this.wasBlockedUnit && !this.didReservation) {\n      await this.checkAndBlockDate();\n    }\n    const el = document.querySelector('.sideWindow');\n    if (!el) return;\n\n    el.classList.add('sideWindow--exit');\n\n    setTimeout(() => {\n      this.closeBookingWindow.emit();\n      document.removeEventListener('keydown', this.handleKeyDown);\n    }, 300);\n  }\n\n  private isEventType(key: TEventType) {\n    return this.defaultData.event_type === key;\n  }\n\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.blockDatesData = opt.data;\n  }\n\n  private handleGuestInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt = event.detail;\n    if (opt.guestRefKey) {\n      if (this.isEventType('BAR_BOOKING') || this.wasBlockedUnit || this.isEventType('SPLIT_BOOKING')) {\n        this.guestData[opt.guestRefKey] = {\n          ...opt.data,\n          roomId: this.defaultData.PR_ID,\n        };\n      } else this.guestData[opt.guestRefKey] = opt.data;\n    }\n  }\n\n  private handleBookedByInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.bookedByInfoData = opt.value.data;\n  }\n\n  private renderPage() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  private gotoPage(gotoPage: string) {\n    this.page = gotoPage;\n    this.renderPage();\n  }\n\n  private getPageBlockDatesView() {\n    return (\n      <Fragment>\n        <igl-block-dates-view\n          fromDate={this.defaultData.FROM_DATE}\n          toDate={this.defaultData.TO_DATE}\n          entryDate={this.defaultData.ENTRY_DATE}\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\n        ></igl-block-dates-view>\n      </Fragment>\n    );\n  }\n\n  private handlePageTwoDataUpdateEvent(event: CustomEvent<IPageTwoDataUpdateProps>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    if (event.detail.key === 'propertyBookedBy') {\n      this.handleBookedByInfoUpdate(event);\n    } else {\n      this.handleGuestInfoUpdate(event);\n    }\n  }\n\n  private async handleBlockDate(auto_close = true) {\n    const props = this.wasBlockedUnit\n      ? this.defaultData.block_exposed_unit_props\n      : (() => {\n          const releaseData = getReleaseHoursString(+this.blockDatesData.RELEASE_AFTER_HOURS);\n          return {\n            from_date: dateToFormattedString(this.defaultData.defaultDateRange.fromDate),\n            to_date: dateToFormattedString(this.defaultData.defaultDateRange.toDate),\n            NOTES: this.blockDatesData.OPTIONAL_REASON || '',\n            pr_id: this.defaultData.PR_ID.toString(),\n            STAY_STATUS_CODE: this.blockDatesData.OUT_OF_SERVICE ? '004' : this.blockDatesData.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\n            DESCRIPTION: this.blockDatesData.RELEASE_AFTER_HOURS || '',\n            ...releaseData,\n          };\n        })();\n    // const blockedUnit = await transformNewBLockedRooms(result);\n    await this.bookingService.blockUnit(props);\n    // this.blockedCreated.emit(blockedUnit);\n    if (auto_close) this.closeWindow();\n  }\n\n  private async bookUser(check_in: boolean) {\n    this.setLoadingState(check_in);\n\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      if (this.isGuestDataIncomplete()) {\n        this.isLoading = '';\n        return;\n      }\n    } else if (this.isButtonDisabled()) {\n      this.isLoading = '';\n      return;\n    }\n\n    try {\n      if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n        this.bookedByInfoData.message = this.defaultData.NOTES;\n      }\n      this.didReservation = true;\n      const serviceParams = await this.bookPropertyService.prepareBookUserServiceParams({\n        context: this,\n        sourceOption: this.sourceOption,\n        check_in,\n      });\n      await this.bookingService.doReservation(serviceParams);\n      await this.adjustBlockedDatesAfterReservation(serviceParams);\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.error('Error booking user:', error);\n    } finally {\n      // this.isLoading = null;\n      this.resetLoadingState();\n    }\n  }\n  private async adjustBlockedDatesAfterReservation(serviceParams: any) {\n    if (!this.wasBlockedUnit) {\n      return;\n    }\n    const original_from_date = moment(this.defaultData.block_exposed_unit_props.from_date, 'YYYY-MM-DD');\n    const current_from_date = moment(serviceParams.booking.from_date, 'YYYY-MM-DD');\n    const original_to_date = moment(this.defaultData.block_exposed_unit_props.to_date, 'YYYY-MM-DD');\n    const current_to_date = moment(serviceParams.booking.to_date, 'YYYY-MM-DD');\n    if (current_to_date.isBefore(original_to_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, from_date: current_to_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    if (current_from_date.isAfter(original_from_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, to_date: current_from_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    return;\n  }\n\n  private setLoadingState(assign_units: boolean) {\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      this.isLoading = 'save';\n    } else {\n      this.isLoading = assign_units ? 'bookAndCheckIn' : 'book';\n    }\n  }\n\n  private resetLoadingState() {\n    this.isLoading = '';\n    setTimeout(() => {\n      this.closeWindow();\n    }, 100);\n  }\n\n  private getCurrentPage(name: string) {\n    return this.page === name;\n  }\n\n  render() {\n    return (\n      <Host data-testid=\"book_property_sheet h-100\">\n        <div class=\"background-overlay\" onClick={() => this.closeWindow()}></div>\n        <div class={'sideWindow sheet-container ' + (this.getCurrentPage('page_block_date') ? 'block-date' : '')}>\n          {isRequestPending('/Get_Setup_Entries_By_TBL_NAME_MULTI') ? (\n            <div class={'loading-container'}>\n              <ir-spinner></ir-spinner>\n            </div>\n          ) : (\n            <Fragment>\n              <div class=\"sheet-header\">\n                <div class=\"card-header-container mb-2\">\n                  <h3 class=\"text-left font-medium-2 px-2\">{this.getCurrentPage('page_block_date') ? this.defaultData.BLOCK_DATES_TITLE : this.defaultData.TITLE}</h3>\n                  <ir-icon\n                    class={'px-2'}\n                    onIconClickHandler={() => {\n                      this.closeWindow();\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={20} width={20}>\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                      />\n                    </svg>\n                  </ir-icon>\n                </div>\n              </div>\n              <div class=\"px-2 sheet-body\">\n                {this.getCurrentPage('page_one') && (\n                  <igl-booking-overview-page\n                    wasBlockedUnit={this.wasBlockedUnit}\n                    initialRoomIds={this.initialRoomIds}\n                    defaultDaterange={this.defaultDateRange}\n                    eventType={this.defaultData.event_type}\n                    selectedRooms={this.selectedUnits}\n                    currency={this.currency}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    ratePricingMode={this.ratePricingMode}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    adultChildCount={this.adultChildCount}\n                    bookedByInfoData={this.bookedByInfoData}\n                    adultChildConstraints={this.adultChildConstraints}\n                    sourceOptions={this._sourceOptions}\n                    propertyId={this.propertyid}\n                  ></igl-booking-overview-page>\n                )}\n\n                {this.getCurrentPage('page_two') && (\n                  <igl-booking-form\n                    currency={this.currency}\n                    propertyId={this.propertyid}\n                    showPaymentDetails={this.showPaymentDetails}\n                    selectedGuestData={this.guestData}\n                    countries={this.countries}\n                    isLoading={this.isLoading}\n                    selectedRooms={this.selectedUnits}\n                    bedPreferenceType={this.bedPreferenceType}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    language={this.language}\n                    bookedByInfoData={this.bookedByInfoData}\n                    defaultGuestData={this.defaultData}\n                    isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                    onDataUpdateEvent={event => this.handlePageTwoDataUpdateEvent(event)}\n                  ></igl-booking-form>\n                )}\n                {this.getCurrentPage('page_block_date') ? this.getPageBlockDatesView() : null}\n              </div>\n              {this.getCurrentPage('page_block_date') ? (\n                <div class=\"sheet-footer\">\n                  <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class=\"flex-fill\" onClick={() => this.closeWindow()}></ir-button>\n                  <ir-button\n                    text={locales.entries.Lcz_Blockdates}\n                    isLoading={isRequestPending('/Block_Exposed_Unit')}\n                    class=\"flex-fill\"\n                    onClick={() => this.handleBlockDate()}\n                  ></ir-button>\n                </div>\n              ) : (\n                <igl-book-property-footer\n                  page={this.page}\n                  dateRangeData={this.dateRangeData}\n                  isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                  isLoading={this.isLoading}\n                  class={'sheet-footer'}\n                  eventType={this.bookingData.event_type}\n                ></igl-book-property-footer>\n              )}\n            </Fragment>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  width: 100% !important;\n  background: #000;\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { TIcons } from '@/components/ui/ir-icons/icons';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\n\n@Component({\n  tag: 'igl-book-property-footer',\n  styleUrl: 'igl-book-property-footer.css',\n  scoped: true,\n})\nexport class IglBookPropertyFooter {\n  @Prop() eventType: string;\n  @Prop() disabled: boolean = true;\n  @Prop() page: string;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() isLoading: string;\n\n  @Event() buttonClicked: EventEmitter<{ key: TPropertyButtonsTypes }>;\n\n  private isEventType(event: string) {\n    return event === this.eventType;\n  }\n  private editNext(label) {\n    if (this.isEventType('EDIT_BOOKING')) {\n      if (label === 'Cancel') {\n        return 'flex-fill';\n      } else {\n        return 'd-none d-md-block  flex-fill';\n      }\n    }\n    return 'flex-fill';\n  }\n\n  private renderButton({\n    label,\n    type,\n    disabled,\n    icon_name,\n    isLoading,\n    icon_position = 'right',\n  }: {\n    type: TPropertyButtonsTypes;\n    label: string;\n    disabled?: boolean;\n    icon_name?: TIcons;\n    isLoading?: boolean;\n    icon_position?: 'right' | 'left';\n  }) {\n    return (\n      <div class={this.shouldRenderTwoButtons() ? ` ${this.editNext(label)}` : 'flex-fill'}>\n        {/* <button class={`btn btn-${type === 'cancel' ? 'secondary' : 'primary'} full-width`} onClick={() => this.buttonClicked.emit({ key: type })} disabled={disabled}>\n          {label}\n        </button> */}\n        <ir-button\n          isLoading={isLoading}\n          btn_color={type === 'cancel' || type === 'back' ? 'secondary' : 'primary'}\n          text={label}\n          btn_disabled={disabled}\n          onClickHandler={() => {\n            this.buttonClicked.emit({ key: type });\n          }}\n          class=\"full-width\"\n          btn_styles=\"justify-content-center\"\n          icon_name={icon_name}\n          iconPosition={icon_position}\n          style={{ '--icon-size': '1rem' }}\n          icon_style={{ paddingBottom: '1.9px' }}\n        ></ir-button>\n      </div>\n    );\n  }\n\n  private shouldRenderTwoButtons() {\n    return this.isEventType('PLUS_BOOKING') || this.isEventType('ADD_ROOM') || this.isEventType('EDIT_BOOKING');\n  }\n\n  render() {\n    if (this.page === 'page_one') {\n      return (\n        <Host>\n          {/* <div class=\"d-flex justify-content-between gap-30 align-items-center full-width\"> */}\n          {this.isEventType('EDIT_BOOKING') ? (\n            <Fragment>\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\n              {this.shouldRenderTwoButtons() &&\n                this.renderButton({\n                  type: 'next',\n                  label: `${locales.entries.Lcz_Next}`,\n                  disabled: isRequestPending('/Get_Exposed_Booking_Availability'),\n                  icon_name: 'angles_right',\n                })}\n            </Fragment>\n          ) : (\n            <Fragment>\n              {this.renderButton({ type: 'cancel', label: locales.entries.Lcz_Cancel })}\n              {this.shouldRenderTwoButtons() && this.renderButton({ type: 'next', label: `${locales.entries.Lcz_Next}`, icon_name: 'angles_right' })}\n            </Fragment>\n          )}\n          {/* </div> */}\n        </Host>\n      );\n    }\n    const showBookAndCheckin = calendar_data.checkin_enabled && moment(new Date(this.dateRangeData?.fromDate)).isSame(new Date(), 'day');\n    return (\n      <Fragment>\n        {this.isEditOrAddRoomEvent ? (\n          <Fragment>\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\n            {this.renderButton({ type: 'save', label: locales.entries.Lcz_Save, isLoading: this.isLoading === 'save' })}\n          </Fragment>\n        ) : (\n          <Fragment>\n            {this.renderButton({ type: 'back', icon_position: 'left', label: locales.entries.Lcz_Back, icon_name: 'angles_left' })}\n            {this.renderButton({ type: 'book', label: locales.entries.Lcz_Book, isLoading: this.isLoading === 'book' })}\n            {showBookAndCheckin && this.renderButton({ type: 'bookAndCheckIn', label: locales.entries.Lcz_BookAndChekcIn, isLoading: this.isLoading === 'bookAndCheckIn' })}\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n",":host {\n  display: flex;\n  flex-direction: column;\n}\n","import { Component, Prop, h, Event, EventEmitter, State } from '@stencil/core';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyPayloadEditBooking, TPropertyButtonsTypes } from '../../../../models/igl-book-property';\nimport { formatAmount } from '@/utils/utils';\nimport locales from '@/stores/locales.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { ICountry } from '@/models/IBooking';\n@Component({\n  tag: 'igl-booking-form',\n  styleUrl: 'igl-booking-form.css',\n  scoped: true,\n})\nexport class IglBookingForm {\n  @Prop() showPaymentDetails: boolean;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true }) isEditOrAddRoomEvent: boolean;\n  @Prop() dateRangeData: { [key: string]: any };\n  @Prop() bookingData: { [key: string]: any };\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() language: string;\n  @Prop() bookedByInfoData: { [key: string]: any };\n  @Prop() propertyId: number;\n  @Prop() bedPreferenceType: any;\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop({ reflect: true }) isLoading: string;\n  @Prop() countries: ICountry[];\n  @Prop() selectedGuestData;\n  @Prop() defaultGuestData: IglBookPropertyPayloadEditBooking;\n\n  @State() selectedBookedByData;\n  @State() guestData: any;\n  @State() selectedUnits: { [key: string]: any } = {};\n\n  @Event() dataUpdateEvent: EventEmitter<IPageTwoDataUpdateProps>;\n  @Event() buttonClicked: EventEmitter<{\n    key: TPropertyButtonsTypes;\n    data?: CustomEvent;\n  }>;\n\n  componentWillLoad() {\n    this.initializeGuestData();\n    this.selectedBookedByData = this.bookedByInfoData;\n  }\n\n  initializeGuestData() {\n    let total = 0;\n    const newSelectedUnits = { ...this.selectedUnits };\n    const getRate = (rate: number, totalNights: number, isRateModified: boolean, preference: number) => {\n      if (isRateModified && preference === 2) {\n        return rate * totalNights;\n      }\n      return rate;\n    };\n    this.selectedUnits = newSelectedUnits;\n    this.guestData = [];\n    this.selectedRooms.forEach((room, key) => {\n      room.forEach(rate_plan => {\n        newSelectedUnits[key] = rate_plan.selectedUnits;\n        total += rate_plan.totalRooms * getRate(rate_plan.rate, this.dateRangeData.dateDifference, rate_plan.isRateModified, rate_plan.rateType);\n        for (let i = 1; i <= rate_plan.totalRooms; i++) {\n          this.guestData.push({\n            guestName: '',\n            roomId: '',\n            preference: '',\n            ...rate_plan,\n          });\n        }\n      });\n    });\n    this.bookingData.TOTAL_PRICE = total;\n  }\n  handleOnApplicationInfoDataUpdateEvent(event: CustomEvent, index: number) {\n    const opt = event.detail;\n    const categoryIdKey = `c_${opt.data.roomCategoryId}`;\n    const updatedUnits = [...(this.selectedUnits[categoryIdKey] || [])];\n    updatedUnits[index] = opt.data.roomId;\n    this.selectedUnits = {\n      ...this.selectedUnits,\n      [categoryIdKey]: updatedUnits,\n    };\n    this.dataUpdateEvent.emit({\n      key: 'applicationInfoUpdateEvent',\n      value: event.detail,\n    });\n  }\n\n  handleEventData(event: any, key: string, index: number) {\n    if (key === 'application-info') {\n      this.handleOnApplicationInfoDataUpdateEvent(event, index);\n    } else {\n      this.selectedBookedByData = event.detail.data;\n      this.dataUpdateEvent.emit({\n        key: 'propertyBookedBy',\n        value: event.detail,\n      });\n    }\n  }\n  isGuestDataIncomplete() {\n    if (this.selectedGuestData.length !== this.guestData.length) {\n      return true;\n    }\n    for (const data of this.selectedGuestData) {\n      if (data.guestName === '' || data.preference === '' || data.roomId === '') {\n        return true;\n      }\n    }\n    return false;\n  }\n  isButtonDisabled(key: string) {\n    const isValidProperty = (property, key, comparedBy) => {\n      if (!property) {\n        return true;\n      }\n      if (property === this.selectedGuestData) {\n        return this.isGuestDataIncomplete();\n      }\n      if (key === 'selectedArrivalTime') {\n        if (property[key] !== undefined) {\n          return property[key].code === '';\n        } else {\n          return true;\n        }\n      }\n      return property[key] === comparedBy || property[key] === undefined;\n    };\n    return (\n      this.isLoading === key ||\n      isValidProperty(this.selectedGuestData, 'guestName', '') ||\n      isValidProperty(this.selectedBookedByData, 'isdCode', '') ||\n      isValidProperty(this.selectedBookedByData, 'contactNumber', '') ||\n      isValidProperty(this.selectedBookedByData, 'firstName', '') ||\n      isValidProperty(this.selectedBookedByData, 'lastName', '') ||\n      isValidProperty(this.selectedBookedByData, 'countryId', -1) ||\n      isValidProperty(this.selectedBookedByData, 'selectedArrivalTime', '') ||\n      isValidProperty(this.selectedBookedByData, 'email', '')\n    );\n  }\n\n  render() {\n    return (\n      <div class=\"d-flex flex-column h-100\">\n        <div class=\"d-flex flex-wrap\">\n          <ir-date-view\n            class=\"mr-1 flex-fill font-weight-bold font-medium-1\"\n            from_date={new Date(this.dateRangeData.fromDate)}\n            to_date={new Date(this.dateRangeData.toDate)}\n            dateOption=\"DD MMM YYYY\"\n          ></ir-date-view>\n          {this.guestData.length > 1 && (\n            <div class=\"mt-1 mt-md-0 text-right\">\n              {locales.entries.Lcz_TotalPrice} <span class=\"font-weight-bold font-medium-1\">{formatAmount(this.currency.symbol, this.bookingData.TOTAL_PRICE || '0')}</span>\n            </div>\n          )}\n        </div>\n        {Object.values(booking_store.ratePlanSelections).map(val =>\n          Object.values(val).map(ratePlan => {\n            const rp = ratePlan as IRatePlanSelection;\n            if (rp.reserved === 0) {\n              return null;\n            }\n\n            return [...new Array(rp.reserved)].map((_, i) => (\n              <igl-application-info\n                totalNights={Number(this.dateRangeData.dateDifference)}\n                bedPreferenceType={this.bedPreferenceType}\n                currency={this.currency}\n                guestInfo={rp.guest ? rp.guest[i] : null}\n                bookingType={this.bookingData.event_type}\n                rateplanSelection={rp}\n                key={`${rp.ratePlan.id}_${i}`}\n                roomIndex={i}\n                baseData={\n                  this.bookingData.event_type === 'EDIT_BOOKING'\n                    ? {\n                        roomtypeId: this.bookingData.currentRoomType.roomtype.id,\n                        unit: this.bookingData.currentRoomType.unit,\n                      }\n                    : undefined\n                }\n              ></igl-application-info>\n            ));\n          }),\n        )}\n\n        {this.isEditOrAddRoomEvent || this.showSplitBookingOption ? null : (\n          <igl-property-booked-by\n            propertyId={this.propertyId}\n            countries={this.countries}\n            language={this.language}\n            showPaymentDetails={this.showPaymentDetails}\n            defaultData={this.bookedByInfoData}\n            onDataUpdateEvent={event => {\n              this.handleEventData(event, 'propertyBookedBy', 0);\n            }}\n          ></igl-property-booked-by>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host > * {\n  margin: 0;\n  padding: auto;\n}\n.scrollContent {\n  height: calc(100% - 79px);\n  overflow: auto;\n  position: relative;\n}\n.loading-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  background: white;\n  position: absolute;\n  inset: 0;\n  z-index: 100;\n}\n.loader {\n  width: 1.25rem;\n  height: 1.25rem;\n  border: 2.5px solid #3f3f3f;\n  border-bottom-color: transparent;\n  border-radius: 50%;\n  display: inline-block;\n  box-sizing: border-box;\n  animation: rotation 1s linear infinite;\n}\n","import { Component, Event, EventEmitter, Fragment, Host, Prop, h } from '@stencil/core';\nimport { TAdultChildConstraints, TSourceOptions } from '../../../../models/igl-book-property';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport moment from 'moment';\nimport booking_store from '@/stores/booking.store';\n@Component({\n  tag: 'igl-booking-overview-page',\n  styleUrl: 'igl-booking-overview-page.css',\n  scoped: true,\n})\nexport class IglBookingOverviewPage {\n  @Prop() bookingData: any;\n  @Prop() propertyId: number;\n  @Prop() message: string;\n  @Prop() showSplitBookingOption: boolean;\n  @Prop() eventType: string;\n  @Prop() currency: any;\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n  @Prop() ratePricingMode: any;\n  @Prop() dateRangeData: any;\n  @Prop() defaultDaterange: { from_date: string; to_date: string };\n  @Prop() selectedRooms: Map<string, Map<string, any>>;\n  @Prop() adultChildCount: { adult: number; child: number };\n  @Prop() sourceOptions: TSourceOptions[];\n  @Prop() bookedByInfoData: any;\n  @Prop() initialRoomIds: any;\n  @Prop() wasBlockedUnit: boolean;\n\n  @Event() roomsDataUpdate: EventEmitter;\n\n  getSplitBookings() {\n    return (this.bookingData.hasOwnProperty('splitBookingEvents') && this.bookingData.splitBookingEvents) || [];\n  }\n  isEventType(event: string) {\n    return event === this.eventType;\n  }\n  setMinDate() {\n    if (!this.isEventType('EDIT_BOOKING')) {\n      return;\n    }\n    const from_date = moment(this.bookingData.FROM_DATE, 'YYYY-MM-DD');\n    const today = moment();\n    if (from_date.isAfter(today)) {\n      return today.add(-2, 'weeks').format('YYYY-MM-DD');\n    }\n    return from_date.add(-2, 'weeks').format('YYYY-MM-DD');\n  }\n  render() {\n    return (\n      <Host>\n        <igl-book-property-header\n          wasBlockedUnit={this.wasBlockedUnit}\n          bookedByInfoData={this.bookedByInfoData}\n          defaultDaterange={this.defaultDaterange}\n          dateRangeData={this.dateRangeData}\n          minDate={this.setMinDate()}\n          // minDate={this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING') ? this.bookedByInfoData.from_date || this.bookingData.FROM_DATE : undefined}\n          adultChildCount={this.adultChildCount}\n          splitBookingId={this.showSplitBookingOption}\n          bookingData={this.bookingData}\n          sourceOptions={this.sourceOptions}\n          message={this.message}\n          bookingDataDefaultDateRange={this.bookingData.defaultDateRange}\n          showSplitBookingOption={this.showSplitBookingOption}\n          adultChildConstraints={this.adultChildConstraints}\n          splitBookings={this.getSplitBookings()}\n          propertyId={this.propertyId}\n        ></igl-book-property-header>\n        {/* {this.adultChildCount.adult === 0 && <p class={'col text-left'}>Please select the number of guests</p>} */}\n        <div class=\" text-left\">\n          {isRequestPending('/Check_Availability') && this.isEventType('EDIT_BOOKING') ? (\n            <div class=\"loading-container\">\n              <div class=\"loader\"></div>\n            </div>\n          ) : (\n            <Fragment>\n              {booking_store.roomTypes?.map(roomType => (\n                <igl-room-type\n                  initialRoomIds={this.initialRoomIds}\n                  isBookDisabled={Object.keys(this.bookedByInfoData).length <= 1}\n                  key={`room-type-${roomType.id}`}\n                  currency={this.currency}\n                  ratePricingMode={this.ratePricingMode}\n                  dateDifference={this.dateRangeData.dateDifference}\n                  bookingType={this.bookingData.event_type}\n                  roomType={roomType}\n                  class=\"mt-2 mb-1 p-0\"\n                  data-testid={`room_type_${roomType.id}`}\n                  id={roomType.id.toString()}\n                  roomInfoId={this.selectedRooms.has(`c_${roomType.id}`) ? roomType.id : null}\n                  onDataUpdateEvent={evt => this.roomsDataUpdate.emit(evt.detail)}\n                ></igl-room-type>\n              ))}\n            </Fragment>\n          )}\n        </div>\n\n        {/* <igl-book-property-footer class={'p-0 mb-1 mt-3'} eventType={this.bookingData.event_type}></igl-book-property-footer> */}\n      </Host>\n    );\n  }\n}\n",":host {\n  overflow-x: hidden;\n  --ir-dialog-max-width: 20rem;\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: inherit !important;\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n\n.font-medium {\n  font-weight: 600;\n}\n\n:host th {\n  font-weight: 600;\n}\n.h-28 {\n  height: 2rem;\n}\n.mx-01 {\n  --m: 5px;\n  margin-right: var(--m) !important;\n  margin-left: var(--m) !important;\n}\n\n.date-margin {\n  margin-right: 5px;\n}\n.pickup-margin {\n  margin-bottom: 7px !important;\n}\n.header-date {\n  padding-left: 5px !important;\n}\n\n.pointer {\n  cursor: pointer;\n}\n\n:root {\n  --sidebar-width: 50rem;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.sm-padding-right {\n  padding-right: 0.2rem;\n}\n.sm-padding-left {\n  padding-left: 0.2rem;\n}\n.sm-padding-top {\n  padding-top: 0.2rem;\n}\n.sm-padding-bottom {\n  padding-bottom: 0.2rem;\n}\n\n.info-notes {\n  list-style: none;\n  padding-left: 0;\n}\n.light-blue-bg {\n  background-color: #acecff;\n  padding: 0.2rem 0.3rem;\n}\n.iframeHeight {\n  height: 17.5rem;\n}\n\n.dialog-title {\n  width: fit-content;\n}\n","import { Component, Listen, h, Prop, Watch, State, Event, EventEmitter, Element, Fragment } from '@stencil/core';\nimport { Booking, ExtraService, Guest, IPmsLog, Room, SharedPerson } from '@/models/booking.dto';\nimport axios from 'axios';\nimport { BookingService } from '@/services/booking.service';\nimport { IglBookPropertyPayloadAddRoom, TIglBookPropertyPayload } from '@/models/igl-book-property';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@components/ui/ir-toast/toast';\nimport { ICountry, IEntries } from '@/models/IBooking';\nimport { IPaymentAction, PaymentService } from '@/services/payment.service';\nimport Token from '@/models/Token';\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent } from './types';\nimport calendar_data from '@/stores/calendar-data';\nimport moment from 'moment';\nimport { IrModalCustomEvent } from '@/components';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n\n@Component({\n  tag: 'ir-booking-details',\n  styleUrl: 'ir-booking-details.css',\n  scoped: true,\n})\nexport class IrBookingDetails {\n  @Element() element: HTMLElement;\n  // Setup Data\n  @Prop() language: string = 'en';\n  @Prop() ticket: string = '';\n  @Prop() bookingNumber: string = '';\n  @Prop() propertyid: number;\n  @Prop() is_from_front_desk = false;\n  @Prop() p: string;\n  // Booleans Conditions\n  @Prop() hasPrint: boolean = false;\n  @Prop() hasReceipt: boolean = false;\n  @Prop() hasDelete: boolean = false;\n  @Prop() hasMenu: boolean = false;\n\n  // Room Booleans\n  @Prop() hasRoomEdit: boolean = false;\n  @Prop() hasRoomDelete: boolean = false;\n  @Prop() hasRoomAdd: boolean = false;\n  @Prop() hasCheckIn: boolean = false;\n  @Prop() hasCheckOut: boolean = false;\n  @Prop() hasCloseButton = false;\n\n  @State() bookingItem: TIglBookPropertyPayload | null = null;\n  @State() statusData = [];\n\n  @State() showPaymentDetails: any;\n  @State() booking: Booking;\n  @State() countries: ICountry[];\n  @State() calendarData: any = {};\n  // Guest Data\n  @State() guestData: Guest = null;\n  // Rerender Flag\n  @State() rerenderFlag = false;\n  @State() sidebarState: BookingDetailsSidebarEvents | null = null;\n  @State() sidebarPayload: any;\n  @State() isUpdateClicked = false;\n\n  @State() pms_status: IPmsLog;\n  @State() isPMSLogLoading: boolean = false;\n  @State() paymentActions: IPaymentAction[];\n  @State() property_id: number;\n  @State() selectedService: ExtraService;\n  @State() bedPreference: IEntries[];\n  @State() roomGuest: any;\n  @State() modalState: { type: 'email' | (string & {}); message: string; loading: boolean } = null;\n  @State() departureTime: IEntries[];\n  @State() paymentTypes: IEntries[];\n  @State() paymentTypesGroups: IEntries[];\n\n  // Payment Event\n  @Event() toast: EventEmitter<IToast>;\n  @Event() bookingChanged: EventEmitter<Booking>;\n  @Event() closeSidebar: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private paymentService = new PaymentService();\n  private token = new Token();\n\n  private printingBaseUrl = 'https://gateway.igloorooms.com/PrintBooking/%1/printing?id=%2';\n  private modalRef: HTMLIrModalElement;\n\n  componentWillLoad() {\n    if (this.ticket !== '') {\n      this.token.setToken(this.ticket);\n      this.initializeApp();\n    }\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.initializeApp();\n  }\n\n  @Listen('openSidebar')\n  handleSideBarEvents(e: CustomEvent<OpenSidebarEvent<unknown>>) {\n    this.sidebarState = e.detail.type;\n    this.sidebarPayload = e.detail.payload;\n  }\n\n  @Listen('clickHandler')\n  handleIconClick(e: CustomEvent) {\n    const target = e.target as HTMLIrButtonElement;\n    switch (target.id) {\n      case 'pickup':\n        this.sidebarState = 'pickup';\n        return;\n      case 'close':\n        this.closeSidebar.emit(null);\n        return;\n      case 'email':\n        this.modalState = {\n          type: 'email',\n          message: locales.entries.Lcz_EmailBookingto.replace('%1', this.booking.guest.email),\n          loading: isRequestPending('/Send_Booking_Confirmation_Email'),\n        };\n        this.modalRef.openModal();\n        return;\n      case 'print':\n        this.openPrintingScreen();\n        return;\n      case 'receipt':\n        this.openPrintingScreen('invoice');\n        return;\n      case 'book-delete':\n        return;\n      case 'menu':\n        window.location.href = 'https://x.igloorooms.com/manage/acbookinglist.aspx';\n        return;\n      case 'room-add':\n        (this.bookingItem as IglBookPropertyPayloadAddRoom) = {\n          ID: '',\n          NAME: this.booking.guest.last_name,\n          EMAIL: this.booking.guest.email,\n          PHONE: this.booking.guest.mobile,\n          REFERENCE_TYPE: '',\n          FROM_DATE: this.booking.from_date,\n          ARRIVAL: this.booking.arrival,\n          TO_DATE: this.booking.to_date,\n          TITLE: `${locales.entries.Lcz_AddingUnitToBooking}# ${this.booking.booking_nbr}`,\n          defaultDateRange: {\n            fromDate: new Date(this.booking.from_date),\n            fromDateStr: '',\n            toDate: new Date(this.booking.to_date),\n            toDateStr: '',\n            dateDifference: 0,\n            message: '',\n          },\n          event_type: 'ADD_ROOM',\n          booking: this.booking,\n          BOOKING_NUMBER: this.booking.booking_nbr,\n          ADD_ROOM_TO_BOOKING: this.booking.booking_nbr,\n          GUEST: this.booking.guest,\n          message: this.booking.remark,\n          SOURCE: this.booking.source,\n          ROOMS: this.booking.rooms,\n        };\n        return;\n      case 'extra_service_btn':\n        this.sidebarState = 'extra_service';\n        return;\n      case 'add-payment':\n        return;\n    }\n  }\n\n  @Listen('resetExposedCancellationDueAmount')\n  async handleResetExposedCancellationDueAmount(e: CustomEvent) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    //TODO: Payment action\n    const paymentActions = await this.paymentService.GetExposedCancellationDueAmount({ booking_nbr: this.booking.booking_nbr, currency_id: this.booking.currency.id });\n    this.paymentActions = [...paymentActions];\n  }\n  @Listen('editInitiated')\n  handleEditInitiated(e: CustomEvent<TIglBookPropertyPayload>) {\n    this.bookingItem = e.detail;\n  }\n  @Listen('updateRoomGuests')\n  handleRoomGuestsUpdate(e: CustomEvent<{ identifier: string; guests: SharedPerson[] }>) {\n    const { identifier, guests } = e.detail;\n    const rooms = [...this.booking.rooms];\n    let currentRoomIndex = rooms.findIndex(r => r.identifier === identifier);\n    if (currentRoomIndex === -1) {\n      return;\n    }\n    const currentRoom = rooms[currentRoomIndex];\n    const updatedRoom = { ...currentRoom, sharing_persons: guests };\n    rooms[currentRoomIndex] = updatedRoom;\n    this.booking = { ...this.booking, rooms: [...rooms] };\n  }\n\n  @Listen('resetBookingEvt')\n  async handleResetBooking(e: CustomEvent<Booking | null>) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    if (e.detail) {\n      return (this.booking = e.detail);\n    }\n    await this.resetBooking();\n  }\n  @Listen('editExtraService')\n  handleEditExtraService(e: CustomEvent) {\n    this.selectedService = e.detail;\n    this.sidebarState = 'extra_service';\n  }\n\n  private setRoomsData(roomServiceResp) {\n    let roomsData: { [key: string]: any }[] = new Array();\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\n      roomsData = roomServiceResp.My_Result.roomtypes;\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\n        roomCategory.expanded = true;\n      });\n    }\n    this.calendarData.roomsInfo = roomsData;\n  }\n  private async initializeApp() {\n    try {\n      const [roomResponse, languageTexts, countriesList, bookingDetails, setupEntries] = await Promise.all([\n        this.roomService.getExposedProperty({ id: this.propertyid || 0, language: this.language, aname: this.p }),\n        this.roomService.fetchLanguage(this.language),\n        this.bookingService.getCountries(this.language),\n        this.bookingService.getExposedBooking(this.bookingNumber, this.language),\n        this.bookingService.getSetupEntriesByTableNameMulti(['_BED_PREFERENCE_TYPE', '_DEPARTURE_TIME', '_PAY_TYPE', '_PAY_TYPE_GROUP']),\n      ]);\n      this.property_id = roomResponse?.My_Result?.id;\n      const { bed_preference_type, departure_time, pay_type, pay_type_group } = this.bookingService.groupEntryTablesResult(setupEntries);\n      this.bedPreference = bed_preference_type;\n      this.departureTime = departure_time;\n      this.paymentTypes = pay_type;\n      this.paymentTypesGroups = pay_type_group;\n      console.log(departure_time);\n      if (bookingDetails?.booking_nbr && bookingDetails?.currency?.id && bookingDetails.is_direct) {\n        this.paymentService\n          .GetExposedCancellationDueAmount({\n            booking_nbr: bookingDetails.booking_nbr,\n            currency_id: bookingDetails.currency.id,\n          })\n          .then(res => {\n            this.paymentActions = res;\n          });\n      }\n      if (!locales?.entries) {\n        locales.entries = languageTexts.entries;\n        locales.direction = languageTexts.direction;\n      }\n      this.countries = countriesList;\n      const myResult = roomResponse?.My_Result;\n      if (myResult) {\n        const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends, aname } = myResult;\n        this.printingBaseUrl = this.printingBaseUrl.replace('%1', aname).replace('%2', this.bookingNumber);\n        this.calendarData = {\n          currency,\n          allowed_booking_sources,\n          adult_child_constraints,\n          legendData: calendar_legends,\n        };\n        this.setRoomsData(roomResponse);\n        const paymentCodesToShow = ['001', '004'];\n        this.showPaymentDetails = paymentMethods?.some(method => paymentCodesToShow.includes(method.code));\n      } else {\n        console.warn(\"Room response is missing 'My_Result'.\");\n      }\n\n      // Set guest and booking data\n      this.guestData = bookingDetails.guest;\n      this.booking = bookingDetails;\n    } catch (error) {\n      console.error('Error initializing app:', error);\n    }\n  }\n\n  private async openPrintingScreen(mode: 'invoice' | 'print' = 'print', version: 'old' | 'new' = 'new') {\n    if (version === 'old') {\n      if (mode === 'invoice') {\n        return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=I&TK=${this.ticket}`);\n      }\n      return window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.booking.system_id}&&PM=B&TK=${this.ticket}`);\n    }\n    let url = this.printingBaseUrl;\n    if (mode === 'invoice') {\n      url = url + '&mode=invoice';\n    }\n    const { data } = await axios.post(`Get_ShortLiving_Token`);\n    if (!data.ExceptionMsg) {\n      url = url + `&token=${data.My_Result}`;\n    }\n    window.open(url);\n  }\n\n  private handleCloseBookingWindow() {\n    this.bookingItem = null;\n  }\n\n  private handleDeleteFinish(e: CustomEvent) {\n    this.booking = { ...this.booking, rooms: this.booking.rooms.filter(room => room.identifier !== e.detail) };\n  }\n\n  private async resetBooking() {\n    try {\n      const booking = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\n      this.booking = { ...booking };\n      this.bookingChanged.emit(this.booking);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private async handleModalConfirm(e: IrModalCustomEvent<any>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    switch (this.modalState.type) {\n      case 'email':\n        await this.bookingService.sendBookingConfirmationEmail(this.booking.booking_nbr, this.language);\n        break;\n    }\n    this.modalState = null;\n    this.modalRef.closeModal();\n  }\n  private renderSidebarContent() {\n    const handleClose = () => {\n      this.sidebarState = null;\n    };\n    switch (this.sidebarState) {\n      case 'guest':\n        return (\n          <ir-guest-info\n            isInSideBar\n            headerShown\n            slot=\"sidebar-body\"\n            booking_nbr={this.bookingNumber}\n            email={this.booking?.guest.email}\n            language={this.language}\n            onCloseSideBar={handleClose}\n          ></ir-guest-info>\n        );\n      case 'pickup':\n        return (\n          <ir-pickup\n            bookingDates={{ from: this.booking.from_date, to: this.booking.to_date }}\n            slot=\"sidebar-body\"\n            defaultPickupData={this.booking.pickup_info}\n            bookingNumber={this.booking.booking_nbr}\n            numberOfPersons={this.booking.occupancy.adult_nbr + this.booking.occupancy.children_nbr}\n            onCloseModal={handleClose}\n          ></ir-pickup>\n        );\n      case 'extra_note':\n        return <ir-booking-extra-note slot=\"sidebar-body\" booking={this.booking} onCloseModal={() => (this.sidebarState = null)}></ir-booking-extra-note>;\n      case 'extra_service':\n        return (\n          <ir-extra-service-config\n            service={this.selectedService}\n            booking={{ from_date: this.booking.from_date, to_date: this.booking.to_date, booking_nbr: this.booking.booking_nbr, currency: this.booking.currency }}\n            slot=\"sidebar-body\"\n            onCloseModal={() => {\n              handleClose();\n              if (this.selectedService) {\n                this.selectedService = null;\n              }\n            }}\n          ></ir-extra-service-config>\n        );\n      case 'room-guest':\n        return (\n          <ir-room-guests\n            countries={this.countries}\n            language={this.language}\n            identifier={this.sidebarPayload?.identifier}\n            bookingNumber={this.booking.booking_nbr}\n            roomName={this.sidebarPayload?.roomName}\n            totalGuests={this.sidebarPayload?.totalGuests}\n            sharedPersons={this.sidebarPayload?.sharing_persons}\n            slot=\"sidebar-body\"\n            checkIn={this.sidebarPayload?.checkin}\n            onCloseModal={handleClose}\n          ></ir-room-guests>\n        );\n      case 'payment-folio':\n        return (\n          <ir-payment-folio\n            paymentTypesGroups={this.paymentTypesGroups}\n            bookingNumber={this.booking.booking_nbr}\n            paymentTypes={this.paymentTypes}\n            slot=\"sidebar-body\"\n            payment={this.sidebarPayload.payment}\n            mode={this.sidebarPayload.mode}\n            onCloseModal={handleClose}\n          ></ir-payment-folio>\n        );\n      default:\n        return null;\n    }\n  }\n  render() {\n    if (!this.booking) {\n      return (\n        <div class={'loading-container'}>\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    return [\n      <Fragment>\n        {!this.is_from_front_desk && (\n          <Fragment>\n            <ir-toast></ir-toast>\n            <ir-interceptor></ir-interceptor>\n          </Fragment>\n        )}\n      </Fragment>,\n      <ir-booking-header\n        booking={this.booking}\n        hasCloseButton={this.hasCloseButton}\n        hasDelete={this.hasDelete}\n        hasMenu={this.hasMenu}\n        hasPrint={this.hasPrint}\n        hasReceipt={this.hasReceipt}\n        hasEmail={['001', '002'].includes(this.booking?.status?.code)}\n      ></ir-booking-header>,\n      <div class=\"fluid-container p-1 text-left mx-0\">\n        <div class=\"row m-0\">\n          <div class=\"col-12 p-0 mx-0 pr-lg-1 col-lg-6\">\n            <ir-reservation-information countries={this.countries} booking={this.booking}></ir-reservation-information>\n            <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\n              <ir-date-view from_date={this.booking.from_date} to_date={this.booking.to_date}></ir-date-view>\n              {\n                // this.hasRoomAdd && this.booking.is_direct && this.booking.is_editable && (\n                this.hasRoomAdd && this.booking.is_editable && <ir-button id=\"room-add\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\n              }\n            </div>\n            <div class=\"card p-0 mx-0\">\n              {this.booking.rooms.map((room: Room, index: number) => {\n                const showCheckin = this.handleRoomCheckin(room);\n                const showCheckout = this.handleRoomCheckout(room);\n                return [\n                  <ir-room\n                    room={room}\n                    property_id={this.property_id}\n                    language={this.language}\n                    departureTime={this.departureTime}\n                    bedPreferences={this.bedPreference}\n                    isEditable={this.booking.is_editable}\n                    legendData={this.calendarData.legendData}\n                    roomsInfo={this.calendarData.roomsInfo}\n                    myRoomTypeFoodCat={room.roomtype.name}\n                    mealCodeName={room.rateplan.short_name}\n                    currency={this.booking.currency.symbol}\n                    hasRoomEdit={this.hasRoomEdit && this.booking.status.code !== '003' && this.booking.is_direct}\n                    hasRoomDelete={this.hasRoomDelete && this.booking.status.code !== '003' && this.booking.is_direct}\n                    hasCheckIn={showCheckin}\n                    hasCheckOut={showCheckout}\n                    booking={this.booking}\n                    bookingIndex={index}\n                    onDeleteFinished={this.handleDeleteFinish.bind(this)}\n                  />,\n                  index !== this.booking.rooms.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />,\n                ];\n              })}\n            </div>\n            {/* <ir-ota-services services={this.booking.ota_services}></ir-ota-services> */}\n            <ir-pickup-view booking={this.booking}></ir-pickup-view>\n            <section>\n              <div class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\n                <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_ExtraServices}</p>\n                <ir-button id=\"extra_service_btn\" icon_name=\"square_plus\" variant=\"icon\" style={{ '--icon-size': '1.5rem' }}></ir-button>\n              </div>\n              <ir-extra-services\n                booking={{ booking_nbr: this.booking.booking_nbr, currency: this.booking.currency, extra_services: this.booking.extra_services }}\n              ></ir-extra-services>\n            </section>\n          </div>\n          <div class=\"col-12 p-0 m-0 pl-lg-1 col-lg-6\">\n            <ir-payment-details paymentTypes={this.paymentTypes} paymentActions={this.paymentActions} booking={this.booking}></ir-payment-details>\n          </div>\n        </div>\n      </div>,\n      <ir-modal\n        modalBody={this.modalState?.message}\n        leftBtnText={locales.entries.Lcz_Cancel}\n        rightBtnText={locales.entries.Lcz_Confirm}\n        autoClose={false}\n        isLoading={isRequestPending('/Send_Booking_Confirmation_Email')}\n        ref={el => (this.modalRef = el)}\n        onConfirmModal={e => {\n          this.handleModalConfirm(e);\n        }}\n        onCancelModal={() => {\n          this.modalRef.closeModal();\n        }}\n      ></ir-modal>,\n      <ir-sidebar\n        open={this.sidebarState !== null}\n        side={'right'}\n        id=\"editGuestInfo\"\n        style={{ '--sidebar-width': this.sidebarState === 'room-guest' ? '60rem' : undefined }}\n        onIrSidebarToggle={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.sidebarState = null;\n        }}\n        showCloseButton={false}\n      >\n        {this.renderSidebarContent()}\n      </ir-sidebar>,\n      <Fragment>\n        {this.bookingItem && (\n          <igl-book-property\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\n            adultChildConstraints={this.calendarData.adult_child_constraints}\n            showPaymentDetails={this.showPaymentDetails}\n            countries={this.countries}\n            currency={this.calendarData.currency}\n            language={this.language}\n            propertyid={this.property_id}\n            bookingData={this.bookingItem}\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\n          ></igl-book-property>\n        )}\n      </Fragment>,\n    ];\n  }\n  private handleRoomCheckout(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    return room.in_out.code === '001';\n  }\n  private handleRoomCheckin(room: Room): boolean {\n    if (!calendar_data.checkin_enabled || calendar_data.is_automatic_check_in_out) {\n      return false;\n    }\n    if (!room.unit) {\n      return false;\n    }\n    if (room.in_out && room.in_out.code !== '000') {\n      return false;\n    }\n    if (moment().isSameOrAfter(moment(room.from_date, 'YYYY-MM-DD'), 'days') && moment().isBefore(moment(room.to_date, 'YYYY-MM-DD'), 'days')) {\n      return true;\n    }\n    return false;\n  }\n}\n",":host {\n  display: block;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { getPrivateNote } from '@/utils/booking';\n@Component({\n  tag: 'ir-booking-extra-note',\n  styleUrls: ['ir-booking-extra-note.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrBookingExtraNote {\n  @Prop() booking: Booking;\n\n  @State() isLoading = false;\n  @State() note = '';\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<Booking | null>;\n\n  private bookingService = new BookingService();\n  componentWillLoad() {\n    if (this.booking.extras) {\n      this.setNote(getPrivateNote(this.booking.extras));\n    }\n  }\n\n  private setNote(value: string) {\n    this.note = value;\n  }\n  private async savePrivateNote() {\n    try {\n      this.isLoading = true;\n      let prevExtras = this.booking.extras || [];\n      const newExtraObj = { key: 'private_note', value: this.note };\n      if (prevExtras.length === 0) {\n        prevExtras.push(newExtraObj);\n      } else {\n        const oldPrivateNoteIndex = prevExtras.findIndex(e => e.key === 'private_note');\n        if (oldPrivateNoteIndex === -1) {\n          prevExtras.push(newExtraObj);\n        } else {\n          prevExtras[oldPrivateNoteIndex] = newExtraObj;\n        }\n      }\n      const res = await this.bookingService.doReservation({\n        assign_units: true,\n        is_pms: true,\n        is_direct: true,\n        is_in_loyalty_mode: false,\n        promo_key: null,\n        booking: this.booking,\n        Is_Non_Technical_Change: true,\n        extras: prevExtras,\n      });\n      this.resetBookingEvt.emit(res);\n      this.closeModal.emit(null);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container h-100'}\n        onSubmit={e => {\n          e.preventDefault();\n          this.savePrivateNote();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_PrivateNote} displayContext=\"sidebar\"></ir-title>\n        <div class=\"sheet-body px-1\">\n          <ir-textarea placeholder={locales.entries.Lcz_PrivateNote_MaxChar} label=\"\" value={this.note} maxLength={150} onTextChange={e => this.setNote(e.detail)}></ir-textarea>\n        </div>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClickHandler={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`mb-1 mb-sm-0 flex-fill  mr-sm-1'}`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'m-0 flex-fill text-center ml-sm-1'}\n            isLoading={this.isLoading}\n            text={locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n            btn_type=\"submit\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n.iframeHeight {\n  height: max-content;\n  height: 22.5rem;\n}\n","import { Component, h, Prop, State } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { toFloat } from '@/utils/utils';\nimport locales from '@/stores/locales.store';\nimport calendar_data from '@/stores/calendar-data';\n\n@Component({\n  styleUrl: 'ir-booking-guarantee.css',\n  tag: 'ir-booking-guarantee',\n  scoped: true,\n})\nexport class IrBookingGuarantee {\n  @Prop() booking: Booking;\n  @Prop() bookingService: BookingService;\n\n  @State() collapsed: boolean = false;\n  @State() paymentDetailsUrl: string = '';\n  @State() paymentExceptionMessage: string = '';\n\n  async componentWillLoad() {\n    try {\n      // Initialize any required data\n    } catch (error) {\n      if (this.booking.guest.cci) {\n        return;\n      }\n      if (!this.booking.is_direct && this.booking.channel_booking_nbr) {\n        this.paymentExceptionMessage = error;\n      }\n    }\n  }\n\n  private formatCurrency(amount: number, currency: string, locale: string = 'en-US'): string {\n    if (!currency || amount < 0) {\n      return '';\n    }\n\n    return new Intl.NumberFormat(locale, {\n      style: 'currency',\n      currency,\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(amount);\n  }\n\n  private checkPaymentCode(value: string): string | null {\n    return calendar_data.allowed_payment_methods?.find(pm => pm.code === value)?.description ?? null;\n  }\n\n  private getPaymentMethod(): string | null {\n    let paymentMethod = null;\n    const payment_code = this.booking?.extras?.find(e => e.key === 'payment_code');\n\n    if (this.booking.agent) {\n      const code = this.booking?.extras?.find(e => e.key === 'agent_payment_mode');\n      if (code) {\n        paymentMethod = code.value === '001' ? locales.entries.Lcz_OnCredit : payment_code ? this.checkPaymentCode(payment_code.value) : null;\n      }\n    } else if (payment_code) {\n      paymentMethod = this.checkPaymentCode(payment_code.value);\n    }\n\n    return paymentMethod;\n  }\n\n  private async handleToggleCollapse() {\n    if (!this.booking.is_direct && this.booking.channel_booking_nbr && !this.booking.guest.cci && !this.collapsed) {\n      this.paymentDetailsUrl = await this.bookingService.getPCICardInfoURL(this.booking.booking_nbr);\n    }\n    this.collapsed = !this.collapsed;\n  }\n\n  private shouldShowGuarantee(): boolean {\n    const paymentMethod = this.booking.is_direct ? this.getPaymentMethod() : null;\n    return this.booking.is_direct ? Boolean(paymentMethod || this.booking.guest.cci) : true;\n  }\n\n  private shouldShowToggleButton() {\n    return !this.booking.is_direct || (this.booking.is_direct && this.booking.guest.cci);\n  }\n\n  private renderCreditCardInfo() {\n    const { cci } = this.booking.guest;\n    if (!cci) return null;\n\n    return [\n      <div>\n        {cci && 'Card:'} <span>{cci.nbr || ''}</span>\n        {cci.expiry_month && ' Expiry: '}\n        <span>\n          {cci.expiry_month || ''}\n          {cci.expiry_year && '/' + cci.expiry_year}\n        </span>\n      </div>,\n      <div>\n        {cci.holder_name && 'Name:'} <span>{cci.holder_name || ''}</span>\n        {cci.cvc && ' - CVC:'} <span>{cci.cvc || ''}</span>\n      </div>,\n    ];\n  }\n\n  private renderCollapsedContent() {\n    if (this.booking.guest.cci) {\n      return this.renderCreditCardInfo();\n    }\n\n    if (this.paymentDetailsUrl) {\n      return <iframe src={this.paymentDetailsUrl} width=\"100%\" class=\"iframeHeight\" frameborder=\"0\" name=\"payment\" />;\n    }\n\n    return <div class=\"text-center\">{this.paymentExceptionMessage}</div>;\n  }\n\n  private renderOtaGuarantee() {\n    const { ota_guarante } = this.booking;\n    if (!ota_guarante || this.booking.is_direct) return null;\n\n    return (\n      <div>\n        <ir-label content={ota_guarante.card_type + `${ota_guarante.is_virtual ? ' (virtual)' : ''}`} labelText={`${locales.entries.Lcz_CardType}:`} />\n        <ir-label content={ota_guarante.cardholder_name} labelText={`${locales.entries.Lcz_CardHolderName}:`} />\n        <ir-label content={ota_guarante.card_number} labelText={`${locales.entries.Lcz_CardNumber}:`} />\n        <ir-label\n          content={this.formatCurrency(\n            toFloat(Number(ota_guarante.meta?.virtual_card_current_balance), Number(ota_guarante.meta?.virtual_card_decimal_places)),\n            ota_guarante.meta?.virtual_card_currency_code,\n          )}\n          labelText={`${locales.entries.Lcz_CardBalance}:`}\n        />\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.shouldShowGuarantee()) {\n      return null;\n    }\n\n    const paymentMethod = this.booking.is_direct ? this.getPaymentMethod() : null;\n\n    return (\n      <div class=\"mb-1\">\n        <div class=\"d-flex align-items-center\">\n          <span class=\"mr-1 font-medium\">\n            {locales.entries.Lcz_BookingGuarantee}\n            {paymentMethod && <span>: {paymentMethod}</span>}\n          </span>\n\n          {this.shouldShowToggleButton() && (\n            <ir-button\n              id=\"drawer-icon\"\n              data-toggle=\"collapse\"\n              data-target=\".guarrantee\"\n              aria-expanded={this.collapsed ? 'true' : 'false'}\n              aria-controls=\"myCollapse\"\n              class=\"sm-padding-right pointer\"\n              variant=\"icon\"\n              icon_name=\"credit_card\"\n              onClickHandler={this.handleToggleCollapse.bind(this)}\n            />\n          )}\n        </div>\n\n        <div class=\"collapse guarrantee\">{this.renderCollapsedContent()}</div>\n\n        {this.renderOtaGuarantee()}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.confirmed {\n  color: #fff;\n  display: flex;\n  align-items: center;\n}\n.bg-ir-green {\n  background: #629a4c;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n.bg-ir-red {\n  background: #ff4961;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n.bg-ir-orange {\n  background: #ff9149;\n  padding: 0.2rem 0.3rem;\n  /* height: 28px; */\n  /* padding-top: 0 !important;\n  padding-bottom: 0 !important ; */\n}\n","import { IToast } from '@/components/ui/ir-toast/toast';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\nimport calendar_data from '@/stores/calendar-data';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, h, Listen, Prop, State } from '@stencil/core';\nimport { BookingDetailsDialogEvents, OpenDialogEvent, OpenSidebarEvent } from '../types';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-booking-header',\n  styleUrl: 'ir-booking-header.css',\n  scoped: true,\n})\nexport class IrBookingHeader {\n  @Prop() booking: Booking;\n  @Prop() hasReceipt: boolean;\n  @Prop() hasPrint: boolean;\n  @Prop() hasDelete: boolean;\n  @Prop() hasMenu: boolean;\n  @Prop() hasCloseButton: boolean;\n  @Prop() hasEmail: boolean = true;\n\n  @State() bookingStatus: string | null = null;\n  @State() currentDialogStatus: BookingDetailsDialogEvents;\n\n  @Event() toast: EventEmitter<IToast>;\n  @Event() closeSidebar: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\n\n  private confirmationBG = {\n    '001': 'bg-ir-orange',\n    '002': 'bg-ir-green',\n    '003': 'bg-ir-red',\n    '004': 'bg-ir-red',\n  };\n  private dialogRef: HTMLIrDialogElement;\n\n  private bookingService = new BookingService();\n  private alertMessage = `ALERT! Modifying an OTA booking will create a discrepancy between igloorooms and the source. Future guest modifications on the OTA may require manual adjustments of the booking.`;\n  modalEl: HTMLIrModalElement;\n\n  @Listen('selectChange')\n  handleSelectChange(e: CustomEvent<any>) {\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n    const target = e.target;\n    this.bookingStatus = (target as any).selectedValue;\n  }\n  private async updateStatus() {\n    if (!this.bookingStatus || this.bookingStatus === '-1') {\n      this.toast.emit({\n        type: 'error',\n        description: '',\n        title: locales.entries.Lcz_SelectStatus,\n        position: 'top-right',\n      });\n      return;\n    }\n    try {\n      await this.bookingService.changeExposedBookingStatus({\n        book_nbr: this.booking.booking_nbr,\n        status: this.bookingStatus,\n      });\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: locales.entries.Lcz_StatusUpdatedSuccessfully,\n        position: 'top-right',\n      });\n      this.bookingStatus = null;\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private openDialog(e: OpenDialogEvent) {\n    const { type } = e;\n    this.currentDialogStatus = type;\n    this.dialogRef.openModal();\n  }\n  private renderDialogBody() {\n    switch (this.currentDialogStatus) {\n      case 'pms':\n        return <ir-pms-logs slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-pms-logs>;\n      case 'events-log':\n        return <ir-events-log booking={this.booking} slot=\"modal-body\" bookingNumber={this.booking.booking_nbr}></ir-events-log>;\n    }\n  }\n\n  render() {\n    const lastManipulation = this.booking.ota_manipulations ? this.booking.ota_manipulations[this.booking.ota_manipulations.length - 1] : null;\n    return (\n      <div class=\"fluid-container px-1\">\n        <div class=\"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1\">\n          <div class=\"m-0 p-0 mb-1 mb-lg-0 mt-md-0\">\n            <p class=\"font-size-large m-0 p-0\">{`${locales.entries.Lcz_Booking}#${this.booking.booking_nbr}`}</p>\n            <p class=\"m-0 p-0\">{!this.booking.is_direct && <span class=\"mr-1 m-0\">{this.booking.channel_booking_nbr}</span>}</p>\n          </div>\n\n          <div class=\"d-flex justify-content-end align-items-center\" style={{ gap: '1rem', flexWrap: 'wrap' }}>\n            <div class=\"d-flex flex-column align-items-center\">\n              <span class={`confirmed btn-sm m-0  ${this.confirmationBG[this.booking.is_requested_to_cancel ? '003' : this.booking.status.code]}`}>\n                {this.booking.is_requested_to_cancel ? locales.entries.Lcz_CancellationRequested : this.booking.status.description}\n              </span>\n              {lastManipulation && (\n                <ir-popover\n                  trigger=\"hover\"\n                  renderContentAsHtml\n                  content={`<div><p>Modified by ${lastManipulation.user} at ${lastManipulation.date} ${lastManipulation.hour}:${lastManipulation.minute}.</p>\n                <p>${this.alertMessage}</p></div>`}\n                >\n                  <p class=\"mx-0 p-0 small text-danger\" style={{ marginTop: '0.25rem', marginBottom: '0' }}>\n                    <b>Modified</b>\n                  </p>\n                </ir-popover>\n              )}\n            </div>\n            {this.booking.allowed_actions.length > 0 && this.booking.is_editable && (\n              <div class=\"m-0 p-0 d-flex align-items-center\" style={{ gap: '0.25rem' }}>\n                <ir-select\n                  selectContainerStyle=\"h-28\"\n                  selectStyles=\"d-flex status-select align-items-center h-28\"\n                  firstOption={locales.entries.Lcz_Select}\n                  id=\"update-status\"\n                  size=\"sm\"\n                  label-available=\"false\"\n                  data={this.booking.allowed_actions.map(b => ({ text: b.description, value: b.code }))}\n                  textSize=\"sm\"\n                  class=\"sm-padding-right m-0 \"\n                  selectedValue={this.bookingStatus}\n                ></ir-select>\n                <ir-button\n                  onClickHandler={() => {\n                    if (!this.booking.is_direct) {\n                      this.modalEl.openModal();\n                      return;\n                    }\n                    this.updateStatus();\n                  }}\n                  btn_styles=\"h-28\"\n                  isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n                  btn_disabled={isRequestPending('/Change_Exposed_Booking_Status')}\n                  id=\"update-status-btn\"\n                  size=\"sm\"\n                  text=\"Update\"\n                ></ir-button>\n              </div>\n            )}\n            <ir-button\n              size=\"sm\"\n              btn_color=\"outline\"\n              text={locales.entries.Lcz_EventsLog}\n              onClickHandler={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                this.openDialog({ type: 'events-log' });\n              }}\n            ></ir-button>\n            {calendar_data.is_pms_enabled && (\n              <ir-button\n                size=\"sm\"\n                btn_color=\"outline\"\n                text={locales.entries.Lcz_pms}\n                onClick={e => {\n                  e.stopImmediatePropagation();\n                  e.stopPropagation();\n                  this.openDialog({ type: 'pms' });\n                }}\n              ></ir-button>\n            )}\n            {this.hasReceipt && <ir-button variant=\"icon\" id=\"receipt\" icon_name=\"reciept\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasPrint && <ir-button variant=\"icon\" id=\"print\" icon_name=\"print\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasEmail && <ir-button variant=\"icon\" id=\"email\" title=\"Email this booking\" icon_name=\"email\" class=\"\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasDelete && <ir-button variant=\"icon\" id=\"book-delete\" icon_name=\"trash\" class=\"\" style={{ ...colorVariants.danger, '--icon-size': '1.65rem' }}></ir-button>}\n            {this.hasMenu && <ir-button variant=\"icon\" class=\"mr-1\" id=\"menu\" icon_name=\"menu_list\" style={{ '--icon-size': '1.65rem' }}></ir-button>}\n\n            {this.hasCloseButton && (\n              <ir-button\n                id=\"close\"\n                variant=\"icon\"\n                style={{ '--icon-size': '1.65rem' }}\n                icon_name=\"xmark\"\n                class=\"ml-2\"\n                onClickHandler={e => {\n                  e.stopPropagation();\n                  e.stopImmediatePropagation();\n                  this.closeSidebar.emit(null);\n                }}\n              ></ir-button>\n            )}\n          </div>\n        </div>\n        <ir-dialog\n          onOpenChange={e => {\n            if (!e.detail) {\n              this.currentDialogStatus = null;\n            }\n          }}\n          style={this.currentDialogStatus === 'events-log' && { '--ir-dialog-max-width': 'max-content' }}\n          ref={el => (this.dialogRef = el)}\n        >\n          {this.renderDialogBody()}\n        </ir-dialog>\n        <ir-modal\n          ref={el => (this.modalEl = el)}\n          modalTitle={''}\n          leftBtnText={locales?.entries?.Lcz_Cancel}\n          rightBtnText={locales?.entries?.Lcz_Confirm}\n          modalBody={locales.entries.Lcz_OTA_Modification_Alter}\n          isLoading={isRequestPending('/Change_Exposed_Booking_Status')}\n          onConfirmModal={this.updateStatus.bind(this)}\n        ></ir-modal>\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n.backdrop {\n  opacity: 0;\n  background: rgba(0, 0, 0, 0.2);\n  position: fixed;\n  inset: 0;\n  z-index: 99999998;\n}\n.backdrop[data-state='opened'] {\n  animation: overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\n}\n.backdrop[data-state='closed'] {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.modal-container {\n  box-sizing: border-box;\n  margin: 0;\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\n  position: fixed;\n  z-index: 99999999;\n  overflow-y: auto;\n  top: 50%;\n  left: 50%;\n  background: white;\n  transform: translate(-50%, -50%);\n  width: 90%;\n  min-height: fit-content;\n  height: fit-content;\n  max-width: var(--ir-dialog-max-width, 40rem);\n  min-width: var(--ir-dialog-min-width);\n  max-height: 85vh;\n  border-radius: 8px;\n  padding: 0;\n  animation: contentShow 300ms cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n.modal-footer ::slotted(*) {\n  flex-direction: row;\n  align-items: center;\n  justify-content: end;\n  gap: 8px;\n  --ir-btn-width: inherit;\n}\n.modal-footer {\n  --ir-btn-width: 100%;\n}\n.modal-title ::slotted(*) {\n  font-size: 18px;\n  font-weight: 600;\n  color: #101828;\n  margin-bottom: 8px;\n}\n.modal-body ::slotted(*) {\n  font-size: 14px;\n  font-weight: 400;\n  color: #475467;\n  padding: 0;\n  margin: 0;\n}\n\n@keyframes overlayShow {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes contentShow {\n  from {\n    opacity: 0;\n    transform: translate(-50%, -48%) scale(0.96);\n  }\n  to {\n    opacity: 1;\n    transform: translate(-50%, -50%) scale(1);\n  }\n}\n.dialog-close-button {\n  position: absolute;\n  top: 15px;\n  right: 15px;\n}\n/* md */\n","import { Component, Host, h, Element, Method, Listen, State, Event, EventEmitter, Prop, Watch } from '@stencil/core';\n\n@Component({\n  tag: 'ir-dialog',\n  styleUrl: 'ir-dialog.css',\n  shadow: true,\n})\nexport class IrDialog {\n  @Element() el: HTMLElement;\n\n  /**\n   * Controls whether the dialog should be opened.\n   * Can be updated externally and watched internally.\n   */\n  @Prop() open: boolean = false;\n\n  /**\n   * Internal open state, driven by `open` prop or internal logic.\n   */\n  @State() isOpen = false;\n\n  /**\n   * Emits the open/close state of the modal.\n   *\n   * Example:\n   * ```tsx\n   * <ir-dialog onOpenChange={(e) => console.log(e.detail)} />\n   * ```\n   */\n  @Event() openChange: EventEmitter<boolean>;\n\n  private firstFocusableElement: HTMLElement;\n  private lastFocusableElement: HTMLElement;\n\n  componentWillLoad() {\n    if (this.open) {\n      this.openModal();\n    }\n  }\n  componentDidLoad() {\n    this.prepareFocusTrap();\n  }\n  /**\n   * Opens the modal dialog programmatically.\n   * Applies `overflow: hidden` to the `body`.\n   *\n   * Example:\n   * ```ts\n   * const dialog = document.querySelector('ir-dialog');\n   * await dialog.openModal();\n   * ```\n   */\n  @Method()\n  async openModal() {\n    this.isOpen = true;\n    document.body.style.overflow = 'hidden';\n    setTimeout(() => {\n      this.prepareFocusTrap();\n    }, 10);\n    this.openChange.emit(this.isOpen);\n  }\n  /**\n   * Closes the modal dialog programmatically.\n   * Reverts body scroll and emits `openChange`.\n   */\n  @Method()\n  async closeModal() {\n    console.log('close');\n    if (!this.isOpen) {\n      return;\n    }\n    document.body.style.overflow = 'visible';\n    this.isOpen = false;\n    this.openChange.emit(this.isOpen);\n  }\n\n  @Watch('open')\n  handleOpenChange() {\n    if (this.open) {\n      this.openModal();\n    } else {\n      this.closeModal();\n    }\n  }\n\n  @Listen('keydown', { target: 'window' })\n  handleKeyDown(ev: KeyboardEvent) {\n    if (!this.isOpen) {\n      return;\n    }\n\n    let isTabPressed = ev.key === 'Tab';\n    if (ev.key === 'Escape' && this.isOpen) {\n      this.closeModal();\n    }\n    if (!isTabPressed) {\n      return;\n    }\n\n    // If focus is about to leave the last focusable element, redirect it to the first.\n    if (!ev.shiftKey && document.activeElement === this.lastFocusableElement) {\n      this.firstFocusableElement.focus();\n      ev.preventDefault();\n    }\n\n    // If focus is about to leave the first focusable element, redirect it to the last.\n    if (ev.shiftKey && document.activeElement === this.firstFocusableElement) {\n      this.lastFocusableElement.focus();\n      ev.preventDefault();\n    }\n  }\n\n  disconnectedCallback() {\n    document.body.style.overflow = 'visible';\n  }\n  /**\n   * Finds and traps focus within modal content for accessibility.\n   */\n  private prepareFocusTrap() {\n    const focusableElements = 'button,ir-dropdown ,[href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n    const focusableContent: NodeListOf<HTMLElement> = this.el.shadowRoot.querySelectorAll(focusableElements);\n    // console.log(focusableContent);\n    if (focusableContent.length === 0) return;\n    this.firstFocusableElement = focusableContent[0];\n    this.lastFocusableElement = focusableContent[focusableContent.length - 1];\n    this.firstFocusableElement.focus();\n  }\n  render() {\n    return (\n      <Host>\n        <div class=\"backdrop\" data-state={this.isOpen ? 'opened' : 'closed'} onClick={() => this.closeModal()}></div>\n        {this.isOpen && (\n          <div class=\"modal-container\" tabIndex={-1} role=\"dialog\" aria-labelledby=\"dialog1Title\" aria-describedby=\"dialog1Desc\">\n            <ir-icon id=\"close\" class=\"dialog-close-button\" onIconClickHandler={() => this.closeModal()}>\n              <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={18} width={18}>\n                <path\n                  fill=\"#104064\"\n                  class=\"currentColor\"\n                  d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                />\n              </svg>\n            </ir-icon>\n            <div class={'modal-title'} id=\"dialog1Title\">\n              <slot name=\"modal-title\"></slot>\n            </div>\n            <div class=\"modal-body\" id=\"dialog1Desc\">\n              <slot name=\"modal-body\"></slot>\n            </div>\n            <div class=\"modal-footer\">\n              <slot name=\"modal-footer\"></slot>\n            </div>\n          </div>\n        )}\n      </Host>\n    );\n  }\n}\n","/* Existing styles */\n\n/* New styles for the overlay dropdown */\n.dropdown-menu {\n  z-index: 1000;\n  width: 100%;\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.dropdown.nav-item.show .dropdown-menu {\n  display: block; /* display the dropdown when the parent has the \"show\" class */\n}\n.caret-icon {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-55%);\n  right: 0.25rem;\n  z-index: 99999;\n}\n.dropdown-trigger {\n  position: relative;\n}\n.caret-icon.disabled {\n  opacity: 0.5 !important;\n  pointer-events: none !important;\n  cursor: not-allowed !important;\n}\n","import { Component, Prop, State, h, Event, EventEmitter, Host, Element, Listen, Watch } from '@stencil/core';\n\nexport type DropdownItem = {\n  value: string | number;\n};\n\n@Component({\n  tag: 'ir-dropdown',\n  styleUrl: 'ir-dropdown.css',\n  scoped: true,\n})\nexport class IrDropdown {\n  @Element() el: HTMLIrDropdownElement;\n\n  @Prop({ reflect: true, mutable: true }) value: DropdownItem['value'];\n\n  @Prop({ reflect: true, mutable: true }) disabled: boolean = false;\n\n  @State() isOpen: boolean = false;\n  @State() selectedOption: DropdownItem['value'];\n  @State() focusedIndex: number = -1;\n  @State() itemChildren: HTMLIrDropdownItemElement[] = [];\n\n  private mo: MutationObserver | null = null;\n  private documentClickHandler: (event: Event) => void;\n  private isComponentConnected: boolean = true;\n  private updateQueued: boolean = false;\n\n  /**\n   * Emitted when a user selects an option from the combobox.\n   * The event payload contains the selected `DropdownItem` object.\n   */\n  @Event() optionChange: EventEmitter<DropdownItem['value']>;\n\n  componentWillLoad() {\n    this.selectedOption = this.value;\n    this.documentClickHandler = this.handleDocumentClick.bind(this);\n    this.collectItemChildren();\n\n    // Optimized mutation observer with debouncing\n    this.mo = new MutationObserver(() => {\n      if (!this.updateQueued) {\n        this.updateQueued = true;\n        requestAnimationFrame(() => {\n          if (this.isComponentConnected) {\n            this.collectItemChildren();\n            this.updateQueued = false;\n          }\n        });\n      }\n    });\n    this.mo.observe(this.el, { childList: true, subtree: true });\n  }\n\n  componentDidLoad() {\n    document.addEventListener('click', this.documentClickHandler, { passive: true });\n\n    // Single RAF call instead of multiple setTimeouts\n    requestAnimationFrame(() => {\n      if (this.isComponentConnected) {\n        this.updateItemElements();\n        if (this.value) {\n          this.updateDropdownItemValue(this.value);\n        }\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n    document.removeEventListener('click', this.documentClickHandler);\n    this.mo?.disconnect();\n    this.mo = null;\n  }\n\n  @Listen('keydown', { target: 'document' })\n  handleDocumentKeyDown(event: KeyboardEvent) {\n    if (!this.isOpen || !this.isComponentConnected) return;\n\n    if (event.key === 'Escape') {\n      this.closeDropdown();\n    }\n  }\n\n  @Listen('dropdownItemSelect')\n  handleDropdownItemSelect(ev: CustomEvent<DropdownItem['value']>) {\n    if (!this.isComponentConnected) return;\n\n    ev.stopPropagation();\n    this.selectOption(ev.detail);\n    (ev.target as HTMLIrDropdownItemElement).setAttribute('aria-selected', 'true');\n  }\n\n  @Listen('dropdownItemRegister')\n  handleDropdownItemRegister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Listen('dropdownItemUnregister')\n  handleDropdownItemUnregister() {\n    if (!this.isComponentConnected) return;\n    this.collectItemChildren();\n  }\n\n  @Watch('value')\n  handleValueChange(newValue: DropdownItem['value'], oldValue: DropdownItem['value']) {\n    if (newValue !== oldValue && this.isComponentConnected) {\n      this.updateDropdownItemValue(newValue);\n    }\n  }\n\n  private updateDropdownItemValue(value: DropdownItem['value']) {\n    // Clear previous selections immediately\n    this.itemChildren.forEach(el => el.removeAttribute('aria-selected'));\n\n    // Set new selection\n    const el = this.itemChildren.find(el => el.value === value);\n    if (el) {\n      el.setAttribute('aria-selected', 'true');\n    }\n  }\n\n  private getSelectedItemIndex(): number {\n    if (!this.value) return -1;\n    return this.itemChildren.findIndex(item => item.value === this.value);\n  }\n\n  private openDropdown() {\n    try {\n      this.isOpen = true;\n      // Initialize focus to the currently selected item\n      this.focusedIndex = this.getSelectedItemIndex();\n      // Immediate update instead of setTimeout\n      this.updateItemElements();\n\n      // Auto-scroll to selected item if it exists\n      if (this.focusedIndex >= 0) {\n        requestAnimationFrame(() => {\n          this.scrollToSelectedItem();\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  private closeDropdown() {\n    this.isOpen = false;\n    this.focusedIndex = -1;\n    this.removeItemFocus();\n  }\n\n  private handleDocumentClick = (event: Event) => {\n    if (!this.isComponentConnected || !this.el.contains(event.target as Node)) {\n      this.closeDropdown();\n    }\n  };\n\n  private collectItemChildren() {\n    if (!this.isComponentConnected) return;\n\n    const items = Array.from(this.el.querySelectorAll('ir-dropdown-item')) as HTMLIrDropdownItemElement[];\n    this.itemChildren = items;\n\n    // Immediate update instead of setTimeout\n    this.updateItemElements();\n  }\n\n  private updateItemElements() {\n    if (!this.isComponentConnected) return;\n\n    // Use the collected item children directly\n    this.itemChildren.forEach((el, index) => {\n      el.setAttribute('data-slot-index', String(index));\n      el.setAttribute('role', 'option');\n      el.setAttribute('tabindex', '-1');\n    });\n  }\n\n  private removeItemFocus() {\n    this.itemChildren.forEach(element => {\n      element.classList.remove('focused', 'active');\n      // Don't remove aria-selected as it indicates selection, not focus\n    });\n  }\n\n  private focusItemElement(index: number) {\n    this.removeItemFocus();\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.classList.add('focused');\n      element.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n    }\n  }\n\n  private selectItemElement(index: number) {\n    if (index >= 0 && index < this.itemChildren.length) {\n      const element = this.itemChildren[index];\n      element.click();\n    }\n  }\n\n  private scrollToSelectedItem() {\n    if (this.focusedIndex >= 0 && this.focusedIndex < this.itemChildren.length) {\n      const selectedElement = this.itemChildren[this.focusedIndex];\n      if (selectedElement) {\n        selectedElement.scrollIntoView({\n          block: 'nearest',\n          behavior: 'smooth',\n          inline: 'nearest',\n        });\n      }\n    }\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    if (!this.isComponentConnected || this.disabled) return;\n\n    const maxIndex = this.itemChildren.length - 1;\n\n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from next item\n          if (this.focusedIndex >= 0 && this.focusedIndex < maxIndex) {\n            this.focusedIndex++;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from first item\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === maxIndex) {\n            // At last item, wrap to first\n            this.focusedIndex = 0;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex < maxIndex ? this.focusedIndex + 1 : 0;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'ArrowUp':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.openDropdown();\n          // After opening, if we have a selection, start from previous item\n          if (this.focusedIndex > 0) {\n            this.focusedIndex--;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === -1) {\n            // No selection, start from last item\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          } else if (this.focusedIndex === 0) {\n            // At first item, wrap to last\n            this.focusedIndex = maxIndex;\n            this.focusItemElement(this.focusedIndex);\n          }\n        } else if (maxIndex >= 0) {\n          this.focusedIndex = this.focusedIndex > 0 ? this.focusedIndex - 1 : maxIndex;\n          this.focusItemElement(this.focusedIndex);\n        }\n        break;\n\n      case 'Enter':\n        event.preventDefault();\n        if (this.isOpen && this.focusedIndex >= 0) {\n          this.selectItemElement(this.focusedIndex);\n        } else if (!this.isOpen) {\n          this.openDropdown();\n        }\n        break;\n\n      case 'Escape':\n        event.preventDefault();\n        this.closeDropdown();\n        break;\n\n      case 'Tab':\n        if (this.isOpen) {\n          this.closeDropdown();\n        }\n        break;\n    }\n  };\n\n  private selectOption(option: DropdownItem['value']) {\n    this.selectedOption = option;\n    this.value = option;\n    this.optionChange.emit(option);\n    this.closeDropdown();\n  }\n\n  render() {\n    return (\n      <Host class={`dropdown ${this.isOpen ? 'show' : ''}`}>\n        <div\n          onClick={() => {\n            if (this.disabled) return;\n            if (this.isOpen) {\n              this.closeDropdown();\n            } else {\n              this.openDropdown();\n            }\n          }}\n          aria-disabled={String(this.disabled)}\n          class={`dropdown-trigger ${this.disabled ? 'disabled' : ''}`}\n          onKeyDown={this.handleKeyDown}\n          tabindex=\"0\"\n        >\n          <slot name=\"trigger\"></slot>\n          <div class={`caret-icon ${this.disabled ? 'disabled' : ''}`}>\n            <ir-icons name={!this.isOpen ? 'angle-down' : 'angle-up'}></ir-icons>\n          </div>\n        </div>\n        <div class=\"dropdown-menu\" role=\"listbox\" aria-expanded={this.isOpen.toString()}>\n          <slot></slot>\n        </div>\n      </Host>\n    );\n  }\n}\n","/* ir-m-combobox-item.css */\n:host {\n  display: block;\n  cursor: pointer;\n}\n:host([hidden]) {\n  display: none !important;\n}\n:host(.focused) {\n  background: #f4f5fa !important;\n}\n:host(.active),\n:host([aria-selected='true']),\n:host:active {\n  /* keep in sync with your combobox .dropdown-item.active styles */\n  outline: none;\n  background-color: var(--blue, #1e9ff2) !important;\n  color: white !important;\n}\n:host(.dropdown-item) {\n  padding: 0.5rem 1rem !important;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n","import { Component, Element, Event, EventEmitter, Host, Method, Prop, h } from '@stencil/core';\nimport { DropdownItem } from '../ir-dropdown/ir-dropdown';\n\n@Component({\n  tag: 'ir-dropdown-item',\n  styleUrl: 'ir-dropdown-item.css',\n  scoped: true,\n})\nexport class IrDropdownItem {\n  @Element() el: HTMLIrDropdownItemElement;\n\n  private isComponentConnected: boolean = true;\n  private hasRegistered: boolean = false;\n\n  /**\n   * Required value for the option\n   */\n  @Prop() value!: string;\n\n  /**\n   * Optional label (falls back to textContent)\n   */\n  @Prop() label?: string;\n\n  /**\n   * Optional html_content (when you want rich content);\n   * If omitted, the component will render its own slot content.\n   */\n  @Prop() html_content?: string;\n\n  /**\n   * When true, visually hide the item (used for filtering).\n   */\n  @Prop({ mutable: true, reflect: true }) hidden: boolean = false;\n\n  /**\n   * Emit when this item is chosen. Parent listens and closes dropdown.\n   */\n  @Event({ eventName: 'dropdownItemSelect' }) dropdownItemSelect: EventEmitter<DropdownItem['value']>;\n\n  /**\n   * Inform the parent this item exists (parent will index and manage focus)\n   */\n  @Event({ eventName: 'dropdownItemRegister' }) dropdownItemRegister: EventEmitter<void>;\n\n  /**\n   * Inform the parent this item is gone\n   */\n  @Event({ eventName: 'dropdownItemUnregister' }) dropdownItemUnregister: EventEmitter<void>;\n\n  componentDidLoad() {\n    if (this.isComponentConnected && !this.hasRegistered) {\n      this.hasRegistered = true;\n      // Use RAF to ensure parent is ready\n      requestAnimationFrame(() => {\n        if (this.isComponentConnected) {\n          this.dropdownItemRegister.emit();\n        }\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    this.isComponentConnected = false;\n\n    // Only emit unregister if we previously registered and parent might still be connected\n    if (this.hasRegistered && this.el.parentElement) {\n      // Check if parent dropdown still exists in DOM\n      const parentDropdown = this.el.closest('ir-dropdown');\n      if (parentDropdown && document.contains(parentDropdown)) {\n        this.dropdownItemUnregister.emit();\n      }\n    }\n    this.hasRegistered = false;\n  }\n\n  @Method()\n  async matchesQuery(query: string): Promise<boolean> {\n    if (!this.isComponentConnected) return false;\n\n    const q = query.toLowerCase();\n    const hay = (this.label ?? this.el.textContent ?? '').toLowerCase();\n    return hay.includes(q);\n  }\n\n  @Method()\n  async setHidden(next: boolean) {\n    if (this.isComponentConnected) {\n      this.hidden = next;\n    }\n  }\n\n  private handleClick = (event: Event) => {\n    event.stopPropagation();\n\n    if (!this.isComponentConnected) return;\n\n    this.dropdownItemSelect.emit(this.value);\n  };\n\n  render() {\n    return (\n      <Host role=\"option\" tabindex=\"-1\" aria-selected=\"false\" class={{ 'dropdown-item': true, 'hidden': this.hidden }} onClick={this.handleClick} data-value={this.value}>\n        {this.html_content ? <span innerHTML={this.html_content}></span> : <slot></slot>}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n\n.beta {\n  background: var(--red);\n  color: white;\n  padding: 0.2rem 0.3rem;\n  font-size: 12px;\n  border-radius: 4px;\n  margin: 0;\n}\n.event-row {\n  padding-bottom: 0.5rem;\n}\n.list-title {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  font-weight: bold;\n  width: fit-content;\n}\n.list-item {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  margin-left: 5px;\n  width: fit-content;\n}\n.list-item.green {\n  color: #629a4c;\n  font-weight: 600;\n}\n.list-item.red {\n  color: #ff4961;\n  font-weight: 600;\n}\n.dates-row {\n  display: flex;\n  align-items: center;\n  gap: 0.875rem;\n}\n","import { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { Component, Fragment, Prop, State, h } from '@stencil/core';\nimport locales from '@/stores/locales.store';\nimport { Booking, ExposedBookingEvent } from '@/models/booking.dto';\n\n@Component({\n  tag: 'ir-events-log',\n  styleUrl: 'ir-events-log.css',\n  scoped: true,\n})\nexport class IrEventsLog {\n  @Prop() bookingNumber: string;\n  @Prop() booking: Booking;\n\n  @State() bookingEvents: ExposedBookingEvent[];\n\n  componentWillLoad() {\n    this.init();\n  }\n\n  private async init() {\n    try {\n      this.bookingEvents = this.booking.events;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"p-1\">\n        <div class=\"d-flex  align-items-center\" style={{ gap: '0.5rem' }}>\n          <h3 class=\" text-left p-0 m-0  dialog-title \">{locales.entries.Lcz_EventsLog}</h3>\n          {/* <span class=\"m-0 beta\">Beta</span> */}\n        </div>\n\n        {isRequestPending('/Get_Exposed_Booking_Events') ? (\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\n            <ir-spinner></ir-spinner>\n          </div>\n        ) : (\n          <Fragment>\n            <table class=\" dialog-container-height\">\n              <thead style={{ opacity: '0' }}>\n                <tr>\n                  <th>date</th>\n                  <th>user</th>\n                  <th>status</th>\n                </tr>\n              </thead>\n              <tbody>\n                {this.bookingEvents?.map(e => (\n                  <tr key={e.id} class=\"pb-1\">\n                    <td class=\"event-row dates-row\">\n                      <span>{e.date}</span>\n                      <span>\n                        {String(e.hour).padStart(2, '0')}:{String(e.minute).padStart(2, '0')}:{String(e.second).padStart(2, '0')}\n                      </span>\n                    </td>\n                    <td class=\"pl-3 event-row \">{e.type}</td>\n                    <td class=\"pl-1 event-row \">{e.user}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.extra-service-container {\n  display: flex;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n.extra-service-container * {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n.extra-service-actions {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.extra-service-conditional-date {\n  margin-top: 0.5rem;\n}\n.extra-service-price {\n  white-space: nowrap;\n}\n.extra-service-description {\n  word-break: break-all;\n}\n","import { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\nimport { ExtraService } from '@/models/booking.dto';\nimport { formatAmount } from '@/utils/utils';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport locales from '@/stores/locales.store';\nimport moment from 'moment';\nimport { BookingService } from '@/services/booking.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\n\n@Component({\n  tag: 'ir-extra-service',\n  styleUrl: 'ir-extra-service.css',\n  scoped: true,\n})\nexport class IrExtraService {\n  @Prop() service: ExtraService;\n  @Prop() bookingNumber: string;\n  @Prop() currencySymbol: string;\n\n  @Event() editExtraService: EventEmitter<ExtraService>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private irModalRef: HTMLIrModalElement;\n  private bookingService = new BookingService();\n\n  private async deleteService() {\n    try {\n      await this.bookingService.doBookingExtraService({\n        service: this.service,\n        is_remove: true,\n        booking_nbr: this.bookingNumber,\n      });\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    return (\n      <Host>\n        <div class=\"p-1\">\n          <div class={'extra-service-container'}>\n            <p class=\"extra-service-description\">{this.service.description}</p>\n            <div class=\"extra-service-actions\">\n              {!!this.service.price && this.service.price > 0 && (\n                <p class=\"extra-service-price p-0 m-0 font-weight-bold\">{formatAmount(this.currencySymbol, this.service.price)}</p>\n              )}\n              <ir-button\n                id={`serviceEdit-${this.service.booking_system_id}`}\n                class=\"extra-service-edit-btn m-0 p-0\"\n                variant=\"icon\"\n                icon_name=\"edit\"\n                style={colorVariants.secondary}\n                onClickHandler={() => this.editExtraService.emit(this.service)}\n              ></ir-button>\n              <ir-button\n                class=\"extra-service-delete-btn m-0 p-0\"\n                variant=\"icon\"\n                onClickHandler={() => this.irModalRef.openModal()}\n                id={`roomDelete-${this.service.booking_system_id}`}\n                icon_name=\"trash\"\n                style={colorVariants.danger}\n              ></ir-button>\n            </div>\n          </div>\n          <div class=\"extra-service-conditional-date\">\n            {this.service.start_date && this.service.end_date ? (\n              <ir-date-view class=\"extra-service-date-view mr-1\" from_date={this.service.start_date} to_date={this.service.end_date} showDateDifference={false}></ir-date-view>\n            ) : (\n              this.service.start_date && <p class=\"extra-service-date-view\">{moment(new Date(this.service.start_date)).format('MMM DD, YYYY')}</p>\n            )}\n          </div>\n        </div>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.irModalRef = el)}\n          isLoading={isRequestPending('/Do_Booking_Extra_Service')}\n          onConfirmModal={this.deleteService.bind(this)}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={locales.entries.Lcz_Delete}\n          leftBtnColor=\"secondary\"\n          rightBtnColor=\"danger\"\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={`${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${locales.entries.Lcz_ThisService} ${locales.entries.Lcz_FromThisBooking}`}\n        ></ir-modal>\n      </Host>\n    );\n  }\n}\n","import { z, ZodError, ZodIssueCode } from 'zod';\nimport { IAllowedOptions, ICurrency, IPickupCurrency } from './calendarData';\nimport { TSourceOption } from './igl-book-property';\nimport { ICountry } from './IBooking';\nimport moment from 'moment';\nimport { IHouseKeepers } from './housekeeping';\n\ninterface IDType {\n  code: string;\n  description: string;\n}\n\ninterface IDInfo {\n  type: IDType;\n  number: string;\n}\n\nexport interface SharedPerson {\n  address: null;\n  alternative_email: null;\n  cci: null;\n  city: null;\n  country: ICountry;\n  country_id: string;\n  country_phone_prefix: null;\n  dob: string;\n  email: null;\n  first_name: string;\n  full_name: string;\n  id: number;\n  id_info: IDInfo;\n  is_main?: boolean;\n  last_name: string;\n  mobile: null;\n  nbr_confirmed_bookings: number;\n  notes: null;\n  password: null;\n  subscribe_to_news_letter: null;\n}\n// export const ZIdInfo = z.object({\n//   type: z.object({\n//     code: z.string().min(3),\n//     description: z.string(),\n//   }),\n//   number: z.string().min(2),\n// });\n// export const ZSharedPerson = z.object({\n//   id: z.number(),\n//   full_name: z.string().min(2),\n//   country_id: z.coerce.number().min(0),\n//   dob: z.coerce.date().transform(date => moment(date).format('YYYY-MM-DD')),\n//   id_info: ZIdInfo,\n// });\n\n/**\n * ZIdInfo schema:\n * - `type.code`: Validates a non-empty string must be at least 3 chars.\n *   If empty string or not provided, validation is skipped.\n * - `type.description`: Same pattern for description (but no min length).\n * - `number`: Validates if non-empty string it should be at least 2 chars.\n */\nexport const ZIdInfo = z.object({\n  type: z.object({\n    code: z\n      .union([\n        // If provided and non-empty, must have at least 3 chars\n        z.string().min(3),\n        // or it can be an empty string\n        z.literal(''),\n      ])\n      .optional(), // or undefined\n    description: z\n      .union([\n        // If provided and non-empty, no special min\n        z.string(),\n        // or it can be empty string\n        z.literal(''),\n      ])\n      .optional(),\n  }),\n  number: z\n    .union([\n      // If provided and non-empty, must have at least 2 chars\n      z.string().min(2),\n      // or it can be empty string\n      z.literal(''),\n    ])\n    .optional()\n    .nullable(),\n});\n\n/**\n * ZSharedPerson schema:\n * - `id`: Optional numeric field.\n * - `full_name`: If provided and non-empty, must be at least 2 chars.\n * - `country_id`: If provided, coerced to number, must be >= 0.\n * - `dob`: If provided, coerced to Date and formatted. Otherwise skipped.\n * - `id_info`: The nested object above; can also be omitted entirely.\n */\nexport const ZSharedPerson = z.object({\n  id: z.number().optional(),\n  // full_name: z\n  //   .union([\n  //     z.string().min(2), // if provided and non-empty, must have min length 2\n  //     z.literal(''), // or it can be empty string\n  //   ])\n  //   .optional(),\n  first_name: z\n    .union([\n      z.string().min(2), // if provided and non-empty, must have min length 2\n      z.literal(''), // or it can be empty string\n    ])\n    .optional(),\n  // .nullable(),\n  last_name: z\n    .union([\n      z.string().min(2), // if provided and non-empty, must have min length 2\n      z.literal(''), // or it can be empty string\n    ])\n    .optional(),\n  // .nullable(),\n  country_id: z.coerce\n    .number()\n    .min(0) // if provided, must be >= 0\n    .optional(),\n  dob: z\n    .string()\n    .nullable()\n    .optional()\n    .refine(value => value === undefined || moment(value, 'DD/MM/YYYY', true).isValid() || value === '' || value === null, 'Invalid date format')\n    .transform(value => {\n      if (value === undefined || value === '' || value === null) return null;\n      const isDDMMYYYY = moment(value, 'DD/MM/YYYY', true).isValid();\n      return isDDMMYYYY ? null : moment(value, 'DD/MM/YYYY').format('YYYY-MM-DD');\n    }),\n  id_info: ZIdInfo.optional(),\n  is_main: z.boolean().default(false),\n});\n\n// export const ZSharedPersons = z.array(ZSharedPerson).superRefine((data, ctx) => {\n//   for (const d of data) {\n//     validateSharedPerson(d, ctx);\n//   }\n// });\n\nexport function validateSharedPerson(data: any) {\n  ZSharedPerson.parse(data);\n  const hasValue = (field: string | null | undefined): boolean => {\n    return field !== null && field !== undefined && field.trim() !== '';\n  };\n  const ctx = [];\n  if (data.is_main) {\n    if (!hasValue(data.first_name)) {\n      ctx.push({\n        path: ['first_name'],\n        code: ZodIssueCode.custom,\n        message: 'First name is required for main guest',\n      });\n    }\n\n    if (!hasValue(data.last_name)) {\n      ctx.push({\n        path: ['last_name'],\n        code: ZodIssueCode.custom,\n        message: 'Last name is required for main guest',\n      });\n    }\n  }\n\n  // For non-main guests: check if ANY field has data\n  const hasAnyFieldData =\n    hasValue(data.first_name) ||\n    hasValue(data.last_name) ||\n    hasValue(data.dob) ||\n    (data.country_id !== null && data.country_id !== undefined && data.country_id > 0) ||\n    hasValue(data.id_info?.number);\n\n  // If any field has data, then first_name and last_name become required\n  if (hasAnyFieldData) {\n    if (!hasValue(data.first_name)) {\n      ctx.push({\n        path: ['first_name'],\n        code: ZodIssueCode.custom,\n        message: 'First name is required when other guest information is provided',\n      });\n    }\n\n    if (!hasValue(data.last_name)) {\n      ctx.push({\n        path: ['last_name'],\n        code: ZodIssueCode.custom,\n        message: 'Last name is required when other guest information is provided',\n      });\n    }\n  }\n  if (ctx.length >= 1) {\n    throw new ZodError(ctx);\n  }\n}\nexport interface HandleExposedRoomGuestsRequest {\n  booking_nbr: string;\n  identifier: string;\n  guests: SharedPerson[];\n}\nexport interface OtaGuarantee {\n  card_number: string;\n  card_type: string;\n  cardholder_name: string;\n  cvv: string;\n  expiration_date: string;\n  is_virtual: boolean;\n  meta: Meta;\n  token: string;\n}\n\ninterface Meta {\n  virtual_card_currency_code: string;\n  virtual_card_current_balance: string;\n  virtual_card_decimal_places: string;\n  virtual_card_effective_date: string;\n  virtual_card_expiration_date: string;\n}\nexport interface OtaService {\n  name: string;\n  nights: number;\n  persons: number;\n  price_mode: string;\n  price_per_unit: number;\n  total_price: number;\n}\nexport interface ExposedBookingEvent {\n  date: string;\n  hour: number;\n  id: number;\n  minute: number;\n  second: number;\n  user: string;\n  type: string;\n}\n\nexport type OTAManipulations = {\n  user: string;\n  date: string;\n  hour: string;\n  minute: string;\n};\n\nexport type BypassedOtaRevisions = {\n  revision_nbr: number;\n  date: string;\n  revision_type: string;\n};\nexport interface Booking {\n  agent: {\n    code: string;\n    id: number;\n    name: string;\n    verification_mode: null;\n  } | null;\n  events: ExposedBookingEvent[];\n  ota_manipulations: OTAManipulations[];\n  bypassed_ota_revisions: BypassedOtaRevisions[];\n  ota_services: OtaService[];\n  is_requested_to_cancel: boolean;\n  arrival: Arrival;\n  allowed_actions: IAllowedActions[];\n  system_id: number;\n  booked_on: DateTime;\n  booking_nbr: string;\n  currency: Currency;\n  extra_services: ExtraService[] | null;\n  from_date: string;\n  guest: Guest;\n  extras: Extras[] | null;\n  occupancy: Occupancy;\n  origin: Origin;\n  ota_guarante: OtaGuarantee;\n  property: Property;\n  remark: string;\n  ota_notes: IOtaNotes[];\n  rooms: Room[];\n  source: Source;\n  status: Status;\n  to_date: string;\n  total: number;\n  is_editable: boolean;\n  format: IFormat;\n  channel_booking_nbr: string | null;\n  is_direct: boolean;\n  financial: IFinancial;\n  pickup_info: IBookingPickupInfo | null;\n  cost: number | null;\n  is_pms_enabled: boolean;\n  promo_key: string | null;\n  is_in_loyalty_mode: boolean;\n}\n\nexport const ExtraServiceSchema = z.object({\n  booking_system_id: z.number().optional(),\n  cost: z.coerce.number().nullable(),\n  currency_id: z.number().min(1),\n  description: z.string().min(1),\n  end_date: z.string().nullable(),\n  price: z.coerce.number(),\n  start_date: z.string().nullable(),\n  system_id: z.number().optional(),\n});\n\nexport type ExtraService = z.infer<typeof ExtraServiceSchema>;\nexport interface Extras {\n  key: string;\n  value: any;\n}\nexport interface IOtaNotes {\n  statement: string;\n}\nexport interface IBookingPickupInfo {\n  currency: IPickupCurrency;\n  date: string;\n  details: string;\n  hour: number;\n  minute: number;\n  nbr_of_units: number;\n  selected_option: IAllowedOptions;\n  total: number;\n}\nexport interface IAllowedActions {\n  code: string;\n  description: string;\n}\nexport interface IFinancial {\n  due_amount: number;\n  due_dates: IDueDate[];\n  payments: IPayment[] | null;\n  total_amount: number;\n  collected: number;\n  gross_total: number;\n  gross_cost: number;\n  invoice_nbr: string;\n}\nexport interface IPayment {\n  id: number | null;\n  date: string;\n  amount: number;\n  currency: ICurrency;\n  designation: string;\n  reference: string;\n  book_nbr?: string;\n  payment_gateway_code?: number;\n  payment_type?: PaymentType;\n}\n\ninterface PaymentType {\n  code: string;\n  description: string;\n  operation: string;\n}\n\nexport interface IDueDate {\n  amount: number;\n  currencysymbol: string;\n  date: string;\n  description: string;\n  room: string;\n}\nexport interface IFormat {\n  from_date: string;\n  to_date: string;\n}\nexport interface Arrival {\n  code: string;\n  description: string;\n}\n\nexport interface DateTime {\n  date: string;\n  hour: number;\n  minute: number;\n}\n\nexport interface Currency {\n  code: string;\n  id: number;\n  symbol: string;\n}\n\nexport interface Guest {\n  address: string | null;\n  city: string | null;\n  country_id: number | null;\n  dob: string | null;\n  email: string | null;\n  first_name: string;\n  id: number;\n  last_name: string | null;\n  mobile: string | null;\n  country_phone_prefix: string | null;\n  subscribe_to_news_letter: boolean | null;\n  cci?: ICCI | null;\n  alternative_email?: string;\n  nbr_confirmed_bookings: number;\n  notes: string;\n  mobile_without_prefix: string;\n}\nexport interface ICCI {\n  nbr: string | number;\n  holder_name: string | number;\n  expiry_month: string | number;\n  expiry_year: string | number;\n  cvc?: string | null;\n}\nexport interface Occupancy {\n  adult_nbr: number;\n  children_nbr: number;\n  infant_nbr: number | null;\n}\nexport interface DoReservationProps {\n  assign_units: boolean;\n  check_in: boolean;\n  is_pms: boolean;\n  is_direct: boolean;\n  is_in_loyalty_mode: boolean;\n  promo_key: string | null;\n  extras: any; // Assuming extras can have any structure, replace with a specific type if known\n  booking: {\n    from_date: string; // Format 'YYYY-MM-DD'\n    to_date: string; // Format 'YYYY-MM-DD'\n    remark: string | null;\n    booking_nbr: string;\n    property: {\n      id: string | number;\n    };\n    booked_on: {\n      date: string; // Format 'YYYY-MM-DD'\n      hour: number;\n      minute: number;\n    };\n    source: TSourceOption;\n    rooms: Room[]; // Assuming rooms are defined in the imported `Room` type\n    currency: string;\n    arrival: {\n      code: string;\n    };\n    guest: {\n      email: string | null;\n      first_name: string;\n      last_name: string;\n      country_id: string | number | null;\n      city: string | null;\n      mobile: string;\n      phone_prefix: string | null;\n      address: string;\n      dob: string | null;\n      subscribe_to_news_letter: boolean;\n      cci: {\n        nbr: string;\n        holder_name: string;\n        expiry_month: string;\n        expiry_year: string;\n      } | null;\n    };\n  };\n  pickup_info: any | null; // Assuming it can be any structure, replace if specific type is available\n}\nexport interface Origin {\n  Icon: string;\n  Label: string;\n}\n\nexport interface Property {\n  calendar_legends: null;\n  currency: null;\n  id: number;\n  name: string;\n  roomtypes: null;\n}\nexport type DepartureTime = {\n  code: string;\n  description: string;\n};\nexport type RoomInOut = { code: '001' | '002' | '000'; description: string };\nexport interface Room {\n  days: Day[];\n  from_date: string;\n  guest: Guest;\n  occupancy_default: number;\n  notes: string | null;\n  occupancy: Occupancy;\n  physicalroom: null;\n  in_out: RoomInOut | null;\n  sharing_persons: SharedPerson[] | null;\n  bed_preference: number | null;\n  rateplan: RatePlan;\n  roomtype: RoomType;\n  departure_time: DepartureTime;\n  to_date: string;\n  total: number;\n  smoking_option: string;\n  identifier: string;\n  unit: string | number | IUnit | null;\n  ota_taxes: IOtaTax[];\n  ota_meta: OtaMeta;\n\n  cost: number | null;\n  gross_cost: number;\n  gross_total: number;\n  guarantee: number;\n  gross_guarantee: number;\n}\ninterface OtaMeta {\n  bed_preferences: string | null;\n  meal_plan: string | null;\n  parent_rate_plan_id: string | null;\n  policies: string | null;\n  smoking_preferences: string | null;\n}\nexport interface IOtaTax {\n  amount: number;\n  currency: IOtaTaxCurrency;\n  is_exlusive: boolean;\n  name: string;\n}\nexport interface IOtaTaxCurrency {\n  code: string;\n  id: number;\n  symbol: string;\n}\nexport interface IUnit {\n  calendar_cell: null;\n  id: 2;\n  name: '402';\n}\nexport interface Day {\n  amount: number;\n  date: string;\n  cost: number | null;\n}\n\nexport interface RatePlan {\n  cancelation: string | null;\n  guarantee: null;\n  id: number;\n  name: string;\n  rate_restrictions: null;\n  variations: null;\n  selected_variation: IVariations;\n  is_non_refundable: boolean;\n  custom_text: string | null;\n  is_active: boolean;\n  short_name: string;\n}\nexport interface IVariations {\n  adult_child_offering: string;\n  adult_nbr: number;\n  amount: number | null;\n  child_nbr: number;\n}\nexport interface RoomType {\n  availabilities: null;\n  id: number;\n  inventory: number;\n  name: string;\n  physicalrooms: PhysicalRoom[];\n  rate: number;\n  rateplans: null;\n  is_active: boolean;\n}\nexport type RoomHkStatus = '001' | '002' | '003' | '004';\nexport interface PhysicalRoom {\n  calendar_cell: null;\n  housekeeper: IHouseKeepers;\n  id: number;\n  is_active: boolean;\n  name: string;\n  hk_status: RoomHkStatus;\n}\n\nexport interface Source {\n  code: string | null;\n  description: string;\n  tag: string | null;\n}\n\nexport interface Status {\n  code: string;\n  description: string;\n}\n\nexport interface IPmsLog {\n  is_acknowledged: boolean;\n  is_sent: boolean;\n  sent_date: string;\n  sent_hour: number;\n  sent_minute: number;\n}\n",":host {\n  display: block;\n  --ir-input-border-color: #cacfe7;\n}\n\n:host .input-group-text {\n  border-color: var(--ir-input-border-color);\n}\n/* .hidden-date-picker.hidden-dates .date-range-input {\n  opacity: 0;\n} */\n.currency-ph {\n  padding: 0;\n  margin: 0;\n  color: #3b4781;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0 0 0 0.25rem;\n  border-top: 1px solid var(--ir-input-border-color);\n  border-bottom: 1px solid var(--ir-input-border-color);\n  border-left: 1px solid transparent;\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, -webkit-box-shadow 0.15s ease-in-out;\n}\n\n.service-description-input {\n  height: 70px !important;\n}\n\n.service-description .input-group-prepend {\n  background-color: #f4f5fa;\n  border: 1px solid var(--ir-input-border-color);\n  border-top-left-radius: 0.25rem;\n  border-bottom-left-radius: 0.25rem;\n}\n.service-date-container {\n  padding: 0;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  position: relative;\n  width: 100%;\n  justify-content: center;\n}\n.service-date-container .btn-container {\n  position: absolute;\n  right: 5px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n}\n.service-description .input-group-text {\n  height: fit-content;\n  border: 0;\n  padding-top: 0.75rem !important;\n}\n\n.price-input-group:focus-within .currency-ph,\n.cost-input-group:focus-within .currency-ph {\n  border-top: 1px solid #1e9ff2;\n  border-bottom: 1px solid #1e9ff2;\n  border-left: 1px solid #1e9ff2;\n}\n.currency-ph[data-state='error'] {\n  border-color: var(--red, #ff4961);\n}\n.price-input:focus {\n  border-right-width: 1px !important;\n}\n\n.is-invalid {\n  background-image: none !important;\n}\n.price-input,\n.cost-input {\n  border-left: 0;\n}\n\n.row-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n@media (min-width: 640px) {\n  .row-group {\n    flex-direction: row;\n    align-items: center;\n    gap: 0;\n  }\n  .cost-label {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    border-left: 0;\n  }\n  .until-prepend,\n  .cost-input-placeholder {\n    border-top-left-radius: 0 !important;\n    border-bottom-left-radius: 0 !important;\n  }\n  .date-from,\n  .price-input {\n    border-right-width: 0 !important;\n    border-top-right-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n  }\n}\n\n.date-focused {\n  border-color: #1e9ff2;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Booking, ExtraService, ExtraServiceSchema } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { ZodError } from 'zod';\nimport { _formatDate } from '../../functions';\n\n@Component({\n  tag: 'ir-extra-service-config',\n  styleUrls: ['ir-extra-service-config.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrExtraServiceConfig {\n  @Prop() booking: Pick<Booking, 'from_date' | 'to_date' | 'currency' | 'booking_nbr'>;\n  @Prop() service: ExtraService;\n\n  @State() s_service: ExtraService;\n  @State() error: boolean;\n  @State() fromDateClicked: boolean;\n  @State() toDateClicked: boolean;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private bookingService = new BookingService();\n  // private d1: HTMLDivElement;\n  // private d1_0: HTMLDivElement;\n  // private d2_0: HTMLDivElement;\n  // private d2: HTMLInputElement;\n\n  componentWillLoad() {\n    if (this.service) {\n      this.s_service = { ...this.service };\n    }\n  }\n\n  private async saveAmenity() {\n    try {\n      ExtraServiceSchema.parse(this.s_service);\n      await this.bookingService.doBookingExtraService({\n        service: this.s_service,\n        booking_nbr: this.booking.booking_nbr,\n        is_remove: false,\n      });\n      this.resetBookingEvt.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        this.error = true;\n      }\n      console.error(error);\n    }\n  }\n  private updateService(params: Partial<ExtraService>) {\n    let prevService: ExtraService = this.s_service;\n    if (!prevService) {\n      prevService = {\n        cost: null,\n        description: null,\n        end_date: null,\n        start_date: null,\n        price: null,\n        currency_id: this.booking.currency.id,\n      };\n    }\n    this.s_service = { ...prevService, ...params };\n  }\n  private validatePrice(): boolean {\n    if (this.s_service?.price === undefined || this.s_service?.price?.toString() === '') {\n      return false;\n    }\n    const priceSchema = ExtraServiceSchema.pick({ price: true });\n    const result = priceSchema.safeParse({ price: this.s_service?.price });\n    return result.success;\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.saveAmenity();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_ExtraServices} displayContext=\"sidebar\"></ir-title>\n        <section class={'px-1 sheet-body'}>\n          {/* Description */}\n          <fieldset class=\"input-group mb-1 service-description\">\n            <div class=\"input-group-prepend\">\n              <span class=\"input-group-text\">{locales.entries.Lcz_Description}</span>\n            </div>\n            <textarea\n              value={this.s_service?.description}\n              class={`form-control service-description-input ${this.error && !this.s_service?.description ? 'is-invalid' : ''}`}\n              style={{ height: '7rem' }}\n              maxLength={250}\n              onChange={e => this.updateService({ description: (e.target as HTMLTextAreaElement).value })}\n              aria-label=\"Amenity description\"\n            ></textarea>\n          </fieldset>\n          {/* Dates */}\n          <div class={'row-group mb-1'}>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <span class=\"input-group-text\" id=\"basic-addon1\">\n                  {locales.entries.Lcz_DatesOn}\n                </span>\n              </div>\n              <div\n                // ref={el => (this.d1_0 = el)}\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center date-from\"\n              >\n                <div class=\"service-date-container\">\n                  <ir-date-picker\n                    // onDatePickerFocus={() => {\n                    //   this.d1?.classList.add('date-focused');\n                    //   this.d1_0?.classList.add('date-focused');\n                    // }}\n                    // onDatePickerBlur={() => {\n                    //   this.d1?.classList.remove('date-focused');\n                    //   this.d1_0?.classList.remove('date-focused');\n                    // }}\n                    // customPicker\n                    emitEmptyDate\n                    date={this.s_service?.start_date}\n                    minDate={this.booking.from_date}\n                    maxDate={this.booking.to_date}\n                    onDateChanged={e => this.updateService({ start_date: e.detail.start?.format('YYYY-MM-DD') })}\n                  >\n                    <input\n                      // ref={el => (this.d1 = el)}\n                      type=\"text\"\n                      slot=\"trigger\"\n                      value={this.s_service?.start_date ? _formatDate(this.s_service.start_date) : null}\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%', borderRadius: '0' }}\n                      class=\"text-center w-100 form-control input-sm\"\n                    ></input>\n                  </ir-date-picker>\n                  {this.s_service?.start_date && (\n                    <div class=\"btn-container\">\n                      <ir-button\n                        title=\"clear\"\n                        id=\"close\"\n                        variant=\"icon\"\n                        style={{ '--icon-size': '0.875rem' }}\n                        icon_name=\"xmark-fill\"\n                        class=\"ml-2\"\n                        onClickHandler={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          this.updateService({ start_date: null });\n                        }}\n                      ></ir-button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend \">\n                <span class=\"input-group-text until-prepend\" id=\"basic-addon1\">\n                  {locales.entries.Lcz_TillAndIncluding}\n                </span>\n              </div>\n              <div\n                // ref={el => (this.d2_0 = el)}\n                class=\"form-control p-0 m-0 d-flex align-items-center justify-content-center\"\n              >\n                <div class=\"service-date-container\">\n                  <ir-date-picker\n                    // onDatePickerFocus={() => {\n                    //   this.d2?.classList.add('date-focused');\n                    //   this.d2_0?.classList.add('date-focused');\n                    // }}\n                    // onDatePickerBlur={() => {\n                    //   this.d2?.classList.remove('date-focused');\n                    //   this.d2_0?.classList.remove('date-focused');\n                    // }}\n                    emitEmptyDate\n                    date={this.s_service?.end_date}\n                    minDate={this.s_service?.start_date ?? this.booking.from_date}\n                    maxDate={this.booking.to_date}\n                    onDateChanged={e => {\n                      e.stopImmediatePropagation();\n                      e.stopPropagation();\n                      this.updateService({ end_date: e.detail.start?.format('YYYY-MM-DD') });\n                    }}\n                  >\n                    <input\n                      // ref={el => (this.d2 = el)}\n                      slot=\"trigger\"\n                      value={this.s_service?.end_date ? _formatDate(this.s_service.end_date) : null}\n                      style={{ borderLeftWidth: '0', borderRightWidth: '0', width: '100%' }}\n                      class=\"text-center form-control input-sm\"\n                    ></input>\n                  </ir-date-picker>\n\n                  {this.s_service?.end_date && (\n                    <div class=\"btn-container\">\n                      <ir-button\n                        title=\"clear\"\n                        id=\"close\"\n                        variant=\"icon\"\n                        style={{ '--icon-size': '0.875rem' }}\n                        icon_name=\"xmark-fill\"\n                        class=\"ml-2\"\n                        onClickHandler={e => {\n                          e.stopImmediatePropagation();\n                          e.stopPropagation();\n                          this.updateService({ end_date: null });\n                        }}\n                      ></ir-button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n          {/* Prices and cost */}\n          <div class={'row-group'}>\n            <ir-price-input\n              label=\"Price\"\n              currency={this.booking.currency.symbol}\n              class=\"ir-br-input-none\"\n              value={this.s_service?.price?.toString()}\n              zod={ExtraServiceSchema.pick({ price: true })}\n              aria-label={locales.entries.Lcz_Price}\n              wrapKey=\"price\"\n              aria-describedby=\"service price\"\n              autoValidate={false}\n              data-state={this.error && !this.validatePrice() ? 'error' : ''}\n              onTextChange={e => this.updateService({ price: parseFloat(e.detail) })}\n            ></ir-price-input>\n            <ir-price-input\n              autoValidate={false}\n              label={locales.entries.Lcz_Cost}\n              labelStyle=\"rounded-0 border-left-0\"\n              currency={this.booking.currency.symbol}\n              // class=\"ir-bl-lbl-none ir-bl-none\"\n              value={this.s_service?.cost?.toString()}\n              zod={ExtraServiceSchema.pick({ cost: true })}\n              onTextChange={e => this.updateService({ cost: parseFloat(e.detail) })}\n              wrapKey=\"cost\"\n              aria-label=\"Cost\"\n              aria-describedby=\"service cost\"\n            ></ir-price-input>\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClick={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`flex-fill`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'flex-fill'}\n            btn_type=\"submit\"\n            isLoading={isRequestPending('/Do_Booking_Extra_Service')}\n            text={locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { Component, Fragment, Host, Prop, h } from '@stencil/core';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-extra-services',\n  styleUrl: 'ir-extra-services.css',\n  scoped: true,\n})\nexport class IrExtraServices {\n  @Prop() booking: Pick<Booking, 'currency' | 'extra_services' | 'booking_nbr'>;\n\n  render() {\n    return (\n      <Host class={'card p-0 '}>\n        {this.booking.extra_services?.map((service, index) => (\n          <Fragment>\n            <ir-extra-service\n              bookingNumber={this.booking.booking_nbr}\n              currencySymbol={this.booking.currency.symbol}\n              key={service.booking_system_id}\n              service={service}\n            ></ir-extra-service>\n            {index !== this.booking.extra_services.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />}\n          </Fragment>\n        ))}\n      </Host>\n    );\n  }\n}\n",".input-group-text {\n  min-width: 10rem;\n  text-align: left;\n}\n.mobilePrefixSelect {\n  border-right-width: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.mobilePrefixInput {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n\n/* custome checkbox */\n.check-container {\n  position: relative;\n  /* padding-left: 30px; */\n  cursor: pointer;\n  font-size: 14px;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  display: flex;\n  align-items: center;\n}\n.check-container input {\n  position: relative;\n  opacity: 0;\n  cursor: pointer;\n  height: 0;\n  width: 0;\n}\n.check-container .checkmark {\n  position: relative;\n  top: 0;\n  left: 0;\n  height: 20px;\n  width: 20px;\n  border: 1px solid #cacfe7;\n  border-radius: 4px;\n  transition: all 0.3s ease;\n}\n.check-container input:checked ~ .checkmark {\n  background-color: #1e9ff2;\n  border-color: #1e9ff2;\n}\n.checkmark:after {\n  content: '';\n  position: absolute;\n  display: none;\n}\n.check-container input:checked ~ .checkmark:after {\n  display: block;\n}\n.check-label {\n  margin-left: 10px !important;\n}\n.check-container .checkmark:after {\n  left: 6px;\n  top: 3px;\n  width: 6px;\n  height: 10px;\n  border: solid white;\n  border-width: 0 2px 2px 0;\n  -webkit-transform: rotate(45deg);\n  -ms-transform: rotate(45deg);\n  transform: rotate(45deg);\n}\n.ir-card-header {\n  width: 100%;\n  border-bottom: 1px solid #e4e5ec;\n}\n.close-icon {\n  margin: 0;\n}\n.border-theme {\n  border: 1px solid #cacfe7;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, State, h, Prop, EventEmitter, Event, Watch, Fragment } from '@stencil/core';\nimport { Guest } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry } from '@/components';\nimport { RoomService } from '@/services/room.service';\nimport locales from '@/stores/locales.store';\nimport Token from '@/models/Token';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { IToast } from '@components/ui/ir-toast/toast';\n\n@Component({\n  tag: 'ir-guest-info',\n  styleUrls: ['ir-guest-info.css', '../../common/sheet.css'],\n  scoped: true,\n})\nexport class GuestInfo {\n  @Prop() language: string;\n  @Prop() headerShown: boolean;\n  @Prop() email: string;\n  @Prop() booking_nbr: string;\n  @Prop() ticket: string;\n  @Prop() isInSideBar: boolean;\n\n  @State() countries: ICountry[];\n  // @State() submit: boolean = false;\n  @State() guest: Guest | null = null;\n  @State() isLoading: boolean = true;\n  @State() autoValidate = false;\n\n  @Event() closeSideBar: EventEmitter<null>;\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\n  @Event() toast: EventEmitter<IToast>;\n\n  private bookingService = new BookingService();\n  private roomService = new RoomService();\n  private token: Token = new Token();\n\n  async componentWillLoad() {\n    if (this.ticket) {\n      this.token.setToken(this.ticket);\n    }\n    if (!!this.token.getToken()) this.init();\n  }\n\n  @Watch('ticket')\n  ticketChanged(newValue: string, oldValue: string) {\n    if (newValue === oldValue) {\n      return;\n    }\n    this.token.setToken(this.ticket);\n    this.init();\n  }\n\n  async init() {\n    try {\n      console.log('first');\n      this.isLoading = true;\n      const [guest, countries, fetchedLocales] = await Promise.all([\n        this.bookingService.fetchGuest(this.email),\n        this.bookingService.getCountries(this.language),\n        !locales || !locales.entries || Object.keys(locales.entries).length === 0 ? this.roomService.fetchLanguage(this.language) : Promise.resolve(null), // Skip fetching if locales are already set\n      ]);\n\n      // Set the fetched locales if they were fetched\n      if (fetchedLocales) {\n        locales.entries = fetchedLocales.entries;\n        locales.direction = fetchedLocales.direction;\n      }\n\n      // Assign the fetched guest and countries\n      this.countries = countries;\n      this.guest = { ...guest, mobile: guest.mobile_without_prefix };\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  private handleInputChange(params: Partial<Guest>) {\n    this.guest = { ...this.guest, ...params };\n  }\n\n  private async editGuest() {\n    try {\n      this.autoValidate = true;\n\n      await this.bookingService.editExposedGuest(this.guest, this.booking_nbr ?? null);\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: 'Saved Successfully',\n        position: 'top-right',\n      });\n      this.closeSideBar.emit(null);\n      this.resetBookingEvt.emit(null);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  render() {\n    if (this.isLoading && this.isInSideBar) {\n      <div class={'loading-container'}>\n        <ir-spinner></ir-spinner>\n      </div>;\n    }\n    if (this.isLoading) {\n      return null;\n    }\n    return (\n      <form\n        class={'p-0 sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.editGuest();\n        }}\n      >\n        {!this.isInSideBar && [<ir-toast></ir-toast>, <ir-interceptor></ir-interceptor>]}\n        {this.headerShown && <ir-title class=\"px-1 sheet-header\" displayContext=\"sidebar\" label={locales.entries.Lcz_GuestDetails}></ir-title>}\n        <div class={this.isInSideBar ? 'sheet-body' : 'card-content collapse show '}>\n          <div class={this.headerShown ? 'card-body px-1 pt-0' : 'pt-0'}>\n            <ir-input-text\n              autoValidate={this.autoValidate}\n              label={locales.entries?.Lcz_FirstName}\n              name=\"firstName\"\n              // submitted={this.submit}\n              value={this.guest?.first_name}\n              required\n              onTextChange={e => this.handleInputChange({ first_name: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              autoValidate={this.autoValidate}\n              label={locales.entries?.Lcz_LastName}\n              name=\"lastName\"\n              // submitted={this.submit}\n              value={this.guest?.last_name}\n              required\n              onTextChange={e => this.handleInputChange({ last_name: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              label={locales.entries?.Lcz_Email}\n              name=\"email\"\n              // submitted={this.submit}\n              value={this.guest?.email}\n              required\n              onTextChange={e => this.handleInputChange({ email: e.detail })}\n            ></ir-input-text>\n            <ir-input-text\n              label={locales.entries?.Lcz_AlternativeEmail}\n              name=\"altEmail\"\n              value={this.guest?.alternative_email}\n              onTextChange={e => this.handleInputChange({ alternative_email: e.detail })}\n            ></ir-input-text>\n            {/* <ir-input-text label=\"Password\" placeholder=\"\" name=\"password\" submited={this.submit} type=\"password\" value={this.Model.password} required></ir-input-text> */}\n            {/* <ir-select\n              selectContainerStyle=\"mb-1\"\n              required\n              name=\"country\"\n              submited={this.submit}\n              label={locales.entries.Lcz_Country}\n              selectedValue={this.guest?.country_id?.toString() ?? ''}\n              data={this.countries?.map(item => {\n                return {\n                  value: item.id.toString(),\n                  text: item.name,\n                };\n              })}\n              firstOption={'...'}\n              onSelectChange={e => this.handleInputChange({ country_id: e.detail })}\n            ></ir-select> */}\n            <ir-country-picker\n              // error={this.submit && !this.guest.country_id}\n              country={this.countries.find(c => c.id === this.guest.country_id)}\n              label={locales.entries?.Lcz_Country}\n              onCountryChange={e => this.handleInputChange({ country_id: e.detail.id })}\n              countries={this.countries}\n            ></ir-country-picker>\n\n            <ir-phone-input\n              onTextChange={e => {\n                e.stopImmediatePropagation();\n                e.stopPropagation();\n                const { mobile, phone_prefix } = e.detail;\n                if (mobile !== this.guest.mobile) {\n                  this.handleInputChange({ mobile });\n                }\n                if (phone_prefix !== this.guest.country_phone_prefix) this.handleInputChange({ country_phone_prefix: phone_prefix });\n              }}\n              phone_prefix={this.guest.country_phone_prefix}\n              value={this.guest.mobile}\n              language={this.language}\n              label={locales.entries?.Lcz_MobilePhone}\n              countries={this.countries}\n            />\n            <div class=\"mb-2\">\n              <ir-textarea\n                variant=\"prepend\"\n                onTextChange={e => this.handleInputChange({ notes: e.detail })}\n                value={this.guest?.notes}\n                label={locales.entries?.Lcz_PrivateNote}\n              ></ir-textarea>\n            </div>\n            <div class={'p-0 m-0'}>\n              <label class={`check-container m-0 p-0`}>\n                <input\n                  class={'m-0 p-0'}\n                  type=\"checkbox\"\n                  name=\"newsletter\"\n                  checked={this.guest.subscribe_to_news_letter}\n                  onInput={e => this.handleInputChange({ subscribe_to_news_letter: (e.target as HTMLInputElement).checked })}\n                />\n                <span class=\"checkmark m-0 p-0\"></span>\n                <span class={'m-0 p-0  check-label'}>{locales.entries.Lcz_Newsletter}</span>\n              </label>\n              {!this.isInSideBar && (\n                <Fragment>\n                  <hr />\n                  <ir-button\n                    btn_styles=\"d-flex align-items-center justify-content-center\"\n                    text={locales.entries.Lcz_Save}\n                    onClickHandler={this.editGuest.bind(this)}\n                    isLoading={isRequestPending('/Edit_Exposed_Guest')}\n                    color=\"btn-primary\"\n                  ></ir-button>\n                </Fragment>\n              )}\n            </div>\n          </div>\n        </div>\n        {this.isInSideBar && (\n          <div class={'sheet-footer'}>\n            <ir-button\n              data-testid=\"cancel\"\n              onClickHandler={() => this.closeSideBar.emit(null)}\n              class=\"flex-fill m-0 p-0\"\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\n              btn_color=\"secondary\"\n              text={locales.entries.Lcz_Cancel}\n            ></ir-button>\n            <ir-button\n              data-testid=\"save\"\n              isLoading={isRequestPending('/Edit_Exposed_Guest')}\n              btn_disabled={this.isLoading}\n              class=\"flex-fill m-0\"\n              btn_type=\"submit\"\n              btn_styles=\"w-100 m-0  justify-content-center align-items-center\"\n              text={locales.entries.Lcz_Save}\n            ></ir-button>\n          </div>\n        )}\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n  --label-col: 6rem; /* width for icon + status text */\n  --amount-col: 1ch; /* width for currency (tabular) */\n  --payment-action-bg: rgba(255, 73, 97, 10%);\n  --payment-action-border: rgba(255, 73, 97, 40%);\n}\n\n.action-container.overdue {\n  --payment-action-bg: rgba(255, 73, 97, 5%);\n  --payment-action-border: rgba(255, 73, 97, 40%);\n}\n.action-container.future {\n  --payment-action-bg: rgb(30, 159, 242, 5%);\n  --payment-action-border: rgba(30, 159, 242, 40%);\n}\n.action-container.overdue:hover {\n  --payment-action-bg: rgba(255, 73, 97, 10%);\n  --payment-action-border: rgba(255, 73, 97, 50%);\n}\n.action-container.future:hover {\n  --payment-action-bg: rgb(30, 159, 242, 10%);\n  --payment-action-border: rgba(30, 159, 242, 50%);\n}\n\n/* One grid per row, but with fixed track sizes so all rows align */\n.action-container {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  background: var(--payment-action-bg);\n  padding: 0.5rem 1rem;\n  box-sizing: border-box; /* (fixed the typo) */\n  border: 1px solid var(--payment-action-border);\n  border-radius: 0.25rem;\n  transition: all 0.3s ease-in-out;\n}\n\n.overdue_action,\n.future_action {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  border-radius: 0.25rem;\n  min-width: 0;\n}\n.action-container.overdue .overdue_action {\n  color: #ff4961;\n}\n.future_action {\n  color: #1e9ff2;\n}\n\n.payment-meta {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.alert-message {\n  display: none;\n}\n.action-container.overdue .alert-message {\n  text-transform: capitalize;\n}\n.amount_action {\n  font-weight: 600;\n  font-variant-numeric: tabular-nums;\n  text-align: right;\n  justify-self: end;\n  white-space: nowrap;\n}\n.meta-grid {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 0%;\n}\n.payment-reason {\n  font-size: 12px;\n  color: hsl(230, 10%, 46%, 80%);\n}\n.date_action {\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.action-container p {\n  margin: 0;\n  padding: 0;\n}\n\n.action-row {\n  display: contents;\n}\n\n@media (min-width: 640px) {\n  :host {\n    --amount-col: 8ch;\n  }\n  .alert-message {\n    display: inline-flex;\n  }\n  .amount_action {\n    justify-self: auto;\n  }\n  .action-container {\n    display: grid;\n    grid-template-columns: var(--label-col) 1fr auto;\n    align-items: center;\n  }\n  .payment-meta {\n    display: grid;\n    grid-template-columns: var(--amount-col) 1fr;\n    align-items: center;\n    column-gap: 1rem;\n    min-width: 0;\n  }\n}\n","import { Component, Event, EventEmitter, Prop, h } from '@stencil/core';\nimport { IPaymentAction } from '@/services/payment.service';\nimport { formatAmount } from '@/utils/utils';\nimport moment from 'moment';\n\n@Component({\n  tag: 'ir-payment-action',\n  styleUrl: 'ir-payment-action.css',\n  scoped: true,\n})\nexport class IrPaymentAction {\n  @Prop({ attribute: 'payment-action' }) paymentAction: IPaymentAction;\n\n  @Event() generatePayment: EventEmitter<IPaymentAction>;\n\n  render() {\n    const paymentActionType = this.paymentAction.type.toLowerCase();\n    const isFutureAction = paymentActionType === 'future';\n    return (\n      <div class={`action-container ${isFutureAction ? 'future' : 'overdue'}`}>\n        <div class={'action-row'}>\n          {!isFutureAction && (\n            <div class={'overdue_action'}>\n              <svg height={16} width={16} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z\"\n                />\n              </svg>\n              <span class=\"alert-message\">{paymentActionType}</span>\n            </div>\n          )}\n          {paymentActionType === 'future' && this.paymentAction.amount > 0 && (\n            <div class={'future_action '}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" height={16} width={16} viewBox=\"0 0 512 512\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z\"\n                />\n              </svg>\n              <span class=\"alert-message\">{moment(new Date(this.paymentAction.due_on)).isSame(new Date()) ? 'Today' : 'Future'}</span>\n            </div>\n          )}\n          <div class=\"meta-grid\">\n            <div class=\"payment-meta\">\n              <p class=\"amount_action\">{formatAmount(this.paymentAction.currency.symbol, this.paymentAction.amount)}</p>\n              <p class=\"date_action\">{moment(new Date(this.paymentAction.due_on)).format('ddd, MMM DD YYYY')}</p>\n            </div>\n            {/* <p class=\"payment-reason\">{this.paymentAction.reason.trim()}</p> */}\n          </div>\n        </div>\n        <div style={{ width: 'fit-content' }}>\n          <ir-button btn_color=\"dark\" text={'Pay'} size=\"sm\" onClickHandler={() => this.generatePayment.emit(this.paymentAction)}></ir-button>\n        </div>\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host p,\n:host div,\n:host span,\n:host ir-icons {\n  box-sizing: border-box;\n  padding: 0;\n  margin: 0;\n}\n.beta {\n  background: var(--red);\n  color: white;\n  padding: 0.2rem 0.3rem !important;\n  font-size: 12px;\n  border-radius: 4px;\n  margin: 0;\n}\n.payment-actions-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n","import { Component, Host, Prop, h } from '@stencil/core';\nimport { IPaymentAction } from '@/services/payment.service';\nimport { Booking } from '@/models/booking.dto';\n\n@Component({\n  tag: 'ir-payment-actions',\n  styleUrl: 'ir-payment-actions.css',\n  scoped: true,\n})\nexport class IrPaymentActions {\n  @Prop() booking: Booking;\n  @Prop() paymentAction: IPaymentAction[];\n\n  render() {\n    if (this.paymentAction?.filter(pa => pa.amount !== 0).length == 0) {\n      return null;\n    }\n    return (\n      <Host>\n        <div class={'my-1 d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n          <p class={'font-size-large p-0 m-0 '}>Payment Actions</p>\n          <span class=\"beta\">Beta</span>\n        </div>\n        <div class=\"payment-actions-container\">\n          {this.paymentAction?.map((pa, index) => (\n            <ir-payment-action key={pa.due_on + index} paymentAction={pa}></ir-payment-action>\n          ))}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n\n.sm-margin-right {\n  margin-right: 5px !important;\n  background: #000;\n}\n.action_icons {\n  width: 60px;\n}\n.w-60 {\n  width: 100px;\n  padding: 0 5px;\n}\n.payments-height {\n  height: 30px;\n}\n.payment_date {\n  width: 100px;\n}\n.iframeHeight {\n  height: max-content;\n  height: 22.5rem;\n}\n.designation {\n  width: 120px;\n}\n.total-cost-container {\n  background: #7cbebe;\n  color: white;\n  padding: 0.5rem;\n  border-radius: 5px;\n}\n","import { Component, h, Prop, State, Event, EventEmitter, Listen } from '@stencil/core';\nimport { Booking, IPayment } from '@/models/booking.dto';\nimport { BookingService } from '@/services/booking.service';\nimport { PaymentService, IPaymentAction } from '@/services/payment.service';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { PaymentSidebarEvent } from '../types';\nimport { IEntries } from '@/models/IBooking';\nimport moment from 'moment';\n\n@Component({\n  styleUrl: 'ir-payment-details.css',\n  tag: 'ir-payment-details',\n  scoped: true,\n})\nexport class IrPaymentDetails {\n  @Prop({ mutable: true }) booking: Booking;\n  @Prop() paymentActions: IPaymentAction[];\n  @Prop() paymentTypes: IEntries[];\n\n  @State() confirmModal: boolean = false;\n  @State() toBeDeletedItem: IPayment | null = null;\n  @State() modalMode: 'delete' | 'save' | null = null;\n\n  @Event({ bubbles: true }) resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true }) resetExposedCancellationDueAmount: EventEmitter<null>;\n  @Event({ bubbles: true }) toast: EventEmitter<IToast>;\n  @Event({ bubbles: true }) openSidebar: EventEmitter<PaymentSidebarEvent>;\n\n  private paymentService = new PaymentService();\n  private bookingService = new BookingService();\n\n  @Listen('generatePayment')\n  handlePaymentGeneration(e: CustomEvent) {\n    const value = e.detail;\n    const paymentType = this.paymentTypes?.find(p => p.CODE_NAME === (this.booking.status.code === '003' ? value.pay_type_code : '001'));\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment: {\n          ...value,\n          date: moment().format('YYYY-MM-DD'),\n          id: -1,\n          amount: value.amount,\n          payment_type: paymentType\n            ? {\n                code: paymentType.CODE_NAME,\n                description: paymentType.CODE_VALUE_EN,\n                operation: paymentType.NOTES,\n              }\n            : null,\n          designation: paymentType?.CODE_VALUE_EN ?? null,\n        },\n        mode: 'payment-action',\n      },\n    });\n  }\n\n  private handleAddPayment = () => {\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: {\n        payment: {\n          id: -1,\n          date: moment().format('YYYY-MM-DD'),\n          amount: null,\n          currency: undefined,\n          designation: null,\n          reference: null,\n        },\n        mode: 'new',\n      },\n    });\n  };\n\n  private handleEditPayment = (payment: IPayment) => {\n    this.openSidebar.emit({\n      type: 'payment-folio',\n      payload: { payment, mode: 'edit' },\n    });\n  };\n\n  private handleDeletePayment = (payment: IPayment) => {\n    this.modalMode = 'delete';\n    this.toBeDeletedItem = payment;\n    this.openModal();\n  };\n\n  private async cancelPayment() {\n    try {\n      await this.paymentService.CancelPayment(this.toBeDeletedItem.id);\n      const newPaymentArray = this.booking.financial.payments.filter((item: IPayment) => item.id !== this.toBeDeletedItem.id);\n\n      this.booking = {\n        ...this.booking,\n        financial: { ...this.booking.financial, payments: newPaymentArray },\n      };\n\n      this.confirmModal = false;\n      this.resetBookingEvt.emit(null);\n      this.resetExposedCancellationDueAmount.emit(null);\n      this.toBeDeletedItem = null;\n      this.modalMode = null;\n    } catch (error) {\n      console.error('Error canceling payment:', error);\n      this.toast.emit({\n        type: 'error',\n        title: 'Error',\n        description: 'Failed to cancel payment. Please try again.',\n        position: 'top-right',\n      });\n    }\n  }\n\n  private handleConfirmModal = async (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n\n    if (this.modalMode === 'delete') {\n      await this.cancelPayment();\n    }\n  };\n\n  private handleCancelModal = (e: CustomEvent) => {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.modalMode = null;\n    this.toBeDeletedItem = null;\n  };\n\n  private openModal() {\n    const modal: any = document.querySelector('.delete-record-modal');\n    modal?.openModal();\n  }\n\n  private hasValidFinancialData(): boolean {\n    return Boolean(this.booking?.financial);\n  }\n\n  private shouldShowPaymentActions(): boolean {\n    return Boolean(this.paymentActions?.filter(pa => pa.amount !== 0).length > 0 && this.booking.is_direct);\n  }\n\n  render() {\n    if (!this.hasValidFinancialData()) {\n      return null;\n    }\n\n    const { financial, currency } = this.booking;\n\n    return [\n      <div class=\"card p-1\">\n        <ir-payment-summary totalCost={financial.gross_cost} balance={financial.due_amount} collected={this.booking.financial.collected} currency={currency} />\n        <ir-booking-guarantee booking={this.booking} bookingService={this.bookingService} />\n        {this.shouldShowPaymentActions() && <ir-payment-actions paymentAction={this.paymentActions} booking={this.booking} />}\n      </div>,\n      <ir-payments-folio\n        paymentTypes={this.paymentTypes}\n        payments={financial.payments || []}\n        onAddPayment={this.handleAddPayment}\n        onEditPayment={e => this.handleEditPayment(e.detail)}\n        onDeletePayment={e => this.handleDeletePayment(e.detail)}\n      />,\n      <ir-modal\n        item={this.toBeDeletedItem}\n        class=\"delete-record-modal\"\n        modalTitle={locales.entries.Lcz_Confirmation}\n        modalBody={this.modalMode === 'delete' ? locales.entries.Lcz_IfDeletedPermantlyLost : locales.entries.Lcz_EnteringAmountGreaterThanDue}\n        iconAvailable={true}\n        icon=\"ft-alert-triangle danger h1\"\n        leftBtnText={locales.entries.Lcz_Cancel}\n        rightBtnText={this.modalMode === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\n        leftBtnColor=\"secondary\"\n        rightBtnColor={this.modalMode === 'delete' ? 'danger' : 'primary'}\n        onConfirmModal={this.handleConfirmModal}\n        onCancelModal={this.handleCancelModal}\n      />,\n    ];\n  }\n}\n",":host {\n  display: block;\n  --payment-type-badge-bg: #ff4961;\n}\n.payment-type-badge {\n  background: var(--payment-type-badge-bg);\n  color: white;\n  padding: 0.2rem 0.3rem !important;\n  font-size: 12px;\n  border-radius: 4px;\n  margin: 0;\n  text-transform: capitalize;\n}\n.credit-badge {\n  --payment-type-badge-bg: #629a4c;\n}\n.debit-badge {\n  --payment-type-badge-bg: #ff4961;\n}\n.dropdown-item-payment {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  box-sizing: border-box;\n  justify-content: space-between;\n}\n\n.input-group-text {\n  border-color: #cacfe7 !important;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport { Component, Event, EventEmitter, Fragment, Prop, State, Watch, h } from '@stencil/core';\nimport moment from 'moment';\nimport { z, ZodError } from 'zod';\nimport { IPayment } from '@/models/booking.dto';\nimport { IEntries } from '@/models/IBooking';\nimport { PaymentService } from '@/services/payment.service';\nimport { FolioEntryMode } from '../../types';\nimport { buildPaymentTypes } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-payment-folio',\n  styleUrls: ['ir-payment-folio.css', '../../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrPaymentFolio {\n  @Prop() paymentTypes: IEntries[];\n  @Prop() paymentTypesGroups: IEntries[];\n\n  @Prop() bookingNumber: string;\n\n  @Prop() payment: IPayment = {\n    date: moment().format('YYYY-MM-DD'),\n    amount: 0,\n    designation: undefined,\n    currency: null,\n    reference: null,\n    id: -1,\n  };\n\n  @Prop() mode: FolioEntryMode;\n\n  @State() isLoading: boolean;\n  @State() errors: any;\n  @State() autoValidate: boolean = false;\n  @State() folioData: IPayment;\n  @State() _paymentTypes: Record<string, IEntries[]> = {};\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() resetExposedCancellationDueAmount: EventEmitter<null>;\n\n  private folioSchema: any;\n  private paymentService = new PaymentService();\n\n  componentWillLoad() {\n    this.folioSchema = z.object({\n      date: z\n        .string()\n        .regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n        .refine(\n          dateStr => {\n            const date = moment(dateStr, 'YYYY-MM-DD', true);\n            return date.isValid();\n          },\n          { message: `Invalid date` },\n        ),\n      amount: z.coerce.number().refine(a => a !== 0),\n      reference: z.string().optional().nullable(),\n      designation: z.string().min(1),\n      payment_type: z.object({\n        code: z.string().min(3).max(4),\n        description: z.string().min(1),\n        operation: z.union([z.literal('CR'), z.literal('DB')]),\n      }),\n    });\n    if (this.payment) {\n      this.folioData = { ...this.payment };\n    }\n    this.getPaymentTypes();\n  }\n\n  @Watch('payment')\n  handlePaymentChange(newValue: IPayment, oldValue: IPayment) {\n    if (newValue !== oldValue && newValue) {\n      this.folioData = { ...newValue };\n      this.getPaymentTypes();\n    }\n  }\n  @Watch('paymentTypes')\n  handlePaymentTypesChange(newValue: IEntries[], oldValue: IEntries[]) {\n    if (newValue !== oldValue && newValue) {\n      this.getPaymentTypes();\n    }\n  }\n\n  private updateFolioData(params: Partial<IPayment>): void {\n    this.folioData = { ...this.folioData, ...params };\n  }\n\n  private async savePayment() {\n    try {\n      this.isLoading = true;\n      this.autoValidate = true;\n      if (this.errors) {\n        this.errors = null;\n      }\n      this.folioSchema.parse(this.folioData ?? {});\n      await this.paymentService.AddPayment(\n        {\n          ...this.folioData,\n          currency: calendar_data.currency,\n          reference: this.folioData.reference ?? '',\n          designation: this.folioData.payment_type?.description,\n        },\n        this.bookingNumber,\n      );\n      this.resetBookingEvt.emit(null);\n      this.resetExposedCancellationDueAmount.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      const err = {};\n      if (error instanceof ZodError) {\n        error.issues.forEach(e => {\n          err[e.path[0]] = true;\n        });\n      }\n      console.error(error);\n      this.errors = err;\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private handleDropdownChange(e: CustomEvent<string | number>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const value = e.detail.toString();\n    console.log(value);\n    this.updateFolioData({ designation: value });\n    if (!e.detail) {\n      this.updateFolioData({\n        payment_type: null,\n      });\n    } else {\n      const payment_type = this.paymentTypes.find(pt => pt.CODE_NAME === value);\n      if (!payment_type) {\n        console.warn(`Invalid payment type ${e.detail}`);\n        this.updateFolioData({\n          payment_type: null,\n        });\n        return;\n      }\n      this.updateFolioData({\n        payment_type: {\n          code: payment_type.CODE_NAME,\n          description: payment_type.CODE_VALUE_EN,\n          operation: payment_type.NOTES,\n        },\n      });\n    }\n  }\n  private async getPaymentTypes() {\n    const rec = buildPaymentTypes(this.paymentTypes, this.paymentTypesGroups);\n    if (this.mode === 'payment-action' && this.payment.payment_type?.code === '001') {\n      const { PAYMENTS, CANCELLATION } = rec;\n      return (this._paymentTypes = {\n        PAYMENTS,\n        CANCELLATION,\n      });\n    }\n    this._paymentTypes = rec;\n  }\n\n  private renderDropdownItems() {\n    return Object.values(this._paymentTypes).map((p, idx) => (\n      <Fragment>\n        {p.map(pt => (\n          <ir-dropdown-item value={pt.CODE_NAME} class=\"dropdown-item-payment\">\n            <span>{pt.CODE_VALUE_EN}</span>\n            <span class={`payment-type-badge ${pt.NOTES === 'CR' ? 'credit-badge' : 'debit-badge'}`}>{pt.NOTES === 'CR' ? 'credit' : 'debit'}</span>\n          </ir-dropdown-item>\n        ))}\n        {idx !== Object.values(this._paymentTypes).length - 1 && <div class=\"dropdown-divider\"></div>}\n      </Fragment>\n    ));\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          this.savePayment();\n        }}\n      >\n        <ir-title\n          class=\"px-1 sheet-header\"\n          onCloseSideBar={() => this.closeModal.emit(null)}\n          label={this.mode === 'edit' ? 'Edit Folio Entry' : 'New Folio Entry'}\n          displayContext=\"sidebar\"\n        ></ir-title>\n        <section class={'px-1 sheet-body d-flex flex-column'} style={{ gap: '1rem' }}>\n          <div class={'d-flex w-fill'} style={{ gap: '0.5rem' }}>\n            {/*Date Picker */}\n            <div class=\"form-group  mb-0 flex-grow-1\">\n              <div class=\"input-group row m-0 flex-grow-1\">\n                <div class={`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`}>\n                  <label class={`input-group-text flex-grow-1 text-dark border-theme `}>Date</label>\n                </div>\n                <div class=\"form-control  form-control-md col-10 flex-grow-1 d-flex align-items-center px-0 mx-0\" style={{ border: '0' }}>\n                  <style>\n                    {`.ir-date-picker-trigger{\n                    width:100%;}`}\n                  </style>\n                  <ir-date-picker\n                    data-testid=\"pickup_date\"\n                    date={this.folioData?.date}\n                    class=\"w-100\"\n                    emitEmptyDate={true}\n                    maxDate={moment().format('YYYY-MM-DD')}\n                    aria-invalid={this.errors?.date && !this.folioData?.date ? 'true' : 'false'}\n                    onDateChanged={evt => {\n                      this.updateFolioData({ date: evt.detail.start?.format('YYYY-MM-DD') });\n                    }}\n                  >\n                    <input\n                      type=\"text\"\n                      slot=\"trigger\"\n                      value={this.folioData?.date ? moment(this.folioData?.date).format('MMM DD, YYYY') : null}\n                      class={`form-control w-100 input-sm ${this.errors?.date && !this.folioData?.date ? 'border-danger' : ''} text-left`}\n                      style={{ borderTopLeftRadius: '0', borderBottomLeftRadius: '0', width: '100%' }}\n                    ></input>\n                  </ir-date-picker>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div>\n            <ir-price-input\n              containerClassname=\"row\"\n              labelContainerClassname=\"col-4 col-md-3 p-0 text-dark border-0\"\n              minValue={0}\n              autoValidate={this.autoValidate}\n              zod={this.folioSchema.pick({ amount: true })}\n              wrapKey=\"amount\"\n              label=\"Amount\"\n              labelStyle={'flex-grow-1 text-dark  border-theme'}\n              error={this.errors?.amount && !this.folioData?.amount}\n              value={this.folioData?.amount?.toString()}\n              currency={calendar_data.currency.symbol}\n              onTextChange={e => this.updateFolioData({ amount: Number(e.detail) })}\n            ></ir-price-input>\n          </div>\n          <div>\n            <ir-dropdown\n              value={this.folioData?.payment_type?.code}\n              disabled={this.payment.payment_type?.code !== '001' && this.mode === 'payment-action'}\n              onOptionChange={this.handleDropdownChange.bind(this)}\n            >\n              <div slot=\"trigger\" class={'input-group row m-0 '}>\n                <div class={`input-group-prepend col-4 col-md-3 p-0 text-dark border-0`}>\n                  <label class={`input-group-text flex-grow-1 text-dark  border-theme`}>Transaction type</label>\n                </div>\n                <button\n                  type=\"button\"\n                  disabled={this.payment.payment_type?.code !== '001' && this.mode === 'payment-action'}\n                  class={`form-control  d-flex align-items-center cursor-pointer ${this.errors?.designation && !this.folioData?.designation ? 'border-danger' : ''}`}\n                >\n                  {this.folioData?.payment_type ? <span>{this.folioData.payment_type?.description}</span> : <span>Select...</span>}\n                </button>\n              </div>\n              <ir-dropdown-item value=\"\">Select...</ir-dropdown-item>\n              {this.renderDropdownItems()}\n            </ir-dropdown>\n          </div>\n          <div>\n            <ir-input-text\n              value={this.folioData?.reference}\n              error={this.errors?.reference_number}\n              autoValidate={this.autoValidate}\n              zod={this.folioSchema.pick({ reference: true })}\n              label=\"Reference\"\n              maxLength={50}\n              inputContainerStyle={{\n                margin: '0',\n              }}\n              onTextChange={e => this.updateFolioData({ reference: e.detail })}\n              labelWidth={3}\n              labelContainerClassname={'col-4 col-md-3'}\n            ></ir-input-text>\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button onClick={() => this.closeModal.emit(null)} btn_styles=\"justify-content-center\" class={`flex-fill`} text={'Cancel'} btn_color=\"secondary\"></ir-button>\n          <ir-button\n            btn_styles=\"justify-content-center align-items-center\"\n            class={'flex-fill'}\n            isLoading={this.isLoading}\n            text={'Save'}\n            btn_color=\"primary\"\n            btn_type=\"submit\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n","/* .payment-item {\n  position: relative;\n  width: 100%;\n  display: flex;\n  padding: 0.5rem;\n  align-items: center;\n  min-height: 3rem;\n  gap: 1rem;\n  box-sizing: border-box;\n}\n.payment-item:hover {\n  background: #f4f5fa;\n}\n.payment-item:hover .payment-actions {\n  display: flex;\n}\n\n.payment-item p {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n\n.payment-item .payment-actions {\n  display: none;\n  background: #f4f5fa;\n  gap: 0.5rem;\n  justify-content: flex-end;\n  align-items: center;\n}\n.payment-body {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  flex: 1 1 0%;\n}\n\n.payment-fields {\n  display: flex;\n  flex-direction: column;\n}\n\n.payment-amount {\n  font-weight: 700;\n  white-space: nowrap;\n}\n\n\n.payment-reference {\n  font-size: 12px;\n}\n.payment-toolbar {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n@media (min-width: 768px) {\n  .payment-fields {\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n  }\n} */\n.payment-item__payment-item {\n  display: flex;\n  flex-direction: column;\n  /* gap: 0.25rem; */\n  padding: 0.5rem;\n  min-height: 3rem;\n}\n.payment-item__payment-item p {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n.payment-item__payment-body {\n  display: flex;\n  flex-direction: column;\n}\n.payment-item__payment-fields {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.payment-item__payment-body .payment-item__payment-reference,\n.payment-item__payment-body .payment-item__payment-description {\n  display: none;\n}\n.payment-item__payment-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.payment-item__payment-toolbar .payment-item__payment-amount {\n  display: none;\n}\n.payment-item__action-button {\n  cursor: pointer;\n}\n.payment-item__payment-amount {\n  font-weight: 700;\n  white-space: nowrap;\n}\n.payment-item__payment-amount.is-credit {\n  color: #629a4c;\n}\n.payment-item__payment-amount.is-debit {\n  color: #ff4961;\n}\n.payment-item__payment-reference {\n  font-size: 12px;\n}\n/*md*/\n@media (min-width: 640px) {\n  .payment-item__payment-item {\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .payment-item__payment-item:hover {\n    background: #f4f5fa;\n  }\n  .payment-item__payment-item:hover .payment-item__payment-actions {\n    display: inline-flex;\n  }\n  .payment-item__payment-body .payment-item__payment-reference,\n  .payment-item__payment-body .payment-item__payment-description,\n  .payment-item__payment-item .payment-item__payment-amount {\n    display: inline-flex;\n  }\n  .payment-item__payment-fields .payment-item__payment-amount,\n  .payment-item__payment-toolbar .payment-item__payment-description,\n  .payment-item__payment-item .payment-item__payment-reference,\n  .payment-item__payment-actions {\n    display: none;\n  }\n  .payment-item__payment-body .payment-item__payment-reference {\n    display: inline-flex;\n    align-items: center;\n  }\n  .payment-item__payment-body {\n    flex: 1 1 0%;\n    justify-content: flex-start;\n    gap: 0.5rem;\n  }\n  .payment-item__payment-fields {\n    justify-content: flex-start;\n    gap: 0.5rem;\n  }\n  .payment-item__payment-toolbar {\n    gap: 0.5rem;\n    align-items: center;\n  }\n}\n","import { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Component, Event, EventEmitter, Prop, h } from '@stencil/core';\nimport { IPayment } from '@/models/booking.dto';\nimport { formatAmount } from '@/utils/utils';\n\n@Component({\n  tag: 'ir-payment-item',\n  styleUrl: 'ir-payment-item.css',\n  shadow: true,\n})\nexport class IrPaymentItem {\n  @Prop() payment: IPayment;\n\n  @Event() editPayment: EventEmitter<IPayment>;\n  @Event() deletePayment: EventEmitter<IPayment>;\n\n  render() {\n    const isCredit = this.payment.payment_type.operation === 'CR';\n    return (\n      // <div class=\"payment-item\" part=\"base\">\n      //   <div class=\"payment-body\" part=\"payment-body\">\n      //     <div class=\"payment-fields\" part=\"payment-fields\">\n      //       <p class=\"text-muted\">{this.payment.date}</p>\n      //       <p>\n      //         <b>{this.payment.payment_type.description ?? this.payment.designation}</b>\n      //       </p>\n      //     </div>\n      //     {this.payment.reference && <p class=\"payment-reference text-muted\">{this.payment?.reference}</p>}\n      //   </div>\n\n      //   <div class=\"payment-toolbar\" part=\"payment-toolbar\">\n      //     <p class={`payment-amount ${isCredit ? 'is-credit' : 'is-debit'}`}>\n      //       {formatAmount(this.payment.currency.symbol, this.payment.payment_type.code === '012' ? this.payment.amount * -1 : this.payment.amount)}\n      //     </p>\n      //     <div class=\"payment-actions\">\n      //       <ir-button\n      //         class=\"action-button\"\n      //         variant=\"icon\"\n      //         onClickHandler={() => {\n      //           this.editPayment.emit(this.payment);\n      //         }}\n      //         icon_name=\"edit\"\n      //         style={colorVariants.secondary}\n      //       ></ir-button>\n      //       <ir-button\n      //         class=\"action-button\"\n      //         onClickHandler={() => {\n      //           this.deletePayment.emit(this.payment);\n      //         }}\n      //         variant=\"icon\"\n      //         style={colorVariants.danger}\n      //         icon_name=\"trash\"\n      //       ></ir-button>\n      //     </div>\n      //   </div>\n      // </div>\n      <div class=\"payment-item__payment-item\">\n        <div class=\"payment-item__payment-body\" part=\"payment-body\">\n          <div class=\"payment-item__payment-fields\" part=\"payment-fields\">\n            <p class=\"payment-item__payment-date\">{this.payment.date}</p>\n            <p class={`payment-item__payment-amount ${isCredit ? 'is-credit' : 'is-debit'}`}>\n              {formatAmount(this.payment.currency.symbol, this.payment.payment_type.code === '012' ? this.payment.amount * -1 : this.payment.amount)}\n            </p>\n            <p class=\"payment-item__payment-description\">\n              <b>{this.payment.payment_type.description ?? this.payment.designation}</b>\n            </p>\n          </div>\n          {this.payment.reference && <p class=\"payment-item__payment-reference\">{this.payment?.reference}</p>}\n        </div>\n        <div class=\"payment-item__payment-toolbar\">\n          <p class={`payment-item__payment-amount ${isCredit ? 'is-credit' : 'is-debit'}`}>\n            {formatAmount(this.payment.currency.symbol, this.payment.payment_type.code === '012' ? this.payment.amount * -1 : this.payment.amount)}\n          </p>\n          <p class=\"payment-item__payment-description\">\n            <b>{this.payment.payment_type.description ?? this.payment.designation}</b>\n          </p>\n          <div class=\"payment-item__payment-actions\">\n            <ir-button\n              class=\"payment-item__action-button\"\n              variant=\"icon\"\n              onClickHandler={() => {\n                this.editPayment.emit(this.payment);\n              }}\n              icon_name=\"edit\"\n              style={colorVariants.secondary}\n            ></ir-button>\n            <ir-button\n              class=\"payment-item__action-button\"\n              onClickHandler={() => {\n                this.deletePayment.emit(this.payment);\n              }}\n              variant=\"icon\"\n              style={colorVariants.danger}\n              icon_name=\"trash\"\n            ></ir-button>\n          </div>\n        </div>\n\n        {this.payment.reference && <p class=\"payment-item__payment-reference\">{this.payment?.reference}</p>}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n:host {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n:host * {\n  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;\n}\n","import { Currency } from '@/models/property';\nimport locales from '@/stores/locales.store';\nimport { formatAmount } from '@/utils/utils';\nimport { Component, Prop, h } from '@stencil/core';\n\n@Component({\n  tag: 'ir-payment-summary',\n  styleUrl: 'ir-payment-summary.css',\n  scoped: true,\n})\nexport class IrPaymentSummary {\n  @Prop() totalCost: number;\n  @Prop() balance: number;\n  @Prop() collected: number;\n  @Prop() currency: Currency;\n\n  private shouldShowTotalCost(): boolean {\n    return this.totalCost > 0 && this.totalCost !== null;\n  }\n\n  render() {\n    return (\n      <div class=\" m-0\">\n        {this.shouldShowTotalCost() && (\n          <div class=\"mb-2 h4 total-cost-container\">\n            {locales.entries.Lcz_TotalCost}:<span>{formatAmount(this.currency.symbol, this.totalCost)}</span>\n          </div>\n        )}\n\n        <div class=\"h4 d-flex align-items-center justify-content-between\">\n          <span>{locales.entries.Lcz_Balance}: </span>\n          <span class=\"danger font-weight-bold\">{formatAmount(this.currency.symbol, this.balance)}</span>\n        </div>\n\n        <div class=\"mb-2 h4 d-flex align-items-center justify-content-between\">\n          <span>{locales.entries.Lcz_Collected}: </span>\n          <span>{formatAmount(this.currency.symbol, this.collected)}</span>\n        </div>\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { Component, h, Prop, Event, EventEmitter } from '@stencil/core';\nimport { IPayment } from '@/models/booking.dto';\nimport { IEntries } from '@/models/IBooking';\n@Component({\n  styleUrl: 'ir-payments-folio.css',\n  tag: 'ir-payments-folio',\n  scoped: true,\n})\nexport class IrPaymentsFolio {\n  @Prop() payments: IPayment[] = [];\n  @Prop() paymentTypes: IEntries[];\n\n  @Event({ bubbles: true }) addPayment: EventEmitter<void>;\n  @Event({ bubbles: true }) editPayment: EventEmitter<IPayment>;\n  @Event({ bubbles: true }) deletePayment: EventEmitter<IPayment>;\n\n  private handleAddPayment = () => {\n    this.addPayment.emit();\n  };\n\n  private handleEditPayment = (payment: IPayment) => {\n    this.editPayment.emit(payment);\n  };\n\n  private handleDeletePayment = (payment: IPayment) => {\n    this.deletePayment.emit(payment);\n  };\n\n  private hasPayments(): boolean {\n    return this.payments && this.payments.length > 0;\n  }\n\n  private renderPaymentItem(payment: IPayment, index: number) {\n    return [\n      <ir-payment-item\n        key={payment.id}\n        payment={payment}\n        onDeletePayment={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.handleDeletePayment(e.detail);\n        }}\n        onEditPayment={e => {\n          e.stopImmediatePropagation();\n          e.stopPropagation();\n          this.handleEditPayment(e.detail);\n        }}\n      />,\n      index < this.payments.length - 1 && <hr class=\"p-0 m-0\" />,\n    ];\n  }\n\n  private renderEmptyState() {\n    return (\n      <div class=\"text-center p-3\">\n        <p class=\"text-muted\">No payments recorded yet</p>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div class=\"mt-1\">\n        <div class=\"d-flex flex-column rounded payment-container\">\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <p class=\"font-size-large p-0 m-0\">Guest Folio</p>\n            <ir-button id=\"add-payment\" variant=\"icon\" icon_name=\"square_plus\" style={{ '--icon-size': '1.5rem' }} onClickHandler={this.handleAddPayment} />\n          </div>\n\n          <div class=\"mt-1 card p-1 payments-container\">\n            {this.hasPayments() ? this.payments.map((payment, index) => this.renderPaymentItem(payment, index)) : this.renderEmptyState()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import axios from 'axios';\nimport { TDueParams, TPickupData } from './types';\nimport calendar_data from '@/stores/calendar-data';\nimport { IBookingPickupInfo } from '@/components';\nimport { z, ZodError } from 'zod';\nimport { renderTime } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class PickupService {\n  public async savePickup(params: TPickupData, booking_nbr: string, is_remove: boolean) {\n    try {\n      const splitTime = params.arrival_time.split(':');\n      await axios.post(`/Do_Pickup`, {\n        booking_nbr,\n        is_remove,\n        currency: params.currency,\n        date: params.arrival_date,\n        details: params.flight_details,\n        hour: splitTime[0],\n        minute: splitTime[1],\n        nbr_of_units: params.number_of_vehicles,\n        selected_option: params.selected_option,\n        total: +params.due_upon_booking,\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  public transformDefaultPickupData(data: IBookingPickupInfo): TPickupData {\n    const arrival_time = data.hour && data.minute ? renderTime(data.hour) + ':' + renderTime(data.minute) : '';\n    return {\n      arrival_date: data.date,\n      arrival_time,\n      currency: data.currency,\n      due_upon_booking: data.total.toFixed(2),\n      flight_details: data.details,\n      location: data.selected_option.location.id,\n      number_of_vehicles: data.nbr_of_units,\n      selected_option: data.selected_option,\n      vehicle_type_code: data.selected_option.vehicle.code,\n    };\n  }\n  public getAvailableLocations(message: string) {\n    let locations: { value: number; text: string }[] = [];\n    calendar_data.pickup_service.allowed_options.forEach(option => {\n      if (locations.filter(location => location.value === option.location.id).length === 0) {\n        locations.push({\n          text: message + ' ' + option.location.description,\n          value: option.location.id,\n        });\n      }\n    });\n    return locations;\n  }\n  public createPickupSchema(minDate: string, maxDate: string) {\n    return z.object({\n      arrival_date: z\n        .string()\n        .regex(/^\\d{4}-\\d{2}-\\d{2}$/, { message: 'Invalid date format, expected YYYY-MM-DD' })\n        .refine(\n          dateStr => {\n            const date = moment(dateStr, 'YYYY-MM-DD', true);\n            const min = moment(minDate, 'YYYY-MM-DD', true);\n            const max = moment(maxDate, 'YYYY-MM-DD', true);\n            return date.isValid() && min.isValid() && max.isValid() && date.isBetween(min, max, undefined, '[]');\n          },\n          { message: `arrival_date must be between ${minDate} and ${maxDate}` },\n        ),\n\n      arrival_time: z\n        .string()\n        .regex(/^\\d{2}:\\d{2}$/, { message: 'Invalid time format. Expected HH:MM' })\n        .refine(\n          time => {\n            const [hours, minutes] = time.split(':').map(Number);\n            return hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59;\n          },\n          { message: 'Time values are out of range' },\n        ),\n      flight_details: z.string().nonempty({ message: 'Flight details cannot be empty' }),\n      vehicle_type_code: z.string().nonempty({ message: 'Vehicle type code cannot be empty' }),\n      number_of_vehicles: z.coerce.number().min(1, { message: 'At least one vehicle is required' }),\n    });\n  }\n  public validateForm(\n    params: TPickupData,\n    schema: any, // : { error: boolean; cause?: keyof TPickupData }\n  ) {\n    try {\n      schema.parse(params);\n      return null;\n    } catch (error) {\n      console.log(error);\n      const err = {};\n      if (error instanceof ZodError) {\n        error.issues.forEach(e => {\n          err[e.path[0]] = true;\n        });\n        return err;\n      }\n    }\n    // if (params.arrival_time.split(':').length !== 2) {\n    //   return {\n    //     error: true,\n    //     cause: 'arrival_time',\n    //   };\n    // }\n    // if (params.flight_details === '') {\n    //   return {\n    //     error: true,\n    //     cause: 'flight_details',\n    //   };\n    // }\n    // if (params.vehicle_type_code === '') {\n    //   return {\n    //     error: true,\n    //     cause: 'vehicle_type_code',\n    //   };\n    // }\n    // if (params.number_of_vehicles === 0) {\n    //   return {\n    //     error: true,\n    //     cause: 'number_of_vehicles',\n    //   };\n    // }\n    // return { error: false };\n  }\n  public getNumberOfVehicles(capacity: number, numberOfPersons: number) {\n    let total_number_of_vehicles = Math.ceil(numberOfPersons / capacity);\n    let startNumber = total_number_of_vehicles > 1 ? total_number_of_vehicles : 1;\n    let bonus_number = total_number_of_vehicles > 1 ? 2 : 3;\n    return Array.from({ length: total_number_of_vehicles + bonus_number }, (_, i) => startNumber + i);\n  }\n  private getPickUpPersonStatus(code: string) {\n    const getCodeDescription = calendar_data.pickup_service.allowed_pricing_models.find(model => model.code === code);\n    if (!getCodeDescription) {\n      return null;\n    }\n    return getCodeDescription.description;\n  }\n  public updateDue(params: TDueParams) {\n    const getCodeDescription = this.getPickUpPersonStatus(params.code);\n    if (!getCodeDescription) {\n      return;\n    }\n    if (getCodeDescription === 'Person') {\n      return params.amount * params.numberOfPersons;\n    } else {\n      return params.amount * params.number_of_vehicles;\n    }\n  }\n}\n",":host {\n  display: block;\n}\n.custom-card-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid #e4e5ec;\n}\n.card-title {\n  flex: 1;\n}\n.border-theme {\n  border: 1px solid #cacfe7;\n}\n@media (min-width: 768px) {\n  .price-input-container {\n    max-width: 290px;\n  }\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport { Component, Element, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { TPickupData } from './types';\nimport moment from 'moment';\nimport { IAllowedOptions } from '@/models/calendarData';\nimport { PickupService } from './pickup.service';\nimport { IBookingPickupInfo } from '@/models/booking.dto';\nimport { MaskedRange } from 'imask';\n\n@Component({\n  tag: 'ir-pickup',\n  styleUrls: ['ir-pickup.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrPickup {\n  @Element() el: HTMLElement;\n\n  @Prop() defaultPickupData: IBookingPickupInfo | null;\n  @Prop() numberOfPersons: number = 0;\n  @Prop() bookingNumber: string;\n  @Prop() bookingDates: { from: string; to: string };\n\n  @State() isLoading = false;\n  @State() allowedOptionsByLocation: IAllowedOptions[] = [];\n  @State() pickupData: TPickupData = {\n    location: -1,\n    flight_details: '',\n    due_upon_booking: '',\n    number_of_vehicles: 1,\n    vehicle_type_code: '',\n    currency: undefined,\n    arrival_time: '',\n    arrival_date: null,\n    selected_option: undefined,\n  };\n  @State() vehicleCapacity: number[] = [];\n  @State() cause: keyof TPickupData | null = null;\n  @State() errors: Record<string, boolean>;\n  @State() autoValidate = false;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n\n  private pickupService = new PickupService();\n  private pickupSchema;\n\n  private arrival_time_mask = {\n    mask: 'HH:mm',\n    blocks: {\n      HH: {\n        mask: MaskedRange,\n        from: 0,\n        to: 23,\n        placeholderChar: 'H',\n      },\n      mm: {\n        mask: MaskedRange,\n        from: 0,\n        to: 59,\n        placeholderChar: 'm',\n      },\n    },\n    lazy: false,\n    placeholderChar: '_',\n  };\n\n  componentWillLoad() {\n    if (this.defaultPickupData) {\n      const transformedData = this.pickupService.transformDefaultPickupData(this.defaultPickupData);\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(transformedData.selected_option.vehicle.capacity, this.numberOfPersons);\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id === transformedData.location);\n      this.pickupData = { ...transformedData };\n    }\n    this.pickupSchema = this.pickupService.createPickupSchema(this.bookingDates.from, this.bookingDates.to);\n  }\n  private handleLocationChange(event: CustomEvent) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const value = event.detail;\n    if (value === '') {\n      this.updatePickupData('location', -1);\n    }\n    if (value !== '') {\n      this.allowedOptionsByLocation = calendar_data.pickup_service.allowed_options.filter(option => option.location.id.toString() === value);\n      let locationChoice = this.allowedOptionsByLocation[0];\n      if (!locationChoice) {\n        return;\n      }\n      locationChoice.currency;\n      this.vehicleCapacity = this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons);\n      this.pickupData = {\n        ...this.pickupData,\n        location: value,\n        selected_option: locationChoice,\n        number_of_vehicles: this.vehicleCapacity[0],\n        due_upon_booking: this.pickupService\n          .updateDue({\n            amount: locationChoice.amount,\n            code: locationChoice.pricing_model.code,\n            numberOfPersons: this.numberOfPersons,\n            number_of_vehicles: this.vehicleCapacity[0],\n          })\n          .toFixed(2),\n        vehicle_type_code: locationChoice.vehicle.code,\n        currency: locationChoice.currency,\n        // number_of_vehicles:this.pickupService\n      };\n    }\n  }\n\n  private handleVehicleQuantityChange(e: CustomEvent) {\n    if (e.detail === '') {\n      return;\n    }\n    const value = +e.detail;\n    this.pickupData = {\n      ...this.pickupData,\n      number_of_vehicles: value,\n      due_upon_booking: this.pickupService\n        .updateDue({\n          amount: this.pickupData.selected_option.amount,\n          code: this.pickupData.selected_option.pricing_model.code,\n          numberOfPersons: this.numberOfPersons,\n          number_of_vehicles: value,\n        })\n        .toFixed(2),\n    };\n  }\n\n  private handleVehicleTypeChange(e: CustomEvent) {\n    if (e.detail === '') {\n      this.pickupData = {\n        ...this.pickupData,\n        due_upon_booking: '',\n        vehicle_type_code: '',\n      };\n      return;\n    }\n    let locationChoice = calendar_data.pickup_service.allowed_options.find(option => option.location.id === +this.pickupData.location && option.vehicle.code === e.detail);\n    if (!locationChoice) {\n      return;\n    }\n    this.vehicleCapacity = [...this.pickupService.getNumberOfVehicles(locationChoice.vehicle.capacity, this.numberOfPersons)];\n    this.pickupData = {\n      ...this.pickupData,\n      selected_option: locationChoice,\n      number_of_vehicles: this.vehicleCapacity[0],\n      due_upon_booking: this.pickupService\n        .updateDue({\n          amount: locationChoice.amount,\n          code: locationChoice.pricing_model.code,\n          numberOfPersons: this.numberOfPersons,\n          number_of_vehicles: this.vehicleCapacity[0],\n        })\n        .toFixed(2),\n      vehicle_type_code: locationChoice.vehicle.code,\n    };\n  }\n\n  private updatePickupData(key: keyof TPickupData, value: any) {\n    this.pickupData = { ...this.pickupData, [key]: value };\n  }\n  private async savePickup() {\n    try {\n      this.isLoading = true;\n      this.autoValidate = true;\n      if (this.errors) {\n        this.errors = null;\n      }\n      this.errors = this.pickupService.validateForm(this.pickupData, this.pickupSchema);\n      if (this.errors) {\n        return;\n      }\n      await this.pickupService.savePickup(this.pickupData, this.bookingNumber, this.defaultPickupData !== null && this.pickupData.location === -1);\n      this.resetBookingEvt.emit(null);\n      this.closeModal.emit(null);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  render() {\n    return (\n      <form\n        class={'sheet-container'}\n        onSubmit={async e => {\n          e.preventDefault();\n          await this.savePickup();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={locales.entries.Lcz_Pickup} displayContext=\"sidebar\"></ir-title>\n        <section class={'px-1 sheet-body'}>\n          <ir-select\n            testId=\"pickup_location\"\n            selectedValue={this.pickupData.location}\n            selectContainerStyle=\"mb-1\"\n            onSelectChange={this.handleLocationChange.bind(this)}\n            firstOption={locales.entries.Lcz_Pickup_NoThankYou}\n            class={'m-0 mb-1'}\n            data={this.pickupService.getAvailableLocations(locales.entries.Lcz_Pickup_YesFrom) as any}\n          ></ir-select>\n          {this.pickupData.location > 0 && (\n            <div class=\"m-0 p-0\" data-testid=\"pickup_body\">\n              {/*Date and Time Picker container */}\n              <div class={'d-flex'}>\n                {/*Date Picker */}\n                <div class=\"form-group  mr-1\">\n                  <div class=\"input-group row m-0\">\n                    <div class={`input-group-prepend col-5 p-0 text-dark border-0`}>\n                      <label class={`input-group-text  flex-grow-1 text-dark border-theme `}>{locales.entries.Lcz_ArrivalDate}</label>\n                    </div>\n                    <div class=\"form-control  form-control-md col-7 d-flex align-items-center px-0 mx-0\" style={{ border: '0' }}>\n                      <ir-date-picker\n                        data-testid=\"pickup_arrival_date\"\n                        date={this.pickupData.arrival_date}\n                        minDate={this.bookingDates.from}\n                        maxDate={this.bookingDates?.to}\n                        emitEmptyDate={true}\n                        aria-invalid={this.errors?.arrival_date && !this.pickupData.arrival_date ? 'true' : 'false'}\n                        onDateChanged={evt => {\n                          this.updatePickupData('arrival_date', evt.detail.start?.format('YYYY-MM-DD'));\n                        }}\n                      >\n                        <input\n                          type=\"text\"\n                          slot=\"trigger\"\n                          value={this.pickupData.arrival_date ? moment(this.pickupData.arrival_date).format('MMM DD, YYYY') : null}\n                          class={`form-control input-sm ${this.errors?.arrival_date && !this.pickupData.arrival_date ? 'border-danger' : ''} text-center`}\n                          style={{ borderTopLeftRadius: '0', borderBottomLeftRadius: '0', width: '100%' }}\n                        ></input>\n                      </ir-date-picker>\n                    </div>\n                  </div>\n                </div>\n                {/*Time Picker */}\n                <ir-input-text\n                  autoValidate={this.autoValidate}\n                  wrapKey=\"arrival_time\"\n                  testId=\"pickup_arrival_time\"\n                  error={this.errors?.arrival_time}\n                  value={this.pickupData.arrival_time}\n                  zod={this.pickupSchema.pick({ arrival_time: true })}\n                  label={locales.entries.Lcz_Time}\n                  inputStyles=\"col-sm-4\"\n                  data-state={this.cause === 'arrival_time' ? 'error' : ''}\n                  mask={this.arrival_time_mask}\n                  onTextChange={e => this.updatePickupData('arrival_time', e.detail)}\n                ></ir-input-text>\n              </div>\n              <ir-input-text\n                wrapKey=\"flight_details\"\n                zod={this.pickupSchema.pick({ flight_details: true })}\n                autoValidate={this.autoValidate}\n                testId=\"pickup_flight_details\"\n                value={this.pickupData.flight_details}\n                label={locales.entries.Lcz_FlightDetails}\n                onTextChange={e => this.updatePickupData('flight_details', e.detail)}\n                placeholder=\"\"\n                error={this.errors?.flight_details}\n              ></ir-input-text>\n              <ir-select\n                testId=\"pickup_vehicle_type_code\"\n                selectContainerStyle=\"mb-1\"\n                error={this.cause === 'vehicle_type_code'}\n                onSelectChange={this.handleVehicleTypeChange.bind(this)}\n                firstOption={locales.entries.Lcz_Select}\n                selectedValue={this.pickupData.vehicle_type_code}\n                class={'m-0'}\n                data={\n                  this.allowedOptionsByLocation.map(option => ({\n                    text: option.vehicle.description,\n                    value: option.vehicle.code,\n                  })) as any\n                }\n              ></ir-select>\n              <div class={'d-flex flex-column flex-md-row'}>\n                <ir-select\n                  showFirstOption={false}\n                  testId=\"pickup_number_of_vehicles\"\n                  labelBorder=\"theme\"\n                  selectContainerStyle=\"mb-1\"\n                  onSelectChange={this.handleVehicleQuantityChange.bind(this)}\n                  selectedValue={this.pickupData.number_of_vehicles}\n                  error={this.cause === 'number_of_vehicles'}\n                  labelWidth={7}\n                  class={'m-0  mb-md-0 mr-md-1 flex-fill'}\n                  label={locales.entries.Lcz_NbrOfVehicles}\n                  data={\n                    this.vehicleCapacity.map(i => ({\n                      text: i,\n                      value: i,\n                    })) as any\n                  }\n                ></ir-select>\n                {/* <ir-input-text\n                  labelBorder=\"theme\"\n                  readonly\n                  value={this.pickupData.due_upon_booking}\n                  labelWidth={7}\n                  label={`${locales.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`}\n                  placeholder=\"\"\n                  class=\"\"\n                ></ir-input-text> */}\n                <div class=\"price-input-container\">\n                  <ir-price-input readOnly label={`${locales.entries.Lcz_DueUponBooking}`} value={this.pickupData.due_upon_booking} currency={this.pickupData.currency.symbol} />\n                </div>\n              </div>\n            </div>\n          )}\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button\n            onClick={() => this.closeModal.emit(null)}\n            btn_styles=\"justify-content-center\"\n            class={`flex-fill`}\n            text={locales.entries.Lcz_Cancel}\n            btn_color=\"secondary\"\n          ></ir-button>\n          {(this.defaultPickupData || this.pickupData.location !== -1) && (\n            <ir-button\n              btn_styles=\"justify-content-center align-items-center\"\n              class={'flex-fill'}\n              isLoading={this.isLoading}\n              text={locales.entries.Lcz_Save}\n              btn_color=\"primary\"\n              btn_type=\"submit\"\n            ></ir-button>\n          )}\n        </div>\n      </form>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import calendar_data from '@/stores/calendar-data';\nimport locales from '@/stores/locales.store';\nimport { Component, Host, Prop, h } from '@stencil/core';\nimport { _formatTime } from '../functions';\nimport moment from 'moment';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\n@Component({\n  tag: 'ir-pickup-view',\n  styleUrl: 'ir-pickup-view.css',\n  scoped: true,\n})\nexport class IrPickupView {\n  @Prop() booking: Booking;\n  render() {\n    if (!calendar_data.pickup_service.is_enabled || !this.booking.is_editable) {\n      return null;\n    }\n    return (\n      <Host>\n        <div class=\"mb-1\">\n          <div class={'d-flex w-100 mb-1 align-items-center justify-content-between'}>\n            <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_Pickup}</p>\n            <ir-button id=\"pickup\" data-testid=\"new_pickup_btn\" variant=\"icon\" icon_name=\"edit\" style={{ ...colorVariants.secondary, '--icon-size': '1.5rem' }}></ir-button>\n          </div>\n          {this.booking.pickup_info && (\n            <div class={'card'}>\n              <div class={'p-1'}>\n                <div class={'d-flex align-items-center py-0 my-0 pickup-margin'}>\n                  <p class={'font-weight-bold mr-1 py-0 my-0'}>\n                    {locales.entries.Lcz_Date}: <span class={'font-weight-normal'}>{moment(this.booking.pickup_info.date, 'YYYY-MM-DD').format('MMM DD, YYYY')}</span>\n                  </p>\n                  {this.booking.pickup_info.hour && this.booking.pickup_info.minute && (\n                    <p class={'font-weight-bold flex-fill py-0 my-0'}>\n                      {locales.entries.Lcz_Time}:\n                      <span class={'font-weight-normal'}> {_formatTime(this.booking.pickup_info.hour.toString(), this.booking.pickup_info.minute.toString())}</span>\n                    </p>\n                  )}\n                  <p class={'font-weight-bold py-0 my-0'}>\n                    {locales.entries.Lcz_DueUponBooking}:{' '}\n                    <span class={'font-weight-normal'}>\n                      {this.booking.pickup_info.currency.symbol}\n                      {this.booking.pickup_info.total}\n                    </span>\n                  </p>\n                </div>\n                <p class={'font-weight-bold py-0 my-0'}>\n                  {locales.entries.Lcz_FlightDetails}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.details}`}</span>\n                </p>\n                <p class={'py-0 my-0 pickup-margin'}>{`${this.booking.pickup_info.selected_option.vehicle.description}`}</p>\n                <p class={'font-weight-bold py-0 my-0 pickup-margin'}>\n                  {locales.entries.Lcz_NbrOfVehicles}:<span class={'font-weight-normal'}> {`${this.booking.pickup_info.nbr_of_units}`}</span>\n                </p>\n                <p class={'small py-0 my-0 pickup-margin'}>\n                  {calendar_data.pickup_service.pickup_instruction.description}\n                  {calendar_data.pickup_service.pickup_cancelation_prepayment.description}\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n.dialog-container-height {\n  height: 4rem;\n}\n.list-title {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  font-weight: bold;\n  width: fit-content;\n}\n.list-item {\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  margin-left: 5px;\n  width: fit-content;\n}\n.list-item.green {\n  color: #629a4c;\n  font-weight: 600;\n}\n.list-item.red {\n  color: #ff4961;\n  font-weight: 600;\n}\n","import { Component, h, Prop, State } from '@stencil/core';\nimport { _formatTime } from '../../functions';\nimport locales from '@/stores/locales.store';\nimport { IPmsLog } from '@/models/booking.dto';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { BookingService } from '@/services/booking.service';\n\n@Component({\n  tag: 'ir-pms-logs',\n  styleUrl: 'ir-pms-logs.css',\n  scoped: true,\n})\nexport class IrPmsLogs {\n  @Prop() bookingNumber: string;\n\n  @State() pmsLogs: IPmsLog;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.init();\n  }\n\n  private async init() {\n    try {\n      this.pmsLogs = await this.bookingService.fetchPMSLogs(this.bookingNumber);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"p-1\">\n        <h3 class=\" text-left mb-1 dialog-title \">{locales.entries.Lcz_PMS_Logs}</h3>\n\n        {isRequestPending('/Get_Exposed_PMS_Logs') ? (\n          <div class={'d-flex align-items-center justify-content-center dialog-container-height'}>\n            <ir-spinner></ir-spinner>\n          </div>\n        ) : (\n          <div class={'dialog-container-height'}>\n            <div class=\"d-flex align-items-center \" style={{ paddingBottom: '0.5rem' }}>\n              <p class=\"list-title p-0 m-0\">{locales.entries.Lcz_SentAt}</p>\n              {this.pmsLogs?.sent_date ? (\n                <p class=\"list-item\">\n                  {this.pmsLogs?.sent_date} {_formatTime(this.pmsLogs?.sent_hour.toString(), this.pmsLogs?.sent_minute.toString())}\n                </p>\n              ) : (\n                <p class={`list-item ${this.pmsLogs?.sent_date ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\n              )}\n            </div>\n            <div class=\"d-flex align-items-center p-0 m-0\">\n              <h4 class=\"list-title p-0 m-0\">{locales.entries.Lcz_Acknowledged}</h4>\n              <p class={`list-item  ${this.pmsLogs?.is_acknowledged ? 'green' : 'red'}`}>{this.pmsLogs?.is_acknowledged ? locales.entries.Lcz_YES : locales.entries.Lcz_NO}</p>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n",":host {\n  display: block;\n  width: 100%;\n}\n* {\n  box-sizing: border-box;\n}\n.popover-trigger {\n  all: unset;\n  cursor: pointer;\n}\n.popover-trigger:hover,\n.popover-trigger:focus {\n  color: #000;\n}\n","import { Component, Host, Prop, h, Element } from '@stencil/core';\n\n@Component({\n  tag: 'ir-popover',\n  styleUrl: 'ir-popover.css',\n  shadow: false,\n})\nexport class IrPopover {\n  @Element() el: HTMLElement;\n  /**\n   * Content to display inside the popover.\n   * Can be plain text or HTML depending on `renderContentAsHtml`.\n   */\n  @Prop() content: string;\n\n  /**\n   * Horizontal offset (left) of the popover from its trigger.\n   * Used in inline style as `--ir-popover-left`.\n   */\n  @Prop() irPopoverLeft: string = '10px';\n\n  /**\n   * Position of the popover relative to the trigger.\n   * Options: `'top'`, `'bottom'`, `'left'`, `'right'`, `'auto'`.\n   */\n  @Prop() placement: 'top' | 'bottom' | 'left' | 'right' | 'auto' = 'auto';\n\n  /**\n   * Event that triggers the popover.\n   * Options: `'focus'`, `'click'`, `'hover'`.\n   */\n  @Prop() trigger: 'focus' | 'click' | 'hover' = 'focus';\n\n  /**\n   * Whether to treat `content` as raw HTML.\n   * When true, `content` will be injected with `html: true` in jQuery popover.\n   */\n  @Prop() renderContentAsHtml: boolean = false;\n\n  /**\n   * Internal flag to ensure popover is only initialized once.\n   */\n  private initialized: boolean = false;\n\n  /**\n   * Reference to the HTML element that triggers the popover.\n   */\n  private popoverTrigger: HTMLElement;\n\n  componentDidLoad() {\n    if (this.initialized) {\n      return;\n    }\n    this.initializePopover();\n  }\n  /**\n   * Initializes the jQuery popover on the trigger element using configured props.\n   */\n  private initializePopover() {\n    $(this.popoverTrigger).popover({\n      trigger: this.trigger,\n      content: this.content,\n      placement: this.placement,\n      html: this.renderContentAsHtml,\n    });\n    this.initialized = true;\n  }\n\n  disconnectedCallback() {\n    $(this.popoverTrigger).popover('dispose');\n  }\n\n  render() {\n    return (\n      <Host style={{ '--ir-popover-left': this.irPopoverLeft }}>\n        {this.trigger !== 'focus' ? (\n          <p\n            ref={el => (this.popoverTrigger = el)}\n            class=\"popover-title m-0 p-0\"\n            style={{\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              cursor: 'pointer',\n            }}\n          >\n            <slot />\n          </p>\n        ) : (\n          <button tabindex=\"0\" class=\"popover-trigger\" ref={el => (this.popoverTrigger = el)}>\n            <slot />\n          </button>\n        )}\n      </Host>\n    );\n  }\n}\n",":host {\n  display: block;\n}\n","import { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { Booking } from '@/models/booking.dto';\nimport locales from '@/stores/locales.store';\nimport { getPrivateNote } from '@/utils/booking';\nimport { Component, Event, EventEmitter, Prop, State, h } from '@stencil/core';\nimport { ICountry } from '@/models/IBooking';\nimport { _formatDate, _formatTime } from '../functions';\nimport { BookingDetailsSidebarEvents, OpenSidebarEvent } from '../types';\n\n@Component({\n  tag: 'ir-reservation-information',\n  styleUrl: 'ir-reservation-information.css',\n  scoped: true,\n})\nexport class IrReservationInformation {\n  @Prop() booking: Booking;\n  @Prop() countries: ICountry[];\n\n  @State() userCountry: ICountry | null = null;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<any>>;\n  componentWillLoad() {\n    const guestCountryId = this.booking?.guest?.country_id;\n    this.userCountry = guestCountryId ? this.countries?.find(country => country.id === guestCountryId) || null : null;\n  }\n  private handleEditClick(e: CustomEvent, type: BookingDetailsSidebarEvents) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    this.openSidebar.emit({ type });\n  }\n\n  private renderPhoneNumber() {\n    const { mobile_without_prefix, country_phone_prefix, country_id } = this.booking.guest;\n    if (!mobile_without_prefix) {\n      return null;\n    }\n    if (country_phone_prefix) {\n      return country_phone_prefix + ' ' + mobile_without_prefix;\n    }\n    if (country_id) {\n      const selectedCountry = this.countries.find(c => c.id === country_id);\n      if (!selectedCountry) {\n        throw new Error('Invalid country id');\n      }\n      return selectedCountry.phone_prefix + ' ' + mobile_without_prefix;\n    }\n    return mobile_without_prefix;\n    // const { mobile, country_phone_prefix, country_id } = this.booking.guest;\n    // if (!mobile) {\n    //   return null;\n    // }\n    // if (this.booking.is_direct) {\n    //   if (country_phone_prefix) {\n    //     return country_phone_prefix + ' ' + mobile;\n    //   }\n    //   if (country_id) {\n    //     const selectedCountry = this.countries.find(c => c.id === country_id);\n    //     if (!selectedCountry) {\n    //       throw new Error('Invalid country id');\n    //     }\n    //     return selectedCountry.phone_prefix + ' ' + mobile;\n    //   }\n    // }\n    // return mobile;\n  }\n  render() {\n    const privateNote = getPrivateNote(this.booking.extras);\n    return (\n      <div class=\"card\">\n        <div class=\"p-1\">\n          <p>{this.booking.property.name || ''}</p>\n          <ir-label\n            labelText={`${locales.entries.Lcz_Source}:`}\n            content={this.booking.origin.Label}\n            image={{ src: this.booking.origin.Icon, alt: this.booking.origin.Label }}\n          ></ir-label>\n          <ir-label\n            renderContentAsHtml\n            labelText={`${locales.entries.Lcz_BookedOn}:`}\n            content={`${_formatDate(this.booking.booked_on.date)}&nbsp&nbsp&nbsp&nbsp${_formatTime(\n              this.booking.booked_on.hour.toString(),\n              this.booking.booked_on.minute.toString(),\n            )}`}\n          ></ir-label>\n          <ir-label labelText={`${locales.entries.Lcz_BookedBy}:`} content={`${this.booking.guest.first_name} ${this.booking.guest.last_name}`}>\n            {this.booking.guest?.nbr_confirmed_bookings > 1 && !this.booking.agent && (\n              <div class={'m-0 p-0'} slot=\"prefix\">\n                <ir-tooltip message={`${locales.entries.Lcz_BookingsNbr}`.replace('%1', this.booking.guest.nbr_confirmed_bookings.toString())} customSlot>\n                  <div class=\"d-flex align-items-center m-0 p-0\" slot=\"tooltip-trigger\" style={{ gap: '0.25rem' }}>\n                    <p class={'p-0 m-0'} style={{ color: '#FB0AAD' }}>\n                      {this.booking.guest.nbr_confirmed_bookings}\n                    </p>\n                    <ir-icons style={{ '--icon-size': '1rem' }} color=\"#FB0AAD\" name=\"heart-fill\"></ir-icons>\n                  </div>\n                </ir-tooltip>\n              </div>\n            )}\n            <ir-button\n              slot=\"suffix\"\n              variant=\"icon\"\n              icon_name={'edit'}\n              style={{ ...colorVariants.secondary, '--icon-size': '1.1rem' }}\n              onClickHandler={e => this.handleEditClick(e, 'guest')}\n            ></ir-button>\n          </ir-label>\n          {this.booking.guest.mobile && <ir-label labelText={`${locales.entries.Lcz_Phone}:`} content={this.renderPhoneNumber()}></ir-label>}\n          {!this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_Email}:`} content={this.booking.guest.email}></ir-label>}\n          {this.booking.guest.alternative_email && <ir-label labelText={`${locales.entries.Lcz_AlternativeEmail}:`} content={this.booking.guest.alternative_email}></ir-label>}\n          {this.booking?.guest?.address && <ir-label labelText={`${locales.entries.Lcz_Address}:`} content={this.booking.guest.address}></ir-label>}\n          {this.userCountry && (\n            <ir-label\n              labelText={`${locales.entries.Lcz_Country}:`}\n              isCountryImage\n              content={this.userCountry.name}\n              image={{ src: this.userCountry.flag, alt: this.userCountry.name }}\n            ></ir-label>\n          )}\n          {this.booking.guest?.notes && <ir-label display=\"inline\" labelText={`${locales.entries.Lcz_GuestPrivateNote}:`} content={this.booking.guest?.notes}></ir-label>}\n          {this.booking.is_direct && <ir-label labelText={`${locales.entries.Lcz_ArrivalTime}:`} content={this.booking.arrival.description}></ir-label>}\n          {this.booking.promo_key && <ir-label labelText={`${locales.entries.Lcz_Coupon}:`} content={this.booking.promo_key}></ir-label>}\n          {/* {this.booking.agent && <ir-label labelText={`${locales.entries.Lcz_AgentCode?.split(':')[0]}:`} content={this.booking.agent.name}></ir-label>} */}\n          {this.booking.is_in_loyalty_mode && !this.booking.promo_key && (\n            <div class=\"d-flex align-items-center\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\n                <path\n                  fill=\"#fc6c85\"\n                  d=\"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z\"\n                />\n              </svg>\n              <p class=\"m-0 p-0 ml-1\">{locales.entries.Lcz_LoyaltyDiscountApplied}</p>\n            </div>\n          )}\n          {this.booking.is_direct ? (\n            <ir-label labelText={`${locales.entries.Lcz_GuestRemark}:`} display=\"inline\" content={this.booking.remark}></ir-label>\n          ) : (\n            <ota-label\n              class={'m-0 p-0'}\n              label={`${locales.entries.Lcz_ChannelNotes || 'Channel notes'}:`}\n              remarks={this.booking.ota_notes}\n              maxVisibleItems={this.booking.ota_notes?.length}\n            ></ota-label>\n          )}\n          <div class=\"d-flex align-items-center justify-content-between\">\n            <ir-label\n              labelText={`${locales.entries.Lcz_BookingPrivateNote}:`}\n              placeholder={locales.entries.Lcz_VisibleToHotelOnly}\n              content={privateNote}\n              display={privateNote ? 'inline' : 'flex'}\n              // ignore_content\n            ></ir-label>\n            <ir-button variant=\"icon\" icon_name=\"edit\" style={colorVariants.secondary} onClickHandler={e => this.handleEditClick(e, 'extra_note')}></ir-button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n",".light-blue-bg {\n  background: #acecff;\n  padding: 0.1rem 0.3rem;\n  border-radius: 5px;\n  display: block;\n  max-width: 100px;\n  box-sizing: border-box;\n  display: inline-block;\n  overflow: hidden;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  cursor: default;\n}\n\n.room_statements {\n  display: block;\n  width: 100%; /* Ensure the container uses the full width */\n}\n.room_statements {\n  display: block;\n  width: 100%;\n}\n.room_statements span {\n  display: inline;\n  white-space: normal;\n  line-height: 1.5;\n  word-break: break-word;\n}\n\n.room_statements b {\n  display: inline;\n  margin-right: 5px;\n}\n.payment-container {\n  position: absolute;\n  right: 1rem;\n  height: fit-content;\n}\n:host {\n  position: relative;\n}\n.sm-mr {\n  margin-right: 3px;\n}\n.subtotal_row {\n  padding-top: 8px;\n  font-weight: 600;\n}\n.room_actions_btns {\n  gap: 0.5rem;\n}\n.night-cost {\n  color: #7cbebe;\n}\n.room_actions_btns {\n  /* max-width: 50%; */\n  white-space: nowrap;\n  width: max-content;\n}\n.room_actions_btns {\n  flex: 1 1 0%;\n  display: flex;\n  justify-content: flex-end;\n}\n/* .cancelation {\n  max-width: 30%;\n} */\n.mx-0-5 {\n  margin-left: 2px !important;\n  margin-right: 2px !important;\n}\n.tax-width {\n  font-size: 10px;\n  /* flex-wrap: wrap; */\n}\n.sm-mb-1 {\n  margin-bottom: 5px !important;\n}\n.sm-mt-1 {\n  margin-top: 5px !important;\n}\n.mx-01 {\n  --m: 5px;\n  margin-right: var(--m) !important;\n  margin-left: var(--m) !important;\n}\n","import { Component, h, Prop, EventEmitter, Event, Listen, State, Element, Host, Fragment, Watch } from '@stencil/core';\nimport { _getDay } from '../functions';\nimport { Booking, IUnit, Occupancy, Room, SharedPerson } from '@/models/booking.dto';\nimport { TIglBookPropertyPayload } from '@/models/igl-book-property';\nimport { formatName } from '@/utils/booking';\nimport locales from '@/stores/locales.store';\nimport calendar_data, { isSingleUnit } from '@/stores/calendar-data';\nimport { colorVariants } from '@/components/ui/ir-icons/icons';\nimport { formatAmount } from '@/utils/utils';\nimport { IEntries } from '@/models/IBooking';\nimport { BookingService } from '@/services/booking.service';\nimport { OpenSidebarEvent, RoomGuestsPayload } from '../types';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nexport type RoomModalReason = 'delete' | 'checkin' | 'checkout' | null;\n@Component({\n  tag: 'ir-room',\n  styleUrl: 'ir-room.css',\n  scoped: true,\n})\nexport class IrRoom {\n  @Element() element: HTMLIrRoomElement;\n  // Room Data\n  @Prop() booking: Booking;\n  @Prop() bookingIndex: number;\n  @Prop() isEditable: boolean;\n  @Prop() room: Room;\n  @Prop() property_id: number;\n  // Meal Code names\n  @Prop() mealCodeName: string;\n  @Prop() myRoomTypeFoodCat: string;\n  // Currency\n  @Prop() currency: string = 'USD';\n  @Prop() language: string = 'en';\n  @Prop() legendData;\n  @Prop() roomsInfo;\n  @Prop() bedPreferences: IEntries[];\n  @Prop() departureTime: IEntries[];\n  // Booleans Conditions\n  @Prop() hasRoomEdit: boolean = false;\n  @Prop() hasRoomDelete: boolean = false;\n  @Prop() hasRoomAdd: boolean = false;\n  @Prop() hasCheckIn: boolean = false;\n  @Prop() hasCheckOut: boolean = false;\n\n  @State() collapsed: boolean = false;\n  @State() isLoading: boolean = false;\n  @State() modalReason: RoomModalReason = null;\n  @State() mainGuest: SharedPerson;\n  @State() isModelOpen: boolean = false;\n\n  // Event Emitters\n  @Event({ bubbles: true, composed: true }) deleteFinished: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n  @Event({ bubbles: true, composed: true }) pressCheckIn: EventEmitter;\n  @Event({ bubbles: true, composed: true }) pressCheckOut: EventEmitter;\n  @Event({ bubbles: true, composed: true }) editInitiated: EventEmitter<TIglBookPropertyPayload>;\n  @Event() resetbooking: EventEmitter<null>;\n  @Event() openSidebar: EventEmitter<OpenSidebarEvent<RoomGuestsPayload>>;\n\n  private modal: HTMLIrModalElement;\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.mainGuest = this.getMainGuest();\n  }\n  @Listen('clickHandler')\n  handleClick(e) {\n    let target = e.target;\n    if (target.id == 'checkin') {\n      this.pressCheckIn.emit(this.room);\n    } else if (target.id == 'checkout') {\n      this.pressCheckOut.emit(this.room);\n    }\n  }\n  @Watch('room')\n  handleRoomDataChange() {\n    this.mainGuest = this.getMainGuest();\n  }\n\n  private getDateStr(date, locale = 'default') {\n    return date.getDate() + ' ' + date.toLocaleString(locale, { month: 'short' }) + ' ' + date.getFullYear();\n  }\n  private handleEditClick() {\n    this.editInitiated.emit({\n      event_type: 'EDIT_BOOKING',\n      ID: this.room['assigned_units_pool'],\n      NAME: formatName(this.mainGuest?.first_name, this.mainGuest?.last_name),\n      EMAIL: this.booking.guest.email,\n      PHONE: this.booking.guest.mobile,\n      REFERENCE_TYPE: '',\n      FROM_DATE: this.booking.from_date,\n      TO_DATE: this.booking.to_date,\n      TITLE: `${locales.entries.Lcz_EditBookingFor} ${this.room?.roomtype?.name} ${(this.room?.unit as IUnit)?.name || ''}`,\n      defaultDateRange: {\n        dateDifference: this.room.days.length,\n        fromDate: new Date(this.room.from_date + 'T00:00:00'),\n        fromDateStr: this.getDateStr(new Date(this.room.from_date + 'T00:00:00')),\n        toDate: new Date(this.room.to_date + 'T00:00:00'),\n        toDateStr: this.getDateStr(new Date(this.room.to_date + 'T00:00:00')),\n        message: '',\n      },\n      bed_preference: this.room.bed_preference,\n      adult_child_offering: this.room.rateplan.selected_variation.adult_child_offering,\n      ADULTS_COUNT: this.room.rateplan.selected_variation.adult_nbr,\n      ARRIVAL: this.booking.arrival,\n      ARRIVAL_TIME: this.booking.arrival.description,\n      BOOKING_NUMBER: this.booking.booking_nbr,\n      cancelation: this.room.rateplan.cancelation,\n      channel_booking_nbr: this.booking.channel_booking_nbr,\n      CHILDREN_COUNT: this.room.rateplan.selected_variation.child_nbr,\n      COUNTRY: this.booking.guest.country_id,\n      ENTRY_DATE: this.booking.from_date,\n      FROM_DATE_STR: this.booking.format.from_date,\n      guarantee: this.room.rateplan.guarantee,\n      GUEST: this.mainGuest,\n      IDENTIFIER: this.room.identifier,\n      is_direct: this.booking.is_direct,\n      IS_EDITABLE: this.booking.is_editable,\n      NO_OF_DAYS: this.room.days.length,\n      NOTES: this.booking.remark,\n      origin: this.booking.origin,\n      POOL: this.room['assigned_units_pool'],\n      PR_ID: (this.room.unit as IUnit)?.id,\n      RATE: this.room.total,\n      RATE_PLAN: this.room.rateplan.name,\n      RATE_PLAN_ID: this.room.rateplan.id,\n      RATE_TYPE: this.room.roomtype.id,\n      ROOMS: this.booking.rooms,\n      SOURCE: this.booking.source,\n      SPLIT_BOOKING: false,\n      STATUS: 'IN-HOUSE',\n      TO_DATE_STR: this.booking.format.to_date,\n      TOTAL_PRICE: this.booking.total,\n      legendData: this.legendData,\n      roomsInfo: this.roomsInfo,\n      roomName: (this.room.unit as IUnit)?.name || '',\n      PICKUP_INFO: this.booking.pickup_info,\n      booking: this.booking,\n      currentRoomType: this.room,\n    });\n  }\n  private openModal(reason: RoomModalReason) {\n    if (!reason) {\n      return;\n    }\n    this.modalReason = reason;\n    this.modal.openModal();\n  }\n  private async handleModalConfirmation(e: CustomEvent) {\n    try {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      if (!this.modalReason) {\n        return;\n      }\n      this.isLoading = true;\n      switch (this.modalReason) {\n        case 'delete':\n          await this.deleteRoom();\n          break;\n        case 'checkin':\n        case 'checkout':\n          await this.bookingService.handleExposedRoomInOut({\n            booking_nbr: this.booking.booking_nbr,\n            room_identifier: this.room.identifier,\n            status: this.modalReason === 'checkin' ? '001' : '002',\n          });\n          this.resetbooking.emit(null);\n          break;\n        default:\n          break;\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      this.isLoading = false;\n      this.modalReason = null;\n      this.modal.closeModal();\n    }\n  }\n  private async deleteRoom() {\n    let oldRooms = [...this.booking.rooms];\n    oldRooms = oldRooms.filter(room => room.identifier !== this.room.identifier);\n\n    const body = {\n      assign_units: true,\n      check_in: true,\n      is_pms: true,\n      is_direct: true,\n      booking: {\n        booking_nbr: this.booking.booking_nbr,\n        from_date: this.booking.from_date,\n        to_date: this.booking.to_date,\n        remark: this.booking.remark,\n        property: this.booking.property,\n        source: this.booking.source,\n        currency: this.booking.currency,\n        arrival: this.booking.arrival,\n        guest: this.booking.guest,\n        rooms: oldRooms,\n      },\n      extras: this.booking.extras,\n      pickup_info: this.booking.pickup_info,\n    };\n    await this.bookingService.doReservation(body);\n    this.deleteFinished.emit(this.room.identifier);\n  }\n  private async updateDepartureTime(code: string) {\n    try {\n      await this.bookingService.setDepartureTime({\n        property_id: this.property_id,\n        code,\n        room_identifier: this.room.identifier,\n      });\n      this.toast.emit({\n        type: 'success',\n        description: '',\n        title: 'Saved Successfully',\n        position: 'top-right',\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  private formatVariation({ infant_nbr, adult_nbr, children_nbr }: Occupancy) {\n    const adultCount = adult_nbr > 0 ? adult_nbr : 0;\n    const childCount = children_nbr > 0 ? children_nbr : 0;\n    const infantCount = infant_nbr > 0 ? infant_nbr : 0;\n\n    const adultLabel = adultCount > 1 ? locales.entries.Lcz_Adults.toLowerCase() : locales.entries.Lcz_Adult.toLowerCase();\n    const childLabel = childCount > 1 ? locales.entries.Lcz_Children.toLowerCase() : locales.entries.Lcz_Child.toLowerCase();\n    const infantLabel = infantCount > 1 ? locales.entries.Lcz_Infants.toLowerCase() : locales.entries.Lcz_Infant.toLowerCase();\n\n    const parts = [];\n    if (adultCount > 0) {\n      parts.push(`${adultCount} ${adultLabel}`);\n    }\n    if (childCount > 0) {\n      parts.push(`${childCount} ${childLabel}`);\n    }\n    if (infantCount > 0) {\n      parts.push(`${infantCount} ${infantLabel}`);\n    }\n\n    return parts.join('&nbsp&nbsp&nbsp&nbsp');\n  }\n  private getSmokingLabel() {\n    if (this.booking.is_direct) {\n      if (!this.room.smoking_option) {\n        return null;\n      }\n      const currRT = calendar_data.roomsInfo.find(rt => rt.id === this.room.roomtype.id);\n      if (currRT) {\n        const smoking_option = currRT['smoking_option']?.allowed_smoking_options;\n        if (smoking_option) {\n          return smoking_option.find(s => s.code === this.room.smoking_option)?.description;\n        }\n        return null;\n      }\n      return null;\n    }\n    return this.room.ota_meta?.smoking_preferences;\n  }\n\n  private getBedName() {\n    if (this.booking.is_direct) {\n      const bed = this.bedPreferences.find(p => p.CODE_NAME === this.room?.bed_preference?.toString());\n      if (!bed) {\n        return;\n      }\n      return bed[`CODE_VALUE_${this.language}`] ?? bed.CODE_VALUE_EN;\n    }\n    return this.room.ota_meta?.bed_preferences;\n  }\n  private renderModalMessage() {\n    switch (this.modalReason) {\n      case 'delete':\n        return `${locales.entries['Lcz_AreYouSureDoYouWantToRemove ']} ${this.room.roomtype.name} ${this.room.unit ? (this.room.unit as IUnit).name : ''} ${\n          locales.entries.Lcz_FromThisBooking\n        }`;\n      case 'checkin':\n        return `Are you sure you want to Check In this unit?\n`;\n      case 'checkout':\n        return `Are you sure you want to Check Out this unit?`;\n      default:\n        return '';\n    }\n  }\n  private handleCheckIn() {\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\n    if (this.room.sharing_persons.length < adult_nbr + children_nbr + infant_nbr) {\n      return this.showGuestModal();\n    }\n    return this.renderModalMessage();\n  }\n  private getMainGuest() {\n    return this.room.sharing_persons?.find(p => p.is_main);\n  }\n\n  render() {\n    const bed = this.getBedName();\n    return (\n      <Host class=\"p-1 d-flex m-0\">\n        <ir-button\n          variant=\"icon\"\n          id=\"drawer-icon\"\n          data-toggle=\"collapse\"\n          data-target={`#roomCollapse-${this.room.identifier?.split(' ').join('')}`}\n          aria-expanded={this.collapsed ? 'true' : 'false'}\n          aria-controls=\"myCollapse\"\n          class=\"mr-1\"\n          icon_name={this.collapsed ? 'closed_eye' : 'open_eye'}\n          onClickHandler={() => {\n            this.collapsed = !this.collapsed;\n          }}\n          style={{ '--icon-size': '1.6rem' }}\n        ></ir-button>\n        <div class=\"flex-fill m-0 \">\n          <div class=\"d-flex align-items-start justify-content-between sm-mb-1\">\n            <p class=\"m-0 p-0\">\n              <span class=\"m-0 p-0\" style={{ fontWeight: '600' }}>\n                {this.myRoomTypeFoodCat || ''}{' '}\n              </span>{' '}\n              {this.mealCodeName} {this.room.rateplan.is_non_refundable && ` - ${locales.entries.Lcz_NonRefundable}`}{' '}\n            </p>\n            {/*this.room.My_Room_type.My_Room_type_desc[0].CUSTOM_TXT || ''*/}\n            <div class=\"d-flex m-0 p-0 align-items-center room_actions_btns\">\n              <span class=\"p-0 m-0 font-weight-bold\">{formatAmount(this.currency, this.room['gross_total'])}</span>\n              {this.hasRoomEdit && this.isEditable && (\n                <ir-button\n                  id={`roomEdit-${this.room.identifier}`}\n                  variant=\"icon\"\n                  icon_name=\"edit\"\n                  // class=\"mx-1\"\n                  style={colorVariants.secondary}\n                  onClickHandler={this.handleEditClick.bind(this)}\n                ></ir-button>\n              )}\n              {this.hasRoomDelete && this.isEditable && (\n                <ir-button\n                  variant=\"icon\"\n                  onClickHandler={this.openModal.bind(this, 'delete')}\n                  id={`roomDelete-${this.room.identifier}`}\n                  icon_name=\"trash\"\n                  style={colorVariants.danger}\n                ></ir-button>\n              )}\n            </div>\n          </div>\n          <div class=\"d-flex align-items-center sm-mb-1\">\n            <ir-date-view\n              class=\"mr-1  flex-grow-1\"\n              style={{ width: 'fit-content' }}\n              from_date={this.room.from_date}\n              to_date={this.room.to_date}\n              showDateDifference={false}\n            ></ir-date-view>\n            {!isSingleUnit(this.room.roomtype.id) && calendar_data.is_frontdesk_enabled && this.room.unit && (\n              <div class={'d-flex justify-content-center align-items-center'}>\n                <ir-tooltip message={(this.room.unit as IUnit).name} customSlot>\n                  <span slot=\"tooltip-trigger\" class={`light-blue-bg  ${this.hasCheckIn || this.hasCheckOut ? 'mr-2' : ''} `}>\n                    {(this.room.unit as IUnit).name}\n                  </span>\n                </ir-tooltip>\n              </div>\n            )}\n            {this.hasCheckIn && (\n              <ir-button onClickHandler={this.handleCheckIn.bind(this)} id=\"checkin\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckIn}></ir-button>\n            )}\n            {this.hasCheckOut && (\n              <ir-button onClickHandler={this.openModal.bind(this, 'checkout')} id=\"checkout\" btn_color=\"outline\" size=\"sm\" text={locales.entries.Lcz_CheckOut}></ir-button>\n            )}\n          </div>\n          <div class={'d-flex align-items-center'} style={{ gap: '0.5rem' }}>\n            <p class=\"m-0 p-0\">{`${this.mainGuest.first_name || ''} ${this.mainGuest.last_name || ''}`}</p>\n            {this.room.rateplan.selected_variation.adult_nbr > 0 &&\n              (this.room.unit ? (\n                <ir-tooltip message={'View guests'} class=\"m-0 p-0\" customSlot>\n                  <ir-button\n                    class=\"m-0 p-0\"\n                    slot=\"tooltip-trigger\"\n                    btn_color=\"link\"\n                    renderContentAsHtml\n                    onClickHandler={() => this.showGuestModal()}\n                    size=\"sm\"\n                    btnStyle={{ width: 'fit-content', margin: '0', padding: '0', fontSize: 'inherit', textAlign: 'center', lineHeight: '1.2' }}\n                    text={this.formatVariation(this.room.occupancy)}\n                  ></ir-button>\n                </ir-tooltip>\n              ) : (\n                <span innerHTML={this.formatVariation(this.room.occupancy)}></span>\n              ))}\n            {bed && <p class=\"m-0 p-0\">({bed})</p>}\n          </div>\n          <div class=\"d-flex align-items-center\" style={{ marginTop: '0.5rem', marginBottom: '0.875rem', gap: '0.5rem' }}>\n            <p class=\"m-0 p-0\">Expected departure time:</p>\n            <ir-select\n              selectedValue={this.room.departure_time?.code}\n              showFirstOption={false}\n              onSelectChange={e => {\n                this.updateDepartureTime(e.detail);\n              }}\n              data={this.departureTime?.map(d => ({\n                text: d[`CODE_VALUE_${this.language?.toUpperCase()}`] ?? d[`CODE_VALUE_EN`],\n                value: d.CODE_NAME,\n              }))}\n            ></ir-select>\n          </div>\n          <div class=\"collapse\" id={`roomCollapse-${this.room.identifier?.split(' ').join('')}`}>\n            <div class=\"d-flex sm-mb-1 sm-mt-1\">\n              <div class=\" sm-padding-top\">\n                <p class=\"sm-padding-right\" style={{ fontWeight: '600' }}>{`${locales.entries.Lcz_Breakdown}:`}</p>\n              </div>\n              <div class={'flex-fill'}>\n                <table>\n                  {this.room.days.length > 0 &&\n                    this.room.days.map(room => {\n                      return (\n                        <tr>\n                          <td class={'pr-2 text-right'}>{_getDay(room.date)}</td>\n                          <td class=\"text-right\">{formatAmount(this.currency, room.amount)}</td>\n                          {room.cost > 0 && room.cost !== null && <td class=\"pl-2 text-left night-cost\">{formatAmount(this.currency, room.cost)}</td>}\n                        </tr>\n                      );\n                    })}\n                  <tr class={''}>\n                    <th class=\"text-right pr-2 subtotal_row\">{locales.entries.Lcz_SubTotal}</th>\n                    <th class=\"text-right subtotal_row\">{formatAmount(this.currency, this.room.total)}</th>\n                    {this.room.gross_cost > 0 && this.room.gross_cost !== null && <th class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, this.room.cost)}</th>}\n                  </tr>\n                  {this.booking.is_direct ? (\n                    <Fragment>\n                      {(() => {\n                        const filtered_data = calendar_data.taxes.filter(tx => tx.pct > 0);\n                        return filtered_data.map(d => {\n                          return (\n                            <tr>\n                              <td class=\"text-right pr-2\">\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name} ({d.pct}%)\n                              </td>\n                              <td class=\"text-right\">{formatAmount(this.currency, (this.room.total * d.pct) / 100)}</td>\n                              {this.room.gross_cost > 0 && this.room.gross_cost !== null && (\n                                <td class=\"pl-2 text-right night-cost\">{formatAmount(this.currency, (this.room.cost * d.pct) / 100)}</td>\n                              )}\n                            </tr>\n                          );\n                        });\n                      })()}\n                    </Fragment>\n                  ) : (\n                    <Fragment>\n                      {(() => {\n                        const filtered_data = this.room.ota_taxes.filter(tx => tx.amount > 0);\n                        return filtered_data.map(d => {\n                          return (\n                            <tr>\n                              <td class=\"text-right pr-2\">\n                                {d.is_exlusive ? locales.entries.Lcz_Excluding : locales.entries.Lcz_Including} {d.name}\n                              </td>\n                              <td class=\"text-right\">\n                                {d.currency.symbol}\n                                {d.amount}\n                              </td>\n                            </tr>\n                          );\n                        });\n                      })()}\n                    </Fragment>\n                  )}\n                </table>\n              </div>\n            </div>\n            <ir-label labelText={`${locales.entries.Lcz_SmokingOptions}:`} display=\"inline\" content={this.getSmokingLabel()}></ir-label>\n            {this.booking.is_direct && (\n              <Fragment>\n                {this.room.rateplan.cancelation && (\n                  <ir-label labelText={`${locales.entries.Lcz_Cancellation}:`} display=\"inline\" content={this.room.rateplan.cancelation || ''} renderContentAsHtml></ir-label>\n                )}\n                {this.room.rateplan.guarantee && (\n                  <ir-label labelText={`${locales.entries.Lcz_Guarantee}:`} display=\"inline\" content={this.room.rateplan.guarantee || ''} renderContentAsHtml></ir-label>\n                )}\n              </Fragment>\n            )}\n            {this.room.ota_meta && (\n              <div>\n                <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} display=\"inline\" content={this.room.ota_meta.meal_plan}></ir-label>\n                <ir-label labelText={`${locales.entries.Lcz_Policies}:`} display=\"inline\" content={this.room.ota_meta.policies}></ir-label>\n              </div>\n            )}\n            {/* {this.bookingEvent.is_direct && <ir-label labelText={`${locales.entries.Lcz_MealPlan}:`} content={this.mealCodeName}></ir-label>} */}\n          </div>\n        </div>\n        <ir-modal\n          autoClose={false}\n          ref={el => (this.modal = el)}\n          isLoading={this.isLoading}\n          onConfirmModal={this.handleModalConfirmation.bind(this)}\n          iconAvailable={true}\n          icon=\"ft-alert-triangle danger h1\"\n          leftBtnText={locales.entries.Lcz_Cancel}\n          rightBtnText={this.modalReason === 'delete' ? locales.entries.Lcz_Delete : locales.entries.Lcz_Confirm}\n          leftBtnColor=\"secondary\"\n          rightBtnColor={this.modalReason === 'delete' ? 'danger' : 'primary'}\n          modalTitle={locales.entries.Lcz_Confirmation}\n          modalBody={this.renderModalMessage()}\n        ></ir-modal>\n      </Host>\n    );\n  }\n  private showGuestModal(): void {\n    const { adult_nbr, children_nbr, infant_nbr } = this.room.occupancy;\n    this.openSidebar.emit({\n      type: 'room-guest',\n      payload: {\n        roomName: (this.room.unit as IUnit)?.name,\n        sharing_persons: this.room.sharing_persons,\n        totalGuests: adult_nbr + children_nbr + infant_nbr,\n        checkin: this.hasCheckIn,\n        identifier: this.room.identifier,\n      },\n    });\n  }\n}\n","import { SharedPerson } from '@/models/booking.dto';\nimport moment from 'moment';\nimport { FactoryArg, MaskedRange } from 'imask';\n\nexport const defaultGuest: SharedPerson = {\n  id: -1,\n  full_name: '',\n  country_id: null,\n  dob: '',\n  id_info: {\n    type: {\n      code: null,\n      description: null,\n    },\n    number: '',\n  },\n  address: null,\n  alternative_email: null,\n  cci: null,\n  city: null,\n  country: undefined,\n  country_phone_prefix: null,\n  email: null,\n  first_name: '',\n  last_name: '',\n  mobile: null,\n  nbr_confirmed_bookings: 0,\n  notes: null,\n  password: null,\n  subscribe_to_news_letter: null,\n};\n/**Date of birth mask for room guests  with min */\nexport const dateMask: FactoryArg = {\n  mask: Date,\n  pattern: 'DD/MM/YYYY',\n  lazy: false,\n  min: new Date(1900, 0, 1),\n  max: new Date(),\n  format: date => moment(date).format('DD/MM/YYYY'),\n  parse: str => moment(str, 'DD/MM/YYYY').toDate(),\n  autofix: true,\n  placeholderChar: '_',\n  blocks: {\n    YYYY: {\n      mask: MaskedRange,\n      from: 1970,\n      to: new Date().getFullYear(),\n      placeholderChar: 'Y',\n    },\n    MM: {\n      mask: MaskedRange,\n      from: 1,\n      to: 12,\n      placeholderChar: 'M',\n    },\n    DD: {\n      mask: MaskedRange,\n      from: 1,\n      to: 31,\n      placeholderChar: 'D',\n    },\n  },\n};\n",":host {\n  display: block;\n  height: 100%;\n  position: relative;\n  text-align: start !important;\n}\n.id-select {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border-right-width: 0;\n}\n:host {\n  display: block;\n  width: 100%;\n}\n\n.guest-grid > * {\n  height: 100%;\n}\n\n.guests-labels {\n  display: none;\n}\n.guest_label {\n  width: 100px;\n  color: #6b6f82;\n}\n.sharing_persons_label {\n  display: none;\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.guest_document input {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.guests-labels *,\n.sharing_persons_label {\n  margin-bottom: 0.5rem;\n  padding-bottom: 0;\n}\n\n/*sm*/\n@media (min-width: 640px) {\n}\n\n/*md*/\n@media (min-width: 768px) {\n  .sharing_persons_label {\n    display: block;\n  }\n  .guest_country_picker {\n    margin-bottom: 3px;\n  }\n  .guest-grid {\n    display: grid;\n    grid-template-columns: 2fr 2fr 2fr 2fr 5fr;\n    gap: 0.5rem;\n    align-items: flex-start;\n  }\n\n  .guest_label,\n  .sharing_persons_heading,\n  .main_guest_heading {\n    display: none;\n  }\n}\n\n/*lg*/\n@media (min-width: 1024px) {\n}\n\n/*xl*/\n@media (min-width: 1280px) {\n}\n\n/*2xl*/\n@media (min-width: 1536px) {\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { SharedPerson, validateSharedPerson, ZIdInfo, ZSharedPerson } from '@/models/booking.dto';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport locales from '@/stores/locales.store';\nimport { Component, Event, EventEmitter, Fragment, Prop, State, h } from '@stencil/core';\nimport moment from 'moment';\nimport { dateMask, defaultGuest } from './data';\nimport { BookingService } from '@/services/booking.service';\nimport { ICountry, IEntries } from '@/models/IBooking';\nimport { ZodError } from 'zod';\n@Component({\n  tag: 'ir-room-guests',\n  styleUrls: ['ir-room-guests.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IrRoomGuests {\n  /**\n   * The name of the room currently being displayed.\n   * Used to label the room in the user interface for clarity.\n   */\n  @Prop() roomName: string;\n\n  /**\n   * A unique identifier for the room.\n   * This is used to distinguish between rooms, especially when performing operations like saving or checking in guests.\n   */\n  @Prop() identifier: string;\n\n  /**\n   * An array of people sharing the room.\n   * Contains information about the {locales.entries.Lcz_MainGuest} and additional guests, such as their name, date of birth, {locales.entries.Lcz_Nationality}, and ID details.\n   */\n  @Prop() sharedPersons: SharedPerson[] = [];\n\n  /**\n   * The total number of guests for the room.\n   * Determines how many guest input forms to display in the UI.\n   */\n  @Prop() totalGuests: number = 0;\n\n  /**\n   * A list of available countries.\n   * Used to populate dropdowns for selecting the {locales.entries.Lcz_Nationality} of guests.\n   */\n  @Prop() countries: ICountry[];\n\n  /**\n   * A boolean indicating whether the room is in the process of being checked in.\n   * If true, additional actions like saving the room state as \"checked in\" are performed.\n   */\n  @Prop() checkIn: boolean;\n\n  /**\n   * The language used for displaying text content in the component.\n   * Defaults to English ('en'), but can be set to other supported languages.\n   */\n  @Prop() language: string = 'en';\n\n  /**\n   * A unique booking number associated with the room.\n   * This is used for backend operations like saving guest information or checking in the room.\n   */\n  @Prop() bookingNumber: string;\n\n  @State() guests: SharedPerson[] = [];\n  @State() idTypes: IEntries[] = [];\n  @State() error: Record<string, boolean> = {};\n  @State() isLoading: boolean;\n  @State() propertyCountry: ICountry;\n  @State() autoValidate = false;\n\n  @Event() closeModal: EventEmitter<null>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event() updateRoomGuests: EventEmitter<{ identifier: string; guests: SharedPerson[] }>;\n\n  private bookingService = new BookingService();\n\n  componentWillLoad() {\n    this.init();\n    this.initializeGuests();\n  }\n\n  private async init() {\n    try {\n      this.isLoading = true;\n      const [country, idTypes] = await Promise.all([this.bookingService.getUserDefaultCountry(), this.bookingService.getSetupEntriesByTableName('_ID_TYPE')]);\n      this.idTypes = idTypes;\n      if (country) {\n        this.propertyCountry = this.countries.find(c => c.id === country.COUNTRY_ID);\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private initializeGuests(): void {\n    let guests = [];\n    if (this.totalGuests > this.sharedPersons.length) {\n      const defaultGuestsCount = this.totalGuests - this.sharedPersons.length;\n      guests = [\n        ...this.sharedPersons,\n        ...Array(defaultGuestsCount).fill({\n          ...defaultGuest,\n          id_info: {\n            ...defaultGuest.id_info,\n            type: {\n              code: this.idTypes[0]?.CODE_NAME || '001',\n              description: this.idTypes[0]?.CODE_VALUE_EN || '',\n            },\n            number: '',\n          },\n        }),\n      ];\n    } else {\n      guests = [...this.sharedPersons];\n    }\n    guests = guests.map(g => ({ ...g, dob: new Date(g.dob).getFullYear() === 1900 ? null : g.dob }));\n    this.guests = guests.map(g => ({ ...g, dob: g.dob ? moment(new Date(g.dob)).format('DD/MM/YYYY') : '', country_id: g.country ? g.country.id : null }));\n  }\n\n  private updateGuestInfo(index: number, params: Partial<SharedPerson>) {\n    const tempGuests = [...this.guests];\n    let tempGuest = tempGuests[index];\n    tempGuest = { ...tempGuest, ...params };\n    tempGuests[index] = tempGuest;\n    this.guests = [...tempGuests];\n  }\n\n  private async saveGuests() {\n    try {\n      this.error = {};\n      this.autoValidate = true;\n      // ZSharedPersons.parse(this.guests);\n      for (const guest of this.guests) {\n        validateSharedPerson(guest);\n      }\n      await this.bookingService.handleExposedRoomGuests({\n        booking_nbr: this.bookingNumber,\n        identifier: this.identifier,\n        guests: this.guests\n          .map(g => {\n            if (!g.first_name && g.id === -1) {\n              return null;\n            }\n            return { ...g, dob: g.dob ? moment(g.dob, 'DD/MM/YYYY').format('YYYY-MM-DD') : null };\n          })\n          .filter(Boolean),\n      });\n      if (this.checkIn) {\n        await this.bookingService.handleExposedRoomInOut({\n          booking_nbr: this.bookingNumber,\n          room_identifier: this.identifier,\n          status: '001',\n        });\n      }\n      this.closeModal.emit(null);\n      this.updateRoomGuests.emit({ identifier: this.identifier, guests: this.guests });\n      this.resetBookingEvt.emit();\n    } catch (error) {\n      console.log(error);\n      if (error instanceof ZodError) {\n        let errors = {};\n        error.issues.forEach(e => {\n          errors[e.path[e.path.length - 1]] = true;\n        });\n        this.error = { ...errors };\n      }\n    }\n  }\n\n  render() {\n    if (this.isLoading) {\n      return (\n        <div class={'loading-container'}>\n          <ir-spinner></ir-spinner>\n        </div>\n      );\n    }\n    return (\n      <form\n        class=\"sheet-container\"\n        style={{ minWidth: '300px' }}\n        onSubmit={e => {\n          e.preventDefault();\n          this.saveGuests();\n        }}\n      >\n        <ir-title class=\"px-1 sheet-header\" onCloseSideBar={() => this.closeModal.emit(null)} label={`Room ${this.roomName}`} displayContext=\"sidebar\"></ir-title>\n        <section class={'sheet-body px-1'}>\n          <div class=\"\">\n            <div class=\"guest-grid guests-labels\">\n              <p class=\"\">{locales.entries.Lcz_MainGuest}</p>\n              <p class=\"\"></p>\n              <p class=\" \">{locales.entries.Lcz_DOB}</p>\n              <p class=\"\">{locales.entries.Lcz_Nationality}</p>\n              <p class=\" \">{locales.entries.Lcz_Documents}</p>\n            </div>\n            <h5 class=\"main_guest_heading\">{locales.entries.Lcz_MainGuest}</h5>\n            {this.guests.map((guest, idx) => {\n              let isRowValid = true;\n              try {\n                validateSharedPerson(guest);\n              } catch (error) {\n                isRowValid = false;\n              }\n              console.log(`row ${idx}=>${isRowValid}`);\n              return (\n                <Fragment>\n                  {idx === 1 && (\n                    <div class=\"d-flex mx-0 px-0\">\n                      <h5 class=\"mx-0 px-0 sharing_persons_heading\">{locales.entries.Lcz_PersonsSharingRoom}</h5>\n                      <p class=\"mx-0 px-0 sharing_persons_label\">{locales.entries.Lcz_PersonsSharingRoom}</p>\n                    </div>\n                  )}\n                  <div key={idx} class=\"guest-grid\">\n                    <div class={'m-0 p-0 d-flex align-items-center h-100'}>\n                      <p class=\"guest_label\">First name</p>\n                      <ir-input-text\n                        class=\"flex-grow-1 h-100\"\n                        id={`first_name_${idx}`}\n                        zod={ZSharedPerson.pick({ first_name: true })}\n                        error={!!this.error['first_name'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"first_name\"\n                        placeholder=\"First name\"\n                        onTextChange={e => this.updateGuestInfo(idx, { first_name: e.detail })}\n                        value={guest.first_name}\n                        maxLength={40}\n                      ></ir-input-text>\n                    </div>\n                    <div class={'m-0 p-0 d-flex align-items-center h-100'}>\n                      <p class=\"guest_label\">Last name</p>\n                      <ir-input-text\n                        maxLength={40}\n                        class=\"flex-grow-1 h-100\"\n                        id={`last_name_${idx}`}\n                        zod={ZSharedPerson.pick({ last_name: true })}\n                        error={!!this.error['last_name'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"last_name\"\n                        placeholder=\"Last name\"\n                        onTextChange={e => this.updateGuestInfo(idx, { last_name: e.detail })}\n                        value={guest.last_name}\n                      ></ir-input-text>\n                    </div>\n                    <div class=\"flex-grow-0 m-0 p-0 h-100 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_DOB}</p>\n                      <ir-input-text\n                        class=\"flex-grow-1 h-100\"\n                        id={`dob_${idx}`}\n                        zod={ZSharedPerson.pick({ dob: true })}\n                        error={!!this.error['dob'] && !isRowValid}\n                        autoValidate={this.autoValidate}\n                        wrapKey=\"dob\"\n                        mask={dateMask}\n                        placeholder=\"\"\n                        onTextChange={e => {\n                          this.updateGuestInfo(idx, { dob: e.detail });\n                        }}\n                        value={guest.dob}\n                      ></ir-input-text>\n                    </div>\n                    <div class=\" m-0 p-0 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_Nationality}</p>\n                      <div class=\"mx-0 flex-grow-1  h-100\">\n                        <ir-country-picker\n                          class=\"h-100\"\n                          propertyCountry={this.propertyCountry}\n                          id={`{locales.entries.Lcz_Nationality}_${idx}`}\n                          error={!!this.error['country_id'] && !guest.country_id}\n                          country={this.countries?.find(c => c.id?.toString() === guest.country?.id?.toString())}\n                          onCountryChange={e => this.updateGuestInfo(idx, { country_id: e.detail?.id?.toString() ?? null, country: e.detail })}\n                          countries={this.countries}\n                        ></ir-country-picker>\n                      </div>\n                    </div>\n                    <div class=\"flex-grow-1 m-0 p-0 d-flex align-items-center\">\n                      <p class=\"guest_label\">{locales.entries.Lcz_Documents}</p>\n                      <div class={' d-flex m-0 flex-grow-1 h-100'}>\n                        <ir-select\n                          selectForcedStyles={{\n                            borderTopRightRadius: '0px',\n                            borderBottomRightRadius: '0px',\n                            borderRight: '0',\n                          }}\n                          selectStyles={'rounded-top-0 rounded-bottom-0'}\n                          onSelectChange={e => {\n                            this.updateGuestInfo(idx, {\n                              id_info: {\n                                ...this.guests[idx].id_info,\n                                type: {\n                                  code: e.detail,\n                                  description: '',\n                                },\n                              },\n                            });\n                          }}\n                          selectedValue={guest.id_info.type.code}\n                          showFirstOption={false}\n                          data={this.idTypes?.map(t => ({ text: t[`CODE_VALUE_${this.language.toUpperCase()}`] ?? t[`CODE_VALUE_EN`], value: t.CODE_NAME }))}\n                        ></ir-select>\n                        <ir-input-text\n                          autoValidate={this.autoValidate}\n                          maxLength={18}\n                          placeholder=\"12345\"\n                          class=\"flex-grow-1 guest_document\"\n                          type=\"text\"\n                          inputForcedStyle={{ borderTopLeftRadius: '0px', borderBottomLeftRadius: '0px' }}\n                          value={guest.id_info.number}\n                          zod={ZIdInfo.pick({ number: true })}\n                          error={!!this.error['number'] && !isRowValid}\n                          wrapKey=\"number\"\n                          inputStyles=\"form-control\"\n                          onTextChange={e =>\n                            this.updateGuestInfo(idx, {\n                              id_info: {\n                                ...this.guests[idx].id_info,\n                                number: e.detail,\n                              },\n                            })\n                          }\n                        ></ir-input-text>\n                      </div>\n                    </div>\n                  </div>\n                </Fragment>\n              );\n            })}\n          </div>\n        </section>\n        <div class={'sheet-footer'}>\n          <ir-button onClick={() => this.closeModal.emit(null)} class={`flex-fill`} text={locales.entries.Lcz_Cancel} btn_color=\"secondary\"></ir-button>\n          <ir-button\n            btn_type=\"submit\"\n            class={'flex-fill'}\n            isLoading={isRequestPending('/Handle_Exposed_Room_Guests')}\n            text={this.checkIn ? locales.entries.Lcz_CheckIn : locales.entries.Lcz_Save}\n            btn_color=\"primary\"\n          ></ir-button>\n        </div>\n      </form>\n    );\n  }\n}\n","* {\n  margin: 0;\n  padding: 0;\n}\n:host {\n  display: flex;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n.label_title {\n  min-width: max-content;\n  padding: 0;\n  margin: 0;\n  font-weight: 600;\n}\n.ota-message-list {\n  margin: 0 3px;\n  padding: 0;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  /* list-style: circle !important; */\n}\n.ota-message-item {\n  width: 100%;\n  line-height: 1.5;\n  margin: 0;\n  padding: 0;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n}\n.ota-message-item::before {\n  content: '- ';\n  margin-right: 0.25rem;\n}\n\n.ota-visibility-toggle {\n  background: white;\n  color: var(--blue);\n  padding: 0;\n  margin: 0;\n  margin-left: 3px;\n  font-size: 12px;\n  border: 0;\n}\n.ota-visibility-toggle:hover {\n  color: #355270;\n}\n.ota-message-list {\n  margin: 0 3px;\n  padding: 0;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  white-space: normal;\n  list-style: none;\n}\n.ota-message-item {\n  width: 100%;\n  line-height: 1.5;\n  margin: 0 0 0 1.2em; /* indent for dash */\n  padding: 0;\n  word-wrap: break-word !important;\n  overflow-wrap: break-word !important;\n  white-space: normal;\n  position: relative;\n}\n/* .ota-message-item::before {\n  content: '-';\n  position: absolute;\n  left: 0;\n} */\n","import { Component, Host, Prop, State, h } from '@stencil/core';\nimport { v4 } from 'uuid';\nimport { IOtaNotes } from '@/models/booking.dto';\nimport locales from '@/stores/locales.store';\n@Component({\n  tag: 'ota-label',\n  styleUrl: 'ota-label.css',\n  scoped: true,\n})\nexport class OtaLabel {\n  /**\n   * Label displayed as the section title.\n   */\n  @Prop() label: string;\n\n  /**\n   * Array of OTA notes to display in the list.\n   */\n  @Prop() remarks: IOtaNotes[];\n\n  /**\n   * Maximum number of remarks to display before showing the \"Show More\" button.\n   */\n  @Prop() maxVisibleItems: number = 3;\n\n  /**\n   * Internal state that determines whether all remarks are shown or only the limited number.\n   */\n  @State() showAll: boolean = false;\n\n  /**\n   * Toggles between showing all remarks or only a limited number.\n   *\n   * Example:\n   * ```ts\n   * this.toggleShowAll(); // flips showAll state\n   * ```\n   */\n  private toggleShowAll = () => {\n    this.showAll = !this.showAll;\n  };\n\n  render() {\n    if (!this.remarks) {\n      return null;\n    }\n\n    const displayedRemarks = this.showAll ? this.remarks : this.remarks.slice(0, this.maxVisibleItems);\n\n    return (\n      <Host>\n        <p class={'label_title'}>{this.label}</p>\n        <ul class=\"ota-message-list\">\n          {displayedRemarks.map((remark, index) => (\n            <li key={v4()} class=\"ota-message-item\">\n              {remark.statement}{' '}\n              {this.remarks.length > this.maxVisibleItems && index === displayedRemarks.length - 1 && (\n                <button class=\"ota-visibility-toggle\" onClick={this.toggleShowAll}>\n                  {this.showAll ? locales.entries.Lcz_ShowLess : locales.entries.Lcz_ShowMore}\n                </button>\n              )}\n            </li>\n          ))}\n        </ul>\n        {/* Show toggle button if there are more remarks than `maxVisibleItems` */}\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}