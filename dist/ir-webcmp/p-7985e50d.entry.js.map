{"version":3,"names":["iglBlockDatesViewCss","IglBlockDatesViewStyle0","IglBlockDatesView","defaultData","fromDate","toDate","entryDate","entryHour","isEventHover","entryMinute","renderAgain","dataUpdateEvent","blockDatesData","RELEASE_AFTER_HOURS","OPTIONAL_REASON","OUT_OF_SERVICE","releaseList","bookingService","BookingService","componentWillLoad","this","getBlockedInfo","parseInt","CODE_NAME","emitData","error","handleOptionalReason","event","target","value","handleReleaseAfterChange","evt","undefined","renderPage","emit","key","data","getReleaseHoursString","dt","Date","setHours","getHours","getMinutes","toLocaleString","month","getDate","formatNumber","handleOutOfService","checked","render","h","Host","class","from_date","dateOption","showDateDifference","to_date","locales","entries","Lcz_Reason","type","id","onChange","Lcz_OutOfservice","Lcz_Or","placeholder","Lcz_OptionalReason","onInput","Lcz_AutomaticReleaseIn","map","releaseItem","selected","Number","CODE_VALUE_EN","Lcz_On"],"sources":["src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.css?tag=igl-block-dates-view&encapsulation=scoped","src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n\n:host .controlContainer {\n  width: 24px;\n}\n\n:host .checkBoxContainer input {\n  height: 1.2rem !important;\n  width: 30px;\n}\n\n.releaseTime {\n  padding-left: 5px;\n}\n.out-of-service-label {\n  margin-left: 5px !important;\n}\n","import { Component, Host, h, Prop, State, Event, EventEmitter } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { IEntries } from '@/models/IBooking';\nimport locales from '@/stores/locales.store';\n\n@Component({\n  tag: 'igl-block-dates-view',\n  styleUrl: 'igl-block-dates-view.css',\n  scoped: true,\n})\nexport class IglBlockDatesView {\n  @Prop() defaultData: { [key: string]: any };\n  @Prop() fromDate: string;\n  @Prop() toDate: string;\n  @Prop({ mutable: true }) entryDate: string;\n  @Prop() entryHour: number;\n  @Prop() isEventHover: boolean = false;\n  @Prop() entryMinute: number;\n  @State() renderAgain: boolean = false;\n\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\n\n  private blockDatesData: { [key: string]: any } = {\n    RELEASE_AFTER_HOURS: 0,\n    OPTIONAL_REASON: '',\n    OUT_OF_SERVICE: false,\n  }; // Change of property name might require updates in booking-event-hover\n  private releaseList: IEntries[] = [];\n  private bookingService: BookingService = new BookingService();\n\n  async componentWillLoad() {\n    try {\n      this.releaseList = await this.bookingService.getBlockedInfo();\n      if (this.defaultData) {\n        this.blockDatesData = { ...this.defaultData };\n      } else {\n        this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(this.releaseList[0].CODE_NAME);\n        this.emitData();\n      }\n    } catch (error) {\n      // toastr.error(error);\n    }\n  }\n\n  handleOptionalReason(event) {\n    this.blockDatesData.OPTIONAL_REASON = event.target.value;\n    this.emitData();\n  }\n\n  handleReleaseAfterChange(evt) {\n    if (this.entryDate) this.entryDate = undefined;\n    this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(evt.target.value);\n    this.renderPage();\n    this.emitData();\n  }\n\n  emitData() {\n    this.dataUpdateEvent.emit({\n      key: 'blockDatesData',\n      data: { ...this.blockDatesData },\n    });\n  }\n\n  getReleaseHoursString() {\n    // console.log(\"entry date\", this.entryDate);\n    // console.log(\"blocked date data\", this.blockDatesData);\n    let dt = this.entryDate ? new Date(this.entryDate) : new Date();\n    if (this.entryDate && this.entryHour && this.entryMinute) {\n      dt.setHours(this.entryHour, this.entryMinute, 0, 0);\n    } else {\n      dt.setHours(dt.getHours() + this.blockDatesData.RELEASE_AFTER_HOURS, dt.getMinutes(), 0, 0);\n    }\n\n    return dt.toLocaleString('default', { month: 'short' }) + ' ' + dt.getDate() + ', ' + this.formatNumber(dt.getHours()) + ':' + this.formatNumber(dt.getMinutes());\n  }\n  formatNumber(value: number) {\n    return value < 10 ? `0${value}` : value;\n  }\n  handleOutOfService(evt) {\n    this.blockDatesData.OUT_OF_SERVICE = evt.target.checked;\n    if (this.blockDatesData.OUT_OF_SERVICE) {\n      this.blockDatesData.OPTIONAL_REASON = '';\n      this.blockDatesData.RELEASE_AFTER_HOURS = 0;\n    }\n    this.renderPage();\n    this.emitData();\n  }\n\n  renderPage() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class={`m-0 p-0 mb-1`}>\n          <div class=\"text-left p-0\">\n            <ir-date-view from_date={this.fromDate} dateOption=\"YYYY-MM-DD\" showDateDifference={false} to_date={this.toDate}></ir-date-view>\n          </div>\n        </div>\n        <div class={` mb-1 text-left ${this.isEventHover && 'p-0'}`}>\n          <div class=\"mb-1 \">\n            <label class=\"p-0 text-bold-700 font-medium-1 m-0 align-middle\">{locales.entries.Lcz_Reason}:</label>\n            <div class=\"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle\">\n              <input class=\"form-control\" type=\"checkbox\" checked={this.blockDatesData.OUT_OF_SERVICE} id=\"userinput6\" onChange={event => this.handleOutOfService(event)} />\n            </div>\n            <span class=\"align-middle out-of-service-label\">{locales.entries.Lcz_OutOfservice}</span>\n          </div>\n          {!this.blockDatesData.OUT_OF_SERVICE ? (\n            <div>\n              <div class=\"mb-1 d-flex  align-items-center\">\n                <span class=\"align-middle\">{locales.entries.Lcz_Or} </span>\n                <div class=\"d-inline-flex col pr-0 align-middle\">\n                  <input\n                    class=\"form-control\"\n                    type=\"text\"\n                    placeholder={locales.entries.Lcz_OptionalReason}\n                    id=\"optReason\"\n                    value={this.blockDatesData.OPTIONAL_REASON}\n                    onInput={event => this.handleOptionalReason(event)}\n                  />\n                </div>\n              </div>\n              <div class=\"mb-1 w-100 pr-0 \">\n                <span class=\"text-bold-700 font-medium-1\">{locales.entries.Lcz_AutomaticReleaseIn}: </span>\n                <div class=\"d-inline-block\">\n                  <select class=\"form-control input-sm\" id=\"zSmallSelect\" onChange={evt => this.handleReleaseAfterChange(evt)}>\n                    {this.releaseList.map(releaseItem => (\n                      <option value={+releaseItem.CODE_NAME} selected={Number(this.blockDatesData.RELEASE_AFTER_HOURS) == Number(releaseItem.CODE_NAME)}>\n                        {releaseItem.CODE_VALUE_EN}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                {this.blockDatesData.RELEASE_AFTER_HOURS ? (\n                  <div class=\"d-inline-block releaseTime\">\n                    <em>\n                      {locales.entries.Lcz_On} {this.getReleaseHoursString()}\n                    </em>\n                  </div>\n                ) : null}\n              </div>\n            </div>\n          ) : null}\n        </div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"oSAAA,MAAMA,EAAuB,mYAC7B,MAAAC,EAAeD,E,MCSFE,EAAiB,M,0EACpBC,YACAC,SACAC,OACiBC,UACjBC,UACAC,aAAwB,MACxBC,YACCC,YAAuB,MAEvBC,gBAEDC,eAAyC,CAC/CC,oBAAqB,EACrBC,gBAAiB,GACjBC,eAAgB,OAEVC,YAA0B,GAC1BC,eAAiC,IAAIC,EAE7C,uBAAMC,GACJ,IACEC,KAAKJ,kBAAoBI,KAAKH,eAAeI,iBAC7C,GAAID,KAAKjB,YAAa,CACpBiB,KAAKR,eAAiB,IAAKQ,KAAKjB,Y,KAC3B,CACLiB,KAAKR,eAAeC,oBAAsBS,SAASF,KAAKJ,YAAY,GAAGO,WACvEH,KAAKI,U,EAEP,MAAOC,G,EAKX,oBAAAC,CAAqBC,GACnBP,KAAKR,eAAeE,gBAAkBa,EAAMC,OAAOC,MACnDT,KAAKI,U,CAGP,wBAAAM,CAAyBC,GACvB,GAAIX,KAAKd,UAAWc,KAAKd,UAAY0B,UACrCZ,KAAKR,eAAeC,oBAAsBS,SAASS,EAAIH,OAAOC,OAC9DT,KAAKa,aACLb,KAAKI,U,CAGP,QAAAA,GACEJ,KAAKT,gBAAgBuB,KAAK,CACxBC,IAAK,iBACLC,KAAM,IAAKhB,KAAKR,iB,CAIpB,qBAAAyB,GAGE,IAAIC,EAAKlB,KAAKd,UAAY,IAAIiC,KAAKnB,KAAKd,WAAa,IAAIiC,KACzD,GAAInB,KAAKd,WAAac,KAAKb,WAAaa,KAAKX,YAAa,CACxD6B,EAAGE,SAASpB,KAAKb,UAAWa,KAAKX,YAAa,EAAG,E,KAC5C,CACL6B,EAAGE,SAASF,EAAGG,WAAarB,KAAKR,eAAeC,oBAAqByB,EAAGI,aAAc,EAAG,E,CAG3F,OAAOJ,EAAGK,eAAe,UAAW,CAAEC,MAAO,UAAa,IAAMN,EAAGO,UAAY,KAAOzB,KAAK0B,aAAaR,EAAGG,YAAc,IAAMrB,KAAK0B,aAAaR,EAAGI,a,CAEtJ,YAAAI,CAAajB,GACX,OAAOA,EAAQ,GAAK,IAAIA,IAAUA,C,CAEpC,kBAAAkB,CAAmBhB,GACjBX,KAAKR,eAAeG,eAAiBgB,EAAIH,OAAOoB,QAChD,GAAI5B,KAAKR,eAAeG,eAAgB,CACtCK,KAAKR,eAAeE,gBAAkB,GACtCM,KAAKR,eAAeC,oBAAsB,C,CAE5CO,KAAKa,aACLb,KAAKI,U,CAGP,UAAAS,GACEb,KAAKV,aAAeU,KAAKV,W,CAG3B,MAAAuC,GACE,OACEC,EAACC,EAAI,CAAAhB,IAAA,4CACHe,EAAA,OAAAf,IAAA,2CAAKiB,MAAO,gBACVF,EAAA,OAAAf,IAAA,2CAAKiB,MAAM,iBACTF,EAAA,gBAAAf,IAAA,2CAAckB,UAAWjC,KAAKhB,SAAUkD,WAAW,aAAaC,mBAAoB,MAAOC,QAASpC,KAAKf,WAG7G6C,EAAA,OAAAf,IAAA,2CAAKiB,MAAO,mBAAmBhC,KAAKZ,cAAgB,SAClD0C,EAAA,OAAAf,IAAA,2CAAKiB,MAAM,SACTF,EAAA,SAAAf,IAAA,2CAAOiB,MAAM,oDAAoDK,EAAQC,QAAQC,WAAU,KAC3FT,EAAA,OAAAf,IAAA,2CAAKiB,MAAM,gFACTF,EAAA,SAAAf,IAAA,2CAAOiB,MAAM,eAAeQ,KAAK,WAAWZ,QAAS5B,KAAKR,eAAeG,eAAgB8C,GAAG,aAAaC,SAAUnC,GAASP,KAAK2B,mBAAmBpB,MAEtJuB,EAAA,QAAAf,IAAA,2CAAMiB,MAAM,qCAAqCK,EAAQC,QAAQK,oBAEjE3C,KAAKR,eAAeG,eACpBmC,EAAA,WACEA,EAAA,OAAKE,MAAM,mCACTF,EAAA,QAAME,MAAM,gBAAgBK,EAAQC,QAAQM,OAAM,KAClDd,EAAA,OAAKE,MAAM,uCACTF,EAAA,SACEE,MAAM,eACNQ,KAAK,OACLK,YAAaR,EAAQC,QAAQQ,mBAC7BL,GAAG,YACHhC,MAAOT,KAAKR,eAAeE,gBAC3BqD,QAASxC,GAASP,KAAKM,qBAAqBC,OAIlDuB,EAAA,OAAKE,MAAM,oBACTF,EAAA,QAAME,MAAM,+BAA+BK,EAAQC,QAAQU,uBAAsB,MACjFlB,EAAA,OAAKE,MAAM,kBACTF,EAAA,UAAQE,MAAM,wBAAwBS,GAAG,eAAeC,SAAU/B,GAAOX,KAAKU,yBAAyBC,IACpGX,KAAKJ,YAAYqD,KAAIC,GACpBpB,EAAA,UAAQrB,OAAQyC,EAAY/C,UAAWgD,SAAUC,OAAOpD,KAAKR,eAAeC,sBAAwB2D,OAAOF,EAAY/C,YACpH+C,EAAYG,mBAKpBrD,KAAKR,eAAeC,oBACnBqC,EAAA,OAAKE,MAAM,8BACTF,EAAA,UACGO,EAAQC,QAAQgB,OAAM,IAAGtD,KAAKiB,0BAGjC,OAGN,M","ignoreList":[]}