import{h as n}from"./p-6c4ba7c0.js";import{d as t}from"./p-8a1159a8.js";import{a as o}from"./p-bf44a732.js";import{l as e}from"./p-e19fbf2a.js";import{c as s}from"./p-70106c2f.js";import{c as a}from"./p-7482373c.js";const i={"004":"BLOCKED","003":"BLOCKED-WITH-DATES","002":"BLOCKED"};const r={"000":"IN-HOUSE","001":"PENDING-CONFIRMATION","002":"CONFIRMED","003":"CHECKED-OUT"};function _(n,t){if(n===null&&t===null)return"";if(t!==null&&t!==""){return`${n!==null&&n!==void 0?n:""} , ${t!==null&&t!==void 0?t:""}`}return n}async function u(){try{const{data:n}=await o.post(`/Get_Setup_Entries_By_TBL_NAME_Multi`,{TBL_NAMES:["_STAY_STATUS"]});return n.My_Result.map((n=>({code:n.CODE_NAME,value:n.CODE_VALUE_EN})))}catch(n){console.log(n)}}function l(t,o,s){const a=new Date(t);a.setHours(o);a.setMinutes(s);return`${e.entries.Lcz_BlockedTill} ${n(a).format("MMM DD, HH:mm")}`}function E(t){var o,e,s,i;const{in_out:_,status_code:u,from_date:l,to_date:E}=t;if(a.checkin_enabled){if((_===null||_===void 0?void 0:_.code)==="001"){return r["000"]}else if((_===null||_===void 0?void 0:_.code)==="002"){if(!a.is_automatic_check_in_out){const t=n();const s=n(E,"YYYY-MM-DD");const i=n(l,"YYYY-MM-DD");const _=O(t.toDate(),Y((o=a.checkin_checkout_hours)===null||o===void 0?void 0:o.offset,(e=a.checkin_checkout_hours)===null||e===void 0?void 0:e.hour));if(t.isSame(s,"days")&&t.isAfter(i,"days")&&_||t.isAfter(s,"days")){return r["003"]}else{return r["002"]}}}return r[u||"001"]}else{const t=n();const o=n(E,"YYYY-MM-DD");const e=n(l,"YYYY-MM-DD");const _=O(t.toDate(),Y((s=a.checkin_checkout_hours)===null||s===void 0?void 0:s.offset,(i=a.checkin_checkout_hours)===null||i===void 0?void 0:i.hour));if(e.isSame(t,"day")&&_){return r["000"]}else if(t.isAfter(e,"day")&&t.isBefore(o,"day")){return r["000"]}else if(o.isSame(t,"day")&&_){return r["000"]}else if(o.isSame(t,"day")&&_||o.isBefore(t,"day")){return r["003"]}else{return r[u||"001"]}}}function T(n){var t;if(!n){return null}return((t=n.find((n=>n.key==="private_note")))===null||t===void 0?void 0:t.value)||null}function c(o){let e=[];const a=o.rooms.filter((n=>!!n["assigned_units_pool"]));a.forEach((a=>{var i,r,u,l,c,d;const D=n(a.from_date,"YYYY-MM-DD").isAfter(n(s.fromDate,"YYYY-MM-DD"))?a.from_date:s.fromDate;const O=a.to_date;if(n(a.to_date,"YYYY-MM-DD").isBefore(n(s.fromDate,"YYYY-MM-DD"))){return}const Y=(i=a.sharing_persons)===null||i===void 0?void 0:i.find((n=>n.is_main));e.push({CHECKIN:false,CHECKOUT:false,ID:a["assigned_units_pool"],TO_DATE:O,FROM_DATE:D,PRIVATE_NOTE:T(o.extras),NO_OF_DAYS:t(D,O),ARRIVAL:o.arrival,IS_EDITABLE:true,BALANCE:(r=o.financial)===null||r===void 0?void 0:r.due_amount,STATUS:E({in_out:a.in_out,from_date:a.from_date,to_date:a.to_date,status_code:(u=o.status)===null||u===void 0?void 0:u.code}),NAME:_(Y===null||Y===void 0?void 0:Y.first_name,Y.last_name),PHONE:(l=o.guest.mobile_without_prefix)!==null&&l!==void 0?l:"",ENTRY_DATE:"12-12-2023",PHONE_PREFIX:o.guest.country_phone_prefix,RATE:a.total,RATE_PLAN:a.rateplan.name,SPLIT_BOOKING:false,RATE_PLAN_ID:a.rateplan.id,IDENTIFIER:a.identifier,RATE_TYPE:a.roomtype.id,ADULTS_COUNT:a.occupancy.adult_nbr,CHILDREN_COUNT:a.occupancy.children_nbr,PR_ID:+a.unit.id,POOL:a["assigned_units_pool"],GUEST:o.guest,ROOMS:o.rooms,BOOKING_NUMBER:o.booking_nbr,cancelation:a.rateplan.cancelation,guarantee:a.rateplan.guarantee,TOTAL_PRICE:(c=o.financial)===null||c===void 0?void 0:c.gross_total,COUNTRY:o.guest.country_id,FROM_DATE_STR:o.format.from_date,TO_DATE_STR:o.format.to_date,adult_child_offering:a.rateplan.selected_variation.adult_child_offering,ARRIVAL_TIME:o.arrival.description,origin:o.origin,channel_booking_nbr:o.channel_booking_nbr,is_direct:o.is_direct,NOTES:o.is_direct?o.remark:null,SOURCE:{code:o.source.code,description:o.source.description,tag:o.source.tag},ota_notes:o.ota_notes,defaultDates:{from_date:a.from_date,to_date:a.to_date},ROOM_INFO:{occupancy:a.occupancy,sharing_persons:a.sharing_persons,unit:a.unit,in_out:a.in_out},BASE_STATUS_CODE:(d=o.status)===null||d===void 0?void 0:d.code})}));return e}async function d(n){const t=await u();return{ID:n.POOL,NOTES:"",BALANCE:"",NAME:n.NOTES!==""?n.NOTES:n.STAY_STATUS_CODE==="003"?l(n.BLOCKED_TILL_DATE,n.BLOCKED_TILL_HOUR,n.BLOCKED_TILL_MINUTE):t.find((t=>t.code===n.STAY_STATUS_CODE)).value||"",RELEASE_AFTER_HOURS:n.DESCRIPTION,PR_ID:n.pr_id,ENTRY_DATE:n.BLOCKED_TILL_DATE,ENTRY_HOUR:n.BLOCKED_TILL_HOUR,ENTRY_MINUTE:n.BLOCKED_TILL_MINUTE,OPTIONAL_REASON:n.NOTES,FROM_DATE:n.from_date,TO_DATE:n.to_date,NO_OF_DAYS:D(n.from_date,n.to_date),STATUS:i[n.STAY_STATUS_CODE],POOL:n.POOL,STATUS_CODE:n.STAY_STATUS_CODE,OUT_OF_SERVICE:n.STAY_STATUS_CODE==="004",FROM_DATE_STR:n.format.from_date,TO_DATE_STR:n.format.to_date,defaultDates:{from_date:n.from_date,to_date:n.to_date}}}function D(t,o){const e=n(t,"YYYY-MM-DD");const s=n(o,"YYYY-MM-DD");const a=s.diff(e,"days");return a||1}function O(n,t){return n.getHours()>=t.getHours()&&n.getMinutes()>=t.getMinutes()}function Y(n,t){const o=new Date;const e=n*60*60*1e3;const s=new Date(o.getTime()+e);const a=s.getUTCFullYear();const i=s.getUTCMonth();const r=s.getUTCDate();const _=t-n;return new Date(Date.UTC(a,i,r,_))}export{E as a,d as b,D as c,r as d,O as e,_ as f,T as g,Y as h,c as t};
//# sourceMappingURL=p-6a092f71.js.map