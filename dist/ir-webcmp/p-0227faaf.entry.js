import{r as t,c as e,g as i,h as s,F as n,H as o}from"./p-acddcbeb.js";import{R as r,S as h,L as a,M as l,f as d}from"./p-ced9b97a.js";import{E as c}from"./p-7661341f.js";import{h as b}from"./p-6c4ba7c0.js";import{l as p}from"./p-e58470d9.js";import{c as m}from"./p-d6d6fb27.js";import{P as u}from"./p-56a32e4a.js";import"./p-b859bcd5.js";import"./p-bf44a732.js";import"./p-2925ded6.js";import"./p-b9d3f324.js";const f=".sc-igl-booking-event-hover-h{display:block;position:relative;z-index:100}.btn.sc-igl-booking-event-hover{padding-left:4px !important;padding-right:4px !important}.balance_amount.sc-igl-booking-event-hover{color:#ff4961;font-size:0.75rem}.user-notes.sc-igl-booking-event-hover{margin-left:4px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:5;line-clamp:5;overflow:hidden;max-width:100%;height:auto}.booking-event-hover__color-picker-trigger.sc-igl-booking-event-hover{all:unset;border:1px solid #e0e0e0;padding:0.25rem 0.25rem;border-radius:0.21rem;cursor:pointer}.events_btns.sc-igl-booking-event-hover{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem}.mx-01.sc-igl-booking-event-hover{--m:5px;margin-left:var(--m) !important;margin-right:var(--m) !important}.pointerContainerTop.sc-igl-booking-event-hover{top:-26px}.pointerContainer.sc-igl-booking-event-hover{position:absolute;height:10px;width:350px;left:var(--el-left, 50%);transform:translateX(-50%)}.ota-notes.sc-igl-booking-event-hover{width:450px}.iglPopOver.sc-igl-booking-event-hover{position:absolute;background-color:#fff;padding:10px;border:1px solid #656ee7;border-radius:6px;left:var(--el-left, 50%);transform:translateX(-50%) translateY(10px);box-shadow:1px 0px 20px rgba(0, 0, 0, 0.2)}.iglPopOver.infoBubble.sc-igl-booking-event-hover{min-width:350px}.iglPopOver.blockedView.sc-igl-booking-event-hover{max-width:400px;width:400px}.iglPopOver.newBookingOptions.sc-igl-booking-event-hover{overflow-wrap:break-word !important;min-width:230px;width:fit-content}.bubblePointer.sc-igl-booking-event-hover{position:absolute;width:0;height:0;left:50%;border-left:10px solid transparent;border-right:10px solid transparent;transform:translate(-50%, 0px)}.bubblePointTop.sc-igl-booking-event-hover{border-top:10px solid #656ee7}.bubblePointBottom.sc-igl-booking-event-hover{border-bottom:10px solid #656ee7}.bubbleInfoAbove.sc-igl-booking-event-hover{bottom:35px}.updateBtnIcon.sc-igl-booking-event-hover{margin-right:4px}.icon-image.sc-igl-booking-event-hover{height:1.5rem;width:1.5rem;margin-right:5px}";const g=f;const w=class{constructor(i){t(this,i);this.showBookingPopup=e(this,"showBookingPopup",7);this.hideBubbleInfo=e(this,"hideBubbleInfo",7);this.deleteButton=e(this,"deleteButton",7);this.bookingCreated=e(this,"bookingCreated",7);this.showDialog=e(this,"showDialog",7);this.openCalendarSidebar=e(this,"openCalendarSidebar",7)}get element(){return i(this)}bookingEvent;bubbleInfoTop=false;currency;countries;is_vacation_rental=false;isLoading;shouldHideUnassignUnit=false;canCheckInOrCheckout;bookingColor=null;showBookingPopup;hideBubbleInfo;deleteButton;bookingCreated;showDialog;openCalendarSidebar;eventService=new c;hideButtons=false;propertyService=new u;baseColor;componentWillLoad(){let t=this.bookingEvent.roomsInfo.find((t=>t.id===this.bookingEvent.RATE_TYPE));if(t){this.shouldHideUnassignUnit=t.physicalrooms.length===1}if(b(this.bookingEvent.TO_DATE,"YYYY-MM-DD").isBefore(b())){this.hideButtons=true}this.baseColor=this.getEventLegend().color;this.bookingColor=this.bookingEvent.ROOM_INFO?.calendar_extra?this.bookingEvent.ROOM_INFO?.calendar_extra?.booking_color:null;this.canCheckInOrCheckout=b().isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&b().isBefore(new Date(this.bookingEvent.TO_DATE),"days")}handleBookingEventChange(t,e){if(t!==e)this.canCheckInOrCheckout=b(new Date).isSameOrAfter(new Date(this.bookingEvent.FROM_DATE),"days")&&b(new Date).isBefore(new Date(this.bookingEvent.TO_DATE),"days")}handleListenKeyDown(t){if(t.key==="Escape"){t.stopPropagation();this.hideBubble()}else return}getEventLegend(){let t=this.bookingEvent?.legendData.statusId[this.bookingEvent.STATUS];return{...this.bookingEvent?.legendData[t.id],...t}}getBookingId(){return this.bookingEvent.ID}hideBubble(){this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}getTotalOccupants(){const{CHILDREN_COUNT:t,ADULTS_COUNT:e}=this.bookingEvent;if(t===0){return`${e} ${e>1?p.entries.Lcz_AdultsCaption.toLowerCase():p.entries.Lcz_Single_Adult?.toLowerCase()}`}return`${e} ${e>1?p.entries.Lcz_AdultsCaption.toLowerCase():p.entries.Lcz_Single_Adult?.toLowerCase()}, ${t} ${t>1?p.entries.Lcz_ChildCaption.toLowerCase():p.entries.Lcz_Single_Child?.toLowerCase()}`}getPhoneNumber(){return this.bookingEvent.PHONE}getCountry(){return r(this.bookingEvent.COUNTRY,this.countries).name}getPhoneCode(){if(this.bookingEvent.PHONE_PREFIX){return this.bookingEvent.PHONE_PREFIX}return r(this.bookingEvent.COUNTRY,this.countries).phone_prefix}renderPhone(){return this.bookingEvent.COUNTRY?`${this.bookingEvent.is_direct?this.getPhoneCode()+"-":""}${this.getPhoneNumber()} - ${this.getCountry()}`:this.getPhoneNumber()}getInternalNote(){return this.bookingEvent.INTERNAL_NOTE}getTotalPrice(){return this.bookingEvent.TOTAL_PRICE}getArrivalTime(){return this.bookingEvent.ARRIVAL_TIME}getRatePlan(){if(!this.bookingEvent){return}const t=this.bookingEvent?.booking?.rooms?.find((t=>t.assigned_units_pool===this.bookingEvent.ID));if(!t){console.warn(`Couldn't find room with pool ${this.bookingEvent.ID}`);return null}let e="";e+=t.rateplan["short_name"];if(t.rateplan["is_non_refundable"]){e+=` - ${p.entries.Lcz_NonRefundable}`}return e}getEntryDate(){return this.bookingEvent.ENTRY_DATE}isNewBooking(){return this.getBookingId()==="NEW_TEMP_EVENT"}isCheckedIn(){return this.bookingEvent.STATUS==="IN-HOUSE"}isBlockedDateEvent(){return this.bookingEvent.STATUS==="BLOCKED"||this.bookingEvent.STATUS==="BLOCKED-WITH-DATES"}hasSplitBooking(){return this.bookingEvent.hasOwnProperty("splitBookingEvents")&&this.bookingEvent.splitBookingEvents}canCheckIn(){return h({from_date:this.bookingEvent.FROM_DATE,to_date:this.bookingEvent.TO_DATE,isCheckedIn:this.isCheckedIn()})}canCheckOut(){if(!m.checkin_enabled||m.is_automatic_check_in_out){return false}if(this.isCheckedIn()){return true}const t=b();if(this.bookingEvent.ROOM_INFO?.in_out?.code==="000"&&b().isSameOrAfter(new Date(this.bookingEvent.TO_DATE),"days")&&a(t.toDate(),l(m.checkin_checkout_hours?.offset,m.checkin_checkout_hours?.hour))){return true}return false}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const e=t.detail;this.bookingEvent={...this.bookingEvent,...e.data}}handleEditBooking(){this.bookingEvent.TITLE=p.entries.Lcz_EditBookingFor;this.handleBookingOption("EDIT_BOOKING")}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}handleAddRoom(){let t=new Date(this.bookingEvent.FROM_DATE);t.setHours(0,0,0,0);let e=this.getStringDateFormat(t);let i=new Date(this.bookingEvent.TO_DATE);i.setHours(0,0,0,0);let s=this.getStringDateFormat(i);let n={ID:"",NAME:"",BOOKING_NUMBER:this.bookingEvent.BOOKING_NUMBER,FROM_DATE:e,TO_DATE:s,roomsInfo:this.bookingEvent.roomsInfo,ARRIVAL:this.bookingEvent.ARRIVAL,ADD_ROOM_TO_BOOKING:this.bookingEvent.ID,TITLE:"Add Room to #"+this.bookingEvent.BOOKING_NUMBER,event_type:"ADD_ROOM",ROOMS:this.bookingEvent.ROOMS,GUEST:this.bookingEvent.GUEST,message:this.bookingEvent.NOTES,SOURCE:this.bookingEvent.SOURCE,booking:this.bookingEvent?.base_booking,defaultDateRange:{fromDate:t,fromDateStr:"",toDate:i,toDateStr:"",dateDifference:0,editabled:true,message:"Including 5.00% City Tax - Excluding 11.00% VAT"}};this.handleBookingOption("ADD_ROOM",n)}handleCustomerCheckIn(){const{adult_nbr:t,children_nbr:e,infant_nbr:i}=this.bookingEvent.ROOM_INFO.occupancy;this.showDialog.emit({reason:"checkin",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:"",sidebarPayload:{identifier:this.bookingEvent.IDENTIFIER,bookingNumber:this.bookingEvent.BOOKING_NUMBER,checkin:false,roomName:this.bookingEvent.ROOM_INFO.unit?.name??"",sharing_persons:this.bookingEvent.ROOM_INFO.sharing_persons,totalGuests:t+e+i}})}handleCustomerCheckOut(){this.showDialog.emit({reason:"checkout",bookingNumber:this.bookingEvent.BOOKING_NUMBER,roomIdentifier:this.bookingEvent.IDENTIFIER,roomName:"",roomUnit:""})}handleDeleteEvent(){this.hideBubble();this.deleteButton.emit(this.bookingEvent.POOL);console.log("Delete Event")}async handleUpdateBlockedDates(){try{this.isLoading="update";setTimeout((()=>{this.hideBubble()}),50);await this.eventService.updateBlockedEvent(this.bookingEvent);this.isLoading=""}catch(t){}}handleConvertBlockedDateToBooking(){this.handleBookingOption("BAR_BOOKING")}getRoomInfo(){const t=+this.bookingEvent.PR_ID;let e={};for(const i of this.bookingEvent.roomsInfo){for(const s of i.physicalrooms){if(t===s.id){e.CATEGORY=i.name;e.ROOM_NAME=s.name;e.ROOMS_INFO=i;return e}}}return e}renderTitle(t,e){switch(t){case"EDIT_BOOKING":return`${p.entries.Lcz_EditBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`;case"ADD_ROOM":return`${p.entries.Lcz_AddingUnitToBooking}# ${this.bookingEvent.BOOKING_NUMBER}`;case"SPLIT_BOOKING":return p.entries.Lcz_Adding+` ${e.CATEGORY} ${e.ROOM_NAME}`;default:return`${p.entries.Lcz_NewBookingFor} ${e.CATEGORY} ${e.ROOM_NAME}`}}handleBookingOption(t,e=null){const i=this.getRoomInfo();let s=e?e:this.bookingEvent;s.event_type=t;s.TITLE=this.renderTitle(t,i);if(["003","002","004"].includes(this.bookingEvent.STATUS_CODE)){s.roomsInfo=[i.ROOMS_INFO]}if(t==="BAR_BOOKING"&&this.bookingEvent.STATUS!=="TEMP-EVENT"){const{FROM_DATE:t,TO_DATE:e,PR_ID:i,RELEASE_AFTER_HOURS:n,ENTRY_DATE:o,OPTIONAL_REASON:r,ENTRY_MINUTE:h,ENTRY_HOUR:a,STATUS_CODE:l}=this.bookingEvent;s.block_exposed_unit_props={from_date:t,to_date:e,NOTES:r,pr_id:i,STAY_STATUS_CODE:l,DESCRIPTION:n,BLOCKED_TILL_DATE:o,BLOCKED_TILL_HOUR:a,BLOCKED_TILL_MINUTE:h};this.handleDeleteEvent()}this.showBookingPopup.emit({key:"add",data:{...s}});this.hideBubbleInfo.emit({key:"hidebubble",currentInfoBubbleId:this.getBookingId()})}getOTANotes(t=3){if(!this.bookingEvent.ota_notes||this.bookingEvent.ota_notes?.length===0){return null}const e=[...this.bookingEvent.ota_notes];const i="<br>- ";if(e.length>t){e[t-1]={statement:`${e[t-1].statement} <span style="color: #1e9ff2;">more...</span>`}}return e.slice(0,t).map((t=>`${i}${t.statement}`)).join("")}canSplitBooking(){const t=this.bookingEvent?.defaultDates?.from_date;const e=this.bookingEvent?.defaultDates?.to_date;const i=b(t,"YYYY-MM-DD",true).startOf("day");const s=b(e,"YYYY-MM-DD",true).startOf("day");if(!i.isValid()||!s.isValid())return false;const n=s.diff(i,"days");if(n<2)return false;const o=b().startOf("day");if(s.diff(o,"days")<1)return false;return true}getInfoElement(){return s("div",{class:`iglPopOver infoBubble ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},s("div",{class:`d-flex p-0 m-0  ${this.bookingEvent.BALANCE>1?"pb-0":"pb-1"}`},s("div",{class:"px-0  font-weight-bold font-medium-1 d-flex align-items-center",style:{flex:"1 1 0%"}},s("img",{src:this.bookingEvent?.origin?.Icon,alt:this.bookingEvent?.origin?.Label,class:"icon-image"}),s("p",{class:"p-0 m-0"},!this.bookingEvent.is_direct?this.bookingEvent.channel_booking_nbr:this.bookingEvent.BOOKING_NUMBER)),s("div",{class:"pr-0  text-right d-flex align-items-center",style:{gap:"0.5rem"}},s("ir-dropdown",{caret:false,onOptionChange:async t=>{const e=t.detail==="none"?null:m.property.calendar_extra?.booking_colors.find((e=>e.color===t.detail));await this.propertyService.setRoomCalendarExtra({property_id:m.property.id,room_identifier:this.bookingEvent.IDENTIFIER,value:JSON.stringify({booking_color:e})});this.bookingColor=e},style:{"--ir-dropdown-menu-min-width":"fit-content",width:"1.5rem"}},s("button",{class:"booking-event-hover__color-picker-trigger",slot:"trigger"},this.bookingColor?s("div",{style:{height:"1rem",width:"1rem",background:this.bookingColor?.color,borderRadius:"0.21rem"}}):s("ir-icons",{class:"p-0 m-0 d-flex align-items-center",style:{"--icon-size":"1rem",height:"1rem",width:"1rem",background:this.baseColor,color:"white",borderRadius:"0.21rem",padding:"0.25rem"},name:"ban"})),s("ir-dropdown-item",{value:"none"},s("ir-icons",{class:"p-0 m-0 d-flex align-items-center",style:{"--icon-size":"1rem",height:"1rem",width:"1rem"},name:"ban"})),m.property.calendar_extra?.booking_colors.map((t=>s("ir-dropdown-item",{value:t.color},s("div",{style:{height:"1rem",width:"1rem",borderRadius:"0.21rem",background:t.color}}))))),d(this.currency.symbol,this.getTotalPrice()))),this.bookingEvent.BALANCE>1&&s("p",{class:"pr-0 m-0 p-0 text-right balance_amount"},p.entries.Lcz_Balance,": ",d(this.currency.symbol,this.bookingEvent.BALANCE)),s("div",{class:"row p-0 m-0"},s("div",{class:"px-0 pr-0 col-12"},s("ir-date-view",{from_date:this.bookingEvent.defaultDates.from_date,to_date:this.bookingEvent.defaultDates.to_date,showDateDifference:false}))),this.bookingEvent.NAME&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`Guest name:`,content:this.bookingEvent.NAME}),this.getArrivalTime()&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_ArrivalTime}:`,content:this.getArrivalTime()}),this.getTotalOccupants()&&s("ir-label",{class:"m-0 p-0",containerStyle:{padding:"0",margin:"0"},labelText:`${p.entries.Lcz_Occupancy}:`,content:this.getTotalOccupants()}),this.getPhoneNumber()&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_Phone}:`,content:this.renderPhone()}),this.getRatePlan()&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_RatePlan}:`,content:this.getRatePlan()}),this.bookingEvent.DEPARTURE_TIME?.code!=="000"&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`Departure time:`,content:this.bookingEvent.DEPARTURE_TIME?.description}),this.bookingEvent.PRIVATE_NOTE&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},class:"m-0 p-0",labelText:`${p.entries.Lcz_BookingPrivateNote}:`,display:"inline",content:this.bookingEvent.PRIVATE_NOTE}),this.bookingEvent.is_direct&&s("ir-label",{containerStyle:{padding:"0",margin:"0"},labelText:`${p.entries.Lcz_GuestRemark}:`,display:"inline",content:this.bookingEvent.NOTES}),s("ir-label",{containerStyle:{padding:"0",margin:"0"},labelText:`${p.entries.Lcz_ChannelNotes}:`,display:"inline",content:this.getOTANotes(),renderContentAsHtml:true}),this.getInternalNote()&&s("ir-label",{labelText:`${p.entries.Lcz_InternalRemark}:`,content:this.getInternalNote()}),s("div",{class:"row p-0 m-0 mt-2"},s("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},s("ir-button",{style:{"--icon-size":"0.875rem"},onClickHandler:()=>this.handleEditBooking(),class:"w-100",btn_block:true,text:p.entries.Lcz_Edit,btn_styles:"h-100",size:"sm"}),this.bookingEvent.is_direct&&this.bookingEvent.IS_EDITABLE&&!this.hideButtons&&s("ir-button",{style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_AddRoom,size:"sm",class:"w-100",btn_styles:"h-100",onClickHandler:()=>this.handleAddRoom()}),this.canSplitBooking()&&s("ir-button",{class:"w-100",style:{"--icon-size":"0.875rem"},text:"Split",onClickHandler:()=>this.handleSplitBooking(),btn_styles:"h-100",size:"sm"}),this.canCheckIn()&&s("ir-button",{class:"w-100",style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_CheckIn,onClickHandler:()=>this.handleCustomerCheckIn(),btn_styles:"h-100",size:"sm"}),this.canCheckOut()&&s("ir-button",{class:"w-100",btn_styles:"h-100",style:{"--icon-size":"0.875rem"},text:p.entries.Lcz_CheckOut,onClickHandler:()=>this.handleCustomerCheckOut(),size:"sm"}),this.hideButtons?null:!this.shouldHideUnassignUnit&&s("ir-button",{class:"w-100",btn_styles:"h-100",style:{"--icon-size":"0.875rem"},size:"sm",text:p.entries.Lcz_Unassign,onClickHandler:t=>{this.handleDeleteEvent()}}))))}handleSplitBooking(){this.hideBubble();this.openCalendarSidebar.emit({type:"split",payload:{booking:this.bookingEvent.base_booking,identifier:this.bookingEvent.IDENTIFIER}})}getNewBookingOptions(){const t=this.bookingEvent.roomsInfo[0].rateplans.some((t=>t.is_active));return s("div",{class:`iglPopOver d-flex flex-column newBookingOptions ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`,style:{gap:"0.5rem"}},t?s(n,null,s("ir-button",{size:"sm",btn_block:true,"data-testid":"bar_booking_btn",text:p.entries.Lcz_CreateNewBooking,onClickHandler:t=>{this.handleBookingOption("BAR_BOOKING")}}),this.hasSplitBooking()&&s("ir-button",{size:"sm",btn_block:true,text:p.entries.Lcz_AssignUnitToExistingBooking,onClickHandler:t=>{this.handleBookingOption("SPLIT_BOOKING")}})):s("p",{class:"text-danger"},p.entries.Lcz_NoRatePlanDefined),s("ir-button",{size:"sm",text:p.entries.Lcz_Blockdates,btn_block:true,onClickHandler:t=>{this.handleBookingOption("BLOCK_DATES")}}))}getBlockedView(){console.log("booking event",this.bookingEvent);return s("div",{class:`iglPopOver blockedView ${this.bubbleInfoTop?"bubbleInfoAbove":""} text-left`},s("igl-block-dates-view",{isEventHover:true,entryHour:this.bookingEvent.ENTRY_HOUR,entryMinute:this.bookingEvent.ENTRY_MINUTE,defaultData:this.bookingEvent,fromDate:this.bookingEvent.defaultDates.from_date,toDate:this.bookingEvent.defaultDates.to_date,entryDate:this.getEntryDate(),onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),s("div",{class:"row p-0 m-0 mt-2"},s("div",{class:"full-width d-flex align-items-center",style:{gap:"0.25rem"},role:"group"},s("ir-button",{btn_disabled:this.isLoading==="update",text:p.entries.Lcz_Update,onClickHandler:t=>{this.handleUpdateBlockedDates()},icon_name:"edit",size:"sm",btn_styles:"h-100",isLoading:this.isLoading==="update",style:{"--icon-size":"0.875rem"},btn_block:true,class:"w-100"}),s("ir-button",{class:"w-100 h-100 my-0",btn_block:true,btn_styles:"h-100",size:"sm",text:p.entries.Lcz_ConvertSplitBooking,onClickHandler:()=>{this.handleConvertBlockedDateToBooking()}}),s("ir-button",{class:"w-100",btn_styles:"h-100",btn_block:true,size:"sm",style:{"--icon-size":"0.875rem"},icon_name:"trash",btn_color:"danger",onClickHandler:t=>{this.handleDeleteEvent()},text:p.entries.Lcz_Delete}))))}render(){return s(o,{key:"aa8e71693165f7bffa060bc4317906f29b5f9f07"},s("div",{key:"e36f5d4d1cdddb7dcc1cbe979594a0625cd2d682",class:`pointerContainer ${this.bubbleInfoTop?"pointerContainerTop":""}`},s("div",{key:"0943e8941f87a48ea4e423ff01e2813f6d2c98fd",class:`bubblePointer ${this.bubbleInfoTop?"bubblePointTop":"bubblePointBottom"}`})),this.isBlockedDateEvent()?this.getBlockedView():null,this.isNewBooking()?this.getNewBookingOptions():null,!this.isBlockedDateEvent()&&!this.isNewBooking()?this.getInfoElement():null)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};w.style=g;const k=".dropdown-menu.sc-ir-dropdown{z-index:1000;width:100%;max-height:300px;min-width:var(--ir-dropdown-menu-min-width, 11rem) !important;overflow-y:auto}.dropdown.nav-item.show.sc-ir-dropdown .dropdown-menu.sc-ir-dropdown{display:block}.caret-icon.sc-ir-dropdown{position:absolute;top:50%;transform:translateY(-55%);right:0.25rem;z-index:99999}.dropdown-trigger.sc-ir-dropdown{position:relative}.caret-icon.disabled.sc-ir-dropdown{opacity:0.5 !important;pointer-events:none !important;cursor:not-allowed !important}";const v=k;const y=class{constructor(i){t(this,i);this.optionChange=e(this,"optionChange",7)}get el(){return i(this)}value;disabled=false;caret=true;isOpen=false;selectedOption;focusedIndex=-1;itemChildren=[];mo=null;documentClickHandler;isComponentConnected=true;updateQueued=false;optionChange;componentWillLoad(){this.selectedOption=this.value;this.documentClickHandler=this.handleDocumentClick.bind(this);this.collectItemChildren();this.mo=new MutationObserver((()=>{if(!this.updateQueued){this.updateQueued=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.collectItemChildren();this.updateQueued=false}}))}}));this.mo.observe(this.el,{childList:true,subtree:true})}componentDidLoad(){document.addEventListener("click",this.documentClickHandler,{passive:true});requestAnimationFrame((()=>{if(this.isComponentConnected){this.updateItemElements();if(this.value){this.updateDropdownItemValue(this.value)}}}))}disconnectedCallback(){this.isComponentConnected=false;document.removeEventListener("click",this.documentClickHandler);this.mo?.disconnect();this.mo=null}handleDocumentKeyDown(t){if(!this.isOpen||!this.isComponentConnected)return;if(t.key==="Escape"){this.closeDropdown()}}handleDropdownItemSelect(t){if(!this.isComponentConnected)return;t.stopPropagation();this.selectOption(t.detail);t.target.setAttribute("aria-selected","true")}handleDropdownItemRegister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleDropdownItemUnregister(){if(!this.isComponentConnected)return;this.collectItemChildren()}handleValueChange(t,e){if(t!==e&&this.isComponentConnected){this.updateDropdownItemValue(t)}}updateDropdownItemValue(t){this.itemChildren.forEach((t=>t.removeAttribute("aria-selected")));const e=this.itemChildren.find((e=>e.value===t));if(e){e.setAttribute("aria-selected","true")}}getSelectedItemIndex(){if(!this.value)return-1;return this.itemChildren.findIndex((t=>t.value===this.value))}openDropdown(){try{this.isOpen=true;this.focusedIndex=this.getSelectedItemIndex();this.updateItemElements();if(this.focusedIndex>=0){requestAnimationFrame((()=>{this.scrollToSelectedItem()}))}}catch(t){console.log(t)}}closeDropdown(){this.isOpen=false;this.focusedIndex=-1;this.removeItemFocus()}handleDocumentClick=t=>{if(!this.isComponentConnected||!this.el.contains(t.target)){this.closeDropdown()}};collectItemChildren(){if(!this.isComponentConnected)return;const t=Array.from(this.el.querySelectorAll("ir-dropdown-item"));this.itemChildren=t;this.updateItemElements()}updateItemElements(){if(!this.isComponentConnected)return;this.itemChildren.forEach(((t,e)=>{t.setAttribute("data-slot-index",String(e));t.setAttribute("role","option");t.setAttribute("tabindex","-1")}))}removeItemFocus(){this.itemChildren.forEach((t=>{t.classList.remove("focused","active")}))}focusItemElement(t){this.removeItemFocus();if(t>=0&&t<this.itemChildren.length){const e=this.itemChildren[t];e.classList.add("focused");e.scrollIntoView({block:"nearest",behavior:"smooth"})}}selectItemElement(t){if(t>=0&&t<this.itemChildren.length){const e=this.itemChildren[t];e.click()}}scrollToSelectedItem(){if(this.focusedIndex>=0&&this.focusedIndex<this.itemChildren.length){const t=this.itemChildren[this.focusedIndex];if(t){t.scrollIntoView({block:"nearest",behavior:"smooth",inline:"nearest"})}}}handleKeyDown=t=>{if(!this.isComponentConnected||this.disabled)return;const e=this.itemChildren.length-1;switch(t.key){case"ArrowDown":t.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>=0&&this.focusedIndex<e){this.focusedIndex++;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===e){this.focusedIndex=0;this.focusItemElement(this.focusedIndex)}}else if(e>=0){this.focusedIndex=this.focusedIndex<e?this.focusedIndex+1:0;this.focusItemElement(this.focusedIndex)}break;case"ArrowUp":t.preventDefault();if(!this.isOpen){this.openDropdown();if(this.focusedIndex>0){this.focusedIndex--;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===-1){this.focusedIndex=e;this.focusItemElement(this.focusedIndex)}else if(this.focusedIndex===0){this.focusedIndex=e;this.focusItemElement(this.focusedIndex)}}else if(e>=0){this.focusedIndex=this.focusedIndex>0?this.focusedIndex-1:e;this.focusItemElement(this.focusedIndex)}break;case"Enter":t.preventDefault();if(this.isOpen&&this.focusedIndex>=0){this.selectItemElement(this.focusedIndex)}else if(!this.isOpen){this.openDropdown()}break;case"Escape":t.preventDefault();this.closeDropdown();break;case"Tab":if(this.isOpen){this.closeDropdown()}break}};selectOption(t){this.selectedOption=t;this.value=t;this.optionChange.emit(t);this.closeDropdown()}render(){return s(o,{key:"14602977184a3f18dd9f4904facd99ecf273667f",class:`dropdown ${this.isOpen?"show":""}`},s("div",{key:"10828f2208c005ef2a2cae22483e6f59ed7d64b9",onClick:()=>{if(this.disabled)return;if(this.isOpen){this.closeDropdown()}else{this.openDropdown()}},"aria-disabled":String(this.disabled),class:`dropdown-trigger ${this.disabled?"disabled":""}`,onKeyDown:this.handleKeyDown,tabindex:"0"},s("slot",{key:"6b543955e0a6170eb9455eeace73e77b9ecfcd34",name:"trigger"}),this.caret&&s("div",{key:"dd521a53a71cf0977285fb594d67b30d69b954be",class:`caret-icon ${this.disabled?"disabled":""}`},s("ir-icons",{key:"9c93fc58a95e3c931b9f0c2708c71ad920d62191",name:!this.isOpen?"angle-down":"angle-up"}))),s("div",{key:"971cc6696fe1942876aec0eeb3653abadb9e20c2",class:"dropdown-menu",role:"listbox","aria-expanded":this.isOpen.toString()},s("slot",{key:"425b696c4f33d88b3228938f259eabd7b8554038"})))}static get watchers(){return{value:["handleValueChange"]}}};y.style=v;const x=".sc-ir-dropdown-item-h{display:block;cursor:pointer}[hidden].sc-ir-dropdown-item-h{display:none !important}.focused.sc-ir-dropdown-item-h{background:#f4f5fa !important}.active.sc-ir-dropdown-item-h,[aria-selected='true'].sc-ir-dropdown-item-h,.sc-ir-dropdown-item-h:active{outline:none;background-color:var(--blue, #1e9ff2) !important;color:white !important}.dropdown-item.sc-ir-dropdown-item-h{padding:0.25rem 1rem !important;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}";const _=x;const D=class{constructor(i){t(this,i);this.dropdownItemSelect=e(this,"dropdownItemSelect",7);this.dropdownItemRegister=e(this,"dropdownItemRegister",7);this.dropdownItemUnregister=e(this,"dropdownItemUnregister",7)}get el(){return i(this)}isComponentConnected=true;hasRegistered=false;value;label;html_content;hidden=false;dropdownItemSelect;dropdownItemRegister;dropdownItemUnregister;componentDidLoad(){if(this.isComponentConnected&&!this.hasRegistered){this.hasRegistered=true;requestAnimationFrame((()=>{if(this.isComponentConnected){this.dropdownItemRegister.emit()}}))}}disconnectedCallback(){this.isComponentConnected=false;if(this.hasRegistered&&this.el.parentElement){const t=this.el.closest("ir-dropdown");if(t&&document.contains(t)){this.dropdownItemUnregister.emit()}}this.hasRegistered=false}async matchesQuery(t){if(!this.isComponentConnected)return false;const e=t.toLowerCase();const i=(this.label??this.el.textContent??"").toLowerCase();return i.includes(e)}async setHidden(t){if(this.isComponentConnected){this.hidden=t}}handleClick=t=>{t.stopPropagation();if(!this.isComponentConnected)return;this.dropdownItemSelect.emit(this.value)};render(){return s(o,{key:"72810e0e014df086918dbb229b811f18c717b7d3",role:"option",tabindex:"-1","aria-selected":"false",class:{"dropdown-item":true,hidden:this.hidden},onClick:this.handleClick,"data-value":this.value},this.html_content?s("span",{innerHTML:this.html_content}):s("slot",null))}};D.style=_;export{w as igl_booking_event_hover,y as ir_dropdown,D as ir_dropdown_item};
//# sourceMappingURL=p-0227faaf.entry.js.map