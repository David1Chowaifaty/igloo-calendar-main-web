{"version":3,"names":["IglBookPropertyService","hasUnderscore","str","test","variationService","setBookingInfoFromAutoComplete","context","res","bookedByInfoData","id","guest","email","firstName","first_name","lastName","last_name","countryId","country_id","isdCode","country_phone_prefix","toString","contactNumber","mobile","selectedArrivalTime","arrival","emailGuest","subscribe_to_news_letter","message","remark","cardNumber","cardHolderName","expiryMonth","expiryYear","bookingNumber","booking_nbr","rooms","from_date","to_date","resetRoomsInfoAndMessage","defaultData","roomsInfo","onDataRoomUpdate","event","selectedUnits","isEdit","isEditBooking","name","units","data","key","changedKey","detail","roomCategoryKey","roomCategoryId","ratePlanKey","ratePlanId","this","shouldClearData","Map","initializeRoomCategoryIfNeeded","has","get","applyBookingEditToSelectedRoom","setSelectedRoomData","cleanupEmptyData","set","selectedRatePlans","totalRooms","inventory","delete","Array","fill","size","clear","guestName","roomId","calculateAmount","is_amount_modified","selected_variation","view_mode","rp_amount","total_days","nights","length","generateDailyRates","rate_plan","i","variation","amount","infant_nbr","VariationService","getVariationBasedOnInfants","variations","ratePlan","baseVariation","infants","map","n","date","night","discounted_amount","cost","getBookedRooms","check_in","check_out","notes","identifier","override_unit","unit","auto_check_in","roomTypeId","booking_store","ratePlanSelections","roomtype","rateplanId","rateplan","reserved","push","prepayment_amount_gross","occupancy","adult_nbr","children_nbr","Number","child_nbr","Math","max","bed_preference","moment","format","days","city","address","dob","cci","prepareBookUserServiceParams","dateRangeData","Error","fromDate","Date","toDate","generateNewRooms","isEventType","bookingData","PR_ID","modifyBookingDetails","pickup_info","extra_services","is_direct","is_in_loyalty_mode","promo_key","extras","rest","assign_units","is_pms","is_backend","booking","newBooking","sourceOption","bookingDraft","source","console","log","event_type","currentRoomType","filteredRooms","filter","r","newRooms","in_out","code","previousRooms","isAgent","type","e","value","selectedPaymentMethod","agent","tag","property","propertyid","booked_on","hour","getHours","minute","getMinutes","currency","nbr","holder_name","expiry_month","expiry_year","error","getRoomCategoryByRoomId","find","roomCategory","RATE_TYPE","setEditingRoomInfo","category","room_id","RATE_PLAN_ID","adultCount","ADULTS_COUNT","rate","RATE","rateType","roomCategoryName","ratePlanName","RATE_PLAN","NAME","cancelation","guarantee","adult_child_offering","iglBookPropertyCss","IglBookPropertyStyle0","sheetCss","IglBookPropertyStyle1","IglBookProperty","allowedBookingSources","language","countries","showPaymentDetails","adultChildConstraints","renderAgain","isLoading","bookingHistory","closeBookingWindow","blockedCreated","resetBookingEvt","animateIrButton","animateIrSelect","toast","initialRoomIds","page","showSplitBookingOption","guestData","blockDatesData","ratePricingMode","bedPreferenceType","bookingService","BookingService","bookPropertyService","defaultDateRange","updatedBooking","MAX_HISTORY_LENGTH","didReservation","wasBlockedUnit","componentWillLoad","roomTypes","modifyBookingStore","handleKeyDown","bind","initializeDefaultDateRange","initializeDefaultData","hasOwnProperty","fetchSetupEntriesAndInitialize","componentDidLoad","document","addEventListener","handleBodyOverflow","disconnectedCallback","removeEventListener","clearBooking","stopImmediatePropagation","stopPropagation","renderPage","handleSpiltBookingSelected","getExposedBooking","selects","sources","opt","setBookingDraft","onDateRangeSelect","resetBookingStore","updateBookingHistory","dates","checkIn","checkOut","gotoSplitPageTwo","gotoPage","handleButtonClicked","bookUser","closeWindow","resetReserved","adults","emit","calculateTotalRooms","description","locales","entries","Lcz_SelectRatePlan","title","checkBookingAvailability","partialData","lastEntry","newEntry","children","shift","FROM_DATE","TO_DATE","setupEntries","fetchSetupEntries","setSourceOptions","setOtherProperties","initializeEventData","initializeEditBookingData","initializePage","CHILDREN_COUNT","roomName","GUEST","isGuestDataIncomplete","roomtypeId","RoomGuestSchema","parse","requires_bed_preference","is_bed_configuration_enabled","bookingSource","_sourceOptions","getFilteredSourceOptions","setBookingSelectOptions","option","SOURCE","o","sourceOptions","agentIds","Set","hasAgentOnlyRoomType","some","rt","rps","rateplans","isForAgentOnly","every","rp","agents","forEach","ag","add","candidate","matchesId","arrivalTime","is_in_agent_mode","room_type_ids_to_update","room_type_ids","room","getBookingAvailability","adultChildCount","adult","child","agent_id","updateBooking","roomtype_id","reserveRooms","checkAndBlockDate","block_exposed_unit_props","isAvailable","is_available_to_book","handleBlockDate","warn","el","querySelector","classList","setTimeout","handleBlockDateUpdate","handleGuestInfoUpdate","guestRefKey","handleBookedByInfoUpdate","getPageBlockDatesView","h","Fragment","entryDate","ENTRY_DATE","onDataUpdateEvent","handlePageTwoDataUpdateEvent","auto_close","props","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","dateToFormattedString","NOTES","OPTIONAL_REASON","pr_id","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","blockUnit","setLoadingState","BookingGuestSchema","isEditOrAdd","serviceParams","doReservation","adjustBlockedDatesAfterReservation","resetLoadingState","original_from_date","current_from_date","original_to_date","current_to_date","isBefore","isAfter","getCurrentPage","render","Host","class","onClick","isRequestPending","BLOCK_DATES_TITLE","TITLE","appearance","variant","onClickHandler","library","label","defaultDaterange","eventType","selectedRooms","propertyId","selectedGuestData","defaultGuestData","isEditOrAddRoomEvent","text","Lcz_Cancel","btn_color","Lcz_Blockdates"],"sources":["src/components/igloo-calendar/igl-book-property/igl-book-property.service.ts","src/components/igloo-calendar/igl-book-property/igl-book-property.css?tag=igl-book-property&encapsulation=scoped","src/common/sheet.css?tag=igl-book-property&encapsulation=scoped","src/components/igloo-calendar/igl-book-property/igl-book-property.tsx"],"sourcesContent":["import { Booking, Room } from '@/models/booking.dto';\nimport VariationService from '@/services/variation.service';\nimport booking_store, { IRatePlanSelection } from '@/stores/booking.store';\nimport { extras } from '@/utils/utils';\nimport moment from 'moment';\n\nexport class IglBookPropertyService {\n  private hasUnderscore(str: string): boolean {\n    return /_+/.test(str);\n  }\n  private variationService: VariationService;\n  public setBookingInfoFromAutoComplete(context, res) {\n    context.bookedByInfoData = {\n      id: res.guest.id,\n      email: res.guest.email,\n      firstName: res.guest.first_name,\n      lastName: res.guest.last_name,\n      countryId: res.guest.country_id,\n      isdCode: res.guest?.country_phone_prefix ?? res.guest?.country_id.toString(),\n      contactNumber: res.guest.mobile,\n      selectedArrivalTime: res.arrival,\n      emailGuest: res.guest.subscribe_to_news_letter,\n      message: res.remark,\n      cardNumber: '',\n      cardHolderName: '',\n      expiryMonth: '',\n      expiryYear: '',\n      bookingNumber: res.booking_nbr,\n      rooms: res.rooms,\n      from_date: res.from_date,\n      to_date: res.to_date,\n    };\n  }\n\n  public resetRoomsInfoAndMessage(context) {\n    context.defaultData.roomsInfo = [];\n    context.message = '';\n  }\n\n  public onDataRoomUpdate(event: CustomEvent, selectedUnits: Map<string, Map<string, any>>, isEdit: boolean, isEditBooking: boolean, name: string) {\n    let units = selectedUnits;\n    const { data, key, changedKey } = event.detail;\n    const roomCategoryKey = `c_${data.roomCategoryId}`;\n    const ratePlanKey = `p_${data.ratePlanId}`;\n\n    if (this.shouldClearData(key)) {\n      units = new Map();\n    }\n\n    this.initializeRoomCategoryIfNeeded(roomCategoryKey, units);\n\n    if (isEditBooking) {\n      if (changedKey === 'rate') {\n        if (units.has(roomCategoryKey) && units.get(roomCategoryKey).has(ratePlanKey)) {\n          this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n        }\n      } else {\n        if (changedKey !== 'rateType') {\n          if (changedKey === 'adult_child_offering') {\n            if (units.has(roomCategoryKey) && selectedUnits.get(roomCategoryKey).has(ratePlanKey)) {\n              this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n            }\n          } else {\n            this.applyBookingEditToSelectedRoom(roomCategoryKey, ratePlanKey, data, units, name, isEdit);\n          }\n        }\n      }\n    } else {\n      this.setSelectedRoomData(roomCategoryKey, ratePlanKey, data, units);\n    }\n    this.cleanupEmptyData(roomCategoryKey, units);\n    return units;\n  }\n\n  private shouldClearData(key: string | undefined): boolean {\n    return key === 'clearData' || key === 'EDIT_BOOKING';\n  }\n\n  private initializeRoomCategoryIfNeeded(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (!selectedUnits.has(roomCategoryKey)) {\n      selectedUnits.set(roomCategoryKey, new Map());\n    }\n  }\n  private setSelectedRoomData(roomCategoryKey: string, ratePlanKey: string, data: any, selectedUnits: Map<string, Map<string, any>>) {\n    let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n    if (data.totalRooms === 0 || data.inventory === 0) {\n      selectedRatePlans.delete(ratePlanKey);\n    } else {\n      selectedUnits.set(roomCategoryKey, selectedRatePlans.set(ratePlanKey, { ...data, selectedUnits: Array(data.totalRooms).fill(-1) }));\n    }\n  }\n\n  private cleanupEmptyData(roomCategoryKey: string, selectedUnits: Map<string, Map<string, any>>) {\n    if (selectedUnits.has(roomCategoryKey)) {\n      let selectedRatePlans = selectedUnits.get(roomCategoryKey);\n      if (selectedRatePlans.size === 0) {\n        selectedUnits.delete(roomCategoryKey);\n      }\n    }\n  }\n  private applyBookingEditToSelectedRoom(roomCategoryKey: string, ratePlanKey: string, data, selectedUnits: Map<string, Map<string, any>>, name: string, isEdit: boolean) {\n    selectedUnits.clear();\n    let res = {};\n    if (isEdit) {\n      res = { ...data, guestName: name || '', roomId: '' };\n    } else {\n      res = { ...data };\n    }\n    selectedUnits.set(roomCategoryKey, new Map().set(ratePlanKey, res));\n  }\n\n  private calculateAmount({ is_amount_modified, selected_variation, view_mode, rp_amount }: IRatePlanSelection) {\n    const total_days = selected_variation.nights.length;\n    if (is_amount_modified) {\n      return view_mode === '002' ? rp_amount : rp_amount / total_days;\n    }\n  }\n\n  private generateDailyRates(rate_plan: IRatePlanSelection, i: number) {\n    let variation = rate_plan.selected_variation;\n    const amount = rate_plan.is_amount_modified ? this.calculateAmount(rate_plan) : null;\n    if (rate_plan.guest[i].infant_nbr > 0 && !rate_plan.is_amount_modified) {\n      if (!this.variationService) {\n        this.variationService = new VariationService();\n      }\n      variation = this.variationService.getVariationBasedOnInfants({\n        variations: rate_plan.ratePlan.variations,\n        baseVariation: rate_plan.selected_variation,\n        infants: rate_plan.guest[i].infant_nbr,\n      });\n    }\n    return variation.nights.map(n => ({\n      date: n.night,\n      amount: amount ?? n.discounted_amount,\n      cost: null,\n    }));\n  }\n\n  // private extractFirstNameAndLastName(name: string) {\n  //   const names = name.split(' ');\n  //   return { first_name: names[0] || null, last_name: names[1] || null };\n  // }\n\n  private getBookedRooms({\n    check_in,\n    check_out,\n    notes,\n    identifier,\n    override_unit,\n    unit,\n    auto_check_in,\n  }: {\n    identifier: string | null;\n    check_in: Date;\n    check_out: Date;\n    override_unit: boolean;\n    unit: string;\n    notes: string | null;\n    auto_check_in: boolean;\n  }) {\n    const rooms = [];\n\n    for (const roomTypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomTypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (let i = 0; i < rateplan.reserved; i++) {\n            const { first_name, last_name } = rateplan.guest[i];\n            rooms.push({\n              identifier,\n              roomtype: rateplan.roomtype,\n              rateplan: rateplan.ratePlan,\n              prepayment_amount_gross: 0,\n              unit: override_unit ? { id: unit } : rateplan.guest[i].unit ? { id: rateplan.guest[i].unit } : null,\n              occupancy: {\n                adult_nbr: rateplan.selected_variation.adult_nbr,\n                children_nbr: Number(rateplan.selected_variation.child_nbr ?? 0) - Math.max(Number(rateplan.guest[i].infant_nbr ?? 0), 0),\n                infant_nbr: rateplan.guest[i].infant_nbr,\n              },\n              bed_preference: rateplan.guest[i].bed_preference,\n              from_date: moment(check_in).format('YYYY-MM-DD'),\n              to_date: moment(check_out).format('YYYY-MM-DD'),\n              notes,\n              check_in: auto_check_in,\n              days: this.generateDailyRates(rateplan, i),\n              guest: {\n                email: null,\n                first_name,\n                last_name,\n                country_id: null,\n                city: null,\n                mobile: null,\n                address: null,\n                dob: null,\n                subscribe_to_news_letter: null,\n                cci: null,\n              },\n            });\n          }\n        }\n      }\n    }\n    return rooms;\n  }\n\n  async prepareBookUserServiceParams({ context, check_in }: { context: any; check_in: boolean }) {\n    try {\n      // Validate context structure\n      if (!context || !context.dateRangeData) {\n        throw new Error('Invalid context: Missing date range data.');\n      }\n\n      const fromDate = new Date(context.dateRangeData.fromDate);\n      const toDate = new Date(context.dateRangeData.toDate);\n\n      const generateNewRooms = (identifier = null, check_in: boolean = false) => {\n        return this.getBookedRooms({\n          check_in: fromDate,\n          check_out: toDate,\n          identifier,\n          notes: '',\n          override_unit: context.isEventType('BAR_BOOKING') ? true : false,\n          unit: context.isEventType('BAR_BOOKING') ? context.bookingData.PR_ID : null,\n          auto_check_in: check_in,\n        });\n      };\n\n      const modifyBookingDetails = ({ pickup_info, extra_services, is_direct, is_in_loyalty_mode, promo_key, extras, ...rest }: Booking, rooms: Room[]) => {\n        return {\n          assign_units: true,\n          is_pms: true,\n          is_direct,\n          is_backend: true,\n          is_in_loyalty_mode,\n          promo_key,\n          extras,\n          booking: {\n            ...rest,\n            rooms,\n          },\n          extra_services,\n          pickup_info,\n        };\n      };\n\n      let newBooking = null;\n      const sourceOption = booking_store.bookingDraft.source;\n      console.log({ sourceOption });\n      console.log({ event_type: context.defaultData.event_type, defaultData: context.defaultData });\n      switch (context.defaultData.event_type) {\n        case 'EDIT_BOOKING': {\n          const { booking, currentRoomType } = context.defaultData;\n\n          const filteredRooms = booking.rooms.filter(r => r.identifier !== currentRoomType.identifier);\n          console.log('currentRoomType', currentRoomType);\n          const newRooms = generateNewRooms(currentRoomType.identifier, currentRoomType.in_out?.code === '001');\n          newBooking = modifyBookingDetails(booking, [...filteredRooms, ...newRooms]);\n          break;\n        }\n        case 'ADD_ROOM':\n        case 'SPLIT_BOOKING': {\n          const { booking } = context.defaultData;\n          // console.log(booking);\n          if (!booking) {\n            throw new Error('Missing booking');\n          }\n          const newRooms = generateNewRooms();\n          // const previousRooms = context.defaultData.event_type === 'ADD_ROOM' ? ROOMS ?? [] : booking?.rooms;\n          const previousRooms = booking.rooms;\n          newBooking = modifyBookingDetails(booking, [...previousRooms, ...newRooms]);\n          break;\n        }\n        default: {\n          const newRooms = generateNewRooms(null, check_in);\n          const { bookedByInfoData } = context;\n          const isAgent = sourceOption.type === 'TRAVEL_AGENCY';\n          newBooking = {\n            assign_units: true,\n            is_pms: true,\n            is_direct: true,\n            is_backend: true,\n            is_in_loyalty_mode: false,\n            promo_key: null,\n            extras: [...extras.filter(e => e.key !== 'payment_code'), { key: 'payment_code', value: booking_store.selectedPaymentMethod?.code }],\n            agent: isAgent ? { id: sourceOption.tag } : null,\n            booking: {\n              from_date: moment(fromDate).format('YYYY-MM-DD'),\n              to_date: moment(toDate).format('YYYY-MM-DD'),\n              remark: bookedByInfoData.message || null,\n              booking_nbr: '',\n              property: {\n                id: context.propertyid,\n              },\n              booked_on: {\n                date: moment().format('YYYY-MM-DD'),\n                hour: new Date().getHours(),\n                minute: new Date().getMinutes(),\n              },\n              source: isAgent ? '' : sourceOption,\n              rooms: newRooms,\n              currency: context.currency,\n              arrival: { code: bookedByInfoData.selectedArrivalTime },\n              guest: {\n                email: bookedByInfoData.email === '' ? null : bookedByInfoData.email || null,\n                first_name: bookedByInfoData.firstName,\n                last_name: bookedByInfoData.lastName,\n                country_id: bookedByInfoData.countryId === '' ? null : bookedByInfoData.countryId,\n                city: null,\n                mobile: bookedByInfoData.contactNumber === null ? '' : this.hasUnderscore(bookedByInfoData.contactNumber) ? '' : bookedByInfoData.contactNumber,\n                country_phone_prefix: bookedByInfoData?.isdCode ?? null,\n                address: '',\n                dob: null,\n                subscribe_to_news_letter: bookedByInfoData.emailGuest || false,\n                cci: bookedByInfoData.cardNumber\n                  ? {\n                      nbr: bookedByInfoData.cardNumber,\n                      holder_name: bookedByInfoData.cardHolderName,\n                      expiry_month: bookedByInfoData.expiryMonth,\n                      expiry_year: bookedByInfoData.expiryYear,\n                    }\n                  : null,\n              },\n            },\n            pickup_info: null,\n          };\n          break;\n        }\n      }\n      return newBooking;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private getRoomCategoryByRoomId(bookingData) {\n    return bookingData.roomsInfo?.find(roomCategory => {\n      return roomCategory.id === bookingData.RATE_TYPE;\n    });\n  }\n  public setEditingRoomInfo(bookingData, selectedUnits) {\n    const category = this.getRoomCategoryByRoomId(bookingData);\n    const room_id = !category ? '' : `c_${category?.id}`;\n    const ratePlanId = `p_${bookingData.RATE_PLAN_ID}`;\n    const data = {\n      adultCount: bookingData.ADULTS_COUNT,\n      rate: bookingData.RATE,\n      rateType: bookingData.RATE_TYPE,\n      ratePlanId: bookingData.RATE_PLAN_ID,\n      roomCategoryId: category ? category.id : '',\n      roomCategoryName: category ? category.name : '',\n      totalRooms: 1,\n      ratePlanName: bookingData.RATE_PLAN,\n      roomId: bookingData.PR_ID,\n      guestName: bookingData.NAME,\n      cancelation: bookingData.cancelation,\n      guarantee: bookingData.guarantee,\n      adult_child_offering: bookingData.adult_child_offering,\n    };\n    selectedUnits.set(room_id, new Map().set(ratePlanId, data));\n  }\n}\n",":host {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100vw;\n  min-height: 100vh;\n  z-index: 99;\n  overflow: hidden;\n  /* min-width: 450px; */\n}\n\n.card-title {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n}\n.card-header-container {\n  border-bottom: 1px solid #e4e5ec;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  padding: 1rem 0;\n  justify-content: space-between;\n}\n.fd-book-property__title {\n  margin: 0;\n  padding: 0;\n  font-family: var(--wa-font-family-heading);\n  font-weight: var(--wa-font-weight-heading);\n  line-height: var(--wa-line-height-condensed);\n  text-wrap: balance;\n  font-size: var(--wa-font-size-l);\n}\n.loading-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0;\n  padding: 0;\n}\n.card-header-container h3 {\n  padding: 0;\n  margin: 0;\n}\n\n.background-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.25);\n}\n\n.formContainer {\n  height: calc(100% - 79px);\n  overflow: auto;\n}\n.gap-30 {\n  gap: 30px;\n}\n.block-date {\n  width: 100%;\n}\n.sideWindow {\n  position: absolute;\n  inset: 0;\n  left: unset;\n  background-color: #ffffff;\n  width: 100%;\n  overflow: auto;\n  animation: slideInFromRight 0.5s;\n}\n.card {\n  top: 0;\n  z-index: 1000;\n}\n\n.close {\n  float: right;\n  font-size: 1.5rem;\n  font-weight: 700;\n  line-height: 1;\n  color: #000;\n  text-shadow: 0 1px 0 #fff;\n  opacity: 0.5;\n  padding: 0;\n  background-color: transparent;\n  border: 0;\n  appearance: none;\n}\n\n.close-icon {\n  position: absolute;\n  top: 18px;\n  right: 33px;\n  outline: none;\n}\n\nbutton:not(:disabled),\n[type='button']:not(:disabled) {\n  cursor: pointer;\n}\n.sheet-footer {\n  width: 100%;\n}\n\n.card-header-container {\n  --spacing: var(--wa-space-l);\n  padding: 0;\n  display: flex;\n  flex-wrap: nowrap;\n  padding-inline-start: var(--spacing);\n  padding-block-end: 0;\n  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));\n  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));\n  border-bottom: 1px solid var(--wa-color-surface-border);\n  padding-bottom: calc(var(--spacing) / 2);\n  background-color: var(--wa-color-surface-default);\n}\n/* .row {\n  padding: 0 0 0 15px;\n  margin: 0;\n} */\n@media only screen and (min-width: 1200px) {\n  .sideWindow {\n    max-width: 70%;\n  }\n}\n@media only screen and (min-width: 2000px) {\n  .sideWindow {\n    max-width: 40%;\n  }\n}\n@media only screen and (min-width: 768px) and (max-width: 1200px) {\n  .sideWindow {\n    max-width: 90%;\n  }\n}\n@media only screen and (min-width: 600px) and (max-width: 768px) {\n  .sideWindow {\n    max-width: 75%;\n  }\n}\n@media only screen and (min-width: 641px) {\n  .block-date {\n    max-width: 450px;\n    padding-bottom: 0 !important;\n  }\n}\n@keyframes slideInFromRight {\n  from {\n    transform: translateX(120%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n@keyframes slideOutToRight {\n  from {\n    transform: translateX(0);\n  }\n  to {\n    transform: translateX(120%);\n  }\n}\n\n.sideWindow--exit {\n  animation: slideOutToRight 0.5s forwards;\n}\n",":host {\n  height: 100%;\n}\n.sheet-container {\n  display: flex !important;\n  flex-direction: column !important;\n  background: white;\n  height: 100vh;\n  gap: 1rem;\n  z-index: 1000;\n}\n.sheet-container {\n  height: -webkit-fill-available;\n  height: 100vh;\n  height: 100dvh;\n}\n\n/* @supports (height: 100svh) {\n  .sheet-container {\n    height: 100svh;\n  }\n} */\n.sheet-footer {\n  position: sticky;\n  bottom: 0;\n  z-index: 20;\n  background: white;\n  border-top: 1px solid #e4e5ec;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  gap: 0.5rem;\n}\n.sheet-header {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n}\n.sheet-body {\n  flex: 1 1 0%;\n}\n/* @media (max-width: 767px) {\n  .sheet-footer {\n    bottom: env(safe-area-inset-bottom);\n  }\n} */\n@media (min-width: 768px) {\n  .sheet-footer {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n","import { Component, Event, EventEmitter, Host, Prop, State, h, Listen, Fragment } from '@stencil/core';\nimport { BookingService } from '@/services/booking-service/booking.service';\nimport { dateToFormattedString, getReleaseHoursString, handleBodyOverflow } from '@/utils/utils';\nimport { ICountry, IEntries, RoomBlockDetails } from '@/models/IBooking';\nimport { IPageTwoDataUpdateProps } from '@/models/models';\nimport { IglBookPropertyService } from './igl-book-property.service';\nimport { BookingSource, IglBookPropertyPayloadEditBooking, TAdultChildConstraints, TEventType, TPropertyButtonsTypes } from '@/models/igl-book-property';\nimport locales from '@/stores/locales.store';\nimport { IToast } from '@/components/ui/ir-toast/toast';\nimport { isRequestPending } from '@/stores/ir-interceptor.store';\nimport { ICurrency } from '@/models/calendarData';\nimport booking_store, {\n  calculateTotalRooms,\n  modifyBookingStore,\n  reserveRooms,\n  resetBookingStore,\n  resetReserved,\n  setBookingDraft,\n  setBookingSelectOptions,\n} from '@/stores/booking.store';\nimport moment from 'moment';\nimport { BookingGuestSchema, RoomGuestSchema } from './types';\nexport type IHistoryEntry = {\n  dates: { checkIn: Date; checkOut: Date };\n  adults: number;\n  children: number;\n};\n@Component({\n  tag: 'igl-book-property',\n  styleUrls: ['igl-book-property.css', '../../../common/sheet.css'],\n  scoped: true,\n})\nexport class IglBookProperty {\n  @Prop() propertyid: number;\n  @Prop() allowedBookingSources: any;\n  @Prop() language: string;\n  @Prop() countries: ICountry[];\n  @Prop() showPaymentDetails: boolean = false;\n  @Prop() currency: ICurrency;\n  @Prop({ reflect: true, mutable: true }) bookingData: { [key: string]: any };\n  @Prop() adultChildConstraints: TAdultChildConstraints;\n\n  @State() renderAgain: boolean = false;\n  @State() dateRangeData: { [key: string]: any };\n  @State() defaultData: any;\n  @State() isLoading: string;\n  @State() bookingHistory: Array<{\n    dates: { checkIn: Date; checkOut: Date };\n    adults: number;\n    children: number;\n  }> = [];\n\n  @Event() closeBookingWindow: EventEmitter<{ [key: string]: any }>;\n  @Event() blockedCreated: EventEmitter<RoomBlockDetails>;\n  @Event() resetBookingEvt: EventEmitter<null>;\n  @Event({ bubbles: true, composed: true }) animateIrButton: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) animateIrSelect: EventEmitter<string>;\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\n\n  private initialRoomIds: { roomName: string; ratePlanId: number; roomId: string; roomTypeId: string } | null = null;\n  private page: string;\n  private showSplitBookingOption: boolean = false;\n  private guestData: { [key: string]: any }[] = [];\n  private bookedByInfoData: { [key: string]: any } = {};\n  private blockDatesData: { [key: string]: any } = {};\n  private ratePricingMode: IEntries[] = [];\n  private selectedUnits: Map<string, Map<string, any>> = new Map();\n  private bedPreferenceType: IEntries[] = [];\n  private bookingService: BookingService = new BookingService();\n  private bookPropertyService = new IglBookPropertyService();\n  private defaultDateRange: { from_date: string; to_date: string };\n  private updatedBooking: boolean = false;\n  private MAX_HISTORY_LENGTH: number = 2;\n  private didReservation: boolean;\n  private wasBlockedUnit: boolean;\n\n  async componentWillLoad() {\n    if (booking_store.roomTypes) {\n      modifyBookingStore('roomTypes', []);\n      modifyBookingStore('ratePlanSelections', {});\n    }\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.initializeDefaultDateRange();\n\n    if (!this.bookingData.defaultDateRange) {\n      return;\n    }\n    this.initializeDefaultData();\n    this.wasBlockedUnit = this.defaultData.hasOwnProperty('block_exposed_unit_props');\n    modifyBookingStore('event_type', { type: this.defaultData.event_type });\n    this.fetchSetupEntriesAndInitialize();\n  }\n\n  componentDidLoad() {\n    document.addEventListener('keydown', this.handleKeyDown);\n    handleBodyOverflow(true);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  @Listen('inputCleared')\n  clearBooking(e: CustomEvent) {\n    if (this.isEventType('SPLIT_BOOKING')) {\n      e.stopImmediatePropagation();\n      e.stopPropagation();\n      this.bookedByInfoData = {};\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n      this.renderPage();\n    }\n  }\n\n  @Listen('spiltBookingSelected')\n  async handleSpiltBookingSelected(e: CustomEvent<{ key: string; data: unknown }>) {\n    e.stopImmediatePropagation();\n    e.stopPropagation();\n    const { key, data } = e.detail;\n    if (key === 'select' || (key === 'blur' && data !== '')) {\n      const res = await this.bookingService.getExposedBooking((data as any).booking_nbr || (data as string), this.language);\n      this.defaultData = { ...this.defaultData, booking: res };\n      this.bookPropertyService.setBookingInfoFromAutoComplete(this, res);\n      const sourceOption = booking_store.selects.sources.find(opt => opt.code === res.source.code);\n      setBookingDraft({\n        source: sourceOption,\n      });\n      this.renderPage();\n    }\n  }\n  @Listen('dateSelectEvent')\n  onDateRangeSelect(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    resetBookingStore(false);\n    const opt: { [key: string]: any } = event.detail;\n    this.updateBookingHistory({\n      dates: {\n        checkIn: new Date(this.dateRangeData.fromDate),\n        checkOut: new Date(new Date(opt.data.toDate)),\n      },\n    });\n    if (opt.key === 'selectedDateRange') {\n      this.dateRangeData = opt.data;\n      if (this.isEventType('ADD_ROOM') || this.isEventType('SPLIT_BOOKING')) {\n        this.defaultData.roomsInfo = [];\n      } else if (booking_store.bookingDraft.occupancy.adults) {\n        // this.checkBookingAvailability();\n        // this.checkBookingAvailability(dateToFormattedString(new Date(this.dateRangeData.fromDate)), dateToFormattedString(new Date(this.dateRangeData.toDate)));\n      }\n    }\n  }\n\n  @Listen('gotoSplitPageTwoEvent', { target: 'window' })\n  gotoSplitPageTwo() {\n    this.gotoPage('page_two');\n  }\n\n  @Listen('buttonClicked')\n  handleButtonClicked(event: CustomEvent<{ key: TPropertyButtonsTypes; data?: CustomEvent }>) {\n    switch (event.detail.key) {\n      case 'save':\n        this.bookUser(false);\n        break;\n      case 'cancel':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        this.closeWindow();\n        break;\n      case 'back':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (this.isEventType('BAR_BOOKING')) {\n          resetReserved();\n        }\n        this.gotoPage('page_one');\n        break;\n      case 'book':\n        this.bookUser(false);\n        break;\n      case 'bookAndCheckIn':\n        this.bookUser(true);\n        break;\n      case 'next':\n        event.stopImmediatePropagation();\n        event.stopPropagation();\n        if (!booking_store.bookingDraft.occupancy?.adults) {\n          this.animateIrSelect.emit('adult_child_select');\n          break;\n        }\n        if (calculateTotalRooms() > 0) {\n          this.gotoPage('page_two');\n          break;\n        } else if (this.defaultData?.roomsInfo.length === 0) {\n          this.animateIrButton.emit('check_availability');\n          break;\n        }\n        this.toast.emit({\n          type: 'error',\n          description: locales.entries.Lcz_SelectRatePlan,\n          title: locales.entries.Lcz_SelectRatePlan,\n        });\n        break;\n      case 'check':\n        this.checkBookingAvailability();\n        break;\n      default:\n        break;\n    }\n  }\n\n  private updateBookingHistory(partialData: Partial<IHistoryEntry>) {\n    const lastEntry = this.bookingHistory[this.bookingHistory.length - 1];\n\n    const newEntry: IHistoryEntry = {\n      dates: {\n        checkIn: partialData.dates?.checkIn || lastEntry?.dates?.checkIn || new Date(this.dateRangeData.fromDate),\n        checkOut: partialData.dates?.checkOut || lastEntry?.dates?.checkOut || new Date(this.dateRangeData.toDate),\n      },\n      adults: partialData.adults ?? lastEntry?.adults ?? booking_store.bookingDraft.occupancy?.adults,\n      children: partialData.children ?? lastEntry?.children ?? booking_store.bookingDraft.occupancy.children,\n    };\n\n    // Update the booking history\n    this.bookingHistory.push(newEntry);\n    if (this.bookingHistory.length > this.MAX_HISTORY_LENGTH) {\n      this.bookingHistory.shift();\n    }\n  }\n\n  private handleKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      this.closeWindow();\n    }\n  }\n\n  private initializeDefaultDateRange() {\n    this.defaultDateRange = {\n      from_date: this.bookingData.FROM_DATE,\n      to_date: this.bookingData.TO_DATE,\n    };\n  }\n\n  private initializeDefaultData() {\n    this.defaultData = this.bookingData;\n    this.dateRangeData = { ...this.defaultData.defaultDateRange };\n    setBookingDraft({\n      dates: {\n        checkIn: moment(this.defaultData.defaultDateRange.fromDate),\n        checkOut: moment(this.defaultData.defaultDateRange.toDate),\n      },\n    });\n  }\n\n  private async fetchSetupEntriesAndInitialize() {\n    try {\n      const setupEntries = await this.fetchSetupEntries();\n      this.setSourceOptions(this.allowedBookingSources);\n      this.setOtherProperties(setupEntries);\n      this.initializeEventData();\n    } catch (error) {\n      console.error('Error fetching setup entries:', error);\n    }\n  }\n\n  private initializeEventData() {\n    if (this.isEventType('EDIT_BOOKING')) {\n      this.initializeEditBookingData();\n    }\n\n    if (!this.isEventType('BAR_BOOKING')) {\n      this.bookPropertyService.resetRoomsInfoAndMessage(this);\n    }\n\n    this.initializePage();\n  }\n\n  private initializeEditBookingData() {\n    setBookingDraft({\n      occupancy: {\n        adults: Number(this.defaultData.ADULTS_COUNT),\n        children: Number(this.defaultData.CHILDREN_COUNT),\n      },\n    });\n    this.initialRoomIds = {\n      roomName: this.defaultData.roomName,\n      ratePlanId: this.defaultData.RATE_PLAN_ID,\n      roomId: this.defaultData.PR_ID,\n      roomTypeId: this.defaultData.RATE_TYPE,\n    };\n    const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n    modifyBookingStore('guest', {\n      bed_preference: currentRoomType.bed_preference?.toString(),\n      infant_nbr: currentRoomType.occupancy.infant_nbr,\n      first_name: GUEST.first_name ?? '',\n      last_name: GUEST.last_name ?? '',\n      // name: currentRoomType.guest.last_name ? currentRoomType.guest.first_name + ' ' + currentRoomType.guest.last_name : currentRoomType.guest.first_name,\n      unit: (currentRoomType.unit as any)?.id?.toString(),\n    });\n    this.checkBookingAvailability();\n    this.bookPropertyService.setEditingRoomInfo(this.defaultData, this.selectedUnits);\n  }\n\n  private initializePage() {\n    switch (this.defaultData.event_type) {\n      case 'SPLIT_BOOKING':\n        this.showSplitBookingOption = true;\n        this.page = 'page_one';\n        break;\n      case 'BLOCK_DATES':\n        this.page = 'page_block_date';\n        break;\n      default:\n        this.page = 'page_one';\n        break;\n    }\n  }\n\n  async fetchSetupEntries() {\n    return await this.bookingService.fetchSetupEntries();\n  }\n\n  private isGuestDataIncomplete() {\n    for (const roomtypeId in booking_store.ratePlanSelections) {\n      const roomtype = booking_store.ratePlanSelections[roomtypeId];\n      for (const rateplanId in roomtype) {\n        const rateplan = roomtype[rateplanId];\n        if (rateplan.reserved > 0) {\n          for (const guest of rateplan.guest) {\n            RoomGuestSchema.parse({ ...guest, requires_bed_preference: rateplan.roomtype.is_bed_configuration_enabled });\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  // private isButtonDisabled() {\n  //   const isValidProperty = (property, key, comparedBy) => {\n  //     if (!property) {\n  //       return true;\n  //     }\n  //     if (property === this.guestData) {\n  //       return this.isGuestDataIncomplete();\n  //     }\n  //     if (key === 'selectedArrivalTime') {\n  //       if (property[key] !== undefined) {\n  //         return property[key].code === '';\n  //       } else {\n  //         return true;\n  //       }\n  //     }\n  //     return property[key] === comparedBy || property[key] === undefined;\n  //   };\n  //   return (\n  //     isValidProperty(this.guestData, 'guestName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'firstName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'lastName', '') ||\n  //     isValidProperty(this.bookedByInfoData, 'selectedArrivalTime', '')\n  //   );\n  // }\n\n  private setSourceOptions(bookingSource: BookingSource[]) {\n    const _sourceOptions = this.isEventType('BAR_BOOKING') ? this.getFilteredSourceOptions(bookingSource) : bookingSource;\n    setBookingSelectOptions({\n      sources: _sourceOptions,\n    });\n    let sourceOption: BookingSource;\n    if (this.isEventType('EDIT_BOOKING')) {\n      const option = bookingSource.find(option => this.defaultData.SOURCE?.code === option.code);\n      sourceOption = option;\n    } else {\n      sourceOption = _sourceOptions.find(o => o.type !== 'LABEL');\n    }\n    setBookingDraft({\n      source: sourceOption,\n    });\n  }\n  private getFilteredSourceOptions(sourceOptions: BookingSource[]): BookingSource[] {\n    const agentIds = new Set<string>();\n    const hasAgentOnlyRoomType =\n      this.bookingData?.roomsInfo?.some((rt: any) => {\n        const rps = rt?.rateplans ?? [];\n        if (rps.length === 0) return false;\n\n        const isForAgentOnly = rps.every((rp: any) => (rp?.agents?.length ?? 0) > 0);\n        if (isForAgentOnly) {\n          rps.forEach((rp: any) => {\n            (rp?.agents ?? []).forEach((ag: any) => agentIds.add(ag?.id?.toString()));\n          });\n        }\n        return isForAgentOnly;\n      }) ?? false;\n    if (!hasAgentOnlyRoomType) {\n      return sourceOptions;\n    }\n    return sourceOptions.filter((opt: any) => {\n      if (opt?.type === 'LABEL') return true;\n      const candidate = opt?.tag;\n      const matchesId = candidate != null && agentIds.has(candidate);\n      return matchesId;\n    });\n  }\n\n  private setOtherProperties(res: any) {\n    this.ratePricingMode = res?.ratePricingMode;\n    this.bookedByInfoData.arrivalTime = res.arrivalTime;\n    this.bedPreferenceType = res.bedPreferenceType;\n  }\n\n  private async checkBookingAvailability() {\n    resetBookingStore(false);\n    const { source, occupancy } = booking_store.bookingDraft;\n    const from_date = moment(this.dateRangeData.fromDate).format('YYYY-MM-DD');\n    const to_date = moment(this.dateRangeData.toDate).format('YYYY-MM-DD');\n    const is_in_agent_mode = source?.type === 'TRAVEL_AGENCY';\n    try {\n      const room_type_ids_to_update = this.isEventType('EDIT_BOOKING') ? [this.defaultData.RATE_TYPE] : [];\n      const room_type_ids = this.isEventType('BAR_BOOKING') ? this.defaultData.roomsInfo.map(room => room.id) : [];\n      const data = await this.bookingService.getBookingAvailability({\n        from_date,\n        to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: occupancy.adults,\n          child: occupancy.children,\n        },\n        language: this.language,\n        room_type_ids,\n        currency: this.currency,\n        agent_id: is_in_agent_mode ? source?.tag : null,\n        is_in_agent_mode,\n        room_type_ids_to_update,\n      });\n      if (!this.isEventType('EDIT_BOOKING')) {\n        this.defaultData.defaultDateRange.fromDate = new Date(this.dateRangeData.fromDate);\n        this.defaultData.defaultDateRange.toDate = new Date(this.dateRangeData.toDate);\n      }\n      this.defaultData = { ...this.defaultData, roomsInfo: data };\n      if (this.isEventType('EDIT_BOOKING') && !this.updatedBooking) {\n        this.updateBooking();\n      }\n    } catch (error) {\n      console.error('Error initializing booking availability:', error);\n    }\n  }\n\n  private updateBooking() {\n    try {\n      const { currentRoomType, GUEST } = this.defaultData as IglBookPropertyPayloadEditBooking;\n      const roomtypeId = currentRoomType.roomtype.id;\n      const rateplanId = currentRoomType.rateplan.id;\n      const guest = {\n        bed_preference: currentRoomType.bed_preference?.toString(),\n        infant_nbr: currentRoomType.occupancy.infant_nbr,\n        last_name: GUEST.last_name,\n        first_name: GUEST.first_name,\n        unit: (currentRoomType.unit as any)?.id?.toString(),\n        roomtype_id: currentRoomType.roomtype.id,\n      };\n      modifyBookingStore('guest', guest);\n      reserveRooms({\n        roomTypeId: roomtypeId,\n        ratePlanId: rateplanId,\n        rooms: 1,\n        guest: [guest],\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  private async checkAndBlockDate() {\n    try {\n      const { block_exposed_unit_props } = this.defaultData;\n      await this.bookingService.getBookingAvailability({\n        from_date: block_exposed_unit_props.from_date,\n        to_date: block_exposed_unit_props.to_date,\n        propertyid: this.propertyid,\n        adultChildCount: {\n          adult: 2,\n          child: 0,\n        },\n        language: this.language,\n        room_type_ids: this.defaultData.roomsInfo.map(room => room.id),\n        currency: this.currency,\n      });\n      const isAvailable = booking_store.roomTypes.every(rt => {\n        if (rt.is_available_to_book) {\n          return true;\n        }\n        return rt.inventory > 0 && rt['not_available_reason'] === 'ALL-RATES-PLAN-NOT-BOOKABLE';\n      });\n      if (isAvailable) {\n        await this.handleBlockDate(false);\n      } else {\n        console.warn('Blocked date is unavailable. Continuing...');\n      }\n    } catch (error) {\n      console.error('Error checking and blocking date:', error);\n    }\n  }\n  private async closeWindow() {\n    resetBookingStore(true);\n    handleBodyOverflow(false);\n\n    if (this.wasBlockedUnit && !this.didReservation) {\n      await this.checkAndBlockDate();\n    }\n    const el = document.querySelector('.sideWindow');\n    if (!el) return;\n\n    el.classList.add('sideWindow--exit');\n\n    setTimeout(() => {\n      this.closeBookingWindow.emit();\n      document.removeEventListener('keydown', this.handleKeyDown);\n    }, 300);\n  }\n\n  private isEventType(key: TEventType) {\n    return this.defaultData.event_type === key;\n  }\n\n  private handleBlockDateUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.blockDatesData = opt.data;\n  }\n\n  private handleGuestInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt = event.detail;\n    if (opt.guestRefKey) {\n      if (this.isEventType('BAR_BOOKING') || this.wasBlockedUnit || this.isEventType('SPLIT_BOOKING')) {\n        this.guestData[opt.guestRefKey] = {\n          ...opt.data,\n          roomId: this.defaultData.PR_ID,\n        };\n      } else this.guestData[opt.guestRefKey] = opt.data;\n    }\n  }\n\n  private handleBookedByInfoUpdate(event: CustomEvent<{ [key: string]: any }>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    const opt: { [key: string]: any } = event.detail;\n    this.bookedByInfoData = opt.value.data;\n  }\n\n  private renderPage() {\n    this.renderAgain = !this.renderAgain;\n  }\n\n  private gotoPage(gotoPage: string) {\n    this.page = gotoPage;\n    this.renderPage();\n  }\n\n  private getPageBlockDatesView() {\n    return (\n      <Fragment>\n        <igl-block-dates-view\n          fromDate={this.defaultData.FROM_DATE}\n          toDate={this.defaultData.TO_DATE}\n          entryDate={this.defaultData.ENTRY_DATE}\n          onDataUpdateEvent={event => this.handleBlockDateUpdate(event)}\n        ></igl-block-dates-view>\n      </Fragment>\n    );\n  }\n\n  private handlePageTwoDataUpdateEvent(event: CustomEvent<IPageTwoDataUpdateProps>) {\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    if (event.detail.key === 'propertyBookedBy') {\n      this.handleBookedByInfoUpdate(event);\n    } else {\n      this.handleGuestInfoUpdate(event);\n    }\n  }\n\n  private async handleBlockDate(auto_close = true) {\n    const props = this.wasBlockedUnit\n      ? this.defaultData.block_exposed_unit_props\n      : (() => {\n          const releaseData = getReleaseHoursString(+this.blockDatesData.RELEASE_AFTER_HOURS);\n          return {\n            from_date: dateToFormattedString(this.defaultData.defaultDateRange.fromDate),\n            to_date: dateToFormattedString(this.defaultData.defaultDateRange.toDate),\n            NOTES: this.blockDatesData.OPTIONAL_REASON || '',\n            pr_id: this.defaultData.PR_ID.toString(),\n            STAY_STATUS_CODE: this.blockDatesData.OUT_OF_SERVICE ? '004' : this.blockDatesData.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\n            DESCRIPTION: this.blockDatesData.RELEASE_AFTER_HOURS || '',\n            ...releaseData,\n          };\n        })();\n    // const blockedUnit = await transformNewBLockedRooms(result);\n    await this.bookingService.blockUnit(props);\n    // this.blockedCreated.emit(blockedUnit);\n    if (auto_close) this.closeWindow();\n  }\n\n  private async bookUser(check_in: boolean) {\n    // if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n    //   if (this.isGuestDataIncomplete()) {\n    //     this.isLoading = '';\n    //     return;\n    //   }\n    // } else if (this.isButtonDisabled()) {\n    //   this.isLoading = '';\n    //   return;\n    // }\n\n    try {\n      this.setLoadingState(check_in);\n      if (!this.isEventType('EDIT_BOOKING') && !this.isEventType('ADD_ROOM')) {\n        BookingGuestSchema.parse({ first_name: this.bookedByInfoData?.firstName, last_name: this.bookedByInfoData?.lastName });\n      }\n      this.isGuestDataIncomplete();\n      const isEditOrAdd = this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM');\n      if (isEditOrAdd) {\n        this.bookedByInfoData.message = this.defaultData.NOTES;\n      }\n      this.didReservation = true;\n      const serviceParams = await this.bookPropertyService.prepareBookUserServiceParams({\n        context: this,\n        check_in,\n      });\n      await this.bookingService.doReservation(serviceParams);\n      await this.adjustBlockedDatesAfterReservation(serviceParams);\n      this.resetBookingEvt.emit(null);\n      this.resetLoadingState();\n    } catch (error) {\n      console.error('Error booking user:', error);\n      this.isLoading = null;\n    }\n  }\n  private async adjustBlockedDatesAfterReservation(serviceParams: any) {\n    if (!this.wasBlockedUnit) {\n      return;\n    }\n    const original_from_date = moment(this.defaultData.block_exposed_unit_props.from_date, 'YYYY-MM-DD');\n    const current_from_date = moment(serviceParams.booking.from_date, 'YYYY-MM-DD');\n    const original_to_date = moment(this.defaultData.block_exposed_unit_props.to_date, 'YYYY-MM-DD');\n    const current_to_date = moment(serviceParams.booking.to_date, 'YYYY-MM-DD');\n    if (current_to_date.isBefore(original_to_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, from_date: current_to_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    if (current_from_date.isAfter(original_from_date, 'days')) {\n      const props = { ...this.defaultData.block_exposed_unit_props, to_date: current_from_date.format('YYYY-MM-DD') };\n      await this.bookingService.blockUnit(props);\n    }\n    return;\n  }\n\n  private setLoadingState(assign_units: boolean) {\n    if (this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')) {\n      this.isLoading = 'save';\n    } else {\n      this.isLoading = assign_units ? 'bookAndCheckIn' : 'book';\n    }\n  }\n\n  private resetLoadingState() {\n    this.isLoading = '';\n    setTimeout(() => {\n      this.closeWindow();\n    }, 100);\n  }\n\n  private getCurrentPage(name: string) {\n    return this.page === name;\n  }\n\n  render() {\n    return (\n      <Host data-testid=\"book_property_sheet h-100\">\n        <div class=\"background-overlay\" onClick={() => this.closeWindow()}></div>\n        <div class={'sideWindow sheet-container ' + (this.getCurrentPage('page_block_date') ? 'block-date' : '')}>\n          {isRequestPending('/Get_Setup_Entries_By_TBL_NAME_MULTI') ? (\n            <div class={'loading-container'}>\n              <ir-spinner></ir-spinner>\n            </div>\n          ) : (\n            <Fragment>\n              <div class=\"sheet-header\">\n                <div class=\"card-header-container\">\n                  <h2 class=\"fd-book-property__title\">{this.getCurrentPage('page_block_date') ? this.defaultData.BLOCK_DATES_TITLE : this.defaultData.TITLE}</h2>\n                  {/* <ir-icon\n                    class={'px-2'}\n                    onIconClickHandler={() => {\n                      this.closeWindow();\n                    }}\n                  >\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" height={20} width={20}>\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n                      />\n                    </svg>\n                  </ir-icon> */}\n                  <ir-custom-button appearance=\"plain\" variant=\"neutral\" size=\"medium\" onClickHandler={() => this.closeWindow()}>\n                    <wa-icon name=\"xmark\" library=\"system\" variant=\"solid\" label=\"Close\" aria-label=\"Close\"></wa-icon>\n                  </ir-custom-button>\n                </div>\n              </div>\n              <div class=\"px-2 sheet-body\">\n                {this.getCurrentPage('page_one') && (\n                  <igl-booking-overview-page\n                    wasBlockedUnit={this.wasBlockedUnit}\n                    initialRoomIds={this.initialRoomIds}\n                    defaultDaterange={this.defaultDateRange}\n                    eventType={this.defaultData.event_type}\n                    selectedRooms={this.selectedUnits}\n                    currency={this.currency}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    ratePricingMode={this.ratePricingMode}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    bookedByInfoData={this.bookedByInfoData}\n                    adultChildConstraints={this.adultChildConstraints}\n                    propertyId={this.propertyid}\n                  ></igl-booking-overview-page>\n                )}\n\n                {this.getCurrentPage('page_two') && (\n                  <igl-booking-form\n                    currency={this.currency}\n                    propertyId={this.propertyid}\n                    showPaymentDetails={this.showPaymentDetails}\n                    selectedGuestData={this.guestData}\n                    countries={this.countries}\n                    isLoading={this.isLoading}\n                    selectedRooms={this.selectedUnits}\n                    bedPreferenceType={this.bedPreferenceType}\n                    dateRangeData={this.dateRangeData}\n                    bookingData={this.defaultData}\n                    showSplitBookingOption={this.showSplitBookingOption}\n                    language={this.language}\n                    bookedByInfoData={this.bookedByInfoData}\n                    defaultGuestData={this.defaultData}\n                    isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                    onDataUpdateEvent={event => this.handlePageTwoDataUpdateEvent(event)}\n                  ></igl-booking-form>\n                )}\n                {this.getCurrentPage('page_block_date') ? this.getPageBlockDatesView() : null}\n              </div>\n              {this.getCurrentPage('page_block_date') ? (\n                <div class=\"sheet-footer\">\n                  <ir-button text={locales.entries.Lcz_Cancel} btn_color=\"secondary\" class=\"flex-fill\" onClick={() => this.closeWindow()}></ir-button>\n                  <ir-button\n                    text={locales.entries.Lcz_Blockdates}\n                    isLoading={isRequestPending('/Block_Exposed_Unit')}\n                    class=\"flex-fill\"\n                    onClick={() => this.handleBlockDate()}\n                  ></ir-button>\n                </div>\n              ) : (\n                <igl-book-property-footer\n                  page={this.page}\n                  dateRangeData={this.dateRangeData}\n                  isEditOrAddRoomEvent={this.isEventType('EDIT_BOOKING') || this.isEventType('ADD_ROOM')}\n                  isLoading={this.isLoading}\n                  class={'sheet-footer'}\n                  eventType={this.bookingData.event_type}\n                ></igl-book-property-footer>\n              )}\n            </Fragment>\n          )}\n        </div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}