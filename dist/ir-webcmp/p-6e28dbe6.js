import{a as e}from"./p-bf44a732.js";import{z as t,u as n,n as o,s as r,o as a,b as i,c as s,e as c,d as l,f as u,g as _}from"./p-e7d273da.js";import{e as d,w as y,x as m,h as p}from"./p-3664f526.js";import{a as f,o as b}from"./p-2d4a05d6.js";import{c as E}from"./p-c5894a47.js";import{h}from"./p-6c4ba7c0.js";import{c as w}from"./p-99cb260a.js";const g={id:-1,email:"",company:"",firstName:"",lastName:"",countryId:"",phone_prefix:"",mobile:"",selectedArrivalTime:"",emailGuest:true,note:"",cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:""};const k={bookedByGuest:g,bookedByGuestManuallyEdited:false,bookingDraft:{dates:{checkIn:h().startOf("day"),checkOut:h().add(1,"day")},occupancy:{adults:null,children:null},source:null},selects:{sources:[],ratePricingMode:[],arrivalTime:[],bedPreferences:[],countries:[]},checkout_guest:null,guest:null,tax_statement:null,roomTypes:[],enableBooking:false,resetBooking:false,ratePlanSelections:{},selectedPaymentMethod:null,isInFreeCancelationZone:false,bookingAvailabilityParams:{from_date:null,to_date:null,adult_nbr:0,child_nbr:0,infant_nbr:0},booking:null,fictus_booking_nbr:null,event_type:{type:"PLUS_BOOKING"}};let{state:v,onChange:I,reset:B}=E(k);function S(e){const{bookingDraft:t,selects:n,bookedByGuest:o}=v;B();if(!e){D(t);N(o);T(n)}}function x(){S(false)}function D(e){v.bookingDraft={...v.bookingDraft,...e,dates:{...v.bookingDraft.dates,...e.dates},occupancy:{...v.bookingDraft.occupancy,...e.occupancy}}}function T(e){v.selects={...v.selects,...e}}function P(e,t){if(!e){return null}if(!t||v.resetBooking){return e[0]}return e?.find((e=>e.adult_nbr===t.adult_nbr&&e.child_nbr===t.child_nbr))??null}I("roomTypes",(e=>{const t=v.ratePlanSelections;const n={};e.forEach((e=>{if(!e.is_active)return;n[e.id]=n[e.id]||{};e.rateplans.forEach((o=>{if(!o.is_active||!o?.variations?.length)return;const r=t[e.id]?.[o.id];n[e.id][o.id]=r&&Object.keys(r).length>0?{...r,ratePlan:o,selected_variation:P(o.variations,r.selected_variation)??null,visibleInventory:e.inventory,reserved:e.inventory===0?0:v.resetBooking?0:r.reserved,checkoutVariations:e.inventory===0?[]:r.checkoutVariations,checkoutBedSelection:e.inventory===0?[]:r.checkoutBedSelection,checkoutSmokingSelection:e.inventory===0?[]:r.checkoutSmokingSelection,guestName:e.inventory===0?[]:r.guestName,roomtype:{...r.roomtype}}:{reserved:0,rp_amount:0,view_mode:"001",guest:null,visibleInventory:e.inventory,selected_variation:o?.variations[0]??null,ratePlan:o,guestName:[],is_bed_configuration_enabled:e.is_bed_configuration_enabled,roomtype:{...e,physicalrooms:null,rateplans:null,availabilities:null},checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[]}}))}));v.ratePlanSelections=n;v.resetBooking=false}));function N(e){v.bookedByGuest={...v.bookedByGuest,...e}}function R({guest:e,ratePlanId:t,roomTypeId:n,ratePlanSelection:o}){v.ratePlanSelections={...v.ratePlanSelections,[n]:{...v.ratePlanSelections[n],[t]:{...o,guest:[...e]}}}}function A(e){const t=v.ratePlanSelections[e];if(!t){return}const n=v.roomTypes.find((t=>t.id===e));if(!n){return}const o=Object.values(t).reduce(((e,t)=>e+t.reserved),0);let r=false;const a=Object.entries(t).reduce(((e,[t,a])=>{const i=o-a.reserved;const s=Math.max(n.inventory-i,0);if(a.visibleInventory!==s){r=true;e[t]={...a,visibleInventory:s}}else{e[t]=a}return e}),{});if(r){v.ratePlanSelections={...v.ratePlanSelections,[e]:a}}}function C(){return Object.values(v.ratePlanSelections).some((e=>Object.values(e).some((e=>e.reserved>0))))}function O({ratePlanId:e,roomTypeId:t,params:n}){v.ratePlanSelections={...v.ratePlanSelections,[Number(t)]:{...v.ratePlanSelections[Number(t)],[e]:{...v.ratePlanSelections[t][e],...n}}}}function G({ratePlanId:e,roomTypeId:t,rooms:n,guest:o}){if(!v.ratePlanSelections[t]){v.ratePlanSelections[t]={}}const r=v.roomTypes?.find((e=>e.id===t));if(!r){throw new Error("Invalid room type id")}const a=r.rateplans.find((t=>t.id===e));if(!a){throw new Error("Invalid rate plan")}let i=Array.from({length:n},(()=>({first_name:"",last_name:"",unit:null,bed_preference:null,infant_nbr:null})));if(o){i=o}if(!v.ratePlanSelections[t][e]){v.ratePlanSelections[t][e]={guestName:[],reserved:0,view_mode:"001",rp_amount:0,guest:i,is_bed_configuration_enabled:r.is_bed_configuration_enabled,visibleInventory:0,selected_variation:null,ratePlan:a,checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],roomtype:{id:r.id,name:r.name,physicalrooms:null,rateplans:null,availabilities:null,inventory:r.inventory,rate:r.rate,bedding_setup:r.bedding_setup,smoking_option:r.smoking_option,is_bed_configuration_enabled:r.is_bed_configuration_enabled}}}v.ratePlanSelections={...v.ratePlanSelections,[Number(t)]:{...v.ratePlanSelections[Number(t)],[e]:{...v.ratePlanSelections[t][e],reserved:n,checkoutVariations:[],guest:i}}};A(t)}function L(e,t){if(!v.ratePlanSelections||!v.ratePlanSelections[e]){return{reserved:0,guest:null,visibleInventory:0,selected_variation:null,ratePlan:null,guestName:[],is_bed_configuration_enabled:false,checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],rp_amount:0,view_mode:"001",roomtype:null}}return v.ratePlanSelections[e][t]}function M(e,t){v[e]=t}function U(e,t){if(e.is_amount_modified){return e.view_mode==="001"?e.rp_amount:e.rp_amount*t}return e.selected_variation?.discounted_gross_amount??0}function V(){const e=f(v.bookingDraft.dates.checkIn.format("YYYY-MM-DD"),v.bookingDraft.dates.checkOut.format("YYYY-MM-DD"));let t=0;Object.values(v.ratePlanSelections).forEach((n=>{Object.values(n).forEach((n=>{if(n.reserved===0){return}const o=U(n,e);t+=o}))}));return t}function j(){return Object.values(v.ratePlanSelections).reduce(((e,t)=>e+Object.values(t).reduce(((e,t)=>{if(t.reserved===0){return e}return e+t.reserved}),0)),0)}function Y(){const e=Object.entries(v.ratePlanSelections).reduce(((e,[t,n])=>{const o=v.roomTypes.find((e=>e.id.toString()===t.toString()));e[t]=Object.entries(n).reduce(((e,[t,n])=>{const r=o?.inventory??n.roomtype?.inventory??n.visibleInventory;e[t]={...n,reserved:0,guest:null,guestName:[],checkoutVariations:[],checkoutBedSelection:[],checkoutSmokingSelection:[],visibleInventory:r??0};return e}),{});return e}),{});v.ratePlanSelections={...e}}function F(e){v.bookedByGuestManuallyEdited=e}function H(){const e=[];Object.entries(v.ratePlanSelections).forEach((([t,n])=>{Object.entries(n).forEach((([n,o])=>{if(!o.reserved){return}const r=o.guest??[];for(let a=0;a<o.reserved;a++){e.push({roomTypeId:Number(t),ratePlanId:Number(n),reservationIndex:a,guest:r[a]??null,ratePlanSelection:o})}}))}));return e}const K=t.object({CODE_NAME:t.string(),CODE_VALUE_AR:t.string().nullable(),CODE_VALUE_DE:t.string().nullable(),CODE_VALUE_EL:t.string().nullable(),CODE_VALUE_EN:t.string().nullable(),CODE_VALUE_FR:t.string().nullable(),CODE_VALUE_HE:t.string().nullable(),CODE_VALUE_PL:t.string().nullable(),CODE_VALUE_RU:t.string().nullable(),CODE_VALUE_UA:t.string().nullable(),DISPLAY_ORDER:t.number().nullable(),ENTRY_DATE:t.string().nullable(),ENTRY_USER_ID:t.number().nullable(),INVARIANT_VALUE:t.string().nullable(),ISDELETEABLE:t.boolean(),ISDELETED:t.boolean(),ISSYSTEM:t.boolean(),ISUPDATEABLE:t.boolean(),ISVISIBLE:t.boolean(),NOTES:t.string().nullable(),OWNER_ID:t.number().nullable(),TBL_NAME:t.string()});var z;(function(e){e["Room"]="room"})(z||(z={}));var Z;(function(e){e["Penthouse"]="Penthouse";e["PremiumSuites"]="Premium Suites";e["StandardRooms"]="Standard Rooms"})(Z||(Z={}));var W;(function(e){e["Empty"]="";e["The001"]="001";e["The002"]="002"})(W||(W={}));const X=n([o(),r().optional()]);const q=a({id:o()});const J=q.extend({code:r().optional()});const Q=a({amount:o(),type:r().optional(),key:n([o(),r().optional()]),description:r().optional().optional().default("")});const $=a({code:r().optional(),description:r().optional()});a({unit_id:o(),from_date:r().optional(),to_date:r().optional()});a({starter:r().optional()});a({booking_nbr:r().optional(),currency_id:o(),language:r().optional().optional(),rate_plan_id:o(),room_type_id:o(),property_id:o(),is_preserve_history:i().optional(),room_identifier:r().optional().optional()});a({booking_nbr:r().optional(),room_identifier:r().optional(),status:r().optional()});a({booking_nbr:r().optional(),currency_id:o(),language:r().optional()});const ee=a({room_type_id:X,night:r().optional()});a({is_closed:i(),restrictions:s(ee),operation_type:r().optional().optional()});a({book_nbr:r().optional(),status:r().optional()});const te=a({adult:o(),child:o()});a({from_date:r().optional(),to_date:r().optional(),propertyid:o(),adultChildCount:te,language:r().optional(),room_type_ids:s(o()),room_type_ids_to_update:s(o()).optional(),rate_plan_ids:s(o()).optional(),currency:J,is_in_agent_mode:i().optional(),agent_id:X.optional()});const ne=a({from_date:r().optional(),to_date:r().optional()});a({unit_id:o(),block_status_code:c(["003","004","002"]).optional(),description:r().optional().optional(),property_id:o(),brackets:s(ne)});a({property_id:o(),room_identifier:r().optional(),code:r().optional()});a({service:l(),booking_nbr:X,is_remove:i()});const oe=a({property_id:r(),check_in_date:r(),page_index:o().default(1),page_size:o().default(10)});const re=a({property_id:r(),check_out_date:r(),page_index:o().default(1),page_size:o().default(10)});const ae=a({booking_nbr:r().optional()});const ie=a({invoice_nbr:r().optional(),reason:r().optional(),property_id:o()});const se=a({booking_nbr:r().optional(),currency:q,target:$,Date:r().optional(),nbr:r().optional(),remark:r().optional(),billed_to_name:r().optional(),billed_to_tax:r().optional(),items:s(Q)});const ce=a({is_proforma:i().optional().default(false),property_id:o(),invoice:se});const le=a({invoice_nbr:r().optional(),property_id:o(),mode:c(["invoice","creditnote","proforma"]),invoice:se.optional()});const ue=a({address:u(),alternative_email:u(),cci:u(),city:u(),country:u(),country_id:o(),country_phone_prefix:r(),dob:u(),email:r(),first_name:r(),id:o(),id_info:u(),is_main:i(),last_name:r(),mobile:r(),mobile_without_prefix:r(),nbr_confirmed_bookings:o(),notes:u(),password:u(),subscribe_to_news_letter:u()});s(ue);const _e=a({code:r(),id:o(),symbol:r()});const de=a({code:r(),description:_()});const ye=a({amount:o(),booking_nbr:r(),currency:_e,description:_(),invoice_nbr:r(),is_invoiceable:i(),key:o(),status:de,system_id:o(),type:r()});const me=a({date:r(),nbr:r(),reason:r(),system_id:r().nullable(),user:r().nullable()});const pe=a({billed_to_name:_(),billed_to_tax:_(),booking_nbr:r(),credit_note:me.nullable(),currency:_e,date:r(),items:s(ye),nbr:r(),pdf_url:_(),remark:r(),status:de,system_id:o(),target:_(),user:r().nullable(),total_amount:_()});const fe=a({code:c(["001","002","003"]),description:r().nullable()});const be=a({amount:o(),booking_nbr:r(),currency:_e,invoice_nbr:r().nullable(),is_invoiceable:i(),key:o(),status:_(),system_id:_(),reason:fe.nullable(),type:c(["BSA","BSP","BSE","PAYMENT"])});const Ee=a({invoiceable_items:s(be),invoices:s(pe).nullable()});class he{async unBlockUnitByPeriod(t){const{data:n}=await e.post(`/Unblock_Unit_By_Period`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getNextValue(t){const{data:n}=await e.post(`/Get_Next_Value`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getExposedApplicablePolicies(t){const{data:n}=await e.post(`/Get_Exposed_Applicable_Policies`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result??[]}async handleExposedRoomInOut(t){const{data:n}=await e.post(`/Handle_Exposed_Room_InOut`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async GetPenaltyStatement(t){const{data:n}=await e.post("/Get_Penalty_Statement",t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}async setExposedRestrictionPerRoomType(t){const{data:n}=await e.post(`https://gateway.igloorooms.com/IRBE/Set_Exposed_Restriction_Per_Room_Type`,{operation_type:t.operation_type??"close_open",...t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getLov(){const{data:t}=await e.post(`/Get_LOV`,{});if(t.ExceptionMsg!==""){throw new Error(t.ExceptionMsg)}return t}async sendBookingConfirmationEmail(t,n){const{data:o}=await e.post(`/Send_Booking_Confirmation_Email`,{booking_nbr:t,language:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o.My_Result}async getCalendarData(t,n,o){try{const{data:r}=await e.post(`/Get_Exposed_Calendar`,{propertyid:t,from_date:n,to_date:o,extras:d,include_sales_rate_plans:true});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}const a=r.My_Result.months;const i=[];const s=await b(a);const c=a.map((e=>{i.push({daysCount:e.days.length,monthName:e.description});return e.days.map((t=>{if(t["value"]==="2025-05-30"){console.log(t)}return{day:y(t.description,e.description),value:t.value,currentDate:m(t.description,e.description),dayDisplayName:t.description,rate:t.room_types,unassigned_units_nbr:t.unassigned_units_nbr,occupancy:t.occupancy}}))})).flat();return Promise.resolve({ExceptionCode:null,ExceptionMsg:"",My_Params_Get_Rooming_Data:{AC_ID:t,FROM:r.My_Params_Get_Exposed_Calendar.from_date,TO:r.My_Params_Get_Exposed_Calendar.to_date},days:c,months:i,myBookings:s,defaultMonths:a})}catch(e){console.error(e)}}async handleExposedRoomGuests(t){const{data:n}=await e.post("/Handle_Exposed_Room_Guests",t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async fetchGuest(t){try{const{data:n}=await e.post(`/Get_Exposed_Guest`,{email:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){console.log(e);throw new Error(e)}}async changeExposedBookingStatus(t){try{const{data:n}=await e.post(`/Change_Exposed_Booking_Status`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){throw new Error(e)}}async fetchPMSLogs(t){try{const{data:n}=await e.post(`/Get_Exposed_PMS_Logs`,{booking_nbr:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){console.log(e);throw new Error(e)}}async getExposedBookingEvents(t){try{const{data:n}=await e.post(`/Get_Exposed_Booking_Events`,{booking_nbr:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){console.log(e);throw new Error(e)}}async editExposedGuest(t,n){try{const{data:o}=await e.post(`/Edit_Exposed_Guest`,{...t,book_nbr:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o.My_Result}catch(e){console.log(e);throw new Error(e)}}async getBookingAvailability(t){try{const{adultChildCount:n,currency:o,...r}=t;const{data:a}=await e.post(`/Check_Availability`,{...r,adult_nbr:n.adult,child_nbr:n.child,currency_ref:o.code,skip_getting_assignable_units:!w.is_frontdesk_enabled,is_backend:true});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}const i=this.modifyRateplans(this.sortRoomTypes(a["My_Result"],{adult_nbr:Number(n.adult),child_nbr:Number(n.child)}));v.roomTypes=[...i];v.tax_statement={message:a.My_Result.tax_statement};return i}catch(e){console.error(e);throw new Error(e)}}sortRoomTypes(e,t){return e.sort(((e,n)=>{if(e.is_available_to_book&&!n.is_available_to_book)return-1;if(!e.is_available_to_book&&n.is_available_to_book)return 1;const o=e.rateplans?.some((e=>e.variations?.some((e=>e.discounted_amount===0||e.discounted_amount===null))));const r=n.rateplans?.some((e=>e.variations?.some((e=>e.discounted_amount===0||e.discounted_amount===null))));if(o&&!r)return 1;if(!o&&r)return-1;const a=e.rateplans?.some((e=>e.variations?.some((e=>e.adult_nbr===t.adult_nbr&&e.child_nbr===t.child_nbr))));const i=n.rateplans?.some((e=>e.variations?.some((e=>e.adult_nbr===t.adult_nbr&&e.child_nbr===t.child_nbr))));if(a&&!i)return-1;if(!a&&i)return 1;const s=Math.max(...e.rateplans.flatMap((e=>e.variations?.map((e=>e.discounted_amount??0)))));const c=Math.max(...n.rateplans.flatMap((e=>e.variations?.map((e=>e.discounted_amount??0)))));if(s<c)return-1;if(s>c)return 1;return 0}))}modifyRateplans(e){return e?.map((e=>({...e,rateplans:e.rateplans?.map((e=>({...e,variations:this.sortVariations(e?.variations??[])})))})))}sortVariations(e){return e.sort(((e,t)=>{if(e.adult_nbr!==t.adult_nbr){return t.adult_nbr-e.adult_nbr}return t.child_nbr-e.child_nbr}))}async getCountries(t){try{const{data:n}=await e.post(`/Get_Exposed_Countries`,{language:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){console.error(e);throw new Error(e)}}async getSetupEntriesByTableName(t){const{data:n}=await e.post(`/Get_Setup_Entries_By_TBL_NAME`,{TBL_NAME:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}const o=n.My_Result??[];return o}async fetchSetupEntries(){try{const e=await this.getSetupEntriesByTableNameMulti(["_ARRIVAL_TIME","_RATE_PRICING_MODE","_BED_PREFERENCE_TYPE"]);const{arrival_time:t,rate_pricing_mode:n,bed_preference_type:o}=this.groupEntryTablesResult(e);return{arrivalTime:t,ratePricingMode:n,bedPreferenceType:o}}catch(e){console.error(e);throw new Error(e)}}async doBookingExtraService({booking_nbr:t,service:n,is_remove:o}){const{data:r}=await e.post(`/Do_Booking_Extra_Service`,{...n,booking_nbr:t,is_remove:o});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}return r.My_Result}groupEntryTablesResult(e){let t={};for(const n of e){const e=n.TBL_NAME.substring(1,n.TBL_NAME.length).toLowerCase();if(!t[e]){t[e]=[]}t[e]=[...t[e],n]}return t}async getSetupEntriesByTableNameMulti(t){const{data:n}=await e.post(`/Get_Setup_Entries_By_TBL_NAME_MULTI`,{TBL_NAMES:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}async getBlockedInfo(){return await this.getSetupEntriesByTableNameMulti(["_CALENDAR_BLOCKED_TILL"])}async getUserDefaultCountry(){try{let t={IP:""};if(w?.property?.id){t={...t,id:w.property.id}}const{data:n}=await e.post(`/Get_Country_By_IP`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n["My_Result"]}catch(e){console.error(e);throw new Error(e)}}async blockUnit(t){try{const{data:n}=await e.post(`/Block_Exposed_Unit`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n);return n["My_Params_Block_Exposed_Unit"]}catch(e){console.error(e);throw new Error(e)}}async blockAvailabilityForBrackets(t){try{const{data:n}=await e.post(`/Block_Availability_For_Brackets`,t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}catch(e){console.error(e);throw new Error(e)}}async setDepartureTime(t){const{data:n}=await e.post("/Set_Departure_Time",t);if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n}async getUserInfo(t){try{const{data:n}=await e.post(`/GET_EXPOSED_GUEST`,{email:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n.My_Result}catch(e){console.error(e);throw new Error(e)}}async getExposedBooking(t,n,o=true){try{const{data:r}=await e.post(`/Get_Exposed_Booking`,{booking_nbr:t,language:n,extras:o?d:null});if(r.ExceptionMsg!==""){throw new Error(r.ExceptionMsg)}return r.My_Result}catch(e){console.error(e)}}generateDays(e,t,n){const o=new Date(e);const r=new Date(t);const a=[];while(o<r){a.push({date:o.toISOString().split("T")[0],amount:n,cost:null});o.setDate(o.getDate()+1)}return a}calculateTotalRate(e,t,n,o){if(n&&o===2){return+e}return+e/+t}async fetchExposedGuest(t,n){try{const{data:o}=await e.post(`/Fetch_Exposed_Guests`,{email:t,property_id:n});if(o.ExceptionMsg!==""){throw new Error(o.ExceptionMsg)}return o["My_Result"]}catch(e){console.error(e);throw new Error(e)}}async fetchExposedBookings(t,n,o,r){try{const{data:a}=await e.post(`/Fetch_Exposed_Bookings`,{booking_nbr:t,property_id:n,from_date:o,to_date:r});if(a.ExceptionMsg!==""){throw new Error(a.ExceptionMsg)}return a["My_Result"]}catch(e){console.error(e);throw new Error(e)}}async getPCICardInfoURL(t){try{const{data:n}=await e.post(`/Get_PCI_Card_Info_URL`,{BOOK_NBR:t});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}return n["My_Result"]}catch(e){console.error(e);throw new Error(e)}}async doReservation(t){const{data:n}=await e.post(`/DoReservation`,{...t,extras:t.extras?t.extras:d});if(n.ExceptionMsg!==""){throw new Error(n.ExceptionMsg)}console.log(n["My_Result"]);return n["My_Result"]}async bookUser({bookedByInfoData:e,check_in:t,currency:n,extras:o=null,fromDate:r,guestData:a,pickup_info:i,propertyid:s,rooms:c,source:l,toDate:u,totalNights:_,arrivalTime:d,bookingNumber:y,defaultGuest:m,identifier:f,pr_id:b}){try{const E=p(r);const h=p(u);let w={email:e.email===""?null:e.email||null,first_name:e.firstName,last_name:e.lastName,country_id:e.countryId===""?null:e.countryId,city:null,mobile:e.contactNumber===null?"":e.contactNumber,phone_prefix:null,address:"",dob:null,subscribe_to_news_letter:e.emailGuest||false,cci:e.cardNumber?{nbr:e.cardNumber,holder_name:e.cardHolderName,expiry_month:e.expiryMonth,expiry_year:e.expiryYear}:null};if(m){w={...m,email:m.email===""?null:m.email}}if(e.id){w={...w,id:e.id}}const g={assign_units:true,check_in:t,is_pms:true,is_direct:true,is_in_loyalty_mode:false,promo_key:null,extras:o,booking:{booking_nbr:y||"",from_date:E,to_date:h,remark:e.message||null,property:{id:s},source:l,currency:n,arrival:{code:d?d:e.selectedArrivalTime},guest:w,rooms:[...a.map((e=>({identifier:f||null,roomtype:{id:e.roomCategoryId,name:e.roomCategoryName,physicalrooms:null,rateplans:null,availabilities:null,inventory:e.inventory,rate:e.rate/_},rateplan:{id:e.ratePlanId,name:e.ratePlanName,rate_restrictions:null,variations:null,cancelation:e.cancelation,guarantee:e.guarantee},unit:typeof b==="undefined"&&e.roomId===""?null:{id:+b||+e.roomId},occupancy:{adult_nbr:e.adultCount,children_nbr:e.childrenCount,infant_nbr:null},bed_preference:e.preference,from_date:E,to_date:h,notes:null,days:this.generateDays(E,h,this.calculateTotalRate(e.rate,_,e.isRateModified,e.rateType)),guest:{email:null,first_name:e.guestName,last_name:null,country_id:null,city:null,mobile:null,address:null,dob:null,subscribe_to_news_letter:null}}))),...c]},pickup_info:i};console.log("book user payload",g)}catch(e){console.error(e);throw new Error(e)}}async getRoomsToCheckIn(t){const n=oe.parse(t);const{data:o}=await e.post("https://gateway.igloorooms.com/IRBE/Get_Rooms_To_Check_In",n);return{bookings:o.My_Result,total_count:o.My_Params_Get_Rooms_To_Check_In?.total_count}}async getRoomsToCheckout(t){const n=re.parse(t);const{data:o}=await e.post("https://gateway.igloorooms.com/IRBE/Get_Rooms_To_Check_Out",n);return{bookings:o.My_Result,total_count:o.My_Params_Get_Rooms_To_Check_Out?.total_count}}async getBookingInvoiceInfo(t){const n=ae.parse(t);const{data:o}=await e.post("/Get_Booking_Invoice_Info",n);return Ee.parse(o.My_Result)}async issueInvoice(t){const n=ce.parse(t);const{data:o}=await e.post("/Issue_Invoice",n);return o}async voidInvoice(t){const n=ie.parse(t);const{data:o}=await e.post("/Void_Invoice",n);return o}async printInvoice(t){const n=le.parse(t);const{data:o}=await e.post("/Print_Invoice",n);return o}}export{he as B,K as Z,N as a,v as b,Y as c,O as d,S as e,T as f,L as g,H as h,C as i,j,V as k,g as l,M as m,x as n,F as o,G as r,D as s,R as u};
//# sourceMappingURL=p-6e28dbe6.js.map