import{r as t,c as e,h as i,H as s}from"./p-ee49d535.js";import{P as l,p as n}from"./p-21a63648.js";import{i as a}from"./p-c71f0e9e.js";import{l as o}from"./p-806fad31.js";import"./p-dfa14c12.js";import"./p-06203439.js";import"./p-4eb12235.js";const r=".sc-ir-option-details-h{display:block}.money-transfer-form.sc-ir-option-details{min-height:200px !important}";const c=r;const h=class{constructor(i){t(this,i);this.closeModal=e(this,"closeModal",7);this.toast=e(this,"toast",7);this.paymentOptionService=new l;this.propertyId=undefined;this.localizationIdx=undefined;this.selectedLanguage=null;this.invalid=false}async componentWillLoad(){this.paymentOptionService.setToken(n.token);if(!n.languages){const t=await this.paymentOptionService.GetExposedLanguages();n.languages=t}this.selectedLanguage=n.languages[0].id.toString();this.localizationIdx=n.selectedOption.code==="005"?n.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage)):null}async saveOption(t){var e;t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();let i=Object.assign(Object.assign({},n.selectedOption),{property_id:this.propertyId,is_active:n.mode==="create"?true:n.selectedOption.is_active});if((i===null||i===void 0?void 0:i.code)==="005"){const t=(e=i.localizables.find((t=>t.language.code.toLowerCase()==="en")))===null||e===void 0?void 0:e.description;console.log(t);if(!t||t.trim()===""){this.selectedLanguage=n.languages.find((t=>t.code.toLowerCase()==="en")).id.toString();this.localizationIdx=n.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage));this.invalid=true;return}}if(i.is_payment_gateway){i.display_order=0;const t=i.data.some((t=>!t.value||t.value===""));if(t){this.invalid=true;return}}await this.paymentOptionService.HandlePaymentMethod(i);this.toast.emit({type:"success",description:"",title:o.entries.Lcz_Saved,position:"top-right"});this.closeModal.emit(i)}handleSelectChange(t){t.stopImmediatePropagation();t.stopPropagation();this.selectedLanguage=t.detail;this.localizationIdx=n.selectedOption.code==="005"?n.selectedOption.localizables.findIndex((t=>t.language.id.toString()===this.selectedLanguage)):null}handleTextAreaChange(t){const e=t.detail;if(e.trim()!==""&&this.invalid){this.invalid=false}const i=[...n.selectedOption.localizables];i[this.localizationIdx]=Object.assign(Object.assign({},i[this.localizationIdx]),{description:e});n.selectedOption=Object.assign(Object.assign({},n.selectedOption),{localizables:i})}handlePaymentGatewayInfoChange(t,e){const i=t.detail;const s=[...n.selectedOption.data];s[e]=Object.assign(Object.assign({},s[e]),{value:i});n.selectedOption=Object.assign(Object.assign({},n.selectedOption),{data:s})}render(){var t,e;if(!n.selectedOption){return null}return i(s,null,i("form",{class:"p-1 mt-2",onSubmit:this.saveOption.bind(this)},n.selectedOption.code==="005"?i("div",null,i("div",{class:"mb-1"},i("ir-select",{selectedValue:this.selectedLanguage,LabelAvailable:false,showFirstOption:false,data:n.languages.map((t=>({text:t.description,value:t.id.toString()})))})),i("div",null,this.invalid&&i("p",{class:"text-danger p-0 m-0"},o.entries.Lcz_YouMustFillEnglishField),i("ir-textarea",{placeholder:"","aria-invalid":this.invalid?"true":"false",textareaClassname:"money-transfer-form",label:"",onTextChange:this.handleTextAreaChange.bind(this),value:(t=n.selectedOption.localizables[this.localizationIdx].description)!==null&&t!==void 0?t:""}))):i("div",null,(e=n.selectedOption.data)===null||e===void 0?void 0:e.map(((t,e)=>{var s,l;return i("fieldset",{key:t.key},i("ir-input-text",{value:t.value,onTextChange:t=>this.handlePaymentGatewayInfoChange(t,e),id:`input_${t.key}`,label:t.key,placeholder:"",labelWidth:4,"aria-invalid":this.invalid&&(t.value===null||((l=(s=t.value)!==null&&s!==void 0?s:"")===null||l===void 0?void 0:l.trim())==="")?"true":"false"}))}))),i("div",{class:"d-flex flex-column flex-sm-row mt-3"},i("ir-button",{onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill mr-sm-1`,icon:"",text:o.entries.Lcz_Cancel,btn_color:"secondary",btn_type:"button"}),i("ir-button",{btn_type:"submit",btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:a("/Handle_Payment_Method"),text:o.entries.Lcz_Save,btn_color:"primary"}))))}};h.style=c;export{h as ir_option_details};
//# sourceMappingURL=p-1835179f.entry.js.map